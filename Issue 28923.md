# Issue 28923: add method to find a surrounding of a polyomino with isometric copies of itself

archive/issues_028923.json:
```json
{
    "body": "This ticket adds some code based on the tiling solver class and dancing links solver to surround a polyomino with copies of itself. An example is below:\n\n\n```\nsage: from sage.combinat.tiling import Polyomino\nsage: H = Polyomino([(-1, 1), (-1, 4), (-1, 7), (0, 0), (0, 1), (0, 2),\n....: (0, 3), (0, 4), (0, 5), (0, 6), (0, 7), (0, 8), (1, 1), (1, 2),\n....: (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 0), (2, 2),\n....: (2, 3), (2, 5), (2, 6), (2, 8)])\nsage: H.show2d()\n```\n\n\n![](H.png)\n\n\n```\nsage: solution = H.self_surrounding(8)\nsage: G = sum([p.show2d() for p in solution], Graphics())\nsage: G\n```\n\n\n![](G.png)\n\nIssue created by migration from https://trac.sagemath.org/ticket/29160\n\n",
    "created_at": "2020-02-06T19:42:42Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "add method to find a surrounding of a polyomino with isometric copies of itself",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28923",
    "user": "slabbe"
}
```
This ticket adds some code based on the tiling solver class and dancing links solver to surround a polyomino with copies of itself. An example is below:


```
sage: from sage.combinat.tiling import Polyomino
sage: H = Polyomino([(-1, 1), (-1, 4), (-1, 7), (0, 0), (0, 1), (0, 2),
....: (0, 3), (0, 4), (0, 5), (0, 6), (0, 7), (0, 8), (1, 1), (1, 2),
....: (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 0), (2, 2),
....: (2, 3), (2, 5), (2, 6), (2, 8)])
sage: H.show2d()
```


![](H.png)


```
sage: solution = H.self_surrounding(8)
sage: G = sum([p.show2d() for p in solution], Graphics())
sage: G
```


![](G.png)

Issue created by migration from https://trac.sagemath.org/ticket/29160





---

archive/issue_comments_409398.json:
```json
{
    "body": "Attachment [H.png](tarball://root/attachments/some-uuid/ticket29160/H.png) by slabbe created at 2020-02-06 19:47:08",
    "created_at": "2020-02-06T19:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409398",
    "user": "slabbe"
}
```

Attachment [H.png](tarball://root/attachments/some-uuid/ticket29160/H.png) by slabbe created at 2020-02-06 19:47:08



---

archive/issue_comments_409399.json:
```json
{
    "body": "Attachment [G.png](tarball://root/attachments/some-uuid/ticket29160/G.png) by slabbe created at 2020-02-06 19:59:30",
    "created_at": "2020-02-06T19:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409399",
    "user": "slabbe"
}
```

Attachment [G.png](tarball://root/attachments/some-uuid/ticket29160/G.png) by slabbe created at 2020-02-06 19:59:30



---

archive/issue_comments_409400.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-02-06T20:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409400",
    "user": "slabbe"
}
```

New commits:



---

archive/issue_comments_409401.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-06T20:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409401",
    "user": "slabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_409402.json:
```json
{
    "body": "A few little things:\n\n```diff\n     - ``dimension`` -- integer (default: ``None``), dimension of the space, \n       if ``None``, it is guessed from the ``coords`` if ``coords`` is non\n-      empty.\n+      empty\n```\n\n\n```diff\n                 raise ValueError(\"dimension(={}) must be provided for\"\n-                             \" the empty polyomino\".format(dimension))\n+                                 \" the empty polyomino\".format(dimension))\n```\n\n\n```diff\n-Return whether self is strictly inside of other.\n+Return whether ``self`` is strictly inside of ``other``.\n```\n\nand other similar changes.\n\n```diff\n         OUTPUT:\n \n-            polyomino\n+        polyomino\n```\n\n\n```diff\n         return Polyomino(self.frozenset() & other.frozenset(),\n-                color=self._color, dimension=self._dimension)\n+                         color=self._color, dimension=self._dimension)\n```\n\n\n```diff\n         OUTPUT:\n \n-            set of 3d polyominoes\n+        set of 3d polyominoes\n```\n\n\n```diff\n-        Using a Polyomino as input ::\n+        Using a Polyomino as input::\n```\n\n\n```diff\n-        - ``orientation_preserving`` -- bool (optional, default: ``True``),\n-          If True, the group of isometries of the `n`-cube is restricted to\n-          those that preserve the orientation, i.e. of determinant 1.\n+        - ``orientation_preserving`` -- bool (optional, default: ``True``);\n+          if ``True``, the group of isometries of the `n`-cube is restricted\n+          to those that preserve the orientation, i.e. of determinant 1\n```\n\n\n```diff\n-        S = set()\n-        for cano in all_distinct_cano:\n-            for t in cano.translated_copies_intersection(box=box):\n-                S.add(t)\n-        return S\n+        return set([t for cano in all_distinct_cano\n+                    for t in cano.translated_copies_intersection(box=box)])\n```\n\n\n```diff\n     def self_surrounding(self, radius, remove_incomplete_copies=True,\n-            ncpus=None):\n+                         ncpus=None):\n```\n\n\n```diff\n         OUTPUT:\n \n-            list of polyominoes\n+        list of polyominoes\n```\n\n\n```\n            raise Exception('No solution was found with radius={}, '\n            'this tile can not be surrounded by itself'.format(radius))\n```\n\nI don't like the fact that this raises a general `Exception`. I think it should be more specific like a `ValueError`.\n\nSome of these are PEP8 and could amount to more of bikeshedding, but I think it is good to try and follow them. There are a few other such PEP8 code changes that could be done too beyond those I mentioned here.",
    "created_at": "2020-02-08T21:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409402",
    "user": "tscrim"
}
```

A few little things:

```diff
     - ``dimension`` -- integer (default: ``None``), dimension of the space, 
       if ``None``, it is guessed from the ``coords`` if ``coords`` is non
-      empty.
+      empty
```


```diff
                 raise ValueError("dimension(={}) must be provided for"
-                             " the empty polyomino".format(dimension))
+                                 " the empty polyomino".format(dimension))
```


```diff
-Return whether self is strictly inside of other.
+Return whether ``self`` is strictly inside of ``other``.
```

and other similar changes.

```diff
         OUTPUT:
 
-            polyomino
+        polyomino
```


```diff
         return Polyomino(self.frozenset() & other.frozenset(),
-                color=self._color, dimension=self._dimension)
+                         color=self._color, dimension=self._dimension)
```


```diff
         OUTPUT:
 
-            set of 3d polyominoes
+        set of 3d polyominoes
```


```diff
-        Using a Polyomino as input ::
+        Using a Polyomino as input::
```


```diff
-        - ``orientation_preserving`` -- bool (optional, default: ``True``),
-          If True, the group of isometries of the `n`-cube is restricted to
-          those that preserve the orientation, i.e. of determinant 1.
+        - ``orientation_preserving`` -- bool (optional, default: ``True``);
+          if ``True``, the group of isometries of the `n`-cube is restricted
+          to those that preserve the orientation, i.e. of determinant 1
```


```diff
-        S = set()
-        for cano in all_distinct_cano:
-            for t in cano.translated_copies_intersection(box=box):
-                S.add(t)
-        return S
+        return set([t for cano in all_distinct_cano
+                    for t in cano.translated_copies_intersection(box=box)])
```


```diff
     def self_surrounding(self, radius, remove_incomplete_copies=True,
-            ncpus=None):
+                         ncpus=None):
```


```diff
         OUTPUT:
 
-            list of polyominoes
+        list of polyominoes
```


```
            raise Exception('No solution was found with radius={}, '
            'this tile can not be surrounded by itself'.format(radius))
```

I don't like the fact that this raises a general `Exception`. I think it should be more specific like a `ValueError`.

Some of these are PEP8 and could amount to more of bikeshedding, but I think it is good to try and follow them. There are a few other such PEP8 code changes that could be done too beyond those I mentioned here.



---

archive/issue_comments_409403.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-02-11T19:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409403",
    "user": "slabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_409404.json:
```json
{
    "body": "Thanks Travis for your careful reading. I agree with your comments. I will work on it.",
    "created_at": "2020-02-11T19:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409404",
    "user": "slabbe"
}
```

Thanks Travis for your careful reading. I agree with your comments. I will work on it.



---

archive/issue_comments_409405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-15T12:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409405",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_409406.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-03-15T12:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409406",
    "user": "slabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_409407.json:
```json
{
    "body": "Each time, I searched and fixed similar issues in the same file.",
    "created_at": "2020-03-15T12:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409407",
    "user": "slabbe"
}
```

Each time, I searched and fixed similar issues in the same file.



---

archive/issue_comments_409408.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409408",
    "user": "mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_409409.json:
```json
{
    "body": "La patchbot se plaint un petit peu :\n\n```\n+src/sage/combinat/tiling.py:446:15: E701 multiple statements on one line (colon)\n```\n\net ca serait gentil de briser cette ligne en deux.",
    "created_at": "2020-06-25T06:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409409",
    "user": "chapoton"
}
```

La patchbot se plaint un petit peu :

```
+src/sage/combinat/tiling.py:446:15: E701 multiple statements on one line (colon)
```

et ca serait gentil de briser cette ligne en deux.



---

archive/issue_comments_409410.json:
```json
{
    "body": "ok, je fais \u00e7a la semaine prochaine.",
    "created_at": "2020-06-26T15:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409410",
    "user": "slabbe"
}
```

ok, je fais ça la semaine prochaine.



---

archive/issue_comments_409411.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-07-13T10:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409411",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_409412.json:
```json
{
    "body": "J'ai trouv\u00e9 le double statement sur une m\u00eame ligne. Je l'ai mis sur deux lignes s\u00e9par\u00e9es.\n\nJ'ai fait un rebase sur une version plus r\u00e9cente de Sage que j'utilise sur cette machine (9.1.rc1).\n\nNeeds review.\n\nS\u00e9bastien",
    "created_at": "2020-07-13T10:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409412",
    "user": "slabbe"
}
```

J'ai trouvé le double statement sur une même ligne. Je l'ai mis sur deux lignes séparées.

J'ai fait un rebase sur une version plus récente de Sage que j'utilise sur cette machine (9.1.rc1).

Needs review.

Sébastien



---

archive/issue_comments_409413.json:
```json
{
    "body": "ok, allons-y",
    "created_at": "2020-07-14T14:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409413",
    "user": "chapoton"
}
```

ok, allons-y



---

archive/issue_comments_409414.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-14T14:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409414",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_409415.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-19T07:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28923#issuecomment-409415",
    "user": "vbraun"
}
```

Resolution: fixed
