# Issue 29325: .homebrew-build-env: Set CPATH instead of CPPFLAGS

Issue created by migration from https://trac.sagemath.org/ticket/29562

Original creator: mkoeppe

Original creation time: 2020-04-24 05:45:13

CC:  slelievre jhpalmieri dimpase

This is to fix a build error of `pillow` that arises when /usr/local/include/zip.h shadows an include file "Zip.h"


---

Comment by mkoeppe created at 2020-04-24 05:53:23

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-04-24 06:36:10

should one be rather using `brew sh` shell?


---

Comment by mkoeppe created at 2020-04-24 06:40:26

Sorry, got distracted - here's the branch
----
New commits:


---

Comment by mkoeppe created at 2020-04-24 06:43:22

Replying to [comment:4 dimpase]:
> should one be rather using `brew sh` shell?
I don't use that, but it's an interesting option.


---

Comment by mkoeppe created at 2020-04-24 13:43:45

Needs review


---

Comment by jhpalmieri created at 2020-04-24 23:54:24

This works for me without `libzip` installed and also with it installed. If `libzip` is installed, then pillow fails to build without this branch. So I think it's ready to go.


---

Comment by jhpalmieri created at 2020-04-24 23:54:24

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2020-04-25 00:09:01

I tried running `brew sh` and not sourcing `.homebrew-build-env`, and Sage's configure file did not detect some packages: it suggested running

```
$ brew install cmake gsl isl gd ppl r
```

whereas it should ordinarily only suggest

```
$ brew install cmake ppl
```



---

Comment by mkoeppe created at 2020-04-25 00:12:42

Thanks!

Yes, let's postpone checking about `brew sh` until after the 9.1 release


---

Comment by vbraun created at 2020-04-26 22:45:59

Resolution: fixed


---

Comment by mkoeppe created at 2020-04-28 16:54:54

Follow-up = #29607
