# Issue 19276: remove expired deprecations

Issue created by migration from Trac.

Original creator: zabrocki

Original creation time: 2015-11-03 04:13:35

CC:  fwclarke andrew.mathas aschilling darij vivianepons hivert chapoton chrisjamesberg saliola ghseeli sage-combinat zabrocki nthiery alubovsky tscrim simonking bsalisbury1 vdelecroix sstarosta ncohen brett

A grep of the word `deprecation` in the source code indicates that there are many functions which have expired and may be removed.  We will remove those deprecations which have been in Sage for at least one year.


---

Comment by jdemeyer created at 2015-11-03 07:10:14

-1 to this ticket. There is no reason to just remove all deprecations like that. Those deprecations _may_ be removed, that's true. But does this imply that it's the right thing to do? Not always. I doubt that any one person really understands all the deprecated code in Sage and you obviously should not remove deprecations that you don't understand.

Besides that, this ticket is simply too broad. If you want to remove specific deprecations, just remove those. But not all at once.


---

Comment by zabrocki created at 2015-11-03 10:47:20

Changing component from performance to combinatorics.


---

Comment by zabrocki created at 2015-11-03 10:47:20

Fair enough. At least `sage/combinat` merits a bit of cleanup and I do know something about those deprecations.


---

Comment by zabrocki created at 2015-11-03 10:47:20

Changing type from defect to enhancement.


---

Comment by jmantysalo created at 2015-11-03 11:19:26

`meet_matrix()` and `join_matrix()` on `posets.py` were badly deprecated, see #17356. Anyway, there have been so much time that they can be be deleted. (They are of course available, but on (semi)lattices, not on posets.)


---

Comment by zabrocki created at 2015-11-03 11:40:31

Replying to [comment:3 jmantysalo]:
> `meet_matrix()` and `join_matrix()` on `posets.py` were badly deprecated, see #17356. Anyway, there have been so much time that they can be be deleted. (They are of course available, but on (semi)lattices, not on posets.)
6.5 was released less than a year ago so those can stay a bit longer.


---

Comment by zabrocki created at 2015-11-03 14:55:35

Changing keywords from "" to "deprecate".


---

Comment by zabrocki created at 2015-11-03 14:55:35

I'll give a full list of relevant tickets soon.  I'll also add to the cc list to ensure that everyone is aware that these functions are disappearing.  I decided my rule was not to touch anything that was deprecated in sage 6.4 or later.  There is enough here for the moment.
----
Last 10 new commits:


---

Comment by zabrocki created at 2015-11-03 15:17:17

I will still have to go through the documentation and ensure that removed code does not appear there (this was just a first pass).

I just added a large number of people to the cc list hoping that they will all check that the code that they are responsible for deprecating really should be removed.

split_nk.py and choose_nk.py are in ticket #18674


---

Comment by tscrim created at 2015-11-03 15:42:20

I can vouch for everything except that in designs. Nathann, Vincent, I think those are more in your area.


---

Comment by jdemeyer created at 2015-11-03 15:42:34

NOTE: whenever `deprecated_callable_import()` is used (as opposed to other kinds of deprecation), you should only remove the functionality from the global namespace but not remove it completely.

For example, `TransitiveIdeal` itself is not deprecated, it's just deprecated within `src/sage/combinat/all.py`. Especially since the deprecation warning says "This class soon will not be available in that way anymore", nothing indicates that the whole class will be removed.


---

Comment by zabrocki created at 2015-11-03 16:49:24

> nothing indicates that the whole class will be removed.
I can restore it if you (or Nicolas or Florent) think that it should remain, however I was following the instruction:

```
-- Once the deprecation has been there for enough time: delete
-  ``TransitiveIdeal`` and ``TransitiveIealGraded``.
```

that was in the file.  Note that I did not delete `SearchForest` for that reason.


---

Comment by tscrim created at 2015-11-03 16:58:26

These classes were deprecated in favor of `RecursivelyEnumeratedSet` in #6637; so we are okay to remove them. (Just for reference, `SearchForest` is waiting on #16351.)


---

Comment by jdemeyer created at 2015-11-03 17:17:41

Replying to [comment:10 tscrim]:
> These classes were deprecated in favor of `RecursivelyEnumeratedSet` in #6637
No, they were not. From #6637 (emphasis mine):

> 2. Deprecate `TransitiveIdeal`, `TransitiveIdealGraded` and `SearchForest` *as entry point*.
>
> B. `TransitiveIdeal` and `TransitiveIealGraded` *are used* in the code of `sage/combinat`, `sage/categories` and `sage/groups` at least. These should be updated to use `RecursivelyEnumeratedSet` for speed improvements and also to avoid issues explained in C below. See #16352.

Those classes should have been deprecated in #16352, but they weren't.


---

Comment by git created at 2015-11-03 17:51:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-03 17:53:13

I haven't done a test all yet, but I did find them in sage/categories.  They can be deprecated and removed in other tickets.


---

Comment by jdemeyer created at 2015-11-04 08:03:58

You can still remove `TransitiveIdeal` and friends from `src/sage/combinat/all.py` (that's the point of the `deprecated_callable_import`).


---

Comment by git created at 2015-11-04 13:55:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-04 14:02:14

I also restored the comment (that was removed in #16352 because it looked like it had been addressed) in backtrack.py that there is an intention that `TransitiveIdeal` and `TransitiveIdealGraded` should eventually be deprecated.  At least `TransitiveIdeal` is still used in `sage/categories/finitely_generated_semigroups.py` and so it can't be deleted completely.  I'd start the deprecation here, but that runs contrary to the purpose of this ticket.


---

Comment by git created at 2015-11-06 13:55:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-11-06 18:09:22

Branch went red (just saying).


---

Comment by git created at 2015-11-07 14:04:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-07 14:12:54

That last commit was a merge with develop.

I'm not quite sure what should be done with the deprecated code in `words/alphabet.py` from #8920 since deleting that code raises unpickling errors.


---

Comment by tscrim created at 2015-11-07 14:30:43

Replying to [comment:20 zabrocki]:
> I'm not quite sure what should be done with the deprecated code in `words/alphabet.py` from #8920 since deleting that code raises unpickling errors.

We probably could setup a `register_unpickle_override` going to a slightly tweaked `OrderedAlphabet_backward_compatibility` to handle those old pickles.


---

Comment by git created at 2015-11-07 14:59:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-11-07 15:02:45

1) Why are we deprecating `RestrictedPartitions`? From the way it looks, this functionality is not implemented elsewhere in its full strength (i.e., fixing both a set and a length).

2) Why are we undeprecating `TransitiveIdeal`? Not deleting it is fine, but removing the deprecation warnings?

3) I have just realized that `CyclicPermutations` of a multiset misbehave: e.g., the cardinality method is inherited from `Permutations` and thus disagrees with the list method. What should we do about this?

4) Another lost child:

```
sage: Permutations(["c","a","t"])[0]
['c', 'a', 't']
sage: _ in Permutations()
False
```

(Yet, the class of `Permutations(["c","a","t"])[0]` inherits from `Permutations`.)


---

Comment by zabrocki created at 2015-11-07 18:04:39

Replying to [comment:23 darij]:
> 1) Why are we deprecating `RestrictedPartitions`? From the way it looks, this functionality is not implemented elsewhere in its full strength (i.e., fixing both a set and a length).

You may be right about this.  There is a warning note that I may not have heeded carefully and I can restore those functions if the current `Partitions` function doesn't have this functionality.  I will check carefully and restore it if need be.

> 2) Why are we undeprecating `TransitiveIdeal`? Not deleting it is fine, but removing the deprecation warnings?

The deprecation warnings were only an indication that the function is being removed from the global name space since there were previously no deprecation warnings if you just imported the functions and started using them.  I restored a comment that `TransitiveIdeal` and `TransitiveIdealGraded` do need to be deprecated.

> 3) I have just realized that `CyclicPermutations` of a multiset misbehave: e.g., the cardinality method is inherited from `Permutations` and thus disagrees with the list method. What should we do about this?
> 
> 4) Another lost child:
> {{{
> sage: Permutations(["c","a","t"])[0]
> ['c', 'a', 't']
> sage: _ in Permutations()
> False
> }}}
> (Yet, the class of `Permutations(["c","a","t"])[0]` inherits from `Permutations`.)

Yes.  I agree that both of these are problems.  I tested:

```
sage: len(CyclicPermutations(range(4)))==CyclicPermutations(range(4)).cardinality()
False
```



---

Comment by ncohen created at 2015-11-07 18:53:55

> I can vouch for everything except that in designs. Nathann, Vincent, I think those are more in your area.

No problem with the current modifications to the design files. Thanks for doing this, by the way.

Nathann


---

Comment by git created at 2015-11-16 02:37:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-16 02:42:10

I am not convinced that the code in `combinat/words` from #16553 was meant to be removed and I am leaving it.  I've done a search through the documentation and it seems all is removed and all tests pass now.


---

Comment by zabrocki created at 2015-11-16 02:42:10

Changing status from new to needs_review.


---

Comment by git created at 2015-11-16 02:53:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-11-16 03:07:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-16 03:12:34

I had forgotten that I had not restored the `RestrictedPartitions` in `combinat/partitions.py`.  Additional functionality needs to be added to `Partitions` before this can be removed.


---

Comment by vdelecroix created at 2015-11-23 14:54:02

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2015-11-23 14:54:02

Apparently, you removed a global import and it causes trouble

```
**********************************************************************
6 items had failures:
   4 of   5 in sage.combinat.partition.RestrictedPartitions
   4 of   5 in sage.combinat.partition.RestrictedPartitions_nsk.__contains__
   1 of   3 in sage.combinat.partition.RestrictedPartitions_nsk.__init__
   1 of   2 in sage.combinat.partition.RestrictedPartitions_nsk._repr_
   2 of   3 in sage.combinat.partition.RestrictedPartitions_nsk.cardinality
   2 of   3 in sage.combinat.partition.RestrictedPartitions_nsk.list
    [1142 tests, 14 failures, 26.59 s]
----------------------------------------------------------------------
sage -t --long src/sage/combinat/partition.py  # 14 doctests failed
----------------------------------------------------------------------
```



---

Comment by git created at 2015-11-24 12:26:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-11-24 12:27:58

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-11-26 12:37:18

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2015-11-26 12:37:18

You removed some deprecation released in sage-6.4 (from 04/14/15)... One year deprecation implies that this should not be merged until 04/14/16 which is in 6 months. This concerns this modification

```
-        if compact is not None:
-            from sage.misc.superseded import deprecation
-            deprecation(16933, 'compact argument is deprecated.')
```



---

Comment by jdemeyer created at 2015-11-26 12:43:08

Sage 6.4 was released 14 november 2014, so it's more than 1 year ago.


---

Comment by jdemeyer created at 2015-11-26 12:43:08

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-11-26 12:43:27

See [http://www.sagemath.org/changelogs/sage-6.4.txt](http://www.sagemath.org/changelogs/sage-6.4.txt)


---

Comment by jdemeyer created at 2015-11-26 12:46:30

14 april 2015 is the release date of [Sage 6.6](http://www.sagemath.org/changelogs/sage-6.6.txt)


---

Comment by vdelecroix created at 2015-11-26 12:51:41

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2015-11-26 12:51:41

Thanks Jeroen for the corrections! I used the dates from trac milestones that were obviously wrong. I fixed them. And I can set this ticket to positive review!


---

Comment by vbraun created at 2015-11-26 18:23:48

Resolution: fixed
