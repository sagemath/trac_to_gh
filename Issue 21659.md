# Issue 21659: Error installing autotools spkg on Cygwin

archive/issues_021659.json:
```json
{
    "body": "CC:  mkoeppe dimpase\n\nWhen installing the autotools spkg on Cygwin it runs for a while, then fails at:\n\n\n```\n[autotools-20141105] [ \"$SAGE_KEEP_BUILT_SPKGS\" = yes ] || rm -rf autoconf-2.69/*\n[autotools-20141105] export MAKE='make -j1' ; \\\n[autotools-20141105] export AUTOCONF_VERSION=2.59 ; \\\n[autotools-20141105] cd automake-1.9 && \\\n[autotools-20141105]     ./configure --prefix=\"/home/embray/src/sagemath/sage/local/automake-1.9\" && \\\n[autotools-20141105]     $MAKE && $MAKE install\n[autotools-20141105] checking build system type... lib/config.guess: unable to guess system type\n[autotools-20141105]\n[autotools-20141105] This script, last modified 2004-06-24, has failed to recognize\n[autotools-20141105] the operating system you are using. It is advised that you\n[autotools-20141105] download the most up to date version of the config scripts from\n[autotools-20141105]\n[autotools-20141105]     ftp://ftp.gnu.org/pub/gnu/config/\n[autotools-20141105]\n[autotools-20141105] If the version you run (lib/config.guess) is already up to date, please\n[autotools-20141105] send the following data and any information you think might be\n[autotools-20141105] pertinent to <config-patches@gnu.org> in order to provide the needed\n[autotools-20141105] information to handle your system.\n[autotools-20141105]\n[autotools-20141105] config.guess timestamp = 2004-06-24\n[autotools-20141105]\n[autotools-20141105] uname -m = x86_64\n[autotools-20141105] uname -r = 2.5.1(0.297/5/3)\n[autotools-20141105] uname -s = CYGWIN_NT-10.0\n[autotools-20141105] uname -v = 2016-04-21 22:14\n[autotools-20141105]\n[autotools-20141105] /usr/bin/uname -p = unknown\n[autotools-20141105] /bin/uname -X     =\n[autotools-20141105]\n[autotools-20141105] hostinfo               =\n[autotools-20141105] /bin/universe          =\n[autotools-20141105] /usr/bin/arch -k       =\n[autotools-20141105] /bin/arch              = x86_64\n[autotools-20141105] /usr/bin/oslevel       =\n[autotools-20141105] /usr/convex/getsysinfo =\n[autotools-20141105]\n[autotools-20141105] UNAME_MACHINE = x86_64\n[autotools-20141105] UNAME_RELEASE = 2.5.1(0.297/5/3)\n[autotools-20141105] UNAME_SYSTEM  = CYGWIN_NT-10.0\n[autotools-20141105] UNAME_VERSION = 2016-04-21 22:14\n[autotools-20141105] configure: error: cannot guess build type; you must specify one\n[autotools-20141105] make[2]: *** [Makefile:235: /home/embray/src/sagemath/sage/local/automake-1.9] Error 1\n[autotools-20141105] make[2]: Leaving directory '/home/embray/src/sagemath/sage/local/var/tmp/sage/build/autotools-20141105/build'\n```\n\n\nupon trying to install automake 1.9.\n\nThis also left the autoreconf script installed by sage broken:\n\n\n```\nautoreconf: Entering directory `.'\nautoreconf: configure.ac: not using Gettext\nautoreconf: running: aclocal -I m4 --output=aclocal.m4t\n/home/embray/src/sagemath/sage/local/bin/aclocal: line 25: /home/embray/src/sagemath/sage/local/automake-1.15/bin/aclocal: No such file or directory\nautoreconf: aclocal failed with exit status: 127\n```\n\n\nIt would be nice if sage packages didn't actually install anything into `$SAGE_LOCAL` until it has successfully built.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21896\n\n",
    "created_at": "2016-11-18T09:56:19Z",
    "labels": [
        "porting: Cygwin",
        "major",
        "bug"
    ],
    "title": "Error installing autotools spkg on Cygwin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21659",
    "user": "embray"
}
```
CC:  mkoeppe dimpase

When installing the autotools spkg on Cygwin it runs for a while, then fails at:


```
[autotools-20141105] [ "$SAGE_KEEP_BUILT_SPKGS" = yes ] || rm -rf autoconf-2.69/*
[autotools-20141105] export MAKE='make -j1' ; \
[autotools-20141105] export AUTOCONF_VERSION=2.59 ; \
[autotools-20141105] cd automake-1.9 && \
[autotools-20141105]     ./configure --prefix="/home/embray/src/sagemath/sage/local/automake-1.9" && \
[autotools-20141105]     $MAKE && $MAKE install
[autotools-20141105] checking build system type... lib/config.guess: unable to guess system type
[autotools-20141105]
[autotools-20141105] This script, last modified 2004-06-24, has failed to recognize
[autotools-20141105] the operating system you are using. It is advised that you
[autotools-20141105] download the most up to date version of the config scripts from
[autotools-20141105]
[autotools-20141105]     ftp://ftp.gnu.org/pub/gnu/config/
[autotools-20141105]
[autotools-20141105] If the version you run (lib/config.guess) is already up to date, please
[autotools-20141105] send the following data and any information you think might be
[autotools-20141105] pertinent to <config-patches@gnu.org> in order to provide the needed
[autotools-20141105] information to handle your system.
[autotools-20141105]
[autotools-20141105] config.guess timestamp = 2004-06-24
[autotools-20141105]
[autotools-20141105] uname -m = x86_64
[autotools-20141105] uname -r = 2.5.1(0.297/5/3)
[autotools-20141105] uname -s = CYGWIN_NT-10.0
[autotools-20141105] uname -v = 2016-04-21 22:14
[autotools-20141105]
[autotools-20141105] /usr/bin/uname -p = unknown
[autotools-20141105] /bin/uname -X     =
[autotools-20141105]
[autotools-20141105] hostinfo               =
[autotools-20141105] /bin/universe          =
[autotools-20141105] /usr/bin/arch -k       =
[autotools-20141105] /bin/arch              = x86_64
[autotools-20141105] /usr/bin/oslevel       =
[autotools-20141105] /usr/convex/getsysinfo =
[autotools-20141105]
[autotools-20141105] UNAME_MACHINE = x86_64
[autotools-20141105] UNAME_RELEASE = 2.5.1(0.297/5/3)
[autotools-20141105] UNAME_SYSTEM  = CYGWIN_NT-10.0
[autotools-20141105] UNAME_VERSION = 2016-04-21 22:14
[autotools-20141105] configure: error: cannot guess build type; you must specify one
[autotools-20141105] make[2]: *** [Makefile:235: /home/embray/src/sagemath/sage/local/automake-1.9] Error 1
[autotools-20141105] make[2]: Leaving directory '/home/embray/src/sagemath/sage/local/var/tmp/sage/build/autotools-20141105/build'
```


upon trying to install automake 1.9.

This also left the autoreconf script installed by sage broken:


```
autoreconf: Entering directory `.'
autoreconf: configure.ac: not using Gettext
autoreconf: running: aclocal -I m4 --output=aclocal.m4t
/home/embray/src/sagemath/sage/local/bin/aclocal: line 25: /home/embray/src/sagemath/sage/local/automake-1.15/bin/aclocal: No such file or directory
autoreconf: aclocal failed with exit status: 127
```


It would be nice if sage packages didn't actually install anything into `$SAGE_LOCAL` until it has successfully built.

Issue created by migration from https://trac.sagemath.org/ticket/21896





---

archive/issue_comments_300817.json:
```json
{
    "body": "Manually going into the automake-1.9 source directory and copying the `config.guess` from my system's `/usr/share/automake-1.15` allowed it to build.\n\nActually, ended up just\n\n\n```\nfind . -name 'config.guess' -exec cp /usr/share/automake-1.15/config.guess {} \\;\n```\n\n\nI wonder if some variant of this wouldn't be good to include in the build scripts for the spkg (without hard-coding `automake-1.15` of course).  In other words, just take the latest `config.guess` from the system, if it exists.",
    "created_at": "2016-11-18T10:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300817",
    "user": "embray"
}
```

Manually going into the automake-1.9 source directory and copying the `config.guess` from my system's `/usr/share/automake-1.15` allowed it to build.

Actually, ended up just


```
find . -name 'config.guess' -exec cp /usr/share/automake-1.15/config.guess {} \;
```


I wonder if some variant of this wouldn't be good to include in the build scripts for the spkg (without hard-coding `automake-1.15` of course).  In other words, just take the latest `config.guess` from the system, if it exists.



---

archive/issue_comments_300818.json:
```json
{
    "body": "After a closer look at the different `config.guess` scripts, the old ones would have worked on 32-bit Cygwin, but not on 64-bit Cygwin (they lack wildcard patterns that would match \"x86_64\" as the machine name).",
    "created_at": "2016-11-18T10:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300818",
    "user": "embray"
}
```

After a closer look at the different `config.guess` scripts, the old ones would have worked on 32-bit Cygwin, but not on 64-bit Cygwin (they lack wildcard patterns that would match "x86_64" as the machine name).



---

archive/issue_comments_300819.json:
```json
{
    "body": "Sage provides more or less up to date config.* scripts.\nYou can try to modify the spkg-install script to copy them at build time to let the build proceed...\nBut maybe installing autotools on a cygwin setup is not the best idea :/",
    "created_at": "2016-11-18T10:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300819",
    "user": "jpflori"
}
```

Sage provides more or less up to date config.* scripts.
You can try to modify the spkg-install script to copy them at build time to let the build proceed...
But maybe installing autotools on a cygwin setup is not the best idea :/



---

archive/issue_comments_300820.json:
```json
{
    "body": "Replying to [comment:3 jpflori]:\n> Sage provides more or less up to date config.* scripts.\n\nProvides how?  \n\n> But maybe installing autotools on a cygwin setup is not the best idea :/\n\nWhat would make you say that?",
    "created_at": "2016-11-18T10:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300820",
    "user": "embray"
}
```

Replying to [comment:3 jpflori]:
> Sage provides more or less up to date config.* scripts.

Provides how?  

> But maybe installing autotools on a cygwin setup is not the best idea :/

What would make you say that?



---

archive/issue_comments_300821.json:
```json
{
    "body": "Replying to [comment:4 embray]:\n> Replying to [comment:3 jpflori]:\n> > Sage provides more or less up to date config.* scripts.\n> \n> Provides how?  \nIn $SAGE_ROOT/config/\n> \n> > But maybe installing autotools on a cygwin setup is not the best idea :/\n> \n> What would make you say that?\nYou could autoreconf on a Linux machine, ok that implies maintaining two systems and communicating btw them...",
    "created_at": "2016-11-18T10:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300821",
    "user": "jpflori"
}
```

Replying to [comment:4 embray]:
> Replying to [comment:3 jpflori]:
> > Sage provides more or less up to date config.* scripts.
> 
> Provides how?  
In $SAGE_ROOT/config/
> 
> > But maybe installing autotools on a cygwin setup is not the best idea :/
> 
> What would make you say that?
You could autoreconf on a Linux machine, ok that implies maintaining two systems and communicating btw them...



---

archive/issue_comments_300822.json:
```json
{
    "body": "For now I hand-edited the Makefile.build to copy my working config.guess to the proper place when building all the automakes, so I've kicked off that build.\n\nIn the meantime I've edited `spkg-write-makefile` (will post a patch soon) to add such a step to the makefile (the details are subject to debate; I haven't thought it through fully).  Once I've bootstrapped my $SAGE_LOCAL with a working autotools build I can re-run `spkg-write-makefile` to provide an updated `Makefile.build` as well.",
    "created_at": "2016-11-18T12:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300822",
    "user": "embray"
}
```

For now I hand-edited the Makefile.build to copy my working config.guess to the proper place when building all the automakes, so I've kicked off that build.

In the meantime I've edited `spkg-write-makefile` (will post a patch soon) to add such a step to the makefile (the details are subject to debate; I haven't thought it through fully).  Once I've bootstrapped my $SAGE_LOCAL with a working autotools build I can re-run `spkg-write-makefile` to provide an updated `Makefile.build` as well.



---

archive/issue_comments_300823.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-13T14:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300823",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_300824.json:
```json
{
    "body": "Outdated - we removed the spkg",
    "created_at": "2020-08-13T14:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300824",
    "user": "mkoeppe"
}
```

Outdated - we removed the spkg



---

archive/issue_comments_300825.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-15T07:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300825",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_300826.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2020-08-31T15:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21659#issuecomment-300826",
    "user": "embray"
}
```

Resolution: wontfix
