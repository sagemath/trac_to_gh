# Issue 17094: Numerical noise is back in src/sage/matrix/matrix_double_dense.pyx

Issue created by migration from https://trac.sagemath.org/ticket/17331

Original creator: darij

Original creation time: 2014-11-13 04:31:21

CC:  vbraun jdemeyer

Keywords: numerical noise, doctest failure


```
sage -t src/sage/matrix/matrix_double_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_double_dense.pyx", line 1012, in sage.matrix.matrix_double_dense.Matrix_double_dense.singular_values
Failed example:
    A.singular_values(eps=None)  # abs tol 5e-16
Expected:
    [1.7953720595619975, 0.38027524595503703, 0.04473854875218107, 0.0037223122378911614, 0.0002330890890217751, 1.116335748323284e-05, 4.082376110397296e-07, 1.1228610675717613e-08, 2.2519645713496478e-10, 3.1113486853814003e-12, 2.6500422260778388e-14, 9.87312834948426e-17]
Got:
    [1.7953720595619969,
     0.3802752459550371,
     0.04473854875218114,
     0.003722312237891189,
     0.00023308908902178912,
     1.1163357483229223e-05,
     4.0823761103637633e-07,
     1.1228610665566416e-08,
     2.251964510803022e-10,
     3.1113474636612192e-12,
     2.6497213779939672e-14,
     1.048419319427735e-16]
Tolerance exceeded in 1 of 12:
    1.7953720595619975 vs 1.7953720595619969, tolerance 6e-16 > 5e-16
**********************************************************************
File "src/sage/matrix/matrix_double_dense.pyx", line 1014, in sage.matrix.matrix_double_dense.Matrix_double_dense.singular_values
Failed example:
    A.singular_values(eps='auto')  # abs tol 5e-16
Expected:
    [1.7953720595619975, 0.38027524595503703, 0.04473854875218107, 0.0037223122378911614, 0.0002330890890217751, 1.116335748323284e-05, 4.082376110397296e-07, 1.1228610675717613e-08, 2.2519645713496478e-10, 3.1113486853814003e-12, 2.6500422260778388e-14, 0.0]
Got:
    [1.7953720595619969,
     0.3802752459550371,
     0.04473854875218114,
     0.003722312237891189,
     0.00023308908902178912,
     1.1163357483229223e-05,
     4.0823761103637633e-07,
     1.1228610665566416e-08,
     2.251964510803022e-10,
     3.1113474636612192e-12,
     2.6497213779939672e-14,
     0.0]
Tolerance exceeded in 1 of 12:
    1.7953720595619975 vs 1.7953720595619969, tolerance 6e-16 > 5e-16
**********************************************************************
File "src/sage/matrix/matrix_double_dense.pyx", line 1016, in sage.matrix.matrix_double_dense.Matrix_double_dense.singular_values
Failed example:
    A.singular_values(eps=1e-4)  # abs tol 5e-16
Expected:
    [1.7953720595619975, 0.38027524595503703, 0.04473854875218107, 0.0037223122378911614, 0.0002330890890217751, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Got:
    [1.7953720595619969,
     0.3802752459550371,
     0.04473854875218114,
     0.003722312237891189,
     0.00023308908902178912,
     0.0,
     0.0,
     0.0,
     0.0,
     0.0,
     0.0,
     0.0]
Tolerance exceeded in 1 of 12:
    1.7953720595619975 vs 1.7953720595619969, tolerance 6e-16 > 5e-16
**********************************************************************
1 item had failures:
   3 of  31 in sage.matrix.matrix_double_dense.Matrix_double_dense.singular_values
    [642 tests, 3 failures, 1.54 s]
```

This is on a virtualized Ubuntu

```
darij@travis-virtualbox:~/gitsage$ uname -s -r -v
Linux 3.2.0-70-generic #105-Ubuntu SMP Wed Sep 24 19:49:46 UTC 2014
```

on a Win7 64bit host.


---

Comment by vbraun created at 2014-11-13 14:33:51

Can you post a patch that increases the tolerance suitably?


---

Comment by darij created at 2014-11-13 18:43:29

OK, done. But is this really the right thing to do, or could it be that there is an actual lack of precision that the failing doctests expose?
----
New commits:


---

Comment by darij created at 2014-11-13 18:43:29

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-11-13 18:52:29

This is just fallout from printing more digits #16858, nothing serious.


---

Comment by vbraun created at 2014-11-13 18:52:41

Changing status from needs_review to positive_review.


---

Comment by darij created at 2014-11-13 19:03:34

Thank you!


---

Comment by vbraun created at 2014-11-14 12:08:13

Resolution: fixed
