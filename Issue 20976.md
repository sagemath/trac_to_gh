# Issue 20976: Power series, pade, rational reconstruction

Issue created by migration from https://trac.sagemath.org/ticket/21213

Original creator: edgarcosta

Original creation time: 2016-08-10 19:37:50

Keywords: power Series, pade, rational reconstruction

Hello,

Over a an exact ring one should implement the pade approximation, using a modified extended gcd, aka, rational reconstruction.

Here is a smple modification of https://github.com/sagemath/sage/blob/master/src/sage/rings/polynomial/polynomial_zmod_flint.pyx:
where m should be by default m = T^prec



```
def rational_reconstruct_poly(p, m, n_deg = 0, d_deg = 0):
    """
    Construct a rational function n/d such that p*d is equivalent to n
    modulo m.
    
    returns (n, d)
    
    Examples:
        sage: P.<z> = QQ[]
        sage: p = -z^16 - z^15 - z^14 + z^13 + z^12 + z^11 - z^5 - z^4 - z^3 + z^2 + z + 1
        sage: m = z^21
        sage: n, d = rational_reconstruct_poly(p, m); 
        sage: print n, d
        z^4 + 2*z^3 + 3*z^2 + 2*z + 1 z^10 + z^9 + z^8 + z^7 + z^6 + z^5 + z^4 +
        z^3 + z^2 + z + 1
        sage: print(p*d) % m == n
        True
    """
    # n and d are unique if m.degree() > (n.degree() + d.degree())
    if n_deg < 0 or d_deg < 0:
        raise ValueError("The degree bounds n_deg and d_deg should be positive.")

    if n_deg == 0:
        n_deg = (m.degree() - 1)//2
    if d_deg == 0:
        d_deg = (m.degree() - 1)//2
        
    P = p.parent()
    #run XGCD until degree of
    s0 = P(0);
    t0 = P(1);
    s1 = P(m);
    t1 = p % P(m);
    
    while n_deg < t1.degree():
        #not optimal divrem
        q = s1 // t1;
        r1 = s1 % t1;
        r0 = s0 - q*t0;
        s0 = t0
        s1 = t1
        t0 = r0
        t1 = r1
        
    assert(t0 != 0)
    if d_deg < t0.degree():
        raise ValueError("could not complete rational reconstruction")
    # make the denominator monic
    c = t0.leading_coefficient()
    t0 = t0.monic()
    t1 = t1/c

    return t1, t0
```




---

Comment by edgarcosta created at 2017-08-24 22:48:13

see #21212


---

Comment by chapoton created at 2017-09-11 12:57:08

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-09-11 12:57:35

can we close this one ? if yes, please set to positive review.


---

Comment by edgarcosta created at 2017-09-11 12:59:08

Changing status from needs_review to positive_review.


---

Comment by edgarcosta created at 2017-09-11 12:59:08

Yes, you can close this one.
I fixed #21212 by doing what I proposed in here.


---

Comment by embray created at 2017-12-12 08:23:33

Resolution: wontfix
