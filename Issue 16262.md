# Issue 16262: Cheap speedup in the OA recursive constructions

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2014-06-19 14:57:07

CC:  vdelecroix

There is a lot to save by not trying to build an Orthogonal Array when ... we already know that we are going to fail.

This is the case when `orthogonal_arrays(k-1,n)` was called and returned "Unknown" : there is no point in trying to build an `orthogonal_array(k,n)` later.

This can be cheaply fixed by querying the cache before trying to build the design.

The "clean" fix would be to introduce a `is_available` along with the `existence` parameter, but this interface will probably change very soon so it is not the right time to touch all functions and deal with all combinations of existence/available/etc because of that. Besides, the current fix already does the job quite well.

This will all become an Object Oriented Hell quite soon anyway .... `:-P`

Nathann


---

Comment by ncohen created at 2014-06-19 15:01:24

Oh. And this patch also renames some private methods in a more "object oriented" way. Maybe it will become a real object, someday. Or be rewritten in Cython. 

Life.

You never know.

Nathann


---

Comment by ncohen created at 2014-06-19 15:02:47

Changing status from new to needs_review.


---

Comment by git created at 2014-06-19 15:03:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-25 10:57:00

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2014-06-25 10:57:00

Needs non-trivial rebase over #16347.


---

Comment by ncohen created at 2014-06-25 11:51:38

Rebased !

Nathann


---

Comment by ncohen created at 2014-06-25 11:51:38

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-06-25 11:52:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-06-25 12:08:50

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2014-06-25 13:27:00

Hi Nathann,

I propose to
- move this over #16423
- remove the `# long time` for the `MOLS_table` test
- change 15 to 20 or 30 in the `MOLS_table`
Timings are now

```
sage: from sage.combinat.designs.latin_squares import MOLS_table
sage: from time import time
sage: t0 = time(); MOLS_table(30); t1 = time()
...
sage: print t1 - t0
3.6996819973
```

Impressive!

Vincent


---

Comment by ncohen created at 2014-06-25 13:33:52

Yo !

> - move this over #16423

I will do this as soon as #16423 is reviewed.

> - remove the `# long time` for the `MOLS_table` test
> - change 15 to 20 or 30 in the `MOLS_table`

No need. We will have to set it back the way it is now as soon as #16500 is reviewed, unless there is a way to save time there.

> Timings are now
> {{{
> sage: from sage.combinat.designs.latin_squares import MOLS_table
> sage: from time import time
> sage: t0 = time(); MOLS_table(30); t1 = time()
> ...
> sage: print t1 - t0
> 3.6996819973
> }}}
> Impressive!

Too bad it will not last `:-/`

Nathann


---

Comment by git created at 2014-06-25 13:39:27

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2014-06-25 14:26:47

Good to me!

Vincent


---

Comment by vdelecroix created at 2014-06-25 14:26:47

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-06-26 19:38:09

Resolution: fixed
