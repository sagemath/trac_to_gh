# Issue 16262: Cheap speedup in the OA recursive constructions

archive/issues_016262.json:
```json
{
    "body": "CC:  vdelecroix\n\nThere is a lot to save by not trying to build an Orthogonal Array when ... we already know that we are going to fail.\n\nThis is the case when `orthogonal_arrays(k-1,n)` was called and returned \"Unknown\" : there is no point in trying to build an `orthogonal_array(k,n)` later.\n\nThis can be cheaply fixed by querying the cache before trying to build the design.\n\nThe \"clean\" fix would be to introduce a `is_available` along with the `existence` parameter, but this interface will probably change very soon so it is not the right time to touch all functions and deal with all combinations of existence/available/etc because of that. Besides, the current fix already does the job quite well.\n\nThis will all become an Object Oriented Hell quite soon anyway .... `:-P`\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/16499\n\n",
    "created_at": "2014-06-19T14:57:07Z",
    "labels": [
        "combinatorial designs",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Cheap speedup in the OA recursive constructions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16262",
    "user": "ncohen"
}
```
CC:  vdelecroix

There is a lot to save by not trying to build an Orthogonal Array when ... we already know that we are going to fail.

This is the case when `orthogonal_arrays(k-1,n)` was called and returned "Unknown" : there is no point in trying to build an `orthogonal_array(k,n)` later.

This can be cheaply fixed by querying the cache before trying to build the design.

The "clean" fix would be to introduce a `is_available` along with the `existence` parameter, but this interface will probably change very soon so it is not the right time to touch all functions and deal with all combinations of existence/available/etc because of that. Besides, the current fix already does the job quite well.

This will all become an Object Oriented Hell quite soon anyway .... `:-P`

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/16499





---

archive/issue_comments_212701.json:
```json
{
    "body": "Oh. And this patch also renames some private methods in a more \"object oriented\" way. Maybe it will become a real object, someday. Or be rewritten in Cython. \n\nLife.\n\nYou never know.\n\nNathann",
    "created_at": "2014-06-19T15:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212701",
    "user": "ncohen"
}
```

Oh. And this patch also renames some private methods in a more "object oriented" way. Maybe it will become a real object, someday. Or be rewritten in Cython. 

Life.

You never know.

Nathann



---

archive/issue_comments_212702.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-19T15:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212702",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_212703.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-19T15:03:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212703",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212704.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-25T10:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212704",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212705.json:
```json
{
    "body": "Needs non-trivial rebase over #16347.",
    "created_at": "2014-06-25T10:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212705",
    "user": "vdelecroix"
}
```

Needs non-trivial rebase over #16347.



---

archive/issue_comments_212706.json:
```json
{
    "body": "Rebased !\n\nNathann",
    "created_at": "2014-06-25T11:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212706",
    "user": "ncohen"
}
```

Rebased !

Nathann



---

archive/issue_comments_212707.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-25T11:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212707",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212708.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-06-25T11:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212708",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_212709.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-06-25T12:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212709",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_212710.json:
```json
{
    "body": "Hi Nathann,\n\nI propose to\n- move this over #16423\n- remove the `# long time` for the `MOLS_table` test\n- change 15 to 20 or 30 in the `MOLS_table`\nTimings are now\n\n```\nsage: from sage.combinat.designs.latin_squares import MOLS_table\nsage: from time import time\nsage: t0 = time(); MOLS_table(30); t1 = time()\n...\nsage: print t1 - t0\n3.6996819973\n```\n\nImpressive!\n\nVincent",
    "created_at": "2014-06-25T13:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212710",
    "user": "vdelecroix"
}
```

Hi Nathann,

I propose to
- move this over #16423
- remove the `# long time` for the `MOLS_table` test
- change 15 to 20 or 30 in the `MOLS_table`
Timings are now

```
sage: from sage.combinat.designs.latin_squares import MOLS_table
sage: from time import time
sage: t0 = time(); MOLS_table(30); t1 = time()
...
sage: print t1 - t0
3.6996819973
```

Impressive!

Vincent



---

archive/issue_comments_212711.json:
```json
{
    "body": "Yo !\n\n> - move this over #16423\n\nI will do this as soon as #16423 is reviewed.\n\n> - remove the `# long time` for the `MOLS_table` test\n> - change 15 to 20 or 30 in the `MOLS_table`\n\nNo need. We will have to set it back the way it is now as soon as #16500 is reviewed, unless there is a way to save time there.\n\n> Timings are now\n> {{{\n> sage: from sage.combinat.designs.latin_squares import MOLS_table\n> sage: from time import time\n> sage: t0 = time(); MOLS_table(30); t1 = time()\n> ...\n> sage: print t1 - t0\n> 3.6996819973\n> }}}\n> Impressive!\n\nToo bad it will not last `:-/`\n\nNathann",
    "created_at": "2014-06-25T13:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212711",
    "user": "ncohen"
}
```

Yo !

> - move this over #16423

I will do this as soon as #16423 is reviewed.

> - remove the `# long time` for the `MOLS_table` test
> - change 15 to 20 or 30 in the `MOLS_table`

No need. We will have to set it back the way it is now as soon as #16500 is reviewed, unless there is a way to save time there.

> Timings are now
> {{{
> sage: from sage.combinat.designs.latin_squares import MOLS_table
> sage: from time import time
> sage: t0 = time(); MOLS_table(30); t1 = time()
> ...
> sage: print t1 - t0
> 3.6996819973
> }}}
> Impressive!

Too bad it will not last `:-/`

Nathann



---

archive/issue_comments_212712.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-06-25T13:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212712",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_212713.json:
```json
{
    "body": "Good to me!\n\nVincent",
    "created_at": "2014-06-25T14:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212713",
    "user": "vdelecroix"
}
```

Good to me!

Vincent



---

archive/issue_comments_212714.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-25T14:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212714",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_212715.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-26T19:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16262#issuecomment-212715",
    "user": "vbraun"
}
```

Resolution: fixed
