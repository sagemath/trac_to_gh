# Issue 18199: Dimension formulae do not accept Dirichlet characters with certain base rings

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2015-05-18 07:56:43

Keywords: Dirichlet character dimension formula

In Sage 6.7:

```
sage: K.<a> = NumberField(x^2 + x + 1)
sage: G = DirichletGroup(13, base_ring=K)
sage: Gamma1(13).dimension_cusp_forms(2, G[1])
Traceback (most recent call last):
...
TypeError: No compatible natural embeddings found for Complex Lazy Field and Number Field in a with defining polynomial x^2 + x + 1
```

This is because `dimension_eis()` tries to convert the character `G[1]` into a Dirichlet group with an incompatible base ring.  This was fixed for `dimension_cusp_forms()` in #8630; we fix `dimension_eis()` in a similar way.


---

Comment by pbruin created at 2015-05-18 08:10:13

Changing status from new to needs_review.


---

Comment by git created at 2015-05-18 08:12:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2015-05-19 19:24:51

Hmm, I have no such bug in sage 6.7 ! was it maybe in a previous version of sage ?


---

Comment by pbruin created at 2015-05-19 19:50:27

Replying to [comment:3 chapoton]:
> Hmm, I have no such bug in sage 6.7 ! was it maybe in a previous version of sage ?
Sorry, I mistakenly put an example in the ticket description that does not exhibit the bug.  It should read `dimension_modular_forms` (or `dimension_eis`) instead of `dimension_cusp_forms`.  I fixed the description.


---

Comment by chapoton created at 2015-05-19 19:54:19

OK. Looks good to me, but I would prefer to check the characteristic of K before
changing the base of eps.


---

Comment by pbruin created at 2015-05-19 20:08:02

Replying to [comment:5 chapoton]:
> OK. Looks good to me, but I would prefer to check the characteristic of K before
> changing the base of eps. 
The line `eps = DirichletGroup(N, K)(eps)` doesn't change the base ring of `eps`, just the level.  Switching the order with the check for the characteristic of `K` makes no difference except that this one line more than necessary is executed in case of invalid input.  I actually had similar thoughts as you while I was writing the patch, and decided on what I think is a fairly logical ordering of the code.  I don't think we would gain a lot by modifying the order.


---

Comment by chapoton created at 2015-05-19 20:12:07

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2015-05-19 20:12:07

Then positive review.


---

Comment by pbruin created at 2015-05-19 20:16:17

Replying to [comment:7 chapoton]:
> Then positive review.
Merci!


---

Comment by vbraun created at 2015-05-20 17:45:12

Resolution: fixed
