# Issue 33885: Bug is_planar() test for directed graph

Issue created by migration from https://trac.sagemath.org/ticket/34122

Original creator: @gdolle

Original creation time: 2022-07-06 14:06:34

There may be a bug in is_planar() implementation for directed graph, we have a case which return false instead of true for the below planar test,


```
  #!div style="font-size: 80%"
  {{{#!python
     # Multiplicity [1,5]
     G = [ [1,2], [1,4], [1,5], [2,3], [2,4], [2,5], [3,4], [3,5], [4,5], [5,1] ]
     G1 = Graph(G)
     G2 = DiGraph(G)
     G1.is_planar() # True
     G2.is_planar() # False => Should be true
  }}}
```


Note that it does not seem to be a problem of cycle, since it works for the case


```
  #!div style="font-size: 80%"
  {{{#!python
     # Multiplicity [1,5]
     G = [ [1,2] , [2,1] ]
     G1 = Graph(G)
     G2 = DiGraph(G)
     G1.is_planar() # True
     G2.is_planar() # True !
```



---

Comment by @DaveWitteMorris created at 2022-07-07 04:35:30

Changing priority from minor to critical.


---

Comment by @DaveWitteMorris created at 2022-07-07 04:35:30

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2022-07-07 04:35:30

Thanks for pointing out the bug. This is a fundamental error in basic functionality, so I increased the priority to "critical". 

The code applied an inequality to digraphs that is only valid for graphs.  A digraph without loops or multiple edges can have twice as many edges as the corresponding graph (because each undirected edge in a graph can be replaced with two oppositely directed edges in a digraph), so it is not true that a digraph with `self.size() > 3 * self.order() - 6` cannot be planar. 
----
New commits:


---

Comment by @DaveWitteMorris created at 2022-07-07 04:35:30

Changing keywords from "" to "digraph, planar".


---

Comment by dcoudert created at 2022-07-11 16:50:10

Good catch. Thank you both for reporting and fixing the issue.


---

Comment by dcoudert created at 2022-07-11 16:50:33

Changing status from needs_review to positive_review.


---

Comment by @DaveWitteMorris created at 2022-07-12 05:20:44

Thanks for the review!


---

Comment by vbraun created at 2022-07-17 18:14:20

Resolution: fixed
