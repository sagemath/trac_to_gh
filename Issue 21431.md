# Issue 21431: sage.stats.basic_stats.mode doesn't sort

Issue created by migration from Trac.

Original creator: schilly

Original creation time: 2016-10-08 20:01:44

CC:  tscrim jmantysalo

The `sage.stats.basic_stats.mode` function claims to sort the result, but it doesn't. 


```
sage: my_list =  [0, 2, 7, 7, 13, 20, 2, 13]
sage: mode(my_list)
[2, 13, 7]
```


Here is a possible fix by Murray Tannock


```
def mode(v):
    """
    Return the mode of `v`.  The mode is the sorted list of the most
    frequently occurring elements in `v`.  If `n` is the most times
    that any element occurs in `v`, then the mode is the sorted list
    of elements of `v` that occur `n` times.

    NOTE: The elements of `v` must be hashable and comparable.

    INPUT:

        - `v` -- a list

    OUTPUT:

        - a list

    EXAMPLES::

        sage: v = [1,2,4,1,6,2,6,7,1]
        sage: mode(v)
        [1]
        sage: v.count(1)
        3
        sage: mode([])
        []
        sage: mode([1,2,3,4,5])
        [1, 2, 3, 4, 5]
        sage: mode([0, 2, 7, 7, 13, 20, 2, 13])
        [2, 7, 13]
        sage: mode(['sage', 4, I, 3/5, 'sage', pi])
        ['sage']
        sage: class MyClass:
        ...     def mode(self):
        ...         return [1]
        sage: stats.mode(MyClass())
        [1]
    """
    if hasattr(v,'mode'): return v.mode()
    from operator import itemgetter

    freq = {}
    for i in v:
        if i in freq:
            freq[i] += 1
        else:
            freq[i] = 1

    s = sorted(freq.items(), key=itemgetter(1,0))
    return [i[0] for i in s if i[1] == s[-1][1]]
```



---

Comment by chapoton created at 2017-05-04 18:17:22

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-05-04 18:17:22

New commits:


---

Comment by chapoton created at 2017-05-04 19:04:16

I made my own branch. This should be an easy review.
----
New commits:


---

Comment by tscrim created at 2017-05-04 20:02:15

I don't think they necessarily have to be comparable, only to have sorted output. However, this will require catching an exception to return the unsorted list, but that is okay IMO.


---

Comment by chapoton created at 2017-05-09 19:07:22

so, is this a positive review, Travis ?


---

Comment by tscrim created at 2017-05-09 19:17:04

I would instead say you should do

```python
try:
    return sorted(u for u, f in freq.items() if f == n)
except TypeError:
    return [u for u, f in freq.items() if f == n]
```

with appropriate changes to the docstring.


---

Comment by git created at 2017-05-09 20:21:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-05-09 20:23:04

Done. But I have no idea what you mean by "appropriate changes".


---

Comment by tscrim created at 2017-05-09 20:24:05

We no longer require the elements are comparable and we can say we sort this list if possible.


---

Comment by git created at 2017-05-10 06:42:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-05-10 06:42:41

done
----
New commits:


---

Comment by tscrim created at 2017-05-10 06:46:41

Thank you.


---

Comment by tscrim created at 2017-05-10 06:46:41

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-05-13 10:33:35

Resolution: fixed
