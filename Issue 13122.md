# Issue 13122: Add test for not necessarly induced subgraphs to Graph.is_subgraph() method

archive/issues_013122.json:
```json
{
    "body": "Assignee: jason, ncohen, rlm\n\nKeywords: graph, induced subgraph\n\nThat attached patch allows for testing if a graph is a subgraph of another,\neither induced or not. \nThe current implementation only tests for\ninduced subgraphs.\n\nA boolean parameter named \"induced\" has been added to Graph.is_subgrapg().\nThat parameter defaults to True for backward compatibility.\n\n\n```\ndef is_subgraph(self, other, induced=True):\n```\n\n\nIf induced is True the method behaves like the current one, testing if 'self' is an *induced* subgraph of other.\n\nIf induces is False the method tests if all vertices and all edges of self are also in other.\n\nThis example illustrates the difference:\n\n```\n            sage: H=graphs.CycleGraph(5)\n            sage: G=graphs.PathGraph(5)\n            sage: G.is_subgraph(H)\n            False\n            sage: G.is_subgraph(H, induced=False)\n            True\n```\n\n\nThe patch also includes a couple of fixes regarding docstrings.\n\nAs a personal note, I think that since the method is named \"is_subgraph\" and not \"is_induced_subgraph\" the default behaviour is counter-intuitive.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13294\n\n",
    "created_at": "2012-07-26T14:45:51Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.4",
    "title": "Add test for not necessarly induced subgraphs to Graph.is_subgraph() method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13122",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```
Assignee: jason, ncohen, rlm

Keywords: graph, induced subgraph

That attached patch allows for testing if a graph is a subgraph of another,
either induced or not. 
The current implementation only tests for
induced subgraphs.

A boolean parameter named "induced" has been added to Graph.is_subgrapg().
That parameter defaults to True for backward compatibility.


```
def is_subgraph(self, other, induced=True):
```


If induced is True the method behaves like the current one, testing if 'self' is an *induced* subgraph of other.

If induces is False the method tests if all vertices and all edges of self are also in other.

This example illustrates the difference:

```
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
```


The patch also includes a couple of fixes regarding docstrings.

As a personal note, I think that since the method is named "is_subgraph" and not "is_induced_subgraph" the default behaviour is counter-intuitive.

Issue created by migration from https://trac.sagemath.org/ticket/13294





---

archive/issue_comments_159458.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-26T15:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159458",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_159459.json:
```json
{
    "body": "A few minor things:\n\n* Python identifiers (like `True`, `self` and `other`) should consistently be typeset monospaced (```True```).\n* Parameters are usually documented in a list (`INPUT:`), like here:\n\n```python\n    def __copy__(self, implementation='c_graph', sparse=None):\n        \"\"\"\n        Creates a copy of the graph.\n\n        INPUT:\n\n         - ``implementation`` - string (default: 'networkx') the\n           implementation goes here.  Current options are only\n           'networkx' or 'c_graph'.\n\n         - ``sparse`` - boolean (default: None) whether the\n           graph given is sparse or not.\n\n        OUTPUT:\n\n        A Graph object.\n```\n\n   (I'd also move the comment `#induced is True for backwards compatibility` there.)\n\n* `s/wether/whether/` (once)\n\nYou can add yourself to the [list of Sage developers](http://trac.sagemath.org/sage_trac/wiki#AccountNamesMappedtoRealNames) on the wiki page.",
    "created_at": "2012-07-26T17:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159459",
    "user": "https://github.com/nexttime"
}
```

A few minor things:

* Python identifiers (like `True`, `self` and `other`) should consistently be typeset monospaced (```True```).
* Parameters are usually documented in a list (`INPUT:`), like here:

```python
    def __copy__(self, implementation='c_graph', sparse=None):
        """
        Creates a copy of the graph.

        INPUT:

         - ``implementation`` - string (default: 'networkx') the
           implementation goes here.  Current options are only
           'networkx' or 'c_graph'.

         - ``sparse`` - boolean (default: None) whether the
           graph given is sparse or not.

        OUTPUT:

        A Graph object.
```

   (I'd also move the comment `#induced is True for backwards compatibility` there.)

* `s/wether/whether/` (once)

You can add yourself to the [list of Sage developers](http://trac.sagemath.org/sage_trac/wiki#AccountNamesMappedtoRealNames) on the wiki page.



---

archive/issue_comments_159460.json:
```json
{
    "body": "Thank you for the comments, I tried to do my best to fix the docstring.\nThere is no description for the ``other`` parameter because it is self-explanatory and I've seen the same thing done in other methods as well.",
    "created_at": "2012-07-27T00:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159460",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```

Thank you for the comments, I tried to do my best to fix the docstring.
There is no description for the ``other`` parameter because it is self-explanatory and I've seen the same thing done in other methods as well.



---

archive/issue_comments_159461.json:
```json
{
    "body": "Hello Steven !!\n\nI cannot review your patch because I will not be able to run Sage until mid september, but it looks like the second loop in your else: is not correctly indented ! `:-)`\n\nNathann",
    "created_at": "2012-08-04T06:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159461",
    "user": "https://github.com/nathanncohen"
}
```

Hello Steven !!

I cannot review your patch because I will not be able to run Sage until mid september, but it looks like the second loop in your else: is not correctly indented ! `:-)`

Nathann



---

archive/issue_comments_159462.json:
```json
{
    "body": "Hello,\n\nI agree with Nathann that you have incorrect indentation, but in both if and else statements. The function should be:\n\n```\n        from sage.graphs.graph import Graph\n        from sage.graphs.digraph import DiGraph\n        if not isinstance(other,Graph) and not isinstance(other,DiGraph):\n            raise ValueError('The input parameter must be a Graph or a DiGraph.')\n\n        if induced:\n            self_verts = self.vertices()   \n            for v in self.vertex_iterator():\n                if v not in other:\n                    return False\n            return other.subgraph(self_verts) == self\n\n        else:\n            for v in self.vertex_iterator():\n                if v not in other:\n                    return False\n\n            for e in self.edge_iterator():\n                if not other.has_edge(e):\n                    return False\n\n            return True\n```\n\nYou could also add necessary doc tests.\n\nAnother question is the expected behavior of the function when self is a Graph and other a DiGraph. If the answer is always False, then you could add a test before the `if induced:` statement. However, what if other has vertices but no edges?",
    "created_at": "2012-08-10T00:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159462",
    "user": "https://github.com/dcoudert"
}
```

Hello,

I agree with Nathann that you have incorrect indentation, but in both if and else statements. The function should be:

```
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if not isinstance(other,Graph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a Graph or a DiGraph.')

        if induced:
            self_verts = self.vertices()   
            for v in self.vertex_iterator():
                if v not in other:
                    return False
            return other.subgraph(self_verts) == self

        else:
            for v in self.vertex_iterator():
                if v not in other:
                    return False

            for e in self.edge_iterator():
                if not other.has_edge(e):
                    return False

            return True
```

You could also add necessary doc tests.

Another question is the expected behavior of the function when self is a Graph and other a DiGraph. If the answer is always False, then you could add a test before the `if induced:` statement. However, what if other has vertices but no edges?



---

archive/issue_comments_159463.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-08-10T00:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159463",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_159464.json:
```json
{
    "body": "Hi,\nthank you for your feedback. I have fixed the incorrect indentation (whoops).\n\nRegarding the problem that may arise when self and other are of two different types, I think the best thing to do is just return an error and let the user explicitly handle that situation.\n\nFor example let's assume that G is undirected and H is directed:\n\n```\nH.is_subgraph(G, induced=False)\n```\n\nraises a Value error.\n\n\n```\nH.is_subgraph(G.to_directed(), induced=False)\n```\n\nTests whether H has *two* edges (u,v) and (v,u) for each of edge (u,v) in G.\n\n\n```\nH.to_undirected().is_subgraph(G, induced=False)\n```\n\nTests whether H has *at least one* edge (either (u,v) or (v,u)) for each of edge (u,v) in G.\n\nThe only problem I see in this approach is that it might, in weird codes, break backwards compatibility as there is no such test right now.\n\nAs for the doc tests, there was already one in place. I've added another to test when induced=False and the method returns false. If it's not enough or there's something else that I'm missing please let me know.\n\nThe proposed code looks something like this:\n\n```\n        [...]\n        EXAMPLES::\n\n            sage: P = graphs.PetersenGraph()\n            sage: G = P.subgraph(range(6))\n            sage: G.is_subgraph(P)\n            True\n            \n            sage: H=graphs.CycleGraph(5)\n            sage: G=graphs.PathGraph(5)\n            sage: G.is_subgraph(H)\n            False\n            sage: G.is_subgraph(H, induced=False)\n            True\n            sage: H.is_subgraph(G, induced=False)\n            False\n        \"\"\"\n        \n        from sage.graphs.graph import Graph\n        from sage.graphs.digraph import DiGraph\n        if isinstance(self,Graph) and not isinstance(other,Graph):\n            raise ValueError('The input parameter must be a Graph.')\n        \n        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):\n            raise ValueError('The input parameter must be a DiGraph.')\n        \n        if induced:\n            self_verts = self.vertices()\n            for v in self_verts:\n                if v not in other:\n                    return False\n            \n            return other.subgraph(self_verts) == self\n        else:\n            for v in self:\n                if v not in other:\n                    return False\n            \n            for e in self.edge_iterator():\n                if not other.has_edge(e):\n                    return False\n            \n            return True\n```\n\n\nIf it looks right I'll post the updated patch file :)",
    "created_at": "2012-08-23T10:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159464",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```

Hi,
thank you for your feedback. I have fixed the incorrect indentation (whoops).

Regarding the problem that may arise when self and other are of two different types, I think the best thing to do is just return an error and let the user explicitly handle that situation.

For example let's assume that G is undirected and H is directed:

```
H.is_subgraph(G, induced=False)
```

raises a Value error.


```
H.is_subgraph(G.to_directed(), induced=False)
```

Tests whether H has *two* edges (u,v) and (v,u) for each of edge (u,v) in G.


```
H.to_undirected().is_subgraph(G, induced=False)
```

Tests whether H has *at least one* edge (either (u,v) or (v,u)) for each of edge (u,v) in G.

The only problem I see in this approach is that it might, in weird codes, break backwards compatibility as there is no such test right now.

As for the doc tests, there was already one in place. I've added another to test when induced=False and the method returns false. If it's not enough or there's something else that I'm missing please let me know.

The proposed code looks something like this:

```
        [...]
        EXAMPLES::

            sage: P = graphs.PetersenGraph()
            sage: G = P.subgraph(range(6))
            sage: G.is_subgraph(P)
            True
            
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
            sage: H.is_subgraph(G, induced=False)
            False
        """
        
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if isinstance(self,Graph) and not isinstance(other,Graph):
            raise ValueError('The input parameter must be a Graph.')
        
        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a DiGraph.')
        
        if induced:
            self_verts = self.vertices()
            for v in self_verts:
                if v not in other:
                    return False
            
            return other.subgraph(self_verts) == self
        else:
            for v in self:
                if v not in other:
                    return False
            
            for e in self.edge_iterator():
                if not other.has_edge(e):
                    return False
            
            return True
```


If it looks right I'll post the updated patch file :)



---

archive/issue_comments_159465.json:
```json
{
    "body": "Use the code bellow plus the tests. I did the following:\n- adds a simple test before to speedup the function when the result is obvious.\n- moved the test on the vertex set to avoid duplicated code\n- replace for loops with 'any' and 'all' statements. They do exactly the same but are nicer.\n\n\n```\n        [...]\n        EXAMPLES:\n\n            sage: P = graphs.PetersenGraph()\n            sage: G = P.subgraph(range(6))\n            sage: G.is_subgraph(P)\n            True\n            \n            sage: H=graphs.CycleGraph(5)\n            sage: G=graphs.PathGraph(5)\n            sage: G.is_subgraph(H)\n            False\n            sage: G.is_subgraph(H, induced=False)\n            True\n            sage: H.is_subgraph(G, induced=False)\n            False\n\n\tTESTS:\n\n\tRaise an error when self and other are of different types::\n\n\t    sage: G = Graph([(0,1)]).is_subgraph( DiGraph([(0,1)]) )\n\t    Traceback (most recent call last):\n\t    ...\n \t    ValueError: The input parameter must be a Graph.\n\t    sage: G = DiGraph([(0,1)]).is_subgraph( Graph([(0,1)]) )\n\t    Traceback (most recent call last):\n\t    ...\n \t    ValueError: The input parameter must be a DiGraph.\n        \"\"\"\n        from sage.graphs.graph import Graph\n        from sage.graphs.digraph import DiGraph\n        if isinstance(self,Graph) and not isinstance(other,Graph):\n            raise ValueError('The input parameter must be a Graph.')\n\n        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):\n            raise ValueError('The input parameter must be a DiGraph.')\n\n        if self.num_verts() > other.num_verts():\n            return False\n\n\tif any(v not in other for v in self.vertex_iterator()):\n            return False\n\n        if induced:\n            return other.subgraph(self.vertices()) == self\n        else:\n            return all(other.has_edge(e) for e in self.edge_iterator())\n```\n",
    "created_at": "2012-08-23T11:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159465",
    "user": "https://github.com/dcoudert"
}
```

Use the code bellow plus the tests. I did the following:
- adds a simple test before to speedup the function when the result is obvious.
- moved the test on the vertex set to avoid duplicated code
- replace for loops with 'any' and 'all' statements. They do exactly the same but are nicer.


```
        [...]
        EXAMPLES:

            sage: P = graphs.PetersenGraph()
            sage: G = P.subgraph(range(6))
            sage: G.is_subgraph(P)
            True
            
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
            sage: H.is_subgraph(G, induced=False)
            False

	TESTS:

	Raise an error when self and other are of different types::

	    sage: G = Graph([(0,1)]).is_subgraph( DiGraph([(0,1)]) )
	    Traceback (most recent call last):
	    ...
 	    ValueError: The input parameter must be a Graph.
	    sage: G = DiGraph([(0,1)]).is_subgraph( Graph([(0,1)]) )
	    Traceback (most recent call last):
	    ...
 	    ValueError: The input parameter must be a DiGraph.
        """
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if isinstance(self,Graph) and not isinstance(other,Graph):
            raise ValueError('The input parameter must be a Graph.')

        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a DiGraph.')

        if self.num_verts() > other.num_verts():
            return False

	if any(v not in other for v in self.vertex_iterator()):
            return False

        if induced:
            return other.subgraph(self.vertices()) == self
        else:
            return all(other.has_edge(e) for e in self.edge_iterator())
```




---

archive/issue_comments_159466.json:
```json
{
    "body": "Attachment [trac_13294_is_subgraph.patch](tarball://root/attachments/some-uuid/ticket13294/trac_13294_is_subgraph.patch) by steven created at 2012-08-23 13:19:13\n\nGraph.is_subgraph() patch -- version 3",
    "created_at": "2012-08-23T13:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159466",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```

Attachment [trac_13294_is_subgraph.patch](tarball://root/attachments/some-uuid/ticket13294/trac_13294_is_subgraph.patch) by steven created at 2012-08-23 13:19:13

Graph.is_subgraph() patch -- version 3



---

archive/issue_comments_159467.json:
```json
{
    "body": "I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).",
    "created_at": "2012-08-23T15:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159467",
    "user": "https://trac.sagemath.org/admin/accounts/users/steven"
}
```

I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).



---

archive/issue_comments_159468.json:
```json
{
    "body": "Replying to [comment:10 steven]:\n> I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).\nRight.\n\nFor me the patch is now OK (install, tests, docbuild,...), so I give positive review.",
    "created_at": "2012-08-23T17:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159468",
    "user": "https://github.com/dcoudert"
}
```

Replying to [comment:10 steven]:
> I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).
Right.

For me the patch is now OK (install, tests, docbuild,...), so I give positive review.



---

archive/issue_comments_159469.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-08-23T17:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159469",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_159470.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-27T10:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13122#issuecomment-159470",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_013042.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-27T10:37:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13122",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13122#event-13042"
}
```
