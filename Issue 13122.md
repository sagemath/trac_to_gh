# Issue 13122: Add test for not necessarly induced subgraphs to Graph.is_subgraph() method

Issue created by migration from https://trac.sagemath.org/ticket/13294

Original creator: steven

Original creation time: 2012-07-26 14:45:51

Assignee: jason, ncohen, rlm

Keywords: graph, induced subgraph

That attached patch allows for testing if a graph is a subgraph of another,
either induced or not. 
The current implementation only tests for
induced subgraphs.

A boolean parameter named "induced" has been added to Graph.is_subgrapg().
That parameter defaults to True for backward compatibility.


```
def is_subgraph(self, other, induced=True):
```


If induced is True the method behaves like the current one, testing if 'self' is an *induced* subgraph of other.

If induces is False the method tests if all vertices and all edges of self are also in other.

This example illustrates the difference:

```
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
```


The patch also includes a couple of fixes regarding docstrings.

As a personal note, I think that since the method is named "is_subgraph" and not "is_induced_subgraph" the default behaviour is counter-intuitive.


---

Comment by steven created at 2012-07-26 15:25:44

Changing status from new to needs_review.


---

Comment by leif created at 2012-07-26 17:14:55

A few minor things:

 * Python identifiers (like `True`, `self` and `other`) should consistently be typeset monospaced (```True```).
 * Parameters are usually documented in a list (`INPUT:`), like here:

```python
    def __copy__(self, implementation='c_graph', sparse=None):
        """
        Creates a copy of the graph.

        INPUT:

         - ``implementation`` - string (default: 'networkx') the
           implementation goes here.  Current options are only
           'networkx' or 'c_graph'.

         - ``sparse`` - boolean (default: None) whether the
           graph given is sparse or not.

        OUTPUT:

        A Graph object.
```

   (I'd also move the comment `#induced is True for backwards compatibility` there.)

 * `s/wether/whether/` (once)

You can add yourself to the [list of Sage developers](http://trac.sagemath.org/sage_trac/wiki#AccountNamesMappedtoRealNames) on the wiki page.


---

Comment by steven created at 2012-07-27 00:26:35

Thank you for the comments, I tried to do my best to fix the docstring.
There is no description for the ``other`` parameter because it is self-explanatory and I've seen the same thing done in other methods as well.


---

Comment by ncohen created at 2012-08-04 06:48:19

Hello Steven !!

I cannot review your patch because I will not be able to run Sage until mid september, but it looks like the second loop in your else: is not correctly indented ! `:-)`

Nathann


---

Comment by dcoudert created at 2012-08-10 00:32:06

Hello,

I agree with Nathann that you have incorrect indentation, but in both if and else statements. The function should be:

```
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if not isinstance(other,Graph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a Graph or a DiGraph.')

        if induced:
            self_verts = self.vertices()   
            for v in self.vertex_iterator():
                if v not in other:
                    return False
            return other.subgraph(self_verts) == self

        else:
            for v in self.vertex_iterator():
                if v not in other:
                    return False

            for e in self.edge_iterator():
                if not other.has_edge(e):
                    return False

            return True
```

You could also add necessary doc tests.

Another question is the expected behavior of the function when self is a Graph and other a DiGraph. If the answer is always False, then you could add a test before the `if induced:` statement. However, what if other has vertices but no edges?


---

Comment by dcoudert created at 2012-08-10 00:32:06

Changing status from needs_review to needs_work.


---

Comment by steven created at 2012-08-23 10:43:02

Hi,
thank you for your feedback. I have fixed the incorrect indentation (whoops).

Regarding the problem that may arise when self and other are of two different types, I think the best thing to do is just return an error and let the user explicitly handle that situation.

For example let's assume that G is undirected and H is directed:

```
H.is_subgraph(G, induced=False)
```

raises a Value error.


```
H.is_subgraph(G.to_directed(), induced=False)
```

Tests whether H has *two* edges (u,v) and (v,u) for each of edge (u,v) in G.


```
H.to_undirected().is_subgraph(G, induced=False)
```

Tests whether H has *at least one* edge (either (u,v) or (v,u)) for each of edge (u,v) in G.

The only problem I see in this approach is that it might, in weird codes, break backwards compatibility as there is no such test right now.

As for the doc tests, there was already one in place. I've added another to test when induced=False and the method returns false. If it's not enough or there's something else that I'm missing please let me know.

The proposed code looks something like this:

```
        [...]
        EXAMPLES::

            sage: P = graphs.PetersenGraph()
            sage: G = P.subgraph(range(6))
            sage: G.is_subgraph(P)
            True
            
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
            sage: H.is_subgraph(G, induced=False)
            False
        """
        
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if isinstance(self,Graph) and not isinstance(other,Graph):
            raise ValueError('The input parameter must be a Graph.')
        
        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a DiGraph.')
        
        if induced:
            self_verts = self.vertices()
            for v in self_verts:
                if v not in other:
                    return False
            
            return other.subgraph(self_verts) == self
        else:
            for v in self:
                if v not in other:
                    return False
            
            for e in self.edge_iterator():
                if not other.has_edge(e):
                    return False
            
            return True
```


If it looks right I'll post the updated patch file :)


---

Comment by dcoudert created at 2012-08-23 11:25:14

Use the code bellow plus the tests. I did the following:
- adds a simple test before to speedup the function when the result is obvious.
- moved the test on the vertex set to avoid duplicated code
- replace for loops with 'any' and 'all' statements. They do exactly the same but are nicer.


```
        [...]
        EXAMPLES:

            sage: P = graphs.PetersenGraph()
            sage: G = P.subgraph(range(6))
            sage: G.is_subgraph(P)
            True
            
            sage: H=graphs.CycleGraph(5)
            sage: G=graphs.PathGraph(5)
            sage: G.is_subgraph(H)
            False
            sage: G.is_subgraph(H, induced=False)
            True
            sage: H.is_subgraph(G, induced=False)
            False

	TESTS:

	Raise an error when self and other are of different types::

	    sage: G = Graph([(0,1)]).is_subgraph( DiGraph([(0,1)]) )
	    Traceback (most recent call last):
	    ...
 	    ValueError: The input parameter must be a Graph.
	    sage: G = DiGraph([(0,1)]).is_subgraph( Graph([(0,1)]) )
	    Traceback (most recent call last):
	    ...
 	    ValueError: The input parameter must be a DiGraph.
        """
        from sage.graphs.graph import Graph
        from sage.graphs.digraph import DiGraph
        if isinstance(self,Graph) and not isinstance(other,Graph):
            raise ValueError('The input parameter must be a Graph.')

        if isinstance(self,DiGraph) and not isinstance(other,DiGraph):
            raise ValueError('The input parameter must be a DiGraph.')

        if self.num_verts() > other.num_verts():
            return False

	if any(v not in other for v in self.vertex_iterator()):
            return False

        if induced:
            return other.subgraph(self.vertices()) == self
        else:
            return all(other.has_edge(e) for e in self.edge_iterator())
```



---

Attachment

Graph.is_subgraph() patch -- version 3


---

Comment by steven created at 2012-08-23 15:55:45

I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).


---

Comment by dcoudert created at 2012-08-23 17:30:44

Replying to [comment:10 steven]:
> I've attached the patch. The only difference from your code is that I've removed the assignment to G in the TESTS section (as it seemed unnecessary).
Right.

For me the patch is now OK (install, tests, docbuild,...), so I give positive review.


---

Comment by dcoudert created at 2012-08-23 17:30:44

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2012-08-27 10:37:53

Resolution: fixed
