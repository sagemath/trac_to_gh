# Issue 25889: Meataxe optional package failures

Issue created by migration from https://trac.sagemath.org/ticket/26126

Original creator: vbraun

Original creation time: 2018-08-25 12:55:02

CC:  simonking

I'm trying to set up a buildbot with meataxe but get lots of failures of the form:

```
File "src/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py", line 1856, in sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field.p_rank
Failed example:
    E.p_rank()
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 614, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1025, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field.p_rank[8]>", line 1, in <module>
        E.p_rank()
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py", line 1866, in p_rank
        N,E= self._Hasse_Witt_cached()
      File "sage/misc/cachefunc.pyx", line 2316, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:13467)
        self.cache = f(self._instance)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py", line 1703, in _Hasse_Witt_cached
        M, Coeffs, g, Fq, p, E = self._Cartier_matrix_cached()
      File "sage/misc/cachefunc.pyx", line 2316, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:13467)
        self.cache = f(self._instance)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py", line 1528, in _Cartier_matrix_cached
        return matrix(Fq,M), Coeff, g, Fq,p, self
      File "sage/matrix/constructor.pyx", line 625, in sage.matrix.constructor.matrix (build/cythonized/sage/matrix/constructor.c:2455)
        return MatrixArgs(*args, **kwds).matrix()
      File "sage/matrix/args.pyx", line 658, in sage.matrix.args.MatrixArgs.matrix (build/cythonized/sage/matrix/args.c:8109)
        M = self.space(self, coerce=convert)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/matrix/matrix_space.py", line 876, in __call__
        return MC(self, entries, copy, coerce)
      File "sage/matrix/matrix_gfpn_dense.pyx", line 412, in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense.__init__ (build/cythonized/sage/matrix/matrix_gfpn_dense.c:5341)
        self.Data = MatAlloc(fl, nr, nc)
    RuntimeError: Cannot select field GF(9) in file matcore.c (line 130)
**********************************************************************
```



---

Comment by SimonKing created at 2018-08-25 16:00:38

That's interesting. In Sage-8.4.beta0 these tests work fine for me.

So, are you talking about 8.4.beta0? And what architecture does your patchbot have? What about the file system --- I ask, because the choice of a base field involves loading some arithmetic tables from disc (or creating new tables and storing them on disc).


---

Comment by vbraun created at 2018-08-25 22:46:44

Can you give it a try with beta2 (uploading right now)? File system is zfs


---

Comment by SimonKing created at 2018-08-26 11:10:13

With

```
$ ./sage --version
SageMath version 8.4.beta2, Release Date: 2018-08-25
```

I get no test failures in sage/schemes/hyperelliptic_curves. And I did verify that `matrix_gfpn_dense` is used for matrices over non-prime finite fields of odd characteristic.

Concerning arithmetic tables: The tables should automatically be created (as soon as the user requests a matrix over a specific finite field) in `$DOT_SAGE/meataxe`, the file names should have the format `pXYZ.zzz`, where `XYZ` is the order of the field.
So, is there anything unusual with the patchbot's `$DOT_SAGE`? If I understand correctly, there *are* patchbots that can use meataxe. So I wonder what is special here.
