# Issue 25746: enhance documentation of divisors

Issue created by migration from Trac.

Original creator: zimmerma

Original creation time: 2018-08-01 09:04:08

CC:  slelievre

the output of divisors(n) for n integer appears to be sorted, if true this should be documented, to avoid the user to call sorted(l).


---

Comment by slelievre created at 2018-08-08 13:53:02

Changing keywords from "" to "divisors, sorted".


---

Comment by slelievre created at 2018-08-08 13:53:02

Tentative documentation improvement. Please review.
----
New commits:


---

Comment by slelievre created at 2018-08-08 13:53:02

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-08-08 23:12:12

Question: Should we sort them? I understand the purpose of sorting them for doctest output, but how often is it useful to go through them in sorted order? In the same vein, would it be useful to have a pure iterator variant?


---

Comment by slelievre created at 2018-08-09 11:36:46

I strongly support adding an iterator variant, either here or in a separate ticket.


---

Comment by slelievre created at 2018-08-09 11:39:33

About iterators, see also this Ask Sage question:

- [Ask Sage question 24969: Lower prime divisor](https://ask.sagemath.org/question/24969)


---

Comment by jdemeyer created at 2018-08-09 12:19:20

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-08-09 12:19:20

I suggest removing the sorting in the generic case.


---

Comment by zimmerma created at 2018-08-22 08:06:39

I agree some applications don't need the divisors sorted, and those that need it can easily use `sorted(divisors(...))`.


---

Comment by slelievre created at 2018-10-07 16:27:09

How about an optional argument `sorted` defaulting to `False`?


---

Comment by zimmerma created at 2018-10-08 07:28:46

Replying to [comment:9 slelievre]:
> How about an optional argument `sorted` defaulting to `False`?

that would be a good solution.


---

Comment by mantepse created at 2018-10-08 07:46:18

Replying to [comment:9 slelievre]:
> How about an optional argument `sorted` defaulting to `False`?

I wonder to what purpose? Is there any advantage over sorting afterwards?


---

Comment by slelievre created at 2018-10-24 14:49:49

This ticket was opened to document that divisors are returned sorted
in increasing order.

Should we review that, and open one (ore more) follow-up ticket(s) to

- make `divisors` and `prime_divisors` return unsorted output by default
- provide an iterator variant for `divisors` and `prime_divisors`

I'm also happy if this ticket is repurposed to something more useful...
but I would not know where to start for that, and I'm afraid this stays stalled.


---

Comment by slelievre created at 2018-10-24 14:49:49

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2019-01-09 09:49:52

Merge failure


---

Comment by jdemeyer created at 2019-01-09 09:49:52

Changing status from needs_review to needs_work.


---

Comment by slelievre created at 2019-01-09 16:00:48

Rebased on SageMath 8.6.rc0. Please review.
----
New commits:


---

Comment by slelievre created at 2019-01-09 16:00:48

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2019-01-10 10:03:10

This is wrong:

```
Return the list of all divisors (up to units) of this element
of a unique factorization domain, sorted in increasing order.
```


In general, there is no guarantee of sorting (it wouldn't make sense either: how would you sort elements of an arbitrary ring?). It is sorted for integers.


---

Comment by jdemeyer created at 2019-01-10 10:05:05

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2019-01-10 10:05:05

Same issue in the other changed documentation: the generic functions don't guarantee any kind of sorting. Only specific implementations like for `Integer` do sort.


---

Comment by git created at 2019-01-10 13:25:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2019-01-10 14:06:51

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2019-01-10 14:06:51

Thanks for these comments. I took them into account.

For `squarefree_divisors(n)` the order comes from using powerset of
the list of prime divisors of `n` and in general will not coincide with
the increasing order.
For example, the list of prime divisors of 30 is [2, 3, 5], and the
powers can be [0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0], [0, 0, 1], [1, 0, 1],
[0, 1, 1], [1, 1, 1], giving the squarefree divisors 1, 2, 3, 6, 5, 10, 15, 30.

The order that squarefree divisors of an integer are returned in can
be described as follows. 

Denote by `p` the list of prime divisors of `n` sorted in increasing order,
and let `k = len(p)`; then there are `2^k` squarefree divisors of `n` to list.

Let `s` be their list, so that these divisors are `s[j]` for `j` ranging from
`0` to `2^k - 1`.

If `b` is the bit sequence corresponding to `j`,
so that `j = sum(2^b[i] for i in range(k))`,
then `s[j] = prod(p[i]^b[i] for i in range(k))`.

Should this be stated in the documentation?
----
New commits:


---

Comment by jdemeyer created at 2019-01-10 14:11:02

Replying to [comment:19 slelievre]:
> Should this be stated in the documentation?

Please no. If we document it, it means that we cannot change the order in the future.


---

Comment by jdemeyer created at 2019-01-10 14:14:14

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2019-01-10 14:19:08

Thanks for the review!

In the current implementation, squarefree divisors of `n` are
yielded in increasing order exactly when each prime divisor of `n`
is greater than the product of the smaller prime divisors of `n`.


---

Comment by vbraun created at 2019-01-28 19:20:19

Resolution: fixed
