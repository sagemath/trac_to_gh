# Issue 25746: enhance documentation of divisors

archive/issues_025746.json:
```json
{
    "body": "CC:  slelievre\n\nthe output of divisors(n) for n integer appears to be sorted, if true this should be documented, to avoid the user to call sorted(l).\n\nIssue created by migration from https://trac.sagemath.org/ticket/25983\n\n",
    "created_at": "2018-08-01T09:04:08Z",
    "labels": [
        "basic arithmetic",
        "trivial",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "enhance documentation of divisors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25746",
    "user": "zimmerma"
}
```
CC:  slelievre

the output of divisors(n) for n integer appears to be sorted, if true this should be documented, to avoid the user to call sorted(l).

Issue created by migration from https://trac.sagemath.org/ticket/25983





---

archive/issue_comments_363272.json:
```json
{
    "body": "Changing keywords from \"\" to \"divisors, sorted\".",
    "created_at": "2018-08-08T13:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363272",
    "user": "slelievre"
}
```

Changing keywords from "" to "divisors, sorted".



---

archive/issue_comments_363273.json:
```json
{
    "body": "Tentative documentation improvement. Please review.\n----\nNew commits:",
    "created_at": "2018-08-08T13:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363273",
    "user": "slelievre"
}
```

Tentative documentation improvement. Please review.
----
New commits:



---

archive/issue_comments_363274.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-08T13:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363274",
    "user": "slelievre"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_363275.json:
```json
{
    "body": "Question: Should we sort them? I understand the purpose of sorting them for doctest output, but how often is it useful to go through them in sorted order? In the same vein, would it be useful to have a pure iterator variant?",
    "created_at": "2018-08-08T23:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363275",
    "user": "tscrim"
}
```

Question: Should we sort them? I understand the purpose of sorting them for doctest output, but how often is it useful to go through them in sorted order? In the same vein, would it be useful to have a pure iterator variant?



---

archive/issue_comments_363276.json:
```json
{
    "body": "I strongly support adding an iterator variant, either here or in a separate ticket.",
    "created_at": "2018-08-09T11:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363276",
    "user": "slelievre"
}
```

I strongly support adding an iterator variant, either here or in a separate ticket.



---

archive/issue_comments_363277.json:
```json
{
    "body": "About iterators, see also this Ask Sage question:\n\n- [Ask Sage question 24969: Lower prime divisor](https://ask.sagemath.org/question/24969)",
    "created_at": "2018-08-09T11:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363277",
    "user": "slelievre"
}
```

About iterators, see also this Ask Sage question:

- [Ask Sage question 24969: Lower prime divisor](https://ask.sagemath.org/question/24969)



---

archive/issue_comments_363278.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-09T12:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363278",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363279.json:
```json
{
    "body": "I suggest removing the sorting in the generic case.",
    "created_at": "2018-08-09T12:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363279",
    "user": "jdemeyer"
}
```

I suggest removing the sorting in the generic case.



---

archive/issue_comments_363280.json:
```json
{
    "body": "I agree some applications don't need the divisors sorted, and those that need it can easily use `sorted(divisors(...))`.",
    "created_at": "2018-08-22T08:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363280",
    "user": "zimmerma"
}
```

I agree some applications don't need the divisors sorted, and those that need it can easily use `sorted(divisors(...))`.



---

archive/issue_comments_363281.json:
```json
{
    "body": "How about an optional argument `sorted` defaulting to `False`?",
    "created_at": "2018-10-07T16:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363281",
    "user": "slelievre"
}
```

How about an optional argument `sorted` defaulting to `False`?



---

archive/issue_comments_363282.json:
```json
{
    "body": "Replying to [comment:9 slelievre]:\n> How about an optional argument `sorted` defaulting to `False`?\n\nthat would be a good solution.",
    "created_at": "2018-10-08T07:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363282",
    "user": "zimmerma"
}
```

Replying to [comment:9 slelievre]:
> How about an optional argument `sorted` defaulting to `False`?

that would be a good solution.



---

archive/issue_comments_363283.json:
```json
{
    "body": "Replying to [comment:9 slelievre]:\n> How about an optional argument `sorted` defaulting to `False`?\n\nI wonder to what purpose? Is there any advantage over sorting afterwards?",
    "created_at": "2018-10-08T07:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363283",
    "user": "mantepse"
}
```

Replying to [comment:9 slelievre]:
> How about an optional argument `sorted` defaulting to `False`?

I wonder to what purpose? Is there any advantage over sorting afterwards?



---

archive/issue_comments_363284.json:
```json
{
    "body": "This ticket was opened to document that divisors are returned sorted\nin increasing order.\n\nShould we review that, and open one (ore more) follow-up ticket(s) to\n\n- make `divisors` and `prime_divisors` return unsorted output by default\n- provide an iterator variant for `divisors` and `prime_divisors`\n\nI'm also happy if this ticket is repurposed to something more useful...\nbut I would not know where to start for that, and I'm afraid this stays stalled.",
    "created_at": "2018-10-24T14:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363284",
    "user": "slelievre"
}
```

This ticket was opened to document that divisors are returned sorted
in increasing order.

Should we review that, and open one (ore more) follow-up ticket(s) to

- make `divisors` and `prime_divisors` return unsorted output by default
- provide an iterator variant for `divisors` and `prime_divisors`

I'm also happy if this ticket is repurposed to something more useful...
but I would not know where to start for that, and I'm afraid this stays stalled.



---

archive/issue_comments_363285.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-10-24T14:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363285",
    "user": "slelievre"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363286.json:
```json
{
    "body": "Merge failure",
    "created_at": "2019-01-09T09:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363286",
    "user": "jdemeyer"
}
```

Merge failure



---

archive/issue_comments_363287.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-09T09:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363287",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363288.json:
```json
{
    "body": "Rebased on SageMath 8.6.rc0. Please review.\n----\nNew commits:",
    "created_at": "2019-01-09T16:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363288",
    "user": "slelievre"
}
```

Rebased on SageMath 8.6.rc0. Please review.
----
New commits:



---

archive/issue_comments_363289.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-09T16:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363289",
    "user": "slelievre"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363290.json:
```json
{
    "body": "This is wrong:\n\n```\nReturn the list of all divisors (up to units) of this element\nof a unique factorization domain, sorted in increasing order.\n```\n\n\nIn general, there is no guarantee of sorting (it wouldn't make sense either: how would you sort elements of an arbitrary ring?). It is sorted for integers.",
    "created_at": "2019-01-10T10:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363290",
    "user": "jdemeyer"
}
```

This is wrong:

```
Return the list of all divisors (up to units) of this element
of a unique factorization domain, sorted in increasing order.
```


In general, there is no guarantee of sorting (it wouldn't make sense either: how would you sort elements of an arbitrary ring?). It is sorted for integers.



---

archive/issue_comments_363291.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-10T10:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363291",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363292.json:
```json
{
    "body": "Same issue in the other changed documentation: the generic functions don't guarantee any kind of sorting. Only specific implementations like for `Integer` do sort.",
    "created_at": "2019-01-10T10:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363292",
    "user": "jdemeyer"
}
```

Same issue in the other changed documentation: the generic functions don't guarantee any kind of sorting. Only specific implementations like for `Integer` do sort.



---

archive/issue_comments_363293.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-10T13:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363293",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_363294.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-10T14:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363294",
    "user": "slelievre"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363295.json:
```json
{
    "body": "Thanks for these comments. I took them into account.\n\nFor `squarefree_divisors(n)` the order comes from using powerset of\nthe list of prime divisors of `n` and in general will not coincide with\nthe increasing order.\nFor example, the list of prime divisors of 30 is [2, 3, 5], and the\npowers can be [0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0], [0, 0, 1], [1, 0, 1],\n[0, 1, 1], [1, 1, 1], giving the squarefree divisors 1, 2, 3, 6, 5, 10, 15, 30.\n\nThe order that squarefree divisors of an integer are returned in can\nbe described as follows. \n\nDenote by `p` the list of prime divisors of `n` sorted in increasing order,\nand let `k = len(p)`; then there are `2^k` squarefree divisors of `n` to list.\n\nLet `s` be their list, so that these divisors are `s[j]` for `j` ranging from\n`0` to `2^k - 1`.\n\nIf `b` is the bit sequence corresponding to `j`,\nso that `j = sum(2^b[i] for i in range(k))`,\nthen `s[j] = prod(p[i]^b[i] for i in range(k))`.\n\nShould this be stated in the documentation?\n----\nNew commits:",
    "created_at": "2019-01-10T14:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363295",
    "user": "slelievre"
}
```

Thanks for these comments. I took them into account.

For `squarefree_divisors(n)` the order comes from using powerset of
the list of prime divisors of `n` and in general will not coincide with
the increasing order.
For example, the list of prime divisors of 30 is [2, 3, 5], and the
powers can be [0, 0, 0], [1, 0, 0], [0, 1, 0], [1, 1, 0], [0, 0, 1], [1, 0, 1],
[0, 1, 1], [1, 1, 1], giving the squarefree divisors 1, 2, 3, 6, 5, 10, 15, 30.

The order that squarefree divisors of an integer are returned in can
be described as follows. 

Denote by `p` the list of prime divisors of `n` sorted in increasing order,
and let `k = len(p)`; then there are `2^k` squarefree divisors of `n` to list.

Let `s` be their list, so that these divisors are `s[j]` for `j` ranging from
`0` to `2^k - 1`.

If `b` is the bit sequence corresponding to `j`,
so that `j = sum(2^b[i] for i in range(k))`,
then `s[j] = prod(p[i]^b[i] for i in range(k))`.

Should this be stated in the documentation?
----
New commits:



---

archive/issue_comments_363296.json:
```json
{
    "body": "Replying to [comment:19 slelievre]:\n> Should this be stated in the documentation?\n\nPlease no. If we document it, it means that we cannot change the order in the future.",
    "created_at": "2019-01-10T14:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363296",
    "user": "jdemeyer"
}
```

Replying to [comment:19 slelievre]:
> Should this be stated in the documentation?

Please no. If we document it, it means that we cannot change the order in the future.



---

archive/issue_comments_363297.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-10T14:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363297",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_363298.json:
```json
{
    "body": "Thanks for the review!\n\nIn the current implementation, squarefree divisors of `n` are\nyielded in increasing order exactly when each prime divisor of `n`\nis greater than the product of the smaller prime divisors of `n`.",
    "created_at": "2019-01-10T14:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363298",
    "user": "slelievre"
}
```

Thanks for the review!

In the current implementation, squarefree divisors of `n` are
yielded in increasing order exactly when each prime divisor of `n`
is greater than the product of the smaller prime divisors of `n`.



---

archive/issue_comments_363299.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-28T19:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25746#issuecomment-363299",
    "user": "vbraun"
}
```

Resolution: fixed
