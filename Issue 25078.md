# Issue 25078: Find libraries in DYLD_LIBRARY_PATH as fallback

archive/issues_025078.json:
```json
{
    "body": "Unfortunately `find_library` doesn't work with nix (see [this](https://github.com/NixOS/nixpkgs/issues/7307) issue) and apparently is only supposed to return the library filename (not the path) anyways.\n\nTo make it possible to use sage when find_library fails, this patch adds `DYLD_LIBRARY_PATH` as a fallback.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25315\n\n",
    "closed_at": "2018-08-11T16:55:26Z",
    "created_at": "2018-05-09T10:23:15Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Find libraries in DYLD_LIBRARY_PATH as fallback",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25078",
    "user": "https://github.com/timokau"
}
```
Unfortunately `find_library` doesn't work with nix (see [this](https://github.com/NixOS/nixpkgs/issues/7307) issue) and apparently is only supposed to return the library filename (not the path) anyways.

To make it possible to use sage when find_library fails, this patch adds `DYLD_LIBRARY_PATH` as a fallback.

Issue created by migration from https://trac.sagemath.org/ticket/25315





---

archive/issue_comments_352447.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-09T10:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352447",
    "user": "https://github.com/timokau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_352448.json:
```json
{
    "body": "update milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352448",
    "user": "https://github.com/videlec"
}
```

update milestone 8.3 -> 8.4



---

archive/issue_events_063438.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25078#event-63438"
}
```



---

archive/issue_comments_352449.json:
```json
{
    "body": "Would it be cleaner if your implementation went into the \"else\" block as the .so, .a extensions are only correct for \"else\" systems, aren't they?",
    "created_at": "2018-08-07T17:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352449",
    "user": "https://github.com/saraedum"
}
```

Would it be cleaner if your implementation went into the "else" block as the .so, .a extensions are only correct for "else" systems, aren't they?



---

archive/issue_comments_352450.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-08-07T17:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352450",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_352451.json:
```json
{
    "body": "Which else block? The `if sys.platform == 'cygwin'` one? If so, I wouldn't mind. But I also don't see why that would be cleaner. cygwin could make use of that fallback too and it doesn't hurt.",
    "created_at": "2018-08-07T20:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352451",
    "user": "https://github.com/timokau"
}
```

Which else block? The `if sys.platform == 'cygwin'` one? If so, I wouldn't mind. But I also don't see why that would be cleaner. cygwin could make use of that fallback too and it doesn't hurt.



---

archive/issue_comments_352452.json:
```json
{
    "body": "I see, I guess this makes sense then. So, is this only used by gferftools.py? (that's the only reference I found...)",
    "created_at": "2018-08-07T20:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352452",
    "user": "https://github.com/saraedum"
}
```

I see, I guess this makes sense then. So, is this only used by gferftools.py? (that's the only reference I found...)



---

archive/issue_comments_352453.json:
```json
{
    "body": "Yes, I can't find any other usage either. I don't remember the exact doctest failure that made me apply this patch, it probably just was the doctest of `find_library` itself.",
    "created_at": "2018-08-07T20:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352453",
    "user": "https://github.com/timokau"
}
```

Yes, I can't find any other usage either. I don't remember the exact doctest failure that made me apply this patch, it probably just was the doctest of `find_library` itself.



---

archive/issue_comments_352454.json:
```json
{
    "body": "Ok, so since this is quite far from being important then, I don't really mind. If it makes your live easier for nix packaging, feel free to set it to positive review.",
    "created_at": "2018-08-09T00:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352454",
    "user": "https://github.com/saraedum"
}
```

Ok, so since this is quite far from being important then, I don't really mind. If it makes your live easier for nix packaging, feel free to set it to positive review.



---

archive/issue_comments_352455.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2018-08-09T08:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352455",
    "user": "https://github.com/timokau"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_352456.json:
```json
{
    "body": "Yes, its just easier to detect new failures if all doctests pass. Maybe it'll be used more in the future. Having an escape hatch can't hurt either way.\n\nThanks for the review :)",
    "created_at": "2018-08-09T08:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352456",
    "user": "https://github.com/timokau"
}
```

Yes, its just easier to detect new failures if all doctests pass. Maybe it'll be used more in the future. Having an escape hatch can't hurt either way.

Thanks for the review :)



---

archive/issue_events_063439.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-11T16:55:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25078#event-63439"
}
```



---

archive/issue_comments_352457.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-11T16:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25078#issuecomment-352457",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
