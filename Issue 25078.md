# Issue 25078: Find libraries in DYLD_LIBRARY_PATH as fallback

Issue created by migration from https://trac.sagemath.org/ticket/25315

Original creator: @timokau

Original creation time: 2018-05-09 10:23:15

Unfortunately find_library doesn't work with nix (see [this](https://github.com/NixOS/nixpkgs/issues/7307) issue) and apparently is only supposed to return the library filename (not the path) anyways.

To make it possible to use sage when find_library fails, this patch adds DYLD_LIBRARY_PATH as a fallback.


---

Comment by @timokau created at 2018-05-09 10:23:41

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by saraedum created at 2018-08-07 17:02:53

Would it be cleaner if your implementation went into the "else" block as the .so, .a extensions are only correct for "else" systems, aren't they?


---

Comment by saraedum created at 2018-08-07 17:02:53

Changing status from needs_review to needs_info.


---

Comment by @timokau created at 2018-08-07 20:08:23

Which else block? The `if sys.platform == 'cygwin'` one? If so, I wouldn't mind. But I also don't see why that would be cleaner. cygwin could make use of that fallback too and it doesn't hurt.


---

Comment by saraedum created at 2018-08-07 20:27:56

I see, I guess this makes sense then. So, is this only used by gferftools.py? (that's the only reference I found...)


---

Comment by @timokau created at 2018-08-07 20:39:13

Yes, I can't find any other usage either. I don't remember the exact doctest failure that made me apply this patch, it probably just was the doctest of `find_library` itself.


---

Comment by saraedum created at 2018-08-09 00:20:41

Ok, so since this is quite far from being important then, I don't really mind. If it makes your live easier for nix packaging, feel free to set it to positive review.


---

Comment by @timokau created at 2018-08-09 08:29:13

Changing status from needs_info to positive_review.


---

Comment by @timokau created at 2018-08-09 08:29:13

Yes, its just easier to detect new failures if all doctests pass. Maybe it'll be used more in the future. Having an escape hatch can't hurt either way.

Thanks for the review :)


---

Comment by vbraun created at 2018-08-11 16:55:26

Resolution: fixed
