# Issue 29792: Implement another nonexistence check for symmetric BIBDs

Issue created by migration from https://trac.sagemath.org/ticket/30029

Original creator: @Ivo-Maffei

Original creation time: 2020-06-30 16:35:07

CC:  dimpase cremona

Keywords: bibd

Implemented a nonexistence check based on the Bruck–Ryser–Chowla theorem.
Before generating a BIBD for some given parameters, we check if the theorem holds for the parameters. If it does not, then no symmetric BIBD exists for such parameters

See https://en.wikipedia.org/wiki/Bruck–Ryser–Chowla_theorem


---

Comment by git created at 2020-07-01 14:43:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @Ivo-Maffei created at 2020-07-01 14:46:39

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-07-03 08:02:35

please mention BRC thm in the relevant docstring, with a link to Wikipedia article.

also, I think a version of BRC for lambda=1 is already used somewhere in designs code, so it would be good to unify these.


---

Comment by git created at 2020-07-03 12:59:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @Ivo-Maffei created at 2020-07-03 13:01:08

I extracted the code in a stand-alone function. I hope this is what you meant.
The issue is that the check is quite slow. Moreover, for projective planes it could be simplified quite a lot (see old code).
So now a few docstring fail because of timed out


---

Comment by git created at 2020-07-03 17:11:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-07-03 23:40:02

This is a so-called Legendre equation, see
https://www.ams.org/journals/mcom/2003-72-243/S0025-5718-02-01480-1/S0025-5718-02-01480-1.pdf
(note that it talks about rational solutions, but every solution in our case, 
x<sup>2</sup>+ay<sup>2</sup>+bz<sup>2</sup>=0 gives rise to an integer one, as we can clear denominators).

I hope John (one of the authors of this paper) can tell us  how testing that there is no rational solution can be done in Sage quickly (perhaps it would need some programming though).


---

Comment by dimpase created at 2020-07-04 08:37:24

actually, this is implemented in Sage:

```
sage: C.<a,b,c> = Conic(QQ, [1, 1, -2]) #  a^2+b^2-2c^2=0
sage: C
Projective Conic Curve over Rational Field defined by a^2 + b^2 - 2*c^2
sage: C.has_rational_point(point=True)
(True, (-1 : -1 : 1))
sage: C.<a,b,c> = Conic(QQ, [1, 1, -3])
sage: C.has_rational_point(point=True)
(False, 3)
sage: v,k,l=(211,15,1)
sage: C.<x,y,z>=Conic(QQ,[1, l-k, (-1 if v%4 == 1 else 1)*l]); C
Projective Conic Curve over Rational Field defined by x^2 - 14*y^2 + z^2
sage: C.has_rational_point(point=True) # no projective plane of order 14
(False, 7)
```


here is a more fun example:

```
sage: n=15; v = 1 + (n + 2)*(n + 1)/2; k=n+2; l=2; (v,k,l) # biplane of order 15?
(137, 17, 2)
sage: C.<x,y,z>=Conic(QQ,[1, l-k, (-1 if v%4 == 1 else 1)*l]); C
Projective Conic Curve over Rational Field defined by x^2 - 15*y^2 - 2*z^2
sage: C.has_rational_point(point=True) # no
(False, 3)
```



---

Comment by cremona created at 2020-07-04 10:12:11

As Dima noted, Sage can test conics for solibility and also solve them.  The default is to call appropriate pari functions.  It would be possible to wrap the conic-solving functions in eclib which implement what's in my paper, but that seem unnecessary for this application.


---

Comment by git created at 2020-07-04 20:26:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-07-05 09:51:31

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-07-05 09:51:31

OK, good to go.


---

Comment by vbraun created at 2020-07-10 19:33:35

Resolution: fixed
