# Issue 22117: Install both python 2 & 3 by default

Issue created by migration from https://trac.sagemath.org/ticket/22354

Original creator: vbraun

Original creation time: 2017-02-11 11:16:30

As long as we don't change the python symlink this has very little potential for errors. But it'll allow us to add 2/3 regression tests, e.g. check that all sources can be compiled by python3 (though not on this ticket).


---

Comment by vbraun created at 2017-02-11 14:17:29

New commits:


---

Comment by vbraun created at 2017-02-11 14:17:29

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2017-02-14 19:44:51

I guess Python 3 doesn't take that long to build, but most users won't ever use it, so why make it standard? Why not make it optional instead (including the other changes here so that installing Python 3 won't break Sage)?

The variable `SAGE_PYTHON3` needs to be documented. It should have been documented before, but it was only used in the top level `configure` file. In this ticket it is starting to be used more widely, so documentation is more important.


---

Comment by vbraun created at 2017-02-14 20:06:48

Hopefully most users WILL use Python 3 in the future ;-)

The advantage of having it by default is that we can use it for regression testing so that the part that already works with Python 3 will keep working during the transition period: #22357


---

Comment by chapoton created at 2017-02-14 20:11:39

Some time ago, at least one person did not want that SAGE_PYTHON3 get documented : #20912.


---

Comment by jhpalmieri created at 2017-02-14 20:25:54

For the documentation, how about something like this:

```diff
diff --git a/src/doc/en/installation/source.rst b/src/doc/en/installation/source.rst
index 1539260..d265cab 100644
--- a/src/doc/en/installation/source.rst
+++ b/src/doc/en/installation/source.rst
@@ -1121,6 +1121,19 @@ Here are some of the more commonly used variables affecting the build process:
   supports :envvar:`SAGE_SUDO`, into a root-owned installation
   hierarchy (:envvar:`SAGE_LOCAL`).
 
+- :envvar:`SAGE_PYTHON3` - set this to ``yes`` to build Sage using
+  Python 3 rather than Python 2.
+
+  .. WARNING::
+
+     This will probably break your Sage installation!
+
+  .. WARNING::
+
+     This environment variable may not be supported in future versions
+     of Sage; it may be replaced by (for example) ``configure``
+     options.
+
 Variables to set if you're trying to build Sage with an unusual setup, e.g.,
 an unsupported machine or an unusual compiler:
 
```



---

Comment by vbraun created at 2017-02-15 07:54:56

Fine with me; I'd be less hesitant in saying that it will definitely be removed in 2020 together with python 2 ;-)


---

Comment by jhpalmieri created at 2017-02-15 18:38:15

Okay, I've added the documentation to the branch. I'm okay with the rest of it.
----
New commits:


---

Comment by vbraun created at 2017-02-17 20:04:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-21 14:34:58

Resolution: fixed


---

Comment by jdemeyer created at 2017-03-18 14:35:04

This broke building with `SAGE_PYTHON3=yes`: #22638.


---

Comment by jhpalmieri created at 2017-04-04 21:39:41

See #22756 for a followup: Python3 seems to be broken on OS X.


---

Comment by jhpalmieri created at 2017-04-06 16:58:38

See #22770 for an easy to review followup to this ticket: this ticket introduced an error in the functools32 spkg-install script, fixed at #22770.
