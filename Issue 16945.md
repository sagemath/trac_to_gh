# Issue 16945: random spanning trees using the Aldous-Broder algorithm

Issue created by migration from https://trac.sagemath.org/ticket/17182

Original creator: chapoton

Original creation time: 2014-10-20 12:43:58

CC:  ncohen

Keywords: random tree

This implements the Aldous-Broder algorithm that uses a random walk to find a random spanning tree (with uniform distribution).


---

Comment by chapoton created at 2014-10-20 12:56:23

Changing status from new to needs_review.


---

Comment by chapoton created at 2014-10-20 12:56:23

New commits:


---

Comment by ncohen created at 2014-10-20 12:58:02

This should probably go in `graph/spanning_trees.py`

Nathann


---

Comment by git created at 2014-10-20 13:29:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-10-20 13:46:33

1) Should be in `spanning_trees.py`

2) Fails on the empty graph

3) Infinite loop on disconnected graphs

4) `found` should be a set, not a list

Nathann


---

Comment by ncohen created at 2014-10-20 13:46:33

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2014-10-20 13:49:22

Furthermore, all explanations of the `Aldous-Broder` algorithm that I find mention taking the initial vertex at random, while you always take the first one.

Nathann


---

Comment by chapoton created at 2014-10-20 14:33:08

Any vertex does the job, see page 2 of https://www.cs.cmu.edu/~15859n/RelatedWork/Broder-GenRanSpanningTrees.pdf

I am working now on the move.

Should I use `set`, `Set` or `frozenset` ?


---

Comment by ncohen created at 2014-10-20 14:36:22

Yo !

> Any vertex does the job, see page 2 of https://www.cs.cmu.edu/~15859n/RelatedWork/Broder-GenRanSpanningTrees.pdf

Okay.

> I am working now on the move.

Okay.

> Should I use `set`, `Set` or `frozenset` ?

`set` is fine. Never use `Set` for anything else than teaching purposes, and `frozenset` makes no sense here as you want to add elements to the set.

Nathann


---

Comment by git created at 2014-10-20 15:53:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-10-20 15:56:58

I have a problem with the empty graph, but I do not see what is wrong with my code.

Another question : do you think I should raise an exception for the empty graph ? Does it have one spanning tree or none ? I would go for none.

I have also corrected Graph().spanning_trees(), that was failing also. It now says that the empty graph has no spanning tree, which is coherent with spanning_trees_count.


---

Comment by git created at 2014-10-20 16:11:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-10-20 16:11:26

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2014-10-21 14:10:40

Hello,

The doc did not compile. I fixed it. A reference was defined twice (once in `spanning_trees.pyx`, another time in the copy of that function as it is imported in `graph.py`).

The 'see also' should appear a bit earlier, especially when there is a 'test' section. Otherwise nobody sees it.

I flagged the spanning tree in the doctest as `#random`, because the vertex ordering can depend on the architecture.

If you agree with the commit I added, please set this ticket to `positive_review`

Nathann
----
New commits:


---

Comment by chapoton created at 2014-10-21 14:43:13

Thank you Nathann !


---

Comment by chapoton created at 2014-10-21 14:43:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-10-23 11:17:23

Resolution: fixed
