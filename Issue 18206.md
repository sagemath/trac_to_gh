# Issue 18206: Multiplier spectra for projective morphisms

Issue created by migration from https://trac.sagemath.org/ticket/18443

Original creator: gjorgenson

Original creation time: 2015-05-18 16:42:11

CC:  bhutz

Implement a function to compute the n multiplier spectra, the set of multipliers of periodic points of formal period n, of a projective morphism. This currently only makes sense for morphisms over projective space of dimension 1.


---

Comment by git created at 2015-05-20 19:01:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-05-20 19:03:00

Changing status from new to needs_review.


---

Comment by bhutz created at 2015-05-25 16:25:23

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2015-05-25 16:25:23

A few things here, the big one is that the multiplier spectrum is defined with multiplicities. So if a perioidic point has multiplicity > 1 its multiplier should be repeated. Such as example should be added to the doc tests.

Other minor issues:
- a positive integer, the period.

- numberfield -> number field

- n = int(n)

- change_ring now works for QQbar, so this is not needed


```
if not PS.base_ring() is QQbar:
 emb = PS.base_ring().embeddings(QQbar)[0]
 f = self.change_ring(QQbar,embedding=emb) # to be able to find all periodic points
else:
 f = self
```


- f.multiplier(P,n)[0][0] -> f.multiplier(P,n)[0,0]

- multipliers.sort() -> not needed


- sigma_invariants - 2nd senctence should say all periodic points. (same for INPUT)


- from sage.combinat.sf.sf import SymmetricFunctions -> move to top

- make len(multipliers) a constant in for loop


---

Comment by git created at 2015-05-27 15:58:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-27 20:25:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-05-27 20:27:24

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2015-05-30 14:12:37

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2015-05-30 14:12:37

A couple things in multiplier_spectrum

- you should check that the domain is projective space to avoid subschemes

- K = f._number_field_from_algebraics() should be outside the if

- if [1,0] is a point of multplicity you will miss this (You also only check if it is fixed not n-periodic). You could instead see if the poly F is of the form `y^m*G(x,y)` for some poly G, then m is the multplicity of [1,0].

- it doesn't seem like your conversion to QQbar is working. Trying your number field example, when the map is actually defined over a number field


```
sage: set_verbose(None)
sage: z = QQ['z'].0
sage: K.<w> = NumberField(z^4 - 4*z^2 + 1)
sage: P.<x,y> = ProjectiveSpace(K,1)
sage: H = End(P)
sage: f = H([x^2 - w/4*y^2,y^2])
sage: f.multiplier_spectra(2,False)
```


Not sure exactly what you should do here. One option is to get change_ring for polynomials to deal with QQbar, by passing in and/or creating an embedding. If you look in schemes.generic.morphism.SchemeMorphism_polynomial.change_ring() it gives a simple way to construct a hom of polynomials given a hom of the base rings. It does appear that the change_ring of the parent is working, so you probably just need to create the hom between the poly rings and apply it to the element to be changed.


---

Comment by git created at 2015-06-08 19:38:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-06-08 20:02:24

For the formal==True case I used the technique in the morphism change_ring function to create the homomorphism between polynomial rings to use on F and this seems to have addressed the issues so far. For the formal==False case, the conversion already seemed to be working, but  the _number_field_from_algebraics version of the map wasn't needed for finding roots.

I found another problem though:


```
P.<x,y> = ProjectiveSpace(QQ,1)
H = End(P)
f = H([x^2 - 3/4*y^2,y^2])
f.multiplier_spectra(2)
```


gives [1,1] back which isn't correct.

I didn’t catch this before, but multiplier_spectra should only return [1] here, because there is only one two cycle. The collapsing causes this two cycle to turn into a root of multiplicity 2 of the dynatomic polynomial, so the algorithm I use to pick representatives from cycles doesn’t work.

I will implement a fix attempt for this next, but I wanted to push up the current commit before doing so.


---

Comment by bhutz created at 2015-06-09 01:50:36

For `x^2-3/4`, what you have are *no* 2-cycles. There are 2 formal 2-periodic points, but they are a doubled fixed point. So, I'm not sure [1,1] is incorrect in this case. Why do you think this is wrong?


---

Comment by gjorgenson created at 2015-06-09 05:10:18

I thought getting [1,1] back was messing up the resulting elementary symmetric polynomial. For the other `x^2 + c`, the formal 2-multiplier spectra consists of one multiplier and so there is only one elementary symmetric polynomial, `sigma_{1}^{(2)} = sigma_2 + 4`. For `x^2 - 3/4`, if we use [1,1] we have an extra multiplier, and `sigma_{1}^{(2)} = 1+1 = 2` when we expect `sigma_{1}^{(2)} = sigma_2 + 4 = 1`. 

I was thinking that it might be better to treat the doubled fixed point as a single 2-cycle so that we only get one multiplier. Would that work?


---

Comment by bhutz created at 2015-06-09 14:42:51

hmm...yes I see your point. I think having the correct number of multipliers so that the elementary symmetric polynomials are continuous as they are supposed to be would be the correct approach.


---

Comment by git created at 2015-06-10 03:30:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-06-10 03:42:16

I modified the selection loop slightly so now there's no break when iterating points to find their cycles. I think this will address the issue of extra representative points for collapsed cycles, and shouldn't change anything for maps with no collapsing.


---

Comment by gjorgenson created at 2015-06-10 03:42:16

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2015-06-11 15:12:08

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2015-06-11 15:12:08

Just a couple very minor things here. You should actually convert n, not just check the conversion. ie. use ``n=int(n)``

Also, I'd rather not have you accessing the ._polys list directly. Instead you can use G[0], G[1], etc.

Finally, I'd like to see an example with multiplicities.

I see you directly implemented the QQbar change ring for the dynatomic polynomial. I still think the .change_ring() should be fixed as well, but that can be done in a different ticket.


---

Comment by git created at 2015-06-12 22:12:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-06-12 22:19:13

Changing status from needs_work to needs_review.


---

Comment by gjorgenson created at 2015-06-12 22:19:13

I added an example using `x^2 - 7/4` which has a collapsed 3-cycle. I left the `x^2 -3/4` example in to illustrate that the doubled fixed point is treated as one 2-cycle, but I can remove it if it seems unnecessary.


---

Comment by bhutz created at 2015-06-15 19:19:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-17 07:42:42

Resolution: fixed
