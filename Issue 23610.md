# Issue 23610: make the experimental FriCAS package optional

archive/issues_023610.json:
```json
{
    "body": "CC:  @fchapoton @EmmanuelCharpentier @embray\n\nFriCAS is a CAS that provides some functionality which is otherwise either missing (e.g., guessing formulas), or not as complete as might be desirable (e.g., symbolic integration).\n\nThe FriCAS interface was completely rewritten after FriCAS was demoted to experimental in #18563 and is now quite mature, containing lots of doctests.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23847\n\n",
    "created_at": "2017-09-13T14:31:16Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "make the experimental FriCAS package optional",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23610",
    "user": "https://github.com/mantepse"
}
```
CC:  @fchapoton @EmmanuelCharpentier @embray

FriCAS is a CAS that provides some functionality which is otherwise either missing (e.g., guessing formulas), or not as complete as might be desirable (e.g., symbolic integration).

The FriCAS interface was completely rewritten after FriCAS was demoted to experimental in #18563 and is now quite mature, containing lots of doctests.

Issue created by migration from https://trac.sagemath.org/ticket/23847





---

archive/issue_comments_330349.json:
```json
{
    "body": "Changing keywords from \"\" to \"FriCAS\".",
    "created_at": "2017-09-15T11:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330349",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "" to "FriCAS".



---

archive/issue_comments_330350.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-27T05:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330350",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_330351.json:
```json
{
    "body": "Replying to [comment:2 mantepse]:\n\nWhat kind of review do you think is suitable for this ? I have had fricas installed for about 2 years, with no specific problems.\n\nSince, AFAICT, #21377 and #22525 are already merged in 8.1.beta6, the only test I could do would be to test #23782 and `ptestlong`.\n\nMaybe we should grasp the opportunity to document this interface a bit better, and possibly doctest some opportunities made available by fricas ?\n\nIn [your post](https://groups.google.com/d/msg/sage-devel/cHkVjFt1pIY/3DhGTFRMAwAJ), you quoted \"guessing formulas\", lazy powerseries, as well as enhancements to symbolic integration and differential equations solving. Documenting those examples, either in the relevant \"main\" documentation or in a specific page) and doctesting them would be useful.\n\nWhat do you think ?",
    "created_at": "2017-09-27T07:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330351",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:2 mantepse]:

What kind of review do you think is suitable for this ? I have had fricas installed for about 2 years, with no specific problems.

Since, AFAICT, #21377 and #22525 are already merged in 8.1.beta6, the only test I could do would be to test #23782 and `ptestlong`.

Maybe we should grasp the opportunity to document this interface a bit better, and possibly doctest some opportunities made available by fricas ?

In [your post](https://groups.google.com/d/msg/sage-devel/cHkVjFt1pIY/3DhGTFRMAwAJ), you quoted "guessing formulas", lazy powerseries, as well as enhancements to symbolic integration and differential equations solving. Documenting those examples, either in the relevant "main" documentation or in a specific page) and doctesting them would be useful.

What do you think ?



---

archive/issue_comments_330352.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-09-27T07:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330352",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_330353.json:
```json
{
    "body": "> In [your post](https://groups.google.com/d/msg/sage-devel/cHkVjFt1pIY/3DhGTFRMAwAJ), you quoted \"guessing formulas\", lazy powerseries, as well as enhancements to symbolic integration and differential equations solving. Documenting those examples, either in the relevant \"main\" documentation or in a specific page) and doctesting them would be useful.\n\nThese are actually in the main documentation.  To see it:\n\n```\nsage: import sage.interfaces.fricas\nsage: sage.interfaces.fricas?\n```\n\n\nI agree that exposing some of the functionality would be good, but I think that's for another ticket.  I wouldn't do it for an experimental package.",
    "created_at": "2017-09-27T07:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330353",
    "user": "https://github.com/mantepse"
}
```

> In [your post](https://groups.google.com/d/msg/sage-devel/cHkVjFt1pIY/3DhGTFRMAwAJ), you quoted "guessing formulas", lazy powerseries, as well as enhancements to symbolic integration and differential equations solving. Documenting those examples, either in the relevant "main" documentation or in a specific page) and doctesting them would be useful.

These are actually in the main documentation.  To see it:

```
sage: import sage.interfaces.fricas
sage: sage.interfaces.fricas?
```


I agree that exposing some of the functionality would be good, but I think that's for another ticket.  I wouldn't do it for an experimental package.



---

archive/issue_comments_330354.json:
```json
{
    "body": "Replying to [comment:5 mantepse]:\n\n[ Snip... ]\n\n> I agree that exposing some of the functionality would be good, but I think that's for another ticket.\n\nYou may be right...\n\n> I wouldn't do it for an experimental package.\n\nBut your ticket aims to make it an //optional// package...\n\nAnyway : sage 8.1.beta6+#23782 passes `ptestlong` without any error. What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).",
    "created_at": "2017-09-27T09:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330354",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:5 mantepse]:

[ Snip... ]

> I agree that exposing some of the functionality would be good, but I think that's for another ticket.

You may be right...

> I wouldn't do it for an experimental package.

But your ticket aims to make it an //optional// package...

Anyway : sage 8.1.beta6+#23782 passes `ptestlong` without any error. What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).



---

archive/issue_comments_330355.json:
```json
{
    "body": "> > I wouldn't do it for an experimental package.\n> \n> But your ticket aims to make it an //optional// package...\n\nYes, I *might* do it for an optional package :-)\n\n> What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).\n\nwhy would the checksum change?  (fricas was updated in #21377)",
    "created_at": "2017-09-27T11:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330355",
    "user": "https://github.com/mantepse"
}
```

> > I wouldn't do it for an experimental package.
> 
> But your ticket aims to make it an //optional// package...

Yes, I *might* do it for an optional package :-)

> What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).

why would the checksum change?  (fricas was updated in #21377)



---

archive/issue_comments_330356.json:
```json
{
    "body": "Replying to [comment:7 mantepse]:\n> > > I wouldn't do it for an experimental package.\n> > \n> > But your ticket aims to make it an //optional// package...\n> \n> Yes, I *might* do it for an optional package :-)\n> \n> > What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).\n> \n> why would the checksum change?  (fricas was updated in #21377)\n\n'Cause, unless I'm mistaken, the $SAGE_ROOT/build/pkgs/fricas/type file is accoundd for in the checksum computation ?",
    "created_at": "2017-09-27T12:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330356",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:7 mantepse]:
> > > I wouldn't do it for an experimental package.
> > 
> > But your ticket aims to make it an //optional// package...
> 
> Yes, I *might* do it for an optional package :-)
> 
> > What remains to do is changing $SAGE_ROOT/build/pkgs/fricas/type from `experimental` to `optional`, fix the checksums, commit and push. Care to do it ? (I can review it this afternoon...).
> 
> why would the checksum change?  (fricas was updated in #21377)

'Cause, unless I'm mistaken, the $SAGE_ROOT/build/pkgs/fricas/type file is accoundd for in the checksum computation ?



---

archive/issue_comments_330357.json:
```json
{
    "body": "It would be easier to test this if all dependencies would actually be merged in a beta release.",
    "created_at": "2017-09-27T12:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330357",
    "user": "https://github.com/jdemeyer"
}
```

It would be easier to test this if all dependencies would actually be merged in a beta release.



---

archive/issue_comments_330358.json:
```json
{
    "body": "Replying to [comment:8 charpent]:\n> 'Cause, unless I'm mistaken, the $SAGE_ROOT/build/pkgs/fricas/type file is accoundd for in the checksum computation ?\n\nNo, the checksum is the checksum of the source tarball. It does not depend on anything from Sage.",
    "created_at": "2017-09-27T12:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330358",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:8 charpent]:
> 'Cause, unless I'm mistaken, the $SAGE_ROOT/build/pkgs/fricas/type file is accoundd for in the checksum computation ?

No, the checksum is the checksum of the source tarball. It does not depend on anything from Sage.



---

archive/issue_comments_330359.json:
```json
{
    "body": "About this ticket itself: the way I see it, the only difference between an optional package and an experimental package is that an optional package is required to work on all supported platforms. \"working\" is defined as building, passing its own testsuite and passing Sage doctests. Regarding the test suite: does FriCAS have one? There is no `spkg-check` file.\n\nIf it works as defined above, then there doesn't even need to be a vote: just make it optional.\n\nI can run some tests on various systems. As I said above, I'd prefer to wait for a beta release where are dependencies have been merged.",
    "created_at": "2017-09-27T13:01:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330359",
    "user": "https://github.com/jdemeyer"
}
```

About this ticket itself: the way I see it, the only difference between an optional package and an experimental package is that an optional package is required to work on all supported platforms. "working" is defined as building, passing its own testsuite and passing Sage doctests. Regarding the test suite: does FriCAS have one? There is no `spkg-check` file.

If it works as defined above, then there doesn't even need to be a vote: just make it optional.

I can run some tests on various systems. As I said above, I'd prefer to wait for a beta release where are dependencies have been merged.



---

archive/issue_comments_330360.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> About this ticket itself: the way I see it, the only difference between an optional package and an experimental package is that an optional package is required to work on all supported platforms. \n> \"working\" is defined as building, passing its own testsuite and passing Sage doctests.\n\nOne of the FriCAS maintainers says (https://groups.google.com/d/msg/fricas-devel/s5WtJx8u-kA/XVJPuUAQBwAJ) that this should be the case.  I have no way of testing it.\n\n> Regarding the test suite: does FriCAS have one? There is no `spkg-check` file.\n\nConcerning this, he answered:\n\n> You can invoke the testsuite by \"cd src/input && make\", although there's no script to collect the results, there's an unofficial one: \n\n> https://raw.githubusercontent.com/oldk1331/fricas/116f64b1fea32b7148421a4efb43117cf3eee819/src/scripts/test.sh \n\nI wonder how useful this testsuite is for sage then.  I also do not know how long it takes to run it.  I just started it.\n \n> If it works as defined above, then there doesn't even need to be a vote: just make it optional.\n> \n> I can run some tests on various systems. As I said above, I'd prefer to wait for a beta release where are dependencies have been merged.\n\nI'll set the type to optional and the ticket to needs-review and you do it whenever you wish, OK?",
    "created_at": "2017-09-27T16:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330360",
    "user": "https://github.com/mantepse"
}
```

Replying to [comment:11 jdemeyer]:
> About this ticket itself: the way I see it, the only difference between an optional package and an experimental package is that an optional package is required to work on all supported platforms. 
> "working" is defined as building, passing its own testsuite and passing Sage doctests.

One of the FriCAS maintainers says (https://groups.google.com/d/msg/fricas-devel/s5WtJx8u-kA/XVJPuUAQBwAJ) that this should be the case.  I have no way of testing it.

> Regarding the test suite: does FriCAS have one? There is no `spkg-check` file.

Concerning this, he answered:

> You can invoke the testsuite by "cd src/input && make", although there's no script to collect the results, there's an unofficial one: 

> https://raw.githubusercontent.com/oldk1331/fricas/116f64b1fea32b7148421a4efb43117cf3eee819/src/scripts/test.sh 

I wonder how useful this testsuite is for sage then.  I also do not know how long it takes to run it.  I just started it.
 
> If it works as defined above, then there doesn't even need to be a vote: just make it optional.
> 
> I can run some tests on various systems. As I said above, I'd prefer to wait for a beta release where are dependencies have been merged.

I'll set the type to optional and the ticket to needs-review and you do it whenever you wish, OK?



---

archive/issue_comments_330361.json:
```json
{
    "body": "On my laptop (Intel(R) Celeron(R) CPU  N2940  `@` 1.83GHz) the test suite runs for about half an hour.  For each of the ~ 200 input files it produces an output file.  Essential differences mean new bugs.\n\nI don't think that we want to run this.\n----\nNew commits:",
    "created_at": "2017-09-27T18:01:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330361",
    "user": "https://github.com/mantepse"
}
```

On my laptop (Intel(R) Celeron(R) CPU  N2940  `@` 1.83GHz) the test suite runs for about half an hour.  For each of the ~ 200 input files it produces an output file.  Essential differences mean new bugs.

I don't think that we want to run this.
----
New commits:



---

archive/issue_comments_330362.json:
```json
{
    "body": "Replying to [comment:14 mantepse]:\n> I don't think that we want to run this.\n\nWhy not? I don't understand how you came to this conclusion.",
    "created_at": "2017-09-27T19:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330362",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:14 mantepse]:
> I don't think that we want to run this.

Why not? I don't understand how you came to this conclusion.



---

archive/issue_comments_330363.json:
```json
{
    "body": "Replying to [comment:15 jdemeyer]:\n> Replying to [comment:14 mantepse]:\n> > I don't think that we want to run this.\n> \n> Why not? I don't understand how you came to this conclusion.\n\nBecause you don't get a result, such as \"tests passed\".  Well, it might make sense to run it and say something like \"output of tests can be found in ...\"\n\nWhat do you think?",
    "created_at": "2017-09-27T19:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330363",
    "user": "https://github.com/mantepse"
}
```

Replying to [comment:15 jdemeyer]:
> Replying to [comment:14 mantepse]:
> > I don't think that we want to run this.
> 
> Why not? I don't understand how you came to this conclusion.

Because you don't get a result, such as "tests passed".  Well, it might make sense to run it and say something like "output of tests can be found in ..."

What do you think?



---

archive/issue_comments_330364.json:
```json
{
    "body": "Replying to [comment:16 mantepse]:\n> Because you don't get a result, such as \"tests passed\".\n\nOK, got it.",
    "created_at": "2017-09-27T20:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330364",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:16 mantepse]:
> Because you don't get a result, such as "tests passed".

OK, got it.



---

archive/issue_comments_330365.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-10-01T16:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330365",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_330366.json:
```json
{
    "body": "LGTM : on Debian testing running on core i7 + 16 GB RAM, 8.1-beta7+#23847 passes `ptestlong` with no error whatsoever //(mirabile dictu),// as well as `sage -t --optional fricas,sage src/sage/interfaces/fricas.py`.\n\nAs suggested by Jeroen Demeyer, I think that this should be tested on other \"officially supported Sage platforms\", whatever that means.\n\nAt the very minimum, I suggest Mac OS X (which is full of surprises, nowadays), the Sage appliance used under Windows, and maybe the Cygwin(-64 ?) port made by Erik Bray, if Erik thinks that his port is ready for diffusion (I put him in `Cc`).\n\nStatus remains at `needs_review`, but should be put as `positive_review` when this will have been tested on all \"interesting\" platforms.",
    "created_at": "2017-10-04T09:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330366",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

LGTM : on Debian testing running on core i7 + 16 GB RAM, 8.1-beta7+#23847 passes `ptestlong` with no error whatsoever //(mirabile dictu),// as well as `sage -t --optional fricas,sage src/sage/interfaces/fricas.py`.

As suggested by Jeroen Demeyer, I think that this should be tested on other "officially supported Sage platforms", whatever that means.

At the very minimum, I suggest Mac OS X (which is full of surprises, nowadays), the Sage appliance used under Windows, and maybe the Cygwin(-64 ?) port made by Erik Bray, if Erik thinks that his port is ready for diffusion (I put him in `Cc`).

Status remains at `needs_review`, but should be put as `positive_review` when this will have been tested on all "interesting" platforms.



---

archive/issue_comments_330367.json:
```json
{
    "body": "All dependencies have now been merged in 8.1.beta7",
    "created_at": "2017-10-04T11:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330367",
    "user": "https://github.com/jdemeyer"
}
```

All dependencies have now been merged in 8.1.beta7



---

archive/issue_comments_330368.json:
```json
{
    "body": "Replying to [comment:20 jdemeyer]:\n> All dependencies have now been merged in 8.1.beta7\n\nIndeed. I waited for this before `ptest`ing it.",
    "created_at": "2017-10-04T13:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330368",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:20 jdemeyer]:
> All dependencies have now been merged in 8.1.beta7

Indeed. I waited for this before `ptest`ing it.



---

archive/issue_comments_330369.json:
```json
{
    "body": "One thing which is very annoying is that the build cannot be interrupted with `CTRL-C`.",
    "created_at": "2017-10-04T13:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330369",
    "user": "https://github.com/jdemeyer"
}
```

One thing which is very annoying is that the build cannot be interrupted with `CTRL-C`.



---

archive/issue_comments_330370.json:
```json
{
    "body": "Works fine on Linux i386 (32-bit).",
    "created_at": "2017-10-05T10:43:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330370",
    "user": "https://github.com/jdemeyer"
}
```

Works fine on Linux i386 (32-bit).



---

archive/issue_comments_330371.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-05T12:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330371",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_330372.json:
```json
{
    "body": "On `Linux sardonis 4.4.0-57-generic #78-Ubuntu SMP Fri Dec 9 23:46:13 UTC 2016 ppc64le ppc64le ppc64le GNU/Linux`:\n\n```\nsage -t --long src/sage/interfaces/fricas.py\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 69, in sage.interfaces.fricas\nFailed example:\n    f^2                                                                   # optional - fricas\nExpected:\n       10     5 5    10\n      y   - 2x y  + x\nGot:  \n    10      5 5    10\n    y   - 2 x y  + x\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 95, in sage.interfaces.fricas\nFailed example:\n    fricas(\"guessADE([partition n for n in 0..40], homogeneous==4)\")      # optional - fricas\nExpected:\n     [\n       [\n           n\n         [x ]f(x):\n              2    3 (iv)          2    2 ,             3  ,,,         2    2 ,,   2\n             x f(x) f    (x) + (20x f(x) f (x) + 5x f(x) )f   (x) - 39x f(x) f  (x)\n    <BLANKLINE>\n           +\n                 2     ,   2           2 ,           3  ,,        2 ,   4\n             (12x f(x)f (x)  - 15x f(x) f (x) + 4f(x) )f  (x) + 6x f (x)\n    <BLANKLINE>\n           +\n                      ,   3         2 ,   2\n             10x f(x)f (x)  - 16f(x) f (x)\n    <BLANKLINE>\n             =\n             0\n         ,\n                        2     3      4\n        f(x)= 1 + x + 2x  + 3x  + O(x )]\n       ]\nGot:\n    [\n      [\n          n\n        [x ]f(x):\n               2    3 (iv)           2    2 ,              3  ,,,\n              x f(x) f    (x) + (20 x f(x) f (x) + 5 x f(x) )f   (x)\n\n            +\n                    2    2 ,,   2\n              - 39 x f(x) f  (x)\n\n            +\n                   2     ,   2            2 ,            3  ,,         2 ,   4\n              (12 x f(x)f (x)  - 15 x f(x) f (x) + 4 f(x) )f  (x) + 6 x f (x)\n\n            +\n                        ,   3          2 ,   2\n              10 x f(x)f (x)  - 16 f(x) f (x)\n\n          =\n            0\n        ,\n                         2      3      4\n       f(x) = 1 + x + 2 x  + 3 x  + O(x )]\n      ]\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 122, in sage.interfaces.fricas\nFailed example:\n    fricas.set(\"sol\", \"solve(deq, y, x)\"); fricas(\"sol\")                  # optional - fricas\nExpected:\n                  5      3      2               3     2      3      3     2\n                 x  - 10x  + 20x  + 4         2x  - 3x  + 1 x  - 1 x  - 3x  - 1\n    [particular= --------------------,basis= [-------------,------,------------]]\n                          15x                       x          x         x\nGot:\n    5       3       2\n                  x  - 10 x  + 20 x  + 4\n    [particular = ----------------------,\n                           15 x\n                 3      2       3       3      2\n              2 x  - 3 x  + 1  x  - 1  x  - 3 x  - 1\n     basis = [---------------, ------, -------------]]\n                     x            x          x\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 157, in sage.interfaces.fricas\nFailed example:\n    2*(1+2*x+sqrt(1-4*x)-2*x*y).recip()                                   # optional - fricas\nExpected:\n                   2      3     2 2     3      4       4       5\n       1 + (x y + x ) + 2x  + (x y  + 2x y + 6x ) + (4x y + 18x )\n     +\n         3 3     4 2      5       6       5 2      6        7\n       (x y  + 3x y  + 13x y + 57x ) + (6x y  + 40x y + 186x )\n     +\n         4 4     5 3      6 2       7        8       6 3      7 2       8         9\n       (x y  + 4x y  + 21x y  + 130x y + 622x ) + (8x y  + 66x y  + 432x y + 2120x )\n     +\n         5 5     6 4      7 3       8 2        9         10\n       (x y  + 5x y  + 30x y  + 220x y  + 1466x y + 7338x  ) + O(11)\nGot:\n    2       3     2 2      3       4        4        5\n      1 + (x y + x ) + 2 x  + (x y  + 2 x y + 6 x ) + (4 x y + 18 x )\n    +\n        3 3      4 2       5        6        5 2       6         7\n      (x y  + 3 x y  + 13 x y + 57 x ) + (6 x y  + 40 x y + 186 x )\n    +\n        4 4      5 3       6 2        7         8\n      (x y  + 4 x y  + 21 x y  + 130 x y + 622 x )\n    +\n          6 3       7 2        8          9\n      (8 x y  + 66 x y  + 432 x y + 2120 x )\n    +\n        5 5      6 4       7 3        8 2         9          10\n      (x y  + 5 x y  + 30 x y  + 220 x y  + 1466 x y + 7338 x  ) + O(11)\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 543, in sage.interfaces.fricas.FriCAS.get\nFailed example:\n    fricas.get(a.name())                                          # optional - fricas\nExpected:\n    '   +-+\\r\\n29\\\\|2  + 41'\nGot:\n    '    +-+\\r\\n29 \\\\|2  + 41'\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 545, in sage.interfaces.fricas.FriCAS.get\nFailed example:\n    fricas.get('(1 + sqrt(2))^5')                                 # optional - fricas\nExpected:\n    '   +-+\\r\\n29\\\\|2  + 41'\nGot:\n    '    +-+\\r\\n29 \\\\|2  + 41'\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 547, in sage.interfaces.fricas.FriCAS.get\nFailed example:\n    fricas.new('(1 + sqrt(2))^5')                                 # optional - fricas\nExpected:\n       +-+\n    29\\|2  + 41\nGot:\n    +-+\n    29 \\|2  + 41\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 629, in sage.interfaces.fricas.FriCAS.get_unparsed_InputForm\nFailed example:\n    fricas.get_unparsed_InputForm('1..3')                         # optional - fricas\nExpected:\n    '1..3$Segment(Integer())'\nGot:\n    '(1..3)$Segment(PositiveInteger())'\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 655, in sage.interfaces.fricas.FriCAS._equality_symbol\nFailed example:\n    a = fricas(x==6); a                                           # optional - fricas, indirect doctest\nExpected:\n    x= 6\nGot:\n    x = 6\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 661, in sage.interfaces.fricas.FriCAS._equality_symbol\nFailed example:\n    a = fricas(x==6); a                                           # optional - fricas\nExpected:\n    2= 6\nGot:\n    2 = 6\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 1147, in sage.interfaces.fricas.FriCASElement._sage_\nFailed example:\n    a = fricas('(1 + sqrt(2))^5'); a                              # optional - fricas\nExpected:\n       +-+\n    29\\|2  + 41\nGot:\n    +-+\n    29 \\|2  + 41\n**********************************************************************\n```\n",
    "created_at": "2017-10-05T12:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330372",
    "user": "https://github.com/jdemeyer"
}
```

On `Linux sardonis 4.4.0-57-generic #78-Ubuntu SMP Fri Dec 9 23:46:13 UTC 2016 ppc64le ppc64le ppc64le GNU/Linux`:

```
sage -t --long src/sage/interfaces/fricas.py
**********************************************************************
File "src/sage/interfaces/fricas.py", line 69, in sage.interfaces.fricas
Failed example:
    f^2                                                                   # optional - fricas
Expected:
       10     5 5    10
      y   - 2x y  + x
Got:  
    10      5 5    10
    y   - 2 x y  + x
**********************************************************************
File "src/sage/interfaces/fricas.py", line 95, in sage.interfaces.fricas
Failed example:
    fricas("guessADE([partition n for n in 0..40], homogeneous==4)")      # optional - fricas
Expected:
     [
       [
           n
         [x ]f(x):
              2    3 (iv)          2    2 ,             3  ,,,         2    2 ,,   2
             x f(x) f    (x) + (20x f(x) f (x) + 5x f(x) )f   (x) - 39x f(x) f  (x)
    <BLANKLINE>
           +
                 2     ,   2           2 ,           3  ,,        2 ,   4
             (12x f(x)f (x)  - 15x f(x) f (x) + 4f(x) )f  (x) + 6x f (x)
    <BLANKLINE>
           +
                      ,   3         2 ,   2
             10x f(x)f (x)  - 16f(x) f (x)
    <BLANKLINE>
             =
             0
         ,
                        2     3      4
        f(x)= 1 + x + 2x  + 3x  + O(x )]
       ]
Got:
    [
      [
          n
        [x ]f(x):
               2    3 (iv)           2    2 ,              3  ,,,
              x f(x) f    (x) + (20 x f(x) f (x) + 5 x f(x) )f   (x)

            +
                    2    2 ,,   2
              - 39 x f(x) f  (x)

            +
                   2     ,   2            2 ,            3  ,,         2 ,   4
              (12 x f(x)f (x)  - 15 x f(x) f (x) + 4 f(x) )f  (x) + 6 x f (x)

            +
                        ,   3          2 ,   2
              10 x f(x)f (x)  - 16 f(x) f (x)

          =
            0
        ,
                         2      3      4
       f(x) = 1 + x + 2 x  + 3 x  + O(x )]
      ]
**********************************************************************
File "src/sage/interfaces/fricas.py", line 122, in sage.interfaces.fricas
Failed example:
    fricas.set("sol", "solve(deq, y, x)"); fricas("sol")                  # optional - fricas
Expected:
                  5      3      2               3     2      3      3     2
                 x  - 10x  + 20x  + 4         2x  - 3x  + 1 x  - 1 x  - 3x  - 1
    [particular= --------------------,basis= [-------------,------,------------]]
                          15x                       x          x         x
Got:
    5       3       2
                  x  - 10 x  + 20 x  + 4
    [particular = ----------------------,
                           15 x
                 3      2       3       3      2
              2 x  - 3 x  + 1  x  - 1  x  - 3 x  - 1
     basis = [---------------, ------, -------------]]
                     x            x          x
**********************************************************************
File "src/sage/interfaces/fricas.py", line 157, in sage.interfaces.fricas
Failed example:
    2*(1+2*x+sqrt(1-4*x)-2*x*y).recip()                                   # optional - fricas
Expected:
                   2      3     2 2     3      4       4       5
       1 + (x y + x ) + 2x  + (x y  + 2x y + 6x ) + (4x y + 18x )
     +
         3 3     4 2      5       6       5 2      6        7
       (x y  + 3x y  + 13x y + 57x ) + (6x y  + 40x y + 186x )
     +
         4 4     5 3      6 2       7        8       6 3      7 2       8         9
       (x y  + 4x y  + 21x y  + 130x y + 622x ) + (8x y  + 66x y  + 432x y + 2120x )
     +
         5 5     6 4      7 3       8 2        9         10
       (x y  + 5x y  + 30x y  + 220x y  + 1466x y + 7338x  ) + O(11)
Got:
    2       3     2 2      3       4        4        5
      1 + (x y + x ) + 2 x  + (x y  + 2 x y + 6 x ) + (4 x y + 18 x )
    +
        3 3      4 2       5        6        5 2       6         7
      (x y  + 3 x y  + 13 x y + 57 x ) + (6 x y  + 40 x y + 186 x )
    +
        4 4      5 3       6 2        7         8
      (x y  + 4 x y  + 21 x y  + 130 x y + 622 x )
    +
          6 3       7 2        8          9
      (8 x y  + 66 x y  + 432 x y + 2120 x )
    +
        5 5      6 4       7 3        8 2         9          10
      (x y  + 5 x y  + 30 x y  + 220 x y  + 1466 x y + 7338 x  ) + O(11)
**********************************************************************
File "src/sage/interfaces/fricas.py", line 543, in sage.interfaces.fricas.FriCAS.get
Failed example:
    fricas.get(a.name())                                          # optional - fricas
Expected:
    '   +-+\r\n29\\|2  + 41'
Got:
    '    +-+\r\n29 \\|2  + 41'
**********************************************************************
File "src/sage/interfaces/fricas.py", line 545, in sage.interfaces.fricas.FriCAS.get
Failed example:
    fricas.get('(1 + sqrt(2))^5')                                 # optional - fricas
Expected:
    '   +-+\r\n29\\|2  + 41'
Got:
    '    +-+\r\n29 \\|2  + 41'
**********************************************************************
File "src/sage/interfaces/fricas.py", line 547, in sage.interfaces.fricas.FriCAS.get
Failed example:
    fricas.new('(1 + sqrt(2))^5')                                 # optional - fricas
Expected:
       +-+
    29\|2  + 41
Got:
    +-+
    29 \|2  + 41
**********************************************************************
File "src/sage/interfaces/fricas.py", line 629, in sage.interfaces.fricas.FriCAS.get_unparsed_InputForm
Failed example:
    fricas.get_unparsed_InputForm('1..3')                         # optional - fricas
Expected:
    '1..3$Segment(Integer())'
Got:
    '(1..3)$Segment(PositiveInteger())'
**********************************************************************
File "src/sage/interfaces/fricas.py", line 655, in sage.interfaces.fricas.FriCAS._equality_symbol
Failed example:
    a = fricas(x==6); a                                           # optional - fricas, indirect doctest
Expected:
    x= 6
Got:
    x = 6
**********************************************************************
File "src/sage/interfaces/fricas.py", line 661, in sage.interfaces.fricas.FriCAS._equality_symbol
Failed example:
    a = fricas(x==6); a                                           # optional - fricas
Expected:
    2= 6
Got:
    2 = 6
**********************************************************************
File "src/sage/interfaces/fricas.py", line 1147, in sage.interfaces.fricas.FriCASElement._sage_
Failed example:
    a = fricas('(1 + sqrt(2))^5'); a                              # optional - fricas
Expected:
       +-+
    29\|2  + 41
Got:
    +-+
    29 \|2  + 41
**********************************************************************
```




---

archive/issue_comments_330373.json:
```json
{
    "body": "Sorry, I just realized now that I should rebase to 8.1.beta7",
    "created_at": "2017-10-05T12:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330373",
    "user": "https://github.com/jdemeyer"
}
```

Sorry, I just realized now that I should rebase to 8.1.beta7



---

archive/issue_comments_330374.json:
```json
{
    "body": "Rebased\n----\nNew commits:",
    "created_at": "2017-10-05T12:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330374",
    "user": "https://github.com/jdemeyer"
}
```

Rebased
----
New commits:



---

archive/issue_comments_330375.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-05T12:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330375",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_330376.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-05T13:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330376",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_330377.json:
```json
{
    "body": "Did Fr\u00e9d\u00e9ric do some of the review? It seems to me that it was Emmanuel Charpentier that should be listed as co-reviewer.",
    "created_at": "2017-10-05T15:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330377",
    "user": "https://github.com/tscrim"
}
```

Did Frédéric do some of the review? It seems to me that it was Emmanuel Charpentier that should be listed as co-reviewer.



---

archive/issue_comments_330378.json:
```json
{
    "body": "Of course. I confused the user names \"charpent\" and \"chapoton\".",
    "created_at": "2017-10-05T15:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330378",
    "user": "https://github.com/jdemeyer"
}
```

Of course. I confused the user names "charpent" and "chapoton".



---

archive/issue_comments_330379.json:
```json
{
    "body": "I will test now on Cygwin.",
    "created_at": "2017-10-05T16:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330379",
    "user": "https://github.com/embray"
}
```

I will test now on Cygwin.



---

archive/issue_comments_330380.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-06T12:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330380",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_330381.json:
```json
{
    "body": "\n```\n[fricas-1.3.2] Thread model: posix\n[fricas-1.3.2] gcc version 5.4.0 (GCC)\n[fricas-1.3.2] ****************************************************\n[fricas-1.3.2] checking build system type... x86_64-cygwin\n[fricas-1.3.2] configure: error: invalid value of canonical build\n[fricas-1.3.2] Error configuring fricas.\n[fricas-1.3.2]\n[fricas-1.3.2] real     0m1.548s\n[fricas-1.3.2] user     0m0.347s\n[fricas-1.3.2] sys      0m1.101s\n```\n\n\nI'll investigate. I have some suspicions...",
    "created_at": "2017-10-06T12:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330381",
    "user": "https://github.com/embray"
}
```


```
[fricas-1.3.2] Thread model: posix
[fricas-1.3.2] gcc version 5.4.0 (GCC)
[fricas-1.3.2] ****************************************************
[fricas-1.3.2] checking build system type... x86_64-cygwin
[fricas-1.3.2] configure: error: invalid value of canonical build
[fricas-1.3.2] Error configuring fricas.
[fricas-1.3.2]
[fricas-1.3.2] real     0m1.548s
[fricas-1.3.2] user     0m0.347s
[fricas-1.3.2] sys      0m1.101s
```


I'll investigate. I have some suspicions...



---

archive/issue_comments_330382.json:
```json
{
    "body": "As I suspected, the problem is a buggy/outdated `config.guess`.  I'm not sure how we want to go about fixing that.  The simplest way is to just include an up-to-date version and copy it over...",
    "created_at": "2017-10-06T12:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330382",
    "user": "https://github.com/embray"
}
```

As I suspected, the problem is a buggy/outdated `config.guess`.  I'm not sure how we want to go about fixing that.  The simplest way is to just include an up-to-date version and copy it over...



---

archive/issue_comments_330383.json:
```json
{
    "body": "Weirdly, last time FriCAS [updated their `config.guess`](https://sourceforge.net/p/fricas/code/2251/), the version it was updated to does not correspond exactly with the [upstream `config.guess` from the same date](http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob;f=config.guess;h=1f5c50c0d1529d50b94dc3533ca72a47f0fa5849;hb=47681e2a9b5e8236e38cffe03c85e571782fc080), almost as if it were hand-edited and mistakes were made.",
    "created_at": "2017-10-06T12:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330383",
    "user": "https://github.com/embray"
}
```

Weirdly, last time FriCAS [updated their `config.guess`](https://sourceforge.net/p/fricas/code/2251/), the version it was updated to does not correspond exactly with the [upstream `config.guess` from the same date](http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob;f=config.guess;h=1f5c50c0d1529d50b94dc3533ca72a47f0fa5849;hb=47681e2a9b5e8236e38cffe03c85e571782fc080), almost as if it were hand-edited and mistakes were made.



---

archive/issue_comments_330384.json:
```json
{
    "body": "I forwarded your observation to the FriCAS mailing list...",
    "created_at": "2017-10-06T12:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330384",
    "user": "https://github.com/mantepse"
}
```

I forwarded your observation to the FriCAS mailing list...



---

archive/issue_comments_330385.json:
```json
{
    "body": "It's also strange that they updated that file in **2017** to a version from **2014**.",
    "created_at": "2017-10-06T13:15:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330385",
    "user": "https://github.com/jdemeyer"
}
```

It's also strange that they updated that file in **2017** to a version from **2014**.



---

archive/issue_comments_330386.json:
```json
{
    "body": "Replying to [comment:34 embray]:\n> The simplest way is to just include an up-to-date version and copy it over...\n\nWe already do that for several packages. See `ccache` (#23710) for one example.",
    "created_at": "2017-10-06T13:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330386",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:34 embray]:
> The simplest way is to just include an up-to-date version and copy it over...

We already do that for several packages. See `ccache` (#23710) for one example.



---

archive/issue_comments_330387.json:
```json
{
    "body": "Replying to [comment:35 embray]:\n> almost as if it were hand-edited and mistakes were made.\n\nIt could be that they used a version from a (Linux) distribution, which might ship a patched version. That might also explain the discrepancy in the year, if the latest version shipped by that distro is from 2014.",
    "created_at": "2017-10-06T13:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330387",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:35 embray]:
> almost as if it were hand-edited and mistakes were made.

It could be that they used a version from a (Linux) distribution, which might ship a patched version. That might also explain the discrepancy in the year, if the latest version shipped by that distro is from 2014.



---

archive/issue_comments_330388.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-06T13:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_330389.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-06T13:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330389",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_330390.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-06T14:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330390",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_330391.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/interfaces/fricas.py\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 313, in sage.interfaces.fricas.FriCAS._quit_string\nFailed example:\n    pr.children()                                                 # optional - fricas\nExpected:\n    [<psutil.Process(pid=..., name='AXIOMsys') at ...>,\n     <psutil.Process(pid=..., name='session') at ...>,\n     <psutil.Process(pid=..., name='spadclient') at ...>,\n     <psutil.Process(pid=..., name='sman') at ...>]\nGot:\n    [<psutil.Process(pid=9800, name='session') at 7660406796560>,\n     <psutil.Process(pid=19536, name='spadclient') at 7660406797648>,\n     <psutil.Process(pid=21068, name='AXIOMsys') at 7660406797712>,\n     <psutil.Process(pid=21532, name='sman') at 7660406797776>]\n```\n\n\nIt seems psutil is sorting the processes by pid, so there's no way to guarantee what order they're in.  I don't know what this test is for or if it's important but if it really is then it should sort these processes by name.",
    "created_at": "2017-10-06T14:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330391",
    "user": "https://github.com/embray"
}
```


```
sage -t --long src/sage/interfaces/fricas.py
**********************************************************************
File "src/sage/interfaces/fricas.py", line 313, in sage.interfaces.fricas.FriCAS._quit_string
Failed example:
    pr.children()                                                 # optional - fricas
Expected:
    [<psutil.Process(pid=..., name='AXIOMsys') at ...>,
     <psutil.Process(pid=..., name='session') at ...>,
     <psutil.Process(pid=..., name='spadclient') at ...>,
     <psutil.Process(pid=..., name='sman') at ...>]
Got:
    [<psutil.Process(pid=9800, name='session') at 7660406796560>,
     <psutil.Process(pid=19536, name='spadclient') at 7660406797648>,
     <psutil.Process(pid=21068, name='AXIOMsys') at 7660406797712>,
     <psutil.Process(pid=21532, name='sman') at 7660406797776>]
```


It seems psutil is sorting the processes by pid, so there's no way to guarantee what order they're in.  I don't know what this test is for or if it's important but if it really is then it should sort these processes by name.



---

archive/issue_comments_330392.json:
```json
{
    "body": "(Build works for me now; thanks)",
    "created_at": "2017-10-06T14:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330392",
    "user": "https://github.com/embray"
}
```

(Build works for me now; thanks)



---

archive/issue_comments_330393.json:
```json
{
    "body": "This test is part of an effort to make sure that FriCAS is really shut down when quitting.  This is actually an unsolved problem, it doesn't work reliably.  Taking into account your observation, the following would make it pass:\n\n```\n            sage: import psutil                                                 # optional - fricas\n            sage: p = fricas.pid(); pr = psutil.Process(p); pr                  # optional - fricas\n            <psutil.Process(pid=..., name='sman') at ...>\n            sage: sorted(pr.children(), key = lambda c: c.name())               # optional - fricas\n            [<psutil.Process(pid=..., name='AXIOMsys') at ...>,\n             <psutil.Process(pid=..., name='session') at ...>,\n             <psutil.Process(pid=..., name='spadclient') at ...>,\n             <psutil.Process(pid=..., name='sman') at ...>]\n            sage: fricas.quit()                                                 # optional - fricas\n            sage: pr.is_running()                                               # optional - fricas, random\n            False\n```\n\nHowever, note that tag `random` in the last line - it turns out that frequently, FriCAS doesn't really stop - only the child processes are gone.  Actually, we could append\n\n```\n            sage: pr.children() if pr.is_running() # optional - fricas\n            []\n```\n\nas final test.",
    "created_at": "2017-10-06T14:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330393",
    "user": "https://github.com/mantepse"
}
```

This test is part of an effort to make sure that FriCAS is really shut down when quitting.  This is actually an unsolved problem, it doesn't work reliably.  Taking into account your observation, the following would make it pass:

```
            sage: import psutil                                                 # optional - fricas
            sage: p = fricas.pid(); pr = psutil.Process(p); pr                  # optional - fricas
            <psutil.Process(pid=..., name='sman') at ...>
            sage: sorted(pr.children(), key = lambda c: c.name())               # optional - fricas
            [<psutil.Process(pid=..., name='AXIOMsys') at ...>,
             <psutil.Process(pid=..., name='session') at ...>,
             <psutil.Process(pid=..., name='spadclient') at ...>,
             <psutil.Process(pid=..., name='sman') at ...>]
            sage: fricas.quit()                                                 # optional - fricas
            sage: pr.is_running()                                               # optional - fricas, random
            False
```

However, note that tag `random` in the last line - it turns out that frequently, FriCAS doesn't really stop - only the child processes are gone.  Actually, we could append

```
            sage: pr.children() if pr.is_running() # optional - fricas
            []
```

as final test.



---

archive/issue_comments_330394.json:
```json
{
    "body": "As it turns out, also that test fails.  When doctesting, after `fricas.quit()` only some processes are gone immediately.",
    "created_at": "2017-10-06T16:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330394",
    "user": "https://github.com/mantepse"
}
```

As it turns out, also that test fails.  When doctesting, after `fricas.quit()` only some processes are gone immediately.



---

archive/issue_comments_330395.json:
```json
{
    "body": "Replying to [comment:36 mantepse]:\n> I forwarded your observation to the FriCAS mailing list...\n\nIf you have a link to that post, it would be good to put it on this ticket.",
    "created_at": "2017-10-07T08:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330395",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:36 mantepse]:
> I forwarded your observation to the FriCAS mailing list...

If you have a link to that post, it would be good to put it on this ticket.



---

archive/issue_comments_330396.json:
```json
{
    "body": "I notified upstream, maybe we should remind them before they make the next release:\n\nhttps://groups.google.com/d/msg/fricas-devel/cmhTjr8IxPU/tY_Idyf2AQAJ\n\nI am currently recompiling sage, to try the suggestion to start fricas with `-nosman`.",
    "created_at": "2017-10-07T08:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330396",
    "user": "https://github.com/mantepse"
}
```

I notified upstream, maybe we should remind them before they make the next release:

https://groups.google.com/d/msg/fricas-devel/cmhTjr8IxPU/tY_Idyf2AQAJ

I am currently recompiling sage, to try the suggestion to start fricas with `-nosman`.



---

archive/issue_comments_330397.json:
```json
{
    "body": "For some reason, using `-nosman` doesn't work.  I can start fricas on the command line with `fricas -nosman`, and in sage manually, but for some reason it breaks the interface :-(",
    "created_at": "2017-10-07T09:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330397",
    "user": "https://github.com/mantepse"
}
```

For some reason, using `-nosman` doesn't work.  I can start fricas on the command line with `fricas -nosman`, and in sage manually, but for some reason it breaks the interface :-(



---

archive/issue_comments_330398.json:
```json
{
    "body": "The issue is a difference in newlines: on linux, with `fricas -nosman`, I have\n\n```\nsage: fricas.eval(\"1+1\", reformat=False)\n'\\n|startAlgebraOutput|\\n   2\\n|endOfAlgebraOutput|'\n```\n\nwhereas with `fricas -nox -noclef`, I have\n\n```\nsage: fricas.eval(\"1+1\", reformat=False)\n'\\r\\n|startAlgebraOutput|\\r\\n   2\\r\\n|endOfAlgebraOutput|\\r'\n```\n\nI'm not sure what the right fix is.  I think I'll replace `\\r\\n` throughout with `\\n`.",
    "created_at": "2017-10-07T12:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330398",
    "user": "https://github.com/mantepse"
}
```

The issue is a difference in newlines: on linux, with `fricas -nosman`, I have

```
sage: fricas.eval("1+1", reformat=False)
'\n|startAlgebraOutput|\n   2\n|endOfAlgebraOutput|'
```

whereas with `fricas -nox -noclef`, I have

```
sage: fricas.eval("1+1", reformat=False)
'\r\n|startAlgebraOutput|\r\n   2\r\n|endOfAlgebraOutput|\r'
```

I'm not sure what the right fix is.  I think I'll replace `\r\n` throughout with `\n`.



---

archive/issue_comments_330399.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-07T13:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330399",
    "user": "https://github.com/mantepse"
}
```

New commits:



---

archive/issue_comments_330400.json:
```json
{
    "body": "Apparently, I cannot push anymore.  Well, it's working now, I'll try to attach a patch.",
    "created_at": "2017-10-07T13:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330400",
    "user": "https://github.com/mantepse"
}
```

Apparently, I cannot push anymore.  Well, it's working now, I'll try to attach a patch.



---

archive/issue_comments_330401.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-07T18:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330401",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_330402.json:
```json
{
    "body": "should work now! please test on cygwin and MacOS X - I modified the handling of newlines!",
    "created_at": "2017-10-07T18:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330402",
    "user": "https://github.com/mantepse"
}
```

should work now! please test on cygwin and MacOS X - I modified the handling of newlines!



---

archive/issue_comments_330403.json:
```json
{
    "body": "tested on FreeBSD 11 with clang (thus pretty close to OSX) (cf #22679), all tests in `src/sage/interfaces/fricas.py` pass.",
    "created_at": "2017-10-08T10:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330403",
    "user": "https://github.com/dimpase"
}
```

tested on FreeBSD 11 with clang (thus pretty close to OSX) (cf #22679), all tests in `src/sage/interfaces/fricas.py` pass.



---

archive/issue_comments_330404.json:
```json
{
    "body": "ping?",
    "created_at": "2017-10-16T05:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330404",
    "user": "https://github.com/mantepse"
}
```

ping?



---

archive/issue_comments_330405.json:
```json
{
    "body": "I'll test on OSX later today.",
    "created_at": "2017-10-18T10:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330405",
    "user": "https://github.com/dimpase"
}
```

I'll test on OSX later today.



---

archive/issue_comments_330406.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-19T08:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330406",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_330407.json:
```json
{
    "body": "OK, all good on OSX.",
    "created_at": "2017-10-19T08:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330407",
    "user": "https://github.com/dimpase"
}
```

OK, all good on OSX.



---

archive/issue_comments_330408.json:
```json
{
    "body": "LGTM now that that one test is fixed.",
    "created_at": "2017-10-19T14:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330408",
    "user": "https://github.com/embray"
}
```

LGTM now that that one test is fixed.



---

archive/issue_comments_330409.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-21T19:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23610",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23610#issuecomment-330409",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
