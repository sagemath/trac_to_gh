# Issue 22519: Python3 is broken on OS X

archive/issues_022519.json:
```json
{
    "body": "On OS X:\n\n```\n$ sage --sh\n$ python3\nFatal Python error: Py_Initialize: unable to load the file system codec\n  File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python/encodings/__init__.py\", line 123\n    raise CodecRegistryError,\\\n                            ^\nSyntaxError: invalid syntax\n\nCurrent thread 0x00007fff76225000 (most recent call first):\nAbort trap: 6\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22756\n\n",
    "created_at": "2017-04-04T21:39:20Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Python3 is broken on OS X",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22519",
    "user": "https://github.com/jhpalmieri"
}
```
On OS X:

```
$ sage --sh
$ python3
Fatal Python error: Py_Initialize: unable to load the file system codec
  File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python/encodings/__init__.py", line 123
    raise CodecRegistryError,\
                            ^
SyntaxError: invalid syntax

Current thread 0x00007fff76225000 (most recent call first):
Abort trap: 6
```


Issue created by migration from https://trac.sagemath.org/ticket/22756





---

archive/issue_comments_313430.json:
```json
{
    "body": "Here is a start, but it doesn't fix the problem with Python 2 breaking Python 3, since I don't know what's going on. I bumped the version number to force a rebuild, since anyone using OS X is likely to currently have a broken Python 3 build.\n----\nNew commits:",
    "created_at": "2017-04-05T03:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313430",
    "user": "https://github.com/jhpalmieri"
}
```

Here is a start, but it doesn't fix the problem with Python 2 breaking Python 3, since I don't know what's going on. I bumped the version number to force a rebuild, since anyone using OS X is likely to currently have a broken Python 3 build.
----
New commits:



---

archive/issue_comments_313431.json:
```json
{
    "body": "By the way, some of the changes were just to decrease differences between the `spkg-install` scripts for `python2` and `python3`. There is two parts in the `python2` script which is not in `python3`:\n\n```\n# Use EXTRA_CFLAGS for user-defined CFLAGS since Python puts its own\n# default flags like -O3 after CFLAGS but before EXTRA_CFLAGS.\n# We also disable warnings about unused variables/functions which are\n# common in Cython-generated code.\nexport EXTRA_CFLAGS=\"`testcflags.sh -Wno-unused` $CFLAGS\"\nunset CFLAGS\n```\n\nand the lines surrounding\n\n```\n    cp -rp \"${xcode}\"/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift-migrator/sdk/MacOSX.sdk/usr/include/openssl \"$CUR\"/include\n```\n\nThis second one is broken even for `python2`, so no need to do it for `python3`. I don't know about the first chunk.",
    "created_at": "2017-04-05T03:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313431",
    "user": "https://github.com/jhpalmieri"
}
```

By the way, some of the changes were just to decrease differences between the `spkg-install` scripts for `python2` and `python3`. There is two parts in the `python2` script which is not in `python3`:

```
# Use EXTRA_CFLAGS for user-defined CFLAGS since Python puts its own
# default flags like -O3 after CFLAGS but before EXTRA_CFLAGS.
# We also disable warnings about unused variables/functions which are
# common in Cython-generated code.
export EXTRA_CFLAGS="`testcflags.sh -Wno-unused` $CFLAGS"
unset CFLAGS
```

and the lines surrounding

```
    cp -rp "${xcode}"/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift-migrator/sdk/MacOSX.sdk/usr/include/openssl "$CUR"/include
```

This second one is broken even for `python2`, so no need to do it for `python3`. I don't know about the first chunk.



---

archive/issue_comments_313432.json:
```json
{
    "body": "The error with `python3` seems to be that the first python to build gets the link python to python$version. So the problem is that `python2.7/encodings/__init__.py` is not compatible with python3. Not sure what's happening to python2 when python3 is build first. It is a bit strange that it uses the link rather than the fully versioned directory. And obviously it doesn't happen on linux, or does it?",
    "created_at": "2017-04-05T04:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313432",
    "user": "https://github.com/kiwifb"
}
```

The error with `python3` seems to be that the first python to build gets the link python to python$version. So the problem is that `python2.7/encodings/__init__.py` is not compatible with python3. Not sure what's happening to python2 when python3 is build first. It is a bit strange that it uses the link rather than the fully versioned directory. And obviously it doesn't happen on linux, or does it?



---

archive/issue_comments_313433.json:
```json
{
    "body": "You're right. If I build `python3` first, then its `sys.path` does not contain `local/lib/python`, but if I build it after `python2`, then the `python3` `sys.path` does contain this. Why? And why isn't this a problem on linux?",
    "created_at": "2017-04-05T05:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313433",
    "user": "https://github.com/jhpalmieri"
}
```

You're right. If I build `python3` first, then its `sys.path` does not contain `local/lib/python`, but if I build it after `python2`, then the `python3` `sys.path` does contain this. Why? And why isn't this a problem on linux?



---

archive/issue_comments_313434.json:
```json
{
    "body": "Do we need the symlink (in `local/lib`) `python2.7 -> python`, or can we get by with two directories `python2.7` and `python3.5`, no symlinks? It seems odd that we have to create it manually. If Python really needed it, it would create it on its own, wouldn't it?\n\nWell, I'll try building without and see what happens.",
    "created_at": "2017-04-05T05:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313434",
    "user": "https://github.com/jhpalmieri"
}
```

Do we need the symlink (in `local/lib`) `python2.7 -> python`, or can we get by with two directories `python2.7` and `python3.5`, no symlinks? It seems odd that we have to create it manually. If Python really needed it, it would create it on its own, wouldn't it?

Well, I'll try building without and see what happens.



---

archive/issue_comments_313435.json:
```json
{
    "body": "Removing the symlink works for me. See #22764. I've made that a dependency.",
    "created_at": "2017-04-05T21:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313435",
    "user": "https://github.com/jhpalmieri"
}
```

Removing the symlink works for me. See #22764. I've made that a dependency.



---

archive/issue_comments_313436.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-05T21:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313436",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_313437.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-05T22:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313438.json:
```json
{
    "body": "I am OK with this but I definitely want to wait for feedback on #22764.",
    "created_at": "2017-04-05T22:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313438",
    "user": "https://github.com/kiwifb"
}
```

I am OK with this but I definitely want to wait for feedback on #22764.



---

archive/issue_comments_313439.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-06T01:35:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313440.json:
```json
{
    "body": "With the branch here, I am having problems building `matplotlib` and `fpylll`. For `fpylll`, the log file consists entirely of\n\n```\nTraceback (most recent call last):\n  File \"setup.py\", line 131, in <module>\n    long_description=open('README.rst').read(),\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/encodings/ascii.py\", line 26, in decode\n    return codecs.ascii_decode(input, self.errors)[0]\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 2249: ordinal not in range(128)\nError: could not determine package name\n```\n\nThe `matplotlib` log starts with\n\n```\nNOTE: Set SAGE_MATPLOTLIB_GUI to anything but 'no' to try to build the Matplotlib GUI.\nNot building any matplotlib graphical backends.\nTraceback (most recent call last):\n  File \"make-setup-config.py\", line 34, in <module>\n    config.write(configfile)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/configparser.py\", line 916, in write\n    self._sections[section].items(), d)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/configparser.py\", line 920, in _write_section\n    fp.write(\"[{}]\\n\".format(section_name))\nTypeError: a bytes-like object is required, not 'str'\nWarning: This package has a badly-behaved setup.py which outputs\nmore than the package name for 'setup.py --name'; using the last\nline as the package name: matplotlib\nInstalling package matplotlib using pip\nWaiting for shared lock to run pip install --ignore-installed --verbose --no-deps --no-index --isolated . ... ok\nIgnoring indexes: https://pypi.python.org/simple\nProcessing /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/var/tmp/sage/build/matplotlib-1.5.1.p0/src\n  Running setup.py (path:/var/folders/cp/n8wtqs490tq5psknff1hv9qr0000gn/T/pip-9u0y0hgx-build/setup.py) egg_info for package from file:///Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/var/tmp/sage/build/matplotlib-1.5.1.p0/src\n    Running command python setup.py egg_info\n```\n\nand then proceeds to try to build. Then later it has this:\n\n```\n    gcc -Wno-unused-result -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -DPY_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib_backends__macosx_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/site-packages/numpy/core/include -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/site-packages/numpy/core/include -I/usr/local/include -I/usr/include -I/usr/X11/include -I/opt/X11/include -I. -Iextern/agg24-svn/include -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/include/python3.5m -c src/_macosx.m -o build/temp.macosx-10.9-x86_64-3.5/src/_macosx.o\n    gcc: error: src/_macosx.m: Objective-C compiler not installed on this system\n    error: command 'gcc' failed with exit status 1\n```\n\nI don't know if these are tied to the branch here or not, since I haven't been able to build python3 without the changes here.",
    "created_at": "2017-04-06T23:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313440",
    "user": "https://github.com/jhpalmieri"
}
```

With the branch here, I am having problems building `matplotlib` and `fpylll`. For `fpylll`, the log file consists entirely of

```
Traceback (most recent call last):
  File "setup.py", line 131, in <module>
    long_description=open('README.rst').read(),
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/encodings/ascii.py", line 26, in decode
    return codecs.ascii_decode(input, self.errors)[0]
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 2249: ordinal not in range(128)
Error: could not determine package name
```

The `matplotlib` log starts with

```
NOTE: Set SAGE_MATPLOTLIB_GUI to anything but 'no' to try to build the Matplotlib GUI.
Not building any matplotlib graphical backends.
Traceback (most recent call last):
  File "make-setup-config.py", line 34, in <module>
    config.write(configfile)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/configparser.py", line 916, in write
    self._sections[section].items(), d)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/configparser.py", line 920, in _write_section
    fp.write("[{}]\n".format(section_name))
TypeError: a bytes-like object is required, not 'str'
Warning: This package has a badly-behaved setup.py which outputs
more than the package name for 'setup.py --name'; using the last
line as the package name: matplotlib
Installing package matplotlib using pip
Waiting for shared lock to run pip install --ignore-installed --verbose --no-deps --no-index --isolated . ... ok
Ignoring indexes: https://pypi.python.org/simple
Processing /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/var/tmp/sage/build/matplotlib-1.5.1.p0/src
  Running setup.py (path:/var/folders/cp/n8wtqs490tq5psknff1hv9qr0000gn/T/pip-9u0y0hgx-build/setup.py) egg_info for package from file:///Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/var/tmp/sage/build/matplotlib-1.5.1.p0/src
    Running command python setup.py egg_info
```

and then proceeds to try to build. Then later it has this:

```
    gcc -Wno-unused-result -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -DPY_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib_backends__macosx_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/site-packages/numpy/core/include -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/lib/python3.5/site-packages/numpy/core/include -I/usr/local/include -I/usr/include -I/usr/X11/include -I/opt/X11/include -I. -Iextern/agg24-svn/include -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta0/local/include/python3.5m -c src/_macosx.m -o build/temp.macosx-10.9-x86_64-3.5/src/_macosx.o
    gcc: error: src/_macosx.m: Objective-C compiler not installed on this system
    error: command 'gcc' failed with exit status 1
```

I don't know if these are tied to the branch here or not, since I haven't been able to build python3 without the changes here.



---

archive/issue_comments_313441.json:
```json
{
    "body": "Hum... for matplotlib, that particular file is an objective-C module. We would have to build gcc with support for it or use native clang. fpylll should build with python3, although I am still at 3.4 in gentoo but I believe upstream tests 3.5. It feels like there is something missing in the python install regarding unicode support. Would have to check python's log.",
    "created_at": "2017-04-07T00:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313441",
    "user": "https://github.com/kiwifb"
}
```

Hum... for matplotlib, that particular file is an objective-C module. We would have to build gcc with support for it or use native clang. fpylll should build with python3, although I am still at 3.4 in gentoo but I believe upstream tests 3.5. It feels like there is something missing in the python install regarding unicode support. Would have to check python's log.



---

archive/issue_comments_313442.json:
```json
{
    "body": "I should have said: the problems with `matplotlib` and `fpylll` were when building Sage with `SAGE_PYTHON3=yes`. I think that may have been clear, but just in case.",
    "created_at": "2017-04-07T00:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313442",
    "user": "https://github.com/jhpalmieri"
}
```

I should have said: the problems with `matplotlib` and `fpylll` were when building Sage with `SAGE_PYTHON3=yes`. I think that may have been clear, but just in case.



---

archive/issue_comments_313443.json:
```json
{
    "body": "Was clear to me. My comments still stand.",
    "created_at": "2017-04-07T00:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313443",
    "user": "https://github.com/kiwifb"
}
```

Was clear to me. My comments still stand.



---

archive/issue_comments_313444.json:
```json
{
    "body": "Building `matplotlib` with `clang` works, by the way. It still has the `TypeError` at the beginning, which does seem like some kind of unicode thing.",
    "created_at": "2017-04-07T00:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313444",
    "user": "https://github.com/jhpalmieri"
}
```

Building `matplotlib` with `clang` works, by the way. It still has the `TypeError` at the beginning, which does seem like some kind of unicode thing.



---

archive/issue_comments_313445.json:
```json
{
    "body": "Attachment [python3-3.5.1.p0.log](tarball://root/attachments/some-uuid/ticket22756/python3-3.5.1.p0.log) by @jhpalmieri created at 2017-04-07 01:05:12",
    "created_at": "2017-04-07T01:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313445",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [python3-3.5.1.p0.log](tarball://root/attachments/some-uuid/ticket22756/python3-3.5.1.p0.log) by @jhpalmieri created at 2017-04-07 01:05:12



---

archive/issue_comments_313446.json:
```json
{
    "body": "Python 3 log attached. I noticed at the beginning:\n\n```\nconfigure: WARNING: unrecognized options: --enable-unicode, --disable-toolbox-glue\n```\n\nWe should probably remove those options, either here or on another ticket.",
    "created_at": "2017-04-07T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313446",
    "user": "https://github.com/jhpalmieri"
}
```

Python 3 log attached. I noticed at the beginning:

```
configure: WARNING: unrecognized options: --enable-unicode, --disable-toolbox-glue
```

We should probably remove those options, either here or on another ticket.



---

archive/issue_comments_313447.json:
```json
{
    "body": "May as well clean up here. I'll look at the log, I cannot find what is causing trouble with fpylll - unless it is in the weird link to the sagecell server.",
    "created_at": "2017-04-07T01:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313447",
    "user": "https://github.com/kiwifb"
}
```

May as well clean up here. I'll look at the log, I cannot find what is causing trouble with fpylll - unless it is in the weird link to the sagecell server.



---

archive/issue_comments_313448.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-07T01:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313449.json:
```json
{
    "body": "`fpylll` is a similar problem to https://github.com/theskumar/python-dotenv/issues/45. It could be linked to locale settings if I believe the last comment.\nAccording to file, the file is ASCII, but python thinks it has utf8 in it. \n----\nNew commits:\n----\nNew commits:",
    "created_at": "2017-04-07T01:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313449",
    "user": "https://github.com/kiwifb"
}
```

`fpylll` is a similar problem to https://github.com/theskumar/python-dotenv/issues/45. It could be linked to locale settings if I believe the last comment.
According to file, the file is ASCII, but python thinks it has utf8 in it. 
----
New commits:
----
New commits:



---

archive/issue_comments_313450.json:
```json
{
    "body": "If I do `./sage --sh` and then run `python3`, I don't get any errors if I execute the command `open('README.rst').read()` on the `README.rst` file from `fpylll`.\n\nEdit: also no errors if I execute `open('README.rst', encoding='ascii').read()`, `open('README.rst', encoding='utf8').read()`, `open('README.rst', encoding='latin1').read()`",
    "created_at": "2017-04-07T03:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313450",
    "user": "https://github.com/jhpalmieri"
}
```

If I do `./sage --sh` and then run `python3`, I don't get any errors if I execute the command `open('README.rst').read()` on the `README.rst` file from `fpylll`.

Edit: also no errors if I execute `open('README.rst', encoding='ascii').read()`, `open('README.rst', encoding='utf8').read()`, `open('README.rst', encoding='latin1').read()`



---

archive/issue_comments_313451.json:
```json
{
    "body": "Oh, wait: the encoding for the file `README.rst` from fpyll version 0.2.3dev is utf8, and that's the one that is causing problems. So it's a bug in fpyll. I think it's been fixed upstream: the version in 0.2.4dev is ascii.\n\nEdit: and 0.2.4dev is the one in Sage 8.0.beta1.",
    "created_at": "2017-04-07T03:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313451",
    "user": "https://github.com/jhpalmieri"
}
```

Oh, wait: the encoding for the file `README.rst` from fpyll version 0.2.3dev is utf8, and that's the one that is causing problems. So it's a bug in fpyll. I think it's been fixed upstream: the version in 0.2.4dev is ascii.

Edit: and 0.2.4dev is the one in Sage 8.0.beta1.



---

archive/issue_comments_313452.json:
```json
{
    "body": "With the change\n\n```diff\ndiff --git a/build/pkgs/matplotlib/make-setup-config.py b/build/pkgs/matplotlib/make-setup-config.py\nindex ad5a0c19ab..9a86586f9b 100644\n--- a/build/pkgs/matplotlib/make-setup-config.py\n+++ b/build/pkgs/matplotlib/make-setup-config.py\n@@ -30,5 +30,5 @@ config.add_section('gui_support')\n for backend in ('gtk', 'gtkagg', 'tkagg', 'wxagg', 'macosx', 'windowing'):\n     config.set('gui_support', backend,  graphical_backend)\n \n-with open('src/setup.cfg', 'wb') as configfile:\n+with open('src/setup.cfg', 'w') as configfile:\n     config.write(configfile)\n```\n\nI don't get the error at the start of the `matplotlib` log. I don't know what the 'b' is doing there in the first place, since `src/setup.cfg` looks like an ascii file.",
    "created_at": "2017-04-07T05:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313452",
    "user": "https://github.com/jhpalmieri"
}
```

With the change

```diff
diff --git a/build/pkgs/matplotlib/make-setup-config.py b/build/pkgs/matplotlib/make-setup-config.py
index ad5a0c19ab..9a86586f9b 100644
--- a/build/pkgs/matplotlib/make-setup-config.py
+++ b/build/pkgs/matplotlib/make-setup-config.py
@@ -30,5 +30,5 @@ config.add_section('gui_support')
 for backend in ('gtk', 'gtkagg', 'tkagg', 'wxagg', 'macosx', 'windowing'):
     config.set('gui_support', backend,  graphical_backend)
 
-with open('src/setup.cfg', 'wb') as configfile:
+with open('src/setup.cfg', 'w') as configfile:
     config.write(configfile)
```

I don't get the error at the start of the `matplotlib` log. I don't know what the 'b' is doing there in the first place, since `src/setup.cfg` looks like an ascii file.



---

archive/issue_comments_313453.json:
```json
{
    "body": "See #22772 for the `matplotlib` fix (eliminating the 'b').",
    "created_at": "2017-04-07T05:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313453",
    "user": "https://github.com/jhpalmieri"
}
```

See #22772 for the `matplotlib` fix (eliminating the 'b').



---

archive/issue_comments_313454.json:
```json
{
    "body": "By the way, the proposed change at #22772 means that we don't need to use `clang` to compile. Without this change, a configuration file is not written properly, and I think that led to the compilation problem. If you've tried building using python 3 on linux, I wonder if the matplotlib log shows a similar error there.",
    "created_at": "2017-04-07T05:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313454",
    "user": "https://github.com/jhpalmieri"
}
```

By the way, the proposed change at #22772 means that we don't need to use `clang` to compile. Without this change, a configuration file is not written properly, and I think that led to the compilation problem. If you've tried building using python 3 on linux, I wonder if the matplotlib log shows a similar error there.



---

archive/issue_comments_313455.json:
```json
{
    "body": "I was already thinking about fpylll 0.2.4, for curiosity I should check if I have logs for 0.2.3 exhibiting any weird behavior. Unltimately I believe our continued use of gcc on OS X is a band aid, but that's another story.",
    "created_at": "2017-04-07T09:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313455",
    "user": "https://github.com/kiwifb"
}
```

I was already thinking about fpylll 0.2.4, for curiosity I should check if I have logs for 0.2.3 exhibiting any weird behavior. Unltimately I believe our continued use of gcc on OS X is a band aid, but that's another story.



---

archive/issue_comments_313456.json:
```json
{
    "body": "Next I'm having trouble building `pynac`. Log file attached.",
    "created_at": "2017-04-07T14:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313456",
    "user": "https://github.com/jhpalmieri"
}
```

Next I'm having trouble building `pynac`. Log file attached.



---

archive/issue_comments_313457.json:
```json
{
    "body": "Attachment [pynac-0.7.5.log](tarball://root/attachments/some-uuid/ticket22756/pynac-0.7.5.log) by @kiwifb created at 2017-04-07 20:08:03\n\nThe mountain of messages about assembly is coming from using gcc instead of clang. May disappear by upgrading gcc (I don't know for sure).\n\nI have seen that before\n\n```\nIn file included from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/basic_ios.h:37:0,\n                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/ios:44,\n                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/ostream:38,\n                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/iostream:39,\n                 from class_info.h:31,\n                 from registrar.h:30,\n                 from basic.h:40,\n                 from numeric.h:49,\n                 from inifcns.h:26,\n                 from function_info.cpp:8:\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:247:53: error: macro \"toupper\" passed 2 arguments, but takes just 1\n       toupper(char_type *__lo, const char_type* __hi) const\n                                                     ^\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:276:53: error: macro \"tolower\" passed 2 arguments, but takes just 1\n       tolower(char_type* __lo, const char_type* __hi) const\n                                                     ^\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:819:53: error: macro \"toupper\" passed 2 arguments, but takes just 1\n       toupper(char_type *__lo, const char_type* __hi) const\n                                                     ^\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:852:53: error: macro \"tolower\" passed 2 arguments, but takes just 1\n       tolower(char_type* __lo, const char_type* __hi) const\n                                                     ^\n```\n\nMay take some time to track it back.\n\n\n```\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/python3.5m/pyport.h:704:29: error: 'btowc' is not a type\n #define tolower(c) towlower(btowc(c))\n                             ^\n```\n\nyes pyport.h, I fixed that in 2.7, and the fix was added in 2.7.13 upstream. May be we need to update to python-3.5.3. see #22147.",
    "created_at": "2017-04-07T20:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313457",
    "user": "https://github.com/kiwifb"
}
```

Attachment [pynac-0.7.5.log](tarball://root/attachments/some-uuid/ticket22756/pynac-0.7.5.log) by @kiwifb created at 2017-04-07 20:08:03

The mountain of messages about assembly is coming from using gcc instead of clang. May disappear by upgrading gcc (I don't know for sure).

I have seen that before

```
In file included from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/basic_ios.h:37:0,
                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/ios:44,
                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/ostream:38,
                 from /Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/iostream:39,
                 from class_info.h:31,
                 from registrar.h:30,
                 from basic.h:40,
                 from numeric.h:49,
                 from inifcns.h:26,
                 from function_info.cpp:8:
/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:247:53: error: macro "toupper" passed 2 arguments, but takes just 1
       toupper(char_type *__lo, const char_type* __hi) const
                                                     ^
/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:276:53: error: macro "tolower" passed 2 arguments, but takes just 1
       tolower(char_type* __lo, const char_type* __hi) const
                                                     ^
/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:819:53: error: macro "toupper" passed 2 arguments, but takes just 1
       toupper(char_type *__lo, const char_type* __hi) const
                                                     ^
/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/c++/5.4.0/bits/locale_facets.h:852:53: error: macro "tolower" passed 2 arguments, but takes just 1
       tolower(char_type* __lo, const char_type* __hi) const
                                                     ^
```

May take some time to track it back.


```
/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta1/local/include/python3.5m/pyport.h:704:29: error: 'btowc' is not a type
 #define tolower(c) towlower(btowc(c))
                             ^
```

yes pyport.h, I fixed that in 2.7, and the fix was added in 2.7.13 upstream. May be we need to update to python-3.5.3. see #22147.



---

archive/issue_comments_313458.json:
```json
{
    "body": "I see. As far as I can tell, your fix is not in Python 3.5. I'll try the patch and see what happens.",
    "created_at": "2017-04-07T20:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313458",
    "user": "https://github.com/jhpalmieri"
}
```

I see. As far as I can tell, your fix is not in Python 3.5. I'll try the patch and see what happens.



---

archive/issue_comments_313459.json:
```json
{
    "body": "That patch fixes it. I'll add it to this branch.",
    "created_at": "2017-04-07T22:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313459",
    "user": "https://github.com/jhpalmieri"
}
```

That patch fixes it. I'll add it to this branch.



---

archive/issue_comments_313460.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-07T22:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313461.json:
```json
{
    "body": "With these changes (and the changes listed at #22781), I can build almost all of Sage on OS X with `SAGE_PYTHON3=yes`. It breaks on the Sage library in an expected place (the use of `cmp` in `sage/rings/real_lazy.pyx` -- see #22257).\n\nEdit: oh, except for SageNB, the build of which is disabled for Python 3 in #22787.",
    "created_at": "2017-04-07T22:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313461",
    "user": "https://github.com/jhpalmieri"
}
```

With these changes (and the changes listed at #22781), I can build almost all of Sage on OS X with `SAGE_PYTHON3=yes`. It breaks on the Sage library in an expected place (the use of `cmp` in `sage/rings/real_lazy.pyx` -- see #22257).

Edit: oh, except for SageNB, the build of which is disabled for Python 3 in #22787.



---

archive/issue_comments_313462.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-08T16:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313463.json:
```json
{
    "body": "I think we may be in a state where we will be able to remove all the OS X work around of setting `CC=clang` by sage-8.0 and just default to build everything with `clang`. So in that regards we may want to start mopping up. Thoughts?",
    "created_at": "2017-04-13T01:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313463",
    "user": "https://github.com/kiwifb"
}
```

I think we may be in a state where we will be able to remove all the OS X work around of setting `CC=clang` by sage-8.0 and just default to build everything with `clang`. So in that regards we may want to start mopping up. Thoughts?



---

archive/issue_comments_313464.json:
```json
{
    "body": "Replying to [comment:37 fbissey]:\n> I think we may be in a state where we will be able to remove all the OS X work around of setting `CC=clang` by sage-8.0 and just default to build everything with `clang`. So in that regards we may want to start mopping up. Thoughts?\n\nI would prefer to put the mopping up on another ticket, once #12426 is ready to go, and merge this one soon (if possible), so that Python 3 can be built on OS X. Many of the changes here have to happen whether we default to `clang` or not.",
    "created_at": "2017-04-13T18:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313464",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:37 fbissey]:
> I think we may be in a state where we will be able to remove all the OS X work around of setting `CC=clang` by sage-8.0 and just default to build everything with `clang`. So in that regards we may want to start mopping up. Thoughts?

I would prefer to put the mopping up on another ticket, once #12426 is ready to go, and merge this one soon (if possible), so that Python 3 can be built on OS X. Many of the changes here have to happen whether we default to `clang` or not.



---

archive/issue_comments_313465.json:
```json
{
    "body": "Also, I am happy to review or work on any mopping up tickets.",
    "created_at": "2017-04-13T18:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313465",
    "user": "https://github.com/jhpalmieri"
}
```

Also, I am happy to review or work on any mopping up tickets.



---

archive/issue_comments_313466.json:
```json
{
    "body": "Changing component from packages: standard to python3.",
    "created_at": "2017-04-16T10:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313466",
    "user": "https://github.com/fchapoton"
}
```

Changing component from packages: standard to python3.



---

archive/issue_comments_313467.json:
```json
{
    "body": "ping?",
    "created_at": "2017-04-24T20:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313467",
    "user": "https://github.com/jhpalmieri"
}
```

ping?



---

archive/issue_comments_313468.json:
```json
{
    "body": "Sure, I think it can go in that state. Then I can some more stuff to both python2 and 3 later. Hope I can get around to it.",
    "created_at": "2017-04-24T22:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313468",
    "user": "https://github.com/kiwifb"
}
```

Sure, I think it can go in that state. Then I can some more stuff to both python2 and 3 later. Hope I can get around to it.



---

archive/issue_comments_313469.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-24T22:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313469",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_313470.json:
```json
{
    "body": "Thank you!\n\nRegarding clang and Python on OS X: I installed gcc 5.4.0 on a machine the other day, and then with #12426, `IS_CLANG` was set to 'no'. So if we remove parts of Python's spkg-install telling it to build with clang on OS X, Python might break. So although it would be nice to mop up, we have to be careful. (I'll try to test whether Python breaks if I use my own `gcc` to build it instead of Sage's gcc, which we know doesn't work, or clang, which does.)",
    "created_at": "2017-04-24T22:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313470",
    "user": "https://github.com/jhpalmieri"
}
```

Thank you!

Regarding clang and Python on OS X: I installed gcc 5.4.0 on a machine the other day, and then with #12426, `IS_CLANG` was set to 'no'. So if we remove parts of Python's spkg-install telling it to build with clang on OS X, Python might break. So although it would be nice to mop up, we have to be careful. (I'll try to test whether Python breaks if I use my own `gcc` to build it instead of Sage's gcc, which we know doesn't work, or clang, which does.)



---

archive/issue_comments_313471.json:
```json
{
    "body": "Replying to [comment:43 jhpalmieri]:\n> Thank you!\n> \n> Regarding clang and Python on OS X: I installed gcc 5.4.0 on a machine the other day, and then with #12426, `IS_CLANG` was set to 'no'. So if we remove parts of Python's spkg-install telling it to build with clang on OS X, Python might break. So although it would be nice to mop up, we have to be careful. (I'll try to test whether Python breaks if I use my own `gcc` to build it instead of Sage's gcc, which we know doesn't work, or clang, which does.)\n\nInteresting experience. #12426 can still be tweaked, but yes we may want to prevent users to shoot themselves too much in the foot. `python` is somewhat ok because it is C and not C++ you can compile it with clang and mostly use it with gcc. Anything that would require clang++ would be in a load of troubles.\n\nWhile I don't want to impose things too strongly, I am very much of a mind to put my foot down on the compiler to be used on OS X.",
    "created_at": "2017-04-24T22:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313471",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:43 jhpalmieri]:
> Thank you!
> 
> Regarding clang and Python on OS X: I installed gcc 5.4.0 on a machine the other day, and then with #12426, `IS_CLANG` was set to 'no'. So if we remove parts of Python's spkg-install telling it to build with clang on OS X, Python might break. So although it would be nice to mop up, we have to be careful. (I'll try to test whether Python breaks if I use my own `gcc` to build it instead of Sage's gcc, which we know doesn't work, or clang, which does.)

Interesting experience. #12426 can still be tweaked, but yes we may want to prevent users to shoot themselves too much in the foot. `python` is somewhat ok because it is C and not C++ you can compile it with clang and mostly use it with gcc. Anything that would require clang++ would be in a load of troubles.

While I don't want to impose things too strongly, I am very much of a mind to put my foot down on the compiler to be used on OS X.



---

archive/issue_comments_313472.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-24T22:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313472",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_313473.json:
```json
{
    "body": "Reviewer name...",
    "created_at": "2017-04-24T22:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313473",
    "user": "https://github.com/vbraun"
}
```

Reviewer name...



---

archive/issue_comments_313474.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-04-24T22:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313474",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_313475.json:
```json
{
    "body": "Sorry, I really should know better.",
    "created_at": "2017-04-24T22:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313475",
    "user": "https://github.com/kiwifb"
}
```

Sorry, I really should know better.



---

archive/issue_comments_313476.json:
```json
{
    "body": "Replying to [comment:44 fbissey]:\n> Interesting experience. #12426 can still be tweaked, but yes we may want to prevent users to shoot themselves too much in the foot. `python` is somewhat ok because it is C and not C++ you can compile it with clang and mostly use it with gcc. Anything that would require clang++ would be in a load of troubles.\n> \n> While I don't want to impose things too strongly, I am very much of a mind to put my foot down on the compiler to be used on OS X.\n\nRight now we build `python2`, `python3` (as of this ticket), `curl`, `psutil`, and `R` using clang rather than gcc, because of troubles with gcc. I'm going to disable the clang build for each of these to see what happens with my own gcc-5.4.0. I'll follow up with the results on #12426.",
    "created_at": "2017-04-24T22:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313476",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:44 fbissey]:
> Interesting experience. #12426 can still be tweaked, but yes we may want to prevent users to shoot themselves too much in the foot. `python` is somewhat ok because it is C and not C++ you can compile it with clang and mostly use it with gcc. Anything that would require clang++ would be in a load of troubles.
> 
> While I don't want to impose things too strongly, I am very much of a mind to put my foot down on the compiler to be used on OS X.

Right now we build `python2`, `python3` (as of this ticket), `curl`, `psutil`, and `R` using clang rather than gcc, because of troubles with gcc. I'm going to disable the clang build for each of these to see what happens with my own gcc-5.4.0. I'll follow up with the results on #12426.



---

archive/issue_comments_313477.json:
```json
{
    "body": "By the way, thank you for your help with this ticket. Many parts of the branch came from your suggestions.",
    "created_at": "2017-04-24T22:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313477",
    "user": "https://github.com/jhpalmieri"
}
```

By the way, thank you for your help with this ticket. Many parts of the branch came from your suggestions.



---

archive/issue_comments_313478.json:
```json
{
    "body": "Author name...",
    "created_at": "2017-04-25T17:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313478",
    "user": "https://github.com/vbraun"
}
```

Author name...



---

archive/issue_comments_313479.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-25T17:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313479",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_313480.json:
```json
{
    "body": "Replying to [comment:46 fbissey]:\n> Sorry, I really should know better.\n\nMe too.",
    "created_at": "2017-04-25T18:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313480",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:46 fbissey]:
> Sorry, I really should know better.

Me too.



---

archive/issue_comments_313481.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-04-25T18:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313481",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_021185.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2017-04-28T23:54:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22519#event-21185"
}
```



---

archive/issue_comments_313482.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-28T23:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22519#issuecomment-313482",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
