# Issue 23754: Update curl to 7.56.0

Issue created by migration from https://trac.sagemath.org/ticket/23991

Original creator: jhpalmieri

Original creation time: 2017-10-08 16:54:27

On at least one OS X High Sierra machine, Sage's current version of curl (7.53.1) does not build, while 7.56.0 does. So let's upgrade.

Tarball: https://curl.haxx.se/download/curl-7.56.0.tar.bz2


---

Comment by jhpalmieri created at 2017-10-08 16:55:20

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2017-10-08 16:55:20

New commits:


---

Comment by jhpalmieri created at 2017-10-08 16:56:37

One test in the testsuite fails for me:

```
[curl-7.56.0] test 1014...Mismatch in features lists:
[curl-7.56.0] curl:        asynchdns ipv6 libz multissl ntlm ntlm_wb ssl tls-srp unixsockets
[curl-7.56.0] curl-config: asynchdns https-proxy ipv6 libz multissl ntlm ntlm_wb ssl tls-srp unixsockets
[curl-7.56.0]  postcheck FAILED
```

But the testsuite has failed in the past for OS X: see #22686. So I don't think this should be an obstacle.


---

Comment by jhpalmieri created at 2017-10-08 18:12:34

On another machine the test suite passes, so maybe it's because I installed the Sage `openssl` package that is causing the failure.


---

Comment by ayyer created at 2017-10-17 06:11:05

Sorry if this is a newbie question. I'm trying to install patch #23898 on OSX High Sierra. Curl-7.53.1 fails for me too. I deleted the old version and downloaded curl-7.56.0 in the upstream folder and reran 

```
SAGE_INSTALL_GCC=yes make ptestlong
```

but it again downloaded curl-7.53.1 and gave the same error. What should I do to avoid this?
Thanks.


---

Comment by ayyer created at 2017-10-17 08:22:25

> but it again downloaded curl-7.53.1 and gave the same error. What should I do to avoid this?

I got this working by manually changing the two files as described in the ticket. Sorry for polluting the discussion.


---

Comment by dimpase created at 2017-10-18 08:53:21

Why do we need to build curl on OSX, is there a reason?

Isn't curl is in the set of command-line tools which are shipped by default, even without Xcode installed?


---

Comment by jdemeyer created at 2017-10-18 09:14:41

Replying to [comment:7 dimpase]:
> Why do we need to build curl on OSX, is there a reason?
> 
> Isn't curl is in the set of command-line tools which are shipped by default, even without Xcode installed?

curl isn't just a command-line program. Probably the other curl stuff (in particular the header files) isn't installed by default.


---

Comment by dimpase created at 2017-10-18 09:25:23

Oh, you are right. Sorry for noise.


---

Comment by jhpalmieri created at 2017-10-18 14:48:21

`/usr/include` is not present without Xcode and/or the command line tools. On a machine on which I've installed Xcode and the command line tools, I have `/usr/lib/libcurl.4.dylib` and a directory `/usr/include/curl` with various header files, so this might be good enough for what Sage needs. But we can think about that on another ticket.


---

Comment by jdemeyer created at 2017-10-18 15:03:56

Replying to [comment:10 jhpalmieri]:
> On a machine on which I've installed Xcode and the command line tools

...which you need anyway if you build Sage from source. That's good to know because it means that we can assume that those headers exist on OS X.


---

Comment by jhpalmieri created at 2017-10-18 15:57:46

Oh, it is also curl version 7.54.0, which is not that old.


---

Comment by jhpalmieri created at 2017-10-20 18:12:05

See #24081.


---

Comment by jhpalmieri created at 2017-10-20 18:12:30

(Let's keep this open because it might be worth upgrading curl anyway.)


---

Comment by jdemeyer created at 2017-10-31 10:59:33

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-10-31 10:59:33

Changing priority from critical to major.


---

Comment by jdemeyer created at 2017-10-31 11:09:47

7.56.0 -> 7.56.1
----
New commits:


---

Comment by jdemeyer created at 2017-10-31 11:09:47

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2017-10-31 11:12:37

Seems to work. John, I'll let you set positive_review if you agree.


---

Comment by jhpalmieri created at 2017-10-31 14:40:08

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2017-10-31 14:40:08

Builds and passes its test-suite.


---

Comment by vbraun created at 2017-11-02 11:06:00

Resolution: fixed
