# Issue 26103: polytopes.snub_cube should be set up with base_ring=QQ

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2018-09-22 20:13:35

CC:  nvcleemp jipilab @laisrast

`polytopes.snub_cube` uses a scaling that makes this polytope rational (though calculations of the vertices has to go through a field extension). See #25097.
But in contrast to other rational polytopes from the library, it is set up in RDF by default. 
This should be changed.


---

Comment by @LaisRast created at 2019-04-17 14:03:41

Changing keywords from "" to "snub_cube, polytopes".


---

Comment by @LaisRast created at 2019-04-17 14:03:41

Changing status from new to needs_review.


---

Comment by @LaisRast created at 2019-04-17 14:03:41

New commits:


---

Comment by vdelecroix created at 2019-04-18 20:02:01


```
sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst", line 770, in doc.en.thematic_tutorials.geometry.polyhedra_tutorial
Failed example:
    E = polytopes.snub_cube(); E
Expected:
    A 3-dimensional polyhedron in RDF^3 defined as the convex hull of 24 vertices
Got:
    A 3-dimensional polyhedron in (Number Field in z with defining polynomial x^3 + x^2 + x - 1)^3 defined as the convex hull of 24 vertices
**********************************************************************
1 item had failures:
   1 of 109 in doc.en.thematic_tutorials.geometry.polyhedra_tutorial
    [108 tests, 1 failure, 57.00 s]
----------------------------------------------------------------------
sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by vdelecroix created at 2019-04-18 20:02:01

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-04-18 20:20:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @LaisRast created at 2019-04-18 20:20:49

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2019-04-18 22:24:58

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2019-04-23 22:02:01

Changing status from positive_review to needs_work.


---

Comment by mkoeppe created at 2019-04-23 22:02:01

Fails its testsuite on Python 2.
Can't use `1/2` in the construction; it gives the float 0.5 (in the Python module, which uses `from __future__ import division`)


---

Comment by mkoeppe created at 2019-04-23 22:07:44

(On branch `public/25097/qnormaliz-algebraic` I also have an improvement of the snub cube construction, which handles the backend parameter. Perhaps the code should be combined.)


---

Comment by git created at 2019-04-24 15:52:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-04-24 17:28:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2019-04-24 17:30:26

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2019-04-25 02:13:38

Considering how long it takes to construct the polytope with `exact=True`, I think default should still be `exact=False`. However, I do like that the exact option is there for those who want it.


---

Comment by jipilab created at 2019-04-25 06:12:23

Replying to [comment:13 tscrim]:
> Considering how long it takes to construct the polytope with `exact=True`, I think default should still be `exact=False`. However, I do like that the exact option is there for those who want it.

The `normaliz` backend will soon accept number fields as base ring and this computation will take much less time, see #25097.

Once it is possible, I suggest to specify the backend `normaliz` with `exact=True` in the test...


---

Comment by tscrim created at 2019-04-25 07:19:09

Replying to [comment:14 jipilab]:
> Replying to [comment:13 tscrim]:
> > Considering how long it takes to construct the polytope with `exact=True`, I think default should still be `exact=False`. However, I do like that the exact option is there for those who want it.
> 
> The `normaliz` backend will soon accept number fields as base ring and this computation will take much less time, see #25097.
> 
> Once it is possible, I suggest to specify the backend `normaliz` with `exact=True` in the test...

I agree with this overall, but I would say you should have all 3 tests (`exact=False`, `exact=True` with `# long time`, and `exact=True` with `# optional - normaliz`) for good coverage.

Once #25097, you could have `exact=None`, which checks if `normaliz` is installed and does the exact if it is and the inexact if not. However, for now, I would again suggest staying with `exact=False` as the default.


---

Comment by git created at 2019-04-25 07:42:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2019-04-25 07:43:58

I agree with Travis and have changed it back to default `exact=False`.

Replying to [comment:15 tscrim]:
> I agree with this overall, but I would say you should have all 3 tests (`exact=False`, `exact=True` with `# long time`, and `exact=True` with `# optional - normaliz`) for good coverage.
Yes, on #25097 we already have all 3 tests.


---

Comment by jipilab created at 2019-04-25 14:10:13

Apart from the annoying convention in line


```diff
- - ``exact`` - (boolean, default ``False``) if ``True`` use exact
+ - ``exact`` -- (boolean, default ``False``) if ``True`` use exact
```


it looks good to go to me. If you fix this, you can set it to positive review on my behalf.


---

Comment by git created at 2019-04-25 14:13:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2019-04-25 14:14:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-04-29 12:36:07

Resolution: fixed
