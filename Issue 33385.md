# Issue 33385: Bug in computation of projective closure

Issue created by migration from https://trac.sagemath.org/ticket/33622

Original creator: davidloeffler

Original creation time: 2022-04-01 09:34:05

Sage offers the option to define subschemes of affine space using any term order on the underlying polynomial ring (not necessarily the default degrevlex order). However, the method `projective_closure` assumes the term order is a graded order, and returns wrong answers for non-graded orders, such as lex:

```
sage: Rlex.<x, y, z> = PolynomialRing(QQ, order='lex')
sage: Ilex = Rlex.ideal([y - z^2, x - z^3])
sage: Slex = AffineSpace(Rlex).subscheme(Ilex)

sage: Rdeg.<x, y, z> = PolynomialRing(QQ, order='degrevlex')
sage: Ideg = Rdeg.ideal([y - z^2, x - z^3])
sage: Sdeg = AffineSpace(Rdeg).subscheme(Ideg)

sage: Sdeg == Slex
True
sage: Sdeg.projective_closure() == Slex.projective_closure()
False
sage: Sdeg.projective_closure().defining_ideal().hilbert_polynomial()
3*t + 1
sage: Slex.projective_closure().defining_ideal().hilbert_polynomial()
6*t - 3
```

This is related to my last ticket #33614; the `projective_closure` method is making a decent stab at computing the ideal homogenization (rather than the feeble excuse for it that `I.homogenize()` computes) but the method it uses is invalid for non-graded term orders.
