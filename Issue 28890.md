# Issue 28890: Implement an affine basis for polytopes

Issue created by migration from https://trac.sagemath.org/ticket/29127

Original creator: @kliem

Original creation time: 2020-01-31 20:39:53

CC:  jipilab @laisrast

Keywords: polytopes, affine basis

Sometimes it is useful to obtain `dim + 1` vertices of a polytope in general position -- an affine basis.

With #29117, which provides a maximal chain of faces, we can easily obtain those vertices that are even guaranteed to be in general position for any realization of the polytope.

We apply this affine basis to simplify `is_inscribable`. This is also faster, as the current approach requires to compute all neighbors of a vertex (which can be pretty hard, even once this is done efficiently through combinatorial polyhedron):

Time without this ticket:

```
sage: P = polytopes.hypercube(8)
sage: %time P.is_inscribed()
CPU times: user 17.5 s, sys: 32.4 ms, total: 17.5 s
Wall time: 17.5 s
True
```

Time with this ticket:

```
sage: P = polytopes.hypercube(8)
sage: %time P.is_inscribed()
CPU times: user 17.5 ms, sys: 10 Âµs, total: 17.5 ms
Wall time: 17.4 ms
True
```


Follow ups:

- We use this to fix #29116.
- We implement `is_affinely_isomorphic`.


---

Comment by @kliem created at 2020-01-31 20:49:42

New commits:


---

Comment by @kliem created at 2020-01-31 20:49:42

Changing status from new to needs_review.


---

Comment by git created at 2020-01-31 21:20:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-02-19 08:24:16

New commits:


---

Comment by @LaisRast created at 2020-02-28 10:01:10

Some typos

```diff
-        in the face lattices and picking for each cover relation
-        on vertex that is in the difference. Thus this method
+        in the face lattice and picking for each cover relationa
+        one vertex that is in the difference. Thus this method
```



```
        # We just in the folling that element in ``chain_indices`` is a sorted list
        # of V-indices.
```


Since you also implemented an_affine_basis for Polyhedron, maybe it is better to use it.
Doing so, you can remove the following part of your code and thus making the code easier to read.
I am saying this because if you use an_affine_basis for Polyhedron, you will have the whole polyhedron as a face.

```
        # Finally append some vertex not contained in ``face``,
        # which is a facet of ``self`` now.
        for i in range(len(face)):
            if face[i] != i:
                basis_indices.append(i)
                break
        else:  # no break
            basis_indices.append(len(face))
+}}}


---

Comment by @LaisRast created at 2020-02-28 10:01:10

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-02-28 10:28:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-02-28 10:32:13

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-02-28 10:36:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @LaisRast created at 2020-02-28 10:40:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-03-01 23:46:02

Resolution: fixed
