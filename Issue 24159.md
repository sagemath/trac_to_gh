# Issue 24159: test failure in manifolds/differentiable/tensorfield.py (8.2.beta0)

Issue created by migration from https://trac.sagemath.org/ticket/24396

Original creator: vdelecroix

Original creation time: 2017-12-16 21:43:48

CC:  â€‹egourgoulhon

On Ubuntu with no optional package and 8.2.beta0 compiled from source

```
sage -t manifolds/differentiable/tensorfield.py
**********************************************************************
File "manifolds/differentiable/tensorfield.py", line 295, in sage.manifolds.differentiable.tensorfield.TensorField
Failed example:
    t[eV,1,1,c_uv].expr()
Exception raised:
    Traceback (most recent call last):
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 517, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 920, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.manifolds.differentiable.tensorfield.TensorField[36]>", line 1, in <module>
        t[eV,Integer(1),Integer(1),c_uv].expr()
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield.py", line 1472, in __getitem__
        return self.comp(frame)[args]
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield.py", line 1235, in comp
        return rst.comp(basis=basis, from_basis=from_basis)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield_paral.py", line 921, in comp
        from_basis=from_basis)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/tensor/modules/free_module_tensor.py", line 1076, in components
        "the components in the {}".format(basis))
    ValueError: no basis could be found for computing the components in the Coordinate frame (V, (d/du,d/dv))
**********************************************************************
File "manifolds/differentiable/tensorfield.py", line 298, in sage.manifolds.differentiable.tensorfield.TensorField
Failed example:
    type(t[eV,1,1,c_uv].expr())
Exception raised:
    Traceback (most recent call last):
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 517, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 920, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.manifolds.differentiable.tensorfield.TensorField[37]>", line 1, in <module>
        type(t[eV,Integer(1),Integer(1),c_uv].expr())
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield.py", line 1472, in __getitem__
        return self.comp(frame)[args]
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield.py", line 1235, in comp
        return rst.comp(basis=basis, from_basis=from_basis)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield_paral.py", line 921, in comp
        from_basis=from_basis)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/tensor/modules/free_module_tensor.py", line 1076, in components
        "the components in the {}".format(basis))
    ValueError: no basis could be found for computing the components in the Coordinate frame (V, (d/du,d/dv))
**********************************************************************
File "manifolds/differentiable/tensorfield.py", line 318, in sage.manifolds.differentiable.tensorfield.TensorField
Failed example:
    f = t(a,b)
Exception raised:
    Traceback (most recent call last):
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 517, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 920, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.manifolds.differentiable.tensorfield.TensorField[46]>", line 1, in <module>
        f = t(a,b)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield.py", line 2348, in __call__
        resu_rr = self_rr(*args_rr)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/manifolds/differentiable/tensorfield_paral.py", line 1461, in __call__
        return FreeModuleTensor.__call__(self_r, *args_r)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/tensor/modules/free_module_tensor.py", line 2130, in __call__
        raise ValueError("no common basis for the components")
    ValueError: no common basis for the components
Killing test manifolds/differentiable/tensorfield.py
----------------------------------------------------------------------
Doctests interrupted: 0/1 files tested
----------------------------------------------------------------------
Total time for all tests: 26.5 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```



---

Comment by vdelecroix created at 2017-12-16 23:09:11

Changing priority from major to blocker.


---

Comment by vdelecroix created at 2017-12-16 23:09:11

Changing component from geometry to documentation.


---

Comment by vdelecroix created at 2017-12-16 23:13:27

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2017-12-16 23:13:27

New commits:


---

Comment by egourgoulhon created at 2017-12-19 09:29:46

Thank you for the fix!


---

Comment by egourgoulhon created at 2017-12-19 09:29:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-12-22 23:29:46

Resolution: fixed
