# Issue 24314: py3: defining __eq__ breaks inheritance of __hash__

archive/issues_024314.json:
```json
{
    "body": "CC:  @jdemeyer @tscrim @kiwifb @embray @vinklein zerline\n\nThis is potentially a large-scale problem, as can be seen using\n\n```\ngrep -L \"def __hash__\" $(git grep -l \"def __eq__\" ) \n```\n\nTODO LIST (extracted from errors on sage/python3 testsuite):\n| **Ticket** | **Module**           | Notes |\n|:------------:|:----------------------:|:-------:|\n|#25935|AbelianGroupWithValues_class_with_category|group|\n|#25935|AbelianGroup_class_with_category|group|\n|#26162|AlternatingGroup_with_category|group|\n|#26058|BruhatTitsHarmonicCocycles_with_category||\n|#26145|CartesianProduct_with_category.element_class|product|\n|#25940|ChainComplex_class_with_category||\n|#25935|ClassGroup_with_category|group|\n|#26192|CompositeConstructionFunctor|functor|\n|#26061|CrystalOfAlcovePaths_with_category.element_class||\n|#26087|CycleIndexSeriesRing_class_with_category||\n|#26162|CyclicPermutationGroup_with_category|group|\n|#26162|DiCyclicGroup_with_category|group|\n|#26162|DihedralGroup_with_category|group|\n|#26088|EisensteinExtensionFieldCappedRelative_with_category||\n|#26088|EisensteinExtensionRingCappedAbsolute_with_category||\n|#26088|EisensteinExtensionRingCappedRelative_with_category||\n|#26088|EisensteinExtensionRingFixedMod_with_category||\n|#26179|FiniteWord_list||\n|#26179|FiniteWord_str||\n|#26179|FiniteWord_tuple||\n|#26167|Gamma0_class_with_category|group|\n|#26167|Gamma1_class_with_category|group|\n|#26167|GammaH_class_with_category|group|\n|#26167|Gamma_class_with_category|group|\n|#26063|HammingCode_with_category||\n|#25946|HyperellipticCurve_g2_padic_field_with_category||\n|#25946|HyperellipticCurve_g2_rational_field_with_category||\n|#25946|HyperellipticCurve_padic_field_with_category||\n|#25946|HyperellipticCurve_rational_field_with_category||\n|#26094|IdealMonoid_c_with_category|ideal, maybe fixed in #26094|\n|#26192|InfinitePolynomialFunctor|functor|\n|#26162|KleinFourGroup_with_category|group|\n|#26162|MathieuGroup_with_category|group|\n|#26093|ModularSymbolsAmbient_wtk_eps_with_category||\n|#26145|MultivariateProduct_with_category.element_class|product|\n|#26094|NCPolynomialIdeal|ideal|\n|#26162|PGL_with_category|group|\n|#26162|PSL_with_category|group|\n|#26158|Partitions_with_constraints_with_category||\n|#26165|PolynomialQuotientRing_domain_with_category||\n|#26165|PolynomialQuotientRing_field_with_category||\n|#26165|PolynomialQuotientRing_generic_with_category||\n||PrimitiveGroup_with_category|fixed somewhere in 8.4.b4|\n|#26163|QuaternionFractionalIdeal_rational|ideal|\n|#26162|QuaternionGroup_with_category|group|\n|#26167|SL2Z_class_with_category|group|\n|#26062|ShiftedPrimedTableaux_shape_with_category.element_class||\n||SimplicialSetMorphism|Fixed somewhere in 8.4.b3|\n|#26089|SmoothCharacterGroupQp_with_category|group|\n|#26089|SmoothCharacterGroupRamifiedQuadratic_with_category|group|\n|#26089|SmoothCharacterGroupUnramifiedQuadratic_with_category|group|\n|#26092|SubsetsSorted_with_category||\n|#26092|Subsets_sk_with_category||\n|#26064|SymbolicConstantsSubring_with_category||\n|#26162|SymmetricGroup_with_category|group|\n|#26162|TransitiveGroup_with_category|group|\n|#26145|UnivariateProduct_with_category.element_class|product|\n|#26088|UnramifiedExtensionFieldCappedRelative_with_category||\n|#26088|UnramifiedExtensionRingCappedAbsolute_with_category||\n|#26088|UnramifiedExtensionRingCappedRelative_with_category||\n|#26088|UnramifiedExtensionRingFixedMod_with_category||\n|#26058|pAdicAutomorphicForms_with_category||\n||sage.rings.padics.qadic_flint_CR.qAdicCappedRelativeElement|Not relevant (appears as an expected result)|\nNew failures in 8.4.beta3:\n| **Ticket** | **Module**           | Notes |\n|:------------:|:----------------------:|:-------:|\n|#26181|Cusps_class||\n|#26177|GRSGaoDecoder||\n|#26177|LinearCodeSyndromeDecoder||\n|#26193|MyModule_with_category||\n|#26198|TestParent4_with_category||\nRemains in 8.4.b4:\n| **Ticket** | **Module**           | Notes |\n|:------------:|:----------------------:|:-------:|\n|#26221|FreeMonoid_class_with_category||\n|#26218|IntegerVectorsConstraints_with_category||\n|#26261|MPolynomial_polydict||\n|#26091|ProjectiveSpace_rational_field_with_category||\n|#26091|ProjectiveSpace_ring_with_category||\n|#26260|ProductProjectiveSpaces_ring_with_category||\nRemains in 8.4.b5\n\n||                                               |                            |\n||-----------------------------------------------|----------------------------|\n||Bitset objects are unhashable; use FrozenBitset|Not relevant, but see #24852|\n|#26313|AffineSpace_generic_with_category||\nRemains in 8.4.b7\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24551\n\n",
    "closed_at": "2018-12-13T11:22:48Z",
    "created_at": "2018-01-16T15:27:28Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: defining __eq__ breaks inheritance of __hash__",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24314",
    "user": "https://github.com/fchapoton"
}
```
CC:  @jdemeyer @tscrim @kiwifb @embray @vinklein zerline

This is potentially a large-scale problem, as can be seen using

```
grep -L "def __hash__" $(git grep -l "def __eq__" ) 
```

TODO LIST (extracted from errors on sage/python3 testsuite):
| **Ticket** | **Module**           | Notes |
|:------------:|:----------------------:|:-------:|
|#25935|AbelianGroupWithValues_class_with_category|group|
|#25935|AbelianGroup_class_with_category|group|
|#26162|AlternatingGroup_with_category|group|
|#26058|BruhatTitsHarmonicCocycles_with_category||
|#26145|CartesianProduct_with_category.element_class|product|
|#25940|ChainComplex_class_with_category||
|#25935|ClassGroup_with_category|group|
|#26192|CompositeConstructionFunctor|functor|
|#26061|CrystalOfAlcovePaths_with_category.element_class||
|#26087|CycleIndexSeriesRing_class_with_category||
|#26162|CyclicPermutationGroup_with_category|group|
|#26162|DiCyclicGroup_with_category|group|
|#26162|DihedralGroup_with_category|group|
|#26088|EisensteinExtensionFieldCappedRelative_with_category||
|#26088|EisensteinExtensionRingCappedAbsolute_with_category||
|#26088|EisensteinExtensionRingCappedRelative_with_category||
|#26088|EisensteinExtensionRingFixedMod_with_category||
|#26179|FiniteWord_list||
|#26179|FiniteWord_str||
|#26179|FiniteWord_tuple||
|#26167|Gamma0_class_with_category|group|
|#26167|Gamma1_class_with_category|group|
|#26167|GammaH_class_with_category|group|
|#26167|Gamma_class_with_category|group|
|#26063|HammingCode_with_category||
|#25946|HyperellipticCurve_g2_padic_field_with_category||
|#25946|HyperellipticCurve_g2_rational_field_with_category||
|#25946|HyperellipticCurve_padic_field_with_category||
|#25946|HyperellipticCurve_rational_field_with_category||
|#26094|IdealMonoid_c_with_category|ideal, maybe fixed in #26094|
|#26192|InfinitePolynomialFunctor|functor|
|#26162|KleinFourGroup_with_category|group|
|#26162|MathieuGroup_with_category|group|
|#26093|ModularSymbolsAmbient_wtk_eps_with_category||
|#26145|MultivariateProduct_with_category.element_class|product|
|#26094|NCPolynomialIdeal|ideal|
|#26162|PGL_with_category|group|
|#26162|PSL_with_category|group|
|#26158|Partitions_with_constraints_with_category||
|#26165|PolynomialQuotientRing_domain_with_category||
|#26165|PolynomialQuotientRing_field_with_category||
|#26165|PolynomialQuotientRing_generic_with_category||
||PrimitiveGroup_with_category|fixed somewhere in 8.4.b4|
|#26163|QuaternionFractionalIdeal_rational|ideal|
|#26162|QuaternionGroup_with_category|group|
|#26167|SL2Z_class_with_category|group|
|#26062|ShiftedPrimedTableaux_shape_with_category.element_class||
||SimplicialSetMorphism|Fixed somewhere in 8.4.b3|
|#26089|SmoothCharacterGroupQp_with_category|group|
|#26089|SmoothCharacterGroupRamifiedQuadratic_with_category|group|
|#26089|SmoothCharacterGroupUnramifiedQuadratic_with_category|group|
|#26092|SubsetsSorted_with_category||
|#26092|Subsets_sk_with_category||
|#26064|SymbolicConstantsSubring_with_category||
|#26162|SymmetricGroup_with_category|group|
|#26162|TransitiveGroup_with_category|group|
|#26145|UnivariateProduct_with_category.element_class|product|
|#26088|UnramifiedExtensionFieldCappedRelative_with_category||
|#26088|UnramifiedExtensionRingCappedAbsolute_with_category||
|#26088|UnramifiedExtensionRingCappedRelative_with_category||
|#26088|UnramifiedExtensionRingFixedMod_with_category||
|#26058|pAdicAutomorphicForms_with_category||
||sage.rings.padics.qadic_flint_CR.qAdicCappedRelativeElement|Not relevant (appears as an expected result)|
New failures in 8.4.beta3:
| **Ticket** | **Module**           | Notes |
|:------------:|:----------------------:|:-------:|
|#26181|Cusps_class||
|#26177|GRSGaoDecoder||
|#26177|LinearCodeSyndromeDecoder||
|#26193|MyModule_with_category||
|#26198|TestParent4_with_category||
Remains in 8.4.b4:
| **Ticket** | **Module**           | Notes |
|:------------:|:----------------------:|:-------:|
|#26221|FreeMonoid_class_with_category||
|#26218|IntegerVectorsConstraints_with_category||
|#26261|MPolynomial_polydict||
|#26091|ProjectiveSpace_rational_field_with_category||
|#26091|ProjectiveSpace_ring_with_category||
|#26260|ProductProjectiveSpaces_ring_with_category||
Remains in 8.4.b5

||                                               |                            |
||-----------------------------------------------|----------------------------|
||Bitset objects are unhashable; use FrozenBitset|Not relevant, but see #24852|
|#26313|AffineSpace_generic_with_category||
Remains in 8.4.b7


Issue created by migration from https://trac.sagemath.org/ticket/24551





---

archive/issue_comments_340015.json:
```json
{
    "body": "Good to know is that there is a metaclass `InheritComparison` which is supposed to fix that problem.",
    "created_at": "2018-01-16T15:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340015",
    "user": "https://github.com/jdemeyer"
}
```

Good to know is that there is a metaclass `InheritComparison` which is supposed to fix that problem.



---

archive/issue_comments_340016.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to python3.",
    "created_at": "2018-01-16T16:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340016",
    "user": "https://github.com/embray"
}
```

Changing component from PLEASE CHANGE to python3.



---

archive/issue_comments_340017.json:
```json
{
    "body": "I've also, at least, provisionally, implemented `__hash__`'s for a lot of classes.  I haven't pushed any of those changes yet because I've been lazy about adding docstrings for them and need to do that.\n\nThere are also lots of cases where it's fine to just assign `__hash__ = BaseClass.__hash__` (in fact this is the case for all classes).  That said, the default `__hash__` a lot of classes have is not very good, or sometimes problematic (e.g. I think some object are hashable even though they're not immutable).  So it's a good opportunity to check those on a case base case basis.",
    "created_at": "2018-01-16T16:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340017",
    "user": "https://github.com/embray"
}
```

I've also, at least, provisionally, implemented `__hash__`'s for a lot of classes.  I haven't pushed any of those changes yet because I've been lazy about adding docstrings for them and need to do that.

There are also lots of cases where it's fine to just assign `__hash__ = BaseClass.__hash__` (in fact this is the case for all classes).  That said, the default `__hash__` a lot of classes have is not very good, or sometimes problematic (e.g. I think some object are hashable even though they're not immutable).  So it's a good opportunity to check those on a case base case basis.



---

archive/issue_comments_340018.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-01-16T16:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340018",
    "user": "https://github.com/embray"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_340019.json:
```json
{
    "body": "ok. But anyway, this seems to require a lot of work..\n\nI did a few simple cases in #24552",
    "created_at": "2018-01-16T16:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340019",
    "user": "https://github.com/fchapoton"
}
```

ok. But anyway, this seems to require a lot of work..

I did a few simple cases in #24552



---

archive/issue_comments_340020.json:
```json
{
    "body": "Of the commits in my python 3 branch that I haven't made tickets for yet, I've added `__hash__` implementations in at least the following (and maybe more):\n\n```\nsrc/sage/algebras/free_algebra.py\nsrc/sage/algebras/free_algebra_quotient.py\nsrc/sage/algebras/quatalg/quaternion_algebra.py\nsrc/sage/algebras/steenrod/steenrod_algebra.py\nsrc/sage/categories/pushout.py\nsrc/sage/coding/hamming_code.py\nsrc/sage/coding/linear_code.py\nsrc/sage/combinat/crystals/generalized_young_walls.py\nsrc/sage/combinat/integer_vector.py\nsrc/sage/combinat/rigged_configurations/rigged_partition.py\nsrc/sage/combinat/root_system/type_dual.py\nsrc/sage/combinat/species/series.py\nsrc/sage/combinat/subset.py\nsrc/sage/combinat/subword_complex.py\nsrc/sage/combinat/words/word_datatypes.pyx\nsrc/sage/groups/abelian_gps/abelian_group.py\nsrc/sage/groups/perm_gps/permgroup_named.py\nsrc/sage/homology/chain_complex.py\nsrc/sage/homology/chain_complex_morphism.py\nsrc/sage/manifolds/continuous_map.py\nsrc/sage/modular/arithgroup/congroup_generic.py\nsrc/sage/modular/modsym/ambient.py\nsrc/sage/monoids/free_monoid.py\nsrc/sage/rings/fraction_field.py\nsrc/sage/rings/ideal_monoid.py\nsrc/sage/rings/number_field/order.py\nsrc/sage/rings/padics/padic_extension_generic.py\nsrc/sage/rings/polynomial/laurent_polynomial_ring.py\nsrc/sage/rings/polynomial/polynomial_quotient_ring.py\nsrc/sage/structure/element_wrapper.pyx\n```",
    "created_at": "2018-01-16T16:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340020",
    "user": "https://github.com/embray"
}
```

Of the commits in my python 3 branch that I haven't made tickets for yet, I've added `__hash__` implementations in at least the following (and maybe more):

```
src/sage/algebras/free_algebra.py
src/sage/algebras/free_algebra_quotient.py
src/sage/algebras/quatalg/quaternion_algebra.py
src/sage/algebras/steenrod/steenrod_algebra.py
src/sage/categories/pushout.py
src/sage/coding/hamming_code.py
src/sage/coding/linear_code.py
src/sage/combinat/crystals/generalized_young_walls.py
src/sage/combinat/integer_vector.py
src/sage/combinat/rigged_configurations/rigged_partition.py
src/sage/combinat/root_system/type_dual.py
src/sage/combinat/species/series.py
src/sage/combinat/subset.py
src/sage/combinat/subword_complex.py
src/sage/combinat/words/word_datatypes.pyx
src/sage/groups/abelian_gps/abelian_group.py
src/sage/groups/perm_gps/permgroup_named.py
src/sage/homology/chain_complex.py
src/sage/homology/chain_complex_morphism.py
src/sage/manifolds/continuous_map.py
src/sage/modular/arithgroup/congroup_generic.py
src/sage/modular/modsym/ambient.py
src/sage/monoids/free_monoid.py
src/sage/rings/fraction_field.py
src/sage/rings/ideal_monoid.py
src/sage/rings/number_field/order.py
src/sage/rings/padics/padic_extension_generic.py
src/sage/rings/polynomial/laurent_polynomial_ring.py
src/sage/rings/polynomial/polynomial_quotient_ring.py
src/sage/structure/element_wrapper.pyx
```



---

archive/issue_comments_340021.json:
```json
{
    "body": "```\nsrc/sage/combinat/rigged_configurations/bij_abstract_class.py\n```\nand its subclasses should never be used in a hash (it is a helper class to perform a bijection) and the `__eq__` is just there so the `TestSuite` with the pickling passes. Probably the better thing to do here is to remove the `__eq__` and skip the pickling test (this is some of the first code I contributed to Sage, memories...).",
    "created_at": "2018-01-16T16:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340021",
    "user": "https://github.com/tscrim"
}
```

```
src/sage/combinat/rigged_configurations/bij_abstract_class.py
```
and its subclasses should never be used in a hash (it is a helper class to perform a bijection) and the `__eq__` is just there so the `TestSuite` with the pickling passes. Probably the better thing to do here is to remove the `__eq__` and skip the pickling test (this is some of the first code I contributed to Sage, memories...).



---

archive/issue_comments_340022.json:
```json
{
    "body": "Quick question one of you can maybe answer:  If a class inherits from `UniqueRepresentation`, then should it even be implementing `__eq__`?  ISTM it should just use the `__eq__` implementation inherited from `UniqueRepresentation` (via `WithEqualityById`).\n\nI've found several classes that inherit from `UniqueRepresentation` but that still implement their own `__eq__` like:\n\n```\ndef __eq__(self, other):\n    return isinstance(other, type(self)) and self.foo == other.foo and self.bar == other.bar\n```\n\nfor some list of various attributes of the objects that are mostly determined at the object's construction.\n\nI admit I don't fully understand yet how `UniqueRepresentation` is supposed to work though (I will read the docs for it carefully now).  But it seems like it should implicitly cover this use case (and thus eliminate the need for a lot of explicit `__eq__` and hence `__hash__` implementations).",
    "created_at": "2018-05-17T09:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340022",
    "user": "https://github.com/embray"
}
```

Quick question one of you can maybe answer:  If a class inherits from `UniqueRepresentation`, then should it even be implementing `__eq__`?  ISTM it should just use the `__eq__` implementation inherited from `UniqueRepresentation` (via `WithEqualityById`).

I've found several classes that inherit from `UniqueRepresentation` but that still implement their own `__eq__` like:

```
def __eq__(self, other):
    return isinstance(other, type(self)) and self.foo == other.foo and self.bar == other.bar
```

for some list of various attributes of the objects that are mostly determined at the object's construction.

I admit I don't fully understand yet how `UniqueRepresentation` is supposed to work though (I will read the docs for it carefully now).  But it seems like it should implicitly cover this use case (and thus eliminate the need for a lot of explicit `__eq__` and hence `__hash__` implementations).



---

archive/issue_comments_340023.json:
```json
{
    "body": "Or could it be that in some of these cases their `__eq__` is defined more broadly than just equality by identity?  I admit in some of these cases I don't know the mathematical background well enough to determine this, and the given examples don't always make the intent clear either.",
    "created_at": "2018-05-17T09:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340023",
    "user": "https://github.com/embray"
}
```

Or could it be that in some of these cases their `__eq__` is defined more broadly than just equality by identity?  I admit in some of these cases I don't know the mathematical background well enough to determine this, and the given examples don't always make the intent clear either.



---

archive/issue_comments_340024.json:
```json
{
    "body": "Okay, quoting the docs:\n\n> Instances of a class have a *unique instance behavior* when instances of this class evaluate equal if and only if they are identical.\n\n\nSo IIUC, a class really shouldn't be inheriting `UniqueRepresentation` unless they truly do define equality by identity.  So either these classes shouldn't be defining `__eq__`, or they aren't using `UniqueRepresentation` appropriately (and should perhaps just be using `CachedRepresentation` at the most).",
    "created_at": "2018-05-17T09:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340024",
    "user": "https://github.com/embray"
}
```

Okay, quoting the docs:

> Instances of a class have a *unique instance behavior* when instances of this class evaluate equal if and only if they are identical.


So IIUC, a class really shouldn't be inheriting `UniqueRepresentation` unless they truly do define equality by identity.  So either these classes shouldn't be defining `__eq__`, or they aren't using `UniqueRepresentation` appropriately (and should perhaps just be using `CachedRepresentation` at the most).



---

archive/issue_comments_340025.json:
```json
{
    "body": "Replying to [comment:8 embray]:\n> So IIUC, a class really shouldn't be inheriting `UniqueRepresentation` unless they truly do define equality by identity.  So either these classes shouldn't be defining `__eq__`, or they aren't using `UniqueRepresentation` appropriately (and should perhaps just be using `CachedRepresentation` at the most).\n\n\nThat sounds reasonable.",
    "created_at": "2018-05-17T09:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340025",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:8 embray]:
> So IIUC, a class really shouldn't be inheriting `UniqueRepresentation` unless they truly do define equality by identity.  So either these classes shouldn't be defining `__eq__`, or they aren't using `UniqueRepresentation` appropriately (and should perhaps just be using `CachedRepresentation` at the most).


That sounds reasonable.



---

archive/issue_comments_340026.json:
```json
{
    "body": "I'm just going through `sage.algebras` and finding several cases like this (this is where I started since that's where I was recently toiling on the `__hash__` issue).  Indeed, it seems many of these classes predate, and/or have `__eq__` methods that predate `UniqueRepresentation`.",
    "created_at": "2018-05-17T10:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340026",
    "user": "https://github.com/embray"
}
```

I'm just going through `sage.algebras` and finding several cases like this (this is where I started since that's where I was recently toiling on the `__hash__` issue).  Indeed, it seems many of these classes predate, and/or have `__eq__` methods that predate `UniqueRepresentation`.



---

archive/issue_comments_340027.json:
```json
{
    "body": "Another angle to this that Jeroen has already pointed out a couple times is that there is `InheritComparison`.  This could be extended to also automatically force the inheritance of `__hash__`.  I think that would solve a lot of this \"for free\".  But what I've also found is that this has exposed many cases where class's default inherited `__hash__`es are not well-defined w.r.t. their `__eq__`, or other issues like in #25387.\n\nIn other words, I think that the new behavior in Python 3, while annoying in terms of how much it breaks in Sage, is good that it forces us to think more carefully about this.  So I'd be hesitant to resort to such a brute-force fix except as a last resort.",
    "created_at": "2018-05-18T09:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340027",
    "user": "https://github.com/embray"
}
```

Another angle to this that Jeroen has already pointed out a couple times is that there is `InheritComparison`.  This could be extended to also automatically force the inheritance of `__hash__`.  I think that would solve a lot of this "for free".  But what I've also found is that this has exposed many cases where class's default inherited `__hash__`es are not well-defined w.r.t. their `__eq__`, or other issues like in #25387.

In other words, I think that the new behavior in Python 3, while annoying in terms of how much it breaks in Sage, is good that it forces us to think more carefully about this.  So I'd be hesitant to resort to such a brute-force fix except as a last resort.



---

archive/issue_comments_340028.json:
```json
{
    "body": "Among the files listed in the ticket description, the case \n\n```\nsrc/sage/manifolds/continuous_map.py\n```\nis dealt with by #25502.\nThe other manifold cases: \n\n```\nsrc/sage/manifolds/chart.py\nsrc/sage/manifolds/chart_func.py\nsrc/sage/manifolds/differentiable/affine_connection.py\nsrc/sage/manifolds/differentiable/tensorfield.py\nsrc/sage/manifolds/scalarfield.py\n```\nshould trigger no Python3 issue since none of these classes is intended to be hashable. Same thing for \n\n```\nsrc/sage/tensor/modules/comp.py\nsrc/sage/tensor/modules/free_module_morphism.py\nsrc/sage/tensor/modules/free_module_tensor.py\nsrc/sage/tensor/modules/tensor_with_indices.py\n```",
    "created_at": "2018-06-03T20:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340028",
    "user": "https://github.com/egourgoulhon"
}
```

Among the files listed in the ticket description, the case 

```
src/sage/manifolds/continuous_map.py
```
is dealt with by #25502.
The other manifold cases: 

```
src/sage/manifolds/chart.py
src/sage/manifolds/chart_func.py
src/sage/manifolds/differentiable/affine_connection.py
src/sage/manifolds/differentiable/tensorfield.py
src/sage/manifolds/scalarfield.py
```
should trigger no Python3 issue since none of these classes is intended to be hashable. Same thing for 

```
src/sage/tensor/modules/comp.py
src/sage/tensor/modules/free_module_morphism.py
src/sage/tensor/modules/free_module_tensor.py
src/sage/tensor/modules/tensor_with_indices.py
```



---

archive/issue_comments_340029.json:
```json
{
    "body": "see #25586 and #25587 for some partial cure",
    "created_at": "2018-06-15T20:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340029",
    "user": "https://github.com/fchapoton"
}
```

see #25586 and #25587 for some partial cure



---

archive/issue_comments_340030.json:
```json
{
    "body": "some failures in sage3 doctests:\n\n```\n 'TypeError(\"unhashable type: \\'AbsoluteOrder_with_category\\'\",)',\n 'TypeError(\"unhashable type: \\'RelativeOrder_with_category\\'\",)',\n \"TypeError: unhashable type: 'AbelianGroup_class_with_category'\",\n \"TypeError: unhashable type: 'AbsoluteOrder_with_category'\",\n \"TypeError: unhashable type: 'CartanType_affine_with_superclass'\",\n \"TypeError: unhashable type: 'CartesianProduct_with_category.element_class'\",\n \"TypeError: unhashable type: 'ChainComplex_class_with_category'\",\n \"TypeError: unhashable type: 'ClassGroup_with_category'\",\n \"TypeError: unhashable type: 'CompositeConstructionFunctor'\",\n \"TypeError: unhashable type: 'CrystalOfAlcovePaths_with_category.element_class'\",\n \"TypeError: unhashable type: 'CycleIndexSeriesRing_class_with_category'\",\n \"TypeError: unhashable type: 'CyclicPermutationGroup_with_category'\",\n \"TypeError: unhashable type: 'DihedralGroup_with_category'\",\n \"TypeError: unhashable type: 'EisensteinExtensionFieldCappedRelative_with_category'\",\n \"TypeError: unhashable type: 'EisensteinExtensionRingCappedAbsolute_with_category'\",\n \"TypeError: unhashable type: 'EisensteinExtensionRingCappedRelative_with_category'\",\n \"TypeError: unhashable type: 'EisensteinExtensionRingFixedMod_with_category'\",\n \"TypeError: unhashable type: 'FpT_with_category'\",\n \"TypeError: unhashable type: 'FractionField_1poly_field_with_category'\",\n \"TypeError: unhashable type: 'FractionField_generic_with_category'\",\n \"TypeError: unhashable type: 'Gamma0_class_with_category'\",\n \"TypeError: unhashable type: 'Gamma1_class_with_category'\",\n \"TypeError: unhashable type: 'GammaH_class_with_category'\",\n \"TypeError: unhashable type: 'HammingCode_with_category'\",\n \"TypeError: unhashable type: 'HyperbolicModelPD_with_category.element_class'\",\n \"TypeError: unhashable type: 'HyperellipticCurve_g2_rational_field_with_category'\",\n \"TypeError: unhashable type: 'HyperellipticCurve_rational_field_with_category'\",\n \"TypeError: unhashable type: 'IdealMonoid_c_with_category'\",\n \"TypeError: unhashable type: 'InfinitePolynomialFunctor'\",\n \"TypeError: unhashable type: 'KleinFourGroup_with_category'\",\n \"TypeError: unhashable type: 'LabelledBinaryTrees_with_category.element_class'\",\n \"TypeError: unhashable type: 'LaurentPolynomialRing_mpair_with_category'\",\n \"TypeError: unhashable type: 'LaurentPolynomialRing_univariate_with_category'\",\n \"TypeError: unhashable type: 'MPolynomialRing_polydict_domain_with_category'\",\n \"TypeError: unhashable type: 'MPolynomialRing_polydict_with_category'\",\n \"TypeError: unhashable type: 'MPolynomial_polydict'\",\n \"TypeError: unhashable type: 'ModularSymbolsAmbient_wtk_eps_with_category'\",\n \"TypeError: unhashable type: 'MultivariateProduct_with_category.element_class'\",\n \"TypeError: unhashable type: 'OverconvergentModularFormsSpace_with_category'\",\n \"TypeError: unhashable type: 'Partitions_with_constraints_with_category'\",\n \"TypeError: unhashable type: 'PolynomialQuotientRing_field_with_category'\",\n \"TypeError: unhashable type: 'PolynomialQuotientRing_generic_with_category'\",\n \"TypeError: unhashable type: 'ProjectiveSpace_rational_field_with_category'\",\n \"TypeError: unhashable type: 'QuaternionAlgebra_ab_with_category'\",\n \"TypeError: unhashable type: 'QuaternionFractionalIdeal_rational'\",\n \"TypeError: unhashable type: 'RelativeOrder_with_category'\",\n \"TypeError: unhashable type: 'SL2Z_class_with_category'\",\n \"TypeError: unhashable type: 'Subsets_sk_with_category'\",\n \"TypeError: unhashable type: 'SymbolicConstantsSubring_with_category'\",\n \"TypeError: unhashable type: 'SymmetricGroup_with_category'\",\n \"TypeError: unhashable type: 'ToricVariety_field_with_category'\",\n \"TypeError: unhashable type: 'UnivariateProduct_with_category.element_class'\",\n \"TypeError: unhashable type: 'UnramifiedExtensionFieldCappedRelative_with_category'\",\n \"TypeError: unhashable type: 'UnramifiedExtensionRingCappedAbsolute_with_category'\",\n \"TypeError: unhashable type: 'UnramifiedExtensionRingCappedRelative_with_category'\",\n \"TypeError: unhashable type: 'UnramifiedExtensionRingFixedMod_with_category'\",\n \"TypeError: unhashable type: 'pAdicAutomorphicForms_with_category'\",\n \"TypeError: unhashable type: 'sage.rings.padics.qadic_flint_CR.qAdicCappedRelativeElement'\"]\n```",
    "created_at": "2018-06-16T15:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340030",
    "user": "https://github.com/fchapoton"
}
```

some failures in sage3 doctests:

```
 'TypeError("unhashable type: \'AbsoluteOrder_with_category\'",)',
 'TypeError("unhashable type: \'RelativeOrder_with_category\'",)',
 "TypeError: unhashable type: 'AbelianGroup_class_with_category'",
 "TypeError: unhashable type: 'AbsoluteOrder_with_category'",
 "TypeError: unhashable type: 'CartanType_affine_with_superclass'",
 "TypeError: unhashable type: 'CartesianProduct_with_category.element_class'",
 "TypeError: unhashable type: 'ChainComplex_class_with_category'",
 "TypeError: unhashable type: 'ClassGroup_with_category'",
 "TypeError: unhashable type: 'CompositeConstructionFunctor'",
 "TypeError: unhashable type: 'CrystalOfAlcovePaths_with_category.element_class'",
 "TypeError: unhashable type: 'CycleIndexSeriesRing_class_with_category'",
 "TypeError: unhashable type: 'CyclicPermutationGroup_with_category'",
 "TypeError: unhashable type: 'DihedralGroup_with_category'",
 "TypeError: unhashable type: 'EisensteinExtensionFieldCappedRelative_with_category'",
 "TypeError: unhashable type: 'EisensteinExtensionRingCappedAbsolute_with_category'",
 "TypeError: unhashable type: 'EisensteinExtensionRingCappedRelative_with_category'",
 "TypeError: unhashable type: 'EisensteinExtensionRingFixedMod_with_category'",
 "TypeError: unhashable type: 'FpT_with_category'",
 "TypeError: unhashable type: 'FractionField_1poly_field_with_category'",
 "TypeError: unhashable type: 'FractionField_generic_with_category'",
 "TypeError: unhashable type: 'Gamma0_class_with_category'",
 "TypeError: unhashable type: 'Gamma1_class_with_category'",
 "TypeError: unhashable type: 'GammaH_class_with_category'",
 "TypeError: unhashable type: 'HammingCode_with_category'",
 "TypeError: unhashable type: 'HyperbolicModelPD_with_category.element_class'",
 "TypeError: unhashable type: 'HyperellipticCurve_g2_rational_field_with_category'",
 "TypeError: unhashable type: 'HyperellipticCurve_rational_field_with_category'",
 "TypeError: unhashable type: 'IdealMonoid_c_with_category'",
 "TypeError: unhashable type: 'InfinitePolynomialFunctor'",
 "TypeError: unhashable type: 'KleinFourGroup_with_category'",
 "TypeError: unhashable type: 'LabelledBinaryTrees_with_category.element_class'",
 "TypeError: unhashable type: 'LaurentPolynomialRing_mpair_with_category'",
 "TypeError: unhashable type: 'LaurentPolynomialRing_univariate_with_category'",
 "TypeError: unhashable type: 'MPolynomialRing_polydict_domain_with_category'",
 "TypeError: unhashable type: 'MPolynomialRing_polydict_with_category'",
 "TypeError: unhashable type: 'MPolynomial_polydict'",
 "TypeError: unhashable type: 'ModularSymbolsAmbient_wtk_eps_with_category'",
 "TypeError: unhashable type: 'MultivariateProduct_with_category.element_class'",
 "TypeError: unhashable type: 'OverconvergentModularFormsSpace_with_category'",
 "TypeError: unhashable type: 'Partitions_with_constraints_with_category'",
 "TypeError: unhashable type: 'PolynomialQuotientRing_field_with_category'",
 "TypeError: unhashable type: 'PolynomialQuotientRing_generic_with_category'",
 "TypeError: unhashable type: 'ProjectiveSpace_rational_field_with_category'",
 "TypeError: unhashable type: 'QuaternionAlgebra_ab_with_category'",
 "TypeError: unhashable type: 'QuaternionFractionalIdeal_rational'",
 "TypeError: unhashable type: 'RelativeOrder_with_category'",
 "TypeError: unhashable type: 'SL2Z_class_with_category'",
 "TypeError: unhashable type: 'Subsets_sk_with_category'",
 "TypeError: unhashable type: 'SymbolicConstantsSubring_with_category'",
 "TypeError: unhashable type: 'SymmetricGroup_with_category'",
 "TypeError: unhashable type: 'ToricVariety_field_with_category'",
 "TypeError: unhashable type: 'UnivariateProduct_with_category.element_class'",
 "TypeError: unhashable type: 'UnramifiedExtensionFieldCappedRelative_with_category'",
 "TypeError: unhashable type: 'UnramifiedExtensionRingCappedAbsolute_with_category'",
 "TypeError: unhashable type: 'UnramifiedExtensionRingCappedRelative_with_category'",
 "TypeError: unhashable type: 'UnramifiedExtensionRingFixedMod_with_category'",
 "TypeError: unhashable type: 'pAdicAutomorphicForms_with_category'",
 "TypeError: unhashable type: 'sage.rings.padics.qadic_flint_CR.qAdicCappedRelativeElement'"]
```



---

archive/issue_comments_340031.json:
```json
{
    "body": "Note that the changes (taken from comment:2)\n\n```diff\ndiff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py\nindex e19199b949..bf6fe5dc2c 100644\n--- a/src/sage/groups/abelian_gps/abelian_group.py\n+++ b/src/sage/groups/abelian_gps/abelian_group.py\n@@ -553,6 +553,8 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):\n             cat = cat.Infinite()\n         AbelianGroupBase.__init__(self, category=cat)\n \n+    __hash__ = UniqueRepresentation.__hash__\n+\n     def is_isomorphic(left, right):\n         \"\"\"\n         Check whether ``left`` and ``right`` are isomorphic\ndiff --git a/src/sage/groups/perm_gps/permgroup_named.py b/src/sage/groups/perm_gps/permgroup_named.py\nindex da1774e96c..54fa034b4a 100644\n--- a/src/sage/groups/perm_gps/permgroup_named.py\n+++ b/src/sage/groups/perm_gps/permgroup_named.py\n@@ -149,6 +149,8 @@ class PermutationGroup_unique(CachedRepresentation, PermutationGroup_generic):\n         \"\"\"\n         return super(CachedRepresentation, self).__eq__(other)\n \n+    __hash__ = CachedRepresentation.__hash__\n+\n \n class PermutationGroup_symalt(PermutationGroup_unique):\n     \"\"\"\n```\nfix many Python 3 doctest failures in `sage/homology`. I don't know if this is the correct approach, or perhaps there is something more systematic to make hashes inherit even when `__eq__` is defined.",
    "created_at": "2018-07-25T22:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340031",
    "user": "https://github.com/jhpalmieri"
}
```

Note that the changes (taken from comment:2)

```diff
diff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py
index e19199b949..bf6fe5dc2c 100644
--- a/src/sage/groups/abelian_gps/abelian_group.py
+++ b/src/sage/groups/abelian_gps/abelian_group.py
@@ -553,6 +553,8 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):
             cat = cat.Infinite()
         AbelianGroupBase.__init__(self, category=cat)
 
+    __hash__ = UniqueRepresentation.__hash__
+
     def is_isomorphic(left, right):
         """
         Check whether ``left`` and ``right`` are isomorphic
diff --git a/src/sage/groups/perm_gps/permgroup_named.py b/src/sage/groups/perm_gps/permgroup_named.py
index da1774e96c..54fa034b4a 100644
--- a/src/sage/groups/perm_gps/permgroup_named.py
+++ b/src/sage/groups/perm_gps/permgroup_named.py
@@ -149,6 +149,8 @@ class PermutationGroup_unique(CachedRepresentation, PermutationGroup_generic):
         """
         return super(CachedRepresentation, self).__eq__(other)
 
+    __hash__ = CachedRepresentation.__hash__
+
 
 class PermutationGroup_symalt(PermutationGroup_unique):
     """
```
fix many Python 3 doctest failures in `sage/homology`. I don't know if this is the correct approach, or perhaps there is something more systematic to make hashes inherit even when `__eq__` is defined.



---

archive/issue_comments_340032.json:
```json
{
    "body": "If you're using the `__hash__` of `UniqueRepresentation` but not its `__eq__`, then you're doing it wrong. So this might indicate an actual bug.",
    "created_at": "2018-07-25T22:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340032",
    "user": "https://github.com/jdemeyer"
}
```

If you're using the `__hash__` of `UniqueRepresentation` but not its `__eq__`, then you're doing it wrong. So this might indicate an actual bug.



---

archive/issue_comments_340033.json:
```json
{
    "body": "That class has the line\n\n```\n    __eq__ = is_isomorphic\n```\nso that generator names (for example) don't affect equality. (`is_isomorphic` just checks whether the elementary divisors match up.) We could define `__hash__` correspondingly. For the simplicial complex code, the important thing (I think) is that the class of abelian groups is hashable. I assume that any reasonable hash function will work.\n\n(I also don't know how or why the design decisions for `AbelianGroup_class` were made.)",
    "created_at": "2018-07-25T23:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340033",
    "user": "https://github.com/jhpalmieri"
}
```

That class has the line

```
    __eq__ = is_isomorphic
```
so that generator names (for example) don't affect equality. (`is_isomorphic` just checks whether the elementary divisors match up.) We could define `__hash__` correspondingly. For the simplicial complex code, the important thing (I think) is that the class of abelian groups is hashable. I assume that any reasonable hash function will work.

(I also don't know how or why the design decisions for `AbelianGroup_class` were made.)



---

archive/issue_comments_340034.json:
```json
{
    "body": "Confirmed:\n\n```diff\ndiff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py\nindex e19199b949..62a5e25edb 100644\n--- a/src/sage/groups/abelian_gps/abelian_group.py\n+++ b/src/sage/groups/abelian_gps/abelian_group.py\n@@ -553,6 +553,9 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):\n             cat = cat.Infinite()\n         AbelianGroupBase.__init__(self, category=cat)\n \n+    def __hash__(self):\n+        return hash(self.elementary_divisors())\n+\n     def is_isomorphic(left, right):\n         \"\"\"\n         Check whether ``left`` and ``right`` are isomorphic\n```\nworks just as well, at least as far as the homology code is concerned.",
    "created_at": "2018-07-25T23:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340034",
    "user": "https://github.com/jhpalmieri"
}
```

Confirmed:

```diff
diff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py
index e19199b949..62a5e25edb 100644
--- a/src/sage/groups/abelian_gps/abelian_group.py
+++ b/src/sage/groups/abelian_gps/abelian_group.py
@@ -553,6 +553,9 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):
             cat = cat.Infinite()
         AbelianGroupBase.__init__(self, category=cat)
 
+    def __hash__(self):
+        return hash(self.elementary_divisors())
+
     def is_isomorphic(left, right):
         """
         Check whether ``left`` and ``right`` are isomorphic
```
works just as well, at least as far as the homology code is concerned.



---

archive/issue_comments_340035.json:
```json
{
    "body": "Replying to [comment:17 jhpalmieri]:\n> That class has the line\n> \n> ```\n>     __eq__ = is_isomorphic\n> ```\n> so that generator names (for example) don't affect equality.\n\n\nThis is different from most other things in Sage though. For example\n\n```\nsage: GF(9, 'a') == GF(9, 'b')\nFalse\nsage: QQ['x'] == QQ['y']\nFalse\n```\n\nI'm not saying that this is necessarily a bug. However, if you can change `__eq__` without breaking anything else, I would do that instead of changing `__hash__`.",
    "created_at": "2018-07-26T09:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340035",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:17 jhpalmieri]:
> That class has the line
> 
> ```
>     __eq__ = is_isomorphic
> ```
> so that generator names (for example) don't affect equality.


This is different from most other things in Sage though. For example

```
sage: GF(9, 'a') == GF(9, 'b')
False
sage: QQ['x'] == QQ['y']
False
```

I'm not saying that this is necessarily a bug. However, if you can change `__eq__` without breaking anything else, I would do that instead of changing `__hash__`.



---

archive/issue_comments_340036.json:
```json
{
    "body": "I opened #25935 for `AbelianGroup_class`. Please continue the discussion there.",
    "created_at": "2018-07-26T09:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340036",
    "user": "https://github.com/jdemeyer"
}
```

I opened #25935 for `AbelianGroup_class`. Please continue the discussion there.



---

archive/issue_comments_340037.json:
```json
{
    "body": "I opened #25940 for `ChainComplex_class`.",
    "created_at": "2018-07-26T18:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340037",
    "user": "https://github.com/jhpalmieri"
}
```

I opened #25940 for `ChainComplex_class`.



---

archive/issue_events_061896.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-27T10:27:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61896"
}
```



---

archive/issue_comments_340038.json:
```json
{
    "body": "Added one for `HyperellipticCurve_generic` in #25946.",
    "created_at": "2018-07-27T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340038",
    "user": "https://github.com/embray"
}
```

Added one for `HyperellipticCurve_generic` in #25946.



---

archive/issue_comments_340039.json:
```json
{
    "body": "Maybe we can now close this one ? I think there remains one bad hash somewhere not returning int, but this is another issue.",
    "created_at": "2018-10-23T13:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340039",
    "user": "https://github.com/fchapoton"
}
```

Maybe we can now close this one ? I think there remains one bad hash somewhere not returning int, but this is another issue.



---

archive/issue_comments_340040.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-23T13:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340040",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_events_061897.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-23T13:50:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61897"
}
```



---

archive/issue_events_061898.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-10-23T13:50:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61898"
}
```



---

archive/issue_comments_340041.json:
```json
{
    "body": "What about the underlying issue of the ticket, \"defining `__eq__` breaks inheritance of `__hash__`\"? Does that need to be addressed?",
    "created_at": "2018-10-23T15:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340041",
    "user": "https://github.com/jhpalmieri"
}
```

What about the underlying issue of the ticket, "defining `__eq__` breaks inheritance of `__hash__`"? Does that need to be addressed?



---

archive/issue_comments_340042.json:
```json
{
    "body": "Well, we are not going to change this. This is the behaviour of python3, dot.",
    "created_at": "2018-10-23T15:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340042",
    "user": "https://github.com/fchapoton"
}
```

Well, we are not going to change this. This is the behaviour of python3, dot.



---

archive/issue_events_061899.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T13:37:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61899"
}
```



---

archive/issue_events_061900.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T13:37:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61900"
}
```



---

archive/issue_comments_340043.json:
```json
{
    "body": "Is there some problem with setting the \"milestone\" to 8.5 and then closing it as \"worksforme\"?  This way we can say \"as of 8.5\" this should work, and any new instance of this issue that occurs after 8.5 is a regression against this ticket and should be addressed in a new ticket.",
    "created_at": "2018-10-28T13:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340043",
    "user": "https://github.com/embray"
}
```

Is there some problem with setting the "milestone" to 8.5 and then closing it as "worksforme"?  This way we can say "as of 8.5" this should work, and any new instance of this issue that occurs after 8.5 is a regression against this ticket and should be addressed in a new ticket.



---

archive/issue_comments_340044.json:
```json
{
    "body": "ok for me",
    "created_at": "2018-10-28T14:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340044",
    "user": "https://github.com/fchapoton"
}
```

ok for me



---

archive/issue_comments_340045.json:
```json
{
    "body": "Please close.",
    "created_at": "2018-11-06T16:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340045",
    "user": "https://github.com/fchapoton"
}
```

Please close.



---

archive/issue_comments_340046.json:
```json
{
    "body": "Are we sure we've gotten all of these?  Odile was saying to me just yesterday she thought there were more cases to fix...",
    "created_at": "2018-11-08T15:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340046",
    "user": "https://github.com/embray"
}
```

Are we sure we've gotten all of these?  Odile was saying to me just yesterday she thought there were more cases to fix...



---

archive/issue_comments_340047.json:
```json
{
    "body": "Where, then ?",
    "created_at": "2018-11-08T16:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340047",
    "user": "https://github.com/fchapoton"
}
```

Where, then ?



---

archive/issue_comments_340048.json:
```json
{
    "body": "No sorry `@`chapoton `@`embray. My mistake apparently.",
    "created_at": "2018-11-08T19:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340048",
    "user": "https://trac.sagemath.org/admin/accounts/users/zerline"
}
```

No sorry `@`chapoton `@`embray. My mistake apparently.



---

archive/issue_comments_340049.json:
```json
{
    "body": "once again. Can we close this ?",
    "created_at": "2018-12-13T10:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340049",
    "user": "https://github.com/fchapoton"
}
```

once again. Can we close this ?



---

archive/issue_events_061901.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-13T10:55:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61901"
}
```



---

archive/issue_events_061902.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-13T10:55:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61902"
}
```



---

archive/issue_events_061903.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-13T11:22:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61903"
}
```



---

archive/issue_comments_340050.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-13T11:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340050",
    "user": "https://github.com/embray"
}
```

Resolution: fixed



---

archive/issue_events_061904.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-13T11:22:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61904"
}
```



---

archive/issue_events_061905.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-13T11:22:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24314#event-61905"
}
```



---

archive/issue_comments_340051.json:
```json
{
    "body": "I wouldn't put it in that milestone.  If we're calling this fixed as of Sage 8.5 then that's worth making note of.  It can just be closed as fixed.\n\nIndeed, I haven't seen any new cases of this in a while.",
    "created_at": "2018-12-13T11:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24314#issuecomment-340051",
    "user": "https://github.com/embray"
}
```

I wouldn't put it in that milestone.  If we're calling this fixed as of Sage 8.5 then that's worth making note of.  It can just be closed as fixed.

Indeed, I haven't seen any new cases of this in a while.
