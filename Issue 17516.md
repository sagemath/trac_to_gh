# Issue 17516: move pexpect-maxima code to maxima_lib

Issue created by migration from https://trac.sagemath.org/ticket/17753

Original creator: rws

Original creation time: 2015-02-09 14:35:03

This metaticket tracks efforts to remove the usage of pexpect for calling maxima, either by using `maxima_lib` or replacing it altogether. Code that is dependent on the maxima expect interface is in:

 * _`calculus/desolvers.py`_: `desolve_*()`
 * _`combinat/combinat.py`_: `euler_number()`
 * _`geometry/lattice_polytope.py`_: `positive_integer_relations()`
 * _`functions/orthogonal_polys.py`_: `hermite()`, `jacobi_P()`, `laguerre()` (obsolete with #16813), `legendre_P/Q()` (obsolete with #17151), ultraspherical()
 * _`functions/piecewise.py`_: `Piecewise.convolution()`
 * _`matrix/matrix1.pyx`_: `Matrix._maxima_init_()`
 * _`matrix/matrix_symbolic_dense.pyx`_: `Matrix_symbolic_dense.exp()` 
 * _`structure/sage_object.pyx`_: `SageObject._maxima_()`, `_maxima_init_()`
 * _`symbolic/assumptions.py`_: `GenericDeclaration.assume()`
 * _`symbolic/expression.pyx`_: `Ex.assume()`, `forget()`, `assume_str()`, `assert()`, `expand_trig()`, `reduce_trig()`, `coefficients()`, `poly()`, `maxima_methods()`, `rectform()`, `simplify()`, `simplify_real()`, `simplify_rational()`, `simplify_log()`, `expand_log()`, `factor()`, `solve()`, `sum()`
 * _`symbolic/maxima_wrapper.py`_: *

This can be considered part of the metaticket #16688.


---

Comment by dimpase created at 2017-11-27 09:29:45

I am confused about the meaning of Absolute vs Optional dependencies mentioned on the wiki, could you elaborate?


---

Comment by rws created at 2017-11-27 10:00:16

As far as I recall, I named that code optional that I thought is only executed when certain non-default keywords are given. Looking at the three items,
 * `symbolic_expression_from_maxima_string` is only used in doctests of `calculs.py` but is absolutely imported by `ex.factor()` and in `relation.py:string_to_list_of_solutions()` which is used by `solve()` so the assessment was wrong
 * `stirling_number2` in `combinat/combinat.py`: default is not Maxima, okay
 * `integration/*`: certainly Maxima is called, so it's wrong

Thanks for asking, I'm changing it.


---

Comment by dimpase created at 2020-07-05 13:18:56

there are places where `maxima.eval` instead of considerably faster `maxima_calculus.eval` is used for no good reason, e.g. in `src/doc`, see #30071.
