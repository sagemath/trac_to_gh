# Issue 17908: Cythonize optional extensions

Issue created by migration from https://trac.sagemath.org/ticket/18145

Original creator: jdemeyer

Original creation time: 2015-04-08 13:33:17

For Cython code dependending on _optional_ packages, we can still run `cython` on that `.pyx` file. The advantage is that breakage due to Cython changes will be detected earlier.

One more advantage of this branch is that optional extensions are listed in between the normal extensions, which is much cleaner.


---

Comment by jdemeyer created at 2015-04-08 14:03:30

New commits:


---

Comment by jdemeyer created at 2015-04-08 14:03:30

Changing status from new to needs_review.


---

Comment by mmezzarobba created at 2015-04-08 16:32:27

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-04-08 16:48:32

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-04-08 16:48:50

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2015-04-08 20:12:16

OK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?


---

Comment by jdemeyer created at 2015-04-08 20:30:48

Replying to [comment:7 fbissey]:
> OK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?
I cannot really parse your question, but I'll try to answer it anyway: `CythonizeExtension` is exactly like `Extension` except for the `skip_build` attribute. There is some code added to `src/setup.py` which checks this attribute. If `skip_build`, then the build (i.e. the `foo.c` -> `foo.so` part) of the extension is skipped.


---

Comment by fbissey created at 2015-04-08 21:31:11

Thanks. You are doing an extremely good job of answering questions you cannot parse :) It otherwise looks good to me and should go in. I must say I thought something needed to be done with the optional stuff and now it is!


---

Comment by fbissey created at 2015-04-08 21:31:11

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-04-14 19:44:26

Resolution: fixed
