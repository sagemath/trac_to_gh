# Issue 29382: tensors should have a sparse iterator

archive/issues_029382.json:
```json
{
    "body": "CC:  egourgoulhon @lbrunswic @honglizhaobob tscrim\n\nAs observed on this [Ask SageMath question](https://ask.sagemath.org/question/51004), it does not seem to be possible to iterate over the non-zero entries of a tensor. This is unfortunate because the entries are stored in a sparse format, in a dictionary.\n\nSince a tensor might have symmetries, this is more involved than just iterating over the dictionary, but such an iterator would immediately be useful for the implementation of the `display()` method, for instance.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29619\n\n",
    "created_at": "2020-04-29T17:36:59Z",
    "labels": [
        "linear algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "tensors should have a sparse iterator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29382",
    "user": "@mwageringel"
}
```
CC:  egourgoulhon @lbrunswic @honglizhaobob tscrim

As observed on this [Ask SageMath question](https://ask.sagemath.org/question/51004), it does not seem to be possible to iterate over the non-zero entries of a tensor. This is unfortunate because the entries are stored in a sparse format, in a dictionary.

Since a tensor might have symmetries, this is more involved than just iterating over the dictionary, but such an iterator would immediately be useful for the implementation of the `display()` method, for instance.

Issue created by migration from https://trac.sagemath.org/ticket/29619





---

archive/issue_comments_416734.json:
```json
{
    "body": "Changing priority from minor to major.",
    "created_at": "2020-04-29T19:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416734",
    "user": "mkoeppe"
}
```

Changing priority from minor to major.



---

archive/issue_comments_416735.json:
```json
{
    "body": "Thanks for opening this ticket. I've added a link to it in the \"Algebraic part\" section of the meta-ticket #18528.",
    "created_at": "2020-04-30T07:51:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416735",
    "user": "egourgoulhon"
}
```

Thanks for opening this ticket. I've added a link to it in the "Algebraic part" section of the meta-ticket #18528.



---

archive/issue_comments_416736.json:
```json
{
    "body": "See also: #30309 - Unify free module elements API: methods `dict`, `monomial_coefficients`, etc.",
    "created_at": "2020-08-13T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416736",
    "user": "mkoeppe"
}
```

See also: #30309 - Unify free module elements API: methods `dict`, `monomial_coefficients`, etc.



---

archive/issue_comments_416737.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416737",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_416738.json:
```json
{
    "body": "`@`gh-honglizhaobob This is probably the best ticket for starting",
    "created_at": "2021-06-15T17:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416738",
    "user": "mkoeppe"
}
```

`@`gh-honglizhaobob This is probably the best ticket for starting



---

archive/issue_comments_416739.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> `@`gh-honglizhaobob This is probably the best ticket for starting\n\nIs there a set of unit test cases one needs to pass to ensure a justified change of data structure?",
    "created_at": "2021-06-18T15:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416739",
    "user": "@honglizhaobob"
}
```

Replying to [comment:7 mkoeppe]:
> `@`gh-honglizhaobob This is probably the best ticket for starting

Is there a set of unit test cases one needs to pass to ensure a justified change of data structure?



---

archive/issue_comments_416740.json:
```json
{
    "body": "To clarify - here on this ticket, the data structure shouldn't be changed but instead methods added.\n\nSage mainly uses doctests - see https://doc.sagemath.org/html/en/developer/doctesting.html\nbut there are also unit tests, which are invoked within the doctests by `TestSuite(...).run()`.",
    "created_at": "2021-06-18T17:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416740",
    "user": "mkoeppe"
}
```

To clarify - here on this ticket, the data structure shouldn't be changed but instead methods added.

Sage mainly uses doctests - see https://doc.sagemath.org/html/en/developer/doctesting.html
but there are also unit tests, which are invoked within the doctests by `TestSuite(...).run()`.



---

archive/issue_comments_416741.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-05T20:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416741",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416742.json:
```json
{
    "body": "\n```\n+        for multi_idx in self._comp.keys():\n+            # access value in dictionary\n+            coef = self._comp[multi_idx]\n```\n\nYou can use `.items()` here - see https://docs.python.org/3/tutorial/datastructures.html#looping-techniques",
    "created_at": "2021-07-05T22:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416742",
    "user": "mkoeppe"
}
```


```
+        for multi_idx in self._comp.keys():
+            # access value in dictionary
+            coef = self._comp[multi_idx]
```

You can use `.items()` here - see https://docs.python.org/3/tutorial/datastructures.html#looping-techniques



---

archive/issue_comments_416743.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-30T06:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416743",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_416744.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-30T06:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416744",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_416745.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-30T06:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416745",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_416746.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-30T06:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416746",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416747.json:
```json
{
    "body": "Thanks for implementing this. LGTM.",
    "created_at": "2022-09-01T14:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416747",
    "user": "egourgoulhon"
}
```

Thanks for implementing this. LGTM.



---

archive/issue_comments_416748.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-01T14:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416748",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416749.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-09-01T14:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416749",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_416750.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-20T20:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29382#issuecomment-416750",
    "user": "vbraun"
}
```

Resolution: fixed
