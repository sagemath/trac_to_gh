# Issue 10598: Small fix in `_an_element_from_iterator` in EnumeratedSets

archive/issues_010598.json:
```json
{
    "body": "Assignee: nborie\n\nCC:  sage-combinat\n\nKeywords: empty set, EmptySetError\n\nAs Florent Hivert gave extremely useful features about empty things, we should use it. The Following should returns an EmptySetError\n\n```\nsage: S = Set([])\nsage: S.an_element()\n---------------------------------------------------------------------------\nStopIteration                             Traceback (most recent call last)\n\n/opt/sage/devel/sage-combinat/<ipython console> in <module>()\n\n/opt/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    329             2\n    330          \"\"\"\n--> 331         return self._cachedmethod._instance_call(self._instance, *args, **kwds)\n    332 \n    333     def get_cache(self, *args, **kwds):\n\n/opt/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in _instance_call(self, inst, *args, **kwds)\n    473             return cache[key]\n    474         else:\n--> 475             cache[key] = self._cachedfunc.f(inst, *args, **kwds)\n    476             return cache[key]\n    477 \n\n/opt/sage/local/lib/python2.6/site-packages/sage/categories/enumerated_sets.pyc in _an_element_from_iterator(self)\n    470             \"\"\"\n    471             it = self.__iter__()\n--> 472             return it.next()\n    473 \n    474         # Should this be implemented from first instead?\n\nStopIteration: \nsage: \n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10651\n\n",
    "created_at": "2011-01-18T12:26:14Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "Small fix in `_an_element_from_iterator` in EnumeratedSets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10598",
    "user": "nborie"
}
```
Assignee: nborie

CC:  sage-combinat

Keywords: empty set, EmptySetError

As Florent Hivert gave extremely useful features about empty things, we should use it. The Following should returns an EmptySetError

```
sage: S = Set([])
sage: S.an_element()
---------------------------------------------------------------------------
StopIteration                             Traceback (most recent call last)

/opt/sage/devel/sage-combinat/<ipython console> in <module>()

/opt/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    329             2
    330          """
--> 331         return self._cachedmethod._instance_call(self._instance, *args, **kwds)
    332 
    333     def get_cache(self, *args, **kwds):

/opt/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in _instance_call(self, inst, *args, **kwds)
    473             return cache[key]
    474         else:
--> 475             cache[key] = self._cachedfunc.f(inst, *args, **kwds)
    476             return cache[key]
    477 

/opt/sage/local/lib/python2.6/site-packages/sage/categories/enumerated_sets.pyc in _an_element_from_iterator(self)
    470             """
    471             it = self.__iter__()
--> 472             return it.next()
    473 
    474         # Should this be implemented from first instead?

StopIteration: 
sage: 
```


Issue created by migration from https://trac.sagemath.org/ticket/10651





---

archive/issue_comments_110967.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-01-18T13:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110967",
    "user": "nborie"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_110968.json:
```json
{
    "body": "Changing keywords from \"empty set, EmptySetError\" to \"days28, empty set, EmptySetError\".",
    "created_at": "2011-01-18T15:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110968",
    "user": "slelievre"
}
```

Changing keywords from "empty set, EmptySetError" to "days28, empty set, EmptySetError".



---

archive/issue_comments_110969.json:
```json
{
    "body": "Technically, some_elements should return an iterable, not an iterator, so you can iterate over it more than once. The except clause should be changed to return [], not return iter([]), though with the empty case the behavior is the same.",
    "created_at": "2011-01-27T05:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110969",
    "user": "robertwb"
}
```

Technically, some_elements should return an iterable, not an iterator, so you can iterate over it more than once. The except clause should be changed to return [], not return iter([]), though with the empty case the behavior is the same.



---

archive/issue_comments_110970.json:
```json
{
    "body": "Good point. I will ask today Nicolas what does he think about that... I don't really know the specifications for the Test Suite and how deal exactly with such corner case.\nFlorent did this with FiniteEnumeratedSet (The user know a priori that the set is finite...)\n\n```\nsage: FiniteEnumeratedSet([])\n{}\nsage: FiniteEnumeratedSet([]).some_elements()\n<generator object _some_elements_from_iterator at 0xb433464>\n```\n\nI will give an answer shortly for that.",
    "created_at": "2011-01-27T07:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110970",
    "user": "nborie"
}
```

Good point. I will ask today Nicolas what does he think about that... I don't really know the specifications for the Test Suite and how deal exactly with such corner case.
Florent did this with FiniteEnumeratedSet (The user know a priori that the set is finite...)

```
sage: FiniteEnumeratedSet([])
{}
sage: FiniteEnumeratedSet([]).some_elements()
<generator object _some_elements_from_iterator at 0xb433464>
```

I will give an answer shortly for that.



---

archive/issue_comments_110971.json:
```json
{
    "body": "As this ticket fix a corner case and try to increase of the coherence for the code about sets, it have to verify all the specifications. Thanks you very much Robert for pointing this. It now return []. Even the behavior is the same, I don't want to fix a mathematical corner case by introducing a Spec corner case...\n\nIt should be ready for review now.",
    "created_at": "2011-01-31T08:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110971",
    "user": "nborie"
}
```

As this ticket fix a corner case and try to increase of the coherence for the code about sets, it have to verify all the specifications. Thanks you very much Robert for pointing this. It now return []. Even the behavior is the same, I don't want to fix a mathematical corner case by introducing a Spec corner case...

It should be ready for review now.



---

archive/issue_comments_110972.json:
```json
{
    "body": "I confirm the problem is fixed, and all doctests still pass.\nThus I give a positive review.\n\nPaul",
    "created_at": "2011-02-08T09:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110972",
    "user": "zimmerma"
}
```

I confirm the problem is fixed, and all doctests still pass.
Thus I give a positive review.

Paul



---

archive/issue_comments_110973.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-02-08T09:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110973",
    "user": "zimmerma"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_110974.json:
```json
{
    "body": "I think you should add an example which shows the `EmptySetError`.",
    "created_at": "2011-02-08T09:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110974",
    "user": "jdemeyer"
}
```

I think you should add an example which shows the `EmptySetError`.



---

archive/issue_comments_110975.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-02-08T09:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110975",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_110976.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-02-08T10:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110976",
    "user": "nborie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_110977.json:
```json
{
    "body": "I just had two tests... Especially one which returns the EmptySetError... Thanks all for your comments and suggestions.",
    "created_at": "2011-02-08T10:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110977",
    "user": "nborie"
}
```

I just had two tests... Especially one which returns the EmptySetError... Thanks all for your comments and suggestions.



---

archive/issue_comments_110978.json:
```json
{
    "body": "after thought, the on-line documentation of `S.an_element` should mention that if `S` is\nempty, an `EmptySetError` is returned.\n\nPaul",
    "created_at": "2011-02-08T13:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110978",
    "user": "zimmerma"
}
```

after thought, the on-line documentation of `S.an_element` should mention that if `S` is
empty, an `EmptySetError` is returned.

Paul



---

archive/issue_comments_110979.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-02-08T13:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110979",
    "user": "zimmerma"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_110980.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-02-16T11:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110980",
    "user": "nborie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_110981.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-02-18T00:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110981",
    "user": "robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_110982.json:
```json
{
    "body": "Looking good now.",
    "created_at": "2011-02-18T00:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110982",
    "user": "robertwb"
}
```

Looking good now.



---

archive/issue_comments_110983.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-03-17T19:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110983",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_110984.json:
```json
{
    "body": "You should change the commit message of the patch (using `hg qrefresh -e`) to something sensible, making sure the ticket number appears on the first line of the commit message.",
    "created_at": "2011-03-17T19:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110984",
    "user": "jdemeyer"
}
```

You should change the commit message of the patch (using `hg qrefresh -e`) to something sensible, making sure the ticket number appears on the first line of the commit message.



---

archive/issue_comments_110985.json:
```json
{
    "body": "Attachment [trac_10651_fix_an_element_from_iterator-nb.patch](tarball://root/attachments/some-uuid/ticket10651/trac_10651_fix_an_element_from_iterator-nb.patch) by nborie created at 2011-03-21 16:27:05\n\nIn order to fix more things in the same time, I update the description of this ticket. I folded the NT'reviewer from the sage-combinat queue, then I uploaded the patch with a better commit message.\n\nI am very OK with the changes in the Parent structure from Nicolas Thi\u00e9ry. I give a positive review on all changes touching the corresponding file. The first part of the patch still comes from me, so no review from me.",
    "created_at": "2011-03-21T16:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110985",
    "user": "nborie"
}
```

Attachment [trac_10651_fix_an_element_from_iterator-nb.patch](tarball://root/attachments/some-uuid/ticket10651/trac_10651_fix_an_element_from_iterator-nb.patch) by nborie created at 2011-03-21 16:27:05

In order to fix more things in the same time, I update the description of this ticket. I folded the NT'reviewer from the sage-combinat queue, then I uploaded the patch with a better commit message.

I am very OK with the changes in the Parent structure from Nicolas Thiéry. I give a positive review on all changes touching the corresponding file. The first part of the patch still comes from me, so no review from me.



---

archive/issue_comments_110986.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-21T16:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110986",
    "user": "nborie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_110987.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-03-21T16:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110987",
    "user": "nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_110988.json:
```json
{
    "body": "And positive review on your part. Good to go!",
    "created_at": "2011-03-21T16:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110988",
    "user": "nthiery"
}
```

And positive review on your part. Good to go!



---

archive/issue_comments_110989.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-03-24T20:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10598#issuecomment-110989",
    "user": "jdemeyer"
}
```

Resolution: fixed
