# Issue 5211: add charset header to worksheet html header

Issue created by migration from https://trac.sagemath.org/ticket/5211

Original creator: ddrake

Original creation time: 2009-02-09 04:04:50

Assignee: boothby

CC:  mhansen

Right now, the html generated for a worksheet does not include a header specifying the encoding, which confuses browsers: http://groups.google.com/group/sage-support/t/3d4b400f5afe66fb

As suggested by the OP of that thread, we should add

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
```

to the worksheet html.


---

Comment by ddrake created at 2009-02-09 07:18:41

The attached patch (trac_5211.patch) adds Content-Type headers to (I think) all of the pages generated by the notebook server...but it seems like to be sure, we should also get Twisted to add Content-Type headers to its HTTP response. I poked around trying to figure out how to do that, but I don't know enough about that side of things to change it appropriately.

Also, this ticket is closely related to #1477 and #2896.

And here's a W3C page on character encodings: http://www.w3.org/International/O-charset


---

Comment by mabshoff created at 2009-02-10 06:48:15

This would be nice to get into 3.3 since it causes trouble for IE users.

Dan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.

Cheers,

Michael


---

Comment by mabshoff created at 2009-02-10 06:48:15

Changing priority from major to critical.


---

Comment by mabshoff created at 2009-02-10 06:49:27

Mike, 

it would be nice if you could review this.

Cheers,

Michael


---

Comment by ddrake created at 2009-02-10 06:56:12

Replying to [comment:2 mabshoff]:
> This would be nice to get into 3.3 since it causes trouble for IE users.
> 
> Dan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.

Okay. I set the milestone to 3.4.1 because I wasn't sure if you were still considering these kinds of tickets for 3.3, and I didn't add a "[with patch, needs review]" because it's not quite done -- we also need to get Twisted to add the correct header, and I don't know how to do that. I was going to ping some of the usual notebook suspects and ask for some help. I see you've already done that. :)

Also, before we charge ahead and merge this, perhaps we should try and find out if anyone uses notebooks *not* encoded in UTF-8...it seems like we already should be encoding everything UTF-8, but as our continuing problems with accents show, there is some potential for problems to crop up.


---

Comment by mabshoff created at 2009-02-10 07:00:50

Ok, if it isn't ready it should be marked as such. Any ticket with a patch should have the "with patch" marker since there is no way to find tickets with patch otherwise that I am aware of.

It sounds like this ticket will miss the boat in 3.3, but there is another, closely related ticket with patch that needs work at #4547 by Mike, so it seems likely that this will come up again in 3.4 or later. Fixing this once and for all would be nice since it otherwise impedes adopting of Sage in countries where they have funny accents or even dare not to use English at all :) 

Cheers,

Michael


---

Comment by ddrake created at 2009-02-10 09:43:09

Ah, #4547 is exactly what I was looking for.


---

Attachment


---

Comment by ddrake created at 2009-03-02 06:52:39

I've attached a new version of the patch, rebased against 3.4.alpha0.


---

Comment by mhansen created at 2009-03-19 12:02:09

Since #4547 was what Dan needed, I can give this a positive review.


---

Comment by mabshoff created at 2009-03-23 21:36:33

Merged in Sage 3.4.1.alpha0.

Cheers,

Michael


---

Comment by mabshoff created at 2009-03-23 21:36:33

Resolution: fixed
