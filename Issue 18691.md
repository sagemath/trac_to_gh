# Issue 18691: A new structure for Reed-Solomon codes in Sage

Issue created by migration from https://trac.sagemath.org/ticket/18928

Original creator: dlucas

Original creation time: 2015-07-20 12:23:59

This ticket proposes a new implementation for Generalized Reed-Solomon codes in Sage.
It contains:

- a new code class, `GeneralizedReedSolomonCode`, which wraps Reed-Solomon code in the object-oriented structure introduced in #18099,
- a first new encoder, `GRSEvaluationVectorEncoder`, which can encode words from a message space which is a vector space, and
- a second new encoder, `GRSEvaluationPolynomialEncoder`, which can encode words from a message space which is a polynomial ring.

This new implementation properly sets GRS codes in the object-oriented structure, which allows the user to use specific methods and algorithms to encode (and later decode) words. It also introduces the notion of generalized Reed-Solomon codes, which means that the user can now set a list of column multipliers for the code. 

It also allows to compute parity-check matrix and generator matrix from the parameters of the code, through dedicated methods. 

As GRS codes are now objects in Sage, it is also possible to ask a GRS code for its specific parameters (like the list of its evaluation points, or its column multipliers).

The two provided encoders follow the structure introduced in #18376.

More details about GRS codes can be found in the docstring of the provided code.


---

Comment by dlucas created at 2015-07-20 12:30:31

New commits:


---

Comment by dlucas created at 2015-07-20 12:30:31

Changing status from new to needs_review.


---

Comment by git created at 2015-09-15 12:17:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-09-15 12:18:38

I updated this ticket to latest beta, and added a few new methods, it's still in the needs_review state.


---

Comment by jsrn created at 2015-09-15 13:17:14

This is not a review: just a comment. I slightly modified the description to underline the awesomeness of your latest commit ("overwrote a few methods"). Perhaps you could also add to the docstring of those overwritten methods that they are fast for this code (since a user would otherwise assume they are slow)?

Johan


---

Comment by git created at 2015-10-19 14:35:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-10-19 14:37:57

I updated this ticket by resolving merge conflicts with latest beta, removing dependency to #18813 and fixing broken doctests in thematic tutorial related to coding theory.

It's now open for review as it does not depend on unmerged ticket anymore.


---

Comment by git created at 2015-11-09 05:24:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-11-09 05:25:19

Fixed merge conflicts after release of 6.10beta3. Still open for review.


---

Comment by git created at 2015-12-01 09:14:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-01 13:16:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jsrn created at 2015-12-02 16:36:11

I read through everything. I've polished a number of doc-tests and doc-strings, both for clarity, correctness and paedagogy. Also, I've removed `unencode_nocheck` on the vector-style encoder (since the inherited one is much faster), and I've added input sanity checks to `encode` for the polynomial-style encoder.

If you can accept my modifications, I give this ticket the green light.
----
New commits:


---

Comment by git created at 2015-12-02 16:54:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-12-02 20:14:32

Hello,

It seems that your changes actually broke something...

If you look in `src/doc/en/thematic_tutorials.coding_theory.rst` lines 614-619, you'll see that the following input:



```
sage: F.<a> = GF(3^2,"a")
sage: pts = [0,1,a,a^2,2*a,2*a+1]
sage: C = codes.GeneralizedReedSolomonCode(pts, 4)
```


is not accepted anymore.

Furthermore, the following:


```
sage: F.<a> = GF(3^2,"a")
sage: C = codes.GeneralizedReedSolomonCode(F.list()[:6], 4)
```


is accepted but `sage: C` returns `[6, 4, 3] Generalized Reed-Solomon Code over Finite Field of size 3` and the _over Finite Field of size 3_ looks weird to me.

David


---

Comment by jsrn created at 2015-12-02 20:19:05

Merde... Good catch.


---

Comment by dlucas created at 2015-12-02 20:36:42

Yup. Oh, by the way I got tricked by that quite a lot of times (until I add these into my test script), there's two external files using methods from coding, namely:

- `src/doc/en/constructions/linear_codes.rst` and
- `src/doc/en/thematic_tutorials/coding_theory.rst`.

They do contain doctests, so remember to test these as well as the `coding` folder when you make changes.


---

Comment by jsrn created at 2015-12-02 20:42:25

Got it, thanks.


---

Comment by git created at 2015-12-03 08:50:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jsrn created at 2015-12-03 08:56:29

Ok, coercion and conversion galore! I've rolled back to a refined version of your "let the vector constructor take care of conversion for me"-solution: now eval pts and col mults are converted simultaneously to find a common parent field. This forbids e.g. having eval pts in F(59) but col mults in F(61) (which was allowed with your version).
I also added a check and test for sanity of the dimension parameter.


---

Comment by dlucas created at 2015-12-03 09:42:47

Changing status from needs_review to positive_review.


---

Comment by dlucas created at 2015-12-03 09:42:47

Ok, tests pass and I agree with your changes.
I give the green light.
I added you as an author & a reviewer.


---

Comment by vbraun created at 2015-12-05 10:01:15

Resolution: fixed
