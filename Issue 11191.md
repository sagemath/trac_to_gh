# Issue 11191: Update setuptools to a newer version

archive/issues_011191.json:
```json
{
    "body": "Assignee: tbd\n\nFor #9958 we will need a newer version of setuptools. Early testing indicate that twisted cannot be installed with the currently shipped version of setuptools and python-2.7.1.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11363\n\n",
    "created_at": "2011-05-20T20:43:10Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Update setuptools to a newer version",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11191",
    "user": "https://github.com/kiwifb"
}
```
Assignee: tbd

For #9958 we will need a newer version of setuptools. Early testing indicate that twisted cannot be installed with the currently shipped version of setuptools and python-2.7.1.

Issue created by migration from https://trac.sagemath.org/ticket/11363





---

archive/issue_comments_122873.json:
```json
{
    "body": "Attachment [setuptools-update.patch](tarball://root/attachments/some-uuid/ticket11363/setuptools-update.patch) by @kiwifb created at 2011-05-21 00:06:59\n\nupdate patch, for reviewer only",
    "created_at": "2011-05-21T00:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122873",
    "user": "https://github.com/kiwifb"
}
```

Attachment [setuptools-update.patch](tarball://root/attachments/some-uuid/ticket11363/setuptools-update.patch) by @kiwifb created at 2011-05-21 00:06:59

update patch, for reviewer only



---

archive/issue_comments_122874.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-21T00:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122874",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_122875.json:
```json
{
    "body": "I don't know if this matters, but I get\n\n```\npatching file setup.py\nHunk #1 succeeded at 137 with fuzz 2 (offset 111 lines).\n```\nelse it installs fine for me.",
    "created_at": "2011-05-23T14:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122875",
    "user": "https://github.com/kcrisman"
}
```

I don't know if this matters, but I get

```
patching file setup.py
Hunk #1 succeeded at 137 with fuzz 2 (offset 111 lines).
```
else it installs fine for me.



---

archive/issue_comments_122876.json:
```json
{
    "body": "I can remove the fuzz but I am not worried by it. I consider a normal part of the patch \"aging process\" but the ability of fuzz make them a bit more robust and durable than just copying files. But I guess you shouldn't have fuzz for a patch introduced to sage for the first time. I lifted it from Gentoo where it was introduced in an earlier version.",
    "created_at": "2011-05-23T18:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122876",
    "user": "https://github.com/kiwifb"
}
```

I can remove the fuzz but I am not worried by it. I consider a normal part of the patch "aging process" but the ability of fuzz make them a bit more robust and durable than just copying files. But I guess you shouldn't have fuzz for a patch introduced to sage for the first time. I lifted it from Gentoo where it was introduced in an earlier version.



---

archive/issue_comments_122877.json:
```json
{
    "body": "Fuzz removed in \".p0\" I had to give it a distinct name because google-code doesn't let delete or replace the old one. It should really be just 0.6.16",
    "created_at": "2011-05-25T01:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122877",
    "user": "https://github.com/kiwifb"
}
```

Fuzz removed in ".p0" I had to give it a distinct name because google-code doesn't let delete or replace the old one. It should really be just 0.6.16



---

archive/issue_comments_122878.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-26T13:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122878",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_122879.json:
```json
{
    "body": "http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.",
    "created_at": "2011-05-26T13:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122879",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.



---

archive/issue_comments_122880.json:
```json
{
    "body": "Replying to [comment:6 mariah]:\n> http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.\n\n\nWorking on that. It shouldn't have been named .p0 in the first place, I have to find another place to host the spkg otherwise I'll to name it .p1.",
    "created_at": "2011-05-26T19:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122880",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:6 mariah]:
> http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.


Working on that. It shouldn't have been named .p0 in the first place, I have to find another place to host the spkg otherwise I'll to name it .p1.



---

archive/issue_comments_122881.json:
```json
{
    "body": "OK I have it hosted with the right name by my friend Steve now.",
    "created_at": "2011-05-26T20:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122881",
    "user": "https://github.com/kiwifb"
}
```

OK I have it hosted with the right name by my friend Steve now.



---

archive/issue_comments_122882.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-26T20:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122882",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_122883.json:
```json
{
    "body": "Built sage-4.7.rc4 with setuptools-0.6.16.spkg with 'make testlong'.  All tests passed.  Positive review!",
    "created_at": "2011-05-27T18:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122883",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Built sage-4.7.rc4 with setuptools-0.6.16.spkg with 'make testlong'.  All tests passed.  Positive review!



---

archive/issue_comments_122884.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-27T18:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122884",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_122885.json:
```json
{
    "body": "As soon as this ticket is fixed, then Ticket #10361 can also be closed (as this ticket supersedes that one by upgrading to an even newer setuptools, and fixing the Twisted/OSX issue).",
    "created_at": "2011-05-30T00:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122885",
    "user": "https://trac.sagemath.org/admin/accounts/users/Koen"
}
```

As soon as this ticket is fixed, then Ticket #10361 can also be closed (as this ticket supersedes that one by upgrading to an even newer setuptools, and fixing the Twisted/OSX issue).



---

archive/issue_comments_122886.json:
```json
{
    "body": "Pity I didn't see that ticket. May be I would have reviewed it instead.",
    "created_at": "2011-05-30T01:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122886",
    "user": "https://github.com/kiwifb"
}
```

Pity I didn't see that ticket. May be I would have reviewed it instead.



---

archive/issue_comments_122887.json:
```json
{
    "body": "As far as I can tell, the spkg here is not really setuptools, but a fork of it called \"distribute\".  At least, I can't find setuptools 0.6.16 on the setuptools web page [http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools), but I do see it on the distribute page [http://pypi.python.org/pypi/distribute](http://pypi.python.org/pypi/distribute).  This needs to be documented in the SPKG.txt file: update both the description and the web page.\n\nOn the bright side, on my OS X box at least, it doesn't seem to suffer from the same problem as reported on #10361.",
    "created_at": "2011-05-31T20:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122887",
    "user": "https://github.com/jhpalmieri"
}
```

As far as I can tell, the spkg here is not really setuptools, but a fork of it called "distribute".  At least, I can't find setuptools 0.6.16 on the setuptools web page [http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools), but I do see it on the distribute page [http://pypi.python.org/pypi/distribute](http://pypi.python.org/pypi/distribute).  This needs to be documented in the SPKG.txt file: update both the description and the web page.

On the bright side, on my OS X box at least, it doesn't seem to suffer from the same problem as reported on #10361.



---

archive/issue_comments_122888.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-05-31T20:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122888",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_122889.json:
```json
{
    "body": "Right. I should have paid more attention you are right. I will update SPKG.txt with the needed info. I will post again when it is available so you can decide if it can be switched back to positive review.",
    "created_at": "2011-05-31T22:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122889",
    "user": "https://github.com/kiwifb"
}
```

Right. I should have paid more attention you are right. I will update SPKG.txt with the needed info. I will post again when it is available so you can decide if it can be switched back to positive review.



---

archive/issue_comments_122890.json:
```json
{
    "body": "Attachment [SPKG.txt.patch](tarball://root/attachments/some-uuid/ticket11363/SPKG.txt.patch) by @kiwifb created at 2011-05-31 22:59:34\n\nLatest changes to SPKG.txt for the reviewer only",
    "created_at": "2011-05-31T22:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122890",
    "user": "https://github.com/kiwifb"
}
```

Attachment [SPKG.txt.patch](tarball://root/attachments/some-uuid/ticket11363/SPKG.txt.patch) by @kiwifb created at 2011-05-31 22:59:34

Latest changes to SPKG.txt for the reviewer only



---

archive/issue_comments_122891.json:
```json
{
    "body": "New spkg uploaded at the same location. I attached a patch which details my latest change to SPKG.txt.",
    "created_at": "2011-05-31T23:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122891",
    "user": "https://github.com/kiwifb"
}
```

New spkg uploaded at the same location. I attached a patch which details my latest change to SPKG.txt.



---

archive/issue_comments_122892.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-06-01T04:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122892",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_122893.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-06-10T08:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122893",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_029510.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-10T08:52:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11191#event-29510"
}
```



---

archive/issue_comments_122894.json:
```json
{
    "body": "Ticket #7230 can also be closed because of this.",
    "created_at": "2011-06-20T18:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122894",
    "user": "https://github.com/jhpalmieri"
}
```

Ticket #7230 can also be closed because of this.



---

archive/issue_comments_122895.json:
```json
{
    "body": "I think it's not a bad idea to look at previous tickets dealing with an spkg when updating it.\n\nIn this case #10361 (updating setuptools to 0.6c11), which got positively reviewed and merged, but later unmerged again due to an issue with `twisted` on MacOS X.\n\nThe changes made there, namely\n* making `spkg-install` executable,\n* adding a *Special Update / Build Instructions* section to `SPKG.txt` (with a note on deleting the Windows binaries),\n* removing mabs from the spkg maintainer list (I'm not sure if that's still desired),\n* substituting `#!/bin/sh` by `#!/usr/bin/env bash`, and, last but not least\n* adding error checks to `spkg-install` (though now in addition patches are applied from it)\nare all missing in the new spkg here.\n\nBtw, the patch [attachment:setuptools-update.patch] (for review purposes) doesn't really reflect the changes made to (Sage's part of) the spkg, which is perhaps minor here, but still a bit confusing.",
    "created_at": "2011-06-24T20:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122895",
    "user": "https://github.com/nexttime"
}
```

I think it's not a bad idea to look at previous tickets dealing with an spkg when updating it.

In this case #10361 (updating setuptools to 0.6c11), which got positively reviewed and merged, but later unmerged again due to an issue with `twisted` on MacOS X.

The changes made there, namely
* making `spkg-install` executable,
* adding a *Special Update / Build Instructions* section to `SPKG.txt` (with a note on deleting the Windows binaries),
* removing mabs from the spkg maintainer list (I'm not sure if that's still desired),
* substituting `#!/bin/sh` by `#!/usr/bin/env bash`, and, last but not least
* adding error checks to `spkg-install` (though now in addition patches are applied from it)
are all missing in the new spkg here.

Btw, the patch [attachment:setuptools-update.patch] (for review purposes) doesn't really reflect the changes made to (Sage's part of) the spkg, which is perhaps minor here, but still a bit confusing.



---

archive/issue_comments_122896.json:
```json
{
    "body": "You are quite right leif and I probably could have done a better job. My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant. I get better results from Gentoo's bugzilla - although it is sometimes quite slow at least I usually got interesting results.\n\nI am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.",
    "created_at": "2011-06-24T20:28:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122896",
    "user": "https://github.com/kiwifb"
}
```

You are quite right leif and I probably could have done a better job. My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant. I get better results from Gentoo's bugzilla - although it is sometimes quite slow at least I usually got interesting results.

I am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.



---

archive/issue_comments_122897.json:
```json
{
    "body": "Replying to [comment:20 fbissey]:\n> You are quite right leif and I probably could have done a better job.\n\n\nWell, there are reviewers, too, and in fact some people who commented here were aware of that ticket.\n\n\n\n\n> My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant.\n\n\nYes, especially if you're searching for things like R... 8-)\n\n\n\n\n> I am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.\n\n\nNot really relevant here, but even patches / diffs just for reference should IMHO be up-to-date. I just stumbled upon\n\n```diff\n--- setup.py    2007-09-04 19:18:46.000000000 +0300 \n+++ setup.py    2007-11-04 09:49:18.000000000 +0200 \n@@ -26,7 +26,6 @@ \n     url = \"http://pypi.python.org/pypi/setuptools\", \n     test_suite = 'setuptools.tests', \n     packages = find_packages(), \n-    package_data = {'setuptools':['*.exe']}, \n  \n     py_modules = ['pkg_resources', 'easy_install', 'site'], \n```\nwhich definitely belongs to an earlier version of the spkg. (Note the `url` in the context.)\n\nIf someone is lazy (like me), he might review (more or less) just the spkg diff on trac as is, assuming it reflects the current state of the spkg, such that mistakes or unintended changes made later may sneak in.",
    "created_at": "2011-06-24T21:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122897",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:20 fbissey]:
> You are quite right leif and I probably could have done a better job.


Well, there are reviewers, too, and in fact some people who commented here were aware of that ticket.




> My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant.


Yes, especially if you're searching for things like R... 8-)




> I am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.


Not really relevant here, but even patches / diffs just for reference should IMHO be up-to-date. I just stumbled upon

```diff
--- setup.py    2007-09-04 19:18:46.000000000 +0300 
+++ setup.py    2007-11-04 09:49:18.000000000 +0200 
@@ -26,7 +26,6 @@ 
     url = "http://pypi.python.org/pypi/setuptools", 
     test_suite = 'setuptools.tests', 
     packages = find_packages(), 
-    package_data = {'setuptools':['*.exe']}, 
  
     py_modules = ['pkg_resources', 'easy_install', 'site'], 
```
which definitely belongs to an earlier version of the spkg. (Note the `url` in the context.)

If someone is lazy (like me), he might review (more or less) just the spkg diff on trac as is, assuming it reflects the current state of the spkg, such that mistakes or unintended changes made later may sneak in.



---

archive/issue_comments_122898.json:
```json
{
    "body": "P.S.: I usually cc the spkg maintainers (as listed in `SPKG.txt`, and also on a completely outdated wiki page ;-) ), though apparently these entries have lost meaning, unfortunately.",
    "created_at": "2011-06-24T21:22:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122898",
    "user": "https://github.com/nexttime"
}
```

P.S.: I usually cc the spkg maintainers (as listed in `SPKG.txt`, and also on a completely outdated wiki page ;-) ), though apparently these entries have lost meaning, unfortunately.



---

archive/issue_comments_122899.json:
```json
{
    "body": "P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for \"R\".\n\nThat's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.",
    "created_at": "2011-06-24T21:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122899",
    "user": "https://github.com/nexttime"
}
```

P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for "R".

That's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.



---

archive/issue_comments_122900.json:
```json
{
    "body": "Replying to [comment:23 leif]:\n> P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for \"R\".\n> \n> That's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.\n\n\nPossibly the best idea since sliced bread! Thanks a lot for pointing it out. And yes I have been treating maintainers like they do not exist (apart David Kirkby but we seem to end up doing a lot of things together so this may explain that) which is of course terribly impolite of me.",
    "created_at": "2011-06-24T23:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11191#issuecomment-122900",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:23 leif]:
> P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for "R".
> 
> That's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.


Possibly the best idea since sliced bread! Thanks a lot for pointing it out. And yes I have been treating maintainers like they do not exist (apart David Kirkby but we seem to end up doing a lot of things together so this may explain that) which is of course terribly impolite of me.
