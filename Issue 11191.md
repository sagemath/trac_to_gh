# Issue 11191: Update setuptools to a newer version

Issue created by migration from https://trac.sagemath.org/ticket/11363

Original creator: fbissey

Original creation time: 2011-05-20 20:43:10

Assignee: tbd

For #9958 we will need a newer version of setuptools. Early testing indicate that twisted cannot be installed with the currently shipped version of setuptools and python-2.7.1.


---

Attachment

update patch, for reviewer only


---

Comment by fbissey created at 2011-05-21 00:07:15

Changing status from new to needs_review.


---

Comment by kcrisman created at 2011-05-23 14:55:53

I don't know if this matters, but I get

```
patching file setup.py
Hunk #1 succeeded at 137 with fuzz 2 (offset 111 lines).
```

else it installs fine for me.


---

Comment by fbissey created at 2011-05-23 18:37:25

I can remove the fuzz but I am not worried by it. I consider a normal part of the patch "aging process" but the ability of fuzz make them a bit more robust and durable than just copying files. But I guess you shouldn't have fuzz for a patch introduced to sage for the first time. I lifted it from Gentoo where it was introduced in an earlier version.


---

Comment by fbissey created at 2011-05-25 01:53:52

Fuzz removed in ".p0" I had to give it a distinct name because google-code doesn't let delete or replace the old one. It should really be just 0.6.16


---

Comment by mariah created at 2011-05-26 13:22:46

Changing status from needs_review to needs_work.


---

Comment by mariah created at 2011-05-26 13:22:46

http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.


---

Comment by fbissey created at 2011-05-26 19:19:57

Replying to [comment:6 mariah]:
> http://spkg-upload.googlecode.com/files/setuptools-0.6.16.p0.spkg unpacks to setuptools-0.6.16 when it should unpack to setuptools-0.6.16.p0.

Working on that. It shouldn't have been named .p0 in the first place, I have to find another place to host the spkg otherwise I'll to name it .p1.


---

Comment by fbissey created at 2011-05-26 20:06:34

OK I have it hosted with the right name by my friend Steve now.


---

Comment by fbissey created at 2011-05-26 20:06:34

Changing status from needs_work to needs_review.


---

Comment by mariah created at 2011-05-27 18:50:11

Built sage-4.7.rc4 with setuptools-0.6.16.spkg with 'make testlong'.  All tests passed.  Positive review!


---

Comment by mariah created at 2011-05-27 18:50:11

Changing status from needs_review to positive_review.


---

Comment by Koen created at 2011-05-30 00:27:27

As soon as this ticket is fixed, then Ticket #10361 can also be closed (as this ticket supersedes that one by upgrading to an even newer setuptools, and fixing the Twisted/OSX issue).


---

Comment by fbissey created at 2011-05-30 01:42:43

Pity I didn't see that ticket. May be I would have reviewed it instead.


---

Comment by jhpalmieri created at 2011-05-31 20:18:46

As far as I can tell, the spkg here is not really setuptools, but a fork of it called "distribute".  At least, I can't find setuptools 0.6.16 on the setuptools web page [http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools), but I do see it on the distribute page [http://pypi.python.org/pypi/distribute](http://pypi.python.org/pypi/distribute).  This needs to be documented in the SPKG.txt file: update both the description and the web page.

On the bright side, on my OS X box at least, it doesn't seem to suffer from the same problem as reported on #10361.


---

Comment by jhpalmieri created at 2011-05-31 20:18:46

Changing status from positive_review to needs_work.


---

Comment by fbissey created at 2011-05-31 22:10:53

Right. I should have paid more attention you are right. I will update SPKG.txt with the needed info. I will post again when it is available so you can decide if it can be switched back to positive review.


---

Attachment

Latest changes to SPKG.txt for the reviewer only


---

Comment by fbissey created at 2011-05-31 23:19:07

New spkg uploaded at the same location. I attached a patch which details my latest change to SPKG.txt.


---

Comment by jhpalmieri created at 2011-06-01 04:22:16

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2011-06-10 08:52:29

Resolution: fixed


---

Comment by jhpalmieri created at 2011-06-20 18:22:34

Ticket #7230 can also be closed because of this.


---

Comment by leif created at 2011-06-24 20:08:08

I think it's not a bad idea to look at previous tickets dealing with an spkg when updating it.

In this case #10361 (updating setuptools to 0.6c11), which got positively reviewed and merged, but later unmerged again due to an issue with `twisted` on MacOS X.

The changes made there, namely
 * making `spkg-install` executable,
 * adding a _Special Update / Build Instructions_ section to `SPKG.txt` (with a note on deleting the Windows binaries),
 * removing mabs from the spkg maintainer list (I'm not sure if that's still desired),
 * substituting `#!/bin/sh` by `#!/usr/bin/env bash`, and, last but not least
 * adding error checks to `spkg-install` (though now in addition patches are applied from it)
are all missing in the new spkg here.

Btw, the patch [attachment:setuptools-update.patch] (for review purposes) doesn't really reflect the changes made to (Sage's part of) the spkg, which is perhaps minor here, but still a bit confusing.


---

Comment by fbissey created at 2011-06-24 20:28:24

You are quite right leif and I probably could have done a better job. My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant. I get better results from Gentoo's bugzilla - although it is sometimes quite slow at least I usually got interesting results.

I am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.


---

Comment by leif created at 2011-06-24 21:14:57

Replying to [comment:20 fbissey]:
> You are quite right leif and I probably could have done a better job.

Well, there are reviewers, too, and in fact some people who commented here were aware of that ticket.




> My only defense is I absolutely hate searching on trac. It takes ages and most of the results are not that relevant.

Yes, especially if you're searching for things like R... 8-)




> I am not sure I understand your last comment. The posted patch summarizes the changes to the spkg and is not meant to be applied, just to give you a quick look at the changes. It seems to be a common enough practice.

Not really relevant here, but even patches / diffs just for reference should IMHO be up-to-date. I just stumbled upon

```diff
--- setup.py    2007-09-04 19:18:46.000000000 +0300 
+++ setup.py    2007-11-04 09:49:18.000000000 +0200 
@@ -26,7 +26,6 @@ 
     url = "http://pypi.python.org/pypi/setuptools", 
     test_suite = 'setuptools.tests', 
     packages = find_packages(), 
-    package_data = {'setuptools':['*.exe']}, 
  
     py_modules = ['pkg_resources', 'easy_install', 'site'], 
```

which definitely belongs to an earlier version of the spkg. (Note the `url` in the context.)

If someone is lazy (like me), he might review (more or less) just the spkg diff on trac as is, assuming it reflects the current state of the spkg, such that mistakes or unintended changes made later may sneak in.


---

Comment by leif created at 2011-06-24 21:22:04

P.S.: I usually cc the spkg maintainers (as listed in `SPKG.txt`, and also on a completely outdated wiki page ;-) ), though apparently these entries have lost meaning, unfortunately.


---

Comment by leif created at 2011-06-24 21:42:05

P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for "R".

That's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.


---

Comment by fbissey created at 2011-06-24 23:20:10

Replying to [comment:23 leif]:
> P.P.S.: You can also search (with G**gle) http://groups.google.com/group/sage-trac, which even gives suitable results for "R".
> 
> That's IMHO the only useful aspect of this group; I don't like feeding G**gle with all that stuff otherwise.

Possibly the best idea since sliced bread! Thanks a lot for pointing it out. And yes I have been treating maintainers like they do not exist (apart David Kirkby but we seem to end up doing a lot of things together so this may explain that) which is of course terribly impolite of me.
