# Issue 20169: get_solver should allow passing a function (a solver factory) as the solver argument

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-04-09 21:22:42

CC:  dimpase vdelecroix vbraun jdemeyer

Keywords: lp

For example, to use GLPK's exact simplex algorithm:


```
def glpk_exact_solver():
    b = get_solver("GLPK")
    b.solver_parameter("simplex_or_intopt", "exact_simplex_only")
    return b

delsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver)
```



---

Comment by mkoeppe created at 2016-04-09 21:44:50

New commits:


---

Comment by mkoeppe created at 2016-04-09 21:45:28

Changing status from new to needs_review.


---

Comment by git created at 2016-04-11 01:54:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2016-04-13 19:47:06

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2016-04-13 19:47:06

this also needs a rebase (sorry for sitting on this too long...)


---

Comment by git created at 2016-04-13 22:37:13

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2016-04-13 22:37:44

Rebased on 7.2.beta4


---

Comment by mkoeppe created at 2016-04-13 22:44:24

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2016-04-14 10:10:49

without the example in the ticket description it's hard to get the idea of this change.
Can you add this example into the code?


---

Comment by git created at 2016-04-14 17:19:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2016-04-14 21:41:27

the doctest in the commit d1d84c6 appears to demonstrate a bug in the ILP solver of GLPK. The correct answer should be 3, not 2. Indeed, look at the entry n=19, k=2 in http://www.codetables.de/BKLC/Tables.php?q=7&n0=1&n1=100&k0=1&k1=100; it is 16, not 15.

(one also gets 3 when using PPL's ILP solver)


---

Comment by mkoeppe created at 2016-04-14 21:43:29

GLPK has an exact simplex, not an exact MIP solver.
See #20446


---

Comment by dimpase created at 2016-04-14 21:51:11

anyhow, this answer by GLPK is wrong, ILP or LP!
(the bound obtained by solving LP cannot be smaller than the one obtained from ILP)

```
sage: delsarte_bound_additive_hamming_space(19,15,7,isinteger=True) # ppl used
3
sage: delsarte_bound_additive_hamming_space(19,15,7) # ppl used
3
```



---

Comment by dimpase created at 2016-04-14 22:06:04


```
sage: a,p,v=delsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver,return_data=True)
...
sage:  [ZZ(j) for i,j in p.get_values(a).iteritems()]
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 0, 0, 0]
```

I need to do `ZZ` as otherwise it outputs floats. This is a maximization (of the sum of the coordinates) LP, and the following vector (computed by PPL) should be feasible, too:

```
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 307, 0, 0, 1, 34]
```



---

Comment by git created at 2016-04-14 22:45:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-04-14 22:46:57

To move this ticket forward, I have replaced the test by something else


---

Comment by mkoeppe created at 2016-04-14 22:52:46

The wrong result is now the subject of ticket #20447.


---

Comment by dimpase created at 2016-04-15 07:32:29

OK!


---

Comment by dimpase created at 2016-04-15 07:32:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-04-15 21:15:07

Resolution: fixed
