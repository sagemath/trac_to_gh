# Issue 20169: get_solver should allow passing a function (a solver factory) as the solver argument

archive/issues_020169.json:
```json
{
    "body": "CC:  @dimpase @videlec @vbraun @jdemeyer\n\nKeywords: lp\n\nFor example, to use GLPK's exact simplex algorithm:\n\n```\ndef glpk_exact_solver():\n    b = get_solver(\"GLPK\")\n    b.solver_parameter(\"simplex_or_intopt\", \"exact_simplex_only\")\n    return b\n\ndelsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver)\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/20406\n\n",
    "created_at": "2016-04-09T21:22:42Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "get_solver should allow passing a function (a solver factory) as the solver argument",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20169",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @videlec @vbraun @jdemeyer

Keywords: lp

For example, to use GLPK's exact simplex algorithm:

```
def glpk_exact_solver():
    b = get_solver("GLPK")
    b.solver_parameter("simplex_or_intopt", "exact_simplex_only")
    return b

delsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver)
```

Issue created by migration from https://trac.sagemath.org/ticket/20406





---

archive/issue_comments_277802.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-04-09T21:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277802",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_277803.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-09T21:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277803",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_277804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-11T01:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_277805.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-13T19:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277805",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_277806.json:
```json
{
    "body": "this also needs a rebase (sorry for sitting on this too long...)",
    "created_at": "2016-04-13T19:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277806",
    "user": "https://github.com/dimpase"
}
```

this also needs a rebase (sorry for sitting on this too long...)



---

archive/issue_comments_277807.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-13T22:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_277808.json:
```json
{
    "body": "Rebased on 7.2.beta4",
    "created_at": "2016-04-13T22:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277808",
    "user": "https://github.com/mkoeppe"
}
```

Rebased on 7.2.beta4



---

archive/issue_comments_277809.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-13T22:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277809",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_277810.json:
```json
{
    "body": "without the example in the ticket description it's hard to get the idea of this change.\nCan you add this example into the code?",
    "created_at": "2016-04-14T10:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277810",
    "user": "https://github.com/dimpase"
}
```

without the example in the ticket description it's hard to get the idea of this change.
Can you add this example into the code?



---

archive/issue_comments_277811.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-14T17:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277811",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_277812.json:
```json
{
    "body": "the doctest in the commit d1d84c6 appears to demonstrate a bug in the ILP solver of GLPK. The correct answer should be 3, not 2. Indeed, look at the entry n=19, k=2 in http://www.codetables.de/BKLC/Tables.php?q=7&n0=1&n1=100&k0=1&k1=100; it is 16, not 15.\n\n(one also gets 3 when using PPL's ILP solver)",
    "created_at": "2016-04-14T21:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277812",
    "user": "https://github.com/dimpase"
}
```

the doctest in the commit d1d84c6 appears to demonstrate a bug in the ILP solver of GLPK. The correct answer should be 3, not 2. Indeed, look at the entry n=19, k=2 in http://www.codetables.de/BKLC/Tables.php?q=7&n0=1&n1=100&k0=1&k1=100; it is 16, not 15.

(one also gets 3 when using PPL's ILP solver)



---

archive/issue_comments_277813.json:
```json
{
    "body": "GLPK has an exact simplex, not an exact MIP solver.\nSee #20446",
    "created_at": "2016-04-14T21:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277813",
    "user": "https://github.com/mkoeppe"
}
```

GLPK has an exact simplex, not an exact MIP solver.
See #20446



---

archive/issue_comments_277814.json:
```json
{
    "body": "anyhow, this answer by GLPK is wrong, ILP or LP!\n(the bound obtained by solving LP cannot be smaller than the one obtained from ILP)\n\n```\nsage: delsarte_bound_additive_hamming_space(19,15,7,isinteger=True) # ppl used\n3\nsage: delsarte_bound_additive_hamming_space(19,15,7) # ppl used\n3\n```",
    "created_at": "2016-04-14T21:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277814",
    "user": "https://github.com/dimpase"
}
```

anyhow, this answer by GLPK is wrong, ILP or LP!
(the bound obtained by solving LP cannot be smaller than the one obtained from ILP)

```
sage: delsarte_bound_additive_hamming_space(19,15,7,isinteger=True) # ppl used
3
sage: delsarte_bound_additive_hamming_space(19,15,7) # ppl used
3
```



---

archive/issue_comments_277815.json:
```json
{
    "body": "```\nsage: a,p,v=delsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver,return_data=True)\n...\nsage:  [ZZ(j) for i,j in p.get_values(a).iteritems()]\n[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 0, 0, 0]\n```\nI need to do `ZZ` as otherwise it outputs floats. This is a maximization (of the sum of the coordinates) LP, and the following vector (computed by PPL) should be feasible, too:\n\n```\n[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 307, 0, 0, 1, 34]\n```",
    "created_at": "2016-04-14T22:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277815",
    "user": "https://github.com/dimpase"
}
```

```
sage: a,p,v=delsarte_bound_additive_hamming_space(19,15,7,solver=glpk_exact_solver,return_data=True)
...
sage:  [ZZ(j) for i,j in p.get_values(a).iteritems()]
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 0, 0, 0]
```
I need to do `ZZ` as otherwise it outputs floats. This is a maximization (of the sum of the coordinates) LP, and the following vector (computed by PPL) should be feasible, too:

```
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 307, 0, 0, 1, 34]
```



---

archive/issue_comments_277816.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-14T22:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277816",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_277817.json:
```json
{
    "body": "To move this ticket forward, I have replaced the test by something else",
    "created_at": "2016-04-14T22:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277817",
    "user": "https://github.com/mkoeppe"
}
```

To move this ticket forward, I have replaced the test by something else



---

archive/issue_comments_277818.json:
```json
{
    "body": "The wrong result is now the subject of ticket #20447.",
    "created_at": "2016-04-14T22:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277818",
    "user": "https://github.com/mkoeppe"
}
```

The wrong result is now the subject of ticket #20447.



---

archive/issue_comments_277819.json:
```json
{
    "body": "OK!",
    "created_at": "2016-04-15T07:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277819",
    "user": "https://github.com/dimpase"
}
```

OK!



---

archive/issue_comments_277820.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-15T07:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277820",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_277821.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-15T21:15:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20169#issuecomment-277821",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055255.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-15T21:15:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20169",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20169#event-55255"
}
```
