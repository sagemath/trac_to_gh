# Issue 17398: Update Givaro to 3.8.0

archive/issues_017398.json:
```json
{
    "body": "CC:  fbissey cpernet\n\nTarball at:\n* https://forge.imag.fr/frs/download.php/592/givaro-3.8.0.tar.gz\n\nIssue created by migration from https://trac.sagemath.org/ticket/17635\n\n",
    "created_at": "2015-01-15T14:13:04Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "title": "Update Givaro to 3.8.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17398",
    "user": "jpflori"
}
```
CC:  fbissey cpernet

Tarball at:
* https://forge.imag.fr/frs/download.php/592/givaro-3.8.0.tar.gz

Issue created by migration from https://trac.sagemath.org/ticket/17635





---

archive/issue_comments_231995.json:
```json
{
    "body": "Requires to update:\n* fflas-ffpack to 2.0.0, see #17636\n* linbox, no release yet",
    "created_at": "2015-01-15T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-231995",
    "user": "jpflori"
}
```

Requires to update:
* fflas-ffpack to 2.0.0, see #17636
* linbox, no release yet



---

archive/issue_comments_231996.json:
```json
{
    "body": "So we have to wait for linbox? Do we have an idea of when it will happen?",
    "created_at": "2015-01-15T22:18:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-231996",
    "user": "fbissey"
}
```

So we have to wait for linbox? Do we have an idea of when it will happen?



---

archive/issue_comments_231997.json:
```json
{
    "body": "Replying to [comment:2 fbissey]:\n> So we have to wait for linbox? Do we have an idea of when it will happen?\nYes we have to wait for a new Linbox, expected about the end of february, Cl\u00e9ment Pernet wrote me, together with updated Givaro and fflas-ffpack.\n\nBy the way, I started this for #17630 which might interest you as well, I'll push code there tomorrow.",
    "created_at": "2015-01-15T22:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-231997",
    "user": "jpflori"
}
```

Replying to [comment:2 fbissey]:
> So we have to wait for linbox? Do we have an idea of when it will happen?
Yes we have to wait for a new Linbox, expected about the end of february, Clément Pernet wrote me, together with updated Givaro and fflas-ffpack.

By the way, I started this for #17630 which might interest you as well, I'll push code there tomorrow.



---

archive/issue_comments_231998.json:
```json
{
    "body": "Replying to [comment:3 jpflori]:\n> Replying to [comment:2 fbissey]:\n> > So we have to wait for linbox? Do we have an idea of when it will happen?\n> Yes we have to wait for a new Linbox, expected about the end of february, Cl\u00e9ment Pernet wrote me, together with updated Givaro and fflas-ffpack.\nIt's June already...\n\nSince givaro, LinBox and FFLAS-FFPACK all depend on each other, we should make one ticket.",
    "created_at": "2015-05-03T11:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-231998",
    "user": "jdemeyer"
}
```

Replying to [comment:3 jpflori]:
> Replying to [comment:2 fbissey]:
> > So we have to wait for linbox? Do we have an idea of when it will happen?
> Yes we have to wait for a new Linbox, expected about the end of february, Clément Pernet wrote me, together with updated Givaro and fflas-ffpack.
It's June already...

Since givaro, LinBox and FFLAS-FFPACK all depend on each other, we should make one ticket.



---

archive/issue_comments_231999.json:
```json
{
    "body": "Sorry for the delay in releasing the fflas-ffpack/Givaro/LinBox environment.\nWe're working on it now, and I'll keep you posted about the status. It should happen before the end of the year and hopefully much earlier.\n\nI also meant to propose to replace ATLAS by OpenBLAS in sage.\nLooking at your clean-up work of the BLAS in #17630, I understand that we should proceed in the following order:\n1. release linbox \n2. upgrade linbox fflas-ffpack Givaro in Sage (this ticket #17635)\n3. clean-up the BLAS usage #17630\n4. replace ATLAS by OpenBLAS (ticket to be created)\n\nI'll be happy to help in these tasks.",
    "created_at": "2015-09-16T09:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-231999",
    "user": "cpernet"
}
```

Sorry for the delay in releasing the fflas-ffpack/Givaro/LinBox environment.
We're working on it now, and I'll keep you posted about the status. It should happen before the end of the year and hopefully much earlier.

I also meant to propose to replace ATLAS by OpenBLAS in sage.
Looking at your clean-up work of the BLAS in #17630, I understand that we should proceed in the following order:
1. release linbox 
2. upgrade linbox fflas-ffpack Givaro in Sage (this ticket #17635)
3. clean-up the BLAS usage #17630
4. replace ATLAS by OpenBLAS (ticket to be created)

I'll be happy to help in these tasks.



---

archive/issue_comments_232000.json:
```json
{
    "body": "Let me remind you also about #15535, which pops up regularly. I don't know if it's a bug in Linbox or in the way that Sage uses Linbox, but it would be good to have a Linbox developer look at it.",
    "created_at": "2015-09-16T09:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232000",
    "user": "jdemeyer"
}
```

Let me remind you also about #15535, which pops up regularly. I don't know if it's a bug in Linbox or in the way that Sage uses Linbox, but it would be good to have a Linbox developer look at it.



---

archive/issue_comments_232001.json:
```json
{
    "body": "Replying to [comment:6 cpernet]:\n> Sorry for the delay in releasing the fflas-ffpack/Givaro/LinBox environment.\n> We're working on it now, and I'll keep you posted about the status. It should happen before the end of the year and hopefully much earlier.\n> \n> I also meant to propose to replace ATLAS by OpenBLAS in sage.\n> Looking at your clean-up work of the BLAS in #17630, I understand that we should proceed in the following order:\n> 1. release linbox \n> 2. upgrade linbox fflas-ffpack Givaro in Sage (this ticket #17635)\n> 3. clean-up the BLAS usage #17630\n> 4. replace ATLAS by OpenBLAS (ticket to be created)\n> \n> I'll be happy to help in these tasks.\n\nI'll admit to have been a bit demotivated on the blas cleaning front. The tickets needs re-organizing and have good descriptions so we know what is supposed to go in them. Getting `ATLAS` to produce `.pc` file and using them is probably a priority task. Once that's done someone could create an optional `openblas` spkg or something.",
    "created_at": "2015-09-16T09:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232001",
    "user": "fbissey"
}
```

Replying to [comment:6 cpernet]:
> Sorry for the delay in releasing the fflas-ffpack/Givaro/LinBox environment.
> We're working on it now, and I'll keep you posted about the status. It should happen before the end of the year and hopefully much earlier.
> 
> I also meant to propose to replace ATLAS by OpenBLAS in sage.
> Looking at your clean-up work of the BLAS in #17630, I understand that we should proceed in the following order:
> 1. release linbox 
> 2. upgrade linbox fflas-ffpack Givaro in Sage (this ticket #17635)
> 3. clean-up the BLAS usage #17630
> 4. replace ATLAS by OpenBLAS (ticket to be created)
> 
> I'll be happy to help in these tasks.

I'll admit to have been a bit demotivated on the blas cleaning front. The tickets needs re-organizing and have good descriptions so we know what is supposed to go in them. Getting `ATLAS` to produce `.pc` file and using them is probably a priority task. Once that's done someone could create an optional `openblas` spkg or something.



---

archive/issue_comments_232002.json:
```json
{
    "body": "I'm working on it, and will release a new version of the 3 libs for the occasion, so as to ensure a smoother integration upstream. This will very likely be\ngivaro-4.0.1\nfflas-ffpack-2.2.0\nlinbox-1.4.1\n\nThese libraries now require c++11 support and this tickets therefore depends on #18323.\n\nInspired by what's propose in there, I suggest to add lines of the form\n\n`+# distutils: extra_compile_args = -std=c++11`\n\nto libs/linbox/linbox.pxd lib/linbox/fflas.pxd lib/linbox/echelonform.pxd but I understand that this is subject to a debate on sage-devel\n[https://groups.google.com/forum/#!topic/sage-devel/aGwotQA9to8](https://groups.google.com/forum/#!topic/sage-devel/aGwotQA9to8)\n\nIf this option happens to be accepted, we would then need to add more cflags in the list: namely those produced by fflas-ffpack configure related to the target architecture:\n`-mavx -msse4.1` and others like `-fabi-version=6 -fopenmp`.\n\nI could not figure a way to append the string returned by `bin/fflas-ffpack-config --cflags` to these pxd files. Any hint?",
    "created_at": "2015-09-25T08:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232002",
    "user": "cpernet"
}
```

I'm working on it, and will release a new version of the 3 libs for the occasion, so as to ensure a smoother integration upstream. This will very likely be
givaro-4.0.1
fflas-ffpack-2.2.0
linbox-1.4.1

These libraries now require c++11 support and this tickets therefore depends on #18323.

Inspired by what's propose in there, I suggest to add lines of the form

`+# distutils: extra_compile_args = -std=c++11`

to libs/linbox/linbox.pxd lib/linbox/fflas.pxd lib/linbox/echelonform.pxd but I understand that this is subject to a debate on sage-devel
[https://groups.google.com/forum/#!topic/sage-devel/aGwotQA9to8](https://groups.google.com/forum/#!topic/sage-devel/aGwotQA9to8)

If this option happens to be accepted, we would then need to add more cflags in the list: namely those produced by fflas-ffpack configure related to the target architecture:
`-mavx -msse4.1` and others like `-fabi-version=6 -fopenmp`.

I could not figure a way to append the string returned by `bin/fflas-ffpack-config --cflags` to these pxd files. Any hint?



---

archive/issue_comments_232003.json:
```json
{
    "body": "Replying to [comment:9 cpernet]:\n> I could not figure a way to append the string returned by `bin/fflas-ffpack-config --cflags` to these pxd files. Any hint?\n\nAdd a definition in `module_list.py`, you define a `LINBOX_FLAGS`. It would be easier if you had a `.pc` file as we have a python interface to `pkgconfig` that we can use easily. Here you have to do your own parsing from python. Anyway you can then use `LINBOX_FLAGS` in the `.pxd` file.",
    "created_at": "2015-09-25T09:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232003",
    "user": "fbissey"
}
```

Replying to [comment:9 cpernet]:
> I could not figure a way to append the string returned by `bin/fflas-ffpack-config --cflags` to these pxd files. Any hint?

Add a definition in `module_list.py`, you define a `LINBOX_FLAGS`. It would be easier if you had a `.pc` file as we have a python interface to `pkgconfig` that we can use easily. Here you have to do your own parsing from python. Anyway you can then use `LINBOX_FLAGS` in the `.pxd` file.



---

archive/issue_comments_232004.json:
```json
{
    "body": "Replying to [comment:9 cpernet]:\n> `-mavx -msse4.1`\nI understand that the libraries themselves want these, but why the Cython files?\n\n> and others like `-fabi-version=6`\nThis looks like it should be used always for all C++ files then. Mixing ABI's doesn't look like a good idea.\n\n> `-fopenmp`\nSame question as before, is this really needed for the Cython interface?",
    "created_at": "2015-09-25T09:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232004",
    "user": "jdemeyer"
}
```

Replying to [comment:9 cpernet]:
> `-mavx -msse4.1`
I understand that the libraries themselves want these, but why the Cython files?

> and others like `-fabi-version=6`
This looks like it should be used always for all C++ files then. Mixing ABI's doesn't look like a good idea.

> `-fopenmp`
Same question as before, is this really needed for the Cython interface?



---

archive/issue_comments_232005.json:
```json
{
    "body": "Replying to [comment:12 jdemeyer]:\n> Replying to [comment:9 cpernet]:\n> > `-mavx -msse4.1`\n> I understand that the libraries themselves want these, but why the Cython files?\n> \nfflas-ffpack and linbox are essentially source libraries, so when you include the headers, you include the whole code. This is by design, due to the ubiquity of template programming in these libraries.\n\nNow the old linbox-sage interface compiles some specializations and offer them through a C api. These extra flags would not be required if we would stick to using this interface.\n\nBut, since then, Cython started to offer the capability to hook C++ code directly and  more functionnalities have been added in sage where fflas-ffpack code is called directly, like in libs/linbox/fflas.pxd where the C++ routine FFLAS::fgemm is called.\n\n> > and others like `-fabi-version=6`\n> This looks like it should be used always for all C++ files then. Mixing ABI's doesn't look like a good idea.\n\nSure. Maybe one should change the ABI higher up then.\n\n\n> > `-fopenmp`\n> Same question as before, is this really needed for the Cython interface?\n\nSame answer as above.",
    "created_at": "2015-09-25T09:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232005",
    "user": "cpernet"
}
```

Replying to [comment:12 jdemeyer]:
> Replying to [comment:9 cpernet]:
> > `-mavx -msse4.1`
> I understand that the libraries themselves want these, but why the Cython files?
> 
fflas-ffpack and linbox are essentially source libraries, so when you include the headers, you include the whole code. This is by design, due to the ubiquity of template programming in these libraries.

Now the old linbox-sage interface compiles some specializations and offer them through a C api. These extra flags would not be required if we would stick to using this interface.

But, since then, Cython started to offer the capability to hook C++ code directly and  more functionnalities have been added in sage where fflas-ffpack code is called directly, like in libs/linbox/fflas.pxd where the C++ routine FFLAS::fgemm is called.

> > and others like `-fabi-version=6`
> This looks like it should be used always for all C++ files then. Mixing ABI's doesn't look like a good idea.

Sure. Maybe one should change the ABI higher up then.


> > `-fopenmp`
> Same question as before, is this really needed for the Cython interface?

Same answer as above.



---

archive/issue_comments_232006.json:
```json
{
    "body": "I added my working branch to the ticket.\nI could not find if and where I should store the tarballs of the new spkg?\n\nAs of today (sept 28 2015); they correspond to the upstream version of the 3 libs: givaro, fflas-ffpack and linbox.\n\nI added .pc files for givaro and fflas-ffpack (coming soon for linbox), and defined the extra_compile_flages in `modules_list.py` as suggested by fbissey.\n\nThis is still work in progress:\n* LinBox sparse solver make the test-suite fail: I'm investigating the problem, which I could not reproduce in LinBox for the moment.\n* the extra_compile_flags should be inferred from the .pc files (harcoded for the moment). I did not find how to use pkg-config through python to do it.\n----\nNew commits:",
    "created_at": "2015-09-28T14:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232006",
    "user": "cpernet"
}
```

I added my working branch to the ticket.
I could not find if and where I should store the tarballs of the new spkg?

As of today (sept 28 2015); they correspond to the upstream version of the 3 libs: givaro, fflas-ffpack and linbox.

I added .pc files for givaro and fflas-ffpack (coming soon for linbox), and defined the extra_compile_flages in `modules_list.py` as suggested by fbissey.

This is still work in progress:
* LinBox sparse solver make the test-suite fail: I'm investigating the problem, which I could not reproduce in LinBox for the moment.
* the extra_compile_flags should be inferred from the .pc files (harcoded for the moment). I did not find how to use pkg-config through python to do it.
----
New commits:



---

archive/issue_comments_232007.json:
```json
{
    "body": "Replying to [comment:16 cpernet]:\n> I could not find if and where I should store the tarballs of the new spkg?\nJust add a link to the upstream tarballs on this ticket. If any renaming is needed, you should rename the tarball and add a link to the renamed tarball.",
    "created_at": "2015-09-28T18:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232007",
    "user": "jdemeyer"
}
```

Replying to [comment:16 cpernet]:
> I could not find if and where I should store the tarballs of the new spkg?
Just add a link to the upstream tarballs on this ticket. If any renaming is needed, you should rename the tarball and add a link to the renamed tarball.



---

archive/issue_comments_232008.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-05T14:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232008",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232009.json:
```json
{
    "body": "Instead of adding flags to individual extensions, they should be added to the `.pxd` or `.pyx` files.",
    "created_at": "2015-10-05T17:03:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232009",
    "user": "jdemeyer"
}
```

Instead of adding flags to individual extensions, they should be added to the `.pxd` or `.pyx` files.



---

archive/issue_comments_232010.json:
```json
{
    "body": "Ok, now I get confused: fbissey suggested to define all compilation flags in `module_list.py`. I saw there that most spkg related extension had their flags set in this file: e.g. `flint, fplll, Lfunction, m4ri, m4rie...` Hence I moved all flags that I originally wrote in the `linbox.pxd fflas-ffpack.pxd givaro.pxd` files to `module_list.py` which has the advantage of defining everything at the same place.\n\nJeroen or Fran\u00e7ois are you suggesting that the proper way to proceed is to\n* define the flags `givaro_extra_compile_args`, `fflas_ffpack_extra_compile_args`, `linbox_extra_compile_args` in `module_list.py`\n* use them in the pxd files with something like \n\n``` \n+# distutils: extra_compile_args = ${givaro_extra_compile_args}\n```\n\n?\nWill do, if that's the way to go.\n\nAlso, I did not find how to invoque the python interface to pkgconfig, mentionned by fran\u00e7ois.",
    "created_at": "2015-10-06T08:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232010",
    "user": "cpernet"
}
```

Ok, now I get confused: fbissey suggested to define all compilation flags in `module_list.py`. I saw there that most spkg related extension had their flags set in this file: e.g. `flint, fplll, Lfunction, m4ri, m4rie...` Hence I moved all flags that I originally wrote in the `linbox.pxd fflas-ffpack.pxd givaro.pxd` files to `module_list.py` which has the advantage of defining everything at the same place.

Jeroen or François are you suggesting that the proper way to proceed is to
* define the flags `givaro_extra_compile_args`, `fflas_ffpack_extra_compile_args`, `linbox_extra_compile_args` in `module_list.py`
* use them in the pxd files with something like 

``` 
+# distutils: extra_compile_args = ${givaro_extra_compile_args}
```

?
Will do, if that's the way to go.

Also, I did not find how to invoque the python interface to pkgconfig, mentionned by françois.



---

archive/issue_comments_232011.json:
```json
{
    "body": "Sorry I have been of the net for most of the week. For how to use `pkgconfig` you can follow the way I use it for blas in sage-on-gentoo at [https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.8-blas-r1.patch](https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.8-blas-r1.patch). Note that you probably don't need to parse the `library_dir`, I do it for blas in unusual location, which is expected for intel MKL or the AMD equivalent.",
    "created_at": "2015-10-06T08:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232011",
    "user": "fbissey"
}
```

Sorry I have been of the net for most of the week. For how to use `pkgconfig` you can follow the way I use it for blas in sage-on-gentoo at [https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.8-blas-r1.patch](https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.8-blas-r1.patch). Note that you probably don't need to parse the `library_dir`, I do it for blas in unusual location, which is expected for intel MKL or the AMD equivalent.



---

archive/issue_comments_232012.json:
```json
{
    "body": "Replying to [comment:21 cpernet]:\n> I moved all flags that I originally wrote in the `linbox.pxd fflas-ffpack.pxd givaro.pxd` files to `module_list.py`\nPlease don't!\n\n> which has the advantage of defining everything at the same place.\n...but the disadvantage of requiring to add the flags to *every single extension*, which is much less scalable.\n\n> Jeroen or Fran\u00e7ois are you suggesting that the proper way to proceed is to\n>  * define the flags `givaro_extra_compile_args`, `fflas_ffpack_extra_compile_args`, `linbox_extra_compile_args` in `module_list.py`\n>  * use them in the pxd files with something like \n> {{{ \n> +# distutils: extra_compile_args = ${givaro_extra_compile_args}\n> }}}\n\nEssentially yes. You can grep for `GSL_LIBRARIES` to see how it's supposed to be done.",
    "created_at": "2015-10-06T10:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232012",
    "user": "jdemeyer"
}
```

Replying to [comment:21 cpernet]:
> I moved all flags that I originally wrote in the `linbox.pxd fflas-ffpack.pxd givaro.pxd` files to `module_list.py`
Please don't!

> which has the advantage of defining everything at the same place.
...but the disadvantage of requiring to add the flags to *every single extension*, which is much less scalable.

> Jeroen or François are you suggesting that the proper way to proceed is to
>  * define the flags `givaro_extra_compile_args`, `fflas_ffpack_extra_compile_args`, `linbox_extra_compile_args` in `module_list.py`
>  * use them in the pxd files with something like 
> {{{ 
> +# distutils: extra_compile_args = ${givaro_extra_compile_args}
> }}}

Essentially yes. You can grep for `GSL_LIBRARIES` to see how it's supposed to be done.



---

archive/issue_comments_232013.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-07T10:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232013",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232014.json:
```json
{
    "body": "This is still not quite what I meant.\n\nFor example, why does `src/sage/rings/polynomial/multi_polynomial_ideal_libsingular.pxd` need `GIVARO_CFLAGS`? Looking at that file, there is *nothing* related to givaro.\n\nI assume you added `GIVARO_CFLAGS` because it still somehow indirectly includes Givaro code. But then you should add `GIVARO_CFLAGS` in the place where the Givaro headers are actually included and Cython's dependency tracking should pick it up.\n\nSee again the `GSL_LIBRARIES` example: I don't add `GSL_LIBRARIES` to every module which somehow indirectly uses GSL, only where the library functions are actually declared.",
    "created_at": "2015-10-07T11:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232014",
    "user": "jdemeyer"
}
```

This is still not quite what I meant.

For example, why does `src/sage/rings/polynomial/multi_polynomial_ideal_libsingular.pxd` need `GIVARO_CFLAGS`? Looking at that file, there is *nothing* related to givaro.

I assume you added `GIVARO_CFLAGS` because it still somehow indirectly includes Givaro code. But then you should add `GIVARO_CFLAGS` in the place where the Givaro headers are actually included and Cython's dependency tracking should pick it up.

See again the `GSL_LIBRARIES` example: I don't add `GSL_LIBRARIES` to every module which somehow indirectly uses GSL, only where the library functions are actually declared.



---

archive/issue_comments_232015.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-07T12:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232015",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232016.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-07T12:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232016",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232017.json:
```json
{
    "body": "Replying to [comment:25 jdemeyer]:\n> I assume you added `GIVARO_CFLAGS` because it still somehow indirectly includes Givaro code. But then you should add `GIVARO_CFLAGS` in the place where the Givaro headers are actually included and Cython's dependency tracking should pick it up.\n> \nYes. It was necessary to add these flags to extensions when everything was gathered in module_list.py, but no longer now that it is in each pxd files. I now see the point!\nSorry for messing this up, it's fixed. I also made the CFLAGS variables set by the pkgconfig .pc files, as suggested by Fran\u00e7ois.\n\nOne pb remains: there is no gmp.pc for the moment, and the givaro.pc lists gmp as a dependency. Similarly fflas-ffpack.pc should list blas as dependency, but we still don't have a blas.pc file (see #17075).\nI suggest to remove these dependencies for the moment, and I'll add them once we have the proper .pc files.\nIf you confirm, I'll produce new tar.gz for givaro and fflas-ffpack accordingly.",
    "created_at": "2015-10-07T12:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232017",
    "user": "cpernet"
}
```

Replying to [comment:25 jdemeyer]:
> I assume you added `GIVARO_CFLAGS` because it still somehow indirectly includes Givaro code. But then you should add `GIVARO_CFLAGS` in the place where the Givaro headers are actually included and Cython's dependency tracking should pick it up.
> 
Yes. It was necessary to add these flags to extensions when everything was gathered in module_list.py, but no longer now that it is in each pxd files. I now see the point!
Sorry for messing this up, it's fixed. I also made the CFLAGS variables set by the pkgconfig .pc files, as suggested by François.

One pb remains: there is no gmp.pc for the moment, and the givaro.pc lists gmp as a dependency. Similarly fflas-ffpack.pc should list blas as dependency, but we still don't have a blas.pc file (see #17075).
I suggest to remove these dependencies for the moment, and I'll add them once we have the proper .pc files.
If you confirm, I'll produce new tar.gz for givaro and fflas-ffpack accordingly.



---

archive/issue_comments_232018.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-09T07:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232018",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232019.json:
```json
{
    "body": "Are there any significant API changes in the new linbox? I would like to add a linbox interface for sparse matrices over ZZ. I could do that using the current linbox-1.3.2 but I'd like to know that it will still work after upgrading linbox.",
    "created_at": "2016-02-07T09:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232019",
    "user": "jdemeyer"
}
```

Are there any significant API changes in the new linbox? I would like to add a linbox interface for sparse matrices over ZZ. I could do that using the current linbox-1.3.2 but I'd like to know that it will still work after upgrading linbox.



---

archive/issue_comments_232020.json:
```json
{
    "body": "Merged latest beta.\n----\nNew commits:",
    "created_at": "2016-02-12T15:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232020",
    "user": "jdemeyer"
}
```

Merged latest beta.
----
New commits:



---

archive/issue_comments_232021.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-02-12T15:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232021",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_232022.json:
```json
{
    "body": "`fflas_ffpack` doesn't build:\n\n```\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../fflas-ffpack/utils/ -I../../fflas-ffpack/fflas/ -I../../fflas-ffpack/ffpack -I../../fflas-ffpack/field -I/usr/local/src/sage-git/local/include -I/usr/local/src/sage-git/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L1_inst.C  -fPIC -DPIC -o .libs/fflas_L1_inst.o\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../fflas-ffpack/utils/ -I../../fflas-ffpack/fflas/ -I../../fflas-ffpack/ffpack -I../../fflas-ffpack/field -I/usr/local/src/sage-git/local/include -I/usr/local/src/sage-git/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L3_inst.C  -fPIC -DPIC -o .libs/fflas_L3_inst.o\nIn file included from ../../fflas-ffpack/fflas/fflas_sparse/csr.h:89:0,\n                 from ../../fflas-ffpack/fflas/fflas_sparse.h:126,\n                 from ../../fflas-ffpack/fflas/fflas.h:164,\n                 from fflas_L1_inst.C:34:\n../../fflas-ffpack/fflas/fflas_sparse/csr/csr_pspmm.inl:48:2: error: stray '#' in program\n   PAR_BLOCK{\n  ^\n```\n",
    "created_at": "2016-02-12T16:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232022",
    "user": "jdemeyer"
}
```

`fflas_ffpack` doesn't build:

```
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../fflas-ffpack/utils/ -I../../fflas-ffpack/fflas/ -I../../fflas-ffpack/ffpack -I../../fflas-ffpack/field -I/usr/local/src/sage-git/local/include -I/usr/local/src/sage-git/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L1_inst.C  -fPIC -DPIC -o .libs/fflas_L1_inst.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../fflas-ffpack/utils/ -I../../fflas-ffpack/fflas/ -I../../fflas-ffpack/ffpack -I../../fflas-ffpack/field -I/usr/local/src/sage-git/local/include -I/usr/local/src/sage-git/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L3_inst.C  -fPIC -DPIC -o .libs/fflas_L3_inst.o
In file included from ../../fflas-ffpack/fflas/fflas_sparse/csr.h:89:0,
                 from ../../fflas-ffpack/fflas/fflas_sparse.h:126,
                 from ../../fflas-ffpack/fflas/fflas.h:164,
                 from fflas_L1_inst.C:34:
../../fflas-ffpack/fflas/fflas_sparse/csr/csr_pspmm.inl:48:2: error: stray '#' in program
   PAR_BLOCK{
  ^
```




---

archive/issue_comments_232023.json:
```json
{
    "body": "I've updated the tarballs of the 3 libraries to the latests rc1 (the failing code in longer there) and updated the checksums.\nEverything builds on my box.\n----\nNew commits:",
    "created_at": "2016-02-17T13:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232023",
    "user": "cpernet"
}
```

I've updated the tarballs of the 3 libraries to the latests rc1 (the failing code in longer there) and updated the checksums.
Everything builds on my box.
----
New commits:



---

archive/issue_comments_232024.json:
```json
{
    "body": "On `powerpc64le`, I had to kill the Givaro test `test-rmint_inv_` after 11 hours. I don't think the test is supposed to take that long...",
    "created_at": "2016-02-21T08:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232024",
    "user": "jdemeyer"
}
```

On `powerpc64le`, I had to kill the Givaro test `test-rmint_inv_` after 11 hours. I don't think the test is supposed to take that long...



---

archive/issue_comments_232025.json:
```json
{
    "body": "Thanks for raising this one. Bug reported on givaro's issue tracker: [https://github.com/linbox-team/givaro/issues/6](https://github.com/linbox-team/givaro/issues/6)\n\nCurrently looking for an acces to a ppc64el to debug it.\n\nThe part of givaro that fails, recint, does small lenght multi-precision arithmetic, and very likely triggers endianness issues. Note that this part of the library is not currently used in sage neither directly nor through fflas-ffpack and linbox. However we'd like to have it fixed anyway, in order to update givaro's debian package.",
    "created_at": "2016-02-22T08:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232025",
    "user": "cpernet"
}
```

Thanks for raising this one. Bug reported on givaro's issue tracker: [https://github.com/linbox-team/givaro/issues/6](https://github.com/linbox-team/givaro/issues/6)

Currently looking for an acces to a ppc64el to debug it.

The part of givaro that fails, recint, does small lenght multi-precision arithmetic, and very likely triggers endianness issues. Note that this part of the library is not currently used in sage neither directly nor through fflas-ffpack and linbox. However we'd like to have it fixed anyway, in order to update givaro's debian package.



---

archive/issue_comments_232026.json:
```json
{
    "body": "On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)",
    "created_at": "2016-02-22T09:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232026",
    "user": "jdemeyer"
}
```

On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)



---

archive/issue_comments_232027.json:
```json
{
    "body": "Apart from the build failures on some systems, are there any further obstructions to this ticket?",
    "created_at": "2016-02-22T10:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232027",
    "user": "jdemeyer"
}
```

Apart from the build failures on some systems, are there any further obstructions to this ticket?



---

archive/issue_comments_232028.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)\nFixed in [https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925](https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925)\n\nReplying to [comment:40 jdemeyer]:\n> Apart from the build failures on some systems, are there any further obstructions to this ticket?\n\nApart from these, no obstruction on our side.",
    "created_at": "2016-02-22T11:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232028",
    "user": "cpernet"
}
```

Replying to [comment:41 jdemeyer]:
> On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)
Fixed in [https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925](https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925)

Replying to [comment:40 jdemeyer]:
> Apart from the build failures on some systems, are there any further obstructions to this ticket?

Apart from these, no obstruction on our side.



---

archive/issue_comments_232029.json:
```json
{
    "body": "Replying to [comment:43 cpernet]:\n> Apart from these, no obstruction on our side. \n\nSo why was this ticket never set to \"needs_review\" then?",
    "created_at": "2016-02-22T12:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232029",
    "user": "jdemeyer"
}
```

Replying to [comment:43 cpernet]:
> Apart from these, no obstruction on our side. 

So why was this ticket never set to "needs_review" then?



---

archive/issue_comments_232030.json:
```json
{
    "body": "Replying to [comment:43 cpernet]:\n> Replying to [comment:41 jdemeyer]:\n> > On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)\n> Fixed in [https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925](https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925)\n\nDo you plan to release fflas_ffpack-2.2.0rc2 for this? Or should we just use git master?",
    "created_at": "2016-02-22T12:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232030",
    "user": "jdemeyer"
}
```

Replying to [comment:43 cpernet]:
> Replying to [comment:41 jdemeyer]:
> > On the same machine, `fflas-ffpack` also fails: [https://github.com/linbox-team/fflas-ffpack/issues/16](https://github.com/linbox-team/fflas-ffpack/issues/16)
> Fixed in [https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925](https://github.com/linbox-team/fflas-ffpack/commit/8634b80bd0c20c538faf9471c8e2289c5a50a925)

Do you plan to release fflas_ffpack-2.2.0rc2 for this? Or should we just use git master?



---

archive/issue_comments_232031.json:
```json
{
    "body": "- the bug of Givaro on powerpc64le has been fixed upstream : [https://github.com/linbox-team/givaro/issues/6](https://github.com/linbox-team/givaro/issues/6)\n- yes I will cut a rc2 for both givaro and fflas-ffpack, if not a release.\n- I did not put the need_review as there was still a hanging question about the blas.pc file and gmp.pc. I assume we will do without these files for the moment.",
    "created_at": "2016-02-22T13:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232031",
    "user": "cpernet"
}
```

- the bug of Givaro on powerpc64le has been fixed upstream : [https://github.com/linbox-team/givaro/issues/6](https://github.com/linbox-team/givaro/issues/6)
- yes I will cut a rc2 for both givaro and fflas-ffpack, if not a release.
- I did not put the need_review as there was still a hanging question about the blas.pc file and gmp.pc. I assume we will do without these files for the moment.



---

archive/issue_comments_232032.json:
```json
{
    "body": "Replying to [comment:46 cpernet]:\n> - I did not put the need_review as there was still a hanging question about the blas.pc file and gmp.pc.\n\nI see. However, did anything change compared to earlier versions of these packages regarding compilation? If not and it worked before, it should still work...",
    "created_at": "2016-02-23T09:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232032",
    "user": "jdemeyer"
}
```

Replying to [comment:46 cpernet]:
> - I did not put the need_review as there was still a hanging question about the blas.pc file and gmp.pc.

I see. However, did anything change compared to earlier versions of these packages regarding compilation? If not and it worked before, it should still work...



---

archive/issue_comments_232033.json:
```json
{
    "body": "As far as build and compilation is concerned, nothing changed.\nI'm checking a last few things on the linbox side (test suite fails badly on power8). Then I'd like to release this evening or tomorow and put this ticket in needs_review status.",
    "created_at": "2016-02-23T11:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232033",
    "user": "cpernet"
}
```

As far as build and compilation is concerned, nothing changed.
I'm checking a last few things on the linbox side (test suite fails badly on power8). Then I'd like to release this evening or tomorow and put this ticket in needs_review status.



---

archive/issue_comments_232034.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-25T13:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232034",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232035.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-25T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232035",
    "user": "cpernet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_232036.json:
```json
{
    "body": "Givaro, fflas-ffpack and linbox have just been released: [https://groups.google.com/forum/#!topic/linbox-devel/6dIj_HW3k38](https://groups.google.com/forum/#!topic/linbox-devel/6dIj_HW3k38)\n\nI updated the link in the ticket descriptions to the latest tarball and updated the checksums.\n\nThis ticket is now ready for review.",
    "created_at": "2016-02-25T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232036",
    "user": "cpernet"
}
```

Givaro, fflas-ffpack and linbox have just been released: [https://groups.google.com/forum/#!topic/linbox-devel/6dIj_HW3k38](https://groups.google.com/forum/#!topic/linbox-devel/6dIj_HW3k38)

I updated the link in the ticket descriptions to the latest tarball and updated the checksums.

This ticket is now ready for review.



---

archive/issue_comments_232037.json:
```json
{
    "body": "Before passing to other details for this ticket, is everyone ok with linbox having openmp enabled?",
    "created_at": "2016-02-25T20:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232037",
    "user": "fbissey"
}
```

Before passing to other details for this ticket, is everyone ok with linbox having openmp enabled?



---

archive/issue_comments_232038.json:
```json
{
    "body": "Actually both `fflas-ffpack` and `linbox`, `fflas-ffpack` has openmp enabled by default and it is stated explicitly in `linbox`. Our minmal compiler should have openmp support, I am wondering about unintended consequences. In sage-on-gentoo I am now using `openblas` with threads rather than openmp as I got into trouble with it.",
    "created_at": "2016-02-25T21:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232038",
    "user": "fbissey"
}
```

Actually both `fflas-ffpack` and `linbox`, `fflas-ffpack` has openmp enabled by default and it is stated explicitly in `linbox`. Our minmal compiler should have openmp support, I am wondering about unintended consequences. In sage-on-gentoo I am now using `openblas` with threads rather than openmp as I got into trouble with it.



---

archive/issue_comments_232039.json:
```json
{
    "body": "Eventhough openmp is enabled in `fflas-ffpack\u0300` and `linbox`, the current code called by sage does not use any OpenMP parallelism.\n\nIf you think it is necessary, I could pass the `--disable-open` argument to the configure scripts. Thanks for pointing out that linbox still forces the -fopenmp evenif --disable-omp was passed to configure. We'll fix it.\n\nRegarding the use of a threaded BLAS: it is possible to run the sequential code of `fflas-ffpack` on top of a parallel BLAS, but one will achieve much better performances by running the parallel code of `fflas-ffpack` (with OpenMP enabled) on top of a sequential BLAS. This will need further discussions when we'll want to have sage run its linear algebra kernels in parallel.",
    "created_at": "2016-02-25T22:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232039",
    "user": "cpernet"
}
```

Eventhough openmp is enabled in `fflas-ffpack̀` and `linbox`, the current code called by sage does not use any OpenMP parallelism.

If you think it is necessary, I could pass the `--disable-open` argument to the configure scripts. Thanks for pointing out that linbox still forces the -fopenmp evenif --disable-omp was passed to configure. We'll fix it.

Regarding the use of a threaded BLAS: it is possible to run the sequential code of `fflas-ffpack` on top of a parallel BLAS, but one will achieve much better performances by running the parallel code of `fflas-ffpack` (with OpenMP enabled) on top of a sequential BLAS. This will need further discussions when we'll want to have sage run its linear algebra kernels in parallel.



---

archive/issue_comments_232040.json:
```json
{
    "body": "Replying to [comment:55 cpernet]:\n> Eventhough openmp is enabled in `fflas-ffpack\u0300` and `linbox`, the current code called by sage does not use any OpenMP parallelism.\n> \n\nYes\n\n> If you think it is necessary, I could pass the `--disable-open` argument to the configure scripts. \n\nAt this stage I think that's an unknown that will only be determined by experience.\n\n>Thanks for pointing out that linbox still forces the -fopenmp evenif --disable-omp was passed to configure. We'll fix it.\n> \n\nI haven't looked at `linbox`' `configure.ac` yet so I don't know about that. I only noticed that it for `fflas-ffpack` it is the default if you don't pass anything.\n\n\n> Regarding the use of a threaded BLAS: it is possible to run the sequential code of `fflas-ffpack` on top of a parallel BLAS, but one will achieve much better performances by running the parallel code of `fflas-ffpack` (with OpenMP enabled) on top of a sequential BLAS. This will need further discussions when we'll want to have sage run its linear algebra kernels in parallel.\n\n\nSure.",
    "created_at": "2016-02-25T22:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232040",
    "user": "fbissey"
}
```

Replying to [comment:55 cpernet]:
> Eventhough openmp is enabled in `fflas-ffpack̀` and `linbox`, the current code called by sage does not use any OpenMP parallelism.
> 

Yes

> If you think it is necessary, I could pass the `--disable-open` argument to the configure scripts. 

At this stage I think that's an unknown that will only be determined by experience.

>Thanks for pointing out that linbox still forces the -fopenmp evenif --disable-omp was passed to configure. We'll fix it.
> 

I haven't looked at `linbox`' `configure.ac` yet so I don't know about that. I only noticed that it for `fflas-ffpack` it is the default if you don't pass anything.


> Regarding the use of a threaded BLAS: it is possible to run the sequential code of `fflas-ffpack` on top of a parallel BLAS, but one will achieve much better performances by running the parallel code of `fflas-ffpack` (with OpenMP enabled) on top of a sequential BLAS. This will need further discussions when we'll want to have sage run its linear algebra kernels in parallel.


Sure.



---

archive/issue_comments_232041.json:
```json
{
    "body": "I had a concern that there may be linking issue on cygwin because of libgomp. But `-fopenmp` should be in the `CFLAGS` provided by `fflas-ffpack.pc`. So long as those flags are passed to the linker I guess we should be ok.\n\n`@`jpflori can you comment on the linking needs on cygwin?",
    "created_at": "2016-02-26T03:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232041",
    "user": "fbissey"
}
```

I had a concern that there may be linking issue on cygwin because of libgomp. But `-fopenmp` should be in the `CFLAGS` provided by `fflas-ffpack.pc`. So long as those flags are passed to the linker I guess we should be ok.

`@`jpflori can you comment on the linking needs on cygwin?



---

archive/issue_comments_232042.json:
```json
{
    "body": "OK, more thoughts about `fflas-ffpack`. By default usage of `sse4.1`, `avx`, `avx2` and `fma` instructions are enabled if found. This is a problem when building a binary for redistribution as we cannot guarantee that the target machine will support any instructions found on the building machine. We need to be able to disable those for binary build (`SAGE_FAT_BINARY=yes`?). \n\nGoing through `linbox` now. Like `fflas-ffpack`, `openmp` is enabled by default even without `--enable-openmp` in `spkg-install` but it looks like it can be disable the standard way to me. `linbox` looks for \n\n```\nLB_CHECK_IML\nLB_CHECK_M4RI\nLB_CHECK_M4RIE\nLB_CHECK_MPFR\n# we nedd mpfr next :\nLB_CHECK_FPLLL\nLB_CHECK_FLINT\n\nLB_CHECK_NTL\n```\n\nbut none of these are in `linbox`'s dependencies. Are any of those actually used?\nActually the current version should depend on `ntl` and `iml`\n\n```\n(sage-sh) fbissey@QCD-nzi3:sage-7.0$ ldd -r local/lib/liblinboxsage.so.0.0.0 \n\tlinux-vdso.so.1 (0x00007ffcaf131000)\n\tlibgmpxx.so.8 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmpxx.so.8 (0x00007f3f89ea8000)\n\tlibgmp.so.16 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmp.so.16 (0x00007f3f89c31000)\n\tlibntl.so.19 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libntl.so.19 (0x00007f3f89810000)\n\tlibcblas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libcblas.so.3 (0x00007f3f895ed000)\n\tlibatlas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libatlas.so.3 (0x00007f3f88d01000)\n\tliblinbox.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/liblinbox.so.0 (0x00007f3f88afa000)\n\tlibgivaro.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgivaro.so.0 (0x00007f3f8889d000)\n\tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f3f88557000)\n\tlibm.so.6 => /lib64/libm.so.6 (0x00007f3f88253000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007f3f87eb8000)\n\tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f3f87ca0000)\n\tlibgf2x.so.1 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgf2x.so.1 (0x00007f3f87a8a000)\n\tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f3f8786d000)\n\t/lib64/ld-linux-x86-64.so.2 (0x0000561bc940b000)\nundefined symbol: maxMagnMP\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: findRNS\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: RNSbound\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: certSolveMP\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: certSolveRedMP\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: nonsingSolvLlhsMM\t(local/lib/liblinboxsage.so.0.0.0)\nundefined symbol: nonsingSolvRNSMM\t(local/lib/liblinboxsage.so.0.0.0)\n```\n\ncompared to sage-on-gentoo on the same machine\n\n```\nldd -r /usr/lib64/liblinboxsage.so.0.0.0\n\tlinux-vdso.so.1 (0x00007ffe013bb000)\n\tlibgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f8a84d7a000)\n\tlibgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f8a84b09000)\n\tlibntl-9.6.2.so => /usr/lib64/libntl-9.6.2.so (0x00007f8a846e5000)\n\tlibreflapack.so => /usr/lib64/libreflapack.so (0x00007f8a83f03000)\n\tlibopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007f8a8396b000)\n\tliblinbox.so.0 => /usr/lib64/liblinbox.so.0 (0x00007f8a83763000)\n\tlibgivaro.so.0 => /usr/lib64/libgivaro.so.0 (0x00007f8a83507000)\n\tlibiml.so.0 => /usr/lib64/libiml.so.0 (0x00007f8a832e6000)\n\tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f8a82fd6000)\n\tlibm.so.6 => /lib64/libm.so.6 (0x00007f8a82cd2000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007f8a82937000)\n\tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f8a8271f000)\n\tlibgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007f8a82509000)\n\tlibgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgfortran.so.3 (0x00007f8a821e0000)\n\tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8a81fc4000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00005557ec4cf000)\n\tlibquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libquadmath.so.0 (0x00007f8a81d85000)\n```\n\nWhere I had to add `LIBS=\"-liml\"` for things to be completely resolved.",
    "created_at": "2016-02-26T09:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232042",
    "user": "fbissey"
}
```

OK, more thoughts about `fflas-ffpack`. By default usage of `sse4.1`, `avx`, `avx2` and `fma` instructions are enabled if found. This is a problem when building a binary for redistribution as we cannot guarantee that the target machine will support any instructions found on the building machine. We need to be able to disable those for binary build (`SAGE_FAT_BINARY=yes`?). 

Going through `linbox` now. Like `fflas-ffpack`, `openmp` is enabled by default even without `--enable-openmp` in `spkg-install` but it looks like it can be disable the standard way to me. `linbox` looks for 

```
LB_CHECK_IML
LB_CHECK_M4RI
LB_CHECK_M4RIE
LB_CHECK_MPFR
# we nedd mpfr next :
LB_CHECK_FPLLL
LB_CHECK_FLINT

LB_CHECK_NTL
```

but none of these are in `linbox`'s dependencies. Are any of those actually used?
Actually the current version should depend on `ntl` and `iml`

```
(sage-sh) fbissey@QCD-nzi3:sage-7.0$ ldd -r local/lib/liblinboxsage.so.0.0.0 
	linux-vdso.so.1 (0x00007ffcaf131000)
	libgmpxx.so.8 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmpxx.so.8 (0x00007f3f89ea8000)
	libgmp.so.16 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmp.so.16 (0x00007f3f89c31000)
	libntl.so.19 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libntl.so.19 (0x00007f3f89810000)
	libcblas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libcblas.so.3 (0x00007f3f895ed000)
	libatlas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libatlas.so.3 (0x00007f3f88d01000)
	liblinbox.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/liblinbox.so.0 (0x00007f3f88afa000)
	libgivaro.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgivaro.so.0 (0x00007f3f8889d000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f3f88557000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f3f88253000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f3f87eb8000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f3f87ca0000)
	libgf2x.so.1 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgf2x.so.1 (0x00007f3f87a8a000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f3f8786d000)
	/lib64/ld-linux-x86-64.so.2 (0x0000561bc940b000)
undefined symbol: maxMagnMP	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: findRNS	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: RNSbound	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: certSolveMP	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: certSolveRedMP	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: nonsingSolvLlhsMM	(local/lib/liblinboxsage.so.0.0.0)
undefined symbol: nonsingSolvRNSMM	(local/lib/liblinboxsage.so.0.0.0)
```

compared to sage-on-gentoo on the same machine

```
ldd -r /usr/lib64/liblinboxsage.so.0.0.0
	linux-vdso.so.1 (0x00007ffe013bb000)
	libgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f8a84d7a000)
	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f8a84b09000)
	libntl-9.6.2.so => /usr/lib64/libntl-9.6.2.so (0x00007f8a846e5000)
	libreflapack.so => /usr/lib64/libreflapack.so (0x00007f8a83f03000)
	libopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007f8a8396b000)
	liblinbox.so.0 => /usr/lib64/liblinbox.so.0 (0x00007f8a83763000)
	libgivaro.so.0 => /usr/lib64/libgivaro.so.0 (0x00007f8a83507000)
	libiml.so.0 => /usr/lib64/libiml.so.0 (0x00007f8a832e6000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f8a82fd6000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f8a82cd2000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f8a82937000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f8a8271f000)
	libgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007f8a82509000)
	libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgfortran.so.3 (0x00007f8a821e0000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8a81fc4000)
	/lib64/ld-linux-x86-64.so.2 (0x00005557ec4cf000)
	libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libquadmath.so.0 (0x00007f8a81d85000)
```

Where I had to add `LIBS="-liml"` for things to be completely resolved.



---

archive/issue_comments_232043.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-02-26T09:15:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232043",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232044.json:
```json
{
    "body": "Replying to [comment:58 fbissey]:\n> OK, more thoughts about `fflas-ffpack`. By default usage of `sse4.1`, `avx`, `avx2` and `fma` instructions are enabled if found. This is a problem when building a binary for redistribution as we cannot guarantee that the target machine will support any instructions found on the building machine. We need to be able to disable those for binary build (`SAGE_FAT_BINARY=yes`?). \n> \n\nSure, we could do that. The alternative option would be to do as for the openblas deb package: have it include all kernel variants and let the switch happen dynamically depending on the variant of x86 it is run on. I am not very familiar with this technique and need to investigate how this can be built.\n\n> Going through `linbox` now. Like `fflas-ffpack`, `openmp` is enabled by default even without `--enable-openmp` in `spkg-install` but it looks like it can be disable the standard way to me. \n\nYes it can, but in `linbox` it will still pass a `-fopenmp` argument to g++ even if you passed the `--disable-openmp` option at configure time. You made me find it yesterday, and this is now [https://github.com/linbox-team/linbox/issues/24](https://github.com/linbox-team/linbox/issues/24).\n\n> `linbox` looks for \n> {{{\n> LB_CHECK_IML\n> LB_CHECK_M4RI\n> LB_CHECK_M4RIE\n> LB_CHECK_MPFR\n> # we nedd mpfr next :\n> LB_CHECK_FPLLL\n> LB_CHECK_FLINT\n> \n> LB_CHECK_NTL\n> }}}\n> but none of these are in `linbox`'s dependencies. Are any of those actually used?\n\nThese are optional dependencies. The long term goal is to have linbox code that uses these libs when available. For the moment, I think they are mostly used for benchmarking comparisons, except for `NTL, IML` and `fplll` used here and there when available.\n\nPassing the `--with-all=` option to configure, as we do, will automatically enable all these optional dependencies if they are found. We could be more picky if this causes problems.\n\n> Actually the current version should depend on `ntl` and `iml`\n> {{{\n> (sage-sh) fbissey`@`QCD-nzi3:sage-7.0$ ldd -r local/lib/liblinboxsage.so.0.0.0 \n> \tlinux-vdso.so.1 (0x00007ffcaf131000)\n> \tlibgmpxx.so.8 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmpxx.so.8 (0x00007f3f89ea8000)\n> \tlibgmp.so.16 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmp.so.16 (0x00007f3f89c31000)\n> \tlibntl.so.19 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libntl.so.19 (0x00007f3f89810000)\n> \tlibcblas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libcblas.so.3 (0x00007f3f895ed000)\n> \tlibatlas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libatlas.so.3 (0x00007f3f88d01000)\n> \tliblinbox.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/liblinbox.so.0 (0x00007f3f88afa000)\n> \tlibgivaro.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgivaro.so.0 (0x00007f3f8889d000)\n> \tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f3f88557000)\n> \tlibm.so.6 => /lib64/libm.so.6 (0x00007f3f88253000)\n> \tlibc.so.6 => /lib64/libc.so.6 (0x00007f3f87eb8000)\n> \tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f3f87ca0000)\n> \tlibgf2x.so.1 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgf2x.so.1 (0x00007f3f87a8a000)\n> \tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f3f8786d000)\n> \t/lib64/ld-linux-x86-64.so.2 (0x0000561bc940b000)\n> undefined symbol: maxMagnMP\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: findRNS\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: RNSbound\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: certSolveMP\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: certSolveRedMP\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: nonsingSolvLlhsMM\t(local/lib/liblinboxsage.so.0.0.0)\n> undefined symbol: nonsingSolvRNSMM\t(local/lib/liblinboxsage.so.0.0.0)\n> }}}\n> compared to sage-on-gentoo on the same machine\n> {{{\n> ldd -r /usr/lib64/liblinboxsage.so.0.0.0\n> \tlinux-vdso.so.1 (0x00007ffe013bb000)\n> \tlibgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f8a84d7a000)\n> \tlibgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f8a84b09000)\n> \tlibntl-9.6.2.so => /usr/lib64/libntl-9.6.2.so (0x00007f8a846e5000)\n> \tlibreflapack.so => /usr/lib64/libreflapack.so (0x00007f8a83f03000)\n> \tlibopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007f8a8396b000)\n> \tliblinbox.so.0 => /usr/lib64/liblinbox.so.0 (0x00007f8a83763000)\n> \tlibgivaro.so.0 => /usr/lib64/libgivaro.so.0 (0x00007f8a83507000)\n> \tlibiml.so.0 => /usr/lib64/libiml.so.0 (0x00007f8a832e6000)\n> \tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f8a82fd6000)\n> \tlibm.so.6 => /lib64/libm.so.6 (0x00007f8a82cd2000)\n> \tlibc.so.6 => /lib64/libc.so.6 (0x00007f8a82937000)\n> \tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f8a8271f000)\n> \tlibgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007f8a82509000)\n> \tlibgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgfortran.so.3 (0x00007f8a821e0000)\n> \tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8a81fc4000)\n> \t/lib64/ld-linux-x86-64.so.2 (0x00005557ec4cf000)\n> \tlibquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libquadmath.so.0 (0x00007f8a81d85000)\n> }}}\n> Where I had to add `LIBS=\"-liml\"` for things to be completely resolved.\n\nThis seems correct: the sage-linbox interface only uses these 2 libs when found.\nAre you saying that the `-liml` option is not passed to gcc even when `iml` was detected at configure time? This would be another bug then.",
    "created_at": "2016-02-26T09:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232044",
    "user": "cpernet"
}
```

Replying to [comment:58 fbissey]:
> OK, more thoughts about `fflas-ffpack`. By default usage of `sse4.1`, `avx`, `avx2` and `fma` instructions are enabled if found. This is a problem when building a binary for redistribution as we cannot guarantee that the target machine will support any instructions found on the building machine. We need to be able to disable those for binary build (`SAGE_FAT_BINARY=yes`?). 
> 

Sure, we could do that. The alternative option would be to do as for the openblas deb package: have it include all kernel variants and let the switch happen dynamically depending on the variant of x86 it is run on. I am not very familiar with this technique and need to investigate how this can be built.

> Going through `linbox` now. Like `fflas-ffpack`, `openmp` is enabled by default even without `--enable-openmp` in `spkg-install` but it looks like it can be disable the standard way to me. 

Yes it can, but in `linbox` it will still pass a `-fopenmp` argument to g++ even if you passed the `--disable-openmp` option at configure time. You made me find it yesterday, and this is now [https://github.com/linbox-team/linbox/issues/24](https://github.com/linbox-team/linbox/issues/24).

> `linbox` looks for 
> {{{
> LB_CHECK_IML
> LB_CHECK_M4RI
> LB_CHECK_M4RIE
> LB_CHECK_MPFR
> # we nedd mpfr next :
> LB_CHECK_FPLLL
> LB_CHECK_FLINT
> 
> LB_CHECK_NTL
> }}}
> but none of these are in `linbox`'s dependencies. Are any of those actually used?

These are optional dependencies. The long term goal is to have linbox code that uses these libs when available. For the moment, I think they are mostly used for benchmarking comparisons, except for `NTL, IML` and `fplll` used here and there when available.

Passing the `--with-all=` option to configure, as we do, will automatically enable all these optional dependencies if they are found. We could be more picky if this causes problems.

> Actually the current version should depend on `ntl` and `iml`
> {{{
> (sage-sh) fbissey`@`QCD-nzi3:sage-7.0$ ldd -r local/lib/liblinboxsage.so.0.0.0 
> 	linux-vdso.so.1 (0x00007ffcaf131000)
> 	libgmpxx.so.8 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmpxx.so.8 (0x00007f3f89ea8000)
> 	libgmp.so.16 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgmp.so.16 (0x00007f3f89c31000)
> 	libntl.so.19 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libntl.so.19 (0x00007f3f89810000)
> 	libcblas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libcblas.so.3 (0x00007f3f895ed000)
> 	libatlas.so.3 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libatlas.so.3 (0x00007f3f88d01000)
> 	liblinbox.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/liblinbox.so.0 (0x00007f3f88afa000)
> 	libgivaro.so.0 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgivaro.so.0 (0x00007f3f8889d000)
> 	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f3f88557000)
> 	libm.so.6 => /lib64/libm.so.6 (0x00007f3f88253000)
> 	libc.so.6 => /lib64/libc.so.6 (0x00007f3f87eb8000)
> 	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f3f87ca0000)
> 	libgf2x.so.1 => /home/fbissey/sandbox/git-fork/sage-7.0/local/lib/libgf2x.so.1 (0x00007f3f87a8a000)
> 	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f3f8786d000)
> 	/lib64/ld-linux-x86-64.so.2 (0x0000561bc940b000)
> undefined symbol: maxMagnMP	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: findRNS	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: RNSbound	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: certSolveMP	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: certSolveRedMP	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: nonsingSolvLlhsMM	(local/lib/liblinboxsage.so.0.0.0)
> undefined symbol: nonsingSolvRNSMM	(local/lib/liblinboxsage.so.0.0.0)
> }}}
> compared to sage-on-gentoo on the same machine
> {{{
> ldd -r /usr/lib64/liblinboxsage.so.0.0.0
> 	linux-vdso.so.1 (0x00007ffe013bb000)
> 	libgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f8a84d7a000)
> 	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f8a84b09000)
> 	libntl-9.6.2.so => /usr/lib64/libntl-9.6.2.so (0x00007f8a846e5000)
> 	libreflapack.so => /usr/lib64/libreflapack.so (0x00007f8a83f03000)
> 	libopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007f8a8396b000)
> 	liblinbox.so.0 => /usr/lib64/liblinbox.so.0 (0x00007f8a83763000)
> 	libgivaro.so.0 => /usr/lib64/libgivaro.so.0 (0x00007f8a83507000)
> 	libiml.so.0 => /usr/lib64/libiml.so.0 (0x00007f8a832e6000)
> 	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libstdc++.so.6 (0x00007f8a82fd6000)
> 	libm.so.6 => /lib64/libm.so.6 (0x00007f8a82cd2000)
> 	libc.so.6 => /lib64/libc.so.6 (0x00007f8a82937000)
> 	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgcc_s.so.1 (0x00007f8a8271f000)
> 	libgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007f8a82509000)
> 	libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libgfortran.so.3 (0x00007f8a821e0000)
> 	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8a81fc4000)
> 	/lib64/ld-linux-x86-64.so.2 (0x00005557ec4cf000)
> 	libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/libquadmath.so.0 (0x00007f8a81d85000)
> }}}
> Where I had to add `LIBS="-liml"` for things to be completely resolved.

This seems correct: the sage-linbox interface only uses these 2 libs when found.
Are you saying that the `-liml` option is not passed to gcc even when `iml` was detected at configure time? This would be another bug then.



---

archive/issue_comments_232045.json:
```json
{
    "body": "Replying to [comment:60 cpernet]:\n> This seems correct: the sage-linbox interface only uses these 2 libs when found.\n> Are you saying that the `-liml` option is not passed to gcc even when `iml` was detected at configure time? This would be another bug then.\n\nYes, at least it is the case in 1.3.6, I haven't confirmed yet it is the case in 1.4.0, but if you weren't aware of it then it is probably still the case. I would rather have `ntl` and `iml` at least be in the dependencies as it makes the build reproducible. Otherwise the libraries linked to `linboxsage` will be random.",
    "created_at": "2016-02-26T09:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232045",
    "user": "fbissey"
}
```

Replying to [comment:60 cpernet]:
> This seems correct: the sage-linbox interface only uses these 2 libs when found.
> Are you saying that the `-liml` option is not passed to gcc even when `iml` was detected at configure time? This would be another bug then.

Yes, at least it is the case in 1.3.6, I haven't confirmed yet it is the case in 1.4.0, but if you weren't aware of it then it is probably still the case. I would rather have `ntl` and `iml` at least be in the dependencies as it makes the build reproducible. Otherwise the libraries linked to `linboxsage` will be random.



---

archive/issue_comments_232046.json:
```json
{
    "body": "On POWER8, I get an internal compiler error while compiling `fflas-ffpack` using GCC-4.9.3.\n\nClement, did you manage to compile `fflas-ffpack` on sardonis? Do you use the system-installed GCC 4.9.2 or did you compile within Sage?",
    "created_at": "2016-02-26T09:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232046",
    "user": "jdemeyer"
}
```

On POWER8, I get an internal compiler error while compiling `fflas-ffpack` using GCC-4.9.3.

Clement, did you manage to compile `fflas-ffpack` on sardonis? Do you use the system-installed GCC 4.9.2 or did you compile within Sage?



---

archive/issue_comments_232047.json:
```json
{
    "body": "Replying to [comment:62 jdemeyer]:\n> On POWER8, I get an internal compiler error while compiling `fflas-ffpack` using GCC-4.9.3.\n> \n> Clement, did you manage to compile `fflas-ffpack` on sardonis? Do you use the system-installed GCC 4.9.2 or did you compile within Sage?\nOutch! I did compile with the system-installed gcc v 4.9.2 and did not hit any internal compiler error.",
    "created_at": "2016-02-26T09:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232047",
    "user": "cpernet"
}
```

Replying to [comment:62 jdemeyer]:
> On POWER8, I get an internal compiler error while compiling `fflas-ffpack` using GCC-4.9.3.
> 
> Clement, did you manage to compile `fflas-ffpack` on sardonis? Do you use the system-installed GCC 4.9.2 or did you compile within Sage?
Outch! I did compile with the system-installed gcc v 4.9.2 and did not hit any internal compiler error.



---

archive/issue_comments_232048.json:
```json
{
    "body": "`linbox` again, `LB_OPT` is commented out in `configure.ac` therefore `--enable-optimization` which is still in `spkg-install` is no longer a recognised option and should be removed unless it is an error upstream.",
    "created_at": "2016-02-26T10:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232048",
    "user": "fbissey"
}
```

`linbox` again, `LB_OPT` is commented out in `configure.ac` therefore `--enable-optimization` which is still in `spkg-install` is no longer a recognised option and should be removed unless it is an error upstream.



---

archive/issue_comments_232049.json:
```json
{
    "body": "`src/sage/rings/finite_rings/element_givaro.pxd` refers to `givaro/givgfq.h`, which no longer exists.",
    "created_at": "2016-02-26T17:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232049",
    "user": "jdemeyer"
}
```

`src/sage/rings/finite_rings/element_givaro.pxd` refers to `givaro/givgfq.h`, which no longer exists.



---

archive/issue_comments_232050.json:
```json
{
    "body": "On powerpc64le with GCC 5.3.0, all 3 packages build and pass their testsuite.",
    "created_at": "2016-02-27T16:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232050",
    "user": "jdemeyer"
}
```

On powerpc64le with GCC 5.3.0, all 3 packages build and pass their testsuite.



---

archive/issue_comments_232051.json:
```json
{
    "body": "On my laptop (`Linux tamiyo 3.17.7-gentoo #1 SMP PREEMPT Wed Dec 31 20:06:39 CET 2014 x86_64 Intel(R) Core(TM) i7-2640M CPU `@` 2.80GHz GenuineIntel GNU/Linux`), fflas_ffpack fails to build with GCC 4.8.4:\n\n```\nmake[6]: Entering directory '/usr/local/src/sage-config/local/var/tmp/sage/build/fflas_ffpack-2.2.0/src/fflas-ffpack/interfaces/libs'\n/bin/bash ../../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../../..  -I../../..  -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/usr/local/src/sage-config/local/include -I/usr/local/src/sage-config/local//include -D__FFLASFFPACK_HAVE_CBLAS  -msse4.1 -mavx -fabi-version=6 -fopenmp  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC  -std=gnu++11 -c -o fflas_L1_inst.lo fflas_L1_inst.C\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/usr/local/src/sage-config/local/include -I/usr/local/src/sage-config/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L1_inst.C  -fPIC -DPIC -o .libs/fflas_L1_inst.o\nIn file included from ../../../fflas-ffpack/fflas/fflas_fger_mp.inl:40:0,\n                 from ../../../fflas-ffpack/fflas/fflas.h:126,\n                 from fflas_L1_inst.C:34:\n../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl:204:2: error: stray '#' in program\n   WAIT;\n  ^\n../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl: In function 'typename FFPACK::RNSInteger<T>::Element_ptr FFLAS::fgemm(const FFPACK::RNSInteger<T>&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, size_t, size_t, size_t, typename FFPACK::RNSInteger<T>::Element, typename FFPACK::RNSInteger<T>::ConstElement_ptr, size_t, typename FFPACK::RNSInteger<T>::ConstElement_ptr, size_t, typename FFPACK::RNSInteger<T>::Element, typename FFPACK::RNSInteger<T>::Element_ptr, size_t, FFLAS::MMHelper<FFPACK::RNSInteger<T>, FFLAS::MMHelperAlgo::Classic, FFLAS::ModeCategories::DefaultTag, FFLAS::ParSeqHelper::Parallel<Cut, Param> >&)':\n../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl:204:8: error: expected ';' before string constant\n   WAIT;\n        ^\nMakefile:576: recipe for target 'fflas_L1_inst.lo' failed\nmake[6]: *** [fflas_L1_inst.lo] Error 1\n```\n\nFull log attached.",
    "created_at": "2016-02-27T16:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232051",
    "user": "jdemeyer"
}
```

On my laptop (`Linux tamiyo 3.17.7-gentoo #1 SMP PREEMPT Wed Dec 31 20:06:39 CET 2014 x86_64 Intel(R) Core(TM) i7-2640M CPU `@` 2.80GHz GenuineIntel GNU/Linux`), fflas_ffpack fails to build with GCC 4.8.4:

```
make[6]: Entering directory '/usr/local/src/sage-config/local/var/tmp/sage/build/fflas_ffpack-2.2.0/src/fflas-ffpack/interfaces/libs'
/bin/bash ../../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../../..  -I../../..  -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/usr/local/src/sage-config/local/include -I/usr/local/src/sage-config/local//include -D__FFLASFFPACK_HAVE_CBLAS  -msse4.1 -mavx -fabi-version=6 -fopenmp  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC  -std=gnu++11 -c -o fflas_L1_inst.lo fflas_L1_inst.C
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/usr/local/src/sage-config/local/include -I/usr/local/src/sage-config/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mavx -fabi-version=6 -fopenmp -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L1_inst.C  -fPIC -DPIC -o .libs/fflas_L1_inst.o
In file included from ../../../fflas-ffpack/fflas/fflas_fger_mp.inl:40:0,
                 from ../../../fflas-ffpack/fflas/fflas.h:126,
                 from fflas_L1_inst.C:34:
../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl:204:2: error: stray '#' in program
   WAIT;
  ^
../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl: In function 'typename FFPACK::RNSInteger<T>::Element_ptr FFLAS::fgemm(const FFPACK::RNSInteger<T>&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, size_t, size_t, size_t, typename FFPACK::RNSInteger<T>::Element, typename FFPACK::RNSInteger<T>::ConstElement_ptr, size_t, typename FFPACK::RNSInteger<T>::ConstElement_ptr, size_t, typename FFPACK::RNSInteger<T>::Element, typename FFPACK::RNSInteger<T>::Element_ptr, size_t, FFLAS::MMHelper<FFPACK::RNSInteger<T>, FFLAS::MMHelperAlgo::Classic, FFLAS::ModeCategories::DefaultTag, FFLAS::ParSeqHelper::Parallel<Cut, Param> >&)':
../../../fflas-ffpack/fflas/fflas_fgemm/fgemm_classical_mp.inl:204:8: error: expected ';' before string constant
   WAIT;
        ^
Makefile:576: recipe for target 'fflas_L1_inst.lo' failed
make[6]: *** [fflas_L1_inst.lo] Error 1
```

Full log attached.



---

archive/issue_comments_232052.json:
```json
{
    "body": "fflas_ffpack build failure on x86_64 GNU/linux GCC 4.8.4",
    "created_at": "2016-02-27T16:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232052",
    "user": "jdemeyer"
}
```

fflas_ffpack build failure on x86_64 GNU/linux GCC 4.8.4



---

archive/issue_comments_232053.json:
```json
{
    "body": "Attachment [fflas_ffpack-2.2.0.log](tarball://root/attachments/some-uuid/ticket17635/fflas_ffpack-2.2.0.log) by jdemeyer created at 2016-02-29 09:39:36\n\nSome of the preprocessed code looks like\n\n```cpp\n#pragma omp task shared(F)\n {fadd(F, rowsize, N, A+iter.begin()*lda, lda, B+iter.begin()*ldb, ldb, C+iter.begin()*ldc, ldc);;};;} } };};} #pragma omp taskwait\n;;        }\n```\n\nso I guess you're missing some newlines in certain macros.",
    "created_at": "2016-02-29T09:39:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232053",
    "user": "jdemeyer"
}
```

Attachment [fflas_ffpack-2.2.0.log](tarball://root/attachments/some-uuid/ticket17635/fflas_ffpack-2.2.0.log) by jdemeyer created at 2016-02-29 09:39:36

Some of the preprocessed code looks like

```cpp
#pragma omp task shared(F)
 {fadd(F, rowsize, N, A+iter.begin()*lda, lda, B+iter.begin()*ldb, ldb, C+iter.begin()*ldc, ldc);;};;} } };};} #pragma omp taskwait
;;        }
```

so I guess you're missing some newlines in certain macros.



---

archive/issue_comments_232054.json:
```json
{
    "body": "Due to https://github.com/linbox-team/linbox/issues/24 this does not actually work...\n----\nNew commits:",
    "created_at": "2016-03-01T12:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232054",
    "user": "jdemeyer"
}
```

Due to https://github.com/linbox-team/linbox/issues/24 this does not actually work...
----
New commits:



---

archive/issue_comments_232055.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-01T12:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232055",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232056.json:
```json
{
    "body": "Note that this ticket conflicts badly with #20133.",
    "created_at": "2016-03-01T13:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232056",
    "user": "jdemeyer"
}
```

Note that this ticket conflicts badly with #20133.



---

archive/issue_comments_232057.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-01T13:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232057",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232058.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-01T13:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232058",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232059.json:
```json
{
    "body": "I got this to build properly now, but there are still a lot of doctest failures in finite field arithmetic :-(\n\nAre there any significant API changes in Givaro that we should know about?",
    "created_at": "2016-03-01T13:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232059",
    "user": "jdemeyer"
}
```

I got this to build properly now, but there are still a lot of doctest failures in finite field arithmetic :-(

Are there any significant API changes in Givaro that we should know about?



---

archive/issue_comments_232060.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-01T14:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232060",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232061.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-01T14:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232061",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232062.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-01T16:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232062",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232063.json:
```json
{
    "body": "Replying to [comment:72 jdemeyer]:\n> Note that this ticket conflicts badly with #20133.\nWill have conflicts with #20140 if I add bits to the dependencies of `linbox`. As mentioned earlier it has automagic dependencies on `iml`, `ntl` and now `fplll` (to check) so you potentially get slightly different `linbox` depending on the build order. I am uncomfortable with that.",
    "created_at": "2016-03-01T21:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232063",
    "user": "fbissey"
}
```

Replying to [comment:72 jdemeyer]:
> Note that this ticket conflicts badly with #20133.
Will have conflicts with #20140 if I add bits to the dependencies of `linbox`. As mentioned earlier it has automagic dependencies on `iml`, `ntl` and now `fplll` (to check) so you potentially get slightly different `linbox` depending on the build order. I am uncomfortable with that.



---

archive/issue_comments_232064.json:
```json
{
    "body": "I agree with your last comment.",
    "created_at": "2016-03-01T21:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232064",
    "user": "jdemeyer"
}
```

I agree with your last comment.



---

archive/issue_comments_232065.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-01T21:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232065",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232066.json:
```json
{
    "body": "I spent quite some today working on `fflas-ffpack-2.2.0` for sage-on-gentoo, expect a PR shortly to fix the tests when `fflas-ffpack` has been configured with `--enable-precompilation` (not that the test will work if you previously installed `fflas-ffpack` with `--enable-precompilation` in a standard location - do I need to say more).\n\n`lapack`, and even probably `ATLAS`' clapack interface, is detected properly but you have to pass all the libraries for `lapack` and `cblas` in the `--with-blas-libs` switch. With our new `.pc` files that should translate to\n\n```\n--with-blas-cflags=\"$(pkg-config cblas --cflags)\" --with-blas-libs=\"$(pkg-config lapack --libs)\"\n```\n\nAlthough it would probably be safer to put\n\n```\n--with-blas-cflags=\"$(pkg-config cblas --cflags)\" --with-blas-libs=\"$(pkg-config lapack  cblas blas --libs)\"\n```\n\nin case `lapack.pc` doesn't pull either or both `cblas` and `blas`.\n\n`sage` run `spkg-check` after install (a bit daft but hard to fix with the current system) so we should also be ok to add a `spkg-check` to `fflas-ffpack` without including my upcoming PR.",
    "created_at": "2016-03-02T02:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232066",
    "user": "fbissey"
}
```

I spent quite some today working on `fflas-ffpack-2.2.0` for sage-on-gentoo, expect a PR shortly to fix the tests when `fflas-ffpack` has been configured with `--enable-precompilation` (not that the test will work if you previously installed `fflas-ffpack` with `--enable-precompilation` in a standard location - do I need to say more).

`lapack`, and even probably `ATLAS`' clapack interface, is detected properly but you have to pass all the libraries for `lapack` and `cblas` in the `--with-blas-libs` switch. With our new `.pc` files that should translate to

```
--with-blas-cflags="$(pkg-config cblas --cflags)" --with-blas-libs="$(pkg-config lapack --libs)"
```

Although it would probably be safer to put

```
--with-blas-cflags="$(pkg-config cblas --cflags)" --with-blas-libs="$(pkg-config lapack  cblas blas --libs)"
```

in case `lapack.pc` doesn't pull either or both `cblas` and `blas`.

`sage` run `spkg-check` after install (a bit daft but hard to fix with the current system) so we should also be ok to add a `spkg-check` to `fflas-ffpack` without including my upcoming PR.



---

archive/issue_comments_232067.json:
```json
{
    "body": "Started on `linbox`. `iml` properly linked in this version if found. `fplll` detected but nowhere to be seen in the final library and no missing `fplll` symbols. On the other I have just been wacked by the detection of `opencl` that I wasn't expecting. No -lOpenCL` are passed to `liblinbox` or `liblinboxsage` when linking when it should be. Let's disable it explicitly for the time being.",
    "created_at": "2016-03-02T02:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232067",
    "user": "fbissey"
}
```

Started on `linbox`. `iml` properly linked in this version if found. `fplll` detected but nowhere to be seen in the final library and no missing `fplll` symbols. On the other I have just been wacked by the detection of `opencl` that I wasn't expecting. No -lOpenCL` are passed to `liblinbox` or `liblinboxsage` when linking when it should be. Let's disable it explicitly for the time being.



---

archive/issue_comments_232068.json:
```json
{
    "body": "I have sent a request for some explanations to Cl\u00e9ment for the linbox tarball, I have patched something and run autoreconf on it and the libraries I get out are completely different.",
    "created_at": "2016-03-02T20:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232068",
    "user": "fbissey"
}
```

I have sent a request for some explanations to Clément for the linbox tarball, I have patched something and run autoreconf on it and the libraries I get out are completely different.



---

archive/issue_comments_232069.json:
```json
{
    "body": "Any news here? There have been various changes in how Sage uses `pkgconfig`, should we try again to get this working?",
    "created_at": "2016-03-20T18:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232069",
    "user": "jdemeyer"
}
```

Any news here? There have been various changes in how Sage uses `pkgconfig`, should we try again to get this working?



---

archive/issue_comments_232070.json:
```json
{
    "body": "Clement told me a couple of weeks ago he was on holidays. I also send a couple of PR for `fflas-ffpack` and `linbox`. He is supposed to cut new releases. I would prefer to wait for a new cut of `linbox` at least as patching the one in the description and running `autoreconf` on it lead to unexpected results (`liblinbox` and `liblinboxsage` were linked completely differently, WTF?).",
    "created_at": "2016-03-20T20:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232070",
    "user": "fbissey"
}
```

Clement told me a couple of weeks ago he was on holidays. I also send a couple of PR for `fflas-ffpack` and `linbox`. He is supposed to cut new releases. I would prefer to wait for a new cut of `linbox` at least as patching the one in the description and running `autoreconf` on it lead to unexpected results (`liblinbox` and `liblinboxsage` were linked completely differently, WTF?).



---

archive/issue_comments_232071.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-21T10:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232071",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232072.json:
```json
{
    "body": "Note that this merge is really more than just a merge: I also started using `pkgconfig` similarly to the way how we started using it in Sage 7.1.",
    "created_at": "2016-03-21T11:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232072",
    "user": "jdemeyer"
}
```

Note that this merge is really more than just a merge: I also started using `pkgconfig` similarly to the way how we started using it in Sage 7.1.



---

archive/issue_comments_232073.json:
```json
{
    "body": "This branch builds fine and passes `make ptestlong` for me.",
    "created_at": "2016-03-21T12:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232073",
    "user": "jdemeyer"
}
```

This branch builds fine and passes `make ptestlong` for me.



---

archive/issue_comments_232074.json:
```json
{
    "body": "Hi,\nSorry for the delay. Just for the status report.\nI've produced fflas-ffpack-2.2.1rc0 and linbox-1.4.1rc0 (links available in the description of this ticket), where I tried to fix the remaining issues:\n* fixing the disable-omp problem (issue [https://github.com/linbox-team/linbox/issues/24](https://github.com/linbox-team/linbox/issues/24)) \n* the missing line break in OMP macro (but it should not be a problem here, as we disable omp) (comment 67_68)\n* removing the obsolete `--enable-optimization` of linbox (comment 64)\n \nI still did not touch the opencl issue.",
    "created_at": "2016-03-21T16:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232074",
    "user": "cpernet"
}
```

Hi,
Sorry for the delay. Just for the status report.
I've produced fflas-ffpack-2.2.1rc0 and linbox-1.4.1rc0 (links available in the description of this ticket), where I tried to fix the remaining issues:
* fixing the disable-omp problem (issue [https://github.com/linbox-team/linbox/issues/24](https://github.com/linbox-team/linbox/issues/24)) 
* the missing line break in OMP macro (but it should not be a problem here, as we disable omp) (comment 67_68)
* removing the obsolete `--enable-optimization` of linbox (comment 64)
 
I still did not touch the opencl issue.



---

archive/issue_comments_232075.json:
```json
{
    "body": "Replying to [comment:91 cpernet]:\n> links available in the description of this ticket\n\nNo, they are not.\n----\nNew commits:",
    "created_at": "2016-03-21T17:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232075",
    "user": "jdemeyer"
}
```

Replying to [comment:91 cpernet]:
> links available in the description of this ticket

No, they are not.
----
New commits:



---

archive/issue_comments_232076.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-01T12:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232076",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232077.json:
```json
{
    "body": "I updated linbox and fflas-ffpack release candidates to address the several issues on dynamic lib linkage (including francois PR).\nI took this opportunity to create a linbox.pc file and update the module_list.py accordingly.\n\nall libraries compile and pass their test suites on my side, and sage builds and passes the test suite with these new rc1's.\nI also tested the libs but not sage compilation on sardonis (power8).",
    "created_at": "2016-04-01T12:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232077",
    "user": "cpernet"
}
```

I updated linbox and fflas-ffpack release candidates to address the several issues on dynamic lib linkage (including francois PR).
I took this opportunity to create a linbox.pc file and update the module_list.py accordingly.

all libraries compile and pass their test suites on my side, and sage builds and passes the test suite with these new rc1's.
I also tested the libs but not sage compilation on sardonis (power8).



---

archive/issue_comments_232078.json:
```json
{
    "body": "OK, so I have done my inspection:\n 1) list of linbox dependency that we want to be there: ntl, fplll, flint, mpfr, iml. Those are direct build dependencies\n\n```\nreadelf -d liblinbox.so.0.0.0\n\nDynamic section at offset 0x44a80 contains 42 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libfflas.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libffpack.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libreflapack.so.3]\n 0x0000000000000001 (NEEDED)             Shared library: [libopenblas_threads.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.8]\n 0x0000000000000001 (NEEDED)             Shared library: [libgmpxx.so.4]\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libntl-9.7.0.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libfplll.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libflint.so.13]\n 0x0000000000000001 (NEEDED)             Shared library: [libmpfr.so.4]\n 0x0000000000000001 (NEEDED)             Shared library: [libiml.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libOpenCL.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x000000000000000e (SONAME)             Library soname: [liblinbox.so.0]\n```\n\nflint is not in the current list. m4ri and m4rie can be removed as they are looked for by `configure` but not used.\n 2) we want to have opencl (`--without-ocl`) to be turned off, at least for binary build.\n 3) because `sage/libs/linbox/linbox.pyx` has been given a block\n\n```\n# distutils: extra_compile_args = LINBOX_CFLAGS\n# distutils: libraries = LINBOX_LIBRARIES\n# distutils: library_dirs = LINBOX_LIBDIR\n```\n\nthe entry in `modules_list.py` doesn't need `libraries = linbox_libs`. `cblas_include_dirs` can stay as its content is somehow not included in `fflas-ffpack.pc` (but it is in `fflas-ffpack-config --cflags`). Similarly `fflas-ffpack.pc` has no information on the blas/lapack libraries - may be it should - you would inherit the correct stuff without having to add anything. Someone check this on a vanilla install please.\n 4) Do we want lapack support in `fflas-ffpack`? That would mean changing `LINBOX_BLAS=\"$(pkg-config --libs cblas)\"` to `LINBOX_BLAS=\"$(pkg-config --libs lapack cblas)\"` this has an impact on the previous item as you really need to know which libraries are used (especially if your linker is dumb). Note: you may want at least `LINBOX_BLAS=\"$(pkg-config --cflags --libs cblas)\"` in case the headers are in a funny location.",
    "created_at": "2016-04-05T22:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232078",
    "user": "fbissey"
}
```

OK, so I have done my inspection:
 1) list of linbox dependency that we want to be there: ntl, fplll, flint, mpfr, iml. Those are direct build dependencies

```
readelf -d liblinbox.so.0.0.0

Dynamic section at offset 0x44a80 contains 42 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libfflas.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libffpack.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libreflapack.so.3]
 0x0000000000000001 (NEEDED)             Shared library: [libopenblas_threads.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.8]
 0x0000000000000001 (NEEDED)             Shared library: [libgmpxx.so.4]
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libntl-9.7.0.so]
 0x0000000000000001 (NEEDED)             Shared library: [libfplll.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libflint.so.13]
 0x0000000000000001 (NEEDED)             Shared library: [libmpfr.so.4]
 0x0000000000000001 (NEEDED)             Shared library: [libiml.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libOpenCL.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x000000000000000e (SONAME)             Library soname: [liblinbox.so.0]
```

flint is not in the current list. m4ri and m4rie can be removed as they are looked for by `configure` but not used.
 2) we want to have opencl (`--without-ocl`) to be turned off, at least for binary build.
 3) because `sage/libs/linbox/linbox.pyx` has been given a block

```
# distutils: extra_compile_args = LINBOX_CFLAGS
# distutils: libraries = LINBOX_LIBRARIES
# distutils: library_dirs = LINBOX_LIBDIR
```

the entry in `modules_list.py` doesn't need `libraries = linbox_libs`. `cblas_include_dirs` can stay as its content is somehow not included in `fflas-ffpack.pc` (but it is in `fflas-ffpack-config --cflags`). Similarly `fflas-ffpack.pc` has no information on the blas/lapack libraries - may be it should - you would inherit the correct stuff without having to add anything. Someone check this on a vanilla install please.
 4) Do we want lapack support in `fflas-ffpack`? That would mean changing `LINBOX_BLAS="$(pkg-config --libs cblas)"` to `LINBOX_BLAS="$(pkg-config --libs lapack cblas)"` this has an impact on the previous item as you really need to know which libraries are used (especially if your linker is dumb). Note: you may want at least `LINBOX_BLAS="$(pkg-config --cflags --libs cblas)"` in case the headers are in a funny location.



---

archive/issue_comments_232079.json:
```json
{
    "body": "`@` Clement for future releases of `fflas-ffpack` and `linbox`. Now that you have committed to provide `.pc` files, you could insist on `pkg-config` being a building requirement. Once you do that, macros like `FF_CHECK_GIVARO` and `LB_CHECK_FFLAS_FFPACK` can die in peace and be replaced by\n\n```\nPKG_PROG_PKG_CONFIG\n\nPKG_CHECK_MODULES(...)\n```\n\nleveraging `pkg.m4` which is installed as part of [http://pkgconfig.freedesktop.org](http://pkgconfig.freedesktop.org)'s `pkg-config`. I can probably send you some PR for that in time.",
    "created_at": "2016-04-05T23:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232079",
    "user": "fbissey"
}
```

`@` Clement for future releases of `fflas-ffpack` and `linbox`. Now that you have committed to provide `.pc` files, you could insist on `pkg-config` being a building requirement. Once you do that, macros like `FF_CHECK_GIVARO` and `LB_CHECK_FFLAS_FFPACK` can die in peace and be replaced by

```
PKG_PROG_PKG_CONFIG

PKG_CHECK_MODULES(...)
```

leveraging `pkg.m4` which is installed as part of [http://pkgconfig.freedesktop.org](http://pkgconfig.freedesktop.org)'s `pkg-config`. I can probably send you some PR for that in time.



---

archive/issue_comments_232080.json:
```json
{
    "body": "Acted upon my comment in (1) and (2). Added some stuff in `fflas_ffpack`'s `spkg-install` to address my final note in section (4). I would rather have the rest of my comments be checked/discussed before they are acted upon.\n----\nNew commits:",
    "created_at": "2016-04-05T23:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232080",
    "user": "fbissey"
}
```

Acted upon my comment in (1) and (2). Added some stuff in `fflas_ffpack`'s `spkg-install` to address my final note in section (4). I would rather have the rest of my comments be checked/discussed before they are acted upon.
----
New commits:



---

archive/issue_comments_232081.json:
```json
{
    "body": "Is it just me or the `givaro` checksum is wrong?",
    "created_at": "2016-04-06T00:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232081",
    "user": "fbissey"
}
```

Is it just me or the `givaro` checksum is wrong?



---

archive/issue_comments_232082.json:
```json
{
    "body": "Somewhat tangential to this ticket, can someone explain to me why `m4rie` depends on `givaro`? I cannot find any reference to `givaro` in it, but because it is marked as depending on `givaro` it got rebuilt when I used `make`.\n\nOf course if the dependency is bogus it shouldn't.",
    "created_at": "2016-04-06T01:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232082",
    "user": "fbissey"
}
```

Somewhat tangential to this ticket, can someone explain to me why `m4rie` depends on `givaro`? I cannot find any reference to `givaro` in it, but because it is marked as depending on `givaro` it got rebuilt when I used `make`.

Of course if the dependency is bogus it shouldn't.



---

archive/issue_comments_232083.json:
```json
{
    "body": "Replying to [comment:101 fbissey]:\n> Is it just me or the `givaro` checksum is wrong?\nMy bad. I'll revert it.",
    "created_at": "2016-04-06T08:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232083",
    "user": "cpernet"
}
```

Replying to [comment:101 fbissey]:
> Is it just me or the `givaro` checksum is wrong?
My bad. I'll revert it.



---

archive/issue_comments_232084.json:
```json
{
    "body": "Replying to [comment:102 fbissey]:\n> Somewhat tangential to this ticket, can someone explain to me why `m4rie` depends on `givaro`? I cannot find any reference to `givaro` in it, but because it is marked as depending on `givaro` it got rebuilt when I used `make`.\n> \n> Of course if the dependency is bogus it shouldn't.\nIt seems bogus to me. There is no reason for m4rie to depend on givaro and a grep confirms there is no mention of givaro in m4rie. The dependency can be removed.",
    "created_at": "2016-04-06T08:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232084",
    "user": "cpernet"
}
```

Replying to [comment:102 fbissey]:
> Somewhat tangential to this ticket, can someone explain to me why `m4rie` depends on `givaro`? I cannot find any reference to `givaro` in it, but because it is marked as depending on `givaro` it got rebuilt when I used `make`.
> 
> Of course if the dependency is bogus it shouldn't.
It seems bogus to me. There is no reason for m4rie to depend on givaro and a grep confirms there is no mention of givaro in m4rie. The dependency can be removed.



---

archive/issue_comments_232085.json:
```json
{
    "body": "I'm fine with your patch on (1) and (2).\n\n(4) Regarding the use of BLAS CFLAGS. The headers of a BLAS are standard both in C and Fortran. Hence fflas-ffpack has the headers for both C and Fortran BLAS (at least for the part of it that it uses). Hence, I did not feel the need to deal with include dirs (also in the .pc file). But ok, there is no harm in adding it and it'll probably prevent some future issues.\n\n(3) Ok to remove these entries in module_list.py. \nThanks for pointing out that fflas-ffpack.pc does not mention the BLAS flags. I'll fix this.",
    "created_at": "2016-04-06T08:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232085",
    "user": "cpernet"
}
```

I'm fine with your patch on (1) and (2).

(4) Regarding the use of BLAS CFLAGS. The headers of a BLAS are standard both in C and Fortran. Hence fflas-ffpack has the headers for both C and Fortran BLAS (at least for the part of it that it uses). Hence, I did not feel the need to deal with include dirs (also in the .pc file). But ok, there is no harm in adding it and it'll probably prevent some future issues.

(3) Ok to remove these entries in module_list.py. 
Thanks for pointing out that fflas-ffpack.pc does not mention the BLAS flags. I'll fix this.



---

archive/issue_comments_232086.json:
```json
{
    "body": "Yes the API to cblas is \"standard\" that doesn't mean that the headers cannot be slightly different between implementations. You can indeed choose to include your own standard headers but if you include \"system headers\" for cblas you need to be more careful.",
    "created_at": "2016-04-06T09:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232086",
    "user": "fbissey"
}
```

Yes the API to cblas is "standard" that doesn't mean that the headers cannot be slightly different between implementations. You can indeed choose to include your own standard headers but if you include "system headers" for cblas you need to be more careful.



---

archive/issue_comments_232087.json:
```json
{
    "body": "Replying to [comment:101 fbissey]:\n> Is it just me or the `givaro` checksum is wrong?\n\nI remember it being wrong before too.\n\n`@`cpernet: are you using a different version from the officially released one or are you changing released tarballs?",
    "created_at": "2016-04-07T06:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232087",
    "user": "jdemeyer"
}
```

Replying to [comment:101 fbissey]:
> Is it just me or the `givaro` checksum is wrong?

I remember it being wrong before too.

`@`cpernet: are you using a different version from the officially released one or are you changing released tarballs?



---

archive/issue_comments_232088.json:
```json
{
    "body": "The givaro tarball is missing `./configure`. It looks like `autogen.sh` was not run...",
    "created_at": "2016-04-07T07:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232088",
    "user": "jdemeyer"
}
```

The givaro tarball is missing `./configure`. It looks like `autogen.sh` was not run...



---

archive/issue_comments_232089.json:
```json
{
    "body": "Replying to [comment:108 jdemeyer]:\n> The givaro tarball is missing `./configure`. It looks like `autogen.sh` was not run...\n\nIndeed, I just realized that Github release tool (simply based on a tag) does not work nicely with autotools and make dist targets generating the configure file.\nI added the proper tar.gz generated by make dist as a binary and will fix the link on this ticket.",
    "created_at": "2016-04-07T08:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232089",
    "user": "cpernet"
}
```

Replying to [comment:108 jdemeyer]:
> The givaro tarball is missing `./configure`. It looks like `autogen.sh` was not run...

Indeed, I just realized that Github release tool (simply based on a tag) does not work nicely with autotools and make dist targets generating the configure file.
I added the proper tar.gz generated by make dist as a binary and will fix the link on this ticket.



---

archive/issue_comments_232090.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-07T08:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232090",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232091.json:
```json
{
    "body": "Replying to [comment:107 jdemeyer]:\n> I remember it being wrong before too.\n> \n> `@`cpernet: are you using a different version from the officially released one or are you changing released tarballs?\n\nNo, it's just that my scripts accidentally ran a make dist on givaro, a few commits ahead of v4.0.1, and moved the tarball to sage and had the checksums updated.",
    "created_at": "2016-04-07T08:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232091",
    "user": "cpernet"
}
```

Replying to [comment:107 jdemeyer]:
> I remember it being wrong before too.
> 
> `@`cpernet: are you using a different version from the officially released one or are you changing released tarballs?

No, it's just that my scripts accidentally ran a make dist on givaro, a few commits ahead of v4.0.1, and moved the tarball to sage and had the checksums updated.



---

archive/issue_comments_232092.json:
```json
{
    "body": "\n```\nFound local metadata for fflas_ffpack-2.2.1rc1\nInvalid checksum for cached file /usr/local/src/sage-git/upstream/fflas_ffpack-2.2.1rc1.tar.bz2, deleting\nAttempting to download package fflas_ffpack-2.2.1rc1.tar.bz2 from mirrors\nhttp://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/fflas_ffpack/fflas_ffpack-2.2.1rc1.tar.bz2\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [download|run:133]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/fflas_ffpack/fflas_ffpack-2.2.1rc1.tar.bz2'\n```\n",
    "created_at": "2016-04-07T09:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232092",
    "user": "jdemeyer"
}
```


```
Found local metadata for fflas_ffpack-2.2.1rc1
Invalid checksum for cached file /usr/local/src/sage-git/upstream/fflas_ffpack-2.2.1rc1.tar.bz2, deleting
Attempting to download package fflas_ffpack-2.2.1rc1.tar.bz2 from mirrors
http://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/fflas_ffpack/fflas_ffpack-2.2.1rc1.tar.bz2
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [download|run:133]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/fflas_ffpack/fflas_ffpack-2.2.1rc1.tar.bz2'
```




---

archive/issue_comments_232093.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-07T14:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232093",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232094.json:
```json
{
    "body": "`@`jdemeyer: sorry for this mess. I updated the packages to new rc's and updated the checksums accordingly.\n\nThis update includes a fix to fbissey's remark (3) (fflas-ffpack now exposes BLAS flags).\nI'll wait for a next release to complete the move to pkgconfig, (i.e. detecting givaro, fflas-ffpack only from their pc files, and requiring pkgconfig as a dependency).\n\nThis ticket is ready again on my side. \nI switch to needs_review.\nOnce a reviewer confirms it works, please don't positive review too soon as it depends on the rc's for the moment. I'll need to release linbox and fflas-ffpack, and update de checksums and pkg_version before being able to close it.\n----\nNew commits:",
    "created_at": "2016-04-07T14:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232094",
    "user": "cpernet"
}
```

`@`jdemeyer: sorry for this mess. I updated the packages to new rc's and updated the checksums accordingly.

This update includes a fix to fbissey's remark (3) (fflas-ffpack now exposes BLAS flags).
I'll wait for a next release to complete the move to pkgconfig, (i.e. detecting givaro, fflas-ffpack only from their pc files, and requiring pkgconfig as a dependency).

This ticket is ready again on my side. 
I switch to needs_review.
Once a reviewer confirms it works, please don't positive review too soon as it depends on the rc's for the moment. I'll need to release linbox and fflas-ffpack, and update de checksums and pkg_version before being able to close it.
----
New commits:



---

archive/issue_comments_232095.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-07T14:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232095",
    "user": "cpernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232096.json:
```json
{
    "body": "Changing keywords from \"\" to \"days77\".",
    "created_at": "2016-04-07T17:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232096",
    "user": "jdemeyer"
}
```

Changing keywords from "" to "days77".



---

archive/issue_comments_232097.json:
```json
{
    "body": "Changing keywords from \"days77\" to \"\".",
    "created_at": "2016-04-07T17:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232097",
    "user": "embray"
}
```

Changing keywords from "days77" to "".



---

archive/issue_comments_232098.json:
```json
{
    "body": "~~I'm still getting the same download error as jdemeyer.~~ Nevermind he explained it to me.",
    "created_at": "2016-04-07T17:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232098",
    "user": "embray"
}
```

~~I'm still getting the same download error as jdemeyer.~~ Nevermind he explained it to me.



---

archive/issue_comments_232099.json:
```json
{
    "body": "Possibly of interest for this patch--I'm currently working getting sage building on Cygwin, and currently am stuck at fflas-ffpack with the following:\n\n\n```\nfflas_ffpack-1.6.0.p2\n====================================================\nSetting up build directory for fflas_ffpack-1.6.0.p2\nFinished set up\n****************************************************\nHost system:\nCYGWIN_NT-6.1 PC-pret-47 2.4.1(0.293/5/3) 2016-01-24 11:26 x86_64 Cygwin\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/lto-wrapper.exe\nTarget: x86_64-pc-cygwin\nConfigured with: /cygdrive/i/szsz/tmpp/gcc/gcc-5.3.0-3.x86_64/src/gcc-5.3.0/configure --srcdir=/cygdrive/i/szsz/tmpp/gcc/gcc-5.3.0-3.x86_64/src/gcc-5.3.0 --prefix=/usr --exec-prefix=/usr --localstatedir=/var --sysconfdir=/etc --docdir=/usr/share/doc/gcc --htmldir=/usr/share/doc/gcc/html -C --build=x86_64-pc-cygwin --host=x86_64-pc-cygwin --target=x86_64-pc-cygwin --without-libiconv-prefix --without-libintl-prefix --libexecdir=/usr/lib --enable-shared --enable-shared-libgcc --enable-static --enable-version-specific-runtime-libs --enable-bootstrap --enable-__cxa_atexit --with-dwarf2 --with-tune=generic --enable-languages=ada,c,c++,fortran,lto,objc,obj-c++ --enable-graphite --enable-threads=posix --enable-libatomic --enable-libcilkrts --enable-libgomp --enable-libitm --enable-libquadmath --enable-libquadmath-support --enable-libssp --enable-libada --enable-libgcj-sublibs --disable-java-awt --disable-symvers --with-ecj-jar=/usr/share/java/ecj.jar --with-gnu-ld --with-gnu-as --with-cloog-include=/usr/include/cloog-isl --without-libiconv-prefix --without-libintl-prefix --with-system-zlib --enable-linker-build-id --with-default-libstdcxx-abi=gcc4-compatible\nThread model: posix\ngcc version 5.3.0 (GCC)\n****************************************************\npatching file fflas-ffpack-config.in\nUsing system-wide Cygwin LAPACK BLAS.\n*************************************************\n Using --with-blas=-lblas\n*************************************************\n...\n... standard ./configure junk ...\n...\n-----------------------------------------------\nDefault path = /home/embray/src/sagemath/sage/local /usr /usr/local\n-----------------------------------------------\nchecking for GMP >= 3.1.1... found\nchecking whether GMP is 4.0 or greater... yes\nchecking whether GMP was compiled with --enable-cxx... yes\nchecking for GIVARO >= 30700 and < 30800... found\nchecking \"for BLAS (-lblas)\"... no\nchecking for C interface to BLAS with -lcblas... not working\nchecking for C interface to BLAS with -lblas... not working\nchecking for other BLAS... problem\nSorry, your BLAS are not working. Disabling.\n\n*******************************************************************************\n ERROR: BLAS not found!\n\n BLAS routines are required for this library to compile. Please\n make sure BLAS are installed and specify its location with the option\n --with-blas=<lib> when running configure (or --with-cblas... see configure --help).\n*******************************************************************************\nError configuring fflas-ffpack\n\nreal    0m23.800s\nuser    0m7.708s\nsys     0m11.372s\n************************************************************************\nError installing package fflas_ffpack-1.6.0.p2\n************************************************************************\n```\n\n\nI tested the branch in this ticket and still had this same problem.  It's a little mysterious, but I haven't deeply investigated it yet.\n\nHowever, if I go into the build directory for fflas_ffpack and manually run:\n\n\n```\n$ ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" --with-default=\"$SAGE_LOCAL\"  --with-blas=\"$(pkg-config --libs cblas)\" --enable-optimization --disable-static\n```\n\n\nSo ISTM it would suffice to remove the special section in `spkg-install` for Cygwin which I guess is no longer required (why, I don't know). That might as well be done as part of this patch.",
    "created_at": "2016-04-07T19:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232099",
    "user": "embray"
}
```

Possibly of interest for this patch--I'm currently working getting sage building on Cygwin, and currently am stuck at fflas-ffpack with the following:


```
fflas_ffpack-1.6.0.p2
====================================================
Setting up build directory for fflas_ffpack-1.6.0.p2
Finished set up
****************************************************
Host system:
CYGWIN_NT-6.1 PC-pret-47 2.4.1(0.293/5/3) 2016-01-24 11:26 x86_64 Cygwin
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/lto-wrapper.exe
Target: x86_64-pc-cygwin
Configured with: /cygdrive/i/szsz/tmpp/gcc/gcc-5.3.0-3.x86_64/src/gcc-5.3.0/configure --srcdir=/cygdrive/i/szsz/tmpp/gcc/gcc-5.3.0-3.x86_64/src/gcc-5.3.0 --prefix=/usr --exec-prefix=/usr --localstatedir=/var --sysconfdir=/etc --docdir=/usr/share/doc/gcc --htmldir=/usr/share/doc/gcc/html -C --build=x86_64-pc-cygwin --host=x86_64-pc-cygwin --target=x86_64-pc-cygwin --without-libiconv-prefix --without-libintl-prefix --libexecdir=/usr/lib --enable-shared --enable-shared-libgcc --enable-static --enable-version-specific-runtime-libs --enable-bootstrap --enable-__cxa_atexit --with-dwarf2 --with-tune=generic --enable-languages=ada,c,c++,fortran,lto,objc,obj-c++ --enable-graphite --enable-threads=posix --enable-libatomic --enable-libcilkrts --enable-libgomp --enable-libitm --enable-libquadmath --enable-libquadmath-support --enable-libssp --enable-libada --enable-libgcj-sublibs --disable-java-awt --disable-symvers --with-ecj-jar=/usr/share/java/ecj.jar --with-gnu-ld --with-gnu-as --with-cloog-include=/usr/include/cloog-isl --without-libiconv-prefix --without-libintl-prefix --with-system-zlib --enable-linker-build-id --with-default-libstdcxx-abi=gcc4-compatible
Thread model: posix
gcc version 5.3.0 (GCC)
****************************************************
patching file fflas-ffpack-config.in
Using system-wide Cygwin LAPACK BLAS.
*************************************************
 Using --with-blas=-lblas
*************************************************
...
... standard ./configure junk ...
...
-----------------------------------------------
Default path = /home/embray/src/sagemath/sage/local /usr /usr/local
-----------------------------------------------
checking for GMP >= 3.1.1... found
checking whether GMP is 4.0 or greater... yes
checking whether GMP was compiled with --enable-cxx... yes
checking for GIVARO >= 30700 and < 30800... found
checking "for BLAS (-lblas)"... no
checking for C interface to BLAS with -lcblas... not working
checking for C interface to BLAS with -lblas... not working
checking for other BLAS... problem
Sorry, your BLAS are not working. Disabling.

*******************************************************************************
 ERROR: BLAS not found!

 BLAS routines are required for this library to compile. Please
 make sure BLAS are installed and specify its location with the option
 --with-blas=<lib> when running configure (or --with-cblas... see configure --help).
*******************************************************************************
Error configuring fflas-ffpack

real    0m23.800s
user    0m7.708s
sys     0m11.372s
************************************************************************
Error installing package fflas_ffpack-1.6.0.p2
************************************************************************
```


I tested the branch in this ticket and still had this same problem.  It's a little mysterious, but I haven't deeply investigated it yet.

However, if I go into the build directory for fflas_ffpack and manually run:


```
$ ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" --with-default="$SAGE_LOCAL"  --with-blas="$(pkg-config --libs cblas)" --enable-optimization --disable-static
```


So ISTM it would suffice to remove the special section in `spkg-install` for Cygwin which I guess is no longer required (why, I don't know). That might as well be done as part of this patch.



---

archive/issue_comments_232100.json:
```json
{
    "body": "Builds and tests fine for me on Linux x86_64.",
    "created_at": "2016-04-07T20:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232100",
    "user": "jdemeyer"
}
```

Builds and tests fine for me on Linux x86_64.



---

archive/issue_comments_232101.json:
```json
{
    "body": "Although I take back the above somewhat--it seems that I built my own ATLAS while building Sage. What I mentioned about the `spkg-install` may still be relevant for using a system BLAS library but I neglected to set `SAGE_ATLAS_LIB`.  So I'll play around with that a bit more and open a separate issue if I find out more.",
    "created_at": "2016-04-07T20:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232101",
    "user": "embray"
}
```

Although I take back the above somewhat--it seems that I built my own ATLAS while building Sage. What I mentioned about the `spkg-install` may still be relevant for using a system BLAS library but I neglected to set `SAGE_ATLAS_LIB`.  So I'll play around with that a bit more and open a separate issue if I find out more.



---

archive/issue_comments_232102.json:
```json
{
    "body": "You could tweak your `.pc` files to point to the cygwin install. We do a particular case in the ATLAS spkg for darwin. We could consider doing one for cygwin. Especially if building sage's own ATLAS doesn't work on cygwin.",
    "created_at": "2016-04-07T21:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232102",
    "user": "fbissey"
}
```

You could tweak your `.pc` files to point to the cygwin install. We do a particular case in the ATLAS spkg for darwin. We could consider doing one for cygwin. Especially if building sage's own ATLAS doesn't work on cygwin.



---

archive/issue_comments_232103.json:
```json
{
    "body": "Building sage's ATLAS *does* work on Cygwin as long as I disable a couple bits that try to *force* me to use Cygwin's BLAS even if I didn't ask it to (and which doesn't work :)  I see what you mean about Darwin though--I could try to adapt the same idea to Cygwin (but really it should only be doing this if `SAGE_ATLAS_LIB` is set, no?",
    "created_at": "2016-04-08T09:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232103",
    "user": "embray"
}
```

Building sage's ATLAS *does* work on Cygwin as long as I disable a couple bits that try to *force* me to use Cygwin's BLAS even if I didn't ask it to (and which doesn't work :)  I see what you mean about Darwin though--I could try to adapt the same idea to Cygwin (but really it should only be doing this if `SAGE_ATLAS_LIB` is set, no?



---

archive/issue_comments_232104.json:
```json
{
    "body": "On an unrelated note, when I build the linbox from this ticket on Cygwin I get:\n\n\n```\n/bin/sh ../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../..  -DDISABLE_COMMENTATOR -I../../linbox -I/home/embray/src/sagemath/sage/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -DDISABLE_COMMENTATOR  -std=gnu++11  -g -fPIC -c -o linbox-sage.lo linbox-sage.C\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -DDISABLE_COMMENTATOR -I../../linbox -I/home/embray/src/sagemath/sage/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -DDISABLE_COMMENTATOR -std=gnu++11 -g -fPIC -c linbox-sage.C  -DDLL_EXPORT -DPIC -o .libs/linbox-sage.o\nlinbox-sage.C:1:0: warning: -fPIC ignored for target (all code is position independent)\n /* linbox-sage.C\n ^\nIn file included from ../../linbox/linbox-config.h:30:0,\n                 from linbox-sage.C:32:\n/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas-ffpack-config.h:42:0: warning: \"_GLIBCXX_USE_C99\" redefined\n #  define _GLIBCXX_USE_C99 true\n ^\nIn file included from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/iostream:38:0,\n                 from linbox-sage.C:27:\n/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/x86_64-pc-cygwin/bits/c++config.h:1309:0: note: this is the location of the previous definition\n #define _GLIBCXX_USE_C99 1\n ^\n/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/../../../../x86_64-pc-cygwin/bin/as: .libs/linbox-sage.o: too many sections (46123)\n/tmp/cck8OXW1.s: Assembler messages:\n/tmp/cck8OXW1.s: Fatal error: can't write .libs/linbox-sage.o: File too big\n/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/../../../../x86_64-pc-cygwin/bin/as: .libs/linbox-sage.o: too many sections (46123)\n/tmp/cck8OXW1.s: Fatal error: can't close .libs/linbox-sage.o: File too big\nMakefile:503: recipe for target 'linbox-sage.lo' failed\n```\n\n\nI was able to fix this by adding `CXXFLAGS=-Wa,-mbig-obj`",
    "created_at": "2016-04-08T09:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232104",
    "user": "embray"
}
```

On an unrelated note, when I build the linbox from this ticket on Cygwin I get:


```
/bin/sh ../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../..  -DDISABLE_COMMENTATOR -I../../linbox -I/home/embray/src/sagemath/sage/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -DDISABLE_COMMENTATOR  -std=gnu++11  -g -fPIC -c -o linbox-sage.lo linbox-sage.C
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -DDISABLE_COMMENTATOR -I../../linbox -I/home/embray/src/sagemath/sage/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include -DDISABLE_COMMENTATOR -std=gnu++11 -g -fPIC -c linbox-sage.C  -DDLL_EXPORT -DPIC -o .libs/linbox-sage.o
linbox-sage.C:1:0: warning: -fPIC ignored for target (all code is position independent)
 /* linbox-sage.C
 ^
In file included from ../../linbox/linbox-config.h:30:0,
                 from linbox-sage.C:32:
/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas-ffpack-config.h:42:0: warning: "_GLIBCXX_USE_C99" redefined
 #  define _GLIBCXX_USE_C99 true
 ^
In file included from /usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/iostream:38:0,
                 from linbox-sage.C:27:
/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/include/c++/x86_64-pc-cygwin/bits/c++config.h:1309:0: note: this is the location of the previous definition
 #define _GLIBCXX_USE_C99 1
 ^
/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/../../../../x86_64-pc-cygwin/bin/as: .libs/linbox-sage.o: too many sections (46123)
/tmp/cck8OXW1.s: Assembler messages:
/tmp/cck8OXW1.s: Fatal error: can't write .libs/linbox-sage.o: File too big
/usr/lib/gcc/x86_64-pc-cygwin/5.3.0/../../../../x86_64-pc-cygwin/bin/as: .libs/linbox-sage.o: too many sections (46123)
/tmp/cck8OXW1.s: Fatal error: can't close .libs/linbox-sage.o: File too big
Makefile:503: recipe for target 'linbox-sage.lo' failed
```


I was able to fix this by adding `CXXFLAGS=-Wa,-mbig-obj`



---

archive/issue_comments_232105.json:
```json
{
    "body": "Clement, I talked with Fran\u00e7ois personally and we agree that the ticket is ready. So if you can make the final release of those packages, please go ahead.\n\nI know it doesn't work on Cygwin properly, but that's true for the old version too, so it's not a regression.",
    "created_at": "2016-04-08T10:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232105",
    "user": "jdemeyer"
}
```

Clement, I talked with François personally and we agree that the ticket is ready. So if you can make the final release of those packages, please go ahead.

I know it doesn't work on Cygwin properly, but that's true for the old version too, so it's not a regression.



---

archive/issue_comments_232106.json:
```json
{
    "body": "Ok, I have released the libraries and updated the link in the ticket description to point to the latest tarball.",
    "created_at": "2016-04-08T18:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232106",
    "user": "cpernet"
}
```

Ok, I have released the libraries and updated the link in the ticket description to point to the latest tarball.



---

archive/issue_comments_232107.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-08T18:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232107",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232108.json:
```json
{
    "body": "Fixed a minor conflict in `module_list.py`\n----\nNew commits:",
    "created_at": "2016-04-22T10:21:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232108",
    "user": "jdemeyer"
}
```

Fixed a minor conflict in `module_list.py`
----
New commits:



---

archive/issue_comments_232109.json:
```json
{
    "body": "Hum... fell into a black hole. It has been a tough couple of weeks, let's put this in positive review and go ahead.",
    "created_at": "2016-04-22T10:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232109",
    "user": "fbissey"
}
```

Hum... fell into a black hole. It has been a tough couple of weeks, let's put this in positive review and go ahead.



---

archive/issue_comments_232110.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-22T10:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232110",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_232111.json:
```json
{
    "body": "Replying to [comment:133 fbissey]:\n> Hum... fell into a black hole. It has been a tough couple of weeks, let's put this in positive review and go ahead.\n\nThanks, I was just about to ping you guys about it, as I was waiting for someone else to positive review the ticket and did not see much action since my last push.",
    "created_at": "2016-04-22T11:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232111",
    "user": "cpernet"
}
```

Replying to [comment:133 fbissey]:
> Hum... fell into a black hole. It has been a tough couple of weeks, let's put this in positive review and go ahead.

Thanks, I was just about to ping you guys about it, as I was waiting for someone else to positive review the ticket and did not see much action since my last push.



---

archive/issue_comments_232112.json:
```json
{
    "body": "Fails to compile on OSX and Linux 32-bit:\n* http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/872/steps/compile_1/logs/stdio\n* http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu12_32s02%20%28Ubuntu%2012.04%2032%20bit%29%20incremental/builds/487/steps/compile_1/logs/stdio",
    "created_at": "2016-04-22T22:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232112",
    "user": "vbraun"
}
```

Fails to compile on OSX and Linux 32-bit:
* http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/872/steps/compile_1/logs/stdio
* http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu12_32s02%20%28Ubuntu%2012.04%2032%20bit%29%20incremental/builds/487/steps/compile_1/logs/stdio



---

archive/issue_comments_232113.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-04-22T22:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232113",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_232114.json:
```json
{
    "body": "OS X: lots of problems with gmp c++ headers in `givaro`'s test suite. `givaro` builds and installs fine just the tests fail to build.\n\n```\ng++ -DHAVE_CONFIG_H -I. -I..  -O0 -Wall -g -DNDEBUG -UGIVARO_DEBUG -UDEBUG -DSTD_RECINT_SIZE=8 -I/Users/buildslave-sage/slave/sage_git/build/local//include -I.. -I../src/kernel/system -I../src/kernel/memory -I../src/kernel/field -I../src/kernel/ring -I../src/kernel/integer -I../src/kernel -I../src/library/poly1 -I../src/kernel/bstruct -I../src/library/tools -I../src/kernel/recint  -O0 -Wall -g -DNDEBUG -UGIVARO_DEBUG -UDEBUG -DNOT_IN_PLACE -DRI_OP=addmul -DGMP_OP=mpz_addmul -DGMP_OPUI=mpz_addmul_ui -I/Users/buildslave-sage/slave/sage_git/build/local//include  -fPIC -I\"/Users/buildslave-sage/slave/sage_git/build/local/include\" -std=gnu++11 -c -o test_ruint_arith_addmul-test-ruint_arith.o `test -f 'test-ruint_arith.C' || echo './'`test-ruint_arith.C\nIn file included from ../src/kernel/recint/rudisplay.h:50:0,\n                 from ../src/kernel/recint/ruint.h:73,\n                 from ../src/kernel/recint/recint.h:45,\n                 from test-rmint_arith.C:16:\n../src/kernel/recint/ruconvert.h: In instantiation of 'mpz_class& RecInt::ruint_to_mpz(mpz_class&, const RecInt::ruint<K>&) [with long unsigned int K = 8ul; mpz_class = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>]':\ntest-rmint_arith.C:39:29:   required from here\n../src/kernel/recint/ruconvert.h:99:15: error: ambiguous overload for 'operator^=' (operand types are 'mpz_class {aka __gmp_expr<__mpz_struct [1], __mpz_struct [1]>}' and 'RecInt::limb {aka long long unsigned int}')\n             a ^= static_cast<uint64_t>(*it);\n               ^\n../src/kernel/recint/ruconvert.h:99:15: note: candidates are:\nIn file included from test-rmint_arith.C:15:0:\n/Users/buildslave-sage/slave/sage_git/build/local/include/gmpxx.h:3283:1: note: mpz_class& __gmp_expr<__mpz_struct [1], __mpz_struct [1]>::operator^=(signed char)\n __GMPZ_DEFINE_COMPOUND_OPERATOR(operator^=, __gmp_binary_xor)\n ^\n/Users/buildslave-sage/slave/sage_git/build/local/include/gmpxx.h:3283:1: note: mpz_class& __gmp_expr<__mpz_struct [1], __mpz_struct [1]>::operator^=(unsigned char)\n __GMPZ_DEFINE_COMPOUND_OPERATOR(operator^=, __gmp_binary_xor)\n ^\n```\n\nand it goes on.\n\nlinux 32bits, the cpu is modern and offers sse4.1, avx and avx2 but is 32 bits.\n\n```\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/home/buildbot/slave/sage_git/build/local/include -I/home/buildbot/slave/sage_git/build/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L2_inst.C  -fPIC -DPIC -o .libs/fflas_L2_inst.o\nIn file included from ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:44:0,\n                 from ../../../fflas-ffpack/fflas/fflas_simd.h:208,\n                 from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,\n                 from ../../../fflas-ffpack/fflas/fflas.h:99,\n                 from fflas_L1_inst.C:34:\n../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl: In static member function 'static Simd256_impl<true, true, true, 8>::vect_t Simd256_impl<true, true, true, 8>::mulhi(Simd256_impl<true, true, true, 8>::vect_t, Simd256_impl<true, true, true, 8>::vect_t)':\n../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl:246:37: error: 'int128_t' was not declared in this scope\n         return set((int128_t(ca.t[0]) * cb.t[0]) >> 64, (int128_t(ca.t[1]) * cb.t[1]) >> 64,\n                                     ^\nIn file included from ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:44:0,\n                 from ../../../fflas-ffpack/fflas/fflas_simd.h:208,\n                 from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,\n                 from ../../../fflas-ffpack/fflas/fflas.h:99,\n                 from fflas_L2_inst.C:34:\n../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl: In static member function 'static Simd256_impl<true, true, true, 8>::vect_t Simd256_impl<true, true, true, 8>::mulhi(Simd256_impl<true, true, true, 8>::vect_t, Simd256_impl<true, true, true, 8>::vect_t)':\n../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl:246:37: error: 'int128_t' was not declared in this scope\n         return set((int128_t(ca.t[0]) * cb.t[0]) >> 64, (int128_t(ca.t[1]) * cb.t[1]) >> 64,\n                                     ^\n```\n\nThere may be a wrong assumptions about type there.",
    "created_at": "2016-04-22T22:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232114",
    "user": "fbissey"
}
```

OS X: lots of problems with gmp c++ headers in `givaro`'s test suite. `givaro` builds and installs fine just the tests fail to build.

```
g++ -DHAVE_CONFIG_H -I. -I..  -O0 -Wall -g -DNDEBUG -UGIVARO_DEBUG -UDEBUG -DSTD_RECINT_SIZE=8 -I/Users/buildslave-sage/slave/sage_git/build/local//include -I.. -I../src/kernel/system -I../src/kernel/memory -I../src/kernel/field -I../src/kernel/ring -I../src/kernel/integer -I../src/kernel -I../src/library/poly1 -I../src/kernel/bstruct -I../src/library/tools -I../src/kernel/recint  -O0 -Wall -g -DNDEBUG -UGIVARO_DEBUG -UDEBUG -DNOT_IN_PLACE -DRI_OP=addmul -DGMP_OP=mpz_addmul -DGMP_OPUI=mpz_addmul_ui -I/Users/buildslave-sage/slave/sage_git/build/local//include  -fPIC -I"/Users/buildslave-sage/slave/sage_git/build/local/include" -std=gnu++11 -c -o test_ruint_arith_addmul-test-ruint_arith.o `test -f 'test-ruint_arith.C' || echo './'`test-ruint_arith.C
In file included from ../src/kernel/recint/rudisplay.h:50:0,
                 from ../src/kernel/recint/ruint.h:73,
                 from ../src/kernel/recint/recint.h:45,
                 from test-rmint_arith.C:16:
../src/kernel/recint/ruconvert.h: In instantiation of 'mpz_class& RecInt::ruint_to_mpz(mpz_class&, const RecInt::ruint<K>&) [with long unsigned int K = 8ul; mpz_class = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>]':
test-rmint_arith.C:39:29:   required from here
../src/kernel/recint/ruconvert.h:99:15: error: ambiguous overload for 'operator^=' (operand types are 'mpz_class {aka __gmp_expr<__mpz_struct [1], __mpz_struct [1]>}' and 'RecInt::limb {aka long long unsigned int}')
             a ^= static_cast<uint64_t>(*it);
               ^
../src/kernel/recint/ruconvert.h:99:15: note: candidates are:
In file included from test-rmint_arith.C:15:0:
/Users/buildslave-sage/slave/sage_git/build/local/include/gmpxx.h:3283:1: note: mpz_class& __gmp_expr<__mpz_struct [1], __mpz_struct [1]>::operator^=(signed char)
 __GMPZ_DEFINE_COMPOUND_OPERATOR(operator^=, __gmp_binary_xor)
 ^
/Users/buildslave-sage/slave/sage_git/build/local/include/gmpxx.h:3283:1: note: mpz_class& __gmp_expr<__mpz_struct [1], __mpz_struct [1]>::operator^=(unsigned char)
 __GMPZ_DEFINE_COMPOUND_OPERATOR(operator^=, __gmp_binary_xor)
 ^
```

and it goes on.

linux 32bits, the cpu is modern and offers sse4.1, avx and avx2 but is 32 bits.

```
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/home/buildbot/slave/sage_git/build/local/include -I/home/buildbot/slave/sage_git/build/local//include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -c fflas_L2_inst.C  -fPIC -DPIC -o .libs/fflas_L2_inst.o
In file included from ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:44:0,
                 from ../../../fflas-ffpack/fflas/fflas_simd.h:208,
                 from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,
                 from ../../../fflas-ffpack/fflas/fflas.h:99,
                 from fflas_L1_inst.C:34:
../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl: In static member function 'static Simd256_impl<true, true, true, 8>::vect_t Simd256_impl<true, true, true, 8>::mulhi(Simd256_impl<true, true, true, 8>::vect_t, Simd256_impl<true, true, true, 8>::vect_t)':
../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl:246:37: error: 'int128_t' was not declared in this scope
         return set((int128_t(ca.t[0]) * cb.t[0]) >> 64, (int128_t(ca.t[1]) * cb.t[1]) >> 64,
                                     ^
In file included from ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:44:0,
                 from ../../../fflas-ffpack/fflas/fflas_simd.h:208,
                 from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,
                 from ../../../fflas-ffpack/fflas/fflas.h:99,
                 from fflas_L2_inst.C:34:
../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl: In static member function 'static Simd256_impl<true, true, true, 8>::vect_t Simd256_impl<true, true, true, 8>::mulhi(Simd256_impl<true, true, true, 8>::vect_t, Simd256_impl<true, true, true, 8>::vect_t)':
../../../fflas-ffpack/fflas/fflas_simd/simd256_int64.inl:246:37: error: 'int128_t' was not declared in this scope
         return set((int128_t(ca.t[0]) * cb.t[0]) >> 64, (int128_t(ca.t[1]) * cb.t[1]) >> 64,
                                     ^
```

There may be a wrong assumptions about type there.



---

archive/issue_comments_232115.json:
```json
{
    "body": "Patch for the 32 bits AVX bug",
    "created_at": "2016-04-24T09:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232115",
    "user": "cpernet"
}
```

Patch for the 32 bits AVX bug



---

archive/issue_comments_232116.json:
```json
{
    "body": "Attachment [fflas-ffpack-simd32bits.patch](tarball://root/attachments/some-uuid/ticket17635/fflas-ffpack-simd32bits.patch) by cpernet created at 2016-04-24 09:41:14\n\nI attached a patch that should fix the 32 bit bug where AVX instructions are available.\nAs the only 32bit virtual box I can access to do not offer AVX instruction, I could not replicate the bug and confirm that the patch fixes it.\nI'm therefore waiting for Volker's confirmation before pushing it upstream.\n\nAs for the givaro OS X issue. I'll report it and look at it once we have a OSX box set up on our CI that we are currently building up.",
    "created_at": "2016-04-24T09:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232116",
    "user": "cpernet"
}
```

Attachment [fflas-ffpack-simd32bits.patch](tarball://root/attachments/some-uuid/ticket17635/fflas-ffpack-simd32bits.patch) by cpernet created at 2016-04-24 09:41:14

I attached a patch that should fix the 32 bit bug where AVX instructions are available.
As the only 32bit virtual box I can access to do not offer AVX instruction, I could not replicate the bug and confirm that the patch fixes it.
I'm therefore waiting for Volker's confirmation before pushing it upstream.

As for the givaro OS X issue. I'll report it and look at it once we have a OSX box set up on our CI that we are currently building up.



---

archive/issue_comments_232117.json:
```json
{
    "body": "Can you put the patch in the branch? We have the buildbot to test tickets, why not use it.",
    "created_at": "2016-04-24T10:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232117",
    "user": "vbraun"
}
```

Can you put the patch in the branch? We have the buildbot to test tickets, why not use it.



---

archive/issue_comments_232118.json:
```json
{
    "body": "Replying to [comment:138 vbraun]:\n> Can you put the patch in the branch? \nYou mean, adding it to build/pkg/fflas-ffpack/patches and having the spkg-install of apply the patch ? Just asking confirmation before touching it as this change will be very temporary.\n\n> We have the buildbot to test tickets, why not use it.\nI don't know how to use the buildbot for ticket related to spkg installs (i.e. how to tell buildbot where to download the tarball).",
    "created_at": "2016-04-24T11:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232118",
    "user": "cpernet"
}
```

Replying to [comment:138 vbraun]:
> Can you put the patch in the branch? 
You mean, adding it to build/pkg/fflas-ffpack/patches and having the spkg-install of apply the patch ? Just asking confirmation before touching it as this change will be very temporary.

> We have the buildbot to test tickets, why not use it.
I don't know how to use the buildbot for ticket related to spkg installs (i.e. how to tell buildbot where to download the tarball).



---

archive/issue_comments_232119.json:
```json
{
    "body": "I can run the ticket on the buildbot, but if you want me to manually patch stuff and try it then you'll probably have to wait a long time for that.",
    "created_at": "2016-04-24T11:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232119",
    "user": "vbraun"
}
```

I can run the ticket on the buildbot, but if you want me to manually patch stuff and try it then you'll probably have to wait a long time for that.



---

archive/issue_comments_232120.json:
```json
{
    "body": "I finally got around setting a new build environment on my OS X box. I first tried to build this branch without running `make check`. linbox failed to build, lots of complaints about ambiguous overload of operators \n\n```\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -DDISABLE_COMMENTATOR -I../../linbox -I/Users/fbissey/build/sage-7.2.beta5/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -DDISABLE_COMMENTATOR -std=gnu++11 -g -fPIC -c linbox-sage.C  -fno-common -DPIC -o .libs/linbox-sage.o\nIn file included from ../../linbox/ring/ntl.h:39:0,\n                 from ../../linbox/blackbox/toeplitz.h:39,\n                 from ../../linbox/solutions/trace.inl:33,\n                 from ../../linbox/solutions/trace.h:68,\n                 from ../../linbox/algorithms/whisart_trace.h:42,\n                 from ../../linbox/solutions/rank.h:45,\n                 from ../../linbox/algorithms/matrix-rank.h:36,\n                 from ../../linbox/algorithms/smith-form-adaptive.inl:43,\n                 from ../../linbox/algorithms/smith-form-adaptive.h:106,\n                 from linbox-sage.C:46:\n../../linbox/ring/ntl/ntl-zz_p.h: In function 'Target& Givaro::Caster(Target&, const Source&) [with Target = Givaro::Integer; Source = NTL::ZZ_p]':\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: error: ambiguous overload for 'operator<<' (operand types are 'Givaro::Integer' and 'ptrdiff_t {aka long int}')\n    x += Integer( txt[i] )<<(8*i) ;\n                          ^\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: candidates are:\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(int32_t {aka int}, ptrdiff_t {aka long int}) <built-in>\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(uint32_t {aka unsigned int}, ptrdiff_t {aka long int}) <built-in>\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(uint64_t {aka long long unsigned int}, ptrdiff_t {aka long int}) <built-in>\n../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(int64_t {aka long long int}, ptrdiff_t {aka long int}) <built-in>\n```\n\nand there is fair amount more after that.",
    "created_at": "2016-04-24T22:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232120",
    "user": "fbissey"
}
```

I finally got around setting a new build environment on my OS X box. I first tried to build this branch without running `make check`. linbox failed to build, lots of complaints about ambiguous overload of operators 

```
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -DDISABLE_COMMENTATOR -I../../linbox -I/Users/fbissey/build/sage-7.2.beta5/local/include -D__FFLASFFPACK_HAVE_CBLAS -msse4.1 -mfma -mavx2 -fabi-version=6 -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local//include -DFFLAS_COMPILED -DFFPACK_COMPILED -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -I/Users/fbissey/build/sage-7.2.beta5/local/include -DDISABLE_COMMENTATOR -std=gnu++11 -g -fPIC -c linbox-sage.C  -fno-common -DPIC -o .libs/linbox-sage.o
In file included from ../../linbox/ring/ntl.h:39:0,
                 from ../../linbox/blackbox/toeplitz.h:39,
                 from ../../linbox/solutions/trace.inl:33,
                 from ../../linbox/solutions/trace.h:68,
                 from ../../linbox/algorithms/whisart_trace.h:42,
                 from ../../linbox/solutions/rank.h:45,
                 from ../../linbox/algorithms/matrix-rank.h:36,
                 from ../../linbox/algorithms/smith-form-adaptive.inl:43,
                 from ../../linbox/algorithms/smith-form-adaptive.h:106,
                 from linbox-sage.C:46:
../../linbox/ring/ntl/ntl-zz_p.h: In function 'Target& Givaro::Caster(Target&, const Source&) [with Target = Givaro::Integer; Source = NTL::ZZ_p]':
../../linbox/ring/ntl/ntl-zz_p.h:84:26: error: ambiguous overload for 'operator<<' (operand types are 'Givaro::Integer' and 'ptrdiff_t {aka long int}')
    x += Integer( txt[i] )<<(8*i) ;
                          ^
../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: candidates are:
../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(int32_t {aka int}, ptrdiff_t {aka long int}) <built-in>
../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(uint32_t {aka unsigned int}, ptrdiff_t {aka long int}) <built-in>
../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(uint64_t {aka long long unsigned int}, ptrdiff_t {aka long int}) <built-in>
../../linbox/ring/ntl/ntl-zz_p.h:84:26: note: operator<<(int64_t {aka long long int}, ptrdiff_t {aka long int}) <built-in>
```

and there is fair amount more after that.



---

archive/issue_comments_232121.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-25T08:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232121",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232122.json:
```json
{
    "body": "Replying to [comment:140 vbraun]:\n> I can run the ticket on the buildbot, but if you want me to manually patch stuff and try it then you'll probably have to wait a long time for that.\nSure no problem, I just wanted to check what was the simplest way to proceed.\nI have pushed the patch in the pkg/fflas-ffpack/patches dir.",
    "created_at": "2016-04-25T08:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232122",
    "user": "cpernet"
}
```

Replying to [comment:140 vbraun]:
> I can run the ticket on the buildbot, but if you want me to manually patch stuff and try it then you'll probably have to wait a long time for that.
Sure no problem, I just wanted to check what was the simplest way to proceed.
I have pushed the patch in the pkg/fflas-ffpack/patches dir.



---

archive/issue_comments_232123.json:
```json
{
    "body": "Builds but now fails during cythonization:\n\nhttp://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu12_32s02%20%28Ubuntu%2012.04%2032%20bit%29%20incremental/builds/492/steps/compile_1/logs/stdio",
    "created_at": "2016-04-25T22:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232123",
    "user": "vbraun"
}
```

Builds but now fails during cythonization:

http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20bu12_32s02%20%28Ubuntu%2012.04%2032%20bit%29%20incremental/builds/492/steps/compile_1/logs/stdio



---

archive/issue_comments_232124.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-26T14:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232124",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232125.json:
```json
{
    "body": "typo in author name",
    "created_at": "2016-07-13T12:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232125",
    "user": "chapoton"
}
```

typo in author name



---

archive/issue_comments_232126.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2016-08-17T14:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232126",
    "user": "jpflori"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_232127.json:
```json
{
    "body": "Is this back to needs_review?",
    "created_at": "2016-08-17T14:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232127",
    "user": "jpflori"
}
```

Is this back to needs_review?



---

archive/issue_comments_232128.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-20T08:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232128",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232129.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-08-20T09:06:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232129",
    "user": "cpernet"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_232130.json:
```json
{
    "body": "The 3 libraries have been released end of july but I could not update the ticket due to some git trac config issues. This is now solved, and I switched the ticket to needs review.",
    "created_at": "2016-08-20T09:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232130",
    "user": "cpernet"
}
```

The 3 libraries have been released end of july but I could not update the ticket due to some git trac config issues. This is now solved, and I switched the ticket to needs review.



---

archive/issue_comments_232131.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-22T09:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232131",
    "user": "cpernet"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232132.json:
```json
{
    "body": "merge fails. Fix in progress",
    "created_at": "2016-08-22T09:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232132",
    "user": "cpernet"
}
```

merge fails. Fix in progress



---

archive/issue_comments_232133.json:
```json
{
    "body": "Replying to [comment:152 cpernet]:\n> merge fails. Fix in progress\n\nAh, I thought I was cc'ed to this ticket...\n\nOther issues remaining (other than rebasing / removing the C++11/14 work-arounds we meanwhile added for GCC 6.x)?",
    "created_at": "2016-08-22T15:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232133",
    "user": "leif"
}
```

Replying to [comment:152 cpernet]:
> merge fails. Fix in progress

Ah, I thought I was cc'ed to this ticket...

Other issues remaining (other than rebasing / removing the C++11/14 work-arounds we meanwhile added for GCC 6.x)?



---

archive/issue_comments_232134.json:
```json
{
    "body": "More precisely, the C++11 issue I'm having is, as I asked #21185#comment:14, to know whether with cygwin, we should still change the `--std=c++11` in `--std=gnu++11`, as was done in #21185.\nIf so, I'm suggesting to have\n\n```\nif [ \"$UNAME\" = CYGWIN ]; then\n     CXXFLAGS=\"$CXXFLAGS -std=gnu++11\"\nfi\n```\n\nin spkg-install in case we need it or add nothing.\nAny help from someone with access to and knowledge on this cygwin bug very welcome.",
    "created_at": "2016-08-22T15:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232134",
    "user": "cpernet"
}
```

More precisely, the C++11 issue I'm having is, as I asked #21185#comment:14, to know whether with cygwin, we should still change the `--std=c++11` in `--std=gnu++11`, as was done in #21185.
If so, I'm suggesting to have

```
if [ "$UNAME" = CYGWIN ]; then
     CXXFLAGS="$CXXFLAGS -std=gnu++11"
fi
```

in spkg-install in case we need it or add nothing.
Any help from someone with access to and knowledge on this cygwin bug very welcome.



---

archive/issue_comments_232135.json:
```json
{
    "body": "I can confirm, the above may be needed on Cygwin.  Cygwin's headers have some bugs with a number of `--std=c<xx>` flags.",
    "created_at": "2016-08-23T10:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232135",
    "user": "embray"
}
```

I can confirm, the above may be needed on Cygwin.  Cygwin's headers have some bugs with a number of `--std=c<xx>` flags.



---

archive/issue_comments_232136.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-23T13:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232136",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232137.json:
```json
{
    "body": "FYI, on my Cygwin32 and Cygwin64 setups, the provided tarballs use `-std=gnu++11` by default.\nThat's outside of Sage (and without NTL, IML), but I don't see why it would change when Sage builds it.",
    "created_at": "2016-08-23T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232137",
    "user": "jpflori"
}
```

FYI, on my Cygwin32 and Cygwin64 setups, the provided tarballs use `-std=gnu++11` by default.
That's outside of Sage (and without NTL, IML), but I don't see why it would change when Sage builds it.



---

archive/issue_comments_232138.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-23T13:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232138",
    "user": "cpernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232139.json:
```json
{
    "body": "I have fixed the conflicts.\nThe cygwin issue is also solved, as noted by jpflori.\nThere is no other issue remaining.",
    "created_at": "2016-08-23T13:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232139",
    "user": "cpernet"
}
```

I have fixed the conflicts.
The cygwin issue is also solved, as noted by jpflori.
There is no other issue remaining.



---

archive/issue_comments_232140.json:
```json
{
    "body": "Changing keywords from \"\" to \"linbox, givaro, fflas-ffpack, sd75\".",
    "created_at": "2016-08-23T21:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232140",
    "user": "cpernet"
}
```

Changing keywords from "" to "linbox, givaro, fflas-ffpack, sd75".



---

archive/issue_comments_232141.json:
```json
{
    "body": "There is a checksum problem:\n\n```\n[fflas_ffpack-2.2.2] Invalid checksum for cached file /home/dima/software/sage/upstream/fflas_ffpack-2.2.2.tar.bz2, deleting\n```\n",
    "created_at": "2016-08-26T08:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232141",
    "user": "dimpase"
}
```

There is a checksum problem:

```
[fflas_ffpack-2.2.2] Invalid checksum for cached file /home/dima/software/sage/upstream/fflas_ffpack-2.2.2.tar.bz2, deleting
```




---

archive/issue_comments_232142.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-26T08:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232142",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232143.json:
```json
{
    "body": "Replying to [comment:160 dimpase]:\n> There is a checksum problem:\n\nSorry, I had uploaded a wrong version on github. \nI just fixed it by updating the tarball on github. The hashes on the ticket now match.",
    "created_at": "2016-08-26T09:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232143",
    "user": "cpernet"
}
```

Replying to [comment:160 dimpase]:
> There is a checksum problem:

Sorry, I had uploaded a wrong version on github. 
I just fixed it by updating the tarball on github. The hashes on the ticket now match.



---

archive/issue_comments_232144.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-26T09:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232144",
    "user": "cpernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232145.json:
```json
{
    "body": "looks good on Linux (with gcc 4.9.3 and with gcc 6.1.1, too).",
    "created_at": "2016-08-26T14:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232145",
    "user": "dimpase"
}
```

looks good on Linux (with gcc 4.9.3 and with gcc 6.1.1, too).



---

archive/issue_comments_232146.json:
```json
{
    "body": "`sage -t --long src/sage/crypto/block_cipher/miniaes.py` gives an error with gcc 6.1.1, see attachment",
    "created_at": "2016-08-26T15:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232146",
    "user": "dimpase"
}
```

`sage -t --long src/sage/crypto/block_cipher/miniaes.py` gives an error with gcc 6.1.1, see attachment



---

archive/issue_comments_232147.json:
```json
{
    "body": "miniaes error log (gcc 6.1.1)",
    "created_at": "2016-08-26T15:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232147",
    "user": "dimpase"
}
```

miniaes error log (gcc 6.1.1)



---

archive/issue_comments_232148.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-26T15:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232148",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232149.json:
```json
{
    "body": "Attachment [giva.log](tarball://root/attachments/some-uuid/ticket17635/giva.log) by dimpase created at 2016-08-26 15:24:51",
    "created_at": "2016-08-26T15:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232149",
    "user": "dimpase"
}
```

Attachment [giva.log](tarball://root/attachments/some-uuid/ticket17635/giva.log) by dimpase created at 2016-08-26 15:24:51



---

archive/issue_comments_232150.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-26T17:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232150",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232151.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-26T17:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232151",
    "user": "cpernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232152.json:
```json
{
    "body": "This was a weird coercion bug : `ArithmeticError` was thrown but never caught while trying to coerce an element of GF(7) over GF(16).\nNot sure exactly why this bug was not triggered before.\n\nAbove commits adds a catch for this `ArithmeticError` and raises a `TypeError` which seemed to me to be the most natural way to handle it (instead of e.g. adding a catch for `ArithmeticError` in `parent.pyx:1317`).",
    "created_at": "2016-08-26T17:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232152",
    "user": "cpernet"
}
```

This was a weird coercion bug : `ArithmeticError` was thrown but never caught while trying to coerce an element of GF(7) over GF(16).
Not sure exactly why this bug was not triggered before.

Above commits adds a catch for this `ArithmeticError` and raises a `TypeError` which seemed to me to be the most natural way to handle it (instead of e.g. adding a catch for `ArithmeticError` in `parent.pyx:1317`).



---

archive/issue_comments_232153.json:
```json
{
    "body": "OK, this looks good on Linux with gcc 6.1.1 now. No errors in ptestlong any more.\n\nI'll see how it goes on OSX.",
    "created_at": "2016-08-26T21:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232153",
    "user": "dimpase"
}
```

OK, this looks good on Linux with gcc 6.1.1 now. No errors in ptestlong any more.

I'll see how it goes on OSX.



---

archive/issue_comments_232154.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-27T05:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232154",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_232155.json:
```json
{
    "body": "look good to me.",
    "created_at": "2016-08-27T05:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232155",
    "user": "dimpase"
}
```

look good to me.



---

archive/issue_comments_232156.json:
```json
{
    "body": "FWIW, `ptestlong` passes for me on x86_64 (Haswell Xeon) with GCC 6.2, despite a bunch of also not-so-harmless looking warnings, like for macro redefinitions from apparently different files...  (Haven't investigated where they really originate from, just noticed them during rebuild.)\n\nNot sure whether passing things like `-mmmx` :-) (and `-msse*` when AVX[2] is available) on a 64-bit machine is *the right thing<sup>TM</sup>*.\n\n----\n\n*Someone<sup>TM</sup>* should also fix `src/setup.py` to not pass `-lfoo -lfoo -lfoo -lfoo ...` to GCC / the linker.",
    "created_at": "2016-08-27T17:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232156",
    "user": "leif"
}
```

FWIW, `ptestlong` passes for me on x86_64 (Haswell Xeon) with GCC 6.2, despite a bunch of also not-so-harmless looking warnings, like for macro redefinitions from apparently different files...  (Haven't investigated where they really originate from, just noticed them during rebuild.)

Not sure whether passing things like `-mmmx` :-) (and `-msse*` when AVX[2] is available) on a 64-bit machine is *the right thing<sup>TM</sup>*.

----

*Someone<sup>TM</sup>* should also fix `src/setup.py` to not pass `-lfoo -lfoo -lfoo -lfoo ...` to GCC / the linker.



---

archive/issue_comments_232157.json:
```json
{
    "body": "I don't have a compiler that default to `c++11` or `gun++11` and the compilation fails for `sage/libs/singular/singular.cpp` and `sage/libs/singular/polynomial.cpp` at least\n\n```\n[151/448] creating /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular\nx86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.o -D__STDC_LIMIT_MACROS -DNDEBUG -fno-strict-aliasing\nx86_64-pc-linux-gnu-g++ -shared -Wl,-O1 -Wl,--as-needed -O1 -march=native -pipe -ggdb -O1 -march=native -pipe -ggdb /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/braiding.o -L/usr/lib -L/usr/lib64 -lbraiding -lstdc++ -lpython2.7 -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/libs/braiding.so -lpari -Ddummy\n[152/448] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/lib64/python2.7/site-packages/cysignals -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.o -DNDEBUG -fno-strict-aliasing\nIn file included from /usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/cstdint:35:0,\n                 from /usr/include/givaro/udl.h:12,\n                 from /usr/include/givaro/givrandom.h:22,\n                 from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:370:\n/usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n #error This file requires compiler and library support for the \\\n  ^\nIn file included from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:370:0:\n/usr/include/givaro/givrandom.h:68:16: error: invalid suffix \"_ui64\" on integer constant\n         return _GIVRAN_MODULO_;\n                ^\n/usr/include/givaro/givrandom.h:77:22: error: invalid suffix \"_ui64\" on integer constant\n             (int64_t)_GIVRAN_MULTIPLYER_\n                      ^\n/usr/include/givaro/givrandom.h:79:24: error: invalid suffix \"_ui64\" on integer constant\n             % (int64_t)_GIVRAN_MODULO_ );\n                        ^\n/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:371:27: fatal error: givaro/givgfq.h: No such file or directory\ncompilation terminated.\n[153/448] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/ring.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/ring.o -DNDEBUG -fno-strict-aliasing\nerror: command 'x86_64-pc-linux-gnu-g++' failed with exit status 1\nIn file included from /usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/cstdint:35:0,\n                 from /usr/include/givaro/udl.h:12,\n                 from /usr/include/givaro/givrandom.h:22,\n                 from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:372:\n/usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n #error This file requires compiler and library support for the \\\n  ^\nIn file included from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:372:0:\n/usr/include/givaro/givrandom.h:68:16: error: invalid suffix \"_ui64\" on integer constant\n         return _GIVRAN_MODULO_;\n                ^\n/usr/include/givaro/givrandom.h:77:22: error: invalid suffix \"_ui64\" on integer constant\n             (int64_t)_GIVRAN_MULTIPLYER_\n                      ^\n/usr/include/givaro/givrandom.h:79:24: error: invalid suffix \"_ui64\" on integer constant\n             % (int64_t)_GIVRAN_MODULO_ );\n                        ^\n/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:373:27: fatal error: givaro/givgfq.h: No such file or directory\ncompilation terminated.\n```\n\n`GIVARO_CFLAGS` needs to be added to the appropriate `.pxd` files I think.",
    "created_at": "2016-08-27T23:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232157",
    "user": "fbissey"
}
```

I don't have a compiler that default to `c++11` or `gun++11` and the compilation fails for `sage/libs/singular/singular.cpp` and `sage/libs/singular/polynomial.cpp` at least

```
[151/448] creating /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular
x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.o -D__STDC_LIMIT_MACROS -DNDEBUG -fno-strict-aliasing
x86_64-pc-linux-gnu-g++ -shared -Wl,-O1 -Wl,--as-needed -O1 -march=native -pipe -ggdb -O1 -march=native -pipe -ggdb /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/braiding.o -L/usr/lib -L/usr/lib64 -lbraiding -lstdc++ -lpython2.7 -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/libs/braiding.so -lpari -Ddummy
[152/448] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/lib64/python2.7/site-packages/cysignals -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.o -DNDEBUG -fno-strict-aliasing
In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/cstdint:35:0,
                 from /usr/include/givaro/udl.h:12,
                 from /usr/include/givaro/givrandom.h:22,
                 from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:370:
/usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.
 #error This file requires compiler and library support for the \
  ^
In file included from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:370:0:
/usr/include/givaro/givrandom.h:68:16: error: invalid suffix "_ui64" on integer constant
         return _GIVRAN_MODULO_;
                ^
/usr/include/givaro/givrandom.h:77:22: error: invalid suffix "_ui64" on integer constant
             (int64_t)_GIVRAN_MULTIPLYER_
                      ^
/usr/include/givaro/givrandom.h:79:24: error: invalid suffix "_ui64" on integer constant
             % (int64_t)_GIVRAN_MODULO_ );
                        ^
/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/singular.cpp:371:27: fatal error: givaro/givgfq.h: No such file or directory
compilation terminated.
[153/448] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/ring.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/ring.o -DNDEBUG -fno-strict-aliasing
error: command 'x86_64-pc-linux-gnu-g++' failed with exit status 1
In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/cstdint:35:0,
                 from /usr/include/givaro/udl.h:12,
                 from /usr/include/givaro/givrandom.h:22,
                 from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:372:
/usr/lib/gcc/x86_64-pc-linux-gnu/5.3.0/include/g++-v5/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.
 #error This file requires compiler and library support for the \
  ^
In file included from /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:372:0:
/usr/include/givaro/givrandom.h:68:16: error: invalid suffix "_ui64" on integer constant
         return _GIVRAN_MODULO_;
                ^
/usr/include/givaro/givrandom.h:77:22: error: invalid suffix "_ui64" on integer constant
             (int64_t)_GIVRAN_MULTIPLYER_
                      ^
/usr/include/givaro/givrandom.h:79:24: error: invalid suffix "_ui64" on integer constant
             % (int64_t)_GIVRAN_MODULO_ );
                        ^
/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/polynomial.cpp:373:27: fatal error: givaro/givgfq.h: No such file or directory
compilation terminated.
```

`GIVARO_CFLAGS` needs to be added to the appropriate `.pxd` files I think.



---

archive/issue_comments_232158.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-27T23:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232158",
    "user": "fbissey"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_232159.json:
```json
{
    "body": "I was about to test with Sage's GCC 4.9.3 (where it will presumably fail in the same way)...",
    "created_at": "2016-08-27T23:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232159",
    "user": "leif"
}
```

I was about to test with Sage's GCC 4.9.3 (where it will presumably fail in the same way)...



---

archive/issue_comments_232160.json:
```json
{
    "body": "I am making and trying a patch, stay tuned.",
    "created_at": "2016-08-27T23:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232160",
    "user": "fbissey"
}
```

I am making and trying a patch, stay tuned.



---

archive/issue_comments_232161.json:
```json
{
    "body": "It looks like I may have had a branch mix. Checking from scratch.",
    "created_at": "2016-08-27T23:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232161",
    "user": "fbissey"
}
```

It looks like I may have had a branch mix. Checking from scratch.



---

archive/issue_comments_232162.json:
```json
{
    "body": "Replying to [comment:171 leif]:\n> I was about to test with Sage's GCC 4.9.3 (where it will presumably fail in the same way)...\n\nHmmm, works for me, e.g. for `.../sage/libs/singular/polynomial.cpp` I have:\n\n```\n[sagelib-7.4.beta2] [ 3/12] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/lib/python2.7/site-packages/cysignals -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include/python2.7 -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/lib/python2.7/site-packages/numpy/core/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/sage/ext -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/ext -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include/python2.7 -c /data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/libs/singular/polynomial.cpp -o build/temp.linux-x86_64-2.7/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/libs/singular/polynomial.o -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local//include -fno-strict-aliasing\n```\n",
    "created_at": "2016-08-27T23:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232162",
    "user": "leif"
}
```

Replying to [comment:171 leif]:
> I was about to test with Sage's GCC 4.9.3 (where it will presumably fail in the same way)...

Hmmm, works for me, e.g. for `.../sage/libs/singular/polynomial.cpp` I have:

```
[sagelib-7.4.beta2] [ 3/12] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/lib/python2.7/site-packages/cysignals -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include/python2.7 -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/lib/python2.7/site-packages/numpy/core/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/sage/ext -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/ext -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include/python2.7 -c /data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/libs/singular/polynomial.cpp -o build/temp.linux-x86_64-2.7/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/src/build/cythonized/sage/libs/singular/polynomial.o -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local/include -I/data/Sage/build/devel/sage-7.4.beta2-gcc-4.4.3/local//include -fno-strict-aliasing
```




---

archive/issue_comments_232163.json:
```json
{
    "body": "Hard to see above, but it contains\n\n```\n-std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6\n```\n\nwhich obviously comes from Givaro.",
    "created_at": "2016-08-28T00:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232163",
    "user": "leif"
}
```

Hard to see above, but it contains

```
-std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6
```

which obviously comes from Givaro.



---

archive/issue_comments_232164.json:
```json
{
    "body": "Definitely had some branch mixed up. So I'll put it back to positive. Sorry for the false alarm.",
    "created_at": "2016-08-28T00:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232164",
    "user": "fbissey"
}
```

Definitely had some branch mixed up. So I'll put it back to positive. Sorry for the false alarm.



---

archive/issue_comments_232165.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-08-28T00:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232165",
    "user": "fbissey"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_232166.json:
```json
{
    "body": "Replying to [comment:169 leif]:\n> FWIW, `ptestlong` passes for me on x86_64 (Haswell Xeon) with GCC 6.2, despite a bunch of also not-so-harmless looking warnings, like for macro redefinitions from apparently different files...  (Haven't investigated where they really originate from, just noticed them during rebuild.)\n\nJust for the record, all (long) tests also passed with Sage's GCC 4.9.3 on the same machine (modulo the usual flaky ones which pass when rerun).",
    "created_at": "2016-08-28T01:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232166",
    "user": "leif"
}
```

Replying to [comment:169 leif]:
> FWIW, `ptestlong` passes for me on x86_64 (Haswell Xeon) with GCC 6.2, despite a bunch of also not-so-harmless looking warnings, like for macro redefinitions from apparently different files...  (Haven't investigated where they really originate from, just noticed them during rebuild.)

Just for the record, all (long) tests also passed with Sage's GCC 4.9.3 on the same machine (modulo the usual flaky ones which pass when rerun).



---

archive/issue_comments_232167.json:
```json
{
    "body": "http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2032%20bit%29%20incremental/builds/692/steps/compile_1/logs/stdio\n\n```\n[fflas_ffpack-2.2.2] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/home/buildbot/slave/sage_git/build/local//include -fPIC -I/home/buildbot/slave/sage_git/build/local/include -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -D__FFLASFFPACK_HAVE_CBLAS -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6 -c ffpack.C  -fPIC -DPIC -o .libs/ffpack.o\n[fflas_ffpack-2.2.2] In file included from ../../../fflas-ffpack/fflas/fflas_simd.h:208:0,\n[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,\n[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas.h:104,\n[fflas_ffpack-2.2.2]                  from fflas_lvl3.C:36:\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]\n[fflas_ffpack-2.2.2]   static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }\n[fflas_ffpack-2.2.2]                                                                                      ^\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]\n[fflas_ffpack-2.2.2]   static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }\n[fflas_ffpack-2.2.2]                                                                                      ^\n[fflas_ffpack-2.2.2] Makefile:585: recipe for target 'fflas_lvl3.lo' failed\n[fflas_ffpack-2.2.2] make[7]: *** [fflas_lvl3.lo] Error 1\n[fflas_ffpack-2.2.2] In file included from ../../../fflas-ffpack/fflas/fflas_simd.h:208:0,\n[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,\n[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas.h:104,\n[fflas_ffpack-2.2.2]                  from ffpack.C:37:\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]\n[fflas_ffpack-2.2.2]   static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }\n[fflas_ffpack-2.2.2]                                                                                      ^\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':\n[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]\n[fflas_ffpack-2.2.2]   static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }\n[fflas_ffpack-2.2.2]                                                                                      ^\n[fflas_ffpack-2.2.2] Makefile:585: recipe for target 'ffpack.lo' failed\n[fflas_ffpack-2.2.2] make[7]: *** [ffpack.lo] Error 1\n```\n\nThis is Debian 8 32-bit",
    "created_at": "2016-08-28T20:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232167",
    "user": "vbraun"
}
```

http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2032%20bit%29%20incremental/builds/692/steps/compile_1/logs/stdio

```
[fflas_ffpack-2.2.2] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../../.. -I../../.. -I../../../fflas-ffpack/utils/ -I../../../fflas-ffpack/fflas/ -I../../../fflas-ffpack/ffpack -I../../../fflas-ffpack/field -I/home/buildbot/slave/sage_git/build/local//include -fPIC -I/home/buildbot/slave/sage_git/build/local/include -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -D__FFLASFFPACK_HAVE_CBLAS -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -g -O2 -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6 -c ffpack.C  -fPIC -DPIC -o .libs/ffpack.o
[fflas_ffpack-2.2.2] In file included from ../../../fflas-ffpack/fflas/fflas_simd.h:208:0,
[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,
[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas.h:104,
[fflas_ffpack-2.2.2]                  from fflas_lvl3.C:36:
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]
[fflas_ffpack-2.2.2]   static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }
[fflas_ffpack-2.2.2]                                                                                      ^
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]
[fflas_ffpack-2.2.2]   static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }
[fflas_ffpack-2.2.2]                                                                                      ^
[fflas_ffpack-2.2.2] Makefile:585: recipe for target 'fflas_lvl3.lo' failed
[fflas_ffpack-2.2.2] make[7]: *** [fflas_lvl3.lo] Error 1
[fflas_ffpack-2.2.2] In file included from ../../../fflas-ffpack/fflas/fflas_simd.h:208:0,
[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas_freduce.h:33,
[fflas_ffpack-2.2.2]                  from ../../../fflas-ffpack/fflas/fflas.h:104,
[fflas_ffpack-2.2.2]                  from ffpack.C:37:
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]
[fflas_ffpack-2.2.2]   static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }
[fflas_ffpack-2.2.2]                                                                                      ^
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':
[fflas_ffpack-2.2.2] ../../../fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]
[fflas_ffpack-2.2.2]   static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }
[fflas_ffpack-2.2.2]                                                                                      ^
[fflas_ffpack-2.2.2] Makefile:585: recipe for target 'ffpack.lo' failed
[fflas_ffpack-2.2.2] make[7]: *** [ffpack.lo] Error 1
```

This is Debian 8 32-bit



---

archive/issue_comments_232168.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-28T20:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232168",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_232169.json:
```json
{
    "body": "Same on Debian 8 64-bit http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/687/steps/compile_1/logs/stdio",
    "created_at": "2016-08-28T20:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232169",
    "user": "vbraun"
}
```

Same on Debian 8 64-bit http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/687/steps/compile_1/logs/stdio



---

archive/issue_comments_232170.json:
```json
{
    "body": "Replying to [comment:179 vbraun]:\n> Same on Debian 8 64-bit http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/687/steps/compile_1/logs/stdio\n\n\n```\n[fflas_ffpack-2.2.2] ****************************************************\n[fflas_ffpack-2.2.2] C compiler: gcc\n[fflas_ffpack-2.2.2] C compiler version:\n[fflas_ffpack-2.2.2] Using built-in specs.\n[fflas_ffpack-2.2.2] COLLECT_GCC=gcc\n[fflas_ffpack-2.2.2] COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.9/lto-wrapper\n[fflas_ffpack-2.2.2] Target: x86_64-linux-gnu\n[fflas_ffpack-2.2.2] Configured with: ../src/configure -v --with-pkgversion='Debian 4.9.2-10' --with-bugurl=file:///usr/share/doc/gcc-4.9/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.9 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.9 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-vtable-verify --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.9-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.9-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.9-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --with-arch-32=i586 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\n[fflas_ffpack-2.2.2] Thread model: posix\n[fflas_ffpack-2.2.2] gcc version 4.9.2 (Debian 4.9.2-10) \n[fflas_ffpack-2.2.2] ****************************************************\n```\n\n\nIsn't that rather a Debian compiler bug?\n\n(I've successfully built with Sage's vanilla FSF GCC 4.9.3 as well as vanilla FSF GCC 6.2.0.)\n\nProbably we should add `-fpermissive` on/for Debian...",
    "created_at": "2016-08-28T20:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232170",
    "user": "leif"
}
```

Replying to [comment:179 vbraun]:
> Same on Debian 8 64-bit http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/687/steps/compile_1/logs/stdio


```
[fflas_ffpack-2.2.2] ****************************************************
[fflas_ffpack-2.2.2] C compiler: gcc
[fflas_ffpack-2.2.2] C compiler version:
[fflas_ffpack-2.2.2] Using built-in specs.
[fflas_ffpack-2.2.2] COLLECT_GCC=gcc
[fflas_ffpack-2.2.2] COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.9/lto-wrapper
[fflas_ffpack-2.2.2] Target: x86_64-linux-gnu
[fflas_ffpack-2.2.2] Configured with: ../src/configure -v --with-pkgversion='Debian 4.9.2-10' --with-bugurl=file:///usr/share/doc/gcc-4.9/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.9 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.9 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-vtable-verify --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.9-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.9-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.9-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --with-arch-32=i586 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
[fflas_ffpack-2.2.2] Thread model: posix
[fflas_ffpack-2.2.2] gcc version 4.9.2 (Debian 4.9.2-10) 
[fflas_ffpack-2.2.2] ****************************************************
```


Isn't that rather a Debian compiler bug?

(I've successfully built with Sage's vanilla FSF GCC 4.9.3 as well as vanilla FSF GCC 6.2.0.)

Probably we should add `-fpermissive` on/for Debian...



---

archive/issue_comments_232171.json:
```json
{
    "body": "In any case, someone should report that upstream Debian.",
    "created_at": "2016-08-28T20:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232171",
    "user": "leif"
}
```

In any case, someone should report that upstream Debian.



---

archive/issue_comments_232172.json:
```json
{
    "body": "we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...",
    "created_at": "2016-08-28T21:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232172",
    "user": "dimpase"
}
```

we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...



---

archive/issue_comments_232173.json:
```json
{
    "body": "Replying to [comment:182 dimpase]:\n> we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...\n\nor **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]\n\n(Not the first time they cause trouble, and sometimes they won't even fix bugs / release versions with existing bugfixes.)",
    "created_at": "2016-08-28T21:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232173",
    "user": "leif"
}
```

Replying to [comment:182 dimpase]:
> we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...

or **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]

(Not the first time they cause trouble, and sometimes they won't even fix bugs / release versions with existing bugfixes.)



---

archive/issue_comments_232174.json:
```json
{
    "body": "There is also that bit earlier that looks strange to me\n\n```\n[fflas_ffpack-2.2.2] -----------------------------------------------\n[fflas_ffpack-2.2.2] checking whether to use run time optimization... yes\n[fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  \n[fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below\n[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == \n[fflas_ffpack-2.2.2] problem\n[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<float> == \n[fflas_ffpack-2.2.2] problem\n[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<double> == \n[fflas_ffpack-2.2.2] problem\n[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<float> == \n[fflas_ffpack-2.2.2] problem\n```\n\nSomething healthy should look like\n\n```\nchecking whether to use run time optimization... yes\n  *** OPTIMIZATION ***  \nchecking best threshold for Strassen-Winograd matrix multiplication... see below\n  == Wino/BLAS threshold for Givaro::Modular<double> == \n\nfgemm 768x768: 0.0181467 s, 49.9248 Gffops\n1Wino 768x768: 0.0225657 s, 40.148 Gffops\n\nfgemm 1280x1280: 0.10682 s, 39.265 Gffops\n1Wino 1280x1280: 0.128083 s, 32.7468 Gffops\n\nfgemm 1792x1792: 0.249509 s, 46.1273 Gffops\n1Wino 1792x1792: 0.23448 s, 49.0839 Gffops\n\nfgemm 1792x1792: 0.217029 s, 53.0307 Gffops\n1Wino 1792x1792: 0.306783 s, 37.5157 Gffops\n\nfgemm 2304x2304: 0.449982 s, 54.3604 Gffops\n1Wino 2304x2304: 0.521436 s, 46.9112 Gffops\n\nfgemm 2816x2816: 0.838325 s, 53.274 Gffops\n1Wino 2816x2816: 0.846912 s, 52.7338 Gffops\n\nfgemm 3328x3328: 1.46935 s, 50.1711 Gffops\n1Wino 3328x3328: 1.49322 s, 49.3692 Gffops\n\nfgemm 3840x3840: 2.38059 s, 47.5706 Gffops\n1Wino 3840x3840: 2.16039 s, 52.4193 Gffops\n\nfgemm 3840x3840: 2.20834 s, 51.2812 Gffops\n1Wino 3840x3840: 2.12749 s, 53.2299 Gffops\n\nfgemm 3584x3584: 1.80012 s, 51.1484 Gffops\n1Wino 3584x3584: 1.82305 s, 50.5051 Gffops\n\nfgemm 3712x3712: 2.0441 s, 50.0441 Gffops\n1Wino 3712x3712: 2.02077 s, 50.6217 Gffops\n\nfgemm 3712x3712: 2.06589 s, 49.5161 Gffops\n1Wino 3712x3712: 2.00375 s, 51.0516 Gffops\ndone (3712)\n....\n```\n",
    "created_at": "2016-08-28T21:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232174",
    "user": "fbissey"
}
```

There is also that bit earlier that looks strange to me

```
[fflas_ffpack-2.2.2] -----------------------------------------------
[fflas_ffpack-2.2.2] checking whether to use run time optimization... yes
[fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  
[fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below
[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == 
[fflas_ffpack-2.2.2] problem
[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<float> == 
[fflas_ffpack-2.2.2] problem
[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<double> == 
[fflas_ffpack-2.2.2] problem
[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<float> == 
[fflas_ffpack-2.2.2] problem
```

Something healthy should look like

```
checking whether to use run time optimization... yes
  *** OPTIMIZATION ***  
checking best threshold for Strassen-Winograd matrix multiplication... see below
  == Wino/BLAS threshold for Givaro::Modular<double> == 

fgemm 768x768: 0.0181467 s, 49.9248 Gffops
1Wino 768x768: 0.0225657 s, 40.148 Gffops

fgemm 1280x1280: 0.10682 s, 39.265 Gffops
1Wino 1280x1280: 0.128083 s, 32.7468 Gffops

fgemm 1792x1792: 0.249509 s, 46.1273 Gffops
1Wino 1792x1792: 0.23448 s, 49.0839 Gffops

fgemm 1792x1792: 0.217029 s, 53.0307 Gffops
1Wino 1792x1792: 0.306783 s, 37.5157 Gffops

fgemm 2304x2304: 0.449982 s, 54.3604 Gffops
1Wino 2304x2304: 0.521436 s, 46.9112 Gffops

fgemm 2816x2816: 0.838325 s, 53.274 Gffops
1Wino 2816x2816: 0.846912 s, 52.7338 Gffops

fgemm 3328x3328: 1.46935 s, 50.1711 Gffops
1Wino 3328x3328: 1.49322 s, 49.3692 Gffops

fgemm 3840x3840: 2.38059 s, 47.5706 Gffops
1Wino 3840x3840: 2.16039 s, 52.4193 Gffops

fgemm 3840x3840: 2.20834 s, 51.2812 Gffops
1Wino 3840x3840: 2.12749 s, 53.2299 Gffops

fgemm 3584x3584: 1.80012 s, 51.1484 Gffops
1Wino 3584x3584: 1.82305 s, 50.5051 Gffops

fgemm 3712x3712: 2.0441 s, 50.0441 Gffops
1Wino 3712x3712: 2.02077 s, 50.6217 Gffops

fgemm 3712x3712: 2.06589 s, 49.5161 Gffops
1Wino 3712x3712: 2.00375 s, 51.0516 Gffops
done (3712)
....
```




---

archive/issue_comments_232175.json:
```json
{
    "body": "P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)\n\nJust pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)",
    "created_at": "2016-08-28T21:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232175",
    "user": "leif"
}
```

P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)

Just pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)



---

archive/issue_comments_232176.json:
```json
{
    "body": "Replying to [comment:185 leif]:\n> P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)\n> \n> Just pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)\n\nIndeed, with vanilla GCC 4.9.2, I'm getting the same errors for FFLAS-FFPACK.\n\nBut Debian should know that .3 and .4 are *bugfix* releases in the 4.9 series...",
    "created_at": "2016-08-28T21:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232176",
    "user": "leif"
}
```

Replying to [comment:185 leif]:
> P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)
> 
> Just pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)

Indeed, with vanilla GCC 4.9.2, I'm getting the same errors for FFLAS-FFPACK.

But Debian should know that .3 and .4 are *bugfix* releases in the 4.9 series...



---

archive/issue_comments_232177.json:
```json
{
    "body": "Replying to [comment:186 leif]:\n> Replying to [comment:185 leif]:\n> > P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)\n> > \n> > Just pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)\n> \n> Indeed, with vanilla GCC 4.9.2, I'm getting the same errors for FFLAS-FFPACK.\n> \n> But Debian should know that .3 and .4 are *bugfix* releases in the 4.9 series...\n\nIt looks avx2 related to me. Does your test machine support that?",
    "created_at": "2016-08-28T21:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232177",
    "user": "fbissey"
}
```

Replying to [comment:186 leif]:
> Replying to [comment:185 leif]:
> > P.S.:  The most recent version of Sage I had built with GCC 4.9.2 is 6.10.beta6. :-)
> > 
> > Just pulled from here and started a (re)build (probably an upgrade adventure; I so far at least had to set `LD_LIBRARY_PATH` because `sage-uncompress-spkg` was replaced by a Python script...)
> 
> Indeed, with vanilla GCC 4.9.2, I'm getting the same errors for FFLAS-FFPACK.
> 
> But Debian should know that .3 and .4 are *bugfix* releases in the 4.9 series...

It looks avx2 related to me. Does your test machine support that?



---

archive/issue_comments_232178.json:
```json
{
    "body": "Replying to [comment:183 leif]:\n> Replying to [comment:182 dimpase]:\n> > we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...\n> \n> or **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]\n\nSage with the branch on this ticket does build on Arch with gcc 6.1.1\n(that's what I have on my shiny new Thinkpad X1 Carbon (4th gen.) :-))\n\nI did't try without this branch...\n\n> \n> (Not the first time they cause trouble, and sometimes they won't even fix bugs / release versions with existing bugfixes.)",
    "created_at": "2016-08-28T21:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232178",
    "user": "dimpase"
}
```

Replying to [comment:183 leif]:
> Replying to [comment:182 dimpase]:
> > we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...
> 
> or **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]

Sage with the branch on this ticket does build on Arch with gcc 6.1.1
(that's what I have on my shiny new Thinkpad X1 Carbon (4th gen.) :-))

I did't try without this branch...

> 
> (Not the first time they cause trouble, and sometimes they won't even fix bugs / release versions with existing bugfixes.)



---

archive/issue_comments_232179.json:
```json
{
    "body": "Replying to [comment:184 fbissey]:\n> There is also that bit earlier that looks strange to me\n> {{{\n> [fflas_ffpack-2.2.2] -----------------------------------------------\n> [fflas_ffpack-2.2.2] checking whether to use run time optimization... yes\n> [fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  \n> [fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below\n> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == \n> [fflas_ffpack-2.2.2] problem\n> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<float> == \n> [fflas_ffpack-2.2.2] problem\n> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<double> == \n> [fflas_ffpack-2.2.2] problem\n> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<float> == \n> [fflas_ffpack-2.2.2] problem\n> }}}\n\n\\\\\n\nThat's the same error; in my `config.log` I have:\n\n```\n...\nconfig.status:1478: executing libtool commands\nconfigure:21501: checking whether to use run time optimization\nconfigure:21518: result: yes\nconfigure:21527: checking best threshold for Strassen-Winograd matrix multiplication\nconfigure:21529: result: see below\nconfigure:21552: g++-4.9 -o conftest -I. -I.. -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src/fflas-ffpack -g -O2 -fPIC  -std=gnu++11  -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/include -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//include     -D__FFLASFFPACK_HAVE_CBLAS  -DFLTTYPE=Givaro::Modular<double> -DOPTIMISATION_MODE  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -Wl,-rpath,/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib  conftest.cpp  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -lcblas -latlas   -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//lib -lgivaro -lgmpxx -lgmp   >&5\nIn file included from ./fflas-ffpack/fflas/fflas_simd.h:208:0,\n                 from fflas-ffpack/fflas/fflas_freduce.h:33,\n                 from fflas-ffpack/fflas/fflas.h:104,\n                 from conftest.cpp:91:\n./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]\n  static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }\n                                                                                     ^\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)\n./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]\n  static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }\n                                                                                     ^\nconfigure:21552: $? = 1\nconfigure: program exited with status 1\nconfigure: failed program was:\n...\nconfigure:21565: result: problem\nconfigure:21588: g++-4.9 -o conftest -I. -I.. -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src/fflas-ffpack -g -O2 -fPIC  -std=gnu++11  -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/include -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//include     -D__FFLASFFPACK_HAVE_CBLAS  -DFLTTYPE=Givaro::Modular<float> -DOPTIMISATION_MODE  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -Wl,-rpath,/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib  conftest.cpp  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -lcblas -latlas   -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//lib -lgivaro -lgmpxx -lgmp   >&5\nIn file included from ./fflas-ffpack/fflas/fflas_simd.h:208:0,\n                 from fflas-ffpack/fflas/fflas_freduce.h:33,\n                 from fflas-ffpack/fflas/fflas.h:104,\n                 from conftest.cpp:91:\n./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]\n  static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }\n                                                                                     ^\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)\n./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':\n./fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]\n  static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }\n                                                                                     ^\nconfigure:21588: $? = 1\nconfigure: program exited with status 1\nconfigure: failed program was:\n...\nconfigure:21601: result: problem\n...\n```\n\nand so on.",
    "created_at": "2016-08-28T21:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232179",
    "user": "leif"
}
```

Replying to [comment:184 fbissey]:
> There is also that bit earlier that looks strange to me
> {{{
> [fflas_ffpack-2.2.2] -----------------------------------------------
> [fflas_ffpack-2.2.2] checking whether to use run time optimization... yes
> [fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  
> [fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below
> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == 
> [fflas_ffpack-2.2.2] problem
> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<float> == 
> [fflas_ffpack-2.2.2] problem
> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<double> == 
> [fflas_ffpack-2.2.2] problem
> [fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::ModularBalanced<float> == 
> [fflas_ffpack-2.2.2] problem
> }}}

\\

That's the same error; in my `config.log` I have:

```
...
config.status:1478: executing libtool commands
configure:21501: checking whether to use run time optimization
configure:21518: result: yes
configure:21527: checking best threshold for Strassen-Winograd matrix multiplication
configure:21529: result: see below
configure:21552: g++-4.9 -o conftest -I. -I.. -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src/fflas-ffpack -g -O2 -fPIC  -std=gnu++11  -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/include -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//include     -D__FFLASFFPACK_HAVE_CBLAS  -DFLTTYPE=Givaro::Modular<double> -DOPTIMISATION_MODE  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -Wl,-rpath,/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib  conftest.cpp  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -lcblas -latlas   -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//lib -lgivaro -lgmpxx -lgmp   >&5
In file included from ./fflas-ffpack/fflas/fflas_simd.h:208:0,
                 from fflas-ffpack/fflas/fflas_freduce.h:33,
                 from fflas-ffpack/fflas/fflas.h:104,
                 from conftest.cpp:91:
./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':
./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]
  static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }
                                                                                     ^
./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)
./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':
./fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]
  static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }
                                                                                     ^
configure:21552: $? = 1
configure: program exited with status 1
configure: failed program was:
...
configure:21565: result: problem
configure:21588: g++-4.9 -o conftest -I. -I.. -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src -I/tmp/sage-build-tmp/fflas_ffpack-2.2.2/src/fflas-ffpack -g -O2 -fPIC  -std=gnu++11  -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -fabi-version=6  -O2  -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -fPIC -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mfpmath=sse -fabi-version=6 -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/include -I/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//include     -D__FFLASFFPACK_HAVE_CBLAS  -DFLTTYPE=Givaro::Modular<float> -DOPTIMISATION_MODE  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -Wl,-rpath,/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib  conftest.cpp  -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -lcblas -latlas   -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local/lib -L/data/Sage/release/devel/sage-6.10.beta6-gcc-4.9.2/local//lib -lgivaro -lgmpxx -lgmp   >&5
In file included from ./fflas-ffpack/fflas/fflas_simd.h:208:0,
                 from fflas-ffpack/fflas/fflas_freduce.h:33,
                 from fflas-ffpack/fflas/fflas.h:104,
                 from conftest.cpp:91:
./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::sll128(Simd256i_base::vect_t)':
./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: error: there are no arguments to '_mm256_bslli_epi128' that depend on a template parameter, so a declaration of '_mm256_bslli_epi128' must be available [-fpermissive]
  static INLINE CONST vect_t sll128(const vect_t a) { return _mm256_bslli_epi128(a, s); }
                                                                                     ^
./fflas-ffpack/fflas/fflas_simd/simd256.inl:94:85: note: (if you use '-fpermissive', G++ will accept your code, but allowing the use of an undeclared name is deprecated)
./fflas-ffpack/fflas/fflas_simd/simd256.inl: In static member function 'static Simd256i_base::vect_t Simd256i_base::srl128(Simd256i_base::vect_t)':
./fflas-ffpack/fflas/fflas_simd/simd256.inl:102:85: error: there are no arguments to '_mm256_bsrli_epi128' that depend on a template parameter, so a declaration of '_mm256_bsrli_epi128' must be available [-fpermissive]
  static INLINE CONST vect_t srl128(const vect_t a) { return _mm256_bsrli_epi128(a, s); }
                                                                                     ^
configure:21588: $? = 1
configure: program exited with status 1
configure: failed program was:
...
configure:21601: result: problem
...
```

and so on.



---

archive/issue_comments_232180.json:
```json
{
    "body": "Can you try with `--disable-avx`?",
    "created_at": "2016-08-28T21:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232180",
    "user": "fbissey"
}
```

Can you try with `--disable-avx`?



---

archive/issue_comments_232181.json:
```json
{
    "body": "Replying to [comment:188 dimpase]:\n> Replying to [comment:183 leif]:\n> > Replying to [comment:182 dimpase]:\n> > > we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...\n> > \n> > or **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]\n> \n> Sage with the branch on this ticket does build on Arch with gcc 6.1.1\n> (that's what I have on my shiny new Thinkpad X1 Carbon (4th gen.) :-))\n\nDoes it also build with `SAGE_INSTALL_GCC=yes`?  (Which is what I meant, since that happens in case we'd blacklist [also newer] distro's GCCs.)",
    "created_at": "2016-08-28T21:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232181",
    "user": "leif"
}
```

Replying to [comment:188 dimpase]:
> Replying to [comment:183 leif]:
> > Replying to [comment:182 dimpase]:
> > > we can just blacklist gcc 4.9.2 and build our 4.9.3 instead...
> > 
> > or **any** Debian and Ubuntu GCC... ;-)  [although someone just reported Sage's GCC doesn't build with some distro's 6.1.1, but that was on Arch Linux IIRC]
> 
> Sage with the branch on this ticket does build on Arch with gcc 6.1.1
> (that's what I have on my shiny new Thinkpad X1 Carbon (4th gen.) :-))

Does it also build with `SAGE_INSTALL_GCC=yes`?  (Which is what I meant, since that happens in case we'd blacklist [also newer] distro's GCCs.)



---

archive/issue_comments_232182.json:
```json
{
    "body": "Replying to [comment:190 fbissey]:\n> Can you try with `--disable-avx`?\n\nWith `-fpermissive` in `CXXFLAGS` I'm getting:\n\n```\n...\n[fflas_ffpack-2.2.2] config.status: executing libtool commands\n[fflas_ffpack-2.2.2] -----------------------------------------------\n[fflas_ffpack-2.2.2] checking whether to use run time optimization... yes\n[fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  \n[fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below\n[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == \n[fflas_ffpack-2.2.2] \n[fflas_ffpack-2.2.2] fgemm 768x768: 0.0556863 s, 16.2692 Gffops\n[fflas_ffpack-2.2.2] 1Wino 768x768: 0.0571907 s, 15.8412 Gffops\n[fflas_ffpack-2.2.2] \n[fflas_ffpack-2.2.2] fgemm 1280x1280: 0.246778 s, 16.9962 Gffops\n[fflas_ffpack-2.2.2] 1Wino 1280x1280: 0.23861 s, 17.5781 Gffops\n[fflas_ffpack-2.2.2] \n[fflas_ffpack-2.2.2] fgemm 1280x1280: 0.246413 s, 17.0214 Gffops\n[fflas_ffpack-2.2.2] 1Wino 1280x1280: 0.239146 s, 17.5387 Gffops\n[fflas_ffpack-2.2.2] \n[fflas_ffpack-2.2.2] fgemm 1024x1024: 0.127811 s, 16.802 Gffops\n[fflas_ffpack-2.2.2] 1Wino 1024x1024: 0.12628 s, 17.0057 Gffops\n[fflas_ffpack-2.2.2] \n[fflas_ffpack-2.2.2] fgemm 896x896: 0.0857503 s, 16.7771 Gffops\n[fflas_ffpack-2.2.2] 1Wino 896x896: 0.083541 s, 17.2208 Gffops\n[fflas_ffpack-2.2.2] done (896)\n...\n[fflas_ffpack-2.2.2] Successfully installed fflas_ffpack-2.2.2\n```\n",
    "created_at": "2016-08-28T22:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232182",
    "user": "leif"
}
```

Replying to [comment:190 fbissey]:
> Can you try with `--disable-avx`?

With `-fpermissive` in `CXXFLAGS` I'm getting:

```
...
[fflas_ffpack-2.2.2] config.status: executing libtool commands
[fflas_ffpack-2.2.2] -----------------------------------------------
[fflas_ffpack-2.2.2] checking whether to use run time optimization... yes
[fflas_ffpack-2.2.2]   *** OPTIMIZATION ***  
[fflas_ffpack-2.2.2] checking best threshold for Strassen-Winograd matrix multiplication... see below
[fflas_ffpack-2.2.2]   == Wino/BLAS threshold for Givaro::Modular<double> == 
[fflas_ffpack-2.2.2] 
[fflas_ffpack-2.2.2] fgemm 768x768: 0.0556863 s, 16.2692 Gffops
[fflas_ffpack-2.2.2] 1Wino 768x768: 0.0571907 s, 15.8412 Gffops
[fflas_ffpack-2.2.2] 
[fflas_ffpack-2.2.2] fgemm 1280x1280: 0.246778 s, 16.9962 Gffops
[fflas_ffpack-2.2.2] 1Wino 1280x1280: 0.23861 s, 17.5781 Gffops
[fflas_ffpack-2.2.2] 
[fflas_ffpack-2.2.2] fgemm 1280x1280: 0.246413 s, 17.0214 Gffops
[fflas_ffpack-2.2.2] 1Wino 1280x1280: 0.239146 s, 17.5387 Gffops
[fflas_ffpack-2.2.2] 
[fflas_ffpack-2.2.2] fgemm 1024x1024: 0.127811 s, 16.802 Gffops
[fflas_ffpack-2.2.2] 1Wino 1024x1024: 0.12628 s, 17.0057 Gffops
[fflas_ffpack-2.2.2] 
[fflas_ffpack-2.2.2] fgemm 896x896: 0.0857503 s, 16.7771 Gffops
[fflas_ffpack-2.2.2] 1Wino 896x896: 0.083541 s, 17.2208 Gffops
[fflas_ffpack-2.2.2] done (896)
...
[fflas_ffpack-2.2.2] Successfully installed fflas_ffpack-2.2.2
```




---

archive/issue_comments_232183.json:
```json
{
    "body": "And for what I asked?",
    "created_at": "2016-08-28T22:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232183",
    "user": "fbissey"
}
```

And for what I asked?



---

archive/issue_comments_232184.json:
```json
{
    "body": "Replying to [comment:193 fbissey]:\n> And for what I asked?\n\nThe machine supports AVX2 (and BMI/BMI2), but GCC 4.9 only supports the former.\n\nDo you want me to retry without `-fpermissive` and configuring FFLAS-FFPACK `--without-avx`?\n\n(The Sage library is still building...)",
    "created_at": "2016-08-28T22:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232184",
    "user": "leif"
}
```

Replying to [comment:193 fbissey]:
> And for what I asked?

The machine supports AVX2 (and BMI/BMI2), but GCC 4.9 only supports the former.

Do you want me to retry without `-fpermissive` and configuring FFLAS-FFPACK `--without-avx`?

(The Sage library is still building...)



---

archive/issue_comments_232185.json:
```json
{
    "body": "Did anyone (any buildbot) try with GCC 4.8 (we no longer blacklist)?",
    "created_at": "2016-08-28T22:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232185",
    "user": "leif"
}
```

Did anyone (any buildbot) try with GCC 4.8 (we no longer blacklist)?



---

archive/issue_comments_232186.json:
```json
{
    "body": "Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).\n\nAs for gcc 4.8 that's my current default on power7 but there are other issues there.",
    "created_at": "2016-08-28T22:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232186",
    "user": "fbissey"
}
```

Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).

As for gcc 4.8 that's my current default on power7 but there are other issues there.



---

archive/issue_comments_232187.json:
```json
{
    "body": "Replying to [comment:196 fbissey]:\n> Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).\n\nOk, I could push a patched branch, if no-one else does.\n\n(`Sage build/upgrade complete!`)\n\nHaven't run tests though, docbuilding in progress...\n\n\\\\\n\n> \n> As for gcc 4.8 that's my current default on power7 but there are other issues there.\n\nWell I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.",
    "created_at": "2016-08-28T22:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232187",
    "user": "leif"
}
```

Replying to [comment:196 fbissey]:
> Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).

Ok, I could push a patched branch, if no-one else does.

(`Sage build/upgrade complete!`)

Haven't run tests though, docbuilding in progress...

\\

> 
> As for gcc 4.8 that's my current default on power7 but there are other issues there.

Well I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.



---

archive/issue_comments_232188.json:
```json
{
    "body": "Replying to [comment:197 leif]:\n> Replying to [comment:196 fbissey]:\n> > As for gcc 4.8 that's my current default on power7 but there are other issues there.\n> \n> Well I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.\n\nI'm now also building on Ubuntu 14.04 x86_64, but that box doesn't have AVX, only SSE 4.1...",
    "created_at": "2016-08-28T22:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232188",
    "user": "leif"
}
```

Replying to [comment:197 leif]:
> Replying to [comment:196 fbissey]:
> > As for gcc 4.8 that's my current default on power7 but there are other issues there.
> 
> Well I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.

I'm now also building on Ubuntu 14.04 x86_64, but that box doesn't have AVX, only SSE 4.1...



---

archive/issue_comments_232189.json:
```json
{
    "body": "Replying to [comment:197 leif]:\n> Replying to [comment:196 fbissey]:\n> > Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).\n> \n> Ok, I could push a patched branch, if no-one else does.\n> \n> (`Sage build/upgrade complete!`)\n> \n> Haven't run tests though, docbuilding in progress...\n\nBesides some unrelated SageNB tests, all (long) tests passed.",
    "created_at": "2016-08-28T23:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232189",
    "user": "leif"
}
```

Replying to [comment:197 leif]:
> Replying to [comment:196 fbissey]:
> > Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).
> 
> Ok, I could push a patched branch, if no-one else does.
> 
> (`Sage build/upgrade complete!`)
> 
> Haven't run tests though, docbuilding in progress...

Besides some unrelated SageNB tests, all (long) tests passed.



---

archive/issue_comments_232190.json:
```json
{
    "body": "OK. As good as expected. For the gcc-4.8 machine I don't expect problem, even without `--permissive` if the avx theory is correct.",
    "created_at": "2016-08-28T23:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232190",
    "user": "fbissey"
}
```

OK. As good as expected. For the gcc-4.8 machine I don't expect problem, even without `--permissive` if the avx theory is correct.



---

archive/issue_comments_232191.json:
```json
{
    "body": "Replying to [comment:199 leif]:\n> Replying to [comment:197 leif]:\n> > Replying to [comment:196 fbissey]:\n> > > Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).\n> > \n> > Ok, I could push a patched branch, if no-one else does.\n> > \n> > (`Sage build/upgrade complete!`)\n> > \n> > Haven't run tests though, docbuilding in progress...\n> \n> Besides some unrelated SageNB tests, all (long) tests passed.\n\n(That refers to the build with GCC 4.9.2 and `-fpermissive`, on a mchine *with* AVX2.)",
    "created_at": "2016-08-28T23:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232191",
    "user": "leif"
}
```

Replying to [comment:199 leif]:
> Replying to [comment:197 leif]:
> > Replying to [comment:196 fbissey]:
> > > Well that was what I was asking for, but if permissive work it is probably a better solution (performance wise at least).
> > 
> > Ok, I could push a patched branch, if no-one else does.
> > 
> > (`Sage build/upgrade complete!`)
> > 
> > Haven't run tests though, docbuilding in progress...
> 
> Besides some unrelated SageNB tests, all (long) tests passed.

(That refers to the build with GCC 4.9.2 and `-fpermissive`, on a mchine *with* AVX2.)



---

archive/issue_comments_232192.json:
```json
{
    "body": "Replying to [comment:198 leif]:\n> Replying to [comment:197 leif]:\n> > Replying to [comment:196 fbissey]:\n> > > As for gcc 4.8 that's my current default on power7 but there are other issues there.\n> > \n> > Well I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.\n> \n> I'm now also building on Ubuntu 14.04 x86_64, but that box doesn't have AVX, only SSE 4.1...\n\\\\\n\nOk, with `gcc (Ubuntu 4.8.2-19ubuntu1) 4.8.2` on Ubuntu 14.04 x86_64 (machine *without* AVX) `ptestlong` passed (modulo few known, unrelated issues).\n\nSame with vanilla FSF GCC 4.8.5 on a machine *with* AVX2.\n\nI didn't (have to) pass `-fpermissive` in either case, so that's apparently only needed for GCC 4.9 <= 4.9.2.",
    "created_at": "2016-08-29T04:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232192",
    "user": "leif"
}
```

Replying to [comment:198 leif]:
> Replying to [comment:197 leif]:
> > Replying to [comment:196 fbissey]:
> > > As for gcc 4.8 that's my current default on power7 but there are other issues there.
> > 
> > Well I could test with some vanilla GCC 4.8, but Ubuntu 14.04.x LTS has some 4.8.2-ubuntu-something, so probably a buildbot could as well.
> 
> I'm now also building on Ubuntu 14.04 x86_64, but that box doesn't have AVX, only SSE 4.1...
\\

Ok, with `gcc (Ubuntu 4.8.2-19ubuntu1) 4.8.2` on Ubuntu 14.04 x86_64 (machine *without* AVX) `ptestlong` passed (modulo few known, unrelated issues).

Same with vanilla FSF GCC 4.8.5 on a machine *with* AVX2.

I didn't (have to) pass `-fpermissive` in either case, so that's apparently only needed for GCC 4.9 <= 4.9.2.



---

archive/issue_comments_232193.json:
```json
{
    "body": "Replying to [comment:202 leif]:\n> I didn't (have to) pass `-fpermissive` in either case, so that's apparently only needed for GCC 4.9 <= 4.9.2.\n\nNote that Debian's (AFAIK), Ubuntu's, and some other distros' GCCs omit the patch level in `gcc -dumpversion` though; if we want to check the version, we have to use e.g. (the one from the first line of) `$CXX --version` instead.",
    "created_at": "2016-08-29T05:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232193",
    "user": "leif"
}
```

Replying to [comment:202 leif]:
> I didn't (have to) pass `-fpermissive` in either case, so that's apparently only needed for GCC 4.9 <= 4.9.2.

Note that Debian's (AFAIK), Ubuntu's, and some other distros' GCCs omit the patch level in `gcc -dumpversion` though; if we want to check the version, we have to use e.g. (the one from the first line of) `$CXX --version` instead.



---

archive/issue_comments_232194.json:
```json
{
    "body": "Random note:\n\nIf `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.",
    "created_at": "2016-08-29T06:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232194",
    "user": "leif"
}
```

Random note:

If `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.



---

archive/issue_comments_232195.json:
```json
{
    "body": "Replying to [comment:204 leif]:\n> If `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.\n\nCl\u00e9ment, is it possible to disable just SSE 4.2 (or 4.x)?",
    "created_at": "2016-08-29T06:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232195",
    "user": "leif"
}
```

Replying to [comment:204 leif]:
> If `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.

Clément, is it possible to disable just SSE 4.2 (or 4.x)?



---

archive/issue_comments_232196.json:
```json
{
    "body": "Will push a new branch later, unless somebody else does (or Cl\u00e9ment updates his):\n\n```diff\ndiff --git a/build/pkgs/fflas_ffpack/spkg-install b/build/pkgs/fflas_ffpack/spkg-install\nindex d37385d..bd854b5 100755\n--- a/build/pkgs/fflas_ffpack/spkg-install\n+++ b/build/pkgs/fflas_ffpack/spkg-install\n@@ -1,7 +1,7 @@\n #!/usr/bin/env bash\n \n if [ -z \"$SAGE_LOCAL\" ]; then\n-    echo >&2 \"SAGE_LOCAL undefined ... exiting\"\n+    echo >&2 \"Error: SAGE_LOCAL undefined ... exiting\"\n     echo >&2 \"Maybe run 'sage --sh'?\"\n     exit 1\n fi\n@@ -26,6 +26,17 @@ cp \"$SAGE_ROOT\"/config/config.* build-aux\n export CFLAGS=\"-g -O2 -fPIC $CFLAGS\"\n export CXXFLAGS=\"-g -O2 -fPIC $CXXFLAGS\"\n \n+# GCC 4.9 <= 4.9.2 is broken, cf. https://trac.sagemath.org/ticket/17635#comment:178 ff.:\n+case `$CXX -dumpversion 2>/dev/null` in\n+    4.9.[0-2])\n+        CXXFLAGS+=\" -fpermissive\"\n+        ;;\n+    4.9) # some distros' GCCs omit the patch level\n+        if $CXX --version 2>/dev/null | head -n 1 | grep '4.9.[0-2]' >/dev/null; then\n+            CXXFLAGS+=\" -fpermissive\"\n+        fi\n+esac\n+\n if [ \"$SAGE64\" = \"yes\" ]; then\n    echo \"64 bit build\"\n    CFLAGS=\"-m64 $CFLAGS \"; export CFLAGS\n@@ -37,16 +48,16 @@ fi\n \n if [ \"$LINBOX_BLAS\" != \"\" ]; then\n     echo \"Using environment variable LINBOX_BLAS=$LINBOX_BLAS\"\n-elif [ $UNAME = \"CYGWIN\" ]; then\n+elif [ \"$UNAME\" = \"CYGWIN\" ]; then\n     # TODO: we should install a suitable blas.pc on Cygwin\n     echo \"Using system-wide Cygwin LAPACK BLAS.\"\n     if [ ! -f \"/usr/lib/libblas.a\" ]; then\n-        echo \"*************************************************\"\n-        echo \"*\"\n-        echo \"* On Cygwin you must install the standard LAPACK Cygwin package\"\n-        echo \"* via the Cygwin setup.exe program in the 'Math' category.\"\n-        echo \"*\"\n-        echo \"*************************************************\"\n+        echo >&2 \"*************************************************\"\n+        echo >&2 \"*\"\n+        echo >&2 \"* Error: On Cygwin you must install the standard LAPACK Cygwin package\"\n+        echo >&2 \"* via the Cygwin setup.exe program in the 'Math' category.\"\n+        echo >&2 \"*\"\n+        echo >&2 \"*************************************************\"\n         exit 1\n     fi\n     LINBOX_BLAS=\"-lblas\"\n@@ -79,18 +90,18 @@ fi\n     --enable-optimization --disable-static --enable-precompilation \\\n     --disable-openmp $FFLAS_FFPACK_CONFIGURE\n if [ $? -ne 0 ]; then\n-    echo \"Error configuring fflas-ffpack\"\n+    echo >&2 \"Error configuring fflas-ffpack\"\n     exit 1\n fi\n \n $MAKE\n if [ $? -ne 0 ]; then\n-    echo \"Error building fflas-ffpack\"\n+    echo >&2 \"Error building fflas-ffpack\"\n     exit 1\n fi\n \n $MAKE install\n if [ $? -ne 0 ]; then\n-    echo \"Error installing fflas-ffpack\"\n+    echo >&2 \"Error installing fflas-ffpack\"\n     exit 1\n fi\n```\n",
    "created_at": "2016-08-29T06:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232196",
    "user": "leif"
}
```

Will push a new branch later, unless somebody else does (or Clément updates his):

```diff
diff --git a/build/pkgs/fflas_ffpack/spkg-install b/build/pkgs/fflas_ffpack/spkg-install
index d37385d..bd854b5 100755
--- a/build/pkgs/fflas_ffpack/spkg-install
+++ b/build/pkgs/fflas_ffpack/spkg-install
@@ -1,7 +1,7 @@
 #!/usr/bin/env bash
 
 if [ -z "$SAGE_LOCAL" ]; then
-    echo >&2 "SAGE_LOCAL undefined ... exiting"
+    echo >&2 "Error: SAGE_LOCAL undefined ... exiting"
     echo >&2 "Maybe run 'sage --sh'?"
     exit 1
 fi
@@ -26,6 +26,17 @@ cp "$SAGE_ROOT"/config/config.* build-aux
 export CFLAGS="-g -O2 -fPIC $CFLAGS"
 export CXXFLAGS="-g -O2 -fPIC $CXXFLAGS"
 
+# GCC 4.9 <= 4.9.2 is broken, cf. https://trac.sagemath.org/ticket/17635#comment:178 ff.:
+case `$CXX -dumpversion 2>/dev/null` in
+    4.9.[0-2])
+        CXXFLAGS+=" -fpermissive"
+        ;;
+    4.9) # some distros' GCCs omit the patch level
+        if $CXX --version 2>/dev/null | head -n 1 | grep '4.9.[0-2]' >/dev/null; then
+            CXXFLAGS+=" -fpermissive"
+        fi
+esac
+
 if [ "$SAGE64" = "yes" ]; then
    echo "64 bit build"
    CFLAGS="-m64 $CFLAGS "; export CFLAGS
@@ -37,16 +48,16 @@ fi
 
 if [ "$LINBOX_BLAS" != "" ]; then
     echo "Using environment variable LINBOX_BLAS=$LINBOX_BLAS"
-elif [ $UNAME = "CYGWIN" ]; then
+elif [ "$UNAME" = "CYGWIN" ]; then
     # TODO: we should install a suitable blas.pc on Cygwin
     echo "Using system-wide Cygwin LAPACK BLAS."
     if [ ! -f "/usr/lib/libblas.a" ]; then
-        echo "*************************************************"
-        echo "*"
-        echo "* On Cygwin you must install the standard LAPACK Cygwin package"
-        echo "* via the Cygwin setup.exe program in the 'Math' category."
-        echo "*"
-        echo "*************************************************"
+        echo >&2 "*************************************************"
+        echo >&2 "*"
+        echo >&2 "* Error: On Cygwin you must install the standard LAPACK Cygwin package"
+        echo >&2 "* via the Cygwin setup.exe program in the 'Math' category."
+        echo >&2 "*"
+        echo >&2 "*************************************************"
         exit 1
     fi
     LINBOX_BLAS="-lblas"
@@ -79,18 +90,18 @@ fi
     --enable-optimization --disable-static --enable-precompilation \
     --disable-openmp $FFLAS_FFPACK_CONFIGURE
 if [ $? -ne 0 ]; then
-    echo "Error configuring fflas-ffpack"
+    echo >&2 "Error configuring fflas-ffpack"
     exit 1
 fi
 
 $MAKE
 if [ $? -ne 0 ]; then
-    echo "Error building fflas-ffpack"
+    echo >&2 "Error building fflas-ffpack"
     exit 1
 fi
 
 $MAKE install
 if [ $? -ne 0 ]; then
-    echo "Error installing fflas-ffpack"
+    echo >&2 "Error installing fflas-ffpack"
     exit 1
 fi
```




---

archive/issue_comments_232197.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-29T08:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232197",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232198.json:
```json
{
    "body": "Replying to [comment:205 leif]:\n> Replying to [comment:204 leif]:\n> > If `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.\n> \n> Cl\u00e9ment, is it possible to disable just SSE 4.2 (or 4.x)?\n\nDarn the `configure.ac` is so confusing and the `macro` folder so full of unused stuff that I got the configuration wrong. It looks like we just have `--{en,dis}able-simd` no granularity.\n----\nNew commits:",
    "created_at": "2016-08-29T08:33:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232198",
    "user": "fbissey"
}
```

Replying to [comment:205 leif]:
> Replying to [comment:204 leif]:
> > If `SAGE_FAT_BINARY=yes`, we should only `--disable-sse` on x86, not x86_64, IMHO.
> 
> Clément, is it possible to disable just SSE 4.2 (or 4.x)?

Darn the `configure.ac` is so confusing and the `macro` folder so full of unused stuff that I got the configuration wrong. It looks like we just have `--{en,dis}able-simd` no granularity.
----
New commits:



---

archive/issue_comments_232199.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-08-29T08:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232199",
    "user": "fbissey"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_232200.json:
```json
{
    "body": "looks good to me. Back to the bots please.",
    "created_at": "2016-08-29T08:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232200",
    "user": "fbissey"
}
```

looks good to me. Back to the bots please.



---

archive/issue_comments_232201.json:
```json
{
    "body": "Indeed, there is no granularity.\nIf I understand correctly, you want to disable all sse>2 on x86 and all avx{1,2} on x86_64.\nThere is no such option for the moment in fflas-ffpack. Given the fact that with a fat binary, the user will get a BLAS compiled for nehalem (very slow), I see almost no interest in terms of effciency to get the sse4 options turned on in fflas-ffpack when building for x86_64.\n\nThe mess in all the simd/sse checking macros comes partly from the fact that the  standard macro ax_x86_features only work on x86 architectures.",
    "created_at": "2016-08-29T08:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232201",
    "user": "cpernet"
}
```

Indeed, there is no granularity.
If I understand correctly, you want to disable all sse>2 on x86 and all avx{1,2} on x86_64.
There is no such option for the moment in fflas-ffpack. Given the fact that with a fat binary, the user will get a BLAS compiled for nehalem (very slow), I see almost no interest in terms of effciency to get the sse4 options turned on in fflas-ffpack when building for x86_64.

The mess in all the simd/sse checking macros comes partly from the fact that the  standard macro ax_x86_features only work on x86 architectures.



---

archive/issue_comments_232202.json:
```json
{
    "body": "Replying to [comment:210 cpernet]:\n> The mess in all the simd/sse checking macros comes partly from the fact that the  standard macro ax_x86_features only work on x86 architectures.\n\nYou are not exactly checking instructions for platforms besides x86(_64). Is it forward thinking?",
    "created_at": "2016-08-29T09:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232202",
    "user": "fbissey"
}
```

Replying to [comment:210 cpernet]:
> The mess in all the simd/sse checking macros comes partly from the fact that the  standard macro ax_x86_features only work on x86 architectures.

You are not exactly checking instructions for platforms besides x86(_64). Is it forward thinking?



---

archive/issue_comments_232203.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-30T06:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232203",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_232204.json:
```json
{
    "body": "Just for the record:  At least on the Debian 8 64-bit buildbot, `-fpermissive` turned the previous errors into just warnings now.\n\n[http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/690/steps/compile_1/logs/stdio](http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/690/steps/compile_1/logs/stdio)",
    "created_at": "2016-08-30T15:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232204",
    "user": "leif"
}
```

Just for the record:  At least on the Debian 8 64-bit buildbot, `-fpermissive` turned the previous errors into just warnings now.

[http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/690/steps/compile_1/logs/stdio](http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/690/steps/compile_1/logs/stdio)



---

archive/issue_comments_232205.json:
```json
{
    "body": "Glad to see that this is finally merged!",
    "created_at": "2016-09-02T08:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232205",
    "user": "jdemeyer"
}
```

Glad to see that this is finally merged!



---

archive/issue_comments_232206.json:
```json
{
    "body": "There seems to be some issue with building the interface(s) when MAPLE is found:\n\n\n```\n...\nchecking for FLINT... found\nchecking for NTL >= 5.0... found\nchecking for SACLIB >= 2.0... not found\nchecking for MAPLE >= 9.0... ./configure: line 18187:\n/bin/maple.system.type: No such file or directory\nfound\nchecking whether to compile the SAGE interface... yes\nchecking whether gnuplot works... yes\nchecking whether ps2pdf works... yes\n...\nMaking all in interfaces\nmake[5]: Entering directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces'\nMaking all in driver\nmake[6]: Entering directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/driver'\n/bin/sh ../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../..  -I../.. -I. -I../../linbox -DDISABLE_COMMENTATOR -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR\n-I/home/dcoudert/sage-dev/sage/local/include -std=gnu++11  -g -fPIC -c -o lb-element.lo lb-element.C\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I. -I../../linbox -DDISABLE_COMMENTATOR -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -I/home/dcoudert/sage-dev/sage/local/include -std=gnu++11 -g -fPIC -c lb-element.C  -fPIC -DPIC -o .libs/lb-element.o\nIn file included from ./lb-domain-functor.h:30:0,\n                 from ./lb-domain-function.h:30,\n                 from ./lb-element-data.h:33,\n                 from lb-element.C:30:\n./lb-domain-type.h:31:33: fatal error: linbox/field/givaro..h: No such file or directory\n#include \"linbox/field/givaro.h\"\n                                ^\ncompilation terminated.\nMakefile:571: recipe for target 'lb-element.lo' failed\nmake[6]: *** [lb-element.lo] Error 1\nmake[6]: Leaving directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/driver'\nMakefile:428: recipe for target 'all-recursive' failed\nmake[5]: *** [all-recursive] Error 1\nmake[5]: Leaving directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces'\nMakefile:582: recipe for target 'all-recursive' failed\nmake[4]: *** [all-recursive] Error 1\nmake[4]: Leaving directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src'\nMakefile:453: recipe for target 'all' failed\nmake[3]: *** [all] Error 2\nmake[3]: Leaving directory\n'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src'\nError building LinBox.\n```\n\n\n(Snippet from sage-devel report today.)",
    "created_at": "2016-09-12T17:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232206",
    "user": "leif"
}
```

There seems to be some issue with building the interface(s) when MAPLE is found:


```
...
checking for FLINT... found
checking for NTL >= 5.0... found
checking for SACLIB >= 2.0... not found
checking for MAPLE >= 9.0... ./configure: line 18187:
/bin/maple.system.type: No such file or directory
found
checking whether to compile the SAGE interface... yes
checking whether gnuplot works... yes
checking whether ps2pdf works... yes
...
Making all in interfaces
make[5]: Entering directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces'
Making all in driver
make[6]: Entering directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/driver'
/bin/sh ../../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I../..  -I../.. -I. -I../../linbox -DDISABLE_COMMENTATOR -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR
-I/home/dcoudert/sage-dev/sage/local/include -std=gnu++11  -g -fPIC -c -o lb-element.lo lb-element.C
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I../.. -I../.. -I. -I../../linbox -DDISABLE_COMMENTATOR -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -I/home/dcoudert/sage-dev/sage/local/include -std=gnu++11 -g -fPIC -c lb-element.C  -fPIC -DPIC -o .libs/lb-element.o
In file included from ./lb-domain-functor.h:30:0,
                 from ./lb-domain-function.h:30,
                 from ./lb-element-data.h:33,
                 from lb-element.C:30:
./lb-domain-type.h:31:33: fatal error: linbox/field/givaro..h: No such file or directory
#include "linbox/field/givaro.h"
                                ^
compilation terminated.
Makefile:571: recipe for target 'lb-element.lo' failed
make[6]: *** [lb-element.lo] Error 1
make[6]: Leaving directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/driver'
Makefile:428: recipe for target 'all-recursive' failed
make[5]: *** [all-recursive] Error 1
make[5]: Leaving directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces'
Makefile:582: recipe for target 'all-recursive' failed
make[4]: *** [all-recursive] Error 1
make[4]: Leaving directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src'
Makefile:453: recipe for target 'all' failed
make[3]: *** [all] Error 2
make[3]: Leaving directory
'/home/dcoudert/sage-dev/sage/local/var/tmp/sage/build/linbox-1.4.2/src'
Error building LinBox.
```


(Snippet from sage-devel report today.)



---

archive/issue_comments_232207.json:
```json
{
    "body": "I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..",
    "created_at": "2016-09-12T18:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232207",
    "user": "chapoton"
}
```

I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..



---

archive/issue_comments_232208.json:
```json
{
    "body": "Replying to [comment:216 chapoton]:\n> I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..\n\n\n```\ngcc version 4.9.3 (Ubuntu 4.9.3-8ubuntu2~14.04) \n```\n\n\nFWIW, it builds with vanilla FSF GCC 4.9.3.",
    "created_at": "2016-09-12T18:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232208",
    "user": "leif"
}
```

Replying to [comment:216 chapoton]:
> I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..


```
gcc version 4.9.3 (Ubuntu 4.9.3-8ubuntu2~14.04) 
```


FWIW, it builds with vanilla FSF GCC 4.9.3.



---

archive/issue_comments_232209.json:
```json
{
    "body": "Replying to [comment:216 chapoton]:\n> I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..\n\nCould you please truncate the log to 833 lines?  We don't need the log of N build attempts... ;-)",
    "created_at": "2016-09-12T18:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232209",
    "user": "leif"
}
```

Replying to [comment:216 chapoton]:
> I have problems (can not build linbox) since the update, I am attaching the log. If somebody could have a look..

Could you please truncate the log to 833 lines?  We don't need the log of N build attempts... ;-)



---

archive/issue_comments_232210.json:
```json
{
    "body": "shorter linbox log",
    "created_at": "2016-09-12T18:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232210",
    "user": "chapoton"
}
```

shorter linbox log



---

archive/issue_comments_232211.json:
```json
{
    "body": "Attachment [linbox.log](tarball://root/attachments/some-uuid/ticket17635/linbox.log) by leif created at 2016-09-12 19:13:54\n\nProbably due to a further (`configure`) issue with MAPLE:\n\n```\nchecking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory\n./configure: line 18198: /bin/maple: No such file or directory\ncat: maple_version.txt: No such file or directory\n./configure: line 18201: test: -lt: unary operator expected\nfound\n./configure: line 18219: test: -ge: unary operator expected\nchecking whether to compile the SAGE interface... yes\n```\n\nThis time there's no `found` though, but interestingly the header file `linbox/field/givaro.h` exists...",
    "created_at": "2016-09-12T19:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232211",
    "user": "leif"
}
```

Attachment [linbox.log](tarball://root/attachments/some-uuid/ticket17635/linbox.log) by leif created at 2016-09-12 19:13:54

Probably due to a further (`configure`) issue with MAPLE:

```
checking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory
./configure: line 18198: /bin/maple: No such file or directory
cat: maple_version.txt: No such file or directory
./configure: line 18201: test: -lt: unary operator expected
found
./configure: line 18219: test: -ge: unary operator expected
checking whether to compile the SAGE interface... yes
```

This time there's no `found` though, but interestingly the header file `linbox/field/givaro.h` exists...



---

archive/issue_comments_232212.json:
```json
{
    "body": "Oh, there **is** a `found` -- *between* the syntax errors...\n\nSo for now disabling the MAPLE interface like Volker suggested may make sense.",
    "created_at": "2016-09-12T19:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232212",
    "user": "leif"
}
```

Oh, there **is** a `found` -- *between* the syntax errors...

So for now disabling the MAPLE interface like Volker suggested may make sense.



---

archive/issue_comments_232213.json:
```json
{
    "body": "Replying to [comment:220 leif]:\n> So for now disabling the MAPLE interface like Volker suggested may make sense.\n\n\n```diff\ndiff --git a/build/pkgs/linbox/spkg-install b/build/pkgs/linbox/spkg-install\nindex b051d4c..ecd6c25 100755\n--- a/build/pkgs/linbox/spkg-install\n+++ b/build/pkgs/linbox/spkg-install\n@@ -65,6 +65,10 @@ if [ \"$SAGE_FAT_BINARY\" = yes ]; then\n     LINBOX_CONFIGURE=\"--without-ocl $LINBOX_CONFIGURE\"\n fi\n \n+# Building MAPLE interface appears to be broken:\n+# http://trac.sagemath.org/ticket/17635#comment:215 ff. (*after* LinBox ticket got merged!)\n+LINBOX_CONFIGURE=\"--without-maple $LINBOX_CONFIGURE\"\n+\n # We disable openmp because of build failures, see\n # http://trac.sagemath.org/ticket/17635#comment:67\n ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" \\\n```\n\n\nHTH, not tested.",
    "created_at": "2016-09-12T19:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232213",
    "user": "leif"
}
```

Replying to [comment:220 leif]:
> So for now disabling the MAPLE interface like Volker suggested may make sense.


```diff
diff --git a/build/pkgs/linbox/spkg-install b/build/pkgs/linbox/spkg-install
index b051d4c..ecd6c25 100755
--- a/build/pkgs/linbox/spkg-install
+++ b/build/pkgs/linbox/spkg-install
@@ -65,6 +65,10 @@ if [ "$SAGE_FAT_BINARY" = yes ]; then
     LINBOX_CONFIGURE="--without-ocl $LINBOX_CONFIGURE"
 fi
 
+# Building MAPLE interface appears to be broken:
+# http://trac.sagemath.org/ticket/17635#comment:215 ff. (*after* LinBox ticket got merged!)
+LINBOX_CONFIGURE="--without-maple $LINBOX_CONFIGURE"
+
 # We disable openmp because of build failures, see
 # http://trac.sagemath.org/ticket/17635#comment:67
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" \
```


HTH, not tested.



---

archive/issue_comments_232214.json:
```json
{
    "body": "I don't have MAPLE installed, but regardless of whether I pass `--without-maple`, `--with-maple=no`, or nothing (related), I'm always getting\n\n```\nchecking for MAPLE >= 9.0... not found\n```\n\nso I'm not sure if that option works at all; `--with-maple=no` is said to be the default anyway:\n\n```\n  --with-maple=<path>|yes|no\n                          Use Maple library. If argument is no, you do not\n                          have the library installed on your machine (set as\n                          default). If argument is yes or <empty> that means\n                          the library is well installed and so reachable.\n                          Otherwise you give the <path> to the directory which\n                          contains the Software.\n```\n",
    "created_at": "2016-09-12T19:47:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232214",
    "user": "leif"
}
```

I don't have MAPLE installed, but regardless of whether I pass `--without-maple`, `--with-maple=no`, or nothing (related), I'm always getting

```
checking for MAPLE >= 9.0... not found
```

so I'm not sure if that option works at all; `--with-maple=no` is said to be the default anyway:

```
  --with-maple=<path>|yes|no
                          Use Maple library. If argument is no, you do not
                          have the library installed on your machine (set as
                          default). If argument is yes or <empty> that means
                          the library is well installed and so reachable.
                          Otherwise you give the <path> to the directory which
                          contains the Software.
```




---

archive/issue_comments_232215.json:
```json
{
    "body": "Replying to [comment:222 leif]:\n> I don't have MAPLE installed, but regardless of whether I pass `--without-maple`, `--with-maple=no`, or nothing (related), I'm always getting\n> {{{\n> checking for MAPLE >= 9.0... not found\n> }}}\n> so I'm not sure if that option works at all...\n\nLooking at `configure`, it (`--with-maple=no` at least) *should* work (`checking` and `not found` will always appear).",
    "created_at": "2016-09-12T20:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232215",
    "user": "leif"
}
```

Replying to [comment:222 leif]:
> I don't have MAPLE installed, but regardless of whether I pass `--without-maple`, `--with-maple=no`, or nothing (related), I'm always getting
> {{{
> checking for MAPLE >= 9.0... not found
> }}}
> so I'm not sure if that option works at all...

Looking at `configure`, it (`--with-maple=no` at least) *should* work (`checking` and `not found` will always appear).



---

archive/issue_comments_232216.json:
```json
{
    "body": "Attachment [linbox-1.4.2.log](tarball://root/attachments/some-uuid/ticket17635/linbox-1.4.2.log) by dcoudert created at 2016-09-12 20:29:33\n\nlinbox log when trying the trick of comment #17635#comment:221",
    "created_at": "2016-09-12T20:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232216",
    "user": "dcoudert"
}
```

Attachment [linbox-1.4.2.log](tarball://root/attachments/some-uuid/ticket17635/linbox-1.4.2.log) by dcoudert created at 2016-09-12 20:29:33

linbox log when trying the trick of comment #17635#comment:221



---

archive/issue_comments_232217.json:
```json
{
    "body": "unfortunately not working :(",
    "created_at": "2016-09-12T20:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232217",
    "user": "dcoudert"
}
```

unfortunately not working :(



---

archive/issue_comments_232218.json:
```json
{
    "body": "Replying to [comment:224 dcoudert]:\n> unfortunately not working :(\n\nCan you retry with `--with-maple=no` instead?  (As said, that should work, despite the \"checking\" message.)",
    "created_at": "2016-09-12T20:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232218",
    "user": "leif"
}
```

Replying to [comment:224 dcoudert]:
> unfortunately not working :(

Can you retry with `--with-maple=no` instead?  (As said, that should work, despite the "checking" message.)



---

archive/issue_comments_232219.json:
```json
{
    "body": "Hmmm, [LinBox doesn't find David's M4RIE...](https://trac.sagemath.org/attachment/ticket/17635/linbox-1.4.2.log#L160)\n\n----\n\nThe `checking for MAPLE` regardless of `--with-maple=no` is by the way due to `Checking all external packages ...` (`--with-all=yes`).",
    "created_at": "2016-09-12T20:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232219",
    "user": "leif"
}
```

Hmmm, [LinBox doesn't find David's M4RIE...](https://trac.sagemath.org/attachment/ticket/17635/linbox-1.4.2.log#L160)

----

The `checking for MAPLE` regardless of `--with-maple=no` is by the way due to `Checking all external packages ...` (`--with-all=yes`).



---

archive/issue_comments_232220.json:
```json
{
    "body": "I tried with `--with-maple=no` and got the same result.\n\n```\n...\nchecking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory\nfound\n...\n./lb-domain-type.h:31:33: fatal error: linbox/field/givaro.h: No such file or directory\n...\n```\n\n\nConcerning m4rie, it is installed (sorry, configured in french)\n\n```\n%m:%S%~%s> yum install m4rie\nModules compl\u00e9mentaires charg\u00e9s\u00a0: langpacks\nLe paquet m4rie-20140914-1.fc21.x86_64 est d\u00e9j\u00e0 install\u00e9 dans sa derni\u00e8re version\nRien \u00e0 faire\n```\n",
    "created_at": "2016-09-12T20:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232220",
    "user": "dcoudert"
}
```

I tried with `--with-maple=no` and got the same result.

```
...
checking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory
found
...
./lb-domain-type.h:31:33: fatal error: linbox/field/givaro.h: No such file or directory
...
```


Concerning m4rie, it is installed (sorry, configured in french)

```
%m:%S%~%s> yum install m4rie
Modules complémentaires chargés : langpacks
Le paquet m4rie-20140914-1.fc21.x86_64 est déjà installé dans sa dernière version
Rien à faire
```




---

archive/issue_comments_232221.json:
```json
{
    "body": "Replying to [comment:226 leif]:\n> Hmmm, [LinBox doesn't find David's M4RIE...](https://trac.sagemath.org/attachment/ticket/17635/linbox-1.4.2.log#L160)\n> \n\n`linbox` has plenty of useless check (stuff that it is not using \"yet\") that's one of them. Because of this `m4rie` is not a dependency of `linbox` and yes sometimes it won't be found.",
    "created_at": "2016-09-12T21:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232221",
    "user": "fbissey"
}
```

Replying to [comment:226 leif]:
> Hmmm, [LinBox doesn't find David's M4RIE...](https://trac.sagemath.org/attachment/ticket/17635/linbox-1.4.2.log#L160)
> 

`linbox` has plenty of useless check (stuff that it is not using "yet") that's one of them. Because of this `m4rie` is not a dependency of `linbox` and yes sometimes it won't be found.



---

archive/issue_comments_232222.json:
```json
{
    "body": "Replying to [comment:227 dcoudert]:\n> I tried with `--with-maple=no` and got the same result.\n> {{{\n> ...\n> checking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory\n> found\n> ...\n> ./lb-domain-type.h:31:33: fatal error: linbox/field/givaro.h: No such file or directory\n> ...\n> }}}\n> \n> Concerning m4rie, it is installed (sorry, configured in french)\n> {{{\n> %m:%S%~%s> yum install m4rie\n> Modules compl\u00e9mentaires charg\u00e9s\u00a0: langpacks\n> Le paquet m4rie-20140914-1.fc21.x86_64 est d\u00e9j\u00e0 install\u00e9 dans sa derni\u00e8re version\n> Rien \u00e0 faire\n> }}}\n\nC'est pas grave parce qu'on veux la version de `sage` pas celle de Fedora.\n\nAre you working for sage-on-fedora?",
    "created_at": "2016-09-12T21:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232222",
    "user": "fbissey"
}
```

Replying to [comment:227 dcoudert]:
> I tried with `--with-maple=no` and got the same result.
> {{{
> ...
> checking for MAPLE >= 9.0... ./configure: line 18187: /bin/maple.system.type: No such file or directory
> found
> ...
> ./lb-domain-type.h:31:33: fatal error: linbox/field/givaro.h: No such file or directory
> ...
> }}}
> 
> Concerning m4rie, it is installed (sorry, configured in french)
> {{{
> %m:%S%~%s> yum install m4rie
> Modules complémentaires chargés : langpacks
> Le paquet m4rie-20140914-1.fc21.x86_64 est déjà installé dans sa dernière version
> Rien à faire
> }}}

C'est pas grave parce qu'on veux la version de `sage` pas celle de Fedora.

Are you working for sage-on-fedora?



---

archive/issue_comments_232223.json:
```json
{
    "body": "Replying to [comment:219 leif]:\n> This time there's no `found` though, but interestingly the header file `linbox/field/givaro.h` exists...\n\nThat's very interesting because I don't have it. Is it generated somehow if you have `maple`?",
    "created_at": "2016-09-12T21:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232223",
    "user": "fbissey"
}
```

Replying to [comment:219 leif]:
> This time there's no `found` though, but interestingly the header file `linbox/field/givaro.h` exists...

That's very interesting because I don't have it. Is it generated somehow if you have `maple`?



---

archive/issue_comments_232224.json:
```json
{
    "body": "I have a patch (rather a hack, for Sage only):\n\n```diff\ndiff --git a/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch b/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch\nnew file mode 100644\nindex 0000000..98c4ab4\n--- /dev/null\n+++ b/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch\n@@ -0,0 +1,32 @@\n+Remove /usr and /usr/local from LinBox's \"default checking path\"\n+such that we can configure with '--with-default=\"$SAGE_LOCAL\"' and\n+no \"external\" packages from elsewhere get picked up (such as MAPLE,\n+whose interface appears to be broken / break the build at the moment).\n+\n+Also, remove \"unknown\" from MAPLE_HOME_PATH as otherwise still /usr\n+and /usr/local will get searched for MAPLE, even though no longer\n+part of DEFAULT_CHECKING_PATH.\n+\n+\n+--- linbox-1.4.2/configure\n++++ linbox-1.4.2/configure\n+@@ -16579,8 +16579,8 @@\n+                       echo \"Default path = /usr /usr/local \"\n+                       DEFAULT_CHECKING_PATH=\"/usr /usr/local \"\n+             else\n+-                      echo \"Default path = $withval /usr /usr/local \"\n+-                      DEFAULT_CHECKING_PATH=\"$withval /usr /usr/local \"\n++                      echo \"Default path = $withval \"\n++                      DEFAULT_CHECKING_PATH=\"$withval \"\n+            fi\n+ \n+ else\n+@@ -16617,7 +16617,7 @@\n+     FFLAS_FFPACK_HOME_PATH=\"${DEFAULT_CHECKING_PATH}\"\n+       LIDIA_HOME_PATH=\"${DEFAULT_CHECKING_PATH}\"\n+       SACLIB_HOME_PATH=\"${DEFAULT_CHECKING_PATH}\"\n+-      MAPLE_HOME_PATH=\"${DEFAULT_CHECKING_PATH} unknown\"\n++      MAPLE_HOME_PATH=\"${DEFAULT_CHECKING_PATH}\"\n+       BLAS_HOME_PATH=\"${DEFAULT_CHECKING_PATH}\"\n+ fi\n+ \ndiff --git a/build/pkgs/linbox/spkg-install b/build/pkgs/linbox/spkg-install\nindex b051d4c..a06ae07 100755\n--- a/build/pkgs/linbox/spkg-install\n+++ b/build/pkgs/linbox/spkg-install\n@@ -65,10 +65,17 @@ if [ \"$SAGE_FAT_BINARY\" = yes ]; then\n     LINBOX_CONFIGURE=\"--without-ocl $LINBOX_CONFIGURE\"\n fi\n \n+# Building MAPLE interface appears to be broken:\n+# http://trac.sagemath.org/ticket/17635#comment:215 ff. (*after* LinBox ticket got merged!)\n+# LINBOX_CONFIGURE=\"--without-maple $LINBOX_CONFIGURE\"\n+LINBOX_CONFIGURE=\"--with-maple=no $LINBOX_CONFIGURE\"\n+# To make this work, currently a patch to 'configure' is needed though:\n+# patches/dont_search__usr__usr_local.patch\n+\n # We disable openmp because of build failures, see\n # http://trac.sagemath.org/ticket/17635#comment:67\n ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" \\\n-            --with-all=\"$SAGE_LOCAL\" \\\n+            --with-all=\"$SAGE_LOCAL\" --with-default=\"$SAGE_LOCAL\" \\\n             --enable-sage --disable-static --disable-openmp \\\n             $LINBOX_CONFIGURE\n if [ $? -ne 0 ]; then\n```\n",
    "created_at": "2016-09-12T21:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232224",
    "user": "leif"
}
```

I have a patch (rather a hack, for Sage only):

```diff
diff --git a/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch b/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch
new file mode 100644
index 0000000..98c4ab4
--- /dev/null
+++ b/build/pkgs/linbox/patches/dont_search__usr__usr_local.patch
@@ -0,0 +1,32 @@
+Remove /usr and /usr/local from LinBox's "default checking path"
+such that we can configure with '--with-default="$SAGE_LOCAL"' and
+no "external" packages from elsewhere get picked up (such as MAPLE,
+whose interface appears to be broken / break the build at the moment).
+
+Also, remove "unknown" from MAPLE_HOME_PATH as otherwise still /usr
+and /usr/local will get searched for MAPLE, even though no longer
+part of DEFAULT_CHECKING_PATH.
+
+
+--- linbox-1.4.2/configure
++++ linbox-1.4.2/configure
+@@ -16579,8 +16579,8 @@
+                       echo "Default path = /usr /usr/local "
+                       DEFAULT_CHECKING_PATH="/usr /usr/local "
+             else
+-                      echo "Default path = $withval /usr /usr/local "
+-                      DEFAULT_CHECKING_PATH="$withval /usr /usr/local "
++                      echo "Default path = $withval "
++                      DEFAULT_CHECKING_PATH="$withval "
+            fi
+ 
+ else
+@@ -16617,7 +16617,7 @@
+     FFLAS_FFPACK_HOME_PATH="${DEFAULT_CHECKING_PATH}"
+       LIDIA_HOME_PATH="${DEFAULT_CHECKING_PATH}"
+       SACLIB_HOME_PATH="${DEFAULT_CHECKING_PATH}"
+-      MAPLE_HOME_PATH="${DEFAULT_CHECKING_PATH} unknown"
++      MAPLE_HOME_PATH="${DEFAULT_CHECKING_PATH}"
+       BLAS_HOME_PATH="${DEFAULT_CHECKING_PATH}"
+ fi
+ 
diff --git a/build/pkgs/linbox/spkg-install b/build/pkgs/linbox/spkg-install
index b051d4c..a06ae07 100755
--- a/build/pkgs/linbox/spkg-install
+++ b/build/pkgs/linbox/spkg-install
@@ -65,10 +65,17 @@ if [ "$SAGE_FAT_BINARY" = yes ]; then
     LINBOX_CONFIGURE="--without-ocl $LINBOX_CONFIGURE"
 fi
 
+# Building MAPLE interface appears to be broken:
+# http://trac.sagemath.org/ticket/17635#comment:215 ff. (*after* LinBox ticket got merged!)
+# LINBOX_CONFIGURE="--without-maple $LINBOX_CONFIGURE"
+LINBOX_CONFIGURE="--with-maple=no $LINBOX_CONFIGURE"
+# To make this work, currently a patch to 'configure' is needed though:
+# patches/dont_search__usr__usr_local.patch
+
 # We disable openmp because of build failures, see
 # http://trac.sagemath.org/ticket/17635#comment:67
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" \
-            --with-all="$SAGE_LOCAL" \
+            --with-all="$SAGE_LOCAL" --with-default="$SAGE_LOCAL" \
             --enable-sage --disable-static --disable-openmp \
             $LINBOX_CONFIGURE
 if [ $? -ne 0 ]; then
```




---

archive/issue_comments_232225.json:
```json
{
    "body": "I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).",
    "created_at": "2016-09-13T07:07:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232225",
    "user": "dcoudert"
}
```

I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).



---

archive/issue_comments_232226.json:
```json
{
    "body": "Replying to [comment:232 dcoudert]:\n> I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).\n\nyou don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there. Then you also need to add a \"patch block\" to spkg-install somewhere near the top of spkg-install:\n\n```\n    # Apply all patches\n    for patch in patches/*.patch; do\n        [ -r \"$patch\" ] || continue  # Skip non-existing or non-readable patches\n        echo \"Applying $patch\"\n        patch -p1 <\"$patch\"\n        if [ $? -ne 0 ]; then\n            echo >&2 \"Error applying '$patch'\"\n            return 1\n        fi\n    done\n}\n```\n\n \nI wonder why there is no default functionality for this, for this block is in dozens of spkg-install files...",
    "created_at": "2016-09-13T09:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232226",
    "user": "dimpase"
}
```

Replying to [comment:232 dcoudert]:
> I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).

you don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there. Then you also need to add a "patch block" to spkg-install somewhere near the top of spkg-install:

```
    # Apply all patches
    for patch in patches/*.patch; do
        [ -r "$patch" ] || continue  # Skip non-existing or non-readable patches
        echo "Applying $patch"
        patch -p1 <"$patch"
        if [ $? -ne 0 ]; then
            echo >&2 "Error applying '$patch'"
            return 1
        fi
    done
}
```

 
I wonder why there is no default functionality for this, for this block is in dozens of spkg-install files...



---

archive/issue_comments_232227.json:
```json
{
    "body": "Should one open a new ticket for this?",
    "created_at": "2016-09-13T09:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232227",
    "user": "dimpase"
}
```

Should one open a new ticket for this?



---

archive/issue_comments_232228.json:
```json
{
    "body": "Definitely new ticket!!!",
    "created_at": "2016-09-13T10:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232228",
    "user": "vbraun"
}
```

Definitely new ticket!!!



---

archive/issue_comments_232229.json:
```json
{
    "body": "I unsuccessfully tried. I'm missing something in copy/paste, etc.\nI will wait for the new ticket and a git branch. Safer for me.\nThanks,\nDavid.\n\nReplying to [comment:233 dimpase]:\n> Replying to [comment:232 dcoudert]:\n> > I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).\n> \n> you don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there. Then you also need to add a \"patch block\" to spkg-install somewhere near the top of spkg-install:\n...",
    "created_at": "2016-09-13T10:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232229",
    "user": "dcoudert"
}
```

I unsuccessfully tried. I'm missing something in copy/paste, etc.
I will wait for the new ticket and a git branch. Safer for me.
Thanks,
David.

Replying to [comment:233 dimpase]:
> Replying to [comment:232 dcoudert]:
> > I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).
> 
> you don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there. Then you also need to add a "patch block" to spkg-install somewhere near the top of spkg-install:
...



---

archive/issue_comments_232230.json:
```json
{
    "body": "Replying to [comment:236 dcoudert]:\n> I unsuccessfully tried. I'm missing something in copy/paste, etc.\n> I will wait for the new ticket and a git branch. Safer for me.\n\nwe continue on this on #21482.",
    "created_at": "2016-09-13T11:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232230",
    "user": "dimpase"
}
```

Replying to [comment:236 dcoudert]:
> I unsuccessfully tried. I'm missing something in copy/paste, etc.
> I will wait for the new ticket and a git branch. Safer for me.

we continue on this on #21482.



---

archive/issue_comments_232231.json:
```json
{
    "body": "Replying to [comment:233 dimpase]:\n> Replying to [comment:232 dcoudert]:\n> > I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).\n\nSorry, I thought it was obvious, although I could in addition have attached the patch (to simply be applied from `$SAGE_ROOT`), but forgot.\n\n\\\\\n\n> you don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there.\n\nNo, it's **one** patch which\n\n* modifies LinBox's `spkg-install` (the \"patch loop\" is already there by the way)\n\n* creates a patch to LinBox's `configure` which will be applied (by `spkg-install`) when reinstalling LinBox.\n\nIn other words, `cd $SAGE_ROOT && patch -p1 < inline_patch_from_the_comment_above.patch`, then `./sage -f linbox && make`.\n\n\\\\\n\n> Then you also need to add a \"patch block\" to spkg-install somewhere near the top of spkg-install:\n> {{{\n>     # Apply all patches\n>     for patch in patches/*.patch; do\n>         [ -r \"$patch\" ] || continue  # Skip non-existing or non-readable patches\n>         echo \"Applying $patch\"\n>         patch -p1 <\"$patch\"\n>         if [ $? -ne 0 ]; then\n>             echo >&2 \"Error applying '$patch'\"\n>             return 1\n>         fi\n>     done\n> }\n> }}}\n>  \n> I wonder why there is no default functionality for this, for this block is in dozens of spkg-install files...\n\nErik B. has a ticket for this, don't know the number right know (probably search for \"apply-patches\").",
    "created_at": "2016-09-13T14:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232231",
    "user": "leif"
}
```

Replying to [comment:233 dimpase]:
> Replying to [comment:232 dcoudert]:
> > I don't know how to test this hack (not able to locate file `linbox-1.4.2/configure`).

Sorry, I thought it was obvious, although I could in addition have attached the patch (to simply be applied from `$SAGE_ROOT`), but forgot.

\\

> you don't need this file physically; one does monkey-patching, as done in many Sage packages; create a directory patches/ in build/pkgs/linbox/, and put the patch above there.

No, it's **one** patch which

* modifies LinBox's `spkg-install` (the "patch loop" is already there by the way)

* creates a patch to LinBox's `configure` which will be applied (by `spkg-install`) when reinstalling LinBox.

In other words, `cd $SAGE_ROOT && patch -p1 < inline_patch_from_the_comment_above.patch`, then `./sage -f linbox && make`.

\\

> Then you also need to add a "patch block" to spkg-install somewhere near the top of spkg-install:
> {{{
>     # Apply all patches
>     for patch in patches/*.patch; do
>         [ -r "$patch" ] || continue  # Skip non-existing or non-readable patches
>         echo "Applying $patch"
>         patch -p1 <"$patch"
>         if [ $? -ne 0 ]; then
>             echo >&2 "Error applying '$patch'"
>             return 1
>         fi
>     done
> }
> }}}
>  
> I wonder why there is no default functionality for this, for this block is in dozens of spkg-install files...

Erik B. has a ticket for this, don't know the number right know (probably search for "apply-patches").



---

archive/issue_comments_232232.json:
```json
{
    "body": "This seems to have broken my Cygwin build in 7.4beta5 (at least).  It fails during build of sagelib itself, linking one of the Cython modules:\n\n\n```\n$ g++ -shared -Wl,--enable-auto-image-base -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib build/temp.cygwin-2.5.1-x86_64-2.7/home/embray/src/sagemath/sage/src/build/cythonized/sage/libs/linbox/linbox.o -L/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local//lib -L/home/embray/src/sagemath/sage/local/lib/python2.7/config -L/home/embray/src/sagemath/sage/local/lib -lfflas -llinboxsage -lffpack -lblas -liml -llinbox -lntl -lgivaro -lflint -lflint -lfplll -lmpfr -lgmp -lgmp -lgmpxx -lstdc++ -lpython2.7 -o build/lib.cygwin-2.5.1-x86_64-2.7/sage/libs/linbox/linbox.dll\n/home/embray/src/sagemath/sage/local/lib/liblinboxsage.a(linbox-sage.o): In function `double* linbox_modn_dense_matrix_matrix_multiply<double>(double, double*, double*, double*, unsigned long, unsigned long, unsigned long)':\n/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313: undefined reference to `Givaro::Modular<double, double>::Element_ptr FFLAS::fgemm<Givaro::Modular<double, double> >(Givaro::Modular<double, double> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::Element_ptr, unsigned long)'\n/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313:(.text+0x35d9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `Givaro::Modular<double, double>::Element_ptr FFLAS::fgemm<Givaro::Modular<double, double> >(Givaro::Modular<double, double> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::Element_ptr, unsigned long)'\n/home/embray/src/sagemath/sage/local/lib/liblinboxsage.a(linbox-sage.o): In function `float* linbox_modn_dense_matrix_matrix_multiply<float>(float, float*, float*, float*, unsigned long, unsigned long, unsigned long)':\n/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313: undefined reference to `Givaro::Modular<float, float>::Element_ptr FFLAS::fgemm<Givaro::Modular<float, float> >(Givaro::Modular<float, float> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<float, float>::Element, Givaro::Modular<float, float>::ConstElement_ptr, unsigned long, Givaro::Modular<float, float>::ConstElement_ptr, unsigned long, Givaro::Modular<float, float>::Element, Givaro::Modular<float, float>::Element_ptr, unsigned long)'\n...\n```\n\n\nfollowed by dozens of similar errors.  There's nothing strange in the build logs for any of fflas-ffpack, givaro, or linbox themselves.  GCC is 5.4.0.  Any ideas?  I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.",
    "created_at": "2016-09-23T09:44:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232232",
    "user": "embray"
}
```

This seems to have broken my Cygwin build in 7.4beta5 (at least).  It fails during build of sagelib itself, linking one of the Cython modules:


```
$ g++ -shared -Wl,--enable-auto-image-base -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib build/temp.cygwin-2.5.1-x86_64-2.7/home/embray/src/sagemath/sage/src/build/cythonized/sage/libs/linbox/linbox.o -L/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local//lib -L/home/embray/src/sagemath/sage/local/lib/python2.7/config -L/home/embray/src/sagemath/sage/local/lib -lfflas -llinboxsage -lffpack -lblas -liml -llinbox -lntl -lgivaro -lflint -lflint -lfplll -lmpfr -lgmp -lgmp -lgmpxx -lstdc++ -lpython2.7 -o build/lib.cygwin-2.5.1-x86_64-2.7/sage/libs/linbox/linbox.dll
/home/embray/src/sagemath/sage/local/lib/liblinboxsage.a(linbox-sage.o): In function `double* linbox_modn_dense_matrix_matrix_multiply<double>(double, double*, double*, double*, unsigned long, unsigned long, unsigned long)':
/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313: undefined reference to `Givaro::Modular<double, double>::Element_ptr FFLAS::fgemm<Givaro::Modular<double, double> >(Givaro::Modular<double, double> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::Element_ptr, unsigned long)'
/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313:(.text+0x35d9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `Givaro::Modular<double, double>::Element_ptr FFLAS::fgemm<Givaro::Modular<double, double> >(Givaro::Modular<double, double> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::ConstElement_ptr, unsigned long, Givaro::Modular<double, double>::Element, Givaro::Modular<double, double>::Element_ptr, unsigned long)'
/home/embray/src/sagemath/sage/local/lib/liblinboxsage.a(linbox-sage.o): In function `float* linbox_modn_dense_matrix_matrix_multiply<float>(float, float*, float*, float*, unsigned long, unsigned long, unsigned long)':
/home/embray/src/sagemath/sage/local/var/tmp/sage/build/linbox-1.4.2/src/interfaces/sage/linbox-sage.C:313: undefined reference to `Givaro::Modular<float, float>::Element_ptr FFLAS::fgemm<Givaro::Modular<float, float> >(Givaro::Modular<float, float> const&, FFLAS::FFLAS_TRANSPOSE, FFLAS::FFLAS_TRANSPOSE, unsigned long, unsigned long, unsigned long, Givaro::Modular<float, float>::Element, Givaro::Modular<float, float>::ConstElement_ptr, unsigned long, Givaro::Modular<float, float>::ConstElement_ptr, unsigned long, Givaro::Modular<float, float>::Element, Givaro::Modular<float, float>::Element_ptr, unsigned long)'
...
```


followed by dozens of similar errors.  There's nothing strange in the build logs for any of fflas-ffpack, givaro, or linbox themselves.  GCC is 5.4.0.  Any ideas?  I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.



---

archive/issue_comments_232233.json:
```json
{
    "body": "Replying to [comment:239 embray]:\n> I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.\n\nYep, in fact switching the order to `-llinboxsage -lfflas` seems to have fixed it.",
    "created_at": "2016-09-23T10:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232233",
    "user": "embray"
}
```

Replying to [comment:239 embray]:
> I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.

Yep, in fact switching the order to `-llinboxsage -lfflas` seems to have fixed it.



---

archive/issue_comments_232234.json:
```json
{
    "body": "Seemingly also related to this ticket is this mess\n\n\n```\ngcc -I/usr/include/ncurses -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/cysignals -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include/python2.7 -I/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/embray/src/sagemath/sage/src -I/home/embray/src/sagemath/sage/src/sage/ext -I/home/embray/src/sagemath/sage/src/build/cythonized -I/home/embray/src/sagemath/sage/src/build/cythonized/sage/ext -I/home/embray/src/sagemath/sage/local/include/python2.7 -c /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp -o build/temp.cygwin-2.5.1-x86_64-2.7/home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -fabi-version=6 -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include/linbox -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -fabi-version=6 -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -D_XPG6 -fno-strict-aliasing\nIn file included from /home/embray/src/sagemath/sage/local/include/flint/flint.h:46:0,\n                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:497:\n/home/embray/src/sagemath/sage/local/include/flint/longlong.h:45:0: warning: \"add_ssaaaa\" redefined\n #define add_ssaaaa(sh, sl, ah, al, bh, bl)                 \\\n ^\nIn file included from /home/embray/src/sagemath/sage/local/include/recint/recdefine.h:145:0,\n                 from /home/embray/src/sagemath/sage/local/include/recint/ruruint.h:43,\n                 from /home/embray/src/sagemath/sage/local/include/recint/rumanip.h:41,\n                 from /home/embray/src/sagemath/sage/local/include/recint/ruconvert.h:43,\n                 from /home/embray/src/sagemath/sage/local/include/gmp++/gmp++_int.h:26,\n                 from /home/embray/src/sagemath/sage/local/include/gmp++/gmp++.h:56,\n                 from /home/embray/src/sagemath/sage/local/include/givaro/givinteger.h:19,\n                 from /home/embray/src/sagemath/sage/local/include/givaro/modular-int8.h:29,\n                 from /home/embray/src/sagemath/sage/local/include/givaro/modular.h:21,\n                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:490:\n/home/embray/src/sagemath/sage/local/include/recint/reclonglong.h:1906:0: note: this is the location of the previous definition\n #define add_ssaaaa(sh, sl, ah, al, bh, bl) \\\n ^\nIn file included from /home/embray/src/sagemath/sage/local/include/flint/flint.h:46:0,\n                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:497:\n```\n\n...\n\n```\nIn file included from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.h:98:0,\n                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm.h:45,\n                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_fgemm/fgemm_classical.inl:43,\n                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_fgemm.inl:440,\n                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas.h:109,\n                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/ffpack/ffpack.h:46,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/blas-matrix-domain.h:45,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrix-domain.h:68,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/transpose-matrix.h:47,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/matrix-domain.inl:34,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/matrix-domain.h:1233,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/densematrix/blas-matrix.h:55,\n                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/dense-matrix.h:79,\n                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:491:\n/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.inl:154:4: error: \u2018B1\u2019 was not declared in this scope\n    B1 = simd::load( blB+1*StepB);\n    ^\n/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.inl:155:27: error: no matching function for call to \u2018Simd256_impl<true, true, true, 8>::fmaddxin(vect_t&, vect_t&, int)\u2019\n    simd::fmaddxin(C0,A0,B0);\n                           ^\n```\n\nwith many similar errors following.",
    "created_at": "2016-09-23T10:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232234",
    "user": "embray"
}
```

Seemingly also related to this ticket is this mess


```
gcc -I/usr/include/ncurses -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/cysignals -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local/include/python2.7 -I/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/embray/src/sagemath/sage/src -I/home/embray/src/sagemath/sage/src/sage/ext -I/home/embray/src/sagemath/sage/src/build/cythonized -I/home/embray/src/sagemath/sage/src/build/cythonized/sage/ext -I/home/embray/src/sagemath/sage/local/include/python2.7 -c /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp -o build/temp.cygwin-2.5.1-x86_64-2.7/home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -fabi-version=6 -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include/linbox -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -fabi-version=6 -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -mbmi -mbmi2 -mfpmath=sse -fabi-version=6 -I/home/embray/src/sagemath/sage/local/include -I/home/embray/src/sagemath/sage/local//include -I/home/embray/src/sagemath/sage/local/include -D_XPG6 -fno-strict-aliasing
In file included from /home/embray/src/sagemath/sage/local/include/flint/flint.h:46:0,
                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:497:
/home/embray/src/sagemath/sage/local/include/flint/longlong.h:45:0: warning: "add_ssaaaa" redefined
 #define add_ssaaaa(sh, sl, ah, al, bh, bl)                 \
 ^
In file included from /home/embray/src/sagemath/sage/local/include/recint/recdefine.h:145:0,
                 from /home/embray/src/sagemath/sage/local/include/recint/ruruint.h:43,
                 from /home/embray/src/sagemath/sage/local/include/recint/rumanip.h:41,
                 from /home/embray/src/sagemath/sage/local/include/recint/ruconvert.h:43,
                 from /home/embray/src/sagemath/sage/local/include/gmp++/gmp++_int.h:26,
                 from /home/embray/src/sagemath/sage/local/include/gmp++/gmp++.h:56,
                 from /home/embray/src/sagemath/sage/local/include/givaro/givinteger.h:19,
                 from /home/embray/src/sagemath/sage/local/include/givaro/modular-int8.h:29,
                 from /home/embray/src/sagemath/sage/local/include/givaro/modular.h:21,
                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:490:
/home/embray/src/sagemath/sage/local/include/recint/reclonglong.h:1906:0: note: this is the location of the previous definition
 #define add_ssaaaa(sh, sl, ah, al, bh, bl) \
 ^
In file included from /home/embray/src/sagemath/sage/local/include/flint/flint.h:46:0,
                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:497:
```

...

```
In file included from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.h:98:0,
                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm.h:45,
                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_fgemm/fgemm_classical.inl:43,
                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_fgemm.inl:440,
                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas.h:109,
                 from /home/embray/src/sagemath/sage/local/include/fflas-ffpack/ffpack/ffpack.h:46,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/blas-matrix-domain.h:45,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrix-domain.h:68,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/transpose-matrix.h:47,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/matrix-domain.inl:34,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/matrixdomain/matrix-domain.h:1233,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/densematrix/blas-matrix.h:55,
                 from /home/embray/src/sagemath/sage/local/include/linbox/matrix/dense-matrix.h:79,
                 from /home/embray/src/sagemath/sage/src/build/cythonized/sage/matrix/matrix_modn_dense_double.cpp:491:
/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.inl:154:4: error: ‘B1’ was not declared in this scope
    B1 = simd::load( blB+1*StepB);
    ^
/home/embray/src/sagemath/sage/local/include/fflas-ffpack/fflas/fflas_igemm/igemm_kernels.inl:155:27: error: no matching function for call to ‘Simd256_impl<true, true, true, 8>::fmaddxin(vect_t&, vect_t&, int)’
    simd::fmaddxin(C0,A0,B0);
                           ^
```

with many similar errors following.



---

archive/issue_comments_232235.json:
```json
{
    "body": "It seems to me that most of the problems I'm having are due to the reliance on `#distutils:` flags in the Cython, which are not being collated intelligently enough...",
    "created_at": "2016-09-23T10:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232235",
    "user": "embray"
}
```

It seems to me that most of the problems I'm having are due to the reliance on `#distutils:` flags in the Cython, which are not being collated intelligently enough...



---

archive/issue_comments_232236.json:
```json
{
    "body": "Replying to [comment:240 embray]:\n> Replying to [comment:239 embray]:\n> > I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.\n> \n> Yep, in fact switching the order to `-llinboxsage -lfflas` seems to have fixed it.\n\nSee the `library_order_list` variable in `src/module_list.py`",
    "created_at": "2016-09-23T11:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232236",
    "user": "jdemeyer"
}
```

Replying to [comment:240 embray]:
> Replying to [comment:239 embray]:
> > I'm guessing maybe linker flag order, which can be more sensitive on Windows--not sure though.
> 
> Yep, in fact switching the order to `-llinboxsage -lfflas` seems to have fixed it.

See the `library_order_list` variable in `src/module_list.py`



---

archive/issue_comments_232237.json:
```json
{
    "body": "Replying to [comment:242 embray]:\n> It seems to me that most of the problems I'm having are due to the reliance on `#distutils:` flags in the Cython, which are not being collated intelligently enough...\n\nIf you have more details, I could try to help with that.",
    "created_at": "2016-09-23T11:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232237",
    "user": "jdemeyer"
}
```

Replying to [comment:242 embray]:
> It seems to me that most of the problems I'm having are due to the reliance on `#distutils:` flags in the Cython, which are not being collated intelligently enough...

If you have more details, I could try to help with that.



---

archive/issue_comments_232238.json:
```json
{
    "body": "Just to be clear: you are using the same version of Cython as vanilla Sage, right?",
    "created_at": "2016-09-23T11:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232238",
    "user": "jdemeyer"
}
```

Just to be clear: you are using the same version of Cython as vanilla Sage, right?



---

archive/issue_comments_232239.json:
```json
{
    "body": "I'm not sure it's coming from `library_order_list`.  For example linbox.cpp contains:\n\n\n```\n        \"libraries\": [\n            \"fflas\",\n            \"linboxsage\",\n            \"ffpack\",\n            \"blas\",\n            \"iml\",\n            \"gmpxx\",\n            \"linbox\",\n            \"flint\",\n            \"ntl\",\n            \"fplll\",\n            \"gmp\",\n            \"givaro\",\n            \"mpfr\",\n            \"flint\",\n            \"gmp\"\n        ],\n```\n\n\nThis does not reflect what's in `library_order_list` at all.",
    "created_at": "2016-09-23T11:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232239",
    "user": "embray"
}
```

I'm not sure it's coming from `library_order_list`.  For example linbox.cpp contains:


```
        "libraries": [
            "fflas",
            "linboxsage",
            "ffpack",
            "blas",
            "iml",
            "gmpxx",
            "linbox",
            "flint",
            "ntl",
            "fplll",
            "gmp",
            "givaro",
            "mpfr",
            "flint",
            "gmp"
        ],
```


This does not reflect what's in `library_order_list` at all.



---

archive/issue_comments_232240.json:
```json
{
    "body": "Replying to [comment:245 jdemeyer]:\n> Just to be clear: you are using the same version of Cython as vanilla Sage, right?\n\nYes, this is after a fresh build following `make maintainer-clean`.",
    "created_at": "2016-09-23T11:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232240",
    "user": "embray"
}
```

Replying to [comment:245 jdemeyer]:
> Just to be clear: you are using the same version of Cython as vanilla Sage, right?

Yes, this is after a fresh build following `make maintainer-clean`.



---

archive/issue_comments_232241.json:
```json
{
    "body": "Replying to [comment:246 embray]:\n> I'm not sure it's coming from `library_order_list`.  For example linbox.cpp contains:\n> \n> {{{\n>         \"libraries\": [\n>             \"fflas\",\n>             \"linboxsage\",\n>             \"ffpack\",\n>             \"blas\",\n>             \"iml\",\n>             \"gmpxx\",\n>             \"linbox\",\n>             \"flint\",\n>             \"ntl\",\n>             \"fplll\",\n>             \"gmp\",\n>             \"givaro\",\n>             \"mpfr\",\n>             \"flint\",\n>             \"gmp\"\n>         ],\n> }}}\n> \n> This does not reflect what's in `library_order_list` at all.\n\nThat's because the library order is changed *after* that metadata is written to the `.cpp` file. If you want to check the real library order, look at the `gcc` command line.",
    "created_at": "2016-09-23T11:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232241",
    "user": "jdemeyer"
}
```

Replying to [comment:246 embray]:
> I'm not sure it's coming from `library_order_list`.  For example linbox.cpp contains:
> 
> {{{
>         "libraries": [
>             "fflas",
>             "linboxsage",
>             "ffpack",
>             "blas",
>             "iml",
>             "gmpxx",
>             "linbox",
>             "flint",
>             "ntl",
>             "fplll",
>             "gmp",
>             "givaro",
>             "mpfr",
>             "flint",
>             "gmp"
>         ],
> }}}
> 
> This does not reflect what's in `library_order_list` at all.

That's because the library order is changed *after* that metadata is written to the `.cpp` file. If you want to check the real library order, look at the `gcc` command line.



---

archive/issue_comments_232242.json:
```json
{
    "body": "See also https://github.com/cython/cython/pull/466",
    "created_at": "2016-09-23T11:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232242",
    "user": "jdemeyer"
}
```

See also https://github.com/cython/cython/pull/466



---

archive/issue_comments_232243.json:
```json
{
    "body": "~~If you look above you'll see that what's in the list I quoted above *is* what's in the gcc command line, so no the library order is not being changed.~~\n\nActually I'm wrong, it's not exactly the same.  But the order it's ending up in is not the same as `library_order_list` would give either.",
    "created_at": "2016-09-23T12:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232243",
    "user": "embray"
}
```

~~If you look above you'll see that what's in the list I quoted above *is* what's in the gcc command line, so no the library order is not being changed.~~

Actually I'm wrong, it's not exactly the same.  But the order it's ending up in is not the same as `library_order_list` would give either.



---

archive/issue_comments_232244.json:
```json
{
    "body": "In https://github.com/cython/cython/pull/412 you wrote\n\n> The whole point of this pull request is that I don't want to list all libraries in setup.py. That is a mess to maintain.\n\nI completely agree there.  But I don't know if using the metadata in Cython files is the best way either.  That works fine for projects where you have a few small files.  And I agree the json metadata is useful for debugging.  But ultimately I think defining hand-written Extension instances is the most explicit and understandable way to go.  That doesn't mean they all have to be dumped into one big file as in `module_list.py`.\n\nOther projects manage this differently.  For example Numpy has a \"setup.py\" for each subpackage that defines build instructions for modules in that package.  Similarly subpackages in Astropy can have a [setup_package.py](http://docs.astropy.org/en/stable/development/building.html?highlight=setup_package.py#customizing-setup-build-for-subpackages) for information about how to build that package, which is reasonably well documented.  Those are just two examples, not saying that Sage needs to follow suit.  Just that I don't know that Cython can always be smart enough here on its own.\n\nAnyways, I'm straying off topic.",
    "created_at": "2016-09-23T12:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232244",
    "user": "embray"
}
```

In https://github.com/cython/cython/pull/412 you wrote

> The whole point of this pull request is that I don't want to list all libraries in setup.py. That is a mess to maintain.

I completely agree there.  But I don't know if using the metadata in Cython files is the best way either.  That works fine for projects where you have a few small files.  And I agree the json metadata is useful for debugging.  But ultimately I think defining hand-written Extension instances is the most explicit and understandable way to go.  That doesn't mean they all have to be dumped into one big file as in `module_list.py`.

Other projects manage this differently.  For example Numpy has a "setup.py" for each subpackage that defines build instructions for modules in that package.  Similarly subpackages in Astropy can have a [setup_package.py](http://docs.astropy.org/en/stable/development/building.html?highlight=setup_package.py#customizing-setup-build-for-subpackages) for information about how to build that package, which is reasonably well documented.  Those are just two examples, not saying that Sage needs to follow suit.  Just that I don't know that Cython can always be smart enough here on its own.

Anyways, I'm straying off topic.



---

archive/issue_comments_232245.json:
```json
{
    "body": "Here's an example of one of the more non-trivial setup_package.py's from astropy: https://github.com/astropy/astropy/blob/master/astropy/_erfa/setup_package.py\n\nAnother feature I added to it not long ago is pre-/post-command hooks, so each subpackage can perform their own special steps before or after specific `./setup.py` commands.  This would be useful, for example, for the stuff in `sage_setup.autogen`--autogenerated the needed Python modules at the appropriate build step; no reliance on a makefile.",
    "created_at": "2016-09-23T13:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232245",
    "user": "embray"
}
```

Here's an example of one of the more non-trivial setup_package.py's from astropy: https://github.com/astropy/astropy/blob/master/astropy/_erfa/setup_package.py

Another feature I added to it not long ago is pre-/post-command hooks, so each subpackage can perform their own special steps before or after specific `./setup.py` commands.  This would be useful, for example, for the stuff in `sage_setup.autogen`--autogenerated the needed Python modules at the appropriate build step; no reliance on a makefile.



---

archive/issue_comments_232246.json:
```json
{
    "body": "~~Anyways, adding `fflas_ffpack_libraries` to `library_order_list` in the appropriate spot seems to have fixed all my woes for now so I will open a new ticket with that fix--thanks jdemeyer for the tip-off on that even if I was confused by it at first.~~\n\nI spoke too soon--my build is still just \"cythonizing\" the files; it didn't compile them yet.\n\nI will open a separate ticket for further discussion on how Sage manages its extension configurations.",
    "created_at": "2016-09-23T13:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232246",
    "user": "embray"
}
```

~~Anyways, adding `fflas_ffpack_libraries` to `library_order_list` in the appropriate spot seems to have fixed all my woes for now so I will open a new ticket with that fix--thanks jdemeyer for the tip-off on that even if I was confused by it at first.~~

I spoke too soon--my build is still just "cythonizing" the files; it didn't compile them yet.

I will open a separate ticket for further discussion on how Sage manages its extension configurations.



---

archive/issue_comments_232247.json:
```json
{
    "body": "Replying to [comment:253 embray]:\n> ~~Anyways, adding `fflas_ffpack_libraries` to `library_order_list` in the appropriate spot seems to have fixed all my woes for now so I will open a new ticket with that fix--thanks jdemeyer for the tip-off on that even if I was confused by it at first.~~\n> \n> I spoke too soon--my build is still just \"cythonizing\" the files; it didn't compile them yet.\n\nUpdating `library_order_list` fixed my first issue (with linking `sage.libs.linbox.linbox`) but not the second issue.",
    "created_at": "2016-09-23T14:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232247",
    "user": "embray"
}
```

Replying to [comment:253 embray]:
> ~~Anyways, adding `fflas_ffpack_libraries` to `library_order_list` in the appropriate spot seems to have fixed all my woes for now so I will open a new ticket with that fix--thanks jdemeyer for the tip-off on that even if I was confused by it at first.~~
> 
> I spoke too soon--my build is still just "cythonizing" the files; it didn't compile them yet.

Updating `library_order_list` fixed my first issue (with linking `sage.libs.linbox.linbox`) but not the second issue.



---

archive/issue_comments_232248.json:
```json
{
    "body": "Replying to [comment:254 embray]:\n> Updating `library_order_list` fixed my first issue\n\nMaybe you can create a ticket just with this fix.",
    "created_at": "2016-09-26T13:13:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17398#issuecomment-232248",
    "user": "jdemeyer"
}
```

Replying to [comment:254 embray]:
> Updating `library_order_list` fixed my first issue

Maybe you can create a ticket just with this fix.
