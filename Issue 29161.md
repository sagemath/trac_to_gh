# Issue 29161: cygwin: Accept system BLAS

archive/issues_029161.json:
```json
{
    "body": "CC:  dimpase embray isuruf arojas fbissey vbraun\n\nAs noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided\n\nFrom http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:\n\n  2) No devel package is provided as liblapack-devel already provide the needed headers and import. Openblas is fully compatible with Netlib BLAS.\n\n  3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS\n\nIssue created by migration from https://trac.sagemath.org/ticket/29398\n\n",
    "created_at": "2020-03-24T02:04:24Z",
    "labels": [
        "build: configure",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "cygwin: Accept system BLAS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29161",
    "user": "mkoeppe"
}
```
CC:  dimpase embray isuruf arojas fbissey vbraun

As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided

From http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:

  2) No devel package is provided as liblapack-devel already provide the needed headers and import. Openblas is fully compatible with Netlib BLAS.

  3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS

Issue created by migration from https://trac.sagemath.org/ticket/29398





---

archive/issue_comments_412828.json:
```json
{
    "body": "Should we accept any system BLAS (blas+cblas+lapack) on cygwin, or test whether it's provided by openblas, for example by testing for `openblas_get_config` (https://github.com/xianyi/OpenBLAS/wiki/OpenBLAS-Extensions)?",
    "created_at": "2020-03-24T02:05:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412828",
    "user": "mkoeppe"
}
```

Should we accept any system BLAS (blas+cblas+lapack) on cygwin, or test whether it's provided by openblas, for example by testing for `openblas_get_config` (https://github.com/xianyi/OpenBLAS/wiki/OpenBLAS-Extensions)?



---

archive/issue_comments_412829.json:
```json
{
    "body": "if we use openblas we would need to generate missing openblas.pc\n(same problem on fedora)\n\nbuild/pkgs/openblas has a python script for this purpose, by the way.\n\nwe should ask cygwin maintainers to fix the install and provide pc file.",
    "created_at": "2020-03-24T02:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412829",
    "user": "dimpase"
}
```

if we use openblas we would need to generate missing openblas.pc
(same problem on fedora)

build/pkgs/openblas has a python script for this purpose, by the way.

we should ask cygwin maintainers to fix the install and provide pc file.



---

archive/issue_comments_412830.json:
```json
{
    "body": "which of our packages depends specifically on openblas.pc?",
    "created_at": "2020-03-24T02:40:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412830",
    "user": "mkoeppe"
}
```

which of our packages depends specifically on openblas.pc?



---

archive/issue_comments_412831.json:
```json
{
    "body": "Replying to [comment:2 dimpase]:\n> build/pkgs/openblas has a python script for this purpose, by the way.\n\nwrite_pc_file.py seems to do the opposite direction -- it writes blas.pc, cblas.pc, lapack.pc. Cygwin already has those",
    "created_at": "2020-03-24T02:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412831",
    "user": "mkoeppe"
}
```

Replying to [comment:2 dimpase]:
> build/pkgs/openblas has a python script for this purpose, by the way.

write_pc_file.py seems to do the opposite direction -- it writes blas.pc, cblas.pc, lapack.pc. Cygwin already has those



---

archive/issue_comments_412832.json:
```json
{
    "body": "Replying to [comment:3 mkoeppe]:\n> which of our packages depends specifically on openblas.pc?\n\nI meant, openblas.pc may be used by our spkg-configure for openblas. Otherwise it is not needed.",
    "created_at": "2020-03-24T02:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412832",
    "user": "dimpase"
}
```

Replying to [comment:3 mkoeppe]:
> which of our packages depends specifically on openblas.pc?

I meant, openblas.pc may be used by our spkg-configure for openblas. Otherwise it is not needed.



---

archive/issue_comments_412833.json:
```json
{
    "body": "Yes, that's the problem.",
    "created_at": "2020-03-24T02:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412833",
    "user": "mkoeppe"
}
```

Yes, that's the problem.



---

archive/issue_comments_412834.json:
```json
{
    "body": "is this on top of a not yet merged ticket?\nPlease list it in Dependencies.\n\nAlso, what are these OPENBLAS_* variables?\n----\nNew commits:",
    "created_at": "2020-03-24T03:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412834",
    "user": "dimpase"
}
```

is this on top of a not yet merged ticket?
Please list it in Dependencies.

Also, what are these OPENBLAS_* variables?
----
New commits:



---

archive/issue_comments_412835.json:
```json
{
    "body": "Not ready for review yet.\n\nOPENBLAS_* is created by the pkgconfig macro",
    "created_at": "2020-03-24T03:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412835",
    "user": "mkoeppe"
}
```

Not ready for review yet.

OPENBLAS_* is created by the pkgconfig macro



---

archive/issue_comments_412836.json:
```json
{
    "body": "And \"of course\" it does not work at all as advertised on cygwin.",
    "created_at": "2020-03-24T04:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412836",
    "user": "mkoeppe"
}
```

And "of course" it does not work at all as advertised on cygwin.



---

archive/issue_comments_412837.json:
```json
{
    "body": "cblas.pc refers to a non-existent library \"-lcblas\"...",
    "created_at": "2020-03-24T04:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412837",
    "user": "mkoeppe"
}
```

cblas.pc refers to a non-existent library "-lcblas"...



---

archive/issue_comments_412838.json:
```json
{
    "body": "we can resort to shipping platform-dependent openblas.pc\n\nor, indeed, generate it.",
    "created_at": "2020-03-24T04:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412838",
    "user": "dimpase"
}
```

we can resort to shipping platform-dependent openblas.pc

or, indeed, generate it.



---

archive/issue_comments_412839.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-24T19:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412839",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_412840.json:
```json
{
    "body": "This is a version that works for cygwin (at least configure finds blas now).\nBut it is not really checking that the implementation is provided by openblas. It seems that functions such as `openblas_get_config` are not accessible.",
    "created_at": "2020-03-24T19:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412840",
    "user": "mkoeppe"
}
```

This is a version that works for cygwin (at least configure finds blas now).
But it is not really checking that the implementation is provided by openblas. It seems that functions such as `openblas_get_config` are not accessible.



---

archive/issue_comments_412841.json:
```json
{
    "body": "`gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`",
    "created_at": "2020-03-25T00:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412841",
    "user": "mkoeppe"
}
```

`gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`



---

archive/issue_comments_412842.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-25T01:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412842",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_412843.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-25T01:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412843",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_412844.json:
```json
{
    "body": "Replying to [comment:16 mkoeppe]:\n> `gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`\n\nOr, rather, we should be generating cblas.pc",
    "created_at": "2020-03-25T01:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412844",
    "user": "mkoeppe"
}
```

Replying to [comment:16 mkoeppe]:
> `gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`

Or, rather, we should be generating cblas.pc



---

archive/issue_comments_412845.json:
```json
{
    "body": "Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).",
    "created_at": "2020-03-25T01:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412845",
    "user": "mkoeppe"
}
```

Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).



---

archive/issue_comments_412846.json:
```json
{
    "body": "generating *.pc files is a bit unpleasant, I did it on #28906 - I suppose one can borrow the relevant macros there (finind the absolute patch to the library was the most tricky part)",
    "created_at": "2020-03-25T02:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412846",
    "user": "dimpase"
}
```

generating *.pc files is a bit unpleasant, I did it on #28906 - I suppose one can borrow the relevant macros there (finind the absolute patch to the library was the most tricky part)



---

archive/issue_comments_412847.json:
```json
{
    "body": "I don't think one needs an absolute path at all in this situation.",
    "created_at": "2020-03-25T02:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412847",
    "user": "mkoeppe"
}
```

I don't think one needs an absolute path at all in this situation.



---

archive/issue_comments_412848.json:
```json
{
    "body": "well, that's what you have in *.pc files, absolute paths, I don't really know why.",
    "created_at": "2020-03-25T02:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412848",
    "user": "dimpase"
}
```

well, that's what you have in *.pc files, absolute paths, I don't really know why.



---

archive/issue_comments_412849.json:
```json
{
    "body": "To my understanding, the variables at the top of the .pc files such as `prefix`, `includedir` are there only by convention and to make relocation easier. The only thing that matters is `Libs:` and `Cflags`",
    "created_at": "2020-03-25T02:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412849",
    "user": "mkoeppe"
}
```

To my understanding, the variables at the top of the .pc files such as `prefix`, `includedir` are there only by convention and to make relocation easier. The only thing that matters is `Libs:` and `Cflags`



---

archive/issue_comments_412850.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-03-29T02:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412850",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_412851.json:
```json
{
    "body": "Rebased on 9.1.beta9",
    "created_at": "2020-03-29T02:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412851",
    "user": "mkoeppe"
}
```

Rebased on 9.1.beta9



---

archive/issue_comments_412852.json:
```json
{
    "body": "Replying to [comment:22 mkoeppe]:\n> Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).\n\nHelp with this would be welcome...",
    "created_at": "2020-03-29T14:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412852",
    "user": "mkoeppe"
}
```

Replying to [comment:22 mkoeppe]:
> Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).

Help with this would be welcome...



---

archive/issue_comments_412853.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-04-01T03:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412853",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_412854.json:
```json
{
    "body": "This seems to work. It falls back to using AC_SEARCH_LIBS, and then constructs a minimal openblas.pc.\n\nBut I think this needs some extra checks -- otherwise this would accept just about any BLAS in the system and pretend it's openblas.",
    "created_at": "2020-04-01T03:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412854",
    "user": "mkoeppe"
}
```

This seems to work. It falls back to using AC_SEARCH_LIBS, and then constructs a minimal openblas.pc.

But I think this needs some extra checks -- otherwise this would accept just about any BLAS in the system and pretend it's openblas.



---

archive/issue_comments_412855.json:
```json
{
    "body": "would it also work on Fedora (which doesn't install openblas.pc)?",
    "created_at": "2020-04-01T03:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412855",
    "user": "dimpase"
}
```

would it also work on Fedora (which doesn't install openblas.pc)?



---

archive/issue_comments_412856.json:
```json
{
    "body": "I would hope so, but haven't tested yet.",
    "created_at": "2020-04-01T03:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412856",
    "user": "mkoeppe"
}
```

I would hope so, but haven't tested yet.



---

archive/issue_comments_412857.json:
```json
{
    "body": "Tests at https://github.com/mkoeppe/sage/actions/runs/67915244 and https://github.com/mkoeppe/sage/actions/runs/67915245",
    "created_at": "2020-04-01T03:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412857",
    "user": "mkoeppe"
}
```

Tests at https://github.com/mkoeppe/sage/actions/runs/67915244 and https://github.com/mkoeppe/sage/actions/runs/67915245



---

archive/issue_comments_412858.json:
```json
{
    "body": "For checking whether a system blas on Linux is actually openblas, we can use a function test for openblas_get_config.\n\nOn Cygwin, I don't know a better solution than to do `strings $(which cygblas-0.dll) | grep openblas` to distinguish the good openblas from the bad generic blas.",
    "created_at": "2020-04-01T03:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412858",
    "user": "mkoeppe"
}
```

For checking whether a system blas on Linux is actually openblas, we can use a function test for openblas_get_config.

On Cygwin, I don't know a better solution than to do `strings $(which cygblas-0.dll) | grep openblas` to distinguish the good openblas from the bad generic blas.



---

archive/issue_comments_412859.json:
```json
{
    "body": "Do you mean that on Cygwin they don't have `openblas_get_config` even for \"real\" openblas? This is a bug...",
    "created_at": "2020-04-01T04:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412859",
    "user": "dimpase"
}
```

Do you mean that on Cygwin they don't have `openblas_get_config` even for "real" openblas? This is a bug...



---

archive/issue_comments_412860.json:
```json
{
    "body": "They only use openblas as a drop-in binary-compatible replacement for blas/cblas.",
    "created_at": "2020-04-01T04:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412860",
    "user": "mkoeppe"
}
```

They only use openblas as a drop-in binary-compatible replacement for blas/cblas.



---

archive/issue_comments_412861.json:
```json
{
    "body": "if it's cygwin-specific, maybe it's easier to call `cygcheck -c openblas` ?",
    "created_at": "2020-04-01T04:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412861",
    "user": "dimpase"
}
```

if it's cygwin-specific, maybe it's easier to call `cygcheck -c openblas` ?



---

archive/issue_comments_412862.json:
```json
{
    "body": "That wouldn't give the correct answer when users change the PATH from the default one, so that the generic blas dll wins",
    "created_at": "2020-04-01T04:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412862",
    "user": "mkoeppe"
}
```

That wouldn't give the correct answer when users change the PATH from the default one, so that the generic blas dll wins



---

archive/issue_comments_412863.json:
```json
{
    "body": "Fedora seems to work too - https://github.com/mkoeppe/sage/runs/550765309",
    "created_at": "2020-04-01T12:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412863",
    "user": "mkoeppe"
}
```

Fedora seems to work too - https://github.com/mkoeppe/sage/runs/550765309



---

archive/issue_comments_412864.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-02T04:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412864",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_412865.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-02T04:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412865",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_412866.json:
```json
{
    "body": "lgtm",
    "created_at": "2020-04-02T06:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412866",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_412867.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-02T06:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412867",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_412868.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-04-02T12:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412868",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_412869.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-04-02T12:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412869",
    "user": "mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_412870.json:
```json
{
    "body": "I guess I should remove my debugging code that disables pkgconfig detection from this!",
    "created_at": "2020-04-02T12:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412870",
    "user": "mkoeppe"
}
```

I guess I should remove my debugging code that disables pkgconfig detection from this!



---

archive/issue_comments_412871.json:
```json
{
    "body": "With the pkgconfig-based detection disabled, on `debian-buster-standard` (https://github.com/mkoeppe/sage/runs/553984061) one sees the following:\n\n```\n       self._backend.solve()\n      File \"sage/numerical/backends/cvxopt_sdp_backend.pyx\", line 369, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:4838)\n        from cvxopt import matrix as c_matrix, solvers\n      File \"/sage/local/lib/python3.7/site-packages/cvxopt/__init__.py\", line 279, in <module>\n        from cvxopt import solvers, blas, lapack\n    ImportError: /sage/local/lib/python3.7/site-packages/cvxopt/blas.cpython-37m-x86_64-linux-gnu.so: undefined symbol: dtrsm_\n```\n",
    "created_at": "2020-04-02T12:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412871",
    "user": "mkoeppe"
}
```

With the pkgconfig-based detection disabled, on `debian-buster-standard` (https://github.com/mkoeppe/sage/runs/553984061) one sees the following:

```
       self._backend.solve()
      File "sage/numerical/backends/cvxopt_sdp_backend.pyx", line 369, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:4838)
        from cvxopt import matrix as c_matrix, solvers
      File "/sage/local/lib/python3.7/site-packages/cvxopt/__init__.py", line 279, in <module>
        from cvxopt import solvers, blas, lapack
    ImportError: /sage/local/lib/python3.7/site-packages/cvxopt/blas.cpython-37m-x86_64-linux-gnu.so: undefined symbol: dtrsm_
```




---

archive/issue_comments_412872.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-02T12:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412872",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_412873.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-04-02T12:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412873",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_412874.json:
```json
{
    "body": "Replying to [comment:52 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[0cda07c](https://git.sagemath.org/sage.git/commit/?id=0cda07c33fe26f035377c57c8982f3e2ea8da85d)||`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`||\n\noops, I missed this.",
    "created_at": "2020-04-02T15:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412874",
    "user": "dimpase"
}
```

Replying to [comment:52 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[0cda07c](https://git.sagemath.org/sage.git/commit/?id=0cda07c33fe26f035377c57c8982f3e2ea8da85d)||`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`||

oops, I missed this.



---

archive/issue_comments_412875.json:
```json
{
    "body": "Fixed `debian-buster-standard`: https://github.com/mkoeppe/sage/runs/554994789",
    "created_at": "2020-04-02T16:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412875",
    "user": "mkoeppe"
}
```

Fixed `debian-buster-standard`: https://github.com/mkoeppe/sage/runs/554994789



---

archive/issue_comments_412876.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-02T16:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412876",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_412877.json:
```json
{
    "body": "OK, looks good.\nBy the way (offtopic), why do we see this\n\n```\n2020-04-02T16:07:07.4502918Z **********************************************************************\n2020-04-02T16:07:07.4503012Z File \"src/sage/tests/cmdline.py\", line 600, in sage.tests.cmdline.test_executable\n2020-04-02T16:07:07.4503087Z Failed example:\n2020-04-02T16:07:07.4503167Z     err\n2020-04-02T16:07:07.4503245Z Expected:\n2020-04-02T16:07:07.4503440Z     ''\n2020-04-02T16:07:07.4503502Z Got:\n2020-04-02T16:07:07.4503715Z     '/sage/src/bin/sage: line 564: exec: sqlite3: not found\\n'\n```\n\nis it by design?",
    "created_at": "2020-04-02T16:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412877",
    "user": "dimpase"
}
```

OK, looks good.
By the way (offtopic), why do we see this

```
2020-04-02T16:07:07.4502918Z **********************************************************************
2020-04-02T16:07:07.4503012Z File "src/sage/tests/cmdline.py", line 600, in sage.tests.cmdline.test_executable
2020-04-02T16:07:07.4503087Z Failed example:
2020-04-02T16:07:07.4503167Z     err
2020-04-02T16:07:07.4503245Z Expected:
2020-04-02T16:07:07.4503440Z     ''
2020-04-02T16:07:07.4503502Z Got:
2020-04-02T16:07:07.4503715Z     '/sage/src/bin/sage: line 564: exec: sqlite3: not found\n'
```

is it by design?



---

archive/issue_comments_412878.json:
```json
{
    "body": "\n```\n$ cat build/pkgs/sqlite/distros/debian.txt \nlibsqlite3-dev\n```\n\nWe can add the package with the executable `sqlite3`",
    "created_at": "2020-04-02T16:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412878",
    "user": "mkoeppe"
}
```


```
$ cat build/pkgs/sqlite/distros/debian.txt 
libsqlite3-dev
```

We can add the package with the executable `sqlite3`



---

archive/issue_comments_412879.json:
```json
{
    "body": "Replying to [comment:57 mkoeppe]:\n> We can add the package with the executable `sqlite3` \n\nThis is now #29487",
    "created_at": "2020-04-09T17:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412879",
    "user": "mkoeppe"
}
```

Replying to [comment:57 mkoeppe]:
> We can add the package with the executable `sqlite3` 

This is now #29487



---

archive/issue_comments_412880.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-09T22:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29161#issuecomment-412880",
    "user": "vbraun"
}
```

Resolution: fixed
