# Issue 17237: directed graph from polyhedron

archive/issues_017237.json:
```json
{
    "body": "Keywords: polyhedron, digraph\n\nThis ticket proposes to implement a method taking a polyhedron and a linear form \nand returning the directed graph made of vertices and edges of the polyhedron, oriented using the linear form.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17474\n\n",
    "created_at": "2014-12-09T08:40:49Z",
    "labels": [
        "component: geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "directed graph from polyhedron",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17237",
    "user": "https://github.com/fchapoton"
}
```
Keywords: polyhedron, digraph

This ticket proposes to implement a method taking a polyhedron and a linear form 
and returning the directed graph made of vertices and edges of the polyhedron, oriented using the linear form.

Issue created by migration from https://trac.sagemath.org/ticket/17474





---

archive/issue_comments_229094.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-12-09T08:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229094",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_229095.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-12-09T08:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229095",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_229096.json:
```json
{
    "body": "Hello,\n\nWhy is it a cached method?\n\nVincent",
    "created_at": "2014-12-10T19:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229096",
    "user": "https://github.com/videlec"
}
```

Hello,

Why is it a cached method?

Vincent



---

archive/issue_comments_229097.json:
```json
{
    "body": "Well, vertex_graph is cached, so I just did the same. But if you prefer not, no problem.",
    "created_at": "2014-12-10T19:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229097",
    "user": "https://github.com/fchapoton"
}
```

Well, vertex_graph is cached, so I just did the same. But if you prefer not, no problem.



---

archive/issue_comments_229098.json:
```json
{
    "body": "The thing is that caching costs (in memory) and these methods do not (in time). So I really do not see the point. Do you agree to also \"uncache\" the `vertex_graph` method?\n\nI think that in most cases, the use of cached method is dirty programming (though it is very cool in development phase).\n\nVincent",
    "created_at": "2014-12-10T20:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229098",
    "user": "https://github.com/videlec"
}
```

The thing is that caching costs (in memory) and these methods do not (in time). So I really do not see the point. Do you agree to also "uncache" the `vertex_graph` method?

I think that in most cases, the use of cached method is dirty programming (though it is very cool in development phase).

Vincent



---

archive/issue_comments_229099.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-10T20:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229099",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_229100.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-12-13T17:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229100",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_229101.json:
```json
{
    "body": "In your implementation, there is no oriented edge associated to an edge of the polyhedron that belongs to the kernel of the linear form, hence the underlying undirected graph of your graph is only a subgraph of vertices and edges of the polyhedron, see for example:\n\n\n```\nsage: penta = Polyhedron([[0,0],[1,0],[0,1],[1,2],[3,2]])\nsage: penta.vertex_digraph(vector([1,0]))\n```\n\n\nWhat is the purpose of this method ? Depending on this, the described behaviour may cause troubles. Other possibilities is to have two oriented edges facing eachother (just replace `> 0` by `>= 0`), or choosing one (but you lose some symmetry).",
    "created_at": "2014-12-13T17:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229101",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

In your implementation, there is no oriented edge associated to an edge of the polyhedron that belongs to the kernel of the linear form, hence the underlying undirected graph of your graph is only a subgraph of vertices and edges of the polyhedron, see for example:


```
sage: penta = Polyhedron([[0,0],[1,0],[0,1],[1,2],[3,2]])
sage: penta.vertex_digraph(vector([1,0]))
```


What is the purpose of this method ? Depending on this, the described behaviour may cause troubles. Other possibilities is to have two oriented edges facing eachother (just replace `> 0` by `>= 0`), or choosing one (but you lose some symmetry).



---

archive/issue_comments_229102.json:
```json
{
    "body": "One could also want to provide a genuine linear form (see `linear_transformation()` function) as an input, instead of a vector (this could be useful in (possible future) case the underlying vector space is not euclidean).\n\nAlso, it seems not very natural that the edges of the graph go in the decreasing direction of the linear form (note that `v-w` is the vector that goes from `w` to `v`, hence if an oriented edge `e` of the polyhedron is viewed as a vector, it is selected if `f(e)<0`), but perhaps it makes sense in the use case (it looks weird from an optimization perspective such as simplex method (note that Sage's MILP maximizes by default)).",
    "created_at": "2014-12-13T18:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229102",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

One could also want to provide a genuine linear form (see `linear_transformation()` function) as an input, instead of a vector (this could be useful in (possible future) case the underlying vector space is not euclidean).

Also, it seems not very natural that the edges of the graph go in the decreasing direction of the linear form (note that `v-w` is the vector that goes from `w` to `v`, hence if an oriented edge `e` of the polyhedron is viewed as a vector, it is selected if `f(e)<0`), but perhaps it makes sense in the use case (it looks weird from an optimization perspective such as simplex method (note that Sage's MILP maximizes by default)).



---

archive/issue_comments_229103.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-16T01:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_229104.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-16T01:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_229105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-16T01:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_229106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-16T01:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_229107.json:
```json
{
    "body": "I am always using this with generic linear forms where every edge is not parallel to the kernel of the form. I then turn the digraphs into posets. Anyway, I have replaced `>` by `>=` so that doubled edges are added when this happen. This will raise an error when I use the Poset constructor, so I am happy with that.\n\nI have also added a keyword to ask for the reverse orientation.\n\nHow can I check if the input is a linear form ?",
    "created_at": "2014-12-20T01:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229107",
    "user": "https://github.com/fchapoton"
}
```

I am always using this with generic linear forms where every edge is not parallel to the kernel of the form. I then turn the digraphs into posets. Anyway, I have replaced `>` by `>=` so that doubled edges are added when this happen. This will raise an error when I use the Poset constructor, so I am happy with that.

I have also added a keyword to ask for the reverse orientation.

How can I check if the input is a linear form ?



---

archive/issue_comments_229108.json:
```json
{
    "body": "Replying to [comment:12 chapoton]:\n> How can I check if the input is a linear form ?\n\nI uploaded a patch that checks if the input is an instance of `VectorSpaceMorphism` whose codomain has dimension 1.\n\nI removed from the doc the possibility to input a list or a tuple since it was not working in the previous version (it is doable to try/except `f = vector(f)` but i am not sure we have to think for the user).\n\n> I have also added a keyword to ask for the reverse orientation.\n\nIt works well. Do you have some important reason to go in the decreasing direction by default ? If not, i would prefer to have it the other way by default, to be consistent with the MILP default, but perhaps i miss some other use case.\n----\nNew commits:",
    "created_at": "2014-12-22T16:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229108",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:12 chapoton]:
> How can I check if the input is a linear form ?

I uploaded a patch that checks if the input is an instance of `VectorSpaceMorphism` whose codomain has dimension 1.

I removed from the doc the possibility to input a list or a tuple since it was not working in the previous version (it is doable to try/except `f = vector(f)` but i am not sure we have to think for the user).

> I have also added a keyword to ask for the reverse orientation.

It works well. Do you have some important reason to go in the decreasing direction by default ? If not, i would prefer to have it the other way by default, to be consistent with the MILP default, but perhaps i miss some other use case.
----
New commits:



---

archive/issue_comments_229109.json:
```json
{
    "body": "ok, thanks.\n\nI have made it increasing by default, as you seem to prefer it so.\n\nI have added a test to check that the orientation is correct.\n\nI have also removed an usused import and made two minor pep8 changes.\n\n----\nNew commits:",
    "created_at": "2014-12-24T10:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229109",
    "user": "https://github.com/fchapoton"
}
```

ok, thanks.

I have made it increasing by default, as you seem to prefer it so.

I have added a test to check that the orientation is correct.

I have also removed an usused import and made two minor pep8 changes.

----
New commits:



---

archive/issue_comments_229110.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-12-25T08:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229110",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_229111.json:
```json
{
    "body": "It looks good to me. Thanks.",
    "created_at": "2014-12-25T14:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229111",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

It looks good to me. Thanks.



---

archive/issue_comments_229112.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-12-25T14:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229112",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_229113.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-02T22:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17237#issuecomment-229113",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_016643.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2015-01-02T22:12:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17237",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17237#event-16643"
}
```
