# Issue 17716: inconsistency in returned type of symbolic function result

archive/issues_017716.json:
```json
{
    "body": "CC:  jdemeyer\n\nIt is generally preferred that the returned result type matches the argument type when calling a builtin function. For example this is as expected:\n\n```\nsage: factorial(8).parent()\nInteger Ring\nsage: factorial(SR(8)).parent()\nSymbolic Ring\nsage: exp(0).parent()\nInteger Ring\nsage: exp(SR(0)).parent()\nSymbolic Ring\n```\n\nbut this is not:\n\n```\nsage: lambert_w(SR(0)).parent()\nInteger Ring\n```\n\n\nThis ticket serves as a catch-all for such unexpected types.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17953\n\n",
    "created_at": "2015-03-14T10:04:21Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "inconsistency in returned type of symbolic function result",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17716",
    "user": "rws"
}
```
CC:  jdemeyer

It is generally preferred that the returned result type matches the argument type when calling a builtin function. For example this is as expected:

```
sage: factorial(8).parent()
Integer Ring
sage: factorial(SR(8)).parent()
Symbolic Ring
sage: exp(0).parent()
Integer Ring
sage: exp(SR(0)).parent()
Symbolic Ring
```

but this is not:

```
sage: lambert_w(SR(0)).parent()
Integer Ring
```


This ticket serves as a catch-all for such unexpected types.

Issue created by migration from https://trac.sagemath.org/ticket/17953





---

archive/issue_comments_236877.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-03-15T16:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236877",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_236878.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-15T16:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236878",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236879.json:
```json
{
    "body": "Hello,\n\nFirst of all, I think that the content of the branch is ok (I am running the test right now).\n\nBut I found the following behavior weird\n\n```\nsage: exp(0).parent()\nInteger ring\n```\n\nIn my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.\n\nVincent",
    "created_at": "2015-03-21T10:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236879",
    "user": "vdelecroix"
}
```

Hello,

First of all, I think that the content of the branch is ok (I am running the test right now).

But I found the following behavior weird

```
sage: exp(0).parent()
Integer ring
```

In my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.

Vincent



---

archive/issue_comments_236880.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/functions/log.py\n**********************************************************************\nFile \"src/sage/functions/log.py\", line 628, in sage.functions.log.Function_lambert_w._eval_\nFailed example:\n    parent(lambert_w(e))\nExpected:\n    Integer Ring\nGot:\n    Symbolic Ring\n**********************************************************************\n```\n",
    "created_at": "2015-03-21T11:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236880",
    "user": "vdelecroix"
}
```


```
sage -t --long src/sage/functions/log.py
**********************************************************************
File "src/sage/functions/log.py", line 628, in sage.functions.log.Function_lambert_w._eval_
Failed example:
    parent(lambert_w(e))
Expected:
    Integer Ring
Got:
    Symbolic Ring
**********************************************************************
```




---

archive/issue_comments_236881.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-21T11:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236881",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_236882.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T13:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236882",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236883.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-21T13:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236883",
    "user": "rws"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_236884.json:
```json
{
    "body": "Simpler way of doing\n\n```\nsymbolic_input = any(parent_c(arg) is SR for arg in args)\n```\n",
    "created_at": "2015-03-22T10:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236884",
    "user": "vdelecroix"
}
```

Simpler way of doing

```
symbolic_input = any(parent_c(arg) is SR for arg in args)
```




---

archive/issue_comments_236885.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> Simpler way of doing\n> {{{\n> symbolic_input = any(parent_c(arg) is SR for arg in args)\n> }}}\nTrue. Not worth a commit however.",
    "created_at": "2015-03-22T14:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236885",
    "user": "rws"
}
```

Replying to [comment:9 vdelecroix]:
> Simpler way of doing
> {{{
> symbolic_input = any(parent_c(arg) is SR for arg in args)
> }}}
True. Not worth a commit however.



---

archive/issue_comments_236886.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-12T19:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236886",
    "user": "mmezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236887.json:
```json
{
    "body": "Replying to [comment:5 vdelecroix]:\n> In my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.\n\nI tend to agree, but the present ticket is a step in the right direction in any case: it fixes some of the issues without making it harder to improve things later on.",
    "created_at": "2015-04-12T19:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236887",
    "user": "mmezzarobba"
}
```

Replying to [comment:5 vdelecroix]:
> In my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.

I tend to agree, but the present ticket is a step in the right direction in any case: it fixes some of the issues without making it harder to improve things later on.



---

archive/issue_comments_236888.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T23:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17716#issuecomment-236888",
    "user": "vbraun"
}
```

Resolution: fixed
