# Issue 17716: inconsistency in returned type of symbolic function result

Issue created by migration from https://trac.sagemath.org/ticket/17953

Original creator: rws

Original creation time: 2015-03-14 10:04:21

CC:  jdemeyer

It is generally preferred that the returned result type matches the argument type when calling a builtin function. For example this is as expected:

```
sage: factorial(8).parent()
Integer Ring
sage: factorial(SR(8)).parent()
Symbolic Ring
sage: exp(0).parent()
Integer Ring
sage: exp(SR(0)).parent()
Symbolic Ring
```

but this is not:

```
sage: lambert_w(SR(0)).parent()
Integer Ring
```


This ticket serves as a catch-all for such unexpected types.


---

Comment by rws created at 2015-03-15 16:22:05

New commits:


---

Comment by rws created at 2015-03-15 16:22:05

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-03-21 10:28:05

Hello,

First of all, I think that the content of the branch is ok (I am running the test right now).

But I found the following behavior weird

```
sage: exp(0).parent()
Integer ring
```

In my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.

Vincent


---

Comment by vdelecroix created at 2015-03-21 11:28:07


```
sage -t --long src/sage/functions/log.py
**********************************************************************
File "src/sage/functions/log.py", line 628, in sage.functions.log.Function_lambert_w._eval_
Failed example:
    parent(lambert_w(e))
Expected:
    Integer Ring
Got:
    Symbolic Ring
**********************************************************************
```



---

Comment by vdelecroix created at 2015-03-21 11:28:07

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-03-21 13:53:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2015-03-21 13:54:15

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-03-22 10:51:04

Simpler way of doing

```
symbolic_input = any(parent_c(arg) is SR for arg in args)
```



---

Comment by rws created at 2015-03-22 14:43:45

Replying to [comment:9 vdelecroix]:
> Simpler way of doing
> {{{
> symbolic_input = any(parent_c(arg) is SR for arg in args)
> }}}
True. Not worth a commit however.


---

Comment by mmezzarobba created at 2015-04-12 19:02:13

Changing status from needs_review to positive_review.


---

Comment by mmezzarobba created at 2015-04-12 19:02:13

Replying to [comment:5 vdelecroix]:
> In my opinion, a function should have a well defined domain and range. In some cases, the function preserves some subset. Like the function `x -> x^2` defined in the complex numbers preserves integers, rationals and algebraic. But considering that `{0}` is a subset of the real numbers on which `exp` preserve the integers is going too far.

I tend to agree, but the present ticket is a step in the right direction in any case: it fixes some of the issues without making it harder to improve things later on.


---

Comment by vbraun created at 2015-04-14 23:01:36

Resolution: fixed
