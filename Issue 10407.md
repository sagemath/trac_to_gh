# Issue 10407: Pickling of Functors

Issue created by migration from Trac.

Original creator: SimonKing

Original creation time: 2010-12-10 13:48:55

Assignee: nthiery

Keywords: pickling, functors

We used to have:

```
sage: F = QQ['t'].construction()[0]
sage: G = loads(dumps(F))
sage: G == F
True
sage: G.domain() == F.domain()
False
sage: G.codomain() is None
True
```


In other words, the cdef'd attributes of the construction functor are lost.

I created a generic pickling method for functors, so that it works a lot better:

```
sage: F = QQ['t'].construction()[0]
sage: G = loads(dumps(F))
sage: G == F
True
sage: G.domain() == F.domain()
True
sage: G.codomain() is None
False
```


The patch contains two tests, showing that the problem is solved.



---

Comment by SimonKing created at 2010-12-10 13:56:21

To the patchbot / release manager:

Depends on #8800

So, in fact, it also depends on #8807 and #10318.

Up to now, I only tested sage/categories/functor.pyx and sage/categories/pushout.py. However, since they use functors intensely, I am already marking the ticket as "needs review".


---

Comment by SimonKing created at 2010-12-10 13:56:21

Changing status from new to needs_review.


---

Comment by SimonKing created at 2011-01-18 07:06:52

Since the patchbot complained, I updated the patch. It should cleanly apply to `sage-4.6.2.alpha0`.

It turns out that the patch does in fact _not_ depend on #8800. It only depends on #8807 and #10318, which are already merged. So, no dependency.


---

Comment by SimonKing created at 2011-02-11 08:01:40

I don't know why the patchbot complains. The patch applies cleanly to a fresh `sage-4.6.2.alpha4`.


---

Comment by SimonKing created at 2011-02-18 07:32:46

Pickling of functors. Independent of #8800


---

Attachment

Since the patchbot did not try to apply the patch again and since the patch cleanly applies to sage-4.6.1.alpha4, I now try to trigger another attempt of the patchbot by posting a new copy of the patch.

And, by the way, this rather simple patch still needs review...


---

Comment by mraum created at 2011-03-01 17:34:37

Changing status from needs_review to positive_review.


---

Comment by mraum created at 2011-03-01 17:34:37

I only corrected tiny typos in the documentation, and I altered one doctest to better reflect the change that you introduced.


---

Comment by mraum created at 2011-03-01 17:35:44

Replacement for original patch.


---

Attachment

Replying to [comment:5 mraum]:
> I only corrected tiny typos in the documentation, and I altered one doctest to better reflect the change that you introduced.

Thank you, Martin!

For the record, the patchbot and the release manager:

Apply trac-10460-pickling_functors-review.patch


---

Comment by jdemeyer created at 2011-03-18 13:40:28

Resolution: fixed
