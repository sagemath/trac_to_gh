# Issue 28641: psutil doesn't build on recent Cygwin

archive/issues_028641.json:
```json
{
    "body": "CC:  slelievre\n\npsutil's Windows-related modules include some C headers that copy some Windows function and type declarations that are missing from public APIs.  However, Cygwin includes the [win32 API headers from the MinGW project](http://mingw-w64.org/doku.php/contribute#win32_api_and_runtime), which are more extensive.\n\nCygwin recently updated to MinGW-w64 7.0 which added some new structs to those headers that happen to already be redefined in psutil, so the psutil Cygwin patch needs to be updated to account for this (it still works on Cygwin installations using the older win32 headers, but for new builds this will be a problem).\n\nIssue created by migration from https://trac.sagemath.org/ticket/28878\n\n",
    "created_at": "2019-12-13T11:15:10Z",
    "labels": [
        "porting: Cygwin",
        "blocker",
        "bug"
    ],
    "title": "psutil doesn't build on recent Cygwin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28641",
    "user": "embray"
}
```
CC:  slelievre

psutil's Windows-related modules include some C headers that copy some Windows function and type declarations that are missing from public APIs.  However, Cygwin includes the [win32 API headers from the MinGW project](http://mingw-w64.org/doku.php/contribute#win32_api_and_runtime), which are more extensive.

Cygwin recently updated to MinGW-w64 7.0 which added some new structs to those headers that happen to already be redefined in psutil, so the psutil Cygwin patch needs to be updated to account for this (it still works on Cygwin installations using the older win32 headers, but for new builds this will be a problem).

Issue created by migration from https://trac.sagemath.org/ticket/28878





---

archive/issue_comments_404374.json:
```json
{
    "body": "I'm working on a patch...",
    "created_at": "2019-12-13T11:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404374",
    "user": "embray"
}
```

I'm working on a patch...



---

archive/issue_comments_404375.json:
```json
{
    "body": "Changing keywords from \"\" to \"cygwin psutil\".",
    "created_at": "2019-12-13T11:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404375",
    "user": "embray"
}
```

Changing keywords from "" to "cygwin psutil".



---

archive/issue_comments_404376.json:
```json
{
    "body": "This patch works on the new version of the headers, as well as an older version.  To check whether or not the patch is even relevant to your Cygwin install, run\n\n\n```\n$ cygcheck -s | grep 'w32api-headers'\nw32api-headers                          5.0.4-1                    OK\n```\n\n\nThis issue only affects version 7.0.0 and up.\n\nThere is no need to increase the patch level on the SPKG, because this is not a runtime issue; it only impacts building, so the patch will be needed if psutil is being built for the first time, or is being rebuilt for some other reason.\n----\nNew commits:",
    "created_at": "2019-12-13T11:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404376",
    "user": "embray"
}
```

This patch works on the new version of the headers, as well as an older version.  To check whether or not the patch is even relevant to your Cygwin install, run


```
$ cygcheck -s | grep 'w32api-headers'
w32api-headers                          5.0.4-1                    OK
```


This issue only affects version 7.0.0 and up.

There is no need to increase the patch level on the SPKG, because this is not a runtime issue; it only impacts building, so the patch will be needed if psutil is being built for the first time, or is being rebuilt for some other reason.
----
New commits:



---

archive/issue_comments_404377.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-13T11:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404377",
    "user": "embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_404378.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-28T11:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404378",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_404379.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-28T22:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404379",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_404380.json:
```json
{
    "body": "Thanks!",
    "created_at": "2019-12-30T15:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28641#issuecomment-404380",
    "user": "embray"
}
```

Thanks!
