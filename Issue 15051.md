# Issue 15051: Balanced Incomplete Block Designs with k=4

archive/issues_015051.json:
```json
{
    "body": "CC:  @dimpase @vbraun @wdjoyner @rbeezer\n\nEnd of a loong queue of patches, here it is ! The constructions for BIBD with k=4 as found in Douglas Stinson's book \"Combinatorial Designs: Constructions and Analysis\", which uses the constructions given in #15286 (Latin Squares) and #15287 (Orthogonal Arrays).\n\nThis patch creates a file named bibd.py in `combinat/design/` for the BIBD we already know how to build and the future ones (I will make sure of that `:-P`)\n\nIssue created by migration from https://trac.sagemath.org/ticket/15288\n\n",
    "created_at": "2013-10-16T15:02:16Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Balanced Incomplete Block Designs with k=4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15051",
    "user": "https://github.com/nathanncohen"
}
```
CC:  @dimpase @vbraun @wdjoyner @rbeezer

End of a loong queue of patches, here it is ! The constructions for BIBD with k=4 as found in Douglas Stinson's book "Combinatorial Designs: Constructions and Analysis", which uses the constructions given in #15286 (Latin Squares) and #15287 (Orthogonal Arrays).

This patch creates a file named bibd.py in `combinat/design/` for the BIBD we already know how to build and the future ones (I will make sure of that `:-P`)

Issue created by migration from https://trac.sagemath.org/ticket/15288





---

archive/issue_comments_192241.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-16T15:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192241",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_192242.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-10-16T15:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192243.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-09T12:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192244.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-09T12:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_044266.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15051#event-44266"
}
```



---

archive/issue_comments_192245.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-03-27T15:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192246.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-03-27T15:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_192247.json:
```json
{
    "body": "Just rebased on the latest version of its last dependency. Hey guys, all the dependencies are reviewed now ! We can get this in !\n\nLook at what it can do. Isn't it totally cool ? `:-PPP`\n\n\n```\nsage: designs.BalancedIncompleteBlockDesign(13,4)\n```\n\n\nNathann",
    "created_at": "2014-03-27T15:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192247",
    "user": "https://github.com/nathanncohen"
}
```

Just rebased on the latest version of its last dependency. Hey guys, all the dependencies are reviewed now ! We can get this in !

Look at what it can do. Isn't it totally cool ? `:-PPP`


```
sage: designs.BalancedIncompleteBlockDesign(13,4)
```


Nathann



---

archive/issue_comments_192248.json:
```json
{
    "body": "while building docs, I get\n\n```\nOSError: [combinat ] /usr/local/src/sage/sage-6.1.rc0/local/lib/python2.7/site-packages/sage/combinat/designs/bibd.py:docstring of sage.combinat.designs.bibd.BalancedIncompleteBlockDesign:27: ERROR: Unknown target name: \"http://www.argilo.net/files/bibd.pdf\".\n```\n\nany clues?",
    "created_at": "2014-03-27T20:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192248",
    "user": "https://github.com/dimpase"
}
```

while building docs, I get

```
OSError: [combinat ] /usr/local/src/sage/sage-6.1.rc0/local/lib/python2.7/site-packages/sage/combinat/designs/bibd.py:docstring of sage.combinat.designs.bibd.BalancedIncompleteBlockDesign:27: ERROR: Unknown target name: "http://www.argilo.net/files/bibd.pdf".
```

any clues?



---

archive/issue_comments_192249.json:
```json
{
    "body": "It is probably this \n\n```\n`http://www.argilo.net/files/bibd.pdf`_\n```\n\n\nYou can remove the link if it is a problem to compile the doc, it is not very important.\n\nNathann",
    "created_at": "2014-03-27T20:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192249",
    "user": "https://github.com/nathanncohen"
}
```

It is probably this 

```
`http://www.argilo.net/files/bibd.pdf`_
```


You can remove the link if it is a problem to compile the doc, it is not very important.

Nathann



---

archive/issue_comments_192250.json:
```json
{
    "body": "I pushed the fix for this and one more small doc-related issue.\n----\nNew commits:",
    "created_at": "2014-03-27T21:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192250",
    "user": "https://github.com/dimpase"
}
```

I pushed the fix for this and one more small doc-related issue.
----
New commits:



---

archive/issue_comments_192251.json:
```json
{
    "body": "I don't like that `designs.BalancedIncompleteBlockDesign()` returns a list of blocks, whereas it should obviously return an `IncidenceStructure`, e.g. as `designs.ProjectivePlaneDesign()` does. Please fix this.",
    "created_at": "2014-03-28T09:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192251",
    "user": "https://github.com/dimpase"
}
```

I don't like that `designs.BalancedIncompleteBlockDesign()` returns a list of blocks, whereas it should obviously return an `IncidenceStructure`, e.g. as `designs.ProjectivePlaneDesign()` does. Please fix this.



---

archive/issue_comments_192252.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-03-28T09:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192252",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_192253.json:
```json
{
    "body": "Done. But honestly you are just enforcing your own subjective point of view there, and I do not like what I am doing.\n\nIt is very nice if for you a BIBD is a Incidence Structure, but for me this thing is a collection of set. That's all. I could also return a complete graph along with a collection of subgraphs to show that a BIBD is a decomposition of a complete graph into smaller ones, and this does not make any sense at all. For me a BIBD is a collection of sets, and if you want some specific additional structure on top of it you are quite free to set it yourself.\n\nBesides this `IncidenceStructure` class spends its lifetime sorting stuff I never asked to sort, and copying stuff around for no reason. That's for the loss of computational time resulting for enforcing a subjective point of view.\n\nIn the end, I just end up calling `.blocks()` every time I build a BIBD, and I don't see why I should pay cycles to `IncidenceStructure` in exchange for that.\n\nNathann\n----\nNew commits:",
    "created_at": "2014-03-28T13:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192253",
    "user": "https://github.com/nathanncohen"
}
```

Done. But honestly you are just enforcing your own subjective point of view there, and I do not like what I am doing.

It is very nice if for you a BIBD is a Incidence Structure, but for me this thing is a collection of set. That's all. I could also return a complete graph along with a collection of subgraphs to show that a BIBD is a decomposition of a complete graph into smaller ones, and this does not make any sense at all. For me a BIBD is a collection of sets, and if you want some specific additional structure on top of it you are quite free to set it yourself.

Besides this `IncidenceStructure` class spends its lifetime sorting stuff I never asked to sort, and copying stuff around for no reason. That's for the loss of computational time resulting for enforcing a subjective point of view.

In the end, I just end up calling `.blocks()` every time I build a BIBD, and I don't see why I should pay cycles to `IncidenceStructure` in exchange for that.

Nathann
----
New commits:



---

archive/issue_comments_192254.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-03-28T13:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192254",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_192255.json:
```json
{
    "body": "Replying to [comment:14 ncohen]:\n> Done. But honestly you are just enforcing your own subjective point of view there, and I do not like what I am doing.\nI am enforcing consistency, as I indicated quite clearly, I hope.\nThe thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.\n\n\n> \n> It is very nice if for you a BIBD is a Incidence Structure, but for me this thing is a collection of set. That's all. I could also return a complete graph along with a collection of subgraphs to show that a BIBD is a decomposition of a complete graph into smaller ones, and this does not make any sense at all. For me a BIBD is a collection of sets, and if you want some specific additional structure on top of it you are quite free to set it yourself.\n> \n> Besides this `IncidenceStructure` class spends its lifetime sorting stuff I never asked to sort, and copying stuff around for no reason. That's for the loss of computational time resulting for enforcing a subjective point of view.\n\nwell, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.",
    "created_at": "2014-03-28T21:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192255",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:14 ncohen]:
> Done. But honestly you are just enforcing your own subjective point of view there, and I do not like what I am doing.
I am enforcing consistency, as I indicated quite clearly, I hope.
The thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.


> 
> It is very nice if for you a BIBD is a Incidence Structure, but for me this thing is a collection of set. That's all. I could also return a complete graph along with a collection of subgraphs to show that a BIBD is a decomposition of a complete graph into smaller ones, and this does not make any sense at all. For me a BIBD is a collection of sets, and if you want some specific additional structure on top of it you are quite free to set it yourself.
> 
> Besides this `IncidenceStructure` class spends its lifetime sorting stuff I never asked to sort, and copying stuff around for no reason. That's for the loss of computational time resulting for enforcing a subjective point of view.

well, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.



---

archive/issue_comments_192256.json:
```json
{
    "body": "> I am enforcing consistency, as I indicated quite clearly, I hope.\n\nYou are enforcing consistency because consistency is a way to enforce what you like. If I tell you that `designs.steiner_quadruple_systems` returns tuples then you will tell me (as before) that \"It's not because I did something wrong once that I should be allowed to do it again\".\n\nDear, dear consistency `:-P`\n\n> The thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.\n\nYep. Exactly like here, and for the same reason.\n\n> well, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.\n\nChanges nothing. All backends have a cost, all of them mean duplicating stuff uselessly, and none of them is as \"simple and understandable\" as a list. If you want a data structure to do something specific, pick the data structure that you like. I don't think we should pick a specific data structure over another one, and so I prefer to return the most basic types. The types that the functions actually work with. No copy, easy-to-understand data.\n\nI personally have NOTHING to do of all methods of `IncidenceStructure`, yet I am the one who implements that code. Isn't that a proof that it is not the right data structure ? `:-P`\n\nNathann",
    "created_at": "2014-03-28T22:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192256",
    "user": "https://github.com/nathanncohen"
}
```

> I am enforcing consistency, as I indicated quite clearly, I hope.

You are enforcing consistency because consistency is a way to enforce what you like. If I tell you that `designs.steiner_quadruple_systems` returns tuples then you will tell me (as before) that "It's not because I did something wrong once that I should be allowed to do it again".

Dear, dear consistency `:-P`

> The thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.

Yep. Exactly like here, and for the same reason.

> well, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.

Changes nothing. All backends have a cost, all of them mean duplicating stuff uselessly, and none of them is as "simple and understandable" as a list. If you want a data structure to do something specific, pick the data structure that you like. I don't think we should pick a specific data structure over another one, and so I prefer to return the most basic types. The types that the functions actually work with. No copy, easy-to-understand data.

I personally have NOTHING to do of all methods of `IncidenceStructure`, yet I am the one who implements that code. Isn't that a proof that it is not the right data structure ? `:-P`

Nathann



---

archive/issue_comments_192257.json:
```json
{
    "body": "Replying to [comment:16 ncohen]:\n> > I am enforcing consistency, as I indicated quite clearly, I hope.\n> \n> You are enforcing consistency because consistency is a way to enforce what you like. If I tell you that `designs.steiner_quadruple_systems` returns tuples then you will tell me (as before) that \"It's not because I did something wrong once that I should be allowed to do it again\".\n> \n> Dear, dear consistency `:-P`\n\nDo you understand the meaning of the word `consistency`? Just wondering...\n\nI don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.\n\n> \n> > The thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.\n> \n> Yep. Exactly like here, and for the same reason.\n\nBut `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.\n\n> \n> > well, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.\n> \n> Changes nothing. All backends have a cost, all of them mean duplicating stuff uselessly, and none of them is as \"simple and understandable\" as a list. If you want a data structure to do something specific, pick the data structure that you like. I don't think we should pick a specific data structure over another one, and so I prefer to return the most basic types. The types that the functions actually work with. No copy, easy-to-understand data.\n\nNo, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.\nIt's perfectly OK to have it in your private code, but not in a library code.\n\nE.g. the fact that it is not an immutable list is inviting errors.\nAnother thing, one might wonder what the parameters of the design are. \nSurely one can have a function to compute them, but it can also be implemented by storing the parameters upon the creation.\nSame for automorphism groups.\n\n> \n> I personally have NOTHING to do of all methods of `IncidenceStructure`, yet I am the one who implements that code. Isn't that a proof that it is not the right data structure ? `:-P`\n> \nI did not check who wrote `IncidenceStructure` structure class. Does it matter? It could have been you...",
    "created_at": "2014-03-29T00:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192257",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:16 ncohen]:
> > I am enforcing consistency, as I indicated quite clearly, I hope.
> 
> You are enforcing consistency because consistency is a way to enforce what you like. If I tell you that `designs.steiner_quadruple_systems` returns tuples then you will tell me (as before) that "It's not because I did something wrong once that I should be allowed to do it again".
> 
> Dear, dear consistency `:-P`

Do you understand the meaning of the word `consistency`? Just wondering...

I don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.

> 
> > The thing I complained about is akin to `graphs.blah()` returning a list of edges instead of a `Graph`.
> 
> Yep. Exactly like here, and for the same reason.

But `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.

> 
> > well, this just means that `IncidenceStructure` class is in need of an improvement; perhaps it should get several backends just as `Graph` has.
> 
> Changes nothing. All backends have a cost, all of them mean duplicating stuff uselessly, and none of them is as "simple and understandable" as a list. If you want a data structure to do something specific, pick the data structure that you like. I don't think we should pick a specific data structure over another one, and so I prefer to return the most basic types. The types that the functions actually work with. No copy, easy-to-understand data.

No, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.
It's perfectly OK to have it in your private code, but not in a library code.

E.g. the fact that it is not an immutable list is inviting errors.
Another thing, one might wonder what the parameters of the design are. 
Surely one can have a function to compute them, but it can also be implemented by storing the parameters upon the creation.
Same for automorphism groups.

> 
> I personally have NOTHING to do of all methods of `IncidenceStructure`, yet I am the one who implements that code. Isn't that a proof that it is not the right data structure ? `:-P`
> 
I did not check who wrote `IncidenceStructure` structure class. Does it matter? It could have been you...



---

archive/issue_comments_192258.json:
```json
{
    "body": "> Do you understand the meaning of the word `consistency`? Just wondering...\n\nMy point was to show you that if I try to be consistent with something you don't like, the result is the same `:-P`\n\n> I don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.\n\nNo authority is ever sufficient to enforce a bad idea. For instance you will never make \"MOLS\" return block designs. They return lists of sets from time to time. And Orthogonal arrays are not block designs when you call `orthogonal_array`. So no, these function will never all return the same thing.\n\n> But `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.\n\n`graphs.something` sometimes return lists of graphs, or  iterators on them. Though it is true that *they* are more consistent.\n\n> No, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.\n\nWho cares ? You know it when you build it, and you do whatever you want afterwards ! You can change the sets of a block design without changing the name. Actually, with  your strandards the design of `BlockDesign` is pretty bad, for `.blocks()` does not return a copy of the blocks but the  blocks themselves, so I wondered at some point if it was safe  to  do that. See ? More copies  for nothing, just because you want to wrap them in a data structure when nobody requested it.\n\n> It's perfectly OK to have it in your private code, but not in a library code.\n> \n> E.g. the fact that it is not an immutable list is inviting errors.\n\nDo you see that your way of looking at things will add useless copies everywhere ? Copies, and sorting, and equality tests, all for no new feature, but only for \"good code administration\" ? Do you see the cost of this, and the total lack of gain in the process ?\n\nThe code will be slower. For nothing. What's so good in \"consistency\" that we have to pay all this ?\n\n> Another thing, one might wonder what the parameters of the design are. \n\nNot when one creates the design by giving it the parameters. But they can recompute them afterwards, I fixed the function recently.\n\n> Surely one can have a function to compute them, but it can also be implemented by storing the parameters upon the creation.\n> Same for automorphism groups.\n\nYou are all crazy with your caches everywhere, immutable structures and so. You waste computations. Consider the developers as responsible beings, and you will stop having to copy/cache stuff when nobody asks you as if you wanted to protect them from themselves. They know what they are doing.\n\n> I did not check who wrote `IncidenceStructure` structure class. Does it matter? It could have been you...\n\nWell, it does not do much. It builds the matrix from the blocks, or the blocks from the matrix, it computes parameters... Well, to be honest it does its job. It's just that there is no reason on earth why we should pay copies to this data structure if we don't need it.\n\nNathann",
    "created_at": "2014-03-29T06:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192258",
    "user": "https://github.com/nathanncohen"
}
```

> Do you understand the meaning of the word `consistency`? Just wondering...

My point was to show you that if I try to be consistent with something you don't like, the result is the same `:-P`

> I don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.

No authority is ever sufficient to enforce a bad idea. For instance you will never make "MOLS" return block designs. They return lists of sets from time to time. And Orthogonal arrays are not block designs when you call `orthogonal_array`. So no, these function will never all return the same thing.

> But `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.

`graphs.something` sometimes return lists of graphs, or  iterators on them. Though it is true that *they* are more consistent.

> No, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.

Who cares ? You know it when you build it, and you do whatever you want afterwards ! You can change the sets of a block design without changing the name. Actually, with  your strandards the design of `BlockDesign` is pretty bad, for `.blocks()` does not return a copy of the blocks but the  blocks themselves, so I wondered at some point if it was safe  to  do that. See ? More copies  for nothing, just because you want to wrap them in a data structure when nobody requested it.

> It's perfectly OK to have it in your private code, but not in a library code.
> 
> E.g. the fact that it is not an immutable list is inviting errors.

Do you see that your way of looking at things will add useless copies everywhere ? Copies, and sorting, and equality tests, all for no new feature, but only for "good code administration" ? Do you see the cost of this, and the total lack of gain in the process ?

The code will be slower. For nothing. What's so good in "consistency" that we have to pay all this ?

> Another thing, one might wonder what the parameters of the design are. 

Not when one creates the design by giving it the parameters. But they can recompute them afterwards, I fixed the function recently.

> Surely one can have a function to compute them, but it can also be implemented by storing the parameters upon the creation.
> Same for automorphism groups.

You are all crazy with your caches everywhere, immutable structures and so. You waste computations. Consider the developers as responsible beings, and you will stop having to copy/cache stuff when nobody asks you as if you wanted to protect them from themselves. They know what they are doing.

> I did not check who wrote `IncidenceStructure` structure class. Does it matter? It could have been you...

Well, it does not do much. It builds the matrix from the blocks, or the blocks from the matrix, it computes parameters... Well, to be honest it does its job. It's just that there is no reason on earth why we should pay copies to this data structure if we don't need it.

Nathann



---

archive/issue_comments_192259.json:
```json
{
    "body": "(Oh, by the way I just looked at the list of commits in this branch and saw that the Orthogonal Array stuff is still there : it has already been reviewed, so this part should be okay. It's not easy to know what is left to review now :-/)",
    "created_at": "2014-03-29T07:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192259",
    "user": "https://github.com/nathanncohen"
}
```

(Oh, by the way I just looked at the list of commits in this branch and saw that the Orthogonal Array stuff is still there : it has already been reviewed, so this part should be okay. It's not easy to know what is left to review now :-/)



---

archive/issue_comments_192260.json:
```json
{
    "body": "Replying to [comment:18 ncohen]:\n> > Do you understand the meaning of the word `consistency`? Just wondering...\n> \n> My point was to show you that if I try to be consistent with something you don't like, the result is the same `:-P`\n> \n> > I don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.\n> \n> No authority is ever sufficient to enforce a bad idea. For instance you will never make \"MOLS\" return block designs. They return lists of sets from time to time. And Orthogonal arrays are not block designs when you call `orthogonal_array`. So no, these function will never all return the same thing.\n> \n> > But `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.\n> \n> `graphs.something` sometimes return lists of graphs, or  iterators on them. Though it is true that *they* are more consistent.\n> \n> > No, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.\n> \n> Who cares ? You know it when you build it, and you do whatever you want afterwards ! \n\na user can go through `designs.*` and call functions, like \n\nYou can change the sets of a block design without changing the name. Actually, with  your strandards the design of `BlockDesign` is pretty bad, for `.blocks()` does not return a copy of the blocks but the  blocks themselves, so I wondered at some point if it was safe  to  do that. See ? More copies  for nothing, just because you want to wrap them in a data structure when nobody requested it.\n\n\n`ProjectivePlaneDesign()` is written by you, isn't it? And it does return `IncidenceStructure`. Needless to say, `ProjectivePlaneDesign()` is a BIBD. You simply do not have a good argument to justify why in different cases you return different classes.",
    "created_at": "2014-03-29T10:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192260",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:18 ncohen]:
> > Do you understand the meaning of the word `consistency`? Just wondering...
> 
> My point was to show you that if I try to be consistent with something you don't like, the result is the same `:-P`
> 
> > I don't have time to control all the code you produce for consistency, sorry. But, indeed, I am of opinion that `designs.*` must all return the stuff from the same class. And I am sure the majority on sage-devel would support me on this, if you think that I am not sufficient authority for you.
> 
> No authority is ever sufficient to enforce a bad idea. For instance you will never make "MOLS" return block designs. They return lists of sets from time to time. And Orthogonal arrays are not block designs when you call `orthogonal_array`. So no, these function will never all return the same thing.
> 
> > But `graphs.*` do not do this, and `designs.*` do. Some have to give, and it's certainly `designs.*`.
> 
> `graphs.something` sometimes return lists of graphs, or  iterators on them. Though it is true that *they* are more consistent.
> 
> > No, this design (more precisely, absence of one) is crap, it throws away the fact that list in question is a list of blocks of BIBD.
> 
> Who cares ? You know it when you build it, and you do whatever you want afterwards ! 

a user can go through `designs.*` and call functions, like 

You can change the sets of a block design without changing the name. Actually, with  your strandards the design of `BlockDesign` is pretty bad, for `.blocks()` does not return a copy of the blocks but the  blocks themselves, so I wondered at some point if it was safe  to  do that. See ? More copies  for nothing, just because you want to wrap them in a data structure when nobody requested it.


`ProjectivePlaneDesign()` is written by you, isn't it? And it does return `IncidenceStructure`. Needless to say, `ProjectivePlaneDesign()` is a BIBD. You simply do not have a good argument to justify why in different cases you return different classes.



---

archive/issue_comments_192261.json:
```json
{
    "body": "> `ProjectivePlaneDesign()` is written by you, isn't it? And it does return `IncidenceStructure`. Needless to say, `ProjectivePlaneDesign()` is a BIBD. You simply do not have a good argument to justify why in different cases you return different classes.\n\n`O_O`\n\nHey, let's make them all return lists of Sets if you don't mind ! `:-D`\n\nThis function returns `IncidenceStructure` because I copy/pasted from projective geometry design, but really I  could not care less about Incidence Structure. I just  never  used  those functions in any way. I just want the sets `:-P`\n\nNathann",
    "created_at": "2014-03-30T01:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192261",
    "user": "https://github.com/nathanncohen"
}
```

> `ProjectivePlaneDesign()` is written by you, isn't it? And it does return `IncidenceStructure`. Needless to say, `ProjectivePlaneDesign()` is a BIBD. You simply do not have a good argument to justify why in different cases you return different classes.

`O_O`

Hey, let's make them all return lists of Sets if you don't mind ! `:-D`

This function returns `IncidenceStructure` because I copy/pasted from projective geometry design, but really I  could not care less about Incidence Structure. I just  never  used  those functions in any way. I just want the sets `:-P`

Nathann



---

archive/issue_comments_192262.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-30T19:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192262",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_192263.json:
```json
{
    "body": "OK, good.",
    "created_at": "2014-03-30T19:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192263",
    "user": "https://github.com/dimpase"
}
```

OK, good.



---

archive/issue_comments_192264.json:
```json
{
    "body": "Wow.\n\nWow.\n\nBIBD with k=4 reviewed.\n\nTHaaaaaaaaaaaaaaaaaaaaaaaaaaank you so much !! `:-)`\n\nI can clean  the code for k=5 now.\n\nNathann",
    "created_at": "2014-03-30T20:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192264",
    "user": "https://github.com/nathanncohen"
}
```

Wow.

Wow.

BIBD with k=4 reviewed.

THaaaaaaaaaaaaaaaaaaaaaaaaaaank you so much !! `:-)`

I can clean  the code for k=5 now.

Nathann



---

archive/issue_comments_192265.json:
```json
{
    "body": "PDF docs don't build:\n\n```\n(inputenc)                in inputencoding `utf8'.\n\nSee the inputenc package documentation for explanation.\nType  H <return>  for immediate help.\n ...                                              \n                                                  \nl.173287 Returns a $(v,\\{^^D\n                            ,5,8,9,12\\})-PBD$ on $v$ elements.\n? \n! Emergency stop.\n ...                                              \n                                                  \nl.173287 Returns a $(v,\\{^^D\n                            ,5,8,9,12\\})-PBD$ on $v$ elements.\n!  ==> Fatal error occurred, no output PDF file produced!\nTranscript written on combinat.log.\n```\n",
    "created_at": "2014-03-31T18:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192265",
    "user": "https://github.com/vbraun"
}
```

PDF docs don't build:

```
(inputenc)                in inputencoding `utf8'.

See the inputenc package documentation for explanation.
Type  H <return>  for immediate help.
 ...                                              
                                                  
l.173287 Returns a $(v,\{^^D
                            ,5,8,9,12\})-PBD$ on $v$ elements.
? 
! Emergency stop.
 ...                                              
                                                  
l.173287 Returns a $(v,\{^^D
                            ,5,8,9,12\})-PBD$ on $v$ elements.
!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on combinat.log.
```




---

archive/issue_comments_192266.json:
```json
{
    "body": "here is the diff to fix the thing:\n\n```\n--- a/src/sage/combinat/designs/bibd.py\n+++ b/src/sage/combinat/designs/bibd.py\n@@ -449,7 +449,7 @@ def _relabel_bibd(B,n):\n \n def PBD_4_5_8_9_12(v, check=True):\n     \"\"\"\n-    Returns a `(v,\\{\\4,5,8,9,12\\})-PBD` on `v` elements.\n+    Returns a `(v,\\{4,5,8,9,12\\})-PBD` on `v` elements.\n \n     A `(v,\\{4,5,8,9,12\\})`-PBD exists if and only if `v\\equiv 0,1 \\pmod 4`. The\n     construction implemented here appears page 168 in [Stinson2004]_.\n```\n\nI have to f*cking clue how to push such a commit into the right place. `Git the hard way` does give recepies that push something somewhere, but certainly not where it should go to...",
    "created_at": "2014-03-31T20:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192266",
    "user": "https://github.com/dimpase"
}
```

here is the diff to fix the thing:

```
--- a/src/sage/combinat/designs/bibd.py
+++ b/src/sage/combinat/designs/bibd.py
@@ -449,7 +449,7 @@ def _relabel_bibd(B,n):
 
 def PBD_4_5_8_9_12(v, check=True):
     """
-    Returns a `(v,\{\4,5,8,9,12\})-PBD` on `v` elements.
+    Returns a `(v,\{4,5,8,9,12\})-PBD` on `v` elements.
 
     A `(v,\{4,5,8,9,12\})`-PBD exists if and only if `v\equiv 0,1 \pmod 4`. The
     construction implemented here appears page 168 in [Stinson2004]_.
```

I have to f*cking clue how to push such a commit into the right place. `Git the hard way` does give recepies that push something somewhere, but certainly not where it should go to...



---

archive/issue_comments_192267.json:
```json
{
    "body": "I've modified the description of the ticket to point to the \"right\" branch and commit. Hope I didn't screw this too badly...",
    "created_at": "2014-03-31T20:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192267",
    "user": "https://github.com/dimpase"
}
```

I've modified the description of the ticket to point to the "right" branch and commit. Hope I didn't screw this too badly...



---

archive/issue_comments_192268.json:
```json
{
    "body": "Just `git push trac HEAD:public/15288` should have done it. But this is fine, too.",
    "created_at": "2014-03-31T21:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192268",
    "user": "https://github.com/vbraun"
}
```

Just `git push trac HEAD:public/15288` should have done it. But this is fine, too.



---

archive/issue_comments_192269.json:
```json
{
    "body": "I don't see how this could work - unless I don't create my own branch. \nI did as described in `Git the hard way`:\n\n```\ngit fetch trac public/15288\nget checkout -b typofix15288 FETCH_HEAD\n... editing the file...\ngit commit -a\ngit push --set-upstream trac HEAD:public/typofix15288` \n```\n\nAnd trac server was not impressed :-)\n\nI thought that the reason for this is some kind of lack of permissions to commit to a branch that is not my own... Anyhow, it's not clear from the description in the docs. Especially it's unclear under what conditions the manual changing of the branch and commit fields are not needed.",
    "created_at": "2014-03-31T21:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192269",
    "user": "https://github.com/dimpase"
}
```

I don't see how this could work - unless I don't create my own branch. 
I did as described in `Git the hard way`:

```
git fetch trac public/15288
get checkout -b typofix15288 FETCH_HEAD
... editing the file...
git commit -a
git push --set-upstream trac HEAD:public/typofix15288` 
```

And trac server was not impressed :-)

I thought that the reason for this is some kind of lack of permissions to commit to a branch that is not my own... Anyhow, it's not clear from the description in the docs. Especially it's unclear under what conditions the manual changing of the branch and commit fields are not needed.



---

archive/issue_comments_192270.json:
```json
{
    "body": "Everybody can write to branches named `public/...`\n\nTrac can't possibly know that `public/typofix15288` is supposed to be on this ticket, which is why you had to manually update the ticket.",
    "created_at": "2014-03-31T21:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192270",
    "user": "https://github.com/vbraun"
}
```

Everybody can write to branches named `public/...`

Trac can't possibly know that `public/typofix15288` is supposed to be on this ticket, which is why you had to manually update the ticket.



---

archive/issue_events_044267.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-01T12:12:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15051#event-44267"
}
```



---

archive/issue_comments_192271.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-01T12:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15051#issuecomment-192271",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
