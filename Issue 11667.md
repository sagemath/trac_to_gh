# Issue 11667: sage.symbolic.expression.Expression.collect has no documentation

Issue created by migration from Trac.

Original creator: mjo

Original creation time: 2011-09-23 19:23:34

Assignee: mvngu

The documentation for Expression.collect() has examples, but doesn't actually tell you what it's supposed to do.


---

Comment by mjo created at 2012-05-30 16:27:46

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-06-01 19:51:32

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2012-06-01 19:51:32

I think that this is pretty good overall, but the random test is a little weak, because they are very small polys.  Check out a few!

Instead, 

```
sage: base = QQ['y']
sage: polynomials = base['x']
sage: f = SR(polynomials.random_element(8)); g = f.expand().collect(x); print f; print g; bool(f == g)
```

gives us a more robust one.  Can you think of even more crazy ones?  We could do arbitrarily wacky ones... but at least this show the collect in action; the current test rarely does, as far as I can tell.


---

Comment by mjo created at 2012-06-01 20:03:17

I left it kind of simple because I've seen expression equality fail on some "easy" cases. A result of `bool(f == g) == False` just means "I couldn't prove that `f == g`".

In that regard the test is only correct if it's going to generate very simple (i.e. comparable) expressions. We could go higher than the default of degree 2 probably, but I didn't feel like spending too much time thinking about it, either.


---

Comment by kcrisman created at 2012-06-02 04:41:02

> I left it kind of simple because I've seen expression equality fail on some "easy" cases. A result of `bool(f == g) == False` just means "I couldn't prove that `f == g`".

???  I'd like to see this.  I think that the kind of examples that the code I posted would generate shouldn't have that happen - we're not talking complicated polynomials here.

> In that regard the test is only correct if it's going to generate very simple (i.e. comparable) expressions. We could go higher than the default of degree 2 probably, but I didn't feel like spending too much time thinking about it, either.

Well, considering that the current tests don't actually generate expressions that have anything to collect, I'd prefer at least something with two variables.


---

Comment by mjo created at 2012-06-12 06:09:19

Changing status from needs_work to needs_review.


---

Comment by mjo created at 2012-06-12 06:09:19

I was worried about things like,


```
sage: bool(1/3*sqrt(2/5) == 2/3*sqrt(1/10))
False
```


and the fact that the relevant Ginac code calls expand:


```
// correct for lost fractional arguments and return
return x + (*this - x).expand();
```


but I think I've convinced myself that this won't matter because we'll be expanding zero in that last statement.

Patch has been updated.


---

Comment by kcrisman created at 2012-07-07 02:53:20

This fixes part of #9046, incidentally.


---

Comment by tscrim created at 2012-11-18 06:40:54

The patchbot and myself gets some small fuzz, however I don't know offhand which patch this needs to be rebased off:

```
patching file sage/symbolic/expression.pyx
Hunk #1 succeeded at 5115 with fuzz 1 (offset 274 lines).
now at: sage-trac_11839.patch
```

Also could you please remove all trailing whitespace and remove the dollar signs `$` (the single backticks ``` takes it into math mode). Otherwise looks good.


---

Attachment

Clean up whitespace, math-mode, and fuzz


---

Comment by mjo created at 2012-11-18 23:18:00

The fuzz was on the blank line before `def collect(...)`. Someone added a tab there.

I've fixed the other issues as well, thanks for taking a look.


---

Comment by tscrim created at 2012-11-18 23:45:25

Looks good to me. Thanks.


---

Comment by tscrim created at 2012-11-18 23:45:25

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-12-18 11:17:03

Resolution: fixed
