# Issue 13082: compute fundamental groups of simplicial complexes

Issue created by migration from https://trac.sagemath.org/ticket/13254

Original creator: jhpalmieri

Original creation time: 2012-07-14 15:16:52

Assignee: jhpalmieri

The attached patch provides a `fundamental_group` method for simplicial complexes.


---

Comment by jhpalmieri created at 2012-07-14 15:18:18

Changing status from new to needs_review.


---

Comment by chapoton created at 2012-12-30 21:12:40

one comment : the last part of fundamental_group, where you use many nested tests to distinguish cases, does not look good and is hard to read. Maybe rather do something like

```
z = dict()
for i in range(3):
    if bdry[i] in spanning_tree:
        z[i] = FG.one()
    else:
        z[i] = FG.gen(gens_dict[bdry[i]])
```

and then

```
rels.append(z[0]*z[1].inverse()*z[2])
```

?


---

Comment by mmarco created at 2013-01-15 13:16:04

I think the suggestion of chapoton makes a lot of sense. Besides that, it looks good. I would be happy to give a positive review once the minor change is made.


---

Comment by mmarco created at 2013-01-15 13:16:57

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2013-01-15 21:17:33

Thank you for the suggestions. It may be a few weeks before I have time to implement anything.


---

Attachment


---

Comment by jhpalmieri created at 2013-02-07 20:58:13

Okay, here's a new version of the patch, with chapoton's suggested simpler code for computing the relations.


---

Comment by jhpalmieri created at 2013-02-07 20:58:13

Changing status from needs_work to needs_review.


---

Comment by mmarco created at 2013-02-08 18:04:23

Looks good to me. By checking this i discovered something the shouldn't happen, but it has nothing to do with this ticket:


```
sage: F=simplicial_complexes.Sphere(0)
sage: F.connected_component()
---------------------------------------------------------------------------
LookupError                               Traceback (most recent call last)
<ipython-input-48-5cd541b6e495> in <module>()
----> 1 F.connected_component()

/home/mmarco/sage-5.7.beta3/local/lib/python2.7/site-packages/sage/homology/simplicial_complex.pyc in connected_component(self, simplex)
   2911         else:
   2912             v = simplex[0]
-> 2913         vertices = self.graph().connected_component_containing_vertex(v)
   2914         facets = [f for f in self.facets() if f.is_face(Simplex(vertices))]
   2915         return SimplicialComplex(facets)

/home/mmarco/sage-5.7.beta3/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in connected_component_containing_vertex(self, vertex)
   3894         """
   3895         try:
-> 3896             c = list(self._backend.depth_first_search(vertex, ignore_direction=True))
   3897         except AttributeError:
   3898             c = list(self.depth_first_search(vertex, ignore_direction=True))

/home/mmarco/sage-5.7.beta3/local/lib/python2.7/site-packages/sage/graphs/base/c_graph.so in sage.graphs.base.c_graph.CGraphBackend.depth_first_search (sage/graphs/base/c_graph.c:17312)()

/home/mmarco/sage-5.7.beta3/local/lib/python2.7/site-packages/sage/graphs/base/c_graph.so in sage.graphs.base.c_graph.Search_iterator.__init__ (sage/graphs/base/c_graph.c:19227)()

LookupError: Vertex (0) is not a vertex of the graph.

```



---

Comment by mmarco created at 2013-02-08 18:05:05

Changing status from needs_review to positive_review.


---

Attachment


---

Comment by jhpalmieri created at 2013-02-08 19:06:28

Changing status from positive_review to needs_work.


---

Comment by jhpalmieri created at 2013-02-08 19:09:33

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2013-02-08 19:09:33

Since the milestone for this ticket has been pushed back to 5.8, we can fix the problem in [comment:7 comment 7] here, too. It's a one line fix: line 2543 in the new version. The rest of the patch is just modifications to doctests. It is possible that the various warnings like

```
This may give the wrong answer if the simplicial complex 
was constructed with ``maximality_check`` set to ``False``. 
```

may not be true any more, but I'm not sure. Since they say "This _may_ give the wrong answer ...", I think we can leave them intact. People should know to be careful when constructing simplicial complexes with `maximality_check=False`.


---

Comment by tscrim created at 2013-02-19 20:41:00

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-02-19 20:41:00

Looks good to me.


---

Comment by jdemeyer created at 2013-02-22 19:10:56

Resolution: fixed
