# Issue 33801: Add custom scaling feature for vectors in plot_vector_field3d() as available in ​VectorField.plot()

Issue created by migration from https://trac.sagemath.org/ticket/34038

Original creator: @niranjankm

Original creation time: 2022-06-21 05:22:13

Keywords: plot, vector, field3d,

`plot_vector_field3d()` lacks user defined scaling. By default the plotted vectors in the field are auto scaled (from 0 to 1) by using maximum length vector in the plotting domain. It is a very nice thing to auto scale like this as it avoids possible overprint of vectors with those ahead of them. But sometimes if user needs them to be scaled to a desired factor say 1 (no scaling) then for those situations we propose availability of user defined scaling as available in ​`VectorField.plot()`. This can be achieved by following modifications in `src/sage/plot/plot3d/plot_field3d.py`:

1. Add a new keyword `scale='auto'` to `plot_vector_field3d()` which can take any real number as scaling factor. Anything other than real number is ignored and auto scaling is performed. Default value 'auto' has nothing to do other than being a non-real quantity, a string, telling it to go with default auto scaling. We wish auto scaling be the default.

```python
def plot_vector_field3d(functions, xrange, yrange, zrange,
                        plot_points=5, colors='jet', center_arrows=False,
                        scale='auto', **kwds):
```


2. Modify the existing

```python
    max_len = max(v.norm() for v in vectors)
    scaled_vectors = [v/max_len for v in vectors]
```

into

```python
    if scale in RR:
        scaled_vectors = [v*scale for v in vectors]
    else: # For `scale` is anything other than real number
        max_len = max(v.norm() for v in vectors)
        scaled_vectors = [v/max_len for v in vectors]
```




---

Comment by @niranjankm created at 2022-06-25 07:01:02

Changing status from new to needs_review.


---

Comment by @niranjankm created at 2022-06-25 07:01:02

Changing keywords from "plot, vector, field3d," to "plot 3d vector field, plot_vector_field3d()".


---

Comment by @niranjankm created at 2022-06-25 07:02:52

Changing type from PLEASE CHANGE to enhancement.


---

Comment by @niranjankm created at 2022-07-27 18:09:30

Changing component from calculus to graphics.


---

Comment by @DaveWitteMorris created at 2022-07-27 20:43:34

Changing status from needs_review to needs_work.


---

Comment by @DaveWitteMorris created at 2022-07-27 20:43:34

A ticket should not be set to "needs review" until it has a git branch that incorporates the proposed changes.


---

Comment by kcrisman created at 2022-07-28 13:40:02

This isn't a bad idea at all - and your comment about 2d plots maybe implies #2922 is already done?  But it would also need a significant amount of documentation to show how it can be used.

See also:
* #7383
* #18641 (perhaps `scale='normalize'` if the approach on this ticket is taken)


---

Comment by @niranjankm created at 2022-07-28 15:17:35

No #2922 is not done. By default the vectors are normalized and scaling option is not provided.
Scaling is available in `VectorField.plot()` which is a part of sage manifolds but is a bit slow due to wide capabilities of sage manifolds and its methods.


---

Comment by kcrisman created at 2022-07-28 15:34:47

> Scaling is available in `VectorField.plot()` which is a part of sage manifolds but is a bit slow due to wide capabilities of sage manifolds and its methods.

I see.  So really we currently have two ways of getting vector fields - the plot methods and the manifold methods.  It might be nice to unify those somehow, though (obviously) not in this ticket.


---

Comment by @niranjankm created at 2022-07-28 15:53:10

Replying to [comment:7 kcrisman]:
> I see.  So really we currently have two ways of getting vector fields - the plot methods and the manifold methods.  It might be nice to unify those somehow, though (obviously) not in this ticket.

See Eric's comments in:

https://groups.google.com/g/sage-devel/c/tMH1RZNyC9s/m/aJhd3vDtAgAJ

https://groups.google.com/g/sage-devel/c/tMH1RZNyC9s/m/2FQTQrn3AgAJ 

https://groups.google.com/g/sage-devel/c/tMH1RZNyC9s/m/gKoZ5nkCAwAJ
