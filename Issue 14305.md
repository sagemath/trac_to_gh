# Issue 14305: Fix LaTeX of free algebras (and repr_lincomb)

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2013-05-01 01:18:35

Assignee: was

CC:  tscrim chapoton hoanguyen

Keywords: latex


```
sage: K.< alpha,b > = FreeAlgebra(SR)
sage: latex(alpha*b)
\alphab
```

Someone we are not using `repr_lincomb` correctly, and in fact that function itself looks pretty hackishly defined.  I couldn't even find a very good workaround.

See [the first report at ask.sagemath](http://ask.sagemath.org/question/2535/latex-form-of-product-of-non-commuting-variables).


---

Comment by ppurka created at 2013-08-03 16:28:28


```diff
diff --git a/sage/misc/latex.py b/sage/misc/latex.py
--- a/sage/misc/latex.py
+++ b/sage/misc/latex.py
`@``@` -2503,7 +2503,7 `@``@`
         '\\alpha'
     """
     if a in common_varnames:
-        return "\\" + a
+        return "\\" + a + "{}"
     elif len(a) == 1:
         return a
     elif is_fname is True:
```

This fixes the latex, but the raw latex doesn't look good any more.

```
sage: K.< alpha,b > = FreeAlgebra(SR)      
sage: latex(alpha*b)                       
\alpha{}b
```



---

Comment by ppurka created at 2013-08-03 16:35:30

In fact, what will break if we simply add a space after every such comman variable name?

```diff
--- a/sage/misc/latex.py
+++ b/sage/misc/latex.py
`@``@` -2503,7 +2503,7 `@``@`
         '\\alpha'
     """
     if a in common_varnames:
-        return "\\" + a
+        return "\\" + a + " "
     elif len(a) == 1:
         return a
     elif is_fname is True:
```

Visually, and in latex, this is probably the simplest fix.

_Edit_: Ok. Visually, this breaks subscripts and superscripts although the latex is fine.


---

Comment by mkoeppe created at 2020-06-18 01:55:49

Still broken in 9.2.beta1.

For `repr_lincomb` see also #29892.


---

Comment by @DaveWitteMorris created at 2020-06-18 03:06:02

Related ticket: #26606 (same problem for power series in one variable).


---

Comment by hoanguyen created at 2020-11-01 14:10:50

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-11-01 14:15:33

missing empty line after

```diff
+            Check that :trac:`14509` is fixed::
```


and doctests should be indented, or rather this line should be un-indented


---

Comment by git created at 2020-11-01 14:17:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-11-01 14:18:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-11-01 14:21:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-11-01 20:18:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-11-02 22:35:19

LGTM.


---

Comment by tscrim created at 2020-11-02 22:35:19

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-11-22 15:05:17

Resolution: fixed
