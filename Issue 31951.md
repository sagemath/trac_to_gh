# Issue 31951: Fix some doctests that fail for various random seeds

Issue created by migration from https://trac.sagemath.org/ticket/32188

Original creator: @kliem

Original creation time: 2021-07-12 15:55:15

CC:  mjo

We fix some doctests or mark them as `# not tested` that were discovered when testing #29935. This should make the review of #29935 easier.

All the tests failed for some random seed during

```
sage -t --long --all --random-seed=n
```



---

Comment by @kliem created at 2021-07-12 15:55:28

New commits:


---

Comment by @kliem created at 2021-07-12 15:55:28

Changing status from new to needs_review.


---

Comment by mjo created at 2021-07-21 13:07:17

I've made three review commits: two just re-enable the tests for #32095 and #32185, and the last one tries to do something more useful with that rank example over `GF(2^4)[a]`.

I have one other question:


```
sage: while True:
....:     try:
....:         y = Chan(c)
....:         D.decode_to_message(y)
....:     except ZeroDivisionError:
....:         pass
```


That looks suspicious to me. It's looping until... what? Neither `c`,`D`, nor `y` change inside the loop unless there's some randomness I missed.

Otherwise the rest LGTM.


---

Comment by @kliem created at 2021-09-01 09:17:13

New commits:


---

Comment by mjo created at 2021-09-01 23:41:36

To answer my own question from comment:3, it looks like `Chan(c)` does something that eliminates the `ZeroDivisionError`, leading to the `DecodingError` that we expect:


```python
# We arrive at this point by running
# c = C.random_element(); y = Chan(c); D.decode_to_message(y)
# in a loop until a ZeroDivisionError is thrown.
sage: c                                                                         
(56, 57, 51, 49, 50, 51, 18, 6, 56, 35, 53, 49, 25, 47, 19, 31, 3, 22, 34, 38, 53, 34, 29, 15, 58, 38, 21, 53, 23, 14, 1, 23, 22, 37, 39, 12, 8, 23, 39, 37)
sage: y                                                                         
(56, 22, 51, 36, 50, 10, 18, 6, 56, 35, 53, 49, 58, 56, 53, 31, 3, 22, 34, 3, 53, 34, 38, 15, 0, 38, 21, 0, 46, 3, 1, 23, 43, 42, 39, 12, 8, 23, 33, 37)
sage: D.decode_to_message(y)
...
ZeroDivisionError: inverse of Mod(0, 59) does not exist
sage: y = Chan(c)                                                               
sage: D.decode_to_message(y)
...
DecodingError: Decoding failed because the number of errors exceeded the decoding radius
```


Regardless... it's doing what it should somehow.


---

Comment by mjo created at 2021-09-02 01:31:45

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-09-02 05:41:46

Thank you.

I had somehow forgotten about your question from comment:3.


---

Comment by vbraun created at 2021-09-07 20:52:25

Resolution: fixed
