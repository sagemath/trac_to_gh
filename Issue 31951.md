# Issue 31951: Fix some doctests that fail for various random seeds

archive/issues_031951.json:
```json
{
    "body": "CC:  @orlitzky\n\nWe fix some doctests or mark them as `# not tested` that were discovered when testing #29935. This should make the review of #29935 easier.\n\nAll the tests failed for some random seed during\n\n```\nsage -t --long --all --random-seed=n\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32188\n\n",
    "created_at": "2021-07-12T15:55:15Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Fix some doctests that fail for various random seeds",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31951",
    "user": "https://github.com/kliem"
}
```
CC:  @orlitzky

We fix some doctests or mark them as `# not tested` that were discovered when testing #29935. This should make the review of #29935 easier.

All the tests failed for some random seed during

```
sage -t --long --all --random-seed=n
```


Issue created by migration from https://trac.sagemath.org/ticket/32188





---

archive/issue_comments_455991.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455991",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_455992.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455992",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_455993.json:
```json
{
    "body": "I've made three review commits: two just re-enable the tests for #32095 and #32185, and the last one tries to do something more useful with that rank example over `GF(2^4)[a]`.\n\nI have one other question:\n\n\n```\nsage: while True:\n....:     try:\n....:         y = Chan(c)\n....:         D.decode_to_message(y)\n....:     except ZeroDivisionError:\n....:         pass\n```\n\n\nThat looks suspicious to me. It's looping until... what? Neither `c`,`D`, nor `y` change inside the loop unless there's some randomness I missed.\n\nOtherwise the rest LGTM.",
    "created_at": "2021-07-21T13:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455993",
    "user": "https://github.com/orlitzky"
}
```

I've made three review commits: two just re-enable the tests for #32095 and #32185, and the last one tries to do something more useful with that rank example over `GF(2^4)[a]`.

I have one other question:


```
sage: while True:
....:     try:
....:         y = Chan(c)
....:         D.decode_to_message(y)
....:     except ZeroDivisionError:
....:         pass
```


That looks suspicious to me. It's looping until... what? Neither `c`,`D`, nor `y` change inside the loop unless there's some randomness I missed.

Otherwise the rest LGTM.



---

archive/issue_comments_455994.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-09-01T09:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455994",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_455995.json:
```json
{
    "body": "To answer my own question from comment:3, it looks like `Chan(c)` does something that eliminates the `ZeroDivisionError`, leading to the `DecodingError` that we expect:\n\n\n```python\n# We arrive at this point by running\n# c = C.random_element(); y = Chan(c); D.decode_to_message(y)\n# in a loop until a ZeroDivisionError is thrown.\nsage: c                                                                         \n(56, 57, 51, 49, 50, 51, 18, 6, 56, 35, 53, 49, 25, 47, 19, 31, 3, 22, 34, 38, 53, 34, 29, 15, 58, 38, 21, 53, 23, 14, 1, 23, 22, 37, 39, 12, 8, 23, 39, 37)\nsage: y                                                                         \n(56, 22, 51, 36, 50, 10, 18, 6, 56, 35, 53, 49, 58, 56, 53, 31, 3, 22, 34, 3, 53, 34, 38, 15, 0, 38, 21, 0, 46, 3, 1, 23, 43, 42, 39, 12, 8, 23, 33, 37)\nsage: D.decode_to_message(y)\n...\nZeroDivisionError: inverse of Mod(0, 59) does not exist\nsage: y = Chan(c)                                                               \nsage: D.decode_to_message(y)\n...\nDecodingError: Decoding failed because the number of errors exceeded the decoding radius\n```\n\n\nRegardless... it's doing what it should somehow.",
    "created_at": "2021-09-01T23:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455995",
    "user": "https://github.com/orlitzky"
}
```

To answer my own question from comment:3, it looks like `Chan(c)` does something that eliminates the `ZeroDivisionError`, leading to the `DecodingError` that we expect:


```python
# We arrive at this point by running
# c = C.random_element(); y = Chan(c); D.decode_to_message(y)
# in a loop until a ZeroDivisionError is thrown.
sage: c                                                                         
(56, 57, 51, 49, 50, 51, 18, 6, 56, 35, 53, 49, 25, 47, 19, 31, 3, 22, 34, 38, 53, 34, 29, 15, 58, 38, 21, 53, 23, 14, 1, 23, 22, 37, 39, 12, 8, 23, 39, 37)
sage: y                                                                         
(56, 22, 51, 36, 50, 10, 18, 6, 56, 35, 53, 49, 58, 56, 53, 31, 3, 22, 34, 3, 53, 34, 38, 15, 0, 38, 21, 0, 46, 3, 1, 23, 43, 42, 39, 12, 8, 23, 33, 37)
sage: D.decode_to_message(y)
...
ZeroDivisionError: inverse of Mod(0, 59) does not exist
sage: y = Chan(c)                                                               
sage: D.decode_to_message(y)
...
DecodingError: Decoding failed because the number of errors exceeded the decoding radius
```


Regardless... it's doing what it should somehow.



---

archive/issue_comments_455996.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-02T01:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455996",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_455997.json:
```json
{
    "body": "Thank you.\n\nI had somehow forgotten about your question from comment:3.",
    "created_at": "2021-09-02T05:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455997",
    "user": "https://github.com/kliem"
}
```

Thank you.

I had somehow forgotten about your question from comment:3.



---

archive/issue_events_029056.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-07T20:52:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31951#event-29056"
}
```



---

archive/issue_comments_455998.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-07T20:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31951#issuecomment-455998",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
