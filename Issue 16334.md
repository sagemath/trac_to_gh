# Issue 16334: APNG (Animated PNG) for animations

archive/issues_016334.json:
```json
{
    "body": "CC:  @nilesjohnson\n\nCurrently the creation of animations depends on external tools: either [ImageMagick](http://www.imagemagick.org) or [FFmpeg](http://www.ffmpeg.org) must be available. Either of these can be used to assemble a sequence of PNG frames into a GIF animation. However, GIF is a very limited format, and the conversion (I guess mostly the color reduction) takes time and costs quality.\n\nA more modern alternative would be [APNG](https://wiki.mozilla.org/APNG_Specification). It's an extension of the PNG standard. One drawback is that only [some browsers support it](http://caniuse.com/#feat=apng). The others would show the first frame of the animation as still image instead. (We could later extend the code so one can specify any image of equal size to be used as fallback.)\n\nAssembling multiple PNG files into a single animation is fairly simple. In fact so simple that it can be accomplished without using any external libraries at all. I wrote such an implementation while working on #16533 and would like to offer it here for inclusion.\n\nThe branch I'm going to append uses commits from #16533 and #16570, so if those get merged before, you will have less to review here.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16571\n\n",
    "created_at": "2014-06-27T18:38:36Z",
    "labels": [
        "component: graphics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "APNG (Animated PNG) for animations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16334",
    "user": "https://github.com/gagern"
}
```
CC:  @nilesjohnson

Currently the creation of animations depends on external tools: either [ImageMagick](http://www.imagemagick.org) or [FFmpeg](http://www.ffmpeg.org) must be available. Either of these can be used to assemble a sequence of PNG frames into a GIF animation. However, GIF is a very limited format, and the conversion (I guess mostly the color reduction) takes time and costs quality.

A more modern alternative would be [APNG](https://wiki.mozilla.org/APNG_Specification). It's an extension of the PNG standard. One drawback is that only [some browsers support it](http://caniuse.com/#feat=apng). The others would show the first frame of the animation as still image instead. (We could later extend the code so one can specify any image of equal size to be used as fallback.)

Assembling multiple PNG files into a single animation is fairly simple. In fact so simple that it can be accomplished without using any external libraries at all. I wrote such an implementation while working on #16533 and would like to offer it here for inclusion.

The branch I'm going to append uses commits from #16533 and #16570, so if those get merged before, you will have less to review here.

Issue created by migration from https://trac.sagemath.org/ticket/16571





---

archive/issue_comments_213874.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-06-27T19:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213874",
    "user": "https://github.com/gagern"
}
```

New commits:



---

archive/issue_comments_213875.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-27T19:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213875",
    "user": "https://github.com/gagern"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_213876.json:
```json
{
    "body": "`sage -coverage` complains about missing doctests in all methods of my `APngAssembler` class. But the doctest in the class documentation tests all the methos implicitely. And checking whether the result is actually correct would mean either looking at a generated picture yourself, or writing down long byte sequences of image file content. Is my current lack of doctests acceptable in this case?",
    "created_at": "2014-06-30T08:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213876",
    "user": "https://github.com/gagern"
}
```

`sage -coverage` complains about missing doctests in all methods of my `APngAssembler` class. But the doctest in the class documentation tests all the methos implicitely. And checking whether the result is actually correct would mean either looking at a generated picture yourself, or writing down long byte sequences of image file content. Is my current lack of doctests acceptable in this case?



---

archive/issue_comments_213877.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-11T21:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213877",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_213878.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2014-07-12T17:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213878",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_213879.json:
```json
{
    "body": "Rebased onto #16645. There are a lot of commits from the dependencies listed above. Only three commits are excludive to this ticket here, so [these are the changes](http://git.sagemath.org/sage.git/diff/?h=a60fe0b14aa4094c86c5efb387f9fd5a9706a218&id2=bb7307f0649cfa90916f74c102d1d09a424b759a) that need to be reviewed in this ticket here.\n\nAt the moment, the APNG support isn't integrated with the `save` and `show` methods. I'd do so based on #7298, but in order to avoid dependency hell, I'll deal with this in a separate ticket so you can review the changes here independently.",
    "created_at": "2014-07-12T17:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213879",
    "user": "https://github.com/gagern"
}
```

Rebased onto #16645. There are a lot of commits from the dependencies listed above. Only three commits are excludive to this ticket here, so [these are the changes](http://git.sagemath.org/sage.git/diff/?h=a60fe0b14aa4094c86c5efb387f9fd5a9706a218&id2=bb7307f0649cfa90916f74c102d1d09a424b759a) that need to be reviewed in this ticket here.

At the moment, the APNG support isn't integrated with the `save` and `show` methods. I'd do so based on #7298, but in order to avoid dependency hell, I'll deal with this in a separate ticket so you can review the changes here independently.



---

archive/issue_comments_213880.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-12T17:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213880",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_213881.json:
```json
{
    "body": "I'm slightly nervous about the long-term stability of the apng format, but given how easy it is to implement and how nice the results are, I suppose this is a reasonable addition.  Some questions/comments:\n\n* I would expect a method named `APngAssembler.frame` to return a frame.  Would `add_frame` or `append_frame` or something similar be a better name for this?\n\n* Since the docstring of `APngAssembler.__init__` won't appear in the manual, it might be more useful to move that information to the class docstring.\n\n* most of the `APngAssembler` methods are missing doctests.\n\n* Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?",
    "created_at": "2014-07-15T13:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213881",
    "user": "https://github.com/nilesjohnson"
}
```

I'm slightly nervous about the long-term stability of the apng format, but given how easy it is to implement and how nice the results are, I suppose this is a reasonable addition.  Some questions/comments:

* I would expect a method named `APngAssembler.frame` to return a frame.  Would `add_frame` or `append_frame` or something similar be a better name for this?

* Since the docstring of `APngAssembler.__init__` won't appear in the manual, it might be more useful to move that information to the class docstring.

* most of the `APngAssembler` methods are missing doctests.

* Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?



---

archive/issue_comments_213882.json:
```json
{
    "body": "Replying to [comment:7 niles]:\n> I'm slightly nervous about the long-term stability of the apng format [\u2026]\n\nI'm less worried about stability and more worried about market share. If one day MNG gets widely adopted, it might make APNG superfluous. But I don't see that coming soon.\n\n> * I would expect a method named `APngAssembler.frame` to return a frame.  Would `add_frame` or `append_frame` or something similar be a better name for this?\n\nFine with me. I will include it in my next commit. I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?\n\n> * Since the docstring of `APngAssembler.__init__` won't appear in the manual, it might be more useful to move that information to the class docstring.\n\nOh, I hadn't realized that. Sure, will move that.\n\n> * most of the `APngAssembler` methods are missing doctests.\n\nMentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.\n\nBy the way, should I prepend a `_` to all my internal methods?\n\n> * Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?\n\nQuoting from the commit message of that commit: \u201cThe APNG pipeline requires the number of frames up front\u201d. I guess I could also save the *number* of frames, instead of the frames themselves. Would you prefer that? It would even be consistent with the doctest.\n\nAn inferior alternative would be copying what `graphics_array()` does:\n\n\n```\n        frame_list = list(self._frames)\n        n = len(frame_list)\n```\n\n\nThere you also have to maintain the list of all frames in memory, although arguably only for the duration of the method call. What I consider even more harmful, however, is the fact that the frames will be generated multiple times. In my opinion, a generator should only be traversed once for the workflow from construction to APNG output, and that one occurrence should be when building the PNGs.",
    "created_at": "2014-07-15T14:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213882",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:7 niles]:
> I'm slightly nervous about the long-term stability of the apng format […]

I'm less worried about stability and more worried about market share. If one day MNG gets widely adopted, it might make APNG superfluous. But I don't see that coming soon.

> * I would expect a method named `APngAssembler.frame` to return a frame.  Would `add_frame` or `append_frame` or something similar be a better name for this?

Fine with me. I will include it in my next commit. I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?

> * Since the docstring of `APngAssembler.__init__` won't appear in the manual, it might be more useful to move that information to the class docstring.

Oh, I hadn't realized that. Sure, will move that.

> * most of the `APngAssembler` methods are missing doctests.

Mentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.

By the way, should I prepend a `_` to all my internal methods?

> * Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?

Quoting from the commit message of that commit: “The APNG pipeline requires the number of frames up front”. I guess I could also save the *number* of frames, instead of the frames themselves. Would you prefer that? It would even be consistent with the doctest.

An inferior alternative would be copying what `graphics_array()` does:


```
        frame_list = list(self._frames)
        n = len(frame_list)
```


There you also have to maintain the list of all frames in memory, although arguably only for the duration of the method call. What I consider even more harmful, however, is the fact that the frames will be generated multiple times. In my opinion, a generator should only be traversed once for the workflow from construction to APNG output, and that one occurrence should be when building the PNGs.



---

archive/issue_comments_213883.json:
```json
{
    "body": "Replying to [comment:8 gagern]:\n> Replying to [comment:7 niles]:\n\n> \n> I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?\n\nLet's use whatever term the APNG developers (Mozilla?) use for it . . . \n\n> \n> > * most of the `APngAssembler` methods are missing doctests.\n> \n> Mentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.\n\nwell, we have to have doctests . . . even if humans don't read them, they're very useful in making sure that new code doesn't break old code.  When writing them, think \"What is a machine-checkable way to ensure that this method is producing what it claims to produce?\"  The current doctest for `APngAssembler` is probably overkill.  Also note that, if necessary, you can use the `#indirect doctest` flag to mark doctests which check the relevant method implicitly, but not explicitly.\n\n> \n> By the way, should I prepend a `_` to all my internal methods?\n\nIt's sort of a grey area . . . the key difference is that underscore methods won't show up in the reference manual, for better or worse.\n\n\n\n> \n> > * Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?\n> \n> Quoting from the commit message of that commit: \u201cThe APNG pipeline requires the number of frames up front\u201d. \n\nI see.  I haven't checked to see why that's necessary . . . are you sure it can't be avoided?\n\n> I guess I could also save the *number* of frames, instead of the frames themselves. \n\nIf you can do that without loading them all into memory, that would be great\n\n> \n> An inferior alternative would be copying what `graphics_array()` does:\n> \n> {{{\n>         frame_list = list(self._frames)\n>         n = len(frame_list)\n> }}}\n> \n> There you also have to maintain the list of all frames in memory, although arguably only for the duration of the method call. What I consider even more harmful, however, is the fact that the frames will be generated multiple times. \n\nright\n\n> In my opinion, a generator should only be traversed once for the workflow from construction to APNG output, and that one occurrence should be when building the PNGs.\n\nI fully agree.  Ideally, this is done one item at a time, rather than loading all frames into memory simultaneously.",
    "created_at": "2014-07-15T15:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213883",
    "user": "https://github.com/nilesjohnson"
}
```

Replying to [comment:8 gagern]:
> Replying to [comment:7 niles]:

> 
> I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?

Let's use whatever term the APNG developers (Mozilla?) use for it . . . 

> 
> > * most of the `APngAssembler` methods are missing doctests.
> 
> Mentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.

well, we have to have doctests . . . even if humans don't read them, they're very useful in making sure that new code doesn't break old code.  When writing them, think "What is a machine-checkable way to ensure that this method is producing what it claims to produce?"  The current doctest for `APngAssembler` is probably overkill.  Also note that, if necessary, you can use the `#indirect doctest` flag to mark doctests which check the relevant method implicitly, but not explicitly.

> 
> By the way, should I prepend a `_` to all my internal methods?

It's sort of a grey area . . . the key difference is that underscore methods won't show up in the reference manual, for better or worse.



> 
> > * Not sure if it's part of this ticket, but I really think [converting a generator to a list when rendering frames](http://git.sagemath.org/sage.git/commit/?id=a60fe0b14aa4094c86c5efb387f9fd5a9706a218) is a bad idea.  When there are lots of very large frames, this becomes becomes time and memory intensive.  What advantage do you see?
> 
> Quoting from the commit message of that commit: “The APNG pipeline requires the number of frames up front”. 

I see.  I haven't checked to see why that's necessary . . . are you sure it can't be avoided?

> I guess I could also save the *number* of frames, instead of the frames themselves. 

If you can do that without loading them all into memory, that would be great

> 
> An inferior alternative would be copying what `graphics_array()` does:
> 
> {{{
>         frame_list = list(self._frames)
>         n = len(frame_list)
> }}}
> 
> There you also have to maintain the list of all frames in memory, although arguably only for the duration of the method call. What I consider even more harmful, however, is the fact that the frames will be generated multiple times. 

right

> In my opinion, a generator should only be traversed once for the workflow from construction to APNG output, and that one occurrence should be when building the PNGs.

I fully agree.  Ideally, this is done one item at a time, rather than loading all frames into memory simultaneously.



---

archive/issue_comments_213884.json:
```json
{
    "body": "Replying to [comment:9 niles]:\n> Replying to [comment:8 gagern]:\n> > I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?\n> \n> Let's use whatever term the APNG developers (Mozilla?) use for it . . . \n\nMozilla terminology is talking about a \u201cdefault image\u201d which either is the first frame or \u201cnot part of the animation\u201d. So I'm looking for a name to set a default image which is not part of the animation. `set_default_image`? My main concern here is the verb, since this sounds like a simple setter with no heavy lifting.\n\n> > > * most of the `APngAssembler` methods are missing doctests.\n> > \n> > Mentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.\n> \n> well, we have to have doctests . . . even if humans don't read them, they're very useful in making sure that new code doesn't break old code.  When writing them, think \"What is a machine-checkable way to ensure that this method is producing what it claims to produce?\"  The current doctest for `APngAssembler` is probably overkill.  Also note that, if necessary, you can use the `#indirect doctest` flag to mark doctests which check the relevant method implicitly, but not explicitly.\n\nI've started to write a doctest for each of my methods, see [here](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/plot/animate.py?id=5786dcf2a441ebf81578b7c54ec02031c60e7f37#n961) for the current state of affairs. But I'm very unhappy about this. Most of the methods I consider private (and I added `_` to them by now). Each of them doesn't do much on its own; it relies on the interplay with the other methods to make things work. So I have basically two options.\n\nOn the one hand I could see what internal variables each of the other methods would set up front, then reproduce this in the example, and test the result of a single method in response to that. But this fixes the internal mechanics of the whole class into the doctest, i.e. I'm testing *how* things get done, not only that they get done. This feels wrong.\n\nOn the other hand, I could write a doctest which uses high level calls, but whose output depends on the method I want to test. That's these indirect doctests you mentioned. But there would be a lot of boilerplate code for each method, and most things would be common for all tests. In the end, I'd have 20 lines of doctests for 3 lines of code, most of these similar for all methods in question.\n\nSo instead of one doctest per method, I'd like to have a single doctest which tests the whole machinery, designed in such a way that it will only work if all the parts interact as intended. In fact in the code I linked above there is such a test for the `frame` method. Can I omit the doctests for the individual methods if I have some doctest somewhere which tests them all? Should I somehow indicate that the test for these is somewhere else?\n\nI've just [posted to sage-devel](https://groups.google.com/forum/#!topic/sage-devel/TtMkK6MTrOM) to obtain some broader input on this question of doctest granularity.\n\nThere is one other problem with the doctests as they currently are: Sphinx is choking on them.\n\n\n```\n[plotting ] Sphinx error:\n[plotting ] 'ascii' codec can't decode byte 0x89 in position 683: ordinal not in range(128)\nError building the documentation.\n```\n\n\nI have no idea why Sphinx is trying to decode a string literal here, but this might make doctests using binary data almost impossible. Which means that I'll likely have to build the data in question from some `struct` calls, or write a helper function to convert largish chunks of hex to binary, or whatever.",
    "created_at": "2014-07-16T11:42:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213884",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:9 niles]:
> Replying to [comment:8 gagern]:
> > I guess that in the long run, I might also add a method which I'd have called `fallback` or `still`, which can be used to set the fallback image to something other than the first frame. Would you prefer `set_still` or `add_fallback` or something like this?
> 
> Let's use whatever term the APNG developers (Mozilla?) use for it . . . 

Mozilla terminology is talking about a “default image” which either is the first frame or “not part of the animation”. So I'm looking for a name to set a default image which is not part of the animation. `set_default_image`? My main concern here is the verb, since this sounds like a simple setter with no heavy lifting.

> > > * most of the `APngAssembler` methods are missing doctests.
> > 
> > Mentioned that problem in comment:3. I can try to come up with some doctests if you insist, but they'd be pretty ugly to read.
> 
> well, we have to have doctests . . . even if humans don't read them, they're very useful in making sure that new code doesn't break old code.  When writing them, think "What is a machine-checkable way to ensure that this method is producing what it claims to produce?"  The current doctest for `APngAssembler` is probably overkill.  Also note that, if necessary, you can use the `#indirect doctest` flag to mark doctests which check the relevant method implicitly, but not explicitly.

I've started to write a doctest for each of my methods, see [here](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/plot/animate.py?id=5786dcf2a441ebf81578b7c54ec02031c60e7f37#n961) for the current state of affairs. But I'm very unhappy about this. Most of the methods I consider private (and I added `_` to them by now). Each of them doesn't do much on its own; it relies on the interplay with the other methods to make things work. So I have basically two options.

On the one hand I could see what internal variables each of the other methods would set up front, then reproduce this in the example, and test the result of a single method in response to that. But this fixes the internal mechanics of the whole class into the doctest, i.e. I'm testing *how* things get done, not only that they get done. This feels wrong.

On the other hand, I could write a doctest which uses high level calls, but whose output depends on the method I want to test. That's these indirect doctests you mentioned. But there would be a lot of boilerplate code for each method, and most things would be common for all tests. In the end, I'd have 20 lines of doctests for 3 lines of code, most of these similar for all methods in question.

So instead of one doctest per method, I'd like to have a single doctest which tests the whole machinery, designed in such a way that it will only work if all the parts interact as intended. In fact in the code I linked above there is such a test for the `frame` method. Can I omit the doctests for the individual methods if I have some doctest somewhere which tests them all? Should I somehow indicate that the test for these is somewhere else?

I've just [posted to sage-devel](https://groups.google.com/forum/#!topic/sage-devel/TtMkK6MTrOM) to obtain some broader input on this question of doctest granularity.

There is one other problem with the doctests as they currently are: Sphinx is choking on them.


```
[plotting ] Sphinx error:
[plotting ] 'ascii' codec can't decode byte 0x89 in position 683: ordinal not in range(128)
Error building the documentation.
```


I have no idea why Sphinx is trying to decode a string literal here, but this might make doctests using binary data almost impossible. Which means that I'll likely have to build the data in question from some `struct` calls, or write a helper function to convert largish chunks of hex to binary, or whatever.



---

archive/issue_comments_213885.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-16T12:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_213886.json:
```json
{
    "body": "I rebased this branch and reordered my commits. Now I can more easily amend the latest commit. And I can also provide a stable link to [the changes which need reviewing here](http://git.sagemath.org/sage.git/diff/?h=u/gagern/ticket/16571&id2=bc9f6817c788390bec1a4388b73a191819ab67bb), based on the merge which is now the first commit not shared with some other ticket.\n\nThe core currently has two major tests for the `APngAssembler` class, one for each public method. These will test all the internal methods as well. I realized that my Sphinx problems were due to the fact that I started my docstring with `\"\"\"` not `r\"\"\"`. But by that time I had my tests converted to make use of the `h2b` utility function, and I found that the file content looked far more readable in that format, so I kept it.",
    "created_at": "2014-07-16T13:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213886",
    "user": "https://github.com/gagern"
}
```

I rebased this branch and reordered my commits. Now I can more easily amend the latest commit. And I can also provide a stable link to [the changes which need reviewing here](http://git.sagemath.org/sage.git/diff/?h=u/gagern/ticket/16571&id2=bc9f6817c788390bec1a4388b73a191819ab67bb), based on the merge which is now the first commit not shared with some other ticket.

The core currently has two major tests for the `APngAssembler` class, one for each public method. These will test all the internal methods as well. I realized that my Sphinx problems were due to the fact that I started my docstring with `"""` not `r"""`. But by that time I had my tests converted to make use of the `h2b` utility function, and I found that the file content looked far more readable in that format, so I kept it.



---

archive/issue_comments_213887.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-02T21:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_213888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-12-09T19:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_213889.json:
```json
{
    "body": "Rebased to handle changes from #16570. It would be really nice if we could get this merged one day soon.\n\nIn case the way I implemented doctests for my public methods, and avoided doctests for my internal methods, is still causing worries, I'd like some *specific* input on how to improve things. Yes, I've heard that every method should have a doctest, that there should be as few exceptions as possible, but I still honestly fail to see how I can *reasonably* do so for the case at hand. At the moment I have class-level documentation for the `APngAssembler` class, which I'm fully comfortable with. I also have two public methods, `add_frame` and `set_default` which are tested using a hex representation of binary file content. A but bulky, but perhaps appropriate. If you want me to, I can move the `h2b` function which turns hex to binary from the doctest to the code proper.\n\nAnd I have a bunch of internal methods which each do very little but which interact with one another in a tight net. They converse not only using parameters and return values but also member variables, so state plays a major role and setting up state would make doctests pretty big. All of these methods are tested implicitely by the tests for the public methods. No user is ever intended to call any of them by itself. Their interplay behind the scenes may change at any time, as long as the end result remains the same. Therefore I see no use at all in doctesting them. Documenting yes, but not testing.\n\nIf you can agree with the above approach, I'd welcome a positive review. If not, please tell me not only that this violates sage standards, but be more specific in what kind of doctest you would like to see added to what code location.",
    "created_at": "2014-12-09T19:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213889",
    "user": "https://github.com/gagern"
}
```

Rebased to handle changes from #16570. It would be really nice if we could get this merged one day soon.

In case the way I implemented doctests for my public methods, and avoided doctests for my internal methods, is still causing worries, I'd like some *specific* input on how to improve things. Yes, I've heard that every method should have a doctest, that there should be as few exceptions as possible, but I still honestly fail to see how I can *reasonably* do so for the case at hand. At the moment I have class-level documentation for the `APngAssembler` class, which I'm fully comfortable with. I also have two public methods, `add_frame` and `set_default` which are tested using a hex representation of binary file content. A but bulky, but perhaps appropriate. If you want me to, I can move the `h2b` function which turns hex to binary from the doctest to the code proper.

And I have a bunch of internal methods which each do very little but which interact with one another in a tight net. They converse not only using parameters and return values but also member variables, so state plays a major role and setting up state would make doctests pretty big. All of these methods are tested implicitely by the tests for the public methods. No user is ever intended to call any of them by itself. Their interplay behind the scenes may change at any time, as long as the end result remains the same. Therefore I see no use at all in doctesting them. Documenting yes, but not testing.

If you can agree with the above approach, I'd welcome a positive review. If not, please tell me not only that this violates sage standards, but be more specific in what kind of doctest you would like to see added to what code location.



---

archive/issue_comments_213890.json:
```json
{
    "body": "Replying to [comment:16 gagern]:\n> Rebased to handle changes from #16570. It would be really nice if we could get this merged one day soon.\n\nAgreed.\n\n> \n> In case the way I implemented doctests for my public methods, and avoided doctests for my internal methods, is still causing worries, I'd like some *specific* input on how to improve things. \n\nSpecific input: Write a doctest for every method.  The feedback from [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/TtMkK6MTrOM) was uniform on this point, and I think it would be unwise to ignore it.\n\n> Yes, I've heard that every method should have a doctest, that there should be as few exceptions as possible, but I still honestly fail to see how I can *reasonably* do so for the case at hand. \n> . . . \n> so state plays a major role and setting up state would make doctests pretty big. \n\nCan you write a function which sets up a test state, or load a pickled test state?  I believe this is what Volker was indicating when he mentioned [fixtures](https://en.wikipedia.org/wiki/Test_fixture).\n\n\n> All of these methods are tested implicitely by the tests for the public methods. \n\nAnd if one of them breaks, and you're not around to fix it, how will someone figure out what's broken?\n\n> No user is ever intended to call any of them by itself. \n\nUnfortunately your intentions don't control what others may do, either now or in the future.  The requirement that all methods be tested is important because none of us can control, or even reliably predict, what will happen in the future.",
    "created_at": "2014-12-10T13:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213890",
    "user": "https://github.com/nilesjohnson"
}
```

Replying to [comment:16 gagern]:
> Rebased to handle changes from #16570. It would be really nice if we could get this merged one day soon.

Agreed.

> 
> In case the way I implemented doctests for my public methods, and avoided doctests for my internal methods, is still causing worries, I'd like some *specific* input on how to improve things. 

Specific input: Write a doctest for every method.  The feedback from [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/TtMkK6MTrOM) was uniform on this point, and I think it would be unwise to ignore it.

> Yes, I've heard that every method should have a doctest, that there should be as few exceptions as possible, but I still honestly fail to see how I can *reasonably* do so for the case at hand. 
> . . . 
> so state plays a major role and setting up state would make doctests pretty big. 

Can you write a function which sets up a test state, or load a pickled test state?  I believe this is what Volker was indicating when he mentioned [fixtures](https://en.wikipedia.org/wiki/Test_fixture).


> All of these methods are tested implicitely by the tests for the public methods. 

And if one of them breaks, and you're not around to fix it, how will someone figure out what's broken?

> No user is ever intended to call any of them by itself. 

Unfortunately your intentions don't control what others may do, either now or in the future.  The requirement that all methods be tested is important because none of us can control, or even reliably predict, what will happen in the future.



---

archive/issue_comments_213891.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-15T22:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_213892.json:
```json
{
    "body": "Replying to [comment:17 niles]:\n> Can you write a function which sets up a test state, or load a pickled test state?  I believe this is what Volker was indicating when he mentioned [fixtures](https://en.wikipedia.org/wiki/Test_fixture).\n\nOK, now I have test data in a class method, and can run a test case using that test data without including all the binary data in the doctest text. What is even more important, I can see the interaction of a given method with the object state using a tracing fixture I newly introduced for this purpose.\n\n> > All of these methods are tested implicitely by the tests for the public methods. \n> \n> And if one of them breaks, and you're not around to fix it, how will someone figure out what's broken?\n\nThe same way the internal workings behind any other public interface are fixed: by reading the docstring of the public interface, by examining the failing doctest of the public interface if there is any, by reading the comments (and in case of internal methods even docstrings) of the internal code, and by understanding the portion of internal code relevant to the problem. There is nothing magic about method boundaries. So as long as you don't require doctests for each and every line of code, I see no reason to doctest internal methods. As it stands, nested functions are usually without doctests, so should I use nested functions instead of classes with private methods? Or should we force everyone to doctest internal functions as well? Perhaps lambdas, too?\n\n> > No user is ever intended to call any of them by itself. \n> \n> Unfortunately your intentions don't control what others may do, either now or in the future.  The requirement that all methods be tested is important because none of us can control, or even reliably predict, what will happen in the future.\n\nSorry, but users using code which is clearly designated internal are on their own. You can't take an arbitrary Sage object, mess directly with its internal state and hope for the result to behave in any reasonable way. Why would internal methods be any different?\n\nIf a sage developer at some point realizes that code could be reused by making a private method public, then that method should get doctested as well. But the same again holds for any piece of code: if some developer finds that a certain portion of an existing method could be reused, he's welcome to factor that out into a new public method and add doctests for it. Again I see no difference here, except that by adding doctests to internal methods I suggest that I might be willing to guarantee certain internal behavior in the future. Which I'm not, as long as the public interface remains.\n\nSorry for the rant. I'm still far from happy with this strict requirement. But since you are right and the mailing list feedback confirmed that requirement, I'm trying to make the best of it, and here it is. Now every method has a doctest, and every doctest shows the tested method in action. Can you give this a positive review?",
    "created_at": "2014-12-15T22:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213892",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:17 niles]:
> Can you write a function which sets up a test state, or load a pickled test state?  I believe this is what Volker was indicating when he mentioned [fixtures](https://en.wikipedia.org/wiki/Test_fixture).

OK, now I have test data in a class method, and can run a test case using that test data without including all the binary data in the doctest text. What is even more important, I can see the interaction of a given method with the object state using a tracing fixture I newly introduced for this purpose.

> > All of these methods are tested implicitely by the tests for the public methods. 
> 
> And if one of them breaks, and you're not around to fix it, how will someone figure out what's broken?

The same way the internal workings behind any other public interface are fixed: by reading the docstring of the public interface, by examining the failing doctest of the public interface if there is any, by reading the comments (and in case of internal methods even docstrings) of the internal code, and by understanding the portion of internal code relevant to the problem. There is nothing magic about method boundaries. So as long as you don't require doctests for each and every line of code, I see no reason to doctest internal methods. As it stands, nested functions are usually without doctests, so should I use nested functions instead of classes with private methods? Or should we force everyone to doctest internal functions as well? Perhaps lambdas, too?

> > No user is ever intended to call any of them by itself. 
> 
> Unfortunately your intentions don't control what others may do, either now or in the future.  The requirement that all methods be tested is important because none of us can control, or even reliably predict, what will happen in the future.

Sorry, but users using code which is clearly designated internal are on their own. You can't take an arbitrary Sage object, mess directly with its internal state and hope for the result to behave in any reasonable way. Why would internal methods be any different?

If a sage developer at some point realizes that code could be reused by making a private method public, then that method should get doctested as well. But the same again holds for any piece of code: if some developer finds that a certain portion of an existing method could be reused, he's welcome to factor that out into a new public method and add doctests for it. Again I see no difference here, except that by adding doctests to internal methods I suggest that I might be willing to guarantee certain internal behavior in the future. Which I'm not, as long as the public interface remains.

Sorry for the rant. I'm still far from happy with this strict requirement. But since you are right and the mailing list feedback confirmed that requirement, I'm trying to make the best of it, and here it is. Now every method has a doctest, and every doctest shows the tested method in action. Can you give this a positive review?



---

archive/issue_comments_213893.json:
```json
{
    "body": "I haven't had a chance to look at this, being unfamiliar with the tools... Just wanted to point out [this](https://productforums.google.com/forum/#!topic/chrome/6BVLS-kEIic) and [this](http://stackoverflow.com/questions/19440171/why-do-no-browsers-apart-from-firefox-support-animated-pngs); will anyone ever support this?",
    "created_at": "2014-12-18T04:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213893",
    "user": "https://github.com/kcrisman"
}
```

I haven't had a chance to look at this, being unfamiliar with the tools... Just wanted to point out [this](https://productforums.google.com/forum/#!topic/chrome/6BVLS-kEIic) and [this](http://stackoverflow.com/questions/19440171/why-do-no-browsers-apart-from-firefox-support-animated-pngs); will anyone ever support this?



---

archive/issue_comments_213894.json:
```json
{
    "body": "Now I have looked at it and realize it would take me far longer to review than reasonable... sorry.   I *can* say that the basic relation to the rest of animate seems fine, it's the actual apng assembler I won't be reviewing.  That said, I have a question about your docs.  I see why you changed the first one from `animate([function for el in list])` to `animate([plot(function, (x,0,2)) for el in list])`, but you made a lot more changes like that in the next patch which seemed gratuitous and which might serve to lead people away from this useful syntax.\n\nUnless \"explicit is better than implicit\" in this case and we are deprecating that syntax, but then we should say so, and do it somewhere else.  Or did all of those cause errors in generating the files?",
    "created_at": "2014-12-18T04:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213894",
    "user": "https://github.com/kcrisman"
}
```

Now I have looked at it and realize it would take me far longer to review than reasonable... sorry.   I *can* say that the basic relation to the rest of animate seems fine, it's the actual apng assembler I won't be reviewing.  That said, I have a question about your docs.  I see why you changed the first one from `animate([function for el in list])` to `animate([plot(function, (x,0,2)) for el in list])`, but you made a lot more changes like that in the next patch which seemed gratuitous and which might serve to lead people away from this useful syntax.

Unless "explicit is better than implicit" in this case and we are deprecating that syntax, but then we should say so, and do it somewhere else.  Or did all of those cause errors in generating the files?



---

archive/issue_comments_213895.json:
```json
{
    "body": "Replying to [comment:20 kcrisman]:\n> I haven't had a chance to look at this, being unfamiliar with the tools... Just wanted to point out [this](https://productforums.google.com/forum/#!topic/chrome/6BVLS-kEIic) and [this](http://stackoverflow.com/questions/19440171/why-do-no-browsers-apart-from-firefox-support-animated-pngs); will anyone ever support this?\n\nAs per [this comparison](http://caniuse.com/apng) (which I also referred to in my documentation), Firefox and Safari do support it a the moment, amounting to over 17% market share. Less than I would wish for, but in my opinion still enough to warrant this effort. Particularly since GIF is so very limited in colors. For the rest of the world, it would be nice to offer `<video>` tags as an alternative (#7298) and perhaps try building an spkg for ffmpeg. But that's a different issue.",
    "created_at": "2014-12-18T07:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213895",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:20 kcrisman]:
> I haven't had a chance to look at this, being unfamiliar with the tools... Just wanted to point out [this](https://productforums.google.com/forum/#!topic/chrome/6BVLS-kEIic) and [this](http://stackoverflow.com/questions/19440171/why-do-no-browsers-apart-from-firefox-support-animated-pngs); will anyone ever support this?

As per [this comparison](http://caniuse.com/apng) (which I also referred to in my documentation), Firefox and Safari do support it a the moment, amounting to over 17% market share. Less than I would wish for, but in my opinion still enough to warrant this effort. Particularly since GIF is so very limited in colors. For the rest of the world, it would be nice to offer `<video>` tags as an alternative (#7298) and perhaps try building an spkg for ffmpeg. But that's a different issue.



---

archive/issue_comments_213896.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-18T09:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213896",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_213897.json:
```json
{
    "body": "Replying to [comment:21 kcrisman]:\n> Now I have looked at it and realize it would take me far longer to review than reasonable... sorry. I *can* say that the basic relation to the rest of animate seems fine, it's the actual apng assembler I won't be reviewing.\n\nSad but quite understandable. Thanks for the partial thumbs up on the integration!\n\n> That said, I have a question about your docs.  I see why you changed the first one from `animate([function for el in list])` to `animate([plot(function, (x,0,2)) for el in list])`, but you made a lot more changes like that in the next patch which seemed gratuitous and which might serve to lead people away from this useful syntax.\n\nSounds like some things originally aimed for #16570 (and superseded by the fixed regression there) somehow ended up in here during rebasing. I'll make an effort to disentangle that. Thanks for pointing this out.",
    "created_at": "2014-12-18T09:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213897",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:21 kcrisman]:
> Now I have looked at it and realize it would take me far longer to review than reasonable... sorry. I *can* say that the basic relation to the rest of animate seems fine, it's the actual apng assembler I won't be reviewing.

Sad but quite understandable. Thanks for the partial thumbs up on the integration!

> That said, I have a question about your docs.  I see why you changed the first one from `animate([function for el in list])` to `animate([plot(function, (x,0,2)) for el in list])`, but you made a lot more changes like that in the next patch which seemed gratuitous and which might serve to lead people away from this useful syntax.

Sounds like some things originally aimed for #16570 (and superseded by the fixed regression there) somehow ended up in here during rebasing. I'll make an effort to disentangle that. Thanks for pointing this out.



---

archive/issue_comments_213898.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-12-19T12:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_213899.json:
```json
{
    "body": "Included fixup to avoid unneccessary modification of examples.",
    "created_at": "2014-12-19T12:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213899",
    "user": "https://github.com/gagern"
}
```

Included fixup to avoid unneccessary modification of examples.



---

archive/issue_comments_213900.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-12-19T12:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213900",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_213901.json:
```json
{
    "body": "This is looking good to me: tests are good, functionality is good, code is clean and straightforward.  HTML documentation looks fine too.  I'm running automated doctests now, but don't expect any problems.\n\nThe only thing preventing me from positive review is that the tracer stuff really belongs on a separate ticket.  When that's split into a separate ticket, I'll give them both positive reviews (modulo issues with the tracer stuff, below).  As a very minor point, I think it would be useful if you put the date and a short description of your contribution in the AUTHORS block.  Obviously this isn't always done, and isn't necessary, but I saw it recommended at some point and I think it's helpful.  If you don't want to do it, that's fine.\n\nComments on `fixtures.py`:\n\n* The function `traceMethod` should be `trace_method` to fit the standard naming convention.  Was there a strong reason for the name you gave it?  If not, please change.\n\n* `PropertyAccessTracerProxy.__init__` and `PropertyAccessTracerProxy.fmt` need docstrings\n\n* An author block and a copyright block are necessary at the top of the file.  See [here](http://www.sagemath.org/doc/developer/coding_basics.html#headings-of-sage-library-code-files).\n\n* While you're at it, why not expand the documentation?  This could be useful much more generally, and a very short description at the top of the document would help explain what it does.\n\n* It doesn't make sense to leave `fixtures.py` out of the reference manual.  I think you add it by adding a line in `src/doc/en/reference/doctest/index.rst`, but I may be misremembering.",
    "created_at": "2014-12-30T17:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213901",
    "user": "https://github.com/nilesjohnson"
}
```

This is looking good to me: tests are good, functionality is good, code is clean and straightforward.  HTML documentation looks fine too.  I'm running automated doctests now, but don't expect any problems.

The only thing preventing me from positive review is that the tracer stuff really belongs on a separate ticket.  When that's split into a separate ticket, I'll give them both positive reviews (modulo issues with the tracer stuff, below).  As a very minor point, I think it would be useful if you put the date and a short description of your contribution in the AUTHORS block.  Obviously this isn't always done, and isn't necessary, but I saw it recommended at some point and I think it's helpful.  If you don't want to do it, that's fine.

Comments on `fixtures.py`:

* The function `traceMethod` should be `trace_method` to fit the standard naming convention.  Was there a strong reason for the name you gave it?  If not, please change.

* `PropertyAccessTracerProxy.__init__` and `PropertyAccessTracerProxy.fmt` need docstrings

* An author block and a copyright block are necessary at the top of the file.  See [here](http://www.sagemath.org/doc/developer/coding_basics.html#headings-of-sage-library-code-files).

* While you're at it, why not expand the documentation?  This could be useful much more generally, and a very short description at the top of the document would help explain what it does.

* It doesn't make sense to leave `fixtures.py` out of the reference manual.  I think you add it by adding a line in `src/doc/en/reference/doctest/index.rst`, but I may be misremembering.



---

archive/issue_comments_213902.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-30T17:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213902",
    "user": "https://github.com/nilesjohnson"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_213903.json:
```json
{
    "body": "There are two tests in `doctest/control.py` that need to be updated because of the new fixtures file.  Otherwise all tests pass.",
    "created_at": "2014-12-30T18:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213903",
    "user": "https://github.com/nilesjohnson"
}
```

There are two tests in `doctest/control.py` that need to be updated because of the new fixtures file.  Otherwise all tests pass.



---

archive/issue_comments_213904.json:
```json
{
    "body": "Working on it.",
    "created_at": "2014-12-30T22:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213904",
    "user": "https://github.com/gagern"
}
```

Working on it.



---

archive/issue_comments_213905.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-01-03T17:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_213906.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-03T17:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_213907.json:
```json
{
    "body": "Replying to [comment:26 niles]:\n> The only thing preventing me from positive review is that the tracer stuff really belongs on a separate ticket.\n\nOK, the code is separated now. The code presented here does depend on that of #17571 (nice that these two tickets are exactly 1000 apart), but I didn't merge that branch into this one here, so this one here, all by itself, won't pass doctests. You have to (temporarily) merge the two to get the whole picture. The stated dependencies of this ticket should ensure that things get merged into develop in the proper order.\n\n> When that's split into a separate ticket, I'll give them both positive reviews (modulo issues with the tracer stuff, below).\n\nThat would be really great!",
    "created_at": "2015-01-03T17:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213907",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:26 niles]:
> The only thing preventing me from positive review is that the tracer stuff really belongs on a separate ticket.

OK, the code is separated now. The code presented here does depend on that of #17571 (nice that these two tickets are exactly 1000 apart), but I didn't merge that branch into this one here, so this one here, all by itself, won't pass doctests. You have to (temporarily) merge the two to get the whole picture. The stated dependencies of this ticket should ensure that things get merged into develop in the proper order.

> When that's split into a separate ticket, I'll give them both positive reviews (modulo issues with the tracer stuff, below).

That would be really great!



---

archive/issue_comments_213908.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-03T17:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213908",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_213909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-06T13:25:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213909",
    "user": "https://github.com/nilesjohnson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_213910.json:
```json
{
    "body": "ok, looks good!",
    "created_at": "2015-01-06T13:25:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213910",
    "user": "https://github.com/nilesjohnson"
}
```

ok, looks good!



---

archive/issue_comments_213911.json:
```json
{
    "body": "Thanks for the review. Hope you don't mind me setting the Reviewer field for you.\n\nThe next step along the path of APNG integration would be #16650 which depends on #7298. If you feel like continuing, reviews for these would of course be highly appreciated. But in any case I'm glad for the reviews you already did, so don't feel forced to do more than you want to.",
    "created_at": "2015-01-06T17:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213911",
    "user": "https://github.com/gagern"
}
```

Thanks for the review. Hope you don't mind me setting the Reviewer field for you.

The next step along the path of APNG integration would be #16650 which depends on #7298. If you feel like continuing, reviews for these would of course be highly appreciated. But in any case I'm glad for the reviews you already did, so don't feel forced to do more than you want to.



---

archive/issue_comments_213912.json:
```json
{
    "body": "Replying to [comment:33 gagern]:\n> Thanks for the review. Hope you don't mind me setting the Reviewer field for you.\n\nThanks!  I should have done that.\n\n> \n> The next step along the path of APNG integration would be #16650 which depends on #7298. If you feel like continuing, reviews for these would of course be highly appreciated. But in any case I'm glad for the reviews you already did, so don't feel forced to do more than you want to.\n\nI'll take a look, but probably slowly.",
    "created_at": "2015-01-06T20:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213912",
    "user": "https://github.com/nilesjohnson"
}
```

Replying to [comment:33 gagern]:
> Thanks for the review. Hope you don't mind me setting the Reviewer field for you.

Thanks!  I should have done that.

> 
> The next step along the path of APNG integration would be #16650 which depends on #7298. If you feel like continuing, reviews for these would of course be highly appreciated. But in any case I'm glad for the reviews you already did, so don't feel forced to do more than you want to.

I'll take a look, but probably slowly.



---

archive/issue_comments_213913.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-01-12T18:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213913",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_213914.json:
```json
{
    "body": "Doctest failures in src/sage/plot/animate.py",
    "created_at": "2015-01-12T18:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213914",
    "user": "https://github.com/vbraun"
}
```

Doctest failures in src/sage/plot/animate.py



---

archive/issue_comments_213915.json:
```json
{
    "body": "Replying to [comment:36 vbraun]:\n> Doctest failures in src/sage/plot/animate.py\n\nDid you merge #17571 along with this branch here? Do I need to merge it explicitely?",
    "created_at": "2015-01-12T18:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213915",
    "user": "https://github.com/gagern"
}
```

Replying to [comment:36 vbraun]:
> Doctest failures in src/sage/plot/animate.py

Did you merge #17571 along with this branch here? Do I need to merge it explicitely?



---

archive/issue_comments_213916.json:
```json
{
    "body": "I did merge #17571. I don't merge tickets whose dependencies are not merged.",
    "created_at": "2015-01-12T19:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213916",
    "user": "https://github.com/vbraun"
}
```

I did merge #17571. I don't merge tickets whose dependencies are not merged.



---

archive/issue_comments_213917.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 45.5 src/sage/plot/animate.py\n**********************************************************************\nFile \"src/sage/plot/animate.py\", line 1122, in sage.plot.animate.APngAssembler._add_png\nFailed example:\n    APngAssembler._testCase1(\"_add_png\", reads=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.animate.APngAssembler._add_png[1]>\", line 1, in <module>\n        APngAssembler._testCase1(\"_add_png\", reads=False)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1501, in _testCase1\n        delay=0x567, delay_denominator=0x1234)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1069, in add_frame\n        self._add_png(pngfile)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py\", line 368, in g\n        arglst = [fmt(arg) for arg in args]\n    NameError: global name 'fmt' is not defined\n**********************************************************************\nFile \"src/sage/plot/animate.py\", line 1202, in sage.plot.animate.APngAssembler._first_IHDR\nFailed example:\n    APngAssembler._testCase1(\"_first_IHDR\")\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.animate.APngAssembler._first_IHDR[1]>\", line 1, in <module>\n        APngAssembler._testCase1(\"_first_IHDR\")\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1501, in _testCase1\n        delay=0x567, delay_denominator=0x1234)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1069, in add_frame\n        self._add_png(pngfile)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1172, in _add_png\n        met(cdata)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py\", line 368, in g\n        arglst = [fmt(arg) for arg in args]\n    NameError: global name 'fmt' is not defined\n**********************************************************************\nFile \"src/sage/plot/animate.py\", line 1219, in sage.plot.animate.APngAssembler._first_IDAT\nFailed example:\n    APngAssembler._testCase1(\"_first_IDAT\")\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.animate.APngAssembler._first_IDAT[1]>\", line 1, in <module>\n        APngAssembler._testCase1(\"_first_IDAT\")\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1501, in _testCase1\n        delay=0x567, delay_denominator=0x1234)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1069, in add_frame\n        self._add_png(pngfile)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1172, in _add_png\n        met(cdata)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py\", line 368, in g\n        arglst = [fmt(arg) for arg in args]\n    NameError: global name 'fmt' is not defined\n**********************************************************************\nFile \"src/sage/plot/animate.py\", line 1237, in sage.plot.animate.APngAssembler._next_IDAT\nFailed example:\n    APngAssembler._testCase1(\"_next_IDAT\")\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.animate.APngAssembler._next_IDAT[1]>\", line 1, in <module>\n        APngAssembler._testCase1(\"_next_IDAT\")\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1502, in _testCase1\n        apng.add_frame(cls._testData(\"input2\", True))\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1069, in add_frame\n        self._add_png(pngfile)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py\", line 1172, in _add_png\n        met(cdata)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py\", line 368, in g\n        arglst = [fmt(arg) for arg in args]\n    NameError: global name 'fmt' is not defined\n**********************************************************************\n```\n",
    "created_at": "2015-01-12T19:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213917",
    "user": "https://github.com/vbraun"
}
```


```
sage -t --long --warn-long 45.5 src/sage/plot/animate.py
**********************************************************************
File "src/sage/plot/animate.py", line 1122, in sage.plot.animate.APngAssembler._add_png
Failed example:
    APngAssembler._testCase1("_add_png", reads=False)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.animate.APngAssembler._add_png[1]>", line 1, in <module>
        APngAssembler._testCase1("_add_png", reads=False)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1501, in _testCase1
        delay=0x567, delay_denominator=0x1234)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1069, in add_frame
        self._add_png(pngfile)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py", line 368, in g
        arglst = [fmt(arg) for arg in args]
    NameError: global name 'fmt' is not defined
**********************************************************************
File "src/sage/plot/animate.py", line 1202, in sage.plot.animate.APngAssembler._first_IHDR
Failed example:
    APngAssembler._testCase1("_first_IHDR")
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.animate.APngAssembler._first_IHDR[1]>", line 1, in <module>
        APngAssembler._testCase1("_first_IHDR")
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1501, in _testCase1
        delay=0x567, delay_denominator=0x1234)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1069, in add_frame
        self._add_png(pngfile)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1172, in _add_png
        met(cdata)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py", line 368, in g
        arglst = [fmt(arg) for arg in args]
    NameError: global name 'fmt' is not defined
**********************************************************************
File "src/sage/plot/animate.py", line 1219, in sage.plot.animate.APngAssembler._first_IDAT
Failed example:
    APngAssembler._testCase1("_first_IDAT")
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.animate.APngAssembler._first_IDAT[1]>", line 1, in <module>
        APngAssembler._testCase1("_first_IDAT")
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1501, in _testCase1
        delay=0x567, delay_denominator=0x1234)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1069, in add_frame
        self._add_png(pngfile)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1172, in _add_png
        met(cdata)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py", line 368, in g
        arglst = [fmt(arg) for arg in args]
    NameError: global name 'fmt' is not defined
**********************************************************************
File "src/sage/plot/animate.py", line 1237, in sage.plot.animate.APngAssembler._next_IDAT
Failed example:
    APngAssembler._testCase1("_next_IDAT")
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.animate.APngAssembler._next_IDAT[1]>", line 1, in <module>
        APngAssembler._testCase1("_next_IDAT")
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1502, in _testCase1
        apng.add_frame(cls._testData("input2", True))
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1069, in add_frame
        self._add_png(pngfile)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/plot/animate.py", line 1172, in _add_png
        met(cdata)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/fixtures.py", line 368, in g
        arglst = [fmt(arg) for arg in args]
    NameError: global name 'fmt' is not defined
**********************************************************************
```




---

archive/issue_comments_213918.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-01-12T19:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213918",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_213919.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-12T19:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213919",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_213920.json:
```json
{
    "body": "It's in fact a bug in code from #17571 where I hadn't covered all aspects in the doctests. Do I need a new review just for that last rename, or can you merge it as is?",
    "created_at": "2015-01-12T19:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213920",
    "user": "https://github.com/gagern"
}
```

It's in fact a bug in code from #17571 where I hadn't covered all aspects in the doctests. Do I need a new review just for that last rename, or can you merge it as is?



---

archive/issue_comments_213921.json:
```json
{
    "body": "Replying to [comment:41 gagern]:\n> It's in fact a bug in code from #17571 where I hadn't covered all aspects in the doctests. Do I need a new review just for that last rename, or can you merge it as is?\n\nThe error is just caused by a function renaming on #17571 (which was not caught because doctesting was insufficient.)  The latest commit fixes the error (use correct function name) and improves an existing doctest to check it.  \n\nTo summarize: a trivial bug in `fixtures.py` (code from #17571) was caught and fixed in the course of addressing this ticket.\n\nI'm happy to give it positive review.",
    "created_at": "2015-01-12T20:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213921",
    "user": "https://github.com/nilesjohnson"
}
```

Replying to [comment:41 gagern]:
> It's in fact a bug in code from #17571 where I hadn't covered all aspects in the doctests. Do I need a new review just for that last rename, or can you merge it as is?

The error is just caused by a function renaming on #17571 (which was not caught because doctesting was insufficient.)  The latest commit fixes the error (use correct function name) and improves an existing doctest to check it.  

To summarize: a trivial bug in `fixtures.py` (code from #17571) was caught and fixed in the course of addressing this ticket.

I'm happy to give it positive review.



---

archive/issue_comments_213922.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-12T20:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213922",
    "user": "https://github.com/nilesjohnson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_015850.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-13T11:04:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16334#event-15850"
}
```



---

archive/issue_comments_213923.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-13T11:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16334#issuecomment-213923",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
