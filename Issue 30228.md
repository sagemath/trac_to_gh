# Issue 30228: faster and memory efficient implementation of Szeged index

archive/issues_030228.json:
```json
{
    "body": "CC:  @vipul79321\n\nThe current implementation uses a dict of dicts containing distances. We change that with\n- a basic version using the Cython distance matrix\n- a version with space complexity in O(m)\n\nIssue created by migration from https://trac.sagemath.org/ticket/30465\n\n",
    "created_at": "2020-08-29T17:27:29Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "faster and memory efficient implementation of Szeged index",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30228",
    "user": "@dcoudert"
}
```
CC:  @vipul79321

The current implementation uses a dict of dicts containing distances. We change that with
- a basic version using the Cython distance matrix
- a version with space complexity in O(m)

Issue created by migration from https://trac.sagemath.org/ticket/30465





---

archive/issue_comments_430898.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430898",
    "user": "@dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_430899.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430899",
    "user": "@dcoudert"
}
```

New commits:



---

archive/issue_comments_430900.json:
```json
{
    "body": "With this patch\n\n```\nsage: G = graphs.Grid2dGraph(10, 10)                                                                                                \nsage: %time G.szeged_index(algorithm='low')                                                                                         \nCPU times: user 1.24 ms, sys: 61 \u00b5s, total: 1.31 ms\nWall time: 1.31 ms\n330000\nsage: %time G.szeged_index(algorithm='high')                                                                                        \nCPU times: user 1.14 ms, sys: 13 \u00b5s, total: 1.15 ms\nWall time: 1.16 ms\n330000\nsage: G = graphs.CompleteGraph(50)                                                                                                  \nsage: %time G.szeged_index(algorithm='low')                                                                                         \nCPU times: user 1.44 ms, sys: 1 \u00b5s, total: 1.44 ms\nWall time: 1.45 ms\n1225\nsage: %time G.szeged_index(algorithm='high')                                                                                        \nCPU times: user 1.59 ms, sys: 0 ns, total: 1.59 ms\nWall time: 1.61 ms\n1225\n```\n\n\nWithout:\n\n```\nsage: G = graphs.Grid2dGraph(10, 10)                                                                                                \nsage: %time G.szeged_index()                                                                                                        \nCPU times: user 8.9 ms, sys: 1.06 ms, total: 9.96 ms\nWall time: 9.57 ms\n330000\nsage: G = graphs.CompleteGraph(50)                                                                                                  \nsage: %time G.szeged_index()                                                                                                        \nCPU times: user 19.2 ms, sys: 720 \u00b5s, total: 20 ms\nWall time: 19.5 ms\n1225\n```\n",
    "created_at": "2020-08-29T18:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430900",
    "user": "@dcoudert"
}
```

With this patch

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.24 ms, sys: 61 µs, total: 1.31 ms
Wall time: 1.31 ms
330000
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.14 ms, sys: 13 µs, total: 1.15 ms
Wall time: 1.16 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.44 ms, sys: 1 µs, total: 1.44 ms
Wall time: 1.45 ms
1225
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.59 ms, sys: 0 ns, total: 1.59 ms
Wall time: 1.61 ms
1225
```


Without:

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index()                                                                                                        
CPU times: user 8.9 ms, sys: 1.06 ms, total: 9.96 ms
Wall time: 9.57 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index()                                                                                                        
CPU times: user 19.2 ms, sys: 720 µs, total: 20 ms
Wall time: 19.5 ms
1225
```




---

archive/issue_comments_430901.json:
```json
{
    "body": "One minor fix in doc \n\n\n```diff\n- `2^16` vertices.\n+ `2^{16}` vertices.\n```\n\n\nAlso, I have one question, hasn't this method restricted the `szeged index` to `unweighted undirected graphs only`. Is that what we want? (I guess earlier that wasnt the case) \n\nAnd it is raising error for directed graph if that's the wanted case then why dont we move this method to `graph.py`.",
    "created_at": "2020-09-01T13:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430901",
    "user": "@vipul79321"
}
```

One minor fix in doc 


```diff
- `2^16` vertices.
+ `2^{16}` vertices.
```


Also, I have one question, hasn't this method restricted the `szeged index` to `unweighted undirected graphs only`. Is that what we want? (I guess earlier that wasnt the case) 

And it is raising error for directed graph if that's the wanted case then why dont we move this method to `graph.py`.



---

archive/issue_comments_430902.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-01T19:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430902",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430903.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-01T20:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430903",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430904.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-01T20:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430904",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430905.json:
```json
{
    "body": "You are right. I changed that to allow the use of the high algorithm on digraphs.",
    "created_at": "2020-09-01T20:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430905",
    "user": "@dcoudert"
}
```

You are right. I changed that to allow the use of the high algorithm on digraphs.



---

archive/issue_comments_430906.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T06:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430906",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430907.json:
```json
{
    "body": "Waiting for patchbot result for any issue. Rest we are done.",
    "created_at": "2020-09-02T06:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430907",
    "user": "@vipul79321"
}
```

Waiting for patchbot result for any issue. Rest we are done.



---

archive/issue_comments_430908.json:
```json
{
    "body": "Looks good to me :)",
    "created_at": "2020-09-03T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430908",
    "user": "@vipul79321"
}
```

Looks good to me :)



---

archive/issue_comments_430909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-03T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430909",
    "user": "@vipul79321"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_430910.json:
```json
{
    "body": "Thank you.",
    "created_at": "2020-09-03T13:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430910",
    "user": "@dcoudert"
}
```

Thank you.



---

archive/issue_comments_430911.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-09-18T20:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30228#issuecomment-430911",
    "user": "@vbraun"
}
```

Resolution: fixed
