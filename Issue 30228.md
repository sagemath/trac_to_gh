# Issue 30228: faster and memory efficient implementation of Szeged index

Issue created by migration from https://trac.sagemath.org/ticket/30465

Original creator: dcoudert

Original creation time: 2020-08-29 17:27:29

CC:  @vipul79321

The current implementation uses a dict of dicts containing distances. We change that with
- a basic version using the Cython distance matrix
- a version with space complexity in O(m)


---

Comment by dcoudert created at 2020-08-29 18:10:22

Changing status from new to needs_review.


---

Comment by dcoudert created at 2020-08-29 18:10:22

New commits:


---

Comment by dcoudert created at 2020-08-29 18:13:54

With this patch

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.24 ms, sys: 61 µs, total: 1.31 ms
Wall time: 1.31 ms
330000
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.14 ms, sys: 13 µs, total: 1.15 ms
Wall time: 1.16 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.44 ms, sys: 1 µs, total: 1.44 ms
Wall time: 1.45 ms
1225
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.59 ms, sys: 0 ns, total: 1.59 ms
Wall time: 1.61 ms
1225
```


Without:

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index()                                                                                                        
CPU times: user 8.9 ms, sys: 1.06 ms, total: 9.96 ms
Wall time: 9.57 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index()                                                                                                        
CPU times: user 19.2 ms, sys: 720 µs, total: 20 ms
Wall time: 19.5 ms
1225
```



---

Comment by @vipul79321 created at 2020-09-01 13:18:06

One minor fix in doc 


```diff
- `2^16` vertices.
+ `2^{16}` vertices.
```


Also, I have one question, hasn't this method restricted the `szeged index` to `unweighted undirected graphs only`. Is that what we want? (I guess earlier that wasnt the case) 

And it is raising error for directed graph if that's the wanted case then why dont we move this method to `graph.py`.


---

Comment by git created at 2020-09-01 19:12:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-01 20:34:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-01 20:39:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-09-01 20:40:12

You are right. I changed that to allow the use of the high algorithm on digraphs.


---

Comment by git created at 2020-09-02 06:29:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-09-02 06:30:29

Waiting for patchbot result for any issue. Rest we are done.


---

Comment by @vipul79321 created at 2020-09-03 13:12:43

Looks good to me :)


---

Comment by @vipul79321 created at 2020-09-03 13:12:43

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-09-03 13:15:24

Thank you.


---

Comment by vbraun created at 2020-09-18 20:22:49

Resolution: fixed
