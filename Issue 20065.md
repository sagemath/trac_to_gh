# Issue 20065: Clean up MILP backend interface

archive/issues_020065.json:
```json
{
    "body": "CC:  dimpase vdelecroix vbraun jdemeyer chapoton fbissey rudi novoselt moritz jipilab mmasdeu klee tmonteil mforets yzh\n\nKeywords: lp\n\nWhile implementing `InteractiveLPBackend` for #20296, I noticed several deficiencies in the design of the MILP backend interface.\n\n- `add_col` and `add_variable` both add a variable to the problem; but `add_col` only allows to add a column with no name; whereas `add_variable` only allows to add a column with no coefficients. There should be one function (`add_variable`, probably) that can do both; should then deprecate `add_col`. (Also compare with `add_linear_constraint`, which takes as zipped index/coefficient list, whereas `add_col` takes two parallel lists.)\n\n- `variable_upper_bound`: This interface is bizarre.  Can't remove an upper bound from a variable because `None` means both 'no upper bound' and 'get the upper bound'. Likewise `variable_lower_bound`. (Moreover, there's redundancy with `col_bounds`.)\n\n- `add_variables` and `add_linear_constraints` should have a default implementation in `GenericBackend`, like `add_linear_constraint_vector`.\n\nAlso, I think the backends should be tested using a common `TestSuite`. Right now each backend uses its own doctests, which have slightly diverged from each other, so there is nothing (other than the fact that they were the result of copy-paste from each other) that ensures consistency. (#20296 fixes several wrong doctests in `GenericBackend`, from which I tried to copy-paste, for example.)\n\nIssue created by migration from https://trac.sagemath.org/ticket/20302\n\n",
    "created_at": "2016-03-27T00:12:12Z",
    "labels": [
        "numerical",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Clean up MILP backend interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20065",
    "user": "mkoeppe"
}
```
CC:  dimpase vdelecroix vbraun jdemeyer chapoton fbissey rudi novoselt moritz jipilab mmasdeu klee tmonteil mforets yzh

Keywords: lp

While implementing `InteractiveLPBackend` for #20296, I noticed several deficiencies in the design of the MILP backend interface.

- `add_col` and `add_variable` both add a variable to the problem; but `add_col` only allows to add a column with no name; whereas `add_variable` only allows to add a column with no coefficients. There should be one function (`add_variable`, probably) that can do both; should then deprecate `add_col`. (Also compare with `add_linear_constraint`, which takes as zipped index/coefficient list, whereas `add_col` takes two parallel lists.)

- `variable_upper_bound`: This interface is bizarre.  Can't remove an upper bound from a variable because `None` means both 'no upper bound' and 'get the upper bound'. Likewise `variable_lower_bound`. (Moreover, there's redundancy with `col_bounds`.)

- `add_variables` and `add_linear_constraints` should have a default implementation in `GenericBackend`, like `add_linear_constraint_vector`.

Also, I think the backends should be tested using a common `TestSuite`. Right now each backend uses its own doctests, which have slightly diverged from each other, so there is nothing (other than the fact that they were the result of copy-paste from each other) that ensures consistency. (#20296 fixes several wrong doctests in `GenericBackend`, from which I tried to copy-paste, for example.)

Issue created by migration from https://trac.sagemath.org/ticket/20302





---

archive/issue_comments_276361.json:
```json
{
    "body": "Description modified to remove my comments about `variable_upper_bound` and `variable_lower_bound`. I was misled by the interface description in `GenericBackend`, which was out of sync with the real backends. Fixed in #20296",
    "created_at": "2016-03-27T19:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276361",
    "user": "mkoeppe"
}
```

Description modified to remove my comments about `variable_upper_bound` and `variable_lower_bound`. I was misled by the interface description in `GenericBackend`, which was out of sync with the real backends. Fixed in #20296



---

archive/issue_comments_276362.json:
```json
{
    "body": "Hello,\n\nI guess that you do not want to fix all of that in one ticket. One possibility is to use this one as a \"task ticket\" pointing to other tickets. See for example #18846, #17601 or #18333.",
    "created_at": "2016-03-30T12:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276362",
    "user": "vdelecroix"
}
```

Hello,

I guess that you do not want to fix all of that in one ticket. One possibility is to use this one as a "task ticket" pointing to other tickets. See for example #18846, #17601 or #18333.



---

archive/issue_comments_276363.json:
```json
{
    "body": "Changing type from defect to task.",
    "created_at": "2016-03-30T16:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276363",
    "user": "mkoeppe"
}
```

Changing type from defect to task.



---

archive/issue_comments_276364.json:
```json
{
    "body": "Perhaps I am not that `klee` that you think I am. My name is Kwankyu Lee.",
    "created_at": "2017-03-02T10:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276364",
    "user": "klee"
}
```

Perhaps I am not that `klee` that you think I am. My name is Kwankyu Lee.



---

archive/issue_comments_276365.json:
```json
{
    "body": "Yes, you wrote ticket #22472 regarding optimization documentation, so I copied you to make sure you are aware of other efforts regarding the optimization code.",
    "created_at": "2017-03-02T10:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276365",
    "user": "mkoeppe"
}
```

Yes, you wrote ticket #22472 regarding optimization documentation, so I copied you to make sure you are aware of other efforts regarding the optimization code.



---

archive/issue_comments_276366.json:
```json
{
    "body": "Ok :-)",
    "created_at": "2017-03-02T10:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276366",
    "user": "klee"
}
```

Ok :-)



---

archive/issue_comments_276367.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276367",
    "user": "embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_276368.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276368",
    "user": "mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_276369.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20065#issuecomment-276369",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
