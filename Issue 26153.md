# Issue 26153: py3: some changes in misc

Issue created by migration from https://trac.sagemath.org/ticket/26390

Original creator: chapoton

Original creation time: 2018-10-03 13:22:25

CC:  embray

extracted from #26319


---

Comment by chapoton created at 2018-10-03 13:23:09

New commits:


---

Comment by chapoton created at 2018-10-03 13:23:09

Changing status from new to needs_review.


---

Comment by vklein created at 2018-10-03 14:48:01

Set assignee to vklein.


---

Comment by vklein created at 2018-10-03 15:13:26


```
-        sage: g = mypartial(f, 2, 3)
+        sage: g = mypartial(f, 2, 3)  # py2; on Python 3 this is an error
         Traceback (most recent call last):
         ...
         DeprecationWarning: object.__init__() takes no parameters
```


Why not testing the error case with py3 ? And if it is not worth it why keeping the test in py2 ?


---

Comment by chapoton created at 2018-10-03 15:14:55

one should ask `@`embray, author of this


---

Comment by embray created at 2018-10-03 15:46:27

Because it's checking behavior that is no longer applicable on Python 3.


---

Comment by vklein created at 2018-10-03 15:57:47

Ok.

I am also surprised by a doctests behaviour.

When i see this


```
sage: sage_input(long(-5), verify=True)  # py2
# Verified
-long(5)
sage: sage_input(long(-7), preparse=False, verify=True)
# Verified
-7L
sage: sage_input(long(11), preparse=None, verify=True)  # py2
# Verified
long(11)

```



i expect the second test to fail in python3 but it doesn't whith a `sage -t --long src/sage/misc/sage_input.py`, what is the trick ?


---

Comment by vklein created at 2018-10-03 16:28:38

I am ok with this ticket, i will set it to positive review after green bot.


---

Comment by vklein created at 2018-10-03 16:28:38

Remove assignee vklein.


---

Comment by embray created at 2018-10-03 16:51:48

Replying to [comment:6 vklein]:
> i expect the second test to fail in python3 but it doesn't whith a `sage -t --long src/sage/misc/sage_input.py`, what is the trick ?

There are some tricks in the doctest parser for massaging differences between Python 2 and 3 w.r.t. to the Python 2 long type.  For example, the `L`-suffix is just ignored on Python 3 as long as the preceding numerals are the same. 

But I don't think the Sage pre-parser will take `long(1)` and output `long(1)` on Python 3.  So there are a few exceptions.  But the _majority_ of long-related tests work on Python 3.


---

Comment by vklein created at 2018-10-03 16:57:49

Ok, thank you for clarifying that.


---

Comment by vklein created at 2018-10-04 12:56:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-10-05 16:56:51

Resolution: fixed
