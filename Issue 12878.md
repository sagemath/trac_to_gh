# Issue 12878: change default numerical evaluation of `erf` to use mpmath

archive/issues_012878.json:
```json
{
    "body": "Assignee: @burcin\n\nCC:  dsm @kcrisman\n\nKeywords: sd40.5 mpmath pari erf\n\nIn #1173 an mpmath numerical evaluator for `erf` was written by Douglas McNeil. This ticket proposes to save that code, incorporate it with the ability to pass an `algorithm` parameter to `numerical_approx` from #12289 and solve #13003 all in one go.\n\nThe mpmath evaluator is more robust than PARI, e.g. at large inputs. This is a good reason to switch the default numerical evaluation of `erf` to use mpmath like most of the rest of the new symbolic functions in Sage.\n\nIn PARIs favor, it is faster for some inputs:\n\n```\nsage: timeit('erf(2).n()')\n625 loops, best of 3: 153 \u00b5s per loop\nsage: timeit(\"erf(2).n(algorithm='pari')\")\n625 loops, best of 3: 135 \u00b5s per loop\n```\n\nbut not always:\n\n```\nsage: timeit('erf(10^7).n()')\n625 loops, best of 3: 118 \u00b5s per loop\nsage: timeit('erf(10^7).n(algorithm=\"pari\")')\n625 loops, best of 3: 132 \u00b5s per loop\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/13050\n\n",
    "created_at": "2012-05-28T17:44:21Z",
    "labels": [
        "symbolics",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "change default numerical evaluation of `erf` to use mpmath",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12878",
    "user": "@benjaminfjones"
}
```
Assignee: @burcin

CC:  dsm @kcrisman

Keywords: sd40.5 mpmath pari erf

In #1173 an mpmath numerical evaluator for `erf` was written by Douglas McNeil. This ticket proposes to save that code, incorporate it with the ability to pass an `algorithm` parameter to `numerical_approx` from #12289 and solve #13003 all in one go.

The mpmath evaluator is more robust than PARI, e.g. at large inputs. This is a good reason to switch the default numerical evaluation of `erf` to use mpmath like most of the rest of the new symbolic functions in Sage.

In PARIs favor, it is faster for some inputs:

```
sage: timeit('erf(2).n()')
625 loops, best of 3: 153 µs per loop
sage: timeit("erf(2).n(algorithm='pari')")
625 loops, best of 3: 135 µs per loop
```

but not always:

```
sage: timeit('erf(10^7).n()')
625 loops, best of 3: 118 µs per loop
sage: timeit('erf(10^7).n(algorithm="pari")')
625 loops, best of 3: 132 µs per loop
```


Issue created by migration from https://trac.sagemath.org/ticket/13050





---

archive/issue_comments_154940.json:
```json
{
    "body": "Attachment [trac_13050_erf_mpmath_eval.patch](tarball://root/attachments/some-uuid/ticket13050/trac_13050_erf_mpmath_eval.patch) by @benjaminfjones created at 2012-05-28 17:46:41\n\nadd mpmath evaluation to erf",
    "created_at": "2012-05-28T17:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12878#issuecomment-154940",
    "user": "@benjaminfjones"
}
```

Attachment [trac_13050_erf_mpmath_eval.patch](tarball://root/attachments/some-uuid/ticket13050/trac_13050_erf_mpmath_eval.patch) by @benjaminfjones created at 2012-05-28 17:46:41

add mpmath evaluation to erf



---

archive/issue_comments_154941.json:
```json
{
    "body": "See comments at #11948 for why we probably want to do this or #1173 as soon as possible.",
    "created_at": "2012-07-02T14:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12878#issuecomment-154941",
    "user": "@kcrisman"
}
```

See comments at #11948 for why we probably want to do this or #1173 as soon as possible.



---

archive/issue_comments_154942.json:
```json
{
    "body": "This looks like a duplicate of #1173 to me.",
    "created_at": "2012-07-02T15:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12878#issuecomment-154942",
    "user": "@jdemeyer"
}
```

This looks like a duplicate of #1173 to me.



---

archive/issue_comments_154943.json:
```json
{
    "body": "> This looks like a duplicate of #1173 to me.\nI think that the point of this ticket was to do some of the things at #1173 more quickly, or using a different infrastructure, or something.  Ben, what was the rationale exactly?",
    "created_at": "2012-07-02T15:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12878#issuecomment-154943",
    "user": "@kcrisman"
}
```

> This looks like a duplicate of #1173 to me.
I think that the point of this ticket was to do some of the things at #1173 more quickly, or using a different infrastructure, or something.  Ben, what was the rationale exactly?



---

archive/issue_comments_154944.json:
```json
{
    "body": "I think that we can repurpose this ticket to adding the algorithm keyword here.  Some good examples from #1173 (most were added in #13001):\n\n```\nVerify we're returning the appropriate zero:: \n\n            sage: erf(0) \n            0 \n            sage: erf(0.0) \n            0.000000000000000 \n            sage: erf(RealField(100)(0)) \n            0.00000000000000000000000000000 \n```\n\n\n```\nset(erf(45*10**i).n() for i in range(10)) \n```\n\n\n```\nsage: CC(erf(ComplexField(1000)(2+3j))) \n```\n",
    "created_at": "2013-06-19T06:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12878#issuecomment-154944",
    "user": "@kcrisman"
}
```

I think that we can repurpose this ticket to adding the algorithm keyword here.  Some good examples from #1173 (most were added in #13001):

```
Verify we're returning the appropriate zero:: 

            sage: erf(0) 
            0 
            sage: erf(0.0) 
            0.000000000000000 
            sage: erf(RealField(100)(0)) 
            0.00000000000000000000000000000 
```


```
set(erf(45*10**i).n() for i in range(10)) 
```


```
sage: CC(erf(ComplexField(1000)(2+3j))) 
```

