# Issue 23010: Symmetric square L-function bug for odd chi

archive/issues_023010.json:
```json
{
    "body": "Keywords: L-functions\n\nThis is a followup to #19668 which added functionality for computing symmetric square L-functions of modular forms (via the Sage interface to Dokchitser's ComputeL GP/PARI script). Unfortunately, the code has a bug when the twisting character psi has non-real values, as one can see by checking the functional equation.\n\n```\nsage: F = Newforms(1,12)[0]\nsage: chi = DirichletGroup(7).0\nsage: F.symsquare_lseries(chi^2).check_functional_equation() # even char\n-9.06002242118120e-8 - 1.94297172129154e-7*I\nsage: F.symsquare_lseries(chi).check_functional_equation() # odd char\n8.86658506905467e7 + 1.10964024593305e8*I\n```\n\nNote the huge discrepancy for the odd character. This is because the Gamma and epsilon factor parameters are being computed wrongly. (Thanks to Jim Brown for pointing this out)\n\nIssue created by migration from https://trac.sagemath.org/ticket/23247\n\n",
    "created_at": "2017-06-15T15:08:14Z",
    "labels": [
        "component: modular forms",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Symmetric square L-function bug for odd chi",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23010",
    "user": "https://github.com/loefflerd"
}
```
Keywords: L-functions

This is a followup to #19668 which added functionality for computing symmetric square L-functions of modular forms (via the Sage interface to Dokchitser's ComputeL GP/PARI script). Unfortunately, the code has a bug when the twisting character psi has non-real values, as one can see by checking the functional equation.

```
sage: F = Newforms(1,12)[0]
sage: chi = DirichletGroup(7).0
sage: F.symsquare_lseries(chi^2).check_functional_equation() # even char
-9.06002242118120e-8 - 1.94297172129154e-7*I
sage: F.symsquare_lseries(chi).check_functional_equation() # odd char
8.86658506905467e7 + 1.10964024593305e8*I
```

Note the huge discrepancy for the odd character. This is because the Gamma and epsilon factor parameters are being computed wrongly. (Thanks to Jim Brown for pointing this out)

Issue created by migration from https://trac.sagemath.org/ticket/23247





---

archive/issue_comments_321572.json:
```json
{
    "body": "Here's a patch.\n----\nNew commits:",
    "created_at": "2017-06-17T11:32:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321572",
    "user": "https://github.com/loefflerd"
}
```

Here's a patch.
----
New commits:



---

archive/issue_comments_321573.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-17T11:32:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321573",
    "user": "https://github.com/loefflerd"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_321574.json:
```json
{
    "body": "Looks good to me. I made a tiny cosmetic change. If you agree with it, you can set to positive on my behalf.\n----\nNew commits:",
    "created_at": "2017-06-17T20:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321574",
    "user": "https://github.com/fchapoton"
}
```

Looks good to me. I made a tiny cosmetic change. If you agree with it, you can set to positive on my behalf.
----
New commits:



---

archive/issue_comments_321575.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-17T22:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321575",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_321576.json:
```json
{
    "body": "Great, thanks!",
    "created_at": "2017-06-17T22:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321576",
    "user": "https://github.com/loefflerd"
}
```

Great, thanks!



---

archive/issue_comments_321577.json:
```json
{
    "body": "I have used the new code and it works correctly now.  It is a positive review from me.",
    "created_at": "2017-06-21T14:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321577",
    "user": "https://trac.sagemath.org/admin/accounts/users/jbrown"
}
```

I have used the new code and it works correctly now.  It is a positive review from me.



---

archive/issue_events_059955.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-22T07:23:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23010#event-59955"
}
```



---

archive/issue_comments_321578.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-22T07:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321578",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_321579.json:
```json
{
    "body": "I've added Jim's name as reviewer.",
    "created_at": "2017-06-22T09:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23010#issuecomment-321579",
    "user": "https://github.com/loefflerd"
}
```

I've added Jim's name as reviewer.
