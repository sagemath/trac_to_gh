# Issue 23010: Symmetric square L-function bug for odd chi

Issue created by migration from Trac.

Original creator: davidloeffler

Original creation time: 2017-06-15 15:08:14

Keywords: L-functions

This is a followup to #19668 which added functionality for computing symmetric square L-functions of modular forms (via the Sage interface to Dokchitser's ComputeL GP/PARI script). Unfortunately, the code has a bug when the twisting character psi has non-real values, as one can see by checking the functional equation.

```
sage: F = Newforms(1,12)[0]
sage: chi = DirichletGroup(7).0
sage: F.symsquare_lseries(chi^2).check_functional_equation() # even char
-9.06002242118120e-8 - 1.94297172129154e-7*I
sage: F.symsquare_lseries(chi).check_functional_equation() # odd char
8.86658506905467e7 + 1.10964024593305e8*I
```

Note the huge discrepancy for the odd character. This is because the Gamma and epsilon factor parameters are being computed wrongly. (Thanks to Jim Brown for pointing this out)


---

Comment by davidloeffler created at 2017-06-17 11:32:01

Here's a patch.
----
New commits:


---

Comment by davidloeffler created at 2017-06-17 11:32:01

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-06-17 20:02:37

Looks good to me. I made a tiny cosmetic change. If you agree with it, you can set to positive on my behalf.
----
New commits:


---

Comment by davidloeffler created at 2017-06-17 22:04:04

Changing status from needs_review to positive_review.


---

Comment by davidloeffler created at 2017-06-17 22:04:04

Great, thanks!


---

Comment by jbrown created at 2017-06-21 14:11:44

I have used the new code and it works correctly now.  It is a positive review from me.


---

Comment by vbraun created at 2017-06-22 07:23:29

Resolution: fixed


---

Comment by davidloeffler created at 2017-06-22 09:21:48

I've added Jim's name as reviewer.
