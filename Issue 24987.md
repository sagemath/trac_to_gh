# Issue 24987: Mismatch in the definition of dilog() between fricas and sympy

Issue created by migration from Trac.

Original creator: mafra

Original creation time: 2018-04-22 10:17:59

The function `dilog` in the output of an integration using `algorithm='fricas'` has a different meaning than `dilog` when integrating using other algorithms.

These different definitions of dilog can be observed as follows:


```
sage: integrate(log(x)/(1-x),x,algorithm='fricas')
sage: integrate(log(x)/(1-x),x,algorithm='sympy')
dilog(x)
dilog(-x+1)
```


That is, sagemath considers `Li_2(x)=dilog(x)` but fricas uses
`Li_2(x)=dilog(1-x)`. The wikipedia page [https://en.wikipedia.org/wiki/Spence%27s_function](https://en.wikipedia.org/wiki/Spence%27s_function) mentions these two alternative definitions.

These conflicting definitions obviously lead to mistakes. It would be nice to take this into account when parsing the output of fricas.


---

Comment by mantepse created at 2018-04-22 18:51:53

Changing keywords from "" to "FriCAS".


---

Comment by mantepse created at 2018-04-22 20:02:48

very likely there is also a mismatch with polylog, could you please check?
----
New commits:


---

Comment by git created at 2018-04-22 20:04:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-04-22 20:11:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-04-22 20:12:11

Changing status from new to needs_review.


---

Comment by mafra created at 2018-04-22 23:10:27

Replying to [comment:5 mantepse]:
> very likely there is also a mismatch with polylog, could you please check?

I am not sure but it seems like the s=2 polylog is the only mismatch. In the fricas source
code (btw there is a new version 1.3.3 around) I found this in the file combfunc.spad:


```
 if F has ElementaryFunctionCategory then
        if F has LiouvillianFunctionCategory then
            iiPolylog(s, x) ==
                s = 1 => -log(1 - x)
                s = 2::F => dilog(1 - x)
                kernel(opPolylog, [s, x])
        else
            iiPolylog(s, x) ==
                s = 1 => -log(1 - x)
                kernel(opPolylog, [s, x])
    else
        iiPolylog(s, x) == kernel(opPolylog, [s, x])
```

which seems to be the source for the mismatch in the polylog(s,x) definition at s=2 for the name `dilog`. But apparently no other cases like that are present.

And thank you for your work!


---

Comment by git created at 2018-04-23 07:58:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-04-23 08:03:14

Well, please review :-)


---

Comment by mafra created at 2018-04-23 09:56:24

Changing status from needs_review to positive_review.


---

Comment by mantepse created at 2018-04-23 10:37:28

Thank you!

Maybe you could also have a look at #25220, which is a stupid bug with a simple fix.


---

Comment by mafra created at 2018-04-23 11:03:00

Replying to [comment:13 mantepse]:
> Thank you!
> 
> Maybe you could also have a look at #25220, which is a stupid bug with a simple fix.

Done now. I was actually aware of your fix there because that bug had hit me last week.


---

Comment by vbraun created at 2018-05-14 17:35:27

Resolution: fixed
