# Issue 24987: Mismatch in the definition of dilog() between fricas and sympy

archive/issues_024987.json:
```json
{
    "body": "The function `dilog` in the output of an integration using `algorithm='fricas'` has a different meaning than `dilog` when integrating using other algorithms.\n\nThese different definitions of dilog can be observed as follows:\n\n\n```\nsage: integrate(log(x)/(1-x),x,algorithm='fricas')\nsage: integrate(log(x)/(1-x),x,algorithm='sympy')\ndilog(x)\ndilog(-x+1)\n```\n\n\nThat is, sagemath considers `Li_2(x)=dilog(x)` but fricas uses\n`Li_2(x)=dilog(1-x)`. The wikipedia page [https://en.wikipedia.org/wiki/Spence%27s_function](https://en.wikipedia.org/wiki/Spence%27s_function) mentions these two alternative definitions.\n\nThese conflicting definitions obviously lead to mistakes. It would be nice to take this into account when parsing the output of fricas.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25224\n\n",
    "created_at": "2018-04-22T10:17:59Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Mismatch in the definition of dilog() between fricas and sympy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24987",
    "user": "mafra"
}
```
The function `dilog` in the output of an integration using `algorithm='fricas'` has a different meaning than `dilog` when integrating using other algorithms.

These different definitions of dilog can be observed as follows:


```
sage: integrate(log(x)/(1-x),x,algorithm='fricas')
sage: integrate(log(x)/(1-x),x,algorithm='sympy')
dilog(x)
dilog(-x+1)
```


That is, sagemath considers `Li_2(x)=dilog(x)` but fricas uses
`Li_2(x)=dilog(1-x)`. The wikipedia page [https://en.wikipedia.org/wiki/Spence%27s_function](https://en.wikipedia.org/wiki/Spence%27s_function) mentions these two alternative definitions.

These conflicting definitions obviously lead to mistakes. It would be nice to take this into account when parsing the output of fricas.

Issue created by migration from https://trac.sagemath.org/ticket/25224





---

archive/issue_comments_351655.json:
```json
{
    "body": "Changing keywords from \"\" to \"FriCAS\".",
    "created_at": "2018-04-22T18:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351655",
    "user": "mantepse"
}
```

Changing keywords from "" to "FriCAS".



---

archive/issue_comments_351656.json:
```json
{
    "body": "very likely there is also a mismatch with polylog, could you please check?\n----\nNew commits:",
    "created_at": "2018-04-22T20:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351656",
    "user": "mantepse"
}
```

very likely there is also a mismatch with polylog, could you please check?
----
New commits:



---

archive/issue_comments_351657.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-22T20:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351657",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351658.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-22T20:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351658",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351659.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-22T20:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351659",
    "user": "mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_351660.json:
```json
{
    "body": "Replying to [comment:5 mantepse]:\n> very likely there is also a mismatch with polylog, could you please check?\n\nI am not sure but it seems like the s=2 polylog is the only mismatch. In the fricas source\ncode (btw there is a new version 1.3.3 around) I found this in the file combfunc.spad:\n\n\n```\n if F has ElementaryFunctionCategory then\n        if F has LiouvillianFunctionCategory then\n            iiPolylog(s, x) ==\n                s = 1 => -log(1 - x)\n                s = 2::F => dilog(1 - x)\n                kernel(opPolylog, [s, x])\n        else\n            iiPolylog(s, x) ==\n                s = 1 => -log(1 - x)\n                kernel(opPolylog, [s, x])\n    else\n        iiPolylog(s, x) == kernel(opPolylog, [s, x])\n```\n\nwhich seems to be the source for the mismatch in the polylog(s,x) definition at s=2 for the name `dilog`. But apparently no other cases like that are present.\n\nAnd thank you for your work!",
    "created_at": "2018-04-22T23:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351660",
    "user": "mafra"
}
```

Replying to [comment:5 mantepse]:
> very likely there is also a mismatch with polylog, could you please check?

I am not sure but it seems like the s=2 polylog is the only mismatch. In the fricas source
code (btw there is a new version 1.3.3 around) I found this in the file combfunc.spad:


```
 if F has ElementaryFunctionCategory then
        if F has LiouvillianFunctionCategory then
            iiPolylog(s, x) ==
                s = 1 => -log(1 - x)
                s = 2::F => dilog(1 - x)
                kernel(opPolylog, [s, x])
        else
            iiPolylog(s, x) ==
                s = 1 => -log(1 - x)
                kernel(opPolylog, [s, x])
    else
        iiPolylog(s, x) == kernel(opPolylog, [s, x])
```

which seems to be the source for the mismatch in the polylog(s,x) definition at s=2 for the name `dilog`. But apparently no other cases like that are present.

And thank you for your work!



---

archive/issue_comments_351661.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-23T07:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351661",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351662.json:
```json
{
    "body": "Well, please review :-)",
    "created_at": "2018-04-23T08:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351662",
    "user": "mantepse"
}
```

Well, please review :-)



---

archive/issue_comments_351663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-23T09:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351663",
    "user": "mafra"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_351664.json:
```json
{
    "body": "Thank you!\n\nMaybe you could also have a look at #25220, which is a stupid bug with a simple fix.",
    "created_at": "2018-04-23T10:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351664",
    "user": "mantepse"
}
```

Thank you!

Maybe you could also have a look at #25220, which is a stupid bug with a simple fix.



---

archive/issue_comments_351665.json:
```json
{
    "body": "Replying to [comment:13 mantepse]:\n> Thank you!\n> \n> Maybe you could also have a look at #25220, which is a stupid bug with a simple fix.\n\nDone now. I was actually aware of your fix there because that bug had hit me last week.",
    "created_at": "2018-04-23T11:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351665",
    "user": "mafra"
}
```

Replying to [comment:13 mantepse]:
> Thank you!
> 
> Maybe you could also have a look at #25220, which is a stupid bug with a simple fix.

Done now. I was actually aware of your fix there because that bug had hit me last week.



---

archive/issue_comments_351666.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-14T17:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24987#issuecomment-351666",
    "user": "vbraun"
}
```

Resolution: fixed
