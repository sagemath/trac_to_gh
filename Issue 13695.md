# Issue 13695: Don't use TAB characters for indentation

Issue created by migration from https://trac.sagemath.org/ticket/13899

Original creator: jdemeyer

Original creation time: 2013-01-02 10:56:07

Assignee: jason




---

Attachment


---

Attachment


---

Attachment


---

Comment by leif created at 2013-01-02 18:01:04

Patches look sane (yes, I've read the whole Sage library patch!), haven't tried to apply them yet though.

Other than removing trailing whitespace (and removing useless backslashes at the end of a few lines), I don't see much value in touching the C/C++ and HTML files.  In particular, removing tabs that introduce end-of-line comments (in the C/C++ files) is rather counter-productive.  [Instead, it would have been worth to translate the French ones, and especially French error messages... ;-) ]


---

Comment by leif created at 2013-01-03 01:48:00

Changing status from new to needs_review.


---

Comment by leif created at 2013-01-03 01:48:00

Not sure whether you planned to add further patches here; just noticed it was still "new".

Patches apply to Sage 5.6.beta1, doc builds...  (The Sage library patch btw. triggers the rebuild of half of the Sage library.)

Haven't reviewed the merger script though.


---

Comment by leif created at 2013-01-03 01:48:18

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-01-03 07:14:31

There are actually doctest failures in `conventions.rst`, I guess because of a bug in the doctest script which causes the tests not to be run.


---

Comment by jdemeyer created at 2013-01-03 07:14:31

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-01-03 13:20:16

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2013-01-03 13:20:16

The Sage library patch [attachment:13899_doctest.patch] needs review.


---

Comment by kcrisman created at 2013-01-03 14:55:15

> The Sage library patch [attachment:13899_doctest.patch] needs review.
This patch needs some work.   At least you should remove the remaining reference(s?) to `cdd_convert`.  Also, I'm a little surprised that you indented the last two examples by one more - shouldn't they be exactly four spaces from the start of the colon (I mean that column)?  I'm not sure why some of the doc has three spaces to the colon and then four more, but I've seen it before.  I assume the links for `tmp_dir` and `tmp_filename` work fine?


---

Comment by jdemeyer created at 2013-01-03 15:02:47

Replying to [comment:9 kcrisman]:
> I assume the links for `tmp_dir` and `tmp_filename` work fine?
No they don't, but I think links between two different manuals (in this case, from the developer manual to the reference manual) are not supported.


---

Comment by kcrisman created at 2013-01-03 15:11:15

> > I assume the links for `tmp_dir` and `tmp_filename` work fine?
> No they don't, but I think links between two different manuals (in this case, from the developer manual to the reference manual) are not supported.
Good point.  But in that case should they just be

```
`tmp_dir`
```

instead of

```
:func:`tmp_dir`
```

or does it just ignore this and not make a link?  I'm surprised it doesn't raise an error in building the doc (or does it?).


---

Comment by jdemeyer created at 2013-01-03 15:17:38

Replying to [comment:11 kcrisman]:
> or does it just ignore this and not make a link?
That's exactly what happens. If we ever allow inter-document links (does #6495 solve this?) the links should magically start working.


---

Attachment


---

Comment by jdemeyer created at 2013-01-03 15:26:09

Replying to [comment:9 kcrisman]:
> > The Sage library patch [attachment:13899_doctest.patch] needs review.
> This patch needs some work.   At least you should remove the remaining reference(s?) to `cdd_convert`.  Also, I'm a little surprised that you indented the last two examples by one more - shouldn't they be exactly four spaces from the start of the colon (I mean that column)?  I'm not sure why some of the doc has three spaces to the colon and then four more, but I've seen it before.

Okay, addressed your comments. New patch ready for review.


---

Comment by leif created at 2013-01-03 23:53:37

The example now using `tmp_filename()` (instead of `SAGE_TMP`) could probably be improved, as the temporary file's name immediately gets discarded.  (I think one would typically reuse it, e.g. to load a saved file later in an example / doctest.)


---

Comment by leif created at 2013-01-04 00:10:43

Otherwise Developer's Guide builds and all of its doctests pass now (still with beta1 though), so positive review again if Karl-Dieter's ok with it, too.


---

Comment by kcrisman created at 2013-01-04 01:42:04

> Otherwise Developer's Guide builds and all of its doctests pass now (still with beta1 though), so positive review again if Karl-Dieter's ok with it, too.
Believe it or not, this does not apply to beta2.  The first hunk is now

```
        def __init__(self, S, m):
            """
            See ``HillCryptosystem`` for full documentation.

            EXAMPLES::
            ...
            """
```

which is close enough to this patch not to warrant extra intrusion.


---

Attachment

Patchbot, apply 13899_TAB_sage_root.patch to root, 13899_TAB_sagelib.patch and trac_13899-doctest-rebase.patch to the Sage library, and 13899_TAB_scripts.patch to the scripts repository.

I have NOT looked at the other patches, only the doctest fix.  I do give positive review to the doctest fix (with my trivial rebase).


---

Comment by kcrisman created at 2013-01-04 01:55:00

Replying to [comment:17 kcrisman]:
> Patchbot, apply 13899_TAB_sage_root.patch to root, 13899_TAB_sagelib.patch and trac_13899-doctest-rebase.patch to the Sage library, and 13899_TAB_scripts.patch to the scripts repository.
> 
> I have NOT looked at the other patches, only the doctest fix.  I do give positive review to the doctest fix (with my trivial rebase).
Scratch that - I see what happened, Jeroen introduced the problem in his previous patch and then fixed it.  Now I have to wait for all those Cython files to rebuild to check how nice the developer guide looks... one moment.


---

Comment by kcrisman created at 2013-01-04 01:56:29

Patchbot, apply 13899_TAB_sage_root.patch to the root repository, 13899_TAB_sagelib.patch and 13899_doctest.patch to the Sage library, and 13899_TAB_scripts.patch to the scripts repository.

Okay, Jeroen's doctest patch is fine.  Sorry for the confusion.


---

Comment by jdemeyer created at 2013-01-04 09:14:56

Replying to [comment:19 kcrisman]:
> Okay, Jeroen's doctest patch is fine.  Sorry for the confusion.
Since leif already reviewed the other patches, I guess this means positive review then.


---

Comment by jdemeyer created at 2013-01-04 09:14:56

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-01-07 20:58:33

Resolution: fixed


---

Comment by vbraun created at 2013-01-13 14:36:46

This breaks the collection of 25 patches for IPython 0.13. Hopefully beautifying whitespace at least satisfies your OCD.


---

Comment by jdemeyer created at 2013-01-13 19:20:44

Replying to [comment:22 vbraun]:
> Hopefully beautifying whitespace at least satisfies your OCD.
And Guido van Rossums: [http://www.python.org/dev/peps/pep-0008/#indentation](http://www.python.org/dev/peps/pep-0008/#indentation)


---

Comment by jason created at 2013-01-15 00:32:35

Whew; -1 on massive whitespace changes like this unless they are actual errors because it breaks patches, which can be a lot of work to rebase.  I thought we had a whitespace beautifying discussion on sage-devel a while ago and we decided on the strategy of correcting whitespace as it was naturally encountered in code changes.  At least, that's what I thought.


---

Comment by jason created at 2013-01-15 00:33:24

I guess it's this that I have the most objection to: "Also, make indentation consistent and/or remove trailing spaces in some places.
"


---

Comment by kcrisman created at 2013-01-15 02:27:07

Replying to [comment:24 jason]:
> Whew; -1 on massive whitespace changes like this unless they are actual errors because it breaks patches, which can be a lot of work to rebase.  I thought we had a whitespace beautifying discussion on sage-devel a while ago and we decided on the strategy of correcting whitespace as it was naturally encountered in code changes.  At least, that's what I thought.
Sorry, guys, I guess I should have caught this because I recall that discussion too.  (And implemented it or something similar in some cases - see my comment at #13255.)  I was just trying to help out with the doctest patch, but somehow didn't really think of the rest as it had been "taken care of", but that's no excuse.


---

Comment by jdemeyer created at 2013-01-15 07:27:44

I apologize for the trouble.  It's true that I'm usually against there changes, but I somehow thought (apparently a mistake) that this was mostly code which isn't often changed.

Jason: which is the patch you're having trouble with rebasing?


---

Comment by leif created at 2013-01-15 15:20:22

Replying to [comment:27 jdemeyer]:
> I apologize for the trouble.  It's true that I'm usually against there changes, but I somehow thought (apparently a mistake) that this was mostly code which isn't often changed.

TBH, I was pretty aware of the discussions in the past when reviewing this, but regarding the files touched, didn't expect major breakage -- just like Jereon.  So to avoid reopening the lengthy debates of the past, I tried to quickly review it... ;-)

[And as mentioned, changing C/C++ and HTML files doesn't make that much sense to me, although those changes probably don't cause the trouble you may have now.]


---

Comment by jason created at 2013-01-15 16:11:27

The big set of patches that caught my attention and made me aware of this ticket was the IPython ticket, #12719, that Volker already rebased (see the comment above by him, which I think shows his frustration with having to rebase things).  I wouldn't be surprised if there were lots of other patches affected by some of the whitespace changes.


---

Comment by jason created at 2013-01-15 16:14:31

For the record, I would be +1 on reverting the parts of this patch that are touching lots of files for beauty's sake only (like removing trailing whitespace).  Large rebasing of tickets like #12719 could easily introduce subtle code errors, and not forcing those changes should take priority over end-of-line spacing.


---

Comment by jdemeyer created at 2013-01-15 16:33:01

Replying to [comment:30 jason]:
> For the record, I would be +1 on reverting the parts of this patch that are touching lots of files for beauty's sake only (like removing trailing whitespace)
Apart from the changes to `conventions.rst`, this patch is only about touching files for beauty's sake.  Given that #12719 is already rebased to this ticket, unmerging would be unwise. It seems that #12719 (which is a *huge* patch) conflicts with this in only one hunk, for a file which is removed in its totality.

So it's not a total disaster and it's not contradictory to leif's and my idea that these patches only touch rarely-edited files (except `conventions.rst` but that file really needed to be fixed).


---

Comment by leif created at 2013-01-15 16:46:39

Replying to [comment:30 jason]:
> Large rebasing of tickets like #12719 could easily introduce subtle code errors, and not forcing those changes should take priority over end-of-line spacing.

Just checked, and as far as I can see, the only offending patch here was removing an empty line from a file that #12719 removes in its entirety.  So I wouldn't say we broke much here, at least until now...

In general, patches IMHO shouldn't touch parts they don't have to (i.e., only doing some reformatting there), which we agreed on IIRC.  But in this case, the _purpose of the ticket_ is to remove tabs (and "normalize" code -- once and for all -- hopefully), so it does _not_ touch code it doesn't have to...


---

Comment by vbraun created at 2013-01-15 17:19:10

Automatically enforcing code style is nice but should only be done though local commit hooks. Having a check in Jeroen's release script is BS, that just adds a completely avoidable multi-week ping-pong game when trying to merge a ticket.

In any case this ticket is done so lets leave it at that. But please post to sage-devel next time so we can talk you out of it ;-)
