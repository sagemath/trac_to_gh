# Issue 29141: Update OpenBLAS to 0.3.9

Issue created by migration from https://trac.sagemath.org/ticket/29378

Original creator: mkoeppe

Original creation time: 2020-03-20 18:34:14

CC:  dimpase vbraun jpflori tmonteil embray @timokau jhpalmieri zimmerma @mwageringel mjo fbissey

0.3.9 was released in Feb 2020. https://github.com/xianyi/OpenBLAS/releases

The upstream tarball URL is in `checksums.ini`. To test the update on this branch: Use `make SAGE_SPKG="sage-spkg -o" openblas`; this will download the new upstream package automatically.

Related tickets:
- Previous update: #27847 openblas 0.3.6
- #29088 Fix BLAS-related installation errors on various systems
- #28768 another openblas build failure
- #28731 openblas sometimes fails its testsuite on OS X
- #28008 Linking OpenBLAS wrong on OSX
- #22179 Improve SAGE_FAT_BINARY for openblas
- #29170 Fix R installation errors related to gfortran
- #22006 CBC tries to use system's blas at runtime which creates an error
- #22822 openblas from Cygwin's package deadloops after fork
- #26000 sage with 64 bit openblas


---

Comment by mkoeppe created at 2020-03-20 18:38:22

New commits:


---

Comment by mkoeppe created at 2020-03-20 18:47:25

Tests run at https://github.com/mkoeppe/sage/actions/runs/59868244


---

Comment by mkoeppe created at 2020-03-21 01:52:47

The update by itself does not fix the errors of the type reported in #29170.

On `archlinux-latest-minimal` (https://github.com/mkoeppe/sage/runs/522730107):

```
cc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -fopenmp -fpic  -g -O2   -c integrate.c -o integrate.o
In file included from ../../src/include/R_ext/Applic.h:41,
                 from integrate.c:33:
../../src/include/R_ext/BLAS.h:103:55: error: expected declaration specifiers or '...' before ')' token
  103 |   const double *beta, double *y, const int *incy FCLEN);
      |                                                       ^
```



---

Comment by mkoeppe created at 2020-03-24 22:43:26

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-03-27 19:40:59

Tests ran at https://github.com/mkoeppe/sage/actions/runs/64126739

Fixes `fedora-32-standard` openblas build, and no problems on other platforms with this update. Needs review


---

Comment by dimpase created at 2020-03-28 02:33:24

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-03-28 02:33:24

lgtm (we still don't know from GH Actions whether tests pass on MacOS, but I suppose it is now for the bots)


---

Comment by mkoeppe created at 2020-03-28 03:50:26

Thanks!

I did the macOS test on my machine. The test didn't go through on [GitHub](GitHub) because of #29418


---

Comment by vbraun created at 2020-04-05 08:30:30

Resolution: fixed
