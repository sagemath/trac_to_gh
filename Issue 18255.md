# Issue 18255: sage's setup.py breaks on python 3

Issue created by migration from https://trac.sagemath.org/ticket/18492

Original creator: ohanar

Original creation time: 2015-05-24 19:50:37

Mostly trivially.


---

Comment by ohanar created at 2015-05-24 19:50:48

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-05-24 21:12:47

`six` should be mentioned as dependency of `sage` in `build/deps`.


---

Comment by jdemeyer created at 2015-05-24 21:12:47

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-05-24 21:22:54

Isn't there a Python-3 equivalent of

```
sys.stdout = os.fdopen(sys.stdout.fileno(), 'w', 0)
```


Changing the `print` statement is *not* equivalent to changing `stdout`.


---

Comment by ohanar created at 2015-05-24 21:50:57

Replying to [comment:3 jdemeyer]:
> Isn't there a Python-3 equivalent of
> {{{
> sys.stdout = os.fdopen(sys.stdout.fileno(), 'w', 0)
> }}}
> 
> Changing the `print` statement is *not* equivalent to changing `stdout`.

I agree, but no there isn't a python 3 equivalent: python 3 requires `sys.stdout` to be buffered, unless you start python with the `-u` (but you can also do that with python 2).


---

Comment by jdemeyer created at 2015-05-24 22:03:07

Not sure, but isn't there something possible with `sys.stdout.buffer` in Python 3?


---

Comment by ohanar created at 2015-05-24 22:53:55

Replying to [comment:5 jdemeyer]:
> Not sure, but isn't there something possible with `sys.stdout.buffer` in Python 3?
It allows you to write bytes to stdout: `sys.stdout.buffer` is a `BytesIO` interface to stdout, whereas `sys.stdout` is a `StringIO` interface to stdout.


---

Comment by git created at 2015-05-24 22:57:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ohanar created at 2015-05-24 22:58:39

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-05-24 22:59:50

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-05-25 07:07:56

Assuming that _you actually tested this_, positive_review since the diff looks good.


---

Comment by jdemeyer created at 2015-05-25 07:07:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-05-25 10:47:27

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-05-25 10:47:27

Apparently you haven't actually (doc-)tested it ;-)


---

Comment by git created at 2015-05-25 18:21:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ohanar created at 2015-05-25 18:23:14

Little hard to doctest on python 3 at the moment :)


---

Comment by ohanar created at 2015-05-25 18:23:14

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-05-26 20:06:15

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-05-27 20:03:19

Resolution: fixed
