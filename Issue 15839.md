# Issue 15839: Python 3 preparation: Py3 has no more the special object-function "__nonzero__"

archive/issues_015839.json:
```json
{
    "body": "CC:  @embray\n\nKeywords: python3\n\nThe tool 2to3 renames `__nonzero__` to `__bool__`.\n\n\nBut the code has to depend on the Python version!\n\nThere are 25 effected modules. \n\nThis ticket is tracked as a dependency of meta-ticket ticket:16052.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16076\n\n",
    "created_at": "2014-04-07T08:53:31Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Python 3 preparation: Py3 has no more the special object-function \"__nonzero__\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15839",
    "user": "https://github.com/wluebbe"
}
```
CC:  @embray

Keywords: python3

The tool 2to3 renames `__nonzero__` to `__bool__`.


But the code has to depend on the Python version!

There are 25 effected modules. 

This ticket is tracked as a dependency of meta-ticket ticket:16052.

Issue created by migration from https://trac.sagemath.org/ticket/16076





---

archive/issue_events_047304.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47304"
}
```



---

archive/issue_events_047305.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47305"
}
```



---

archive/issue_events_047306.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47306"
}
```



---

archive/issue_comments_205313.json:
```json
{
    "body": "Changing component from distribution to python3.",
    "created_at": "2016-05-02T13:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205313",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from distribution to python3.



---

archive/issue_comments_205314.json:
```json
{
    "body": "one step done (for the rings folder) in #21887",
    "created_at": "2016-11-17T16:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205314",
    "user": "https://github.com/fchapoton"
}
```

one step done (for the rings folder) in #21887



---

archive/issue_events_047307.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-11-17T16:16:41Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47307"
}
```



---

archive/issue_events_047308.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-11-17T16:16:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47308"
}
```



---

archive/issue_comments_205315.json:
```json
{
    "body": "another step in #21898",
    "created_at": "2016-11-18T20:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205315",
    "user": "https://github.com/fchapoton"
}
```

another step in #21898



---

archive/issue_events_047309.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-12T18:06:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47309"
}
```



---

archive/issue_events_047310.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-12T18:06:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47310"
}
```



---

archive/issue_comments_205316.json:
```json
{
    "body": "Here is a brute-force tentative\n\n* search and replace `__nonzero__` by `__bool__`\n* remove the former lines that have become `__bool__ = __bool__`\n\nLet us see what happens..\n----\nNew commits:",
    "created_at": "2017-01-22T14:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205316",
    "user": "https://github.com/fchapoton"
}
```

Here is a brute-force tentative

* search and replace `__nonzero__` by `__bool__`
* remove the former lines that have become `__bool__ = __bool__`

Let us see what happens..
----
New commits:



---

archive/issue_comments_205317.json:
```json
{
    "body": "ok, this was too brutal.",
    "created_at": "2017-01-25T10:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205317",
    "user": "https://github.com/fchapoton"
}
```

ok, this was too brutal.



---

archive/issue_comments_205318.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-25T10:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205318",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_205319.json:
```json
{
    "body": "ok, still not subtle enough..",
    "created_at": "2017-01-25T15:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205319",
    "user": "https://github.com/fchapoton"
}
```

ok, still not subtle enough..



---

archive/issue_comments_205320.json:
```json
{
    "body": "The way I've seen for this to be 2/3 compatible is to have `__bool__` be an alias for `__nonzero__` (or vice versa). The other way we could hack this is have in `SageObject`, as almost everything has this as a base class, we implement:\n\n```python\ndef __bool__(self):\n    return self.__nonzero__()\n```\n",
    "created_at": "2017-01-25T16:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205320",
    "user": "https://github.com/tscrim"
}
```

The way I've seen for this to be 2/3 compatible is to have `__bool__` be an alias for `__nonzero__` (or vice versa). The other way we could hack this is have in `SageObject`, as almost everything has this as a base class, we implement:

```python
def __bool__(self):
    return self.__nonzero__()
```




---

archive/issue_comments_205321.json:
```json
{
    "body": "Hello Travis,\n\nif you feel like giving it a try, please do. There is an abstract method `__nonzero__` somewhere, which is the last place where `__nonzero__` is not an alias (in python files).",
    "created_at": "2017-01-25T16:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205321",
    "user": "https://github.com/fchapoton"
}
```

Hello Travis,

if you feel like giving it a try, please do. There is an abstract method `__nonzero__` somewhere, which is the last place where `__nonzero__` is not an alias (in python files).



---

archive/issue_comments_205322.json:
```json
{
    "body": "I think we should keep things as `__nonzero__` for right now (up to having an explicit alias) for right now since we are in Python2 and to avoid the extra redirection. Although I guess to test how much this would cover things for Python3, it would have to be with a Python3 build.",
    "created_at": "2017-01-25T18:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205322",
    "user": "https://github.com/tscrim"
}
```

I think we should keep things as `__nonzero__` for right now (up to having an explicit alias) for right now since we are in Python2 and to avoid the extra redirection. Although I guess to test how much this would cover things for Python3, it would have to be with a Python3 build.



---

archive/issue_events_047311.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-06T17:50:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47311"
}
```



---

archive/issue_events_047312.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-06T17:50:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47312"
}
```



---

archive/issue_events_047313.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-23T12:50:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47313"
}
```



---

archive/issue_events_047314.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-23T12:50:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47314"
}
```



---

archive/issue_comments_205323.json:
```json
{
    "body": "why sage-pending ?",
    "created_at": "2017-11-23T13:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205323",
    "user": "https://github.com/fchapoton"
}
```

why sage-pending ?



---

archive/issue_comments_205324.json:
```json
{
    "body": "I might be misusing the milestone but this seems to be a very general task ticket not tied to a specific release milestone...?",
    "created_at": "2017-11-23T13:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205324",
    "user": "https://github.com/embray"
}
```

I might be misusing the milestone but this seems to be a very general task ticket not tied to a specific release milestone...?



---

archive/issue_events_047315.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-11-29T07:36:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47315"
}
```



---

archive/issue_events_047316.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-11-29T07:36:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47316"
}
```



---

archive/issue_comments_205325.json:
```json
{
    "body": "is this fixed by #24294?",
    "created_at": "2017-11-29T07:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205325",
    "user": "https://github.com/fchapoton"
}
```

is this fixed by #24294?



---

archive/issue_comments_205326.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-29T07:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205326",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_205327.json:
```json
{
    "body": "Replying to [comment:13 tscrim]:\n> The way I've seen for this to be 2/3 compatible is to have `__bool__` be an alias for `__nonzero__` (or vice versa). The other way we could hack this is have in `SageObject`, as almost everything has this as a base class, we implement:\n> {{{#!python\n> def __bool__(self):\n>     return self.__nonzero__()\n> }}}\n\nI know that this reply is pointless is now, but I guess that something like that would have worked :-)\n\nWe are doing something similar for division in `CategoryObject`:\n\n```\nfrom __future__ import division\n\ncdef class CategoryObject(SageObject):\n    def __div__(self, other):\n        return self / other\n```\n",
    "created_at": "2017-11-29T14:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205327",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:13 tscrim]:
> The way I've seen for this to be 2/3 compatible is to have `__bool__` be an alias for `__nonzero__` (or vice versa). The other way we could hack this is have in `SageObject`, as almost everything has this as a base class, we implement:
> {{{#!python
> def __bool__(self):
>     return self.__nonzero__()
> }}}

I know that this reply is pointless is now, but I guess that something like that would have worked :-)

We are doing something similar for division in `CategoryObject`:

```
from __future__ import division

cdef class CategoryObject(SageObject):
    def __div__(self, other):
        return self / other
```




---

archive/issue_comments_205328.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-29T14:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205328",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_205329.json:
```json
{
    "body": "Replying to [comment:20 chapoton]:\n> is this fixed by #24294?\n\nI don't think so by itself--I believe I've found some other examples affected by this (in non-Cython modules) but I could be mistaken.",
    "created_at": "2017-11-29T15:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205329",
    "user": "https://github.com/embray"
}
```

Replying to [comment:20 chapoton]:
> is this fixed by #24294?

I don't think so by itself--I believe I've found some other examples affected by this (in non-Cython modules) but I could be mistaken.



---

archive/issue_events_047317.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15839#event-47317"
}
```



---

archive/issue_comments_205330.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15839#issuecomment-205330",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix
