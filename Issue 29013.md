# Issue 29013: Three.js: Cleanup in preparation for adding camera viewpoint option

archive/issues_029013.json:
```json
{
    "body": "CC:  @egourgoulhon @jcamp0x2a\n\nKeywords: threejs\n\nBefore commandeering #29192 to add a new option to set the camera viewpoint, there are several points of cleanup that should be addressed:\n\n1) In the file plot3d/base.pyx the dictionary `js_options` is created a number of lines distant from where options are actually set. This struck me as double maintenance of lists, so I moved creation of this dictionary up in the file and set its entries immediately. This also makes explicit in one spot which options are being sent to the Three.js template.\n\n2) The variable names `aspect_ratio` and `axes_labels` are currently carried over into the Three.js template. Since camel case is more common for JavaScript people, I renamed these in the template.\n\n3) A couple CSS improvements inspired by the current branch of #29192 are included here\n\n4) The data for the viewpoint is overly precise: no one needs ten decimal places to set orientations in a graphic. The numerical values have been rounded to sufficient values.\n\nThis cleanup should be merged separately from #29192 for clarity.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29250\n\n",
    "created_at": "2020-02-27T01:16:15Z",
    "labels": [
        "graphics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Three.js: Cleanup in preparation for adding camera viewpoint option",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29013",
    "user": "@paulmasson"
}
```
CC:  @egourgoulhon @jcamp0x2a

Keywords: threejs

Before commandeering #29192 to add a new option to set the camera viewpoint, there are several points of cleanup that should be addressed:

1) In the file plot3d/base.pyx the dictionary `js_options` is created a number of lines distant from where options are actually set. This struck me as double maintenance of lists, so I moved creation of this dictionary up in the file and set its entries immediately. This also makes explicit in one spot which options are being sent to the Three.js template.

2) The variable names `aspect_ratio` and `axes_labels` are currently carried over into the Three.js template. Since camel case is more common for JavaScript people, I renamed these in the template.

3) A couple CSS improvements inspired by the current branch of #29192 are included here

4) The data for the viewpoint is overly precise: no one needs ten decimal places to set orientations in a graphic. The numerical values have been rounded to sufficient values.

This cleanup should be merged separately from #29192 for clarity.

Issue created by migration from https://trac.sagemath.org/ticket/29250





---

archive/issue_comments_410698.json:
```json
{
    "body": "Eric, if you have a notebook that stress-test overall options, then please test this ticket with it. I'm quite sure I caught all the options, but a second set of eyes is always useful.\n\nJoshua, after this ticket is merged I'll push a branch to #29192 to add the camera viewpoint setting. Please make sure you have all of your original code before I overwrite the public branch!\n----\nNew commits:",
    "created_at": "2020-02-27T01:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410698",
    "user": "@paulmasson"
}
```

Eric, if you have a notebook that stress-test overall options, then please test this ticket with it. I'm quite sure I caught all the options, but a second set of eyes is always useful.

Joshua, after this ticket is merged I'll push a branch to #29192 to add the camera viewpoint setting. Please make sure you have all of your original code before I overwrite the public branch!
----
New commits:



---

archive/issue_comments_410699.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-27T01:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410699",
    "user": "@paulmasson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_410700.json:
```json
{
    "body": "Much appreciated, Paul; the `viewpoint` option will be quite nice to have. I've got the original code for the branch so no worries. I'm almost 100% sure I'll have a conflict in plot3d/base.pyx and perhaps elsewhere with my animation work, so I'll rebase off your work before requesting the animation stuff get merged in.",
    "created_at": "2020-02-27T01:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410700",
    "user": "@jcamp0x2a"
}
```

Much appreciated, Paul; the `viewpoint` option will be quite nice to have. I've got the original code for the branch so no worries. I'm almost 100% sure I'll have a conflict in plot3d/base.pyx and perhaps elsewhere with my animation work, so I'll rebase off your work before requesting the animation stuff get merged in.



---

archive/issue_comments_410701.json:
```json
{
    "body": "Just finished testing these changes myself without issue so you have my vote. :) \n\nOne question I do have, though: you added some rounding with the \"get viewpoint\" data and also removed a space in the resulting string. I'm wondering if maybe someone is feeding this info into a script, program, or database and the formatting changes might break that?",
    "created_at": "2020-03-02T21:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410701",
    "user": "@jcamp0x2a"
}
```

Just finished testing these changes myself without issue so you have my vote. :) 

One question I do have, though: you added some rounding with the "get viewpoint" data and also removed a space in the resulting string. I'm wondering if maybe someone is feeding this info into a script, program, or database and the formatting changes might break that?



---

archive/issue_comments_410702.json:
```json
{
    "body": "Replying to [comment:4 gh-jcamp0x2a]:\n> One question I do have, though: you added some rounding with the \"get viewpoint\" data and also removed a space in the resulting string. I'm wondering if maybe someone is feeding this info into a script, program, or database and the formatting changes might break that?\nThe format of the viewpoint data is set by this [tutorial](http://doc.sagemath.org/html/en/thematic_tutorials/geometry/polytope_tikz.html) using tikz. It's all copy and paste right now.",
    "created_at": "2020-03-02T23:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410702",
    "user": "@paulmasson"
}
```

Replying to [comment:4 gh-jcamp0x2a]:
> One question I do have, though: you added some rounding with the "get viewpoint" data and also removed a space in the resulting string. I'm wondering if maybe someone is feeding this info into a script, program, or database and the formatting changes might break that?
The format of the viewpoint data is set by this [tutorial](http://doc.sagemath.org/html/en/thematic_tutorials/geometry/polytope_tikz.html) using tikz. It's all copy and paste right now.



---

archive/issue_comments_410703.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-03-02T23:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410703",
    "user": "@paulmasson"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_410704.json:
```json
{
    "body": "Need to redo ticket thanks to #21785",
    "created_at": "2020-03-02T23:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410704",
    "user": "@paulmasson"
}
```

Need to redo ticket thanks to #21785



---

archive/issue_comments_410705.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-03T01:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410705",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_410706.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-03-03T01:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410706",
    "user": "@paulmasson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_410707.json:
```json
{
    "body": "Should now be good to go, gentlemen. Please review!",
    "created_at": "2020-03-03T01:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410707",
    "user": "@paulmasson"
}
```

Should now be good to go, gentlemen. Please review!



---

archive/issue_comments_410708.json:
```json
{
    "body": "I went through and tested the various viewer options and the \"get viewpoint\" menu button again and didn't run into any issues.",
    "created_at": "2020-03-03T04:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410708",
    "user": "@jcamp0x2a"
}
```

I went through and tested the various viewer options and the "get viewpoint" menu button again and didn't run into any issues.



---

archive/issue_comments_410709.json:
```json
{
    "body": "Joshua, if you are satisfied with this ticket then enter your full name as a reviewer and set it to positive review.",
    "created_at": "2020-03-03T23:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410709",
    "user": "@paulmasson"
}
```

Joshua, if you are satisfied with this ticket then enter your full name as a reviewer and set it to positive review.



---

archive/issue_comments_410710.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-03T23:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410710",
    "user": "@jcamp0x2a"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_410711.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-05T23:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29013#issuecomment-410711",
    "user": "@vbraun"
}
```

Resolution: fixed
