# Issue 20405: Infinite recursion in exp_polar

Issue created by migration from https://trac.sagemath.org/ticket/20642

Original creator: nbruin

Original creation time: 2016-05-20 19:39:43

The following shows that `exp_polar` is relying on a `recursion depth exceeded` exception being caught in order to function:

```
sage: sys.setrecursionlimit(50000)
sage: exp_polar(-5.0 + 8.0*I)
<segfault>
```

It's the same problem as in #20624 and it means that either `_evalf_` must be removed entirely or must be rewritten in such a way that it doesn't call `_eval_`. This is due to a change introduced in [6d107297](http://git.sagemath.org/sage.git/diff/src/sage/symbolic/function.pyx?id=6d107297a5d8867f1a1e9996678ffa441adc8a2d) which shuffles methods and indiscriminately masks exceptions.


---

Comment by rws created at 2016-05-24 14:48:33

Maybe it's better to move this to Pynac right now (`exp` is already).


---

Comment by rws created at 2016-05-24 15:19:39

New commits:


---

Comment by rws created at 2016-05-24 15:19:39

Changing status from new to needs_review.


---

Comment by nbruin created at 2016-05-24 15:34:37

Is there a good reason for being so strict with the argument? It basically means we can't represent -1 presently:

```
exp_polar(0+RealField(12)(pi)*I).n(12)
```

Especially because the system is quite happy to work with arguments outside the principal value range, why do we need to be so strict for numerical evaluation?


---

Comment by rws created at 2016-06-11 14:43:19

Nils, I have no opinion on your question. I just want to submit a fix. Do you see any problems with this fix? Your question very much looks to me like a separate ticket.


---

Comment by nbruin created at 2016-06-11 15:50:09

OK, I guess your change does make the function work as specified. Once the patchbot is happy, this can get positive review as far as I'm concerned.


---

Comment by rws created at 2016-06-12 07:51:09

Thanks. I add your name if you don't mind.


---

Comment by rws created at 2016-06-12 07:51:09

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-06-12 23:11:25

Resolution: fixed
