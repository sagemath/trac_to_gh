# Issue 22889: Hidden bug: matching_polynomial() for graphs without edges

Issue created by migration from https://trac.sagemath.org/ticket/23126

Original creator: jdemeyer

Original creation time: 2017-06-02 09:15:18

The code of `matching_polynomial` has a hidden bug when the graph has zero edges: in this block of code

```
    edges = <int **>malloc(2 * nedges * sizeof(int *))
[...]
    edges1 = edges[0]
    edges2 = edges[1]
```

we access the first 2 elements of a 0-length array. Due to the way how `malloc()` works, this doesn't actually crash. But with `check_allocarray` from `cysignals`, it does crash.

The solution is easy: special case graphs without edges.


---

Comment by git created at 2017-06-02 10:19:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-06-02 10:20:22

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-06-02 19:19:13

ok, let it be.


---

Comment by chapoton created at 2017-06-02 19:19:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-07 20:13:06

Resolution: fixed
