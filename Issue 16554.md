# Issue 16554: DiGraph.period: new method

Issue created by migration from https://trac.sagemath.org/ticket/16791

Original creator: cheuberg

Original creation time: 2014-08-10 11:52:42

CC:  dkrenn skropf ncohen

Keywords: period, directed graph, is_aperiodic

New method to compute the period of a directed graph. A graph is aperiodic if its period equals 1.

I took the implementation of NetworkX' function `is_aperiodic` (wrapped in `DiGraph` since #16062), rewrote it into `DiGraph` and replaced the final check `g == 1` by returning the period.

For simplicity, the method is only implemented for strongly connected digraphs ... this is at the cost of some performance penalty for the check.


---

Comment by cheuberg created at 2014-08-10 11:55:35

Changing status from new to needs_review.


---

Comment by chapoton created at 2014-08-10 11:59:30

Please do not put the seealso on just one line, but rather do

```
.. SEEALSO::

    :meth:`is_aperiodic`
```



---

Comment by git created at 2014-08-10 17:39:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-08-11 09:16:09

Helllooooooooooooooooooo !!!

Could you make it work for "all" graphs, not only strongly connected ones ?

It is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).

Note that it replaces your call to `is_strongly_connected`, for if the list has length 1... So it does not cost more for the strongly connected case, and it makes it work for all other graphs.

Also, could you add a "seealso" from "is_aperiodic" to your new function ?

Thanks !

Nathann


---

Comment by git created at 2014-08-11 10:08:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2014-08-11 10:12:36

Replying to [comment:5 ncohen]:
> Could you make it work for "all" graphs, not only strongly connected ones ?
> 
> It is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).

I used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.

> Also, could you add a "seealso" from "is_aperiodic" to your new function ?

done.


---

Comment by ncohen created at 2014-08-11 11:38:27

Hello !

> I used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.

Hmmm... `:-/`

The thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`

> > Also, could you add a "seealso" from "is_aperiodic" to your new function ?
> 
> done.

Thanks.

Well, then I agree with your code and unless you plan to do something about the "speed" remark you can set the code to `positive_review` !

Nathann


---

Comment by git created at 2014-08-11 12:14:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2014-08-11 12:19:11

Replying to [comment:8 ncohen]:
> 
> The thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`

well, we move away from my initial intention of having code which only minimally deviates from the NetworkX code for `is_aperiodic` and does what I need it for `;-)`.

So, new proposal: no more subgraphs copying; I now force staying in the same component by a hash lookup where the hash used for the levels is re-used.


---

Comment by ncohen created at 2014-08-11 19:26:36

Hello !

Thanks for your modifications. I added a commit on top of yours at public/16791 which does two things:

1) creates an "alias" for the dictionary level. This is just to make the way you use this dictionary to test containment in the scc clearer

2) I decreased the level of indentation of the inner code by using a "continue"

3) I added a "if" to save some time when `g=1`

Now it is your turn to review my code. As usual, if there is anything you don't like, just say it ! `:-)`

Nathann


---

Comment by cheuberg created at 2014-08-12 03:40:44

Thank you, cross-reviewed your code. These changes are fine for me.


---

Comment by ncohen created at 2014-08-12 07:37:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-12 18:28:17

Resolution: fixed
