# Issue 16554: DiGraph.period: new method

archive/issues_016554.json:
```json
{
    "body": "CC:  dkrenn skropf ncohen\n\nKeywords: period, directed graph, is_aperiodic\n\nNew method to compute the period of a directed graph. A graph is aperiodic if its period equals 1.\n\nI took the implementation of NetworkX' function `is_aperiodic` (wrapped in `DiGraph` since #16062), rewrote it into `DiGraph` and replaced the final check `g == 1` by returning the period.\n\nFor simplicity, the method is only implemented for strongly connected digraphs ... this is at the cost of some performance penalty for the check.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16791\n\n",
    "created_at": "2014-08-10T11:52:42Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "DiGraph.period: new method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16554",
    "user": "cheuberg"
}
```
CC:  dkrenn skropf ncohen

Keywords: period, directed graph, is_aperiodic

New method to compute the period of a directed graph. A graph is aperiodic if its period equals 1.

I took the implementation of NetworkX' function `is_aperiodic` (wrapped in `DiGraph` since #16062), rewrote it into `DiGraph` and replaced the final check `g == 1` by returning the period.

For simplicity, the method is only implemented for strongly connected digraphs ... this is at the cost of some performance penalty for the check.

Issue created by migration from https://trac.sagemath.org/ticket/16791





---

archive/issue_comments_217777.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-10T11:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217777",
    "user": "cheuberg"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_217778.json:
```json
{
    "body": "Please do not put the seealso on just one line, but rather do\n\n```\n.. SEEALSO::\n\n    :meth:`is_aperiodic`\n```\n",
    "created_at": "2014-08-10T11:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217778",
    "user": "chapoton"
}
```

Please do not put the seealso on just one line, but rather do

```
.. SEEALSO::

    :meth:`is_aperiodic`
```




---

archive/issue_comments_217779.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-10T17:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217779",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217780.json:
```json
{
    "body": "Helllooooooooooooooooooo !!!\n\nCould you make it work for \"all\" graphs, not only strongly connected ones ?\n\nIt is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).\n\nNote that it replaces your call to `is_strongly_connected`, for if the list has length 1... So it does not cost more for the strongly connected case, and it makes it work for all other graphs.\n\nAlso, could you add a \"seealso\" from \"is_aperiodic\" to your new function ?\n\nThanks !\n\nNathann",
    "created_at": "2014-08-11T09:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217780",
    "user": "ncohen"
}
```

Helllooooooooooooooooooo !!!

Could you make it work for "all" graphs, not only strongly connected ones ?

It is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).

Note that it replaces your call to `is_strongly_connected`, for if the list has length 1... So it does not cost more for the strongly connected case, and it makes it work for all other graphs.

Also, could you add a "seealso" from "is_aperiodic" to your new function ?

Thanks !

Nathann



---

archive/issue_comments_217781.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-11T10:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217781",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217782.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> Could you make it work for \"all\" graphs, not only strongly connected ones ?\n> \n> It is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).\n\nI used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.\n\n> Also, could you add a \"seealso\" from \"is_aperiodic\" to your new function ?\n\ndone.",
    "created_at": "2014-08-11T10:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217782",
    "user": "cheuberg"
}
```

Replying to [comment:5 ncohen]:
> Could you make it work for "all" graphs, not only strongly connected ones ?
> 
> It is not that hard: `d.strongly_connected_components()` returns the list of strongly connected components. You can call it at the beginning of the function, and run your algorithm for one vertex per connected component (and take the gcd of all that).

I used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.

> Also, could you add a "seealso" from "is_aperiodic" to your new function ?

done.



---

archive/issue_comments_217783.json:
```json
{
    "body": "Hello !\n\n> I used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.\n\nHmmm... `:-/`\n\nThe thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`\n\n> > Also, could you add a \"seealso\" from \"is_aperiodic\" to your new function ?\n> \n> done.\n\nThanks.\n\nWell, then I agree with your code and unless you plan to do something about the \"speed\" remark you can set the code to `positive_review` !\n\nNathann",
    "created_at": "2014-08-11T11:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217783",
    "user": "ncohen"
}
```

Hello !

> I used `d.strongly_connected_components_subgraphs`: otherwise, we might follow a path from one connected component to another and either have to live with dealing with a component twice or check that this does not happen.

Hmmm... `:-/`

The thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`

> > Also, could you add a "seealso" from "is_aperiodic" to your new function ?
> 
> done.

Thanks.

Well, then I agree with your code and unless you plan to do something about the "speed" remark you can set the code to `positive_review` !

Nathann



---

archive/issue_comments_217784.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-11T12:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217784",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217785.json:
```json
{
    "body": "Replying to [comment:8 ncohen]:\n> \n> The thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`\n\nwell, we move away from my initial intention of having code which only minimally deviates from the NetworkX code for `is_aperiodic` and does what I need it for `;-)`.\n\nSo, new proposal: no more subgraphs copying; I now force staying in the same component by a hash lookup where the hash used for the levels is re-used.",
    "created_at": "2014-08-11T12:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217785",
    "user": "cheuberg"
}
```

Replying to [comment:8 ncohen]:
> 
> The thing with `strongly_connected_components_subgraphs` is that it triggers copies of the graph, even if the original graph is strongly connected `:-/`

well, we move away from my initial intention of having code which only minimally deviates from the NetworkX code for `is_aperiodic` and does what I need it for `;-)`.

So, new proposal: no more subgraphs copying; I now force staying in the same component by a hash lookup where the hash used for the levels is re-used.



---

archive/issue_comments_217786.json:
```json
{
    "body": "Hello !\n\nThanks for your modifications. I added a commit on top of yours at public/16791 which does two things:\n\n1) creates an \"alias\" for the dictionary level. This is just to make the way you use this dictionary to test containment in the scc clearer\n\n2) I decreased the level of indentation of the inner code by using a \"continue\"\n\n3) I added a \"if\" to save some time when `g=1`\n\nNow it is your turn to review my code. As usual, if there is anything you don't like, just say it ! `:-)`\n\nNathann",
    "created_at": "2014-08-11T19:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217786",
    "user": "ncohen"
}
```

Hello !

Thanks for your modifications. I added a commit on top of yours at public/16791 which does two things:

1) creates an "alias" for the dictionary level. This is just to make the way you use this dictionary to test containment in the scc clearer

2) I decreased the level of indentation of the inner code by using a "continue"

3) I added a "if" to save some time when `g=1`

Now it is your turn to review my code. As usual, if there is anything you don't like, just say it ! `:-)`

Nathann



---

archive/issue_comments_217787.json:
```json
{
    "body": "Thank you, cross-reviewed your code. These changes are fine for me.",
    "created_at": "2014-08-12T03:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217787",
    "user": "cheuberg"
}
```

Thank you, cross-reviewed your code. These changes are fine for me.



---

archive/issue_comments_217788.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-12T07:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217788",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_217789.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-12T18:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16554#issuecomment-217789",
    "user": "vbraun"
}
```

Resolution: fixed
