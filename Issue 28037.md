# Issue 28037: EnumeratedFamily should use integers as keys

Issue created by migration from https://trac.sagemath.org/ticket/28274

Original creator: @mwageringel

Original creation time: 2019-07-28 16:35:06

CC:  tscrim nthiery

This ticket solves the following problems involing `EnumeratedFamily`:

- The keys of an enumerated family should be integers. Currently, the elements of the family itself are returned.
  {{{
  sage: f = Family(Permutations(4))
  sage: f.keys()
  Standard permutations of 4
  sage: list(f.keys()) == list(f)  # should not be True here
  True
  }}}
  Because of this, looking up elements by key as in `f[next(iter(f.keys()))]` raises a type error. For example, this is used in `DisjointUnionEnumeratedSets`.

- The category of finite enumerated families should be in `FiniteEnumeratedSets()`, while currently it is only in `EnumeratedSets()`.

- Infinite enumerated families are currently indexed by `NonNegativeIntegers()` from `sage.categories.example.infinite_enumerated_sets`. This ticket replaces the usage of these example numbers by those in `sage.sets.non_negative_integers`. This also includes one instance in `baxter_permutations`.


---

Comment by @mwageringel created at 2019-07-28 16:48:39

Note that this ticket is independent from, but compatible with #28273.
----
New commits:


---

Comment by @mwageringel created at 2019-07-28 16:48:39

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-08-24 19:36:22

Travis, any opinion on this proposal ?


---

Comment by tscrim created at 2019-08-25 02:18:08

This is clearly a bug as it contradicts the documentation of `EnumeratedFamily`:

```
    :class:`EnumeratedFamily` turns an enumerated set ``c`` into a family
    indexed by the set `\{0,\dots, |c|-1\}`.
```


I don't understand this:
> The category of finite enumerated families should be in `FiniteEnumeratedSets()`, while currently it is only in `EnumeratedSets()`.
in both what is supposed to mean and what was changed.


---

Comment by @mwageringel created at 2019-08-25 08:43:01

Replying to [comment:3 tscrim]:
> I don't understand this:
> > The category of finite enumerated families should be in `FiniteEnumeratedSets()`, while currently it is only in `EnumeratedSets()`.
> in both what is supposed to mean and what was changed.

What I meant is that the category should be a subcategory of `FiniteEnumeratedSets()` so that the following can be used to check whether the family is finite.

```
sage: Family(Permutations(4)) in FiniteEnumeratedSets()  # should be True
False
```

The category is set based on whether the type of the keys is known to be finite, such as for lists and tuples. I added `range` to this detection, which is the type of keys of `EnumeratedFamily`. This bug was probably introduced when `six.moves.range` was imported into the module, as ordinarily in Python 2 `range` returns a list.


---

Comment by tscrim created at 2019-08-25 21:35:33

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-08-25 21:35:33

Okay, that helps quite a lot. Thanks.


---

Comment by @mwageringel created at 2019-08-25 21:40:14

Thank you.


---

Comment by vbraun created at 2019-09-02 21:40:48

Resolution: fixed
