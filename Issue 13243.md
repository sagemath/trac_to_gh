# Issue 13243: Prevent unneeded rebuilding when upgrading

archive/issues_013243.json:
```json
{
    "body": "Assignee: GeorgSWeber\n\nCC:  jhpalmieri\n\nSince (almost) every package depends on `patch` and `bzip2`, an update of either of these packages causes a rebuild of everything when upgrading.\n\nAn update of `prereq` even causes everything to be built twice(!) when upgrading (the new prereq script is only seen after the new root repo is installed, so the second `sage-upgrade` run for double-checking when install the new prereq and therefore rebuild everything).\n\nWe should simply remove dependencies of packages on `PREREQ`, `BZIP2` and `PATCH` and build those packages separately.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13415\n\n",
    "created_at": "2012-08-31T10:19:23Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "Prevent unneeded rebuilding when upgrading",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13243",
    "user": "jdemeyer"
}
```
Assignee: GeorgSWeber

CC:  jhpalmieri

Since (almost) every package depends on `patch` and `bzip2`, an update of either of these packages causes a rebuild of everything when upgrading.

An update of `prereq` even causes everything to be built twice(!) when upgrading (the new prereq script is only seen after the new root repo is installed, so the second `sage-upgrade` run for double-checking when install the new prereq and therefore rebuild everything).

We should simply remove dependencies of packages on `PREREQ`, `BZIP2` and `PATCH` and build those packages separately.

Issue created by migration from https://trac.sagemath.org/ticket/13415





---

archive/issue_comments_162254.json:
```json
{
    "body": "John, do you agree in principle with these patches?  They are sort-of ready, but I still have to test things properly (including upgrading).",
    "created_at": "2012-09-04T11:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162254",
    "user": "jdemeyer"
}
```

John, do you agree in principle with these patches?  They are sort-of ready, but I still have to test things properly (including upgrading).



---

archive/issue_comments_162255.json:
```json
{
    "body": "I've only given the patches a quick look, but this looks like a good idea (especially after trying an update recently which updated prereq).",
    "created_at": "2012-09-04T21:34:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162255",
    "user": "jhpalmieri"
}
```

I've only given the patches a quick look, but this looks like a good idea (especially after trying an update recently which updated prereq).



---

archive/issue_comments_162256.json:
```json
{
    "body": "Attachment [13415_separate_base_deps_2.patch](tarball://root/attachments/some-uuid/ticket13415/13415_separate_base_deps_2.patch) by jdemeyer created at 2012-09-13 17:18:01",
    "created_at": "2012-09-13T17:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162256",
    "user": "jdemeyer"
}
```

Attachment [13415_separate_base_deps_2.patch](tarball://root/attachments/some-uuid/ticket13415/13415_separate_base_deps_2.patch) by jdemeyer created at 2012-09-13 17:18:01



---

archive/issue_comments_162257.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-09-16T17:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162257",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_162258.json:
```json
{
    "body": "Attachment [13415_separate_base_deps_auto.patch](tarball://root/attachments/some-uuid/ticket13415/13415_separate_base_deps_auto.patch) by jdemeyer created at 2012-09-18 06:48:26\n\nJohn, any chance you could formally review this?  I have tested this many times on the buildbot (together with other tickets) and it seems to work fine.",
    "created_at": "2012-09-18T06:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162258",
    "user": "jdemeyer"
}
```

Attachment [13415_separate_base_deps_auto.patch](tarball://root/attachments/some-uuid/ticket13415/13415_separate_base_deps_auto.patch) by jdemeyer created at 2012-09-18 06:48:26

John, any chance you could formally review this?  I have tested this many times on the buildbot (together with other tickets) and it seems to work fine.



---

archive/issue_comments_162259.json:
```json
{
    "body": "This will conflict (not much) with the changes at #10508, which basically has positive review...",
    "created_at": "2012-09-19T01:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162259",
    "user": "kcrisman"
}
```

This will conflict (not much) with the changes at #10508, which basically has positive review...



---

archive/issue_comments_162260.json:
```json
{
    "body": "This looks okay to me. I think the conflicts will be easy to resolve.",
    "created_at": "2012-09-19T05:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162260",
    "user": "jhpalmieri"
}
```

This looks okay to me. I think the conflicts will be easy to resolve.



---

archive/issue_comments_162261.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-19T05:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162261",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_162262.json:
```json
{
    "body": "Replying to [comment:15 jhpalmieri]:\n> This looks okay to me. I think the conflicts will be easy to resolve.\nIndeed, it's just a matter of regenerating the auto-generated patch.",
    "created_at": "2012-09-19T06:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162262",
    "user": "jdemeyer"
}
```

Replying to [comment:15 jhpalmieri]:
> This looks okay to me. I think the conflicts will be easy to resolve.
Indeed, it's just a matter of regenerating the auto-generated patch.



---

archive/issue_comments_162263.json:
```json
{
    "body": "Many thanks for the review!",
    "created_at": "2012-09-19T06:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162263",
    "user": "jdemeyer"
}
```

Many thanks for the review!



---

archive/issue_comments_162264.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-09-19T06:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13243#issuecomment-162264",
    "user": "jdemeyer"
}
```

Resolution: fixed
