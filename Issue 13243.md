# Issue 13243: Prevent unneeded rebuilding when upgrading

Issue created by migration from https://trac.sagemath.org/ticket/13415

Original creator: jdemeyer

Original creation time: 2012-08-31 10:19:23

Assignee: GeorgSWeber

CC:  jhpalmieri

Since (almost) every package depends on `patch` and `bzip2`, an update of either of these packages causes a rebuild of everything when upgrading.

An update of `prereq` even causes everything to be built twice(!) when upgrading (the new prereq script is only seen after the new root repo is installed, so the second `sage-upgrade` run for double-checking when install the new prereq and therefore rebuild everything).

We should simply remove dependencies of packages on `PREREQ`, `BZIP2` and `PATCH` and build those packages separately.


---

Comment by jdemeyer created at 2012-09-04 11:21:24

John, do you agree in principle with these patches?  They are sort-of ready, but I still have to test things properly (including upgrading).


---

Comment by jhpalmieri created at 2012-09-04 21:34:15

I've only given the patches a quick look, but this looks like a good idea (especially after trying an update recently which updated prereq).


---

Attachment


---

Comment by jdemeyer created at 2012-09-16 17:42:24

Changing status from new to needs_review.


---

Attachment

John, any chance you could formally review this?  I have tested this many times on the buildbot (together with other tickets) and it seems to work fine.


---

Comment by kcrisman created at 2012-09-19 01:03:29

This will conflict (not much) with the changes at #10508, which basically has positive review...


---

Comment by jhpalmieri created at 2012-09-19 05:19:28

This looks okay to me. I think the conflicts will be easy to resolve.


---

Comment by jhpalmieri created at 2012-09-19 05:19:28

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-09-19 06:28:06

Replying to [comment:15 jhpalmieri]:
> This looks okay to me. I think the conflicts will be easy to resolve.
Indeed, it's just a matter of regenerating the auto-generated patch.


---

Comment by jdemeyer created at 2012-09-19 06:34:21

Many thanks for the review!


---

Comment by jdemeyer created at 2012-09-19 06:34:54

Resolution: fixed
