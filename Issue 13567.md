# Issue 13567: Canonical Forms and Automorphism Groups of linear codes

Issue created by migration from Trac.

Original creator: tfeulner

Original creation time: 2012-11-28 12:07:14

Assignee: wdj

CC:  okazymyrov dimpase mmarco

Two linear codes C, C' over a finite field F of length n are equivalent, if there is

 * a permutation pi in S<sub>n</sub>
 * a multiplication vector phi in F*<sup>n</sup> (F* the unit group)
 * an automorphism alpha of F

with C' = (phi, pi, alpha) C and the action is defined via

(phi, pi, alpha) (c<sub>0</sub>, ..., c<sub>n-1</sub>) = ( alpha( c<sub>pi(0)</sub>) phi<sub>0</sub><sup>-1</sup>  , ... , alpha( c<sub>pi(n-1)</sub>) phi<sub>n-1</sub><sup>-1</sup> )

This patch adds an algorithm for calculating a unique representative within the equivalence class of a given linear code. Furthermore, it computes the automorphism group of the code as a byproduct.

Finally, it can also deal with the action of subgroups of the semimonomial group.


---

Comment by tfeulner created at 2012-11-28 12:28:36

Changing keywords from "" to "linear code, canonical form, automorphism group, semilinear equiavelent".


---

Comment by tfeulner created at 2012-11-28 12:29:33

Changing keywords from "linear code, canonical form, automorphism group, semilinear equiavelent" to "linear code, canonical form, automorphism group, semilinear equivalent".


---

Comment by tfeulner created at 2013-01-07 13:35:52

Changing status from new to needs_review.


---

Comment by tfeulner created at 2013-10-21 12:49:43

rebased upon #13726


---

Comment by wdj created at 2013-10-21 17:35:10

Does this patch apply to 5.13.b0?


```
sage: hg_sage.patch("/home/wdj/sagefiles/sage-5.13.beta0/trac_13771-canonical_forms_linear_code.patch")
```

followed by sage -b gives


```
Installing c_lib
scons: `install' is up to date.
Updating Cython code....
missing cimport in module 'sage.groups.semimonomial_transformations.semimonomial_transformation': sage/coding/codecan/codecan.pxd
Compiling sage/coding/codecan/codecan.pyx because it changed.

...

Compiling sage/sets/disjoint_set.pyx because it depends on sage/groups/perm_gps/partn_ref/data_structures_pyx.pxi.
Cythonizing sage/coding/codecan/autgroup_can_label.pyx
Cythonizing sage/coding/codecan/codecan.pyx

Error compiling Cython file:
------------------------------------------------------------
...
from sage.groups.perm_gps.permgroup_element cimport PermutationGroupElement
from sage.groups.semimonomial_transformations.semimonomial_transformation cimport SemimonomialTransformation
^
```

etc


---

Comment by tfeulner created at 2013-10-23 06:41:11

Replying to [comment:9 wdj]:
> Does this patch apply to 5.13.b0?
It must be 5.13.b1. At least for the patchbot it seems to work, except for some old-style doctest continuation errors.


---

Comment by jdemeyer created at 2013-10-23 07:30:03

Why don't you test the exception directly, instead of working with a `try`/`except` clause? It is possible to doctest exceptions:

```
            sage: # something raising an exception
            Traceback (most recent call last):
            ...
            NotImplementedError
```



---

Comment by vbraun created at 2013-10-23 10:50:36

Interface-wise, it would be nice to expose the different styles of automorphism groups from linear code as

```
    `@`cached_method
    def automorphism_group(self, morphisms="semilinear"):
       ...
```

and return the actual automorphism group, not a list of generators and order. For that, you'd have to implement subgroups of the semimonomial transformation groups as a parent, but that ought to be easy: Just derive from the parent and override as necessary. We probably should have some infrastructure to make subgroups easier to construct (but that is material for another ticket). Then you wouldn't need `_canonize`.

The implementation looks good to me, can anybody who is actually working on something related to coding theory have a look?


---

Comment by dimpase created at 2013-10-23 14:59:17

Could you explain what 

```
Finally, it can also deal with the action of subgroups of the semimonomial group.
```

means? E.g. can you find the canonical form which does not take the ring automorphisms into account? (This would be natural is some settings, I suppose).


---

Comment by vbraun created at 2013-10-23 15:10:42

If you look at the docstring of `class LinearCodeAutGroupCanLabel` then you'll see. There is just permutations and only linear maps as subgroups, but currently you need to dig into the innards to construct them.


---

Comment by dimpase created at 2013-10-23 15:28:21

Replying to [comment:14 vbraun]:
> If you look at the docstring of `class LinearCodeAutGroupCanLabel` then you'll see. There is just permutations and only linear maps as subgroups, but currently you need to dig into the innards to construct them.

If the same algorithm works for any (or some other nontrivial well-defined class, e.g. the normal subgroups) of the subgroups of the semimonomial group, then there should be a proper interface for this exposed.


---

Comment by tfeulner created at 2013-10-24 06:43:46

Replying to [comment:12 vbraun]:
> Interface-wise, it would be nice to expose the different styles of automorphism groups from linear code as
> {{{
>     `@`cached_method
>     def automorphism_group(self, morphisms="semilinear"):
>        ...
> }}}

You are right, it would be nice to distinguish these different notions of equivalence in
`automorhpism_group` and also in `canonical_representative`. I will change that.
There is also the possibility to restrict the permutational part of the action to Young subgroups.
This is non-standard, should I provide an interface for that, too?

> Then you wouldn't need `_canonize`.

My algorithm computes the canonical representative and the automorphism group at the same time. Therefore I thought that I have to implement the method `_canonize`, which guarantees that the computation is carried out only once. But I think, I should define

```
     `@`cached_method
     def _canonize(self, equivalence="semilinear"):
     ...
```

instead and `automorphism_group` and `canonical_representative` need not to be cached.
> and return the actual automorphism group, not a list of generators and order. For that, you'd have to implement subgroups of the semimonomial transformation groups as a parent ...

I agree, but I am not sure how difficult this task will become. I am not working in academia anymore, so I am not sure if I will find enough time. Maybe we could open a seperate ticket with someone else being responsible?


---

Comment by tfeulner created at 2013-10-24 08:55:02

Replying to [comment:11 jdemeyer]:
> Why don't you test the exception directly, instead of working with a `try`/`except` clause? It is possible to doctest exceptions:
> {{{
>             sage: # something raising an exception
>             Traceback (most recent call last):
>             ...
>             NotImplementedError
> }}}

I have no idea, why I did this... I changed it.

The new version also provides an interface to the algorithm started for different notions of equivalence.


---

Comment by vbraun created at 2013-10-24 20:44:03

My point with the `automorphism_group` was mainly that its bad to make backwards-incompatible changes. If we implement the various subgroups properly then we would want to return the actual group and not a pair (generators, order). Its perfectly fine to leave that for future work, of course. How about we call it `automorphism_group_gens` or something like that, then we can in the future implement `automorphism_group` returning an actual group. 

Apart from that looks good... Dima, did you take a look at the code?


---

Comment by darij created at 2013-10-25 02:31:22

Just saw this mentioned on sage-combinat-devel; sorry I can't be of any actual help, so I thought I'll just drop a few remarks...

tfeulner: Given that you reference your thesis in the code, wouldn't it make sense to put it online on, say, arXiv?

I don't understand what `_cyclic_shift` is supposed to do. What is being cycled? If you want to get a cyclic permutation, why the `+ 1`'s in:

```
 	122	        x[p[i - 1]] = p[i] + 1 
 	123	    x[p[len(p) - 1]] = p[0] + 1 
```


"quadrupel" should be "quadruple".


```
 	45	    For every `i \in \{0, \ldots, n-1\}` 
 	46	    there is a group `G^{(i)}` and a surjective group homomorphism `f^{(i)}: G 
 	47	    \rightarrow G^{(i)}` such that `(f^{(i)}, \Pi^{(i)})` is a homomorphism of 
 	48	    group actions where `\Pi^{(i)}: X^n \rightarrow X` is the projection to 
 	49	    the `i`-th coordinate.
```

Isn't this a rather complicated way to say that the action of `G \rtimes \{id\}` on `X^n` is given by a direct product of several `G`-sets `X` ? I agree that the above is more precise, but can't you at least get rid of the `G^{(i)}` by assuming it to be `G` right away?


---

Attachment


---

Comment by tfeulner created at 2013-10-28 09:58:29

Replying to [comment:19 darij]:

Thanks for your comments, darij and Volker. I have changed the corresponding lines in the new patch.

> tfeulner: Given that you reference your thesis in the code, wouldn't it make sense to put it online on, say, arXiv?

At the moment, it is getting reviewed. The final version will be published online by the university,  maybe in about three months.


---

Comment by tfeulner created at 2013-11-23 08:02:00

Some weeks passed, I just want to bring this ticket back to your minds.


---

Comment by vbraun created at 2013-12-23 15:16:15

Dima, are you reviewing this ticket?

If not then I'll merge it, code looks good and is better than what we have (i.e. nothing).


---

Comment by dimpase created at 2013-12-23 15:25:34

Replying to [comment:22 vbraun]:
> Dima, are you reviewing this ticket?
> 
> If not then I'll merge it, code looks good and is better than what we have (i.e. nothing). 
No, I am not. Please merge this.


---

Comment by vbraun created at 2013-12-23 15:43:10

Does not apply to the latest Sage-6, please rebase.

Build sage-git and then run

```
sage -dev import-patch --url http://trac.sagemath.org/raw-attachment/ticket/13771/trac_13771-canonical_forms_linear_code.patch
```



---

Comment by tfeulner created at 2013-12-26 09:47:42

Dear Volker,

Thanks for this decision.

Before rebasing this ticket, I will work on #15576 and see if some changes will be necessary.


---

Comment by tfeulner created at 2013-12-31 15:48:11

Replying to [comment:24 vbraun]:

rebased to sage-6.1.beta2
----
New commits:


---

Comment by vbraun created at 2014-01-05 00:32:20

Resolution: fixed
