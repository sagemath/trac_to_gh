# Issue 17472: Maxima limit() regression

Issue created by migration from https://trac.sagemath.org/ticket/17709

Original creator: rws

Original creation time: 2015-02-01 08:40:38

CC:  tmonteil

`var('n'); u = (1+sqrt(n))^(-n); limit(u(n=n+1)/u,n=infinity)`: this was reported in http://ask.sagemath.org/question/25647/cannot-calculate-limit/ and worked at least in Sage-4.7


---

Comment by kcrisman created at 2015-02-03 14:22:49

Upstream [here](https://sourceforge.net/p/maxima/bugs/2899/).


---

Comment by mkoeppe created at 2020-08-29 18:42:12

Seems fixed in 9.2.beta10 - 0 is returned


---

Comment by mkoeppe created at 2020-08-29 18:42:12

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-08-29 18:43:46

(The upstream bug in maxima is still present; it seems we are using something else for computing the limit.)


---

Comment by kcrisman created at 2020-08-29 20:38:14

My guess is that we now, as with integration, go through several "algorithms"/programs to get limits.

I guess technically this is still a Sage bug, then, if that is true and one then specifies the `algorithm`?  Otherwise I'd at the very least add a doctest.


---

Comment by kcrisman created at 2020-08-29 20:38:14

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2020-10-13 11:47:27

Changing keywords from "" to "limit".


---

Comment by chapoton created at 2020-10-13 11:56:47

Replying to [comment:4 kcrisman]:
> My guess is that we now, as with integration, go through several "algorithms"/programs to get limits.

Not yet, as nobody did it..

> I guess technically this is still a Sage bug, then, if that is true and one then specifies the `algorithm`?  Otherwise I'd at the very least add a doctest.


---

Comment by kcrisman created at 2020-10-13 12:35:49

Hmm, that is interesting.  Maxima returns a nounform `'limit((sqrt(n)+1)<sup>n*(sqrt(n+1)+1)</sup>((-n)-1),n,inf)` inside of Sage 9.2.beta1

```
Maxima 5.42.2 http://maxima.sourceforge.net
using Lisp ECL 16.1.2
```

But I don't have the most recent Maxima.  Can you test this?

```
sage -maxima
<messages about Maxima 5.44, hopefully>
(%i1) limit((1+sqrt(n+1))^(-n-1)/(1+sqrt(n))^(-n),n,inf);
```

If you get zero then they fixed it, and then a doctest suffices.  Otherwise we may have something really weird going on in our own processing, though I don't see what would have changed - Frédéric is right about that, as far as I can tell.


---

Comment by kcrisman created at 2020-10-13 13:04:09

Can you also test this in `maxima_calculus` in the most recent Sage rc?  [Upstream says it is not fixed.](https://sourceforge.net/p/maxima/bugs/2899/#203b)  I still get 

```
sage: maxima_calculus("limit((1+sqrt(n+1))^(-n-1)/(1+sqrt(n))^(-n),n,inf)")
'limit((sqrt(n)+1)^n*(sqrt(n+1)+1)^((-n)-1),n,inf)
```



---

Comment by chapoton created at 2020-10-13 13:18:28

I get

```
sage: banner()                                                                  
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.2.rc2, Release Date: 2020-10-12                 │
│ Using Python 3.8.5. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: maxima_calculus("limit((1+sqrt(n+1))^(-n-1)/(1+sqrt(n))^(-n),n,inf)")     
'limit((sqrt(n)+1)^n*(sqrt(n+1)+1)^((-n)-1),n,inf)
```

**EDIT:**
with

```
Maxima 5.44.0 http://maxima.sourceforge.net
using Lisp ECL 20.4.24
```



---

Comment by kcrisman created at 2020-10-13 14:54:25

That is really weird.  I really can't find any branch of the code that should just avoid Maxima completely without adding an `algorithm`.  Can you confirm Matthias' contention that 

```
var('n'); u = (1+sqrt(n))^(-n); limit(u(n=n+1)/u,n=infinity)
```

now returns zero in that rc version?


---

Comment by chapoton created at 2020-10-13 15:32:05

no, this does not return 0. Maybe Matthias was looking at something else ?


---

Comment by mkoeppe created at 2020-10-13 16:44:00

I cannot confirm my claim from comment 2 above either. I don't know what I may have tested there.


---

Comment by kcrisman created at 2020-10-13 16:53:04

Ok, thanks - setting back settings then.  At least now Maxima has acknowledged  bug :-)


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by chapoton created at 2022-06-03 06:29:23

in 9.7.b1

```
sage: limit(u(n=n+1)/u,n=infinity,algorithm="sympy")
0
sage: limit(u(n=n+1)/u,n=infinity,algorithm="fricas")
0
sage: limit(u(n=n+1)/u,n=infinity,algorithm="giac")
// Giac share root-directory:/home/chapoton/sage/local/share/giac/
// Giac share root-directory:/home/chapoton/sage/local/share/giac/
Help file /home/chapoton/sage/local/share/giac/doc/fr/aide_cas not found
Added 0 synonyms
0
sage: limit(u(n=n+1)/u,n=infinity,algorithm="maxima")
limit((sqrt(n + 1) + 1)^(-n - 1)*(sqrt(n) + 1)^n, n, +Infinity)
```

