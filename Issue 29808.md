# Issue 29808: Bug in Reed-Solomon encoder and error-erasure decoder

archive/issues_029808.json:
```json
{
    "body": "CC:  @kliem\n\nKeywords: reed-solomon decoding\n\nThe following two snippets demonstrate two bugs when working with `GeneralizedReedSolomonCode`:\n\n\n```\nsage: F = GF(59)\nsage: n, k = 40, 12\nsage: C = codes.GeneralizedReedSolomonCode(F.list()[:n], k)\nsage: D = codes.decoders.GRSErrorErasureDecoder(C)\nsage: y = (vector(F, [0, 0, 10, 0, 0, 22, 0, 0, 38, 8, 34, 14, 33, 0, 0, 39, 0, 0, 0, 0, 17, 36, 43, 30, 10, 15, 0, 0, 21, 10, 37, 0, 0, 0, 0, 0, 0, 0, 0, 42]),\nsage:      vector(GF(2), [1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]))\nsage: D.decode_to_code(y)\n<BOOM>\n```\n\n\nDecoding to message works, but produces a vector of incorrect length (should equal the dimension, i.e. 12):\n\n\n```\n{\nsage: m = D.decode_to_message(y)\nsage: len(m)\n11\n```\n\n\n(The bugs were found by introducing random seeding in #29945)\n\nIssue created by migration from https://trac.sagemath.org/ticket/30045\n\n",
    "created_at": "2020-07-02T09:04:48Z",
    "labels": [
        "component: coding theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Bug in Reed-Solomon encoder and error-erasure decoder",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29808",
    "user": "https://github.com/johanrosenkilde"
}
```
CC:  @kliem

Keywords: reed-solomon decoding

The following two snippets demonstrate two bugs when working with `GeneralizedReedSolomonCode`:


```
sage: F = GF(59)
sage: n, k = 40, 12
sage: C = codes.GeneralizedReedSolomonCode(F.list()[:n], k)
sage: D = codes.decoders.GRSErrorErasureDecoder(C)
sage: y = (vector(F, [0, 0, 10, 0, 0, 22, 0, 0, 38, 8, 34, 14, 33, 0, 0, 39, 0, 0, 0, 0, 17, 36, 43, 30, 10, 15, 0, 0, 21, 10, 37, 0, 0, 0, 0, 0, 0, 0, 0, 42]),
sage:      vector(GF(2), [1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]))
sage: D.decode_to_code(y)
<BOOM>
```


Decoding to message works, but produces a vector of incorrect length (should equal the dimension, i.e. 12):


```
{
sage: m = D.decode_to_message(y)
sage: len(m)
11
```


(The bugs were found by introducing random seeding in #29945)

Issue created by migration from https://trac.sagemath.org/ticket/30045





---

archive/issue_comments_422925.json:
```json
{
    "body": "The second error seems to be due to `GeneralizedReedSolomonCode` having a `decode_to_message` implemented, which incorrectly converts between polynomials and vectors. I don't see why it should have this method implemented - it should be provided in the correct way by `AbstractCode`.",
    "created_at": "2020-07-02T09:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422925",
    "user": "https://github.com/johanrosenkilde"
}
```

The second error seems to be due to `GeneralizedReedSolomonCode` having a `decode_to_message` implemented, which incorrectly converts between polynomials and vectors. I don't see why it should have this method implemented - it should be provided in the correct way by `AbstractCode`.



---

archive/issue_comments_422926.json:
```json
{
    "body": "As posted already on #29945, I would propose to just fix the problem and don't worry about #29945.\n----\nNew commits:",
    "created_at": "2020-07-06T08:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422926",
    "user": "https://github.com/kliem"
}
```

As posted already on #29945, I would propose to just fix the problem and don't worry about #29945.
----
New commits:



---

archive/issue_comments_422927.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-06T08:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422927",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_422928.json:
```json
{
    "body": "OK, then this is up for review.",
    "created_at": "2020-07-06T08:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422928",
    "user": "https://github.com/johanrosenkilde"
}
```

OK, then this is up for review.



---

archive/issue_comments_422929.json:
```json
{
    "body": "The bug fix should be tested with a doctest yet.",
    "created_at": "2020-07-06T09:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422929",
    "user": "https://github.com/kliem"
}
```

The bug fix should be tested with a doctest yet.



---

archive/issue_comments_422930.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-06T09:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422931.json:
```json
{
    "body": "Right you are.",
    "created_at": "2020-07-06T09:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422931",
    "user": "https://github.com/johanrosenkilde"
}
```

Right you are.



---

archive/issue_comments_422932.json:
```json
{
    "body": "Can you please add the doctest that was removed with the method somewhere.\n\nAlso\n\n\n```diff\n-    Test that the bug in #30045 is fixed::\n+    Test that the bug in :trac:`30045` is fixed::\n```\n",
    "created_at": "2020-07-08T13:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422932",
    "user": "https://github.com/kliem"
}
```

Can you please add the doctest that was removed with the method somewhere.

Also


```diff
-    Test that the bug in #30045 is fixed::
+    Test that the bug in :trac:`30045` is fixed::
```




---

archive/issue_comments_422933.json:
```json
{
    "body": "And missing author name. Otherwise this looks good.",
    "created_at": "2020-07-10T08:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422933",
    "user": "https://github.com/kliem"
}
```

And missing author name. Otherwise this looks good.



---

archive/issue_comments_422934.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-10T08:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422934",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422935.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-10T08:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422935",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422936.json:
```json
{
    "body": "Thanks for the patience! It's been a while since I last fixed something in Sage ;-)",
    "created_at": "2020-07-10T08:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422936",
    "user": "https://github.com/johanrosenkilde"
}
```

Thanks for the patience! It's been a while since I last fixed something in Sage ;-)



---

archive/issue_comments_422937.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-10T10:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422937",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_422938.json:
```json
{
    "body": "LGTM. Thanks for fixing this.",
    "created_at": "2020-07-10T10:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422938",
    "user": "https://github.com/kliem"
}
```

LGTM. Thanks for fixing this.



---

archive/issue_events_027480.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-12T08:30:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29808#event-27480"
}
```



---

archive/issue_comments_422939.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-12T08:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29808#issuecomment-422939",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
