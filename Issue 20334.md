# Issue 20334: Newton method for nth_root of polynomial

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2016-05-08 01:51:36

CC:  nbruin behackl kedlaya

We can use Newton method to compute n-th root of polynomials. In all (?) cases, this should be much more efficient than relying on factorisation.


---

Comment by vdelecroix created at 2016-05-08 01:58:39

Waiting for #20086 to be merged... in the mean time people can have a look at [attachment:poly_nth_root.py].


---

Comment by nbruin created at 2016-05-08 05:22:01

We need to do something else when the characteristic divides n.

```
sage: R.<x>=GF(5)[]
sage: nth_root((x+1)^5,5)
ZeroDivisionError: Inverse does not exist.
```

Taking a p-th root (with p the characteristic) is easy, though: all exponents that occur need to be a multiple of p and we simply divide them by p. Similarly, we take a p-th root of all coefficients.


---

Attachment


---

Comment by vdelecroix created at 2016-05-08 23:48:31

Indeed! Thanks for having a look. I added some random tests in positive characteristic as well (and they pass).


---

Comment by vdelecroix created at 2016-05-24 01:04:06

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-05-24 01:04:06

All right. Ready for review!
----
New commits:


---

Comment by git created at 2016-05-24 14:56:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bruno created at 2016-06-10 16:22:31

Changing status from needs_review to needs_work.


---

Comment by bruno created at 2016-06-10 16:22:31

Hi Vincent,

1. For the Newton method, your loop ranges over `newton_method_sizes(p.degree()+1)`: if you are computing an `n`-th root, isn't it sufficient to loop up to `p.degree()//n + 1`? It would fasten the case when `p.nth_root(n)` raises an `Exception`.

2. Instead of the following code, you may use `i = self.valuation()`. The code would gain in legibility, and it is slightly faster if I ran my tests correctly:

```python
            i = 1
            while self[i].is_zero():
                i += 1
```


3. Two typos:

```diff
        This is computed using Newton method in the ring of power series. This
        method works only when the base ring is an integral domain. Morever, for
        polynomial whose coefficient of lower degree is different from 1, the
-        elemehts of the base ring should have a method ``nth_root`` implemented.
+        elements of the base ring should have a method ``nth_root`` implemented.
```


```diff
-            # begining of Newton method
+            # beginning of Newton method
            Sorig = p.parent()
```



---

Comment by git created at 2016-06-10 22:31:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-06-10 22:32:39

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2016-06-10 22:32:39

Hi Bruno,

Thanks for having a look. I implemented your suggestions.

Vincent


---

Comment by bruno created at 2016-06-13 15:36:43

Looks good to me!


---

Comment by bruno created at 2016-06-13 15:36:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-06-14 07:10:26

Resolution: fixed
