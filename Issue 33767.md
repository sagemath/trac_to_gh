# Issue 33767: Inconsistent behaviour for subgraph_search_iterator

Issue created by migration from https://trac.sagemath.org/ticket/34004

Original creator: pelegm

Original creation time: 2022-06-16 14:56:03

Keywords: subgraph

Let `g` be the complete graph on 3 vertices.

1. The command

```
g.subgraph_search_iterator(graphs.PathGraph(0))
```

returns a **list** with a single element, and that element is a **Graph**.

2. The command

```
g.subgraph_search_iterator(graphs.PathGraph(1))
```

returns a **list_iterator**,  and the first element there is a **Graph**.

3. The command

```
g.subgraph_search_iterator(graphs.PathGraph(2))
```

returns a **`SubgraphSearch`** instance, and the first element there is a **list**.

That makes it (very) hard to work with.

Tried in [SageMath](SageMath) version 9.0, Release Date: 2020-01-01.



---

Comment by dcoudert created at 2022-06-16 17:24:41

Good catch. I assume that the expected behavior is to yield graphs, right ? and method `subgraph_search` should just return the first graph found by method `subgraph_search_iterator`.


---

Comment by pelegm created at 2022-06-16 18:50:42

I think that yielding graphs is probably indeed the best way to go. But it's also not good to return a list (rather than an iterator).


---

Comment by dcoudert created at 2022-06-17 17:26:24

Let me know if this is OK.

I added an extra parameter in case one prefers to get lists of vertices.
----
New commits:


---

Comment by dcoudert created at 2022-06-17 17:26:24

Changing status from new to needs_review.


---

Comment by git created at 2022-06-17 19:32:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-06-17 19:33:11

Should be ok now.


---

Comment by git created at 2022-06-26 12:26:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-06-26 12:26:44

Just fixed a pycodestyle issue


---

Comment by vdelecroix created at 2022-06-27 05:39:08

While you are at it, could you scream if not simple

```
sage: G = Graph(2)
sage: H = Graph([(0,0)], loops=True)
sage: next(G.subgraph_search_iterator(H))
Graph on 1 vertex
```



---

Comment by git created at 2022-06-27 09:18:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-06-27 09:20:55

I did several improvements, in particular to ensure that we cannot search of a digraph in a graph, and that the type of each yielded graph is the same as the type of self (graph, digraph, bipartite graph).

I have not doctested the loop/multiedges cases. I don't think it's necessary.


---

Comment by vdelecroix created at 2022-06-29 08:47:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-07-09 22:33:21

Resolution: fixed
