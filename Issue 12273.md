# Issue 12273: revise Sage banner, help message

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2012-02-04 22:22:14

Assignee: jason

Keywords: banner help

This arose from some of the discussion at #12421. In summary: we don't need to mention `license()` in the Sage banner.  Instead, we should mention the `help()` command.  I also added basic information about using `less` with introspection to the help message.


---

Comment by jhpalmieri created at 2012-02-04 22:23:13

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2012-02-04 22:29:59

Note that the new browser won't appear when you start Sage unless you produce a Sage distribution with `sage --sdist ...` or `sage --bdist ...`. To look at the new banner, type `banner()` while running Sage. The old banner:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
```

After the patch:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
```



---

Comment by jhpalmieri created at 2012-02-04 22:47:34

See #12447: the file COPYING.txt (printed when you run `license()`) is out-of-date.


---

Comment by davidloeffler created at 2012-03-12 12:31:00

This seems to cause a couple of doctests in sage/misc to fail -- see patchbot logs. (Looks like doctests for the introspection machinery are using the Sage banner as a test case.)


---

Comment by davidloeffler created at 2012-03-12 12:31:00

Changing status from needs_review to needs_work.


---

Attachment

Here's a patch which fixes those broken doctests.


---

Comment by jhpalmieri created at 2012-03-12 17:54:50

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2012-05-16 20:25:24

I'm wondering whether the following looks better:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
```

as opposed to

```
----------------------------------------------------------------------
----------------------------------------------------------------------
```



---

Comment by jhpalmieri created at 2012-05-16 20:58:41

I don't have a strong opinion about it either way, but Python uses quotes: when I start Python, I see

```
Python 2.7.2 (default, May 14 2012, 16:40:23) 
[GCC 4.6.3] on darwin
Type "help", "copyright", "credits" or "license" for more information.
```

(Of course, when you type `help`, it essentially tells you to type `help()` instead.)


---

Comment by kcrisman created at 2012-05-17 14:12:46

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2012-05-17 14:12:46

I like this.  jhpalmieri _always_ knows how to add actual helpful documentation that is not too verbose.

This changes the help message after `sage -br` ~~but for some reason it doesn't actually change the banner~~ and now I read comment:2.  

As for the quotes, I don't have a strong opinion either and this seems reasonable.  I guess if we get emails asking for how to use help we'll need to change it!

All the sage/misc/ tests pass, and so although I'm going to run all of them now I'll put this as positive review.  I don't think it's a problem we don't test these, because in theory Sage should work fine without the very very long process of building documentation (why oh why is that not parallelized yet?).


---

Attachment


---

Comment by jdemeyer created at 2012-05-18 15:25:15

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2012-05-18 15:25:15

I have a slight preference for double quotes, hence my reviewer patch.  It fixes some docstring formatting also.


---

Comment by jdemeyer created at 2012-05-18 15:26:09

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2012-05-18 17:05:59

I'm ready to give this a positive review, except for two issues, fixed in my referee's patch. Please check my changes, and give the ticket a positive review if you're happy with them.

 - A doctest fails because of the changes to lines 93-94 of banner.py: the old doctest ended in "...", while the new one doesn't, so it doesn't handle banners for beta versions (which include "Warning: this is a prerelease version...").
 - Also, you were a little over-enthusiastic with search-and-replace: `function"s`, line 1413, and `Python"s`, line 1425, of sagedoc.py.


---

Comment by kcrisman created at 2012-05-18 17:08:44

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2012-05-18 17:08:44

You did a search/replace for single quotes, didn't you?

```
function"s
To enter Python"s 
```

And does `COPYING.txt` need to be quoted at all?  I didn't catch that last time, maybe I should have.

I assume that the "without warranty" business is no longer needed, then, and is implicit in the GPL?


---

Comment by kcrisman created at 2012-05-18 17:11:13

Hmm, maybe that whole "couldn't take your changes because someone else changed it in the meantime" was useful after all, huh?  Sorry, John.

These changes seem fine as long as they apply.  I assume that the banner change in the most recent patch is only needed for betas, but will it cause a non-beta doctest to fail, since there won't be any dot-dot-dot to dot-dot-dot?


---

Comment by kcrisman created at 2012-05-18 17:20:02

As I suspected:

```
sage -t  "devel/sage-main/sage/misc/banner.py"              
**********************************************************************
File "/Users/.../sage-5.0/devel/sage-main/sage/misc/banner.py", line 91:
    sage: banner()
Expected:
    ----------------------------------------------------------------------
    | Sage Version ..., Release Date: ...
    | Type "notebook()" for the browser-based notebook interface.        |
    | Type "help()" for help.                                            |
    ----------------------------------------------------------------------
    ...
Got:
    ----------------------------------------------------------------------
    | Sage Version 5.0, Release Date: 2012-05-14                         |
    | Type "notebook()" for the browser-based notebook interface.        |
    | Type "help()" for help.                                            |
    ----------------------------------------------------------------------
**********************************************************************
1 items had failures:
   1 of   4 in __main__.example_3
***Test Failed*** 1 failures.
	sage -t  "devel/sage-main/sage/misc/banner.py"
Total time for all tests: 2.0 seconds
```



---

Comment by kcrisman created at 2012-05-18 17:21:17

Maybe just instead of ending the last line with the "bars" and then doing ..., could one just have it end ... instead of the "bars"?  Or a few bars, like

```
-----------...
```

would take care of it?  I realize that is inelegant.


---

Comment by jhpalmieri created at 2012-05-18 17:21:51

I thought I had tested that. Here's a revised version which works on top of both 5.1.beta0 and 5.0.


---

Comment by jhpalmieri created at 2012-05-18 17:22:11

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2012-05-18 17:45:51

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2012-05-18 17:45:51

I think this should be okay.  I don't have any "beta" versions on hand right now but this seems like the right fix.

I added Jeroen to the author for his contribution.

Aack!

```

sage -t  devel/sage-main/sage/misc/lazy_attribute.py
**********************************************************************
File "/Users/.../sage-5.0/devel/sage-main/sage/misc/lazy_attribute.py", line 498:
    sage: lines
Expected:
    80
Got:
    77
**********************************************************************
sage -t  devel/sage-main/sage/misc/abstract_method.py
**********************************************************************
File "/Users/.../sage-5.0/devel/sage-main/sage/misc/abstract_method.py", line 196:
    sage: lines
Expected:
    80
Got:
    77
**********************************************************************
```

If it isn't too terribly much trouble to update that ref patch one last time...


---

Comment by kcrisman created at 2012-05-18 17:47:11

By the way, do you know a way to use hg queues to import the same named patch, replacing the current one?  I always have to hg qremove it, which is annoying because they have long hard-to-type names.


---

Attachment

This should fix it - just updated John's patch with the correct number of lines for doctesting.  I'm reluctant to hit "positive review" though I think it is...


---

Comment by kcrisman created at 2012-05-18 18:33:57

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2012-05-18 18:34:21

Patchbot: Apply [attachment:trac_12445-banner.patch], [attachment:12445_doublequote.patch], and [attachment:trac_12445-ref2.patch] to the main Sage library.


---

Comment by jhpalmieri created at 2012-05-19 04:22:13

All tests pass on the directory misc, with both 5.0 and 5.1.beta0.


---

Comment by jdemeyer created at 2012-05-19 07:59:08

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-05-23 21:32:06

Resolution: fixed
