# Issue 21520: Bug in reflection group to_matrix

Issue created by migration from https://trac.sagemath.org/ticket/21757

Original creator: stumpc5

Original creation time: 2016-10-24 12:53:25

CC:  chapoton

Keywords: reflection group, gap3

The following doctest used to work:

```
sage: W = ReflectionGroup((3,1,2))          # optional - gap3
sage: for w in W:                           # optional - gap3
....:     w.reduced_word()                  # optional - gap3
....:     [w.to_matrix(), w.to_matrix(on_space="dual")] # optional - gap3
```

and now breaks in

```
'SageMath version 7.4, Release Date: 2016-10-18'
```



---

Comment by tscrim created at 2016-10-24 14:25:41

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-10-24 14:25:41

This was caused by an overly generous removal of `keys()` from families. I've added them back in (and cc-ing Frédéric so we are more careful about this in the future).
----
New commits:


---

Comment by stumpc5 created at 2016-10-24 14:27:59

Great, thanks for the fix! I will review it once I have some spare cpu/memory...


---

Comment by stumpc5 created at 2016-10-25 07:27:04

Changing status from needs_review to positive_review.


---

Comment by stumpc5 created at 2016-10-25 07:27:04

sage builds and tests pass


---

Comment by vbraun created at 2016-10-31 12:32:31

Resolution: fixed
