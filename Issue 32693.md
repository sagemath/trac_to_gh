# Issue 32693: IPython/Jupyter upgrade for python 3.10 support

archive/issues_032693.json:
```json
{
    "body": "CC:  @enriqueartal @tornaria @egourgoulhon @kwankyu @orlitzky\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32930\n\n",
    "created_at": "2021-11-25T02:19:28Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "IPython/Jupyter upgrade for python 3.10 support",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32693",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @enriqueartal @tornaria @egourgoulhon @kwankyu @orlitzky



Issue created by migration from https://trac.sagemath.org/ticket/32930





---

archive/issue_comments_465883.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2021-11-25T02:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465883",
    "user": "https://github.com/mkoeppe"
}
```

Last 10 new commits:



---

archive/issue_comments_465884.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-11-25T04:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465884",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_465885.json:
```json
{
    "body": "Tests look OK. Ready for review",
    "created_at": "2021-11-26T03:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465885",
    "user": "https://github.com/mkoeppe"
}
```

Tests look OK. Ready for review



---

archive/issue_comments_465886.json:
```json
{
    "body": "Is a similar ticket needed for JupyterLab\n(optional package) too?",
    "created_at": "2021-11-27T14:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465886",
    "user": "https://github.com/slel"
}
```

Is a similar ticket needed for JupyterLab
(optional package) too?



---

archive/issue_comments_465887.json:
```json
{
    "body": "There's a separate ticket somewhere for that",
    "created_at": "2021-11-28T00:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465887",
    "user": "https://github.com/mkoeppe"
}
```

There's a separate ticket somewhere for that



---

archive/issue_comments_465888.json:
```json
{
    "body": "Oh, #32069, I see.",
    "created_at": "2021-11-28T00:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465888",
    "user": "https://github.com/slel"
}
```

Oh, #32069, I see.



---

archive/issue_comments_465889.json:
```json
{
    "body": "I'm testing this along with #31535. I've run\n\n\n```\n$ EXTRA_CONFIGURE_ARGS=\"--without-system-python3\" tox -e local-direct -- build sagelib-tox-python-sagewheels-nopypi\n```\n\n\nand I'm seeing doctest failures like\n\n\n```\nFailed example:\n    shell = get_test_shell()\nExpected nothing\nGot:\n    doctest:warning\n    ...\n   :\n    UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv.\n    Error processing line 1 of /home/mjo/src/sage.git/pkgs/sagemath-standard/.tox/python-sagewheels-nopypi/lib/python3.9/site-packages/_virtualenv.pth:\n    <BLANKLINE>\n      Traceback (most recent call last):\n        File \"/home/mjo/src/sage.git/.tox/local-direct/local/lib/python3.9/site.py\", line 169, in addpackage\n          exec(line)\n        File \"<string>\", line 1, in <module>\n      ModuleNotFoundError: No module named '_virtualenv'\n    <BLANKLINE>\n    Remainder of file ignored\n```\n\n\nDoes that look like a tox issue, or something that changed with ipython?",
    "created_at": "2021-12-03T20:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465889",
    "user": "https://github.com/orlitzky"
}
```

I'm testing this along with #31535. I've run


```
$ EXTRA_CONFIGURE_ARGS="--without-system-python3" tox -e local-direct -- build sagelib-tox-python-sagewheels-nopypi
```


and I'm seeing doctest failures like


```
Failed example:
    shell = get_test_shell()
Expected nothing
Got:
    doctest:warning
    ...
   :
    UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv.
    Error processing line 1 of /home/mjo/src/sage.git/pkgs/sagemath-standard/.tox/python-sagewheels-nopypi/lib/python3.9/site-packages/_virtualenv.pth:
    <BLANKLINE>
      Traceback (most recent call last):
        File "/home/mjo/src/sage.git/.tox/local-direct/local/lib/python3.9/site.py", line 169, in addpackage
          exec(line)
        File "<string>", line 1, in <module>
      ModuleNotFoundError: No module named '_virtualenv'
    <BLANKLINE>
    Remainder of file ignored
```


Does that look like a tox issue, or something that changed with ipython?



---

archive/issue_comments_465890.json:
```json
{
    "body": "I think this might be fixed with #32933",
    "created_at": "2021-12-03T21:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465890",
    "user": "https://github.com/mkoeppe"
}
```

I think this might be fixed with #32933



---

archive/issue_comments_465891.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-04T03:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465891",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_465892.json:
```json
{
    "body": "Yep, looks like that was it.",
    "created_at": "2021-12-04T03:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465892",
    "user": "https://github.com/orlitzky"
}
```

Yep, looks like that was it.



---

archive/issue_comments_465893.json:
```json
{
    "body": "Thanks for reviewing!",
    "created_at": "2021-12-04T06:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465893",
    "user": "https://github.com/mkoeppe"
}
```

Thanks for reviewing!



---

archive/issue_comments_465894.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-12-17T17:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465894",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_029643.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-23T20:26:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32693#event-29643"
}
```



---

archive/issue_comments_465895.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-23T20:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32693",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32693#issuecomment-465895",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
