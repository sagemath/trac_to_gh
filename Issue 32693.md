# Issue 32693: IPython/Jupyter upgrade for python 3.10 support

Issue created by migration from https://trac.sagemath.org/ticket/32930

Original creator: mkoeppe

Original creation time: 2021-11-25 02:19:28

CC:  enriqueartal tornaria egourgoulhon klee mjo




---

Comment by mkoeppe created at 2021-11-25 02:45:51

Last 10 new commits:


---

Comment by mkoeppe created at 2021-11-25 04:04:25

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-11-26 03:13:31

Tests look OK. Ready for review


---

Comment by slelievre created at 2021-11-27 14:16:01

Is a similar ticket needed for JupyterLab
(optional package) too?


---

Comment by mkoeppe created at 2021-11-28 00:11:15

There's a separate ticket somewhere for that


---

Comment by slelievre created at 2021-11-28 00:18:15

Oh, #32069, I see.


---

Comment by mjo created at 2021-12-03 20:17:07

I'm testing this along with #31535. I've run


```
$ EXTRA_CONFIGURE_ARGS="--without-system-python3" tox -e local-direct -- build sagelib-tox-python-sagewheels-nopypi
```


and I'm seeing doctest failures like


```
Failed example:
    shell = get_test_shell()
Expected nothing
Got:
    doctest:warning
    ...
   :
    UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv.
    Error processing line 1 of /home/mjo/src/sage.git/pkgs/sagemath-standard/.tox/python-sagewheels-nopypi/lib/python3.9/site-packages/_virtualenv.pth:
    <BLANKLINE>
      Traceback (most recent call last):
        File "/home/mjo/src/sage.git/.tox/local-direct/local/lib/python3.9/site.py", line 169, in addpackage
          exec(line)
        File "<string>", line 1, in <module>
      ModuleNotFoundError: No module named '_virtualenv'
    <BLANKLINE>
    Remainder of file ignored
```


Does that look like a tox issue, or something that changed with ipython?


---

Comment by mkoeppe created at 2021-12-03 21:03:00

I think this might be fixed with #32933


---

Comment by mjo created at 2021-12-04 03:12:26

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2021-12-04 03:12:26

Yep, looks like that was it.


---

Comment by mkoeppe created at 2021-12-04 06:20:21

Thanks for reviewing!


---

Comment by mkoeppe created at 2021-12-17 17:42:01

Changing priority from major to critical.


---

Comment by vbraun created at 2021-12-23 20:26:29

Resolution: fixed
