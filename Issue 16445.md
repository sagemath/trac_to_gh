# Issue 16445: Fix random_element of polynomial ring

archive/issues_016445.json:
```json
{
    "body": "CC:  @pjbruin @defeo @miguelmarco @vbraun\n\nThe degree is not the one expected (as there is no check that the dominant coefficient is nonzero):\n\n```\nsage: R = PolynomialRing(GF(2),'z')\nsage: R.random_element(degree=5).degree()\n3\n```\n\n\nThis was found in #16681\n\nIssue created by migration from https://trac.sagemath.org/ticket/16682\n\n",
    "created_at": "2014-07-19T10:15:27Z",
    "labels": [
        "number theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Fix random_element of polynomial ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16445",
    "user": "@videlec"
}
```
CC:  @pjbruin @defeo @miguelmarco @vbraun

The degree is not the one expected (as there is no check that the dominant coefficient is nonzero):

```
sage: R = PolynomialRing(GF(2),'z')
sage: R.random_element(degree=5).degree()
3
```


This was found in #16681

Issue created by migration from https://trac.sagemath.org/ticket/16682





---

archive/issue_comments_216190.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-19T10:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216190",
    "user": "@videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_216191.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-07-19T10:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216191",
    "user": "@videlec"
}
```

New commits:



---

archive/issue_comments_216192.json:
```json
{
    "body": "Hi Vincent,\n\nwhy are you treating the degree 0 case differently? Since the degree of 0 is -1, wouldn't it be better to guarantee that random_element with degree 0 doesn't return 0?\nThat is, why don't you just remove these two lines:\n\n```\nif degree == 0:\nreturn self(R.random_element(*args, **kwds))\n```\n",
    "created_at": "2014-07-21T18:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216192",
    "user": "jkeitel"
}
```

Hi Vincent,

why are you treating the degree 0 case differently? Since the degree of 0 is -1, wouldn't it be better to guarantee that random_element with degree 0 doesn't return 0?
That is, why don't you just remove these two lines:

```
if degree == 0:
return self(R.random_element(*args, **kwds))
```




---

archive/issue_comments_216193.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-25T05:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216193",
    "user": "@vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_216194.json:
```json
{
    "body": "Agreed.",
    "created_at": "2014-07-25T05:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216194",
    "user": "@vbraun"
}
```

Agreed.



---

archive/issue_comments_216195.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-25T07:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216195",
    "user": "jkeitel"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_216196.json:
```json
{
    "body": "I simply removed these two lines and extended the doctest. If you're happy with that, you can it to positive review.\n----\nNew commits:",
    "created_at": "2014-07-25T07:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216196",
    "user": "jkeitel"
}
```

I simply removed these two lines and extended the doctest. If you're happy with that, you can it to positive review.
----
New commits:



---

archive/issue_comments_216197.json:
```json
{
    "body": "Hi Jan,\n\nIf you have a suggestion, I don't mind that you do it. And we can discuss it. I do not find acceptable that you come and set your branch as default.\n\nNow, concretely about your commit: `R.random_element(degree=whatever)` will **never** return the zero polynomial. So I would not say that it \"works\".\n\nThe new commit handles the case of `degree=-1` which correspond to the zero polynomial.\n\nVincent\n----\nNew commits:",
    "created_at": "2014-07-25T07:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216197",
    "user": "@videlec"
}
```

Hi Jan,

If you have a suggestion, I don't mind that you do it. And we can discuss it. I do not find acceptable that you come and set your branch as default.

Now, concretely about your commit: `R.random_element(degree=whatever)` will **never** return the zero polynomial. So I would not say that it "works".

The new commit handles the case of `degree=-1` which correspond to the zero polynomial.

Vincent
----
New commits:



---

archive/issue_comments_216198.json:
```json
{
    "body": "Hi Vincent,\n\nsorry, I certainly didn't mean to offend you and your current branch is a better solution.\n\nHowever, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have\n\n\n```\nsage: R = PolynomialRing(GF(2), 'z')\nsage: R.random_element(degree=-2)\n1\n```\n",
    "created_at": "2014-07-25T08:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216198",
    "user": "jkeitel"
}
```

Hi Vincent,

sorry, I certainly didn't mean to offend you and your current branch is a better solution.

However, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have


```
sage: R = PolynomialRing(GF(2), 'z')
sage: R.random_element(degree=-2)
1
```




---

archive/issue_comments_216199.json:
```json
{
    "body": "Vincent, changing the \"Branch\" field on the trac ticket is the recommended way of collaborating. Change it back if you don't like the proposed commits, easy.",
    "created_at": "2014-07-25T14:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216199",
    "user": "@vbraun"
}
```

Vincent, changing the "Branch" field on the trac ticket is the recommended way of collaborating. Change it back if you don't like the proposed commits, easy.



---

archive/issue_comments_216200.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-07T14:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216200",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216201.json:
```json
{
    "body": "Replying to [comment:6 jkeitel]:\n> Hi Vincent,\n> \n> sorry, I certainly didn't mean to offend you and your current branch is a better solution.\n\nEverybody works differently, so no offense at all.\n\n> However, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have\n\nI always assume that the user is intelligent enough... done in the last commit.\n\nVincent\n----\nNew commits:",
    "created_at": "2014-08-07T14:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216201",
    "user": "@videlec"
}
```

Replying to [comment:6 jkeitel]:
> Hi Vincent,
> 
> sorry, I certainly didn't mean to offend you and your current branch is a better solution.

Everybody works differently, so no offense at all.

> However, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have

I always assume that the user is intelligent enough... done in the last commit.

Vincent
----
New commits:



---

archive/issue_comments_216202.json:
```json
{
    "body": "There are several doctest that need to be fixed... I am on it.\n\nVincent",
    "created_at": "2014-08-07T14:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216202",
    "user": "@videlec"
}
```

There are several doctest that need to be fixed... I am on it.

Vincent



---

archive/issue_comments_216203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T09:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216203",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216204.json:
```json
{
    "body": "Needs review.\n\nVincent",
    "created_at": "2014-08-13T09:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216204",
    "user": "@videlec"
}
```

Needs review.

Vincent



---

archive/issue_comments_216205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-13T09:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216205",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_216206.json:
```json
{
    "body": "Can you raise a ValueError of input is out of bounds (degree <= -2)? Assertions are for spelling out contracts, not validating user input. In particular, assertions can be disabled at compile-time.",
    "created_at": "2014-08-24T15:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216206",
    "user": "@vbraun"
}
```

Can you raise a ValueError of input is out of bounds (degree <= -2)? Assertions are for spelling out contracts, not validating user input. In particular, assertions can be disabled at compile-time.



---

archive/issue_comments_216207.json:
```json
{
    "body": "Apart from that, positive review.",
    "created_at": "2014-08-24T15:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216207",
    "user": "@vbraun"
}
```

Apart from that, positive review.



---

archive/issue_comments_216208.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-24T15:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216208",
    "user": "@vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_216209.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-24T16:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216209",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216210.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-24T16:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216210",
    "user": "@videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_216211.json:
```json
{
    "body": "done",
    "created_at": "2014-08-24T16:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216211",
    "user": "@videlec"
}
```

done



---

archive/issue_comments_216212.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-24T16:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216212",
    "user": "@videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_216213.json:
```json
{
    "body": "Thanks!",
    "created_at": "2014-08-24T16:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216213",
    "user": "@videlec"
}
```

Thanks!



---

archive/issue_comments_216214.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-25T10:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16445#issuecomment-216214",
    "user": "@vbraun"
}
```

Resolution: fixed
