# Issue 16445: Fix random_element of polynomial ring

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2014-07-19 10:15:27

CC:  pbruin defeo mmarco vbraun

The degree is not the one expected (as there is no check that the dominant coefficient is nonzero):

```
sage: R = PolynomialRing(GF(2),'z')
sage: R.random_element(degree=5).degree()
3
```


This was found in #16681


---

Comment by vdelecroix created at 2014-07-19 10:22:36

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2014-07-19 10:22:36

New commits:


---

Comment by jkeitel created at 2014-07-21 18:03:34

Hi Vincent,

why are you treating the degree 0 case differently? Since the degree of 0 is -1, wouldn't it be better to guarantee that random_element with degree 0 doesn't return 0?
That is, why don't you just remove these two lines:

```
if degree == 0:
return self(R.random_element(*args, **kwds))
```



---

Comment by vbraun created at 2014-07-25 05:04:35

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2014-07-25 05:04:35

Agreed.


---

Comment by jkeitel created at 2014-07-25 07:38:04

Changing status from needs_work to needs_review.


---

Comment by jkeitel created at 2014-07-25 07:38:04

I simply removed these two lines and extended the doctest. If you're happy with that, you can it to positive review.
----
New commits:


---

Comment by vdelecroix created at 2014-07-25 07:57:58

Hi Jan,

If you have a suggestion, I don't mind that you do it. And we can discuss it. I do not find acceptable that you come and set your branch as default.

Now, concretely about your commit: `R.random_element(degree=whatever)` will *never* return the zero polynomial. So I would not say that it "works".

The new commit handles the case of `degree=-1` which correspond to the zero polynomial.

Vincent
----
New commits:


---

Comment by jkeitel created at 2014-07-25 08:08:05

Hi Vincent,

sorry, I certainly didn't mean to offend you and your current branch is a better solution.

However, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have


```
sage: R = PolynomialRing(GF(2), 'z')
sage: R.random_element(degree=-2)
1
```



---

Comment by vbraun created at 2014-07-25 14:20:08

Vincent, changing the "Branch" field on the trac ticket is the recommended way of collaborating. Change it back if you don't like the proposed commits, easy.


---

Comment by git created at 2014-08-07 14:26:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-07 14:26:27

Replying to [comment:6 jkeitel]:
> Hi Vincent,
> 
> sorry, I certainly didn't mean to offend you and your current branch is a better solution.

Everybody works differently, so no offense at all.

> However, what about doing one more check that `degree >-1` and raising an error if that's not the case? At the moment we have

I always assume that the user is intelligent enough... done in the last commit.

Vincent
----
New commits:


---

Comment by vdelecroix created at 2014-08-07 14:34:52

There are several doctest that need to be fixed... I am on it.

Vincent


---

Comment by git created at 2014-08-13 09:22:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-13 09:22:26

Needs review.

Vincent


---

Comment by git created at 2014-08-13 09:31:57

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vbraun created at 2014-08-24 15:59:17

Can you raise a ValueError of input is out of bounds (degree <= -2)? Assertions are for spelling out contracts, not validating user input. In particular, assertions can be disabled at compile-time.


---

Comment by vbraun created at 2014-08-24 15:59:34

Apart from that, positive review.


---

Comment by vbraun created at 2014-08-24 15:59:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-08-24 16:46:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-24 16:47:28

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-08-24 16:47:28

done


---

Comment by vdelecroix created at 2014-08-24 16:47:53

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2014-08-24 16:48:00

Thanks!


---

Comment by vbraun created at 2014-08-25 10:27:52

Resolution: fixed
