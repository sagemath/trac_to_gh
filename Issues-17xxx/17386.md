# Issue 17386: Enumerate points of bounded height in projective/affine space over number fields

archive/issues_017149.json:
```json
{
    "body": "Add functionality to iterate over points of bounded height in projective/affine space over a number field. Also add functionality to list the points of height less than a given bound on a scheme defined over a number field.\n\nCC:  @bhutz\n\nBranch: [63b6422759a26bc2393a952b186731296e14fe48](https://github.com/sagemath/sagetrac-mirror/commit/63b6422759a26bc2393a952b186731296e14fe48)\n\nReviewer: Ben Hutz\n\nAuthor: Grayson Jorgenson\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17386\n\n",
    "closed_at": "2015-02-18T08:53:23Z",
    "created_at": "2014-11-24T05:26:20Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Enumerate points of bounded height in projective/affine space over number fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17386",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
Add functionality to iterate over points of bounded height in projective/affine space over a number field. Also add functionality to list the points of height less than a given bound on a scheme defined over a number field.

CC:  @bhutz

Branch: [63b6422759a26bc2393a952b186731296e14fe48](https://github.com/sagemath/sagetrac-mirror/commit/63b6422759a26bc2393a952b186731296e14fe48)

Reviewer: Ben Hutz

Author: Grayson Jorgenson

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17386





---

archive/issue_comments_299121.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gjorgenson/ticket/17386\"",
    "created_at": "2014-11-24T05:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299121",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing branch from "" to "u/gjorgenson/ticket/17386"



---

archive/issue_comments_299122.json:
```json
{
    "body": "Changing commit from \"\" to \"456c7213880388ca6311348c55a798cf5a9b1187\"",
    "created_at": "2014-11-28T06:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "456c7213880388ca6311348c55a798cf5a9b1187"



---

archive/issue_comments_299123.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[456c721](https://github.com/sagemath/sagetrac-mirror/commit/456c7213880388ca6311348c55a798cf5a9b1187)|`Added enumeration functionality for affine space over number fields.`|",
    "created_at": "2014-11-28T06:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299123",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[456c721](https://github.com/sagemath/sagetrac-mirror/commit/456c7213880388ca6311348c55a798cf5a9b1187)|`Added enumeration functionality for affine space over number fields.`|



---

archive/issue_comments_299124.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-28T07:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299124",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_299125.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-18T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299125",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_299126.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2014-12-18T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299126",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_299127.json:
```json
{
    "body": "<a id='comment:4'></a>\nHere is a first pass at reviewing this.\n\nFirst you need to be careful with the difference between relative height and absolute height. The function K.elements_of_bounded_height() is returning with respect to a bound of relative height (as its documentation says). I would think most users would be interested in absolute height rational points for schemes. So you'll need to fix the functionality here, but also fix the documentation to specify which height in all appropriate places.\n\nAlso, specify whether the bound is <= or <\n\n`numberField` is not a good variable name as [CamelCase](CamelCase) is reserved for class names.\n\nIn projective_homset.py put the imports near where they are needed so you only import what you need (this is done correctly in affine_homset.py)\n\nSome examples that I expected to work that didn't\n\n```\nu = QQ['u'].0\nK.<v> = NumberField(u^2 + 3)\nA.<x,y> = ProjectiveSpace(K,1)\nX=A.subscheme(x-y)\nX.rational_points(3)\n```\nsame for affine\n\n```\nfrom sage.schemes.projective.projective_rational_point import enum_projective_number_field\nenum_projective_number_field(X,3)\n```\n\n```\nfrom sage.schemes.affine.affine_rational_point import enum_affine_number_field\nenum_affine_number_field(X,3)\n```\n\nI think the issues with the enum_ functions is whether the input should be the scheme `X` or the point set `X(K)`. Clarify which in the documentation for the functions. However, the X.rational_points ones seem to actually be failing.",
    "created_at": "2014-12-18T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299127",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:4'></a>
Here is a first pass at reviewing this.

First you need to be careful with the difference between relative height and absolute height. The function K.elements_of_bounded_height() is returning with respect to a bound of relative height (as its documentation says). I would think most users would be interested in absolute height rational points for schemes. So you'll need to fix the functionality here, but also fix the documentation to specify which height in all appropriate places.

Also, specify whether the bound is <= or <

`numberField` is not a good variable name as [CamelCase](CamelCase) is reserved for class names.

In projective_homset.py put the imports near where they are needed so you only import what you need (this is done correctly in affine_homset.py)

Some examples that I expected to work that didn't

```
u = QQ['u'].0
K.<v> = NumberField(u^2 + 3)
A.<x,y> = ProjectiveSpace(K,1)
X=A.subscheme(x-y)
X.rational_points(3)
```
same for affine

```
from sage.schemes.projective.projective_rational_point import enum_projective_number_field
enum_projective_number_field(X,3)
```

```
from sage.schemes.affine.affine_rational_point import enum_affine_number_field
enum_affine_number_field(X,3)
```

I think the issues with the enum_ functions is whether the input should be the scheme `X` or the point set `X(K)`. Clarify which in the documentation for the functions. However, the X.rational_points ones seem to actually be failing.



---

archive/issue_comments_299128.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[9eb56a3](https://github.com/sagemath/sagetrac-mirror/commit/9eb56a31db4299eac0299ef3dae7dba8d7fc4be5)|`17386: Implemented some of the changes discussed by the review.`|\n|[9e610df](https://github.com/sagemath/sagetrac-mirror/commit/9e610dfbc873f87685de92ee14363b333a8fe522)|`17386: Merge branch 'master' into ticket/17386`|\n|[003884c](https://github.com/sagemath/sagetrac-mirror/commit/003884c155f7fc53bd649617fc5c983e545aefbd)|`17386: finished implementing changes from first review`|",
    "created_at": "2015-01-27T19:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299128",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[9eb56a3](https://github.com/sagemath/sagetrac-mirror/commit/9eb56a31db4299eac0299ef3dae7dba8d7fc4be5)|`17386: Implemented some of the changes discussed by the review.`|
|[9e610df](https://github.com/sagemath/sagetrac-mirror/commit/9e610dfbc873f87685de92ee14363b333a8fe522)|`17386: Merge branch 'master' into ticket/17386`|
|[003884c](https://github.com/sagemath/sagetrac-mirror/commit/003884c155f7fc53bd649617fc5c983e545aefbd)|`17386: finished implementing changes from first review`|



---

archive/issue_comments_299129.json:
```json
{
    "body": "Changing commit from \"456c7213880388ca6311348c55a798cf5a9b1187\" to \"003884c155f7fc53bd649617fc5c983e545aefbd\"",
    "created_at": "2015-01-27T19:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299129",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "456c7213880388ca6311348c55a798cf5a9b1187" to "003884c155f7fc53bd649617fc5c983e545aefbd"



---

archive/issue_comments_299130.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-27T19:15:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299130",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_299131.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks like we are almost there with this one. The functionality all is in working order. But, I came across a few minor things to fix.\n\naffine_rational_point\nexample line 168 is a long test so add -> # long time\nprobably makes more sense to make the bound smaller and get the test < 1s\n\naffine_space -> line 777 not needed, but move the comment to 779\n\naffine_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).\n\nalgebraic_scheme -> line 1502 no longer need is_RationalField(F)\n\nprojective_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).\n\nprojective_space -> line 94 not needed -> move comment to 951\n\n\nThere are a few places where the lines in the docs are too long. You need to wrap those. Such as line 748 in affine_space.py\n\n\nAnother bad example:\n\n```\nu = QQ['u'].0\nK.<v> = NumberField(u^2 + 3)\nA.<x,y> = ProjectiveSpace(K,1)\nX=A.subscheme(x-y)\nX.rational_points(3)\nfrom sage.schemes.affine.affine_rational_point import enum_affine_number_field\nenum_affine_number_field(X,3)\n```\noops...X is projective and we called enum_affine successfully!! Need a check in those functions to make sure the ambient space is Affine or Projective",
    "created_at": "2015-01-29T14:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299131",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:7'></a>
Looks like we are almost there with this one. The functionality all is in working order. But, I came across a few minor things to fix.

affine_rational_point
example line 168 is a long test so add -> # long time
probably makes more sense to make the bound smaller and get the test < 1s

affine_space -> line 777 not needed, but move the comment to 779

affine_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).

algebraic_scheme -> line 1502 no longer need is_RationalField(F)

projective_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).

projective_space -> line 94 not needed -> move comment to 951


There are a few places where the lines in the docs are too long. You need to wrap those. Such as line 748 in affine_space.py


Another bad example:

```
u = QQ['u'].0
K.<v> = NumberField(u^2 + 3)
A.<x,y> = ProjectiveSpace(K,1)
X=A.subscheme(x-y)
X.rational_points(3)
from sage.schemes.affine.affine_rational_point import enum_affine_number_field
enum_affine_number_field(X,3)
```
oops...X is projective and we called enum_affine successfully!! Need a check in those functions to make sure the ambient space is Affine or Projective



---

archive/issue_comments_299132.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-29T14:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299132",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_299133.json:
```json
{
    "body": "Changing commit from \"003884c155f7fc53bd649617fc5c983e545aefbd\" to \"f786719b1183eb412e2898deb002b9e3cf3603d4\"",
    "created_at": "2015-02-03T17:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "003884c155f7fc53bd649617fc5c983e545aefbd" to "f786719b1183eb412e2898deb002b9e3cf3603d4"



---

archive/issue_comments_299134.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|\n|[f786719](https://github.com/sagemath/sagetrac-mirror/commit/f786719b1183eb412e2898deb002b9e3cf3603d4)|`17386: Implemented changes from second review. In addition to these changes, also added checks in`|",
    "created_at": "2015-02-03T17:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299134",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
|[f786719](https://github.com/sagemath/sagetrac-mirror/commit/f786719b1183eb412e2898deb002b9e3cf3603d4)|`17386: Implemented changes from second review. In addition to these changes, also added checks in`|



---

archive/issue_comments_299135.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-03T17:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299135",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_299136.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[63b6422](https://github.com/sagemath/sagetrac-mirror/commit/63b6422759a26bc2393a952b186731296e14fe48)|`17386: removed uneeded references`|",
    "created_at": "2015-02-03T18:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299136",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[63b6422](https://github.com/sagemath/sagetrac-mirror/commit/63b6422759a26bc2393a952b186731296e14fe48)|`17386: removed uneeded references`|



---

archive/issue_comments_299137.json:
```json
{
    "body": "Changing commit from \"f786719b1183eb412e2898deb002b9e3cf3603d4\" to \"63b6422759a26bc2393a952b186731296e14fe48\"",
    "created_at": "2015-02-03T18:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f786719b1183eb412e2898deb002b9e3cf3603d4" to "63b6422759a26bc2393a952b186731296e14fe48"



---

archive/issue_comments_299138.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-03T19:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299138",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_299139.json:
```json
{
    "body": "<a id='comment:11'></a>\nOk. this looks good now.",
    "created_at": "2015-02-03T19:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299139",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:11'></a>
Ok. this looks good now.



---

archive/issue_comments_299140.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-18T08:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299140",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_299141.json:
```json
{
    "body": "Changing branch from \"u/gjorgenson/ticket/17386\" to \"63b6422759a26bc2393a952b186731296e14fe48\"",
    "created_at": "2015-02-18T08:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299141",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gjorgenson/ticket/17386" to "63b6422759a26bc2393a952b186731296e14fe48"



---

archive/issue_events_056971.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-18T08:53:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17386#event-56971"
}
```



---

archive/issue_events_056972.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/gjorgenson",
    "created_at": "2015-02-20T17:18:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17386#event-56972"
}
```



---

archive/issue_comments_299142.json:
```json
{
    "body": "Changing commit from \"63b6422759a26bc2393a952b186731296e14fe48\" to \"\"",
    "created_at": "2015-02-20T17:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-299142",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing commit from "63b6422759a26bc2393a952b186731296e14fe48" to ""
