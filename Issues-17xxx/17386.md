# Issue 17386: Enumerate points of bounded height in projective/affine space over number fields

archive/issues_017149.json:
```json
{
    "body": "CC:  @bhutz\n\nAdd functionality to iterate over points of bounded height in projective/affine space over a number field. Also add functionality to list the points of height less than a given bound on a scheme defined over a number field.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17386\n\n",
    "closed_at": "2015-02-18T08:53:23Z",
    "created_at": "2014-11-24T05:26:20Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Enumerate points of bounded height in projective/affine space over number fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17386",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
CC:  @bhutz

Add functionality to iterate over points of bounded height in projective/affine space over a number field. Also add functionality to list the points of height less than a given bound on a scheme defined over a number field.

Issue created by migration from https://trac.sagemath.org/ticket/17386





---

archive/issue_comments_227680.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-11-28T06:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_227681.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-28T07:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227681",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_227682.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-18T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227682",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_227683.json:
```json
{
    "body": "Here is a first pass at reviewing this.\n\nFirst you need to be careful with the difference between relative height and absolute height. The function K.elements_of_bounded_height() is returning with respect to a bound of relative height (as its documentation says). I would think most users would be interested in absolute height rational points for schemes. So you'll need to fix the functionality here, but also fix the documentation to specify which height in all appropriate places.\n\nAlso, specify whether the bound is <= or <\n\n`numberField` is not a good variable name as [CamelCase](CamelCase) is reserved for class names.\n\nIn projective_homset.py put the imports near where they are needed so you only import what you need (this is done correctly in affine_homset.py)\n\nSome examples that I expected to work that didn't\n\n```\nu = QQ['u'].0\nK.<v> = NumberField(u^2 + 3)\nA.<x,y> = ProjectiveSpace(K,1)\nX=A.subscheme(x-y)\nX.rational_points(3)\n```\nsame for affine\n\n```\nfrom sage.schemes.projective.projective_rational_point import enum_projective_number_field\nenum_projective_number_field(X,3)\n```\n\n```\nfrom sage.schemes.affine.affine_rational_point import enum_affine_number_field\nenum_affine_number_field(X,3)\n```\n\nI think the issues with the enum_ functions is whether the input should be the scheme `X` or the point set `X(K)`. Clarify which in the documentation for the functions. However, the X.rational_points ones seem to actually be failing.",
    "created_at": "2014-12-18T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227683",
    "user": "https://github.com/bhutz"
}
```

Here is a first pass at reviewing this.

First you need to be careful with the difference between relative height and absolute height. The function K.elements_of_bounded_height() is returning with respect to a bound of relative height (as its documentation says). I would think most users would be interested in absolute height rational points for schemes. So you'll need to fix the functionality here, but also fix the documentation to specify which height in all appropriate places.

Also, specify whether the bound is <= or <

`numberField` is not a good variable name as [CamelCase](CamelCase) is reserved for class names.

In projective_homset.py put the imports near where they are needed so you only import what you need (this is done correctly in affine_homset.py)

Some examples that I expected to work that didn't

```
u = QQ['u'].0
K.<v> = NumberField(u^2 + 3)
A.<x,y> = ProjectiveSpace(K,1)
X=A.subscheme(x-y)
X.rational_points(3)
```
same for affine

```
from sage.schemes.projective.projective_rational_point import enum_projective_number_field
enum_projective_number_field(X,3)
```

```
from sage.schemes.affine.affine_rational_point import enum_affine_number_field
enum_affine_number_field(X,3)
```

I think the issues with the enum_ functions is whether the input should be the scheme `X` or the point set `X(K)`. Clarify which in the documentation for the functions. However, the X.rational_points ones seem to actually be failing.



---

archive/issue_comments_227684.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-27T19:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_227685.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-27T19:15:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227685",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_227686.json:
```json
{
    "body": "Looks like we are almost there with this one. The functionality all is in working order. But, I came across a few minor things to fix.\n\naffine_rational_point\nexample line 168 is a long test so add -> # long time\nprobably makes more sense to make the bound smaller and get the test < 1s\n\naffine_space -> line 777 not needed, but move the comment to 779\n\naffine_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).\n\nalgebraic_scheme -> line 1502 no longer need is_RationalField(F)\n\nprojective_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).\n\nprojective_space -> line 94 not needed -> move comment to 951\n\n\nThere are a few places where the lines in the docs are too long. You need to wrap those. Such as line 748 in affine_space.py\n\n\nAnother bad example:\n\n```\nu = QQ['u'].0\nK.<v> = NumberField(u^2 + 3)\nA.<x,y> = ProjectiveSpace(K,1)\nX=A.subscheme(x-y)\nX.rational_points(3)\nfrom sage.schemes.affine.affine_rational_point import enum_affine_number_field\nenum_affine_number_field(X,3)\n```\noops...X is projective and we called enum_affine successfully!! Need a check in those functions to make sure the ambient space is Affine or Projective",
    "created_at": "2015-01-29T14:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227686",
    "user": "https://github.com/bhutz"
}
```

Looks like we are almost there with this one. The functionality all is in working order. But, I came across a few minor things to fix.

affine_rational_point
example line 168 is a long test so add -> # long time
probably makes more sense to make the bound smaller and get the test < 1s

affine_space -> line 777 not needed, but move the comment to 779

affine_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).

algebraic_scheme -> line 1502 no longer need is_RationalField(F)

projective_space -> points_of_bounded_height -> add comment that this is using the Krumm-Doyle algorithm for number fields (get the citation from number fields where they implemented it).

projective_space -> line 94 not needed -> move comment to 951


There are a few places where the lines in the docs are too long. You need to wrap those. Such as line 748 in affine_space.py


Another bad example:

```
u = QQ['u'].0
K.<v> = NumberField(u^2 + 3)
A.<x,y> = ProjectiveSpace(K,1)
X=A.subscheme(x-y)
X.rational_points(3)
from sage.schemes.affine.affine_rational_point import enum_affine_number_field
enum_affine_number_field(X,3)
```
oops...X is projective and we called enum_affine successfully!! Need a check in those functions to make sure the ambient space is Affine or Projective



---

archive/issue_comments_227687.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-29T14:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227687",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_227688.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-03T17:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227688",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_227689.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-03T17:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227689",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_227690.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-03T18:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_227691.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-03T19:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227691",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_227692.json:
```json
{
    "body": "Ok. this looks good now.",
    "created_at": "2015-02-03T19:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227692",
    "user": "https://github.com/bhutz"
}
```

Ok. this looks good now.



---

archive/issue_comments_227693.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-18T08:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17386#issuecomment-227693",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_050095.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-18T08:53:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17386#event-50095"
}
```



---

archive/issue_events_050096.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/gjorgenson",
    "created_at": "2015-02-20T17:18:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17386",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17386#event-50096"
}
```
