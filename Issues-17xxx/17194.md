# Issue 17194: Minimal bindings for optional arb package

archive/issues_016957.json:
```json
{
    "body": "In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any bindings for the Sage library.\n\nIn the present ticket, rather minimal bindings are provided.\n\nAs a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.\n\n\n\nDepends on #16747\n\nDepends on #17688\n\n**CC:**  alina @fredrik-johansson ktkohl skropf @jdemeyer @mezzarobba\n\n**Keywords:** arb, digamma function, real interval field\n\n**Branch/Commit:** [195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)\n\n**Reviewer:** Marc Mezzarobba\n\n**Author:** Clemens Heuberger, Marc Mezzarobba\n\nIssue created by migration from https://trac.sagemath.org/ticket/17194\n\n",
    "closed_at": "2015-02-21T12:40:39Z",
    "created_at": "2014-10-22T06:48:01Z",
    "labels": [
        "component: numerical",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.5",
    "title": "Minimal bindings for optional arb package",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/17194",
    "user": "https://github.com/cheuberg"
}
```
In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any bindings for the Sage library.

In the present ticket, rather minimal bindings are provided.

As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.



Depends on #16747

Depends on #17688

**CC:**  alina @fredrik-johansson ktkohl skropf @jdemeyer @mezzarobba

**Keywords:** arb, digamma function, real interval field

**Branch/Commit:** [195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)

**Reviewer:** Marc Mezzarobba

**Author:** Clemens Heuberger, Marc Mezzarobba

Issue created by migration from https://trac.sagemath.org/ticket/17194





---

archive/issue_events_154296.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2014-10-22T06:48:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154296"
}
```



---

archive/issue_comments_230843.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis probably does not matter as long as the bindings are not part of the sage coercion world, but I suppose then you'd want to handle precision in a similar way to `RealField`, `RealIntervalField` etc. where it is an attribute of the parent (maybe with a `RealBallField` type?).",
    "created_at": "2014-10-22T07:41:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230843",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:2'></a>
This probably does not matter as long as the bindings are not part of the sage coercion world, but I suppose then you'd want to handle precision in a similar way to `RealField`, `RealIntervalField` etc. where it is an attribute of the parent (maybe with a `RealBallField` type?).



---

archive/issue_comments_230844.json:
```json
{
    "body": "<a id='comment:3'></a>\nSage should arguably have a `RealBallField` and `ComplexBallField` with concrete implementations `RealBallField_arb` and `ComplexBallField_arb` (it would be useful to provide alternative implementations, for example to provide actual circular complex balls).\n\nAnyway, I took a quick look at the code, and it seems fine to me.",
    "created_at": "2014-10-22T07:52:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230844",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:3'></a>
Sage should arguably have a `RealBallField` and `ComplexBallField` with concrete implementations `RealBallField_arb` and `ComplexBallField_arb` (it would be useful to provide alternative implementations, for example to provide actual circular complex balls).

Anyway, I took a quick look at the code, and it seems fine to me.



---

archive/issue_comments_230845.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe question is how the relation to `RealIntervalField` and `ComplexIntervalField` should be.",
    "created_at": "2014-10-22T08:13:50Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230845",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:4'></a>
The question is how the relation to `RealIntervalField` and `ComplexIntervalField` should be.



---

archive/issue_comments_230846.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb8b58458ef6f4652637aa9c06b4ba723ea261ee\">eb8b584</a></td><td><code>Trac #17194: Fix typo in one doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6cb2ca76850c365becfff6d8f7cb1f43efb1e1c\">a6cb2ca</a></td><td><code>Trac #17194: declare return types</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2\">55bdc8b</a></td><td><code>Trac #17194: mark all doctests in real_arb.pyx as \"optional - arb\"</code></td></tr></table>\n",
    "created_at": "2014-10-25T06:21:32Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230846",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb8b58458ef6f4652637aa9c06b4ba723ea261ee">eb8b584</a></td><td><code>Trac #17194: Fix typo in one doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6cb2ca76850c365becfff6d8f7cb1f43efb1e1c">a6cb2ca</a></td><td><code>Trac #17194: declare return types</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2">55bdc8b</a></td><td><code>Trac #17194: mark all doctests in real_arb.pyx as "optional - arb"</code></td></tr></table>




---

archive/issue_comments_230847.json:
```json
{
    "body": "**Changing commit** from \"[4a343229803c8b3dafec47fb13cb12e49e51bdb6](https://github.com/sagemath/sagetrac-mirror/commit/4a343229803c8b3dafec47fb13cb12e49e51bdb6)\" to \"[55bdc8b67439f5742c8a9fed70dfc795262377c2](https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2)\".",
    "created_at": "2014-10-25T06:21:32Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230847",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4a343229803c8b3dafec47fb13cb12e49e51bdb6](https://github.com/sagemath/sagetrac-mirror/commit/4a343229803c8b3dafec47fb13cb12e49e51bdb6)" to "[55bdc8b67439f5742c8a9fed70dfc795262377c2](https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2)".



---

archive/issue_comments_230848.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52\">14f599f</a></td><td><code>Trac #17194: rename attribute precision to _precision_</code></td></tr></table>\n",
    "created_at": "2014-10-25T08:30:33Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230848",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52">14f599f</a></td><td><code>Trac #17194: rename attribute precision to _precision_</code></td></tr></table>




---

archive/issue_comments_230849.json:
```json
{
    "body": "**Changing commit** from \"[55bdc8b67439f5742c8a9fed70dfc795262377c2](https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2)\" to \"[14f599fe6469378d9474fb52a71caabbcfe7eb52](https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52)\".",
    "created_at": "2014-10-25T08:30:33Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230849",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[55bdc8b67439f5742c8a9fed70dfc795262377c2](https://github.com/sagemath/sagetrac-mirror/commit/55bdc8b67439f5742c8a9fed70dfc795262377c2)" to "[14f599fe6469378d9474fb52a71caabbcfe7eb52](https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52)".



---

archive/issue_comments_230850.json:
```json
{
    "body": "<a id='comment:8'></a>\nAs a follow-up, minimal bindings for the `acb` type (complex balls) are provided in #17218.",
    "created_at": "2014-10-25T08:37:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230850",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:8'></a>
As a follow-up, minimal bindings for the `acb` type (complex balls) are provided in #17218.



---

archive/issue_comments_230851.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe code looks ok to me. A small detail is that precision must be >= 2, not just positive (this is required by `RealField` et al too).",
    "created_at": "2014-10-28T13:35:25Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230851",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:9'></a>
The code looks ok to me. A small detail is that precision must be >= 2, not just positive (this is required by `RealField` et al too).



---

archive/issue_comments_230852.json:
```json
{
    "body": "**Changing commit** from \"[14f599fe6469378d9474fb52a71caabbcfe7eb52](https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52)\" to \"[11df4b42506bfeaa63796e6dff90085353f8a730](https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730)\".",
    "created_at": "2014-10-28T18:38:37Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[14f599fe6469378d9474fb52a71caabbcfe7eb52](https://github.com/sagemath/sagetrac-mirror/commit/14f599fe6469378d9474fb52a71caabbcfe7eb52)" to "[11df4b42506bfeaa63796e6dff90085353f8a730](https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730)".



---

archive/issue_comments_230853.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730\">11df4b4</a></td><td><code>Trac #17194: Clarify that precision >=2 is required</code></td></tr></table>\n",
    "created_at": "2014-10-28T18:38:37Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230853",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730">11df4b4</a></td><td><code>Trac #17194: Clarify that precision >=2 is required</code></td></tr></table>




---

archive/issue_comments_230854.json:
```json
{
    "body": "**Changing commit** from \"[11df4b42506bfeaa63796e6dff90085353f8a730](https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730)\" to \"[141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8](https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8)\".",
    "created_at": "2014-10-28T18:41:33Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230854",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[11df4b42506bfeaa63796e6dff90085353f8a730](https://github.com/sagemath/sagetrac-mirror/commit/11df4b42506bfeaa63796e6dff90085353f8a730)" to "[141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8](https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8)".



---

archive/issue_comments_230855.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8\">141aca0</a></td><td><code>Trac #17194: >2 should have been >= 2 in previous commit</code></td></tr></table>\n",
    "created_at": "2014-10-28T18:41:33Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230855",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8">141aca0</a></td><td><code>Trac #17194: >2 should have been >= 2 in previous commit</code></td></tr></table>




---

archive/issue_events_154297.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-28T19:23:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154297"
}
```



---

archive/issue_events_154298.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-28T19:23:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154298"
}
```



---

archive/issue_comments_230856.json:
```json
{
    "body": "<a id='comment:12'></a>\nPlease don't use `is_package_installed()`. That's extremely slow, you don't want to call it every time.",
    "created_at": "2014-10-28T19:23:19Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230856",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Please don't use `is_package_installed()`. That's extremely slow, you don't want to call it every time.



---

archive/issue_comments_230857.json:
```json
{
    "body": "<a id='comment:13'></a>\nI disagree with\n> In its present minimal form, this is not part of the sage coercion world.\n\n\nYou should have a `Parent` from the start, adding it afterwards is only going to make things more difficult.",
    "created_at": "2014-10-28T19:26:03Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230857",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
I disagree with
> In its present minimal form, this is not part of the sage coercion world.


You should have a `Parent` from the start, adding it afterwards is only going to make things more difficult.



---

archive/issue_comments_230858.json:
```json
{
    "body": "<a id='comment:14'></a>\nAnd `Arb` should probably be renamed to `RealBallElement`.",
    "created_at": "2014-10-28T19:27:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230858",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
And `Arb` should probably be renamed to `RealBallElement`.



---

archive/issue_comments_230859.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [jdemeyer](#comment%3A12):\n> Please don't use `is_package_installed()`. That's extremely slow, you don't want to call it every time.\n\n\nWhat alternative do you recommend? Calling `is_package_installed()` once and storing the result in a module global variable? Or just `try`ing to call the arb code and catching the exception?\n\nConcerning renaming `Arb` to `RealBallElement`: `real_mpfi` aka `RealIntervalFieldElement`  and `arb` have some similarities in their goals; the implementation is different, there might be more functions in the `arb` library, and there are the corresponding functions for complex balls. Do we want to stress the difference between `RealBallElement` and `RealIntervalFieldElement`? Or would `RealBallElement` be some kind of special case of `RealIntervalFieldElement`.\n\nI'll try to implement a parent, but it will take some time. The parent would then be `RealBallField`; what about `RealBallFieldElement` for the current `Arb`?",
    "created_at": "2014-10-30T15:19:52Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230859",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:15'></a>
Replying to [jdemeyer](#comment%3A12):
> Please don't use `is_package_installed()`. That's extremely slow, you don't want to call it every time.


What alternative do you recommend? Calling `is_package_installed()` once and storing the result in a module global variable? Or just `try`ing to call the arb code and catching the exception?

Concerning renaming `Arb` to `RealBallElement`: `real_mpfi` aka `RealIntervalFieldElement`  and `arb` have some similarities in their goals; the implementation is different, there might be more functions in the `arb` library, and there are the corresponding functions for complex balls. Do we want to stress the difference between `RealBallElement` and `RealIntervalFieldElement`? Or would `RealBallElement` be some kind of special case of `RealIntervalFieldElement`.

I'll try to implement a parent, but it will take some time. The parent would then be `RealBallField`; what about `RealBallFieldElement` for the current `Arb`?



---

archive/issue_comments_230860.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [cheuberg](#comment%3A15):\n> What alternative do you recommend?\n\nTry the import and catch `ImportError`. Would that work?",
    "created_at": "2014-10-30T16:21:21Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230860",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
Replying to [cheuberg](#comment%3A15):
> What alternative do you recommend?

Try the import and catch `ImportError`. Would that work?



---

archive/issue_comments_230861.json:
```json
{
    "body": "<a id='comment:17'></a>\nYou could possibly make it so that one can choose between two different implementations of `RealIntervalField` and `ComplexIntervalField`, just like one can choose between:\n\n`PolynomialRing(ZZ, implementation='NTL')`\n\n`PolynomialRing(ZZ, implementation='FLINT')`\n\nSo you might look up how those are implemented. I don't have an opinion on whether this is better than what you're doing right now.",
    "created_at": "2014-10-30T16:21:47Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230861",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:17'></a>
You could possibly make it so that one can choose between two different implementations of `RealIntervalField` and `ComplexIntervalField`, just like one can choose between:

`PolynomialRing(ZZ, implementation='NTL')`

`PolynomialRing(ZZ, implementation='FLINT')`

So you might look up how those are implemented. I don't have an opinion on whether this is better than what you're doing right now.



---

archive/issue_comments_230862.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [cheuberg](#comment%3A15):\n> Do we want to stress the difference between `RealBallElement` and `RealIntervalFieldElement`?\n\nYes, I would do that. The implementations are also quite different.\n\n> I'll try to implement a parent, but it will take some time. The parent would then be `RealBallField`; what about `RealBallFieldElement` for the current `Arb`?\n\nI slightly prefer the shorter name `RealBallElement` (like `RealDoubleElement`), but I can live with `RealBallFieldElement`.",
    "created_at": "2014-10-30T16:26:35Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230862",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [cheuberg](#comment%3A15):
> Do we want to stress the difference between `RealBallElement` and `RealIntervalFieldElement`?

Yes, I would do that. The implementations are also quite different.

> I'll try to implement a parent, but it will take some time. The parent would then be `RealBallField`; what about `RealBallFieldElement` for the current `Arb`?

I slightly prefer the shorter name `RealBallElement` (like `RealDoubleElement`), but I can live with `RealBallFieldElement`.



---

archive/issue_comments_230863.json:
```json
{
    "body": "**Changing commit** from \"[141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8](https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8)\" to \"[a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2](https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2)\".",
    "created_at": "2014-10-31T19:17:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230863",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8](https://github.com/sagemath/sagetrac-mirror/commit/141aca0b89aa89b5e4a810b219d1f6fb8c94f4f8)" to "[a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2](https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2)".



---

archive/issue_comments_230864.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc2334112dc920f85cca825566121804b5f66684\">dc23341</a></td><td><code>Trac #17194: Renamed 'Arb' to 'RealBallElement'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2\">a0afebd</a></td><td><code>Trac #17194: Replace is_package_installed by try ... except ImportError</code></td></tr></table>\n",
    "created_at": "2014-10-31T19:17:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230864",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc2334112dc920f85cca825566121804b5f66684">dc23341</a></td><td><code>Trac #17194: Renamed 'Arb' to 'RealBallElement'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2">a0afebd</a></td><td><code>Trac #17194: Replace is_package_installed by try ... except ImportError</code></td></tr></table>




---

archive/issue_comments_230865.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A16):\n> Try the import and catch `ImportError`. Would that work?\n\nYes, it works, thanks.",
    "created_at": "2014-10-31T19:18:56Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230865",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A16):
> Try the import and catch `ImportError`. Would that work?

Yes, it works, thanks.



---

archive/issue_comments_230866.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [jdemeyer](#comment%3A18):\n> I slightly prefer the shorter name `RealBallElement` (like `RealDoubleElement`), but I can live with `RealBallFieldElement`.\n\n\nAs we apparently do not have a systematic naming scheme here, I renamed it to the shorter `RealBallElement`, as suggested.",
    "created_at": "2014-10-31T19:20:57Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230866",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:21'></a>
Replying to [jdemeyer](#comment%3A18):
> I slightly prefer the shorter name `RealBallElement` (like `RealDoubleElement`), but I can live with `RealBallFieldElement`.


As we apparently do not have a systematic naming scheme here, I renamed it to the shorter `RealBallElement`, as suggested.



---

archive/issue_comments_230867.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n In the present ticket, rather minimal bindings are provided.\n \n-As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `Arb`, computing the digamma function via the arb library, and converting the result back.\n+As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.\n \n In its present minimal form, this is not part of the sage coercion world.\n``````\n",
    "created_at": "2014-10-31T19:20:57Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230867",
    "user": "https://github.com/cheuberg"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 In the present ticket, rather minimal bindings are provided.
 
-As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `Arb`, computing the digamma function via the arb library, and converting the result back.
+As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.
 
 In its present minimal form, this is not part of the sage coercion world.
``````




---

archive/issue_events_154299.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-06T12:52:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "rename": {
        "from": "Minimal bindings for optional arb package; RealIntervalFieldElement.psi",
        "to": "Minimal bindings for optional arb package"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154299"
}
```



---

archive/issue_comments_230868.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,5 @@\n-In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any python bindings for the library.\n+In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any bindings for the Sage library.\n \n In the present ticket, rather minimal bindings are provided.\n \n As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.\n-\n-In its present minimal form, this is not part of the sage coercion world.\n``````\n",
    "created_at": "2014-11-06T12:52:23Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230868",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,5 @@
-In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any python bindings for the library.
+In #16747, the optional arb package is proposed for inclusion in sage. That ticket did not have any bindings for the Sage library.
 
 In the present ticket, rather minimal bindings are provided.
 
 As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.
-
-In its present minimal form, this is not part of the sage coercion world.
``````




---

archive/issue_comments_230869.json:
```json
{
    "body": "**Changing commit** from \"[a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2](https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2)\" to \"[a194938dca3bed5878bfa85ab94d0e52425298d4](https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4)\".",
    "created_at": "2014-11-21T15:15:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2](https://github.com/sagemath/sagetrac-mirror/commit/a0afebd76117cdaeae6d8a408a2b1071ec3b8cd2)" to "[a194938dca3bed5878bfa85ab94d0e52425298d4](https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4)".



---

archive/issue_comments_230870.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ffa347a21ad062809431a4eda51147720ff5e44\">0ffa347</a></td><td><code>Trac #17194: Implemented RealBallField</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd8933ae0f991ebda77cac4f2a55ac0819a7737d\">dd8933a</a></td><td><code>Trac #17194: Implement RealBallElement._repr_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4\">a194938</a></td><td><code>Trac #17194: Mark all doctests as optional - arb</code></td></tr></table>\n",
    "created_at": "2014-11-21T15:15:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ffa347a21ad062809431a4eda51147720ff5e44">0ffa347</a></td><td><code>Trac #17194: Implemented RealBallField</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd8933ae0f991ebda77cac4f2a55ac0819a7737d">dd8933a</a></td><td><code>Trac #17194: Implement RealBallElement._repr_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4">a194938</a></td><td><code>Trac #17194: Mark all doctests as optional - arb</code></td></tr></table>




---

archive/issue_events_154300.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2014-11-21T15:18:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154300"
}
```



---

archive/issue_events_154301.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2014-11-21T15:18:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154301"
}
```



---

archive/issue_comments_230871.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jdemeyer](#comment%3A13):\n> I disagree with\n> > In its present minimal form, this is not part of the sage coercion world.\n\n> \n> You should have a `Parent` from the start, adding it afterwards is only going to make things more difficult.\n\n\nI have implemented a parent `RealBallField`.",
    "created_at": "2014-11-21T15:18:56Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230871",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:24'></a>
Replying to [jdemeyer](#comment%3A13):
> I disagree with
> > In its present minimal form, this is not part of the sage coercion world.

> 
> You should have a `Parent` from the start, adding it afterwards is only going to make things more difficult.


I have implemented a parent `RealBallField`.



---

archive/issue_comments_230872.json:
```json
{
    "body": "<a id='comment:25'></a>\ntrac's automerge fails for unknown reasons; I have successfully tried to merge this branch with `6.5.beta0`.",
    "created_at": "2014-11-21T15:21:10Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230872",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:25'></a>
trac's automerge fails for unknown reasons; I have successfully tried to merge this branch with `6.5.beta0`.



---

archive/issue_comments_230873.json:
```json
{
    "body": "<a id='comment:26'></a>\nThe radius could just be printed with 3-5 digits (it is never a high precision number).",
    "created_at": "2014-11-22T18:10:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230873",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:26'></a>
The radius could just be printed with 3-5 digits (it is never a high precision number).



---

archive/issue_comments_230874.json:
```json
{
    "body": "<a id='comment:27'></a>\nIn fact, the case could be made for printing in the same format as `RealIntervalField`.",
    "created_at": "2014-11-22T18:12:37Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230874",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:27'></a>
In fact, the case could be made for printing in the same format as `RealIntervalField`.



---

archive/issue_comments_230875.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [fredrik.johansson](#comment%3A27):\n> In fact, the case could be made for printing in the same format as `RealIntervalField`.\n\n[jdemeyer](#comment%3A18) was in favor of making a clear distinction between `RealIntervalField` and `RealBallField`. Therefore, I chose to implement the `_repr_` method of a `RealBallElement` to look different from that of a `RealIntervalFieldElement` and close to the `arb_printd` method.\n\nOf course, doing it the `RealIntervalFieldElement` way would be easy, because conversion to a `RealIntervalFieldElement` is already implemented, so we could simply delegate the task.\n\nJeroen, do you have a comment on this?",
    "created_at": "2014-11-23T06:41:56Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230875",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:28'></a>
Replying to [fredrik.johansson](#comment%3A27):
> In fact, the case could be made for printing in the same format as `RealIntervalField`.

[jdemeyer](#comment%3A18) was in favor of making a clear distinction between `RealIntervalField` and `RealBallField`. Therefore, I chose to implement the `_repr_` method of a `RealBallElement` to look different from that of a `RealIntervalFieldElement` and close to the `arb_printd` method.

Of course, doing it the `RealIntervalFieldElement` way would be easy, because conversion to a `RealIntervalFieldElement` is already implemented, so we could simply delegate the task.

Jeroen, do you have a comment on this?



---

archive/issue_comments_230876.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbcac86ddb83cf3556a8ac0af8d95bb71c49dadd\">fbcac86</a></td><td><code>Merge remote-tracking branch 'trac/develop' into rings/real_arb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1683f05e63a9e3f02f5976dcf6e7197ed79b4f6\">e1683f0</a></td><td><code>Trac #17194: Changes required after merge of #17267</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ef90e055066f502ec388dac92de69c149606cec\">6ef90e0</a></td><td><code>Trac #17194: `_coerce_map_from_` as cpdef instead of def</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac\">1ce0e90</a></td><td><code>Trac #17194: use weak_cached_function for RealBallField</code></td></tr></table>\n",
    "created_at": "2014-11-24T15:04:19Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbcac86ddb83cf3556a8ac0af8d95bb71c49dadd">fbcac86</a></td><td><code>Merge remote-tracking branch 'trac/develop' into rings/real_arb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1683f05e63a9e3f02f5976dcf6e7197ed79b4f6">e1683f0</a></td><td><code>Trac #17194: Changes required after merge of #17267</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ef90e055066f502ec388dac92de69c149606cec">6ef90e0</a></td><td><code>Trac #17194: `_coerce_map_from_` as cpdef instead of def</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac">1ce0e90</a></td><td><code>Trac #17194: use weak_cached_function for RealBallField</code></td></tr></table>




---

archive/issue_comments_230877.json:
```json
{
    "body": "**Changing commit** from \"[a194938dca3bed5878bfa85ab94d0e52425298d4](https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4)\" to \"[1ce0e90678ad06f6004be7fc8eb47f58ed9184ac](https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac)\".",
    "created_at": "2014-11-24T15:04:19Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a194938dca3bed5878bfa85ab94d0e52425298d4](https://github.com/sagemath/sagetrac-mirror/commit/a194938dca3bed5878bfa85ab94d0e52425298d4)" to "[1ce0e90678ad06f6004be7fc8eb47f58ed9184ac](https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac)".



---

archive/issue_comments_230878.json:
```json
{
    "body": "<a id='comment:30'></a>\nThe changes in #17267 were incompatible with this ticket. Thus, I merged 6.5.beta1 (containing #17267) and adapted the code.\n\nI used this occasion to change to minor other issues.",
    "created_at": "2014-11-24T15:07:52Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230878",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:30'></a>
The changes in #17267 were incompatible with this ticket. Thus, I merged 6.5.beta1 (containing #17267) and adapted the code.

I used this occasion to change to minor other issues.



---

archive/issue_comments_230879.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35\">f4393a9</a></td><td><code>Trac #17194: remove one obsolete import</code></td></tr></table>\n",
    "created_at": "2014-11-24T15:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230879",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35">f4393a9</a></td><td><code>Trac #17194: remove one obsolete import</code></td></tr></table>




---

archive/issue_comments_230880.json:
```json
{
    "body": "**Changing commit** from \"[1ce0e90678ad06f6004be7fc8eb47f58ed9184ac](https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac)\" to \"[f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35](https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35)\".",
    "created_at": "2014-11-24T15:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230880",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1ce0e90678ad06f6004be7fc8eb47f58ed9184ac](https://github.com/sagemath/sagetrac-mirror/commit/1ce0e90678ad06f6004be7fc8eb47f58ed9184ac)" to "[f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35](https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35)".



---

archive/issue_comments_230881.json:
```json
{
    "body": "<a id='comment:32'></a>\nA few random remarks (I would be interested in working more on this, but unfortunately I don't expect to have time to do it before a few weeks):\n* Why call the element class `RealBallElement` and not just `RealBall`? to me the former sounds more like a point *in* a real ball, not the ball itself...\n* Does the parent class really need to be a Cython class?\n* I'd rename the `RealIntervalFieldElement` method to something like `interval`, or perhaps `_interval` since in the long run it should be accessible through coercion/conversion to `RealIntervalField` (which is currently broken in several ways, but that's another story).\n* I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?",
    "created_at": "2014-12-16T14:51:32Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230881",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:32'></a>
A few random remarks (I would be interested in working more on this, but unfortunately I don't expect to have time to do it before a few weeks):
* Why call the element class `RealBallElement` and not just `RealBall`? to me the former sounds more like a point *in* a real ball, not the ball itself...
* Does the parent class really need to be a Cython class?
* I'd rename the `RealIntervalFieldElement` method to something like `interval`, or perhaps `_interval` since in the long run it should be accessible through coercion/conversion to `RealIntervalField` (which is currently broken in several ways, but that's another story).
* I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?



---

archive/issue_comments_230882.json:
```json
{
    "body": "**Changing commit** from \"[f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35](https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35)\" to \"[80850af551dcc6634c322e0f023515ecbe14d2d8](https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8)\".",
    "created_at": "2014-12-16T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35](https://github.com/sagemath/sagetrac-mirror/commit/f4393a997a6bdee1d5765fb5f7e8c0a9dff61e35)" to "[80850af551dcc6634c322e0f023515ecbe14d2d8](https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8)".



---

archive/issue_comments_230883.json:
```json
{
    "body": "<a id='comment:33'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9705e091a0292e5132871a42790344d3b6bdf097\">9705e09</a></td><td><code>Trac #17194: Rename RealBallElement to RealBall</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8\">80850af</a></td><td><code>Trac #17194: Rename RealBall.RealIntervalFieldElement -> RealBall._interval</code></td></tr></table>\n",
    "created_at": "2014-12-16T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230883",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9705e091a0292e5132871a42790344d3b6bdf097">9705e09</a></td><td><code>Trac #17194: Rename RealBallElement to RealBall</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8">80850af</a></td><td><code>Trac #17194: Rename RealBall.RealIntervalFieldElement -> RealBall._interval</code></td></tr></table>




---

archive/issue_comments_230884.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddf7e9f5fab068c00aa9512f7875add941b19ecb\">ddf7e9f</a></td><td><code>Trac #17194: Fix one Docstring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b\">a45f691</a></td><td><code>Trac #17194: Rename parameter \"value\" of RealBall.__init__ to \"x\"</code></td></tr></table>\n",
    "created_at": "2014-12-16T18:37:12Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230884",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddf7e9f5fab068c00aa9512f7875add941b19ecb">ddf7e9f</a></td><td><code>Trac #17194: Fix one Docstring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b">a45f691</a></td><td><code>Trac #17194: Rename parameter "value" of RealBall.__init__ to "x"</code></td></tr></table>




---

archive/issue_comments_230885.json:
```json
{
    "body": "**Changing commit** from \"[80850af551dcc6634c322e0f023515ecbe14d2d8](https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8)\" to \"[a45f691daf51970311b43190496104a774d6518b](https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b)\".",
    "created_at": "2014-12-16T18:37:12Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[80850af551dcc6634c322e0f023515ecbe14d2d8](https://github.com/sagemath/sagetrac-mirror/commit/80850af551dcc6634c322e0f023515ecbe14d2d8)" to "[a45f691daf51970311b43190496104a774d6518b](https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b)".



---

archive/issue_comments_230886.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n In the present ticket, rather minimal bindings are provided.\n \n-As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.\n+As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.\n``````\n",
    "created_at": "2014-12-16T18:47:12Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230886",
    "user": "https://github.com/cheuberg"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 In the present ticket, rather minimal bindings are provided.
 
-As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBallElement`, computing the digamma function via the arb library, and converting the result back.
+As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.
``````




---

archive/issue_comments_230887.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [mmezzarobba](#comment%3A32):\n> * Why call the element class `RealBallElement` and not just `RealBall`? to me the former sounds more like a point *in* a real ball, not the ball itself...\n\n\nrenamed.\n\n> * Does the parent class really need to be a Cython class?\n\n\nWhat are the disadvantages if it is a Cython class?\n\nWhile working on #17222, I found that I spent most of the time in many, many calls of `ComplexIntervalField.__call__`. Therefore, I wanted `RealBallField` to be a Cython class in order to save any bit of performance possible.\n\n> * I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?\n\n\nI do not understand your last comment on the precisions of the arguments. \n\nApart from that, do you have an opinion on how the output of the balls should look like? See comments [27](#comment%3A27) and [28](#comment%3A28).",
    "created_at": "2014-12-16T18:47:12Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230887",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:35'></a>
Replying to [mmezzarobba](#comment%3A32):
> * Why call the element class `RealBallElement` and not just `RealBall`? to me the former sounds more like a point *in* a real ball, not the ball itself...


renamed.

> * Does the parent class really need to be a Cython class?


What are the disadvantages if it is a Cython class?

While working on #17222, I found that I spent most of the time in many, many calls of `ComplexIntervalField.__call__`. Therefore, I wanted `RealBallField` to be a Cython class in order to save any bit of performance possible.

> * I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?


I do not understand your last comment on the precisions of the arguments. 

Apart from that, do you have an opinion on how the output of the balls should look like? See comments [27](#comment%3A27) and [28](#comment%3A28).



---

archive/issue_comments_230888.json:
```json
{
    "body": "**Changing dependencies** from \"#16747\" to \"#16747, #17688\".",
    "created_at": "2015-01-29T18:09:00Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230888",
    "user": "https://github.com/cheuberg"
}
```

**Changing dependencies** from "#16747" to "#16747, #17688".



---

archive/issue_events_154302.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-29T18:09:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154302"
}
```



---

archive/issue_events_154303.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-29T18:09:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154303"
}
```



---

archive/issue_comments_230889.json:
```json
{
    "body": "<a id='comment:36'></a>\nAs Arb 2.5 has a function `arb_get_str`, this should be used for the output. So, we should upgrade to 2.5 (#17688).",
    "created_at": "2015-01-29T18:09:00Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230889",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:36'></a>
As Arb 2.5 has a function `arb_get_str`, this should be used for the output. So, we should upgrade to 2.5 (#17688).



---

archive/issue_comments_230890.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0eb70b05d22108e2e64cb8423eb5f779fd300bb6\">0eb70b0</a></td><td><code>Trac #17688: Upgrade arb spkg to 2.5.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50eeecb7a17e661587423f96d1895738ad54f7f6\">50eeecb</a></td><td><code>Merge branch 'u/cheuberg/packages/arb-2.5' (#17688) of git://trac.sagemath.org/sage into rings/real_arb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c41d27b532c7b2e3f19c43d5254d2e95ea0e932\">6c41d27</a></td><td><code>Trac #17194: Remove coercion from RealIntervalField</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672\">8802939</a></td><td><code>Trac #17194: Use arb's arg_get_str for RealBall._repr_</code></td></tr></table>\n",
    "created_at": "2015-02-08T09:13:54Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0eb70b05d22108e2e64cb8423eb5f779fd300bb6">0eb70b0</a></td><td><code>Trac #17688: Upgrade arb spkg to 2.5.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50eeecb7a17e661587423f96d1895738ad54f7f6">50eeecb</a></td><td><code>Merge branch 'u/cheuberg/packages/arb-2.5' (#17688) of git://trac.sagemath.org/sage into rings/real_arb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c41d27b532c7b2e3f19c43d5254d2e95ea0e932">6c41d27</a></td><td><code>Trac #17194: Remove coercion from RealIntervalField</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672">8802939</a></td><td><code>Trac #17194: Use arb's arg_get_str for RealBall._repr_</code></td></tr></table>




---

archive/issue_comments_230891.json:
```json
{
    "body": "**Changing commit** from \"[a45f691daf51970311b43190496104a774d6518b](https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b)\" to \"[8802939c14030e34ad81d7a6acea00c5a8e71672](https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672)\".",
    "created_at": "2015-02-08T09:13:54Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a45f691daf51970311b43190496104a774d6518b](https://github.com/sagemath/sagetrac-mirror/commit/a45f691daf51970311b43190496104a774d6518b)" to "[8802939c14030e34ad81d7a6acea00c5a8e71672](https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672)".



---

archive/issue_events_154304.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-08T09:19:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154304"
}
```



---

archive/issue_events_154305.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-08T09:19:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154305"
}
```



---

archive/issue_events_154306.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-08T09:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154306"
}
```



---

archive/issue_events_154307.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-08T09:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154307"
}
```



---

archive/issue_comments_230892.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [mmezzarobba](#comment%3A32):\n> * I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?\n\n\nThis coercion is now removed. So we do not coerce from anywhere at the moment. Coercions may be added later as needed.\n\nFurthermore, we use arb's `arb_get_str` method for `_repr_` now.",
    "created_at": "2015-02-08T09:19:39Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230892",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:38'></a>
Replying to [mmezzarobba](#comment%3A32):
> * I'm not sure if setting up coercion maps from real interval fields is a good idea. It's probably sound from the mathematical point of view, but I seem to remember that bidirectional coercions are at least discouraged, and when computing, say, the sum of an interval and a ball, I'd tend to expect the result to be an interval. Or perhaps this should depend on the precisions of the arguments...?


This coercion is now removed. So we do not coerce from anywhere at the moment. Coercions may be added later as needed.

Furthermore, we use arb's `arb_get_str` method for `_repr_` now.



---

archive/issue_comments_230893.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [cheuberg](#comment%3A35):\n> > * Does the parent class really need to be a Cython class?\n \n> \n> What are the disadvantages if it is a Cython class?\n\n\nI don't know exactly `:-)`. I think Nicolas Thi\u00e9ry used to say that sticking to Python for parents when possible was better, perhaps because of the tricks the category framework plays. But if there is a performance reason for using Cython, I'm all for it!\n\nI will try to have a closer look at this ticket in the next few days if I have time... but no guarantees at all!",
    "created_at": "2015-02-08T10:14:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230893",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:39'></a>
Replying to [cheuberg](#comment%3A35):
> > * Does the parent class really need to be a Cython class?
 
> 
> What are the disadvantages if it is a Cython class?


I don't know exactly `:-)`. I think Nicolas Thiéry used to say that sticking to Python for parents when possible was better, perhaps because of the tricks the category framework plays. But if there is a performance reason for using Cython, I'm all for it!

I will try to have a closer look at this ticket in the next few days if I have time... but no guarantees at all!



---

archive/issue_comments_230894.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [mmezzarobba](#comment%3A39):\n> > > * Does the parent class really need to be a Cython class?\n \n> > \n> > What are the disadvantages if it is a Cython class?\n\n> \n>[...] But if there is a performance reason for using Cython, I'm all for it!\n\n\nIn view of the answers to my recent questions on sage-devel (`<mbdlc7$bjo$2@ger.gmane.org>` and its thread), I guess we should indeed try moving to a Python class (still compiled by Cython) and see if, for example, just making the element constructor a Cython function suffices to solve your problem. (I can probably do that if you want.)\n\nI have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint \"precision\". Is that correct?\n\nFinally, it is clear that I am not confortable enough with the issues involved to provide a good review by myself. I'd be happy to continue reviewing the ticket nonetheless, but it would be nice if someone more experienced could \"review my review\". (Jeroen, would you be willing to do that?)",
    "created_at": "2015-02-11T17:14:09Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230894",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:40'></a>
Replying to [mmezzarobba](#comment%3A39):
> > > * Does the parent class really need to be a Cython class?
 
> > 
> > What are the disadvantages if it is a Cython class?

> 
>[...] But if there is a performance reason for using Cython, I'm all for it!


In view of the answers to my recent questions on sage-devel (`<mbdlc7$bjo$2@ger.gmane.org>` and its thread), I guess we should indeed try moving to a Python class (still compiled by Cython) and see if, for example, just making the element constructor a Cython function suffices to solve your problem. (I can probably do that if you want.)

I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint "precision". Is that correct?

Finally, it is clear that I am not confortable enough with the issues involved to provide a good review by myself. I'd be happy to continue reviewing the ticket nonetheless, but it would be nice if someone more experienced could "review my review". (Jeroen, would you be willing to do that?)



---

archive/issue_comments_230895.json:
```json
{
    "body": "<a id='comment:41'></a>\nIncidentally, with the current (non-`cpdef`, going through `RIF`, etc., so this probably doesn't mean much) `_element_constructor_`, a call to `RBF(42)` even from Cython takes slightly *less* time with a Python version of the parent class...",
    "created_at": "2015-02-11T19:57:14Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230895",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:41'></a>
Incidentally, with the current (non-`cpdef`, going through `RIF`, etc., so this probably doesn't mean much) `_element_constructor_`, a call to `RBF(42)` even from Cython takes slightly *less* time with a Python version of the parent class...



---

archive/issue_comments_230896.json:
```json
{
    "body": "<a id='comment:42'></a>\nI made a few changes and pushed them to `u/mmezzarobba/arb`. Please tell me what you think. Jeroen, if you are reading this, your comments are also more than welcome.",
    "created_at": "2015-02-11T21:01:13Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230896",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:42'></a>
I made a few changes and pushed them to `u/mmezzarobba/arb`. Please tell me what you think. Jeroen, if you are reading this, your comments are also more than welcome.



---

archive/issue_comments_230897.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/676f8a2d6b0c232e70c577fafdd31dc9d11247cf\">676f8a2</a></td><td><code>Make RealBallField a plain Python class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a61566fec212f15f0e99e439a43e4c52a131a8e5\">a61566f</a></td><td><code>Minor doc improvements</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fa8fd196b7b87adc187ba35a90136f07b1de5e3\">7fa8fd1</a></td><td><code>Modernize [PC]ython style</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7eaa0e97e000d0fced5dc64fabe3ce22f395b87\">b7eaa0e</a></td><td><code>sig_on/sig_off</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0aaf188e85a701f4a0d779b74bcc893c1e752c9f\">0aaf188</a></td><td><code>Clarify that the precision is a default precision</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5be8dfa12111a56e11107cd9fd166c5956345398\">5be8dfa</a></td><td><code>clarify(?) error message</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e1ed11a9441057ec71f80f604c7ee6cbc9b0b45\">3e1ed11</a></td><td><code>Trac #17194: Mark one doctest as #optional - arb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f\">ec8d706</a></td><td><code>Trac #17194: Language correction</code></td></tr></table>\n",
    "created_at": "2015-02-12T07:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/676f8a2d6b0c232e70c577fafdd31dc9d11247cf">676f8a2</a></td><td><code>Make RealBallField a plain Python class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a61566fec212f15f0e99e439a43e4c52a131a8e5">a61566f</a></td><td><code>Minor doc improvements</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fa8fd196b7b87adc187ba35a90136f07b1de5e3">7fa8fd1</a></td><td><code>Modernize [PC]ython style</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7eaa0e97e000d0fced5dc64fabe3ce22f395b87">b7eaa0e</a></td><td><code>sig_on/sig_off</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0aaf188e85a701f4a0d779b74bcc893c1e752c9f">0aaf188</a></td><td><code>Clarify that the precision is a default precision</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5be8dfa12111a56e11107cd9fd166c5956345398">5be8dfa</a></td><td><code>clarify(?) error message</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e1ed11a9441057ec71f80f604c7ee6cbc9b0b45">3e1ed11</a></td><td><code>Trac #17194: Mark one doctest as #optional - arb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f">ec8d706</a></td><td><code>Trac #17194: Language correction</code></td></tr></table>




---

archive/issue_comments_230898.json:
```json
{
    "body": "**Changing commit** from \"[8802939c14030e34ad81d7a6acea00c5a8e71672](https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672)\" to \"[ec8d7062c18fde4ffa52191e866cb465a76b751f](https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f)\".",
    "created_at": "2015-02-12T07:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8802939c14030e34ad81d7a6acea00c5a8e71672](https://github.com/sagemath/sagetrac-mirror/commit/8802939c14030e34ad81d7a6acea00c5a8e71672)" to "[ec8d7062c18fde4ffa52191e866cb465a76b751f](https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f)".



---

archive/issue_comments_230899.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [mmezzarobba](#comment%3A42):\n> I made a few changes and pushed them to `u/mmezzarobba/arb`. Please tell me what you think.\n\n\nI added up two one-line patches and pushed it on the ticket.\n\nFrom the discussion on sage-devel, I also remember the recommendation to have the parent in a different `.py` file. If I understand the reasoning correctly, this seems to be preferred in order to avoid circular C imports.\n\nNow, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.",
    "created_at": "2015-02-12T07:46:20Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230899",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:44'></a>
Replying to [mmezzarobba](#comment%3A42):
> I made a few changes and pushed them to `u/mmezzarobba/arb`. Please tell me what you think.


I added up two one-line patches and pushed it on the ticket.

From the discussion on sage-devel, I also remember the recommendation to have the parent in a different `.py` file. If I understand the reasoning correctly, this seems to be preferred in order to avoid circular C imports.

Now, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.



---

archive/issue_comments_230900.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [mmezzarobba](#comment%3A40):\n> Replying to [mmezzarobba](#comment%3A39):\n> > > > * Does the parent class really need to be a Cython class?\n \n> > > \n> > > What are the disadvantages if it is a Cython class?\n\n> > \n> >[...] But if there is a performance reason for using Cython, I'm all for it!\n\n> \n> In view of the answers to my recent questions on sage-devel (`<mbdlc7$bjo$2@ger.gmane.org>` and its thread), I guess we should indeed try moving to a Python class (still compiled by Cython) and see if, for example, just making the element constructor a Cython function suffices to solve your problem. (I can probably do that if you want.)\n\n\nThanks for doing it.\n\nI now believe that my performance problems in #17222 with `ComplexIntervalField` might be caused by the fact that in `ComplexIntervalField`, the `call` function is overridden in Python.\n\n> \n> I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint \"precision\". Is that correct?\n\n\nYes.",
    "created_at": "2015-02-12T07:51:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230900",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:45'></a>
Replying to [mmezzarobba](#comment%3A40):
> Replying to [mmezzarobba](#comment%3A39):
> > > > * Does the parent class really need to be a Cython class?
 
> > > 
> > > What are the disadvantages if it is a Cython class?

> > 
> >[...] But if there is a performance reason for using Cython, I'm all for it!

> 
> In view of the answers to my recent questions on sage-devel (`<mbdlc7$bjo$2@ger.gmane.org>` and its thread), I guess we should indeed try moving to a Python class (still compiled by Cython) and see if, for example, just making the element constructor a Cython function suffices to solve your problem. (I can probably do that if you want.)


Thanks for doing it.

I now believe that my performance problems in #17222 with `ComplexIntervalField` might be caused by the fact that in `ComplexIntervalField`, the `call` function is overridden in Python.

> 
> I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint "precision". Is that correct?


Yes.



---

archive/issue_comments_230901.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [cheuberg](#comment%3A44):\n> From the discussion on sage-devel, I also remember the recommendation to have the parent in a different `.py` file. If I understand the reasoning correctly, this seems to be preferred in order to avoid circular C imports.\n\n\nAnd/or to keep the parent interpreted (which has some benefits in terms of debugging, build time...), I guess? But I think we really want a compiled parent in the present case, even if it remains a Python class, so it doesn't matter, does it?\n\n> Now, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.\n\n\nYes, that was my concern as well. But let's see, and if that's the case, we can always turn the parent back to a Cython class (or possibly keep a copy of the precision in the elements?). I will introduce a function to access the precision of an element so that we can go back to a Cython parent without changing every reference to the precision.",
    "created_at": "2015-02-12T08:41:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230901",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:46'></a>
Replying to [cheuberg](#comment%3A44):
> From the discussion on sage-devel, I also remember the recommendation to have the parent in a different `.py` file. If I understand the reasoning correctly, this seems to be preferred in order to avoid circular C imports.


And/or to keep the parent interpreted (which has some benefits in terms of debugging, build time...), I guess? But I think we really want a compiled parent in the present case, even if it remains a Python class, so it doesn't matter, does it?

> Now, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.


Yes, that was my concern as well. But let's see, and if that's the case, we can always turn the parent back to a Cython class (or possibly keep a copy of the precision in the elements?). I will introduce a function to access the precision of an element so that we can go back to a Cython parent without changing every reference to the precision.



---

archive/issue_comments_230902.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [mmezzarobba](#comment%3A46):\n> \n> > Now, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.\n\n> \n> Yes, that was my concern as well. But let's see, and if that's the case, we can always turn the parent back to a Cython class (or possibly keep a copy of the precision in the elements?).\n\n\nok.\n\n> I will introduce a function to access the precision of an element so that we can go back to a Cython parent without changing every reference to the precision.\n\n\nThank you.",
    "created_at": "2015-02-12T11:03:40Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230902",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:47'></a>
Replying to [mmezzarobba](#comment%3A46):
> 
> > Now, the behaviour is that the precision is stored in the Python parent. If we end up needing the precision frequently in arithmetic operations, that might turn out to be a bottleneck.

> 
> Yes, that was my concern as well. But let's see, and if that's the case, we can always turn the parent back to a Cython class (or possibly keep a copy of the precision in the elements?).


ok.

> I will introduce a function to access the precision of an element so that we can go back to a Cython parent without changing every reference to the precision.


Thank you.



---

archive/issue_comments_230903.json:
```json
{
    "body": "<a id='comment:48'></a>\nAnother question: is there a reason to declare `precision` as unsigned in your code? The precision parameter of arb (and mpfr) functions is signed.",
    "created_at": "2015-02-12T13:19:00Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230903",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:48'></a>
Another question: is there a reason to declare `precision` as unsigned in your code? The precision parameter of arb (and mpfr) functions is signed.



---

archive/issue_comments_230904.json:
```json
{
    "body": "<a id='comment:49'></a>\nNot really. I cannot imagine what a negative precision should be, but if it is signed in arb and mpfr, then let's be signed too.",
    "created_at": "2015-02-12T14:53:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230904",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:49'></a>
Not really. I cannot imagine what a negative precision should be, but if it is signed in arb and mpfr, then let's be signed too.



---

archive/issue_comments_230905.json:
```json
{
    "body": "<a id='comment:50'></a>\nSigned integers are used because of the problems mixing signed and unsigned types in C, and precisions above LONG_MAX would not work anyway. In fact there is a limit somewhat smaller than MPFR_PREC_MAX above which things will start breaking. For a sanity check in the parent constructor, something like LONG_MAX / 16 should be fine (this is a bit conservative, but there's currently no macro in arb that gives a firm bound).",
    "created_at": "2015-02-12T17:36:40Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230905",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:50'></a>
Signed integers are used because of the problems mixing signed and unsigned types in C, and precisions above LONG_MAX would not work anyway. In fact there is a limit somewhat smaller than MPFR_PREC_MAX above which things will start breaking. For a sanity check in the parent constructor, something like LONG_MAX / 16 should be fine (this is a bit conservative, but there's currently no macro in arb that gives a firm bound).



---

archive/issue_comments_230906.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [cheuberg](#comment%3A45):\n> > I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint \"precision\". Is that correct?\n\n> \n> Yes.\n\n\nOk, thanks. And do you think operations on balls should take a precision argument (defaulting to the parent's precision)? Or is the ability to change the parent enough?\n\nIn other words, assuming `b` is a `RealBall` resulting from a 100-bit operation, and thus living in `RBF(100)`, which commands among the following do you think should work to compute the exponential of `b` with 53\u00a0bits of precision:\n* `RealBallField(53)(b).exp()` (yes by the discussion I am quoting, I guess),\n* `b.change_prec(53).exp()` (a possible shortcut for the above),\n* `b.exp(prec=53)` (that's my question)?\n(All three would yield a result in `RBF(53)`.)\n\nDepending on that, I wonder if we shouldn't revert the commit where I changed \"precision\" to \"default precision\" in the messages.",
    "created_at": "2015-02-12T17:53:27Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230906",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:51'></a>
Replying to [cheuberg](#comment%3A45):
> > I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint "precision". Is that correct?

> 
> Yes.


Ok, thanks. And do you think operations on balls should take a precision argument (defaulting to the parent's precision)? Or is the ability to change the parent enough?

In other words, assuming `b` is a `RealBall` resulting from a 100-bit operation, and thus living in `RBF(100)`, which commands among the following do you think should work to compute the exponential of `b` with 53 bits of precision:
* `RealBallField(53)(b).exp()` (yes by the discussion I am quoting, I guess),
* `b.change_prec(53).exp()` (a possible shortcut for the above),
* `b.exp(prec=53)` (that's my question)?
(All three would yield a result in `RBF(53)`.)

Depending on that, I wonder if we shouldn't revert the commit where I changed "precision" to "default precision" in the messages.



---

archive/issue_comments_230907.json:
```json
{
    "body": "<a id='comment:52'></a>\nI think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).",
    "created_at": "2015-02-12T18:01:15Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230907",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:52'></a>
I think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).



---

archive/issue_comments_230908.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [mmezzarobba](#comment%3A51):\n> Replying to [cheuberg](#comment%3A45):\n> > > I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint \"precision\". Is that correct?\n\n> > \n> > Yes.\n\n> \n> Ok, thanks. And do you think operations on balls should take a precision argument (defaulting to the parent's precision)? Or is the ability to change the parent enough?\n\n\nIMHO, changing the parent is enough.\n\n> \n> In other words, assuming `b` is a `RealBall` resulting from a 100-bit operation, and thus living in `RBF(100)`, which commands among the following do you think should work to compute the exponential of `b` with 53\u00a0bits of precision:\n> * `RealBallField(53)(b).exp()` (yes by the discussion I am quoting, I guess),\n\n\nyes, but not yet implemented.\n\nI think that `RealBallField(53)(b)` would not actually *change* anything in `b` except for changing the parent.\n\n> * `b.change_prec(53).exp()` (a possible shortcut for the above),\n\n\nI do not think that this is needed: we'd have to find the correct parent, after all.\n\n> * `b.exp(prec=53)` (that's my question)?\n\n\nI do not think that this is necessary.\n\n> (All three would yield a result in `RBF(53)`.)\n> \n> Depending on that, I wonder if we shouldn't revert the commit where I changed \"precision\" to \"default precision\" in the messages.\n\n\nThe [Arb documentation](http://fredrikj.net/arb/arb.html) says \"The precision parameter [...] roughly indicates the precision to which calculations on the midpoint are carried out\".\n\nLater on, it is also mentioned that \"For more complex operations, the precision parameter indicates a minimum working precision\".\n\nSo \"default precision\" is not really correct, because the user is not allowed to change the default precision. So perhaps \"working precision\" would be more correct, or simply \"precision\".",
    "created_at": "2015-02-13T07:15:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230908",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:53'></a>
Replying to [mmezzarobba](#comment%3A51):
> Replying to [cheuberg](#comment%3A45):
> > > I have another general design question. In arb, there is no precision attached to a number or a ball, precisions are parameters of arithmetic operations. Hence, to some extent, it would make sense to have a single real ball field with no precision parameter. Except of course that we need at least a default precision for operations like coercion from exact rings and arithmetic on exact balls. (For operations with inexact balls, another, less flexible option would be to choose the default precision based on the input radii.) So I guess the model you have in mind is that the parent provides the precision parameter of arb functions, but otherwise all `RealBallField`s can have elements balls with any radius and any midpoint "precision". Is that correct?

> > 
> > Yes.

> 
> Ok, thanks. And do you think operations on balls should take a precision argument (defaulting to the parent's precision)? Or is the ability to change the parent enough?


IMHO, changing the parent is enough.

> 
> In other words, assuming `b` is a `RealBall` resulting from a 100-bit operation, and thus living in `RBF(100)`, which commands among the following do you think should work to compute the exponential of `b` with 53 bits of precision:
> * `RealBallField(53)(b).exp()` (yes by the discussion I am quoting, I guess),


yes, but not yet implemented.

I think that `RealBallField(53)(b)` would not actually *change* anything in `b` except for changing the parent.

> * `b.change_prec(53).exp()` (a possible shortcut for the above),


I do not think that this is needed: we'd have to find the correct parent, after all.

> * `b.exp(prec=53)` (that's my question)?


I do not think that this is necessary.

> (All three would yield a result in `RBF(53)`.)
> 
> Depending on that, I wonder if we shouldn't revert the commit where I changed "precision" to "default precision" in the messages.


The [Arb documentation](http://fredrikj.net/arb/arb.html) says "The precision parameter [...] roughly indicates the precision to which calculations on the midpoint are carried out".

Later on, it is also mentioned that "For more complex operations, the precision parameter indicates a minimum working precision".

So "default precision" is not really correct, because the user is not allowed to change the default precision. So perhaps "working precision" would be more correct, or simply "precision".



---

archive/issue_comments_230909.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [fredrik.johansson](#comment%3A52):\n> I think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).\n\n\nIMHO, that is a valid point.",
    "created_at": "2015-02-13T07:16:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230909",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:54'></a>
Replying to [fredrik.johansson](#comment%3A52):
> I think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).


IMHO, that is a valid point.



---

archive/issue_comments_230910.json:
```json
{
    "body": "**Changing branch** from \"[u/cheuberg/rings/real_arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/rings/real_arb)\" to \"[u/mmezzarobba/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/17194-arb)\".",
    "created_at": "2015-02-14T21:42:28Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230910",
    "user": "https://github.com/mezzarobba"
}
```

**Changing branch** from "[u/cheuberg/rings/real_arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/rings/real_arb)" to "[u/mmezzarobba/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/17194-arb)".



---

archive/issue_comments_230911.json:
```json
{
    "body": "**Changing commit** from \"[ec8d7062c18fde4ffa52191e866cb465a76b751f](https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f)\" to \"[ce51f81a120e229bc082a16d03b855607335fba9](https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9)\".",
    "created_at": "2015-02-14T21:42:28Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230911",
    "user": "https://github.com/mezzarobba"
}
```

**Changing commit** from "[ec8d7062c18fde4ffa52191e866cb465a76b751f](https://github.com/sagemath/sagetrac-mirror/commit/ec8d7062c18fde4ffa52191e866cb465a76b751f)" to "[ce51f81a120e229bc082a16d03b855607335fba9](https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9)".



---

archive/issue_comments_230912.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [cheuberg](#comment%3A54):\n> Replying to [fredrik.johansson](#comment%3A52):\n> > I think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).\n\n> \n> IMHO, that is a valid point.\n\n\nOk, I think we all agree. Thanks for your input!\n\nSo I made a few more changes as promised. As far as I am concerned I'd be happy to set the ticket to positive review, but (i) at the very least someone should review my commits, and (ii) it would be great if someone with more experience on writing (efficient) parent could check that we are not doing anything that will prove awfully wrong later on.\n\nAnd (as a way to reassure myself regarding this last point `;-)`) I started implementing some basic arithmetic (edit: and more...) on `RealBall`s. See `u/mmezzarobba/arb`. But that's for another ticket, unless you feel like reviewing the first few commits here.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/555df20dfc0443adc6cbe3d803c68847d4b1eda5\">555df20</a></td><td><code>Revert \"Clarify that the precision is a default precision\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dbc48d4f36e2dccb1aec890aa7085812f577731\">5dbc48d</a></td><td><code>#17194 RBF: prec should be a signed long</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc1d64b390a0e27a0f48624e4d345c7548fd1984\">dc1d64b</a></td><td><code>#17194 doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa39c10deba2582d944e15dbfae4a52c9a4825a0\">aa39c10</a></td><td><code>#17194 RealBall: abstract away access to parent precision</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3e3998e080c28e2bde55a85e3f08febd200ed87\">d3e3998</a></td><td><code>#17194 RBF: add a precision() method</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9\">ce51f81</a></td><td><code>#17194 RBF: some more is_foo() and similar methods</code></td></tr></table>\n",
    "created_at": "2015-02-14T21:42:28Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230912",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:55'></a>
Replying to [cheuberg](#comment%3A54):
> Replying to [fredrik.johansson](#comment%3A52):
> > I think precision should be handled identically for all versions of real and complex fields (from Sage's point of view, it doesn't really matter whether the precision is part of the underlying C structures).

> 
> IMHO, that is a valid point.


Ok, I think we all agree. Thanks for your input!

So I made a few more changes as promised. As far as I am concerned I'd be happy to set the ticket to positive review, but (i) at the very least someone should review my commits, and (ii) it would be great if someone with more experience on writing (efficient) parent could check that we are not doing anything that will prove awfully wrong later on.

And (as a way to reassure myself regarding this last point `;-)`) I started implementing some basic arithmetic (edit: and more...) on `RealBall`s. See `u/mmezzarobba/arb`. But that's for another ticket, unless you feel like reviewing the first few commits here.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/555df20dfc0443adc6cbe3d803c68847d4b1eda5">555df20</a></td><td><code>Revert "Clarify that the precision is a default precision"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dbc48d4f36e2dccb1aec890aa7085812f577731">5dbc48d</a></td><td><code>#17194 RBF: prec should be a signed long</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc1d64b390a0e27a0f48624e4d345c7548fd1984">dc1d64b</a></td><td><code>#17194 doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa39c10deba2582d944e15dbfae4a52c9a4825a0">aa39c10</a></td><td><code>#17194 RealBall: abstract away access to parent precision</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3e3998e080c28e2bde55a85e3f08febd200ed87">d3e3998</a></td><td><code>#17194 RBF: add a precision() method</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9">ce51f81</a></td><td><code>#17194 RBF: some more is_foo() and similar methods</code></td></tr></table>




---

archive/issue_comments_230913.json:
```json
{
    "body": "<a id='comment:56'></a>\nFollow-up: #17786.",
    "created_at": "2015-02-15T13:44:48Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230913",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:56'></a>
Follow-up: #17786.



---

archive/issue_comments_230914.json:
```json
{
    "body": "<a id='comment:57'></a>\nReplying to [mmezzarobba](#comment%3A56):\n> Follow-up: #11786.\n\nThe follow-up is actually #17786.\n\nI'd propose to move `is_zero` and `is_nonzero` from #17786 to this ticket in order to avoid a change of behaviour later on. Similarly, I think that rich comparison and equality checking should be implemented here.",
    "created_at": "2015-02-16T07:13:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230914",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:57'></a>
Replying to [mmezzarobba](#comment%3A56):
> Follow-up: #11786.

The follow-up is actually #17786.

I'd propose to move `is_zero` and `is_nonzero` from #17786 to this ticket in order to avoid a change of behaviour later on. Similarly, I think that rich comparison and equality checking should be implemented here.



---

archive/issue_comments_230915.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [cheuberg](#comment%3A57):\n> The follow-up is actually #17786.\n\n\nOops, thanks. I will edit my other post to avoid any confusion.\n\n> I'd propose to move `is_zero` and `is_nonzero` from #17786 to this ticket in order to avoid a change of behaviour later on. Similarly, I think that rich comparison and equality checking should be implemented here.\n\n\nFine with me. Feel free to do it if you want, I will again be a bit busy in the next days.",
    "created_at": "2015-02-16T07:26:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230915",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:58'></a>
Replying to [cheuberg](#comment%3A57):
> The follow-up is actually #17786.


Oops, thanks. I will edit my other post to avoid any confusion.

> I'd propose to move `is_zero` and `is_nonzero` from #17786 to this ticket in order to avoid a change of behaviour later on. Similarly, I think that rich comparison and equality checking should be implemented here.


Fine with me. Feel free to do it if you want, I will again be a bit busy in the next days.



---

archive/issue_comments_230916.json:
```json
{
    "body": "**Changing branch** from \"[u/mmezzarobba/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/17194-arb)\" to \"[u/cheuberg/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/17194-arb)\".",
    "created_at": "2015-02-16T07:57:23Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230916",
    "user": "https://github.com/cheuberg"
}
```

**Changing branch** from "[u/mmezzarobba/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/17194-arb)" to "[u/cheuberg/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/17194-arb)".



---

archive/issue_comments_230917.json:
```json
{
    "body": "<a id='comment:60'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588\">5e41fcb</a></td><td><code>Trac #17194: remove imports of fmpr</code></td></tr></table>\n",
    "created_at": "2015-02-16T08:08:59Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588">5e41fcb</a></td><td><code>Trac #17194: remove imports of fmpr</code></td></tr></table>




---

archive/issue_comments_230918.json:
```json
{
    "body": "**Changing commit** from \"[ce51f81a120e229bc082a16d03b855607335fba9](https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9)\" to \"[5e41fcbc08bf0e04ff5a41ea60866568c5bc8588](https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588)\".",
    "created_at": "2015-02-16T08:08:59Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230918",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ce51f81a120e229bc082a16d03b855607335fba9](https://github.com/sagemath/sagetrac-mirror/commit/ce51f81a120e229bc082a16d03b855607335fba9)" to "[5e41fcbc08bf0e04ff5a41ea60866568c5bc8588](https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588)".



---

archive/issue_comments_230919.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n In the present ticket, rather minimal bindings are provided.\n \n As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.\n+\n+\n``````\n",
    "created_at": "2015-02-16T08:14:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230919",
    "user": "https://github.com/cheuberg"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 In the present ticket, rather minimal bindings are provided.
 
 As a proof of concept, the digamma function of a `RealIntervalFieldElement` is implemented by converting it to an `RealBall`, computing the digamma function via the arb library, and converting the result back.
+
+
``````




---

archive/issue_comments_230920.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [mmezzarobba](#comment%3A55):\n> So I made a few more changes as promised.\n\nThank you.\n\n> As far as I am concerned I'd be happy to set the ticket to positive review, but (i) at the very least someone should review my commits,\n\n\nI cross-reviewed your commits, they look good to me, doctests pass. For a test, I included `real_arb` into the documentation, documentation built fine.\n\nFurthermore, I removed `fmpr.pxd` because it is no longer needed and deprecated in arb.\n\nI'll take care of `is_zero`, `is_nonzero`, `__richcmp__`.",
    "created_at": "2015-02-16T08:14:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230920",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:61'></a>
Replying to [mmezzarobba](#comment%3A55):
> So I made a few more changes as promised.

Thank you.

> As far as I am concerned I'd be happy to set the ticket to positive review, but (i) at the very least someone should review my commits,


I cross-reviewed your commits, they look good to me, doctests pass. For a test, I included `real_arb` into the documentation, documentation built fine.

Furthermore, I removed `fmpr.pxd` because it is no longer needed and deprecated in arb.

I'll take care of `is_zero`, `is_nonzero`, `__richcmp__`.



---

archive/issue_comments_230921.json:
```json
{
    "body": "**Work Issues:** is_zero, is_nonzero, __richcmp__",
    "created_at": "2015-02-16T08:14:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230921",
    "user": "https://github.com/cheuberg"
}
```

**Work Issues:** is_zero, is_nonzero, __richcmp__



---

archive/issue_comments_230922.json:
```json
{
    "body": "**Changing author** from \"Clemens Heuberger\" to \"Clemens Heuberger, Marc Mezzarobba\".",
    "created_at": "2015-02-16T08:14:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230922",
    "user": "https://github.com/cheuberg"
}
```

**Changing author** from "Clemens Heuberger" to "Clemens Heuberger, Marc Mezzarobba".



---

archive/issue_events_154308.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-16T08:14:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154308"
}
```



---

archive/issue_events_154309.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-16T08:14:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154309"
}
```



---

archive/issue_comments_230923.json:
```json
{
    "body": "**Changing commit** from \"[5e41fcbc08bf0e04ff5a41ea60866568c5bc8588](https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588)\" to \"[195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)\".",
    "created_at": "2015-02-16T11:25:20Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5e41fcbc08bf0e04ff5a41ea60866568c5bc8588](https://github.com/sagemath/sagetrac-mirror/commit/5e41fcbc08bf0e04ff5a41ea60866568c5bc8588)" to "[195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)".



---

archive/issue_comments_230924.json:
```json
{
    "body": "<a id='comment:62'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e7ec4690876cd0ac2f3d77a27bd2319fcd9e2bf\">4e7ec46</a></td><td><code>Trac #17194: is_zero, is_nonzero, is_exact</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e2615290be0d4470083844f071dd09131d7cfc4\">9e26152</a></td><td><code>Trac #17194: Implement comparisons</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1196b578f14cadb6051dafa5515dd7660340915e\">1196b57</a></td><td><code>Trac #17194: Fix RealBallField._an_element_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363\">195a6ee</a></td><td><code>Trac #17194: Fix two broken references</code></td></tr></table>\n",
    "created_at": "2015-02-16T11:25:20Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e7ec4690876cd0ac2f3d77a27bd2319fcd9e2bf">4e7ec46</a></td><td><code>Trac #17194: is_zero, is_nonzero, is_exact</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e2615290be0d4470083844f071dd09131d7cfc4">9e26152</a></td><td><code>Trac #17194: Implement comparisons</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1196b578f14cadb6051dafa5515dd7660340915e">1196b57</a></td><td><code>Trac #17194: Fix RealBallField._an_element_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363">195a6ee</a></td><td><code>Trac #17194: Fix two broken references</code></td></tr></table>




---

archive/issue_comments_230925.json:
```json
{
    "body": "<a id='comment:63'></a>\nThe semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.\n\nSo, `!=` is not `not ==`.\n\nI prefer this for two reasons:\n\n- We are wrapping `arb` here, and `arb` has this convention (`is_nonzero`).\n- `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.\n\nFurthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not. Otherwise, `a==b` can only hold if `a` and `b` are exact.",
    "created_at": "2015-02-16T11:30:52Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230925",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:63'></a>
The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.

So, `!=` is not `not ==`.

I prefer this for two reasons:

- We are wrapping `arb` here, and `arb` has this convention (`is_nonzero`).
- `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.

Furthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not. Otherwise, `a==b` can only hold if `a` and `b` are exact.



---

archive/issue_comments_230926.json:
```json
{
    "body": "**Changing work issues** from \"is_zero, is_nonzero, __richcmp__\" to \"\".",
    "created_at": "2015-02-16T11:31:17Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230926",
    "user": "https://github.com/cheuberg"
}
```

**Changing work issues** from "is_zero, is_nonzero, __richcmp__" to "".



---

archive/issue_events_154310.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-16T11:31:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154310"
}
```



---

archive/issue_events_154311.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-02-16T11:31:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154311"
}
```



---

archive/issue_comments_230927.json:
```json
{
    "body": "<a id='comment:65'></a>\nReplying to [cheuberg](#comment%3A63):\n> The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.\n> \n> So, `!=` is not `not ==`.\n\n\nHmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.\n\n> I prefer this for two reasons:\n> \n> - We are wrapping `arb` here, and `arb` has this convention (`is_nonzero`).\n\n\n(I don't understand what you mean here, but I don't think it matters.)\n\n> - `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.\n\n\nYes, I agree. Unfortunately, this convention (having `True` mean true and `False` mean false or don't know, basically) is not observed consistently in sage. Besides, I am very unconfortable with comparisons in sage in general, mostly due to the fact that they try to apply coercions, which leads to all sorts of problems when different parents use different semantics... So I guess I'd be in favor of having methods that *duplicate* the behavior of comparisons but only work for balls, in order not to risk mixing balls with other object types by mistake!\n\n> Furthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not.\n\n\nI don't know what to think about that. That's consistent with the semantics of arb functions, and up to now I have sticked to the convention in the bindings I wrote. But I fear this will lead to unexpected behaviors and inconsistencies wrt the rest of sage, and I really believe we should think it through more carefully before committing to the arb semantics.",
    "created_at": "2015-02-16T15:35:17Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230927",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:65'></a>
Replying to [cheuberg](#comment%3A63):
> The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.
> 
> So, `!=` is not `not ==`.


Hmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.

> I prefer this for two reasons:
> 
> - We are wrapping `arb` here, and `arb` has this convention (`is_nonzero`).


(I don't understand what you mean here, but I don't think it matters.)

> - `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.


Yes, I agree. Unfortunately, this convention (having `True` mean true and `False` mean false or don't know, basically) is not observed consistently in sage. Besides, I am very unconfortable with comparisons in sage in general, mostly due to the fact that they try to apply coercions, which leads to all sorts of problems when different parents use different semantics... So I guess I'd be in favor of having methods that *duplicate* the behavior of comparisons but only work for balls, in order not to risk mixing balls with other object types by mistake!

> Furthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not.


I don't know what to think about that. That's consistent with the semantics of arb functions, and up to now I have sticked to the convention in the bindings I wrote. But I fear this will lead to unexpected behaviors and inconsistencies wrt the rest of sage, and I really believe we should think it through more carefully before committing to the arb semantics.



---

archive/issue_comments_230928.json:
```json
{
    "body": "<a id='comment:66'></a>\nReplying to [mmezzarobba](#comment%3A65):\n> Replying to [cheuberg](#comment%3A63):\n> > The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.\n> > \n> > So, `!=` is not `not ==`.\n\n> \n> Hmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.\n\n\n\nI hope that the following examples make my impression of the current behaviour clear.\n\n```\nsage: a = RIF(-1, 1)\nsage: from sage.rings.real_arb import RealBallField\nsage: RBF = RealBallField()\nsage: b = RBF(a)\nsage: a.__nonzero__()\nTrue\nsage: b.__nonzero__()\nFalse\nsage: bool(a)\nTrue\nsage: bool(b)\nFalse\nsage: a == 0\nFalse\nsage: b == 0\nFalse\nsage: a != 0\nFalse\nsage: b != 0\nFalse\n```\n\n> > - `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.\n \n> \n> Yes, I agree. Unfortunately, this convention (having `True` mean true and `False` mean false or don't know, basically) is not observed consistently in sage. Besides, I am very unconfortable with comparisons in sage in general, mostly due to the fact that they try to apply coercions, which leads to all sorts of problems when different parents use different semantics... So I guess I'd be in favor of having methods that *duplicate* the behavior of comparisons but only work for balls, in order not to risk mixing balls with other object types by mistake!\n\n\nIn commit 5e41fcb, prior to my implementation of comparison, I obtain\n\n```\nsage: b < RIF(-3)\nTrue\n```\non my system because, sadly, sage reverts to comparing types if it cannot compare elements.\n\nSo if I understand you correctly, you'd be in favor of having methods `RealBall.lt` and leave the original methods untouched? I fear that a user may then mistakenly use the above example and get \"surprising\" results.\n\nPerhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?\n\n> > Furthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not.\n\n> \n> I don't know what to think about that. That's consistent with the semantics of arb functions, and up to now I have sticked to the convention in the bindings I wrote. But I fear this will lead to unexpected behaviors and inconsistencies wrt the rest of sage, and I really believe we should think it through more carefully before committing to the arb semantics.\n\n\nI do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. \n\nFor me, the behavior of `RealIntervalFieldElement`\n\n```\nsage: a = RIF(-1, 1)\nsage: from sage.rings.real_arb import RealBallField\nsage: RBF = RealBallField()\nsage: b = RBF(a)\nsage: a == a\nFalse\nsage: b == b\nTrue\n```\nis *very* unexpected. After all, equality is usually assumed to be reflexive.",
    "created_at": "2015-02-16T16:57:02Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230928",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:66'></a>
Replying to [mmezzarobba](#comment%3A65):
> Replying to [cheuberg](#comment%3A63):
> > The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.
> > 
> > So, `!=` is not `not ==`.

> 
> Hmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.



I hope that the following examples make my impression of the current behaviour clear.

```
sage: a = RIF(-1, 1)
sage: from sage.rings.real_arb import RealBallField
sage: RBF = RealBallField()
sage: b = RBF(a)
sage: a.__nonzero__()
True
sage: b.__nonzero__()
False
sage: bool(a)
True
sage: bool(b)
False
sage: a == 0
False
sage: b == 0
False
sage: a != 0
False
sage: b != 0
False
```

> > - `__richcmp__` allows independent implementations for `==` and `!=`; I take this as a hint.
 
> 
> Yes, I agree. Unfortunately, this convention (having `True` mean true and `False` mean false or don't know, basically) is not observed consistently in sage. Besides, I am very unconfortable with comparisons in sage in general, mostly due to the fact that they try to apply coercions, which leads to all sorts of problems when different parents use different semantics... So I guess I'd be in favor of having methods that *duplicate* the behavior of comparisons but only work for balls, in order not to risk mixing balls with other object types by mistake!


In commit 5e41fcb, prior to my implementation of comparison, I obtain

```
sage: b < RIF(-3)
True
```
on my system because, sadly, sage reverts to comparing types if it cannot compare elements.

So if I understand you correctly, you'd be in favor of having methods `RealBall.lt` and leave the original methods untouched? I fear that a user may then mistakenly use the above example and get "surprising" results.

Perhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?

> > Furthermore, the semantics of `==` are different from real intervals: If `a is b`, then `a==b`, independently of whether they are exact or not.

> 
> I don't know what to think about that. That's consistent with the semantics of arb functions, and up to now I have sticked to the convention in the bindings I wrote. But I fear this will lead to unexpected behaviors and inconsistencies wrt the rest of sage, and I really believe we should think it through more carefully before committing to the arb semantics.


I do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. 

For me, the behavior of `RealIntervalFieldElement`

```
sage: a = RIF(-1, 1)
sage: from sage.rings.real_arb import RealBallField
sage: RBF = RealBallField()
sage: b = RBF(a)
sage: a == a
False
sage: b == b
True
```
is *very* unexpected. After all, equality is usually assumed to be reflexive.



---

archive/issue_comments_230929.json:
```json
{
    "body": "<a id='comment:67'></a>\nReplying to [cheuberg](#comment%3A66):\n> Replying to [mmezzarobba](#comment%3A65):\n> > Replying to [cheuberg](#comment%3A63):\n> > > The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.\n> > > \n> > > So, `!=` is not `not ==`.\n\n> > \n> > Hmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.\n\n> \n> \n> I hope that the following examples make my impression of the current behaviour clear.\n> \n> ```\n> sage: a = RIF(-1, 1)\n> sage: from sage.rings.real_arb import RealBallField\n> sage: RBF = RealBallField()\n> sage: b = RBF(a)\n> sage: a.__nonzero__()\n> True\n> sage: b.__nonzero__()\n> False\n> sage: bool(a)\n> True\n> sage: bool(b)\n> False\n> sage: a == 0\n> False\n> sage: b == 0\n> False\n> sage: a != 0\n> False\n> sage: b != 0\n> False\n> ```\n\n\nSo I think we agree: `==` and `!=` behave the same way for intervals and balls (with your implementation), except for the case of `x == y` when `x is y`. However, `__nonzero__` behaves differently. (And, to be clear: I believe that your choice is the more sensible one, but I don't like the inconsistency.) Is that correct?\n\n> So if I understand you correctly, you'd be in favor of having methods `RealBall.lt` and leave the original methods untouched? I fear that a user may then mistakenly use the above example and get \"surprising\" results.\n\n\nNo, I guess I wasn't clear, sorry. Imho the fact that comparisons of sage objects (or at least of sage Elements) can fall back to comparing types at all is dreadful. I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.\n\n> Perhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?\n\n\nI don't know if it is possible, and I doubt it is a good idea to circumvent the coercion system even if it can lead to problems.\n\n> I do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. \n\n\nForget it, I think I convinced myself that it was ok\u2014as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)\n\n> For me, the behavior of `RealIntervalFieldElement`\n> \n> ```\n> sage: a = RIF(-1, 1)\n> sage: from sage.rings.real_arb import RealBallField\n> sage: RBF = RealBallField()\n> sage: b = RBF(a)\n> sage: a == a\n> False\n> sage: b == b\n> True\n> ```\n> is *very* unexpected.\n\n\nI wouldn't say that: after all, it does not hold true that for all x, y in [-1,1], x=y...\n\n> After all, equality is usually assumed to be reflexive.\n\n\nYes, but that argument would be (almost) equally valid in the case of `RBF(foo) == RBF(foo)`, and I don't think we want that to hold if `RBF(foo)` is not a point ball!\n\n(I will be offline for a few days. If anyone would like to take over the review, please feel free.)",
    "created_at": "2015-02-18T15:02:53Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230929",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:67'></a>
Replying to [cheuberg](#comment%3A66):
> Replying to [mmezzarobba](#comment%3A65):
> > Replying to [cheuberg](#comment%3A63):
> > > The semantics of `!=` differ from those of real intervals: A ball is considered non-zero if it does not contain `0`.
> > > 
> > > So, `!=` is not `not ==`.

> > 
> > Hmm, if I read correctly, that's also how comparisons of `RealIntervalFieldElement`s work. Can you please be more specific about the difference you're seeing? For me the only difference is that, in the case of `RealIntervalFieldElement`s, `__nonzero__` is not consistent with `!= 0`.

> 
> 
> I hope that the following examples make my impression of the current behaviour clear.
> 
> ```
> sage: a = RIF(-1, 1)
> sage: from sage.rings.real_arb import RealBallField
> sage: RBF = RealBallField()
> sage: b = RBF(a)
> sage: a.__nonzero__()
> True
> sage: b.__nonzero__()
> False
> sage: bool(a)
> True
> sage: bool(b)
> False
> sage: a == 0
> False
> sage: b == 0
> False
> sage: a != 0
> False
> sage: b != 0
> False
> ```


So I think we agree: `==` and `!=` behave the same way for intervals and balls (with your implementation), except for the case of `x == y` when `x is y`. However, `__nonzero__` behaves differently. (And, to be clear: I believe that your choice is the more sensible one, but I don't like the inconsistency.) Is that correct?

> So if I understand you correctly, you'd be in favor of having methods `RealBall.lt` and leave the original methods untouched? I fear that a user may then mistakenly use the above example and get "surprising" results.


No, I guess I wasn't clear, sorry. Imho the fact that comparisons of sage objects (or at least of sage Elements) can fall back to comparing types at all is dreadful. I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.

> Perhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?


I don't know if it is possible, and I doubt it is a good idea to circumvent the coercion system even if it can lead to problems.

> I do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. 


Forget it, I think I convinced myself that it was ok—as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)

> For me, the behavior of `RealIntervalFieldElement`
> 
> ```
> sage: a = RIF(-1, 1)
> sage: from sage.rings.real_arb import RealBallField
> sage: RBF = RealBallField()
> sage: b = RBF(a)
> sage: a == a
> False
> sage: b == b
> True
> ```
> is *very* unexpected.


I wouldn't say that: after all, it does not hold true that for all x, y in [-1,1], x=y...

> After all, equality is usually assumed to be reflexive.


Yes, but that argument would be (almost) equally valid in the case of `RBF(foo) == RBF(foo)`, and I don't think we want that to hold if `RBF(foo)` is not a point ball!

(I will be offline for a few days. If anyone would like to take over the review, please feel free.)



---

archive/issue_comments_230930.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [mmezzarobba](#comment%3A67):\n> So I think we agree: `==` and `!=` behave the same way for intervals and balls (with your implementation), except for the case of `x == y` when `x is y`. However, `__nonzero__` behaves differently. (And, to be clear: I believe that your choice is the more sensible one, but I don't like the inconsistency.) Is that correct?\n\n\nThis is correct.",
    "created_at": "2015-02-19T07:16:17Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230930",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:68'></a>
Replying to [mmezzarobba](#comment%3A67):
> So I think we agree: `==` and `!=` behave the same way for intervals and balls (with your implementation), except for the case of `x == y` when `x is y`. However, `__nonzero__` behaves differently. (And, to be clear: I believe that your choice is the more sensible one, but I don't like the inconsistency.) Is that correct?


This is correct.



---

archive/issue_comments_230931.json:
```json
{
    "body": "<a id='comment:69'></a>\n(Replying in several chunks due to trac timeouts when I try to reply in one go, sorry).\n\nReplying to [mmezzarobba](#comment%3A67):\n> No, I guess I wasn't clear, sorry. Imho the fact that comparisons of sage objects (or at least of sage Elements) can fall back to comparing types at all is dreadful.\n\n\nI agree.\n\n> I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.\n\n\nWe can always do that later because it would not change behaviour.\n\n\n> > Perhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?\n\n> \n> I don't know if it is possible, and I doubt it is a good idea to circumvent the coercion system even if it can lead to problems.\n\n\nSo let's forget this idea.",
    "created_at": "2015-02-19T07:18:32Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230931",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:69'></a>
(Replying in several chunks due to trac timeouts when I try to reply in one go, sorry).

Replying to [mmezzarobba](#comment%3A67):
> No, I guess I wasn't clear, sorry. Imho the fact that comparisons of sage objects (or at least of sage Elements) can fall back to comparing types at all is dreadful.


I agree.

> I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.


We can always do that later because it would not change behaviour.


> > Perhaps we could overwrite `__richcmp__` in such a way that, if no coercions to balls are available, a `NotImplementedError` is raised?

> 
> I don't know if it is possible, and I doubt it is a good idea to circumvent the coercion system even if it can lead to problems.


So let's forget this idea.



---

archive/issue_comments_230932.json:
```json
{
    "body": "<a id='comment:70'></a>\nReplying to [mmezzarobba](#comment%3A67):\n> > I do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. \n\n> \n> Forget it, I think I convinced myself that it was ok\u2014as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)\n\n\nI do not understand your point. If `M` is a subset of the real line (represented by a ball) and `f` is a function, I still believe that `f(M)` can be computed by `RealBall`.\n\n> I wouldn't say that: after all, it does not hold true that for all x, y in [-1,1], x=y...\n> \n> > After all, equality is usually assumed to be reflexive.\n\n> \n> Yes, but that argument would be (almost) equally valid in the case of `RBF(foo) == RBF(foo)`, and I don't think we want that to hold if `RBF(foo)` is not a point ball!\n\n\nNo, I do not want that.\n\nFor reference, I quote here from the [Arb manual](http://fredrikj.net/arb/issues.html):\n\n\"Identical pointers are understood to give permission for algebraic simplification. This assumption is made to improve performance. For example, the call `arb_mul(z, x, x, prec)` sets `z` to a ball enclosing the set `{t^2 : t \u2208 x}` and not the (generally larger) set `{tu : t \u2208 x, u \u2208 x}`.\"",
    "created_at": "2015-02-19T07:21:30Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230932",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:70'></a>
Replying to [mmezzarobba](#comment%3A67):
> > I do not understand what you mean. In my understanding, having the implication that identical objects are mathematically equal, should not lead to unexpected behavior within the rest of sage. 

> 
> Forget it, I think I convinced myself that it was ok—as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)


I do not understand your point. If `M` is a subset of the real line (represented by a ball) and `f` is a function, I still believe that `f(M)` can be computed by `RealBall`.

> I wouldn't say that: after all, it does not hold true that for all x, y in [-1,1], x=y...
> 
> > After all, equality is usually assumed to be reflexive.

> 
> Yes, but that argument would be (almost) equally valid in the case of `RBF(foo) == RBF(foo)`, and I don't think we want that to hold if `RBF(foo)` is not a point ball!


No, I do not want that.

For reference, I quote here from the [Arb manual](http://fredrikj.net/arb/issues.html):

"Identical pointers are understood to give permission for algebraic simplification. This assumption is made to improve performance. For example, the call `arb_mul(z, x, x, prec)` sets `z` to a ball enclosing the set `{t^2 : t ∈ x}` and not the (generally larger) set `{tu : t ∈ x, u ∈ x}`."



---

archive/issue_comments_230933.json:
```json
{
    "body": "<a id='comment:71'></a>\nReplying to [cheuberg](#comment%3A69):\n> > I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.\n\n> \n> We can always do that later because it would not change behaviour.\n\n\nYes.",
    "created_at": "2015-02-19T07:46:27Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230933",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:71'></a>
Replying to [cheuberg](#comment%3A69):
> > I was saying (as an aside, not as a remark on your code) that I would be tempted to implement safer comparison methods in addition to your implementation of Python comparisons (and with the same semantics in the case where we compare balls to balls) because Sage comparisons are dangerous in general.

> 
> We can always do that later because it would not change behaviour.


Yes.



---

archive/issue_events_154312.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-02-19T09:50:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154312"
}
```



---

archive/issue_events_154313.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-02-19T09:50:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154313"
}
```



---

archive/issue_comments_230934.json:
```json
{
    "body": "<a id='comment:72'></a>\nSo despite what I said about being offline for a few days, I could have a look at your last changes before disappearing.\n\nReplying to [cheuberg](#comment%3A70):\n> > Forget it, I think I convinced myself that it was ok\u2014as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)\n\n> \n> I do not understand your point. If `M` is a subset of the real line (represented by a ball) and `f` is a function, I still believe that `f(M)` can be computed by `RealBall`.\n\n\nOk, that was very badly expressed once again. Sorry about that, I'm trying to do too many things at once `:-(`. \n\nAll I was trying to say essentially is that if your think of balls as ranges, not approximate reals, then code like\n\n```\ndef f(x, y): return x-y\ndef range(f, *args): return f(*args)\nunit_ball = RBF(0, rad=1)\nrange(f, unit_ball, unit_ball)\n```\nlooks correct, while it violates the rule about aliasing in arb that you quoted. I guess one could come up with more subtle examples with `cached_function`s or additional layers of abstraction.\n\nA few more quick comments:\n* I think we will need `fmpr` again later on to implement `rad()`;\n* `_an_element_` can be inherited, but perhaps this requires some of the coercion & category stuff I implemented on the other ticket, I don't remember;\n(so several of your last changes will probably be reverted in the follow-up ticket)\n* we should add a note about aliasing similar to that which you quoted to the python package's documentation too;\n* `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;\n* I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.\n\nNone of the above is really urgent or important and the current state of the code looks good to me, so I'm setting the ticket to positive review to avoid delaying it too much. But please feel free to make changes here if you want, and then I'll try to review them when I come back.",
    "created_at": "2015-02-19T09:50:02Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230934",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:72'></a>
So despite what I said about being offline for a few days, I could have a look at your last changes before disappearing.

Replying to [cheuberg](#comment%3A70):
> > Forget it, I think I convinced myself that it was ok—as long as a ball is understood as representing a single real number, of course. (And never as a subset of the real line whose image by a given function needs to be bounded, say.)

> 
> I do not understand your point. If `M` is a subset of the real line (represented by a ball) and `f` is a function, I still believe that `f(M)` can be computed by `RealBall`.


Ok, that was very badly expressed once again. Sorry about that, I'm trying to do too many things at once `:-(`. 

All I was trying to say essentially is that if your think of balls as ranges, not approximate reals, then code like

```
def f(x, y): return x-y
def range(f, *args): return f(*args)
unit_ball = RBF(0, rad=1)
range(f, unit_ball, unit_ball)
```
looks correct, while it violates the rule about aliasing in arb that you quoted. I guess one could come up with more subtle examples with `cached_function`s or additional layers of abstraction.

A few more quick comments:
* I think we will need `fmpr` again later on to implement `rad()`;
* `_an_element_` can be inherited, but perhaps this requires some of the coercion & category stuff I implemented on the other ticket, I don't remember;
(so several of your last changes will probably be reverted in the follow-up ticket)
* we should add a note about aliasing similar to that which you quoted to the python package's documentation too;
* `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;
* I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.

None of the above is really urgent or important and the current state of the code looks good to me, so I'm setting the ticket to positive review to avoid delaying it too much. But please feel free to make changes here if you want, and then I'll try to review them when I come back.



---

archive/issue_comments_230935.json:
```json
{
    "body": "**Reviewer:** Marc Mezzarobba",
    "created_at": "2015-02-19T09:50:02Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230935",
    "user": "https://github.com/mezzarobba"
}
```

**Reviewer:** Marc Mezzarobba



---

archive/issue_comments_230936.json:
```json
{
    "body": "<a id='comment:73'></a>\nReplying to [mmezzarobba](#comment%3A72):\n> So despite what I said about being offline for a few days, I could have a look at your last changes before disappearing.\n\n\nThank you.\n\n> * we should add a note about aliasing similar to that which you quoted to the python package's documentation too;\n> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;\n> * I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.\n> \n> None of the above is really urgent or important and the current state of the code looks good to me, so I'm setting the ticket to positive review to avoid delaying it too much. But please feel free to make changes here if you want, and then I'll try to review them when I come back.\n\n\nWhile I think that your points above are valid, I do not want to make changes here any more.\nI'll try to do that in a separate ticket. Moreover, I plan to adapt the `ComplexBalls` (#17218) to the structure implemented here.",
    "created_at": "2015-02-19T10:15:14Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230936",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:73'></a>
Replying to [mmezzarobba](#comment%3A72):
> So despite what I said about being offline for a few days, I could have a look at your last changes before disappearing.


Thank you.

> * we should add a note about aliasing similar to that which you quoted to the python package's documentation too;
> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;
> * I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.
> 
> None of the above is really urgent or important and the current state of the code looks good to me, so I'm setting the ticket to positive review to avoid delaying it too much. But please feel free to make changes here if you want, and then I'll try to review them when I come back.


While I think that your points above are valid, I do not want to make changes here any more.
I'll try to do that in a separate ticket. Moreover, I plan to adapt the `ComplexBalls` (#17218) to the structure implemented here.



---

archive/issue_comments_230937.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [mmezzarobba](#comment%3A72):\n> A few more quick comments:\n> * I think we will need `fmpr` again later on to implement `rad()`;\n\n\nAnything `fmpr` can be done with `arf` module.\n\n> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;\n\n\nYes, unfortunately I haven't added any code yet to underflow or overflow gracefully when converting to MPFR. When developing, I deliberately wanted this to crash rather than fail silently.\n\nI should probably fix `arb_get_interval_mpfr` to set the endpoint to `+/- 2^MPFR_MIN_EXP` on underflow and `+/- inf` on overflow.\n\nRather than changing `arf_get_mpfr`, I might add a separate `arf_get_mpfr_overflow` that behaves as if you had computed an out-of-range value within MPFR (setting MPFR overflow flags and so on).",
    "created_at": "2015-02-19T10:15:47Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230937",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:74'></a>
Replying to [mmezzarobba](#comment%3A72):
> A few more quick comments:
> * I think we will need `fmpr` again later on to implement `rad()`;


Anything `fmpr` can be done with `arf` module.

> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;


Yes, unfortunately I haven't added any code yet to underflow or overflow gracefully when converting to MPFR. When developing, I deliberately wanted this to crash rather than fail silently.

I should probably fix `arb_get_interval_mpfr` to set the endpoint to `+/- 2^MPFR_MIN_EXP` on underflow and `+/- inf` on overflow.

Rather than changing `arf_get_mpfr`, I might add a separate `arf_get_mpfr_overflow` that behaves as if you had computed an out-of-range value within MPFR (setting MPFR overflow flags and so on).



---

archive/issue_comments_230938.json:
```json
{
    "body": "<a id='comment:75'></a>\nReplying to [cheuberg](#comment%3A73):\n> While I think that your points above are valid, I do not want to make changes here any more.\n> I'll try to do that in a separate ticket. Moreover, I plan to adapt the `ComplexBalls` (#17218) to the structure implemented here.\n\n\nGreat, thanks for your work on these bindings! I'll do what I can to help.",
    "created_at": "2015-02-19T10:22:18Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230938",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:75'></a>
Replying to [cheuberg](#comment%3A73):
> While I think that your points above are valid, I do not want to make changes here any more.
> I'll try to do that in a separate ticket. Moreover, I plan to adapt the `ComplexBalls` (#17218) to the structure implemented here.


Great, thanks for your work on these bindings! I'll do what I can to help.



---

archive/issue_comments_230939.json:
```json
{
    "body": "<a id='comment:76'></a>\nReplying to [fredrik.johansson](#comment%3A74):\n> Replying to [mmezzarobba](#comment%3A72):\n> > A few more quick comments:\n> > * I think we will need `fmpr` again later on to implement `rad()`;\n \n> \n> Anything `fmpr` can be done with `arf` module.\n\n\nWhat should we do to convert a `mag_t` to an `mpfr_t`? Using `mag_get_fmpr`looked like the simplest method.",
    "created_at": "2015-02-19T10:26:24Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230939",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:76'></a>
Replying to [fredrik.johansson](#comment%3A74):
> Replying to [mmezzarobba](#comment%3A72):
> > A few more quick comments:
> > * I think we will need `fmpr` again later on to implement `rad()`;
 
> 
> Anything `fmpr` can be done with `arf` module.


What should we do to convert a `mag_t` to an `mpfr_t`? Using `mag_get_fmpr`looked like the simplest method.



---

archive/issue_comments_230940.json:
```json
{
    "body": "<a id='comment:77'></a>\nReplying to [mmezzarobba](#comment%3A76):\n> Replying to [fredrik.johansson](#comment%3A74):\n> > Replying to [mmezzarobba](#comment%3A72):\n> > > A few more quick comments:\n> > > * I think we will need `fmpr` again later on to implement `rad()`;\n \n> > \n> > Anything `fmpr` can be done with `arf` module.\n\n> \n> What should we do to convert a `mag_t` to an `mpfr_t`? Using `mag_get_fmpr`looked like the simplest method.\n\n\n`arf_set_mag`, so-called because the `arf` module depends on the `mag` module and not vice versa.",
    "created_at": "2015-02-19T10:29:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230940",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:77'></a>
Replying to [mmezzarobba](#comment%3A76):
> Replying to [fredrik.johansson](#comment%3A74):
> > Replying to [mmezzarobba](#comment%3A72):
> > > A few more quick comments:
> > > * I think we will need `fmpr` again later on to implement `rad()`;
 
> > 
> > Anything `fmpr` can be done with `arf` module.

> 
> What should we do to convert a `mag_t` to an `mpfr_t`? Using `mag_get_fmpr`looked like the simplest method.


`arf_set_mag`, so-called because the `arf` module depends on the `mag` module and not vice versa.



---

archive/issue_comments_230941.json:
```json
{
    "body": "<a id='comment:78'></a>\nReplying to [fredrik.johansson](#comment%3A77):\n> `arf_set_mag`, so-called because the `arf` module depends on the `mag` module and not vice versa.\n\n\nOk, I missed that function, thanks!",
    "created_at": "2015-02-19T10:30:59Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230941",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:78'></a>
Replying to [fredrik.johansson](#comment%3A77):
> `arf_set_mag`, so-called because the `arf` module depends on the `mag` module and not vice versa.


Ok, I missed that function, thanks!



---

archive/issue_comments_230942.json:
```json
{
    "body": "<a id='comment:79'></a>\nAnother question that we may want to think about is whether and how to expose exact (by which I mean `ARF_PREC_EXACT`) operations. They would be useful to me, but perhaps being able to use them directly from cython is enough.",
    "created_at": "2015-02-19T10:33:03Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230942",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:79'></a>
Another question that we may want to think about is whether and how to expose exact (by which I mean `ARF_PREC_EXACT`) operations. They would be useful to me, but perhaps being able to use them directly from cython is enough.



---

archive/issue_comments_230943.json:
```json
{
    "body": "<a id='comment:80'></a>\n`ARF_PREC_EXACT` is something of a hack, and not really safe in general. If your numbers are too large, you get undefined behavior.",
    "created_at": "2015-02-19T10:46:23Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230943",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:80'></a>
`ARF_PREC_EXACT` is something of a hack, and not really safe in general. If your numbers are too large, you get undefined behavior.



---

archive/issue_comments_230944.json:
```json
{
    "body": "<a id='comment:81'></a>\nReplying to [mmezzarobba](#comment%3A72):\n> * we should add a note about aliasing similar to that which you quoted to the python package's documentation too;\n\n\nThis is now #17809.\n\n> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;\n\n\nIt was hard to provoke this with available functions, but it did crash sage. This is now #17811.\n\n> * I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.\n\n\nThis is #17810.",
    "created_at": "2015-02-19T16:52:21Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230944",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:81'></a>
Replying to [mmezzarobba](#comment%3A72):
> * we should add a note about aliasing similar to that which you quoted to the python package's documentation too;


This is now #17809.

> * `arb_to_mpfi` will probably crash sage if the ball's endpoints are not representable within the exponent range of MPFR FP numbers (but it is close to impossible to construct such balls at this point), use `sig_on()` or `sig_str()` (without `_do_sig`) to prevent that;


It was hard to provoke this with available functions, but it did crash sage. This is now #17811.

> * I personally find `return (lst is rt) or (arb_is_exact(...) and ... and ...)` more readable than your implementation of equality, but that's a matter of taste.


This is #17810.



---

archive/issue_events_154314.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-21T12:40:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154314"
}
```



---

archive/issue_events_154315.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ed2927bb9452aa35f85700a843ebc07149b00d12",
    "created_at": "2015-02-21T12:40:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17194#event-154315"
}
```



---

archive/issue_comments_230945.json:
```json
{
    "body": "**Changing branch** from \"[u/cheuberg/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/17194-arb)\" to \"[195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)\".",
    "created_at": "2015-02-21T12:40:39Z",
    "issue": "https://github.com/sagemath/sage/issues/17194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17194#issuecomment-230945",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/cheuberg/17194-arb](https://github.com/sagemath/sagetrac-mirror/tree/u/cheuberg/17194-arb)" to "[195a6ee9c9efe97f24e806526cc3ec50c7b93363](https://github.com/sagemath/sagetrac-mirror/commit/195a6ee9c9efe97f24e806526cc3ec50c7b93363)".
