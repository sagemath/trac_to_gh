# Issue 17034: New user interface for orthogonal arrays and a .explain_construction method

archive/issues_016797.json:
```json
{
    "body": "With this branch the users do not have access to the \"designs.orthogonal_array\" function which returns int/bool/OA(/string) values. It is deprecated, and replaced with \"designs.orthogonal_arrays.*\" function that do the same.\n\nInstead of having 3 times the same functions for MOLS and TD, I chosed to remove the arguments in those other constructors, redirecting the users toward the OA functions. I believe that it is better in the long run, as copy/pasting everything really seems pointless.\n\nAdditionally, this branch adds a *NICE* feature:\n\n```\nsage: print designs.orthogonal_arrays.explain_construction(10,151)\nFrom a projective plane of order 151\nsage: print designs.orthogonal_arrays.explain_construction(10,935)\nBrouwer's separable design construction with t=16,q=7,x=23 from:\n    Andries E. Brouwer,\n    A series of separable designs with application to pairwise orthogonal Latin squares\n    Vol. 1, n. 1, pp. 39-41,\n    European Journal of Combinatorics, 1980\n```\n\nCC:  @videlec\n\nReviewer: Vincent Delecroix\n\nAuthor: Nathann Cohen\n\nBranch: b9516b194fdbcd8ec5e17e6d251b63ef9ac3d7e8\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17034\n\n",
    "closed_at": "2014-10-07T14:23:23Z",
    "created_at": "2014-09-24T15:40:33Z",
    "labels": [
        "component: combinatorial designs"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "New user interface for orthogonal arrays and a .explain_construction method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17034",
    "user": "https://github.com/nathanncohen"
}
```
With this branch the users do not have access to the "designs.orthogonal_array" function which returns int/bool/OA(/string) values. It is deprecated, and replaced with "designs.orthogonal_arrays.*" function that do the same.

Instead of having 3 times the same functions for MOLS and TD, I chosed to remove the arguments in those other constructors, redirecting the users toward the OA functions. I believe that it is better in the long run, as copy/pasting everything really seems pointless.

Additionally, this branch adds a *NICE* feature:

```
sage: print designs.orthogonal_arrays.explain_construction(10,151)
From a projective plane of order 151
sage: print designs.orthogonal_arrays.explain_construction(10,935)
Brouwer's separable design construction with t=16,q=7,x=23 from:
    Andries E. Brouwer,
    A series of separable designs with application to pairwise orthogonal Latin squares
    Vol. 1, n. 1, pp. 39-41,
    European Journal of Combinatorics, 1980
```

CC:  @videlec

Reviewer: Vincent Delecroix

Author: Nathann Cohen

Branch: b9516b194fdbcd8ec5e17e6d251b63ef9ac3d7e8

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17034





---

archive/issue_comments_236649.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-24T15:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236649",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236650.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-24T15:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236651.json:
```json
{
    "body": "<a id='comment:3'></a>Hey,\n\nCool! I will add a look ASAP.\n\nVincent",
    "created_at": "2014-09-24T16:26:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236651",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Hey,

Cool! I will add a look ASAP.

Vincent



---

archive/issue_comments_236652.json:
```json
{
    "body": "<a id='comment:4'></a>Hello,\n\nI like much better the interface now!\n\nIn `OA_build` the argument `resolvable` is not used (and not tested).\n\nWhy do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?\n\nVincent",
    "created_at": "2014-10-03T15:26:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236652",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hello,

I like much better the interface now!

In `OA_build` the argument `resolvable` is not used (and not tested).

Why do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?

Vincent



---

archive/issue_comments_236653.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-03T15:26:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236653",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_236654.json:
```json
{
    "body": "<a id='comment:5'></a>Yo !\n\n> I like much better the interface now!\n\n\nWell, I have a lot of things to write when this will be reviewed. Like the functions to get all n such that there exists an `OA(k,n)`, and stuff for incomplete orthogonal arrays too that I need for yet other applications of the Brouwer van Rees construction.\n\nAll the stuff that I cannot write when everything is done through the same function.\n \n> In `OA_build` the argument `resolvable` is not used (and not tested).\n\n\nOh. Right. That's because I had created a \"build_resolvable\" function at some point in the interface, and did not add it in the end.\n\n> Why do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?\n\n\nIt depends on you. I hate the very principle of backward compatibility, but that's why it is there, because the guys who call `designs.orthogonal_array` and will persist in doing so for a year even if it displays a warning need to be able to call it anyway, or so I am told.\n\nWhen this thing will not be deprecated anymore this will only be internal code and we will be allowed to remove whatever we want whenever we want.\n\nNathann",
    "created_at": "2014-10-03T15:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236654",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>Yo !

> I like much better the interface now!


Well, I have a lot of things to write when this will be reviewed. Like the functions to get all n such that there exists an `OA(k,n)`, and stuff for incomplete orthogonal arrays too that I need for yet other applications of the Brouwer van Rees construction.

All the stuff that I cannot write when everything is done through the same function.
 
> In `OA_build` the argument `resolvable` is not used (and not tested).


Oh. Right. That's because I had created a "build_resolvable" function at some point in the interface, and did not add it in the end.

> Why do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?


It depends on you. I hate the very principle of backward compatibility, but that's why it is there, because the guys who call `designs.orthogonal_array` and will persist in doing so for a year even if it displays a warning need to be able to call it anyway, or so I am told.

When this thing will not be deprecated anymore this will only be internal code and we will be allowed to remove whatever we want whenever we want.

Nathann



---

archive/issue_comments_236655.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 ncohen]:\n> > Why do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?\n\n> \n> It depends on you. I hate the very principle of backward compatibility, but that's why it is there, because the guys who call `designs.orthogonal_array` and will persist in doing so for a year even if it displays a warning need to be able to call it anyway, or so I am told.\n> \n> When this thing will not be deprecated anymore this will only be internal code and we will be allowed to remove whatever we want whenever we want.\n\n\nI see. Following the deprecation rules, the code will not be deleted before sage 6.5. And at that time we might have forget about this! What do you think about an extra deprecation there?\n\nVincent",
    "created_at": "2014-10-03T15:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236655",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>Replying to [comment:5 ncohen]:
> > Why do you still allow `k=None` in the function `orthogonal_array`? It would be simpler/cleaner if it was only managed by `largest_available`. No?

> 
> It depends on you. I hate the very principle of backward compatibility, but that's why it is there, because the guys who call `designs.orthogonal_array` and will persist in doing so for a year even if it displays a warning need to be able to call it anyway, or so I am told.
> 
> When this thing will not be deprecated anymore this will only be internal code and we will be allowed to remove whatever we want whenever we want.


I see. Following the deprecation rules, the code will not be deleted before sage 6.5. And at that time we might have forget about this! What do you think about an extra deprecation there?

Vincent



---

archive/issue_comments_236656.json:
```json
{
    "body": "<a id='comment:7'></a>Yo !\n\n> I see. Following the deprecation rules, the code will not be deleted before sage 6.5. And at that time we might have forget about this! What do you think about an extra deprecation there?\n\n\nI do not know what you call \"extra deprecation\" but I added a note near another note about that (see commit).\n\nNathann",
    "created_at": "2014-10-03T16:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236656",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>Yo !

> I see. Following the deprecation rules, the code will not be deleted before sage 6.5. And at that time we might have forget about this! What do you think about an extra deprecation there?


I do not know what you call "extra deprecation" but I added a note near another note about that (see commit).

Nathann



---

archive/issue_comments_236657.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-10-03T16:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_236658.json:
```json
{
    "body": "<a id='comment:9'></a>Hi,\n\nI pushed a commit at `u/vdelecroix/17034`. With your version we add a very ugly documentation for\n\n```\nsage: designs.orthogonal_arrays?\n```\nI moved the examples from the function `orthogonal_array` to the class used for the tab completion.\n\nI also renamed `OATabThing` into `OAMainFunctions`... it is much more explicit.\n\nBeyond my modifications:\n- why do we have `designs.orthogonal_arrays.build` but `designs.orthogonal_arrays.exists`. It should be uniform for the presence/absence of `s`.\n- having a class `OATabThing` to imitate a module is really ugly... wouldn't it be better to create a new file `orthogonal_arrays_catalog.py` which would gather the things.\n- you wrote that you would like to remove the argument `existence` from the function `orthogonal_array`... but I really do not see how we can achieve that right now without duplication!\n\nVincent",
    "created_at": "2014-10-03T19:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236658",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Hi,

I pushed a commit at `u/vdelecroix/17034`. With your version we add a very ugly documentation for

```
sage: designs.orthogonal_arrays?
```
I moved the examples from the function `orthogonal_array` to the class used for the tab completion.

I also renamed `OATabThing` into `OAMainFunctions`... it is much more explicit.

Beyond my modifications:
- why do we have `designs.orthogonal_arrays.build` but `designs.orthogonal_arrays.exists`. It should be uniform for the presence/absence of `s`.
- having a class `OATabThing` to imitate a module is really ugly... wouldn't it be better to create a new file `orthogonal_arrays_catalog.py` which would gather the things.
- you wrote that you would like to remove the argument `existence` from the function `orthogonal_array`... but I really do not see how we can achieve that right now without duplication!

Vincent



---

archive/issue_comments_236659.json:
```json
{
    "body": "<a id='comment:10'></a>Personal pet peeve: don't use `assert` for checking user input, use proper `raise ValueError()` (or whatever exception) instead.\n\nAlso, there is this funny comment\n\n```\nNote to self: when\n```",
    "created_at": "2014-10-03T20:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236659",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Personal pet peeve: don't use `assert` for checking user input, use proper `raise ValueError()` (or whatever exception) instead.

Also, there is this funny comment

```
Note to self: when
```



---

archive/issue_comments_236660.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 jdemeyer]:\n> Also, there is this funny comment\n> \n> ```\n> Note to self: when\n> ```\n\n\nThis funny comment is removed in my commit!",
    "created_at": "2014-10-04T07:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236660",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>Replying to [comment:10 jdemeyer]:
> Also, there is this funny comment
> 
> ```
> Note to self: when
> ```


This funny comment is removed in my commit!



---

archive/issue_comments_236661.json:
```json
{
    "body": "<a id='comment:12'></a>Hello !\n\n> I pushed a commit at `u/vdelecroix/17034`. With your version we add a very ugly documentation for\n> \n> ```\n> sage: designs.orthogonal_arrays?\n> ```\n\n\nOh, True.\n\n> I moved the examples from the function `orthogonal_array` to the class used for the tab completion.\n\n\nThanks\n\n> I also renamed `OATabThing` into `OAMainFunctions`... it is much more explicit.\n\n\nI prefered mine. Those are not the 'main functions', they are the ones exposed to the user. The 'main function' is `orthogonal_array` that they don't see anymore.\n\n> Beyond my modifications:\n> - why do we have `designs.orthogonal_arrays.build` but `designs.orthogonal_arrays.exists`. It should be uniform for the presence/absence of `s`.\n\n\nAs we are only talking of english here, I do not agree. \"Build\" is an order given to Sage. As in \"Build me that orthogonal array\". While for 'exists' comes from \"An OA(k,n) exists\". In particular, you can't order something to exist. But perhaps it already exists `:-P`\n\n>  - having a class `OATabThing` to imitate a module is really ugly... wouldn't it be better to create a new file `orthogonal_arrays_catalog.py` which would gather the things.\n\n\nWell, I did that to avoid creating a new file for absolutely nothing. Otherwise it means newfile+doc module+entry in the reference manual+import the functions+import the module.\n\nHere we have a class defined with 10 lines, I found that better.\n\n>  - you wrote that you would like to remove the argument `existence` from the function `orthogonal_array`... but I really do not see how we can achieve that right now without duplication!\n\n\nOh, sorry. I will fix that in my next commit. You have no idea how many 'drafts' of this patch I wrote before deciding that it was the right way.\n\nNathann",
    "created_at": "2014-10-04T13:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236661",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>Hello !

> I pushed a commit at `u/vdelecroix/17034`. With your version we add a very ugly documentation for
> 
> ```
> sage: designs.orthogonal_arrays?
> ```


Oh, True.

> I moved the examples from the function `orthogonal_array` to the class used for the tab completion.


Thanks

> I also renamed `OATabThing` into `OAMainFunctions`... it is much more explicit.


I prefered mine. Those are not the 'main functions', they are the ones exposed to the user. The 'main function' is `orthogonal_array` that they don't see anymore.

> Beyond my modifications:
> - why do we have `designs.orthogonal_arrays.build` but `designs.orthogonal_arrays.exists`. It should be uniform for the presence/absence of `s`.


As we are only talking of english here, I do not agree. "Build" is an order given to Sage. As in "Build me that orthogonal array". While for 'exists' comes from "An OA(k,n) exists". In particular, you can't order something to exist. But perhaps it already exists `:-P`

>  - having a class `OATabThing` to imitate a module is really ugly... wouldn't it be better to create a new file `orthogonal_arrays_catalog.py` which would gather the things.


Well, I did that to avoid creating a new file for absolutely nothing. Otherwise it means newfile+doc module+entry in the reference manual+import the functions+import the module.

Here we have a class defined with 10 lines, I found that better.

>  - you wrote that you would like to remove the argument `existence` from the function `orthogonal_array`... but I really do not see how we can achieve that right now without duplication!


Oh, sorry. I will fix that in my next commit. You have no idea how many 'drafts' of this patch I wrote before deciding that it was the right way.

Nathann



---

archive/issue_comments_236662.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-04T13:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236663.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-04T13:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236663",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_236664.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-10-04T14:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236664",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_236665.json:
```json
{
    "body": "<a id='comment:15'></a>Hello,\n\nDoes the function `largest_available_k`, `explain_construction`, `OA_build`, `OA_exists` and `OA_is_available` are intended to be used by programmers? I guess that it is not. So Why not defining them directly as staticmethod in `OATabThing` (or `OAMainFunctions` that you dislike)... and about the name, why not `OAPublicFunctions`? These are one line functions and it would cost nothing to make them not call each other.\n\nVincent",
    "created_at": "2014-10-04T14:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236665",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Hello,

Does the function `largest_available_k`, `explain_construction`, `OA_build`, `OA_exists` and `OA_is_available` are intended to be used by programmers? I guess that it is not. So Why not defining them directly as staticmethod in `OATabThing` (or `OAMainFunctions` that you dislike)... and about the name, why not `OAPublicFunctions`? These are one line functions and it would cost nothing to make them not call each other.

Vincent



---

archive/issue_comments_236666.json:
```json
{
    "body": "<a id='comment:16'></a>For the previous remark, see the commit at `u/vdelecroix/17034`.\n\nWhat about\n\n```\nsage: designs.orthogonal_arrays.is_available(1,2)\nTraceback (most recent call last):\n...\nValueError: undefined for k<t \nsage: from sage.combinat.designs.orthogonal_arrays import is_orthogonal_array\nsage: is_orthogonal_array([[1]]*4, 1,2,2)\nTrue\n```\n\nVincent",
    "created_at": "2014-10-04T14:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236666",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>For the previous remark, see the commit at `u/vdelecroix/17034`.

What about

```
sage: designs.orthogonal_arrays.is_available(1,2)
Traceback (most recent call last):
...
ValueError: undefined for k<t 
sage: from sage.combinat.designs.orthogonal_arrays import is_orthogonal_array
sage: is_orthogonal_array([[1]]*4, 1,2,2)
True
```

Vincent



---

archive/issue_comments_236667.json:
```json
{
    "body": "<a id='comment:17'></a>Yo !\n\n> Does the function `largest_available_k`, `explain_construction`, `OA_build`, `OA_exists` and `OA_is_available` are intended to be used by programmers? I guess that it is not. So Why not defining them directly as staticmethod in `OATabThing` (or `OAMainFunctions` that you dislike)... and about the name, why not `OAPublicFunctions`?\n\n\nI really don't care about any of those points. Do it if you like, or let it stay like that.\n\nThis being said, I plan on adding new functions to \"list all 'k' such that there exists an `OA(k,n)`\", or similar functions for incomplete orthogonal arrays, and those functions may be used by both developpers and users.\n\n> These are one line functions and it would cost nothing to make them not call each other.\n\n\nWhy is it a problem if they call each other ?\n\nNathann",
    "created_at": "2014-10-04T21:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236667",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>Yo !

> Does the function `largest_available_k`, `explain_construction`, `OA_build`, `OA_exists` and `OA_is_available` are intended to be used by programmers? I guess that it is not. So Why not defining them directly as staticmethod in `OATabThing` (or `OAMainFunctions` that you dislike)... and about the name, why not `OAPublicFunctions`?


I really don't care about any of those points. Do it if you like, or let it stay like that.

This being said, I plan on adding new functions to "list all 'k' such that there exists an `OA(k,n)`", or similar functions for incomplete orthogonal arrays, and those functions may be used by both developpers and users.

> These are one line functions and it would cost nothing to make them not call each other.


Why is it a problem if they call each other ?

Nathann



---

archive/issue_comments_236668.json:
```json
{
    "body": "<a id='comment:18'></a>> For the previous remark, see the commit at `u/vdelecroix/17034`.\n\n\nOh. You already implemented it. Well let's change the branch then.\n\n> What about\n> \n> ```\n> sage: designs.orthogonal_arrays.is_available(1,2)\n> Traceback (most recent call last):\n> ...\n> ValueError: undefined for k<t \n> sage: from sage.combinat.designs.orthogonal_arrays import is_orthogonal_array\n> sage: is_orthogonal_array([[1]]*4, 1,2,2)\n> True\n> ```\n\n\nI believe that we should return a matrix filled with 0 when k<t.\n\nNathann\n\n---\nNew commits:",
    "created_at": "2014-10-04T21:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236668",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:18'></a>> For the previous remark, see the commit at `u/vdelecroix/17034`.


Oh. You already implemented it. Well let's change the branch then.

> What about
> 
> ```
> sage: designs.orthogonal_arrays.is_available(1,2)
> Traceback (most recent call last):
> ...
> ValueError: undefined for k<t 
> sage: from sage.combinat.designs.orthogonal_arrays import is_orthogonal_array
> sage: is_orthogonal_array([[1]]*4, 1,2,2)
> True
> ```


I believe that we should return a matrix filled with 0 when k<t.

Nathann

---
New commits:



---

archive/issue_comments_236669.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-10-04T21:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236669",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_236670.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:17 ncohen]:\n> This being said, I plan on adding new functions to \"list all 'k' such that there exists an `OA(k,n)`\", or similar functions for incomplete orthogonal arrays, and those functions may be used by both developpers and users.\n\n\nYou meant list all `n` I guess. Yes, that would be cool!\n\n> > These are one line functions and it would cost nothing to make them not call each other.\n\n> \n> Why is it a problem if they call each other ?\n\n\nFunction calls cost. I do not like using `OA_is_available` rather than `orthogonal_array` directly.\n\nVincent",
    "created_at": "2014-10-05T09:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236670",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>Replying to [comment:17 ncohen]:
> This being said, I plan on adding new functions to "list all 'k' such that there exists an `OA(k,n)`", or similar functions for incomplete orthogonal arrays, and those functions may be used by both developpers and users.


You meant list all `n` I guess. Yes, that would be cool!

> > These are one line functions and it would cost nothing to make them not call each other.

> 
> Why is it a problem if they call each other ?


Function calls cost. I do not like using `OA_is_available` rather than `orthogonal_array` directly.

Vincent



---

archive/issue_comments_236671.json:
```json
{
    "body": "<a id='comment:20'></a>Hey,\n\nI am happy with the current version. The weird case of `k < t` does not belong to that ticket. As I did the last commit I let you put to positive review if it deserves.\n\nVincent",
    "created_at": "2014-10-05T09:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236671",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Hey,

I am happy with the current version. The weird case of `k < t` does not belong to that ticket. As I did the last commit I let you put to positive review if it deserves.

Vincent



---

archive/issue_comments_236672.json:
```json
{
    "body": "<a id='comment:21'></a>Yo !\n\n> You meant list all `n` I guess. Yes, that would be cool!\n\n\nOops, right.\n\n> Function calls cost. I do not like using `OA_is_available` rather than `orthogonal_array` directly.\n\n\nAhahah. True, but if the caching mechanism taught us anything it is that the actual functions do not matter much. Only the caching does `:-P`\n\nNathann",
    "created_at": "2014-10-05T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236672",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>Yo !

> You meant list all `n` I guess. Yes, that would be cool!


Oops, right.

> Function calls cost. I do not like using `OA_is_available` rather than `orthogonal_array` directly.


Ahahah. True, but if the caching mechanism taught us anything it is that the actual functions do not matter much. Only the caching does `:-P`

Nathann



---

archive/issue_comments_236673.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-05T09:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236673",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236674.json:
```json
{
    "body": "<a id='comment:22'></a>> I am happy with the current version. The weird case of `k < t` does not belong to that ticket. As I did the last commit I let you put to positive review if it deserves.\n\n\nRight ! `positive_review`, then. If you feel like reviewing some actual constructions today, the Brouwer-van Rees has been updated with the example you wanted `:-P`\n\nThaaaaaaaaaaaaaaanks !\n\nNathann",
    "created_at": "2014-10-05T09:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236674",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>> I am happy with the current version. The weird case of `k < t` does not belong to that ticket. As I did the last commit I let you put to positive review if it deserves.


Right ! `positive_review`, then. If you feel like reviewing some actual constructions today, the Brouwer-van Rees has been updated with the example you wanted `:-P`

Thaaaaaaaaaaaaaaanks !

Nathann



---

archive/issue_comments_236675.json:
```json
{
    "body": "<a id='comment:23'></a>This really should be a `ValueError`:\n\n```\nsage: designs.orthogonal_arrays.largest_available_k(-1)\n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\n<ipython-input-1-67d3fe8bb1f0> in <module>()\n----> 1 designs.orthogonal_arrays.largest_available_k(-Integer(1))\n\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in largest_available_k(n, t)\n    934     \"\"\"\n    935     from block_design import projective_plane\n--> 936     assert n>=0, \"n(={}) was expected to be >=0\".format(n)\n    937     assert t>=0, \"t(={}) was expected to be >=0\".format(t)\n    938     if n == 0 or n == 1:\n\nAssertionError: n(=-1) was expected to be >=0\n```\n\n(use `assert` when you *know* that a condition must be true, not to *check* whether a condition is true)",
    "created_at": "2014-10-05T12:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236675",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>This really should be a `ValueError`:

```
sage: designs.orthogonal_arrays.largest_available_k(-1)
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-67d3fe8bb1f0> in <module>()
----> 1 designs.orthogonal_arrays.largest_available_k(-Integer(1))

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in largest_available_k(n, t)
    934     """
    935     from block_design import projective_plane
--> 936     assert n>=0, "n(={}) was expected to be >=0".format(n)
    937     assert t>=0, "t(={}) was expected to be >=0".format(t)
    938     if n == 0 or n == 1:

AssertionError: n(=-1) was expected to be >=0
```

(use `assert` when you *know* that a condition must be true, not to *check* whether a condition is true)



---

archive/issue_comments_236676.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-05T12:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236676",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_236677.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-10-05T13:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236677",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_236678.json:
```json
{
    "body": "<a id='comment:24'></a>> (use `assert` when you *know* that a condition must be true, not to *check* whether a condition is true)\n\n\nWell, technically that's an 'assert' then. We added that when we noticed that some of our code was calling this function with negative values, while we *KNEW* that it had to be `>=0`\n\nNathann\n\n---\nNew commits:",
    "created_at": "2014-10-05T13:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236678",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>> (use `assert` when you *know* that a condition must be true, not to *check* whether a condition is true)


Well, technically that's an 'assert' then. We added that when we noticed that some of our code was calling this function with negative values, while we *KNEW* that it had to be `>=0`

Nathann

---
New commits:



---

archive/issue_comments_236679.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2014-10-05T13:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236679",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_236680.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-10-05T13:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_236681.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-05T15:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236681",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236682.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:24 ncohen]:\n> We added that when we noticed that some of our code was calling this function with negative values, while we *KNEW* that it had to be `>=0`\n\nThe usage of `assert` would indeed have been correct in the context of \"some of our code calling this function\". However, since this is a public function which can also be called directly, the use of an `assert` is wrong.",
    "created_at": "2014-10-05T20:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236682",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Replying to [comment:24 ncohen]:
> We added that when we noticed that some of our code was calling this function with negative values, while we *KNEW* that it had to be `>=0`

The usage of `assert` would indeed have been correct in the context of "some of our code calling this function". However, since this is a public function which can also be called directly, the use of an `assert` is wrong.



---

archive/issue_events_049573.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-05T22:39:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17034#event-49573"
}
```



---

archive/issue_comments_236683.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-05T22:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236683",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_236684.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2014-10-06T10:17:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236684",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_049574.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-06T10:17:43Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17034#event-49574"
}
```



---

archive/issue_comments_236685.json:
```json
{
    "body": "<a id='comment:29'></a>\n```\nsage -t --long --warn-long 59.4 src/sage/graphs/generators/intersection.py\n**********************************************************************\nFile \"src/sage/graphs/generators/intersection.py\", line 418, in sage.graphs.generators.intersection.OrthogonalArrayBlockGraph\nFailed example:\n    OAa = designs.orthogonal_array(k,n)\nExpected nothing\nGot:\n    doctest:1: DeprecationWarning: This function will soon be removed. Use the designs.orthogonal_arrays.* functions instead\n    See http://trac.sagemath.org/17034 for details.\n**********************************************************************\n```",
    "created_at": "2014-10-06T10:17:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236685",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>
```
sage -t --long --warn-long 59.4 src/sage/graphs/generators/intersection.py
**********************************************************************
File "src/sage/graphs/generators/intersection.py", line 418, in sage.graphs.generators.intersection.OrthogonalArrayBlockGraph
Failed example:
    OAa = designs.orthogonal_array(k,n)
Expected nothing
Got:
    doctest:1: DeprecationWarning: This function will soon be removed. Use the designs.orthogonal_arrays.* functions instead
    See http://trac.sagemath.org/17034 for details.
**********************************************************************
```



---

archive/issue_comments_236686.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2014-10-06T10:17:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236686",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_236687.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-06T11:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236687",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236688.json:
```json
{
    "body": "<a id='comment:30'></a>Sorry about that. I had forgotten that the graph code called combinatorial designs.\n\nNathann\n\n---\nNew commits:",
    "created_at": "2014-10-06T11:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236688",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:30'></a>Sorry about that. I had forgotten that the graph code called combinatorial designs.

Nathann

---
New commits:



---

archive/issue_comments_236689.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-06T11:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236689",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049575.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-07T14:23:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17034#event-49575"
}
```



---

archive/issue_comments_236690.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-07T14:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236690",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_236691.json:
```json
{
    "body": "<a id='comment:33'></a>In #22796, I'm removing some deprecation introduced by this ticket.\n\nThis ticket added this comment:\n\n```\n# When this deprecated function is removed, remove the handling of k=None in the\n# function orthogonal_arrays.orthogonal_array()\n```\n\nbut the argument `k is None` for `orthogonal_array` is still used in some doctests in `src/sage/combinat/designs/orthogonal_arrays.py`. So I will **not** do what the comment asks me to do.\n\nIn any case, the handling of `k is None` should be deprecated first before it can be removed.",
    "created_at": "2017-04-11T13:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17034#issuecomment-236691",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>In #22796, I'm removing some deprecation introduced by this ticket.

This ticket added this comment:

```
# When this deprecated function is removed, remove the handling of k=None in the
# function orthogonal_arrays.orthogonal_array()
```

but the argument `k is None` for `orthogonal_array` is still used in some doctests in `src/sage/combinat/designs/orthogonal_arrays.py`. So I will **not** do what the comment asks me to do.

In any case, the handling of `k is None` should be deprecated first before it can be removed.
