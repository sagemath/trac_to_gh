# Issue 17268: Fix removal of old versions in setuptools

archive/issues_017031.json:
```json
{
    "body": "The setuptools patch `build/pkgs/setuptools/patches/easy_install_lock.patch` from #13201 breaks the removal of old versions of packages.\n\nThis has the following effect in Sage:\nthe wrong version of sagenb is used. Even after an explicit `./sage -f sagenb` installing `sagenb-0.11.0`, Sage still thinks I want to use an older version.\n\nLooking at `local/lib/python2.7/site-packages/easy-install.pth` shows\n\n```\n[...]\n./Flask_OpenID-1.2.4-py2.7.egg\n./sagenb-0.10.7.2-py2.7.egg\n./zope.interface-4.0.5-py2.7-linux-x86_64.egg\n./sagenb-0.10.8.2-py2.7.egg\n./sagenb-0.11.0-py2.7.egg\n./itsdangerous-0.23-py2.7.egg\n[...]\n```\n\nThis leads to the following doctest failure:\n\n```\n$ ./sage -tp --long --sagenb\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2014-10-31-14-01-49-cac56b83.\nDoctesting the Sage notebook.\nSorting sources by runtime so that slower doctests are run first....\nDoctesting 51 files using 4 threads.\nsage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 69, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('A test')\nExpected:\n    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 71, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('**Testing**\\n`monospace`')\nExpected:\n    '\\n<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 73, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('`x=y`')\nExpected:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n**********************************************************************\n```\n\nKeywords: setuptools, sagenb\n\nReviewer: Volker Braun\n\nAuthor: Jeroen Demeyer\n\nBranch: db9fe89fdb525a48c9d2472f7dc648f6b3b632a1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17268\n\n",
    "closed_at": "2014-11-01T18:36:15Z",
    "created_at": "2014-10-31T13:07:32Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Fix removal of old versions in setuptools",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17268",
    "user": "https://github.com/jdemeyer"
}
```
The setuptools patch `build/pkgs/setuptools/patches/easy_install_lock.patch` from #13201 breaks the removal of old versions of packages.

This has the following effect in Sage:
the wrong version of sagenb is used. Even after an explicit `./sage -f sagenb` installing `sagenb-0.11.0`, Sage still thinks I want to use an older version.

Looking at `local/lib/python2.7/site-packages/easy-install.pth` shows

```
[...]
./Flask_OpenID-1.2.4-py2.7.egg
./sagenb-0.10.7.2-py2.7.egg
./zope.interface-4.0.5-py2.7-linux-x86_64.egg
./sagenb-0.10.8.2-py2.7.egg
./sagenb-0.11.0-py2.7.egg
./itsdangerous-0.23-py2.7.egg
[...]
```

This leads to the following doctest failure:

```
$ ./sage -tp --long --sagenb
too many failed tests, not using stored timings
Running doctests with ID 2014-10-31-14-01-49-cac56b83.
Doctesting the Sage notebook.
Sorting sources by runtime so that slower doctests are run first....
Doctesting 51 files using 4 threads.
sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 69, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('A test')
Expected:
    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 71, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('**Testing**\n`monospace`')
Expected:
    '\n<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 73, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('`x=y`')
Expected:
    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
**********************************************************************
```

Keywords: setuptools, sagenb

Reviewer: Volker Braun

Author: Jeroen Demeyer

Branch: db9fe89fdb525a48c9d2472f7dc648f6b3b632a1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17268





---

archive/issue_comments_240947.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-With sage-6.4.rc0:\n+With sage-6.4.rc0, the wrong version of sagenb is used. Even after an explicit \\`./sage -f sagenb\\` installing \\`sagenb-0.11.0\\`, Sage still thinks I want to use an older version.\n+\n+This leads to the following doctest failure:\n \n \\`\\`\\`\n $ ./sage -tp --long --sagenb\n```\n",
    "created_at": "2014-10-31T13:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240947",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
-With sage-6.4.rc0:
+With sage-6.4.rc0, the wrong version of sagenb is used. Even after an explicit \`./sage -f sagenb\` installing \`sagenb-0.11.0\`, Sage still thinks I want to use an older version.
+
+This leads to the following doctest failure:
 
 \`\`\`
 $ ./sage -tp --long --sagenb
```




---

archive/issue_comments_240948.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,54 @@\n+With sage-6.4.rc0, the wrong version of sagenb is used. Even after an explicit \\`./sage -f sagenb\\` installing \\`sagenb-0.11.0\\`, Sage still thinks I want to use an older version.\n \n+Looking at \\`local/lib/python2.7/site-packages/easy-install.pth\\` shows\n+\n+\\`\\`\\`\n+[...]\n+./Flask_OpenID-1.2.4-py2.7.egg\n+./sagenb-0.10.7.2-py2.7.egg\n+./zope.interface-4.0.5-py2.7-linux-x86_64.egg\n+./sagenb-0.10.8.2-py2.7.egg\n+./sagenb-0.11.0-py2.7.egg\n+./itsdangerous-0.23-py2.7.egg\n+[...]\n+\\`\\`\\`\n+\n+This leads to the following doctest failure:\n+\n+\\`\\`\\`\n+$ ./sage -tp --long --sagenb\n+too many failed tests, not using stored timings\n+Running doctests with ID 2014-10-31-14-01-49-cac56b83.\n+Doctesting the Sage notebook.\n+Sorting sources by runtime so that slower doctests are run first....\n+Doctesting 51 files using 4 threads.\n+sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 69, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('A test')\n+Expected:\n+    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 71, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('**Testing**\\n\\`monospace\\`')\n+Expected:\n+    '\\n<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 73, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('\\`x=y\\`')\n+Expected:\n+    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n+**********************************************************************\n+\\`\\`\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2014-10-31T13:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240948",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,54 @@
+With sage-6.4.rc0, the wrong version of sagenb is used. Even after an explicit \`./sage -f sagenb\` installing \`sagenb-0.11.0\`, Sage still thinks I want to use an older version.
 
+Looking at \`local/lib/python2.7/site-packages/easy-install.pth\` shows
+
+\`\`\`
+[...]
+./Flask_OpenID-1.2.4-py2.7.egg
+./sagenb-0.10.7.2-py2.7.egg
+./zope.interface-4.0.5-py2.7-linux-x86_64.egg
+./sagenb-0.10.8.2-py2.7.egg
+./sagenb-0.11.0-py2.7.egg
+./itsdangerous-0.23-py2.7.egg
+[...]
+\`\`\`
+
+This leads to the following doctest failure:
+
+\`\`\`
+$ ./sage -tp --long --sagenb
+too many failed tests, not using stored timings
+Running doctests with ID 2014-10-31-14-01-49-cac56b83.
+Doctesting the Sage notebook.
+Sorting sources by runtime so that slower doctests are run first....
+Doctesting 51 files using 4 threads.
+sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 69, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('A test')
+Expected:
+    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 71, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('**Testing**\n\`monospace\`')
+Expected:
+    '\n<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 73, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('\`x=y\`')
+Expected:
+    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
+**********************************************************************
+\`\`\`
 
 Comment: 1
 
```




---

archive/issue_comments_240949.json:
```json
{
    "body": "Changing keywords from \"\" to \"setuptools, sagenb\".",
    "created_at": "2014-10-31T13:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240949",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "setuptools, sagenb".



---

archive/issue_comments_240950.json:
```json
{
    "body": "Changing component from notebook to build.",
    "created_at": "2014-10-31T13:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240950",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from notebook to build.



---

archive/issue_comments_240951.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,57 @@\n+The setuptools patch \\`build/pkgs/setuptools/patches/easy_install_lock.patch\\` from #13201 breaks the removal of old versions of packages.\n \n+This has the following effect in Sage:\n+the wrong version of sagenb is used. Even after an explicit \\`./sage -f sagenb\\` installing \\`sagenb-0.11.0\\`, Sage still thinks I want to use an older version.\n+\n+Looking at \\`local/lib/python2.7/site-packages/easy-install.pth\\` shows\n+\n+\\`\\`\\`\n+[...]\n+./Flask_OpenID-1.2.4-py2.7.egg\n+./sagenb-0.10.7.2-py2.7.egg\n+./zope.interface-4.0.5-py2.7-linux-x86_64.egg\n+./sagenb-0.10.8.2-py2.7.egg\n+./sagenb-0.11.0-py2.7.egg\n+./itsdangerous-0.23-py2.7.egg\n+[...]\n+\\`\\`\\`\n+\n+This leads to the following doctest failure:\n+\n+\\`\\`\\`\n+$ ./sage -tp --long --sagenb\n+too many failed tests, not using stored timings\n+Running doctests with ID 2014-10-31-14-01-49-cac56b83.\n+Doctesting the Sage notebook.\n+Sorting sources by runtime so that slower doctests are run first....\n+Doctesting 51 files using 4 threads.\n+sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 69, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('A test')\n+Expected:\n+    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 71, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('**Testing**\\n\\`monospace\\`')\n+Expected:\n+    '\\n<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n+**********************************************************************\n+File \"local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 73, in sagenb.misc.sphinxify.sphinxify\n+Failed example:\n+    sphinxify('\\`x=y\\`')\n+Expected:\n+    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n+Got:\n+    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n+**********************************************************************\n+\\`\\`\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2014-10-31T13:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240951",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,57 @@
+The setuptools patch \`build/pkgs/setuptools/patches/easy_install_lock.patch\` from #13201 breaks the removal of old versions of packages.
 
+This has the following effect in Sage:
+the wrong version of sagenb is used. Even after an explicit \`./sage -f sagenb\` installing \`sagenb-0.11.0\`, Sage still thinks I want to use an older version.
+
+Looking at \`local/lib/python2.7/site-packages/easy-install.pth\` shows
+
+\`\`\`
+[...]
+./Flask_OpenID-1.2.4-py2.7.egg
+./sagenb-0.10.7.2-py2.7.egg
+./zope.interface-4.0.5-py2.7-linux-x86_64.egg
+./sagenb-0.10.8.2-py2.7.egg
+./sagenb-0.11.0-py2.7.egg
+./itsdangerous-0.23-py2.7.egg
+[...]
+\`\`\`
+
+This leads to the following doctest failure:
+
+\`\`\`
+$ ./sage -tp --long --sagenb
+too many failed tests, not using stored timings
+Running doctests with ID 2014-10-31-14-01-49-cac56b83.
+Doctesting the Sage notebook.
+Sorting sources by runtime so that slower doctests are run first....
+Doctesting 51 files using 4 threads.
+sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 69, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('A test')
+Expected:
+    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 71, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('**Testing**\n\`monospace\`')
+Expected:
+    '\n<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
+**********************************************************************
+File "local/lib/python2.7/site-packages/sagenb-0.10.7.2-py2.7.egg/sagenb/misc/sphinxify.py", line 73, in sagenb.misc.sphinxify.sphinxify
+Failed example:
+    sphinxify('\`x=y\`')
+Expected:
+    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
+Got:
+    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
+**********************************************************************
+\`\`\`
 
 Comment: 1
 
```




---

archive/issue_comments_240952.json:
```json
{
    "body": "<a id='comment:4'></a>maybe the best solution is to switch everything to pip and get rid of easy_install ...",
    "created_at": "2014-10-31T14:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240952",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>maybe the best solution is to switch everything to pip and get rid of easy_install ...



---

archive/issue_comments_240953.json:
```json
{
    "body": "<a id='comment:5'></a>I have a simple patch ready which simply locks `easy_install.pth` all the time.",
    "created_at": "2014-10-31T14:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240953",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>I have a simple patch ready which simply locks `easy_install.pth` all the time.



---

archive/issue_comments_240954.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2014-10-31T16:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240954",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_240955.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-31T16:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240955",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_240956.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T16:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240956",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240957.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:4 vbraun]:\n> maybe the best solution is to switch everything to pip and get rid of easy_install ...\n\nDoes `pip` not have such a race condition?",
    "created_at": "2014-10-31T16:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240957",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Replying to [comment:4 vbraun]:
> maybe the best solution is to switch everything to pip and get rid of easy_install ...

Does `pip` not have such a race condition?



---

archive/issue_comments_240958.json:
```json
{
    "body": "<a id='comment:10'></a>Afaik if you are doing it right (not using editable mode)...",
    "created_at": "2014-10-31T22:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240958",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>Afaik if you are doing it right (not using editable mode)...



---

archive/issue_comments_240959.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-31T22:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240959",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049946.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-01T18:36:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17268#event-49946"
}
```



---

archive/issue_comments_240960.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-01T18:36:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240960",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_240961.json:
```json
{
    "body": "<a id='comment:12'></a>Hmm\u2026 I'm seeing the same error messages from `sphinxify`, even without the `--sagenb` flag, and even after manually removing `./sagenb-0.10.8.2-py2.7.egg` from my `easy-install.pth`. Is this some kind of legacy from this bug here, or is this a separate bug in its own right?",
    "created_at": "2014-12-19T10:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240961",
    "user": "https://github.com/gagern"
}
```

<a id='comment:12'></a>Hmmâ€¦ I'm seeing the same error messages from `sphinxify`, even without the `--sagenb` flag, and even after manually removing `./sagenb-0.10.8.2-py2.7.egg` from my `easy-install.pth`. Is this some kind of legacy from this bug here, or is this a separate bug in its own right?



---

archive/issue_comments_240962.json:
```json
{
    "body": "<a id='comment:13'></a>Obvious question: did you run `make`?",
    "created_at": "2014-12-19T12:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240962",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Obvious question: did you run `make`?



---

archive/issue_comments_240963.json:
```json
{
    "body": "<a id='comment:14'></a>...or are you working on an old branch which doesn't have this patch?",
    "created_at": "2014-12-19T12:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240963",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>...or are you working on an old branch which doesn't have this patch?



---

archive/issue_comments_240964.json:
```json
{
    "body": "<a id='comment:15'></a>TL;DR: Found my mistake.\n\nOK, I am on 6.5.beta2 which contains this since it got merged for 6.4.rc1. I guess my main problem was the following: I encountered the problem on a feature branch, then checked whether I could reproduce on develop. To do that, I copied the command line as printed by the test suite runner, The one to execute the test from one single file:\n\n```\nsage -t --warn-long 22.0 local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py\n```\n\nI copied that line without really reading it, so I didn't realize that it was referring to the file in the version-specific sagenb directory. Then I started searching for it, found this one here, removed the old sagenb from my pth file, but the executed that same command line.\n\nI guess I had somehow assumed that the error message was due to a bug in the code, and that bug in the code had been fixed by now. The fact that the doctest itself might have been updated didn't occur to me.\n\nSorry for the noise.",
    "created_at": "2014-12-19T12:37:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17268#issuecomment-240964",
    "user": "https://github.com/gagern"
}
```

<a id='comment:15'></a>TL;DR: Found my mistake.

OK, I am on 6.5.beta2 which contains this since it got merged for 6.4.rc1. I guess my main problem was the following: I encountered the problem on a feature branch, then checked whether I could reproduce on develop. To do that, I copied the command line as printed by the test suite runner, The one to execute the test from one single file:

```
sage -t --warn-long 22.0 local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py
```

I copied that line without really reading it, so I didn't realize that it was referring to the file in the version-specific sagenb directory. Then I started searching for it, found this one here, removed the old sagenb from my pth file, but the executed that same command line.

I guess I had somehow assumed that the error message was due to a bug in the code, and that bug in the code had been fixed by now. The fact that the doctest itself might have been updated didn't occur to me.

Sorry for the noise.
