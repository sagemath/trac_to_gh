# Issue 17895: Computing all roots is faster than computing a single one

archive/issues_017658.json:
```json
{
    "body": "The following example comes from[comment:27](#comment%3A27):ticket:16964 via[comment:2](#comment%3A2):ticket:17886.\n\n```\nsage: x,y = polygens(QQ,\"x,y\")\nsage: p1 = x^5 + 6*x^4 - 42*x^3 - 142*x^2 + 467*x + 422\nsage: p2 = p1(x=(x-1)^2)\nsage: p3 = p2(x=x*y).resultant(p2,x).univariate_polynomial()\nsage: p4, = [f[0] for f in p3.factor() if f[0].degree() == 80]\nsage: ival = CIF((0.77, 0.78), (-0.08, -0.07))\nsage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]\nCPU times: user 1.43 s, sys: 195 ms, total: 1.62 s\nWall time: 1.47 s\nsage: %time z2 = QQbar.polynomial_root(p4, ival)\nCPU times: user 1min 5s, sys: 212 ms, total: 1min 5s\nWall time: 1min 5s\n```\n\nThe computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute. Which is definitely wrong, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one!\n\nThe reason for this is the time spent in the square-free decomposition (called from `sage/rings/polynomial/complex_roots.py`) which behave differently depending whether the polynomial is defined with coefficients in `QQ` or `AA`\n\n```\nsage: %time _ = p4.squarefree_decomposition()\nCPU times: user 807 \u00b5s, sys: 0 ns, total: 807 \u00b5s\nWall time: 883 \u00b5s\nsage: %time _ = p4.change_ring(AA).squarefree_decomposition()\nCPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s\nWall time: 40.1 s\n```\n(this somehow independent problem about gcd is tracked at #28199).\n\nWith the branch attached the timings become\n\n```\nsage: sage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]\nCPU times: user 411 ms, sys: 152 \u00b5s, total: 411 ms\nWall time: 410 ms\nsage: sage: %time z2 = QQbar.polynomial_root(p4, ival)\nCPU times: user 294 ms, sys: 1 \u00b5s, total: 294 ms\nWall time: 296 ms\n```\n\nCC:  @simonbrandhorst\n\nKeywords: qqbar polynomial_root roots performance\n\nBranch/Commit: [d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)\n\nReviewer: Simon Brandhorst\n\nAuthor: Vincent Delecroix\n\nDependencies: #28191\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17895\n\n",
    "closed_at": "2019-07-26T20:27:35Z",
    "created_at": "2015-03-04T22:45:27Z",
    "labels": [
        "component: number fields",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Computing all roots is faster than computing a single one",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17895",
    "user": "https://github.com/gagern"
}
```
The following example comes from[comment:27](#comment%3A27):ticket:16964 via[comment:2](#comment%3A2):ticket:17886.

```
sage: x,y = polygens(QQ,"x,y")
sage: p1 = x^5 + 6*x^4 - 42*x^3 - 142*x^2 + 467*x + 422
sage: p2 = p1(x=(x-1)^2)
sage: p3 = p2(x=x*y).resultant(p2,x).univariate_polynomial()
sage: p4, = [f[0] for f in p3.factor() if f[0].degree() == 80]
sage: ival = CIF((0.77, 0.78), (-0.08, -0.07))
sage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]
CPU times: user 1.43 s, sys: 195 ms, total: 1.62 s
Wall time: 1.47 s
sage: %time z2 = QQbar.polynomial_root(p4, ival)
CPU times: user 1min 5s, sys: 212 ms, total: 1min 5s
Wall time: 1min 5s
```

The computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute. Which is definitely wrong, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one!

The reason for this is the time spent in the square-free decomposition (called from `sage/rings/polynomial/complex_roots.py`) which behave differently depending whether the polynomial is defined with coefficients in `QQ` or `AA`

```
sage: %time _ = p4.squarefree_decomposition()
CPU times: user 807 µs, sys: 0 ns, total: 807 µs
Wall time: 883 µs
sage: %time _ = p4.change_ring(AA).squarefree_decomposition()
CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s
Wall time: 40.1 s
```
(this somehow independent problem about gcd is tracked at #28199).

With the branch attached the timings become

```
sage: sage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]
CPU times: user 411 ms, sys: 152 µs, total: 411 ms
Wall time: 410 ms
sage: sage: %time z2 = QQbar.polynomial_root(p4, ival)
CPU times: user 294 ms, sys: 1 µs, total: 294 ms
Wall time: 296 ms
```

CC:  @simonbrandhorst

Keywords: qqbar polynomial_root roots performance

Branch/Commit: [d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)

Reviewer: Simon Brandhorst

Author: Vincent Delecroix

Dependencies: #28191

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17895





---

archive/issue_comments_311061.json:
```json
{
    "body": "<a id='comment:1'></a>\nIf the interval is close enough to the root, `QQbar.polynomial_root` is fast\n\n```\nsage: z1\n0.7745442035157198? - 0.07841573936877289?*I\nsage: ival = CIF((0.77454420351571, 0.77454420351572), (-0.078415739368773, -0.078415739368772))\nsage: %time z2 = QQbar.polynomial_root(p4, ival); z2._more_precision()\nWall time: 26.7 ms\nsage: z2\n0.7745442035157198? - 0.07841573936877289?*I\n```",
    "created_at": "2015-04-25T11:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311061",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:1'></a>
If the interval is close enough to the root, `QQbar.polynomial_root` is fast

```
sage: z1
0.7745442035157198? - 0.07841573936877289?*I
sage: ival = CIF((0.77454420351571, 0.77454420351572), (-0.078415739368773, -0.078415739368772))
sage: %time z2 = QQbar.polynomial_root(p4, ival); z2._more_precision()
Wall time: 26.7 ms
sage: z2
0.7745442035157198? - 0.07841573936877289?*I
```



---

archive/issue_comments_311062.json:
```json
{
    "body": "<a id='comment:2'></a>\nFor the record, here is what profiling shows\n\n```\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n     6320   23.769    0.004   23.769    0.004 {built-in method _operator.sub}\n     6481   17.266    0.003   17.266    0.003 {built-in method _operator.mul}\n        2    0.225    0.112    0.231    0.116 {method 'roots' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}\n    16711    0.188    0.000    0.188    0.000 sets_cat.py:974(_element_constructor_from_element_class)\n       89    0.069    0.001    0.070    0.001 {sage.rings.polynomial.refine_root.refine_root}\n    15053    0.037    0.000    0.272    0.000 qqbar.py:3074(__init__)\n    15287    0.031    0.000    0.227    0.000 qqbar.py:5723(_interval_fast)\n        1    0.028    0.028   41.429   41.429 fields.py:218(_gcd_univariate_polynomial)\n    14889    0.024    0.000   41.096    0.003 qqbar.py:7736(an_binop_rational)\n    15052    0.024    0.000    0.036    0.000 qqbar.py:5653(__init__)\n    47328    0.022    0.000    0.022    0.000 {built-in method builtins.isinstance}\n    15052    0.017    0.000    0.297    0.000 qqbar.py:4712(__init__)\n     6481    0.014    0.000   17.451    0.003 qqbar.py:3240(_mul_)\n     6320    0.012    0.000   23.946    0.004 qqbar.py:3284(_sub_)\n    15449    0.009    0.000    0.009    0.000 {built-in method sage.rings.real_mpfi.RealIntervalField}\n    15287    0.006    0.000    0.008    0.000 qqbar.py:4730(_ensure_real)\n     2088    0.003    0.000    0.022    0.000 qqbar.py:3271(_add_)\n    15450    0.003    0.000    0.003    0.000 {sage.rings.complex_interval.is_ComplexIntervalFieldElement}\n  448/160    0.002    0.000    0.004    0.000 complex_field.py:389(_element_constructor_)\n        4    0.002    0.000    0.024    0.006 {method 'derivative' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}\n     2088    0.002    0.000    0.002    0.000 {built-in method _operator.add}\n      484    0.001    0.000    0.005    0.000 qqbar.py:4023(interval)\n1322/1000    0.001    0.000    0.005    0.000 complex_interval_field.py:427(__call__)\n      484    0.001    0.000    0.003    0.000 qqbar.py:3999(interval_diameter)\n      216    0.001    0.000    0.003    0.000 {method 'n' of 'sage.structure.element.Element' objects}\n        1    0.001    0.001   41.766   41.766 qqbar.py:6487(_complex_refine_interval)\n        4    0.001    0.000    0.005    0.001 {built-in method builtins.sorted}\n       81    0.001    0.000    0.001    0.000 qqbar.py:5809(invert)\n  628/324    0.001    0.000    0.005    0.000 complex_field.py:352(__call__)\n      561    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}\n      240    0.001    0.000    0.004    0.000 misc.py:5558(_key_complex_for_display)\n      144    0.001    0.000    0.001    0.000 {method '__copy__' of 'sage.categories.map.Map' objects}\n      719    0.000    0.000    0.000    0.000 {method 'diameter' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}\n       15    0.000    0.000    0.007    0.000 polynomial_element_generic.py:1052(__init__)\n  161/155    0.000    0.000    0.001    0.000 homset.py:84(Hom)\n      312    0.000    0.000    0.001    0.000 copy.py:66(copy)\n        2    0.000    0.000    0.086    0.043 complex_roots.py:47(interval_roots)\n      235    0.000    0.000    0.001    0.000 qqbar.py:3905(_more_precision)\n        1    0.000    0.000   41.757   41.757 complex_roots.py:147(complex_roots)\n      162    0.000    0.000    0.001    0.000 qqbar.py:5244(real_number)\n      161    0.000    0.000    0.001    0.000 qqbar.py:3970(interval_fast)\n     1067    0.000    0.000    0.000    0.000 complex_field.py:289(_real_field)\n       11    0.000    0.000    0.000    0.000 homset.py:582(__init__)\n       81    0.000    0.000    0.004    0.000 qqbar.py:3262(__invert__)\n      235    0.000    0.000    0.001    0.000 qqbar.py:4751(_more_precision)\n        2    0.000    0.000    0.000    0.000 polynomial_ring.py:234(__init__)\n      469    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)\n       85    0.000    0.000    0.000    0.000 qqbar.py:3386(__bool__)\n        2    0.000    0.000    0.000    0.000 complex_field.py:193(__init__)\n       82    0.000    0.000    0.001    0.000 qqbar.py:720(_element_constructor_)\n      671    0.000    0.000    0.000    0.000 complex_interval_field.py:266(prec)\n      160    0.000    0.000    0.000    0.000 {method 'real' of 'sage.rings.complex_number.ComplexNumber' objects}\n        1    0.000    0.000   41.766   41.766 qqbar.py:6320(refine_interval)\n      218    0.000    0.000    0.001    0.000 complex_field.py:91(ComplexField)\n       80    0.000    0.000    0.003    0.000 fields.py:767(inverse_of_unit)\n        1    0.000    0.000    0.001    0.001 {method 'change_ring' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}\n      216    0.000    0.000    0.000    0.000 {method 'abs' of 'sage.structure.element.RingElement' objects}\n        6    0.000    0.000    0.001    0.000 polynomial_ring_constructor.py:52(PolynomialRing)\n        1    0.000    0.000   41.436   41.436 fields.py:441(_squarefree_decomposition_univariate_polynomial)\n      160    0.000    0.000    0.000    0.000 {method 'imag' of 'sage.rings.complex_number.ComplexNumber' objects}\n        1    0.000    0.000    0.001    0.001 complex_roots.py:85(intervals_disjoint)\n       17    0.000    0.000    0.000    0.000 dynamic_class.py:127(dynamic_class)\n      160    0.000    0.000    0.000    0.000 {method 'real' of 'sage.rings.complex_interval.ComplexIntervalFieldElement' objects}\n        1    0.000    0.000    0.000    0.000 {method 'monic' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}\n        9    0.000    0.000    0.008    0.001 polynomial_ring.py:320(_element_constructor_)\n       80    0.000    0.000    0.000    0.000 complex_roots.py:118(row_disjoint)\n        6    0.000    0.000    0.000    0.000 polynomial_ring_constructor.py:677(_single_variate)\n        1    0.000    0.000    0.000    0.000 dynamic_class.py:346(dynamic_class_internal)\n      6/5    0.000    0.000    0.000    0.000 {method 'has_coerce_map_from' of 'sage.structure.parent.Parent' objects}\n      496    0.000    0.000    0.000    0.000 complex_interval_field.py:255(is_exact)\n        2    0.000    0.000    0.000    0.000 category.py:499(__repr_object_names)\n       91    0.000    0.000    0.000    0.000 weakref.py:341(__init__)\n        6    0.000    0.000    0.000    0.000 homset.py:40(RingHomset)\n      468    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}\n        8    0.000    0.000    0.000    0.000 rings.py:322(_Hom_)\n        1    0.000    0.000   41.757   41.757 qqbar.py:6060(complex_roots)\n      160    0.000    0.000    0.000    0.000 {method 'imag' of 'sage.rings.complex_interval.ComplexIntervalFieldElement' objects}\n       36    0.000    0.000    0.000    0.000 complex_roots.py:112(column_disjoint)\n       85    0.000    0.000    0.000    0.000 {method 'contains_zero' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}\n        3    0.000    0.000    0.000    0.000 {method '_coerce_map_via' of 'sage.structure.parent.Parent' objects}\n       97    0.000    0.000    0.000    0.000 weakref.py:336(__new__)\n        5    0.000    0.000    0.001    0.000 rings.py:845(__getitem__)\n       80    0.000    0.000    0.001    0.000 misc.py:5634(<lambda>)\n      152    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\n        8    0.000    0.000    0.000    0.000 pushout.py:817(__init__)\n       97    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x7fc5f0f21a00}\n        6    0.000    0.000    0.000    0.000 {built-in method sage.structure.category_object.normalize_names}\n      333    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n      155    0.000    0.000    0.000    0.000 homset.py:1174(domain)\n      318    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}\n        5    0.000    0.000    0.000    0.000 polynomial_ring.py:661(_coerce_map_from_)\n      306    0.000    0.000    0.000    0.000 complex_field.py:43(late_import)\n        1    0.000    0.000   41.768   41.768 {built-in method builtins.exec}\n        1    0.000    0.000    0.000    0.000 qqbar.py:6545(<listcomp>)\n      144    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfr.RealNumber' objects}\n        5    0.000    0.000    0.000    0.000 {method 'coerce_map_from' of 'sage.structure.parent.Parent' objects}\n        2    0.000    0.000    0.000    0.000 polynomial_singular_interface.py:355(can_convert_to_singular)\n        4    0.000    0.000    0.000    0.000 {method '_populate_coercion_lists_' of 'sage.structure.parent.Parent' objects}\n      162    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfr.RealField_class' objects}\n        3    0.000    0.000    0.000    0.000 complex_field.py:431(_coerce_map_from_)\n        1    0.000    0.000    0.000    0.000 sequence.py:80(Sequence)\n        8    0.000    0.000    0.000    0.000 polynomial_ring.py:628(construction)\n        2    0.000    0.000    0.000    0.000 polynomial_ring.py:1650(__init__)\n        3    0.000    0.000    0.000    0.000 rational_field.py:349(_coerce_map_from_)\n       16    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:416(parent)\n        1    0.000    0.000   41.768   41.768 <string>:1(<module>)\n        1    0.000    0.000    0.000    0.000 qqbar.py:6533(<listcomp>)\n      146    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}\n      200    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n        2    0.000    0.000    0.000    0.000 polynomial_ring.py:1826(__init__)\n        4    0.000    0.000    0.000    0.000 polynomial_ring_constructor.py:672(_save_in_cache)\n      155    0.000    0.000    0.000    0.000 homset.py:1189(codomain)\n      149    0.000    0.000    0.000    0.000 copy.py:111(_copy_immutable)\n        2    0.000    0.000    0.000    0.000 category.py:525(_repr_object_names)\n        1    0.000    0.000   41.757   41.757 qqbar.py:6060(complex_roots)\n        1    0.000    0.000   41.768   41.768 qqbar.py:6171(__init__)\n        1    0.000    0.000   41.436   41.436 {method 'squarefree_decomposition' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}\n        1    0.000    0.000   41.768   41.768 qqbar.py:1361(polynomial_root)\n        1    0.000    0.000   41.757   41.757 qqbar.py:6637(_complex_isolate_interval)\n```",
    "created_at": "2019-07-14T20:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311062",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
For the record, here is what profiling shows

```
   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     6320   23.769    0.004   23.769    0.004 {built-in method _operator.sub}
     6481   17.266    0.003   17.266    0.003 {built-in method _operator.mul}
        2    0.225    0.112    0.231    0.116 {method 'roots' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}
    16711    0.188    0.000    0.188    0.000 sets_cat.py:974(_element_constructor_from_element_class)
       89    0.069    0.001    0.070    0.001 {sage.rings.polynomial.refine_root.refine_root}
    15053    0.037    0.000    0.272    0.000 qqbar.py:3074(__init__)
    15287    0.031    0.000    0.227    0.000 qqbar.py:5723(_interval_fast)
        1    0.028    0.028   41.429   41.429 fields.py:218(_gcd_univariate_polynomial)
    14889    0.024    0.000   41.096    0.003 qqbar.py:7736(an_binop_rational)
    15052    0.024    0.000    0.036    0.000 qqbar.py:5653(__init__)
    47328    0.022    0.000    0.022    0.000 {built-in method builtins.isinstance}
    15052    0.017    0.000    0.297    0.000 qqbar.py:4712(__init__)
     6481    0.014    0.000   17.451    0.003 qqbar.py:3240(_mul_)
     6320    0.012    0.000   23.946    0.004 qqbar.py:3284(_sub_)
    15449    0.009    0.000    0.009    0.000 {built-in method sage.rings.real_mpfi.RealIntervalField}
    15287    0.006    0.000    0.008    0.000 qqbar.py:4730(_ensure_real)
     2088    0.003    0.000    0.022    0.000 qqbar.py:3271(_add_)
    15450    0.003    0.000    0.003    0.000 {sage.rings.complex_interval.is_ComplexIntervalFieldElement}
  448/160    0.002    0.000    0.004    0.000 complex_field.py:389(_element_constructor_)
        4    0.002    0.000    0.024    0.006 {method 'derivative' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}
     2088    0.002    0.000    0.002    0.000 {built-in method _operator.add}
      484    0.001    0.000    0.005    0.000 qqbar.py:4023(interval)
1322/1000    0.001    0.000    0.005    0.000 complex_interval_field.py:427(__call__)
      484    0.001    0.000    0.003    0.000 qqbar.py:3999(interval_diameter)
      216    0.001    0.000    0.003    0.000 {method 'n' of 'sage.structure.element.Element' objects}
        1    0.001    0.001   41.766   41.766 qqbar.py:6487(_complex_refine_interval)
        4    0.001    0.000    0.005    0.001 {built-in method builtins.sorted}
       81    0.001    0.000    0.001    0.000 qqbar.py:5809(invert)
  628/324    0.001    0.000    0.005    0.000 complex_field.py:352(__call__)
      561    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      240    0.001    0.000    0.004    0.000 misc.py:5558(_key_complex_for_display)
      144    0.001    0.000    0.001    0.000 {method '__copy__' of 'sage.categories.map.Map' objects}
      719    0.000    0.000    0.000    0.000 {method 'diameter' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}
       15    0.000    0.000    0.007    0.000 polynomial_element_generic.py:1052(__init__)
  161/155    0.000    0.000    0.001    0.000 homset.py:84(Hom)
      312    0.000    0.000    0.001    0.000 copy.py:66(copy)
        2    0.000    0.000    0.086    0.043 complex_roots.py:47(interval_roots)
      235    0.000    0.000    0.001    0.000 qqbar.py:3905(_more_precision)
        1    0.000    0.000   41.757   41.757 complex_roots.py:147(complex_roots)
      162    0.000    0.000    0.001    0.000 qqbar.py:5244(real_number)
      161    0.000    0.000    0.001    0.000 qqbar.py:3970(interval_fast)
     1067    0.000    0.000    0.000    0.000 complex_field.py:289(_real_field)
       11    0.000    0.000    0.000    0.000 homset.py:582(__init__)
       81    0.000    0.000    0.004    0.000 qqbar.py:3262(__invert__)
      235    0.000    0.000    0.001    0.000 qqbar.py:4751(_more_precision)
        2    0.000    0.000    0.000    0.000 polynomial_ring.py:234(__init__)
      469    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
       85    0.000    0.000    0.000    0.000 qqbar.py:3386(__bool__)
        2    0.000    0.000    0.000    0.000 complex_field.py:193(__init__)
       82    0.000    0.000    0.001    0.000 qqbar.py:720(_element_constructor_)
      671    0.000    0.000    0.000    0.000 complex_interval_field.py:266(prec)
      160    0.000    0.000    0.000    0.000 {method 'real' of 'sage.rings.complex_number.ComplexNumber' objects}
        1    0.000    0.000   41.766   41.766 qqbar.py:6320(refine_interval)
      218    0.000    0.000    0.001    0.000 complex_field.py:91(ComplexField)
       80    0.000    0.000    0.003    0.000 fields.py:767(inverse_of_unit)
        1    0.000    0.000    0.001    0.001 {method 'change_ring' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}
      216    0.000    0.000    0.000    0.000 {method 'abs' of 'sage.structure.element.RingElement' objects}
        6    0.000    0.000    0.001    0.000 polynomial_ring_constructor.py:52(PolynomialRing)
        1    0.000    0.000   41.436   41.436 fields.py:441(_squarefree_decomposition_univariate_polynomial)
      160    0.000    0.000    0.000    0.000 {method 'imag' of 'sage.rings.complex_number.ComplexNumber' objects}
        1    0.000    0.000    0.001    0.001 complex_roots.py:85(intervals_disjoint)
       17    0.000    0.000    0.000    0.000 dynamic_class.py:127(dynamic_class)
      160    0.000    0.000    0.000    0.000 {method 'real' of 'sage.rings.complex_interval.ComplexIntervalFieldElement' objects}
        1    0.000    0.000    0.000    0.000 {method 'monic' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}
        9    0.000    0.000    0.008    0.001 polynomial_ring.py:320(_element_constructor_)
       80    0.000    0.000    0.000    0.000 complex_roots.py:118(row_disjoint)
        6    0.000    0.000    0.000    0.000 polynomial_ring_constructor.py:677(_single_variate)
        1    0.000    0.000    0.000    0.000 dynamic_class.py:346(dynamic_class_internal)
      6/5    0.000    0.000    0.000    0.000 {method 'has_coerce_map_from' of 'sage.structure.parent.Parent' objects}
      496    0.000    0.000    0.000    0.000 complex_interval_field.py:255(is_exact)
        2    0.000    0.000    0.000    0.000 category.py:499(__repr_object_names)
       91    0.000    0.000    0.000    0.000 weakref.py:341(__init__)
        6    0.000    0.000    0.000    0.000 homset.py:40(RingHomset)
      468    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}
        8    0.000    0.000    0.000    0.000 rings.py:322(_Hom_)
        1    0.000    0.000   41.757   41.757 qqbar.py:6060(complex_roots)
      160    0.000    0.000    0.000    0.000 {method 'imag' of 'sage.rings.complex_interval.ComplexIntervalFieldElement' objects}
       36    0.000    0.000    0.000    0.000 complex_roots.py:112(column_disjoint)
       85    0.000    0.000    0.000    0.000 {method 'contains_zero' of 'sage.rings.real_mpfi.RealIntervalFieldElement' objects}
        3    0.000    0.000    0.000    0.000 {method '_coerce_map_via' of 'sage.structure.parent.Parent' objects}
       97    0.000    0.000    0.000    0.000 weakref.py:336(__new__)
        5    0.000    0.000    0.001    0.000 rings.py:845(__getitem__)
       80    0.000    0.000    0.001    0.000 misc.py:5634(<lambda>)
      152    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
        8    0.000    0.000    0.000    0.000 pushout.py:817(__init__)
       97    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x7fc5f0f21a00}
        6    0.000    0.000    0.000    0.000 {built-in method sage.structure.category_object.normalize_names}
      333    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      155    0.000    0.000    0.000    0.000 homset.py:1174(domain)
      318    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 polynomial_ring.py:661(_coerce_map_from_)
      306    0.000    0.000    0.000    0.000 complex_field.py:43(late_import)
        1    0.000    0.000   41.768   41.768 {built-in method builtins.exec}
        1    0.000    0.000    0.000    0.000 qqbar.py:6545(<listcomp>)
      144    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfr.RealNumber' objects}
        5    0.000    0.000    0.000    0.000 {method 'coerce_map_from' of 'sage.structure.parent.Parent' objects}
        2    0.000    0.000    0.000    0.000 polynomial_singular_interface.py:355(can_convert_to_singular)
        4    0.000    0.000    0.000    0.000 {method '_populate_coercion_lists_' of 'sage.structure.parent.Parent' objects}
      162    0.000    0.000    0.000    0.000 {method 'precision' of 'sage.rings.real_mpfr.RealField_class' objects}
        3    0.000    0.000    0.000    0.000 complex_field.py:431(_coerce_map_from_)
        1    0.000    0.000    0.000    0.000 sequence.py:80(Sequence)
        8    0.000    0.000    0.000    0.000 polynomial_ring.py:628(construction)
        2    0.000    0.000    0.000    0.000 polynomial_ring.py:1650(__init__)
        3    0.000    0.000    0.000    0.000 rational_field.py:349(_coerce_map_from_)
       16    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:416(parent)
        1    0.000    0.000   41.768   41.768 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 qqbar.py:6533(<listcomp>)
      146    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 polynomial_ring.py:1826(__init__)
        4    0.000    0.000    0.000    0.000 polynomial_ring_constructor.py:672(_save_in_cache)
      155    0.000    0.000    0.000    0.000 homset.py:1189(codomain)
      149    0.000    0.000    0.000    0.000 copy.py:111(_copy_immutable)
        2    0.000    0.000    0.000    0.000 category.py:525(_repr_object_names)
        1    0.000    0.000   41.757   41.757 qqbar.py:6060(complex_roots)
        1    0.000    0.000   41.768   41.768 qqbar.py:6171(__init__)
        1    0.000    0.000   41.436   41.436 {method 'squarefree_decomposition' of 'sage.rings.polynomial.polynomial_element.Polynomial' objects}
        1    0.000    0.000   41.768   41.768 qqbar.py:1361(polynomial_root)
        1    0.000    0.000   41.757   41.757 qqbar.py:6637(_complex_isolate_interval)
```



---

archive/issue_comments_311063.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,4 +15,15 @@\n Wall time: 1min 5s\n ```\n \n-The computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute on my system. Which I find really strange, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one. Should we change `QQbar.polynomial_root` to go via the list of all roots, or is there a better solution?\n+The computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute. Which is definitely wrong, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one!\n+\n+The reason for this is the time spent in the square-free decomposition (called from `sage/rings/polynomial/complex_roots.py`) which behave differently depending whether the polynomial is defined with coefficients in `QQ` or `AA`\n+\n+```\n+sage: %time _ = p4.squarefree_decomposition()\n+CPU times: user 807 \u00b5s, sys: 0 ns, total: 807 \u00b5s\n+Wall time: 883 \u00b5s\n+sage: %time _ = p4.change_ring(AA).squarefree_decomposition()\n+CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s\n+Wall time: 40.1 s\n+```\n``````\n",
    "created_at": "2019-07-14T20:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311063",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,4 +15,15 @@
 Wall time: 1min 5s
 ```
 
-The computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute on my system. Which I find really strange, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one. Should we change `QQbar.polynomial_root` to go via the list of all roots, or is there a better solution?
+The computation for `z1` works reasonably well and completes in under 2 seconds, but the one for `z2` takes over a minute. Which is definitely wrong, since computing all roots and then choosing the right one should be *more* work, not *less* than just computing a single one!
+
+The reason for this is the time spent in the square-free decomposition (called from `sage/rings/polynomial/complex_roots.py`) which behave differently depending whether the polynomial is defined with coefficients in `QQ` or `AA`
+
+```
+sage: %time _ = p4.squarefree_decomposition()
+CPU times: user 807 µs, sys: 0 ns, total: 807 µs
+Wall time: 883 µs
+sage: %time _ = p4.change_ring(AA).squarefree_decomposition()
+CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s
+Wall time: 40.1 s
+```
``````




---

archive/issue_comments_311064.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-14T21:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311064",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_events_057956.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-07-14T21:33:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17895#event-57956"
}
```



---

archive/issue_comments_311065.json:
```json
{
    "body": "Commit: [2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)",
    "created_at": "2019-07-14T21:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311065",
    "user": "https://github.com/videlec"
}
```

Commit: [2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)



---

archive/issue_comments_311066.json:
```json
{
    "body": "Branch: [u/vdelecroix/17895](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17895)",
    "created_at": "2019-07-14T21:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311066",
    "user": "https://github.com/videlec"
}
```

Branch: [u/vdelecroix/17895](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17895)



---

archive/issue_comments_311067.json:
```json
{
    "body": "Author: Vincent Delecroix",
    "created_at": "2019-07-14T21:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311067",
    "user": "https://github.com/videlec"
}
```

Author: Vincent Delecroix



---

archive/issue_comments_311068.json:
```json
{
    "body": "<a id='comment:4'></a>\nWith the change in the branch, timings go back to normal! Though, I have some strange doctest failures in `qqbar.py`. Before trying to understand them I would like to see if I did break anything else. So I am just waiting for a more complete patchbot report.\n\n---\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[3893ba3](https://github.com/sagemath/sagetrac-mirror/commit/3893ba32857087390aba75e34772293bbc2ebf2f)|`rewrite root refinement in qqbar`|\n|[2984ecb](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)|`allow rational polys in AlgebraicPolynomialTracker`|",
    "created_at": "2019-07-14T21:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311068",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
With the change in the branch, timings go back to normal! Though, I have some strange doctest failures in `qqbar.py`. Before trying to understand them I would like to see if I did break anything else. So I am just waiting for a more complete patchbot report.

---
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[3893ba3](https://github.com/sagemath/sagetrac-mirror/commit/3893ba32857087390aba75e34772293bbc2ebf2f)|`rewrite root refinement in qqbar`|
|[2984ecb](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)|`allow rational polys in AlgebraicPolynomialTracker`|



---

archive/issue_comments_311069.json:
```json
{
    "body": "Dependencies: #28191",
    "created_at": "2019-07-14T21:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311069",
    "user": "https://github.com/videlec"
}
```

Dependencies: #28191



---

archive/issue_comments_311070.json:
```json
{
    "body": "Changing commit from \"[2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)\" to \"[659b7a6ce931a998df29fca979772f604a78f677](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)\"",
    "created_at": "2019-07-14T21:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311070",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7](https://github.com/sagemath/sagetrac-mirror/commit/2984ecb978aca6e1f3d3926f3e4e9afbe954e3f7)" to "[659b7a6ce931a998df29fca979772f604a78f677](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)"



---

archive/issue_comments_311071.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[242a41a](https://github.com/sagemath/sagetrac-mirror/commit/242a41ae2de755bcd75bc53702dd65ea8ed70cef)|`allow rational polys in AlgebraicPolynomialTracker`|\n|[659b7a6](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)|`fix doctests in qqbar.py`|",
    "created_at": "2019-07-14T21:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311071",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[242a41a](https://github.com/sagemath/sagetrac-mirror/commit/242a41ae2de755bcd75bc53702dd65ea8ed70cef)|`allow rational polys in AlgebraicPolynomialTracker`|
|[659b7a6](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)|`fix doctests in qqbar.py`|



---

archive/issue_comments_311072.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,3 +27,14 @@\n CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s\n Wall time: 40.1 s\n ```\n+\n+With the branch attached the timings become\n+\n+```\n+sage: sage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]\n+CPU times: user 411 ms, sys: 152 \u00b5s, total: 411 ms\n+Wall time: 410 ms\n+sage: sage: %time z2 = QQbar.polynomial_root(p4, ival)\n+CPU times: user 294 ms, sys: 1 \u00b5s, total: 294 ms\n+Wall time: 296 ms\n+```\n``````\n",
    "created_at": "2019-07-14T22:03:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311072",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,3 +27,14 @@
 CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s
 Wall time: 40.1 s
 ```
+
+With the branch attached the timings become
+
+```
+sage: sage: %time z1, = [r for r in p4.roots(QQbar, False) if r in ival]
+CPU times: user 411 ms, sys: 152 µs, total: 411 ms
+Wall time: 410 ms
+sage: sage: %time z2 = QQbar.polynomial_root(p4, ival)
+CPU times: user 294 ms, sys: 1 µs, total: 294 ms
+Wall time: 296 ms
+```
``````




---

archive/issue_comments_311073.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,6 +27,7 @@\n CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s\n Wall time: 40.1 s\n ```\n+(this somehow independent problem about gcd is tracked at #28199).\n \n With the branch attached the timings become\n \n``````\n",
    "created_at": "2019-07-14T22:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311073",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,6 +27,7 @@
 CPU times: user 40.1 s, sys: 3.21 ms, total: 40.1 s
 Wall time: 40.1 s
 ```
+(this somehow independent problem about gcd is tracked at #28199).
 
 With the branch attached the timings become
 
``````




---

archive/issue_comments_311074.json:
```json
{
    "body": "Changing commit from \"[659b7a6ce931a998df29fca979772f604a78f677](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)\" to \"[49f917a3b74b3784e5ced901404b3778c94ecf92](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)\"",
    "created_at": "2019-07-14T22:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311074",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[659b7a6ce931a998df29fca979772f604a78f677](https://github.com/sagemath/sagetrac-mirror/commit/659b7a6ce931a998df29fca979772f604a78f677)" to "[49f917a3b74b3784e5ced901404b3778c94ecf92](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)"



---

archive/issue_comments_311075.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[49f917a](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)|`also handle ZZ`|",
    "created_at": "2019-07-14T22:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311075",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[49f917a](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)|`also handle ZZ`|



---

archive/issue_comments_311076.json:
```json
{
    "body": "<a id='comment:11'></a>\nready for review :-)",
    "created_at": "2019-07-15T09:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311076",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>
ready for review :-)



---

archive/issue_comments_311077.json:
```json
{
    "body": "<a id='comment:12'></a>\nseems to look good. One question:\n\nIs there a reason to hardcode `QQy` in several places?",
    "created_at": "2019-07-16T13:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311077",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:12'></a>
seems to look good. One question:

Is there a reason to hardcode `QQy` in several places?



---

archive/issue_comments_311078.json:
```json
{
    "body": "Reviewer: Simon Brandhorst",
    "created_at": "2019-07-16T13:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311078",
    "user": "https://github.com/simonbrandhorst"
}
```

Reviewer: Simon Brandhorst



---

archive/issue_comments_311079.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2019-07-16T13:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311079",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_311080.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [sbrandhorst](#comment%3A12):\n> seems to look good. One question:\n> \n> Is there a reason to hardcode `QQy` in several places?\n\n\nMainly for consistency and the fact that you don't want to multiply parents. This is an internal class, so the name of the variable does not matter from the user perspective. Before, it used to be canoncalized with a `y` (after the call to complex roots). I kept this convention.",
    "created_at": "2019-07-16T13:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311080",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Replying to [sbrandhorst](#comment%3A12):
> seems to look good. One question:
> 
> Is there a reason to hardcode `QQy` in several places?


Mainly for consistency and the fact that you don't want to multiply parents. This is an internal class, so the name of the variable does not matter from the user perspective. Before, it used to be canoncalized with a `y` (after the call to complex roots). I kept this convention.



---

archive/issue_comments_311081.json:
```json
{
    "body": "<a id='comment:15'></a>\nYou could add a doctest to show the speedup. Then I am happy.",
    "created_at": "2019-07-16T14:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311081",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:15'></a>
You could add a doctest to show the speedup. Then I am happy.



---

archive/issue_comments_311082.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[d5105b6](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)|`add a doctest for speedup`|",
    "created_at": "2019-07-16T15:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[d5105b6](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)|`add a doctest for speedup`|



---

archive/issue_comments_311083.json:
```json
{
    "body": "Changing commit from \"[49f917a3b74b3784e5ced901404b3778c94ecf92](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)\" to \"[d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)\"",
    "created_at": "2019-07-16T15:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311083",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[49f917a3b74b3784e5ced901404b3778c94ecf92](https://github.com/sagemath/sagetrac-mirror/commit/49f917a3b74b3784e5ced901404b3778c94ecf92)" to "[d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)"



---

archive/issue_comments_311084.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-07-16T15:03:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311084",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_311085.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-16T15:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311085",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_311086.json:
```json
{
    "body": "<a id='comment:19'></a>\nThank you.",
    "created_at": "2019-07-16T15:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311086",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>
Thank you.



---

archive/issue_comments_311087.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-26T20:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311087",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057957.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-26T20:27:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17895#event-57957"
}
```



---

archive/issue_comments_311088.json:
```json
{
    "body": "Changing branch from \"[u/vdelecroix/17895](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17895)\" to \"[d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)\"",
    "created_at": "2019-07-26T20:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17895#issuecomment-311088",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/vdelecroix/17895](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17895)" to "[d5105b625060d4b2a9cfe9cee4316d8b7c96ea46](https://github.com/sagemath/sagetrac-mirror/commit/d5105b625060d4b2a9cfe9cee4316d8b7c96ea46)"
