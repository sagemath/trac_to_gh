# Issue 17618: Update matplotlib so that plot_directive is less broken

archive/issues_017381.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nIn #17498, some problems appeared with the `plot_directive module` from matplotlib, in particular, the impossibility to remove the `(Source code)` link (that points nowhere) above images.\n\nWith 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.\n\nTarball:\n[http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2](http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2)\n\nCC:  @kiwifb @strogdon @kcrisman @gagern @novoselt\n\nComponent: **packages: standard**\n\nAuthor: **Thierry Monteil, Fran\u00e7ois Bissey**\n\nBranch/Commit: **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**\n\nReviewer: **Steven Trogdon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/17618_\n\n",
    "closed_at": "2015-06-23T22:34:25Z",
    "created_at": "2015-01-11T17:32:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update matplotlib so that plot_directive is less broken",
    "type": "issue",
    "updated_at": "2023-01-08T08:42:24Z",
    "url": "https://github.com/sagemath/sage/issues/17618",
    "user": "https://github.com/sagetrac-tmonteil"
}
```
<div id="comment:0"></div>

In #17498, some problems appeared with the `plot_directive module` from matplotlib, in particular, the impossibility to remove the `(Source code)` link (that points nowhere) above images.

With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.

Tarball:
[http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2](http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2)

CC:  @kiwifb @strogdon @kcrisman @gagern @novoselt

Component: **packages: standard**

Author: **Thierry Monteil, Fran√ßois Bissey**

Branch/Commit: **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**

Reviewer: **Steven Trogdon**

_Issue created by migration from https://trac.sagemath.org/ticket/17618_





---

archive/issue_events_248684.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-01-11T17:32:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248684"
}
```



---

archive/issue_events_248685.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-01-11T17:32:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248685"
}
```



---

archive/issue_events_248686.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-01-11T17:32:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248686"
}
```



---

archive/issue_events_248687.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-01-11T17:32:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248687"
}
```



---

archive/issue_comments_236948.json:
```json
{
    "body": "Branch: **[u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken)**",
    "created_at": "2015-01-12T07:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236948",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Branch: **[u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken)**



---

archive/issue_comments_236949.json:
```json
{
    "body": "Commit: **[`374eca4`](https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11)**",
    "created_at": "2015-01-12T07:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236949",
    "user": "https://github.com/kiwifb"
}
```

Commit: **[`374eca4`](https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11)**



---

archive/issue_comments_236950.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI am expecting broken doctests with matplotlib 1.4.x? Did you find any?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2fdfecf993adad1466dd6ac6ce839ded8e1b1894\"><code>2fdfecf</code></a></td><td><code>#17618 package version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef72f4b0d2d1f976787a647edfec866d3c1f7110\"><code>ef72f4b</code></a></td><td><code>#17618 remove upstream-applied patches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/188c737143b08b43098fd2f44918424b0e98aa12\"><code>188c737</code></a></td><td><code>#17618 update setup.py.patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11\"><code>374eca4</code></a></td><td><code>#17618 update SPKG.txt</code></td></tr></table>\n",
    "created_at": "2015-01-12T07:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236950",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:3" align="right">comment:3</div>

I am expecting broken doctests with matplotlib 1.4.x? Did you find any?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2fdfecf993adad1466dd6ac6ce839ded8e1b1894"><code>2fdfecf</code></a></td><td><code>#17618 package version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef72f4b0d2d1f976787a647edfec866d3c1f7110"><code>ef72f4b</code></a></td><td><code>#17618 remove upstream-applied patches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/188c737143b08b43098fd2f44918424b0e98aa12"><code>188c737</code></a></td><td><code>#17618 update setup.py.patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11"><code>374eca4</code></a></td><td><code>#17618 update SPKG.txt</code></td></tr></table>




---

archive/issue_comments_236951.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIs the tarball ready ?\n\nNathann",
    "created_at": "2015-01-12T14:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236951",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

Is the tarball ready ?

Nathann



---

archive/issue_comments_236952.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@kiwifb](#comment%3A3):\n> I am expecting broken doctests with matplotlib 1.4.x? Did you find any?\n\nI am indeed getting some `MatplotlibDeprecationWarning`\n\nReplying to [@nathanncohen](#comment%3A4):\n> Is the tarball ready ?\n\nAs explained on [this thread](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/77150), i would like to be sure to make a reproducible tarball. If you want to test for #17498, you can use the upstream tarball meanwhile (we only remove some dirs it to save space but there is no difference otherwise).",
    "created_at": "2015-01-12T15:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236952",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@kiwifb](#comment%3A3):
> I am expecting broken doctests with matplotlib 1.4.x? Did you find any?

I am indeed getting some `MatplotlibDeprecationWarning`

Replying to [@nathanncohen](#comment%3A4):
> Is the tarball ready ?

As explained on [this thread](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/77150), i would like to be sure to make a reproducible tarball. If you want to test for #17498, you can use the upstream tarball meanwhile (we only remove some dirs it to save space but there is no difference otherwise).



---

archive/issue_comments_236953.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> As explained on [this thread](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/77150), i would like to be sure to make a reproducible tarball.\n\nIt seems to be the thread on which I mentionned a workaround using \"diff -R\". I saw your answer but I did not understand it, and so I wait for the answer to the private email I sent you after that.\n\nNathann",
    "created_at": "2015-01-12T15:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236953",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

> As explained on [this thread](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/77150), i would like to be sure to make a reproducible tarball.

It seems to be the thread on which I mentionned a workaround using "diff -R". I saw your answer but I did not understand it, and so I wait for the answer to the private email I sent you after that.

Nathann



---

archive/issue_comments_236954.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere are the 13 doctest failures that appeared in a `make ptestlong`, quite a few are redundant:\n\n```\nFile \"src/doc/en/bordeaux_2008/introduction.rst\", line 75, in doc.en.bordeaux_2008.introduction\nFailed example:\n    list_plot3d(v, interpolation_type='nn')\nExpected:\n    Graphics3d Object\nGot:\n    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triangulation instead.\n    Graphics3d Object\n```\n\n```\nFile \"src/sage/graphs/generic_graph.py\", line 15636, in sage.graphs.generic_graph.GenericGraph.plot\nFailed example:\n    D.plot(edge_labels=True, color_by_label={'a':'blue', 'b':'red'}, edge_style='dashed')\nExpected:\n    Graphics object consisting of 34 graphics primitives\nGot:\n    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'\n    None\n```\n\n```\nFile \"src/sage/plot/arrow.py\", line 349, in sage.plot.arrow.Arrow._render_on_subplot\nFailed example:\n    a.save(filename=filename)\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.arrow.Arrow._render_on_subplot[11]>\", line 1, in <module>\n        a.save(filename=filename)\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 471, in wrapper\n        return func(*args, **kwds)\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 3048, in save\n        figure = self.matplotlib(**options)\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 2494, in matplotlib\n        g._render_on_subplot(subplot)\n      File \"/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/arrow.py\", line 414, in _render_on_subplot\n        class ConditionalStroke(pe._Base):\n    AttributeError: 'module' object has no attribute '_Base'\n```\n\n\n```\nFile \"src/sage/plot/arrow.py\", line 523, in sage.plot.arrow.arrow2d\nFailed example:\n    arrow2d((1, 1), (3, 3), linestyle='dashed')\nExpected:\n    Graphics object consisting of 1 graphics primitive\nGot:\n    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'\n    None\n```\n\n\n```\nFile \"src/sage/plot/arrow.py\", line 525, in sage.plot.arrow.arrow2d\nFailed example:\n    arrow2d((1, 1), (3, 3), linestyle='--')\nExpected:\n    Graphics object consisting of 1 graphics primitive\nGot:\n    None\n```\n\n\n\n```\nFile \"src/sage/plot/colors.py\", line 22, in sage.plot.colors\nFailed example:\n    sorted(colormaps)\nExpected:\n    ['Accent', 'Accent_r', 'Blues', 'Blues_r', 'BrBG', 'BrBG_r', ...]\nGot:\n    [u'Accent',\n     u'Accent_r',\n     u'Blues',\n     u'Blues_r',\n     u'BrBG',\n```\n\n\n```\nFile \"src/sage/plot/colors.py\", line 1337, in sage.plot.colors.get_cmap\nFailed example:\n    sorted(colormaps)\nExpected:\n    ['Accent', 'Accent_r', 'Blues', 'Blues_r', ...]\nGot:\n    [u'Accent',\n     u'Accent_r',\n     u'Blues',\n     u'Blues_r',\n     u'BrBG',\n     u'BrBG_r',\n```\n\n```\nFile \"src/sage/plot/colors.py\", line 1398, in sage.plot.colors.Colormaps\nFailed example:\n    sorted(colormaps)\nExpected:\n    ['Accent', 'Accent_r', 'Blues', 'Blues_r', ...]\nGot:\n    [u'Accent',\n     u'Accent_r',\n     u'Blues',\n     u'Blues_r',\n```\n\n```\nFile \"src/sage/plot/colors.py\", line 1645, in sage.plot.colors.Colormaps.__delitem__\nFailed example:\n    maps.popitem()\nExpected:\n    ('Spectral', <matplotlib.colors.LinearSegmentedColormap object at ...>)\nGot:\n    (u'Spectral', <matplotlib.colors.LinearSegmentedColormap object at 0x4afd4a0c>)\n```\n\n```\nFile \"src/sage/plot/graphics.py\", line 1091, in sage.plot.graphics.Graphics.add_primitive\nFailed example:\n    G\nExpected:\n    Graphics object consisting of 2 graphics primitives\nGot:\n    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'\n    None\n```\n\n```\nFile \"src/sage/plot/graphics.py\", line 2096, in sage.plot.graphics.Graphics.?\nFailed example:\n    p._matplotlib_tick_formatter(subplot, **d)\nExpected:\n    (<matplotlib.axes.AxesSubplot object at ...>,\n    <matplotlib.ticker.MaxNLocator object at ...>,\n    <matplotlib.ticker.MaxNLocator object at ...>,\n    <matplotlib.ticker.OldScalarFormatter object at ...>,\n    <matplotlib.ticker.OldScalarFormatter object at ...>)\nGot:\n    (<matplotlib.axes._subplots.AxesSubplot object at 0x4b8da48c>,\n     <matplotlib.ticker.MaxNLocator object at 0x4bbe3dac>,\n     <matplotlib.ticker.MaxNLocator object at 0x4bbe3f2c>,\n     <matplotlib.ticker.OldScalarFormatter object at 0x4bbe388c>,\n     <matplotlib.ticker.OldScalarFormatter object at 0x4bbe332c>)\n```\n\n```\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 90, in sage.plot.plot3d.list_plot3d.list_plot3d\nFailed example:\n    list_plot3d(m, texture='yellow', interpolation_type='nn',frame_aspect_ratio=[1,1,1/3])\nExpected:\n    Graphics3d Object\nGot:\n    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triangulation instead.\n    Graphics3d Object\n```\n\n```\nFile \"src/sage/stats/distributions/discrete_gaussian_lattice.py\", line 133, in sage.stats.distributions.discrete_gaussian_lattice.Disc\nreteGaussianDistributionLatticeSampler\nFailed example:\n    list_plot3d(l, point_list=True, interploation='nn')\nExpected:\n    Graphics3d Object\nGot:\n    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triang\nulation instead.\n    Graphics3d Object\n```",
    "created_at": "2015-01-12T19:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236954",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:7" align="right">comment:7</div>

Here are the 13 doctest failures that appeared in a `make ptestlong`, quite a few are redundant:

```
File "src/doc/en/bordeaux_2008/introduction.rst", line 75, in doc.en.bordeaux_2008.introduction
Failed example:
    list_plot3d(v, interpolation_type='nn')
Expected:
    Graphics3d Object
Got:
    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triangulation instead.
    Graphics3d Object
```

```
File "src/sage/graphs/generic_graph.py", line 15636, in sage.graphs.generic_graph.GenericGraph.plot
Failed example:
    D.plot(edge_labels=True, color_by_label={'a':'blue', 'b':'red'}, edge_style='dashed')
Expected:
    Graphics object consisting of 34 graphics primitives
Got:
    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'
    None
```

```
File "src/sage/plot/arrow.py", line 349, in sage.plot.arrow.Arrow._render_on_subplot
Failed example:
    a.save(filename=filename)
Exception raised:
    Traceback (most recent call last):
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.arrow.Arrow._render_on_subplot[11]>", line 1, in <module>
        a.save(filename=filename)
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 471, in wrapper
        return func(*args, **kwds)
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 3048, in save
        figure = self.matplotlib(**options)
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 2494, in matplotlib
        g._render_on_subplot(subplot)
      File "/opt/sagemath/sage-6.3/local/lib/python2.7/site-packages/sage/plot/arrow.py", line 414, in _render_on_subplot
        class ConditionalStroke(pe._Base):
    AttributeError: 'module' object has no attribute '_Base'
```


```
File "src/sage/plot/arrow.py", line 523, in sage.plot.arrow.arrow2d
Failed example:
    arrow2d((1, 1), (3, 3), linestyle='dashed')
Expected:
    Graphics object consisting of 1 graphics primitive
Got:
    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'
    None
```


```
File "src/sage/plot/arrow.py", line 525, in sage.plot.arrow.arrow2d
Failed example:
    arrow2d((1, 1), (3, 3), linestyle='--')
Expected:
    Graphics object consisting of 1 graphics primitive
Got:
    None
```



```
File "src/sage/plot/colors.py", line 22, in sage.plot.colors
Failed example:
    sorted(colormaps)
Expected:
    ['Accent', 'Accent_r', 'Blues', 'Blues_r', 'BrBG', 'BrBG_r', ...]
Got:
    [u'Accent',
     u'Accent_r',
     u'Blues',
     u'Blues_r',
     u'BrBG',
```


```
File "src/sage/plot/colors.py", line 1337, in sage.plot.colors.get_cmap
Failed example:
    sorted(colormaps)
Expected:
    ['Accent', 'Accent_r', 'Blues', 'Blues_r', ...]
Got:
    [u'Accent',
     u'Accent_r',
     u'Blues',
     u'Blues_r',
     u'BrBG',
     u'BrBG_r',
```

```
File "src/sage/plot/colors.py", line 1398, in sage.plot.colors.Colormaps
Failed example:
    sorted(colormaps)
Expected:
    ['Accent', 'Accent_r', 'Blues', 'Blues_r', ...]
Got:
    [u'Accent',
     u'Accent_r',
     u'Blues',
     u'Blues_r',
```

```
File "src/sage/plot/colors.py", line 1645, in sage.plot.colors.Colormaps.__delitem__
Failed example:
    maps.popitem()
Expected:
    ('Spectral', <matplotlib.colors.LinearSegmentedColormap object at ...>)
Got:
    (u'Spectral', <matplotlib.colors.LinearSegmentedColormap object at 0x4afd4a0c>)
```

```
File "src/sage/plot/graphics.py", line 1091, in sage.plot.graphics.Graphics.add_primitive
Failed example:
    G
Expected:
    Graphics object consisting of 2 graphics primitives
Got:
    doctest:239: FormatterWarning: Exception in text/plain formatter: 'module' object has no attribute '_Base'
    None
```

```
File "src/sage/plot/graphics.py", line 2096, in sage.plot.graphics.Graphics.?
Failed example:
    p._matplotlib_tick_formatter(subplot, **d)
Expected:
    (<matplotlib.axes.AxesSubplot object at ...>,
    <matplotlib.ticker.MaxNLocator object at ...>,
    <matplotlib.ticker.MaxNLocator object at ...>,
    <matplotlib.ticker.OldScalarFormatter object at ...>,
    <matplotlib.ticker.OldScalarFormatter object at ...>)
Got:
    (<matplotlib.axes._subplots.AxesSubplot object at 0x4b8da48c>,
     <matplotlib.ticker.MaxNLocator object at 0x4bbe3dac>,
     <matplotlib.ticker.MaxNLocator object at 0x4bbe3f2c>,
     <matplotlib.ticker.OldScalarFormatter object at 0x4bbe388c>,
     <matplotlib.ticker.OldScalarFormatter object at 0x4bbe332c>)
```

```
File "src/sage/plot/plot3d/list_plot3d.py", line 90, in sage.plot.plot3d.list_plot3d.list_plot3d
Failed example:
    list_plot3d(m, texture='yellow', interpolation_type='nn',frame_aspect_ratio=[1,1,1/3])
Expected:
    Graphics3d Object
Got:
    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triangulation instead.
    Graphics3d Object
```

```
File "src/sage/stats/distributions/discrete_gaussian_lattice.py", line 133, in sage.stats.distributions.discrete_gaussian_lattice.Disc
reteGaussianDistributionLatticeSampler
Failed example:
    list_plot3d(l, point_list=True, interploation='nn')
Expected:
    Graphics3d Object
Got:
    doctest:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triang
ulation instead.
    Graphics3d Object
```



---

archive/issue_comments_236955.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSome redundancy indeed. Let's see what's to be done:\n1. Add the missing \"u\" to doctest (for unicode if I am not mistaken). That's one of the easiest bit.\n2. Get rid of calls to _base in sage/plot/*\n3. Migrate from delaunay to tri.Triang\n4. Fix sage/plot/graphics.py - easy.\n5. Why no output in sage/plot/arrow.py?",
    "created_at": "2015-01-12T20:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236955",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">comment:8</div>

Some redundancy indeed. Let's see what's to be done:
1. Add the missing "u" to doctest (for unicode if I am not mistaken). That's one of the easiest bit.
2. Get rid of calls to _base in sage/plot/*
3. Migrate from delaunay to tri.Triang
4. Fix sage/plot/graphics.py - easy.
5. Why no output in sage/plot/arrow.py?



---

archive/issue_comments_236956.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nIt looks like we may be able to get away with replacing delaunay with tri.Triangulation without any other changes. Another option is to switch to scipy's delaunay.",
    "created_at": "2015-01-12T21:11:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236956",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

It looks like we may be able to get away with replacing delaunay with tri.Triangulation without any other changes. Another option is to switch to scipy's delaunay.



---

archive/issue_comments_236957.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf4b81b520e8fd4bb21881b9f05143ad9a209202\"><code>bf4b81b</code></a></td><td><code>#17618 fix bugs involving a missing _Base class in sage/plot/arrow.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12baa7f99ccd852b4f1f5bfdaf6751676fe31411\"><code>12baa7f</code></a></td><td><code>#17618 fix unicode doctest failures in colors.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab\"><code>4c6f6e1</code></a></td><td><code>#17618 fix _subplots doctest failure in plot/graphics.py</code></td></tr></table>\n",
    "created_at": "2015-01-13T18:18:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236957",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf4b81b520e8fd4bb21881b9f05143ad9a209202"><code>bf4b81b</code></a></td><td><code>#17618 fix bugs involving a missing _Base class in sage/plot/arrow.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12baa7f99ccd852b4f1f5bfdaf6751676fe31411"><code>12baa7f</code></a></td><td><code>#17618 fix unicode doctest failures in colors.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab"><code>4c6f6e1</code></a></td><td><code>#17618 fix _subplots doctest failure in plot/graphics.py</code></td></tr></table>




---

archive/issue_comments_236958.json:
```json
{
    "body": "Changed commit from **[`374eca4`](https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11)** to **[`4c6f6e1`](https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab)**",
    "created_at": "2015-01-13T18:18:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236958",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`374eca4`](https://github.com/sagemath/sagetrac-mirror/commit/374eca4c6161a7216b48ebb5ea772d62c5695f11)** to **[`4c6f6e1`](https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab)**



---

archive/issue_comments_236959.json:
```json
{
    "body": "Author: **Thierry Monteil**",
    "created_at": "2015-01-13T19:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236959",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Author: **Thierry Monteil**



---

archive/issue_comments_236960.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@kiwifb](#comment%3A9):\n> It looks like we may be able to get away with replacing delaunay with tri.Triangulation without any other changes. Another option is to switch to scipy's delaunay.\n\nA drop-in replacement does not work since they do not offer the same methods. Also, we rely on nearest neighbor interpolation which, according to [this page](https://github.com/matplotlib/matplotlib/pull/2504) seems to require installing some natgrid package, see also [this page](http://matplotlib.1069221.n5.nabble.com/Replacing-matplotlib-delaunay-natural-neighbor-interpolation-td42786.html) about removing natgrid.",
    "created_at": "2015-01-13T19:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236960",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@kiwifb](#comment%3A9):
> It looks like we may be able to get away with replacing delaunay with tri.Triangulation without any other changes. Another option is to switch to scipy's delaunay.

A drop-in replacement does not work since they do not offer the same methods. Also, we rely on nearest neighbor interpolation which, according to [this page](https://github.com/matplotlib/matplotlib/pull/2504) seems to require installing some natgrid package, see also [this page](http://matplotlib.1069221.n5.nabble.com/Replacing-matplotlib-delaunay-natural-neighbor-interpolation-td42786.html) about removing natgrid.



---

archive/issue_comments_236961.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'm not invested in this, but just be sure to check *actual pictures* for a good variety of plots...",
    "created_at": "2015-01-13T19:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236961",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:13" align="right">comment:13</div>

I'm not invested in this, but just be sure to check *actual pictures* for a good variety of plots...



---

archive/issue_comments_236962.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@kcrisman](#comment%3A13):\n> I'm not invested in this, \n\nUh, sorry for cc-ing you, `git blame` denounced you.\n\n> but just be sure to check *actual pictures* for a good variety of plots...\n\nYes, we will look at how failed doctests are visually rendered before and after the fixes.",
    "created_at": "2015-01-13T19:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236962",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@kcrisman](#comment%3A13):
> I'm not invested in this, 

Uh, sorry for cc-ing you, `git blame` denounced you.

> but just be sure to check *actual pictures* for a good variety of plots...

Yes, we will look at how failed doctests are visually rendered before and after the fixes.



---

archive/issue_comments_236963.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI, on the other hand, am very interested in this because updating matplotlib is a pre-requisite for updating numpy to 1.9.x (MPL 1.3.x won't build with numpy 1.9.x).\n\nSo if we cannot use matplotlib tri.Triangulation could we try scipy's delaunay instead?",
    "created_at": "2015-01-13T20:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236963",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

I, on the other hand, am very interested in this because updating matplotlib is a pre-requisite for updating numpy to 1.9.x (MPL 1.3.x won't build with numpy 1.9.x).

So if we cannot use matplotlib tri.Triangulation could we try scipy's delaunay instead?



---

archive/issue_comments_236964.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOK scipy doesn't offer nearest neighbour either. I think it is time to hit the list to know if there is any reason we should stick to nn. linear or cubic should make good default. I would go cubic myself as the default.",
    "created_at": "2015-01-13T23:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236964",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

OK scipy doesn't offer nearest neighbour either. I think it is time to hit the list to know if there is any reason we should stick to nn. linear or cubic should make good default. I would go cubic myself as the default.



---

archive/issue_comments_236965.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nIf no one comment on my post on sage-devel by tomorrow we just go ahead and change the default. Is this ok with you? We may need to check the documentation.",
    "created_at": "2015-01-14T20:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236965",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

If no one comment on my post on sage-devel by tomorrow we just go ahead and change the default. Is this ok with you? We may need to check the documentation.



---

archive/issue_comments_236966.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOK in the absence of comments I think we should go ahead with something.",
    "created_at": "2015-01-15T23:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236966",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

OK in the absence of comments I think we should go ahead with something.



---

archive/issue_comments_236967.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI see you didn't put up a tarball or updated the checksums so I will do it. I am testing my current changes, I am doing a build from scratch right now.",
    "created_at": "2015-01-16T00:42:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236967",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

I see you didn't put up a tarball or updated the checksums so I will do it. I am testing my current changes, I am doing a build from scratch right now.



---

archive/issue_comments_236968.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAfter changing to triangulation there are differences with what we have before but I don't know at this stage if it is better or worse. See commit.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5\"><code>8ee674d</code></a></td><td><code>Add checksum and migrate to tri.Trinagulation</code></td></tr></table>\n",
    "created_at": "2015-01-16T01:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236968",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

After changing to triangulation there are differences with what we have before but I don't know at this stage if it is better or worse. See commit.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5"><code>8ee674d</code></a></td><td><code>Add checksum and migrate to tri.Trinagulation</code></td></tr></table>




---

archive/issue_comments_236969.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken)** to **[u/fbissey/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL-1.4)**",
    "created_at": "2015-01-16T01:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236969",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_matplotlib_so_that_plot_directive_is_less_broken)** to **[u/fbissey/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL-1.4)**



---

archive/issue_comments_236970.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,5 @@\n \n With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.\n \n+Tarball:\n+[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz)\n``````\n",
    "created_at": "2015-01-16T01:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236970",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,5 @@
 
 With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.
 
+Tarball:
+[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz)
``````




---

archive/issue_comments_236971.json:
```json
{
    "body": "Changed commit from **[`4c6f6e1`](https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab)** to **[`8ee674d`](https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5)**",
    "created_at": "2015-01-16T01:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236971",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`4c6f6e1`](https://github.com/sagemath/sagetrac-mirror/commit/4c6f6e1b58d270077dc6eb6e0fdff5b85904ceab)** to **[`8ee674d`](https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5)**



---

archive/issue_comments_236972.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThere is also a section of code that was specifically to correct data that could segfault the delaunay code. Unfortunately there is no doctest so we cannot check whether we still need it or not.",
    "created_at": "2015-01-16T02:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236972",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

There is also a section of code that was specifically to correct data that could segfault the delaunay code. Unfortunately there is no doctest so we cannot check whether we still need it or not.



---

archive/issue_comments_236973.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOK for the first doctest both delaunay and triangulation are bad compared to spline... Difficult to know which one is worst but nearest neighbour wasn't involved in either.",
    "created_at": "2015-01-16T02:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236973",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

OK for the first doctest both delaunay and triangulation are bad compared to spline... Difficult to know which one is worst but nearest neighbour wasn't involved in either.



---

archive/issue_comments_236974.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI'm coming late to the game. Aside from the actual triangulation it looks like there is still\n\n```\ninterpolation_type='nn'\n```\nin `listplot_3d.py` which gives failures for me. And in `discrete_gaussian_lattice.py`\nthere is\n\n`interploation='nn'`\n\nI guess `interploation` should be `interpolation` and the `'nn'` should be something else.",
    "created_at": "2015-01-16T03:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236974",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:23" align="right">comment:23</div>

I'm coming late to the game. Aside from the actual triangulation it looks like there is still

```
interpolation_type='nn'
```
in `listplot_3d.py` which gives failures for me. And in `discrete_gaussian_lattice.py`
there is

`interploation='nn'`

I guess `interploation` should be `interpolation` and the `'nn'` should be something else.



---

archive/issue_comments_236975.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nActually with `interpolation_type='nn'` no 3D-graphic is generated at all. And changing `'nn'` to `'cubic'` I get:\n\n```\nsage -t src/sage/plot/plot3d/list_plot3d.py\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 138, in sage.plot.plot3d.list_plot3d.list_plot3d\nFailed example:\n    list_plot3d(l,interpolation_type='cubic',texture='yellow',num_points=100)\nExpected:\n    Graphics3d Object\nGot:\n    doctest:3847: UserWarning: Warning: converting a masked element to nan.\n    Graphics3d Object\n**********************************************************************\n```",
    "created_at": "2015-01-16T03:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236975",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:24" align="right">comment:24</div>

Actually with `interpolation_type='nn'` no 3D-graphic is generated at all. And changing `'nn'` to `'cubic'` I get:

```
sage -t src/sage/plot/plot3d/list_plot3d.py
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 138, in sage.plot.plot3d.list_plot3d.list_plot3d
Failed example:
    list_plot3d(l,interpolation_type='cubic',texture='yellow',num_points=100)
Expected:
    Graphics3d Object
Got:
    doctest:3847: UserWarning: Warning: converting a masked element to nan.
    Graphics3d Object
**********************************************************************
```



---

archive/issue_comments_236976.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nYes, still work in progress, I'll have to get to all these next. We'll have to explore that last warning too.",
    "created_at": "2015-01-16T05:03:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236976",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Yes, still work in progress, I'll have to get to all these next. We'll have to explore that last warning too.



---

archive/issue_comments_236977.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nHi, sorry i was out of connection those days, which is why i did not answered earlier. @kiwifb i am not sure 2 days is a sufficient delay to let people answer in such community as Sage, involving so much people, none of which working full time on it.\n\nI am not convinced yet that cubic interpolation is a suitable replacement for nearest neighborhood, both in terms of speed, meaning and visual rendering, so i guess this should be inspected further with that respect (as suggested by @kcrisman in his previous answer). I will try to work on it later in the day.\n\nI see two things:\n- the `delaunay` module of matplotlib is only deprecated for now, according to the second thread i mentioned earlier: \"This will be OK for a year or two, but eventually we will completely remove matplotlib.delaunay\", so for now it is possible to catch the deprecation warning and get time to think further. If matplotlib's upgrade is urgent because it blocks other important packages, let us better go for it than silently forget a feature.\n- If matplotlib decides to get rid of its `delaunay` module, why not incorporate it in Sage's source code, this is free software after all. We also have some similar stuff in Sage that could be used as a replacement as @kiwifb suggested with scipy. This can of course be the purpose of another ticket.",
    "created_at": "2015-01-16T07:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236977",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:26" align="right">comment:26</div>

Hi, sorry i was out of connection those days, which is why i did not answered earlier. @kiwifb i am not sure 2 days is a sufficient delay to let people answer in such community as Sage, involving so much people, none of which working full time on it.

I am not convinced yet that cubic interpolation is a suitable replacement for nearest neighborhood, both in terms of speed, meaning and visual rendering, so i guess this should be inspected further with that respect (as suggested by @kcrisman in his previous answer). I will try to work on it later in the day.

I see two things:
- the `delaunay` module of matplotlib is only deprecated for now, according to the second thread i mentioned earlier: "This will be OK for a year or two, but eventually we will completely remove matplotlib.delaunay", so for now it is possible to catch the deprecation warning and get time to think further. If matplotlib's upgrade is urgent because it blocks other important packages, let us better go for it than silently forget a feature.
- If matplotlib decides to get rid of its `delaunay` module, why not incorporate it in Sage's source code, this is free software after all. We also have some similar stuff in Sage that could be used as a replacement as @kiwifb suggested with scipy. This can of course be the purpose of another ticket.



---

archive/issue_comments_236978.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThings happen! Anyway if you want to have an answer to something that has been posted more than 24-48hours you may need to re-post again.\nAdmitly the list has been relatively quite the past week so it may not be drawn in the flow has it would normally be.\n\nWhile it is only deprecated it is only pushing the problem away in my opinion - it is a form of procrastination. \n\nI guess we don't completely loss delaunay if we want to hold to it, we can migrate to scipy, what we will lose fast, is the nearest neighbour default. scipy doesn't have it, MPL doesn't really want it, why should we have it? Are there any technical arguments for it? Also the underlying code under delaunay is changed in any case to be based on qhull, there may be difference, even in the linear if we decide to postpone.",
    "created_at": "2015-01-16T08:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236978",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

Things happen! Anyway if you want to have an answer to something that has been posted more than 24-48hours you may need to re-post again.
Admitly the list has been relatively quite the past week so it may not be drawn in the flow has it would normally be.

While it is only deprecated it is only pushing the problem away in my opinion - it is a form of procrastination. 

I guess we don't completely loss delaunay if we want to hold to it, we can migrate to scipy, what we will lose fast, is the nearest neighbour default. scipy doesn't have it, MPL doesn't really want it, why should we have it? Are there any technical arguments for it? Also the underlying code under delaunay is changed in any case to be based on qhull, there may be difference, even in the linear if we decide to postpone.



---

archive/issue_comments_236979.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nSlightly related, I've opened #17642, #17643, #17644 for numpy/scipy/sympy updates (currently, nothing to see there though).",
    "created_at": "2015-01-16T10:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236979",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:28" align="right">comment:28</div>

Slightly related, I've opened #17642, #17643, #17644 for numpy/scipy/sympy updates (currently, nothing to see there though).



---

archive/issue_comments_236980.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI may be missing something, and it may be a terminology thing, but it appears that scipy-0.15 does have nearest neighbor interpolation:\n\nhttps://github.com/scipy/scipy/blob/master/scipy/interpolate/interpolate.py\nand\nhttps://github.com/scipy/scipy/blob/master/scipy/interpolate/interpolate_wrapper.py\n\nsearch for `nearest`.",
    "created_at": "2015-01-16T19:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236980",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:29" align="right">comment:29</div>

I may be missing something, and it may be a terminology thing, but it appears that scipy-0.15 does have nearest neighbor interpolation:

https://github.com/scipy/scipy/blob/master/scipy/interpolate/interpolate.py
and
https://github.com/scipy/scipy/blob/master/scipy/interpolate/interpolate_wrapper.py

search for `nearest`.



---

archive/issue_comments_236981.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nIndeed, I thought I read that scipy didn't have it. May be delaunay doesn't have it.",
    "created_at": "2015-01-16T19:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236981",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">comment:30</div>

Indeed, I thought I read that scipy didn't have it. May be delaunay doesn't have it.



---

archive/issue_comments_236982.json:
```json
{
    "body": "Attachment: **[vectors.sobj.gz](https://github.com/sagemath/sage/files/ticket17618/vectors.sobj.gz)**\n\nAttachment: **[6.4_linear.png](https://github.com/sagemath/sage/files/ticket17618/6.4_linear.png)**",
    "created_at": "2015-01-17T17:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236982",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Attachment: **[vectors.sobj.gz](https://github.com/sagemath/sage/files/ticket17618/vectors.sobj.gz)**

Attachment: **[6.4_linear.png](https://github.com/sagemath/sage/files/ticket17618/6.4_linear.png)**



---

archive/issue_comments_236983.json:
```json
{
    "body": "Attachment: **[6.4_nn.png](https://github.com/sagemath/sage/files/ticket17618/6.4_nn.png)**",
    "created_at": "2015-01-17T17:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236983",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Attachment: **[6.4_nn.png](https://github.com/sagemath/sage/files/ticket17618/6.4_nn.png)**



---

archive/issue_comments_236984.json:
```json
{
    "body": "Attachment: **[6.5_linear.png](https://github.com/sagemath/sage/files/ticket17618/6.5_linear.png)**\n\nAttachment: **[6.5_cubic.png](https://github.com/sagemath/sage/files/ticket17618/6.5_cubic.png)**",
    "created_at": "2015-01-17T17:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236984",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Attachment: **[6.5_linear.png](https://github.com/sagemath/sage/files/ticket17618/6.5_linear.png)**

Attachment: **[6.5_cubic.png](https://github.com/sagemath/sage/files/ticket17618/6.5_cubic.png)**



---

archive/issue_comments_236985.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI did the following test to compare the new `cubic` interpolation type with the former `nn`:\n\nCreation of a common test (taken from `discrete_gaussian_lattice.py` doctest):\n\n```\nfrom sage.stats.distributions.discrete_gaussian_lattice import DiscreteGaussianDistributionLatticeSampler\nD = DiscreteGaussianDistributionLatticeSampler(identity_matrix(2), 3.0)\nS = [D() for _ in range(2^12)]\nl = [vector(v.list() + [S.count(v)]) for v in set(S)]\nsave(l, '/tmp/vectors.sobj')\n```\n\nThen, on the former 6.4:\n\n```\nsage: l = load('/tmp/vectors.sobj')\nsage: %timeit P = list_plot3d(l, interpolation_type='linear', texture=\"automatic\", point_list=True)\n100 loops, best of 3: 12.4 ms per loop\n```\n\n![](https://github.com/sagemath/sage/files/ticket17618/6.4_linear.png)\n\n```\nsage: %timeit P = list_plot3d(l, interpolation_type='nn', texture=\"automatic\", point_list=True)\n10 loops, best of 3: 29.8 ms per loop\n```\n\n![](https://github.com/sagemath/sage/files/ticket17618/6.4_nn.png)\n\n\nOn the patched 6.5.beta5:\n\n```\nsage: l = load('/tmp/vectors.sobj')\nsage: %timeit P = list_plot3d(l, interpolation_type='linear', texture=\"automatic\", point_list=True)\n100 loops, best of 3: 18.8 ms per loop\n```\n\n![](https://github.com/sagemath/sage/files/ticket17618/6.5_linear.png)\n\n\n```\nsage: %timeit P = list_plot3d(l, interpolation_type='cubic', texture=\"automatic\", point_list=True)\n1 loops, best of 3: 498 ms per loop\n```\n\n![](https://github.com/sagemath/sage/files/ticket17618/6.5_cubic.png)\n\nThe generation of the `cubic` interpolation is much (16x) slower that the `nn` interpolation, and the visual renderings are very different (`nn` looks more like a smoothed `linear` while `cubic` shows more spots at lattice points). So, i agree to add the `cubic` interpolation type, but disagree to let this replace `nn` in existing tests (too different) nor as becoming the default (too slow).",
    "created_at": "2015-01-17T17:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236985",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:31" align="right">comment:31</div>

I did the following test to compare the new `cubic` interpolation type with the former `nn`:

Creation of a common test (taken from `discrete_gaussian_lattice.py` doctest):

```
from sage.stats.distributions.discrete_gaussian_lattice import DiscreteGaussianDistributionLatticeSampler
D = DiscreteGaussianDistributionLatticeSampler(identity_matrix(2), 3.0)
S = [D() for _ in range(2^12)]
l = [vector(v.list() + [S.count(v)]) for v in set(S)]
save(l, '/tmp/vectors.sobj')
```

Then, on the former 6.4:

```
sage: l = load('/tmp/vectors.sobj')
sage: %timeit P = list_plot3d(l, interpolation_type='linear', texture="automatic", point_list=True)
100 loops, best of 3: 12.4 ms per loop
```

![](https://github.com/sagemath/sage/files/ticket17618/6.4_linear.png)

```
sage: %timeit P = list_plot3d(l, interpolation_type='nn', texture="automatic", point_list=True)
10 loops, best of 3: 29.8 ms per loop
```

![](https://github.com/sagemath/sage/files/ticket17618/6.4_nn.png)


On the patched 6.5.beta5:

```
sage: l = load('/tmp/vectors.sobj')
sage: %timeit P = list_plot3d(l, interpolation_type='linear', texture="automatic", point_list=True)
100 loops, best of 3: 18.8 ms per loop
```

![](https://github.com/sagemath/sage/files/ticket17618/6.5_linear.png)


```
sage: %timeit P = list_plot3d(l, interpolation_type='cubic', texture="automatic", point_list=True)
1 loops, best of 3: 498 ms per loop
```

![](https://github.com/sagemath/sage/files/ticket17618/6.5_cubic.png)

The generation of the `cubic` interpolation is much (16x) slower that the `nn` interpolation, and the visual renderings are very different (`nn` looks more like a smoothed `linear` while `cubic` shows more spots at lattice points). So, i agree to add the `cubic` interpolation type, but disagree to let this replace `nn` in existing tests (too different) nor as becoming the default (too slow).



---

archive/issue_comments_236986.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nIn `list_plot3d.py`, the following is more than dubious, especially if `drop_list` is not empty:\n\n```\n    x=[x[i] for i in range(len(x)) if i not in drop_list]\n    y=[y[i] for i in range(len(x)) if i not in drop_list]\n    z=[z[i] for i in range(len(x)) if i not in drop_list]\n```",
    "created_at": "2015-01-18T10:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236986",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:32" align="right">comment:32</div>

In `list_plot3d.py`, the following is more than dubious, especially if `drop_list` is not empty:

```
    x=[x[i] for i in range(len(x)) if i not in drop_list]
    y=[y[i] for i in range(len(x)) if i not in drop_list]
    z=[z[i] for i in range(len(x)) if i not in drop_list]
```



---

archive/issue_comments_236987.json:
```json
{
    "body": "Changed branch from **[u/fbissey/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL-1.4)** to **[u/tmonteil/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL-1.4)**",
    "created_at": "2015-01-18T10:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236987",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed branch from **[u/fbissey/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL-1.4)** to **[u/tmonteil/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL-1.4)**



---

archive/issue_comments_236988.json:
```json
{
    "body": "Changed commit from **[`8ee674d`](https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5)** to **[`065dc77`](https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2)**",
    "created_at": "2015-01-18T11:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236988",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`8ee674d`](https://github.com/sagemath/sagetrac-mirror/commit/8ee674d1b6e6bc2e22d7bc9f0ad9af05cce766d5)** to **[`065dc77`](https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2)**



---

archive/issue_comments_236989.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nHadn't seen your plots (not shown in email) that's cool work. I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. \n\nOn the other code that code in the generation of drop_list is a bit gauche\n\n```\nif z[i] != z[j]:\n.....\nelif z[i] == z[j]:\n    drop_list.append(j)\n```\nLike there was a third case? the elif could be replaced by else in my opinion.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b4e74ee67b855c4d738dccf401852bf2754675f\"><code>1b4e74e</code></a></td><td><code>#17618 : fix spacing (trivial)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2\"><code>065dc77</code></a></td><td><code>#17618 : fix comment 32</code></td></tr></table>\n",
    "created_at": "2015-01-18T11:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236989",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:34" align="right">comment:34</div>

Hadn't seen your plots (not shown in email) that's cool work. I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. 

On the other code that code in the generation of drop_list is a bit gauche

```
if z[i] != z[j]:
.....
elif z[i] == z[j]:
    drop_list.append(j)
```
Like there was a third case? the elif could be replaced by else in my opinion.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b4e74ee67b855c4d738dccf401852bf2754675f"><code>1b4e74e</code></a></td><td><code>#17618 : fix spacing (trivial)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2"><code>065dc77</code></a></td><td><code>#17618 : fix comment 32</code></td></tr></table>




---

archive/issue_comments_236990.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@kiwifb](#comment%3A34):\n> I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. \n\nThe problem is that, if `drop_list` is not empty, then at the first line, the list `x` is shortened (duplicates are removed), but then only a prefix of the lists `y` and `z` is dealt with (since `len(x)` decreased at the first line).\n\n> On the other code that code in the generation of drop_list is a bit gauche\n> \n> ```\n> if z[i] != z[j]:\n> .....\n> elif z[i] == z[j]:\n>     drop_list.append(j)\n> ```\n> Like there was a third case? the elif could be replaced by else in my opinion.\n\nIndeed, it would save a useless computation to just write `else`.",
    "created_at": "2015-01-18T21:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236990",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@kiwifb](#comment%3A34):
> I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. 

The problem is that, if `drop_list` is not empty, then at the first line, the list `x` is shortened (duplicates are removed), but then only a prefix of the lists `y` and `z` is dealt with (since `len(x)` decreased at the first line).

> On the other code that code in the generation of drop_list is a bit gauche
> 
> ```
> if z[i] != z[j]:
> .....
> elif z[i] == z[j]:
>     drop_list.append(j)
> ```
> Like there was a third case? the elif could be replaced by else in my opinion.

Indeed, it would save a useless computation to just write `else`.



---

archive/issue_comments_236991.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A35):\n> Replying to [@kiwifb](#comment%3A34):\n> > I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. \n> \n> \n> The problem is that, if `drop_list` is not empty, then at the first line, the list `x` is shortened (duplicates are removed), but then only a prefix of the lists `y` and `z` is dealt with (since `len(x)` decreased at the first line).\n\nGood spotting I understand what you mean now. The quick fix is to use len(y) and len(z) or a pre-set auxiliary variable as you have done some other places.",
    "created_at": "2015-01-18T21:42:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236991",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@sagetrac-tmonteil](#comment%3A35):
> Replying to [@kiwifb](#comment%3A34):
> > I don't think the stuff with drop_list is spurious. The point is to eliminate double entries. Indices are added to drop_list if the corresponding point is identical to a previous one. The code you quote builds a new set of x, y and z where each set of point is unique. 
> 
> 
> The problem is that, if `drop_list` is not empty, then at the first line, the list `x` is shortened (duplicates are removed), but then only a prefix of the lists `y` and `z` is dealt with (since `len(x)` decreased at the first line).

Good spotting I understand what you mean now. The quick fix is to use len(y) and len(z) or a pre-set auxiliary variable as you have done some other places.



---

archive/issue_comments_236992.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nOK I spent some time over the scipy documentation and I think I will try to use scipy delaunay and interpolation instead. It looks doable. There may still be some differences in rendering because the back end for delaunay is different.\nIt may take me a couple of days before getting there.",
    "created_at": "2015-01-19T00:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236992",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:37" align="right">comment:37</div>

OK I spent some time over the scipy documentation and I think I will try to use scipy delaunay and interpolation instead. It looks doable. There may still be some differences in rendering because the back end for delaunay is different.
It may take me a couple of days before getting there.



---

archive/issue_comments_236993.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@kiwifb](#comment%3A37):\n> OK I spent some time over the scipy documentation and I think I will try to use scipy delaunay and interpolation instead. It looks doable. There may still be some differences in rendering because the back end for delaunay is different.\n> It may take me a couple of days before getting there. \n\nGreat ! I will finish some cleanup of `list_plot3d.py` meanwhile.",
    "created_at": "2015-01-21T15:06:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236993",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@kiwifb](#comment%3A37):
> OK I spent some time over the scipy documentation and I think I will try to use scipy delaunay and interpolation instead. It looks doable. There may still be some differences in rendering because the back end for delaunay is different.
> It may take me a couple of days before getting there. 

Great ! I will finish some cleanup of `list_plot3d.py` meanwhile.



---

archive/issue_comments_236994.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI tried to post a comment on Tuesday but trac wouldn't let me :( so in scipy we can produce a Delaunay object and use it for linear interpolation but the nearest neighbor method cannot use a Delaunay object just a list of points. The linear interpolation can use the same kind of list of points. So I think I will give the delaunay object the hard shoulder and go directly to the list of points for both.",
    "created_at": "2015-01-21T20:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236994",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:39" align="right">comment:39</div>

I tried to post a comment on Tuesday but trac wouldn't let me :( so in scipy we can produce a Delaunay object and use it for linear interpolation but the nearest neighbor method cannot use a Delaunay object just a list of points. The linear interpolation can use the same kind of list of points. So I think I will give the delaunay object the hard shoulder and go directly to the list of points for both.



---

archive/issue_comments_236995.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@kiwifb](#comment%3A39):\n> I tried to post a comment on Tuesday but trac wouldn't let me :( so in scipy we can produce a Delaunay object and use it for linear interpolation but the nearest neighbor method cannot use a Delaunay object just a list of points. The linear interpolation can use the same kind of list of points. So I think I will give the delaunay object the hard shoulder and go directly to the list of points for both.\n\nI definitely agree with that: using Delaunay triangulations eases finding nearest neighbors, but nearest neighbors can be found without that, see also [this comment](http://matplotlib.1069221.n5.nabble.com/Replacing-matplotlib-delaunay-natural-neighbor-interpolation-td42786.html#a42796). The only loss we could have not using an underlying Delaunay triangulation should be with respect to speed (though computing Delaunay triangulation also costs, even with `qhull`). Do you plan to use `scipy.interpolate.NearestNDInterpolator` (or `scipy.interpolate.griddata`) for `nn` interpolation ? If yes, it seems to rely on `scipy.spatial.cKDTree` which seems to be a method unrelated to relying on a Delaunay triangulation, perhaps is it faster ?\n\nAlso, it could be nice to keep both matplotlib's and scipy's `linear` and `cubic` interpolations in order to compare them (both visually and in terms of speed), at least for now. Depending on that, we could give the whole job to `scipy`.",
    "created_at": "2015-01-22T11:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236995",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@kiwifb](#comment%3A39):
> I tried to post a comment on Tuesday but trac wouldn't let me :( so in scipy we can produce a Delaunay object and use it for linear interpolation but the nearest neighbor method cannot use a Delaunay object just a list of points. The linear interpolation can use the same kind of list of points. So I think I will give the delaunay object the hard shoulder and go directly to the list of points for both.

I definitely agree with that: using Delaunay triangulations eases finding nearest neighbors, but nearest neighbors can be found without that, see also [this comment](http://matplotlib.1069221.n5.nabble.com/Replacing-matplotlib-delaunay-natural-neighbor-interpolation-td42786.html#a42796). The only loss we could have not using an underlying Delaunay triangulation should be with respect to speed (though computing Delaunay triangulation also costs, even with `qhull`). Do you plan to use `scipy.interpolate.NearestNDInterpolator` (or `scipy.interpolate.griddata`) for `nn` interpolation ? If yes, it seems to rely on `scipy.spatial.cKDTree` which seems to be a method unrelated to relying on a Delaunay triangulation, perhaps is it faster ?

Also, it could be nice to keep both matplotlib's and scipy's `linear` and `cubic` interpolations in order to compare them (both visually and in terms of speed), at least for now. Depending on that, we could give the whole job to `scipy`.



---

archive/issue_comments_236996.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nDelaunay would be especially useful for speed if we were re-using it. But that's not the case.  I was planning on using scipy.interpolate.NearestNDInterpolator. I will try to put everything at first so we can test as you suggest. So there will be MPLlinear and SPlinear I will investigate using griddata too now that you suggested it.\n\nI am caught in things but hopefully I can get a decent shot at it today.",
    "created_at": "2015-01-22T19:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236996",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:41" align="right">comment:41</div>

Delaunay would be especially useful for speed if we were re-using it. But that's not the case.  I was planning on using scipy.interpolate.NearestNDInterpolator. I will try to put everything at first so we can test as you suggest. So there will be MPLlinear and SPlinear I will investigate using griddata too now that you suggested it.

I am caught in things but hopefully I can get a decent shot at it today.



---

archive/issue_comments_236997.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nOK so scipy and MPL linear interpolation look pretty much the same on screen but scipy's nn is ugly and all blocky. scipy's linear is the fastest\n\n```\nsage: %timeit P = list_plot3d(l, interpolation_type='linear', texture=\"automatic\", point_list=True)\n100 loops, best of 3: 6.6 ms per loop\nsage: %timeit P = list_plot3d(l, interpolation_type='MPLlinear', texture=\"automatic\", point_list=True)\n100 loops, best of 3: 7.71 ms per loop\nsage: %timeit P = list_plot3d(l, interpolation_type='nn', texture=\"automatic\", point_list=True)\n100 loops, best of 3: 4.15 ms per loop\n```\nThe first one is scipy's linear. nn is fast but blocky![](https://github.com/sagemath/sage/files/ticket17618/SP_nn.jpg)",
    "created_at": "2015-01-23T01:34:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236997",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:42" align="right">comment:42</div>

OK so scipy and MPL linear interpolation look pretty much the same on screen but scipy's nn is ugly and all blocky. scipy's linear is the fastest

```
sage: %timeit P = list_plot3d(l, interpolation_type='linear', texture="automatic", point_list=True)
100 loops, best of 3: 6.6 ms per loop
sage: %timeit P = list_plot3d(l, interpolation_type='MPLlinear', texture="automatic", point_list=True)
100 loops, best of 3: 7.71 ms per loop
sage: %timeit P = list_plot3d(l, interpolation_type='nn', texture="automatic", point_list=True)
100 loops, best of 3: 4.15 ms per loop
```
The first one is scipy's linear. nn is fast but blocky![](https://github.com/sagemath/sage/files/ticket17618/SP_nn.jpg)



---

archive/issue_comments_236998.json:
```json
{
    "body": "scipy nearest neighbor - sage 6.5.beta5",
    "created_at": "2015-01-23T01:35:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236998",
    "user": "https://github.com/kiwifb"
}
```

scipy nearest neighbor - sage 6.5.beta5



---

archive/issue_comments_236999.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nAttachment: **[SP_nn.jpg](https://github.com/sagemath/sage/files/ticket17618/SP_nn.jpg)**\n\nI am trying to get griddata in before posting a new branch.",
    "created_at": "2015-01-23T01:50:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-236999",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:43" align="right">comment:43</div>

Attachment: **[SP_nn.jpg](https://github.com/sagemath/sage/files/ticket17618/SP_nn.jpg)**

I am trying to get griddata in before posting a new branch.



---

archive/issue_comments_237000.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI don't think I will do griddata. griddata will output an array value for for all the x and y want at once. ParametricSurface takes a function and a list of point to evaluate your function at. The best way to plot a known list of given [x,y,z] such as generated by griddata is listplot3d. So we would have listplot3d calling listplot3d and I have no idea on how to avoid that.",
    "created_at": "2015-01-23T02:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237000",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:44" align="right">comment:44</div>

I don't think I will do griddata. griddata will output an array value for for all the x and y want at once. ParametricSurface takes a function and a list of point to evaluate your function at. The best way to plot a known list of given [x,y,z] such as generated by griddata is listplot3d. So we would have listplot3d calling listplot3d and I have no idea on how to avoid that.



---

archive/issue_comments_237001.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nHere is the stuff I got so far. Sorry for the delay - I am still thinking about the grid stuff. We may be able to do it but we'll have to use lower level drawing directives than what is used for the other plots.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8\"><code>b2c0045</code></a></td><td><code>more experiments in list_plot3d</code></td></tr></table>\n",
    "created_at": "2015-02-03T21:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237001",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:45" align="right">comment:45</div>

Here is the stuff I got so far. Sorry for the delay - I am still thinking about the grid stuff. We may be able to do it but we'll have to use lower level drawing directives than what is used for the other plots.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8"><code>b2c0045</code></a></td><td><code>more experiments in list_plot3d</code></td></tr></table>




---

archive/issue_comments_237002.json:
```json
{
    "body": "Changed commit from **[`065dc77`](https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2)** to **[`b2c0045`](https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8)**",
    "created_at": "2015-02-03T21:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237002",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`065dc77`](https://github.com/sagemath/sagetrac-mirror/commit/065dc779e98d32ec5b081680db5356df98f15ff2)** to **[`b2c0045`](https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8)**



---

archive/issue_comments_237003.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL-1.4)** to **[u/fbissey/trac17618-MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/trac17618-MPL-1.4)**",
    "created_at": "2015-02-03T21:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237003",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/tmonteil/MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL-1.4)** to **[u/fbissey/trac17618-MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/trac17618-MPL-1.4)**



---

archive/issue_comments_237004.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nMPL 1.4.3 is out and is the latest release before 2.0, Now that sage 6.5 is officially out we may want to drive that one in if we can.",
    "created_at": "2015-02-17T08:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237004",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:46" align="right">comment:46</div>

MPL 1.4.3 is out and is the latest release before 2.0, Now that sage 6.5 is officially out we may want to drive that one in if we can.



---

archive/issue_comments_237005.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThis patch has grown a lot of \"hair\" (i.e. stuff unrelated to the purpose of the ticket). To what extent are all the changes in `src/sage/plot/plot3d/list_plot3d.py` really needed?",
    "created_at": "2015-04-08T07:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237005",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:48" align="right">comment:48</div>

This patch has grown a lot of "hair" (i.e. stuff unrelated to the purpose of the ticket). To what extent are all the changes in `src/sage/plot/plot3d/list_plot3d.py` really needed?



---

archive/issue_comments_237006.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nA lot of the stuff is for testing and deciding which bits to include. I haven't really had feedback or suggestions for the last two months. Of course a first step will be to update the tarball to 1.4.3.\n\nThe problem seems to be that we cannot quite reproduce the previous stuff in aspect or speed with functions of MPL or scipy that are not deprecated.",
    "created_at": "2015-04-08T08:07:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237006",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:49" align="right">comment:49</div>

A lot of the stuff is for testing and deciding which bits to include. I haven't really had feedback or suggestions for the last two months. Of course a first step will be to update the tarball to 1.4.3.

The problem seems to be that we cannot quite reproduce the previous stuff in aspect or speed with functions of MPL or scipy that are not deprecated.



---

archive/issue_comments_237007.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nIs anything happening with this ticket? The broken 'source code' links still appear on our online doc.\n\nNathann",
    "created_at": "2015-05-25T10:35:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237007",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:51" align="right">comment:51</div>

Is anything happening with this ticket? The broken 'source code' links still appear on our online doc.

Nathann



---

archive/issue_comments_237008.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nNot lately. I or someone has to update the spkg to 1.4.3 which is the final 1.4 release of MPL before 2.0. The main problem is the deprecation of `Delaunay`, we don't have anything to replace it that match the speed or the appearance in terms of plots. We can have very good slow plotting or very fast crappy plotting but nothing quite like Delaunay and that puts people a bit off.",
    "created_at": "2015-05-25T12:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237008",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:52" align="right">comment:52</div>

Not lately. I or someone has to update the spkg to 1.4.3 which is the final 1.4 release of MPL before 2.0. The main problem is the deprecation of `Delaunay`, we don't have anything to replace it that match the speed or the appearance in terms of plots. We can have very good slow plotting or very fast crappy plotting but nothing quite like Delaunay and that puts people a bit off.



---

archive/issue_comments_237009.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\ntest, please ignore",
    "created_at": "2015-06-18T07:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237009",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:53" align="right">comment:53</div>

test, please ignore



---

archive/issue_comments_237010.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nOK we need to move this forward. I suggest and will try to do in the next few days:\n* update tarball to 1.4.3\n* use Thierry latest branch in terms of patches\n* Re-introduce Delaunay and use it as a default.\n* fix any doctest warnings due to that decision\n* correct the documentation. \"nn\" has never been \"nearest neighbour\" in the context of Delaunay, it means \"natural neighbour\" which is why the scipy \"nn\" interpolator looks different.\n\nWe'll probably need to deal with Delaunay in MPL 2.0 but there may be suitable replacement in that version.",
    "created_at": "2015-06-18T21:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237010",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:54" align="right">comment:54</div>

OK we need to move this forward. I suggest and will try to do in the next few days:
* update tarball to 1.4.3
* use Thierry latest branch in terms of patches
* Re-introduce Delaunay and use it as a default.
* fix any doctest warnings due to that decision
* correct the documentation. "nn" has never been "nearest neighbour" in the context of Delaunay, it means "natural neighbour" which is why the scipy "nn" interpolator looks different.

We'll probably need to deal with Delaunay in MPL 2.0 but there may be suitable replacement in that version.



---

archive/issue_comments_237011.json:
```json
{
    "body": "Changed branch from **[u/fbissey/trac17618-MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/trac17618-MPL-1.4)** to **[u/fbissey/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL1.4.3)**",
    "created_at": "2015-06-18T22:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237011",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/fbissey/trac17618-MPL-1.4](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/trac17618-MPL-1.4)** to **[u/fbissey/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL1.4.3)**



---

archive/issue_comments_237012.json:
```json
{
    "body": "Changed author from **Thierry Monteil** to **Thierry Monteil, Fran\u00e7ois Bissey**",
    "created_at": "2015-06-18T22:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237012",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Thierry Monteil** to **Thierry Monteil, Fran√ßois Bissey**



---

archive/issue_comments_237013.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,4 +3,4 @@\n With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.\n \n Tarball:\n-[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz)\n+[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz)\n``````\n",
    "created_at": "2015-06-18T22:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237013",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,4 +3,4 @@
 With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.
 
 Tarball:
-[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.2/matplotlib-1.4.2.tar.gz)
+[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz)
``````




---

archive/issue_comments_237014.json:
```json
{
    "body": "Changed commit from **[`b2c0045`](https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8)** to **[`b16e00b`](https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b)**",
    "created_at": "2015-06-18T22:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237014",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`b2c0045`](https://github.com/sagemath/sagetrac-mirror/commit/b2c0045d3619b225008984e7631c3abcf4f382e8)** to **[`b16e00b`](https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b)**



---

archive/issue_comments_237015.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThe current linked tarball is suitable for testing at this stage. I am preparing a slimmed down tarball as per instructions in `SPKG.txt` and will put it up when ready.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c9091d6ff06a64a1a237f2ce18886e225c85350\"><code>5c9091d</code></a></td><td><code>Merge branch 'u/tmonteil/MPL-1.4' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b\"><code>b16e00b</code></a></td><td><code>Update matplotlib to 1.4.3 replace some Delaunay calls by \"tri\". Keep Delaunay interpolations for the default \"nn\" (natural</code></td></tr></table>\n",
    "created_at": "2015-06-18T22:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237015",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:55" align="right">comment:55</div>

The current linked tarball is suitable for testing at this stage. I am preparing a slimmed down tarball as per instructions in `SPKG.txt` and will put it up when ready.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c9091d6ff06a64a1a237f2ce18886e225c85350"><code>5c9091d</code></a></td><td><code>Merge branch 'u/tmonteil/MPL-1.4' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b"><code>b16e00b</code></a></td><td><code>Update matplotlib to 1.4.3 replace some Delaunay calls by "tri". Keep Delaunay interpolations for the default "nn" (natural</code></td></tr></table>




---

archive/issue_comments_237016.json:
```json
{
    "body": "<div id=\"comment:56\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895\"><code>a62644f</code></a></td><td><code>Slim the tarball by removing images. Also commit correct version.</code></td></tr></table>\n",
    "created_at": "2015-06-18T22:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237016",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:56"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895"><code>a62644f</code></a></td><td><code>Slim the tarball by removing images. Also commit correct version.</code></td></tr></table>




---

archive/issue_comments_237017.json:
```json
{
    "body": "Changed commit from **[`b16e00b`](https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b)** to **[`a62644f`](https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895)**",
    "created_at": "2015-06-18T22:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237017",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b16e00b`](https://github.com/sagemath/sagetrac-mirror/commit/b16e00b38cf554bcd55650d95a76ea17ffb4cf1b)** to **[`a62644f`](https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895)**



---

archive/issue_comments_237018.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,4 +3,4 @@\n With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.\n \n Tarball:\n-[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz)\n+[http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2](http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2)\n``````\n",
    "created_at": "2015-06-18T22:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237018",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,4 +3,4 @@
 With 1.4.2, the `plot_include_source` option seems still broken but a new `plot_html_show_source_link` seems to work, so let us upgrade.
 
 Tarball:
-[https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz](https://downloads.sourceforge.net/project/matplotlib/matplotlib/matplotlib-1.4.3/matplotlib-1.4.3.tar.gz)
+[http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2](http://www.lmona.de/files/sage/matplotlib-1.4.3.tar.bz2)
``````




---

archive/issue_events_248688.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-06-18T22:18:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248688"
}
```



---

archive/issue_events_248689.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-06-18T22:18:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248689"
}
```



---

archive/issue_events_248690.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-06-18T22:18:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248690"
}
```



---

archive/issue_comments_237019.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReady for review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895\"><code>a62644f</code></a></td><td><code>Slim the tarball by removing images. Also commit correct version.</code></td></tr></table>\n",
    "created_at": "2015-06-18T22:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237019",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:57" align="right">comment:57</div>

Ready for review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895"><code>a62644f</code></a></td><td><code>Slim the tarball by removing images. Also commit correct version.</code></td></tr></table>




---

archive/issue_comments_237020.json:
```json
{
    "body": "Changed branch from **[u/fbissey/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL1.4.3)** to **[u/tmonteil/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL1.4.3)**",
    "created_at": "2015-06-21T13:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237020",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed branch from **[u/fbissey/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/MPL1.4.3)** to **[u/tmonteil/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL1.4.3)**



---

archive/issue_comments_237021.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nI added a `spkg-src` file to automate the tarball's trimming.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6\"><code>4612049</code></a></td><td><code>#17618 add a spkg-src file to automate tarball trimming.</code></td></tr></table>\n",
    "created_at": "2015-06-21T13:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237021",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:59" align="right">comment:59</div>

I added a `spkg-src` file to automate the tarball's trimming.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6"><code>4612049</code></a></td><td><code>#17618 add a spkg-src file to automate tarball trimming.</code></td></tr></table>




---

archive/issue_comments_237022.json:
```json
{
    "body": "Changed commit from **[`a62644f`](https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895)** to **[`4612049`](https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6)**",
    "created_at": "2015-06-21T13:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237022",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed commit from **[`a62644f`](https://github.com/sagemath/sagetrac-mirror/commit/a62644f4d11251157ce9883521d15993a3bae895)** to **[`4612049`](https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6)**



---

archive/issue_events_248691.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-21T22:01:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248691"
}
```



---

archive/issue_events_248692.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-21T22:01:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248692"
}
```



---

archive/issue_comments_237023.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nThis looks good to me and I think in the interest of moving forward with matplotlib that the approach used is the best. I too was confused with the use of `'nn'`. I'm now running doctests to make sure everything is OK. Then I'll give `positive review`. One clarifying question. Should the following typo be fixed here?\n\n```\n--- a/src/sage/stats/distributions/discrete_gaussian_lattice.py\n+++ b/src/sage/stats/distributions/discrete_gaussian_lattice.py\n@@ -132,7 +132,7 @@ class DiscreteGaussianDistributionLatticeSampler(SageObject):\n         sage: D = DiscreteGaussianDistributionLatticeSampler(identity_matrix(2), 3.0)\n         sage: S = [D() for _ in range(2^12)]\n         sage: l = [vector(v.list() + [S.count(v)]) for v in set(S)]\n-        sage: list_plot3d(l, point_list=True, interploation='nn')\n+        sage: list_plot3d(l, point_list=True, interpolation='nn')\n         Graphics3d Object\n \n     REFERENCES:\n```\nNothing on this ticket caused it but it is a typo and it appeared while searching for `'nn'`.",
    "created_at": "2015-06-21T22:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237023",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:60" align="right">comment:60</div>

This looks good to me and I think in the interest of moving forward with matplotlib that the approach used is the best. I too was confused with the use of `'nn'`. I'm now running doctests to make sure everything is OK. Then I'll give `positive review`. One clarifying question. Should the following typo be fixed here?

```
--- a/src/sage/stats/distributions/discrete_gaussian_lattice.py
+++ b/src/sage/stats/distributions/discrete_gaussian_lattice.py
@@ -132,7 +132,7 @@ class DiscreteGaussianDistributionLatticeSampler(SageObject):
         sage: D = DiscreteGaussianDistributionLatticeSampler(identity_matrix(2), 3.0)
         sage: S = [D() for _ in range(2^12)]
         sage: l = [vector(v.list() + [S.count(v)]) for v in set(S)]
-        sage: list_plot3d(l, point_list=True, interploation='nn')
+        sage: list_plot3d(l, point_list=True, interpolation='nn')
         Graphics3d Object
 
     REFERENCES:
```
Nothing on this ticket caused it but it is a typo and it appeared while searching for `'nn'`.



---

archive/issue_comments_237024.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nNow that you have posted it, yes we should and I believe it is appropriate to do it in this ticket. Thierry, would you add it on top of your last commit?",
    "created_at": "2015-06-21T22:20:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237024",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:61" align="right">comment:61</div>

Now that you have posted it, yes we should and I believe it is appropriate to do it in this ticket. Thierry, would you add it on top of your last commit?



---

archive/issue_comments_237025.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d\"><code>30fb859</code></a></td><td><code>#17618 fix typo in discrete_gaussian_lattice.py</code></td></tr></table>\n",
    "created_at": "2015-06-22T10:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237025",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d"><code>30fb859</code></a></td><td><code>#17618 fix typo in discrete_gaussian_lattice.py</code></td></tr></table>




---

archive/issue_comments_237026.json:
```json
{
    "body": "Changed commit from **[`4612049`](https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6)** to **[`30fb859`](https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d)**",
    "created_at": "2015-06-22T10:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237026",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4612049`](https://github.com/sagemath/sagetrac-mirror/commit/4612049e6faa2157c09a8f453fb37ab2b993b2f6)** to **[`30fb859`](https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d)**



---

archive/issue_events_248693.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-06-22T10:28:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248693"
}
```



---

archive/issue_events_248694.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-06-22T10:28:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248694"
}
```



---

archive/issue_comments_237027.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nCool, back to need_review.",
    "created_at": "2015-06-22T10:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237027",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:63" align="right">comment:63</div>

Cool, back to need_review.



---

archive/issue_comments_237028.json:
```json
{
    "body": "Reviewer: **Steven Trogdon**",
    "created_at": "2015-06-22T12:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237028",
    "user": "https://github.com/strogdon"
}
```

Reviewer: **Steven Trogdon**



---

archive/issue_events_248695.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T12:55:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248695"
}
```



---

archive/issue_events_248696.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T12:55:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248696"
}
```



---

archive/issue_comments_237029.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nThis works for me.",
    "created_at": "2015-06-22T12:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237029",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:64" align="right">comment:64</div>

This works for me.



---

archive/issue_comments_237030.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\n\n```\n+[ -n \"${SAGE_ROOT}\" ] || SAGE_ROOT=\"$(pwd)/../../../\"\n```\n\nIsn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?",
    "created_at": "2015-06-22T12:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237030",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:65" align="right">comment:65</div>


```
+[ -n "${SAGE_ROOT}" ] || SAGE_ROOT="$(pwd)/../../../"
```

Isn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?



---

archive/issue_comments_237031.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@nathanncohen](#comment%3A65):\n> \n> ```\n> +[ -n \"${SAGE_ROOT}\" ] || SAGE_ROOT=\"$(pwd)/../../../\"\n> ```\n> \n> Isn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?\n> \n\nPerhaps something does need to be done. I don't know what the protocol for these `spkg-src` scripts is. The present script does work from a sage shell. However, if not in a sage shell, it fails with something like\n\n```\ntar (child): /64bitdev/storage/sage-git_develop/sage/../../..//upstream/matplotlib-1.4.3.tar.bz2: Cannot open: No such file or directory\ntar (child): Error is not recoverable: exiting now\n```\nunless executed from the `build/pkgs/matplotlib` folder. So setting this back to `needs_info` until it can be resolved.",
    "created_at": "2015-06-22T13:40:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237031",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@nathanncohen](#comment%3A65):
> 
> ```
> +[ -n "${SAGE_ROOT}" ] || SAGE_ROOT="$(pwd)/../../../"
> ```
> 
> Isn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?
> 

Perhaps something does need to be done. I don't know what the protocol for these `spkg-src` scripts is. The present script does work from a sage shell. However, if not in a sage shell, it fails with something like

```
tar (child): /64bitdev/storage/sage-git_develop/sage/../../..//upstream/matplotlib-1.4.3.tar.bz2: Cannot open: No such file or directory
tar (child): Error is not recoverable: exiting now
```
unless executed from the `build/pkgs/matplotlib` folder. So setting this back to `needs_info` until it can be resolved.



---

archive/issue_events_248697.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T13:40:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248697"
}
```



---

archive/issue_events_248698.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T13:40:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248698"
}
```



---

archive/issue_comments_237032.json:
```json
{
    "body": "<div id=\"comment:67\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7\"><code>32afbe1</code></a></td><td><code>#17618 : add some information on how to use spkg-src.</code></td></tr></table>\n",
    "created_at": "2015-06-22T14:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237032",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:67"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7"><code>32afbe1</code></a></td><td><code>#17618 : add some information on how to use spkg-src.</code></td></tr></table>




---

archive/issue_comments_237033.json:
```json
{
    "body": "Changed commit from **[`30fb859`](https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d)** to **[`32afbe1`](https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7)**",
    "created_at": "2015-06-22T14:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237033",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`30fb859`](https://github.com/sagemath/sagetrac-mirror/commit/30fb859c8e77cc76adb35f6fe8ef44a36215d35d)** to **[`32afbe1`](https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7)**



---

archive/issue_events_248699.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-06-22T14:43:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248699"
}
```



---

archive/issue_events_248700.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2015-06-22T14:43:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248700"
}
```



---

archive/issue_comments_237034.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@nathanncohen](#comment%3A65):\n> \n> ```\n> +[ -n \"${SAGE_ROOT}\" ] || SAGE_ROOT=\"$(pwd)/../../../\"\n> ```\n> \n> Isn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?\n> \n\nThe checks done to some `spkg-install` scripts are here to ensure that the script is run from the Sage shell, because they use its features (e.g. some environment variables like `${MAKE}`). Here, in contrary to such `spkg-install` scripts, there is no need to check that since the script do not use such feature, except `${SAGE_ROOT}` that can be recovered from the current location.\n\nReplying to [@strogdon](#comment%3A66):\n> Perhaps something does need to be done. I don't know what the protocol for these `spkg-src` scripts is. The present script does work from a sage shell. However, if not in a sage shell, it fails with something like\n> \n> ```\n> tar (child): /64bitdev/storage/sage-git_develop/sage/../../..//upstream/matplotlib-1.4.3.tar.bz2: Cannot open: No such file or directory\n> tar (child): Error is not recoverable: exiting now\n> ```\n> unless executed from the `build/pkgs/matplotlib` folder. So setting this back to `needs_info` until it can be resolved.\n\nThe whole \"protocol\" can be found [here](http://www.sagemath.org/documentation/html/en/developer/packaging.html#modified-tarballs), which is pretty vague regarding the importance to be run from the Sage shell.\n\nHow i see it, this script is intented to be run by maintainers, ease of use is prefered over security, which is pretty different from `spkg-install` that is run by users and should be pretty strict regarding misuses. The aim is not to have a script that could be run from anywhere, obfuscated with tons of tests, but should deserve the following purposes:\n\n- document and make transparent the differences between the upstream tarball and the one we distribute (hence the comments above each paragraph),\n- be a handy tool to save some time for next updates (hence the autodiscovery of latest version and download url, and the possibility to be run from the developer's shell),\n- i would add perfect reproductibility of distributed tarballs, but it seems that nobody cares.",
    "created_at": "2015-06-22T14:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237034",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@nathanncohen](#comment%3A65):
> 
> ```
> +[ -n "${SAGE_ROOT}" ] || SAGE_ROOT="$(pwd)/../../../"
> ```
> 
> Isn't it cleaner to just stop (as `spkg-install` does when `SAGE_LOCAL` is not defined)?
> 

The checks done to some `spkg-install` scripts are here to ensure that the script is run from the Sage shell, because they use its features (e.g. some environment variables like `${MAKE}`). Here, in contrary to such `spkg-install` scripts, there is no need to check that since the script do not use such feature, except `${SAGE_ROOT}` that can be recovered from the current location.

Replying to [@strogdon](#comment%3A66):
> Perhaps something does need to be done. I don't know what the protocol for these `spkg-src` scripts is. The present script does work from a sage shell. However, if not in a sage shell, it fails with something like
> 
> ```
> tar (child): /64bitdev/storage/sage-git_develop/sage/../../..//upstream/matplotlib-1.4.3.tar.bz2: Cannot open: No such file or directory
> tar (child): Error is not recoverable: exiting now
> ```
> unless executed from the `build/pkgs/matplotlib` folder. So setting this back to `needs_info` until it can be resolved.

The whole "protocol" can be found [here](http://www.sagemath.org/documentation/html/en/developer/packaging.html#modified-tarballs), which is pretty vague regarding the importance to be run from the Sage shell.

How i see it, this script is intented to be run by maintainers, ease of use is prefered over security, which is pretty different from `spkg-install` that is run by users and should be pretty strict regarding misuses. The aim is not to have a script that could be run from anywhere, obfuscated with tons of tests, but should deserve the following purposes:

- document and make transparent the differences between the upstream tarball and the one we distribute (hence the comments above each paragraph),
- be a handy tool to save some time for next updates (hence the autodiscovery of latest version and download url, and the possibility to be run from the developer's shell),
- i would add perfect reproductibility of distributed tarballs, but it seems that nobody cares.



---

archive/issue_comments_237035.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nWhat about replacing \"#!/usr/bin/env bash\" with \"#!/usr/bin/env sage -sh\" ? Wouldn'it solve the problem in an elegant way? We would not have to check for those environment variables anymore, and that would only require 'sage' can be found in `PATH` (which is easier than requiring SAGE_ROOT to be set)? Errors would be reported by bash itself (i.e. 'sage' not found) when needed?",
    "created_at": "2015-06-22T14:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237035",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:69" align="right">comment:69</div>

What about replacing "#!/usr/bin/env bash" with "#!/usr/bin/env sage -sh" ? Wouldn'it solve the problem in an elegant way? We would not have to check for those environment variables anymore, and that would only require 'sage' can be found in `PATH` (which is easier than requiring SAGE_ROOT to be set)? Errors would be reported by bash itself (i.e. 'sage' not found) when needed?



---

archive/issue_comments_237036.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\n> - i would add perfect reproductibility of distributed tarballs, but it seems that nobody cares.\n\nThat's wrong (the 'nobody cares' part, of course `:-P`)",
    "created_at": "2015-06-22T14:56:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237036",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:70" align="right">comment:70</div>

> - i would add perfect reproductibility of distributed tarballs, but it seems that nobody cares.

That's wrong (the 'nobody cares' part, of course `:-P`)



---

archive/issue_comments_237037.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@nathanncohen](#comment%3A69):\n> What about replacing \"#!/usr/bin/env bash\" with \"#!/usr/bin/env sage -sh\" ? \n\nI think that if you put a command with spaces after \"#!/usr/bin/env\", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.",
    "created_at": "2015-06-22T15:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237037",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@nathanncohen](#comment%3A69):
> What about replacing "#!/usr/bin/env bash" with "#!/usr/bin/env sage -sh" ? 

I think that if you put a command with spaces after "#!/usr/bin/env", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.



---

archive/issue_comments_237038.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\n> I think that if you put a command with spaces after \"#!/usr/bin/env\", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.\n\nWorks for me. Can you illustrate your claim with examples, possibly online bug reports? It seems that \"env -- sage -sh\" does what it should.",
    "created_at": "2015-06-22T15:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237038",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:72" align="right">comment:72</div>

> I think that if you put a command with spaces after "#!/usr/bin/env", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.

Works for me. Can you illustrate your claim with examples, possibly online bug reports? It seems that "env -- sage -sh" does what it should.



---

archive/issue_comments_237039.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nOh. You are right, it totally breaks when it's the first line of a bash script.",
    "created_at": "2015-06-22T15:29:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237039",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:73" align="right">comment:73</div>

Oh. You are right, it totally breaks when it's the first line of a bash script.



---

archive/issue_comments_237040.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@nathanncohen](#comment%3A72):\n> > I think that if you put a command with spaces after \"#!/usr/bin/env\", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.\n> \n> \n> Works for me. Can you illustrate your claim with examples, possibly online bug reports? It seems that \"env -- sage -sh\" does what it should.\n\nFor reference, see http://mail-index.netbsd.org/netbsd-users/2008/11/09/msg002388.html.",
    "created_at": "2015-06-22T16:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237040",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@nathanncohen](#comment%3A72):
> > I think that if you put a command with spaces after "#!/usr/bin/env", the behavior is either unpredictable or just wrong (= not what you expect). I forget which. In any case, I think it's a bad idea.
> 
> 
> Works for me. Can you illustrate your claim with examples, possibly online bug reports? It seems that "env -- sage -sh" does what it should.

For reference, see http://mail-index.netbsd.org/netbsd-users/2008/11/09/msg002388.html.



---

archive/issue_comments_237041.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nI don't think checking for `SAGE_ROOT` is necessarily a bad idea. And the protocol doesn't seem to require the script to be run from the Sage shell. What if something like the following, in addition to the latest commit, were added\n\n```\n--- a/build/pkgs/matplotlib/spkg-src\n+++ b/build/pkgs/matplotlib/spkg-src\n@@ -2,6 +2,10 @@\n \n set -e\n \n+printf \"This script should be run as ./spkg-src from the repository to which it \n+belongs, or from the Sage shell.\\n\"\n+read -rsp $'Press any key to continue or \\'CTRL+C\\' to exit :\\n' -n1 key\n+\n [ -n \"${SAGE_ROOT}\" ] || SAGE_ROOT=\"$(pwd)/../../../\"\n```\nOff hand I don't know how to check if one is `in` the correct repository. And perhaps giving the warning is enough.",
    "created_at": "2015-06-22T16:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237041",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:75" align="right">comment:75</div>

I don't think checking for `SAGE_ROOT` is necessarily a bad idea. And the protocol doesn't seem to require the script to be run from the Sage shell. What if something like the following, in addition to the latest commit, were added

```
--- a/build/pkgs/matplotlib/spkg-src
+++ b/build/pkgs/matplotlib/spkg-src
@@ -2,6 +2,10 @@
 
 set -e
 
+printf "This script should be run as ./spkg-src from the repository to which it 
+belongs, or from the Sage shell.\n"
+read -rsp $'Press any key to continue or \'CTRL+C\' to exit :\n' -n1 key
+
 [ -n "${SAGE_ROOT}" ] || SAGE_ROOT="$(pwd)/../../../"
```
Off hand I don't know how to check if one is `in` the correct repository. And perhaps giving the warning is enough.



---

archive/issue_comments_237042.json:
```json
{
    "body": "Changed commit from **[`32afbe1`](https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7)** to **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**",
    "created_at": "2015-06-22T18:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237042",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`32afbe1`](https://github.com/sagemath/sagetrac-mirror/commit/32afbe15955286dfaf2f3f270ca2e231aa8f0af7)** to **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**



---

archive/issue_comments_237043.json:
```json
{
    "body": "<div id=\"comment:76\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70\"><code>9dc580d</code></a></td><td><code>#17618 spkg-src can be run from anywhere.</code></td></tr></table>\n",
    "created_at": "2015-06-22T18:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237043",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:76"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70"><code>9dc580d</code></a></td><td><code>#17618 spkg-src can be run from anywhere.</code></td></tr></table>




---

archive/issue_comments_237044.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nReplying to [@strogdon](#comment%3A75):\n\nI am not favorable to developing interactive user interfaces for `spkg-src` scripts.",
    "created_at": "2015-06-22T18:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237044",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:77" align="right">comment:77</div>

Replying to [@strogdon](#comment%3A75):

I am not favorable to developing interactive user interfaces for `spkg-src` scripts.



---

archive/issue_events_248701.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T19:08:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248701"
}
```



---

archive/issue_events_248702.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2015-06-22T19:08:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248702"
}
```



---

archive/issue_comments_237045.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A77):\n> Replying to [@strogdon](#comment%3A75):\n> \n> I am not favorable to developing interactive user interfaces for `spkg-src` scripts.\n\nIt's not really the best. I'm good with this now. Let's hope it sticks.",
    "created_at": "2015-06-22T19:08:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237045",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:78" align="right">comment:78</div>

Replying to [@sagetrac-tmonteil](#comment%3A77):
> Replying to [@strogdon](#comment%3A75):
> 
> I am not favorable to developing interactive user interfaces for `spkg-src` scripts.

It's not really the best. I'm good with this now. Let's hope it sticks.



---

archive/issue_events_248703.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-23T22:34:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248703"
}
```



---

archive/issue_events_248704.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "550dacaa77e686886fe17659f95605d481761d5e",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-23T22:34:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17618#event-248704"
}
```



---

archive/issue_comments_237046.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL1.4.3)** to **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**",
    "created_at": "2015-06-23T22:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17618",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17618#issuecomment-237046",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tmonteil/MPL1.4.3](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/MPL1.4.3)** to **[`9dc580d`](https://github.com/sagemath/sagetrac-mirror/commit/9dc580db712380bbcfe20c958d5125696ceb5e70)**
