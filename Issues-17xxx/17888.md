# Issue 17888: Implement check for modular elements and if a poset is supersolvable

archive/issues_017651.json:
```json
{
    "body": "This adds an option to check if a set of elements are modular (and by extension, if you pass a singleton, then that element is modular). This also checks if a lattice is supersolvable, that is to say there exists a maximal chain of modular elements.\n\nAssignee: sage-combinat\n\nCC:  sage-combinat\n\nBranch/Commit: 6404f493f19b7852cbd046d7a8df809d1bd5c8c1\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17888\n\n",
    "closed_at": "2015-03-08T22:01:05Z",
    "created_at": "2015-03-03T03:16:35Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Implement check for modular elements and if a poset is supersolvable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17888",
    "user": "https://github.com/tscrim"
}
```
This adds an option to check if a set of elements are modular (and by extension, if you pass a singleton, then that element is modular). This also checks if a lattice is supersolvable, that is to say there exists a maximal chain of modular elements.

Assignee: sage-combinat

CC:  sage-combinat

Branch/Commit: 6404f493f19b7852cbd046d7a8df809d1bd5c8c1

Reviewer: Frédéric Chapoton

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17888





---

archive/issue_comments_250900.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-03-03T03:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250900",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_250901.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-03T03:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250901",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_250902.json:
```json
{
    "body": "<a id='comment:2'></a>Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)\n\n```\ndef is_supersolvable(self):\n    \"\"\"\n    \"\"\"\n    x0 = self.minimal_elements()[0]\n    x1 = self.maximal_elements()[0]\n    mod_elts = [x for x in self if self.is_modular([x])]\n    mg = DiGraph([e for e in self.cover_relations()\n                  if e[0] in mod_elts and e[1] in mod_elts])\n    return mg.shortest_path(x0, x1) != []\n```\nMaybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?",
    "created_at": "2015-03-03T21:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250902",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)

```
def is_supersolvable(self):
    """
    """
    x0 = self.minimal_elements()[0]
    x1 = self.maximal_elements()[0]
    mod_elts = [x for x in self if self.is_modular([x])]
    mg = DiGraph([e for e in self.cover_relations()
                  if e[0] in mod_elts and e[1] in mod_elts])
    return mg.shortest_path(x0, x1) != []
```
Maybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?



---

archive/issue_comments_250903.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 chapoton]:\n> Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)\n\n\nThis is likely not as efficient because it checks all elements for modularity, whereas the current implementation will short-circuit. I think we can do this by starting at the lowest element, going up a cover relation to another modular element, if no such element exists, backtrack. I'll implement this tomorrow.\n\n> Maybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?\n\n\nHow would you handle the following poset: `x ,- [x] <- [This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)`? By enforcing that it is always a list (or quacks like one), then there's no ambiguity.",
    "created_at": "2015-03-04T05:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250903",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>Replying to [comment:2 chapoton]:
> Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)


This is likely not as efficient because it checks all elements for modularity, whereas the current implementation will short-circuit. I think we can do this by starting at the lowest element, going up a cover relation to another modular element, if no such element exists, backtrack. I'll implement this tomorrow.

> Maybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?


How would you handle the following poset: `x ,- [x] <- [This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)`? By enforcing that it is always a list (or quacks like one), then there's no ambiguity.



---

archive/issue_comments_250904.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 tscrim]:\n> Replying to [comment:2 chapoton]:\n> > Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)\n  \n> \n> This is likely not as efficient because it checks all elements for modularity, whereas the current implementation will short-circuit. I think we can do this by starting at the lowest element, going up a cover relation to another modular element, if no such element exists, backtrack. I'll implement this tomorrow.\n\n\nYou're right. It would be good to never check twice if some element is modular.\n\n> > Maybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?\n\n> \n> How would you handle the following poset: `x ,- [x] <- [This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)`? By enforcing that it is always a list (or quacks like one), then there's no ambiguity.\n\n\nok, I understand. Maybe we can have a function is_modular_element, then ?",
    "created_at": "2015-03-05T09:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250904",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>Replying to [comment:4 tscrim]:
> Replying to [comment:2 chapoton]:
> > Hmm. `is_supersolvable` does not seems very efficient to me. What about something like that (not tested)
  
> 
> This is likely not as efficient because it checks all elements for modularity, whereas the current implementation will short-circuit. I think we can do this by starting at the lowest element, going up a cover relation to another modular element, if no such element exists, backtrack. I'll implement this tomorrow.


You're right. It would be good to never check twice if some element is modular.

> > Maybe you could also make sure that `is_modular` can take a single element of the lattice as argument ?

> 
> How would you handle the following poset: `x ,- [x] <- [This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)`? By enforcing that it is always a list (or quacks like one), then there's no ambiguity.


ok, I understand. Maybe we can have a function is_modular_element, then ?



---

archive/issue_comments_250905.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-05T11:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250905",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_250906.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-06T23:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250907.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:5 chapoton]:\n> Replying to [comment:4 tscrim]:\n> You're right. It would be good to never check twice if some element is modular.\n\n\nIt's tomorrow...ish. I've implemented a backtracing version of `is_supersolvable`.\n\n> ok, I understand. Maybe we can have a function is_modular_element, then ?\n\n\nI've added such a method.",
    "created_at": "2015-03-06T23:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250907",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Replying to [comment:5 chapoton]:
> Replying to [comment:4 tscrim]:
> You're right. It would be good to never check twice if some element is modular.


It's tomorrow...ish. I've implemented a backtracing version of `is_supersolvable`.

> ok, I understand. Maybe we can have a function is_modular_element, then ?


I've added such a method.



---

archive/issue_comments_250908.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-06T23:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250908",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_250909.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-07T01:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250910.json:
```json
{
    "body": "<a id='comment:10'></a>I changed things so that we go from the maximal elements down since in most of my use cases, the rank 1 elements are typically modular.",
    "created_at": "2015-03-07T01:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250910",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>I changed things so that we go from the maximal elements down since in most of my use cases, the rank 1 elements are typically modular.



---

archive/issue_comments_250911.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-07T19:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250911",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250912.json:
```json
{
    "body": "<a id='comment:12'></a>I have tried to enhance the doc.\n\nI also propose to cache the modular property inside \"is_supersolvable\", so that one does not check twice that an element is modular or not. What do you think ? (the line with `@`cached_function is currently commented out)",
    "created_at": "2015-03-07T19:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250912",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>I have tried to enhance the doc.

I also propose to cache the modular property inside "is_supersolvable", so that one does not check twice that an element is modular or not. What do you think ? (the line with `@`cached_function is currently commented out)



---

archive/issue_comments_250913.json:
```json
{
    "body": "<a id='comment:13'></a>I agree with the ``@`cached_function` (at least, from my testing it doesn't cause any memory leaks). Once that's uncommented, then you can set a positive review.",
    "created_at": "2015-03-07T23:25:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250913",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>I agree with the ``@`cached_function` (at least, from my testing it doesn't cause any memory leaks). Once that's uncommented, then you can set a positive review.



---

archive/issue_comments_250914.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-08T09:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250914",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250915.json:
```json
{
    "body": "<a id='comment:15'></a>ok, then positive review. thanks for implementing that !",
    "created_at": "2015-03-08T09:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250915",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>ok, then positive review. thanks for implementing that !



---

archive/issue_comments_250916.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-08T09:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250916",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_250917.json:
```json
{
    "body": "<a id='comment:16'></a>Thanks Frederic.",
    "created_at": "2015-03-08T17:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250917",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>Thanks Frederic.



---

archive/issue_comments_250918.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-08T22:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17888#issuecomment-250918",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_050952.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-08T22:01:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17888",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17888#event-50952"
}
```
