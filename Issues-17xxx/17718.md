# Issue 17718: Further clean-up of expect.py

archive/issues_017481.json:
```json
{
    "body": "\n\nBranch/Commit: c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0\n\nReviewer: Vincent Delecroix, Marc Mezzarobba, Ralf Stephan\n\nAuthor: Jeroen Demeyer\n\nDependencies: #17704\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17718\n\n",
    "closed_at": "2015-02-26T07:11:08Z",
    "created_at": "2015-02-03T09:33:17Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Further clean-up of expect.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17718",
    "user": "https://github.com/jdemeyer"
}
```


Branch/Commit: c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0

Reviewer: Vincent Delecroix, Marc Mezzarobba, Ralf Stephan

Author: Jeroen Demeyer

Dependencies: #17704

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17718





---

archive/issue_comments_303470.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/ticket/17718\"",
    "created_at": "2015-02-03T10:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303470",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/ticket/17718"



---

archive/issue_comments_303471.json:
```json
{
    "body": "Changing commit from \"\" to \"d556229dd9fec47e492a3543b0815ce02b4870de\"",
    "created_at": "2015-02-03T11:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303471",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "d556229dd9fec47e492a3543b0815ce02b4870de"



---

archive/issue_comments_303472.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-02-03T11:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303472",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_303473.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[8501bb1](http://git.sagemath.org/sage.git/commit/?id=8501bb16498e220d74685285c4adde3b3129a533)|`Clean up in expect.py`|\n|[d556229](http://git.sagemath.org/sage.git/commit/?id=d556229dd9fec47e492a3543b0815ce02b4870de)|`Further clean-up of interfaces`|",
    "created_at": "2015-02-03T11:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303473",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[8501bb1](http://git.sagemath.org/sage.git/commit/?id=8501bb16498e220d74685285c4adde3b3129a533)|`Clean up in expect.py`|
|[d556229](http://git.sagemath.org/sage.git/commit/?id=d556229dd9fec47e492a3543b0815ce02b4870de)|`Further clean-up of interfaces`|



---

archive/issue_comments_303474.json:
```json
{
    "body": "<a id='comment:3'></a>\nWhy\n\n```\n if self.silent:\n-     return\n+     return self.interface\n```\nIf this is necessary, could you add a doctest?",
    "created_at": "2015-02-04T21:17:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303474",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Why

```
 if self.silent:
-     return
+     return self.interface
```
If this is necessary, could you add a doctest?



---

archive/issue_comments_303475.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [vdelecroix](#comment%3A3):\n> Why\n> \n> ```\n>  if self.silent:\n> -     return\n> +     return self.interface\n> ```\n> If this is necessary, could you add a doctest?\n\nIt's to allow `with StdOutContext(...) as ...` as opposed to just `with StdOutContext(...)`.\n\nSo it's covered by this doctest change:\n\n```diff\n-sage: with StdOutContext(gp):\n-...       gp('1+1')\n-...\n+sage: with StdOutContext(Gp()) as g:\n+....:     g('1+1')\n```",
    "created_at": "2015-02-05T07:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303475",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Replying to [vdelecroix](#comment%3A3):
> Why
> 
> ```
>  if self.silent:
> -     return
> +     return self.interface
> ```
> If this is necessary, could you add a doctest?

It's to allow `with StdOutContext(...) as ...` as opposed to just `with StdOutContext(...)`.

So it's covered by this doctest change:

```diff
-sage: with StdOutContext(gp):
-...       gp('1+1')
-...
+sage: with StdOutContext(Gp()) as g:
+....:     g('1+1')
```



---

archive/issue_comments_303476.json:
```json
{
    "body": "Changing commit from \"d556229dd9fec47e492a3543b0815ce02b4870de\" to \"568b6a8e4478fe93f70841efc664a9992e820386\"",
    "created_at": "2015-02-05T13:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303476",
    "user": "https://github.com/mezzarobba"
}
```

Changing commit from "d556229dd9fec47e492a3543b0815ce02b4870de" to "568b6a8e4478fe93f70841efc664a9992e820386"



---

archive/issue_comments_303477.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/17718\" to \"u/mmezzarobba/17718-expect\"",
    "created_at": "2015-02-05T13:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303477",
    "user": "https://github.com/mezzarobba"
}
```

Changing branch from "u/jdemeyer/ticket/17718" to "u/mmezzarobba/17718-expect"



---

archive/issue_comments_303478.json:
```json
{
    "body": "<a id='comment:6'></a>\nWhy that extra commit?",
    "created_at": "2015-02-05T13:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303478",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Why that extra commit?



---

archive/issue_comments_303479.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-05T13:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303479",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_303480.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [jdemeyer](#comment%3A6):\n> Why that extra commit?\n\n\nAs the commit message says: to make the optional test involving octave pass also when the tests are run with `--optional=octave`, not `--optional=sage,octave`.",
    "created_at": "2015-02-05T13:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303480",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:7'></a>
Replying to [jdemeyer](#comment%3A6):
> Why that extra commit?


As the commit message says: to make the optional test involving octave pass also when the tests are run with `--optional=octave`, not `--optional=sage,octave`.



---

archive/issue_comments_303481.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [mmezzarobba](#comment%3A7):\n> Replying to [jdemeyer](#comment%3A6):\n> > Why that extra commit?\n\n> \n> As the commit message says: to make the optional test involving octave pass also when the tests are run with `--optional=octave`, not `--optional=sage,octave`.\n\nI'm not aware of any general rule that tests should pass when run with `./sage -t --optional=octave`. I prefer to have as few tests as possible optional.",
    "created_at": "2015-02-05T13:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303481",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [mmezzarobba](#comment%3A7):
> Replying to [jdemeyer](#comment%3A6):
> > Why that extra commit?

> 
> As the commit message says: to make the optional test involving octave pass also when the tests are run with `--optional=octave`, not `--optional=sage,octave`.

I'm not aware of any general rule that tests should pass when run with `./sage -t --optional=octave`. I prefer to have as few tests as possible optional.



---

archive/issue_comments_303482.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-05T13:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303482",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_303483.json:
```json
{
    "body": "Changing commit from \"568b6a8e4478fe93f70841efc664a9992e820386\" to \"d556229dd9fec47e492a3543b0815ce02b4870de\"",
    "created_at": "2015-02-05T13:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303483",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "568b6a8e4478fe93f70841efc664a9992e820386" to "d556229dd9fec47e492a3543b0815ce02b4870de"



---

archive/issue_comments_303484.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn any case, this could be discussed in a different ticket.",
    "created_at": "2015-02-05T13:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303484",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
In any case, this could be discussed in a different ticket.



---

archive/issue_comments_303485.json:
```json
{
    "body": "Changing branch from \"u/mmezzarobba/17718-expect\" to \"u/jdemeyer/ticket/17718\"",
    "created_at": "2015-02-05T13:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303485",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/mmezzarobba/17718-expect" to "u/jdemeyer/ticket/17718"



---

archive/issue_comments_303486.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jdemeyer](#comment%3A8):\n> I'm not aware of any general rule that tests should pass when run with `./sage -t --optional=octave`.\n\n\nWhat is the point of having an option `--optional=octave` that does not imply `--optional=sage`, then?\n\n> I prefer to have as few tests as possible optional.\n\n\nI agree in principle, but here I don't think the example without its `optional` part is a meaningful test case.\n\nAnyway, I'm fine with leaving that change out if you prefer.",
    "created_at": "2015-02-05T13:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303486",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:10'></a>
Replying to [jdemeyer](#comment%3A8):
> I'm not aware of any general rule that tests should pass when run with `./sage -t --optional=octave`.


What is the point of having an option `--optional=octave` that does not imply `--optional=sage`, then?

> I prefer to have as few tests as possible optional.


I agree in principle, but here I don't think the example without its `optional` part is a meaningful test case.

Anyway, I'm fine with leaving that change out if you prefer.



---

archive/issue_comments_303487.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix, Marc Mezzarobba\"",
    "created_at": "2015-02-05T13:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303487",
    "user": "https://github.com/mezzarobba"
}
```

Changing reviewer from "" to "Vincent Delecroix, Marc Mezzarobba"



---

archive/issue_comments_303488.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-05T13:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303488",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303489.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-02-21T12:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303489",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_303490.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis leads to random failures in the R interface on my desktop (Haswell-E Linux x86_64, background computation running)\n\n```\nsage -t --long src/sage/interfaces/r.py\n**********************************************************************\nFile \"src/sage/interfaces/r.py\", line 24, in sage.interfaces.r\nFailed example:\n    1/x\nExpected:\n    [1] 0.09615385 0.17857143 0.32258065 0.15625000 0.04608295\nGot:\n    <BLANKLINE>\n\ncommand timed out: 1200 seconds without output running ['./sage', '-t', '-p', '8', '--all', '--long', '--logfile=logs/ptestlong.log'], attempting to kill\nprocess killed by signal 9\nprogram finished with exit code -1\nelapsedTime=2461.278640\n```",
    "created_at": "2015-02-21T12:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303490",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
This leads to random failures in the R interface on my desktop (Haswell-E Linux x86_64, background computation running)

```
sage -t --long src/sage/interfaces/r.py
**********************************************************************
File "src/sage/interfaces/r.py", line 24, in sage.interfaces.r
Failed example:
    1/x
Expected:
    [1] 0.09615385 0.17857143 0.32258065 0.15625000 0.04608295
Got:
    <BLANKLINE>

command timed out: 1200 seconds without output running ['./sage', '-t', '-p', '8', '--all', '--long', '--logfile=logs/ptestlong.log'], attempting to kill
process killed by signal 9
program finished with exit code -1
elapsedTime=2461.278640
```



---

archive/issue_comments_303491.json:
```json
{
    "body": "<a id='comment:12'></a>\nanother failed example (seems to be falling over a prompt in the R docs if you are unlucky with the timing):\n\n```\n$ SAGE_PEXPECT_LOG=yes sage -bt --long --verbose src/sage/interfaces/r.py \n[...]\nTrying (line 1955):    print length._sage_doc_()\nExpecting:\n    length                 package:base                 R Documentation\n    ...\n    <BLANKLINE>\nok [0.04 s]\nTrying (line 1959):    sig_on_count()\nExpecting:\n    0\nok [0.00 s]\nTrying (line 1969):    length = r.length\nExpecting nothing\nok [0.00 s]\nTrying (line 1970):    print length._sage_src_()\nExpecting:\nTrying (line 1970):    print length._sage_src_()\nExpecting:\n    function (x)  .Primitive(\"length\")\nok [0.00 s]\nTrying (line 1973):    sig_on_count()\nExpecting:\n    0\nok [0.00 s]\nTrying (line 1981):    length = r.length\nExpecting nothing\nok [0.00 s]\nTrying (line 1982):    length([1,2,3])\nExpecting:\n    [1] 3\n... hangs ...\n```\npexpect log:\n\n```\n[...]\nExamples:\n\n     length(diag(4))  # = 16 (4 x 4)\n     length(options())  # 12 or more\n     length(y ~ x1 + x2 + x3)  # 3\n     length(expression(x, {y <- x^2; y+2}, x^y))  # 3\n     \n     ## from example(warpbreaks)\n     require(stats)\n     \n     fm1 <- lm(breaks ~ wool * tension, data = warpbreaks)\n     length(fm1$call)      # 3, lm() and two arguments.\n     length(formula(fm1))  # 3, ~ lhs rhs\n     \n\n__SAGE__R__PROMPT__> 1+310416896;\n[1] 310416897\n__SAGE__R__PROMPT__> length\nlength\nfunction (x)  .Primitive(\"length\")\n__SAGE__R__PROMPT__> 1+1371999567;\n[1] 1.372e+09\n__SAGE__R__PROMPT__> \ufffd\nquit(save=\"no\")\n\n__SAGE__R__PROMPT__> \n__SAGE__R__PROMPT__> ^C\nquit(save=\"no\")\n\nsage2 <- 1\nsage2 <- 1\n1+1305756531;\nquit(save=\"no\")\n```",
    "created_at": "2015-02-21T12:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303491",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
another failed example (seems to be falling over a prompt in the R docs if you are unlucky with the timing):

```
$ SAGE_PEXPECT_LOG=yes sage -bt --long --verbose src/sage/interfaces/r.py 
[...]
Trying (line 1955):    print length._sage_doc_()
Expecting:
    length                 package:base                 R Documentation
    ...
    <BLANKLINE>
ok [0.04 s]
Trying (line 1959):    sig_on_count()
Expecting:
    0
ok [0.00 s]
Trying (line 1969):    length = r.length
Expecting nothing
ok [0.00 s]
Trying (line 1970):    print length._sage_src_()
Expecting:
Trying (line 1970):    print length._sage_src_()
Expecting:
    function (x)  .Primitive("length")
ok [0.00 s]
Trying (line 1973):    sig_on_count()
Expecting:
    0
ok [0.00 s]
Trying (line 1981):    length = r.length
Expecting nothing
ok [0.00 s]
Trying (line 1982):    length([1,2,3])
Expecting:
    [1] 3
... hangs ...
```
pexpect log:

```
[...]
Examples:

     length(diag(4))  # = 16 (4 x 4)
     length(options())  # 12 or more
     length(y ~ x1 + x2 + x3)  # 3
     length(expression(x, {y <- x^2; y+2}, x^y))  # 3
     
     ## from example(warpbreaks)
     require(stats)
     
     fm1 <- lm(breaks ~ wool * tension, data = warpbreaks)
     length(fm1$call)      # 3, lm() and two arguments.
     length(formula(fm1))  # 3, ~ lhs rhs
     

__SAGE__R__PROMPT__> 1+310416896;
[1] 310416897
__SAGE__R__PROMPT__> length
length
function (x)  .Primitive("length")
__SAGE__R__PROMPT__> 1+1371999567;
[1] 1.372e+09
__SAGE__R__PROMPT__> ï¿½
quit(save="no")

__SAGE__R__PROMPT__> 
__SAGE__R__PROMPT__> ^C
quit(save="no")

sage2 <- 1
sage2 <- 1
1+1305756531;
quit(save="no")
```



---

archive/issue_comments_303492.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [vbraun](#comment%3A11):\n> This leads to random failures in the R interface on my desktop\n\nAre you really sure that this is caused by this ticket? The point is that this ticket is really a clean-up ticket, with almost no functional changes.",
    "created_at": "2015-02-21T13:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303492",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Replying to [vbraun](#comment%3A11):
> This leads to random failures in the R interface on my desktop

Are you really sure that this is caused by this ticket? The point is that this ticket is really a clean-up ticket, with almost no functional changes.



---

archive/issue_comments_303493.json:
```json
{
    "body": "<a id='comment:14'></a>\nWell maybe it triggers a pre-existing bug. All I know for sure is that doctests get stuck in R on my machine with it.",
    "created_at": "2015-02-21T13:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303493",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>
Well maybe it triggers a pre-existing bug. All I know for sure is that doctests get stuck in R on my machine with it.



---

archive/issue_comments_303494.json:
```json
{
    "body": "<a id='comment:15'></a>\nHow common is this failure?",
    "created_at": "2015-02-21T15:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303494",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
How common is this failure?



---

archive/issue_comments_303495.json:
```json
{
    "body": "<a id='comment:16'></a>\nMaybe 50% when the system is under load...",
    "created_at": "2015-02-21T16:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303495",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>
Maybe 50% when the system is under load...



---

archive/issue_comments_303496.json:
```json
{
    "body": "<a id='comment:17'></a>\nWhen I have some time, I'll try to reproduce it. The only possible reason that I can think of is the change `self._interrupt()` -> `self.interrupt()`\n\nIf that's the cause, I suggest to just revert that.",
    "created_at": "2015-02-21T17:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303496",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
When I have some time, I'll try to reproduce it. The only possible reason that I can think of is the change `self._interrupt()` -> `self.interrupt()`

If that's the cause, I suggest to just revert that.



---

archive/issue_comments_303497.json:
```json
{
    "body": "Changing commit from \"d556229dd9fec47e492a3543b0815ce02b4870de\" to \"c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0\"",
    "created_at": "2015-02-22T09:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d556229dd9fec47e492a3543b0815ce02b4870de" to "c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0"



---

archive/issue_comments_303498.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[c8d1a28](http://git.sagemath.org/sage.git/commit/?id=c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0)|`Revert interrupt change`|",
    "created_at": "2015-02-22T09:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303498",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[c8d1a28](http://git.sagemath.org/sage.git/commit/?id=c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0)|`Revert interrupt change`|



---

archive/issue_comments_303499.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-22T09:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303499",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_303500.json:
```json
{
    "body": "<a id='comment:19'></a>\nI confirm the issue and this should fix it.",
    "created_at": "2015-02-22T09:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303500",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
I confirm the issue and this should fix it.



---

archive/issue_comments_303501.json:
```json
{
    "body": "<a id='comment:20'></a>\nPatchbot says fine. Tests in `interfaces` on my machine pass too. As the code was already reviewed by others I dare to set positive.",
    "created_at": "2015-02-25T15:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303501",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>
Patchbot says fine. Tests in `interfaces` on my machine pass too. As the code was already reviewed by others I dare to set positive.



---

archive/issue_comments_303502.json:
```json
{
    "body": "Changing reviewer from \"Vincent Delecroix, Marc Mezzarobba\" to \"Vincent Delecroix, Marc Mezzarobba, Ralf Stephan\"",
    "created_at": "2015-02-25T15:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303502",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "Vincent Delecroix, Marc Mezzarobba" to "Vincent Delecroix, Marc Mezzarobba, Ralf Stephan"



---

archive/issue_events_050692.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-25T15:04:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17718#event-50692"
}
```



---

archive/issue_comments_303503.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-25T15:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303503",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303504.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-26T07:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303504",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_303505.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/17718\" to \"c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0\"",
    "created_at": "2015-02-26T07:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17718#issuecomment-303505",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/17718" to "c8d1a289e95184f3f6f5528e8fb8ee4638ab47c0"



---

archive/issue_events_050693.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-26T07:11:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17718",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17718#event-50693"
}
```
