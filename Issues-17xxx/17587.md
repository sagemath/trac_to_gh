# Issue 17587: ToricLattice: fix use of span() and span_of_basis()

archive/issues_017350.json:
```json
{
    "assignees": [],
    "body": "The methods `span` and `span_of_basis` of `ToricLattice_generic` should work when given a `base_ring` and such a `base_ring` must be given whenever the elements of the basis are not integers.\n\nThis is needed in preparation of #17585, where\n\n```\nsage: N = ToricLattice(3)\nsage: Ns = N.span_of_basis([(1,2,3)])\nsage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])\n```\nwill become an error, since `ToricLattice_generic` explicitly has\n\n```\nElement = ToricLatticeElement\n```\nwhich derives from `Vector_integer_dense`.\n\nCurrent code overrides the element class if needed, after #17585 that will no longer work.\n\nCC:  @vbraun @novoselt\n\nBranch/Commit: **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Andrey Novoseltsev**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/17587_\n\n",
    "closed_at": "2015-01-24T13:18:59Z",
    "created_at": "2015-01-05T18:41:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "ToricLattice: fix use of span() and span_of_basis()",
    "type": "issue",
    "updated_at": "2015-01-24T13:18:59Z",
    "url": "https://github.com/sagemath/sage/issues/17587",
    "user": "https://github.com/jdemeyer"
}
```
The methods `span` and `span_of_basis` of `ToricLattice_generic` should work when given a `base_ring` and such a `base_ring` must be given whenever the elements of the basis are not integers.

This is needed in preparation of #17585, where

```
sage: N = ToricLattice(3)
sage: Ns = N.span_of_basis([(1,2,3)])
sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])
```
will become an error, since `ToricLattice_generic` explicitly has

```
Element = ToricLatticeElement
```
which derives from `Vector_integer_dense`.

Current code overrides the element class if needed, after #17585 that will no longer work.

CC:  @vbraun @novoselt

Branch/Commit: **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**

Reviewer: **Jeroen Demeyer**

Author: **Andrey Novoseltsev**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/17587_





---

archive/issue_events_250609.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-05T18:41:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250609"
}
```



---

archive/issue_events_250610.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-05T18:41:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250610"
}
```



---

archive/issue_events_250611.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-05T18:41:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250611"
}
```



---

archive/issue_events_250612.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-05T18:41:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250612"
}
```



---

archive/issue_comments_236237.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,8 +5,13 @@\n ```\n sage: N = ToricLattice(3)\n sage: Ns = N.span_of_basis([(1,2,3)])\n-sage: Ns.span_of_basis([(2,4,0)])\n-Sublattice <N(2, 4, 0)>\n sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])\n ```\n-will become an error, since the ring is assumed to be `ZZ` but the elements are actually rationals.\n+will become an error, since `ToricLattice_generic` explicitly has\n+\n+```\n+Element = ToricLatticeElement\n+```\n+which derives from `Vector_integer_dense`.\n+\n+Current code overrides the element class if needed, after #17585 that will no longer work.\n``````\n",
    "created_at": "2015-01-05T18:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236237",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,8 +5,13 @@
 ```
 sage: N = ToricLattice(3)
 sage: Ns = N.span_of_basis([(1,2,3)])
-sage: Ns.span_of_basis([(2,4,0)])
-Sublattice <N(2, 4, 0)>
 sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])
 ```
-will become an error, since the ring is assumed to be `ZZ` but the elements are actually rationals.
+will become an error, since `ToricLattice_generic` explicitly has
+
+```
+Element = ToricLatticeElement
+```
+which derives from `Vector_integer_dense`.
+
+Current code overrides the element class if needed, after #17585 that will no longer work.
``````




---

archive/issue_comments_236238.json:
```json
{
    "body": "Branch: **[u/jdemeyer/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17587)**",
    "created_at": "2015-01-05T18:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236238",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17587)**



---

archive/issue_comments_236239.json:
```json
{
    "body": "Commit: **[`ab9ada2`](https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc)**",
    "created_at": "2015-01-05T18:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236239",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`ab9ada2`](https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc)**



---

archive/issue_events_250613.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-05T18:58:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250613"
}
```



---

archive/issue_comments_236240.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc\"><code>ab9ada2</code></a></td><td><code>Fix use of base_ring in span() and span_of_basis()</code></td></tr></table>\n",
    "created_at": "2015-01-05T18:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236240",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc"><code>ab9ada2</code></a></td><td><code>Fix use of base_ring in span() and span_of_basis()</code></td></tr></table>




---

archive/issue_events_250614.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-05T19:07:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250614"
}
```



---

archive/issue_events_250615.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-05T19:07:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250615"
}
```



---

archive/issue_comments_236241.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWhy QQ was added in the last line? It seems to me that a saturated sublattice should be constructed there, without any fractional generators.",
    "created_at": "2015-01-05T19:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236241",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:4" align="right">comment:4</div>

Why QQ was added in the last line? It seems to me that a saturated sublattice should be constructed there, without any fractional generators.



---

archive/issue_comments_236242.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@novoselt](#comment:4):\n> Why QQ was added in the last line? It seems to me that a saturated sublattice should be constructed there, without any fractional generators.\n\nI don't completely understand what you mean, but the problem is that `base_cone_preimg` can have coefficients in `QQ`. So either we add `QQ` there, or we change the `span()` method to not default to `ZZ`.",
    "created_at": "2015-01-05T22:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236242",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@novoselt](#comment:4):
> Why QQ was added in the last line? It seems to me that a saturated sublattice should be constructed there, without any fractional generators.

I don't completely understand what you mean, but the problem is that `base_cone_preimg` can have coefficients in `QQ`. So either we add `QQ` there, or we change the `span()` method to not default to `ZZ`.



---

archive/issue_comments_236243.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nBut the module is over ZZ for the sake of using saturation, which works differently for QQ:\n\n```\nsage: M = ZZ^3\nsage: M.span_of_basis([(1,1/2,1/3)])\nFree module of degree 3 and rank 1 over Integer Ring\nUser basis matrix:\n[  1 1/2 1/3]\nsage: _.saturation()\nFree module of degree 3 and rank 1 over Integer Ring\nEchelon basis matrix:\n[6 3 2]\nsage: M.span_of_basis([(1,1/2,1/3)], QQ)\nVector space of degree 3 and dimension 1 over Rational Field\nUser basis matrix:\n[  1 1/2 1/3]\nsage: _.saturation()\nVector space of degree 3 and dimension 1 over Rational Field\nUser basis matrix:\n[  1 1/2 1/3]\n```",
    "created_at": "2015-01-05T22:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236243",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:6" align="right">comment:6</div>

But the module is over ZZ for the sake of using saturation, which works differently for QQ:

```
sage: M = ZZ^3
sage: M.span_of_basis([(1,1/2,1/3)])
Free module of degree 3 and rank 1 over Integer Ring
User basis matrix:
[  1 1/2 1/3]
sage: _.saturation()
Free module of degree 3 and rank 1 over Integer Ring
Echelon basis matrix:
[6 3 2]
sage: M.span_of_basis([(1,1/2,1/3)], QQ)
Vector space of degree 3 and dimension 1 over Rational Field
User basis matrix:
[  1 1/2 1/3]
sage: _.saturation()
Vector space of degree 3 and dimension 1 over Rational Field
User basis matrix:
[  1 1/2 1/3]
```



---

archive/issue_comments_236244.json:
```json
{
    "body": "Changed commit from **[`ab9ada2`](https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc)** to **[`7a080f7`](https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5)**",
    "created_at": "2015-01-06T08:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236244",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ab9ada2`](https://github.com/sagemath/sagetrac-mirror/commit/ab9ada208a895e01f973b0df90075d61e865e0dc)** to **[`7a080f7`](https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5)**



---

archive/issue_comments_236245.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5\"><code>7a080f7</code></a></td><td><code>Add \"toric\" argument to span() and span_of_basis()</code></td></tr></table>\n",
    "created_at": "2015-01-06T08:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236245",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5"><code>7a080f7</code></a></td><td><code>Add "toric" argument to span() and span_of_basis()</code></td></tr></table>




---

archive/issue_events_250616.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-06T08:24:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250616"
}
```



---

archive/issue_events_250617.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-06T08:24:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250617"
}
```



---

archive/issue_comments_236246.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI think this is a better solution then.",
    "created_at": "2015-01-06T08:24:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236246",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

I think this is a better solution then.



---

archive/issue_comments_236247.json:
```json
{
    "body": "Changed commit from **[`7a080f7`](https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5)** to **[`7392a01`](https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668)**",
    "created_at": "2015-01-06T08:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236247",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7a080f7`](https://github.com/sagemath/sagetrac-mirror/commit/7a080f7a7570206003ab151ed6c0b92b46c73af5)** to **[`7392a01`](https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668)**



---

archive/issue_comments_236248.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668\"><code>7392a01</code></a></td><td><code>Remove unused import</code></td></tr></table>\n",
    "created_at": "2015-01-06T08:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236248",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668"><code>7392a01</code></a></td><td><code>Remove unused import</code></td></tr></table>




---

archive/issue_comments_236249.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI don't think such complications are necessary and what exactly is the point of this ticket? The example from the descriptions currently gives\n\n```\nsage: sage: N = ToricLattice(3)\nsage: sage: Ns = N.span_of_basis([(1,2,3)])\nsage: sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])\nSublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>\n```\nand perhaps this can be claimed as a bug unrelated to any coming changes - there is nothing wrong with the span call on fractional vectors, but calling it a sublattice is strange/wrong (even if it looks to me that I am the one who allowed it). The solution should be, I think: try to return a sublattice and if it does not work because given vectors are not integral or a different ring is requested - return a free module with the same dimension etc.\n\nIn particular there will be no need to mess with the morphism code at all.\n\nIt is a bit unfortunate that we have\n\n```\nsage: N.change_ring(QQ) is N.dual().change_ring(QQ)\nTrue\n```\nbut fixing it is quite a bit of work, since basically I want named modules which are isomorphic but have no canonical isomorphism, as it is the case with ``N`` and ``N.dual()``.",
    "created_at": "2015-01-07T20:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236249",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:10" align="right">comment:10</div>

I don't think such complications are necessary and what exactly is the point of this ticket? The example from the descriptions currently gives

```
sage: sage: N = ToricLattice(3)
sage: sage: Ns = N.span_of_basis([(1,2,3)])
sage: sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])
Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>
```
and perhaps this can be claimed as a bug unrelated to any coming changes - there is nothing wrong with the span call on fractional vectors, but calling it a sublattice is strange/wrong (even if it looks to me that I am the one who allowed it). The solution should be, I think: try to return a sublattice and if it does not work because given vectors are not integral or a different ring is requested - return a free module with the same dimension etc.

In particular there will be no need to mess with the morphism code at all.

It is a bit unfortunate that we have

```
sage: N.change_ring(QQ) is N.dual().change_ring(QQ)
True
```
but fixing it is quite a bit of work, since basically I want named modules which are isomorphic but have no canonical isomorphism, as it is the case with ``N`` and ``N.dual()``.



---

archive/issue_comments_236250.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@novoselt](#comment:10):\n> I don't think such complications are necessary and what exactly is the point of this ticket? The example from the descriptions currently gives\n> \n> ```\n> sage: sage: N = ToricLattice(3)\n> sage: sage: Ns = N.span_of_basis([(1,2,3)])\n> sage: sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])\n> Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>\n> ```\n> and perhaps this can be claimed as a bug unrelated to any coming changes - there is nothing wrong with the span call on fractional vectors, but calling it a sublattice is strange/wrong (even if it looks to me that I am the one who allowed it).\n\nWhat's wrong is this:\n\n```\nsage: N = ToricLattice(3)\nsage: Ns = N.span_of_basis([(1,2,3)])\nsage: M1 = Ns.span_of_basis([(1,2,0), (1,1,0)])\nsage: type(M1.basis()[0])\n<type 'sage.geometry.toric_lattice_element.ToricLatticeElement'>\nsage: M2 = Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])\nsage: type(M2.basis()[0])\n<type 'sage.modules.vector_rational_dense.Vector_rational_dense'>\n```\nYou have a `ToricLattice_generic`, but the basis consists simply of rational vectors, having nothing to do with lattices. The fact that this does *not* raise an exception is a bug which I'm fixing in #17585: if `ToricLattice_generic` states `Element = ToricLatticeElement`, the module code shouldn't change this.\n\n> The solution should be, I think: try to return a sublattice and if it does not work because given vectors are not integral or a different ring is requested - return a free module with the same dimension etc.\n\nThat *could* be a solution, but I prefer to be explicit. With my solution, you at least know and expect that the result won't be a toric lattice.",
    "created_at": "2015-01-07T21:42:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236250",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@novoselt](#comment:10):
> I don't think such complications are necessary and what exactly is the point of this ticket? The example from the descriptions currently gives
> 
> ```
> sage: sage: N = ToricLattice(3)
> sage: sage: Ns = N.span_of_basis([(1,2,3)])
> sage: sage: Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])
> Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>
> ```
> and perhaps this can be claimed as a bug unrelated to any coming changes - there is nothing wrong with the span call on fractional vectors, but calling it a sublattice is strange/wrong (even if it looks to me that I am the one who allowed it).

What's wrong is this:

```
sage: N = ToricLattice(3)
sage: Ns = N.span_of_basis([(1,2,3)])
sage: M1 = Ns.span_of_basis([(1,2,0), (1,1,0)])
sage: type(M1.basis()[0])
<type 'sage.geometry.toric_lattice_element.ToricLatticeElement'>
sage: M2 = Ns.span_of_basis([(1/5,2/5,0), (1/7,1/7,0)])
sage: type(M2.basis()[0])
<type 'sage.modules.vector_rational_dense.Vector_rational_dense'>
```
You have a `ToricLattice_generic`, but the basis consists simply of rational vectors, having nothing to do with lattices. The fact that this does *not* raise an exception is a bug which I'm fixing in #17585: if `ToricLattice_generic` states `Element = ToricLatticeElement`, the module code shouldn't change this.

> The solution should be, I think: try to return a sublattice and if it does not work because given vectors are not integral or a different ring is requested - return a free module with the same dimension etc.

That *could* be a solution, but I prefer to be explicit. With my solution, you at least know and expect that the result won't be a toric lattice.



---

archive/issue_comments_236251.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe span of given vectors over given field should either exist or not, and what it is should not depend on some strange keyword parameter whose existence is impossible to guess (and documenting them is not quite a solution - who will read `span` documentation for each class they use???\n\nToric lattices were designed to implement \"named\" copies of `ZZ^n` and their sublattices and (free) quotients. `Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>` or some generic toric lattice on these vectors most probably just should not exist.",
    "created_at": "2015-01-07T22:47:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236251",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:12" align="right">comment:12</div>

The span of given vectors over given field should either exist or not, and what it is should not depend on some strange keyword parameter whose existence is impossible to guess (and documenting them is not quite a solution - who will read `span` documentation for each class they use???

Toric lattices were designed to implement "named" copies of `ZZ^n` and their sublattices and (free) quotients. `Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>` or some generic toric lattice on these vectors most probably just should not exist.



---

archive/issue_comments_236252.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nVolker, do you have any preferences about it?",
    "created_at": "2015-01-07T22:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236252",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:13" align="right">comment:13</div>

Volker, do you have any preferences about it?



---

archive/issue_comments_236253.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWhats the question?\n* If possible then `M.span()` should raise an error if the given vectors do not lie in `M`\n* I don't mind a shortcut `M.span(..., base_ring=QQ)` for `M.change_ring(QQ).span(...)`.",
    "created_at": "2015-01-08T00:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236253",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">comment:14</div>

Whats the question?
* If possible then `M.span()` should raise an error if the given vectors do not lie in `M`
* I don't mind a shortcut `M.span(..., base_ring=QQ)` for `M.change_ring(QQ).span(...)`.



---

archive/issue_comments_236254.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@vbraun](#comment:14):\n> Whats the question?\n> * If possible then `M.span()` should raise an error if the given vectors do not lie in `M`\n> * I don't mind a shortcut `M.span(..., base_ring=QQ)` for `M.change_ring(QQ).span(...)`.\n\nMy objection is to `toric` in `M.span(..., toric=True/False)` as obscure.\n\nWhether it is OK to call `M.span(...)` for vectors not in `M` but in `M.change_ring(QQ)` is a more general question. Certainly it should be possible to make a module of integral combinations of rational vectors. The question is what should be the interface for it.",
    "created_at": "2015-01-08T00:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236254",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@vbraun](#comment:14):
> Whats the question?
> * If possible then `M.span()` should raise an error if the given vectors do not lie in `M`
> * I don't mind a shortcut `M.span(..., base_ring=QQ)` for `M.change_ring(QQ).span(...)`.

My objection is to `toric` in `M.span(..., toric=True/False)` as obscure.

Whether it is OK to call `M.span(...)` for vectors not in `M` but in `M.change_ring(QQ)` is a more general question. Certainly it should be possible to make a module of integral combinations of rational vectors. The question is what should be the interface for it.



---

archive/issue_comments_236255.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOh ok, I don't like the toric=True option either. \n\nCan we (easily) change the toric code so that we don't have to rely on `M_ZZ.span(QQ-vectors)` at all?",
    "created_at": "2015-01-08T01:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236255",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Oh ok, I don't like the toric=True option either. 

Can we (easily) change the toric code so that we don't have to rely on `M_ZZ.span(QQ-vectors)` at all?



---

archive/issue_comments_236256.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI think so - for the morphism code we care about directions only, as we are taking saturation in the end. A call to `normalize_rays` should work there without much performance loss. Will try to write a patch tomorrow - got to catch a bus!",
    "created_at": "2015-01-08T01:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236256",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:17" align="right">comment:17</div>

I think so - for the morphism code we care about directions only, as we are taking saturation in the end. A call to `normalize_rays` should work there without much performance loss. Will try to write a patch tomorrow - got to catch a bus!



---

archive/issue_comments_236257.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@novoselt](#comment:12):\n> `Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>` or some generic toric lattice on these vectors most probably just should not exist.\n\nAfter #17585 it won't exist anymore.",
    "created_at": "2015-01-08T08:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236257",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@novoselt](#comment:12):
> `Sublattice <(1/5, 2/5, 0), (1/7, 1/7, 0)>` or some generic toric lattice on these vectors most probably just should not exist.

After #17585 it won't exist anymore.



---

archive/issue_comments_236258.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17587)** to **[u/novoselt/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/ticket/17587)**",
    "created_at": "2015-01-08T20:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236258",
    "user": "https://github.com/novoselt"
}
```

Changed branch from **[u/jdemeyer/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17587)** to **[u/novoselt/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/ticket/17587)**



---

archive/issue_comments_236259.json:
```json
{
    "body": "Changed commit from **[`7392a01`](https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668)** to **[`9e13c1b`](https://github.com/sagemath/sagetrac-mirror/commit/9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57)**",
    "created_at": "2015-01-08T20:50:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236259",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`7392a01`](https://github.com/sagemath/sagetrac-mirror/commit/7392a01ee14245ddad6b13498fbeab40faa40668)** to **[`9e13c1b`](https://github.com/sagemath/sagetrac-mirror/commit/9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57)**



---

archive/issue_events_250618.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-08T20:52:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250618"
}
```



---

archive/issue_events_250619.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-08T20:52:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250619"
}
```



---

archive/issue_comments_236260.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe commit just points to\n\n```\ncommit 9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57\nAuthor: Volker Braun <vbraun.name@gmail.com>\nDate:   Mon Jan 5 22:57:05 2015 +0100\n\n    Updated Sage version to 6.5.beta5\n```",
    "created_at": "2015-01-08T20:52:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236260",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

The commit just points to

```
commit 9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57
Author: Volker Braun <vbraun.name@gmail.com>
Date:   Mon Jan 5 22:57:05 2015 +0100

    Updated Sage version to 6.5.beta5
```



---

archive/issue_comments_236261.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d\"><code>d941a17</code></a></td><td><code>Don't create toric sublattices with rational generators.</code></td></tr></table>\n",
    "created_at": "2015-01-08T21:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236261",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d"><code>d941a17</code></a></td><td><code>Don't create toric sublattices with rational generators.</code></td></tr></table>




---

archive/issue_comments_236262.json:
```json
{
    "body": "Changed commit from **[`9e13c1b`](https://github.com/sagemath/sagetrac-mirror/commit/9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57)** to **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**",
    "created_at": "2015-01-08T21:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236262",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9e13c1b`](https://github.com/sagemath/sagetrac-mirror/commit/9e13c1b5422e475827e3c3d3a5daf61a4b0ebc57)** to **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**



---

archive/issue_comments_236263.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nYes, I forgot to commit, but then though of a simpler way. Basically, I just create now generic module instead of a toric sublattice when generators are not integral. This is in line with how other `span` methods work and hopefully will be sufficient for the switch you are working on.",
    "created_at": "2015-01-08T21:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236263",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:23" align="right">comment:23</div>

Yes, I forgot to commit, but then though of a simpler way. Basically, I just create now generic module instead of a toric sublattice when generators are not integral. This is in line with how other `span` methods work and hopefully will be sufficient for the switch you are working on.



---

archive/issue_events_250620.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-09T05:17:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250620"
}
```



---

archive/issue_events_250621.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-09T05:17:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250621"
}
```



---

archive/issue_comments_236264.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2015-01-21T16:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236264",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_236265.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to none",
    "created_at": "2015-01-21T16:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236265",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jeroen Demeyer** to none



---

archive/issue_events_250622.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-21T16:31:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250622"
}
```



---

archive/issue_events_250623.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-21T16:31:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250623"
}
```



---

archive/issue_comments_236266.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI don't really like the solution, but it works and that suffices for me.",
    "created_at": "2015-01-21T16:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236266",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

I don't really like the solution, but it works and that suffices for me.



---

archive/issue_comments_236267.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nWhat exactly is the problem? I see two:\n1. `N.span` works at all for elements that do not generate a submodule of `N`.\n2. `N.span` for a toric lattice returns a non-toric thing.\nBut 1 is the way Sage works, so if it is changed it is better be changed everywhere and it will break a lot of user code too. As for 2 - writing custom classes for `N \\otimes QQ` and its submodule would be useful, but is not the top priority for me personally and we managed to go a long way in toric stuff without implementing it...",
    "created_at": "2015-01-21T18:46:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236267",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:26" align="right">comment:26</div>

What exactly is the problem? I see two:
1. `N.span` works at all for elements that do not generate a submodule of `N`.
2. `N.span` for a toric lattice returns a non-toric thing.
But 1 is the way Sage works, so if it is changed it is better be changed everywhere and it will break a lot of user code too. As for 2 - writing custom classes for `N \otimes QQ` and its submodule would be useful, but is not the top priority for me personally and we managed to go a long way in toric stuff without implementing it...



---

archive/issue_comments_236268.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@novoselt](#comment:26):\n> What exactly is the problem?\n\nMainly the fact that the difference between returning a toric lattice and a free module is done very implicitly. In particular, there is no way to force the returning of a free module (as opposed to a toric lattice).\n\nSage is supposed to have the philosophy that the *type* of the output should only depend on the *type* of the input, not the *values* of the input.",
    "created_at": "2015-01-21T19:11:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236268",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@novoselt](#comment:26):
> What exactly is the problem?

Mainly the fact that the difference between returning a toric lattice and a free module is done very implicitly. In particular, there is no way to force the returning of a free module (as opposed to a toric lattice).

Sage is supposed to have the philosophy that the *type* of the output should only depend on the *type* of the input, not the *values* of the input.



---

archive/issue_comments_236269.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nIn what situations will you **want** a non-toric output from a toric span? The reason for its current presence at all is that we don't have a toric implementation for the ambient vector space. One it is implemented, there will be no non-toric output at all. A technically clean resolution to it meanwhile is to raise `NotImplementedError` for some input, but I'd rather not.",
    "created_at": "2015-01-21T19:18:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236269",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:28" align="right">comment:28</div>

In what situations will you **want** a non-toric output from a toric span? The reason for its current presence at all is that we don't have a toric implementation for the ambient vector space. One it is implemented, there will be no non-toric output at all. A technically clean resolution to it meanwhile is to raise `NotImplementedError` for some input, but I'd rather not.



---

archive/issue_comments_236270.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@novoselt](#comment:28):\n> In what situations will you **want** a non-toric output from a toric span?\n\nI have no idea, I don't use this code, I only created this ticket because it broke #17585.",
    "created_at": "2015-01-21T19:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236270",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@novoselt](#comment:28):
> In what situations will you **want** a non-toric output from a toric span?

I have no idea, I don't use this code, I only created this ticket because it broke #17585.



---

archive/issue_comments_236271.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAuthor name is missing",
    "created_at": "2015-01-23T23:42:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236271",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:30" align="right">comment:30</div>

Author name is missing



---

archive/issue_events_250624.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-23T23:42:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250624"
}
```



---

archive/issue_events_250625.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-23T23:42:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250625"
}
```



---

archive/issue_events_250626.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-23T23:51:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250626"
}
```



---

archive/issue_events_250627.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-01-23T23:51:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250627"
}
```



---

archive/issue_comments_236272.json:
```json
{
    "body": "Author: **Andrey Novoseltsev**",
    "created_at": "2015-01-23T23:51:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236272",
    "user": "https://github.com/novoselt"
}
```

Author: **Andrey Novoseltsev**



---

archive/issue_events_250628.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-24T13:18:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250628"
}
```



---

archive/issue_events_250629.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8e01ad85790851161fbbc486e9a366aeffab0a98",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-01-24T13:18:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17587#event-250629"
}
```



---

archive/issue_comments_236273.json:
```json
{
    "body": "Changed branch from **[u/novoselt/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/ticket/17587)** to **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**",
    "created_at": "2015-01-24T13:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17587#issuecomment-236273",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/novoselt/ticket/17587](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/ticket/17587)** to **[`d941a17`](https://github.com/sagemath/sagetrac-mirror/commit/d941a1762c4cfd4da9d186992d19a80e572b6c4d)**
