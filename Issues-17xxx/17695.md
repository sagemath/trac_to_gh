# Issue 17695: Slightly fasten is_cyclotomic()

archive/issues_017458.json:
```json
{
    "body": "In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins by checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`. \n\nCC:  @fchapoton\n\nKeywords: cyclotomic polynomials\n\nBranch/Commit: a2a6f026794fb12e1d557d8ca6738c45d5ed937f\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Bruno Grenet\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17695\n\n",
    "closed_at": "2015-02-18T08:53:14Z",
    "created_at": "2015-01-30T10:55:24Z",
    "labels": [
        "component: number theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Slightly fasten is_cyclotomic()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17695",
    "user": "https://github.com/bgrenet"
}
```
In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins by checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`. 

CC:  @fchapoton

Keywords: cyclotomic polynomials

Branch/Commit: a2a6f026794fb12e1d557d8ca6738c45d5ed937f

Reviewer: Frédéric Chapoton

Author: Bruno Grenet

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17695





---

archive/issue_comments_248177.json:
```json
{
    "body": "Changing keywords from \"\" to \"cyclotomic polynomials\".",
    "created_at": "2015-01-30T13:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248177",
    "user": "https://github.com/bgrenet"
}
```

Changing keywords from "" to "cyclotomic polynomials".



---

archive/issue_comments_248178.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins with checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`.\n+In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins by checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`. \n \n Author: Bruno Grenet\n \n``````\n",
    "created_at": "2015-01-30T13:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248178",
    "user": "https://github.com/bgrenet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins with checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`.
+In `src/sage/rings/polynomial/polynomial_element.pyx`, the method `is_cyclotomic()` begins by checking the irreducibility of the input polynomial, and then checks the leading and constant coefficients. I simply propose to invert those tests to fasten a bit the test for polynomials that are not monic or whose constant coefficient is not `1`. 
 
 Author: Bruno Grenet
 
``````




---

archive/issue_comments_248179.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-01-30T13:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248179",
    "user": "https://github.com/bgrenet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_248180.json:
```json
{
    "body": "<a id='comment:3'></a>Hello Bruno,\n\nActually, I discussed this with Karim Belabas in Bordeaux few weeks ago. We should either call Pari or stick to their implementation. It is much faster:\n\n```\nsage: p = cyclotomic_polynomial(150)\nsage: pp = p._gp_()\nsage: timeit(\"pp.poliscyclo()\")\n625 loops, best of 3: 697 \u00b5s per loop\nsage: timeit(\"p.is_cyclotomic()\")\n125 loops, best of 3: 2.78 ms per loop\n```\nMoreover they do have the function `poliscycloprod` that checks if all roots are roots of unity (which is even faster).\n\nVincent",
    "created_at": "2015-01-30T15:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248180",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Hello Bruno,

Actually, I discussed this with Karim Belabas in Bordeaux few weeks ago. We should either call Pari or stick to their implementation. It is much faster:

```
sage: p = cyclotomic_polynomial(150)
sage: pp = p._gp_()
sage: timeit("pp.poliscyclo()")
625 loops, best of 3: 697 µs per loop
sage: timeit("p.is_cyclotomic()")
125 loops, best of 3: 2.78 ms per loop
```
Moreover they do have the function `poliscycloprod` that checks if all roots are roots of unity (which is even faster).

Vincent



---

archive/issue_comments_248181.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 vdelecroix]:\n> Hello Bruno,\n> \n> Actually, I discussed this with Karim Belabas in Bordeaux few weeks ago. We should either call Pari or stick to their implementation. It is much faster:\n> \n> ```\n> sage: p = cyclotomic_polynomial(150)\n> sage: pp = p._gp_()\n> sage: timeit(\"pp.poliscyclo()\")\n> 625 loops, best of 3: 697 \u00b5s per loop\n> sage: timeit(\"p.is_cyclotomic()\")\n> 125 loops, best of 3: 2.78 ms per loop\n> ```\n> Moreover they do have the function `poliscycloprod` that checks if all roots are roots of unity (which is even faster).\n> \n> Vincent\n\n\nIt is not surprising indeed that Pari is faster for this. I don't understand what you mean by\n> either call Pari or stick to their implementation.\n\nDo you mean there are two ways to use Pari's implementation?",
    "created_at": "2015-01-31T13:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248181",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:5'></a>Replying to [comment:3 vdelecroix]:
> Hello Bruno,
> 
> Actually, I discussed this with Karim Belabas in Bordeaux few weeks ago. We should either call Pari or stick to their implementation. It is much faster:
> 
> ```
> sage: p = cyclotomic_polynomial(150)
> sage: pp = p._gp_()
> sage: timeit("pp.poliscyclo()")
> 625 loops, best of 3: 697 µs per loop
> sage: timeit("p.is_cyclotomic()")
> 125 loops, best of 3: 2.78 ms per loop
> ```
> Moreover they do have the function `poliscycloprod` that checks if all roots are roots of unity (which is even faster).
> 
> Vincent


It is not surprising indeed that Pari is faster for this. I don't understand what you mean by
> either call Pari or stick to their implementation.

Do you mean there are two ways to use Pari's implementation?



---

archive/issue_comments_248182.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 bruno]:\n> Replying to [comment:3 vdelecroix]:\n> It is not surprising indeed that Pari is faster for this. I don't understand what you mean by\n> > either call Pari or stick to their implementation.\n\n> Do you mean there are two ways to use Pari's implementation? \n\nNope. Either we should copy their implementation within Sage (I do not think this is justified) or just call Pari.\n\nAnd by the way there are two ways of using pari. Either with `gp` (this is a pexpect interface with a lot of latency in communication) and with `libpari` (which is very efficient in C). But sadly there is not yet `poliscyclo` and `poliscycloprod` in the libpari interface (i.e. in the file `libs/pari/gen.pyx`). I guess that we should wait for #17631 and not modify `gen.pyx` directly.\n\nVincent",
    "created_at": "2015-01-31T14:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248182",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>Replying to [comment:5 bruno]:
> Replying to [comment:3 vdelecroix]:
> It is not surprising indeed that Pari is faster for this. I don't understand what you mean by
> > either call Pari or stick to their implementation.

> Do you mean there are two ways to use Pari's implementation? 

Nope. Either we should copy their implementation within Sage (I do not think this is justified) or just call Pari.

And by the way there are two ways of using pari. Either with `gp` (this is a pexpect interface with a lot of latency in communication) and with `libpari` (which is very efficient in C). But sadly there is not yet `poliscyclo` and `poliscycloprod` in the libpari interface (i.e. in the file `libs/pari/gen.pyx`). I guess that we should wait for #17631 and not modify `gen.pyx` directly.

Vincent



---

archive/issue_comments_248183.json:
```json
{
    "body": "<a id='comment:7'></a>A side remark:\n\nI would like to have a certificate (something like : this is the cyclotomic polynomial Phi_20)\n\nIs this allowed by the pari function ?",
    "created_at": "2015-02-02T13:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248183",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>A side remark:

I would like to have a certificate (something like : this is the cyclotomic polynomial Phi_20)

Is this allowed by the pari function ?



---

archive/issue_comments_248184.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 chapoton]:\n> A side remark:\n> \n> I would like to have a certificate (something like : this is the cyclotomic polynomial Phi_20)\n> \n> Is this allowed by the pari function ?\n\n\nOf course ;-) From pari documentation\n\n```\npoliscyclo(f): returns 0 if f is not a cyclotomic polynomial,\n               and n > 0 if f = Phi_n, the n-th cyclotomic polynomial.\n```\n\nand you can already use it\n\n```\nsage: R.<x> = ZZ[]\nsage: (x^2+x+1)._gp_().poliscyclo()\n3\nsage: (x^2-1)._gp_().poliscyclo()\n0\n```\n\nVincent",
    "created_at": "2015-02-04T13:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248184",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>Replying to [comment:7 chapoton]:
> A side remark:
> 
> I would like to have a certificate (something like : this is the cyclotomic polynomial Phi_20)
> 
> Is this allowed by the pari function ?


Of course ;-) From pari documentation

```
poliscyclo(f): returns 0 if f is not a cyclotomic polynomial,
               and n > 0 if f = Phi_n, the n-th cyclotomic polynomial.
```

and you can already use it

```
sage: R.<x> = ZZ[]
sage: (x^2+x+1)._gp_().poliscyclo()
3
sage: (x^2-1)._gp_().poliscyclo()
0
```

Vincent



---

archive/issue_comments_248185.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:6 vdelecroix]:\n> Replying to [comment:5 bruno]:\n> > Replying to [comment:3 vdelecroix]:\n> > It is not surprising indeed that Pari is faster for this. I don't understand what you mean by\n> > > either call Pari or stick to their implementation.\n\n> > Do you mean there are two ways to use Pari's implementation? \n> \n> Nope. Either we should copy their implementation within Sage (I do not think this is justified) or just call Pari.\n> \n> And by the way there are two ways of using pari. Either with `gp` (this is a pexpect interface with a lot of latency in communication) and with `libpari` (which is very efficient in C). But sadly there is not yet `poliscyclo` and `poliscycloprod` in the libpari interface (i.e. in the file `libs/pari/gen.pyx`). I guess that we should wait for #17631 and not modify `gen.pyx` directly.\n> \n> Vincent\n\n\n\nFor concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!",
    "created_at": "2015-02-04T13:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248185",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:9'></a>Replying to [comment:6 vdelecroix]:
> Replying to [comment:5 bruno]:
> > Replying to [comment:3 vdelecroix]:
> > It is not surprising indeed that Pari is faster for this. I don't understand what you mean by
> > > either call Pari or stick to their implementation.

> > Do you mean there are two ways to use Pari's implementation? 
> 
> Nope. Either we should copy their implementation within Sage (I do not think this is justified) or just call Pari.
> 
> And by the way there are two ways of using pari. Either with `gp` (this is a pexpect interface with a lot of latency in communication) and with `libpari` (which is very efficient in C). But sadly there is not yet `poliscyclo` and `poliscycloprod` in the libpari interface (i.e. in the file `libs/pari/gen.pyx`). I guess that we should wait for #17631 and not modify `gen.pyx` directly.
> 
> Vincent



For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!



---

archive/issue_comments_248186.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 bruno]:\n> For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!\n\n\nFor now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.\n\nVincent",
    "created_at": "2015-02-04T14:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248186",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>Replying to [comment:9 bruno]:
> For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!


For now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.

Vincent



---

archive/issue_comments_248187.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 vdelecroix]:\n> Replying to [comment:9 bruno]:\n> > For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!\n\n> \n> For now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.\n\n\nI am not sure to agree since it actually makes the function slower:\n\n```python\nsage: p = cyclotomic_polynomial(150)\nsage: %timeit p.is_cyclotomic()\n100 loops, best of 3: 2.75 ms per loop\nsage: %timeit p._gp_().poliscyclo()\n100 loops, best of 3: 3.96 ms per loop\n```\n\nAs an aside, isn't it a problem for a method named `is_cyclotomic()` to return an integer rather than a boolean? Of course, the certificate is interesting to have, and one can still test with `is_cyclotomic()` as before. It is just that I expect a method `is_...()` to return a boolean. Maybe I am wrong...",
    "created_at": "2015-02-04T14:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248187",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:11'></a>Replying to [comment:10 vdelecroix]:
> Replying to [comment:9 bruno]:
> > For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!

> 
> For now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.


I am not sure to agree since it actually makes the function slower:

```python
sage: p = cyclotomic_polynomial(150)
sage: %timeit p.is_cyclotomic()
100 loops, best of 3: 2.75 ms per loop
sage: %timeit p._gp_().poliscyclo()
100 loops, best of 3: 3.96 ms per loop
```

As an aside, isn't it a problem for a method named `is_cyclotomic()` to return an integer rather than a boolean? Of course, the certificate is interesting to have, and one can still test with `is_cyclotomic()` as before. It is just that I expect a method `is_...()` to return a boolean. Maybe I am wrong...



---

archive/issue_comments_248188.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 bruno]:\n> Replying to [comment:10 vdelecroix]:\n> > Replying to [comment:9 bruno]:\n> > > For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!\n\n> > \n> > For now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.\n\n> \n> I am not sure to agree since it actually makes the function slower:\n> \n> ```python\n> sage: p = cyclotomic_polynomial(150)\n> sage: %timeit p.is_cyclotomic()\n> 100 loops, best of 3: 2.75 ms per loop\n> sage: %timeit p._gp_().poliscyclo()\n> 100 loops, best of 3: 3.96 ms per loop\n> ```\n\n\nRight. Most of the time seems to be lost in the conversion\n\n```\nsage: l = [cyclotomic_polynomial(i) for i in range(2,50)]\nsage: timeit(\"for p in l: _ = p.is_cyclotomic()\")\n5 loops, best of 3: 51.7 ms per loop\nsage: timeit(\"for p in l: _ = p._gp_().poliscyclo()\")\n5 loops, best of 3: 303 ms per loop\nsage: lgp = [p._gp_() for p in l]\nsage: timeit(\"for p in lgp: _ = p.poliscyclo()\")\n25 loops, best of 3: 34.8 ms per loop\n```\n\n> As an aside, isn't it a problem for a method named `is_cyclotomic()` to return an integer rather than a boolean? Of course, the certificate is interesting to have, and one can still test with `is_cyclotomic()` as before. It is just that I expect a method `is_...()` to return a boolean. Maybe I am wrong...\n\n\nYou are right. The best option would be:\n\n```\ndef is_cyclotomic(self, certificate=False):\n    ...\n    return ans if certificate else bool(ans)\n```\n\n\nA compromise can be:\n- add the keyword `certificate` (if it is `True` we use `self._gp_().polisyclco()`)\n- do your initial suggested change\n- add a `TODO` to the documentation to switch from gp to pari (and open a ticket for it). We will then consider the fact of making it the default.\n\nVincent",
    "created_at": "2015-02-04T15:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248188",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>Replying to [comment:11 bruno]:
> Replying to [comment:10 vdelecroix]:
> > Replying to [comment:9 bruno]:
> > > For concreteness, what do you propose to do now? If I understand correctly, you propose to wait for #17631 and then make `is_cyclotomic()` directly call the pari functions, and not introduce the tiny change I made? I am fine with that, just wanted to be sure!

> > 
> > For now, we can already do the thing I proposed with the gp interface (and return the certificate instead of `True`/`False`). And we can also add a `TODO` section in the documentation saying that we should move to the pari interface as soon as #17631 is ready.

> 
> I am not sure to agree since it actually makes the function slower:
> 
> ```python
> sage: p = cyclotomic_polynomial(150)
> sage: %timeit p.is_cyclotomic()
> 100 loops, best of 3: 2.75 ms per loop
> sage: %timeit p._gp_().poliscyclo()
> 100 loops, best of 3: 3.96 ms per loop
> ```


Right. Most of the time seems to be lost in the conversion

```
sage: l = [cyclotomic_polynomial(i) for i in range(2,50)]
sage: timeit("for p in l: _ = p.is_cyclotomic()")
5 loops, best of 3: 51.7 ms per loop
sage: timeit("for p in l: _ = p._gp_().poliscyclo()")
5 loops, best of 3: 303 ms per loop
sage: lgp = [p._gp_() for p in l]
sage: timeit("for p in lgp: _ = p.poliscyclo()")
25 loops, best of 3: 34.8 ms per loop
```

> As an aside, isn't it a problem for a method named `is_cyclotomic()` to return an integer rather than a boolean? Of course, the certificate is interesting to have, and one can still test with `is_cyclotomic()` as before. It is just that I expect a method `is_...()` to return a boolean. Maybe I am wrong...


You are right. The best option would be:

```
def is_cyclotomic(self, certificate=False):
    ...
    return ans if certificate else bool(ans)
```


A compromise can be:
- add the keyword `certificate` (if it is `True` we use `self._gp_().polisyclco()`)
- do your initial suggested change
- add a `TODO` to the documentation to switch from gp to pari (and open a ticket for it). We will then consider the fact of making it the default.

Vincent



---

archive/issue_comments_248189.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 vdelecroix]:\n> A compromise can be:\n> - add the keyword `certificate` (if it is `True` we use `self._gp_().polisyclco()`)\n> - do your initial suggested change\n> - add a `TODO` to the documentation to switch from gp to pari (and open a ticket for it). We will then consider the fact of making it the default.\n\n\nI like this proposition, I'll do it.",
    "created_at": "2015-02-04T15:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248189",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:13'></a>Replying to [comment:12 vdelecroix]:
> A compromise can be:
> - add the keyword `certificate` (if it is `True` we use `self._gp_().polisyclco()`)
> - do your initial suggested change
> - add a `TODO` to the documentation to switch from gp to pari (and open a ticket for it). We will then consider the fact of making it the default.


I like this proposition, I'll do it.



---

archive/issue_comments_248190.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-04T21:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_248191.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-04T21:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248191",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_248192.json:
```json
{
    "body": "<a id='comment:15'></a>Just typographical comment. The `TODO` block must be indented. In other words\n\n```\n.. TODO::\n\n    As soon as #XYZ is finished we should do blih and blah.\n```\nHave a look to [Docstring section of the developer manual](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx).\n\nIt is `_gp_()` and not `__gp__()` (i.e. one underscore).\n\nI would move the `._gp_().poliscyclo()` below the tests for characteristic.\n\nVincent",
    "created_at": "2015-02-04T21:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248192",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Just typographical comment. The `TODO` block must be indented. In other words

```
.. TODO::

    As soon as #XYZ is finished we should do blih and blah.
```
Have a look to [Docstring section of the developer manual](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx).

It is `_gp_()` and not `__gp__()` (i.e. one underscore).

I would move the `._gp_().poliscyclo()` below the tests for characteristic.

Vincent



---

archive/issue_comments_248193.json:
```json
{
    "body": "<a id='comment:16'></a>I pushed too fast, and noticed my mistake on `__gp__()`. Actually, there are other ones. I'm correcting this.\n\nThanks anyway for the feedback, and especially for the documentation!",
    "created_at": "2015-02-04T21:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248193",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:16'></a>I pushed too fast, and noticed my mistake on `__gp__()`. Actually, there are other ones. I'm correcting this.

Thanks anyway for the feedback, and especially for the documentation!



---

archive/issue_comments_248194.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-04T21:40:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_248195.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-04T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248195",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_248196.json:
```json
{
    "body": "<a id='comment:19'></a>One more thing for the doc: for trac tickets you should use `:trac:`17730``. That will create automatically a link in the compiled documentation.\n\nMore seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.\n\nVincent",
    "created_at": "2015-02-04T22:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248196",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>One more thing for the doc: for trac tickets you should use `:trac:`17730``. That will create automatically a link in the compiled documentation.

More seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.

Vincent



---

archive/issue_comments_248197.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-04T22:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248197",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_248198.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:19 vdelecroix]:\n> One more thing for the doc: for trac tickets you should use `:trac:`17730``. That will create automatically a link in the compiled documentation.\n\n\nOK.\n \n> More seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.\n\n\nI do not understand your remark: irreducibility was tested as the first step before, and moving this test later is precisely the purpose of my ticket.",
    "created_at": "2015-02-04T22:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248198",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:21'></a>Replying to [comment:19 vdelecroix]:
> One more thing for the doc: for trac tickets you should use `:trac:`17730``. That will create automatically a link in the compiled documentation.


OK.
 
> More seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.


I do not understand your remark: irreducibility was tested as the first step before, and moving this test later is precisely the purpose of my ticket.



---

archive/issue_comments_248199.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:21 bruno]:\n> > More seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.\n\n> \n> I do not understand your remark: irreducibility was tested as the first step before, and moving this test later is precisely the purpose of my ticket.\n\n\nRight ;-) I will try a bit more optimization on my side.",
    "created_at": "2015-02-04T22:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248199",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>Replying to [comment:21 bruno]:
> > More seriously, we definitely do **not** want to test irreducibility at the beginning. You can possibly add this test in between step 2 and 3. That would prevent some useless factorization. But if you do so, I want to see some benchmarks first.

> 
> I do not understand your remark: irreducibility was tested as the first step before, and moving this test later is precisely the purpose of my ticket.


Right ;-) I will try a bit more optimization on my side.



---

archive/issue_comments_248200.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-04T22:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_248201.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-04T22:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248201",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_248202.json:
```json
{
    "body": "<a id='comment:25'></a>Actually, the factor at the end is overkill as we only want a square root. I did have a look at the method `.is_square()` and it was dirty enough to be slow. So I just make it simpler/clearer. The speedup is very small and concerns mostly positive cases.\n\nI am happy with your commits. Just review mine.\n\nVincent\n\n---\nNew commits:",
    "created_at": "2015-02-04T23:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248202",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>Actually, the factor at the end is overkill as we only want a square root. I did have a look at the method `.is_square()` and it was dirty enough to be slow. So I just make it simpler/clearer. The speedup is very small and concerns mostly positive cases.

I am happy with your commits. Just review mine.

Vincent

---
New commits:



---

archive/issue_comments_248203.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:25 vdelecroix]:\n> Actually, the factor at the end is overkill as we only want a square root. I did have a look at the method `.is_square()` and it was dirty enough to be slow. So I just make it simpler/clearer. The speedup is very small and concerns mostly positive cases.\n> \n> I am happy with your commits. Just review mine.\n\n\nI am fine with your commit too, but for one typo that I've corrected in the docstring of `is_square()`:\n\n```diff\n def is_square(self, root=False):\n\"\"\"\nReturns whether or not polynomial is square. If the optional\n- argument ``root`` is set to ``True, then also returns the square root\n+ argument ``root`` is set to ``True``, then also returns the square root\n(or ``None``, if the polynomial is not square).\n```\n\nI do not know whether it is acceptable for me to set \"positive review\". I let you do so if you consider everything's OK. Thanks for the patient feedback!\n\n---\nNew commits:",
    "created_at": "2015-02-06T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248203",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:27'></a>Replying to [comment:25 vdelecroix]:
> Actually, the factor at the end is overkill as we only want a square root. I did have a look at the method `.is_square()` and it was dirty enough to be slow. So I just make it simpler/clearer. The speedup is very small and concerns mostly positive cases.
> 
> I am happy with your commits. Just review mine.


I am fine with your commit too, but for one typo that I've corrected in the docstring of `is_square()`:

```diff
 def is_square(self, root=False):
"""
Returns whether or not polynomial is square. If the optional
- argument ``root`` is set to ``True, then also returns the square root
+ argument ``root`` is set to ``True``, then also returns the square root
(or ``None``, if the polynomial is not square).
```

I do not know whether it is acceptable for me to set "positive review". I let you do so if you consider everything's OK. Thanks for the patient feedback!

---
New commits:



---

archive/issue_comments_248204.json:
```json
{
    "body": "<a id='comment:28'></a>Looks good to me. I have just made a few typographical changes, so I allow myself to put this into positive review.\n\n---\nNew commits:",
    "created_at": "2015-02-06T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248204",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'></a>Looks good to me. I have just made a few typographical changes, so I allow myself to put this into positive review.

---
New commits:



---

archive/issue_comments_248205.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-06T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248205",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_248206.json:
```json
{
    "body": "<a id='comment:29'></a>Ho great! Nice catch!\n\nVincent",
    "created_at": "2015-02-06T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248206",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>Ho great! Nice catch!

Vincent



---

archive/issue_events_050644.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-18T08:53:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17695#event-50644"
}
```



---

archive/issue_comments_248207.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-18T08:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17695#issuecomment-248207",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
