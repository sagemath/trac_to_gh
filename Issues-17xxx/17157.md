# Issue 17157: Improve formula for Bell numbers

archive/issues_016920.json:
```json
{
    "body": "Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to\n\n1. code which is actually consistent with the mathematical formulas\n2. code which is cleaner and simpler than before\n3. a complete error estimate including the final real approximation\n4. faster code:\n\nBefore:\n\n```\nsage: timeit('bell_number(200)', number=2000)\n2000 loops, best of 3: 1.45 ms per loop\n```\n\nAfter:\n\n```\nsage: timeit('bell_number(200)', number=2000)\n2000 loops, best of 3: 441 \u00b5s per loop\n```\n\n**Branch/Commit:** [330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Jeroen Demeyer\n\n**Dependencies:** #16428, #15300\n\nIssue created by migration from https://trac.sagemath.org/ticket/17157\n\n",
    "closed_at": "2014-10-24T18:05:57Z",
    "created_at": "2014-10-15T08:35:38Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "Improve formula for Bell numbers",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/17157",
    "user": "https://github.com/jdemeyer"
}
```
Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to

1. code which is actually consistent with the mathematical formulas
2. code which is cleaner and simpler than before
3. a complete error estimate including the final real approximation
4. faster code:

Before:

```
sage: timeit('bell_number(200)', number=2000)
2000 loops, best of 3: 1.45 ms per loop
```

After:

```
sage: timeit('bell_number(200)', number=2000)
2000 loops, best of 3: 441 µs per loop
```

**Branch/Commit:** [330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)

**Reviewer:** Travis Scrimshaw

**Author:** Jeroen Demeyer

**Dependencies:** #16428, #15300

Issue created by migration from https://trac.sagemath.org/ticket/17157





---

archive/issue_comments_230088.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,6 +5,7 @@\n ```\n \n This can be improved by\n-1. Removing the `1 / 4` which is actually `0` in Python 2.\n-2. Not using global functions like `ceil()` and `exp()`.\n-3. Using a `RealField` instead of the `N()` function.\n+1. Using a `RealField` instead of the `N()` function.\n+2. Removing the `1 / 4` which is actually `0` in Python 2 and rounding up.\n+3. Removing the `-n` which is nowhere mentioned in the mathematical formula.\n+4. Not using global functions like `ceil()` and `exp()`.\n``````\n",
    "created_at": "2014-10-15T10:10:42Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230088",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,6 +5,7 @@
 ```
 
 This can be improved by
-1. Removing the `1 / 4` which is actually `0` in Python 2.
-2. Not using global functions like `ceil()` and `exp()`.
-3. Using a `RealField` instead of the `N()` function.
+1. Using a `RealField` instead of the `N()` function.
+2. Removing the `1 / 4` which is actually `0` in Python 2 and rounding up.
+3. Removing the `-n` which is nowhere mentioned in the mathematical formula.
+4. Not using global functions like `ceil()` and `exp()`.
``````




---

archive/issue_events_153997.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-15T20:45:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "rename": {
        "from": "Cleanup formula for Bell numbers",
        "to": "Improve formula for Bell numbers"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-153997"
}
```



---

archive/issue_comments_230089.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,11 +1 @@\n-In the function `bell_number`, we have the line\n-\n-```\n-return ZZ(ceil(N((b - n) / n2 * exp2(Integer(-1)) - 1 / 4, log(b, 2) + 3)))\n-```\n-\n-This can be improved by\n-1. Using a `RealField` instead of the `N()` function.\n-2. Removing the `1 / 4` which is actually `0` in Python 2 and rounding up.\n-3. Removing the `-n` which is nowhere mentioned in the mathematical formula.\n-4. Not using global functions like `ceil()` and `exp()`.\n+Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers.\n``````\n",
    "created_at": "2014-10-15T20:45:50Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230089",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,11 +1 @@
-In the function `bell_number`, we have the line
-
-```
-return ZZ(ceil(N((b - n) / n2 * exp2(Integer(-1)) - 1 / 4, log(b, 2) + 3)))
-```
-
-This can be improved by
-1. Using a `RealField` instead of the `N()` function.
-2. Removing the `1 / 4` which is actually `0` in Python 2 and rounding up.
-3. Removing the `-n` which is nowhere mentioned in the mathematical formula.
-4. Not using global functions like `ceil()` and `exp()`.
+Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers.
``````




---

archive/issue_events_153998.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-15T21:56:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-153998"
}
```



---

archive/issue_comments_230090.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n-Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers.\n+Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to\n+\n+1. code which is actually consistent with the mathematical formulas\n+2. code which is cleaner and simpler than before, hopefully slightly faster\n+3. a complete error estimate including the final real approximation\n``````\n",
    "created_at": "2014-10-15T21:56:27Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230090",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
-Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers.
+Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to
+
+1. code which is actually consistent with the mathematical formulas
+2. code which is cleaner and simpler than before, hopefully slightly faster
+3. a complete error estimate including the final real approximation
``````




---

archive/issue_comments_230091.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/ticket/17157](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17157)",
    "created_at": "2014-10-15T21:56:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230091",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/ticket/17157](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17157)



---

archive/issue_comments_230092.json:
```json
{
    "body": "**Commit:** [0266cef42895b095b8c7eca5718a1466300e1304](https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304)",
    "created_at": "2014-10-15T22:03:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230092",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [0266cef42895b095b8c7eca5718a1466300e1304](https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304)



---

archive/issue_comments_230093.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,20 @@\n Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to\n \n 1. code which is actually consistent with the mathematical formulas\n-2. code which is cleaner and simpler than before, hopefully slightly faster\n+2. code which is cleaner and simpler than before\n 3. a complete error estimate including the final real approximation\n+4. faster code:\n+\n+Before:\n+\n+```\n+sage: timeit('bell_number(200)', number=2000)\n+2000 loops, best of 3: 1.45 ms per loop\n+```\n+\n+After:\n+\n+```\n+sage: timeit('bell_number(200)', number=2000)\n+2000 loops, best of 3: 441 \u00b5s per loop\n+```\n``````\n",
    "created_at": "2014-10-15T22:03:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230093",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,20 @@
 Improve the error analysis for the implementation of Dobinski's formula to compute the Bell numbers leading to
 
 1. code which is actually consistent with the mathematical formulas
-2. code which is cleaner and simpler than before, hopefully slightly faster
+2. code which is cleaner and simpler than before
 3. a complete error estimate including the final real approximation
+4. faster code:
+
+Before:
+
+```
+sage: timeit('bell_number(200)', number=2000)
+2000 loops, best of 3: 1.45 ms per loop
+```
+
+After:
+
+```
+sage: timeit('bell_number(200)', number=2000)
+2000 loops, best of 3: 441 µs per loop
+```
``````




---

archive/issue_comments_230094.json:
```json
{
    "body": "<a id='comment:5'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304\">0266cef</a></td><td><code>Improve formula for Bell numbers</code></td></tr></table>\n",
    "created_at": "2014-10-15T22:03:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230094",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304">0266cef</a></td><td><code>Improve formula for Bell numbers</code></td></tr></table>




---

archive/issue_comments_230095.json:
```json
{
    "body": "<a id='comment:6'></a>\nYou might also consider wrapping flint's arith_bell_number. On this computer it seems to be about twice as fast as Sage's current bell_number(n, algorithm='dobinski') for n = 1000, 2000, 4000, 10000, 20000, 40000.",
    "created_at": "2014-10-16T13:30:12Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230095",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:6'></a>
You might also consider wrapping flint's arith_bell_number. On this computer it seems to be about twice as fast as Sage's current bell_number(n, algorithm='dobinski') for n = 1000, 2000, 4000, 10000, 20000, 40000.



---

archive/issue_comments_230096.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [fredrik.johansson](#comment%3A6):\n> Sage's current bell_number(n, algorithm='dobinski')\n\nWith or without this patch?",
    "created_at": "2014-10-16T13:37:35Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [fredrik.johansson](#comment%3A6):
> Sage's current bell_number(n, algorithm='dobinski')

With or without this patch?



---

archive/issue_comments_230097.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [fredrik.johansson](#comment%3A6):\n> You might also consider wrapping flint's arith_bell_number.\n\nIf I do so, will you review this ticket?",
    "created_at": "2014-10-16T13:43:52Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230097",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [fredrik.johansson](#comment%3A6):
> You might also consider wrapping flint's arith_bell_number.

If I do so, will you review this ticket?



---

archive/issue_comments_230098.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jdemeyer](#comment%3A7):\n> Replying to [fredrik.johansson](#comment%3A6):\n> > Sage's current bell_number(n, algorithm='dobinski')\n\n> With or without this patch?\n\nWithout. The difference is bigger for smaller n of course. Here is a more accurate comparison:\n\nflint:\n\n100  cpu/wall(s): 2.6e-05 2.68e-05\n200  cpu/wall(s): 8.2e-05 8.57e-05\n400  cpu/wall(s): 0.00039 0.000403\n1000  cpu/wall(s): 0.004 0.00441\n2000  cpu/wall(s): 0.023 0.026\n4000  cpu/wall(s): 0.16 0.172\n10000  cpu/wall(s): 0.91 0.949\n20000  cpu/wall(s): 4.02 4.173\n40000  cpu/wall(s): 18.12 21.109\n\nsage (without patch):\n\n100 5 loops, best of 3: 1.05 ms per loop\n200 625 loops, best of 3: 1.52 ms per loop\n400 125 loops, best of 3: 1.96 ms per loop\n1000 125 loops, best of 3: 7.39 ms per loop\n2000 5 loops, best of 3: 38 ms per loop\n4000 5 loops, best of 3: 216 ms per loop\n10000 5 loops, best of 3: 2.17 s per loop\n20000 1 loops, best of 3: 13 s per loop\n40000 1 loops, best of 3: 68 s per loop",
    "created_at": "2014-10-16T13:47:17Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230098",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:9'></a>
Replying to [jdemeyer](#comment%3A7):
> Replying to [fredrik.johansson](#comment%3A6):
> > Sage's current bell_number(n, algorithm='dobinski')

> With or without this patch?

Without. The difference is bigger for smaller n of course. Here is a more accurate comparison:

flint:

100  cpu/wall(s): 2.6e-05 2.68e-05
200  cpu/wall(s): 8.2e-05 8.57e-05
400  cpu/wall(s): 0.00039 0.000403
1000  cpu/wall(s): 0.004 0.00441
2000  cpu/wall(s): 0.023 0.026
4000  cpu/wall(s): 0.16 0.172
10000  cpu/wall(s): 0.91 0.949
20000  cpu/wall(s): 4.02 4.173
40000  cpu/wall(s): 18.12 21.109

sage (without patch):

100 5 loops, best of 3: 1.05 ms per loop
200 625 loops, best of 3: 1.52 ms per loop
400 125 loops, best of 3: 1.96 ms per loop
1000 125 loops, best of 3: 7.39 ms per loop
2000 5 loops, best of 3: 38 ms per loop
4000 5 loops, best of 3: 216 ms per loop
10000 5 loops, best of 3: 2.17 s per loop
20000 1 loops, best of 3: 13 s per loop
40000 1 loops, best of 3: 68 s per loop



---

archive/issue_comments_230099.json:
```json
{
    "body": "<a id='comment:10'></a>\nYou can just compute the sum in Dobinski's formula as an exact fraction (keeping the numerator and denominator separate, not actually dividing rational numbers by successive factorials). Indeed this is what flint does for n < 5000 (for larger n it uses a multimodular algorithm). This simplifies the error analysis.",
    "created_at": "2014-10-16T14:09:15Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230099",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:10'></a>
You can just compute the sum in Dobinski's formula as an exact fraction (keeping the numerator and denominator separate, not actually dividing rational numbers by successive factorials). Indeed this is what flint does for n < 5000 (for larger n it uses a multimodular algorithm). This simplifies the error analysis.



---

archive/issue_comments_230100.json:
```json
{
    "body": "<a id='comment:11'></a>\nWhich reminds me that flint is missing two tricks: firstly, batch computing all the powers `1^n, 3^n, 5^n, ..., N^n` using sieving (one multiplication for every odd index, then one shift for every even index), and secondly, only working with approximate values of the powers near the end of that list.\n\nThe first trick would use much more memory, of course, but that's fine as one can fall back to the multimodular algorithm for very large n anyway.",
    "created_at": "2014-10-16T14:28:32Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230100",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:11'></a>
Which reminds me that flint is missing two tricks: firstly, batch computing all the powers `1^n, 3^n, 5^n, ..., N^n` using sieving (one multiplication for every odd index, then one shift for every even index), and secondly, only working with approximate values of the powers near the end of that list.

The first trick would use much more memory, of course, but that's fine as one can fall back to the multimodular algorithm for very large n anyway.



---

archive/issue_comments_230101.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9\">58984af</a></td><td><code>Round down instead of up</code></td></tr></table>\n",
    "created_at": "2014-10-20T19:36:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230101",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9">58984af</a></td><td><code>Round down instead of up</code></td></tr></table>




---

archive/issue_comments_230102.json:
```json
{
    "body": "**Changing commit** from \"[0266cef42895b095b8c7eca5718a1466300e1304](https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304)\" to \"[58984af74dcf78a93b3751d7d25862168f8528a9](https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9)\".",
    "created_at": "2014-10-20T19:36:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230102",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0266cef42895b095b8c7eca5718a1466300e1304](https://github.com/sagemath/sagetrac-mirror/commit/0266cef42895b095b8c7eca5718a1466300e1304)" to "[58984af74dcf78a93b3751d7d25862168f8528a9](https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9)".



---

archive/issue_comments_230103.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jdemeyer](#comment%3A8):\n> Replying to [fredrik.johansson](#comment%3A6):\n> > You might also consider wrapping flint's arith_bell_number.\n\n> If I do so, will you review this ticket?\n\nI will review it if you do so. I'm for including access to multiple implementations.",
    "created_at": "2014-10-23T14:23:30Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230103",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
Replying to [jdemeyer](#comment%3A8):
> Replying to [fredrik.johansson](#comment%3A6):
> > You might also consider wrapping flint's arith_bell_number.

> If I do so, will you review this ticket?

I will review it if you do so. I'm for including access to multiple implementations.



---

archive/issue_comments_230104.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce226027dfea0ea4a3c5fabee069c70a826a9790\">ce22602</a></td><td><code>Cleanup/reorganization of FLINT imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc177409e274f01611a4bb7ae71623ee48ce655d\">fc17740</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/ticket/16428' into mpir</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a669ec721367f83dfdcc456156f06051daea124e\">a669ec7</a></td><td><code>Fix test in cython.py for new FLINT layout.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b69be0da26e43f9454e676867afb54de530d2a58\">b69be0d</a></td><td><code>Fix some ctypedef in FLINT pxd files.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5851a8597033314c6338d90f9c0ec12910aa8a2a\">5851a85</a></td><td><code>Merge commit 'b69be0da26e43f9454e676867afb54de530d2a58' into HEAD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797\">c93c4e9</a></td><td><code>Add FLINT implementation of Bell numbers</code></td></tr></table>\n",
    "created_at": "2014-10-23T14:51:15Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce226027dfea0ea4a3c5fabee069c70a826a9790">ce22602</a></td><td><code>Cleanup/reorganization of FLINT imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc177409e274f01611a4bb7ae71623ee48ce655d">fc17740</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/ticket/16428' into mpir</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a669ec721367f83dfdcc456156f06051daea124e">a669ec7</a></td><td><code>Fix test in cython.py for new FLINT layout.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b69be0da26e43f9454e676867afb54de530d2a58">b69be0d</a></td><td><code>Fix some ctypedef in FLINT pxd files.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5851a8597033314c6338d90f9c0ec12910aa8a2a">5851a85</a></td><td><code>Merge commit 'b69be0da26e43f9454e676867afb54de530d2a58' into HEAD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797">c93c4e9</a></td><td><code>Add FLINT implementation of Bell numbers</code></td></tr></table>




---

archive/issue_comments_230105.json:
```json
{
    "body": "**Changing commit** from \"[58984af74dcf78a93b3751d7d25862168f8528a9](https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9)\" to \"[c93c4e92544c2cc2cca5119b95a31b0e62969797](https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797)\".",
    "created_at": "2014-10-23T14:51:15Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[58984af74dcf78a93b3751d7d25862168f8528a9](https://github.com/sagemath/sagetrac-mirror/commit/58984af74dcf78a93b3751d7d25862168f8528a9)" to "[c93c4e92544c2cc2cca5119b95a31b0e62969797](https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797)".



---

archive/issue_comments_230106.json:
```json
{
    "body": "**Dependencies:** #16428",
    "created_at": "2014-10-23T15:43:38Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230106",
    "user": "https://github.com/tscrim"
}
```

**Dependencies:** #16428



---

archive/issue_comments_230107.json:
```json
{
    "body": "<a id='comment:15'></a>\nWaiting now for all my cython files to recompile.",
    "created_at": "2014-10-23T15:43:38Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230107",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>
Waiting now for all my cython files to recompile.



---

archive/issue_comments_230108.json:
```json
{
    "body": "<a id='comment:16'></a>\nSome timings:\n\n```\nsage: %timeit bell_number(200)\n1000 loops, best of 3: 612 \u00b5s per loop\nsage: %timeit bell_number(200, algorithm='dobinski')\n100 loops, best of 3: 2.2 ms per loop\nsage: %timeit bell_number(200, algorithm='gap')\n1 loops, best of 3: 21 ms per loop\nsage: %timeit bell_number(200, algorithm='mpmath')\n10 loops, best of 3: 21.2 ms per loop\n\nsage: %timeit bell_number(1000)\n10 loops, best of 3: 40.1 ms per loop\nsage: %timeit bell_number(1000, algorithm='dobinski')\n10 loops, best of 3: 49.5 ms per loop\nsage: %timeit bell_number(1000, algorithm='gap')\n1 loops, best of 3: 1.58 s per loop\nsage: %timeit bell_number(1000, algorithm='mpmath')\n1 loops, best of 3: 737 ms per loop\n\nsage: %timeit bell_number(10000, algorithm='flint')\n1 loops, best of 3: 3.57 s per loop\nsage: %timeit bell_number(10000, algorithm='dobinski')\n1 loops, best of 3: 20 s per loop\n```\n\nSo LGTM.",
    "created_at": "2014-10-23T16:32:46Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230108",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>
Some timings:

```
sage: %timeit bell_number(200)
1000 loops, best of 3: 612 µs per loop
sage: %timeit bell_number(200, algorithm='dobinski')
100 loops, best of 3: 2.2 ms per loop
sage: %timeit bell_number(200, algorithm='gap')
1 loops, best of 3: 21 ms per loop
sage: %timeit bell_number(200, algorithm='mpmath')
10 loops, best of 3: 21.2 ms per loop

sage: %timeit bell_number(1000)
10 loops, best of 3: 40.1 ms per loop
sage: %timeit bell_number(1000, algorithm='dobinski')
10 loops, best of 3: 49.5 ms per loop
sage: %timeit bell_number(1000, algorithm='gap')
1 loops, best of 3: 1.58 s per loop
sage: %timeit bell_number(1000, algorithm='mpmath')
1 loops, best of 3: 737 ms per loop

sage: %timeit bell_number(10000, algorithm='flint')
1 loops, best of 3: 3.57 s per loop
sage: %timeit bell_number(10000, algorithm='dobinski')
1 loops, best of 3: 20 s per loop
```

So LGTM.



---

archive/issue_comments_230109.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2014-10-23T16:32:46Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230109",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_events_153999.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-10-23T16:32:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-153999"
}
```



---

archive/issue_events_154000.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-10-23T16:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154000"
}
```



---

archive/issue_events_154001.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-23T19:19:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154001"
}
```



---

archive/issue_events_154002.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-23T19:19:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154002"
}
```



---

archive/issue_comments_230110.json:
```json
{
    "body": "<a id='comment:17'></a>\nConflicts with #15300 most likely",
    "created_at": "2014-10-23T19:19:33Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230110",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>
Conflicts with #15300 most likely



---

archive/issue_comments_230111.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/165f943b828ca2a7f743139d101f9c9c913e96ac\">165f943</a></td><td><code>Rewrite Weyl algebra and reviewer suggestions added.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34c9b4c2300549a06d7dc27758527c5915fe76bf\">34c9b4c</a></td><td><code>Changes from the reviewers.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b47af6ae9f8dd1e6d870ec986f81fb6913d12e16\">b47af6a</a></td><td><code>A minor tweaking of the doc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53a9d7e6e93156fbf36fcfc0bf2c9b1109a1a679\">53a9d7e</a></td><td><code>Families return output based on order of variable names. Fixed coercion issue.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/339b71d736c66aba83aa60899578558a0d182fca\">339b71d</a></td><td><code>Fixed some typos.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ce3f6ae55342d823bb971d5b11d1a36969a9f99\">3ce3f6a</a></td><td><code>Merge branch 'public/algebras/weyl_clifford-15300' of git://trac.sagemath.org/sage into clifford</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86982750ec7fcf5a9a531702ee038dc26cadb401\">8698275</a></td><td><code>lifting bilinear forms onto exterior algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a002f4b47f23dea0b0dcd7b5dbf80a98af85b091\">a002f4b</a></td><td><code>Some tweaks to lifted_bilinear_form and fixed doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff27bdc5d87967d0e7fd5c1305cef4340db816c7\">ff27bdc</a></td><td><code>further fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9\">330617c</a></td><td><code>Merge commit 'ff27bdc5d87967d0e7fd5c1305cef4340db816c7' into ticket/17157</code></td></tr></table>\n",
    "created_at": "2014-10-23T19:27:06Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230111",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/165f943b828ca2a7f743139d101f9c9c913e96ac">165f943</a></td><td><code>Rewrite Weyl algebra and reviewer suggestions added.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34c9b4c2300549a06d7dc27758527c5915fe76bf">34c9b4c</a></td><td><code>Changes from the reviewers.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b47af6ae9f8dd1e6d870ec986f81fb6913d12e16">b47af6a</a></td><td><code>A minor tweaking of the doc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53a9d7e6e93156fbf36fcfc0bf2c9b1109a1a679">53a9d7e</a></td><td><code>Families return output based on order of variable names. Fixed coercion issue.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/339b71d736c66aba83aa60899578558a0d182fca">339b71d</a></td><td><code>Fixed some typos.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ce3f6ae55342d823bb971d5b11d1a36969a9f99">3ce3f6a</a></td><td><code>Merge branch 'public/algebras/weyl_clifford-15300' of git://trac.sagemath.org/sage into clifford</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86982750ec7fcf5a9a531702ee038dc26cadb401">8698275</a></td><td><code>lifting bilinear forms onto exterior algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a002f4b47f23dea0b0dcd7b5dbf80a98af85b091">a002f4b</a></td><td><code>Some tweaks to lifted_bilinear_form and fixed doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff27bdc5d87967d0e7fd5c1305cef4340db816c7">ff27bdc</a></td><td><code>further fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9">330617c</a></td><td><code>Merge commit 'ff27bdc5d87967d0e7fd5c1305cef4340db816c7' into ticket/17157</code></td></tr></table>




---

archive/issue_comments_230112.json:
```json
{
    "body": "**Changing commit** from \"[c93c4e92544c2cc2cca5119b95a31b0e62969797](https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797)\" to \"[330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)\".",
    "created_at": "2014-10-23T19:27:06Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c93c4e92544c2cc2cca5119b95a31b0e62969797](https://github.com/sagemath/sagetrac-mirror/commit/c93c4e92544c2cc2cca5119b95a31b0e62969797)" to "[330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)".



---

archive/issue_events_154003.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-23T19:27:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154003"
}
```



---

archive/issue_events_154004.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-23T19:27:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154004"
}
```



---

archive/issue_comments_230113.json:
```json
{
    "body": "**Changing dependencies** from \"#16428\" to \"#16428, #15300\".",
    "created_at": "2014-10-23T19:27:54Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230113",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#16428" to "#16428, #15300".



---

archive/issue_comments_230114.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/165f943b828ca2a7f743139d101f9c9c913e96ac\">165f943</a></td><td><code>Rewrite Weyl algebra and reviewer suggestions added.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34c9b4c2300549a06d7dc27758527c5915fe76bf\">34c9b4c</a></td><td><code>Changes from the reviewers.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b47af6ae9f8dd1e6d870ec986f81fb6913d12e16\">b47af6a</a></td><td><code>A minor tweaking of the doc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53a9d7e6e93156fbf36fcfc0bf2c9b1109a1a679\">53a9d7e</a></td><td><code>Families return output based on order of variable names. Fixed coercion issue.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/339b71d736c66aba83aa60899578558a0d182fca\">339b71d</a></td><td><code>Fixed some typos.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ce3f6ae55342d823bb971d5b11d1a36969a9f99\">3ce3f6a</a></td><td><code>Merge branch 'public/algebras/weyl_clifford-15300' of git://trac.sagemath.org/sage into clifford</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86982750ec7fcf5a9a531702ee038dc26cadb401\">8698275</a></td><td><code>lifting bilinear forms onto exterior algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a002f4b47f23dea0b0dcd7b5dbf80a98af85b091\">a002f4b</a></td><td><code>Some tweaks to lifted_bilinear_form and fixed doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff27bdc5d87967d0e7fd5c1305cef4340db816c7\">ff27bdc</a></td><td><code>further fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9\">330617c</a></td><td><code>Merge commit 'ff27bdc5d87967d0e7fd5c1305cef4340db816c7' into ticket/17157</code></td></tr></table>\n",
    "created_at": "2014-10-23T19:27:54Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230114",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/165f943b828ca2a7f743139d101f9c9c913e96ac">165f943</a></td><td><code>Rewrite Weyl algebra and reviewer suggestions added.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34c9b4c2300549a06d7dc27758527c5915fe76bf">34c9b4c</a></td><td><code>Changes from the reviewers.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b47af6ae9f8dd1e6d870ec986f81fb6913d12e16">b47af6a</a></td><td><code>A minor tweaking of the doc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53a9d7e6e93156fbf36fcfc0bf2c9b1109a1a679">53a9d7e</a></td><td><code>Families return output based on order of variable names. Fixed coercion issue.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/339b71d736c66aba83aa60899578558a0d182fca">339b71d</a></td><td><code>Fixed some typos.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ce3f6ae55342d823bb971d5b11d1a36969a9f99">3ce3f6a</a></td><td><code>Merge branch 'public/algebras/weyl_clifford-15300' of git://trac.sagemath.org/sage into clifford</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86982750ec7fcf5a9a531702ee038dc26cadb401">8698275</a></td><td><code>lifting bilinear forms onto exterior algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a002f4b47f23dea0b0dcd7b5dbf80a98af85b091">a002f4b</a></td><td><code>Some tweaks to lifted_bilinear_form and fixed doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff27bdc5d87967d0e7fd5c1305cef4340db816c7">ff27bdc</a></td><td><code>further fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9">330617c</a></td><td><code>Merge commit 'ff27bdc5d87967d0e7fd5c1305cef4340db816c7' into ticket/17157</code></td></tr></table>




---

archive/issue_comments_230115.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/ticket/17157](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17157)\" to \"[330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)\".",
    "created_at": "2014-10-24T18:05:57Z",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17157#issuecomment-230115",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/ticket/17157](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/17157)" to "[330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9](https://github.com/sagemath/sagetrac-mirror/commit/330617caa6e52c1cc5d7b67ae41fd5cf30ef8dc9)".



---

archive/issue_events_154005.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-24T18:05:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154005"
}
```



---

archive/issue_events_154006.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-24T18:05:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17157",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17157#event-154006"
}
```
