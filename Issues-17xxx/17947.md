# Issue 17947: implement the cluster fans

archive/issues_017710.json:
```json
{
    "body": "CC:  gmoose05 @jplab\n\nKeywords: cluster, fan, Sage Days 64.5\n\nFans play an important role in cluster algebra theory. Let's have them in.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17947\n\n",
    "closed_at": "2015-10-16T18:42:44Z",
    "created_at": "2015-03-13T15:20:16Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "implement the cluster fans",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17947",
    "user": "https://github.com/fchapoton"
}
```
CC:  gmoose05 @jplab

Keywords: cluster, fan, Sage Days 64.5

Fans play an important role in cluster algebra theory. Let's have them in.

Issue created by migration from https://trac.sagemath.org/ticket/17947





---

archive/issue_comments_236492.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-13T15:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236492",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236493.json:
```json
{
    "body": "Changing keywords from \"\" to \"cluster, fan\".",
    "created_at": "2015-03-13T15:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236493",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "cluster, fan".



---

archive/issue_comments_236494.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-03-13T15:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236494",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_236495.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-13T15:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236496.json:
```json
{
    "body": "Care to define it in the docstring?\n\nI've always wanted to understand what Nathan is talking about all the time, but I never got over my laziness to read up on it. I guess this is my chance :) Thanks a lot.",
    "created_at": "2015-03-13T17:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236496",
    "user": "https://github.com/darijgr"
}
```

Care to define it in the docstring?

I've always wanted to understand what Nathan is talking about all the time, but I never got over my laziness to read up on it. I guess this is my chance :) Thanks a lot.



---

archive/issue_comments_236497.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-16T16:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236498.json:
```json
{
    "body": "Thanks -- this makes things a lot less scarier. I feel I need some more help, though. Is a simplicial fan the same as a simplicial complex but with \"simplex\" replaced by \"simplicial cone\"? How exactly do the vectors `d` in `\\ZZ^n` give rise to a cone? Is the cone corresponding to a cluster simply the set of all nonnegative linear combinations of the denominator vectors? What is a smooth fan? Why do you require acyclicity; isn't finite-type enough?",
    "created_at": "2015-03-17T01:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236498",
    "user": "https://github.com/darijgr"
}
```

Thanks -- this makes things a lot less scarier. I feel I need some more help, though. Is a simplicial fan the same as a simplicial complex but with "simplex" replaced by "simplicial cone"? How exactly do the vectors `d` in `\ZZ^n` give rise to a cone? Is the cone corresponding to a cluster simply the set of all nonnegative linear combinations of the denominator vectors? What is a smooth fan? Why do you require acyclicity; isn't finite-type enough?



---

archive/issue_comments_236499.json:
```json
{
    "body": "Replying to [comment:5 darij]:\n> Thanks -- this makes things a lot less scarier. I feel I need some more help, though.\n\n\nYes. I hope you do not want all these explanations to be written in the doc ?\n\n> Is a simplicial fan the same as a simplicial complex but with \"simplex\" replaced by \"simplicial cone\"? \n\n\nYes, essentially, but not quite because some convexity issues enter the definition. For the exact definition of a fan, see Fulton book on toric varieties for example. A simplicial fan is a fan where every cone is simplicial, namely has the minimal number of generators wrt its dimension.\n\n>How exactly do the vectors `d` in `\\ZZ^n` give rise to a cone?\n\n\nThe d associated with variables in a given cluster span the rays of a cone.\n\n>Is the cone corresponding to a cluster simply the set of all nonnegative linear combinations of the denominator vectors?\n\n\nYes.\n\n> What is a smooth fan? \n\n\na smooth fan is a simplicial fan such that each cone is smooth. A smooth cone is a simplicial cone whose rays define a basis of the lattice (they have determinant +-1)\n\nThis is related to the smoothness of the toric variety associated to the fan.\n\n> Why do you require acyclicity; isn't finite-type enough?\n\n\nNo, with this version of the fan. If you apply it to the cyclic quiver with 3 vertices, the result is not an interesting fan (in particular it is not smooth). There is maybe another version of the fan using the g-vector instead. I do not remember the details right now.",
    "created_at": "2015-03-17T08:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236499",
    "user": "https://github.com/fchapoton"
}
```

Replying to [comment:5 darij]:
> Thanks -- this makes things a lot less scarier. I feel I need some more help, though.


Yes. I hope you do not want all these explanations to be written in the doc ?

> Is a simplicial fan the same as a simplicial complex but with "simplex" replaced by "simplicial cone"? 


Yes, essentially, but not quite because some convexity issues enter the definition. For the exact definition of a fan, see Fulton book on toric varieties for example. A simplicial fan is a fan where every cone is simplicial, namely has the minimal number of generators wrt its dimension.

>How exactly do the vectors `d` in `\ZZ^n` give rise to a cone?


The d associated with variables in a given cluster span the rays of a cone.

>Is the cone corresponding to a cluster simply the set of all nonnegative linear combinations of the denominator vectors?


Yes.

> What is a smooth fan? 


a smooth fan is a simplicial fan such that each cone is smooth. A smooth cone is a simplicial cone whose rays define a basis of the lattice (they have determinant +-1)

This is related to the smoothness of the toric variety associated to the fan.

> Why do you require acyclicity; isn't finite-type enough?


No, with this version of the fan. If you apply it to the cyclic quiver with 3 vertices, the result is not an interesting fan (in particular it is not smooth). There is maybe another version of the fan using the g-vector instead. I do not remember the details right now.



---

archive/issue_comments_236500.json:
```json
{
    "body": "OK, I am not able to review this, but thank you a lot for the explanations. I still don't know what almost positive roots are, how `Cone` infers its lattice, etc., so I'll defer to someone more familiar with these things, though the code does look good to me.\n\n---\nNew commits:",
    "created_at": "2015-04-02T03:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236500",
    "user": "https://github.com/darijgr"
}
```

OK, I am not able to review this, but thank you a lot for the explanations. I still don't know what almost positive roots are, how `Cone` infers its lattice, etc., so I'll defer to someone more familiar with these things, though the code does look good to me.

---
New commits:



---

archive/issue_comments_236501.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-02T03:09:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_051061.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-15T06:39:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51061"
}
```



---

archive/issue_events_051062.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-05-22T20:26:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51062"
}
```



---

archive/issue_events_051063.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-05-22T20:26:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51063"
}
```



---

archive/issue_comments_236502.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-03T17:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236502",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236503.json:
```json
{
    "body": "I attempt my first Sage Days on cluster algebras, and I wanted to implant d-vector fans and g-vector fans. I realized that this was already partially done in this ticket. For the functions d_vector_fan and g_vector_fan to be coherent, I merged with #18588 which implements the d_matrix function.",
    "created_at": "2015-06-03T17:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236503",
    "user": "https://trac.sagemath.org/admin/accounts/users/vpilaud"
}
```

I attempt my first Sage Days on cluster algebras, and I wanted to implant d-vector fans and g-vector fans. I realized that this was already partially done in this ticket. For the functions d_vector_fan and g_vector_fan to be coherent, I merged with #18588 which implements the d_matrix function.



---

archive/issue_comments_236504.json:
```json
{
    "body": "Changing keywords from \"cluster, fan\" to \"cluster, fan, Sage Days 64.5\".",
    "created_at": "2015-06-03T17:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236504",
    "user": "https://trac.sagemath.org/admin/accounts/users/vpilaud"
}
```

Changing keywords from "cluster, fan" to "cluster, fan, Sage Days 64.5".



---

archive/issue_comments_236505.json:
```json
{
    "body": "Hi!\n\nI would be happy to review this ticket!\n\nIt will be quite handy!",
    "created_at": "2015-06-03T17:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236505",
    "user": "https://github.com/jplab"
}
```

Hi!

I would be happy to review this ticket!

It will be quite handy!



---

archive/issue_comments_236506.json:
```json
{
    "body": "Duplicate import\n\n```\n+        from cluster_seed import ClusterSeed\n+        from cluster_seed import ClusterSeed\n```",
    "created_at": "2015-06-05T07:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236506",
    "user": "https://github.com/fchapoton"
}
```

Duplicate import

```
+        from cluster_seed import ClusterSeed
+        from cluster_seed import ClusterSeed
```



---

archive/issue_comments_236507.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-05T07:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236507",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_236508.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-06T15:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236508",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236509.json:
```json
{
    "body": "There are blank lines that contain white spaces in the function d_vector_fan in the quiver.py file.\n\nOtherwise it looks good to me.",
    "created_at": "2015-06-07T09:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236509",
    "user": "https://github.com/jplab"
}
```

There are blank lines that contain white spaces in the function d_vector_fan in the quiver.py file.

Otherwise it looks good to me.



---

archive/issue_comments_236510.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-29T17:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236511.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-29T17:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236511",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_236512.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-12T08:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236512",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_051064.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-09-13T19:30:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51064"
}
```



---

archive/issue_events_051065.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-09-13T19:30:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51065"
}
```



---

archive/issue_comments_236513.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-25T12:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236513",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236514.json:
```json
{
    "body": "Ping ? The patchbot has given a green light !",
    "created_at": "2015-09-29T07:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236514",
    "user": "https://github.com/fchapoton"
}
```

Ping ? The patchbot has given a green light !



---

archive/issue_comments_236515.json:
```json
{
    "body": "Re-ping ? this should be an easy ticket !",
    "created_at": "2015-10-07T18:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236515",
    "user": "https://github.com/fchapoton"
}
```

Re-ping ? this should be an easy ticket !



---

archive/issue_comments_236516.json:
```json
{
    "body": "All test passed on sage-6.9.\n\nThis looks good to me. I set this as positive review.",
    "created_at": "2015-10-12T14:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236516",
    "user": "https://github.com/jplab"
}
```

All test passed on sage-6.9.

This looks good to me. I set this as positive review.



---

archive/issue_comments_236517.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-12T14:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236517",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236518.json:
```json
{
    "body": "Thanks a lot ! Maybe you could also look at #16209 ?",
    "created_at": "2015-10-12T16:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236518",
    "user": "https://github.com/fchapoton"
}
```

Thanks a lot ! Maybe you could also look at #16209 ?



---

archive/issue_events_051066.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-10-14T07:29:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51066"
}
```



---

archive/issue_events_051067.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-10-14T07:29:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51067"
}
```



---

archive/issue_comments_236519.json:
```json
{
    "body": "Just a PSA: Your ticket will never be merged if it depends on a invalid/wontfix ticket. At least not until that one is being merged into the git tree.",
    "created_at": "2015-10-15T19:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236519",
    "user": "https://github.com/vbraun"
}
```

Just a PSA: Your ticket will never be merged if it depends on a invalid/wontfix ticket. At least not until that one is being merged into the git tree.



---

archive/issue_comments_236520.json:
```json
{
    "body": "ok, thanks. Let us remove the dependency then. It has been taken care of in another ticket.",
    "created_at": "2015-10-15T19:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236520",
    "user": "https://github.com/fchapoton"
}
```

ok, thanks. Let us remove the dependency then. It has been taken care of in another ticket.



---

archive/issue_comments_236521.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-16T18:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17947#issuecomment-236521",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051068.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-16T18:42:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17947",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17947#event-51068"
}
```
