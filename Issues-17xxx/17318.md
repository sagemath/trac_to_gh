# Issue 17318: openssl-dependent tests in notebook_ipython should be marked optional

archive/issues_017081.json:
```json
{
    "body": "`IPython.html.notebookapp` unconditionally imports tornado, and tornado unconditionally imports the Python ssl module. This will fail if the openssl development stuff is not installed on the host. \n\nBranch/Commit: 3c4a96db3781b5b0384bee9048566da18e09e69a\n\nReviewer: Dima Pasechnik\n\nAuthor: Volker Braun\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17318\n\n",
    "closed_at": "2014-11-19T08:32:11Z",
    "created_at": "2014-11-12T09:43:02Z",
    "labels": [
        "component: notebook",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "openssl-dependent tests in notebook_ipython should be marked optional",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17318",
    "user": "https://github.com/dimpase"
}
```
`IPython.html.notebookapp` unconditionally imports tornado, and tornado unconditionally imports the Python ssl module. This will fail if the openssl development stuff is not installed on the host. 

Branch/Commit: 3c4a96db3781b5b0384bee9048566da18e09e69a

Reviewer: Dima Pasechnik

Author: Volker Braun

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17318





---

archive/issue_comments_293719.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+`IPython.html.notebookapp` unconditionally imports tornado, and tornado unconditionally imports the Python ssl module. This will fail if the openssl development stuff is not installed on the host. \n \n Component: interfaces\n \n``````\n",
    "created_at": "2014-11-13T17:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293719",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+`IPython.html.notebookapp` unconditionally imports tornado, and tornado unconditionally imports the Python ssl module. This will fail if the openssl development stuff is not installed on the host. 
 
 Component: interfaces
 
``````




---

archive/issue_comments_293720.json:
```json
{
    "body": "Changing component from interfaces to notebook.",
    "created_at": "2014-11-13T17:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293720",
    "user": "https://github.com/vbraun"
}
```

Changing component from interfaces to notebook.



---

archive/issue_comments_293721.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/openssl_dependent_tests_in_notebook_ipython_should_be_marked_optional\"",
    "created_at": "2014-11-13T17:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293721",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/openssl_dependent_tests_in_notebook_ipython_should_be_marked_optional"



---

archive/issue_comments_293722.json:
```json
{
    "body": "Changing commit from \"\" to \"3c4a96db3781b5b0384bee9048566da18e09e69a\"",
    "created_at": "2014-11-13T17:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293722",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "" to "3c4a96db3781b5b0384bee9048566da18e09e69a"



---

archive/issue_comments_293723.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun\"",
    "created_at": "2014-11-13T17:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293723",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Volker Braun"



---

archive/issue_comments_293724.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2014-11-13T17:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293724",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_293725.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-13T17:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293725",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_293726.json:
```json
{
    "body": "<a id='comment:4'></a>The problem is how to test if this does the thing without ssl installed.\nWould it be enough to build Sage and do not install openssl spkg?",
    "created_at": "2014-11-16T20:45:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293726",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>The problem is how to test if this does the thing without ssl installed.
Would it be enough to build Sage and do not install openssl spkg?



---

archive/issue_comments_293727.json:
```json
{
    "body": "<a id='comment:5'></a>easiest way is to rename `_ssl.so`",
    "created_at": "2014-11-16T21:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293727",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>easiest way is to rename `_ssl.so`



---

archive/issue_comments_293728.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 vbraun]:\n> easiest way is to rename `_ssl.so`then \n\n\nit seems to me that the patch goes too far in making tests pass no matter what. Indeed, if I do this renaming and do\n\n```\nsage -bt --long --optional=ssl src/sage/repl/ipython_extension.py\n```\nI see\n\n```\n...\n    [0 tests, 0.00 s]\n----------------------------------------------------------------------\nAll tests passed\n```\ninstead of a meaningful error.",
    "created_at": "2014-11-16T21:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293728",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>Replying to [comment:5 vbraun]:
> easiest way is to rename `_ssl.so`then 


it seems to me that the patch goes too far in making tests pass no matter what. Indeed, if I do this renaming and do

```
sage -bt --long --optional=ssl src/sage/repl/ipython_extension.py
```
I see

```
...
    [0 tests, 0.00 s]
----------------------------------------------------------------------
All tests passed
```
instead of a meaningful error.



---

archive/issue_comments_293729.json:
```json
{
    "body": "<a id='comment:7'></a>The only ssl dependence is in `src/sage/repl/notebook_ipython.py`",
    "created_at": "2014-11-16T21:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293729",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>The only ssl dependence is in `src/sage/repl/notebook_ipython.py`



---

archive/issue_comments_293730.json:
```json
{
    "body": "<a id='comment:8'></a>While running `sage -t --optional=ssl` I get failures like \n\n```\nFile \"src/sage/repl/notebook_ipython.py\", line 81, in sage.repl.notebook_ipython.SageNotebookApp.load_config_file\nFailed example:\n    app = SageNotebookApp()   # optional - ssl\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 851, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.notebook_ipython.SageNotebookApp.load_config_file[0]>\", line 1, in <module>\n        app = SageNotebookApp()   # optional - ssl\n    NameError: name 'SageNotebookApp' is not defined\n```\nwhile the same code works fine at the Sage prompt. Don't know what's going on here...",
    "created_at": "2014-11-17T09:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293730",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>While running `sage -t --optional=ssl` I get failures like 

```
File "src/sage/repl/notebook_ipython.py", line 81, in sage.repl.notebook_ipython.SageNotebookApp.load_config_file
Failed example:
    app = SageNotebookApp()   # optional - ssl
Exception raised:
    Traceback (most recent call last):
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 851, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.notebook_ipython.SageNotebookApp.load_config_file[0]>", line 1, in <module>
        app = SageNotebookApp()   # optional - ssl
    NameError: name 'SageNotebookApp' is not defined
```
while the same code works fine at the Sage prompt. Don't know what's going on here...



---

archive/issue_comments_293731.json:
```json
{
    "body": "<a id='comment:9'></a>You need `--optional=sage,ssl`.",
    "created_at": "2014-11-17T11:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293731",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>You need `--optional=sage,ssl`.



---

archive/issue_comments_293732.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 vbraun]:\n> You need `--optional=sage,ssl`.\n\n\nyeah, right. Sorry for noise.",
    "created_at": "2014-11-17T14:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293732",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>Replying to [comment:9 vbraun]:
> You need `--optional=sage,ssl`.


yeah, right. Sorry for noise.



---

archive/issue_comments_293733.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-17T14:28:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293733",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_293734.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2014-11-18T14:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293734",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_293735.json:
```json
{
    "body": "Changing branch from \"u/vbraun/openssl_dependent_tests_in_notebook_ipython_should_be_marked_optional\" to \"3c4a96db3781b5b0384bee9048566da18e09e69a\"",
    "created_at": "2014-11-19T08:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293735",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vbraun/openssl_dependent_tests_in_notebook_ipython_should_be_marked_optional" to "3c4a96db3781b5b0384bee9048566da18e09e69a"



---

archive/issue_comments_293736.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-19T08:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17318#issuecomment-293736",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_050014.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-19T08:32:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17318",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17318#event-50014"
}
```
