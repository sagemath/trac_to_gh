# Issue 17591: remove gdmodule

archive/issues_017354.json:
```json
{
    "body": "Separated from #15593.\n\nCC:  @jdemeyer\n\nBranch/Commit: [a12db779288e6a65fa1cf95f18e19ed84058be1b](https://github.com/sagemath/sagetrac-mirror/commit/a12db779288e6a65fa1cf95f18e19ed84058be1b)\n\nReviewer: Jeroen Demeyer\n\nAuthor: R. Andrew Ohana\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17591\n\n",
    "closed_at": "2015-04-21T14:08:50Z",
    "created_at": "2015-01-06T15:16:27Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "remove gdmodule",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17591",
    "user": "https://github.com/kcrisman"
}
```
Separated from #15593.

CC:  @jdemeyer

Branch/Commit: [a12db779288e6a65fa1cf95f18e19ed84058be1b](https://github.com/sagemath/sagetrac-mirror/commit/a12db779288e6a65fa1cf95f18e19ed84058be1b)

Reviewer: Jeroen Demeyer

Author: R. Andrew Ohana

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17591





---

archive/issue_comments_303849.json:
```json
{
    "body": "Changing commit from \"\" to \"d701c15354193da3ba02762ca61e6763a74b6b40\"",
    "created_at": "2015-01-06T15:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303849",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing commit from "" to "d701c15354193da3ba02762ca61e6763a74b6b40"



---

archive/issue_comments_303850.json:
```json
{
    "body": "<a id='comment:1'></a>\nJust pointing to the branch from #15593 since most of the work is about gdmodule (the sqlalchemy part is straightforward).",
    "created_at": "2015-01-06T15:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303850",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:1'></a>
Just pointing to the branch from #15593 since most of the work is about gdmodule (the sqlalchemy part is straightforward).



---

archive/issue_comments_303851.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ohanar/optionalize\"",
    "created_at": "2015-01-06T15:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303851",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing branch from "" to "u/ohanar/optionalize"



---

archive/issue_comments_303852.json:
```json
{
    "body": "Changing author from \"\" to \"R. Andrew Ohana\"",
    "created_at": "2015-01-06T16:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303852",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "R. Andrew Ohana"



---

archive/issue_comments_303853.json:
```json
{
    "body": "Changing branch from \"u/ohanar/optionalize\" to \"u/ohanar/remove_gdmodule\"",
    "created_at": "2015-01-07T03:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303853",
    "user": "https://github.com/ohanar"
}
```

Changing branch from "u/ohanar/optionalize" to "u/ohanar/remove_gdmodule"



---

archive/issue_comments_303854.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt is now rebased and just removes the package. All tests pass on my system.\n\n---\nNew commits:\n|                                                                                                                                          |                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[3e569b8](https://github.com/sagemath/sagetrac-mirror/commit/3e569b8a0ee56020cb6dc2861670f09081c8bccc)|`remove gdmodule`|",
    "created_at": "2015-01-07T03:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303854",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:3'></a>
It is now rebased and just removes the package. All tests pass on my system.

---
New commits:
|                                                                                                                                          |                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[3e569b8](https://github.com/sagemath/sagetrac-mirror/commit/3e569b8a0ee56020cb6dc2861670f09081c8bccc)|`remove gdmodule`|



---

archive/issue_comments_303855.json:
```json
{
    "body": "Changing commit from \"d701c15354193da3ba02762ca61e6763a74b6b40\" to \"3e569b8a0ee56020cb6dc2861670f09081c8bccc\"",
    "created_at": "2015-01-07T03:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303855",
    "user": "https://github.com/ohanar"
}
```

Changing commit from "d701c15354193da3ba02762ca61e6763a74b6b40" to "3e569b8a0ee56020cb6dc2861670f09081c8bccc"



---

archive/issue_comments_303856.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-01-07T03:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303856",
    "user": "https://github.com/ohanar"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_303857.json:
```json
{
    "body": "<a id='comment:5'></a>\nJust for the record,[comment:4](#comment%3A4):ticket:15593 says\n\n> I dislike\n\n{{{\nfn = open(filename, 'wb') # check filename\nfn.close()\n\ncdef FILE *out = fopen(filename, 'wb')\n\ngdImagePng(im, out)\n\nfclose(out)\n}}}\n> You can open the file using Python and access its FILE* with \u200bPyFile_AsFile.\n\n\nOut of curiosity, is this just a Python module now instead of a separate thing?",
    "created_at": "2015-01-08T14:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303857",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
Just for the record,[comment:4](#comment%3A4):ticket:15593 says

> I dislike

{{{
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')

gdImagePng(im, out)

fclose(out)
}}}
> You can open the file using Python and access its FILE* with ​PyFile_AsFile.


Out of curiosity, is this just a Python module now instead of a separate thing?



---

archive/issue_comments_303858.json:
```json
{
    "body": "<a id='comment:6'></a>\n> > You can open the file using Python and access its FILE* with \u200bPyFile_AsFile.\n\nRobert replied that my suggestion wouldn't work in Python 3, so it's not good either. But still, I dislike\n\n```\nfn = open(filename, 'wb') # check filename\nfn.close()\n\ncdef FILE *out = fopen(filename, 'wb')\n```\nIt would better be\n\n```\ncdef FILE *out = fopen(filename, 'wb')\nif not FILE:\n   raise ...\n```\n\n> Out of curiosity, is this just a Python module now instead of a separate thing?\n\nI don't understand this question.",
    "created_at": "2015-01-08T14:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303858",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
> > You can open the file using Python and access its FILE* with ​PyFile_AsFile.

Robert replied that my suggestion wouldn't work in Python 3, so it's not good either. But still, I dislike

```
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')
```
It would better be

```
cdef FILE *out = fopen(filename, 'wb')
if not FILE:
   raise ...
```

> Out of curiosity, is this just a Python module now instead of a separate thing?

I don't understand this question.



---

archive/issue_comments_303859.json:
```json
{
    "body": "<a id='comment:7'></a>\nI think that `src/sage/ext/gd.pxi` should be moved to `src/sage/libs/gd.pxd` and possibly `src/sage/libs/gd.pyx` for the wrapper functions.",
    "created_at": "2015-01-08T14:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303859",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I think that `src/sage/ext/gd.pxi` should be moved to `src/sage/libs/gd.pxd` and possibly `src/sage/libs/gd.pyx` for the wrapper functions.



---

archive/issue_comments_303860.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-08T14:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303860",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_303861.json:
```json
{
    "body": "<a id='comment:8'></a>\n> I don't understand this question.\n\nI was just curious why this was no longer necessary - apparently `gd` is still used, but directly now, I guess.  Why did we use `gdmodule` in the first place?",
    "created_at": "2015-01-08T14:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303861",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
> I don't understand this question.

I was just curious why this was no longer necessary - apparently `gd` is still used, but directly now, I guess.  Why did we use `gdmodule` in the first place?



---

archive/issue_comments_303862.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[a597814](https://github.com/sagemath/sagetrac-mirror/commit/a5978146023852ed5d415ed284c82558f8698b15)|`move gd.pxi -> gd.pxd`|",
    "created_at": "2015-01-08T20:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[a597814](https://github.com/sagemath/sagetrac-mirror/commit/a5978146023852ed5d415ed284c82558f8698b15)|`move gd.pxi -> gd.pxd`|



---

archive/issue_comments_303863.json:
```json
{
    "body": "Changing commit from \"3e569b8a0ee56020cb6dc2861670f09081c8bccc\" to \"a5978146023852ed5d415ed284c82558f8698b15\"",
    "created_at": "2015-01-08T20:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303863",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3e569b8a0ee56020cb6dc2861670f09081c8bccc" to "a5978146023852ed5d415ed284c82558f8698b15"



---

archive/issue_comments_303864.json:
```json
{
    "body": "<a id='comment:10'></a>\nI agree that the wrapper functions aren't ideal, but I didn't want to spend that much time on it. Part of the motivation of this ticket is to work towards python 3 compatibility, since when I did my evaluation on which sage dependencies weren't compatible with python 3, gdmodule was one of the few libraries that didn't have python 3 support (that may have changed since then, haven't looked into it).",
    "created_at": "2015-01-08T20:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303864",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:10'></a>
I agree that the wrapper functions aren't ideal, but I didn't want to spend that much time on it. Part of the motivation of this ticket is to work towards python 3 compatibility, since when I did my evaluation on which sage dependencies weren't compatible with python 3, gdmodule was one of the few libraries that didn't have python 3 support (that may have changed since then, haven't looked into it).



---

archive/issue_comments_303865.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-08T20:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303865",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_057384.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "rename": {
        "from": "remove gdmodule as standard package",
        "to": "remove gdmodule"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17591#event-57384"
}
```



---

archive/issue_comments_303866.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-17T16:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303866",
    "user": "https://github.com/a-andre"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_303867.json:
```json
{
    "body": "<a id='comment:11'></a>\nRemove the references to gdmodule from COPYING.txt.",
    "created_at": "2015-01-17T16:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303867",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:11'></a>
Remove the references to gdmodule from COPYING.txt.



---

archive/issue_comments_303868.json:
```json
{
    "body": "Changing commit from \"a5978146023852ed5d415ed284c82558f8698b15\" to \"6c243b06d8d61a9079f4e968d74d889ca786ec0f\"",
    "created_at": "2015-01-25T00:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a5978146023852ed5d415ed284c82558f8698b15" to "6c243b06d8d61a9079f4e968d74d889ca786ec0f"



---

archive/issue_comments_303869.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[6c243b0](https://github.com/sagemath/sagetrac-mirror/commit/6c243b06d8d61a9079f4e968d74d889ca786ec0f)|`remove gdmodule from COPYING.txt`|",
    "created_at": "2015-01-25T00:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[6c243b0](https://github.com/sagemath/sagetrac-mirror/commit/6c243b06d8d61a9079f4e968d74d889ca786ec0f)|`remove gdmodule from COPYING.txt`|



---

archive/issue_comments_303870.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-25T00:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303870",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_303871.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[a12db77](https://github.com/sagemath/sagetrac-mirror/commit/a12db779288e6a65fa1cf95f18e19ed84058be1b)|`remove gdmodule`|",
    "created_at": "2015-04-18T00:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[a12db77](https://github.com/sagemath/sagetrac-mirror/commit/a12db779288e6a65fa1cf95f18e19ed84058be1b)|`remove gdmodule`|



---

archive/issue_comments_303872.json:
```json
{
    "body": "Changing commit from \"6c243b06d8d61a9079f4e968d74d889ca786ec0f\" to \"a12db779288e6a65fa1cf95f18e19ed84058be1b\"",
    "created_at": "2015-04-18T00:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6c243b06d8d61a9079f4e968d74d889ca786ec0f" to "a12db779288e6a65fa1cf95f18e19ed84058be1b"



---

archive/issue_comments_303873.json:
```json
{
    "body": "<a id='comment:15'></a>\nThis should be much simpler to review now - all our previous usage of gdmodule was removed in one of the recent display manager changes.",
    "created_at": "2015-04-18T00:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303873",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:15'></a>
This should be much simpler to review now - all our previous usage of gdmodule was removed in one of the recent display manager changes.



---

archive/issue_events_057385.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-04-21T09:25:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17591#event-57385"
}
```



---

archive/issue_comments_303874.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2015-04-21T09:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303874",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_303875.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-21T11:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303875",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303876.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-21T14:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303876",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_303877.json:
```json
{
    "body": "Changing branch from \"u/ohanar/remove_gdmodule\" to \"a12db779288e6a65fa1cf95f18e19ed84058be1b\"",
    "created_at": "2015-04-21T14:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17591#issuecomment-303877",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/ohanar/remove_gdmodule" to "a12db779288e6a65fa1cf95f18e19ed84058be1b"



---

archive/issue_events_057386.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-21T14:08:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17591",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17591#event-57386"
}
```
