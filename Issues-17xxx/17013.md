# Issue 17013: WordDatatype_char

archive/issues_016776.json:
```json
{
    "body": "Creation of a new class WordDatatype_char that has in backend an 'unsigned char *' and use it wherever possible. The implementation is much faster than anything else but is only available for alphabet contained in [0,255].\n\n**CC:**  @seblabbe\n\n**Keywords:** words\n\n**Branch:** [c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)\n\n**Reviewer:** S\u00e9bastien Labb\u00e9, Jeroen Demeyer\n\n**Author:** Vincent Delecroix\n\nIssue created by migration from https://trac.sagemath.org/ticket/17013\n\n",
    "closed_at": "2014-09-25T12:05:55Z",
    "created_at": "2014-09-20T15:17:18Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "WordDatatype_char",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/17013",
    "user": "https://github.com/videlec"
}
```
Creation of a new class WordDatatype_char that has in backend an 'unsigned char *' and use it wherever possible. The implementation is much faster than anything else but is only available for alphabet contained in [0,255].

**CC:**  @seblabbe

**Keywords:** words

**Branch:** [c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)

**Reviewer:** Sébastien Labbé, Jeroen Demeyer

**Author:** Vincent Delecroix

Issue created by migration from https://trac.sagemath.org/ticket/17013





---

archive/issue_comments_227426.json:
```json
{
    "body": "**Commit:** [398b33c0a6f6a96f5c301e1867edb47158703776](https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776)",
    "created_at": "2014-09-20T15:35:07Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227426",
    "user": "https://github.com/videlec"
}
```

**Commit:** [398b33c0a6f6a96f5c301e1867edb47158703776](https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776)



---

archive/issue_comments_227427.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a25e28644286e665c2cbfea5fec1ffc50e704101\">a25e286</a></td><td><code>trac #17013: new class WordDatatype_char</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776\">398b33c</a></td><td><code>trac #17013: added is_square in WordDatatype_char</code></td></tr></table>\n",
    "created_at": "2014-09-20T15:35:07Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227427",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a25e28644286e665c2cbfea5fec1ffc50e704101">a25e286</a></td><td><code>trac #17013: new class WordDatatype_char</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776">398b33c</a></td><td><code>trac #17013: added is_square in WordDatatype_char</code></td></tr></table>




---

archive/issue_events_152708.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-20T15:35:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152708"
}
```



---

archive/issue_comments_227428.json:
```json
{
    "body": "**Branch:** [u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)",
    "created_at": "2014-09-20T15:35:07Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227428",
    "user": "https://github.com/videlec"
}
```

**Branch:** [u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)



---

archive/issue_comments_227429.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)\" to \"[u/slabbe/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17013)\".",
    "created_at": "2014-09-20T18:53:55Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227429",
    "user": "https://github.com/seblabbe"
}
```

**Changing branch** from "[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)" to "[u/slabbe/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17013)".



---

archive/issue_comments_227430.json:
```json
{
    "body": "**Changing commit** from \"[398b33c0a6f6a96f5c301e1867edb47158703776](https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776)\" to \"[a563343267f1690d74275ad3835cdebef8512a19](https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19)\".",
    "created_at": "2014-09-20T18:53:55Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227430",
    "user": "https://github.com/seblabbe"
}
```

**Changing commit** from "[398b33c0a6f6a96f5c301e1867edb47158703776](https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776)" to "[a563343267f1690d74275ad3835cdebef8512a19](https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19)".



---

archive/issue_comments_227431.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19\">a563343</a></td><td><code>trac #17013: doctests improvements + bug fix</code></td></tr></table>\n",
    "created_at": "2014-09-20T18:53:55Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227431",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19">a563343</a></td><td><code>trac #17013: doctests improvements + bug fix</code></td></tr></table>




---

archive/issue_comments_227432.json:
```json
{
    "body": "<a id='comment:3'></a>\nIf Vincent agrees with my changes, then he can set this ticket to positive review.",
    "created_at": "2014-09-20T18:54:50Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227432",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>
If Vincent agrees with my changes, then he can set this ticket to positive review.



---

archive/issue_comments_227433.json:
```json
{
    "body": "**Reviewer:** S\u00e9bastien Labb\u00e9",
    "created_at": "2014-09-20T18:54:50Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227433",
    "user": "https://github.com/seblabbe"
}
```

**Reviewer:** Sébastien Labbé



---

archive/issue_comments_227434.json:
```json
{
    "body": "<a id='comment:4'></a>\nHere is one benchmark.\n\nBEFORE::\n\n```\n    sage: w = Word([0,-1,2]*100, alphabet=[0,-1,2])\n    sage: type(w)\n    <class 'sage.combinat.words.word.FiniteWord_list'>\n    sage: %timeit w.is_square_free()\n    1000 loops, best of 3: 417 \u00b5s per loop\n```\n\nAFTER::\n\n```\n    sage: w = Word([0,1,2]*100, alphabet=[0,1,2])\n    sage: type(w)\n    <class 'sage.combinat.words.word.FiniteWord_char'>\n    sage: %timeit w.is_square_free()\n    100000 loops, best of 3: 6.29 \u00b5s per loop\n```\n\nWe should also add here some benchmark about equality test and also `__getitem__`.",
    "created_at": "2014-09-20T18:57:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227434",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:4'></a>
Here is one benchmark.

BEFORE::

```
    sage: w = Word([0,-1,2]*100, alphabet=[0,-1,2])
    sage: type(w)
    <class 'sage.combinat.words.word.FiniteWord_list'>
    sage: %timeit w.is_square_free()
    1000 loops, best of 3: 417 µs per loop
```

AFTER::

```
    sage: w = Word([0,1,2]*100, alphabet=[0,1,2])
    sage: type(w)
    <class 'sage.combinat.words.word.FiniteWord_char'>
    sage: %timeit w.is_square_free()
    100000 loops, best of 3: 6.29 µs per loop
```

We should also add here some benchmark about equality test and also `__getitem__`.



---

archive/issue_comments_227435.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [slabbe](#comment%3A4):\n> We should also add here some benchmark about equality test and also `__getitem__`.\n\nEDIT: the timings were edited because there were not about `FiniteWord_str` but `FiniteWord_list`...\n\nCompetitions between:\n- Python string\n- `FiniteWord_str`\n- `FiniteWord_char`\n\n```\nsage: W1 = Words('abc')\nsage: W2 = Words([0,1,2])\nsage: w1 = W1(''.join(choice('abc') for _ in range(1000)))\nsage: w2 = W2([choice([0,1,2]) for _ in range(1000])\nsage: s = str(w1)\n```\nthen on slices\n\n```\nsage: timeit(\"for i in range(1000): u = w1[:i]\")\n25 loops, best of 3: 25.3 ms per loop\nsage: timeit(\"for i in range(1000): u = w2[:i]\")\n625 loops, best of 3: 237 \u00b5s per loop\nsage: timeit(\"for i in range(1000): u = s[:i]\")\n625 loops, best of 3: 129 \u00b5s per loop\n```\nand on equality\n\n```\nsage: timeit(\"w1 == w1\")\n625 loops, best of 3: 365 ns per loop\nsage: timeit(\"w2 == w2\")\n625 loops, best of 3: 187 ns per loop\nsage: timeit(\"s == s\")\n625 loops, best of 3: 86.6 ns per loop\n```\nSo Python strings are still ahead, but its much less ridiculous.\n\nVincent",
    "created_at": "2014-09-20T21:38:11Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227435",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Replying to [slabbe](#comment%3A4):
> We should also add here some benchmark about equality test and also `__getitem__`.

EDIT: the timings were edited because there were not about `FiniteWord_str` but `FiniteWord_list`...

Competitions between:
- Python string
- `FiniteWord_str`
- `FiniteWord_char`

```
sage: W1 = Words('abc')
sage: W2 = Words([0,1,2])
sage: w1 = W1(''.join(choice('abc') for _ in range(1000)))
sage: w2 = W2([choice([0,1,2]) for _ in range(1000])
sage: s = str(w1)
```
then on slices

```
sage: timeit("for i in range(1000): u = w1[:i]")
25 loops, best of 3: 25.3 ms per loop
sage: timeit("for i in range(1000): u = w2[:i]")
625 loops, best of 3: 237 µs per loop
sage: timeit("for i in range(1000): u = s[:i]")
625 loops, best of 3: 129 µs per loop
```
and on equality

```
sage: timeit("w1 == w1")
625 loops, best of 3: 365 ns per loop
sage: timeit("w2 == w2")
625 loops, best of 3: 187 ns per loop
sage: timeit("s == s")
625 loops, best of 3: 86.6 ns per loop
```
So Python strings are still ahead, but its much less ridiculous.

Vincent



---

archive/issue_comments_227436.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [slabbe](#comment%3A3):\n> If Vincent agrees with my changes, then he can set this ticket to positive review.\n\nI am! Thanks for the review.\n\nVincent",
    "created_at": "2014-09-20T21:40:16Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227436",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
Replying to [slabbe](#comment%3A3):
> If Vincent agrees with my changes, then he can set this ticket to positive review.

I am! Thanks for the review.

Vincent



---

archive/issue_events_152709.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-20T21:40:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152709"
}
```



---

archive/issue_events_152710.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-20T21:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152710"
}
```



---

archive/issue_comments_227437.json:
```json
{
    "body": "<a id='comment:7'></a>\n> Competitions between:\n> - Python string\n> - `FiniteWord_str`\n> - `FiniteWord_char`\n\nI believe you do not have `FiniteWord_str` in the competition...\n\n```\nsage: type(w1)                                     \n<class 'sage.combinat.words.word.FiniteWord_list'> \n```",
    "created_at": "2014-09-20T21:44:27Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227437",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:7'></a>
> Competitions between:
> - Python string
> - `FiniteWord_str`
> - `FiniteWord_char`

I believe you do not have `FiniteWord_str` in the competition...

```
sage: type(w1)                                     
<class 'sage.combinat.words.word.FiniteWord_list'> 
```



---

archive/issue_comments_227438.json:
```json
{
    "body": "<a id='comment:8'></a>\nInstead of (note that you already have defined i as a `ssize_t`):\n\n```python\ncdef ssize_t i\nfor i in range(w._length-1, -1, -1):\n```\n\nMaybe the following is better and would allow to use `size_t` type?\n\n```python\ncdef size_t i\nfor i from w._length > i >= 0:\n```",
    "created_at": "2014-09-20T21:55:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227438",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:8'></a>
Instead of (note that you already have defined i as a `ssize_t`):

```python
cdef ssize_t i
for i in range(w._length-1, -1, -1):
```

Maybe the following is better and would allow to use `size_t` type?

```python
cdef size_t i
for i from w._length > i >= 0:
```



---

archive/issue_comments_227439.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [slabbe](#comment%3A8):\n> Instead of (note that you already have defined i as a `ssize_t`):\n> \n> ```python\n> cdef ssize_t i\n> for i in range(w._length-1, -1, -1):\n> ```\n> \n> Maybe the following is better and would allow to use `size_t` type?\n> \n> ```python\n> cdef size_t i\n> for i from w._length > i >= 0:\n> ```\n\nNope, it does note change anything. And be careful, your second loop is infinite (a size_t is always >= 0).",
    "created_at": "2014-09-20T21:56:52Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227439",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Replying to [slabbe](#comment%3A8):
> Instead of (note that you already have defined i as a `ssize_t`):
> 
> ```python
> cdef ssize_t i
> for i in range(w._length-1, -1, -1):
> ```
> 
> Maybe the following is better and would allow to use `size_t` type?
> 
> ```python
> cdef size_t i
> for i from w._length > i >= 0:
> ```

Nope, it does note change anything. And be careful, your second loop is infinite (a size_t is always >= 0).



---

archive/issue_comments_227440.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [slabbe](#comment%3A7):\n> > Competitions between:\n> > - Python string\n> > - `FiniteWord_str`\n> > - `FiniteWord_char`\n\n> \n> I believe you do not have `FiniteWord_str` in the competition...\n> \n> ```\n> sage: type(w1)                                     \n> <class 'sage.combinat.words.word.FiniteWord_list'> \n> ```\n\nOups... corrected. Does not change anything for slicing, but huge difference in equality.",
    "created_at": "2014-09-20T21:59:51Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227440",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>
Replying to [slabbe](#comment%3A7):
> > Competitions between:
> > - Python string
> > - `FiniteWord_str`
> > - `FiniteWord_char`

> 
> I believe you do not have `FiniteWord_str` in the competition...
> 
> ```
> sage: type(w1)                                     
> <class 'sage.combinat.words.word.FiniteWord_list'> 
> ```

Oups... corrected. Does not change anything for slicing, but huge difference in equality.



---

archive/issue_comments_227441.json:
```json
{
    "body": "<a id='comment:11'></a>\nGreat, so I am ok with this ticket. Positive review as already set!\n\nS\u00e9bastien",
    "created_at": "2014-09-20T22:04:07Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227441",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:11'></a>
Great, so I am ok with this ticket. Positive review as already set!

Sébastien



---

archive/issue_comments_227442.json:
```json
{
    "body": "**Changing reviewer** from \"S\u00e9bastien Labb\u00e9\" to \"S\u00e9bastien Labb\u00e9, Jeroen Demeyer\".",
    "created_at": "2014-09-24T15:34:46Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227442",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Sébastien Labbé" to "Sébastien Labbé, Jeroen Demeyer".



---

archive/issue_comments_227443.json:
```json
{
    "body": "<a id='comment:12'></a>\nThis is absolutely not the right way to handle exceptions:\n\n```\nif PySlice_GetIndicesEx(...) < 0:\n    return\n```\nThe fact that it \"works\" is because IPython picks up the exception much later than you intended. Note the botched traceback:\n\n```\nsage: Words([0,1,2,3])([0,1,0,2,0,3,1,2,3])[slice(\"foo\")]\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\nTypeError: slice indices must be integers or None or have an __index__ method\n```\nThe right way is to declare your function as `except -1` and let Cython do the right thing. See http://docs.cython.org/src/userguide/language_basics.html#error-return-values",
    "created_at": "2014-09-24T15:34:46Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227443",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
This is absolutely not the right way to handle exceptions:

```
if PySlice_GetIndicesEx(...) < 0:
    return
```
The fact that it "works" is because IPython picks up the exception much later than you intended. Note the botched traceback:

```
sage: Words([0,1,2,3])([0,1,0,2,0,3,1,2,3])[slice("foo")]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
TypeError: slice indices must be integers or None or have an __index__ method
```
The right way is to declare your function as `except -1` and let Cython do the right thing. See http://docs.cython.org/src/userguide/language_basics.html#error-return-values



---

archive/issue_events_152711.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T15:34:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152711"
}
```



---

archive/issue_events_152712.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T15:34:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152712"
}
```



---

archive/issue_comments_227444.json:
```json
{
    "body": "<a id='comment:13'></a>\nSee [https://github.com/cython/cython/commit/543c33c4a1fdf105c3173a0950297ce4f7550ece](https://github.com/cython/cython/commit/543c33c4a1fdf105c3173a0950297ce4f7550ece) for how such a declaration would look like.\n\nIf you feel like it, add that patch to the Cython package and then you can do\n\n```\nfrom cpython.slice cimport *\n```\ninstead of manually declaring the `PySlice_` functions.",
    "created_at": "2014-09-24T16:00:45Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227444",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
See [https://github.com/cython/cython/commit/543c33c4a1fdf105c3173a0950297ce4f7550ece](https://github.com/cython/cython/commit/543c33c4a1fdf105c3173a0950297ce4f7550ece) for how such a declaration would look like.

If you feel like it, add that patch to the Cython package and then you can do

```
from cpython.slice cimport *
```
instead of manually declaring the `PySlice_` functions.



---

archive/issue_comments_227445.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi Jeroen,\n\nAs you noticed, the commit in cython is 3 days old... and the reason is because I asked on the [cython-users list](https://groups.google.com/forum/#!topic/cython-users/2G-QguqmgKk). Patching is much more work than the declaration (see the last commit):\n\n```\ncdef extern from \"Python.h\":\n    int PySlice_GetIndicesEx(...) except -1\n```\n\nVincent",
    "created_at": "2014-09-24T16:13:03Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227445",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Hi Jeroen,

As you noticed, the commit in cython is 3 days old... and the reason is because I asked on the [cython-users list](https://groups.google.com/forum/#!topic/cython-users/2G-QguqmgKk). Patching is much more work than the declaration (see the last commit):

```
cdef extern from "Python.h":
    int PySlice_GetIndicesEx(...) except -1
```

Vincent



---

archive/issue_comments_227446.json:
```json
{
    "body": "<a id='comment:15'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e\">c00964d</a></td><td><code>trac #17013: fix Python C API declaration</code></td></tr></table>\n",
    "created_at": "2014-09-24T16:19:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227446",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e">c00964d</a></td><td><code>trac #17013: fix Python C API declaration</code></td></tr></table>




---

archive/issue_events_152713.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-24T16:19:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152713"
}
```



---

archive/issue_events_152714.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-24T16:19:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152714"
}
```



---

archive/issue_comments_227447.json:
```json
{
    "body": "**Changing branch** from \"[u/slabbe/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17013)\" to \"[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)\".",
    "created_at": "2014-09-24T16:19:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227447",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/slabbe/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17013)" to "[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)".



---

archive/issue_comments_227448.json:
```json
{
    "body": "**Changing commit** from \"[a563343267f1690d74275ad3835cdebef8512a19](https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19)\" to \"[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)\".",
    "created_at": "2014-09-24T16:19:08Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227448",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[a563343267f1690d74275ad3835cdebef8512a19](https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19)" to "[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)".



---

archive/issue_events_152715.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T16:45:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152715"
}
```



---

archive/issue_events_152716.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T16:45:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152716"
}
```



---

archive/issue_comments_227449.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks!",
    "created_at": "2014-09-24T16:55:01Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227449",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
Thanks!



---

archive/issue_comments_227450.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)\" to \"[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)\".",
    "created_at": "2014-09-25T12:05:55Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227450",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/vdelecroix/17013](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17013)" to "[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)".



---

archive/issue_events_152717.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-25T12:05:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152717"
}
```



---

archive/issue_events_152718.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-25T12:05:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17013#event-152718"
}
```



---

archive/issue_comments_227451.json:
```json
{
    "body": "**Changing commit** from \"[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)\" to \"\".",
    "created_at": "2014-12-13T23:24:40Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227451",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing commit** from "[c00964da4655d7580277c3d4aba1e0a51b06b78e](https://github.com/sagemath/sagetrac-mirror/commit/c00964da4655d7580277c3d4aba1e0a51b06b78e)" to "".



---

archive/issue_comments_227452.json:
```json
{
    "body": "<a id='comment:19'></a>\nNote that #15820 seems to address similar applications, but more general (without restriction to alphabets of length 255). In preliminary versions of bounded integer sequences, I experimented with `char*` as underlying data structure, but found that using GMP long integers with the shift operations provided by GMP was faster.",
    "created_at": "2014-12-13T23:24:40Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227452",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:19'></a>
Note that #15820 seems to address similar applications, but more general (without restriction to alphabets of length 255). In preliminary versions of bounded integer sequences, I experimented with `char*` as underlying data structure, but found that using GMP long integers with the shift operations provided by GMP was faster.



---

archive/issue_comments_227453.json:
```json
{
    "body": "<a id='comment:20'></a>\nYou should really compare the speed of the operations here with those from #15820. What I dislike about this ticket here is that it just talks about `WordDatatype_char` which doesn't mean anything to me: I never noticed that you were implementing sequences of integers in the interval [0,255].\n\nOn #15820, I insisted that the approach would be as general as possible. Of course, Simon King (the author) had a particular application in mind, but the code in #15820 never refers to that application, it is very general.",
    "created_at": "2014-12-14T08:32:34Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227453",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
You should really compare the speed of the operations here with those from #15820. What I dislike about this ticket here is that it just talks about `WordDatatype_char` which doesn't mean anything to me: I never noticed that you were implementing sequences of integers in the interval [0,255].

On #15820, I insisted that the approach would be as general as possible. Of course, Simon King (the author) had a particular application in mind, but the code in #15820 never refers to that application, it is very general.



---

archive/issue_comments_227454.json:
```json
{
    "body": "<a id='comment:21'></a>\nHello,\n\nThe thing is that having a complicated datatype with letters not aligned with computer words also has disadvantages. Namely:\n1. code less readable\n2. might be slower if not carefully done (you can not use `memcmp`, `memcpy` from `strings.h`)\nAnd implementing more involved algorithms (pattern matchings, counting subsequences, etc) might be painful.\n\nNevertheless, I would be happy to give it a try and do proper benchmarkings. There will be no problem to remove the data structure here if #15820 is just better.\n\nVincent",
    "created_at": "2014-12-14T09:14:40Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227454",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
Hello,

The thing is that having a complicated datatype with letters not aligned with computer words also has disadvantages. Namely:
1. code less readable
2. might be slower if not carefully done (you can not use `memcmp`, `memcpy` from `strings.h`)
And implementing more involved algorithms (pattern matchings, counting subsequences, etc) might be painful.

Nevertheless, I would be happy to give it a try and do proper benchmarkings. There will be no problem to remove the data structure here if #15820 is just better.

Vincent



---

archive/issue_comments_227455.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [vdelecroix](#comment%3A21):\n> The thing is that having a complicated datatype with letters not aligned with computer words also has disadvantages. Namely:\n> 1. code less readable\n\nTrue for the underlying boilerplate functions. Not necessarily true for higher level code.\n\n\n> 2. might be slower if not carefully done (you can not use `memcmp`, `memcpy` from `strings.h`)\n\nWhy can one not use `memcmp` and `memcpy`? Respectively, what's wrong with using `mpn_cmp` and similar functions?\n\n> And implementing more involved algorithms (pattern matchings, counting subsequences, etc) might be painful.\n\nIndeed, detection of subsequences (which is also implemented in #15820) is a bit more complicated than it would be with `char*`. Detection of subsequences is one of the operations I care about. Admittedly, with my application to right modules over path algebras in mind, I care more about testing whether a sequence *starts* with a given subsequence than whether it just *contains* the subsequence.",
    "created_at": "2014-12-14T10:05:49Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227455",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:22'></a>
Replying to [vdelecroix](#comment%3A21):
> The thing is that having a complicated datatype with letters not aligned with computer words also has disadvantages. Namely:
> 1. code less readable

True for the underlying boilerplate functions. Not necessarily true for higher level code.


> 2. might be slower if not carefully done (you can not use `memcmp`, `memcpy` from `strings.h`)

Why can one not use `memcmp` and `memcpy`? Respectively, what's wrong with using `mpn_cmp` and similar functions?

> And implementing more involved algorithms (pattern matchings, counting subsequences, etc) might be painful.

Indeed, detection of subsequences (which is also implemented in #15820) is a bit more complicated than it would be with `char*`. Detection of subsequences is one of the operations I care about. Admittedly, with my application to right modules over path algebras in mind, I care more about testing whether a sequence *starts* with a given subsequence than whether it just *contains* the subsequence.



---

archive/issue_comments_227456.json:
```json
{
    "body": "<a id='comment:23'></a>\nOf course, bounded integer sequences have one disadvantage for your applications: you can not prescribe an alphabet. Each bounded integer sequences is formed by integers between 0 and a prescribed bound.\n\nAnyway, here are some timings:\n\n```\nsage: from sage.data_structures.bounded_integer_sequences import BoundedIntegerSequence\nsage: w_s = Word([9,2,0,1,5,3,10,15,1,14,8,3]*100, alphabet=range(16))\nsage: type(w_s)\n<class 'sage.combinat.words.word.FiniteWord_char'>\nsage: w_l = Word([9,2,0,1,5,3,10,15,1,14,8,3]*100)\nsage: type(w_l)\n<class 'sage.combinat.words.word.FiniteWord_list'>\nsage: w_t = Word((9,2,0,1,5,3,10,15,1,14,8,3)*100)\nsage: type(w_t)\n<class 'sage.combinat.words.word.FiniteWord_tuple'>\nsage: w_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,8,3]*100)\nsage: w2_s = Word([9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8], alphabet=range(16))\nsage: w2_l = Word([9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8])\nsage: w2_t = Word((9,2,0,1,5,3,10,15,1,14,8,3)*99+(9,2,0,1,5,3,10,15,1,14,3,8))\nsage: w2_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8])\nsage: list(w_s)==list(w_l)==list(w_t)==list(w_b)\nTrue\nsage: list(w2_s)==list(w2_l)==list(w2_t)==list(w2_b)\nTrue\n```\n\nComparison:\n\n```\nsage: %timeit w_s==w2_s\n100000 loops, best of 3: 2.57 \u00b5s per loop\nsage: %timeit w_l==w2_l\n10000 loops, best of 3: 57.8 \u00b5s per loop\nsage: %timeit w_t==w2_t\n10000 loops, best of 3: 56 \u00b5s per loop\nsage: %timeit w_b==w2_b\n1000000 loops, best of 3: 537 ns per loop\n```\n\nHash, which is not (yet?) cached for bounded integer sequences:\n\n```\nsage: %timeit hash(w_s)\n10000000 loops, best of 3: 137 ns per loop\nsage: %timeit hash(w_l)\n10000000 loops, best of 3: 138 ns per loop\nsage: %timeit hash(w_t)\n10000000 loops, best of 3: 137 ns per loop\nsage: %timeit hash(w_b)\n1000000 loops, best of 3: 246 ns per loop\n```\n\nConcatenation:\n\n```\nsage: list(w_s+w2_s)==list(w_l+w2_l)==list(w_t+w2_t)==list(w_b+w2_b)\nTrue\nsage: %timeit w_s+w2_s\n1000 loops, best of 3: 336 \u00b5s per loop\nsage: %timeit w_l+w2_l\n10000 loops, best of 3: 31.1 \u00b5s per loop\nsage: %timeit w_t+w2_t\n10000 loops, best of 3: 31.7 \u00b5s per loop\nsage: %timeit w_b+w2_b\n1000000 loops, best of 3: 1.05 \u00b5s per loop\n```\n\nSubsequence containment:\n\n```\nsage: sub_s = Word([9,2,0,1,5,3,10,15,1,14,3,8], alphabet=range(16))\nsage: sub_l = Word([9,2,0,1,5,3,10,15,1,14,3,8])\nsage: sub_t = Word((9,2,0,1,5,3,10,15,1,14,3,8))\nsage: sub_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,3,8])\nsage: W_s = w2_s+w_s\nsage: W_l = w2_l+w_l\nsage: W_t = w2_t+w_t\nsage: W_b = w2_b+w_b\nsage: sub_s.is_subword_of(W_s)\nTrue\nsage: sub_b in W_b\nTrue\nsage: %timeit sub_s.is_subword_of(W_s)\n10000 loops, best of 3: 21.3 \u00b5s per loop\nsage: %timeit sub_l.is_subword_of(W_l)\n100000 loops, best of 3: 10.9 \u00b5s per loop\nsage: %timeit sub_t.is_subword_of(W_t)\n100000 loops, best of 3: 10.7 \u00b5s per loop\nsage: %timeit sub_b in W_b\n100000 loops, best of 3: 10.8 \u00b5s per loop\n```\n\nSo, using a compressed data format (where many letters are squeezed into one machine word) is not bad for the operations above.",
    "created_at": "2014-12-14T10:31:05Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227456",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:23'></a>
Of course, bounded integer sequences have one disadvantage for your applications: you can not prescribe an alphabet. Each bounded integer sequences is formed by integers between 0 and a prescribed bound.

Anyway, here are some timings:

```
sage: from sage.data_structures.bounded_integer_sequences import BoundedIntegerSequence
sage: w_s = Word([9,2,0,1,5,3,10,15,1,14,8,3]*100, alphabet=range(16))
sage: type(w_s)
<class 'sage.combinat.words.word.FiniteWord_char'>
sage: w_l = Word([9,2,0,1,5,3,10,15,1,14,8,3]*100)
sage: type(w_l)
<class 'sage.combinat.words.word.FiniteWord_list'>
sage: w_t = Word((9,2,0,1,5,3,10,15,1,14,8,3)*100)
sage: type(w_t)
<class 'sage.combinat.words.word.FiniteWord_tuple'>
sage: w_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,8,3]*100)
sage: w2_s = Word([9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8], alphabet=range(16))
sage: w2_l = Word([9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8])
sage: w2_t = Word((9,2,0,1,5,3,10,15,1,14,8,3)*99+(9,2,0,1,5,3,10,15,1,14,3,8))
sage: w2_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,8,3]*99+[9,2,0,1,5,3,10,15,1,14,3,8])
sage: list(w_s)==list(w_l)==list(w_t)==list(w_b)
True
sage: list(w2_s)==list(w2_l)==list(w2_t)==list(w2_b)
True
```

Comparison:

```
sage: %timeit w_s==w2_s
100000 loops, best of 3: 2.57 µs per loop
sage: %timeit w_l==w2_l
10000 loops, best of 3: 57.8 µs per loop
sage: %timeit w_t==w2_t
10000 loops, best of 3: 56 µs per loop
sage: %timeit w_b==w2_b
1000000 loops, best of 3: 537 ns per loop
```

Hash, which is not (yet?) cached for bounded integer sequences:

```
sage: %timeit hash(w_s)
10000000 loops, best of 3: 137 ns per loop
sage: %timeit hash(w_l)
10000000 loops, best of 3: 138 ns per loop
sage: %timeit hash(w_t)
10000000 loops, best of 3: 137 ns per loop
sage: %timeit hash(w_b)
1000000 loops, best of 3: 246 ns per loop
```

Concatenation:

```
sage: list(w_s+w2_s)==list(w_l+w2_l)==list(w_t+w2_t)==list(w_b+w2_b)
True
sage: %timeit w_s+w2_s
1000 loops, best of 3: 336 µs per loop
sage: %timeit w_l+w2_l
10000 loops, best of 3: 31.1 µs per loop
sage: %timeit w_t+w2_t
10000 loops, best of 3: 31.7 µs per loop
sage: %timeit w_b+w2_b
1000000 loops, best of 3: 1.05 µs per loop
```

Subsequence containment:

```
sage: sub_s = Word([9,2,0,1,5,3,10,15,1,14,3,8], alphabet=range(16))
sage: sub_l = Word([9,2,0,1,5,3,10,15,1,14,3,8])
sage: sub_t = Word((9,2,0,1,5,3,10,15,1,14,3,8))
sage: sub_b = BoundedIntegerSequence(16, [9,2,0,1,5,3,10,15,1,14,3,8])
sage: W_s = w2_s+w_s
sage: W_l = w2_l+w_l
sage: W_t = w2_t+w_t
sage: W_b = w2_b+w_b
sage: sub_s.is_subword_of(W_s)
True
sage: sub_b in W_b
True
sage: %timeit sub_s.is_subword_of(W_s)
10000 loops, best of 3: 21.3 µs per loop
sage: %timeit sub_l.is_subword_of(W_l)
100000 loops, best of 3: 10.9 µs per loop
sage: %timeit sub_t.is_subword_of(W_t)
100000 loops, best of 3: 10.7 µs per loop
sage: %timeit sub_b in W_b
100000 loops, best of 3: 10.8 µs per loop
```

So, using a compressed data format (where many letters are squeezed into one machine word) is not bad for the operations above.



---

archive/issue_comments_227457.json:
```json
{
    "body": "<a id='comment:24'></a>\nI forgot slicing:\n\n```\nsage: list(w_s[30:70]) == list(w_b[30:70])\nTrue\nsage: %timeit x=w_s[30:70]\n1000000 loops, best of 3: 1.02 \u00b5s per loop\nsage: %timeit x=w_l[30:70]\n10000 loops, best of 3: 20.6 \u00b5s per loop\nsage: %timeit x=w_t[30:70]\n10000 loops, best of 3: 21 \u00b5s per loop\nsage: %timeit x=w_b[30:70]\n1000000 loops, best of 3: 1.14 \u00b5s per loop\nsage: list(w_s[30:70:2]) == list(w_b[30:70:2])\nTrue\nsage: %timeit x=w_s[30:70:2]\n100000 loops, best of 3: 2.65 \u00b5s per loop\nsage: %timeit x=w_l[30:70:2]\n100000 loops, best of 3: 13.3 \u00b5s per loop\nsage: %timeit x=w_t[30:70:2]\n100000 loops, best of 3: 14.4 \u00b5s per loop\nsage: %timeit x=w_b[30:70:2]\n1000000 loops, best of 3: 1.63 \u00b5s per loop\n```",
    "created_at": "2014-12-14T10:33:20Z",
    "issue": "https://github.com/sagemath/sage/issues/17013",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17013#issuecomment-227457",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:24'></a>
I forgot slicing:

```
sage: list(w_s[30:70]) == list(w_b[30:70])
True
sage: %timeit x=w_s[30:70]
1000000 loops, best of 3: 1.02 µs per loop
sage: %timeit x=w_l[30:70]
10000 loops, best of 3: 20.6 µs per loop
sage: %timeit x=w_t[30:70]
10000 loops, best of 3: 21 µs per loop
sage: %timeit x=w_b[30:70]
1000000 loops, best of 3: 1.14 µs per loop
sage: list(w_s[30:70:2]) == list(w_b[30:70:2])
True
sage: %timeit x=w_s[30:70:2]
100000 loops, best of 3: 2.65 µs per loop
sage: %timeit x=w_l[30:70:2]
100000 loops, best of 3: 13.3 µs per loop
sage: %timeit x=w_t[30:70:2]
100000 loops, best of 3: 14.4 µs per loop
sage: %timeit x=w_b[30:70:2]
1000000 loops, best of 3: 1.63 µs per loop
```
