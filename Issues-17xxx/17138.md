# Issue 17138: LatticePoset: complements() is broken

archive/issues_016901.json:
```json
{
    "body": "CC:  @nathanncohen\n\nComplement of an element of lattice, if it exists, is not necessarily unique. Hence returning an array from `complements()` seems to be totally wrong. Right way is to return a dict of lists if called without arguments and a list if called with one element as argument.\n\nTo clarify what is wrong in all possible meanings for a function called \"complements\":\n\n```\nsage: Posets.PentagonPoset().complements()\n[4, 3, 1, 1, 0]\nsage: LatticePoset({'a':'b'}).complements()\n[1, 0]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/17138\n\n",
    "closed_at": "2014-10-15T18:12:32Z",
    "created_at": "2014-10-12T12:02:32Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "LatticePoset: complements() is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17138",
    "user": "https://github.com/jm58660"
}
```
CC:  @nathanncohen

Complement of an element of lattice, if it exists, is not necessarily unique. Hence returning an array from `complements()` seems to be totally wrong. Right way is to return a dict of lists if called without arguments and a list if called with one element as argument.

To clarify what is wrong in all possible meanings for a function called "complements":

```
sage: Posets.PentagonPoset().complements()
[4, 3, 1, 1, 0]
sage: LatticePoset({'a':'b'}).complements()
[1, 0]
```


Issue created by migration from https://trac.sagemath.org/ticket/17138





---

archive/issue_comments_223561.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T08:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_223562.json:
```json
{
    "body": "Because `complements()` make sense for lattices, not for posets in general, I think that function can be removed from `hasse_diagram.py`. Otherwise I didn't even think about good algorithm etc.",
    "created_at": "2014-10-13T08:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223562",
    "user": "https://github.com/jm58660"
}
```

Because `complements()` make sense for lattices, not for posets in general, I think that function can be removed from `hasse_diagram.py`. Otherwise I didn't even think about good algorithm etc.



---

archive/issue_comments_223563.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-13T08:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223563",
    "user": "https://github.com/jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_223564.json:
```json
{
    "body": "Hello !\n\n- depreceated -> deprecated\n\n- `Use FiniteLattices::complements()` -- this is not C++ ! Plus the message should probably be \"complements() is only defined on LatticePoset\" or something. I mean, an error message telling the user that he should change the poset's type itself.\n\n- Given how broken that function is, perhaps it is better to raise an exception rather than a warning.. What do you think ? Besides, that function is defined in `HasseDiagram` which are not really meant to be used directly anyway.\n\n- (Do as you like but) the \"comps\" loop could have been rewritten as\n\n```\nreturn {self._vertex_to_element(u):map(self._vertex_to_element,l)\n        for u,l in c.iteritems()\n        if l}\n```\n\n- Why do you test `cardinality==0` instead of `if x not in self` ?\n\n- `for x in self.list()` can also be written `for x in self`\n\nNathann",
    "created_at": "2014-10-13T09:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223564",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

- depreceated -> deprecated

- `Use FiniteLattices::complements()` -- this is not C++ ! Plus the message should probably be "complements() is only defined on LatticePoset" or something. I mean, an error message telling the user that he should change the poset's type itself.

- Given how broken that function is, perhaps it is better to raise an exception rather than a warning.. What do you think ? Besides, that function is defined in `HasseDiagram` which are not really meant to be used directly anyway.

- (Do as you like but) the "comps" loop could have been rewritten as

```
return {self._vertex_to_element(u):map(self._vertex_to_element,l)
        for u,l in c.iteritems()
        if l}
```

- Why do you test `cardinality==0` instead of `if x not in self` ?

- `for x in self.list()` can also be written `for x in self`

Nathann



---

archive/issue_comments_223565.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n\n> - depreceated -> deprecated\n> - `for x in self.list()` can also be written `for x in self`\n\n\nDone this.\n\n> - (Do as you like but) the \"comps\" loop could have been rewritten as - -\n\n\nThis says `AttributeError: 'list' object has no attribute 'iteritems'`.\n\n> - Why do you test `cardinality==0` instead of `if x not in self` ?\n\n\nRunning `meet()` or `join()` will check that element belongs to the lattice, the only exception is empty lattice. (Well, partly because of that the code is non-optimal. But at least it works.)\n\n> - `Use FiniteLattices::complements()` -- this is not C++ ! Plus the message should probably be \"complements() is only defined on LatticePoset\" or something. I mean, an error message telling the user that he should change the poset's type itself.\n> \n> - Given how broken that function is, perhaps it is better to raise an exception rather than a warning.. What do you think ? Besides, that function is defined in `HasseDiagram` which are not really meant to be used directly anyway.\n\n\nI don't know. Can function from `HasseDiagram` be directly deleted without deprecating it first? For now I changed phrasing in the message.",
    "created_at": "2014-10-13T13:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223565",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:5 ncohen]:

> - depreceated -> deprecated
> - `for x in self.list()` can also be written `for x in self`


Done this.

> - (Do as you like but) the "comps" loop could have been rewritten as - -


This says `AttributeError: 'list' object has no attribute 'iteritems'`.

> - Why do you test `cardinality==0` instead of `if x not in self` ?


Running `meet()` or `join()` will check that element belongs to the lattice, the only exception is empty lattice. (Well, partly because of that the code is non-optimal. But at least it works.)

> - `Use FiniteLattices::complements()` -- this is not C++ ! Plus the message should probably be "complements() is only defined on LatticePoset" or something. I mean, an error message telling the user that he should change the poset's type itself.
> 
> - Given how broken that function is, perhaps it is better to raise an exception rather than a warning.. What do you think ? Besides, that function is defined in `HasseDiagram` which are not really meant to be used directly anyway.


I don't know. Can function from `HasseDiagram` be directly deleted without deprecating it first? For now I changed phrasing in the message.



---

archive/issue_comments_223566.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T13:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_223567.json:
```json
{
    "body": "Yo !\n\n> > - (Do as you like but) the \"comps\" loop could have been rewritten as - -\n \n> \n> This says `AttributeError: 'list' object has no attribute 'iteritems'`.\n\n\n`O_o`\n\n`comps` seems to be a dictionary in your code, not a list `O_o`\n\n> Running `meet()` or `join()` will check that element belongs to the lattice, the only exception is empty lattice. (Well, partly because of that the code is non-optimal. But at least it works.)\n\n\n`O_o`\n\nWell, it would still be clearer to check 'element in self' rather than the cardinality `O_o`\n\n> I don't know. Can function from `HasseDiagram` be directly deleted without deprecating it first? For now I changed phrasing in the message.\n\n\nWe can keep it like that, it does not matter much. One year from now we will remove it, no harm done I guess.\n\nNathann",
    "created_at": "2014-10-13T13:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223567",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> > - (Do as you like but) the "comps" loop could have been rewritten as - -
 
> 
> This says `AttributeError: 'list' object has no attribute 'iteritems'`.


`O_o`

`comps` seems to be a dictionary in your code, not a list `O_o`

> Running `meet()` or `join()` will check that element belongs to the lattice, the only exception is empty lattice. (Well, partly because of that the code is non-optimal. But at least it works.)


`O_o`

Well, it would still be clearer to check 'element in self' rather than the cardinality `O_o`

> I don't know. Can function from `HasseDiagram` be directly deleted without deprecating it first? For now I changed phrasing in the message.


We can keep it like that, it does not matter much. One year from now we will remove it, no harm done I guess.

Nathann



---

archive/issue_comments_223568.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T13:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223568",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_223569.json:
```json
{
    "body": "All tests pass !\n\nThanks,\n\nNathann",
    "created_at": "2014-10-13T22:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223569",
    "user": "https://github.com/nathanncohen"
}
```

All tests pass !

Thanks,

Nathann



---

archive/issue_comments_223570.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-13T22:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223570",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_223571.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-14T21:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223571",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_223572.json:
```json
{
    "body": "Int/string have no stable sort order:\n\n```\nsage -t --long src/sage/combinat/posets/lattices.py\n**********************************************************************\nFile \"src/sage/combinat/posets/lattices.py\", line 433, in sage.combinat.posets.lattices.FiniteLatticePoset.complements\nFailed example:\n    L.complements()\nExpected:\n    {0: [1], 1: [0], 'a': ['b', 'c'], 'b': ['c', 'a'], 'c': ['b', 'a']}\nGot:\n    {'a': ['b', 'c'], 'b': ['c', 'a'], 'c': ['b', 'a'], 0: [1], 1: [0]}\n**********************************************************************\n```",
    "created_at": "2014-10-14T21:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223572",
    "user": "https://github.com/vbraun"
}
```

Int/string have no stable sort order:

```
sage -t --long src/sage/combinat/posets/lattices.py
**********************************************************************
File "src/sage/combinat/posets/lattices.py", line 433, in sage.combinat.posets.lattices.FiniteLatticePoset.complements
Failed example:
    L.complements()
Expected:
    {0: [1], 1: [0], 'a': ['b', 'c'], 'b': ['c', 'a'], 'c': ['b', 'a']}
Got:
    {'a': ['b', 'c'], 'b': ['c', 'a'], 'c': ['b', 'a'], 0: [1], 1: [0]}
**********************************************************************
```



---

archive/issue_comments_223573.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-15T04:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_223574.json:
```json
{
    "body": "Addedd \"# random\" to doctest.",
    "created_at": "2014-10-15T04:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223574",
    "user": "https://github.com/jm58660"
}
```

Addedd "# random" to doctest.



---

archive/issue_comments_223575.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-15T04:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223575",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_223576.json:
```json
{
    "body": "Hmmmmmm.... The problem with 'random' flags is that it basically means that the output is not tested. Could you write a real doctest in a \"TEST\" section ? Something that tests that what the output claims to be complements indeed yield the top as their meet and the bottom as their join ?\n\nOtherwise this function actually is not tested.\n\nNathann",
    "created_at": "2014-10-15T07:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223576",
    "user": "https://github.com/nathanncohen"
}
```

Hmmmmmm.... The problem with 'random' flags is that it basically means that the output is not tested. Could you write a real doctest in a "TEST" section ? Something that tests that what the output claims to be complements indeed yield the top as their meet and the bottom as their join ?

Otherwise this function actually is not tested.

Nathann



---

archive/issue_comments_223577.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-15T07:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223577",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_223578.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-15T08:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223578",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_223579.json:
```json
{
    "body": "Something like this?",
    "created_at": "2014-10-15T08:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223579",
    "user": "https://github.com/jm58660"
}
```

Something like this?



---

archive/issue_comments_223580.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-15T08:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223580",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_223581.json:
```json
{
    "body": "No, that would not work. Here is the reason:\n\n1) The order in which elements are listed when you iterate upon the elements of a dictionary is architecture-dependent. If you write a doctest that just 'displays' the content of a dictionary, it will break on some machines. The problem is not only the order of the lists of complements.\n\n2) Actually, there is in Sage a 'hack' that reorders the entry of a dictionary before they are displayed. I expect that it uses a 'sort' or something, which works fine if you have only integers or only strings as keys to your dictionary. On the other hand, Volker says that comparing int and strings can be architecture dependent, as it is probably done according to the memory locations\n\n3) I believe that \"random order\" should be just \"random\"\n\nI added a commit which does some non-architecture-dependent checks on the output of the function. Tell me what you think, and you can set the ticket to `positive_review` if you agree with it !\n\nThanks,\n\nNathann\n\n---\nNew commits:",
    "created_at": "2014-10-15T08:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223581",
    "user": "https://github.com/nathanncohen"
}
```

No, that would not work. Here is the reason:

1) The order in which elements are listed when you iterate upon the elements of a dictionary is architecture-dependent. If you write a doctest that just 'displays' the content of a dictionary, it will break on some machines. The problem is not only the order of the lists of complements.

2) Actually, there is in Sage a 'hack' that reorders the entry of a dictionary before they are displayed. I expect that it uses a 'sort' or something, which works fine if you have only integers or only strings as keys to your dictionary. On the other hand, Volker says that comparing int and strings can be architecture dependent, as it is probably done according to the memory locations

3) I believe that "random order" should be just "random"

I added a commit which does some non-architecture-dependent checks on the output of the function. Tell me what you think, and you can set the ticket to `positive_review` if you agree with it !

Thanks,

Nathann

---
New commits:



---

archive/issue_comments_223582.json:
```json
{
    "body": "Replying to [comment:18 ncohen]:\n\n> 1) The order in which elements are listed when you iterate upon the elements of a dictionary is architecture-dependent. If you write a doctest that just 'displays' the content of a dictionary, it will break on some machines. The problem is not only the order of the lists of complements.\n\n\nWhat??? Is `sorted('a', 42)` architecture-dependent? I understand that `print {'a':'b', 42:43}` is, but that is different thing.\n\n> 2) Actually, there is in Sage a 'hack' that reorders the entry of a dictionary before they are displayed.\n\n\nOK, I understand the basic idea behind it. Maybe Volker will tell the actual code doing this.\n\n> 3) I believe that \"random order\" should be just \"random\"\n\n\nDocumentation says if comment *contains* strgin \"random\", then it will not be tested. So one could write for example \"Slightly random due numerical approximations\". But not an important thing.\n\n> I added a commit which does some non-architecture-dependent checks on the output of the function. Tell me what you think, and you can set the ticket to `positive_review` if you agree with it !\n\n\nWorks. Thanks.\n\n(Actually I think posets might have real test suite. Maybe later...)",
    "created_at": "2014-10-15T08:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223582",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:18 ncohen]:

> 1) The order in which elements are listed when you iterate upon the elements of a dictionary is architecture-dependent. If you write a doctest that just 'displays' the content of a dictionary, it will break on some machines. The problem is not only the order of the lists of complements.


What??? Is `sorted('a', 42)` architecture-dependent? I understand that `print {'a':'b', 42:43}` is, but that is different thing.

> 2) Actually, there is in Sage a 'hack' that reorders the entry of a dictionary before they are displayed.


OK, I understand the basic idea behind it. Maybe Volker will tell the actual code doing this.

> 3) I believe that "random order" should be just "random"


Documentation says if comment *contains* strgin "random", then it will not be tested. So one could write for example "Slightly random due numerical approximations". But not an important thing.

> I added a commit which does some non-architecture-dependent checks on the output of the function. Tell me what you think, and you can set the ticket to `positive_review` if you agree with it !


Works. Thanks.

(Actually I think posets might have real test suite. Maybe later...)



---

archive/issue_comments_223583.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-15T08:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223583",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_223584.json:
```json
{
    "body": "Yo !\n\n> What??? Is `sorted('a', 42)` architecture-dependent? I understand that `print {'a':'b', 42:43}` is, but that is different thing.\n\n\nOh sorry, perhaps not architecture dependent but 'unreliable'. It may even change on the same computer I guess, but I have no idea. Volker will know. In Sage, however, I was told that dictionaries output is sorted first, so that should be equivalent as far as doctests are concerned.\n\n> Documentation says if comment *contains* strgin \"random\", then it will not be tested. So one could write for example \"Slightly random due numerical approximations\". But not an important thing.\n\n\nYeah but then people come and say that you should not put too many words there, because your 'random order' doctest will also be tested if you do --optional=order\n\nNathann",
    "created_at": "2014-10-15T08:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223584",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> What??? Is `sorted('a', 42)` architecture-dependent? I understand that `print {'a':'b', 42:43}` is, but that is different thing.


Oh sorry, perhaps not architecture dependent but 'unreliable'. It may even change on the same computer I guess, but I have no idea. Volker will know. In Sage, however, I was told that dictionaries output is sorted first, so that should be equivalent as far as doctests are concerned.

> Documentation says if comment *contains* strgin "random", then it will not be tested. So one could write for example "Slightly random due numerical approximations". But not an important thing.


Yeah but then people come and say that you should not put too many words there, because your 'random order' doctest will also be tested if you do --optional=order

Nathann



---

archive/issue_comments_223585.json:
```json
{
    "body": "OK, comments from Nathann read and understood.",
    "created_at": "2014-10-15T10:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223585",
    "user": "https://github.com/jm58660"
}
```

OK, comments from Nathann read and understood.



---

archive/issue_comments_223586.json:
```json
{
    "body": "The order in `sorted(['a', 42])` is random (depends on memory location). `sorted(['a', '42'])` is not. Dictionaries are sorted by key in the displayhook, so if you don't mix strings and ints as keys then they are always printed he same. \n\nPossible solutions \n* don't mix string and int as keys\n* Doctest equality of dicts `L.complements() == {...}` instead of the dict repr",
    "created_at": "2014-10-15T10:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223586",
    "user": "https://github.com/vbraun"
}
```

The order in `sorted(['a', 42])` is random (depends on memory location). `sorted(['a', '42'])` is not. Dictionaries are sorted by key in the displayhook, so if you don't mix strings and ints as keys then they are always printed he same. 

Possible solutions 
* don't mix string and int as keys
* Doctest equality of dicts `L.complements() == {...}` instead of the dict repr



---

archive/issue_comments_223587.json:
```json
{
    "body": "Thanks Volker. From the user perspective I think that `do_something() --> some_output` is much better example than `do_something()==some_output --> True`.\n\nI was thinking about usual convention of having `0` and `1` as bottom and top element of a lattice. Maybe `'0'` instead of `0` is better. I will think this later (but polishind documentation on posets will go before lattices). For now this can be as it is.",
    "created_at": "2014-10-15T10:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223587",
    "user": "https://github.com/jm58660"
}
```

Thanks Volker. From the user perspective I think that `do_something() --> some_output` is much better example than `do_something()==some_output --> True`.

I was thinking about usual convention of having `0` and `1` as bottom and top element of a lattice. Maybe `'0'` instead of `0` is better. I will think this later (but polishind documentation on posets will go before lattices). For now this can be as it is.



---

archive/issue_comments_223588.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-15T18:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17138#issuecomment-223588",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049738.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-15T18:12:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17138",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17138#event-49738"
}
```
