# Issue 17021: Faster creation of words by the parent

archive/issues_016784.json:
```json
{
    "assignees": [],
    "body": "1. Move the code of `_construct_word` into `__call__` method.\n\n2. Create `_word_from_list` methods which are shortcuts for `__call__` when we know the datatype.\n\nHere are some benchmarks:\n\nlist:\n\n```\nsage: W = Words()\nsage: L = range(1000)\nsage: %timeit W.call__old(L)             # before\n10000 loops, best of 3: 45.1 \u00b5s per loop\n\nsage: %timeit W(L)                       # after\n10000 loops, best of 3: 17.1 \u00b5s per loop  \nsage: %timeit W(L, check=False)     \n100000 loops, best of 3: 2.21 \u00b5s per loop \nsage: %timeit W._word_from_list(L)  \n1000000 loops, best of 3: 1.33 \u00b5s per loop\n```\n\nstr:\n\n```\nsage: W = Words()\nsage: s = 'a'*1000\nsage: %timeit W.call__old(s)              # before\n10000 loops, best of 3: 45.7 \u00b5s per loop   \nsage: %timeit W(s)                        # after\n10000 loops, best of 3: 18.4 \u00b5s per loop  \nsage: %timeit W(s, check=False)           \n100000 loops, best of 3: 2.62 \u00b5s per loop\nsage: %timeit W._word_from_str(s)         \n1000000 loops, best of 3: 1.23 \u00b5s per loop\n```\n\ntuple:\n\n```\nsage: t = tuple(L)\nsage: %timeit W.call__old(t)             # before\n10000 loops, best of 3: 45.9 \u00b5s per loop \nsage: %timeit W(t)                       # after\n10000 loops, best of 3: 18.6 \u00b5s per loop \nsage: %timeit W(t,check=False)           \n100000 loops, best of 3: 3.25 \u00b5s per loop\nsage: %timeit W._word_from_tuple(t)      \n1000000 loops, best of 3: 1.3 \u00b5s per loop\n```\n\nchar (here creation is longer than str, tuple or list because a copy of data is performed):\n\n```\nsage: W = Words([0,1,2])\nsage: L = [0,1,1,2]*1000\nsage: type(W(L))\n<class 'sage.combinat.words.word.FiniteWord_char'>\nsage: %timeit W.call__old(L)           # before\n1000 loops, best of 3: 322 \u00b5s per loop\nsage: %timeit W(L)                     # after\n1000 loops, best of 3: 292 \u00b5s per loop\nsage: %timeit W(L, check=False)       \n1000 loops, best of 3: 248 \u00b5s per loop\nsage: %timeit W._word_from_char(L)    \n1000 loops, best of 3: 245 \u00b5s per loop\n```\n\nBEFORE:\n\n```\nsage: W = Words(range(5))\nsage: %time L = list(W.iterate_by_length(7))\nCPU times: user 4.6 s, sys: 54.7 ms, total: 4.66 s\nWall time: 4.68 s\n```\n\nAFTER (about 20 times faster):\n\n```\nsage: W = Words(range(5))\nsage: %time L = list(W.iterate_by_length(7))\nCPU times: user 235 ms, sys: 29.1 ms, total: 264 ms\nWall time: 259 ms                                  \n```\n\n\nCC:  @videlec @staroste\n\nBranch/Commit: **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **S\u00e9bastien Labb\u00e9**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/17021_\n\n",
    "closed_at": "2014-10-02T16:22:04Z",
    "created_at": "2014-09-20T23:47:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Faster creation of words by the parent",
    "type": "issue",
    "updated_at": "2014-10-02T16:22:04Z",
    "url": "https://github.com/sagemath/sage/issues/17021",
    "user": "https://github.com/seblabbe"
}
```
1. Move the code of `_construct_word` into `__call__` method.

2. Create `_word_from_list` methods which are shortcuts for `__call__` when we know the datatype.

Here are some benchmarks:

list:

```
sage: W = Words()
sage: L = range(1000)
sage: %timeit W.call__old(L)             # before
10000 loops, best of 3: 45.1 µs per loop

sage: %timeit W(L)                       # after
10000 loops, best of 3: 17.1 µs per loop  
sage: %timeit W(L, check=False)     
100000 loops, best of 3: 2.21 µs per loop 
sage: %timeit W._word_from_list(L)  
1000000 loops, best of 3: 1.33 µs per loop
```

str:

```
sage: W = Words()
sage: s = 'a'*1000
sage: %timeit W.call__old(s)              # before
10000 loops, best of 3: 45.7 µs per loop   
sage: %timeit W(s)                        # after
10000 loops, best of 3: 18.4 µs per loop  
sage: %timeit W(s, check=False)           
100000 loops, best of 3: 2.62 µs per loop
sage: %timeit W._word_from_str(s)         
1000000 loops, best of 3: 1.23 µs per loop
```

tuple:

```
sage: t = tuple(L)
sage: %timeit W.call__old(t)             # before
10000 loops, best of 3: 45.9 µs per loop 
sage: %timeit W(t)                       # after
10000 loops, best of 3: 18.6 µs per loop 
sage: %timeit W(t,check=False)           
100000 loops, best of 3: 3.25 µs per loop
sage: %timeit W._word_from_tuple(t)      
1000000 loops, best of 3: 1.3 µs per loop
```

char (here creation is longer than str, tuple or list because a copy of data is performed):

```
sage: W = Words([0,1,2])
sage: L = [0,1,1,2]*1000
sage: type(W(L))
<class 'sage.combinat.words.word.FiniteWord_char'>
sage: %timeit W.call__old(L)           # before
1000 loops, best of 3: 322 µs per loop
sage: %timeit W(L)                     # after
1000 loops, best of 3: 292 µs per loop
sage: %timeit W(L, check=False)       
1000 loops, best of 3: 248 µs per loop
sage: %timeit W._word_from_char(L)    
1000 loops, best of 3: 245 µs per loop
```

BEFORE:

```
sage: W = Words(range(5))
sage: %time L = list(W.iterate_by_length(7))
CPU times: user 4.6 s, sys: 54.7 ms, total: 4.66 s
Wall time: 4.68 s
```

AFTER (about 20 times faster):

```
sage: W = Words(range(5))
sage: %time L = list(W.iterate_by_length(7))
CPU times: user 235 ms, sys: 29.1 ms, total: 264 ms
Wall time: 259 ms                                  
```


CC:  @videlec @staroste

Branch/Commit: **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**

Reviewer: **Vincent Delecroix**

Author: **Sébastien Labbé**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/17021_





---

archive/issue_events_241023.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-20T23:47:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241023"
}
```



---

archive/issue_events_241024.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-20T23:47:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241024"
}
```



---

archive/issue_events_241025.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-20T23:47:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241025"
}
```



---

archive/issue_events_241026.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-20T23:47:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241026"
}
```



---

archive/issue_events_241027.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-20T23:50:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241027"
}
```



---

archive/issue_comments_225126.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a25e28644286e665c2cbfea5fec1ffc50e704101\"><code>a25e286</code></a></td><td><code>trac #17013: new class WordDatatype_char</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776\"><code>398b33c</code></a></td><td><code>trac #17013: added is_square in WordDatatype_char</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19\"><code>a563343</code></a></td><td><code>trac #17013: doctests improvements + bug fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d\"><code>9008b8d</code></a></td><td><code>Trac #17021: Faster creation of words by the parent.</code></td></tr></table>\n",
    "created_at": "2014-09-20T23:50:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225126",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a25e28644286e665c2cbfea5fec1ffc50e704101"><code>a25e286</code></a></td><td><code>trac #17013: new class WordDatatype_char</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/398b33c0a6f6a96f5c301e1867edb47158703776"><code>398b33c</code></a></td><td><code>trac #17013: added is_square in WordDatatype_char</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a563343267f1690d74275ad3835cdebef8512a19"><code>a563343</code></a></td><td><code>trac #17013: doctests improvements + bug fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d"><code>9008b8d</code></a></td><td><code>Trac #17021: Faster creation of words by the parent.</code></td></tr></table>




---

archive/issue_comments_225127.json:
```json
{
    "body": "Branch: **[u/slabbe/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17021)**",
    "created_at": "2014-09-20T23:50:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225127",
    "user": "https://github.com/seblabbe"
}
```

Branch: **[u/slabbe/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17021)**



---

archive/issue_comments_225128.json:
```json
{
    "body": "Commit: **[`9008b8d`](https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d)**",
    "created_at": "2014-09-20T23:50:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225128",
    "user": "https://github.com/seblabbe"
}
```

Commit: **[`9008b8d`](https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d)**



---

archive/issue_comments_225129.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI based my branch on top of #17013 who just got positive reviewed. I hope it is okay.",
    "created_at": "2014-09-20T23:54:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225129",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:2" align="right">comment:2</div>

I based my branch on top of #17013 who just got positive reviewed. I hope it is okay.



---

archive/issue_comments_225130.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHello,\n\n1) what is the point of\n\n```\n+        word_classes = self._element_classes\n+        cls_str = 'FiniteWord_list'\n+        return word_classes[cls_str](parent=self, data=data)\n```\ninstead of\n\n```\n+        return self._element_classes['FiniteWord_list'](parent, data)\n```\n\n2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). Instead of using directly those, I would rather introduce a `check` argument in `__call__` and do not use them in methods of `FiniteWord`.\n\nVincent",
    "created_at": "2014-09-24T10:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225130",
    "user": "https://github.com/videlec"
}
```

<div id="comment:3" align="right">comment:3</div>

Hello,

1) what is the point of

```
+        word_classes = self._element_classes
+        cls_str = 'FiniteWord_list'
+        return word_classes[cls_str](parent=self, data=data)
```
instead of

```
+        return self._element_classes['FiniteWord_list'](parent, data)
```

2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). Instead of using directly those, I would rather introduce a `check` argument in `__call__` and do not use them in methods of `FiniteWord`.

Vincent



---

archive/issue_events_241028.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-24T10:17:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241028"
}
```



---

archive/issue_events_241029.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-24T10:17:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241029"
}
```



---

archive/issue_comments_225131.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n> 1) what is the point of\n\nYou are right, I will change that.\n\n> 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. \n\nOkay, I see and agree.\n\nBut still `__call__` is much slower because it guesses the datatype. I will check with a check argument whether it is better...",
    "created_at": "2014-09-24T22:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225131",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:4" align="right">comment:4</div>

> 1) what is the point of

You are right, I will change that.

> 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. 

Okay, I see and agree.

But still `__call__` is much slower because it guesses the datatype. I will check with a check argument whether it is better...



---

archive/issue_events_241030.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-24T22:06:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241030"
}
```



---

archive/issue_events_241031.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-24T22:06:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241031"
}
```



---

archive/issue_comments_225132.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@seblabbe](#comment%3A4):\n> > 1) what is the point of\n\n> \n> You are right, I will change that.\n> \n> > 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. \n\n> \n> Okay, I see and agree.\n> \n> But still `__call__` is much slower because it guesses the datatype. I will check with a check argument whether it is better...\n\nNot if `datatype` is properly set in input, no? You can assume that with a `check=False`, if the datatype is provided then there is no need to check that the data fits.\n\nVincent",
    "created_at": "2014-09-25T07:11:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225132",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@seblabbe](#comment%3A4):
> > 1) what is the point of

> 
> You are right, I will change that.
> 
> > 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. 

> 
> Okay, I see and agree.
> 
> But still `__call__` is much slower because it guesses the datatype. I will check with a check argument whether it is better...

Not if `datatype` is properly set in input, no? You can assume that with a `check=False`, if the datatype is provided then there is no need to check that the data fits.

Vincent



---

archive/issue_comments_225133.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n> 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). \n\nWhat do you think if we do the following (automatically use char instead of list)?\n\n```diff\n    @lazy_attribute\n    def _element_classes(self):\n\n        [...]\n\n        # test whether or not we can use the class Finiteword_char\n        if (self.alphabet().cardinality() <= 256 and\n                all(isinstance(i, (int,Integer)) and 0 <= i < 256 for i in self.alphabet())):\n            L = self.alphabet().list()\n            if (all(L[i] < L[i+1] for i in range(len(L)-1)) and\n                    all(self.cmp_letters(L[i],L[i+1]) == -1 for i in range(len(L)-1))):\n                classes['FiniteWord_char'] = word.FiniteWord_char\n+               classes['FiniteWord_list'] = word.FiniteWord_char\n```\n\nWell, maybe it is bad since we won't be able to compare char with list anymore...",
    "created_at": "2014-09-26T10:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225133",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:7" align="right">comment:7</div>

> 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). 

What do you think if we do the following (automatically use char instead of list)?

```diff
    @lazy_attribute
    def _element_classes(self):

        [...]

        # test whether or not we can use the class Finiteword_char
        if (self.alphabet().cardinality() <= 256 and
                all(isinstance(i, (int,Integer)) and 0 <= i < 256 for i in self.alphabet())):
            L = self.alphabet().list()
            if (all(L[i] < L[i+1] for i in range(len(L)-1)) and
                    all(self.cmp_letters(L[i],L[i+1]) == -1 for i in range(len(L)-1))):
                classes['FiniteWord_char'] = word.FiniteWord_char
+               classes['FiniteWord_list'] = word.FiniteWord_char
```

Well, maybe it is bad since we won't be able to compare char with list anymore...



---

archive/issue_comments_225134.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@seblabbe](#comment%3A7):\n> > 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). \n\n> \n> What do you think if we do the following (automatically use char instead of list)?\n\n>\n> [...]\n\n \nI already proposed that and you answered: \"and what if I really want a `Word_list`?\" If you want to go that way, we can even remove all the classes and always return `Word_char` whatever the input is. It is definitely the simplest but of course only concerns alphabet included in [0,255[.\n\nVincent",
    "created_at": "2014-09-26T13:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225134",
    "user": "https://github.com/videlec"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@seblabbe](#comment%3A7):
> > 2) Calling directly `.finite_word_tuple()` or `.finite_word_list()` from the methods in `FiniteWord` is bad. Doing that you impose the return type to be `FiniteWord_list` or `FiniteWord_tuple` (you might prefer a `FiniteWord_char` sometimes). 

> 
> What do you think if we do the following (automatically use char instead of list)?

>
> [...]

 
I already proposed that and you answered: "and what if I really want a `Word_list`?" If you want to go that way, we can even remove all the classes and always return `Word_char` whatever the input is. It is definitely the simplest but of course only concerns alphabet included in [0,255[.

Vincent



---

archive/issue_comments_225135.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n 1. Move the code of `_construct_word` into `__call__` method.\n \n-2. Create `finite_word_list` methods which are shortcuts for `__call__` when we know the datatype.\n+2. Create `_word_from_list` methods which are shortcuts for `__call__` when we know the datatype.\n \n Here are some benchmarks:\n \n@@ -9,10 +9,15 @@\n ```\n sage: W = Words()\n sage: L = range(1000)\n-sage: %timeit W(L)\n-10000 loops, best of 3: 45.5 \u00b5s per loop\n-sage: %timeit W.finite_word_list(L)\n-1000000 loops, best of 3: 1.29 \u00b5s per loop\n+sage: %timeit W.call__old(L)             # before\n+10000 loops, best of 3: 45.1 \u00b5s per loop\n+\n+sage: %timeit W(L)                       # after\n+10000 loops, best of 3: 17.1 \u00b5s per loop  \n+sage: %timeit W(L, check=False)     \n+100000 loops, best of 3: 2.21 \u00b5s per loop \n+sage: %timeit W._word_from_list(L)  \n+1000000 loops, best of 3: 1.33 \u00b5s per loop\n ```\n \n str:\n@@ -20,33 +25,45 @@\n ```\n sage: W = Words()\n sage: s = 'a'*1000\n-sage: %timeit W(s)\n-10000 loops, best of 3: 45.2 \u00b5s per loop\n-sage: %timeit W.finite_word_str(s)\n-1000000 loops, best of 3: 1.27 \u00b5s per loop\n+sage: %timeit W.call__old(s)              # before\n+10000 loops, best of 3: 45.7 \u00b5s per loop   \n+sage: %timeit W(s)                        # after\n+10000 loops, best of 3: 18.4 \u00b5s per loop  \n+sage: %timeit W(s, check=False)           \n+100000 loops, best of 3: 2.62 \u00b5s per loop\n+sage: %timeit W._word_from_str(s)         \n+1000000 loops, best of 3: 1.23 \u00b5s per loop\n ```\n \n tuple:\n \n ```\n sage: t = tuple(L)\n-sage: %timeit W(t)\n-10000 loops, best of 3: 46 \u00b5s per loop\n-sage: %timeit W.finite_word_tuple(t)\n-1000000 loops, best of 3: 1.39 \u00b5s per loop\n+sage: %timeit W.call__old(t)             # before\n+10000 loops, best of 3: 45.9 \u00b5s per loop \n+sage: %timeit W(t)                       # after\n+10000 loops, best of 3: 18.6 \u00b5s per loop \n+sage: %timeit W(t,check=False)           \n+100000 loops, best of 3: 3.25 \u00b5s per loop\n+sage: %timeit W._word_from_tuple(t)      \n+1000000 loops, best of 3: 1.3 \u00b5s per loop\n ```\n \n-char (why creation is so longer than str, tuple or list?):\n+char (here creation is longer than str, tuple or list because a copy of data is performed):\n \n ```\n sage: W = Words([0,1,2])\n sage: L = [0,1,1,2]*1000\n sage: type(W(L))\n <class 'sage.combinat.words.word.FiniteWord_char'>\n-sage: %timeit W(L)\n-1000 loops, best of 3: 336 \u00b5s per loop\n-sage: %timeit W.finite_word_char(L)\n-1000 loops, best of 3: 246 \u00b5s per loop\n+sage: %timeit W.call__old(L)           # before\n+1000 loops, best of 3: 322 \u00b5s per loop\n+sage: %timeit W(L)                     # after\n+1000 loops, best of 3: 292 \u00b5s per loop\n+sage: %timeit W(L, check=False)       \n+1000 loops, best of 3: 248 \u00b5s per loop\n+sage: %timeit W._word_from_char(L)    \n+1000 loops, best of 3: 245 \u00b5s per loop\n ```\n \n BEFORE:\n@@ -58,12 +75,12 @@\n Wall time: 4.68 s\n ```\n \n-AFTER:\n+AFTER (about 20 times faster):\n \n ```\n sage: W = Words(range(5))\n sage: %time L = list(W.iterate_by_length(7))\n-CPU times: user 940 ms, sys: 80.4 ms, total: 1.02 s\n-Wall time: 1.02 s\n+CPU times: user 235 ms, sys: 29.1 ms, total: 264 ms\n+Wall time: 259 ms                                  \n ```\n \n``````\n",
    "created_at": "2014-09-28T13:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225135",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 1. Move the code of `_construct_word` into `__call__` method.
 
-2. Create `finite_word_list` methods which are shortcuts for `__call__` when we know the datatype.
+2. Create `_word_from_list` methods which are shortcuts for `__call__` when we know the datatype.
 
 Here are some benchmarks:
 
@@ -9,10 +9,15 @@
 ```
 sage: W = Words()
 sage: L = range(1000)
-sage: %timeit W(L)
-10000 loops, best of 3: 45.5 µs per loop
-sage: %timeit W.finite_word_list(L)
-1000000 loops, best of 3: 1.29 µs per loop
+sage: %timeit W.call__old(L)             # before
+10000 loops, best of 3: 45.1 µs per loop
+
+sage: %timeit W(L)                       # after
+10000 loops, best of 3: 17.1 µs per loop  
+sage: %timeit W(L, check=False)     
+100000 loops, best of 3: 2.21 µs per loop 
+sage: %timeit W._word_from_list(L)  
+1000000 loops, best of 3: 1.33 µs per loop
 ```
 
 str:
@@ -20,33 +25,45 @@
 ```
 sage: W = Words()
 sage: s = 'a'*1000
-sage: %timeit W(s)
-10000 loops, best of 3: 45.2 µs per loop
-sage: %timeit W.finite_word_str(s)
-1000000 loops, best of 3: 1.27 µs per loop
+sage: %timeit W.call__old(s)              # before
+10000 loops, best of 3: 45.7 µs per loop   
+sage: %timeit W(s)                        # after
+10000 loops, best of 3: 18.4 µs per loop  
+sage: %timeit W(s, check=False)           
+100000 loops, best of 3: 2.62 µs per loop
+sage: %timeit W._word_from_str(s)         
+1000000 loops, best of 3: 1.23 µs per loop
 ```
 
 tuple:
 
 ```
 sage: t = tuple(L)
-sage: %timeit W(t)
-10000 loops, best of 3: 46 µs per loop
-sage: %timeit W.finite_word_tuple(t)
-1000000 loops, best of 3: 1.39 µs per loop
+sage: %timeit W.call__old(t)             # before
+10000 loops, best of 3: 45.9 µs per loop 
+sage: %timeit W(t)                       # after
+10000 loops, best of 3: 18.6 µs per loop 
+sage: %timeit W(t,check=False)           
+100000 loops, best of 3: 3.25 µs per loop
+sage: %timeit W._word_from_tuple(t)      
+1000000 loops, best of 3: 1.3 µs per loop
 ```
 
-char (why creation is so longer than str, tuple or list?):
+char (here creation is longer than str, tuple or list because a copy of data is performed):
 
 ```
 sage: W = Words([0,1,2])
 sage: L = [0,1,1,2]*1000
 sage: type(W(L))
 <class 'sage.combinat.words.word.FiniteWord_char'>
-sage: %timeit W(L)
-1000 loops, best of 3: 336 µs per loop
-sage: %timeit W.finite_word_char(L)
-1000 loops, best of 3: 246 µs per loop
+sage: %timeit W.call__old(L)           # before
+1000 loops, best of 3: 322 µs per loop
+sage: %timeit W(L)                     # after
+1000 loops, best of 3: 292 µs per loop
+sage: %timeit W(L, check=False)       
+1000 loops, best of 3: 248 µs per loop
+sage: %timeit W._word_from_char(L)    
+1000 loops, best of 3: 245 µs per loop
 ```
 
 BEFORE:
@@ -58,12 +75,12 @@
 Wall time: 4.68 s
 ```
 
-AFTER:
+AFTER (about 20 times faster):
 
 ```
 sage: W = Words(range(5))
 sage: %time L = list(W.iterate_by_length(7))
-CPU times: user 940 ms, sys: 80.4 ms, total: 1.02 s
-Wall time: 1.02 s
+CPU times: user 235 ms, sys: 29.1 ms, total: 264 ms
+Wall time: 259 ms                                  
 ```
 
``````




---

archive/issue_comments_225136.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThere is no new commit, is that ok?",
    "created_at": "2014-09-28T14:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225136",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

There is no new commit, is that ok?



---

archive/issue_comments_225137.json:
```json
{
    "body": "Changed commit from **[`9008b8d`](https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d)** to **[`3a26ce4`](https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1)**",
    "created_at": "2014-09-28T14:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225137",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9008b8d`](https://github.com/sagemath/sagetrac-mirror/commit/9008b8d2986614ece259a54274ae054ef5fad40d)** to **[`3a26ce4`](https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1)**



---

archive/issue_comments_225138.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1\"><code>3a26ce4</code></a></td><td><code>Trac #17021: answered reviewer comments</code></td></tr></table>\n",
    "created_at": "2014-09-28T14:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225138",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1"><code>3a26ce4</code></a></td><td><code>Trac #17021: answered reviewer comments</code></td></tr></table>




---

archive/issue_events_241032.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T14:34:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241032"
}
```



---

archive/issue_events_241033.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T14:34:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241033"
}
```



---

archive/issue_events_241034.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-28T16:16:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241034"
}
```



---

archive/issue_events_241035.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-28T16:16:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241035"
}
```



---

archive/issue_comments_225139.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHello,\n\nMuch cleaner than before! Great!\n\nAre you sure this is worth it\n\n```\nsage: W = Words([0,1,2])\nsage: l = [0,1,0]*100\nsage: timeit(\"w = W(l, datatype='list', check=False)\", number=2000)\n2000 loops, best of 3: 2.17 \u00b5s per loop\nsage: timeit(\"w = W._word_from_list(l)\", number=2000)\n2000 loops, best of 3: 1.55 \u00b5s per loop\nsage: cls = W._element_classes['FiniteWord_list']\nsage: timeit(\"w = cls(W,l)\", number=2000)\n2000 loops, best of 3: 717 ns per loop\n```\nHaving 20% gain with a method that is twice slower than calling the class constructor looks useless. If you want speed, use the classes themselves.\n\nThe name `_word_from_list_or_char` is more than confusing. For me `from` is about the input not the output. I have nothing against a method `_word_from_list` which return whatever it wants, but I would expect it to raise an Error if the input is not a list.\n\nSometimes you use `MyWordClass(parent=self, data=data)` and sometimes `MyWordClass(parent, data)`. Is there a reason why?\n\nVincent",
    "created_at": "2014-09-28T16:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225139",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

Hello,

Much cleaner than before! Great!

Are you sure this is worth it

```
sage: W = Words([0,1,2])
sage: l = [0,1,0]*100
sage: timeit("w = W(l, datatype='list', check=False)", number=2000)
2000 loops, best of 3: 2.17 µs per loop
sage: timeit("w = W._word_from_list(l)", number=2000)
2000 loops, best of 3: 1.55 µs per loop
sage: cls = W._element_classes['FiniteWord_list']
sage: timeit("w = cls(W,l)", number=2000)
2000 loops, best of 3: 717 ns per loop
```
Having 20% gain with a method that is twice slower than calling the class constructor looks useless. If you want speed, use the classes themselves.

The name `_word_from_list_or_char` is more than confusing. For me `from` is about the input not the output. I have nothing against a method `_word_from_list` which return whatever it wants, but I would expect it to raise an Error if the input is not a list.

Sometimes you use `MyWordClass(parent=self, data=data)` and sometimes `MyWordClass(parent, data)`. Is there a reason why?

Vincent



---

archive/issue_comments_225140.json:
```json
{
    "body": "Changed commit from **[`3a26ce4`](https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1)** to **[`383f7e2`](https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3)**",
    "created_at": "2014-09-28T18:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225140",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3a26ce4`](https://github.com/sagemath/sagetrac-mirror/commit/3a26ce48b97c17c16e663c4bd9aff00b83a74cc1)** to **[`383f7e2`](https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3)**



---

archive/issue_comments_225141.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea2752dbb457dfb506b3172b42352963d988048d\"><code>ea2752d</code></a></td><td><code>Merge branch 't/17021_6.4.beta3' into t/17021</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3\"><code>383f7e2</code></a></td><td><code>Trac #17021: Fixes according to reviewer comment #2</code></td></tr></table>\n",
    "created_at": "2014-09-28T18:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225141",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea2752dbb457dfb506b3172b42352963d988048d"><code>ea2752d</code></a></td><td><code>Merge branch 't/17021_6.4.beta3' into t/17021</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3"><code>383f7e2</code></a></td><td><code>Trac #17021: Fixes according to reviewer comment #2</code></td></tr></table>




---

archive/issue_comments_225142.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI kept `_word_from_word`, `_word_from_iter` and `_word_from_callable` because their code takes more than one line and the latter two are used two or three times in the `__call__` method.",
    "created_at": "2014-09-28T18:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225142",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:15" align="right">comment:15</div>

I kept `_word_from_word`, `_word_from_iter` and `_word_from_callable` because their code takes more than one line and the latter two are used two or three times in the `__call__` method.



---

archive/issue_events_241036.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T18:34:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241036"
}
```



---

archive/issue_events_241037.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T18:34:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241037"
}
```



---

archive/issue_comments_225143.json:
```json
{
    "body": "Changed branch from **[u/slabbe/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17021)** to **[u/vdelecroix/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17021)**",
    "created_at": "2014-09-28T22:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225143",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/slabbe/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/slabbe/17021)** to **[u/vdelecroix/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17021)**



---

archive/issue_comments_225144.json:
```json
{
    "body": "Changed commit from **[`383f7e2`](https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3)** to **[`020d549`](https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914)**",
    "created_at": "2014-09-28T22:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225144",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`383f7e2`](https://github.com/sagemath/sagetrac-mirror/commit/383f7e2b0e666df3531c70af710ba7a4cd7d09b3)** to **[`020d549`](https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914)**



---

archive/issue_comments_225145.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHi Sebastien,\n\nI added a commit which removes some trailing whitespaces and allow to use `Word_char` when the input data is a tuple.\n\nIf you are happy with it, set to positive review.\n\nVincent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914\"><code>020d549</code></a></td><td><code>trac #17021: trailing whitespaces + more Word_char</code></td></tr></table>\n",
    "created_at": "2014-09-28T22:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225145",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">comment:16</div>

Hi Sebastien,

I added a commit which removes some trailing whitespaces and allow to use `Word_char` when the input data is a tuple.

If you are happy with it, set to positive review.

Vincent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914"><code>020d549</code></a></td><td><code>trac #17021: trailing whitespaces + more Word_char</code></td></tr></table>




---

archive/issue_comments_225146.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nokay!",
    "created_at": "2014-09-28T22:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225146",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:17" align="right">comment:17</div>

okay!



---

archive/issue_events_241038.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T22:48:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241038"
}
```



---

archive/issue_events_241039.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-28T22:48:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241039"
}
```



---

archive/issue_comments_225147.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2014-09-28T22:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225147",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_225148.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n\n```\nsage -t --long --warn-long 62.5 src/sage/combinat/permutation.py  # 1 doctest failed\nsage -t --long --warn-long 62.5 src/sage/combinat/parking_functions.py  # 62 doctests failed\n```",
    "created_at": "2014-09-29T13:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225148",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">comment:18</div>


```
sage -t --long --warn-long 62.5 src/sage/combinat/permutation.py  # 1 doctest failed
sage -t --long --warn-long 62.5 src/sage/combinat/parking_functions.py  # 62 doctests failed
```



---

archive/issue_events_241040.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-29T13:15:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241040"
}
```



---

archive/issue_events_241041.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-29T13:15:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241041"
}
```



---

archive/issue_comments_225149.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee\"><code>e3b6901</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>\n",
    "created_at": "2014-09-29T14:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225149",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee"><code>e3b6901</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>




---

archive/issue_comments_225150.json:
```json
{
    "body": "Changed commit from **[`020d549`](https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914)** to **[`e3b6901`](https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee)**",
    "created_at": "2014-09-29T14:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225150",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`020d549`](https://github.com/sagemath/sagetrac-mirror/commit/020d5498e8d3ca4b452accd5a089e0b155000914)** to **[`e3b6901`](https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee)**



---

archive/issue_comments_225151.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHi Sebastien,\n\nSo `CombinatorialObject` is still used as input ;-( I added a special case for it in the `__call__`.\n\nVincent",
    "created_at": "2014-09-29T14:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225151",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

Hi Sebastien,

So `CombinatorialObject` is still used as input ;-( I added a special case for it in the `__call__`.

Vincent



---

archive/issue_comments_225152.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n`import is_iterator` ?",
    "created_at": "2014-09-29T14:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225152",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:21" align="right">comment:21</div>

`import is_iterator` ?



---

archive/issue_comments_225153.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484\"><code>df5da57</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>\n",
    "created_at": "2014-09-29T15:10:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225153",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484"><code>df5da57</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>




---

archive/issue_comments_225154.json:
```json
{
    "body": "Changed commit from **[`e3b6901`](https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee)** to **[`df5da57`](https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484)**",
    "created_at": "2014-09-29T15:10:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225154",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e3b6901`](https://github.com/sagemath/sagetrac-mirror/commit/e3b69013d091769af8c6b98b3d83e79997c391ee)** to **[`df5da57`](https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484)**



---

archive/issue_comments_225155.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c\"><code>7b5b64c</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>\n",
    "created_at": "2014-09-29T15:11:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225155",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c"><code>7b5b64c</code></a></td><td><code>trac #17021: fix `__call__` for CombinatorialObject</code></td></tr></table>




---

archive/issue_comments_225156.json:
```json
{
    "body": "Changed commit from **[`df5da57`](https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484)** to **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**",
    "created_at": "2014-09-29T15:11:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225156",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`df5da57`](https://github.com/sagemath/sagetrac-mirror/commit/df5da575f9ca58196ad9084aa204a4874a2f7484)** to **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**



---

archive/issue_events_241042.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-29T16:01:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241042"
}
```



---

archive/issue_events_241043.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-09-29T16:01:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241043"
}
```



---

archive/issue_comments_225157.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nHey Sebastien,\n\nAre you happy with that version? The tests in combinat pass at home.\n\nVincent",
    "created_at": "2014-09-29T16:21:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225157",
    "user": "https://github.com/videlec"
}
```

<div id="comment:25" align="right">comment:25</div>

Hey Sebastien,

Are you happy with that version? The tests in combinat pass at home.

Vincent



---

archive/issue_comments_225158.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nTest in combinat pass here too. I was waiting for the buildbot. It says \"success\", but I can not check if all of tests in the sage library passed. Can you see it?\n\nS\u00e9bastien",
    "created_at": "2014-09-29T16:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225158",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:26" align="right">comment:26</div>

Test in combinat pass here too. I was waiting for the buildbot. It says "success", but I can not check if all of tests in the sage library passed. Can you see it?

Sébastien



---

archive/issue_events_241044.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-29T16:59:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241044"
}
```



---

archive/issue_events_241045.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-09-29T16:59:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241045"
}
```



---

archive/issue_comments_225159.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nNope. But at least it pass where it failed before... I set to positive review.\n\nI do not know whether the build bot runs the test or only try to compile and run.\n\nVincent",
    "created_at": "2014-09-29T16:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225159",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

Nope. But at least it pass where it failed before... I set to positive review.

I do not know whether the build bot runs the test or only try to compile and run.

Vincent



---

archive/issue_comments_225160.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI tried `make doc-clean` and `sage -docbuild reference html` and I get the following error:\n\n```\n...\n[combinat ] writing output... [ 98%] sage/databases/oeis                                               \n[combinat ] writing output... [ 98%] species                                                           \n[combinat ] writing output... [ 99%] symmetric_functions                                               \n[combinat ] writing output... [ 99%] tableaux                                                          \n[combinat ] writing output... [100%] words                                                             \n[combinat ] None:38: WARNING: citation not found: Schiffmann                                           \nError building the documentation.                                                                      \nTraceback (most recent call last):                                                                     \n  File \"/Users/slabbe/Applications/sage-git/src/doc/common/builder.py\", line 1491, in <module>         \n    getattr(get_builder(name), type)()                                                                 \n  File \"/Users/slabbe/Applications/sage-git/src/doc/common/builder.py\", line 503, in _wrapper          \n    x.get(99999)                                                                                       \n  File \"/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/pool.py\", line 558, in get\n    raise self._value                                                                                  \nOSError: [combinat ] None:38: WARNING: citation not found: Schiffmann\n```\n\nBut I get the same error on a clean version of `sage-6.4.beta4`. So it is not related to us. Also:\n\n```\nsage: search_src('Schiffman')      \nalgebras/hall_algebra.py:114:    See section 2.3 in [Schiffmann]_, and sections II.2 and III.3     \nalgebras/hall_algebra.py:211:    .. [Schiffmann] Oliver Schiffmann. *Lectures on Hall algebras*.   \nalgebras/hall_algebra.py:465:            corresponding to `\\lambda`. See Lemma 2.8 in [Schiffmann]_\ncombinat/hall_polynomial.py:66:    in [Schiffmann]_):                                              \n```\n\nThe part on words did not raised any warning or errors. So still positive review.",
    "created_at": "2014-09-29T17:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225160",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:28" align="right">comment:28</div>

I tried `make doc-clean` and `sage -docbuild reference html` and I get the following error:

```
...
[combinat ] writing output... [ 98%] sage/databases/oeis                                               
[combinat ] writing output... [ 98%] species                                                           
[combinat ] writing output... [ 99%] symmetric_functions                                               
[combinat ] writing output... [ 99%] tableaux                                                          
[combinat ] writing output... [100%] words                                                             
[combinat ] None:38: WARNING: citation not found: Schiffmann                                           
Error building the documentation.                                                                      
Traceback (most recent call last):                                                                     
  File "/Users/slabbe/Applications/sage-git/src/doc/common/builder.py", line 1491, in <module>         
    getattr(get_builder(name), type)()                                                                 
  File "/Users/slabbe/Applications/sage-git/src/doc/common/builder.py", line 503, in _wrapper          
    x.get(99999)                                                                                       
  File "/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/pool.py", line 558, in get
    raise self._value                                                                                  
OSError: [combinat ] None:38: WARNING: citation not found: Schiffmann
```

But I get the same error on a clean version of `sage-6.4.beta4`. So it is not related to us. Also:

```
sage: search_src('Schiffman')      
algebras/hall_algebra.py:114:    See section 2.3 in [Schiffmann]_, and sections II.2 and III.3     
algebras/hall_algebra.py:211:    .. [Schiffmann] Oliver Schiffmann. *Lectures on Hall algebras*.   
algebras/hall_algebra.py:465:            corresponding to `\lambda`. See Lemma 2.8 in [Schiffmann]_
combinat/hall_polynomial.py:66:    in [Schiffmann]_):                                              
```

The part on words did not raised any warning or errors. So still positive review.



---

archive/issue_comments_225161.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17021)** to **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**",
    "created_at": "2014-10-02T16:22:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17021#issuecomment-225161",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/17021](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/17021)** to **[`7b5b64c`](https://github.com/sagemath/sagetrac-mirror/commit/7b5b64c2f5af5dc976439b9d84ac6030ac94290c)**



---

archive/issue_events_241046.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-02T16:22:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241046"
}
```



---

archive/issue_events_241047.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ff6467ada62050a9330326598a55479100c4f1ce",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-10-02T16:22:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17021",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17021#event-241047"
}
```
