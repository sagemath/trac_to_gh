# Issue 17190: Error in conversion from RR['x,y'] to RR['x']

archive/issues_016953.json:
```json
{
    "body": "Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:\n\n```\nsage: RR['x'](RR['x,y'].0)\n\n----\nValueError                                Traceback (most recent call last)\n...\nValueError: max() arg is an empty sequence\n```\n\nThis does not seem to affect other rings:\n\n```\nsage: QQ['x'](QQ['x,y'].0)\nx\nsage: CC['x'](CC['x,y'].0)\nx\nsage: RDF['x'](RDF['x,y'].0)\nx\n```\n\nKeywords: polynomials RR\n\nBranch/Commit: 6315d74ebf51bc82c26d6dafd389f52d895c8d78\n\nReviewer: Travis Scrimshaw\n\nAuthor: Bruno Grenet\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17190\n\n",
    "closed_at": "2015-10-12T07:16:44Z",
    "created_at": "2014-10-21T16:05:59Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Error in conversion from RR['x,y'] to RR['x']",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17190",
    "user": "https://github.com/defeo"
}
```
Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:

```
sage: RR['x'](RR['x,y'].0)

----
ValueError                                Traceback (most recent call last)
...
ValueError: max() arg is an empty sequence
```

This does not seem to affect other rings:

```
sage: QQ['x'](QQ['x,y'].0)
x
sage: CC['x'](CC['x,y'].0)
x
sage: RDF['x'](RDF['x,y'].0)
x
```

Keywords: polynomials RR

Branch/Commit: 6315d74ebf51bc82c26d6dafd389f52d895c8d78

Reviewer: Travis Scrimshaw

Author: Bruno Grenet

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17190





---

archive/issue_comments_290021.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,9 @@\n Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:\n \n ```\n-sage: RR['x'](RR['x,y'].0)\n+sage: RR[wiki:'x' x](RR[wiki:'x,y' x,y].0)~~\n \n----\n+----\n ValueError                                Traceback (most recent call last)\n ...\n ValueError: max() arg is an empty sequence\n@@ -12,11 +12,10 @@\n This does not seem to affect other rings:\n \n ```\n-sage: QQ['x'](QQ['x,y'].0)\n+sage: QQ[wiki:'x' x](QQ[wiki:'x,y' x,y].0)\n x\n-sage: CC['x'](CC['x,y'].0)\n+sage: CC[wiki:'x' x](CC[wiki:'x,y' x,y].0)\n x\n-sage: RDF['x'](RDF['x,y'].0)\n+sage: RDF[wiki:'x' x](RDF[wiki:'x,y' x,y].0)\n x\n ```\n-\n``````\n",
    "created_at": "2014-10-21T16:07:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290021",
    "user": "https://github.com/defeo"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,9 @@
 Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:
 
 ```
-sage: RR['x'](RR['x,y'].0)
+sage: RR[wiki:'x' x](RR[wiki:'x,y' x,y].0)~~
 
----
+----
 ValueError                                Traceback (most recent call last)
 ...
 ValueError: max() arg is an empty sequence
@@ -12,11 +12,10 @@
 This does not seem to affect other rings:
 
 ```
-sage: QQ['x'](QQ['x,y'].0)
+sage: QQ[wiki:'x' x](QQ[wiki:'x,y' x,y].0)
 x
-sage: CC['x'](CC['x,y'].0)
+sage: CC[wiki:'x' x](CC[wiki:'x,y' x,y].0)
 x
-sage: RDF['x'](RDF['x,y'].0)
+sage: RDF[wiki:'x' x](RDF[wiki:'x,y' x,y].0)
 x
 ```
-
``````




---

archive/issue_comments_290022.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:\n \n ```\n-sage: RR[wiki:'x' x](RR[wiki:'x,y' x,y].0)~~\n+sage: RR['x'](RR['x,y'].0)\n \n ----\n ValueError                                Traceback (most recent call last)\n@@ -12,10 +12,10 @@\n This does not seem to affect other rings:\n \n ```\n-sage: QQ[wiki:'x' x](QQ[wiki:'x,y' x,y].0)\n+sage: QQ['x'](QQ['x,y'].0)\n x\n-sage: CC[wiki:'x' x](CC[wiki:'x,y' x,y].0)\n+sage: CC['x'](CC['x,y'].0)\n x\n-sage: RDF[wiki:'x' x](RDF[wiki:'x,y' x,y].0)\n+sage: RDF['x'](RDF['x,y'].0)\n x\n ```\n``````\n",
    "created_at": "2014-10-21T16:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290022",
    "user": "https://github.com/defeo"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 Conversion of univariate polynomials from the bivariate ring `RR['x,y']` fails:
 
 ```
-sage: RR[wiki:'x' x](RR[wiki:'x,y' x,y].0)~~
+sage: RR['x'](RR['x,y'].0)
 
 ----
 ValueError                                Traceback (most recent call last)
@@ -12,10 +12,10 @@
 This does not seem to affect other rings:
 
 ```
-sage: QQ[wiki:'x' x](QQ[wiki:'x,y' x,y].0)
+sage: QQ['x'](QQ['x,y'].0)
 x
-sage: CC[wiki:'x' x](CC[wiki:'x,y' x,y].0)
+sage: CC['x'](CC['x,y'].0)
 x
-sage: RDF[wiki:'x' x](RDF[wiki:'x,y' x,y].0)
+sage: RDF['x'](RDF['x,y'].0)
 x
 ```
``````




---

archive/issue_comments_290023.json:
```json
{
    "body": "Changing branch from \"\" to \"u/bruno/t17190_error_conversion\"",
    "created_at": "2015-09-25T13:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290023",
    "user": "https://github.com/bgrenet"
}
```

Changing branch from "" to "u/bruno/t17190_error_conversion"



---

archive/issue_comments_290024.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-25T14:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290024",
    "user": "https://github.com/bgrenet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_290025.json:
```json
{
    "body": "Changing author from \"\" to \"Bruno Grenet\"",
    "created_at": "2015-09-25T14:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290025",
    "user": "https://github.com/bgrenet"
}
```

Changing author from "" to "Bruno Grenet"



---

archive/issue_comments_290026.json:
```json
{
    "body": "Changing commit from \"\" to \"c546e17684c29b2e5f108440205833b55e7622d5\"",
    "created_at": "2015-09-25T14:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290026",
    "user": "https://github.com/bgrenet"
}
```

Changing commit from "" to "c546e17684c29b2e5f108440205833b55e7622d5"



---

archive/issue_comments_290027.json:
```json
{
    "body": "<a id='comment:4'></a>\n~~**[EDIT]** As one can notice, I messed up the history with some completely unrelated commits. I am trying to undo this... The relevant code is the latest commit only! **![/EDIT]**~~ Should be OK now!\n\nThe problem was not in conversion, but rather in initialization of univariate polynomials over `RR`, with an empty dictionary.  \nBefore:\n\n```python\nsage: RR['x']({})\nTraceback (most recent call last):\n...\nValueError: max() arg is an empty sequence\n```\nAfter:\n\n```python\nsage: RR['x']({})\n0\n```\n\nAs a result, we also have:\n\n```python\nsage: RR['x'](RR['x,y'].0)\nx\n```\n\n## Details\n\nIn the initialization of a polynomial over `RR`, if the \"data\" is given as a dictionary, this dictionary is converted to a list. Before the patch, there was an attempt to compute `max(x.keys())` where `x` is the dictionary. If `x` is empty, this yields an error. To correct the error, I could have add a test. Yet, a function is already specifically defined in the class `Polynomial` to perform this conversion `dict -> list`. The new code just uses this function. \n\nNote that I corrected some slight formatting issues in the docstring in other (unrelated) parts of the same file `src/sage/rings/polynomials/polynomial_real_mpfr_dense.pyx`.\n\n---\nNew commits: (**Note:** Irrelevant commits. The only correct commit is in[comment:5](#comment%3A5) below)\n|                                                                                                                                          |                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[98b7ca1](http://git.sagemath.org/sage.git/commit/?id=98b7ca12cfe9335f9c871eda34ff9dc2ce03d3cf)|`Rebased on 6.9beta1`|\n|[6d0da24](http://git.sagemath.org/sage.git/commit/?id=6d0da248d4151d354a47e0a407aa3530dd008e77)|`One last zero_element removed + correct one doctest`|\n|[dbfb518](http://git.sagemath.org/sage.git/commit/?id=dbfb5186d55ad1682014ffc92907fa1af9fc488f)|`Remove useless colons`|\n|[331c713](http://git.sagemath.org/sage.git/commit/?id=331c7133714180023a7911c02b6bffd919511a68)|`#19171: New method divides`|\n|[7527104](http://git.sagemath.org/sage.git/commit/?id=7527104d614c1d9fceb4ea992c5ebaaa98d6fdcc)|`#19172: Rewrite valuation for dense polynomials`|\n|[22d9c67](http://git.sagemath.org/sage.git/commit/?id=22d9c6792c3e29c91db2534933f719b6187c23f7)|`#19172: valuation for sparse polynomials`|\n|[c546e17](http://git.sagemath.org/sage.git/commit/?id=c546e17684c29b2e5f108440205833b55e7622d5)|`#17190: Authorize empty dictionary in initialization of polynomial over RR`|",
    "created_at": "2015-09-25T14:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290027",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:4'></a>
~~**[EDIT]** As one can notice, I messed up the history with some completely unrelated commits. I am trying to undo this... The relevant code is the latest commit only! **![/EDIT]**~~ Should be OK now!

The problem was not in conversion, but rather in initialization of univariate polynomials over `RR`, with an empty dictionary.  
Before:

```python
sage: RR['x']({})
Traceback (most recent call last):
...
ValueError: max() arg is an empty sequence
```
After:

```python
sage: RR['x']({})
0
```

As a result, we also have:

```python
sage: RR['x'](RR['x,y'].0)
x
```

## Details

In the initialization of a polynomial over `RR`, if the "data" is given as a dictionary, this dictionary is converted to a list. Before the patch, there was an attempt to compute `max(x.keys())` where `x` is the dictionary. If `x` is empty, this yields an error. To correct the error, I could have add a test. Yet, a function is already specifically defined in the class `Polynomial` to perform this conversion `dict -> list`. The new code just uses this function. 

Note that I corrected some slight formatting issues in the docstring in other (unrelated) parts of the same file `src/sage/rings/polynomials/polynomial_real_mpfr_dense.pyx`.

---
New commits: (**Note:** Irrelevant commits. The only correct commit is in[comment:5](#comment%3A5) below)
|                                                                                                                                          |                     |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[98b7ca1](http://git.sagemath.org/sage.git/commit/?id=98b7ca12cfe9335f9c871eda34ff9dc2ce03d3cf)|`Rebased on 6.9beta1`|
|[6d0da24](http://git.sagemath.org/sage.git/commit/?id=6d0da248d4151d354a47e0a407aa3530dd008e77)|`One last zero_element removed + correct one doctest`|
|[dbfb518](http://git.sagemath.org/sage.git/commit/?id=dbfb5186d55ad1682014ffc92907fa1af9fc488f)|`Remove useless colons`|
|[331c713](http://git.sagemath.org/sage.git/commit/?id=331c7133714180023a7911c02b6bffd919511a68)|`#19171: New method divides`|
|[7527104](http://git.sagemath.org/sage.git/commit/?id=7527104d614c1d9fceb4ea992c5ebaaa98d6fdcc)|`#19172: Rewrite valuation for dense polynomials`|
|[22d9c67](http://git.sagemath.org/sage.git/commit/?id=22d9c6792c3e29c91db2534933f719b6187c23f7)|`#19172: valuation for sparse polynomials`|
|[c546e17](http://git.sagemath.org/sage.git/commit/?id=c546e17684c29b2e5f108440205833b55e7622d5)|`#17190: Authorize empty dictionary in initialization of polynomial over RR`|



---

archive/issue_comments_290028.json:
```json
{
    "body": "Changing commit from \"c546e17684c29b2e5f108440205833b55e7622d5\" to \"fe6f95c764bbc69663ac6a68cc92723426ec40d2\"",
    "created_at": "2015-09-25T14:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c546e17684c29b2e5f108440205833b55e7622d5" to "fe6f95c764bbc69663ac6a68cc92723426ec40d2"



---

archive/issue_comments_290029.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[fe6f95c](http://git.sagemath.org/sage.git/commit/?id=fe6f95c764bbc69663ac6a68cc92723426ec40d2)|`#17190: Authorize empty dictionary in initialization of polynomial over RR`|",
    "created_at": "2015-09-25T14:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[fe6f95c](http://git.sagemath.org/sage.git/commit/?id=fe6f95c764bbc69663ac6a68cc92723426ec40d2)|`#17190: Authorize empty dictionary in initialization of polynomial over RR`|



---

archive/issue_comments_290030.json:
```json
{
    "body": "<a id='comment:6'></a>\nLGTM modulo adding a blank line here:\n\n```diff\n         Check that :trac:`17190` is fixed::\n+\n             sage: RR['x']({})\n             0\n```\nOnce you make this change, you can set a positive review on my behalf. (Also, could you edit you post above to show the result is 0?)",
    "created_at": "2015-09-25T14:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290030",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
LGTM modulo adding a blank line here:

```diff
         Check that :trac:`17190` is fixed::
+
             sage: RR['x']({})
             0
```
Once you make this change, you can set a positive review on my behalf. (Also, could you edit you post above to show the result is 0?)



---

archive/issue_comments_290031.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2015-09-25T14:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290031",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_events_049814.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-09-25T14:26:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17190#event-49814"
}
```



---

archive/issue_comments_290032.json:
```json
{
    "body": "Changing commit from \"fe6f95c764bbc69663ac6a68cc92723426ec40d2\" to \"6315d74ebf51bc82c26d6dafd389f52d895c8d78\"",
    "created_at": "2015-09-25T14:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fe6f95c764bbc69663ac6a68cc92723426ec40d2" to "6315d74ebf51bc82c26d6dafd389f52d895c8d78"



---

archive/issue_comments_290033.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[6315d74](http://git.sagemath.org/sage.git/commit/?id=6315d74ebf51bc82c26d6dafd389f52d895c8d78)|`#17190: Add missing blank line`|",
    "created_at": "2015-09-25T14:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290033",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[6315d74](http://git.sagemath.org/sage.git/commit/?id=6315d74ebf51bc82c26d6dafd389f52d895c8d78)|`#17190: Add missing blank line`|



---

archive/issue_comments_290034.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-25T14:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290034",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_290035.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [tscrim](#comment%3A6):\n> LGTM modulo adding a blank line here:\n> \n> ```diff\n>          Check that :trac:`17190` is fixed::\n> +\n>              sage: RR['x']({})\n>              0\n> ```\n> Once you make this change, you can set a positive review on my behalf. (Also, could you edit you post above to show the result is 0?)\n\n\nThanks for the quick review! (I edited my post to make it correct...)",
    "created_at": "2015-09-25T14:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290035",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:8'></a>
Replying to [tscrim](#comment%3A6):
> LGTM modulo adding a blank line here:
> 
> ```diff
>          Check that :trac:`17190` is fixed::
> +
>              sage: RR['x']({})
>              0
> ```
> Once you make this change, you can set a positive review on my behalf. (Also, could you edit you post above to show the result is 0?)


Thanks for the quick review! (I edited my post to make it correct...)



---

archive/issue_comments_290036.json:
```json
{
    "body": "Changing branch from \"u/bruno/t17190_error_conversion\" to \"6315d74ebf51bc82c26d6dafd389f52d895c8d78\"",
    "created_at": "2015-10-12T07:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290036",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/bruno/t17190_error_conversion" to "6315d74ebf51bc82c26d6dafd389f52d895c8d78"



---

archive/issue_events_049815.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-12T07:16:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17190#event-49815"
}
```



---

archive/issue_comments_290037.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-12T07:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17190",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17190#issuecomment-290037",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
