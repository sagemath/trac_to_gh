# Issue 17573: Wrap Gap Structure Description

archive/issues_017336.json:
```json
{
    "assignees": [],
    "body": "See [this math.sx question](http://math.stackexchange.com/questions/1084341).\n\n     G.gap().StructureDescription()\n\nComponent: **group theory**\n\nAuthor: **Sergey Bykov**\n\nBranch/Commit: **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**\n\nReviewer: **Nathann Cohen**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/17573_\n\n",
    "closed_at": "2015-01-29T13:25:54Z",
    "created_at": "2014-12-31T04:38:48Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Wrap Gap Structure Description",
    "type": "issue",
    "updated_at": "2015-01-29T13:25:54Z",
    "url": "https://github.com/sagemath/sage/issues/17573",
    "user": "https://github.com/kcrisman"
}
```
See [this math.sx question](http://math.stackexchange.com/questions/1084341).

     G.gap().StructureDescription()

Component: **group theory**

Author: **Sergey Bykov**

Branch/Commit: **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**

Reviewer: **Nathann Cohen**

_Issue created by migration from https://trac.sagemath.org/ticket/17573_





---

archive/issue_events_248154.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-31T04:38:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248154"
}
```



---

archive/issue_events_248155.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-31T04:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "c: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248155"
}
```



---

archive/issue_events_248156.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-31T04:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248156"
}
```



---

archive/issue_events_248157.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-31T04:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248157"
}
```



---

archive/issue_comments_235889.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSomething like that ?\n\n```\nsage: graphs.PetersenGraph().automorphism_group().structure_description()\n'S5'\n```\n\nIt is in `sage.groups.perm_gps.permgroup.PermutationGroup` (relevant ticket#15128)\n\nNathann",
    "created_at": "2014-12-31T07:26:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235889",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1" align="right">comment:1</div>

Something like that ?

```
sage: graphs.PetersenGraph().automorphism_group().structure_description()
'S5'
```

It is in `sage.groups.perm_gps.permgroup.PermutationGroup` (relevant ticket#15128)

Nathann



---

archive/issue_comments_235890.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nTo make it work on the example given on math.sx, you have to first build the associated permutation group.\n\n```\nsage: F.<x, y> = FreeGroup()\nsage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\nsage: G.as_permutation_group().structure_description()\n'C7'\n```\n\nIt should probably be exposed in `F` directly. As an alias to `.as_permutation_group().structure_description()` if we have to, but it seems that gap does not actually need to build the permutation group in order to compute that.\n\nNathann",
    "created_at": "2014-12-31T07:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235890",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:2" align="right">comment:2</div>

To make it work on the example given on math.sx, you have to first build the associated permutation group.

```
sage: F.<x, y> = FreeGroup()
sage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
sage: G.as_permutation_group().structure_description()
'C7'
```

It should probably be exposed in `F` directly. As an alias to `.as_permutation_group().structure_description()` if we have to, but it seems that gap does not actually need to build the permutation group in order to compute that.

Nathann



---

archive/issue_comments_235891.json:
```json
{
    "body": "Branch: **[u/captaintrunky/wrap_gap_structure_description](https://github.com/sagemath/sagetrac-mirror/tree/u/captaintrunky/wrap_gap_structure_description)**",
    "created_at": "2015-01-22T20:49:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235891",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

Branch: **[u/captaintrunky/wrap_gap_structure_description](https://github.com/sagemath/sagetrac-mirror/tree/u/captaintrunky/wrap_gap_structure_description)**



---

archive/issue_events_248158.json:
```json
{
    "actor": "https://github.com/sagetrac-captaintrunky",
    "created_at": "2015-01-22T20:49:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248158"
}
```



---

archive/issue_comments_235892.json:
```json
{
    "body": "Author: **Sergey Bykov**",
    "created_at": "2015-01-22T20:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235892",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

Author: **Sergey Bykov**



---

archive/issue_comments_235893.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114\"><code>b88e7a5</code></a></td><td><code>Added shortcut for structure_description() procedure</code></td></tr></table>\n",
    "created_at": "2015-01-22T20:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235893",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

<div id="comment:4"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114"><code>b88e7a5</code></a></td><td><code>Added shortcut for structure_description() procedure</code></td></tr></table>




---

archive/issue_comments_235894.json:
```json
{
    "body": "Commit: **[`b88e7a5`](https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114)**",
    "created_at": "2015-01-22T20:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235894",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

Commit: **[`b88e7a5`](https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114)**



---

archive/issue_comments_235895.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHello,\n\nThe method does not look reasonable: if you ask the structure description of the free group, it will not answer. I am pretty sure that there are things to analyze structure of finitely generated groups in GAP. Moreover why 4096000 for finite groups? it is quite huge!\n\nVincent",
    "created_at": "2015-01-22T22:38:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235895",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Hello,

The method does not look reasonable: if you ask the structure description of the free group, it will not answer. I am pretty sure that there are things to analyze structure of finitely generated groups in GAP. Moreover why 4096000 for finite groups? it is quite huge!

Vincent



---

archive/issue_comments_235896.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHello again,\n\nIt seems that it is not necessary to turn the group into a permutation group in order to get this information from gap\n\n```\nsage: F.<x, y> = FreeGroup()\nsage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\nsage: G._gap_().StructureDescription()\n\"C7\"\n```\n\nThus there should be no problem with a limit argument or anything.\n\nThere remains some work to do in this ticket, however, for the code of `structure_description` defined in `PermutationGroup` does not only return GAP's answer: there is some string rewriting going on (as well as a latex output available), and it would be better to not copy/paste it here.\n\nNathann",
    "created_at": "2015-01-23T09:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235896",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

Hello again,

It seems that it is not necessary to turn the group into a permutation group in order to get this information from gap

```
sage: F.<x, y> = FreeGroup()
sage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
sage: G._gap_().StructureDescription()
"C7"
```

Thus there should be no problem with a limit argument or anything.

There remains some work to do in this ticket, however, for the code of `structure_description` defined in `PermutationGroup` does not only return GAP's answer: there is some string rewriting going on (as well as a latex output available), and it would be better to not copy/paste it here.

Nathann



---

archive/issue_events_248159.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-01-23T09:35:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248159"
}
```



---

archive/issue_events_248160.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-01-23T09:35:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248160"
}
```



---

archive/issue_comments_235897.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHi, Nathan. Thanks for the feedback.\nI've ended up today with exactly the same solution like yours. I'll add Latex output and proper string formatting in a couple of days.\n\nReplying to [@nathanncohen](#comment%3A6):\n> Hello again,\n> \n> It seems that it is not necessary to turn the group into a permutation group in order to get this information from gap\n> \n> ```\n> sage: F.<x, y> = FreeGroup()\n> sage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\n> sage: G._gap_().StructureDescription()\n> \"C7\"\n> ```\n> \n> Thus there should be no problem with a limit argument or anything.\n> \n> There remains some work to do in this ticket, however, for the code of `structure_description` defined in `PermutationGroup` does not only return GAP's answer: there is some string rewriting going on (as well as a latex output available), and it would be better to not copy/paste it here.\n> \n> Nathann",
    "created_at": "2015-01-23T16:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235897",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

<div id="comment:8" align="right">comment:8</div>

Hi, Nathan. Thanks for the feedback.
I've ended up today with exactly the same solution like yours. I'll add Latex output and proper string formatting in a couple of days.

Replying to [@nathanncohen](#comment%3A6):
> Hello again,
> 
> It seems that it is not necessary to turn the group into a permutation group in order to get this information from gap
> 
> ```
> sage: F.<x, y> = FreeGroup()
> sage: G=F / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
> sage: G._gap_().StructureDescription()
> "C7"
> ```
> 
> Thus there should be no problem with a limit argument or anything.
> 
> There remains some work to do in this ticket, however, for the code of `structure_description` defined in `PermutationGroup` does not only return GAP's answer: there is some string rewriting going on (as well as a latex output available), and it would be better to not copy/paste it here.
> 
> Nathann



---

archive/issue_comments_235898.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYoooooooo !\n\n> I've ended up today with exactly the same solution like yours. I'll add Latex output and proper string formatting in a couple of days.\n\nGreat! Thanks for working on that.\n\nNathann",
    "created_at": "2015-01-23T16:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235898",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:9" align="right">comment:9</div>

Yoooooooo !

> I've ended up today with exactly the same solution like yours. I'll add Latex output and proper string formatting in a couple of days.

Great! Thanks for working on that.

Nathann



---

archive/issue_comments_235899.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83\"><code>3afe347</code></a></td><td><code>Added direct call to the _gap_.StructureDescription and Latex formatting</code></td></tr></table>\n",
    "created_at": "2015-01-25T21:12:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235899",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83"><code>3afe347</code></a></td><td><code>Added direct call to the _gap_.StructureDescription and Latex formatting</code></td></tr></table>




---

archive/issue_comments_235900.json:
```json
{
    "body": "Changed commit from **[`b88e7a5`](https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114)** to **[`3afe347`](https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83)**",
    "created_at": "2015-01-25T21:12:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235900",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b88e7a5`](https://github.com/sagemath/sagetrac-mirror/commit/b88e7a5c17a8e564852bef7d1a80580c04d0f114)** to **[`3afe347`](https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83)**



---

archive/issue_events_248161.json:
```json
{
    "actor": "https://github.com/sagetrac-captaintrunky",
    "created_at": "2015-01-25T21:37:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248161"
}
```



---

archive/issue_events_248162.json:
```json
{
    "actor": "https://github.com/sagetrac-captaintrunky",
    "created_at": "2015-01-25T21:37:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248162"
}
```



---

archive/issue_comments_235901.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHello again,\n\nI thought for a while about how we could avoid some copy/pate meant to handle the GAP output, then ended up using a trick. I wrote a couple of commits which do the following:\n\n1) Move `structure_description` from `permgroup.py` to `generic.py` without doing any modification to it\n\n2) Update it a bit (change 'self' into 'G', add a couple of examples) then bind this function to the `permutation_group` and `finitely_presented_group` classes. And also to `Matrix_group` while I was at it.\n\nI had to find a workaround for this `.sage()/.str()` problem you must have met yourself while you were working on this patch. This code works but there is definitely something fishy there.\n\nTell me what you think,\n\nNathann\n\nP.S.: Those two commits can be found at: `public/17573`",
    "created_at": "2015-01-26T10:58:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235901",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:12" align="right">comment:12</div>

Hello again,

I thought for a while about how we could avoid some copy/pate meant to handle the GAP output, then ended up using a trick. I wrote a couple of commits which do the following:

1) Move `structure_description` from `permgroup.py` to `generic.py` without doing any modification to it

2) Update it a bit (change 'self' into 'G', add a couple of examples) then bind this function to the `permutation_group` and `finitely_presented_group` classes. And also to `Matrix_group` while I was at it.

I had to find a workaround for this `.sage()/.str()` problem you must have met yourself while you were working on this patch. This code works but there is definitely something fishy there.

Tell me what you think,

Nathann

P.S.: Those two commits can be found at: `public/17573`



---

archive/issue_comments_235902.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi, Nathann!\n`StructureDescription` routine seems to be very general, so I agree that it should be moved from a special object like `permutation_group` somewhere else. I found your solution in these 2 commits reasonable for the whole problem.\nYes, I have already struggled with `sage()/str()`. Maybe we should open a ticket for this? I was very surprised that such basic stuff works in different (and not obvious) ways under the same cover due to several APIs to GAP.\nIn conclusion, I think that this ticket may be closed -- the goal is achieved.\n\nReplying to [@nathanncohen](#comment%3A12):\n> Hello again,\n> \n> I thought for a while about how we could avoid some copy/pate meant to handle the GAP output, then ended up using a trick. I wrote a couple of commits which do the following:\n> \n> 1) Move `structure_description` from `permgroup.py` to `generic.py` without doing any modification to it\n> \n> 2) Update it a bit (change 'self' into 'G', add a couple of examples) then bind this function to the `permutation_group` and `finitely_presented_group` classes. And also to `Matrix_group` while I was at it.\n> \n> I had to find a workaround for this `.sage()/.str()` problem you must have met yourself while you were working on this patch. This code works but there is definitely something fishy there.\n> \n> Tell me what you think,\n> \n> Nathann\n> \n> P.S.: Those two commits can be found at: `public/17573`",
    "created_at": "2015-01-26T16:38:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235902",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi, Nathann!
`StructureDescription` routine seems to be very general, so I agree that it should be moved from a special object like `permutation_group` somewhere else. I found your solution in these 2 commits reasonable for the whole problem.
Yes, I have already struggled with `sage()/str()`. Maybe we should open a ticket for this? I was very surprised that such basic stuff works in different (and not obvious) ways under the same cover due to several APIs to GAP.
In conclusion, I think that this ticket may be closed -- the goal is achieved.

Replying to [@nathanncohen](#comment%3A12):
> Hello again,
> 
> I thought for a while about how we could avoid some copy/pate meant to handle the GAP output, then ended up using a trick. I wrote a couple of commits which do the following:
> 
> 1) Move `structure_description` from `permgroup.py` to `generic.py` without doing any modification to it
> 
> 2) Update it a bit (change 'self' into 'G', add a couple of examples) then bind this function to the `permutation_group` and `finitely_presented_group` classes. And also to `Matrix_group` while I was at it.
> 
> I had to find a workaround for this `.sage()/.str()` problem you must have met yourself while you were working on this patch. This code works but there is definitely something fishy there.
> 
> Tell me what you think,
> 
> Nathann
> 
> P.S.: Those two commits can be found at: `public/17573`



---

archive/issue_comments_235903.json:
```json
{
    "body": "Changed branch from **[u/captaintrunky/wrap_gap_structure_description](https://github.com/sagemath/sagetrac-mirror/tree/u/captaintrunky/wrap_gap_structure_description)** to **[public/17573](https://github.com/sagemath/sagetrac-mirror/tree/public/17573)**",
    "created_at": "2015-01-26T16:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235903",
    "user": "https://github.com/nathanncohen"
}
```

Changed branch from **[u/captaintrunky/wrap_gap_structure_description](https://github.com/sagemath/sagetrac-mirror/tree/u/captaintrunky/wrap_gap_structure_description)** to **[public/17573](https://github.com/sagemath/sagetrac-mirror/tree/public/17573)**



---

archive/issue_comments_235904.json:
```json
{
    "body": "Reviewer: **Nathann Cohen**",
    "created_at": "2015-01-26T16:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235904",
    "user": "https://github.com/nathanncohen"
}
```

Reviewer: **Nathann Cohen**



---

archive/issue_comments_235905.json:
```json
{
    "body": "Changed commit from **[`3afe347`](https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83)** to **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**",
    "created_at": "2015-01-26T16:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235905",
    "user": "https://github.com/nathanncohen"
}
```

Changed commit from **[`3afe347`](https://github.com/sagemath/sagetrac-mirror/commit/3afe347685ec8ccf777c633f9c91bd6f334b1c83)** to **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**



---

archive/issue_comments_235906.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHello!\n\n> `StructureDescription` routine seems to be very general, so I agree that it should be moved from a special object like `permutation_group` somewhere else.\n\nIndeed.\n\n> I found your solution in these 2 commits reasonable for the whole problem.\n\nThanks.\n\n> Yes, I have already struggled with `sage()/str()`. Maybe we should open a ticket for this? I was very surprised that such basic stuff works in different (and not obvious) ways under the same cover due to several APIs to GAP.\n\nTo be honest I would be glad to see it fixed, but I really did not understand where the problem came from. For some reason that I do not get, calling `str(x)` is not equivalent to `x.__str__()` on some objects `O_o`\n\n> In conclusion, I think that this ticket may be closed -- the goal is achieved.\n\nWell, then you can switch the ticket's status to `positive_review` and it will make it in the next release `:-)`\n\nNathann\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2d8adeb3100c6e5b28c65c7ef615150557674de\"><code>a2d8ade</code></a></td><td><code>trac #17573: Move structure_description from permgroup.py to generic.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee\"><code>294041b</code></a></td><td><code>trac #17573: update structure_descriptions and bind it to the classes</code></td></tr></table>\n",
    "created_at": "2015-01-26T16:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235906",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:14" align="right">comment:14</div>

Hello!

> `StructureDescription` routine seems to be very general, so I agree that it should be moved from a special object like `permutation_group` somewhere else.

Indeed.

> I found your solution in these 2 commits reasonable for the whole problem.

Thanks.

> Yes, I have already struggled with `sage()/str()`. Maybe we should open a ticket for this? I was very surprised that such basic stuff works in different (and not obvious) ways under the same cover due to several APIs to GAP.

To be honest I would be glad to see it fixed, but I really did not understand where the problem came from. For some reason that I do not get, calling `str(x)` is not equivalent to `x.__str__()` on some objects `O_o`

> In conclusion, I think that this ticket may be closed -- the goal is achieved.

Well, then you can switch the ticket's status to `positive_review` and it will make it in the next release `:-)`

Nathann

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2d8adeb3100c6e5b28c65c7ef615150557674de"><code>a2d8ade</code></a></td><td><code>trac #17573: Move structure_description from permgroup.py to generic.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee"><code>294041b</code></a></td><td><code>trac #17573: update structure_descriptions and bind it to the classes</code></td></tr></table>




---

archive/issue_events_248163.json:
```json
{
    "actor": "https://github.com/sagetrac-captaintrunky",
    "created_at": "2015-01-26T17:09:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248163"
}
```



---

archive/issue_events_248164.json:
```json
{
    "actor": "https://github.com/sagetrac-captaintrunky",
    "created_at": "2015-01-26T17:09:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248164"
}
```



---

archive/issue_comments_235907.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI'll try to investigate the troubles with `str()/sage()`.",
    "created_at": "2015-01-26T17:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235907",
    "user": "https://github.com/sagetrac-captaintrunky"
}
```

<div id="comment:15" align="right">comment:15</div>

I'll try to investigate the troubles with `str()/sage()`.



---

archive/issue_comments_235908.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nArgh, monkey patching classes to inherit your methods? Really? Am I the only one who finds this hideously ugly?\n\nThe plan is to \n1. get rid of `Group_old`, ie. switch permutation group to libgap\n2. get rid of all users of the old gap pexpect interface",
    "created_at": "2015-01-27T15:41:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235908",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Argh, monkey patching classes to inherit your methods? Really? Am I the only one who finds this hideously ugly?

The plan is to 
1. get rid of `Group_old`, ie. switch permutation group to libgap
2. get rid of all users of the old gap pexpect interface



---

archive/issue_comments_235909.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n> Argh, monkey patching classes to inherit your methods? Really? Am I the only one who finds this hideously ugly?\n\nWhere do you think that this method should be implemented in order to be only inherited by classes on which it will actually work?\n\nNathann",
    "created_at": "2015-01-27T15:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235909",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:17" align="right">comment:17</div>

> Argh, monkey patching classes to inherit your methods? Really? Am I the only one who finds this hideously ugly?

Where do you think that this method should be implemented in order to be only inherited by classes on which it will actually work?

Nathann



---

archive/issue_events_248165.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-27T15:46:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248165"
}
```



---

archive/issue_events_248166.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-27T15:46:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248166"
}
```



---

archive/issue_comments_235910.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAt the very least don't impose your idea of the degree of the dihedral group on others. Especially if your docs say that you use GAP's definititon.",
    "created_at": "2015-01-27T15:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235910",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">comment:18</div>

At the very least don't impose your idea of the degree of the dihedral group on others. Especially if your docs say that you use GAP's definititon.



---

archive/issue_comments_235911.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nathanncohen](#comment%3A17):\n> Where do you think that this method should be implemented in order to be only inherited by classes on which it will actually work?\n\nThe standard lore is to give a generic implementation as high up as possible (e.g. in `Group`) and then override it with specialized implementations where appropriate.",
    "created_at": "2015-01-27T15:48:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235911",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nathanncohen](#comment%3A17):
> Where do you think that this method should be implemented in order to be only inherited by classes on which it will actually work?

The standard lore is to give a generic implementation as high up as possible (e.g. in `Group`) and then override it with specialized implementations where appropriate.



---

archive/issue_comments_235912.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n> At the very least don't impose your idea of the degree of the dihedral group on others. Especially if your docs say that you use GAP's definititon.\n\nNone of the code that this branch contains does that. As you will find from the commits, it merely moves a function from one place to another, and the function's body has not been changed.\n\n> The standard lore is to give a generic implementation as high up as possible (e.g. in Group) and then override it with specialized implementations where appropriate.\n\nIf you do that, the function will be broken on many groups. It will not give wrong or slow results, but will just break. This is why I only added it to the classes that I found able to handle it.\n\nI set this patch back to its original status.\n\nNathann",
    "created_at": "2015-01-27T15:53:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235912",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:20" align="right">comment:20</div>

> At the very least don't impose your idea of the degree of the dihedral group on others. Especially if your docs say that you use GAP's definititon.

None of the code that this branch contains does that. As you will find from the commits, it merely moves a function from one place to another, and the function's body has not been changed.

> The standard lore is to give a generic implementation as high up as possible (e.g. in Group) and then override it with specialized implementations where appropriate.

If you do that, the function will be broken on many groups. It will not give wrong or slow results, but will just break. This is why I only added it to the classes that I found able to handle it.

I set this patch back to its original status.

Nathann



---

archive/issue_events_248167.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-01-27T15:53:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248167"
}
```



---

archive/issue_events_248168.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-01-27T15:53:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248168"
}
```



---

archive/issue_comments_235913.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nFine, take a dump in our codebase.",
    "created_at": "2015-01-27T15:57:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235913",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">comment:22</div>

Fine, take a dump in our codebase.



---

archive/issue_comments_235914.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n> Fine, take a dump in our codebase. \n\nI'll be glad to improve this implementation if you eventually want to contribute some more constructive criticism.\n\nNathann",
    "created_at": "2015-01-27T16:02:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235914",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:23" align="right">comment:23</div>

> Fine, take a dump in our codebase. 

I'll be glad to improve this implementation if you eventually want to contribute some more constructive criticism.

Nathann



---

archive/issue_comments_235915.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nCould raising a `NotImplementedError` at the highest level solve this standoff?  I believe that is the usual way to deal with this.",
    "created_at": "2015-01-27T16:06:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235915",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:24" align="right">comment:24</div>

Could raising a `NotImplementedError` at the highest level solve this standoff?  I believe that is the usual way to deal with this.



---

archive/issue_comments_235916.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n> Could raising a `NotImplementedError` at the highest level solve this standoff?  I believe that is the usual way to deal with this.\n\nThis would make the function available on all groups, but then how should we make the 'real code' available in the groups that actually support it (if not by the trick used here)?\n\nNathann",
    "created_at": "2015-01-27T16:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235916",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:25" align="right">comment:25</div>

> Could raising a `NotImplementedError` at the highest level solve this standoff?  I believe that is the usual way to deal with this.

This would make the function available on all groups, but then how should we make the 'real code' available in the groups that actually support it (if not by the trick used here)?

Nathann



---

archive/issue_comments_235917.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReally the SX question boils down to : why is `structure_description` not consistently available for every group, after all it makes sense for every group. Just monkey-patching it to yet another group  addresses one particular symptom, but does nothing against the disease. I agree with Karl-Dieter, just raise `NotImplementedError` where appropriate (e.g. there is no `gap` method).",
    "created_at": "2015-01-27T16:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235917",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

Really the SX question boils down to : why is `structure_description` not consistently available for every group, after all it makes sense for every group. Just monkey-patching it to yet another group  addresses one particular symptom, but does nothing against the disease. I agree with Karl-Dieter, just raise `NotImplementedError` where appropriate (e.g. there is no `gap` method).



---

archive/issue_comments_235918.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI haven't looked at the details, just trying a suggestion; perhaps in this case it isn't appropriate.  There is no subclass of groups that it is available on?\n\nOr is the problem that the code for wrapping this only should be written *once*, but the various subclasses it works on aren't inherited from each other, so that then one has to rewrite this code for each such class?\n\nTo Volker's point, I believe that not every group actually has this description available in gap itself, or so I read the comments and tests to imply.  It isn't sufficient to have a gap method, it looks like.",
    "created_at": "2015-01-27T16:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235918",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:27" align="right">comment:27</div>

I haven't looked at the details, just trying a suggestion; perhaps in this case it isn't appropriate.  There is no subclass of groups that it is available on?

Or is the problem that the code for wrapping this only should be written *once*, but the various subclasses it works on aren't inherited from each other, so that then one has to rewrite this code for each such class?

To Volker's point, I believe that not every group actually has this description available in gap itself, or so I read the comments and tests to imply.  It isn't sufficient to have a gap method, it looks like.



---

archive/issue_comments_235919.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nYo!\n\n> Really the SX question boils down to : why is `structure_description` not consistently available for every group, after all it makes sense for every group.\n\nTrue. There are oddities in the code, however, like this `MatrixGroup_gap` class whose description reads:\n\n`Matrix group over a ring that GAP understands`\n\nI took it as a hint that there will never be a working `.gap()` function on all groups.\n\n> Just monkey-patching it to yet another group  addresses one particular symptom, but does nothing against the disease.\n\nIndeed. It only makes the method available on some classes where it was not.\n\n> I agree with Karl-Dieter, just raise `NotImplementedError` where appropriate (e.g. there is no `gap` method).\n\nThus this patch should only move that function from one place to another. In which class do you think it should go?\n\nNathann",
    "created_at": "2015-01-27T16:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235919",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:28" align="right">comment:28</div>

Yo!

> Really the SX question boils down to : why is `structure_description` not consistently available for every group, after all it makes sense for every group.

True. There are oddities in the code, however, like this `MatrixGroup_gap` class whose description reads:

`Matrix group over a ring that GAP understands`

I took it as a hint that there will never be a working `.gap()` function on all groups.

> Just monkey-patching it to yet another group  addresses one particular symptom, but does nothing against the disease.

Indeed. It only makes the method available on some classes where it was not.

> I agree with Karl-Dieter, just raise `NotImplementedError` where appropriate (e.g. there is no `gap` method).

Thus this patch should only move that function from one place to another. In which class do you think it should go?

Nathann



---

archive/issue_comments_235920.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@nathanncohen](#comment%3A28):\n> I took it as a hint that there will never be a working `.gap()` function on all groups.\n\nYes. Another possible generic implementation is to call `.as_permutation_group().structure_description()`, if that is available. But in some cases you'll have to raise `NotImplementedError`. It is then up to author of that particular group to override `structure_description`.\n\n> Thus this patch should only move that function from one place to another. In which class do you think it should go?\n\nEvidently it should be in sage.groups.group.Group",
    "created_at": "2015-01-27T16:26:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235920",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@nathanncohen](#comment%3A28):
> I took it as a hint that there will never be a working `.gap()` function on all groups.

Yes. Another possible generic implementation is to call `.as_permutation_group().structure_description()`, if that is available. But in some cases you'll have to raise `NotImplementedError`. It is then up to author of that particular group to override `structure_description`.

> Thus this patch should only move that function from one place to another. In which class do you think it should go?

Evidently it should be in sage.groups.group.Group



---

archive/issue_comments_235921.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\n> Yes. Another possible generic implementation is to call `.as_permutation_group().structure_description()`, if that is available.\n\nOnly applies to finite groups. And will be meaningless for very large finitely presented groups.\n\n> But in some cases you'll have to raise `NotImplementedError`. It is then up to author of that particular group to override `structure_description`.\n\nI personally consider this bad design, and this is why I prefer to monkey-patch functions that work rather than inherit broken ones.\n\n> Evidently it should be in sage.groups.group.Group\n\nWill you review it if I make the change?\n\nNathann",
    "created_at": "2015-01-27T16:33:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235921",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:30" align="right">comment:30</div>

> Yes. Another possible generic implementation is to call `.as_permutation_group().structure_description()`, if that is available.

Only applies to finite groups. And will be meaningless for very large finitely presented groups.

> But in some cases you'll have to raise `NotImplementedError`. It is then up to author of that particular group to override `structure_description`.

I personally consider this bad design, and this is why I prefer to monkey-patch functions that work rather than inherit broken ones.

> Evidently it should be in sage.groups.group.Group

Will you review it if I make the change?

Nathann



---

archive/issue_comments_235922.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@nathanncohen](#comment%3A30):\n> And will be meaningless for very large finitely presented groups.\n\nEverything is impossible to compute once you increase the problem size too far. FP groups are perhaps particularly tricky in that regard since there is no algorithm that necessarily terminates. But you should be allowed to ask the question.\n \n> I personally consider this bad design\n\nthis = consistent interfaces and specialized implementations in subclasses?\n\n> Will you review it if I make the change?\n\nSure",
    "created_at": "2015-01-27T16:42:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235922",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@nathanncohen](#comment%3A30):
> And will be meaningless for very large finitely presented groups.

Everything is impossible to compute once you increase the problem size too far. FP groups are perhaps particularly tricky in that regard since there is no algorithm that necessarily terminates. But you should be allowed to ask the question.
 
> I personally consider this bad design

this = consistent interfaces and specialized implementations in subclasses?

> Will you review it if I make the change?

Sure



---

archive/issue_comments_235923.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\n> Everything is impossible to compute once you increase the problem size too far.\n\nYou are oversimplifying. Some finitely presented groups can be described very easily in either Sage or Gap, and this function can be called quickly too. Turning them into a permutation group is a very bad move.\n\n> > I personally consider this bad design\n\n> \n> this = consistent interfaces and specialized implementations in subclasses?\n\nCalling non implemented or broken functions, and saying that \"it is somebody else's problem\"\n\n```\nIt is then up to author of that particular group to override structure_description.\n```\n\nNathann",
    "created_at": "2015-01-27T16:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235923",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:32" align="right">comment:32</div>

> Everything is impossible to compute once you increase the problem size too far.

You are oversimplifying. Some finitely presented groups can be described very easily in either Sage or Gap, and this function can be called quickly too. Turning them into a permutation group is a very bad move.

> > I personally consider this bad design

> 
> this = consistent interfaces and specialized implementations in subclasses?

Calling non implemented or broken functions, and saying that "it is somebody else's problem"

```
It is then up to author of that particular group to override structure_description.
```

Nathann



---

archive/issue_comments_235924.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\n> Evidently it should be in sage.groups.group.Group\n\nThis change does not work: a `CyclicPermutationGroup` does not inherit from `Group`. If you wonder how that happens, just look at that and roll your eyes, just like me:\n\n```\ndef is_Group(x):\n    from sage.groups.old import Group as OldGroup\n    return isinstance(x, (Group, OldGroup))\n```\n\nNathann",
    "created_at": "2015-01-27T16:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235924",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:33" align="right">comment:33</div>

> Evidently it should be in sage.groups.group.Group

This change does not work: a `CyclicPermutationGroup` does not inherit from `Group`. If you wonder how that happens, just look at that and roll your eyes, just like me:

```
def is_Group(x):
    from sage.groups.old import Group as OldGroup
    return isinstance(x, (Group, OldGroup))
```

Nathann



---

archive/issue_comments_235925.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI know. This is why I said that permutation groups need to be switched away from OldGroup.",
    "created_at": "2015-01-27T16:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235925",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:34" align="right">comment:34</div>

I know. This is why I said that permutation groups need to be switched away from OldGroup.



---

archive/issue_comments_235926.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\n> I know. This is why I said that permutation groups need to be switched away from OldGroup. \n\nI see. What do you propose that we do with this ticket, then? I want this feature to make it into Sage, but I cannot rewrite code that I do not understand.\n\nNathann",
    "created_at": "2015-01-27T17:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235926",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:35" align="right">comment:35</div>

> I know. This is why I said that permutation groups need to be switched away from OldGroup. 

I see. What do you propose that we do with this ticket, then? I want this feature to make it into Sage, but I cannot rewrite code that I do not understand.

Nathann



---

archive/issue_comments_235927.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nI would just add a method to OldGroup that calls Group.structure_description (or whatever is appropriate) with a note that it should be removed later.",
    "created_at": "2015-01-27T17:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235927",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:36" align="right">comment:36</div>

I would just add a method to OldGroup that calls Group.structure_description (or whatever is appropriate) with a note that it should be removed later.



---

archive/issue_comments_235928.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n> I would just add a method to OldGroup that calls Group.structure_description (or whatever is appropriate) with a note that it should be removed later.\n\nI am sorry to block this here, but I do not agree with this way of doing things. I can rebase this patch on another ticket if this `OldGroup/Group` problem is solved soon, but otherwise I prefer this code as it is, as it does not introduce broken methods.\n\nNathann",
    "created_at": "2015-01-27T17:32:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235928",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:37" align="right">comment:37</div>

> I would just add a method to OldGroup that calls Group.structure_description (or whatever is appropriate) with a note that it should be removed later.

I am sorry to block this here, but I do not agree with this way of doing things. I can rebase this patch on another ticket if this `OldGroup/Group` problem is solved soon, but otherwise I prefer this code as it is, as it does not introduce broken methods.

Nathann



---

archive/issue_comments_235929.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nSo we'll have a consistent interface as soon as we have monkey-patched every group in Sage, excellent.",
    "created_at": "2015-01-27T20:47:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235929",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">comment:38</div>

So we'll have a consistent interface as soon as we have monkey-patched every group in Sage, excellent.



---

archive/issue_comments_235930.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n> So we'll have a consistent interface as soon as we have monkey-patched every group in Sage, excellent.\n\nStop being difficult and let us do something useful: I am telling you that I am willing to help you or whoever will try to rewrite this code. The only thing I cannot do is rewrite it all by myself if you start taking this ticket as a hostage.\n\nMy problem is that I do not know nor understand how the group code works. I only want to add a feature, and this is the only way I found to do it without introducing broken functions (I do not want users to call a function and end up with an exception -- to them that is nothing but a bug).\n\nIf you are willing to solve the root of the problem, let us do so in another ticket. I will be glad to help.\n\nNathann",
    "created_at": "2015-01-27T21:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235930",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:39" align="right">comment:39</div>

> So we'll have a consistent interface as soon as we have monkey-patched every group in Sage, excellent.

Stop being difficult and let us do something useful: I am telling you that I am willing to help you or whoever will try to rewrite this code. The only thing I cannot do is rewrite it all by myself if you start taking this ticket as a hostage.

My problem is that I do not know nor understand how the group code works. I only want to add a feature, and this is the only way I found to do it without introducing broken functions (I do not want users to call a function and end up with an exception -- to them that is nothing but a bug).

If you are willing to solve the root of the problem, let us do so in another ticket. I will be glad to help.

Nathann



---

archive/issue_comments_235931.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nIn general I agree with ncohen here.  Though:\n\n> this is the only way I found to do it without introducing broken functions (I do not want users to call a function and end up with an exception -- to them that is nothing but a bug).\n\nWell, `NotImplementedError` is a special case, though.  Maybe you can make the error message really really obvious that it is GAP which doesn't have this available, not that Sage has some error?  Then it takes the sting away - *nobody* can calculate it, it's not a Sage bug at all, just the user wishing something got calculated that isn't, like an elementary integral to sin(x)/x.",
    "created_at": "2015-01-27T21:53:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235931",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:40" align="right">comment:40</div>

In general I agree with ncohen here.  Though:

> this is the only way I found to do it without introducing broken functions (I do not want users to call a function and end up with an exception -- to them that is nothing but a bug).

Well, `NotImplementedError` is a special case, though.  Maybe you can make the error message really really obvious that it is GAP which doesn't have this available, not that Sage has some error?  Then it takes the sting away - *nobody* can calculate it, it's not a Sage bug at all, just the user wishing something got calculated that isn't, like an elementary integral to sin(x)/x.



---

archive/issue_events_248169.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-29T13:25:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248169"
}
```



---

archive/issue_events_248170.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e2ac7e6ffd730bb47a0e4bcf174e1b602c688521",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-01-29T13:25:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17573#event-248170"
}
```



---

archive/issue_comments_235932.json:
```json
{
    "body": "Changed branch from **[public/17573](https://github.com/sagemath/sagetrac-mirror/tree/public/17573)** to **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**",
    "created_at": "2015-01-29T13:25:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17573#issuecomment-235932",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/17573](https://github.com/sagemath/sagetrac-mirror/tree/public/17573)** to **[`294041b`](https://github.com/sagemath/sagetrac-mirror/commit/294041b72adf4b10f44f913d7439c33c96524eee)**
