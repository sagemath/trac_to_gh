# Issue 17242: Uniform random generation  of Composition of a given size

archive/issues_017005.json:
```json
{
    "body": "I am overwritting the default random_element method of the Composition_n class to implement an efficient way to compute a random composition.\n\nAs explained in the documentation, I use the fact that composition of size n are in bijection with binary words of size n starting with a 1.\n\nAssignee: gchatel\n\nCC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton\n\nKeywords: composition,  combinatorics, random\n\nBranch/Commit: 39391763e5a5734c8b46c20b0f46369575003551\n\nReviewer: Darij Grinberg\n\nAuthor: Gr\u00e9gory Ch\u00e2tel\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17242\n\n",
    "closed_at": "2014-10-30T09:45:10Z",
    "created_at": "2014-10-28T14:12:50Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Uniform random generation  of Composition of a given size",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17242",
    "user": "https://github.com/rodgzilla"
}
```
I am overwritting the default random_element method of the Composition_n class to implement an efficient way to compute a random composition.

As explained in the documentation, I use the fact that composition of size n are in bijection with binary words of size n starting with a 1.

Assignee: gchatel

CC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton

Keywords: composition,  combinatorics, random

Branch/Commit: 39391763e5a5734c8b46c20b0f46369575003551

Reviewer: Darij Grinberg

Author: Grégory Châtel

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17242





---

archive/issue_comments_291382.json:
```json
{
    "body": "Changing branch from \"\" to \"public/combinat/composition-random-17242\"",
    "created_at": "2014-10-28T14:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291382",
    "user": "https://github.com/rodgzilla"
}
```

Changing branch from "" to "public/combinat/composition-random-17242"



---

archive/issue_comments_291383.json:
```json
{
    "body": "Changing commit from \"\" to \"c2ddd33adbf47f86a6a3db60f6f84bec64989c5a\"",
    "created_at": "2014-10-28T14:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291383",
    "user": "https://github.com/rodgzilla"
}
```

Changing commit from "" to "c2ddd33adbf47f86a6a3db60f6f84bec64989c5a"



---

archive/issue_comments_291384.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[c2ddd33](http://git.sagemath.org/sage.git/commit/?id=c2ddd33adbf47f86a6a3db60f6f84bec64989c5a)|`First commit overwritting the method random_element of Compositions_n.`|",
    "created_at": "2014-10-28T14:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291384",
    "user": "https://github.com/rodgzilla"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[c2ddd33](http://git.sagemath.org/sage.git/commit/?id=c2ddd33adbf47f86a6a3db60f6f84bec64989c5a)|`First commit overwritting the method random_element of Compositions_n.`|



---

archive/issue_comments_291385.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[2470bbf](http://git.sagemath.org/sage.git/commit/?id=2470bbf9bbfcab09c8645d9ec36c64467bc75b42)|`Fixing a format problem with the documentation.`|",
    "created_at": "2014-10-28T14:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291385",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[2470bbf](http://git.sagemath.org/sage.git/commit/?id=2470bbf9bbfcab09c8645d9ec36c64467bc75b42)|`Fixing a format problem with the documentation.`|



---

archive/issue_comments_291386.json:
```json
{
    "body": "Changing commit from \"c2ddd33adbf47f86a6a3db60f6f84bec64989c5a\" to \"2470bbf9bbfcab09c8645d9ec36c64467bc75b42\"",
    "created_at": "2014-10-28T14:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291386",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c2ddd33adbf47f86a6a3db60f6f84bec64989c5a" to "2470bbf9bbfcab09c8645d9ec36c64467bc75b42"



---

archive/issue_comments_291387.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-28T14:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291387",
    "user": "https://github.com/rodgzilla"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_291388.json:
```json
{
    "body": "<a id='comment:4'></a>\nYou have deleted one line in some other place in the file. (to see where, click on the green link in the branch field on top of this page). Please put it back.\n\nAlso, please gather the imports at the begininng of the code. Otherwise, seems ok.",
    "created_at": "2014-10-28T14:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291388",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
You have deleted one line in some other place in the file. (to see where, click on the green link in the branch field on top of this page). Please put it back.

Also, please gather the imports at the begininng of the code. Otherwise, seems ok.



---

archive/issue_comments_291389.json:
```json
{
    "body": "<a id='comment:5'></a>\nI have not done any benchmarks, but I bet that\n`[sage.misc.prandom.choice([0,1]) for _ in range(self.n - 1)]` is faster than `FiniteWords_length_k_over_OrderedAlphabet(A, length = self.n - 1).random_element()` (and, besides, works for n = 0 as well).",
    "created_at": "2014-10-28T15:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291389",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:5'></a>
I have not done any benchmarks, but I bet that
`[sage.misc.prandom.choice([0,1]) for _ in range(self.n - 1)]` is faster than `FiniteWords_length_k_over_OrderedAlphabet(A, length = self.n - 1).random_element()` (and, besides, works for n = 0 as well).



---

archive/issue_comments_291390.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[6539c20](http://git.sagemath.org/sage.git/commit/?id=6539c20d5eafe641e0fe775eaa2f83cf4ab149d7)|`Putting the deleted line back.`|\n|[d6ca32a](http://git.sagemath.org/sage.git/commit/?id=d6ca32abfa3d922d2d147f54255de05459946847)|`Cleaning up the code.`|",
    "created_at": "2014-10-28T18:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[6539c20](http://git.sagemath.org/sage.git/commit/?id=6539c20d5eafe641e0fe775eaa2f83cf4ab149d7)|`Putting the deleted line back.`|
|[d6ca32a](http://git.sagemath.org/sage.git/commit/?id=d6ca32abfa3d922d2d147f54255de05459946847)|`Cleaning up the code.`|



---

archive/issue_comments_291391.json:
```json
{
    "body": "Changing commit from \"2470bbf9bbfcab09c8645d9ec36c64467bc75b42\" to \"d6ca32abfa3d922d2d147f54255de05459946847\"",
    "created_at": "2014-10-28T18:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2470bbf9bbfcab09c8645d9ec36c64467bc75b42" to "d6ca32abfa3d922d2d147f54255de05459946847"



---

archive/issue_comments_291392.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-28T18:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291392",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_291393.json:
```json
{
    "body": "<a id='comment:8'></a>\nWelldone; it's positive_review then.",
    "created_at": "2014-10-28T18:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291393",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:8'></a>
Welldone; it's positive_review then.



---

archive/issue_comments_291394.json:
```json
{
    "body": "<a id='comment:9'></a>\nReviewer name",
    "created_at": "2014-10-28T20:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291394",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>
Reviewer name



---

archive/issue_comments_291395.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-28T20:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291395",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_291396.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-10-28T20:47:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291396",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_291397.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Darij Grinberg\"",
    "created_at": "2014-10-28T20:47:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291397",
    "user": "https://github.com/darijgr"
}
```

Changing reviewer from "" to "Darij Grinberg"



---

archive/issue_comments_291398.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-29T16:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291398",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_291399.json:
```json
{
    "body": "<a id='comment:11'></a>\nDoctests failure in src/sage/combinat/composition_signed.py",
    "created_at": "2014-10-29T16:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291399",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
Doctests failure in src/sage/combinat/composition_signed.py



---

archive/issue_comments_291400.json:
```json
{
    "body": "Changing commit from \"d6ca32abfa3d922d2d147f54255de05459946847\" to \"39391763e5a5734c8b46c20b0f46369575003551\"",
    "created_at": "2014-10-29T18:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291400",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d6ca32abfa3d922d2d147f54255de05459946847" to "39391763e5a5734c8b46c20b0f46369575003551"



---

archive/issue_comments_291401.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[3939176](http://git.sagemath.org/sage.git/commit/?id=39391763e5a5734c8b46c20b0f46369575003551)|`random doctest is random`|",
    "created_at": "2014-10-29T18:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[3939176](http://git.sagemath.org/sage.git/commit/?id=39391763e5a5734c8b46c20b0f46369575003551)|`random doctest is random`|



---

archive/issue_comments_291402.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-10-29T18:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291402",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_291403.json:
```json
{
    "body": "<a id='comment:13'></a>\nGood point; that file had a random doctest not marked as random. I am wondering if we can have a script that automatically warns of such things?",
    "created_at": "2014-10-29T18:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291403",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:13'></a>
Good point; that file had a random doctest not marked as random. I am wondering if we can have a script that automatically warns of such things?



---

archive/issue_comments_291404.json:
```json
{
    "body": "Changing branch from \"public/combinat/composition-random-17242\" to \"39391763e5a5734c8b46c20b0f46369575003551\"",
    "created_at": "2014-10-30T09:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291404",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/combinat/composition-random-17242" to "39391763e5a5734c8b46c20b0f46369575003551"



---

archive/issue_comments_291405.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-30T09:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17242#issuecomment-291405",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049890.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-30T09:45:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17242",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17242#event-49890"
}
```
