# Issue 17982: Ambient space root poset is broken

archive/issues_017745.json:
```json
{
    "body": "The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.\n\n```\n  sage: RootSystem(['A', 2]).ambient_space().root_poset()\n  Error in lines 2-2\n  KeyError: 3\n```\nI fixed this bug by redefining the dimension to be the number of simple roots.  \"I\" also fixed some formatting conventions.\n\n**CC:**  @nthiery\n\n**Keywords:** root poset, days64\n\n**Branch/Commit:** [4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)\n\n**Reviewer:** Franco Saliola\n\n**Author:** Nathan Williams\n\nIssue created by migration from https://trac.sagemath.org/ticket/17982\n\n",
    "closed_at": "2015-03-21T09:32:04Z",
    "created_at": "2015-03-18T00:01:53Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Ambient space root poset is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17982",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```
The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.

```
  sage: RootSystem(['A', 2]).ambient_space().root_poset()
  Error in lines 2-2
  KeyError: 3
```
I fixed this bug by redefining the dimension to be the number of simple roots.  "I" also fixed some formatting conventions.

**CC:**  @nthiery

**Keywords:** root poset, days64

**Branch/Commit:** [4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)

**Reviewer:** Franco Saliola

**Author:** Nathan Williams

Issue created by migration from https://trac.sagemath.org/ticket/17982





---

archive/issue_comments_248463.json:
```json
{
    "body": "**Commit:** [c1c9fd5f1d9863852075aa79022c0e7e812ad28c](https://github.com/sagemath/sagetrac-mirror/commit/c1c9fd5f1d9863852075aa79022c0e7e812ad28c)",
    "created_at": "2015-03-18T00:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248463",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```

**Commit:** [c1c9fd5f1d9863852075aa79022c0e7e812ad28c](https://github.com/sagemath/sagetrac-mirror/commit/c1c9fd5f1d9863852075aa79022c0e7e812ad28c)



---

archive/issue_comments_248464.json:
```json
{
    "body": "**Branch:** [public/17982](https://github.com/sagemath/sagetrac-mirror/tree/public/17982)",
    "created_at": "2015-03-18T00:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248464",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```

**Branch:** [public/17982](https://github.com/sagemath/sagetrac-mirror/tree/public/17982)



---

archive/issue_events_164596.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams",
    "created_at": "2015-03-18T00:11:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164596"
}
```



---

archive/issue_comments_248465.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,15 @@\n-The ambient space for the root system of type A causes a bug in the method root_poset().\n+The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.\n+\n+  sage: RootSystem(['A', 2]).ambient_space().root_poset()\n+  Error in lines 2-2\n+Traceback (most recent call last):\n+  File \"/projects/35ffe4a3-aac4-4456-85aa-5c0ad4b5e2d1/.sagemathcloud/sage_server.py\", line 875, in execute\n+    exec compile(block+'\\n', '', 'single') in namespace, locals\n+  File \"\", line 1, in <module>\n+  File \"/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/combinat/root_system/root_lattice_realizations.py\", line 1050, in root_poset\n+    root_cover = root + simple_roots[i]\n+  File \"/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/sets/family.py\", line 718, in `__getitem__`\n+    return self._dictionary.__getitem__(i)\n+KeyError: 3\n+\n+I fixed this bug by redefining the dimension to be the number of simple roots.\n``````\n",
    "created_at": "2015-03-18T01:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248465",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,15 @@
-The ambient space for the root system of type A causes a bug in the method root_poset().
+The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.
+
+  sage: RootSystem(['A', 2]).ambient_space().root_poset()
+  Error in lines 2-2
+Traceback (most recent call last):
+  File "/projects/35ffe4a3-aac4-4456-85aa-5c0ad4b5e2d1/.sagemathcloud/sage_server.py", line 875, in execute
+    exec compile(block+'\n', '', 'single') in namespace, locals
+  File "", line 1, in <module>
+  File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/combinat/root_system/root_lattice_realizations.py", line 1050, in root_poset
+    root_cover = root + simple_roots[i]
+  File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/sets/family.py", line 718, in `__getitem__`
+    return self._dictionary.__getitem__(i)
+KeyError: 3
+
+I fixed this bug by redefining the dimension to be the number of simple roots.
``````




---

archive/issue_comments_248466.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,14 +2,6 @@\n \n   sage: RootSystem(['A', 2]).ambient_space().root_poset()\n   Error in lines 2-2\n-Traceback (most recent call last):\n-  File \"/projects/35ffe4a3-aac4-4456-85aa-5c0ad4b5e2d1/.sagemathcloud/sage_server.py\", line 875, in execute\n-    exec compile(block+'\\n', '', 'single') in namespace, locals\n-  File \"\", line 1, in <module>\n-  File \"/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/combinat/root_system/root_lattice_realizations.py\", line 1050, in root_poset\n-    root_cover = root + simple_roots[i]\n-  File \"/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/sets/family.py\", line 718, in `__getitem__`\n-    return self._dictionary.__getitem__(i)\n-KeyError: 3\n+  KeyError: 3\n \n I fixed this bug by redefining the dimension to be the number of simple roots.\n``````\n",
    "created_at": "2015-03-18T01:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248466",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,14 +2,6 @@
 
   sage: RootSystem(['A', 2]).ambient_space().root_poset()
   Error in lines 2-2
-Traceback (most recent call last):
-  File "/projects/35ffe4a3-aac4-4456-85aa-5c0ad4b5e2d1/.sagemathcloud/sage_server.py", line 875, in execute
-    exec compile(block+'\n', '', 'single') in namespace, locals
-  File "", line 1, in <module>
-  File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/combinat/root_system/root_lattice_realizations.py", line 1050, in root_poset
-    root_cover = root + simple_roots[i]
-  File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-packages/sage/sets/family.py", line 718, in `__getitem__`
-    return self._dictionary.__getitem__(i)
-KeyError: 3
+  KeyError: 3
 
 I fixed this bug by redefining the dimension to be the number of simple roots.
``````




---

archive/issue_comments_248467.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n   Error in lines 2-2\n   KeyError: 3\n \n-I fixed this bug by redefining the dimension to be the number of simple roots.\n+I fixed this bug by redefining the dimension to be the number of simple roots.  \"I\" also fixed some formatting conventions.\n``````\n",
    "created_at": "2015-03-18T01:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248467",
    "user": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
   Error in lines 2-2
   KeyError: 3
 
-I fixed this bug by redefining the dimension to be the number of simple roots.
+I fixed this bug by redefining the dimension to be the number of simple roots.  "I" also fixed some formatting conventions.
``````




---

archive/issue_comments_248468.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.\n \n+```\n   sage: RootSystem(['A', 2]).ambient_space().root_poset()\n   Error in lines 2-2\n   KeyError: 3\n-\n+```\n I fixed this bug by redefining the dimension to be the number of simple roots.  \"I\" also fixed some formatting conventions.\n``````\n",
    "created_at": "2015-03-18T01:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248468",
    "user": "https://github.com/saliola"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
 The ambient space for the root system of type A causes a bug in the method root_poset().  In particular, the following code causes an error.
 
+```
   sage: RootSystem(['A', 2]).ambient_space().root_poset()
   Error in lines 2-2
   KeyError: 3
-
+```
 I fixed this bug by redefining the dimension to be the number of simple roots.  "I" also fixed some formatting conventions.
``````




---

archive/issue_comments_248469.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks good to me. All doctests pass.",
    "created_at": "2015-03-18T01:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248469",
    "user": "https://github.com/saliola"
}
```

<a id='comment:7'></a>
Looks good to me. All doctests pass.



---

archive/issue_events_164597.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-18T01:23:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164597"
}
```



---

archive/issue_events_164598.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-18T01:23:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164598"
}
```



---

archive/issue_comments_248470.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a\">75138a2</a></td><td><code>Merge branch 'develop' into t/17982/public/17982</code></td></tr></table>\n",
    "created_at": "2015-03-18T01:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a">75138a2</a></td><td><code>Merge branch 'develop' into t/17982/public/17982</code></td></tr></table>




---

archive/issue_comments_248471.json:
```json
{
    "body": "**Changing commit** from \"[c1c9fd5f1d9863852075aa79022c0e7e812ad28c](https://github.com/sagemath/sagetrac-mirror/commit/c1c9fd5f1d9863852075aa79022c0e7e812ad28c)\" to \"[75138a2aea877172e284dba5ccdbf6b60712c91a](https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a)\".",
    "created_at": "2015-03-18T01:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248471",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c1c9fd5f1d9863852075aa79022c0e7e812ad28c](https://github.com/sagemath/sagetrac-mirror/commit/c1c9fd5f1d9863852075aa79022c0e7e812ad28c)" to "[75138a2aea877172e284dba5ccdbf6b60712c91a](https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a)".



---

archive/issue_events_164599.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2015-03-18T01:28:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164599"
}
```



---

archive/issue_events_164600.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2015-03-18T01:28:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164600"
}
```



---

archive/issue_comments_248472.json:
```json
{
    "body": "**Changing reviewer** from \"Nicolas M. Thi\u00e9ry\" to \"Franco Saliola\".",
    "created_at": "2015-03-18T01:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248472",
    "user": "https://github.com/saliola"
}
```

**Changing reviewer** from "Nicolas M. Thiéry" to "Franco Saliola".



---

archive/issue_events_164601.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-18T01:38:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164601"
}
```



---

archive/issue_events_164602.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-18T01:38:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164602"
}
```



---

archive/issue_events_164603.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2015-03-18T05:31:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164603"
}
```



---

archive/issue_events_164604.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2015-03-18T05:31:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164604"
}
```



---

archive/issue_comments_248473.json:
```json
{
    "body": "<a id='comment:11'></a>\nWe discussed with Nathan, and the change is not yet enough",
    "created_at": "2015-03-18T05:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248473",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:11'></a>
We discussed with Nathan, and the change is not yet enough



---

archive/issue_comments_248474.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5\">4cb9eb1</a></td><td><code>17982: probably fixed according to Nicolas' specifications</code></td></tr></table>\n",
    "created_at": "2015-03-19T23:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248474",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5">4cb9eb1</a></td><td><code>17982: probably fixed according to Nicolas' specifications</code></td></tr></table>




---

archive/issue_comments_248475.json:
```json
{
    "body": "**Changing commit** from \"[75138a2aea877172e284dba5ccdbf6b60712c91a](https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a)\" to \"[4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)\".",
    "created_at": "2015-03-19T23:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[75138a2aea877172e284dba5ccdbf6b60712c91a](https://github.com/sagemath/sagetrac-mirror/commit/75138a2aea877172e284dba5ccdbf6b60712c91a)" to "[4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)".



---

archive/issue_events_164605.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams",
    "created_at": "2015-03-19T23:51:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164605"
}
```



---

archive/issue_events_164606.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nathanwilliams",
    "created_at": "2015-03-19T23:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164606"
}
```



---

archive/issue_events_164607.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-20T00:39:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164607"
}
```



---

archive/issue_events_164608.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2015-03-20T00:39:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164608"
}
```



---

archive/issue_comments_248476.json:
```json
{
    "body": "**Changing branch** from \"[public/17982](https://github.com/sagemath/sagetrac-mirror/tree/public/17982)\" to \"[4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)\".",
    "created_at": "2015-03-21T09:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17982#issuecomment-248476",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/17982](https://github.com/sagemath/sagetrac-mirror/tree/public/17982)" to "[4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5](https://github.com/sagemath/sagetrac-mirror/commit/4cb9eb1ca74ea760991eaa5c0e45be788efe7ee5)".



---

archive/issue_events_164609.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-21T09:32:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164609"
}
```



---

archive/issue_events_164610.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-21T09:32:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17982",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17982#event-164610"
}
```
