# Issue 17739: enhance desolve output from separable ODEs

archive/issues_017502.json:
```json
{
    "assignees": [],
    "body": "At the moment, `desolve` behaves like this even with trivial separable ODEs:\n\n```\nsage: t = var('t')\nsage: y=function('y')(t)\nsage: desolve(diff(y,t)-y^2,y)\n-1/y(t) == _C + t\nsage: desolve(diff(y,t)-y^2+y,y)\nlog(y(t) - 1) - log(y(t)) == _C + t\nsage: desolve(diff(y,t)-y^2-1,y)\narctan(y(t)) == _C + t\n```\nThey could be solved by substituting a variable for `y(t)` and calling `solve`. Only if there is no solution from `solve` the integrated equation should be given.\n\n\nUpstream: **Not yet reported upstream; Will do shortly.**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/17739_\n\n",
    "created_at": "2015-02-06T09:15:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20calculus",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "enhance desolve output from separable ODEs",
    "type": "issue",
    "updated_at": "2022-12-29T01:30:11Z",
    "url": "https://github.com/sagemath/sage/issues/17739",
    "user": "https://github.com/rwst"
}
```
At the moment, `desolve` behaves like this even with trivial separable ODEs:

```
sage: t = var('t')
sage: y=function('y')(t)
sage: desolve(diff(y,t)-y^2,y)
-1/y(t) == _C + t
sage: desolve(diff(y,t)-y^2+y,y)
log(y(t) - 1) - log(y(t)) == _C + t
sage: desolve(diff(y,t)-y^2-1,y)
arctan(y(t)) == _C + t
```
They could be solved by substituting a variable for `y(t)` and calling `solve`. Only if there is no solution from `solve` the integrated equation should be given.


Upstream: **Not yet reported upstream; Will do shortly.**

_Issue created by migration from https://trac.sagemath.org/ticket/17739_





---

archive/issue_events_235017.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T09:15:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17739#event-235017"
}
```



---

archive/issue_events_235018.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T09:15:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "component: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17739#event-235018"
}
```



---

archive/issue_events_235019.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T09:15:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17739#event-235019"
}
```



---

archive/issue_events_235020.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T09:15:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17739#event-235020"
}
```



---

archive/issue_comments_242139.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nThis would yield (doctest):\n\n```\nsage: t = var('t')\nsage: y=function('y')(t)\nsage: desolve(diff(y,t)-y^2,y)\n-1/(_C + t)\nsage: desolve(diff(y,t)-y^2+y,y)\n-1/(e^(_C + t) - 1)\nsage: desolve(diff(y,t)-y^2-1,y)\ntan(_C + t)\n```",
    "created_at": "2015-02-06T09:20:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242139",
    "user": "https://github.com/rwst"
}
```

<div id="comment:1" align="right">Comment 1</div>

This would yield (doctest):

```
sage: t = var('t')
sage: y=function('y')(t)
sage: desolve(diff(y,t)-y^2,y)
-1/(_C + t)
sage: desolve(diff(y,t)-y^2+y,y)
-1/(e^(_C + t) - 1)
sage: desolve(diff(y,t)-y^2-1,y)
tan(_C + t)
```



---

archive/issue_comments_242140.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nDo we resolve this in Sage, Maxima, or both?",
    "created_at": "2015-02-06T09:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242140",
    "user": "https://github.com/rwst"
}
```

<div id="comment:2" align="right">Comment 2</div>

Do we resolve this in Sage, Maxima, or both?



---

archive/issue_comments_242141.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2015-02-06T15:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242141",
    "user": "https://github.com/kcrisman"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_comments_242142.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nYou should report this upstream, but maybe first to the email list, not as a bug.  Surely there must be a *reason* they report the solutions that way ... right?  (For instance, maybe this is \"more correct\" than something with solve that might lose a solution or something.  Though it's hard to see how that could happen in your first example!)",
    "created_at": "2015-02-06T15:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242142",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:3" align="right">Comment 3</div>

You should report this upstream, but maybe first to the email list, not as a bug.  Surely there must be a *reason* they report the solutions that way ... right?  (For instance, maybe this is "more correct" than something with solve that might lose a solution or something.  Though it's hard to see how that could happen in your first example!)



---

archive/issue_comments_242143.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nReplying to [@kcrisman](#comment%3A3):\n> You should report this upstream, but maybe first to the email list, not as a bug.  Surely there must be a *reason* they report the solutions that way ... right? \n\nIt appears not, see http://sourceforge.net/p/maxima/mailman/message/33364512/",
    "created_at": "2015-02-07T13:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242143",
    "user": "https://github.com/rwst"
}
```

<div id="comment:4" align="right">Comment 4</div>

Replying to [@kcrisman](#comment%3A3):
> You should report this upstream, but maybe first to the email list, not as a bug.  Surely there must be a *reason* they report the solutions that way ... right? 

It appears not, see http://sourceforge.net/p/maxima/mailman/message/33364512/



---

archive/issue_comments_242144.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nSo, the inconsistency is in Sage, which removes 'y==' from the results that have it, perhaps to facilitate further usage of the expression.\n\n```\n    if is_SymbolicEquation(soln) and soln.lhs() == dvar:\n        # Remark: Here we do not check that the right hand side does not depend on dvar.\n        # This probably will not hapen for soutions obtained via ode2, anyway.\n        soln = soln.rhs()\n```\nWe could now either remove the snippet, in order to always get an equation, or always try to solve for `dvar` and return an equation only when no solution is found.",
    "created_at": "2015-02-09T17:18:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/17739#issuecomment-242144",
    "user": "https://github.com/rwst"
}
```

<div id="comment:5" align="right">Comment 5</div>

So, the inconsistency is in Sage, which removes 'y==' from the results that have it, perhaps to facilitate further usage of the expression.

```
    if is_SymbolicEquation(soln) and soln.lhs() == dvar:
        # Remark: Here we do not check that the right hand side does not depend on dvar.
        # This probably will not hapen for soutions obtained via ode2, anyway.
        soln = soln.rhs()
```
We could now either remove the snippet, in order to always get an equation, or always try to solve for `dvar` and return an equation only when no solution is found.



---

archive/issue_events_235021.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:30:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/17739",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/17739#event-235021"
}
```
