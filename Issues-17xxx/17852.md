# Issue 17852: Cleanup in rings.arith and rings.integer

archive/issues_017615.json:
```json
{
    "body": "In this ticket, we:\n- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`\n- simplify the import logic in `rings.arith`\n- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`\n- remove some useless comments in arith\n- deprecate `powermodm_ui`\n- remove 1 from the output of `prime_powers()` (consistent with #16878)\n- remove the method `lcm` from `Rational`\n\nBranch/Commit: d7e1e37f954184aa281d22c25ef9485e8b8f453c\n\nReviewer: Jeroen Demeyer\n\nAuthor: Vincent Delecroix\n\nDependencies: #16878\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17852\n\n",
    "closed_at": "2015-04-15T13:58:20Z",
    "created_at": "2015-02-25T13:38:16Z",
    "labels": [
        "component: basic arithmetic"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Cleanup in rings.arith and rings.integer",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17852",
    "user": "https://github.com/videlec"
}
```
In this ticket, we:
- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`
- simplify the import logic in `rings.arith`
- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`
- remove some useless comments in arith
- deprecate `powermodm_ui`
- remove 1 from the output of `prime_powers()` (consistent with #16878)
- remove the method `lcm` from `Rational`

Branch/Commit: d7e1e37f954184aa281d22c25ef9485e8b8f453c

Reviewer: Jeroen Demeyer

Author: Vincent Delecroix

Dependencies: #16878

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17852





---

archive/issue_comments_306180.json:
```json
{
    "body": "Changing commit from \"\" to \"613ae23a399c16a03032e78e5483eaf90c42af15\"",
    "created_at": "2015-02-25T13:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306180",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "613ae23a399c16a03032e78e5483eaf90c42af15"



---

archive/issue_comments_306181.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-02-25T13:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306181",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_306182.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/17852\"",
    "created_at": "2015-02-25T13:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306182",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/17852"



---

archive/issue_comments_306183.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-02-25T13:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306183",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_306184.json:
```json
{
    "body": "<a id='comment:2'></a>Conflicts with #17819",
    "created_at": "2015-02-25T13:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306184",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Conflicts with #17819



---

archive/issue_comments_306185.json:
```json
{
    "body": "<a id='comment:3'></a>I suggest you revert all changes to `Integer.divisors`",
    "created_at": "2015-02-25T13:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306185",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>I suggest you revert all changes to `Integer.divisors`



---

archive/issue_comments_306186.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 jdemeyer]:\n> I suggest you revert all changes to `Integer.divisors`\n\n\nthere is none...\n\nEDIT: there are... I messed up my develop branch!",
    "created_at": "2015-02-25T13:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306186",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Replying to [comment:3 jdemeyer]:
> I suggest you revert all changes to `Integer.divisors`


there is none...

EDIT: there are... I messed up my develop branch!



---

archive/issue_comments_306187.json:
```json
{
    "body": "Changing commit from \"613ae23a399c16a03032e78e5483eaf90c42af15\" to \"7dcce3a9040cbb609bbc00432386c1d1dcbed945\"",
    "created_at": "2015-02-25T13:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "613ae23a399c16a03032e78e5483eaf90c42af15" to "7dcce3a9040cbb609bbc00432386c1d1dcbed945"



---

archive/issue_comments_306188.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-02-25T13:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306189.json:
```json
{
    "body": "<a id='comment:6'></a>No conflicts anymore...",
    "created_at": "2015-02-25T13:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306189",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>No conflicts anymore...



---

archive/issue_comments_306190.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-02-25T15:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306190",
    "user": "https://github.com/jdemeyer"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_306191.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-25T15:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306191",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306192.json:
```json
{
    "body": "<a id='comment:8'></a>I don't like this:\n\n```\ncdef mpz_t g = <mpz_t> mm.value\n```\n\nJust use `mm.value` instead of `g`.",
    "created_at": "2015-02-25T15:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306192",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>I don't like this:

```
cdef mpz_t g = <mpz_t> mm.value
```

Just use `mm.value` instead of `g`.



---

archive/issue_comments_306193.json:
```json
{
    "body": "<a id='comment:9'></a>`isinstance(z, (Rational))` -> `isinstance(z, Rational)`",
    "created_at": "2015-02-25T15:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306193",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>`isinstance(z, (Rational))` -> `isinstance(z, Rational)`



---

archive/issue_comments_306194.json:
```json
{
    "body": "<a id='comment:10'></a>What's the point of `eratosthenes()`, shouldn't that be a `deprecated_function_alias` of `prime_range`?",
    "created_at": "2015-02-25T15:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306194",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>What's the point of `eratosthenes()`, shouldn't that be a `deprecated_function_alias` of `prime_range`?



---

archive/issue_comments_306195.json:
```json
{
    "body": "<a id='comment:11'></a>Remove this:\n\n```\n    TESTS::\n\n        sage:\n```",
    "created_at": "2015-02-25T15:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306195",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>Remove this:

```
    TESTS::

        sage:
```



---

archive/issue_comments_306196.json:
```json
{
    "body": "<a id='comment:12'></a>For `is_squarefree`, add an example where the `.is_squarefree()` method is not used, for example `ZZ[sqrt(-1)]`.",
    "created_at": "2015-02-25T15:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306196",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>For `is_squarefree`, add an example where the `.is_squarefree()` method is not used, for example `ZZ[sqrt(-1)]`.



---

archive/issue_comments_306197.json:
```json
{
    "body": "<a id='comment:13'></a>\n```\nif isinstance(x, Integer):\n    return x.binomial(m, **kwds)\n```\nshould be `try`/`except AttributeError`",
    "created_at": "2015-02-25T15:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306197",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
```
if isinstance(x, Integer):
    return x.binomial(m, **kwds)
```
should be `try`/`except AttributeError`



---

archive/issue_comments_306198.json:
```json
{
    "body": "<a id='comment:14'></a>Replace\n\n```\ntry:\n    P = x.parent()\nexcept AttributeError:\n    P = type(x)\nif m < 0:\n    return P(0)\n```\nby\n\n```\nif m < 0:\n    return parent(x)(0)\n```",
    "created_at": "2015-02-25T16:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306198",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replace

```
try:
    P = x.parent()
except AttributeError:
    P = type(x)
if m < 0:
    return P(0)
```
by

```
if m < 0:
    return parent(x)(0)
```



---

archive/issue_comments_306199.json:
```json
{
    "body": "<a id='comment:15'></a>And `powermodm_ui` should be a deprecated alias for `powermod`: what's the point of an optimized path for `unsigned long` in a **Python function**?\n\nThen you can also remove\n\n```\nMAX_UNSIGNED_LONG = 2 * sys.maxsize\n```\n(which is wrong anyway!)",
    "created_at": "2015-02-25T16:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306199",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>And `powermodm_ui` should be a deprecated alias for `powermod`: what's the point of an optimized path for `unsigned long` in a **Python function**?

Then you can also remove

```
MAX_UNSIGNED_LONG = 2 * sys.maxsize
```
(which is wrong anyway!)



---

archive/issue_comments_306200.json:
```json
{
    "body": "<a id='comment:16'></a>\n```\nif not self:\n    raise ValueError(\"self must be nonzero\")\n```\nshould be `ArithmeticError` instead.",
    "created_at": "2015-02-25T16:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306200",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
```
if not self:
    raise ValueError("self must be nonzero")
```
should be `ArithmeticError` instead.



---

archive/issue_comments_306201.json:
```json
{
    "body": "<a id='comment:17'></a>\n```\nThe argument ``m`` or (``self-m``) must fits into unsigned long::\n```\n`fits` -> `fit`",
    "created_at": "2015-02-25T16:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306201",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
```
The argument ``m`` or (``self-m``) must fits into unsigned long::
```
`fits` -> `fit`



---

archive/issue_comments_306202.json:
```json
{
    "body": "<a id='comment:18'></a>I'm done for now :-)",
    "created_at": "2015-02-25T16:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306202",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>I'm done for now :-)



---

archive/issue_comments_306203.json:
```json
{
    "body": "Changing commit from \"7dcce3a9040cbb609bbc00432386c1d1dcbed945\" to \"975c2a0a6563538377eca78590fd16ddf0342548\"",
    "created_at": "2015-02-25T17:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306203",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7dcce3a9040cbb609bbc00432386c1d1dcbed945" to "975c2a0a6563538377eca78590fd16ddf0342548"



---

archive/issue_comments_306204.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-25T17:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306204",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306205.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:10 jdemeyer]:\n> What's the point of `eratosthenes()`, shouldn't that be a `deprecated_function_alias` of `prime_range`?\n\n\nIt is excplicitely written \"for educational purpose\"... I do not want to deprecate it so roughly.\n\nI agreed with all of the other suggestions and implemented them.\n\nVincent",
    "created_at": "2015-02-25T17:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306205",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Replying to [comment:10 jdemeyer]:
> What's the point of `eratosthenes()`, shouldn't that be a `deprecated_function_alias` of `prime_range`?


It is excplicitely written "for educational purpose"... I do not want to deprecate it so roughly.

I agreed with all of the other suggestions and implemented them.

Vincent



---

archive/issue_comments_306206.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,7 @@\n - simplify the import logic in `rings.arith`\n - replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`\n - remove some useless comments in arith\n+- deprecate `powermodm_ui`\n \n Author: Vincent Delecroix\n \n``````\n",
    "created_at": "2015-02-25T17:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306206",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,7 @@
 - simplify the import logic in `rings.arith`
 - replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`
 - remove some useless comments in arith
+- deprecate `powermodm_ui`
 
 Author: Vincent Delecroix
 
``````




---

archive/issue_comments_306207.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-25T17:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306207",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306208.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-25T18:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306209.json:
```json
{
    "body": "Changing commit from \"975c2a0a6563538377eca78590fd16ddf0342548\" to \"ad7d25a752db23ee3cae1a7d7b9fb2bbc7569bba\"",
    "created_at": "2015-02-25T18:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "975c2a0a6563538377eca78590fd16ddf0342548" to "ad7d25a752db23ee3cae1a7d7b9fb2bbc7569bba"



---

archive/issue_comments_306210.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-25T20:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306210",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306211.json:
```json
{
    "body": "<a id='comment:23'></a>just testing... didn't have a problem changing the status.",
    "created_at": "2015-02-25T20:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306211",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>just testing... didn't have a problem changing the status.



---

archive/issue_comments_306212.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-25T20:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306212",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306213.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-26T22:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306213",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306214.json:
```json
{
    "body": "<a id='comment:24'></a>Needs to be rebased on #16878.",
    "created_at": "2015-02-26T22:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306214",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>Needs to be rebased on #16878.



---

archive/issue_comments_306215.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#16878\"",
    "created_at": "2015-02-26T22:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306215",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#16878"



---

archive/issue_comments_306216.json:
```json
{
    "body": "Changing commit from \"ad7d25a752db23ee3cae1a7d7b9fb2bbc7569bba\" to \"c7916a76b70e698c278fa1780da16e7d96df2fe9\"",
    "created_at": "2015-02-28T21:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ad7d25a752db23ee3cae1a7d7b9fb2bbc7569bba" to "c7916a76b70e698c278fa1780da16e7d96df2fe9"



---

archive/issue_comments_306217.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-02-28T21:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306218.json:
```json
{
    "body": "<a id='comment:26'></a>Rebased over #16878",
    "created_at": "2015-02-28T21:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306218",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>Rebased over #16878



---

archive/issue_comments_306219.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-28T21:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306219",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306220.json:
```json
{
    "body": "<a id='comment:27'></a>This looks dubious to me:\n\n```\n-    R = parent(n)\n-    if R in [int, long]:\n+    if isinstance(int, long):\n```",
    "created_at": "2015-03-05T09:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306220",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>This looks dubious to me:

```
-    R = parent(n)
-    if R in [int, long]:
+    if isinstance(int, long):
```



---

archive/issue_comments_306221.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-05T09:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306221",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306222.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-06T01:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306222",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306223.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 chapoton]:\n> This looks dubious to me:\n> \n> ```\n> -    R = parent(n)\n> -    if R in [int, long]:\n> +    if isinstance(int, long):\n> ```\n\n\nEDIT: you are definitely right... see the commit below!\n\nIf an object `n` is not a Sage Element `parent(n)` returns the type of `n`.\n\n```\nsage: parent(3r)\n<type 'int'>\nsage: parent(Graph())\n<class 'sage.graphs.graph.Graph'>\n```\nThe code `parent(n) in [int,long]` is (roughly) equivalent to `type(n) in [int,long]`. I find much cleaner to use `isinstance`. If you do have a use case for which there is a difference, then please tell me.\n\nVincent",
    "created_at": "2015-03-06T01:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306223",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>Replying to [comment:27 chapoton]:
> This looks dubious to me:
> 
> ```
> -    R = parent(n)
> -    if R in [int, long]:
> +    if isinstance(int, long):
> ```


EDIT: you are definitely right... see the commit below!

If an object `n` is not a Sage Element `parent(n)` returns the type of `n`.

```
sage: parent(3r)
<type 'int'>
sage: parent(Graph())
<class 'sage.graphs.graph.Graph'>
```
The code `parent(n) in [int,long]` is (roughly) equivalent to `type(n) in [int,long]`. I find much cleaner to use `isinstance`. If you do have a use case for which there is a difference, then please tell me.

Vincent



---

archive/issue_comments_306224.json:
```json
{
    "body": "Changing commit from \"c7916a76b70e698c278fa1780da16e7d96df2fe9\" to \"03d78d330b2693223c8cff3975206b38752174e8\"",
    "created_at": "2015-03-06T07:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c7916a76b70e698c278fa1780da16e7d96df2fe9" to "03d78d330b2693223c8cff3975206b38752174e8"



---

archive/issue_comments_306225.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-03-06T07:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306225",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306226.json:
```json
{
    "body": "<a id='comment:31'></a>I get a doc builder error (but I closed my session, so I cannot copy the error message now)",
    "created_at": "2015-03-06T16:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306226",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>I get a doc builder error (but I closed my session, so I cannot copy the error message now)



---

archive/issue_comments_306227.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-06T16:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306227",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306228.json:
```json
{
    "body": "<a id='comment:32'></a>please replace the first :: by : in\n\n```\n TESTS::\n+ Check that output are always Sage integers (:trac:`922`)::\n```",
    "created_at": "2015-03-06T16:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306228",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'></a>please replace the first :: by : in

```
 TESTS::
+ Check that output are always Sage integers (:trac:`922`)::
```



---

archive/issue_comments_306229.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-07T16:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306229",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306230.json:
```json
{
    "body": "Changing commit from \"03d78d330b2693223c8cff3975206b38752174e8\" to \"101f5a0feaf66f5f5e3a7cb0e4d706220ee3ff71\"",
    "created_at": "2015-03-07T16:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306230",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "03d78d330b2693223c8cff3975206b38752174e8" to "101f5a0feaf66f5f5e3a7cb0e4d706220ee3ff71"



---

archive/issue_comments_306231.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-07T16:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306231",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306232.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n-\n+In this ticket, we:\n+- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`\n+- simplify the import logic in `rings.arith`\n+- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`\n+- remove some useless comments in arith\n+- deprecate `powermodm_ui`\n+- remove 1 from the output of `prime_powers()` (consistent with #16878)\n \n Author: Vincent Delecroix\n \n``````\n",
    "created_at": "2015-03-09T10:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306232",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
-
+In this ticket, we:
+- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`
+- simplify the import logic in `rings.arith`
+- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`
+- remove some useless comments in arith
+- deprecate `powermodm_ui`
+- remove 1 from the output of `prime_powers()` (consistent with #16878)
 
 Author: Vincent Delecroix
 
``````




---

archive/issue_comments_306233.json:
```json
{
    "body": "<a id='comment:36'></a>Why did you remove many doctests of `prime_powers()`? In particular this test:\n\n```\nprime_powers(95,1234)\n```",
    "created_at": "2015-03-09T10:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306233",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>Why did you remove many doctests of `prime_powers()`? In particular this test:

```
prime_powers(95,1234)
```



---

archive/issue_comments_306234.json:
```json
{
    "body": "<a id='comment:37'></a>In `prime_powers`, why do you only allow `Integer`, `int` and `long`? Why not\n\n```\nif not isinstance(start, Integer):\n    start = Integer(start)\n```\nThen you don't need to `raise TypeError` explicitly, as `Integer(start)` will do that if needed.",
    "created_at": "2015-03-09T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306234",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>In `prime_powers`, why do you only allow `Integer`, `int` and `long`? Why not

```
if not isinstance(start, Integer):
    start = Integer(start)
```
Then you don't need to `raise TypeError` explicitly, as `Integer(start)` will do that if needed.



---

archive/issue_comments_306235.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-09T10:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306235",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306236.json:
```json
{
    "body": "<a id='comment:38'></a>Replace\n\n```\nif isinstance(x, (float, complex, RealNumber, RealLiteral, ComplexNumber))\n```\nby\n\n```\nif isinstance(x, (float, complex, RealNumber, ComplexNumber))\n```",
    "created_at": "2015-03-09T10:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306236",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>Replace

```
if isinstance(x, (float, complex, RealNumber, RealLiteral, ComplexNumber))
```
by

```
if isinstance(x, (float, complex, RealNumber, ComplexNumber))
```



---

archive/issue_comments_306237.json:
```json
{
    "body": "<a id='comment:39'></a>Why\n\n```\nP(1) * x.binomial(m, **kwds)\n```\nand not\n\n```\nx.binomial(m, **kwds)\n```\nor\n\n```\nP(x.binomial(m, **kwds))\n```",
    "created_at": "2015-03-09T10:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306237",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>Why

```
P(1) * x.binomial(m, **kwds)
```
and not

```
x.binomial(m, **kwds)
```
or

```
P(x.binomial(m, **kwds))
```



---

archive/issue_comments_306238.json:
```json
{
    "body": "<a id='comment:40'></a>For the binomial function: the documentation mentions\n\n```\nEither ``m`` or ``x-m`` must be an integer.\n```\nbut the code doesn't reflect this.\n\nI think therefore you need\n\n```\ntry:\n    m = Integer(m)\nexcept TypeError:\n    m = Integer(x - m)\n```\nAlso, a doctest should be added for this case.",
    "created_at": "2015-03-09T10:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306238",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>For the binomial function: the documentation mentions

```
Either ``m`` or ``x-m`` must be an integer.
```
but the code doesn't reflect this.

I think therefore you need

```
try:
    m = Integer(m)
except TypeError:
    m = Integer(x - m)
```
Also, a doctest should be added for this case.



---

archive/issue_comments_306239.json:
```json
{
    "body": "<a id='comment:41'></a>And the conversion of `x` to `ZZ` should be added after the PARI branch.",
    "created_at": "2015-03-09T10:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306239",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>And the conversion of `x` to `ZZ` should be added after the PARI branch.



---

archive/issue_comments_306240.json:
```json
{
    "body": "<a id='comment:42'></a>\n```\nsage -t --long src/sage/rings/integer.pyx\n**********************************************************************\nFile \"src/sage/rings/integer.pyx\", line 6118, in sage.rings.integer.Integer.binomial\nFailed example:\n    alarm(0.1); (2**100).binomial(2**30, algorithm='pari')\nExpected:\n    Traceback (most recent call last):\n    ...\n    AlarmInterrupt\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 492, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 854, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.integer.Integer.binomial[12]>\", line 1, in <module>\n        alarm(RealNumber('0.1')); (Integer(2)**Integer(100)).binomial(Integer(2)**Integer(30), algorithm='pari')\n      File \"sage/rings/integer.pyx\", line 6154, in sage.rings.integer.Integer.binomial (build/cythonized/sage/rings/integer.c:36402)\n        return the_integer_ring(self._pari_().binomial(mm))\n      File \"sage/libs/pari/gen.pyx\", line 5379, in sage.libs.pari.gen.gen.binomial (build/cythonized/sage/libs/pari/gen.c:25503)\n        pari_catch_sig_on()\n      File \"sage/libs/pari/handle_error.pyx\", line 163, in sage.libs.pari.handle_error._pari_err_handle (build/cythonized/sage/libs/pari/handle_error.c:2656)\n        pari_instance.allocatemem(silent=True)\n      File \"sage/libs/pari/pari_instance.pyx\", line 1122, in sage.libs.pari.pari_instance.PariInstance.allocatemem (build/cythonized/sage/libs/pari/pari_instance.c:7709)\n        init_stack(s)\n      File \"sage/libs/pari/pari_instance.pyx\", line 1657, in sage.libs.pari.pari_instance.init_stack (build/cythonized/sage/libs/pari/pari_instance.c:11894)\n        raise MemoryError(\"Unable to allocate %s bytes for the PARI stack (instead, allocated %s bytes)\"%(failed_size, new_size))\n    MemoryError: Unable to allocate 6400000000 bytes for the PARI stack (instead, allocated 5120000000 bytes)\n**********************************************************************\n1 item had failures:\n   1 of  14 in sage.rings.integer.Integer.binomial\n    [1031 tests, 1 failure, 10.74 s]\nsage -t --long src/doc/en/developer/coding_basics.rst\n**********************************************************************\nFile \"src/doc/en/developer/coding_basics.rst\", line 845, in doc.en.developer.coding_basics\nFailed example:\n    z.powermodm_ui(2^32-1, 14)\nExpected:\n    8                                                               \nGot:\n    doctest:1: DeprecationWarning: powermodm_ui is deprecated. Please use powermod instead.\n    See http://trac.sagemath.org/17852 for details.\n    8\n**********************************************************************\n```",
    "created_at": "2015-03-09T10:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306240",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>
```
sage -t --long src/sage/rings/integer.pyx
**********************************************************************
File "src/sage/rings/integer.pyx", line 6118, in sage.rings.integer.Integer.binomial
Failed example:
    alarm(0.1); (2**100).binomial(2**30, algorithm='pari')
Expected:
    Traceback (most recent call last):
    ...
    AlarmInterrupt
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.integer.Integer.binomial[12]>", line 1, in <module>
        alarm(RealNumber('0.1')); (Integer(2)**Integer(100)).binomial(Integer(2)**Integer(30), algorithm='pari')
      File "sage/rings/integer.pyx", line 6154, in sage.rings.integer.Integer.binomial (build/cythonized/sage/rings/integer.c:36402)
        return the_integer_ring(self._pari_().binomial(mm))
      File "sage/libs/pari/gen.pyx", line 5379, in sage.libs.pari.gen.gen.binomial (build/cythonized/sage/libs/pari/gen.c:25503)
        pari_catch_sig_on()
      File "sage/libs/pari/handle_error.pyx", line 163, in sage.libs.pari.handle_error._pari_err_handle (build/cythonized/sage/libs/pari/handle_error.c:2656)
        pari_instance.allocatemem(silent=True)
      File "sage/libs/pari/pari_instance.pyx", line 1122, in sage.libs.pari.pari_instance.PariInstance.allocatemem (build/cythonized/sage/libs/pari/pari_instance.c:7709)
        init_stack(s)
      File "sage/libs/pari/pari_instance.pyx", line 1657, in sage.libs.pari.pari_instance.init_stack (build/cythonized/sage/libs/pari/pari_instance.c:11894)
        raise MemoryError("Unable to allocate %s bytes for the PARI stack (instead, allocated %s bytes)"%(failed_size, new_size))
    MemoryError: Unable to allocate 6400000000 bytes for the PARI stack (instead, allocated 5120000000 bytes)
**********************************************************************
1 item had failures:
   1 of  14 in sage.rings.integer.Integer.binomial
    [1031 tests, 1 failure, 10.74 s]
sage -t --long src/doc/en/developer/coding_basics.rst
**********************************************************************
File "src/doc/en/developer/coding_basics.rst", line 845, in doc.en.developer.coding_basics
Failed example:
    z.powermodm_ui(2^32-1, 14)
Expected:
    8                                                               
Got:
    doctest:1: DeprecationWarning: powermodm_ui is deprecated. Please use powermod instead.
    See http://trac.sagemath.org/17852 for details.
    8
**********************************************************************
```



---

archive/issue_comments_306241.json:
```json
{
    "body": "Changing commit from \"101f5a0feaf66f5f5e3a7cb0e4d706220ee3ff71\" to \"cbbb06fa27b0b9178ad3f9d0de3dc3235c5ec1c3\"",
    "created_at": "2015-03-13T21:54:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "101f5a0feaf66f5f5e3a7cb0e4d706220ee3ff71" to "cbbb06fa27b0b9178ad3f9d0de3dc3235c5ec1c3"



---

archive/issue_comments_306242.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-13T21:54:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306243.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-13T21:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306243",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306244.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:41 jdemeyer]:\n> And the conversion of `x` to `ZZ` should be added after the PARI branch.\n\n\nWhy?",
    "created_at": "2015-03-13T21:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306244",
    "user": "https://github.com/videlec"
}
```

<a id='comment:45'></a>Replying to [comment:41 jdemeyer]:
> And the conversion of `x` to `ZZ` should be added after the PARI branch.


Why?



---

archive/issue_comments_306245.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:39 jdemeyer]:\n> Why\n> \n> ```\n> P(1) * x.binomial(m, **kwds)\n> ```\n> and not\n> \n> ```\n> x.binomial(m, **kwds)\n> ```\n\n\nDone",
    "created_at": "2015-03-13T21:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306245",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>Replying to [comment:39 jdemeyer]:
> Why
> 
> ```
> P(1) * x.binomial(m, **kwds)
> ```
> and not
> 
> ```
> x.binomial(m, **kwds)
> ```


Done



---

archive/issue_comments_306246.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:42 jdemeyer]:\n> {{{\n> sage -t --long src/sage/rings/integer.pyx\n> **********************************************************************\n> File \"src/sage/rings/integer.pyx\", line 6118, in sage.rings.integer.Integer.binomial\n> Failed example:\n>     alarm(0.1); (2**100).binomial(2**30, algorithm='pari')\n> ...\n> }}}\n\n\nFor the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?",
    "created_at": "2015-03-13T21:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306246",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>Replying to [comment:42 jdemeyer]:
> {{{
> sage -t --long src/sage/rings/integer.pyx
> **********************************************************************
> File "src/sage/rings/integer.pyx", line 6118, in sage.rings.integer.Integer.binomial
> Failed example:
>     alarm(0.1); (2**100).binomial(2**30, algorithm='pari')
> ...
> }}}


For the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?



---

archive/issue_comments_306247.json:
```json
{
    "body": "<a id='comment:48'></a>I'm not sure that I like this:\n\n```\nsage: a = binomial(float(1001), float(1)); a\n1001.0\nsage: type(a)\n<type 'sage.rings.real_double.RealDoubleElement'>\n```\n\nShouldn't `float` input also give `float` output?",
    "created_at": "2015-03-13T22:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306247",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>I'm not sure that I like this:

```
sage: a = binomial(float(1001), float(1)); a
1001.0
sage: type(a)
<type 'sage.rings.real_double.RealDoubleElement'>
```

Shouldn't `float` input also give `float` output?



---

archive/issue_comments_306248.json:
```json
{
    "body": "<a id='comment:49'></a>Replying to [comment:47 vdelecroix]:\n> For the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?\n\n\nThe problem wasn't time, the problem was memory. We should find input for which the call needs at most 2GB of memory.",
    "created_at": "2015-03-13T22:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306248",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>Replying to [comment:47 vdelecroix]:
> For the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?


The problem wasn't time, the problem was memory. We should find input for which the call needs at most 2GB of memory.



---

archive/issue_comments_306249.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 jdemeyer]:\n> Replying to [comment:47 vdelecroix]:\n> > For the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?\n\n> \n> The problem wasn't time, the problem was memory. We should find input for which the call needs at most 2GB of memory.\n\n\nI also changed the values to `(2**100).binomial(2**19)` (it is a number with 43223705 bits). At least on my computer, the RAM used stays below 2G.",
    "created_at": "2015-03-14T07:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306249",
    "user": "https://github.com/videlec"
}
```

<a id='comment:50'></a>Replying to [comment:49 jdemeyer]:
> Replying to [comment:47 vdelecroix]:
> > For the doctest I put more reasonable values for which the call took 2 sec on my computer. I also decrease the alarm time to `0.01`. Does this look better?

> 
> The problem wasn't time, the problem was memory. We should find input for which the call needs at most 2GB of memory.


I also changed the values to `(2**100).binomial(2**19)` (it is a number with 43223705 bits). At least on my computer, the RAM used stays below 2G.



---

archive/issue_comments_306250.json:
```json
{
    "body": "<a id='comment:51'></a>There is a test in `doc/en/developer/coding_basics.rst` that uses `Integer.powermod_ui` as an example for difference behavior for 32 bits and 64 bits. Do you have an other example in mind?\n\nReplying to [comment:48 jdemeyer]:\n> I'm not sure that I like this:\n> \n> ```\n> sage: a = binomial(float(1001), float(1)); a\n> 1001.0\n> sage: type(a)\n> <type 'sage.rings.real_double.RealDoubleElement'>\n> ```\n> \n> Shouldn't `float` input also give `float` output?\n\n\nRight. On the previous version we had\n\n```\nsage: type(binomial(5r,2r))\n<type 'int'>\nsage: type(binomial(5r,2))\n<type 'sage.rings.integer.Integer'>\nsage: type(binomial(5,2r))\n<type 'sage.rings.integer.Integer'>\n```\nI will change that.",
    "created_at": "2015-03-14T08:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306250",
    "user": "https://github.com/videlec"
}
```

<a id='comment:51'></a>There is a test in `doc/en/developer/coding_basics.rst` that uses `Integer.powermod_ui` as an example for difference behavior for 32 bits and 64 bits. Do you have an other example in mind?

Replying to [comment:48 jdemeyer]:
> I'm not sure that I like this:
> 
> ```
> sage: a = binomial(float(1001), float(1)); a
> 1001.0
> sage: type(a)
> <type 'sage.rings.real_double.RealDoubleElement'>
> ```
> 
> Shouldn't `float` input also give `float` output?


Right. On the previous version we had

```
sage: type(binomial(5r,2r))
<type 'int'>
sage: type(binomial(5r,2))
<type 'sage.rings.integer.Integer'>
sage: type(binomial(5,2r))
<type 'sage.rings.integer.Integer'>
```
I will change that.



---

archive/issue_comments_306251.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-14T08:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306251",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306252.json:
```json
{
    "body": "<a id='comment:52'></a>There was also no care of the output type for rational input\n\n```\nsage: type(binomial(5/1,3/1))\n<type 'sage.rings.integer.Integer'>\n```\n(in sage-6.5)",
    "created_at": "2015-03-14T08:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306252",
    "user": "https://github.com/videlec"
}
```

<a id='comment:52'></a>There was also no care of the output type for rational input

```
sage: type(binomial(5/1,3/1))
<type 'sage.rings.integer.Integer'>
```
(in sage-6.5)



---

archive/issue_comments_306253.json:
```json
{
    "body": "<a id='comment:53'></a>\n```\n            sage: hash(-920390823904823094890238490238484)\n            -873977844            # 32-bit\n            6874330978542788722   # 64-bit\n```",
    "created_at": "2015-03-14T08:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306253",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>
```
            sage: hash(-920390823904823094890238490238484)
            -873977844            # 32-bit
            6874330978542788722   # 64-bit
```



---

archive/issue_comments_306254.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:53 jdemeyer]:\n> {{{\n>             sage: hash(-920390823904823094890238490238484)\n>             -873977844            # 32-bit\n>             6874330978542788722   # 64-bit\n> }}}\n\n\nThanks!\n\nI also noticed that on large input `pari` is faster than `mpir`:\n\n```\nsage: %timeit a = (2**50).binomial(2**10, algorithm='mpir')\n1000 loops, best of 3: 462 \u00b5s per loop\nsage: %timeit a = (2**50).binomial(2**10, algorithm='pari')\n1000 loops, best of 3: 221 \u00b5s per loop\n```\nand the difference is even more significant with larger numbers... I will had a note related to that.\n\nFinally, I have troubles with the modification of the output type in `arith.binomial` ([comment:48 comment:48], [comment:51 comment:51] and [comment:52 comment:52]). It is responsible for some doctest failure in `rings/polynomial/multi_polynomial_ideal.py` (the random generation stuff). I was not able to track down the issue.",
    "created_at": "2015-03-14T08:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306254",
    "user": "https://github.com/videlec"
}
```

<a id='comment:54'></a>Replying to [comment:53 jdemeyer]:
> {{{
>             sage: hash(-920390823904823094890238490238484)
>             -873977844            # 32-bit
>             6874330978542788722   # 64-bit
> }}}


Thanks!

I also noticed that on large input `pari` is faster than `mpir`:

```
sage: %timeit a = (2**50).binomial(2**10, algorithm='mpir')
1000 loops, best of 3: 462 s per loop
sage: %timeit a = (2**50).binomial(2**10, algorithm='pari')
1000 loops, best of 3: 221 s per loop
```
and the difference is even more significant with larger numbers... I will had a note related to that.

Finally, I have troubles with the modification of the output type in `arith.binomial` ([comment:48 comment:48], [comment:51 comment:51] and [comment:52 comment:52]). It is responsible for some doctest failure in `rings/polynomial/multi_polynomial_ideal.py` (the random generation stuff). I was not able to track down the issue.



---

archive/issue_comments_306255.json:
```json
{
    "body": "Changing commit from \"cbbb06fa27b0b9178ad3f9d0de3dc3235c5ec1c3\" to \"d40126995abbc7dcb7e484b3d628a5196ea026d0\"",
    "created_at": "2015-03-14T14:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cbbb06fa27b0b9178ad3f9d0de3dc3235c5ec1c3" to "d40126995abbc7dcb7e484b3d628a5196ea026d0"



---

archive/issue_comments_306256.json:
```json
{
    "body": "<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-14T14:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306257.json:
```json
{
    "body": "<a id='comment:56'></a>Before doing coercion, what matters is the `parent()`, not the `type()` which should be equal.",
    "created_at": "2015-03-14T14:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306257",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>Before doing coercion, what matters is the `parent()`, not the `type()` which should be equal.



---

archive/issue_comments_306258.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-14T14:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306258",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306259.json:
```json
{
    "body": "Changing commit from \"d40126995abbc7dcb7e484b3d628a5196ea026d0\" to \"8fc6b3da7c26d5ff4695991c26d67e38b3c1f103\"",
    "created_at": "2015-03-14T14:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d40126995abbc7dcb7e484b3d628a5196ea026d0" to "8fc6b3da7c26d5ff4695991c26d67e38b3c1f103"



---

archive/issue_comments_306260.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n-\n+In this ticket, we:\n+- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`\n+- simplify the import logic in `rings.arith`\n+- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`\n+- remove some useless comments in arith\n+- deprecate `powermodm_ui`\n+- remove 1 from the output of `prime_powers()` (consistent with #16878)\n+- remove the method `lcm` from `Rational`\n \n Author: Vincent Delecroix\n \n``````\n",
    "created_at": "2015-03-14T14:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306260",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,11 @@
-
+In this ticket, we:
+- implement the two functions `prime_part_m` and `binomial` directly as methods of Sage integers and get rid of the `late_import` in `sage.rings.integer`
+- simplify the import logic in `rings.arith`
+- replace in arith `prod([x for x in hum])` by `prod(x for x in hum)`
+- remove some useless comments in arith
+- deprecate `powermodm_ui`
+- remove 1 from the output of `prime_powers()` (consistent with #16878)
+- remove the method `lcm` from `Rational`
 
 Author: Vincent Delecroix
 
``````




---

archive/issue_comments_306261.json:
```json
{
    "body": "Changing commit from \"8fc6b3da7c26d5ff4695991c26d67e38b3c1f103\" to \"61b94c202141bf164d87bae24912c687553b7869\"",
    "created_at": "2015-03-14T21:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8fc6b3da7c26d5ff4695991c26d67e38b3c1f103" to "61b94c202141bf164d87bae24912c687553b7869"



---

archive/issue_comments_306262.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-14T21:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306263.json:
```json
{
    "body": "<a id='comment:60'></a>For the strange doctest failure responsible for commit \u200b61b94c2 see [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/kYovnNz7NmM).",
    "created_at": "2015-03-14T21:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306263",
    "user": "https://github.com/videlec"
}
```

<a id='comment:60'></a>For the strange doctest failure responsible for commit 61b94c2 see [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/kYovnNz7NmM).



---

archive/issue_comments_306264.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-14T21:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306264",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306265.json:
```json
{
    "body": "<a id='comment:61'></a>I'm not sure if `rings/arith.py:binomial` should do more than numerics because the console user will first see `functions/other.py:binomial` and use that. The programmer OTOH probably won't need other than numerics. So, your efforts in `rings/arith.py:binomial` regarding other rings looks wasted to me.\n\nThere is already #17489 removing function duplicity for `factorial` so this is something to think of.",
    "created_at": "2015-03-15T10:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306265",
    "user": "https://github.com/rwst"
}
```

<a id='comment:61'></a>I'm not sure if `rings/arith.py:binomial` should do more than numerics because the console user will first see `functions/other.py:binomial` and use that. The programmer OTOH probably won't need other than numerics. So, your efforts in `rings/arith.py:binomial` regarding other rings looks wasted to me.

There is already #17489 removing function duplicity for `factorial` so this is something to think of.



---

archive/issue_comments_306266.json:
```json
{
    "body": "<a id='comment:62'></a>Replying to [comment:61 rws]:\n> I'm not sure if `rings/arith.py:binomial` should do more than numerics because the console user will first see `functions/other.py:binomial` and use that. The programmer OTOH probably won't need other than numerics. So, your efforts in `rings/arith.py:binomial` regarding other rings looks wasted to me.\n\n\nIn the new version, `arith.binomial` do less than before regarding other rings (especially the symbolic one). What do you mean by numerics: integers? rationals? reals? complex? algebraic numbers?\n\n> There is already #17489 removing function duplicity for `factorial` so this is something to think of.\n\n\nRemoving `binomial` from arith is not an option. On top of #17852 we have\n\n```\nsage: from sage.rings.arith import binomial as arith_binomial\nsage: %timeit arith_binomial(10,4)\n100000 loops, best of 3: 1.87 \u00b5s per loop\nsage: %timeit binomial(10,4)\n10000 loops, best of 3: 47.3 \u00b5s per loop\n```\nThe slowdown is less dramatic for factorial but still visible\n\n```\nsage: from sage.rings.arith import factorial as arith_factorial\nsage: %timeit arith_factorial(10)\n1000000 loops, best of 3: 474 ns per loop\nsage: %timeit factorial(10)\n1000000 loops, best of 3: 1.02 \u00b5s per loop\n```",
    "created_at": "2015-03-15T10:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306266",
    "user": "https://github.com/videlec"
}
```

<a id='comment:62'></a>Replying to [comment:61 rws]:
> I'm not sure if `rings/arith.py:binomial` should do more than numerics because the console user will first see `functions/other.py:binomial` and use that. The programmer OTOH probably won't need other than numerics. So, your efforts in `rings/arith.py:binomial` regarding other rings looks wasted to me.


In the new version, `arith.binomial` do less than before regarding other rings (especially the symbolic one). What do you mean by numerics: integers? rationals? reals? complex? algebraic numbers?

> There is already #17489 removing function duplicity for `factorial` so this is something to think of.


Removing `binomial` from arith is not an option. On top of #17852 we have

```
sage: from sage.rings.arith import binomial as arith_binomial
sage: %timeit arith_binomial(10,4)
100000 loops, best of 3: 1.87 s per loop
sage: %timeit binomial(10,4)
10000 loops, best of 3: 47.3 s per loop
```
The slowdown is less dramatic for factorial but still visible

```
sage: from sage.rings.arith import factorial as arith_factorial
sage: %timeit arith_factorial(10)
1000000 loops, best of 3: 474 ns per loop
sage: %timeit factorial(10)
1000000 loops, best of 3: 1.02 s per loop
```



---

archive/issue_comments_306267.json:
```json
{
    "body": "Changing commit from \"61b94c202141bf164d87bae24912c687553b7869\" to \"6697e686ab123c65b147e03c8df1b3969ea548fa\"",
    "created_at": "2015-03-15T13:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306267",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "61b94c202141bf164d87bae24912c687553b7869" to "6697e686ab123c65b147e03c8df1b3969ea548fa"



---

archive/issue_comments_306268.json:
```json
{
    "body": "<a id='comment:63'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-15T13:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306268",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:63'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306269.json:
```json
{
    "body": "<a id='comment:64'></a>An additional commit to take care of #12179.",
    "created_at": "2015-03-15T13:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306269",
    "user": "https://github.com/videlec"
}
```

<a id='comment:64'></a>An additional commit to take care of #12179.



---

archive/issue_comments_306270.json:
```json
{
    "body": "Changing commit from \"6697e686ab123c65b147e03c8df1b3969ea548fa\" to \"2260680a81f19b47202401109a7ec10f59e32d50\"",
    "created_at": "2015-03-20T09:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306270",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6697e686ab123c65b147e03c8df1b3969ea548fa" to "2260680a81f19b47202401109a7ec10f59e32d50"



---

archive/issue_comments_306271.json:
```json
{
    "body": "<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-20T09:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306272.json:
```json
{
    "body": "<a id='comment:66'></a>All test pass on 6.6-beta6!\n\nVincent",
    "created_at": "2015-03-20T11:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306272",
    "user": "https://github.com/videlec"
}
```

<a id='comment:66'></a>All test pass on 6.6-beta6!

Vincent



---

archive/issue_comments_306273.json:
```json
{
    "body": "<a id='comment:67'></a>Comment [comment:36] hasn't been addressed.",
    "created_at": "2015-03-21T13:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306273",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:67'></a>Comment [comment:36] hasn't been addressed.



---

archive/issue_comments_306274.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-21T13:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306274",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306275.json:
```json
{
    "body": "<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T13:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306275",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306276.json:
```json
{
    "body": "Changing commit from \"2260680a81f19b47202401109a7ec10f59e32d50\" to \"7f9847fb45b5fe5601a909155371c5ee024d19db\"",
    "created_at": "2015-03-21T13:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306276",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2260680a81f19b47202401109a7ec10f59e32d50" to "7f9847fb45b5fe5601a909155371c5ee024d19db"



---

archive/issue_comments_306277.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-21T13:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306277",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306278.json:
```json
{
    "body": "<a id='comment:70'></a>Now this test is duplicated:\n\n```\nsage: len(prime_powers(1000))\n```",
    "created_at": "2015-03-21T18:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306278",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:70'></a>Now this test is duplicated:

```
sage: len(prime_powers(1000))
```



---

archive/issue_comments_306279.json:
```json
{
    "body": "Changing commit from \"7f9847fb45b5fe5601a909155371c5ee024d19db\" to \"faf206825e26344ae20fbe41363b00ba4e301c07\"",
    "created_at": "2015-03-21T18:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306279",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7f9847fb45b5fe5601a909155371c5ee024d19db" to "faf206825e26344ae20fbe41363b00ba4e301c07"



---

archive/issue_comments_306280.json:
```json
{
    "body": "<a id='comment:71'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T18:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:71'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306281.json:
```json
{
    "body": "<a id='comment:72'></a>Sorry but I still don't like the `binomial` code.\n\nIn particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.\n\nAlso, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.\n\nI will continue my review of the rest of this branch, please do not change anything except `binomial`.",
    "created_at": "2015-03-21T21:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306281",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:72'></a>Sorry but I still don't like the `binomial` code.

In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.

Also, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.

I will continue my review of the rest of this branch, please do not change anything except `binomial`.



---

archive/issue_comments_306282.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-21T21:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306282",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306283.json:
```json
{
    "body": "<a id='comment:74'></a>Not your fault, but should be fixed anyway: the error message of `integer_ceil` has\n\n```\nraise NotImplementedError(\"computation of floor of %s not implemented\"%repr(x))\n```",
    "created_at": "2015-03-21T21:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306283",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:74'></a>Not your fault, but should be fixed anyway: the error message of `integer_ceil` has

```
raise NotImplementedError("computation of floor of %s not implemented"%repr(x))
```



---

archive/issue_comments_306284.json:
```json
{
    "body": "<a id='comment:75'></a>Replace\n\n```\nsage: alarm(0.01); (2**100).binomial(2**19, algorithm='pari')\n```\nby\n\n```\nsage: alarm(0.5); (2^100).binomial(2^22, algorithm='pari')\n```\n(analogously for `mpir`)\n\nWith this value, the memory use is reasonable and the computation takes long enough (48s on my machine) that it will not answer in <0.5s in the near future.",
    "created_at": "2015-03-21T21:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306284",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>Replace

```
sage: alarm(0.01); (2**100).binomial(2**19, algorithm='pari')
```
by

```
sage: alarm(0.5); (2^100).binomial(2^22, algorithm='pari')
```
(analogously for `mpir`)

With this value, the memory use is reasonable and the computation takes long enough (48s on my machine) that it will not answer in <0.5s in the near future.



---

archive/issue_comments_306285.json:
```json
{
    "body": "<a id='comment:76'></a>No further comments: if you fix the above without introducing new bugs :-) then it will finally be positive_review.",
    "created_at": "2015-03-21T21:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306285",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:76'></a>No further comments: if you fix the above without introducing new bugs :-) then it will finally be positive_review.



---

archive/issue_comments_306286.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2015-03-21T21:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306286",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_306287.json:
```json
{
    "body": "<a id='comment:78'></a>Replying to [comment:72 jdemeyer]:\n> Sorry but I still don't like the `binomial` code.\n> \n> In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.\n\n\nI am not sure I understand. You don't want the case 2 that tries to convert `x` to an integer? It is much faster that way for real or rational input that are actually integers.\n\n> Also, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.\n\n\nI am not sure that what I did in the branch is the best, but there is definitely something that needs to be specified (see #12179). Would you be satisfied with\n\n```\nsage: factorial(Zmod(12)(10), 4)\n3\n```",
    "created_at": "2015-03-21T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306287",
    "user": "https://github.com/videlec"
}
```

<a id='comment:78'></a>Replying to [comment:72 jdemeyer]:
> Sorry but I still don't like the `binomial` code.
> 
> In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.


I am not sure I understand. You don't want the case 2 that tries to convert `x` to an integer? It is much faster that way for real or rational input that are actually integers.

> Also, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.


I am not sure that what I did in the branch is the best, but there is definitely something that needs to be specified (see #12179). Would you be satisfied with

```
sage: factorial(Zmod(12)(10), 4)
3
```



---

archive/issue_comments_306288.json:
```json
{
    "body": "<a id='comment:79'></a>Replying to [comment:78 vdelecroix]:\n> Replying to [comment:72 jdemeyer]:\n> > Sorry but I still don't like the `binomial` code.\n> > \n> > In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.\n\n> \n> I am not sure I understand. You don't want the case 2 that tries to convert `x` to an integer? It is much faster that way for real or rational input that are actually integers.\n> \n> > Also, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.\n\n> \n> I am not sure that what I did in the branch is the best, but there is definitely something that needs to be specified (see #12179). Would you be satisfied with\n> \n> ```\n> sage: factorial(Zmod(12)(10), 4)\n> 3\n> ```\n\n\nActually, it does matter. When an operation on a given quotient ring is implemented from the initial ring, you expect it to not depend on the representative you used... but\n\n```\nsage: R = Integers(6)\nsage: R(binomial(5,2))\n4\nsage: R(binomial(5+6,2))\n1\n```\nNote that it would have been fine on quotients in which `2!` is invertible.",
    "created_at": "2015-03-21T22:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306288",
    "user": "https://github.com/videlec"
}
```

<a id='comment:79'></a>Replying to [comment:78 vdelecroix]:
> Replying to [comment:72 jdemeyer]:
> > Sorry but I still don't like the `binomial` code.
> > 
> > In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.

> 
> I am not sure I understand. You don't want the case 2 that tries to convert `x` to an integer? It is much faster that way for real or rational input that are actually integers.
> 
> > Also, the check that `factorial(m)` is invertible has no mathematical meaning and should just be removed.

> 
> I am not sure that what I did in the branch is the best, but there is definitely something that needs to be specified (see #12179). Would you be satisfied with
> 
> ```
> sage: factorial(Zmod(12)(10), 4)
> 3
> ```


Actually, it does matter. When an operation on a given quotient ring is implemented from the initial ring, you expect it to not depend on the representative you used... but

```
sage: R = Integers(6)
sage: R(binomial(5,2))
4
sage: R(binomial(5+6,2))
1
```
Note that it would have been fine on quotients in which `2!` is invertible.



---

archive/issue_comments_306289.json:
```json
{
    "body": "<a id='comment:80'></a>Replying to [comment:78 vdelecroix]:\n> Replying to [comment:72 jdemeyer]:\n> > Sorry but I still don't like the `binomial` code.\n> > \n> > In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.\n\n> \n> I am not sure I understand.\n\nI mean this:\n\n```\n    if parent(m) is not P:\n        from sage.structure.element import get_coercion_model\n        cm = get_coercion_model()\n        x,m = cm.canonical_coercion(x,m)\n        P = parent(x)\n```",
    "created_at": "2015-03-21T22:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306289",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:80'></a>Replying to [comment:78 vdelecroix]:
> Replying to [comment:72 jdemeyer]:
> > Sorry but I still don't like the `binomial` code.
> > 
> > In particular, do we really need the coercion there? The arguments `x` and `m` play a very different role, note that `m` is immediately converted to an integer anyway.

> 
> I am not sure I understand.

I mean this:

```
    if parent(m) is not P:
        from sage.structure.element import get_coercion_model
        cm = get_coercion_model()
        x,m = cm.canonical_coercion(x,m)
        P = parent(x)
```



---

archive/issue_comments_306290.json:
```json
{
    "body": "<a id='comment:81'></a>Replying to [comment:79 vdelecroix]:\n> Actually, it does matter. When an operation on a given quotient ring is implemented from the initial ring, you expect it to not depend on the representative you used... but\n> \n> ```\n> sage: R = Integers(6)\n> sage: R(binomial(5,2))\n> 4\n> sage: R(binomial(5+6,2))\n> 1\n> ```\n> Note that it would have been fine on quotients in which `2!` is invertible.\n\n\nOf course, you are right. Never mind what I said about this.",
    "created_at": "2015-03-21T22:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306290",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:81'></a>Replying to [comment:79 vdelecroix]:
> Actually, it does matter. When an operation on a given quotient ring is implemented from the initial ring, you expect it to not depend on the representative you used... but
> 
> ```
> sage: R = Integers(6)
> sage: R(binomial(5,2))
> 4
> sage: R(binomial(5+6,2))
> 1
> ```
> Note that it would have been fine on quotients in which `2!` is invertible.


Of course, you are right. Never mind what I said about this.



---

archive/issue_comments_306291.json:
```json
{
    "body": "Changing commit from \"faf206825e26344ae20fbe41363b00ba4e301c07\" to \"d70e2e8254b0da61792f6ddc4db8d430e4684bf0\"",
    "created_at": "2015-03-21T22:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "faf206825e26344ae20fbe41363b00ba4e301c07" to "d70e2e8254b0da61792f6ddc4db8d430e4684bf0"



---

archive/issue_comments_306292.json:
```json
{
    "body": "<a id='comment:82'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T22:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:82'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306293.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-21T22:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306293",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306294.json:
```json
{
    "body": "Changing commit from \"d70e2e8254b0da61792f6ddc4db8d430e4684bf0\" to \"4f0ca87b9f64858a22f3fcd23b63526ba7622f55\"",
    "created_at": "2015-03-21T23:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d70e2e8254b0da61792f6ddc4db8d430e4684bf0" to "4f0ca87b9f64858a22f3fcd23b63526ba7622f55"



---

archive/issue_comments_306295.json:
```json
{
    "body": "<a id='comment:84'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T23:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:84'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306296.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-23T14:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306296",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306297.json:
```json
{
    "body": "<a id='comment:85'></a>I thought a bit more about the invertibility check: in fact it has nothing to do with integral domains, but with the *characteristic* of the ring.\n\nThis is also not well-defined, despite `R` being a field:\n\n```\nsage: R = Zmod(7)\nsage: binomial(R(10), 7)\n1\nsage: R(binomial(17, 7))\n2\n```\n\nThe correct condition is that `factorial(m)` should be coprime to the characteristic of the ring. So the code should be something like\n\n```\ntry:\n    c = P.characteristic()\nexcept AttributeError:\n    # Assume that P has characteristic zero\n    pass\nelse:\n    if c > 0 and any(c.gcd(k) > 1 for k in range(2, m+1)):\n        raise ...\n```\n(you don't need `Q` for this)\n\nThe example with `Zmod(7)` should be added as doctest.",
    "created_at": "2015-03-23T14:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306297",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:85'></a>I thought a bit more about the invertibility check: in fact it has nothing to do with integral domains, but with the *characteristic* of the ring.

This is also not well-defined, despite `R` being a field:

```
sage: R = Zmod(7)
sage: binomial(R(10), 7)
1
sage: R(binomial(17, 7))
2
```

The correct condition is that `factorial(m)` should be coprime to the characteristic of the ring. So the code should be something like

```
try:
    c = P.characteristic()
except AttributeError:
    # Assume that P has characteristic zero
    pass
else:
    if c > 0 and any(c.gcd(k) > 1 for k in range(2, m+1)):
        raise ...
```
(you don't need `Q` for this)

The example with `Zmod(7)` should be added as doctest.



---

archive/issue_comments_306298.json:
```json
{
    "body": "<a id='comment:86'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-23T21:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306298",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:86'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306299.json:
```json
{
    "body": "Changing commit from \"4f0ca87b9f64858a22f3fcd23b63526ba7622f55\" to \"e24a437155ef6a95b6e413fd5717985fc05a48a1\"",
    "created_at": "2015-03-23T21:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4f0ca87b9f64858a22f3fcd23b63526ba7622f55" to "e24a437155ef6a95b6e413fd5717985fc05a48a1"



---

archive/issue_comments_306300.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-23T21:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306300",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306301.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-24T14:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306301",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_306302.json:
```json
{
    "body": "<a id='comment:89'></a>Indeed, it is not small anymore... thanks!\n\nVincent",
    "created_at": "2015-03-24T19:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306302",
    "user": "https://github.com/videlec"
}
```

<a id='comment:89'></a>Indeed, it is not small anymore... thanks!

Vincent



---

archive/issue_comments_306303.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-11T08:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306303",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306304.json:
```json
{
    "body": "<a id='comment:90'></a>On 32-bit:\n\n```\nsage -t --long src/sage/combinat/baxter_permutations.py\n**********************************************************************\nFile \"src/sage/combinat/baxter_permutations.py\", line 232, in sage.combinat.baxter_permutations.BaxterPermutations_size.cardinality\nFailed example:\n    [BaxterPermutations(n).cardinality() for n in xrange(13)]\nExpected:\n    [1, 1, 2, 6, 22, 92, 422, 2074, 10754, 58202, 326240, 1882960, 11140560]\nGot:\n    [1, 1, 2, 6, 22, 92, 422, 2074, 10754, 58202, 326240, 1882960, 11140560L]\n**********************************************************************\n1 item had failures:\n   1 of   2 in sage.combinat.baxter_permutations.BaxterPermutations_size.cardinality\n    [31 tests, 1 failure, 1.41 s]\n```\nReally, cardinality should always return Sage integers.",
    "created_at": "2015-04-11T08:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306304",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:90'></a>On 32-bit:

```
sage -t --long src/sage/combinat/baxter_permutations.py
**********************************************************************
File "src/sage/combinat/baxter_permutations.py", line 232, in sage.combinat.baxter_permutations.BaxterPermutations_size.cardinality
Failed example:
    [BaxterPermutations(n).cardinality() for n in xrange(13)]
Expected:
    [1, 1, 2, 6, 22, 92, 422, 2074, 10754, 58202, 326240, 1882960, 11140560]
Got:
    [1, 1, 2, 6, 22, 92, 422, 2074, 10754, 58202, 326240, 1882960, 11140560L]
**********************************************************************
1 item had failures:
   1 of   2 in sage.combinat.baxter_permutations.BaxterPermutations_size.cardinality
    [31 tests, 1 failure, 1.41 s]
```
Really, cardinality should always return Sage integers.



---

archive/issue_comments_306305.json:
```json
{
    "body": "Changing commit from \"e24a437155ef6a95b6e413fd5717985fc05a48a1\" to \"4f4cdad1ae7953971c1e21993f26ece509034377\"",
    "created_at": "2015-04-11T08:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306305",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e24a437155ef6a95b6e413fd5717985fc05a48a1" to "4f4cdad1ae7953971c1e21993f26ece509034377"



---

archive/issue_comments_306306.json:
```json
{
    "body": "<a id='comment:91'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T08:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306306",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:91'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306307.json:
```json
{
    "body": "<a id='comment:92'></a>Replying to [comment:90 vbraun]:\n> On 32-bit:\n> \n> ```\n> ...\n> ```\n\n\nFixed.\n\n> Really, cardinality should always return Sage integers.\n\n\nThen we are not to blame here ;-)\n\n```\nsage: parent(BaxterPermutations(3).cardinality())\nRational Field\n```\n\nVincent",
    "created_at": "2015-04-11T08:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306307",
    "user": "https://github.com/videlec"
}
```

<a id='comment:92'></a>Replying to [comment:90 vbraun]:
> On 32-bit:
> 
> ```
> ...
> ```


Fixed.

> Really, cardinality should always return Sage integers.


Then we are not to blame here ;-)

```
sage: parent(BaxterPermutations(3).cardinality())
Rational Field
```

Vincent



---

archive/issue_comments_306308.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-04-11T08:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306308",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_306309.json:
```json
{
    "body": "<a id='comment:94'></a>Replying to [comment:90 vbraun]:\n> Really, cardinality should always return Sage integers.\n\n\nSee #18159\n\nVincent",
    "created_at": "2015-04-11T19:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306309",
    "user": "https://github.com/videlec"
}
```

<a id='comment:94'></a>Replying to [comment:90 vbraun]:
> Really, cardinality should always return Sage integers.


See #18159

Vincent



---

archive/issue_comments_306310.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-12T09:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306310",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306311.json:
```json
{
    "body": "<a id='comment:95'></a>\n```\nsage -t --long --warn-long 48.0 src/sage/rings/arith.py\n**********************************************************************\nFile \"src/sage/rings/arith.py\", line 2608, in sage.rings.arith.is_squarefree\nFailed example:\n    is_squarefree(a - 3)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Non-principal ideal in factorization\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.arith.is_squarefree[13]>\", line 1, in <module>\n        is_squarefree(a - Integer(3))\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py\", line 2623, in is_squarefree\n        return all(r[1] == 1 for r in factor(n))\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py\", line 2391, in factor\n        return n.factor(**kwds)\n      File \"sage/rings/number_field/number_field_element.pyx\", line 1485, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:15877)\n        raise ArithmeticError(\"non-principal ideal in factorization\")\n    ArithmeticError: non-principal ideal in factorization\n```",
    "created_at": "2015-04-12T09:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306311",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:95'></a>
```
sage -t --long --warn-long 48.0 src/sage/rings/arith.py
**********************************************************************
File "src/sage/rings/arith.py", line 2608, in sage.rings.arith.is_squarefree
Failed example:
    is_squarefree(a - 3)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Non-principal ideal in factorization
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.arith.is_squarefree[13]>", line 1, in <module>
        is_squarefree(a - Integer(3))
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py", line 2623, in is_squarefree
        return all(r[1] == 1 for r in factor(n))
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py", line 2391, in factor
        return n.factor(**kwds)
      File "sage/rings/number_field/number_field_element.pyx", line 1485, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:15877)
        raise ArithmeticError("non-principal ideal in factorization")
    ArithmeticError: non-principal ideal in factorization
```



---

archive/issue_comments_306312.json:
```json
{
    "body": "<a id='comment:96'></a>Volker, I do not get this error. Did you test on top of 6.6.rc2 or 6.6.rc3?\n\nVincent",
    "created_at": "2015-04-12T09:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306312",
    "user": "https://github.com/videlec"
}
```

<a id='comment:96'></a>Volker, I do not get this error. Did you test on top of 6.6.rc2 or 6.6.rc3?

Vincent



---

archive/issue_comments_306313.json:
```json
{
    "body": "<a id='comment:97'></a>This comes from #17294, not from this ticket!!",
    "created_at": "2015-04-12T09:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306313",
    "user": "https://github.com/videlec"
}
```

<a id='comment:97'></a>This comes from #17294, not from this ticket!!



---

archive/issue_comments_306314.json:
```json
{
    "body": "<a id='comment:98'></a>Well life is tough :-P",
    "created_at": "2015-04-12T09:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306314",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:98'></a>Well life is tough :-P



---

archive/issue_comments_306315.json:
```json
{
    "body": "<a id='comment:99'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-15T08:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306315",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:99'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306316.json:
```json
{
    "body": "Changing commit from \"4f4cdad1ae7953971c1e21993f26ece509034377\" to \"d7e1e37f954184aa281d22c25ef9485e8b8f453c\"",
    "created_at": "2015-04-15T08:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306316",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4f4cdad1ae7953971c1e21993f26ece509034377" to "d7e1e37f954184aa281d22c25ef9485e8b8f453c"



---

archive/issue_comments_306317.json:
```json
{
    "body": "<a id='comment:0'></a>All test pass.",
    "created_at": "2015-04-15T09:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306317",
    "user": "https://github.com/videlec"
}
```

<a id='comment:0'></a>All test pass.



---

archive/issue_comments_306318.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-04-15T09:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306318",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_306319.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-15T13:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306319",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_306320.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/17852\" to \"d7e1e37f954184aa281d22c25ef9485e8b8f453c\"",
    "created_at": "2015-04-15T13:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17852#issuecomment-306320",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/17852" to "d7e1e37f954184aa281d22c25ef9485e8b8f453c"



---

archive/issue_events_050907.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-15T13:58:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17852",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17852#event-50907"
}
```
