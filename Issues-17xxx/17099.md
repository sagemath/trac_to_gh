# Issue 17099: Fix quaternion algebras over number field

archive/issues_016862.json:
```json
{
    "body": "In this [sage devel thread](https://groups.google.com/forum/#!topic/sage-devel/0AkI7IEHCIw) was mentioned the following bug\n\n```\nsage: K = NumberField(x**3 + x - 1, 'a')\nsage: D.<i,j,k> = QuaternionAlgebra(K, -1, -3)\nsage: j/3 + (2*j)/3 == j\nFalse\n```\n\nCC:  @NathanDunfield @williamstein\n\nBranch/Commit: 54970847e0a5bb67c912cec9e39400da2abb59ce\n\nReviewer: Nathan Dunfield\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17099\n\n",
    "closed_at": "2014-10-08T12:59:52Z",
    "created_at": "2014-10-04T18:49:19Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Fix quaternion algebras over number field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17099",
    "user": "https://github.com/videlec"
}
```
In this [sage devel thread](https://groups.google.com/forum/#!topic/sage-devel/0AkI7IEHCIw) was mentioned the following bug

```
sage: K = NumberField(x**3 + x - 1, 'a')
sage: D.<i,j,k> = QuaternionAlgebra(K, -1, -3)
sage: j/3 + (2*j)/3 == j
False
```

CC:  @NathanDunfield @williamstein

Branch/Commit: 54970847e0a5bb67c912cec9e39400da2abb59ce

Reviewer: Nathan Dunfield

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17099





---

archive/issue_comments_292301.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[f0f8599](https://github.com/sagemath/sagetrac-mirror/commit/f0f85996f591d9dcaa01924759f24350eede9f02)|`trac #17099: fix quaternion algebra over number fields`|\n|[5497084](https://github.com/sagemath/sagetrac-mirror/commit/54970847e0a5bb67c912cec9e39400da2abb59ce)|`trac #17099: doc`|",
    "created_at": "2014-10-04T18:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292301",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[f0f8599](https://github.com/sagemath/sagetrac-mirror/commit/f0f85996f591d9dcaa01924759f24350eede9f02)|`trac #17099: fix quaternion algebra over number fields`|
|[5497084](https://github.com/sagemath/sagetrac-mirror/commit/54970847e0a5bb67c912cec9e39400da2abb59ce)|`trac #17099: doc`|



---

archive/issue_comments_292302.json:
```json
{
    "body": "Changing commit from \"\" to \"54970847e0a5bb67c912cec9e39400da2abb59ce\"",
    "created_at": "2014-10-04T18:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292302",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "54970847e0a5bb67c912cec9e39400da2abb59ce"



---

archive/issue_comments_292303.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/17099\"",
    "created_at": "2014-10-04T18:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292303",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/17099"



---

archive/issue_comments_292304.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-04T18:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292304",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292305.json:
```json
{
    "body": "<a id='comment:2'></a>\nI looked at Vincent's patch and tested it on my own machine.  It definitely fixes the issue and the new doctest passes.   However, buildbot reports doctest failures in other modules (including ones almost certainly unconnected with the quaternion algebra code, like \"src/sage/rings/real_double.pyx\").  Am I allowed to move the status to \"positive review\" in this situation?",
    "created_at": "2014-10-05T14:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292305",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:2'></a>
I looked at Vincent's patch and tested it on my own machine.  It definitely fixes the issue and the new doctest passes.   However, buildbot reports doctest failures in other modules (including ones almost certainly unconnected with the quaternion algebra code, like "src/sage/rings/real_double.pyx").  Am I allowed to move the status to "positive review" in this situation?



---

archive/issue_comments_292306.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-06T17:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292306",
    "user": "https://github.com/NathanDunfield"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292307.json:
```json
{
    "body": "<a id='comment:3'></a>\nOk, of the five doctests that failed on buildbot, on my machine two fail in what Vincent branched from (sr.py and pbori.py) and the other three (polynomial_element.pyx, modform/numerical.py, and real_double.pyx) pass both before and after.  I think this looks good, so moving to positive review.",
    "created_at": "2014-10-06T17:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292307",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:3'></a>
Ok, of the five doctests that failed on buildbot, on my machine two fail in what Vincent branched from (sr.py and pbori.py) and the other three (polynomial_element.pyx, modform/numerical.py, and real_double.pyx) pass both before and after.  I think this looks good, so moving to positive review.



---

archive/issue_comments_292308.json:
```json
{
    "body": "<a id='comment:4'></a>\nThanks Nathan! The buildbot has some trouble... (there is a thread about that on sage devel)\n\nVincent",
    "created_at": "2014-10-06T18:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292308",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
Thanks Nathan! The buildbot has some trouble... (there is a thread about that on sage devel)

Vincent



---

archive/issue_comments_292309.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathan Dunfield\"",
    "created_at": "2014-10-06T18:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292309",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Nathan Dunfield"



---

archive/issue_comments_292310.json:
```json
{
    "body": "<a id='comment:5'></a>\nYeah, I saw that thread, which is another reason I when ahead to \"positive review\"...",
    "created_at": "2014-10-06T19:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292310",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:5'></a>
Yeah, I saw that thread, which is another reason I when ahead to "positive review"...



---

archive/issue_events_056506.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-08T12:59:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17099#event-56506"
}
```



---

archive/issue_comments_292311.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/17099\" to \"54970847e0a5bb67c912cec9e39400da2abb59ce\"",
    "created_at": "2014-10-08T12:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292311",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/17099" to "54970847e0a5bb67c912cec9e39400da2abb59ce"



---

archive/issue_comments_292312.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-08T12:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17099#issuecomment-292312",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
