# Issue 17248: Rewriting the method cardinality in the SetPartitions_setparts

archive/issues_017011.json:
```json
{
    "body": "I have changed the cardinality method of the SetPartitions_setparts class. It used to list the set partitions and now it computes the cardinality using basic enumeration formulas.\n\nAssignee: gchatel\n\nCC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton\n\nKeywords: cardinality, set partitions\n\nBranch/Commit: 8bf6e004220fe0eda092938e23f0018a54590d30\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix\n\nAuthor: Gr\u00e9gory Ch\u00e2tel\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17248\n\n",
    "closed_at": "2014-11-15T16:22:20Z",
    "created_at": "2014-10-28T23:25:05Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Rewriting the method cardinality in the SetPartitions_setparts",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17248",
    "user": "https://github.com/rodgzilla"
}
```
I have changed the cardinality method of the SetPartitions_setparts class. It used to list the set partitions and now it computes the cardinality using basic enumeration formulas.

Assignee: gchatel

CC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton

Keywords: cardinality, set partitions

Branch/Commit: 8bf6e004220fe0eda092938e23f0018a54590d30

Reviewer: Frédéric Chapoton, Vincent Delecroix

Author: Grégory Châtel

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17248





---

archive/issue_comments_291552.json:
```json
{
    "body": "Changing commit from \"\" to \"36c150e491b16b1c9662b8f43d43b36f94eeabfd\"",
    "created_at": "2014-10-28T23:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291552",
    "user": "https://github.com/rodgzilla"
}
```

Changing commit from "" to "36c150e491b16b1c9662b8f43d43b36f94eeabfd"



---

archive/issue_comments_291553.json:
```json
{
    "body": "Changing branch from \"\" to \"public/combinat/set-partition-cardinality-17248\"",
    "created_at": "2014-10-28T23:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291553",
    "user": "https://github.com/rodgzilla"
}
```

Changing branch from "" to "public/combinat/set-partition-cardinality-17248"



---

archive/issue_comments_291554.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-28T23:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291554",
    "user": "https://github.com/rodgzilla"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_291555.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-28T23:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291555",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291556.json:
```json
{
    "body": "Changing commit from \"36c150e491b16b1c9662b8f43d43b36f94eeabfd\" to \"a18a343ec6d0192f75d399047df373e5862e3208\"",
    "created_at": "2014-10-28T23:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291556",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "36c150e491b16b1c9662b8f43d43b36f94eeabfd" to "a18a343ec6d0192f75d399047df373e5862e3208"



---

archive/issue_comments_291557.json:
```json
{
    "body": "<a id='comment:3'></a>Instead of 2 variables `set_size` and `sum_subset_size`, you could use just one : `remaining_subset_size`, which is the difference.",
    "created_at": "2014-10-29T08:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291557",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>Instead of 2 variables `set_size` and `sum_subset_size`, you could use just one : `remaining_subset_size`, which is the difference.



---

archive/issue_comments_291558.json:
```json
{
    "body": "<a id='comment:4'></a>Hello,\n\nThat's cool you worked on this!\n\n1. To avoid the if/else inside your loop you can use the method `to_exp_dict` of partitions:\n\n```\nsage: S = SetPartitions(13, Partition([4,3,3,2,1]))\nsage: p = S.parts; p\n[4, 3, 3, 2, 1]\nsage: d = p.to_exp_dict(); d\n{1: 1, 2: 1, 3: 2, 4: 1}\n```\n\n2. Minor remark: if you write\n   {{{\n   a = 1\n   }}}\n   in the source code this is a Python integer. It is not bad to use it but it is confusing if you start to mix them with Sage integer which do not behave the same (especially with respect to division).\n\n3. If you use only Sage integer, there is no need to import `factorial` and `binomial` as they are methods of Sage integers\n   {{{\n   sage: 10.factorial()\n   3628800\n   sage: 10.binomial(2)\n   45\n   }}}\n   Using directly those will significantly improve the timings (the `import` takes time and the function in `sage.rings.arith` are much more complicated and ends in calling these methods).\n\n4. It would be nice to have a test like the following:\n   {{{\n   sage: SetPartitions(13).cardinality()\n   27644437\n   sage: sage: sum(SetPartitions(13,p).cardinality() for p in Partitions(13))\n   27644437\n   }}}\n\nVincent",
    "created_at": "2014-10-29T13:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291558",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hello,

That's cool you worked on this!

1. To avoid the if/else inside your loop you can use the method `to_exp_dict` of partitions:

```
sage: S = SetPartitions(13, Partition([4,3,3,2,1]))
sage: p = S.parts; p
[4, 3, 3, 2, 1]
sage: d = p.to_exp_dict(); d
{1: 1, 2: 1, 3: 2, 4: 1}
```

2. Minor remark: if you write
   {{{
   a = 1
   }}}
   in the source code this is a Python integer. It is not bad to use it but it is confusing if you start to mix them with Sage integer which do not behave the same (especially with respect to division).

3. If you use only Sage integer, there is no need to import `factorial` and `binomial` as they are methods of Sage integers
   {{{
   sage: 10.factorial()
   3628800
   sage: 10.binomial(2)
   45
   }}}
   Using directly those will significantly improve the timings (the `import` takes time and the function in `sage.rings.arith` are much more complicated and ends in calling these methods).

4. It would be nice to have a test like the following:
   {{{
   sage: SetPartitions(13).cardinality()
   27644437
   sage: sage: sum(SetPartitions(13,p).cardinality() for p in Partitions(13))
   27644437
   }}}

Vincent



---

archive/issue_comments_291559.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-29T13:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291559",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_291560.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T11:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291561.json:
```json
{
    "body": "Changing commit from \"a18a343ec6d0192f75d399047df373e5862e3208\" to \"627efa1fd7d910fb031f17c74da729557ceec588\"",
    "created_at": "2014-10-31T11:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a18a343ec6d0192f75d399047df373e5862e3208" to "627efa1fd7d910fb031f17c74da729557ceec588"



---

archive/issue_comments_291562.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks a lot for your comments, It helps me a lot to learn how Sage works.\n\nDo I need to modify the status of this ticket back to \"needs review\" ?",
    "created_at": "2014-10-31T11:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291562",
    "user": "https://github.com/rodgzilla"
}
```

<a id='comment:6'></a>Thanks a lot for your comments, It helps me a lot to learn how Sage works.

Do I need to modify the status of this ticket back to "needs review" ?



---

archive/issue_comments_291563.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 g.chatel]:\n> Thanks a lot for your comments, It helps me a lot to learn how Sage works.\n> \n> Do I need to modify the status of this ticket back to \"needs review\" ?\n\n\nYes. I did it. Basically the workflow is\n\n   - author does modif\n   - author puts in needs review\n   - reviewer complains (and possibly provides commit) and set to needs work/needs info\n\nand you repeat until agreement.\n\nVincent",
    "created_at": "2014-10-31T12:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291563",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>Replying to [comment:6 g.chatel]:
> Thanks a lot for your comments, It helps me a lot to learn how Sage works.
> 
> Do I need to modify the status of this ticket back to "needs review" ?


Yes. I did it. Basically the workflow is

   - author does modif
   - author puts in needs review
   - reviewer complains (and possibly provides commit) and set to needs work/needs info

and you repeat until agreement.

Vincent



---

archive/issue_comments_291564.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-31T12:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291564",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_291565.json:
```json
{
    "body": "Changing commit from \"627efa1fd7d910fb031f17c74da729557ceec588\" to \"8bf6e004220fe0eda092938e23f0018a54590d30\"",
    "created_at": "2014-10-31T14:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291565",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "627efa1fd7d910fb031f17c74da729557ceec588" to "8bf6e004220fe0eda092938e23f0018a54590d30"



---

archive/issue_comments_291566.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T14:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291567.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix\"",
    "created_at": "2014-10-31T14:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291567",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton, Vincent Delecroix"



---

archive/issue_comments_291568.json:
```json
{
    "body": "<a id='comment:9'></a>I made a small review commit. If you agree with my changes, you can set this to positive review.",
    "created_at": "2014-10-31T14:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291568",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>I made a small review commit. If you agree with my changes, you can set this to positive review.



---

archive/issue_comments_291569.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-31T14:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291569",
    "user": "https://github.com/rodgzilla"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:22:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17248#event-49897"
}
```



---

archive/issue_comments_291570.json:
```json
{
    "body": "Changing branch from \"public/combinat/set-partition-cardinality-17248\" to \"8bf6e004220fe0eda092938e23f0018a54590d30\"",
    "created_at": "2014-11-15T16:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291570",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/combinat/set-partition-cardinality-17248" to "8bf6e004220fe0eda092938e23f0018a54590d30"



---

archive/issue_comments_291571.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-15T16:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17248",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17248#issuecomment-291571",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
