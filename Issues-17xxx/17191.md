# Issue 17191: Poset: change rank dict to rank array

archive/issues_016954.json:
```json
{
    "body": "On `hasse_diagram.py` there is now `_rank_dict` whose keys are just numbers `0,...,n`. It can be converted to array, and it will be slightly faster then.\n\n\nBranch/Commit: cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7\n\nReviewer: Jori M\u00e4ntysalo\n\nAuthor: Nathann Cohen\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17191\n\n",
    "closed_at": "2014-11-15T16:18:33Z",
    "created_at": "2014-10-21T20:57:30Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Poset: change rank dict to rank array",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17191",
    "user": "https://github.com/jm58660"
}
```
On `hasse_diagram.py` there is now `_rank_dict` whose keys are just numbers `0,...,n`. It can be converted to array, and it will be slightly faster then.


Branch/Commit: cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7

Reviewer: Jori Mäntysalo

Author: Nathann Cohen

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17191





---

archive/issue_comments_286127.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ncohen/17191\"",
    "created_at": "2014-11-03T21:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286127",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "" to "u/ncohen/17191"



---

archive/issue_comments_286128.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-03T21:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286128",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_286129.json:
```json
{
    "body": "Changing author from \"\" to \"Nathann Cohen\"",
    "created_at": "2014-11-03T21:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286129",
    "user": "https://github.com/nathanncohen"
}
```

Changing author from "" to "Nathann Cohen"



---

archive/issue_comments_286130.json:
```json
{
    "body": "Changing commit from \"\" to \"08727b253f8ecc25285f2e0c01a21424868bcf63\"",
    "created_at": "2014-11-03T21:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286130",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "08727b253f8ecc25285f2e0c01a21424868bcf63"



---

archive/issue_comments_286131.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[08727b2](https://github.com/sagemath/sagetrac-mirror/commit/08727b253f8ecc25285f2e0c01a21424868bcf63)|`trac #17191: Poset: change rank dict to rank array`|",
    "created_at": "2014-11-03T21:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286131",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[08727b2](https://github.com/sagemath/sagetrac-mirror/commit/08727b253f8ecc25285f2e0c01a21424868bcf63)|`trac #17191: Poset: change rank dict to rank array`|



---

archive/issue_comments_286132.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-11-04T09:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286132",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_286133.json:
```json
{
    "body": "<a id='comment:3'></a>\nAbout\n\n```\nreturn lambda x:self._rank[x] # the rank function is just the getitem of the dict\n```\n\nThe comment string should be changed, \"dict\" -> \"list\". Also why bother with lambda function, because lists also has a `__getitem__`?\n\nLine\n\n```\nreturn [rank_fcn[i] for i in range(self.order())]\n```\n\nseems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this.",
    "created_at": "2014-11-04T09:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286133",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:3'></a>
About

```
return lambda x:self._rank[x] # the rank function is just the getitem of the dict
```

The comment string should be changed, "dict" -> "list". Also why bother with lambda function, because lists also has a `__getitem__`?

Line

```
return [rank_fcn[i] for i in range(self.order())]
```

seems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this.



---

archive/issue_comments_286134.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jori M\u00e4ntysalo\"",
    "created_at": "2014-11-04T09:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286134",
    "user": "https://github.com/jm58660"
}
```

Changing reviewer from "" to "Jori Mäntysalo"



---

archive/issue_comments_286135.json:
```json
{
    "body": "<a id='comment:4'></a>\nYooo !\n\n> {{{\n> return lambda x:self._rank[x] # the rank function is just the getitem of the dict\n> }}}\n> \n> The comment string should be changed, \"dict\" -> \"list\". Also why bother with lambda function, because lists also has a `__getitem__`?\n\n\nYou are right.\n\n> {{{\n> return [rank_fcn[i] for i in range(self.order())]\n> }}}\n> \n> seems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this. \n\n\nBecause `rank_fcn` is a dictionary, not a list, and because it should be a dictionary in this function (because of lines like 'if x in rank_fcn').\n\nNathann",
    "created_at": "2014-11-04T09:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286135",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Yooo !

> {{{
> return lambda x:self._rank[x] # the rank function is just the getitem of the dict
> }}}
> 
> The comment string should be changed, "dict" -> "list". Also why bother with lambda function, because lists also has a `__getitem__`?


You are right.

> {{{
> return [rank_fcn[i] for i in range(self.order())]
> }}}
> 
> seems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this. 


Because `rank_fcn` is a dictionary, not a list, and because it should be a dictionary in this function (because of lines like 'if x in rank_fcn').

Nathann



---

archive/issue_comments_286136.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-11-04T09:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286136",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_286137.json:
```json
{
    "body": "Changing commit from \"08727b253f8ecc25285f2e0c01a21424868bcf63\" to \"45fc474b60ea8de4d76f4aa98c64b9b2765743fe\"",
    "created_at": "2014-11-04T09:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "08727b253f8ecc25285f2e0c01a21424868bcf63" to "45fc474b60ea8de4d76f4aa98c64b9b2765743fe"



---

archive/issue_comments_286138.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[45fc474](https://github.com/sagemath/sagetrac-mirror/commit/45fc474b60ea8de4d76f4aa98c64b9b2765743fe)|`trac #17191: Reviewer's comments`|",
    "created_at": "2014-11-04T09:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[45fc474](https://github.com/sagemath/sagetrac-mirror/commit/45fc474b60ea8de4d76f4aa98c64b9b2765743fe)|`trac #17191: Reviewer's comments`|



---

archive/issue_comments_286139.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-04T09:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286139",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_064411.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-11-04T09:53:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17191#event-64411"
}
```



---

archive/issue_comments_286140.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [ncohen](#comment%3A4):\n\n> > {{{\n> > return [rank_fcn[i] for i in range(self.order())]\n> > }}}\n> > \n> > seems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this. \n\n> \n> Because `rank_fcn` is a dictionary, not a list, and because it should be a dictionary in this function (because of lines like 'if x in rank_fcn').\n\n\nAh, true. This could also start with `rank_fcn=[None]*self.order()` instead of `rank_fcn={}`, but the current code seems to be cleaner.\n\nI think this is ready for production, so I also changed milestone with status.",
    "created_at": "2014-11-04T09:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286140",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:7'></a>
Replying to [ncohen](#comment%3A4):

> > {{{
> > return [rank_fcn[i] for i in range(self.order())]
> > }}}
> > 
> > seems strange --- isn't that just same as `return rank_fcn` or `return copy(rank_fcn)`? Or maybe I didn't understand this. 

> 
> Because `rank_fcn` is a dictionary, not a list, and because it should be a dictionary in this function (because of lines like 'if x in rank_fcn').


Ah, true. This could also start with `rank_fcn=[None]*self.order()` instead of `rank_fcn={}`, but the current code seems to be cleaner.

I think this is ready for production, so I also changed milestone with status.



---

archive/issue_comments_286141.json:
```json
{
    "body": "<a id='comment:8'></a>\nYo !\n\n> Ah, true. This could also start with `rank_fcn=[None]*self.order()` instead of `rank_fcn={}`, but the current code seems to be cleaner.\n\n\nRight again. And I could have turned the 'if x in rank_fcn' into 'if rank_fcn[x] is Null'... Stupid me.\n\n> I think this is ready for production, so I also changed milestone with status.\n\n\nI hope that you do not mind: I am going to add a commit in a second to do that properly with a list in the function too. Not very important, but worth doing anyway.\n\nNathann",
    "created_at": "2014-11-04T09:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286141",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
Yo !

> Ah, true. This could also start with `rank_fcn=[None]*self.order()` instead of `rank_fcn={}`, but the current code seems to be cleaner.


Right again. And I could have turned the 'if x in rank_fcn' into 'if rank_fcn[x] is Null'... Stupid me.

> I think this is ready for production, so I also changed milestone with status.


I hope that you do not mind: I am going to add a commit in a second to do that properly with a list in the function too. Not very important, but worth doing anyway.

Nathann



---

archive/issue_comments_286142.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-11-04T10:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286142",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_286143.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[cc8fd43](https://github.com/sagemath/sagetrac-mirror/commit/cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7)|`trac #17191: Doing the job properly`|",
    "created_at": "2014-11-04T10:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286143",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[cc8fd43](https://github.com/sagemath/sagetrac-mirror/commit/cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7)|`trac #17191: Doing the job properly`|



---

archive/issue_comments_286144.json:
```json
{
    "body": "Changing commit from \"45fc474b60ea8de4d76f4aa98c64b9b2765743fe\" to \"cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7\"",
    "created_at": "2014-11-04T10:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "45fc474b60ea8de4d76f4aa98c64b9b2765743fe" to "cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7"



---

archive/issue_comments_286145.json:
```json
{
    "body": "<a id='comment:10'></a>\nWorks.",
    "created_at": "2014-11-04T10:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286145",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:10'></a>
Works.



---

archive/issue_comments_286146.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-04T10:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286146",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_286147.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks !\n\nNathann",
    "created_at": "2014-11-04T10:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286147",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>
Thanks !

Nathann



---

archive/issue_comments_286148.json:
```json
{
    "body": "Changing branch from \"u/ncohen/17191\" to \"cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7\"",
    "created_at": "2014-11-15T16:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286148",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/ncohen/17191" to "cc8fd43ab6d177faa74fd90b9979d5ff17da4bb7"



---

archive/issue_comments_286149.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-15T16:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17191#issuecomment-286149",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_064412.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:18:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17191",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17191#event-64412"
}
```
