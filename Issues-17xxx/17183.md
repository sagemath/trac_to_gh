# Issue 17183: Yet another abs_integrate trig integral problem

archive/issues_016946.json:
```json
{
    "body": "Keywords: abs_integrate\n\nSee [this ask.sagemath question](http://ask.sagemath.org/question/24532/).  Original report is \n\n```\nsage: F = sqrt((cos(x) - 1)^2 + sin(x)^2)\nsage: F.integrate(x, 0, 2*pi)\n0\n```\nbut the answer should be 8.\n\nEDIT: related\n\n```\nsage: F.integrate(x, 0, pi)\n4\nsage: F.integrate(x, pi, 2*pi)\n-4\n```\nand the primitive is wrong:\n\n```\nsage: F.integrate(x)\n-4/sqrt(sin(x)^2/(cos(x) + 1)^2 + 1)\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/17183\n\n",
    "created_at": "2014-10-20T13:25:49Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Yet another abs_integrate trig integral problem",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17183",
    "user": "https://github.com/kcrisman"
}
```
Keywords: abs_integrate

See [this ask.sagemath question](http://ask.sagemath.org/question/24532/).  Original report is 

```
sage: F = sqrt((cos(x) - 1)^2 + sin(x)^2)
sage: F.integrate(x, 0, 2*pi)
0
```
but the answer should be 8.

EDIT: related

```
sage: F.integrate(x, 0, pi)
4
sage: F.integrate(x, pi, 2*pi)
-4
```
and the primitive is wrong:

```
sage: F.integrate(x)
-4/sqrt(sin(x)^2/(cos(x) + 1)^2 + 1)
```

Issue created by migration from https://trac.sagemath.org/ticket/17183





---

archive/issue_comments_224276.json:
```json
{
    "body": "Upstream https://sourceforge.net/p/maxima/bugs/2823/",
    "created_at": "2014-10-20T13:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224276",
    "user": "https://github.com/kcrisman"
}
```

Upstream https://sourceforge.net/p/maxima/bugs/2823/



---

archive/issue_comments_224277.json:
```json
{
    "body": "See also #12731.",
    "created_at": "2014-12-08T15:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224277",
    "user": "https://github.com/kcrisman"
}
```

See also #12731.



---

archive/issue_comments_224278.json:
```json
{
    "body": "I  suppose, this ticket needs a stopgap?",
    "created_at": "2015-01-30T19:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224278",
    "user": "https://trac.sagemath.org/admin/accounts/users/jakobkroeker"
}
```

I  suppose, this ticket needs a stopgap?



---

archive/issue_comments_224279.json:
```json
{
    "body": "Maybe all the `abs_integrate` ones do - see #12731.  But I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.  So there would have to be some way to limit its applicability.  I think that is why I never worked on stopgaps; the stuff I was working on doesn't lend itself to easily pointing that out, other than having Sage itself start with a disclaimer \"warning: computer math sometimes has errors\".",
    "created_at": "2015-01-30T20:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224279",
    "user": "https://github.com/kcrisman"
}
```

Maybe all the `abs_integrate` ones do - see #12731.  But I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.  So there would have to be some way to limit its applicability.  I think that is why I never worked on stopgaps; the stuff I was working on doesn't lend itself to easily pointing that out, other than having Sage itself start with a disclaimer "warning: computer math sometimes has errors".



---

archive/issue_comments_224280.json:
```json
{
    "body": ">Sage itself start with a disclaimer \"warning: computer math sometimes has errors\"\n\n\n+1\n\nwhich in additional links to Mathematically Wrong Answers:\nhttp://trac.sagemath.org/query?status=new&status=needs_work&status=needs_review&status=needs_info&type=defect&stopgaps=!&max=0&order=id\n\nI would support that (to warn the greenhorns), or will that have too much opposition?\n``\n\n> but I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.\n\n\nAgree, so what about showing a stopgap warning only once per user+computer+sageVersion or similar?\n( otherwise the user has explicitly request regular stopgap warnings)",
    "created_at": "2015-01-30T21:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224280",
    "user": "https://trac.sagemath.org/admin/accounts/users/jakobkroeker"
}
```

>Sage itself start with a disclaimer "warning: computer math sometimes has errors"


+1

which in additional links to Mathematically Wrong Answers:
http://trac.sagemath.org/query?status=new&status=needs_work&status=needs_review&status=needs_info&type=defect&stopgaps=!&max=0&order=id

I would support that (to warn the greenhorns), or will that have too much opposition?
``

> but I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.


Agree, so what about showing a stopgap warning only once per user+computer+sageVersion or similar?
( otherwise the user has explicitly request regular stopgap warnings)



---

archive/issue_comments_224281.json:
```json
{
    "body": "These are questions above my pay grade, as I did not institute the stopgap system.  Again, if there is a way to invoke this when `abs_integrate` is used, that would be fine - we already have a way to only selectively load packages, but once loaded, I'm not sure we can \"unload\" it.  But continue that discussion at #12731.",
    "created_at": "2015-01-31T02:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224281",
    "user": "https://github.com/kcrisman"
}
```

These are questions above my pay grade, as I did not institute the stopgap system.  Again, if there is a way to invoke this when `abs_integrate` is used, that would be fine - we already have a way to only selectively load packages, but once loaded, I'm not sure we can "unload" it.  But continue that discussion at #12731.



---

archive/issue_comments_224282.json:
```json
{
    "body": "Changing keywords from \"\" to \"abs_integrate\".",
    "created_at": "2019-05-17T17:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224282",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "abs_integrate".



---

archive/issue_comments_224283.json:
```json
{
    "body": "Possibly related:\n\n```\nsage: integrate(sqrt(1/(2-cos(x))), (x, 0, pi))\n0\n```\nAccording to Mathematica, the correct result should be `2*elliptic_kc(-2)`.",
    "created_at": "2019-05-18T15:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224283",
    "user": "https://github.com/mwageringel"
}
```

Possibly related:

```
sage: integrate(sqrt(1/(2-cos(x))), (x, 0, pi))
0
```
According to Mathematica, the correct result should be `2*elliptic_kc(-2)`.



---

archive/issue_comments_224284.json:
```json
{
    "body": "See also https://groups.google.com/g/sage-devel/c/h50LZVLVQI4.",
    "created_at": "2020-08-06T08:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224284",
    "user": "https://github.com/mwageringel"
}
```

See also https://groups.google.com/g/sage-devel/c/h50LZVLVQI4.



---

archive/issue_comments_224285.json:
```json
{
    "body": "The issue with the primitive of F may come from our choice of \"domain: complex\" in maxima.\n\nUsing `maxima(\"domain : real;\")` gives another answer, that could be better.\n\nEDIT: this seems to give in fact the same wrong primitive.\n\nfricas and giac also gives other wrong primitives, not even continuous ? Sigh :(",
    "created_at": "2021-06-06T08:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224285",
    "user": "https://github.com/fchapoton"
}
```

The issue with the primitive of F may come from our choice of "domain: complex" in maxima.

Using `maxima("domain : real;")` gives another answer, that could be better.

EDIT: this seems to give in fact the same wrong primitive.

fricas and giac also gives other wrong primitives, not even continuous ? Sigh :(



---

archive/issue_comments_224286.json:
```json
{
    "body": "Apparently fixed [upstream](https://sourceforge.net/p/maxima/code/ci/3ca4235b8206b44e6670788696e6614b616f8994/).",
    "created_at": "2021-11-15T11:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17183",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17183#issuecomment-224286",
    "user": "https://github.com/kcrisman"
}
```

Apparently fixed [upstream](https://sourceforge.net/p/maxima/code/ci/3ca4235b8206b44e6670788696e6614b616f8994/).
