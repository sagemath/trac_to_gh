# Issue 17058: Add abelian_vectors and abelian_complexity method to finite words

archive/issues_016821.json:
```json
{
    "body": "Add abelian_vectors and abelian_complexity method to finite words\n\nFollowing the comment made by Jacques Sakarovitch during Journ\u00e9es montoises 2014 in Nancy, we deprecate the `parikh_vector` method:\n\n```\nparikh_vector = deprecated_function_alias(17058, abelian_vector)\n```\n\nMoreover, we deprecate the argument `alphabet` for the method `abelian_vector` method because it was a bad design choice to allow to specify the alphabet in such a method. User should specify the alphabet in the parent.\n\nCC:  @videlec @staroste\n\nBranch/Commit: 2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d\n\nReviewer: Vincent Delecroix\n\nAuthor: S\u00e9bastien Labb\u00e9\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/17058\n\n",
    "closed_at": "2014-10-03T22:37:30Z",
    "created_at": "2014-09-27T20:56:55Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Add abelian_vectors and abelian_complexity method to finite words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17058",
    "user": "https://github.com/seblabbe"
}
```
Add abelian_vectors and abelian_complexity method to finite words

Following the comment made by Jacques Sakarovitch during Journées montoises 2014 in Nancy, we deprecate the `parikh_vector` method:

```
parikh_vector = deprecated_function_alias(17058, abelian_vector)
```

Moreover, we deprecate the argument `alphabet` for the method `abelian_vector` method because it was a bad design choice to allow to specify the alphabet in such a method. User should specify the alphabet in the parent.

CC:  @videlec @staroste

Branch/Commit: 2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d

Reviewer: Vincent Delecroix

Author: Sébastien Labbé

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/17058





---

archive/issue_comments_287141.json:
```json
{
    "body": "Changing branch from \"\" to \"u/slabbe/17058\"",
    "created_at": "2014-09-27T21:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287141",
    "user": "https://github.com/seblabbe"
}
```

Changing branch from "" to "u/slabbe/17058"



---

archive/issue_comments_287142.json:
```json
{
    "body": "Changing commit from \"\" to \"ea0257cb2b026ab2ffe366a4d599e084d074a58c\"",
    "created_at": "2014-09-27T21:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287142",
    "user": "https://github.com/seblabbe"
}
```

Changing commit from "" to "ea0257cb2b026ab2ffe366a4d599e084d074a58c"



---

archive/issue_comments_287143.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-27T21:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287143",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_287144.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2014-09-27T21:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287144",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_287145.json:
```json
{
    "body": "<a id='comment:3'></a>Could we use this ticket to deprecate `parikh_vector` and use `abelianization` or `abelian_image` instead?\n\nVincent",
    "created_at": "2014-09-28T08:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287145",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Could we use this ticket to deprecate `parikh_vector` and use `abelianization` or `abelian_image` instead?

Vincent



---

archive/issue_comments_287146.json:
```json
{
    "body": "<a id='comment:4'></a>Hello,\n\nIt is weird to call a method `alphabet` on the word which is not the alphabet of the parent. Moreover, there is already the method `letters` which does the job. So please use `letters` if you need it.\n\nNow about your design choice, if the alphabet of the parent is {a,b,c} and my word is abbab then the abelianization must be a vector of length 3. With your branch:\n\n```\nsage: W = Words([0,1,2])\nsage: w = W([0,1,1,0,1,2,0,2,0,2])\nsage: w.abelian_vectors(3)\n{(1, 0, 2), (1, 1, 1), (1, 2, 0), (2, 0, 1)}\nsage: w[:5].abelian_vectors(3)  # word on 0,1\n{(1, 2)}\nsage: w[5:].abelian_vectors(3)  # word on 0,2\n{(1, 2), (2, 1)}\n```\nwhich is completely crazy!\n\nFor the algorithm, it would be faster to deal only with integers because\n\n```\nsage: tuple(my_list)\n```\nis much faster than\n\n```\nsage: tuple(my_dict[a] for a in alphabet)\n```\ni.e. I would initialize `abelian` as a list of length the cardinality of the alphabet and then\n\n```\n    abelian[rank[start.next()]] += 1\n    abelian[rank[stop.next()]]  -= 1\n    S.add(tuple(abelian))\n```\nwhere `rank` would be a dictionnary `letter -> index`.\n\nCheers\nVincent",
    "created_at": "2014-09-28T09:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287146",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hello,

It is weird to call a method `alphabet` on the word which is not the alphabet of the parent. Moreover, there is already the method `letters` which does the job. So please use `letters` if you need it.

Now about your design choice, if the alphabet of the parent is {a,b,c} and my word is abbab then the abelianization must be a vector of length 3. With your branch:

```
sage: W = Words([0,1,2])
sage: w = W([0,1,1,0,1,2,0,2,0,2])
sage: w.abelian_vectors(3)
{(1, 0, 2), (1, 1, 1), (1, 2, 0), (2, 0, 1)}
sage: w[:5].abelian_vectors(3)  # word on 0,1
{(1, 2)}
sage: w[5:].abelian_vectors(3)  # word on 0,2
{(1, 2), (2, 1)}
```
which is completely crazy!

For the algorithm, it would be faster to deal only with integers because

```
sage: tuple(my_list)
```
is much faster than

```
sage: tuple(my_dict[a] for a in alphabet)
```
i.e. I would initialize `abelian` as a list of length the cardinality of the alphabet and then

```
    abelian[rank[start.next()]] += 1
    abelian[rank[stop.next()]]  -= 1
    S.add(tuple(abelian))
```
where `rank` would be a dictionnary `letter -> index`.

Cheers
Vincent



---

archive/issue_comments_287147.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-28T09:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287147",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_287148.json:
```json
{
    "body": "<a id='comment:5'></a>I often get the following error while working on this ticket. Is it the same issue that was fixed in #17056?\n\n```\nsage -t finite_word.py\n**********************************************************************\nFile \"finite_word.py\", line 6053, in sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions\nFailed example:\n    w.apply_permutation_to_positions(PermutationGroupElement([2,1,4,3]))\nExpected:\n    word: badc\nGot:\n    python(17649) malloc: *** error for object 0xff37a70: double free\n    *** set a breakpoint in malloc_error_break to debug\n    word: badc\n**********************************************************************\n1 item had failures:\n   1 of   8 in sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions\n    [1142 tests, 1 failure, 16.64 s]\n----------------------------------------------------------------------\nsage -t finite_word.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2014-09-28T20:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287148",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'></a>I often get the following error while working on this ticket. Is it the same issue that was fixed in #17056?

```
sage -t finite_word.py
**********************************************************************
File "finite_word.py", line 6053, in sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions
Failed example:
    w.apply_permutation_to_positions(PermutationGroupElement([2,1,4,3]))
Expected:
    word: badc
Got:
    python(17649) malloc: *** error for object 0xff37a70: double free
    *** set a breakpoint in malloc_error_break to debug
    word: badc
**********************************************************************
1 item had failures:
   1 of   8 in sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions
    [1142 tests, 1 failure, 16.64 s]
----------------------------------------------------------------------
sage -t finite_word.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_287149.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n+We also add the following deprecation:\n \n+```\n+parikh_vector = deprecated_function_alias(17058, abelian_vector)\n+```\n``````\n",
    "created_at": "2014-09-28T20:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287149",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
+We also add the following deprecation:
 
+```
+parikh_vector = deprecated_function_alias(17058, abelian_vector)
+```
``````




---

archive/issue_comments_287150.json:
```json
{
    "body": "Changing commit from \"ea0257cb2b026ab2ffe366a4d599e084d074a58c\" to \"4072235c4b5b0b57d700afeecfd1da1cdf26e2c4\"",
    "created_at": "2014-09-28T20:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287150",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ea0257cb2b026ab2ffe366a4d599e084d074a58c" to "4072235c4b5b0b57d700afeecfd1da1cdf26e2c4"



---

archive/issue_comments_287151.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-28T20:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287152.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-28T20:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287152",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287153.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [slabbe](#comment%3A5):\n> I often get the following error while working on this ticket. Is it the same issue that was fixed in #17056?\n\n\nYes it is! It is quite strange that this did not occur before.",
    "created_at": "2014-09-28T21:28:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287153",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Replying to [slabbe](#comment%3A5):
> I often get the following error while working on this ticket. Is it the same issue that was fixed in #17056?


Yes it is! It is quite strange that this did not occur before.



---

archive/issue_comments_287154.json:
```json
{
    "body": "<a id='comment:10'></a>Hi,\n\nI got\n\n```\nsage: w = Word([0,1,0])\nsage: w.abelian_complexity(5)\nTraceback (most recent call last):\n...\nStopIteration: \n```\nwhere I would expect a `0`.\n\nstupid coercion is around\n\n```\nsage: timeit(\"1 < Infinity\")\n625 loops, best of 3: 12.6 \u00b5s per loop\nsage: timeit(\"1 < float('inf')\")\n625 loops, best of 3: 803 ns per loop\n```\nbut I guess it is not critical here.\n\nWhat do you think of\n\n```\nsage: from itertools import count\nsage: w = Word(count(), alphabet=NN)\nsage: w[:2].abelian_vectors(2)\n{(1, 1)}\nsage: w[:3].abelian_vectors(2)\n{(0, 1, 1), (1, 1, 0)}\nsage: w[:4].abelian_vectors(2)\n{(0, 0, 1, 1), (0, 1, 1, 0), (1, 1, 0, 0)}\n```\nI think this is very bad. I would rather raise an Error when the alphabet is infinite (in the very same way `abelian_vector` does, by the way). But at least `.abelian_complexity()` gets right.\n\nAre you sure that the ``@`cached_method` is needed on `.letters()`? It seems used only when the alphabet is infinite... in which case the user is doing something wrong.\n\nThe convention for the header of methods is \"Return bla\" instead of \"Returns bla\". See [developer guide](http://www.sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx) about the header:\n\n```\nA one-sentence description of the function, followed by a blank line and\nending in a period. It prescribes the function or method\u2019s effect as a\ncommand (\u201cDo this\u201d, \u201cReturn that\u201d), not as a description; e.g. don\u2019t\nwrite \u201cReturns the pathname ...\u201d.\n```\n\nBe careful, you introduced several trailing whitespaces.\n\nVincent",
    "created_at": "2014-09-28T22:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287154",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>Hi,

I got

```
sage: w = Word([0,1,0])
sage: w.abelian_complexity(5)
Traceback (most recent call last):
...
StopIteration: 
```
where I would expect a `0`.

stupid coercion is around

```
sage: timeit("1 < Infinity")
625 loops, best of 3: 12.6 µs per loop
sage: timeit("1 < float('inf')")
625 loops, best of 3: 803 ns per loop
```
but I guess it is not critical here.

What do you think of

```
sage: from itertools import count
sage: w = Word(count(), alphabet=NN)
sage: w[:2].abelian_vectors(2)
{(1, 1)}
sage: w[:3].abelian_vectors(2)
{(0, 1, 1), (1, 1, 0)}
sage: w[:4].abelian_vectors(2)
{(0, 0, 1, 1), (0, 1, 1, 0), (1, 1, 0, 0)}
```
I think this is very bad. I would rather raise an Error when the alphabet is infinite (in the very same way `abelian_vector` does, by the way). But at least `.abelian_complexity()` gets right.

Are you sure that the ``@`cached_method` is needed on `.letters()`? It seems used only when the alphabet is infinite... in which case the user is doing something wrong.

The convention for the header of methods is "Return bla" instead of "Returns bla". See [developer guide](http://www.sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx) about the header:

```
A one-sentence description of the function, followed by a blank line and
ending in a period. It prescribes the function or method’s effect as a
command (“Do this”, “Return that”), not as a description; e.g. don’t
write “Returns the pathname ...”.
```

Be careful, you introduced several trailing whitespaces.

Vincent



---

archive/issue_comments_287155.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-28T22:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287155",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_287156.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n-We also add the following deprecation:\n+Add abelian_vectors and abelian_complexity method to finite words\n+\n+Following the comment made by Jacques Sakarovitch during Journ\u00e9es montoises 2014 in Nancy, we deprecate the `parikh_vector` method:\n \n ```\n parikh_vector = deprecated_function_alias(17058, abelian_vector)\n ```\n+\n+Moreover, we deprecate the argument `alphabet` for the method `abelian_vector` method because it was a bad design choice to allow to specify the alphabet in such a method. User should specify the alphabet in the parent.\n``````\n",
    "created_at": "2014-09-29T20:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287156",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
-We also add the following deprecation:
+Add abelian_vectors and abelian_complexity method to finite words
+
+Following the comment made by Jacques Sakarovitch during Journées montoises 2014 in Nancy, we deprecate the `parikh_vector` method:
 
 ```
 parikh_vector = deprecated_function_alias(17058, abelian_vector)
 ```
+
+Moreover, we deprecate the argument `alphabet` for the method `abelian_vector` method because it was a bad design choice to allow to specify the alphabet in such a method. User should specify the alphabet in the parent.
``````




---

archive/issue_comments_287157.json:
```json
{
    "body": "Changing commit from \"4072235c4b5b0b57d700afeecfd1da1cdf26e2c4\" to \"ac56d6801c2f2d525b67e7e0becfd1f1ab5d950b\"",
    "created_at": "2014-09-29T20:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287157",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4072235c4b5b0b57d700afeecfd1da1cdf26e2c4" to "ac56d6801c2f2d525b67e7e0becfd1f1ab5d950b"



---

archive/issue_comments_287158.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-29T20:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287158",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287159.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-29T20:33:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287159",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287160.json:
```json
{
    "body": "<a id='comment:14'></a>I pushed a commit at `u/vdelecroix/17058` with few optimizations and the things that I describe below.\n\nI do not feel very comfortable with your note and the examples. The reasonable way to get the Abelian complexity from 0 to n is actually to build the language. Certainly not to call `w.abelian_complexity` n times. A version of the suffix tree in which we can compute things on the fly would be really helpful (as it is trivial to update the abelian vectors along the tree)! Do you mind if we remove the `.. NOTE:`?\n\nFor the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.\n\nAs a sided note, I guess we have a global problem with alphabet managed at the level of word\n\n```\nsage: W = Words()\nsage: w = W([0,1,2,3,4,5,6,7,8])\nsage: w[:4].to_integer_list()\n[0, 1, 2, 3]\nsage: w[1:5].to_integer_list()\n[0, 1, 2, 3]\n```\n\nTell me what you think.\n\nVincent",
    "created_at": "2014-09-29T20:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287160",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>I pushed a commit at `u/vdelecroix/17058` with few optimizations and the things that I describe below.

I do not feel very comfortable with your note and the examples. The reasonable way to get the Abelian complexity from 0 to n is actually to build the language. Certainly not to call `w.abelian_complexity` n times. A version of the suffix tree in which we can compute things on the fly would be really helpful (as it is trivial to update the abelian vectors along the tree)! Do you mind if we remove the `.. NOTE:`?

For the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.

As a sided note, I guess we have a global problem with alphabet managed at the level of word

```
sage: W = Words()
sage: w = W([0,1,2,3,4,5,6,7,8])
sage: w[:4].to_integer_list()
[0, 1, 2, 3]
sage: w[1:5].to_integer_list()
[0, 1, 2, 3]
```

Tell me what you think.

Vincent



---

archive/issue_comments_287161.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-09-29T20:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287161",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_287162.json:
```json
{
    "body": "<a id='comment:15'></a>> Do you mind if we remove the `.. NOTE:`?\n\n\nOkay.\n\n> For the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.\n\n\nI thought the INPUT block was always necessary...\n\n> As a sided note, I guess we have a global problem with alphabet managed at the level of word. Tell me what you think.\n\n\nThere are a lot of methods of `FiniteWord_class` that do not need the existence of a parent alphabet. That was one of the first clean up that we did back in 2009: get rid of things that were not necesary.\n\nBut then, there are also a lot of methods of `FiniteWord_class` that *needs* an alphabet. At that time, we choose to allow the user to use such methods without having previously defined an alphabet. But, I think we were wrong. If a method needs an alphabet to work reasonably, we should just raise an error if there were no alphabet assigned to the parent. This is in accordance to the way I fixed the `abelian_vector` method and added a deprecation to the alphabet input.",
    "created_at": "2014-09-29T21:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287162",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:15'></a>> Do you mind if we remove the `.. NOTE:`?


Okay.

> For the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.


I thought the INPUT block was always necessary...

> As a sided note, I guess we have a global problem with alphabet managed at the level of word. Tell me what you think.


There are a lot of methods of `FiniteWord_class` that do not need the existence of a parent alphabet. That was one of the first clean up that we did back in 2009: get rid of things that were not necesary.

But then, there are also a lot of methods of `FiniteWord_class` that *needs* an alphabet. At that time, we choose to allow the user to use such methods without having previously defined an alphabet. But, I think we were wrong. If a method needs an alphabet to work reasonably, we should just raise an error if there were no alphabet assigned to the parent. This is in accordance to the way I fixed the `abelian_vector` method and added a deprecation to the alphabet input.



---

archive/issue_comments_287163.json:
```json
{
    "body": "Changing commit from \"ac56d6801c2f2d525b67e7e0becfd1f1ab5d950b\" to \"a749bc38dc4ed94942e22e0af11686609c0db669\"",
    "created_at": "2014-09-30T07:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287163",
    "user": "https://github.com/seblabbe"
}
```

Changing commit from "ac56d6801c2f2d525b67e7e0becfd1f1ab5d950b" to "a749bc38dc4ed94942e22e0af11686609c0db669"



---

archive/issue_comments_287164.json:
```json
{
    "body": "<a id='comment:16'></a>New commits:",
    "created_at": "2014-09-30T07:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287164",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:16'></a>New commits:



---

archive/issue_comments_287165.json:
```json
{
    "body": "Changing branch from \"u/slabbe/17058\" to \"u/vdelecroix/17058\"",
    "created_at": "2014-09-30T07:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287165",
    "user": "https://github.com/seblabbe"
}
```

Changing branch from "u/slabbe/17058" to "u/vdelecroix/17058"



---

archive/issue_comments_287166.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [slabbe](#comment%3A15):\n> > Do you mind if we remove the `.. NOTE:`?\n\n> \n> Okay.\n\n\nCool!\n \n> > For the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.\n\n> \n> I thought the INPUT block was always necessary...\n\n\nNone of the section of the docstring is mandatory except `EXAMPLES` or `TESTS`. In particular a function whose header is `Return the number of factors of length n` does not need an `INPUT` nor an `OUTPUT` section. The docstring are only used for documentation (and doctesting): the simplest the best!\n\nI am having a last look.\n\nVincent",
    "created_at": "2014-09-30T08:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287166",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>Replying to [slabbe](#comment%3A15):
> > Do you mind if we remove the `.. NOTE:`?

> 
> Okay.


Cool!
 
> > For the `INPUT` section. It is needed only if the arguments are not described in the documentation or if they are quite subtle. And whatever is inside `self` can not appear there.

> 
> I thought the INPUT block was always necessary...


None of the section of the docstring is mandatory except `EXAMPLES` or `TESTS`. In particular a function whose header is `Return the number of factors of length n` does not need an `INPUT` nor an `OUTPUT` section. The docstring are only used for documentation (and doctesting): the simplest the best!

I am having a last look.

Vincent



---

archive/issue_comments_287167.json:
```json
{
    "body": "Changing commit from \"a749bc38dc4ed94942e22e0af11686609c0db669\" to \"572859135dcbcb9be6a11fa6efb11b4fabddcf3b\"",
    "created_at": "2014-09-30T08:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a749bc38dc4ed94942e22e0af11686609c0db669" to "572859135dcbcb9be6a11fa6efb11b4fabddcf3b"



---

archive/issue_comments_287168.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-30T08:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287169.json:
```json
{
    "body": "<a id='comment:19'></a>Hello,\n\nA last commit for optimization, including a much faster implementation of `.letters()` in `WordDatatype_char`. If you like it, you can then set to positive review.\n\nVincent",
    "created_at": "2014-09-30T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287169",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>Hello,

A last commit for optimization, including a much faster implementation of `.letters()` in `WordDatatype_char`. If you like it, you can then set to positive review.

Vincent



---

archive/issue_comments_287170.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-09-30T19:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287170",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_287171.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/17058\" to \"u/slabbe/17058\"",
    "created_at": "2014-09-30T20:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287171",
    "user": "https://github.com/seblabbe"
}
```

Changing branch from "u/vdelecroix/17058" to "u/slabbe/17058"



---

archive/issue_comments_287172.json:
```json
{
    "body": "Changing commit from \"572859135dcbcb9be6a11fa6efb11b4fabddcf3b\" to \"8c24b064335445465c708efdc257be53eb7be874\"",
    "created_at": "2014-09-30T20:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287172",
    "user": "https://github.com/seblabbe"
}
```

Changing commit from "572859135dcbcb9be6a11fa6efb11b4fabddcf3b" to "8c24b064335445465c708efdc257be53eb7be874"



---

archive/issue_comments_287173.json:
```json
{
    "body": "<a id='comment:21'></a>New commits:",
    "created_at": "2014-09-30T20:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287173",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:21'></a>New commits:



---

archive/issue_comments_287174.json:
```json
{
    "body": "Changing author from \"\" to \"S\u00e9bastien Labb\u00e9\"",
    "created_at": "2014-09-30T20:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287174",
    "user": "https://github.com/seblabbe"
}
```

Changing author from "" to "Sébastien Labbé"



---

archive/issue_comments_287175.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-30T20:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287175",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_287176.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2014-09-30T20:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287176",
    "user": "https://github.com/seblabbe"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_287177.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-01T15:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287177",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_287178.json:
```json
{
    "body": "<a id='comment:23'></a>Merge conflict (probably with #17021)",
    "created_at": "2014-10-01T15:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287178",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>Merge conflict (probably with #17021)



---

archive/issue_comments_287179.json:
```json
{
    "body": "Changing commit from \"8c24b064335445465c708efdc257be53eb7be874\" to \"2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d\"",
    "created_at": "2014-10-01T21:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8c24b064335445465c708efdc257be53eb7be874" to "2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d"



---

archive/issue_comments_287180.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-01T21:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287181.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-01T21:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287181",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287182.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-02T06:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287182",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049618.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-03T22:37:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17058#event-49618"
}
```



---

archive/issue_comments_287183.json:
```json
{
    "body": "Changing branch from \"u/slabbe/17058\" to \"2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d\"",
    "created_at": "2014-10-03T22:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287183",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/slabbe/17058" to "2fbb3e125d1e247b7e2ffaa875e65c4c77973a0d"



---

archive/issue_comments_287184.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-03T22:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17058#issuecomment-287184",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
