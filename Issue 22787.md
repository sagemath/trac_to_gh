# Issue 22787: Replacement of sage/libs/ppl.pyx by pplpy

archive/issues_022787.json:
```json
{
    "body": "CC:  @videlec @kiwifb @embray @slel\n\nKeywords: thursdaysbdx, ppl, pplpy\n\nRemove ppl.pyx extension and replace with pplpy[https://github.com/videlec/pplpy/](https://github.com/videlec/pplpy/) package.\n\nSome steps :\n- list any ticket proposing to extend ppl functionalities in Sage (if yes, open issues on github with cross links)\n- see if anybody changed sage/libs/ppl.pyx since the fork (if yes, list the commit and port them into pplpy)\n- prepare a package for pplpy as documented in the developer guide\n- replace the Sage code calling sage/libs/ppl.pyx to call pplpy\n\nIssue created by migration from https://trac.sagemath.org/ticket/23024\n\n",
    "created_at": "2017-05-18T12:30:47Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Replacement of sage/libs/ppl.pyx by pplpy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22787",
    "user": "https://github.com/vinklein"
}
```
CC:  @videlec @kiwifb @embray @slel

Keywords: thursdaysbdx, ppl, pplpy

Remove ppl.pyx extension and replace with pplpy[https://github.com/videlec/pplpy/](https://github.com/videlec/pplpy/) package.

Some steps :
- list any ticket proposing to extend ppl functionalities in Sage (if yes, open issues on github with cross links)
- see if anybody changed sage/libs/ppl.pyx since the fork (if yes, list the commit and port them into pplpy)
- prepare a package for pplpy as documented in the developer guide
- replace the Sage code calling sage/libs/ppl.pyx to call pplpy

Issue created by migration from https://trac.sagemath.org/ticket/23024





---

archive/issue_comments_318151.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2017-05-18T17:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318151",
    "user": "https://github.com/vinklein"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_318152.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-07T07:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318152",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318153.json:
```json
{
    "body": "For testing purpose you can use the following tarball of [pplpy](http://www.labri.fr/perso/vklein/pplpy-0.7.tar.gz) (outdated, use the one in the ticket's description)",
    "created_at": "2017-06-07T07:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318153",
    "user": "https://github.com/vinklein"
}
```

For testing purpose you can use the following tarball of [pplpy](http://www.labri.fr/perso/vklein/pplpy-0.7.tar.gz) (outdated, use the one in the ticket's description)



---

archive/issue_comments_318154.json:
```json
{
    "body": "Salut Vincent,\n\nYour branch appears in red which means that there are merge issues (possibly trivial). Would be better to rebase it on the latest beta.",
    "created_at": "2017-06-07T10:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318154",
    "user": "https://github.com/videlec"
}
```

Salut Vincent,

Your branch appears in red which means that there are merge issues (possibly trivial). Would be better to rebase it on the latest beta.



---

archive/issue_comments_318155.json:
```json
{
    "body": "1) Pickling should be fixed\n\n```diff\n-        sage: TestSuite(Asso).run()\n+        sage: TestSuite(Asso).run(skip='_test_pickling')\n```\n\nIt works with `pplpy` used from Python\n\n```\n>>> x = ppl.Variable(0)\n>>> y = ppl.Variable(1)\n>>> z = ppl.Variable(2)\n>>> gs.insert(ppl.point(x+y+2*z))\n>>> gs.insert(ppl.point(x-y))\n>>> gs.insert(ppl.point(z))\n>>> P = ppl.C_Polyhedron(gs)\n>>> import pickle\n>>> pickle.loads(pickle.dumps(P)) == P\nTrue\n```\n\n\n\n2) I don't see the point of the function `mpz_to_sage_integer`. You can just do `[Integer(x) for x in my_mpz_list]`. For example\n\n```\nv_coords = (1,) + tuple(mpz_to_sage_integer(v.coefficients()))\n```\n\ncan be replaced by\n\n```\nv_coords = (1,) + tuple(Integer(c) for c in v.coefficients())\n```\n\nMoreover, the name is confusing since the fuction converts a **list** of mpz integers.\n\n3) Some possible simplifications\n\n- In `ppl_backend.pyx`:\n`Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> \n`Rational(g.coefficient(Variable(variable)) / g.divisor())`\n\n- In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`",
    "created_at": "2017-06-07T11:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318155",
    "user": "https://github.com/videlec"
}
```

1) Pickling should be fixed

```diff
-        sage: TestSuite(Asso).run()
+        sage: TestSuite(Asso).run(skip='_test_pickling')
```

It works with `pplpy` used from Python

```
>>> x = ppl.Variable(0)
>>> y = ppl.Variable(1)
>>> z = ppl.Variable(2)
>>> gs.insert(ppl.point(x+y+2*z))
>>> gs.insert(ppl.point(x-y))
>>> gs.insert(ppl.point(z))
>>> P = ppl.C_Polyhedron(gs)
>>> import pickle
>>> pickle.loads(pickle.dumps(P)) == P
True
```



2) I don't see the point of the function `mpz_to_sage_integer`. You can just do `[Integer(x) for x in my_mpz_list]`. For example

```
v_coords = (1,) + tuple(mpz_to_sage_integer(v.coefficients()))
```

can be replaced by

```
v_coords = (1,) + tuple(Integer(c) for c in v.coefficients())
```

Moreover, the name is confusing since the fuction converts a **list** of mpz integers.

3) Some possible simplifications

- In `ppl_backend.pyx`:
`Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> 
`Rational(g.coefficient(Variable(variable)) / g.divisor())`

- In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`



---

archive/issue_comments_318156.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2017-06-07T14:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318156",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_318157.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> 3) Some possible simplifications\n> \n> - In `ppl_backend.pyx`:\n> `Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> \n> `Rational(g.coefficient(Variable(variable)) / g.divisor())`\n> \n> - In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`\n\nIt will be nice, but coercion for gmpy2 types is required for doing this (#23052).",
    "created_at": "2017-06-07T15:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318157",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:9 vdelecroix]:
> 3) Some possible simplifications
> 
> - In `ppl_backend.pyx`:
> `Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> 
> `Rational(g.coefficient(Variable(variable)) / g.divisor())`
> 
> - In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`

It will be nice, but coercion for gmpy2 types is required for doing this (#23052).



---

archive/issue_comments_318158.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-07T15:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318158",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318159.json:
```json
{
    "body": "Replying to [comment:11 vklein]:\n> Replying to [comment:9 vdelecroix]:\n> > 3) Some possible simplifications\n> > \n> > - In `ppl_backend.pyx`:\n> > `Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> \n> > `Rational(g.coefficient(Variable(variable)) / g.divisor())`\n> > \n> > - In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`\n> \n> It will be nice, but coercion for gmpy2 types is required for doing this (#23052).\n\nWhere? The first involves a direct call `Rational(mpq_type)` and the second comparison between `mpz` and Python integer. Which operation is mixing gmpy2 types with Sage types?",
    "created_at": "2017-06-07T20:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318159",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:11 vklein]:
> Replying to [comment:9 vdelecroix]:
> > 3) Some possible simplifications
> > 
> > - In `ppl_backend.pyx`:
> > `Integer(g.coefficient(Variable(variable))) / Integer(g.divisor())` -> 
> > `Rational(g.coefficient(Variable(variable)) / g.divisor())`
> > 
> > - In `ppl_lattice_polytope.py`: `assert Integer(v.divisor()).is_one()` -> `assert v.divisor() == 1`
> 
> It will be nice, but coercion for gmpy2 types is required for doing this (#23052).

Where? The first involves a direct call `Rational(mpq_type)` and the second comparison between `mpz` and Python integer. Which operation is mixing gmpy2 types with Sage types?



---

archive/issue_comments_318160.json:
```json
{
    "body": "Replying to [comment:13 vdelecroix]:\n> \n> Where? The first involves a direct call `Rational(mpq_type)` and the second comparison between `mpz` and Python integer. Which operation is mixing gmpy2 types with Sage types?\nYou're right, tests failures in ppl_backend.pyx with the suggested code are not coercion related. Forget my previous comment.",
    "created_at": "2017-06-08T08:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318160",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:13 vdelecroix]:
> 
> Where? The first involves a direct call `Rational(mpq_type)` and the second comparison between `mpz` and Python integer. Which operation is mixing gmpy2 types with Sage types?
You're right, tests failures in ppl_backend.pyx with the suggested code are not coercion related. Forget my previous comment.



---

archive/issue_comments_318161.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-08T18:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318162.json:
```json
{
    "body": "As pplpy has evolved to fix pickling with cPickle download [pplpy](http://www.labri.fr/perso/vklein/pplpy-0.7.tar.gz) again to update your local package.",
    "created_at": "2017-06-08T18:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318162",
    "user": "https://github.com/vinklein"
}
```

As pplpy has evolved to fix pickling with cPickle download [pplpy](http://www.labri.fr/perso/vklein/pplpy-0.7.tar.gz) again to update your local package.



---

archive/issue_comments_318163.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-09T14:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318164.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-06-15T12:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318164",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_318165.json:
```json
{
    "body": "As pplpy has evolved to fix pickling with cPickle download \u200bpplpy again to update your local package.",
    "created_at": "2017-06-15T13:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318165",
    "user": "https://github.com/vinklein"
}
```

As pplpy has evolved to fix pickling with cPickle download ​pplpy again to update your local package.



---

archive/issue_comments_318166.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2017-11-17T15:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_318167.json:
```json
{
    "body": "[pplpy 0.7](https://pypi.python.org/pypi/pplpy/0.7) is out",
    "created_at": "2017-11-24T18:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318167",
    "user": "https://github.com/videlec"
}
```

[pplpy 0.7](https://pypi.python.org/pypi/pplpy/0.7) is out



---

archive/issue_comments_318168.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2017-12-19T15:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_318169.json:
```json
{
    "body": "Rebase on 22928 (with 22928 based on 8.2.beta0)",
    "created_at": "2017-12-19T15:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318169",
    "user": "https://github.com/vinklein"
}
```

Rebase on 22928 (with 22928 based on 8.2.beta0)



---

archive/issue_comments_318170.json:
```json
{
    "body": "You need to provide a link to the pplpy tarball.",
    "created_at": "2017-12-19T21:22:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318170",
    "user": "https://github.com/videlec"
}
```

You need to provide a link to the pplpy tarball.



---

archive/issue_comments_318171.json:
```json
{
    "body": "And proper deprecation has to be done for `sage.libs.ppl` so that a user doing\n\n```\nsage: from sage.libs.ppl import whatever\n```\n\nshould not get an `ImportError` but a warning. See http://doc.sagemath.org/html/en/reference/misc/sage/misc/superseded.htm",
    "created_at": "2017-12-19T21:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318171",
    "user": "https://github.com/videlec"
}
```

And proper deprecation has to be done for `sage.libs.ppl` so that a user doing

```
sage: from sage.libs.ppl import whatever
```

should not get an `ImportError` but a warning. See http://doc.sagemath.org/html/en/reference/misc/sage/misc/superseded.htm



---

archive/issue_comments_318172.json:
```json
{
    "body": "And by proper deprecation do you mean keeping sage.libs.ppl fully functioning with his doctests ? Or do we prefer to shutdown sage.libs.ppl functionalities (Functions don't do their old work and just return a warning) ?",
    "created_at": "2017-12-20T10:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318172",
    "user": "https://github.com/vinklein"
}
```

And by proper deprecation do you mean keeping sage.libs.ppl fully functioning with his doctests ? Or do we prefer to shutdown sage.libs.ppl functionalities (Functions don't do their old work and just return a warning) ?



---

archive/issue_comments_318173.json:
```json
{
    "body": "Replying to [comment:30 vklein]:\n> And by proper deprecation do you mean keeping sage.libs.ppl fully functioning with his doctests ? Or do we prefer to shutdown sage.libs.ppl functionalities (Functions don't do their old work and just return a warning) ?\n\nThe aim is not to keep `sage.libs.ppl` but to just to have some indirection in the import so that you do not break user's code. As `sage.libs.ppl` will not here anymore I do not expect the full doctesuite to pass as it used to be. But the following kind of things should work (and be doctested)\n\n```\nsage: from sage.libs.ppl import Variable, Constraint_System, C_Polyhedron\nUserWarning: proper deprecation message\nsage: x = Variable(0)\nsage: y = Variable(1)\nsage: cs = Constraint_System()\nsage: cs.insert(x >= 0)\nsage: cs.insert(x <= 3)\nsage: cs.insert(y >= 0)\nsage: cs.insert(y <= 3)\nsage: poly_from_constraints = C_Polyhedron(cs)\n```\n\nAnd the various objects constructed above are of course from pplpy.\n\nYou can have a look at other places in the sage code and look for \"deprecation\" and \"lazy_import\".",
    "created_at": "2017-12-20T10:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318173",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:30 vklein]:
> And by proper deprecation do you mean keeping sage.libs.ppl fully functioning with his doctests ? Or do we prefer to shutdown sage.libs.ppl functionalities (Functions don't do their old work and just return a warning) ?

The aim is not to keep `sage.libs.ppl` but to just to have some indirection in the import so that you do not break user's code. As `sage.libs.ppl` will not here anymore I do not expect the full doctesuite to pass as it used to be. But the following kind of things should work (and be doctested)

```
sage: from sage.libs.ppl import Variable, Constraint_System, C_Polyhedron
UserWarning: proper deprecation message
sage: x = Variable(0)
sage: y = Variable(1)
sage: cs = Constraint_System()
sage: cs.insert(x >= 0)
sage: cs.insert(x <= 3)
sage: cs.insert(y >= 0)
sage: cs.insert(y <= 3)
sage: poly_from_constraints = C_Polyhedron(cs)
```

And the various objects constructed above are of course from pplpy.

You can have a look at other places in the sage code and look for "deprecation" and "lazy_import".



---

archive/issue_comments_318174.json:
```json
{
    "body": "Well, i spoke with Sebastien L. and if the goal is to let one year for developers to adapt their old code, doing an indirection is not enough. Mainly because pplpy use gmpy2 (some functions return and calls are differents).\n\nTherefore it seems like we should keep `sage.libs.ppl` old code with added warnings.",
    "created_at": "2017-12-20T11:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318174",
    "user": "https://github.com/vinklein"
}
```

Well, i spoke with Sebastien L. and if the goal is to let one year for developers to adapt their old code, doing an indirection is not enough. Mainly because pplpy use gmpy2 (some functions return and calls are differents).

Therefore it seems like we should keep `sage.libs.ppl` old code with added warnings.



---

archive/issue_comments_318175.json:
```json
{
    "body": "Just a small request can you put upstream's address in SPKG.txt? Of course you are available on pypi but it is not the same as being able to find where to fill bugs and what the current issues are straight away.",
    "created_at": "2017-12-21T01:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318175",
    "user": "https://github.com/kiwifb"
}
```

Just a small request can you put upstream's address in SPKG.txt? Of course you are available on pypi but it is not the same as being able to find where to fill bugs and what the current issues are straight away.



---

archive/issue_comments_318176.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-21T07:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318177.json:
```json
{
    "body": "Done, thanks for noticing that.",
    "created_at": "2017-12-21T08:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318177",
    "user": "https://github.com/vinklein"
}
```

Done, thanks for noticing that.



---

archive/issue_comments_318178.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-21T09:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318179.json:
```json
{
    "body": "Deprecation of `sage.libs.ppl` added. As the whole module is deprecated i choose to send deprecation warning at import time.",
    "created_at": "2017-12-21T09:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318179",
    "user": "https://github.com/vinklein"
}
```

Deprecation of `sage.libs.ppl` added. As the whole module is deprecated i choose to send deprecation warning at import time.



---

archive/issue_comments_318180.json:
```json
{
    "body": "Replying to [comment:38 vklein]:\n> Deprecation of `sage.libs.ppl` added. As the whole module is deprecated i choose to send deprecation warning at import time.\n\nGood solution.\n\nNow, we just need to wait for #22928...",
    "created_at": "2017-12-21T10:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318180",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:38 vklein]:
> Deprecation of `sage.libs.ppl` added. As the whole module is deprecated i choose to send deprecation warning at import time.

Good solution.

Now, we just need to wait for #22928...



---

archive/issue_comments_318181.json:
```json
{
    "body": "Did you run the testsuite!?\n\n```\nsage -t src/sage/geometry/lattice_polytope.py\n**********************************************************************\nFile \"src/sage/geometry/lattice_polytope.py\", line 1608, in sage.geometry.lattice_polytope.LatticePolytopeClass.boundary_point_indices\nFailed example:\n    face.points()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 517, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 920, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.lattice_polytope.LatticePolytopeClass.boundary_point_indices[4]>\", line 1, in <module>\n        face.points()\n      File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/geometry/lattice_polytope.py\", line 3680, in points\n        l = gcd(v)\n    NameError: global name 'gcd' is not defined\n```\n",
    "created_at": "2017-12-21T15:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318181",
    "user": "https://github.com/videlec"
}
```

Did you run the testsuite!?

```
sage -t src/sage/geometry/lattice_polytope.py
**********************************************************************
File "src/sage/geometry/lattice_polytope.py", line 1608, in sage.geometry.lattice_polytope.LatticePolytopeClass.boundary_point_indices
Failed example:
    face.points()
Exception raised:
    Traceback (most recent call last):
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 517, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 920, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.lattice_polytope.LatticePolytopeClass.boundary_point_indices[4]>", line 1, in <module>
        face.points()
      File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage/geometry/lattice_polytope.py", line 3680, in points
        l = gcd(v)
    NameError: global name 'gcd' is not defined
```




---

archive/issue_comments_318182.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-21T16:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318183.json:
```json
{
    "body": "Yes i have see this one. \nThe last remaining problem is a SEGFAULT when running ppl_lattice_polytope.py doctests.",
    "created_at": "2017-12-21T16:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318183",
    "user": "https://github.com/vinklein"
}
```

Yes i have see this one. 
The last remaining problem is a SEGFAULT when running ppl_lattice_polytope.py doctests.



---

archive/issue_comments_318184.json:
```json
{
    "body": "Could you post the log here?",
    "created_at": "2017-12-21T16:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318184",
    "user": "https://github.com/videlec"
}
```

Could you post the log here?



---

archive/issue_comments_318185.json:
```json
{
    "body": "Replying to [comment:43 vdelecroix]:\n> Could you post the log here?\n[segfault_ppl_lattice_polytope.log](http://www.labri.fr/perso/vklein/segfault_ppl_lattice_polytope.log)\n\nShort story is \n\n```\nsage: LatticePolytope_PPL((0,0),(1/2,1))\n```\n\ncause a Segfault.",
    "created_at": "2017-12-21T16:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318185",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:43 vdelecroix]:
> Could you post the log here?
[segfault_ppl_lattice_polytope.log](http://www.labri.fr/perso/vklein/segfault_ppl_lattice_polytope.log)

Short story is 

```
sage: LatticePolytope_PPL((0,0),(1/2,1))
```

cause a Segfault.



---

archive/issue_comments_318186.json:
```json
{
    "body": "Isn't it https://github.com/aleaxit/gmpy/pull/174?",
    "created_at": "2017-12-21T17:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318186",
    "user": "https://github.com/videlec"
}
```

Isn't it https://github.com/aleaxit/gmpy/pull/174?



---

archive/issue_comments_318187.json:
```json
{
    "body": "At least with the patch applied I got\n\n```\nsage: from sage.geometry.polyhedron.ppl_lattice_polytope import LatticePolytope_PPL\nsage: LatticePolytope_PPL((0,0),(1/2,1))\nTraceback (most recent call last):\n...\nTypeError: rational is not an integer\n```\n",
    "created_at": "2017-12-21T17:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318187",
    "user": "https://github.com/videlec"
}
```

At least with the patch applied I got

```
sage: from sage.geometry.polyhedron.ppl_lattice_polytope import LatticePolytope_PPL
sage: LatticePolytope_PPL((0,0),(1/2,1))
Traceback (most recent call last):
...
TypeError: rational is not an integer
```




---

archive/issue_comments_318188.json:
```json
{
    "body": "See #24417",
    "created_at": "2017-12-21T17:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318188",
    "user": "https://github.com/videlec"
}
```

See #24417



---

archive/issue_comments_318189.json:
```json
{
    "body": "Replying to [comment:45 vdelecroix]:\n> Isn't it https://github.com/aleaxit/gmpy/pull/174?\nYes it is ! Nicely done.",
    "created_at": "2017-12-21T18:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318189",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:45 vdelecroix]:
> Isn't it https://github.com/aleaxit/gmpy/pull/174?
Yes it is ! Nicely done.



---

archive/issue_comments_318190.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2018-01-31T16:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_318191.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-01-31T16:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318192.json:
```json
{
    "body": "You are adding `sage.libs.gmpy2` in `7596cff` and removing it in `91b5d52`...",
    "created_at": "2018-01-31T16:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318192",
    "user": "https://github.com/videlec"
}
```

You are adding `sage.libs.gmpy2` in `7596cff` and removing it in `91b5d52`...



---

archive/issue_comments_318193.json:
```json
{
    "body": "Yes adding it was one of our old solutions. Before having a better include in pplpy's `setup.py` if i remember correctly. All of this historical things can be squashed later.",
    "created_at": "2018-01-31T17:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318193",
    "user": "https://github.com/vinklein"
}
```

Yes adding it was one of our old solutions. Before having a better include in pplpy's `setup.py` if i remember correctly. All of this historical things can be squashed later.



---

archive/issue_comments_318194.json:
```json
{
    "body": "It's the same for `ppl.pyx` we don't need to show that we deleted it and restore and deprecate later.",
    "created_at": "2018-01-31T17:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318194",
    "user": "https://github.com/vinklein"
}
```

It's the same for `ppl.pyx` we don't need to show that we deleted it and restore and deprecate later.



---

archive/issue_comments_318195.json:
```json
{
    "body": "There are a lot of trailing whitespaces that should be removed.",
    "created_at": "2018-02-01T08:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318195",
    "user": "https://github.com/videlec"
}
```

There are a lot of trailing whitespaces that should be removed.



---

archive/issue_comments_318196.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-02-01T09:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318196",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318197.json:
```json
{
    "body": "History rewrited. Trailing whitespaces removed in `real_mpfr.pyx`, `complex_mpc.pyx` and `complex_number.pyx` files.",
    "created_at": "2018-02-01T09:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318197",
    "user": "https://github.com/vinklein"
}
```

History rewrited. Trailing whitespaces removed in `real_mpfr.pyx`, `complex_mpc.pyx` and `complex_number.pyx` files.



---

archive/issue_comments_318198.json:
```json
{
    "body": "I don't understand why you are modifying `pplpy/SPKG.txt`, `pplpy/checksums.ini`, `pplpy/spkg-check`, etc in both `886424b` and `\u200ba6e1cc7`.",
    "created_at": "2018-02-02T13:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318198",
    "user": "https://github.com/videlec"
}
```

I don't understand why you are modifying `pplpy/SPKG.txt`, `pplpy/checksums.ini`, `pplpy/spkg-check`, etc in both `886424b` and `​a6e1cc7`.



---

archive/issue_comments_318199.json:
```json
{
    "body": "Build fine and all tests pass on my computer!",
    "created_at": "2018-02-03T09:47:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318199",
    "user": "https://github.com/videlec"
}
```

Build fine and all tests pass on my computer!



---

archive/issue_comments_318200.json:
```json
{
    "body": "Use `sdh_pip_install` instead of `$PIP_INSTALL`",
    "created_at": "2018-02-05T08:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318200",
    "user": "https://github.com/jdemeyer"
}
```

Use `sdh_pip_install` instead of `$PIP_INSTALL`



---

archive/issue_comments_318201.json:
```json
{
    "body": "Is the license of pplpy really `GPL version 3`? Or do you mean `GPL version 3 or later`? The difference is important.",
    "created_at": "2018-02-05T08:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318201",
    "user": "https://github.com/jdemeyer"
}
```

Is the license of pplpy really `GPL version 3`? Or do you mean `GPL version 3 or later`? The difference is important.



---

archive/issue_comments_318202.json:
```json
{
    "body": "This looks like a strange way to check if something is one:\n\n```\nInteger(p.divisor()).is_one()\n```\n\nWhat's wrong with\n\n```\np.divisor() == 1\n```\n",
    "created_at": "2018-02-05T08:54:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318202",
    "user": "https://github.com/jdemeyer"
}
```

This looks like a strange way to check if something is one:

```
Integer(p.divisor()).is_one()
```

What's wrong with

```
p.divisor() == 1
```




---

archive/issue_comments_318203.json:
```json
{
    "body": "Replying to [comment:61 jdemeyer]:\n> Is the license of pplpy really `GPL version 3`? Or do you mean `GPL version 3 or later`? The difference is important.\nYes the current one is `GPL version 3` (see [LICENSE.txt](https://github.com/videlec/pplpy/blob/master/LICENSE.txt)). Is it better to say `GPL version 3 or later` anyway ?",
    "created_at": "2018-02-05T08:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318203",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:61 jdemeyer]:
> Is the license of pplpy really `GPL version 3`? Or do you mean `GPL version 3 or later`? The difference is important.
Yes the current one is `GPL version 3` (see [LICENSE.txt](https://github.com/videlec/pplpy/blob/master/LICENSE.txt)). Is it better to say `GPL version 3 or later` anyway ?



---

archive/issue_comments_318204.json:
```json
{
    "body": "In `backend_ppl.py` you do `from gmpy2 import mpz` but you're not using it.",
    "created_at": "2018-02-05T09:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318204",
    "user": "https://github.com/jdemeyer"
}
```

In `backend_ppl.py` you do `from gmpy2 import mpz` but you're not using it.



---

archive/issue_comments_318205.json:
```json
{
    "body": "Replying to [comment:63 vklein]:\n> Is it better to say `GPL version 3 or later` anyway ?\n\nSee https://github.com/videlec/pplpy/issues/28",
    "created_at": "2018-02-05T09:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318205",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:63 vklein]:
> Is it better to say `GPL version 3 or later` anyway ?

See https://github.com/videlec/pplpy/issues/28



---

archive/issue_comments_318206.json:
```json
{
    "body": "Replying to [comment:62 jdemeyer]:\n> What's wrong with\n> {{{\n> p.divisor() == 1\n> }}}\np.divisor() return a `gmpy2.mpz`.",
    "created_at": "2018-02-05T10:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318206",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:62 jdemeyer]:
> What's wrong with
> {{{
> p.divisor() == 1
> }}}
p.divisor() return a `gmpy2.mpz`.



---

archive/issue_comments_318207.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-05T10:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318208.json:
```json
{
    "body": "Replying to [comment:66 vklein]:\n> Replying to [comment:62 jdemeyer]:\n> > What's wrong with\n> > {{{\n> > p.divisor() == 1\n> > }}}\n> p.divisor() return a `gmpy2.mpz`.\n\nWhat is wrong with\n\n```\n>>> gmpy2.mpz(1) == 1\nTrue\n```\n",
    "created_at": "2018-02-05T23:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318208",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:66 vklein]:
> Replying to [comment:62 jdemeyer]:
> > What's wrong with
> > {{{
> > p.divisor() == 1
> > }}}
> p.divisor() return a `gmpy2.mpz`.

What is wrong with

```
>>> gmpy2.mpz(1) == 1
True
```




---

archive/issue_comments_318209.json:
```json
{
    "body": "Replying to [comment:68 vdelecroix]:\n> ...\n> What is wrong with\n> {{{\n> >>> gmpy2.mpz(1) == 1\n> True\n> }}}\n\\\\\n\nIn this case you compare a python `int` with a `gmpy2.mpz`. \\\\\n\nBut with sage's `Integer` : \n\n```\nsage: gmpy2.mpz(1) == 1\nFalse\n```\n\n\nEdit: Hum ok my bad.",
    "created_at": "2018-02-06T08:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318209",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:68 vdelecroix]:
> ...
> What is wrong with
> {{{
> >>> gmpy2.mpz(1) == 1
> True
> }}}
\\

In this case you compare a python `int` with a `gmpy2.mpz`. \\

But with sage's `Integer` : 

```
sage: gmpy2.mpz(1) == 1
False
```


Edit: Hum ok my bad.



---

archive/issue_comments_318210.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-06T08:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318211.json:
```json
{
    "body": "self-testing fails:\n\n\n```\n$ SAGE_CHECK=yes ./sage -f pplpy\n...\n[pplpy-0.7] Successfully installed pplpy-0.7\n[pplpy-0.7] Cleaning up...\n[pplpy-0.7] \n[pplpy-0.7] real\t0m38.345s\n[pplpy-0.7] user\t0m36.490s\n[pplpy-0.7] sys\t0m1.835s\n[pplpy-0.7] Copying package files from temporary location /home/dima/Sage/sage-dev/local/var/tmp/sage/build/pplpy-0.7/inst to /home/dima/Sage/sage-dev/local\n[pplpy-0.7] Running the test suite for pplpy-0.7...\n[pplpy-0.7] running test\n[pplpy-0.7] error: cannot copy tree './tests': not a directory\n[pplpy-0.7] \n```\n",
    "created_at": "2018-02-06T16:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318211",
    "user": "https://github.com/dimpase"
}
```

self-testing fails:


```
$ SAGE_CHECK=yes ./sage -f pplpy
...
[pplpy-0.7] Successfully installed pplpy-0.7
[pplpy-0.7] Cleaning up...
[pplpy-0.7] 
[pplpy-0.7] real	0m38.345s
[pplpy-0.7] user	0m36.490s
[pplpy-0.7] sys	0m1.835s
[pplpy-0.7] Copying package files from temporary location /home/dima/Sage/sage-dev/local/var/tmp/sage/build/pplpy-0.7/inst to /home/dima/Sage/sage-dev/local
[pplpy-0.7] Running the test suite for pplpy-0.7...
[pplpy-0.7] running test
[pplpy-0.7] error: cannot copy tree './tests': not a directory
[pplpy-0.7] 
```




---

archive/issue_comments_318212.json:
```json
{
    "body": "Indeed. https://github.com/videlec/pplpy/issues/30",
    "created_at": "2018-02-06T17:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318212",
    "user": "https://github.com/vinklein"
}
```

Indeed. https://github.com/videlec/pplpy/issues/30



---

archive/issue_comments_318213.json:
```json
{
    "body": "This would still be a good thing to do IMO, in general.",
    "created_at": "2019-01-18T13:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318213",
    "user": "https://github.com/embray"
}
```

This would still be a good thing to do IMO, in general.



---

archive/issue_comments_318214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-22T17:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318215.json:
```json
{
    "body": "Rebased on sage8.6",
    "created_at": "2019-01-22T17:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318215",
    "user": "https://github.com/vinklein"
}
```

Rebased on sage8.6



---

archive/issue_comments_318216.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-23T18:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318217.json:
```json
{
    "body": "upgrade pplpy to 0.8.1",
    "created_at": "2019-01-23T18:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318217",
    "user": "https://github.com/vinklein"
}
```

upgrade pplpy to 0.8.1



---

archive/issue_comments_318218.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-23T18:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318218",
    "user": "https://github.com/vinklein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_318219.json:
```json
{
    "body": "Apparently a merge failure with sage 8.7.beta0",
    "created_at": "2019-01-24T07:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318219",
    "user": "https://github.com/videlec"
}
```

Apparently a merge failure with sage 8.7.beta0



---

archive/issue_comments_318220.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-24T10:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318221.json:
```json
{
    "body": "Solve merge failure with sage 8.7.beta0.",
    "created_at": "2019-01-24T10:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318221",
    "user": "https://github.com/vinklein"
}
```

Solve merge failure with sage 8.7.beta0.



---

archive/issue_comments_318222.json:
```json
{
    "body": "- off-topic - Vincent, please provide info on \nhttps://github.com/OpenDreamKit/OpenDreamKit/issues/281",
    "created_at": "2019-01-24T10:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318222",
    "user": "https://github.com/dimpase"
}
```

- off-topic - Vincent, please provide info on 
https://github.com/OpenDreamKit/OpenDreamKit/issues/281



---

archive/issue_comments_318223.json:
```json
{
    "body": "You should set `gmpy2` and `pplpy` as dependencies of the Sage library (otherwise building the Cython code might fail). This is done in `build/make/deps`.",
    "created_at": "2019-01-27T16:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318223",
    "user": "https://github.com/videlec"
}
```

You should set `gmpy2` and `pplpy` as dependencies of the Sage library (otherwise building the Cython code might fail). This is done in `build/make/deps`.



---

archive/issue_comments_318224.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-27T16:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318224",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318225.json:
```json
{
    "body": "Why\n\n```diff\n-            sage: TestSuite(P).run(skip='_test_pickling')\n+            sage: TestSuite(P).run(skip=('_test_pickling'))\n```\n",
    "created_at": "2019-01-27T16:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318225",
    "user": "https://github.com/videlec"
}
```

Why

```diff
-            sage: TestSuite(P).run(skip='_test_pickling')
+            sage: TestSuite(P).run(skip=('_test_pickling'))
```




---

archive/issue_comments_318226.json:
```json
{
    "body": "And\n\n```diff\n-    def _repr_(self):\n+    def __repr__(self):\n```\n",
    "created_at": "2019-01-27T17:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318226",
    "user": "https://github.com/videlec"
}
```

And

```diff
-    def _repr_(self):
+    def __repr__(self):
```




---

archive/issue_comments_318227.json:
```json
{
    "body": "The links in the documentation `:class:`ppl.C_Polyhedron``, `:class:`~ppl.Polyhedron``, etc are broken. These should not be sphinx links at all.",
    "created_at": "2019-01-27T17:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318227",
    "user": "https://github.com/videlec"
}
```

The links in the documentation `:class:`ppl.C_Polyhedron``, `:class:`~ppl.Polyhedron``, etc are broken. These should not be sphinx links at all.



---

archive/issue_comments_318228.json:
```json
{
    "body": "Does pplpy build/install its own docs? This kind of setup is used e.g. in cvxopt.",
    "created_at": "2019-01-27T18:07:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318228",
    "user": "https://github.com/dimpase"
}
```

Does pplpy build/install its own docs? This kind of setup is used e.g. in cvxopt.



---

archive/issue_comments_318229.json:
```json
{
    "body": "Replying to [comment:91 dimpase]:\n> Does pplpy build/install its own docs? This kind of setup is used e.g. in cvxopt.\n\nIt does build documentation if you ask it to. Tough it does not install anything (perhaps it should?). But even with properly installed documentation, I don't see how to make linking work properly.",
    "created_at": "2019-01-27T18:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318229",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:91 dimpase]:
> Does pplpy build/install its own docs? This kind of setup is used e.g. in cvxopt.

It does build documentation if you ask it to. Tough it does not install anything (perhaps it should?). But even with properly installed documentation, I don't see how to make linking work properly.



---

archive/issue_comments_318230.json:
```json
{
    "body": "Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..`",
    "created_at": "2019-01-27T18:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318230",
    "user": "https://github.com/dimpase"
}
```

Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..`



---

archive/issue_comments_318231.json:
```json
{
    "body": "Replying to [comment:89 vdelecroix]:\n> And\n> {{{#!diff\n> -    def _repr_(self):\n> +    def __repr__(self):\n> }}}\n\nThat's because `LatticePolytope_PPL_class` now inherit from pplpy's `C_Polyhedron` and therefore `LatticePolytope_PPL_class` is not a `SageObject`.",
    "created_at": "2019-01-28T16:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318231",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:89 vdelecroix]:
> And
> {{{#!diff
> -    def _repr_(self):
> +    def __repr__(self):
> }}}

That's because `LatticePolytope_PPL_class` now inherit from pplpy's `C_Polyhedron` and therefore `LatticePolytope_PPL_class` is not a `SageObject`.



---

archive/issue_comments_318232.json:
```json
{
    "body": "Replying to [comment:93 dimpase]:\n> Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` \n\nI can try. \\\\\nBut i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *\"$SAGE_SPKG_INSTALL_DOCS\" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#\"$SAGE_SPKG_INSTALL_DOCS\" = yes -macro)`. \\\\\nIf we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.\n\nI think there is many distinct questions :\\\\\n- 1. Should we install a pplpy documentation ?\n- 2. If yes should we install it only if `\"$SAGE_SPKG_INSTALL_DOCS\" = yes` ?\n- 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.",
    "created_at": "2019-01-28T16:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318232",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:93 dimpase]:
> Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` 

I can try. \\
But i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *"$SAGE_SPKG_INSTALL_DOCS" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#"$SAGE_SPKG_INSTALL_DOCS" = yes -macro)`. \\
If we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.

I think there is many distinct questions :\\
- 1. Should we install a pplpy documentation ?
- 2. If yes should we install it only if `"$SAGE_SPKG_INSTALL_DOCS" = yes` ?
- 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.



---

archive/issue_comments_318233.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-28T17:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318234.json:
```json
{
    "body": "It is a good practice to have the first line of the commit below 50 characters. More precisely, any commit message should be\n\n```\none line with <= 50 characters\n(optional) linebreak\n(optional) more extensive paragraph with lines <= 72 characters\n```\n",
    "created_at": "2019-01-29T07:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318234",
    "user": "https://github.com/videlec"
}
```

It is a good practice to have the first line of the commit below 50 characters. More precisely, any commit message should be

```
one line with <= 50 characters
(optional) linebreak
(optional) more extensive paragraph with lines <= 72 characters
```




---

archive/issue_comments_318235.json:
```json
{
    "body": "Replying to [comment:95 vklein]:\n> Replying to [comment:93 dimpase]:\n> > Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` \n> \n> I can try. \\\\\n> But i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *\"$SAGE_SPKG_INSTALL_DOCS\" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#\"$SAGE_SPKG_INSTALL_DOCS\" = yes -macro)`. \\\\\n> If we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.\n> \n> I think there is many distinct questions :\\\\\n> - 1. Should we install a pplpy documentation ?\n> - 2. If yes should we install it only if `\"$SAGE_SPKG_INSTALL_DOCS\" = yes` ?\n> - 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.\n\nI don't know what is the way to proceed. See https://gitlab.com/videlec/pplpy/issues/12\n\nFor now I would say:\n- remove all links in the Sage documentation\n- in each relevant module, make a reference to the pplpy development website (https://gitlab.com/videlec/pplpy) and pplpy documentation website (http://www.labri.fr/perso/vdelecro/pplpy/latest/).",
    "created_at": "2019-01-29T07:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318235",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:95 vklein]:
> Replying to [comment:93 dimpase]:
> > Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` 
> 
> I can try. \\
> But i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *"$SAGE_SPKG_INSTALL_DOCS" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#"$SAGE_SPKG_INSTALL_DOCS" = yes -macro)`. \\
> If we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.
> 
> I think there is many distinct questions :\\
> - 1. Should we install a pplpy documentation ?
> - 2. If yes should we install it only if `"$SAGE_SPKG_INSTALL_DOCS" = yes` ?
> - 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.

I don't know what is the way to proceed. See https://gitlab.com/videlec/pplpy/issues/12

For now I would say:
- remove all links in the Sage documentation
- in each relevant module, make a reference to the pplpy development website (https://gitlab.com/videlec/pplpy) and pplpy documentation website (http://www.labri.fr/perso/vdelecro/pplpy/latest/).



---

archive/issue_comments_318236.json:
```json
{
    "body": "I've left comments in https://gitlab.com/videlec/pplpy/issues/12\nnamely there appears to be a Sphinx extension to link different projects.\n\nIt's too early to start blindly removing links to docs, probably there is a more intelligent way to preserve what is already there.",
    "created_at": "2019-01-29T09:41:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318236",
    "user": "https://github.com/dimpase"
}
```

I've left comments in https://gitlab.com/videlec/pplpy/issues/12
namely there appears to be a Sphinx extension to link different projects.

It's too early to start blindly removing links to docs, probably there is a more intelligent way to preserve what is already there.



---

archive/issue_comments_318237.json:
```json
{
    "body": "Replying to [comment:95 vklein]:\n> Replying to [comment:93 dimpase]:\n> > Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` \n> \n> I can try. \\\\\n> But i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *\"$SAGE_SPKG_INSTALL_DOCS\" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#\"$SAGE_SPKG_INSTALL_DOCS\" = yes -macro)`. \\\\\n> If we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.\n> \n> I think there is many distinct questions :\\\\\n> - 1. Should we install a pplpy documentation ?\n\nWe should compile **and** install.\n\n> - 2. If yes should we install it only if `\"$SAGE_SPKG_INSTALL_DOCS\" = yes` ?\n\nI don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?\n\n> - 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.\n\nSee #27164.",
    "created_at": "2019-01-29T14:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318237",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:95 vklein]:
> Replying to [comment:93 dimpase]:
> > Packages install docs into `$SAGE_LOCAL/share/doc/`. I guess that docs can be linked to docs in Sage code via relative paths, i.e. `../../..` 
> 
> I can try. \\
> But i can see a potential problem here: most packages seems to install documentation on if `[This is the Trac macro *"$SAGE_SPKG_INSTALL_DOCS" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#"$SAGE_SPKG_INSTALL_DOCS" = yes -macro)`. \\
> If we do the same for pplpy, given `$SAGE_SPKG_INSTALL_DOCS` default value is not `yes` that mean that the links will be broken by default.
> 
> I think there is many distinct questions :\\
> - 1. Should we install a pplpy documentation ?

We should compile **and** install.

> - 2. If yes should we install it only if `"$SAGE_SPKG_INSTALL_DOCS" = yes` ?

I don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?

> - 3. If yes to 1. and yes to 2. should we link the sagemaths documentation with pplpy's.

See #27164.



---

archive/issue_comments_318238.json:
```json
{
    "body": "Replying to [comment:100 vdelecroix]:\n> ...\n> > - 2. If yes should we install it only if `\"$SAGE_SPKG_INSTALL_DOCS\" = yes` ?\n> \n> I don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?\n> \n\nHere http://doc.sagemath.org/html/en/installation/source.html.\n\n\n**SAGE_SPKG_INSTALL_DOCS** - if set to yes, then install package-specific documentation to $SAGE_ROOT/local/share/doc/PACKAGE_NAME/ when an spkg is installed. This option may not be supported by all spkgs. Some spkgs might also assume that certain programs are available on the system (for example, latex or pdflatex).",
    "created_at": "2019-01-29T15:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318238",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:100 vdelecroix]:
> ...
> > - 2. If yes should we install it only if `"$SAGE_SPKG_INSTALL_DOCS" = yes` ?
> 
> I don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?
> 

Here http://doc.sagemath.org/html/en/installation/source.html.


**SAGE_SPKG_INSTALL_DOCS** - if set to yes, then install package-specific documentation to $SAGE_ROOT/local/share/doc/PACKAGE_NAME/ when an spkg is installed. This option may not be supported by all spkgs. Some spkgs might also assume that certain programs are available on the system (for example, latex or pdflatex).



---

archive/issue_comments_318239.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-29T16:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318239",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318240.json:
```json
{
    "body": "Replying to [comment:101 vklein]:\n> Replying to [comment:100 vdelecroix]:\n> > ...\n> > > - 2. If yes should we install it only if `\"$SAGE_SPKG_INSTALL_DOCS\" = yes` ?\n> > \n> > I don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?\n> > \n> \n> Here http://doc.sagemath.org/html/en/installation/source.html.\n> \n> \n> **SAGE_SPKG_INSTALL_DOCS** - if set to yes, then install package-specific documentation to $SAGE_ROOT/local/share/doc/PACKAGE_NAME/ when an spkg is installed. This option may not be supported by all spkgs. Some spkgs might also assume that certain programs are available on the system (for example, latex or pdflatex).\n\nI believe it has been done that way a long time ago when Sage was not thought modular at all. Some of the package documentation (including pplpy) might be automatically installed unless SAGE_SPKG_INSTALL_DOCS is explicitely set to \"no\".",
    "created_at": "2019-01-29T18:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318240",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:101 vklein]:
> Replying to [comment:100 vdelecroix]:
> > ...
> > > - 2. If yes should we install it only if `"$SAGE_SPKG_INSTALL_DOCS" = yes` ?
> > 
> > I don't know. Where is `SAGE_SPKG_INSTALL_DOCS` documented?
> > 
> 
> Here http://doc.sagemath.org/html/en/installation/source.html.
> 
> 
> **SAGE_SPKG_INSTALL_DOCS** - if set to yes, then install package-specific documentation to $SAGE_ROOT/local/share/doc/PACKAGE_NAME/ when an spkg is installed. This option may not be supported by all spkgs. Some spkgs might also assume that certain programs are available on the system (for example, latex or pdflatex).

I believe it has been done that way a long time ago when Sage was not thought modular at all. Some of the package documentation (including pplpy) might be automatically installed unless SAGE_SPKG_INSTALL_DOCS is explicitely set to "no".



---

archive/issue_comments_318241.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-30T15:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318242.json:
```json
{
    "body": "For testing purpose use https://www.labri.fr/perso/vklein/pplpy-0.8.2b0.tar.gz with `ef89978`.",
    "created_at": "2019-01-30T15:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318242",
    "user": "https://github.com/vinklein"
}
```

For testing purpose use https://www.labri.fr/perso/vklein/pplpy-0.8.2b0.tar.gz with `ef89978`.



---

archive/issue_comments_318243.json:
```json
{
    "body": "`ef89978` Implements the compilation and installation of pplpy's documentation.\n\nThe current implementation drawback is that pplpy is compiled two times (one time for package installation and one time using \"inplace\" build in preparation for sphinx).\n\nTo avoid that i am looking for an elegant and generic way to express `PYTHONPATH=$PYTHONPATH:$SAGE_DESTDIR_LOCAL/lib/python2.7/site-packages`.\n\nI haven't find an environment variable for `lib/python2.7/site-packages` or something equivalent.\n\nAny help is welcomed.",
    "created_at": "2019-01-30T16:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318243",
    "user": "https://github.com/vinklein"
}
```

`ef89978` Implements the compilation and installation of pplpy's documentation.

The current implementation drawback is that pplpy is compiled two times (one time for package installation and one time using "inplace" build in preparation for sphinx).

To avoid that i am looking for an elegant and generic way to express `PYTHONPATH=$PYTHONPATH:$SAGE_DESTDIR_LOCAL/lib/python2.7/site-packages`.

I haven't find an environment variable for `lib/python2.7/site-packages` or something equivalent.

Any help is welcomed.



---

archive/issue_comments_318244.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-30T17:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318245.json:
```json
{
    "body": "`d8c41f6` Fix intersphinx question.\n\nI wait for returns for [#comment:106](https://trac.sagemath.org/ticket/23024#comment:106) and for a new pplpy official version before setting this ticket in need_review.",
    "created_at": "2019-01-30T17:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318245",
    "user": "https://github.com/vinklein"
}
```

`d8c41f6` Fix intersphinx question.

I wait for returns for [#comment:106](https://trac.sagemath.org/ticket/23024#comment:106) and for a new pplpy official version before setting this ticket in need_review.



---

archive/issue_comments_318246.json:
```json
{
    "body": "I wonder whether you tried to set up a link to pplpy docs in Sage's reference manual, something that ought to be done for many more packages...",
    "created_at": "2019-01-30T17:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318246",
    "user": "https://github.com/dimpase"
}
```

I wonder whether you tried to set up a link to pplpy docs in Sage's reference manual, something that ought to be done for many more packages...



---

archive/issue_comments_318247.json:
```json
{
    "body": "Replying to [comment:109 dimpase]:\n> I wonder whether you tried to set up a link to pplpy docs in Sage's reference manual, something that ought to be done for many more packages...\n\\\\\n\nI am not sure what is your question about.\\\\\n\nI have think about doing the intersphinx link at reference level yes. But IMHO doing it under common is a better call.\\\\\n\nI haven't tried to do direct html link with relative path.",
    "created_at": "2019-01-30T17:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318247",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:109 dimpase]:
> I wonder whether you tried to set up a link to pplpy docs in Sage's reference manual, something that ought to be done for many more packages...
\\

I am not sure what is your question about.\\

I have think about doing the intersphinx link at reference level yes. But IMHO doing it under common is a better call.\\

I haven't tried to do direct html link with relative path.



---

archive/issue_comments_318248.json:
```json
{
    "body": "I meant to ask whether you managed to replace the docs link to PPL backend\nin the reference manual, such as\nhttp://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/backend_ppl.html\n(its local equivalent would have something else instead of `http://doc.sagemath.org/` part, naturally)\nwith the link to the pplpy docs.",
    "created_at": "2019-01-30T17:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318248",
    "user": "https://github.com/dimpase"
}
```

I meant to ask whether you managed to replace the docs link to PPL backend
in the reference manual, such as
http://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/backend_ppl.html
(its local equivalent would have something else instead of `http://doc.sagemath.org/` part, naturally)
with the link to the pplpy docs.



---

archive/issue_comments_318249.json:
```json
{
    "body": "Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?",
    "created_at": "2019-01-30T19:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318249",
    "user": "https://github.com/videlec"
}
```

Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?



---

archive/issue_comments_318250.json:
```json
{
    "body": "Replying to [comment:112 vdelecroix]:\n> Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?\n\nMaybe try a `make doc-clean`. ``ppl.C_Polyhedron`` should have been replaced by ``ppl.polyhedron.C_Polyhedron``.",
    "created_at": "2019-01-31T07:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318250",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:112 vdelecroix]:
> Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?

Maybe try a `make doc-clean`. ``ppl.C_Polyhedron`` should have been replaced by ``ppl.polyhedron.C_Polyhedron``.



---

archive/issue_comments_318251.json:
```json
{
    "body": "Replying to [comment:113 vklein]:\n> Replying to [comment:112 vdelecroix]:\n> > Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?\n> \n> Maybe try a `make doc-clean`. ``ppl.C_Polyhedron`` should have been replaced by ``ppl.polyhedron.C_Polyhedron``.\n\nI did `make doc-clean`, `sage -f pplpy` and `make doc`.",
    "created_at": "2019-01-31T07:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318251",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:113 vklein]:
> Replying to [comment:112 vdelecroix]:
> > Crossed links does not work for me (e.g. the `ppl.C_Polyhedron` in the file `en/reference/discrete_geometry/sage/geometry/polyhedron/ppl_lattice_polytope.html`) ... did you do something special in order to make it work for you?
> 
> Maybe try a `make doc-clean`. ``ppl.C_Polyhedron`` should have been replaced by ``ppl.polyhedron.C_Polyhedron``.

I did `make doc-clean`, `sage -f pplpy` and `make doc`.



---

archive/issue_comments_318252.json:
```json
{
    "body": "I know what I did wrong: I did not pull your last commits... sorry for the noise.",
    "created_at": "2019-01-31T07:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318252",
    "user": "https://github.com/videlec"
}
```

I know what I did wrong: I did not pull your last commits... sorry for the noise.



---

archive/issue_comments_318253.json:
```json
{
    "body": "It is working now!",
    "created_at": "2019-01-31T08:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318253",
    "user": "https://github.com/videlec"
}
```

It is working now!



---

archive/issue_comments_318254.json:
```json
{
    "body": "I will make a new release of pplpy.\n\nCould you ask about [comment:106] on sage-devel? This is a general problem when a package needs to be installed before being able to build the docs. Perhaps this is a problem with the package itself or in the way our current staged installation works in Sage. But then, it is not clear to me how to solve it.",
    "created_at": "2019-01-31T08:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318254",
    "user": "https://github.com/videlec"
}
```

I will make a new release of pplpy.

Could you ask about [comment:106] on sage-devel? This is a general problem when a package needs to be installed before being able to build the docs. Perhaps this is a problem with the package itself or in the way our current staged installation works in Sage. But then, it is not clear to me how to solve it.



---

archive/issue_comments_318255.json:
```json
{
    "body": "For comment:106 : link to the post on sage-devel https://groups.google.com/forum/#!topic/sage-devel/IOn7wneT8xo",
    "created_at": "2019-01-31T08:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318255",
    "user": "https://github.com/vinklein"
}
```

For comment:106 : link to the post on sage-devel https://groups.google.com/forum/#!topic/sage-devel/IOn7wneT8xo



---

archive/issue_comments_318256.json:
```json
{
    "body": "Replying to [comment:111 dimpase]:\n> I meant to ask whether you managed to replace the docs link to PPL backend\n> in the reference manual, such as\n> http://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/backend_ppl.html\n> (its local equivalent would have something else instead of `http://doc.sagemath.org/` part, naturally)\n> with the link to the pplpy docs.\\\\\n\n\nI managed to replace the doc links of type `sage.libs.ppl.*`. But there is no such kind of doclinks under `backend_ppl.html`. Class like `sage.geometry.polyhedron.base_QQ.Polyhedron_QQ` are still sage classes.",
    "created_at": "2019-01-31T09:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318256",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:111 dimpase]:
> I meant to ask whether you managed to replace the docs link to PPL backend
> in the reference manual, such as
> http://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/backend_ppl.html
> (its local equivalent would have something else instead of `http://doc.sagemath.org/` part, naturally)
> with the link to the pplpy docs.\\


I managed to replace the doc links of type `sage.libs.ppl.*`. But there is no such kind of doclinks under `backend_ppl.html`. Class like `sage.geometry.polyhedron.base_QQ.Polyhedron_QQ` are still sage classes.



---

archive/issue_comments_318257.json:
```json
{
    "body": "Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...",
    "created_at": "2019-01-31T13:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318257",
    "user": "https://github.com/videlec"
}
```

Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...



---

archive/issue_comments_318258.json:
```json
{
    "body": "Replying to [comment:120 vdelecroix]:\n> Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...\n \n-1. I'd rather run the installation twice than this.",
    "created_at": "2019-01-31T13:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318258",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:120 vdelecroix]:
> Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...
 
-1. I'd rather run the installation twice than this.



---

archive/issue_comments_318259.json:
```json
{
    "body": "Replying to [comment:120 vdelecroix]:\n> Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...\n\nWhy not. It will increase the tarball size of something like 200 kbytes.",
    "created_at": "2019-01-31T13:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318259",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:120 vdelecroix]:
> Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...

Why not. It will increase the tarball size of something like 200 kbytes.



---

archive/issue_comments_318260.json:
```json
{
    "body": "Replying to [comment:121 dimpase]:\n> Replying to [comment:120 vdelecroix]:\n> > Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...\n>  \n> -1. I'd rather run the installation twice than this.\n\nWhy ? (I personally have no preferences between the two solutions).",
    "created_at": "2019-01-31T13:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318260",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:121 dimpase]:
> Replying to [comment:120 vdelecroix]:
> > Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...
>  
> -1. I'd rather run the installation twice than this.

Why ? (I personally have no preferences between the two solutions).



---

archive/issue_comments_318261.json:
```json
{
    "body": "Replying to [comment:122 vklein]:\n> Replying to [comment:120 vdelecroix]:\n> > Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...\n> \n> Why not. It will increase the tarball size of something like 200 kbytes.\n\nThe external tarball can contain extra 200K, sure, but already \"just copying\" has to be done properly, in order not to break package de-installation.\nBesides, there is no guarantee it would look nice enough, so that it matches the current Sage docs style, etc.",
    "created_at": "2019-01-31T13:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318261",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:122 vklein]:
> Replying to [comment:120 vdelecroix]:
> > Alternative: include the compiled doc in the source tarball so that the spkg-install script just need to copy it...
> 
> Why not. It will increase the tarball size of something like 200 kbytes.

The external tarball can contain extra 200K, sure, but already "just copying" has to be done properly, in order not to break package de-installation.
Besides, there is no guarantee it would look nice enough, so that it matches the current Sage docs style, etc.



---

archive/issue_comments_318262.json:
```json
{
    "body": "Ok i see. And i agree that having the same sphinx install generating both documentation is a good thing.",
    "created_at": "2019-01-31T13:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318262",
    "user": "https://github.com/vinklein"
}
```

Ok i see. And i agree that having the same sphinx install generating both documentation is a good thing.



---

archive/issue_comments_318263.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-02-01T08:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_318264.json:
```json
{
    "body": "Upgrade pplpy to 8.2.\\\\\nRebase on sage 8.7.beta1.\\\\\n\\\\\nFor the doc generation, i think we can go with the double compilation now and switch\\\\\nto a better solution later if we find one.",
    "created_at": "2019-02-01T08:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318264",
    "user": "https://github.com/vinklein"
}
```

Upgrade pplpy to 8.2.\\
Rebase on sage 8.7.beta1.\\
\\
For the doc generation, i think we can go with the double compilation now and switch\\
to a better solution later if we find one.



---

archive/issue_comments_318265.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-01T08:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318265",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318266.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-01T08:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318266",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318267.json:
```json
{
    "body": "Rewrite ticket history.",
    "created_at": "2019-02-01T08:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318267",
    "user": "https://github.com/vinklein"
}
```

Rewrite ticket history.



---

archive/issue_comments_318268.json:
```json
{
    "body": "To my mind, a better solution has to be found for\n\n```\n+    # Compile pplpy's documentation\n+    sage-python23 setup.py build_ext --inplace\n+    PYTHONPATH=$PYTHONPATH:$(pwd)\n+    cd docs\n+    $MAKE html\n```\n",
    "created_at": "2019-02-01T11:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318268",
    "user": "https://github.com/videlec"
}
```

To my mind, a better solution has to be found for

```
+    # Compile pplpy's documentation
+    sage-python23 setup.py build_ext --inplace
+    PYTHONPATH=$PYTHONPATH:$(pwd)
+    cd docs
+    $MAKE html
```




---

archive/issue_comments_318269.json:
```json
{
    "body": "As long as gmpy2 is optional, this package cannot be standard, as it depends on gmpy2.\n\n(Edit - I misread the ticket description, hence the edit). I recall last time there was a discussion about gmpy2 being standard, there were quite a bit of objections. Do they still stand?",
    "created_at": "2019-02-01T12:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318269",
    "user": "https://github.com/dimpase"
}
```

As long as gmpy2 is optional, this package cannot be standard, as it depends on gmpy2.

(Edit - I misread the ticket description, hence the edit). I recall last time there was a discussion about gmpy2 being standard, there were quite a bit of objections. Do they still stand?



---

archive/issue_comments_318270.json:
```json
{
    "body": "Yes, this is the discussion link https://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A.\n\nThe discussion/objections where more about what types pplpy should return (Sage numbers or gmpy2 numbers).\n\nThe last 3 messages for gmpy2 solution have never been answered, but rereading the thread it's true that it doesn't mean that we have an explicit consensus.\n\nI put this ticket on hold in wait for better solution for generating documentation.\\\\\n\nI will repost on the discussion thread when this ticket is ready.",
    "created_at": "2019-02-01T16:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318270",
    "user": "https://github.com/vinklein"
}
```

Yes, this is the discussion link https://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A.

The discussion/objections where more about what types pplpy should return (Sage numbers or gmpy2 numbers).

The last 3 messages for gmpy2 solution have never been answered, but rereading the thread it's true that it doesn't mean that we have an explicit consensus.

I put this ticket on hold in wait for better solution for generating documentation.\\

I will repost on the discussion thread when this ticket is ready.



---

archive/issue_comments_318271.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-01T16:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318271",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318272.json:
```json
{
    "body": "Replying to [comment:130 vdelecroix]:\n> To my mind, a better solution has to be found for\n> {{{\n> +    # Compile pplpy's documentation\n> +    sage-python23 setup.py build_ext --inplace\n> +    PYTHONPATH=$PYTHONPATH:$(pwd)\n> +    cd docs\n> +    $MAKE html\n> }}}\n\nthe question is - are you prepared to patch pplpy sources?\nComparing their docs/Makefile with https://github.com/sagemath/sagenb/blob/master/doc/Makefile\nseems to say that there are sphinx options one might try to use to do everything in one build, not in two.",
    "created_at": "2019-02-01T23:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318272",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:130 vdelecroix]:
> To my mind, a better solution has to be found for
> {{{
> +    # Compile pplpy's documentation
> +    sage-python23 setup.py build_ext --inplace
> +    PYTHONPATH=$PYTHONPATH:$(pwd)
> +    cd docs
> +    $MAKE html
> }}}

the question is - are you prepared to patch pplpy sources?
Comparing their docs/Makefile with https://github.com/sagemath/sagenb/blob/master/doc/Makefile
seems to say that there are sphinx options one might try to use to do everything in one build, not in two.



---

archive/issue_comments_318273.json:
```json
{
    "body": "I haven't find a decisive difference between the two Makefile. The most obvious one being that pplpy use `sphinx-build -b` and sagenb use `sphinx-build -M`.\\\\\n\\\\\nI have tried with `-M` and get the same result.\\\\\nI think the reason it works with `sagenb` is because it doesn't have cython files and therefore the source directory is enough for the sphinx build to succeed.",
    "created_at": "2019-02-06T10:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318273",
    "user": "https://github.com/vinklein"
}
```

I haven't find a decisive difference between the two Makefile. The most obvious one being that pplpy use `sphinx-build -b` and sagenb use `sphinx-build -M`.\\
\\
I have tried with `-M` and get the same result.\\
I think the reason it works with `sagenb` is because it doesn't have cython files and therefore the source directory is enough for the sphinx build to succeed.



---

archive/issue_comments_318274.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-14T14:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318274",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318275.json:
```json
{
    "body": "Add a workaround to avoid two build and rebase on 8.7.beta3.",
    "created_at": "2019-02-14T14:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318275",
    "user": "https://github.com/vinklein"
}
```

Add a workaround to avoid two build and rebase on 8.7.beta3.



---

archive/issue_comments_318276.json:
```json
{
    "body": "It is not working for me\n\n```\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.constraint'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.constraint\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.linear_algebra'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.linear_algebra\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.generator'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.generator\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.polyhedron'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.polyhedron\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.mip_problem'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.mip_problem\n```\n",
    "created_at": "2019-02-14T14:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318276",
    "user": "https://github.com/videlec"
}
```

It is not working for me

```
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl'; the following exception was raised:
[pplpy-0.8.2] No module named ppl
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.constraint'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.constraint
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.linear_algebra'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.linear_algebra
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.generator'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.generator
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.polyhedron'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.polyhedron
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.mip_problem'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.mip_problem
```




---

archive/issue_comments_318277.json:
```json
{
    "body": "And shouldn't `python` be `python23`?",
    "created_at": "2019-02-14T14:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318277",
    "user": "https://github.com/videlec"
}
```

And shouldn't `python` be `python23`?



---

archive/issue_comments_318278.json:
```json
{
    "body": "And the command you provided is very suspicious to me. Inside the sage shell\n\n```\n$ python -c \"import site; print(site.getusersitepackages().replace(site.getuserbase(), ''))\"\n/home/vincent/.sage/local/lib/python2.7/site-packages\n```\n\nAnd using string `replace` is not an option\n\n```\n>>> import site\n>>> site.getusersitepackages()\n'/home/vincent/.sage/local/lib/python2.7/site-packages'\n>>> site.getuserbase()\n'/home/vincent/.sage//local'\n```\n",
    "created_at": "2019-02-14T14:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318278",
    "user": "https://github.com/videlec"
}
```

And the command you provided is very suspicious to me. Inside the sage shell

```
$ python -c "import site; print(site.getusersitepackages().replace(site.getuserbase(), ''))"
/home/vincent/.sage/local/lib/python2.7/site-packages
```

And using string `replace` is not an option

```
>>> import site
>>> site.getusersitepackages()
'/home/vincent/.sage/local/lib/python2.7/site-packages'
>>> site.getuserbase()
'/home/vincent/.sage//local'
```




---

archive/issue_comments_318279.json:
```json
{
    "body": "This already looks more reasonable\n\n```\n>>> import sysconfig\n>>> sysconfig.get_paths(expand=False)\n{'purelib': '{base}/lib/python{py_version_short}/site-packages',\n 'stdlib': '{base}/lib/python{py_version_short}',\n 'scripts': '{base}/bin',\n 'platinclude': '{platbase}/include/python{py_version_short}',\n 'include': '{base}/include/python{py_version_short}',\n 'data': '{base}', 'platstdlib':\n '{platbase}/lib/python{py_version_short}',\n 'platlib': '{platbase}/lib/python{py_version_short}/site-packages'\n}\n```\n",
    "created_at": "2019-02-14T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318279",
    "user": "https://github.com/videlec"
}
```

This already looks more reasonable

```
>>> import sysconfig
>>> sysconfig.get_paths(expand=False)
{'purelib': '{base}/lib/python{py_version_short}/site-packages',
 'stdlib': '{base}/lib/python{py_version_short}',
 'scripts': '{base}/bin',
 'platinclude': '{platbase}/include/python{py_version_short}',
 'include': '{base}/include/python{py_version_short}',
 'data': '{base}', 'platstdlib':
 '{platbase}/lib/python{py_version_short}',
 'platlib': '{platbase}/lib/python{py_version_short}/site-packages'
}
```




---

archive/issue_comments_318280.json:
```json
{
    "body": "I believe that what you want is\n\n```\n>>> import sysconfig\n>>> py_version_short = sysconfig.get_config_vars()['py_version_short']\n>>> path = sysconfig.get_path('platlib', expand=False)\n>>> path.format(platbase=\"$SAGE_DESTDIR_LOCAL\", py_version_short=py_version_short)\n'$SAGE_DESTDIR_LOCAL/lib/python2.7/site-packages'\n```\n",
    "created_at": "2019-02-14T14:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318280",
    "user": "https://github.com/videlec"
}
```

I believe that what you want is

```
>>> import sysconfig
>>> py_version_short = sysconfig.get_config_vars()['py_version_short']
>>> path = sysconfig.get_path('platlib', expand=False)
>>> path.format(platbase="$SAGE_DESTDIR_LOCAL", py_version_short=py_version_short)
'$SAGE_DESTDIR_LOCAL/lib/python2.7/site-packages'
```




---

archive/issue_comments_318281.json:
```json
{
    "body": "the site module is already supposed to do the job in a generic way : \n\n\n```\ndef _get_path(userbase):\n    version = sys.version_info\n\n    if os.name == 'nt':\n        return f'{userbase}\\\\Python{version[0]}{version[1]}\\\\site-packages'\n\n    if sys.platform == 'darwin' and sys._framework:\n        return f'{userbase}/lib/python/site-packages'\n\n    return f'{userbase}/lib/python{version[0]}.{version[1]}/site-packages'\n```\n\n\nPython version is not always used",
    "created_at": "2019-02-14T15:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318281",
    "user": "https://github.com/vinklein"
}
```

the site module is already supposed to do the job in a generic way : 


```
def _get_path(userbase):
    version = sys.version_info

    if os.name == 'nt':
        return f'{userbase}\\Python{version[0]}{version[1]}\\site-packages'

    if sys.platform == 'darwin' and sys._framework:
        return f'{userbase}/lib/python/site-packages'

    return f'{userbase}/lib/python{version[0]}.{version[1]}/site-packages'
```


Python version is not always used



---

archive/issue_comments_318282.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-14T15:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318282",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318283.json:
```json
{
    "body": "Replying to [comment:138 vdelecroix]:\n> And shouldn't `python` be `python23`?\nYes you are right.\\\\\nWorkaround fixed and enhanced with Erik Bray's help.",
    "created_at": "2019-02-14T15:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318283",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:138 vdelecroix]:
> And shouldn't `python` be `python23`?
Yes you are right.\\
Workaround fixed and enhanced with Erik Bray's help.



---

archive/issue_comments_318284.json:
```json
{
    "body": "Same as before\n\n```\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.constraint'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.constraint\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.linear_algebra'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.linear_algebra\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.generator'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.generator\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.polyhedron'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.polyhedron\n[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.mip_problem'; the following exception was raised:\n[pplpy-0.8.2] No module named ppl.mip_problem\n```\n",
    "created_at": "2019-02-14T15:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318284",
    "user": "https://github.com/videlec"
}
```

Same as before

```
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl'; the following exception was raised:
[pplpy-0.8.2] No module named ppl
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.constraint'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.constraint
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.linear_algebra'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.linear_algebra
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.generator'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.generator
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.polyhedron'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.polyhedron
[pplpy-0.8.2] WARNING: autodoc: failed to import module u'ppl.mip_problem'; the following exception was raised:
[pplpy-0.8.2] No module named ppl.mip_problem
```




---

archive/issue_comments_318285.json:
```json
{
    "body": "Can you post or mail me the whole log ?",
    "created_at": "2019-02-14T15:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318285",
    "user": "https://github.com/vinklein"
}
```

Can you post or mail me the whole log ?



---

archive/issue_comments_318286.json:
```json
{
    "body": "Ok i have an obvious bug in my `spgk_install` file",
    "created_at": "2019-02-14T15:53:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318286",
    "user": "https://github.com/vinklein"
}
```

Ok i have an obvious bug in my `spgk_install` file



---

archive/issue_comments_318287.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-14T20:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318288.json:
```json
{
    "body": "It's fixed sorry for the previous commit.",
    "created_at": "2019-02-14T20:46:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318288",
    "user": "https://github.com/vinklein"
}
```

It's fixed sorry for the previous commit.



---

archive/issue_comments_318289.json:
```json
{
    "body": "Why does sphinx inventory connect to internet!?\n\n```\n[pplpy-0.8.2] loading intersphinx inventory from http://docs.python.org/objects.inv...\n```\n",
    "created_at": "2019-02-14T20:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318289",
    "user": "https://github.com/videlec"
}
```

Why does sphinx inventory connect to internet!?

```
[pplpy-0.8.2] loading intersphinx inventory from http://docs.python.org/objects.inv...
```




---

archive/issue_comments_318290.json:
```json
{
    "body": "I believe because of `pplpy's` `conf.py` last line :\n\n```\n# Example configuration for intersphinx: refer to the Python standard library.\nintersphinx_mapping = {'http://docs.python.org/': None}\n```\n\n\nThis says pplpy's intersphinx needs python's `objects.inv`.\n\nWich isn't true if i am not wrong ( I don't remember a sphinx link to python documentation in pplpy's documentation)",
    "created_at": "2019-02-14T21:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318290",
    "user": "https://github.com/vinklein"
}
```

I believe because of `pplpy's` `conf.py` last line :

```
# Example configuration for intersphinx: refer to the Python standard library.
intersphinx_mapping = {'http://docs.python.org/': None}
```


This says pplpy's intersphinx needs python's `objects.inv`.

Wich isn't true if i am not wrong ( I don't remember a sphinx link to python documentation in pplpy's documentation)



---

archive/issue_comments_318291.json:
```json
{
    "body": "new tarball ready",
    "created_at": "2019-02-14T22:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318291",
    "user": "https://github.com/videlec"
}
```

new tarball ready



---

archive/issue_comments_318292.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-14T22:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318293.json:
```json
{
    "body": "Ticket ready for review.\n\nDon't set this ticket to positive review right now.\\\\\nWe need to clarify the discussion \nhttps://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A first.",
    "created_at": "2019-02-14T23:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318293",
    "user": "https://github.com/vinklein"
}
```

Ticket ready for review.

Don't set this ticket to positive review right now.\\
We need to clarify the discussion 
https://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A first.



---

archive/issue_comments_318294.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-14T23:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318294",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318295.json:
```json
{
    "body": "Replying to [comment:154 vklein]:\n> Don't set this ticket to positive review right now.\\\\\n> We need to clarify the discussion \n> https://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A first.\n\nWhat is the status of the discussion now?",
    "created_at": "2019-02-18T10:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318295",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:154 vklein]:
> Don't set this ticket to positive review right now.\\
> We need to clarify the discussion 
> https://groups.google.com/forum/?#!topic/sage-devel/qoxVng1__0A first.

What is the status of the discussion now?



---

archive/issue_comments_318296.json:
```json
{
    "body": "Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).",
    "created_at": "2019-02-19T10:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318296",
    "user": "https://github.com/videlec"
}
```

Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).



---

archive/issue_comments_318297.json:
```json
{
    "body": "Replying to [comment:156 vdelecroix]:\n> Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).\n\nYes that's true. The reason to keep the documentation build in `spkg-inst` is because it's currently the standard way of doing it. Tell me what you prefer.",
    "created_at": "2019-02-19T12:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318297",
    "user": "https://github.com/vinklein"
}
```

Replying to [comment:156 vdelecroix]:
> Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).

Yes that's true. The reason to keep the documentation build in `spkg-inst` is because it's currently the standard way of doing it. Tell me what you prefer.



---

archive/issue_comments_318298.json:
```json
{
    "body": "Replying to [comment:157 vklein]:\n> Replying to [comment:156 vdelecroix]:\n> > Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).\n> \n> Yes that's true. The reason to keep the documentation build in `spkg-inst` is because it's currently the standard way of doing it. Tell me what you prefer.\n\nTo my knowledge, no package had this problem before (ie building the doc depending on the library being installed). Everything that would avoid modifying `PYTHONPATH` looks nicer to me. But that is my own feeling.",
    "created_at": "2019-02-19T13:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318298",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:157 vklein]:
> Replying to [comment:156 vdelecroix]:
> > Note: for the documentation build, there is also the possibility to use the `spkg-postinst` script (that is run after the installation in `$SAGE_LOCAL`).
> 
> Yes that's true. The reason to keep the documentation build in `spkg-inst` is because it's currently the standard way of doing it. Tell me what you prefer.

To my knowledge, no package had this problem before (ie building the doc depending on the library being installed). Everything that would avoid modifying `PYTHONPATH` looks nicer to me. But that is my own feeling.



---

archive/issue_comments_318299.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-19T14:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318300.json:
```json
{
    "body": "Ok seems fair. `spkg-postinst` script added.",
    "created_at": "2019-02-19T14:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318300",
    "user": "https://github.com/vinklein"
}
```

Ok seems fair. `spkg-postinst` script added.



---

archive/issue_comments_318301.json:
```json
{
    "body": "Having a comment in the `spkg-install` script is good but I think that it would be even nicer with an explanation of why this is moved inside the `spkg-postinst` script.",
    "created_at": "2019-02-19T14:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318301",
    "user": "https://github.com/videlec"
}
```

Having a comment in the `spkg-install` script is good but I think that it would be even nicer with an explanation of why this is moved inside the `spkg-postinst` script.



---

archive/issue_comments_318302.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-19T14:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318302",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318303.json:
```json
{
    "body": "Ok, explanation added.",
    "created_at": "2019-02-19T14:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318303",
    "user": "https://github.com/vinklein"
}
```

Ok, explanation added.



---

archive/issue_comments_318304.json:
```json
{
    "body": "The current status is good for me. Thanks Vincent.\n\nAny comment Dima?",
    "created_at": "2019-02-19T14:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318304",
    "user": "https://github.com/videlec"
}
```

The current status is good for me. Thanks Vincent.

Any comment Dima?



---

archive/issue_comments_318305.json:
```json
{
    "body": "How about src/sage/numerical/backends/ppl_backend.pyx ?\nDo you at least have a ticket to work on replacing this with pplpy?",
    "created_at": "2019-02-20T07:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318305",
    "user": "https://github.com/dimpase"
}
```

How about src/sage/numerical/backends/ppl_backend.pyx ?
Do you at least have a ticket to work on replacing this with pplpy?



---

archive/issue_comments_318306.json:
```json
{
    "body": "ppl_backend.pyx is modified in this ticket. This is not replaced but `ppl_backend.pyx` methods use pplpy instead of using sage.lib.ppl.\n\nsee: https://git.sagemath.org/sage.git/diff/src/sage/numerical/backends/ppl_backend.pyx?id=fed0a135795f8f076d7ffaf69aecc84f2f096b5d",
    "created_at": "2019-02-20T08:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318306",
    "user": "https://github.com/vinklein"
}
```

ppl_backend.pyx is modified in this ticket. This is not replaced but `ppl_backend.pyx` methods use pplpy instead of using sage.lib.ppl.

see: https://git.sagemath.org/sage.git/diff/src/sage/numerical/backends/ppl_backend.pyx?id=fed0a135795f8f076d7ffaf69aecc84f2f096b5d



---

archive/issue_comments_318307.json:
```json
{
    "body": "`@`Dima tell me if you think it's ok or if you think `ppl_backend.pyx` should be reworked in another way.",
    "created_at": "2019-02-20T09:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318307",
    "user": "https://github.com/vinklein"
}
```

`@`Dima tell me if you think it's ok or if you think `ppl_backend.pyx` should be reworked in another way.



---

archive/issue_comments_318308.json:
```json
{
    "body": "I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.\nPotentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.",
    "created_at": "2019-02-20T09:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318308",
    "user": "https://github.com/dimpase"
}
```

I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.
Potentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.



---

archive/issue_comments_318309.json:
```json
{
    "body": "Replying to [comment:168 dimpase]:\n> I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.\n> Potentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.\n\nThe PPL Coefficient type is hardcoded in the Cython wrapper as\n\n```\nctypedef mpz_class PPL_Coefficient\n```\n\nThis implies that all computations with pplpy are done with GMP mpz. I agree that PPL supports computations with `mpz_class`, `mpq_class` as well as various native integer types (from `char` to `long long`). Nothing has changed on this side yet. This feature request is disjoint from this ticket which aims to be a simple transition from Sage source code to standalone library.",
    "created_at": "2019-02-20T09:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318309",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:168 dimpase]:
> I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.
> Potentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.

The PPL Coefficient type is hardcoded in the Cython wrapper as

```
ctypedef mpz_class PPL_Coefficient
```

This implies that all computations with pplpy are done with GMP mpz. I agree that PPL supports computations with `mpz_class`, `mpq_class` as well as various native integer types (from `char` to `long long`). Nothing has changed on this side yet. This feature request is disjoint from this ticket which aims to be a simple transition from Sage source code to standalone library.



---

archive/issue_comments_318310.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-20T09:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318310",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318311.json:
```json
{
    "body": "looks good to me then.",
    "created_at": "2019-02-20T09:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318311",
    "user": "https://github.com/dimpase"
}
```

looks good to me then.



---

archive/issue_comments_318312.json:
```json
{
    "body": "Replying to [comment:169 vdelecroix]:\n> Replying to [comment:168 dimpase]:\n> > I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.\n> > Potentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.\n> \n> The PPL Coefficient type is hardcoded in the Cython wrapper as\n> {{{\n> ctypedef mpz_class PPL_Coefficient\n> }}}\n> This implies that all computations with pplpy are done with GMP mpz. I agree that PPL supports computations with `mpz_class`, `mpq_class` as well as various native integer types (from `char` to `long long`). Nothing has changed on this side yet. This feature request is disjoint from this ticket which aims to be a simple transition from Sage source code to standalone library.\n\nThis is high priority and I opened an issue: https://gitlab.com/videlec/pplpy/issues/14",
    "created_at": "2019-02-20T09:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318312",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:169 vdelecroix]:
> Replying to [comment:168 dimpase]:
> > I recall that ppl_backend.pyx had a tricky part due to the inability of PPL to work with rationals - everything had to be integer. I don't know whether this is still the case.
> > Potentially, if it, or/and pplpy can now work directly with rationals, it might be worthwhile to change, as computing common denominators lead to blowup of coefficients.
> 
> The PPL Coefficient type is hardcoded in the Cython wrapper as
> {{{
> ctypedef mpz_class PPL_Coefficient
> }}}
> This implies that all computations with pplpy are done with GMP mpz. I agree that PPL supports computations with `mpz_class`, `mpq_class` as well as various native integer types (from `char` to `long long`). Nothing has changed on this side yet. This feature request is disjoint from this ticket which aims to be a simple transition from Sage source code to standalone library.

This is high priority and I opened an issue: https://gitlab.com/videlec/pplpy/issues/14



---

archive/issue_comments_318313.json:
```json
{
    "body": "Thanks to all reviewers.",
    "created_at": "2019-02-20T10:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318313",
    "user": "https://github.com/vinklein"
}
```

Thanks to all reviewers.



---

archive/issue_comments_318314.json:
```json
{
    "body": "merge conflict",
    "created_at": "2019-02-22T23:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318314",
    "user": "https://github.com/vbraun"
}
```

merge conflict



---

archive/issue_comments_318315.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-22T23:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318315",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_318316.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-25T09:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318316",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318317.json:
```json
{
    "body": "Rebase on 8.7.beta5",
    "created_at": "2019-02-25T09:29:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318317",
    "user": "https://github.com/vinklein"
}
```

Rebase on 8.7.beta5



---

archive/issue_comments_318318.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-25T09:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318318",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318319.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-25T09:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318319",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318320.json:
```json
{
    "body": "Looking at the diff, I have several minor comments:\n\n1. Don't change whitespace in `src/module_list.py` for no good reason.\n\n2. In various places, you use `list(...)`. Why not use a list comprehension instead?\n\n3. In multi-line imports, the preferred style is to use parentheses instead of `\\`.\n\n4. The deprecation message is really strangely formatted: it shouldn't start with a newline and there shouldn't be a huge amount of indentation in the second line. I would probably write it all on one line without any newlines at all.\n\n5. What's the meaning of the `/...` at the start of the deprecation warnings in doctests? I have never seen that.\n\n6. In `_add_rational_constraint`, why do you `cdef Rational rhs`? Since `numerator` and `denominator` are pure Python methods, this is a pessimization.",
    "created_at": "2019-02-25T09:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318320",
    "user": "https://github.com/jdemeyer"
}
```

Looking at the diff, I have several minor comments:

1. Don't change whitespace in `src/module_list.py` for no good reason.

2. In various places, you use `list(...)`. Why not use a list comprehension instead?

3. In multi-line imports, the preferred style is to use parentheses instead of `\`.

4. The deprecation message is really strangely formatted: it shouldn't start with a newline and there shouldn't be a huge amount of indentation in the second line. I would probably write it all on one line without any newlines at all.

5. What's the meaning of the `/...` at the start of the deprecation warnings in doctests? I have never seen that.

6. In `_add_rational_constraint`, why do you `cdef Rational rhs`? Since `numerator` and `denominator` are pure Python methods, this is a pessimization.



---

archive/issue_comments_318321.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-25T09:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318321",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_318322.json:
```json
{
    "body": "Replying to [comment:178 jdemeyer]:\n> Looking at the diff, I have several minor comments:\n> 2. In various places, you use `list(...)`. Why not use a list comprehension instead?\n\nI wonder if there shouldn't be something like this mentioned in the developer docs (do we have a style guide)?\n\nThis is a comment I've made in review on dozens of tickets at this point.\n\nShort list comprehensions (it's trickier when they get nested) are *often* clearer than any alternative, and are usually much more efficient from the Python interpreter's standpoint as well.",
    "created_at": "2019-02-25T10:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318322",
    "user": "https://github.com/embray"
}
```

Replying to [comment:178 jdemeyer]:
> Looking at the diff, I have several minor comments:
> 2. In various places, you use `list(...)`. Why not use a list comprehension instead?

I wonder if there shouldn't be something like this mentioned in the developer docs (do we have a style guide)?

This is a comment I've made in review on dozens of tickets at this point.

Short list comprehensions (it's trickier when they get nested) are *often* clearer than any alternative, and are usually much more efficient from the Python interpreter's standpoint as well.



---

archive/issue_comments_318323.json:
```json
{
    "body": "> 5. What's the meaning of the `/...` at the start of the deprecation warnings in doctests? I have never seen that.\n\nIt means the line begin with `/` then something before `DeprecationWarning...`.\nI think i have done that because the `print(err)` result begin by the path `$SAGE_LOCAL/src/bin/sage-eval`.",
    "created_at": "2019-02-25T10:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318323",
    "user": "https://github.com/vinklein"
}
```

> 5. What's the meaning of the `/...` at the start of the deprecation warnings in doctests? I have never seen that.

It means the line begin with `/` then something before `DeprecationWarning...`.
I think i have done that because the `print(err)` result begin by the path `$SAGE_LOCAL/src/bin/sage-eval`.



---

archive/issue_comments_318324.json:
```json
{
    "body": "I see now. Those aren't \"normal\" doctests, they are actually run in a subprocess.",
    "created_at": "2019-02-25T11:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318324",
    "user": "https://github.com/jdemeyer"
}
```

I see now. Those aren't "normal" doctests, they are actually run in a subprocess.



---

archive/issue_comments_318325.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-25T12:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318325",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318326.json:
```json
{
    "body": "Comments 1,2,3,4 and 6 implemented.",
    "created_at": "2019-02-25T12:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318326",
    "user": "https://github.com/vinklein"
}
```

Comments 1,2,3,4 and 6 implemented.



---

archive/issue_comments_318327.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-25T12:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318327",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318328.json:
```json
{
    "body": "Jeroen?",
    "created_at": "2019-02-27T08:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318328",
    "user": "https://github.com/videlec"
}
```

Jeroen?



---

archive/issue_comments_318329.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-27T08:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318329",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318330.json:
```json
{
    "body": "Good for me if this passes doctests (I haven't checked)",
    "created_at": "2019-02-27T08:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318330",
    "user": "https://github.com/jdemeyer"
}
```

Good for me if this passes doctests (I haven't checked)



---

archive/issue_comments_318331.json:
```json
{
    "body": "Replying to [comment:186 jdemeyer]:\n> Good for me if this passes doctests (I haven't checked)\n\nThis I did (and I belive Vincent K also)",
    "created_at": "2019-02-27T09:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318331",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:186 jdemeyer]:
> Good for me if this passes doctests (I haven't checked)

This I did (and I belive Vincent K also)



---

archive/issue_comments_318332.json:
```json
{
    "body": "After the last commit i only did tests on all modified files and everything under `sage/geometry`. I will launch a `sage -t -a --long` just to be extra sure.",
    "created_at": "2019-02-27T09:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318332",
    "user": "https://github.com/vinklein"
}
```

After the last commit i only did tests on all modified files and everything under `sage/geometry`. I will launch a `sage -t -a --long` just to be extra sure.



---

archive/issue_comments_318333.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-02-28T13:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318333",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_318334.json:
```json
{
    "body": "I would like to test this on Windows.  I can do that in a few minutes.",
    "created_at": "2019-02-28T13:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318334",
    "user": "https://github.com/embray"
}
```

I would like to test this on Windows.  I can do that in a few minutes.



---

archive/issue_comments_318335.json:
```json
{
    "body": "Set assignee to @embray.",
    "created_at": "2019-02-28T13:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318335",
    "user": "https://github.com/embray"
}
```

Set assignee to @embray.



---

archive/issue_comments_318336.json:
```json
{
    "body": "One minor comment just looking at the patch: To complement the `pplpy/spkg-postinst` script, it would be good, albeit not strictly necessary, to include a `pplpy/spkg-postrm` script that removes that documentation directory in its entirety, if it was installed.  That way it's a bit tidier if you also remove or upgrade pplpy and its documentation changes.",
    "created_at": "2019-02-28T14:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318336",
    "user": "https://github.com/embray"
}
```

One minor comment just looking at the patch: To complement the `pplpy/spkg-postinst` script, it would be good, albeit not strictly necessary, to include a `pplpy/spkg-postrm` script that removes that documentation directory in its entirety, if it was installed.  That way it's a bit tidier if you also remove or upgrade pplpy and its documentation changes.



---

archive/issue_comments_318337.json:
```json
{
    "body": "Ok, when exactly are `spkg-postrm` scripts called ? `sage -f pkgname` after the uninstall ?\n\nAnyways i will wait for Owner field to be empty before pushing any new commit.",
    "created_at": "2019-02-28T14:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318337",
    "user": "https://github.com/vinklein"
}
```

Ok, when exactly are `spkg-postrm` scripts called ? `sage -f pkgname` after the uninstall ?

Anyways i will wait for Owner field to be empty before pushing any new commit.



---

archive/issue_comments_318338.json:
```json
{
    "body": "Yeah, pplpy doesn't build on Cygwin:\n\n\n```\n[pplpy-0.8.3]     g++ -shared -Wl,--enable-auto-image-base -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o build/temp.cygwin-2.9.0-x86_64-2.7/ppl/ppl_shim.o -L/home/embray/src/sagemath/sage/local/lib/python2.7/config -L/home/embray/src/sagemath/sage/local/lib -lppl -lm -lpython2.7 -o build/lib.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.dll\n[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::clear()':\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40661: undefined reference to `__imp___gmpz_set_ui'\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40661:(.text+0x14c): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_set_ui'\n[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::~Bit_Row()':\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40618: undefined reference to `__imp___gmpz_clear'\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40618:(.text+0x235): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_clear'\n[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `__pyx_pf_3ppl_10bit_arrays_7Bit_Row___cinit__':\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40588: undefined reference to `__imp___gmpz_init'\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40588:(.text+0x2c9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_init'\n[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::clear_from(unsigned long)':\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40639: undefined reference to `__imp___gmpz_tdiv_r_2exp'\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40639:(.text+0x1dd0): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_tdiv_r_2exp'\n[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::set(unsigned long)':\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40629: undefined reference to `__imp___gmpz_setbit'\n[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40629:(.text+0x239d): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_setbit'\n[pplpy-0.8.3]     collect2: error: ld returned 1 exit status\n[pplpy-0.8.3]     error: command 'g++' failed with exit status 1\n[pplpy-0.8.3]     Running setup.py install for pplpy: finished with status 'error'\n```\n\n\nThis looks...unsurprising to me. I think I can fix this easily-enough, I hope.",
    "created_at": "2019-02-28T14:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318338",
    "user": "https://github.com/embray"
}
```

Yeah, pplpy doesn't build on Cygwin:


```
[pplpy-0.8.3]     g++ -shared -Wl,--enable-auto-image-base -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o build/temp.cygwin-2.9.0-x86_64-2.7/ppl/ppl_shim.o -L/home/embray/src/sagemath/sage/local/lib/python2.7/config -L/home/embray/src/sagemath/sage/local/lib -lppl -lm -lpython2.7 -o build/lib.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.dll
[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::clear()':
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40661: undefined reference to `__imp___gmpz_set_ui'
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40661:(.text+0x14c): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_set_ui'
[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::~Bit_Row()':
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40618: undefined reference to `__imp___gmpz_clear'
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40618:(.text+0x235): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_clear'
[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `__pyx_pf_3ppl_10bit_arrays_7Bit_Row___cinit__':
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40588: undefined reference to `__imp___gmpz_init'
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40588:(.text+0x2c9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_init'
[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::clear_from(unsigned long)':
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40639: undefined reference to `__imp___gmpz_tdiv_r_2exp'
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40639:(.text+0x1dd0): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_tdiv_r_2exp'
[pplpy-0.8.3]     build/temp.cygwin-2.9.0-x86_64-2.7/ppl/bit_arrays.o: In function `Parma_Polyhedra_Library::Bit_Row::set(unsigned long)':
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40629: undefined reference to `__imp___gmpz_setbit'
[pplpy-0.8.3]     /home/embray/src/sagemath/sage/local/include/ppl.hh:40629:(.text+0x239d): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___gmpz_setbit'
[pplpy-0.8.3]     collect2: error: ld returned 1 exit status
[pplpy-0.8.3]     error: command 'g++' failed with exit status 1
[pplpy-0.8.3]     Running setup.py install for pplpy: finished with status 'error'
```


This looks...unsurprising to me. I think I can fix this easily-enough, I hope.



---

archive/issue_comments_318339.json:
```json
{
    "body": "Replying to [comment:192 vklein]:\n> Ok, when exactly are `spkg-postrm` scripts called ? `sage -f pkgname` after the uninstall ?\n\nBasically, at the end of `sage-spkg-uninstall` (which is called by `sage -f` among other things).  This is also called when upgrading a package so that's why I thought it might matter eventually, at least in a minor way.",
    "created_at": "2019-02-28T14:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318339",
    "user": "https://github.com/embray"
}
```

Replying to [comment:192 vklein]:
> Ok, when exactly are `spkg-postrm` scripts called ? `sage -f pkgname` after the uninstall ?

Basically, at the end of `sage-spkg-uninstall` (which is called by `sage -f` among other things).  This is also called when upgrading a package so that's why I thought it might matter eventually, at least in a minor way.



---

archive/issue_comments_318340.json:
```json
{
    "body": "**Upstream PR:** https://gitlab.com/videlec/pplpy/merge_requests/6\n\nWe can either see if Vincent wants to make an 0.8.4 release for this fix, or I'm just as happy for now to include this as a patch in the Sage SPKG.",
    "created_at": "2019-02-28T15:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318340",
    "user": "https://github.com/embray"
}
```

**Upstream PR:** https://gitlab.com/videlec/pplpy/merge_requests/6

We can either see if Vincent wants to make an 0.8.4 release for this fix, or I'm just as happy for now to include this as a patch in the Sage SPKG.



---

archive/issue_comments_318341.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-28T15:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318341",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318342.json:
```json
{
    "body": "Replying to [comment:195 embray]:\n> **Upstream PR:** https://gitlab.com/videlec/pplpy/merge_requests/6\n> \n> We can either see if Vincent wants to make an 0.8.4 release for this fix, or I'm just as happy for now to include this as a patch in the Sage SPKG.\n\nLet us do that.",
    "created_at": "2019-02-28T15:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318342",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:195 embray]:
> **Upstream PR:** https://gitlab.com/videlec/pplpy/merge_requests/6
> 
> We can either see if Vincent wants to make an 0.8.4 release for this fix, or I'm just as happy for now to include this as a patch in the Sage SPKG.

Let us do that.



---

archive/issue_comments_318343.json:
```json
{
    "body": "(the release 0.8.4)",
    "created_at": "2019-02-28T15:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318343",
    "user": "https://github.com/videlec"
}
```

(the release 0.8.4)



---

archive/issue_comments_318344.json:
```json
{
    "body": "new release (ticket description updated)",
    "created_at": "2019-02-28T15:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318344",
    "user": "https://github.com/videlec"
}
```

new release (ticket description updated)



---

archive/issue_comments_318345.json:
```json
{
    "body": "That was quick, thank you :)\n\nNot sure yet if it's a showstopper, but I'm also having a weird problem with error handling in the gmpy2 in Sage.  This following example should raise a `TypeError` exception:\n\n\n```\n$ python -c 'import gmpy2;  gmpy2.is_fermat_prp(1234, \"a\")'\nAborted (core dumped)\n```\n\n\nI also built the latest gmpy2 from source, and when I run it in that source tree I get the correct behavior:\n\n\n```\n$ python -c 'import gmpy2;  gmpy2.is_fermat_prp(1234, \"a\")'\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nTypeError: is_fermat_prp() requires 2 integer arguments\n```\n\n\nPerhaps it was just a bug in gmpy2 that has since been fixed upstream?  Not sure.",
    "created_at": "2019-02-28T15:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318345",
    "user": "https://github.com/embray"
}
```

That was quick, thank you :)

Not sure yet if it's a showstopper, but I'm also having a weird problem with error handling in the gmpy2 in Sage.  This following example should raise a `TypeError` exception:


```
$ python -c 'import gmpy2;  gmpy2.is_fermat_prp(1234, "a")'
Aborted (core dumped)
```


I also built the latest gmpy2 from source, and when I run it in that source tree I get the correct behavior:


```
$ python -c 'import gmpy2;  gmpy2.is_fermat_prp(1234, "a")'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
TypeError: is_fermat_prp() requires 2 integer arguments
```


Perhaps it was just a bug in gmpy2 that has since been fixed upstream?  Not sure.



---

archive/issue_comments_318346.json:
```json
{
    "body": "Indeed, that particular bug was already fixed upstream: https://github.com/aleaxit/gmpy/commit/533a62cf2b2cf3673e1d6b0f3c2d0c64548a3908\n\nI just wanted to make sure.   I think I only hit on it because I was running the tests from gmpy2's current' master branch against our slightly older version, and hit that bug specifically because they added a regression test when they fixed it.  Other than that all `spkg-check` tests pass on Cygwin for gmpy2 and pplpy :)",
    "created_at": "2019-02-28T15:50:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318346",
    "user": "https://github.com/embray"
}
```

Indeed, that particular bug was already fixed upstream: https://github.com/aleaxit/gmpy/commit/533a62cf2b2cf3673e1d6b0f3c2d0c64548a3908

I just wanted to make sure.   I think I only hit on it because I was running the tests from gmpy2's current' master branch against our slightly older version, and hit that bug specifically because they added a regression test when they fixed it.  Other than that all `spkg-check` tests pass on Cygwin for gmpy2 and pplpy :)



---

archive/issue_comments_318347.json:
```json
{
    "body": "All good on my end in terms of Sage doctests, I think.  I'm doing one more full run just to be sure but I can think of no reason it should work differently.\n\nSo just update to the just-released pplpy 0.8.4 and you can set back to postive_review.  The spkg-postrm would be good to have too but I don't consider it a blocker.",
    "created_at": "2019-02-28T15:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318347",
    "user": "https://github.com/embray"
}
```

All good on my end in terms of Sage doctests, I think.  I'm doing one more full run just to be sure but I can think of no reason it should work differently.

So just update to the just-released pplpy 0.8.4 and you can set back to postive_review.  The spkg-postrm would be good to have too but I don't consider it a blocker.



---

archive/issue_comments_318348.json:
```json
{
    "body": "Ok i don't think doing a gmpy2 patch for this commit is worth it. \n\n`@`Erik: Tell me when you're ok and i will update this ticket with `pplpy's` upgrade and `spkg-postrm`.",
    "created_at": "2019-02-28T15:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318348",
    "user": "https://github.com/vinklein"
}
```

Ok i don't think doing a gmpy2 patch for this commit is worth it. 

`@`Erik: Tell me when you're ok and i will update this ticket with `pplpy's` upgrade and `spkg-postrm`.



---

archive/issue_comments_318349.json:
```json
{
    "body": "Changing assignee from @embray to @vinklein.",
    "created_at": "2019-02-28T16:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318349",
    "user": "https://github.com/embray"
}
```

Changing assignee from @embray to @vinklein.



---

archive/issue_comments_318350.json:
```json
{
    "body": "Yep. Once you're done with that feel free to set back to positive_review.",
    "created_at": "2019-02-28T16:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318350",
    "user": "https://github.com/embray"
}
```

Yep. Once you're done with that feel free to set back to positive_review.



---

archive/issue_comments_318351.json:
```json
{
    "body": "Ok thank you for your help.",
    "created_at": "2019-02-28T16:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318351",
    "user": "https://github.com/vinklein"
}
```

Ok thank you for your help.



---

archive/issue_comments_318352.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-28T16:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318353.json:
```json
{
    "body": "Upgrade to pplpy 0.8.4 and add a spkg-postrm script to clean the documentation.\nA reviewer should validate `\u200b829317e` in order to set this ticket in positive review.",
    "created_at": "2019-02-28T16:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318353",
    "user": "https://github.com/vinklein"
}
```

Upgrade to pplpy 0.8.4 and add a spkg-postrm script to clean the documentation.
A reviewer should validate `​829317e` in order to set this ticket in positive review.



---

archive/issue_comments_318354.json:
```json
{
    "body": "Remove assignee @vinklein.",
    "created_at": "2019-02-28T17:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318354",
    "user": "https://github.com/vinklein"
}
```

Remove assignee @vinklein.



---

archive/issue_comments_318355.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-28T17:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318355",
    "user": "https://github.com/vinklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318356.json:
```json
{
    "body": "doing some testing...",
    "created_at": "2019-02-28T17:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318356",
    "user": "https://github.com/videlec"
}
```

doing some testing...



---

archive/issue_comments_318357.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-28T17:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318357",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318358.json:
```json
{
    "body": "`spkg-postrm` works as expected. Thanks Vincent!",
    "created_at": "2019-02-28T17:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318358",
    "user": "https://github.com/videlec"
}
```

`spkg-postrm` works as expected. Thanks Vincent!



---

archive/issue_comments_318359.json:
```json
{
    "body": "Adding \"upgrade\" to keywords to emphasize the need to upload new tarball to our download mirrors.",
    "created_at": "2019-03-01T20:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318359",
    "user": "https://github.com/slel"
}
```

Adding "upgrade" to keywords to emphasize the need to upload new tarball to our download mirrors.



---

archive/issue_comments_318360.json:
```json
{
    "body": "Changing keywords from \"thursdaysbdx, ppl, pplpy\" to \"thursdaysbdx, ppl, pplpy, upgrade\".",
    "created_at": "2019-03-01T20:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318360",
    "user": "https://github.com/slel"
}
```

Changing keywords from "thursdaysbdx, ppl, pplpy" to "thursdaysbdx, ppl, pplpy, upgrade".



---

archive/issue_comments_318361.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-02T09:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318361",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_021417.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-03-02T09:39:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22787#event-21417"
}
```



---

archive/issue_comments_318362.json:
```json
{
    "body": "There were several instances of removal similar to `self._PPL_C_Polyhedron.set_immutable()` - is this functionality no longer supported? This was done for objects that are cached and if a user ever modifies the polyhedron, things will get wrong.",
    "created_at": "2019-03-03T04:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318362",
    "user": "https://github.com/novoselt"
}
```

There were several instances of removal similar to `self._PPL_C_Polyhedron.set_immutable()` - is this functionality no longer supported? This was done for objects that are cached and if a user ever modifies the polyhedron, things will get wrong.



---

archive/issue_comments_318363.json:
```json
{
    "body": "Replying to [comment:213 novoselt]:\n> There were several instances of removal similar to `self._PPL_C_Polyhedron.set_immutable()` - is this functionality no longer supported? This was done for objects that are cached and if a user ever modifies the polyhedron, things will get wrong.\n\nIndeed, it is not supported anymore. Also you can not cache a `PPL_C_Polyhedron`: https://gitlab.com/videlec/pplpy/blob/master/ppl/polyhedron.pyx#L86-102\n\nIn sage, the pplpy polyhedra are only used as attribute from which the user is not supposed to have direct access (unless she knows very well what she is doing). The higher level `Polyhedron_base` still implements this mutability flag.\n\nCould you give a concrete example of a problematic behavior?",
    "created_at": "2019-03-03T09:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318363",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:213 novoselt]:
> There were several instances of removal similar to `self._PPL_C_Polyhedron.set_immutable()` - is this functionality no longer supported? This was done for objects that are cached and if a user ever modifies the polyhedron, things will get wrong.

Indeed, it is not supported anymore. Also you can not cache a `PPL_C_Polyhedron`: https://gitlab.com/videlec/pplpy/blob/master/ppl/polyhedron.pyx#L86-102

In sage, the pplpy polyhedra are only used as attribute from which the user is not supposed to have direct access (unless she knows very well what she is doing). The higher level `Polyhedron_base` still implements this mutability flag.

Could you give a concrete example of a problematic behavior?



---

archive/issue_comments_318364.json:
```json
{
    "body": "Well I don't have an example from \"real life\" given that these objects used to be immutable and that I generally knew what I am doing, but the situation I have described is not at all impossible. Although the method returning PPL representation is underscored. There is also a discrepancy with documentation at\nhttps://github.com/sagemath/sage/blob/develop/src/sage/geometry/cone.py#L1373\nwhich claims that supplied polytope will be made immutable.",
    "created_at": "2019-03-04T16:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318364",
    "user": "https://github.com/novoselt"
}
```

Well I don't have an example from "real life" given that these objects used to be immutable and that I generally knew what I am doing, but the situation I have described is not at all impossible. Although the method returning PPL representation is underscored. There is also a discrepancy with documentation at
https://github.com/sagemath/sage/blob/develop/src/sage/geometry/cone.py#L1373
which claims that supplied polytope will be made immutable.



---

archive/issue_comments_318365.json:
```json
{
    "body": "Please continue the discussion at #27423 since this ticket is closed.",
    "created_at": "2019-03-04T19:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22787#issuecomment-318365",
    "user": "https://github.com/videlec"
}
```

Please continue the discussion at #27423 since this ticket is closed.
