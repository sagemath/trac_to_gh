# Issue 16597: Change ring fails for affine morphisms.

Issue created by migration from Trac.

Original creator: gjorgenson

Original creation time: 2014-08-15 18:01:08

Assignee: gjorgenson

CC:  bhutz

When calling the change ring function on affine morphisms an error occurs.


```

A.<x> = AffineSpace(QQ,1)
h = Hom(A,A)
f = h([1])
f.change_ring(ZZ)

```



---

Comment by gjorgenson created at 2014-08-17 18:04:14

New commits:


---

Comment by gjorgenson created at 2014-08-17 18:04:14

Changing status from new to needs_review.


---

Comment by bhutz created at 2014-08-18 00:30:38

I'd like to see the example a little more complex. Say at least dimension 2 with non-constant polynomials.

For the code itself you can get rid of the helper list F with the following


```
G=[F.change_ring(R) for F in self._polys]
```


Another thought. What happens when the domain and codomain are different? This code is assuming that the domain and codomain are the same.


---

Comment by bhutz created at 2014-08-18 00:30:38

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-08-18 19:37:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2014-08-18 19:39:43

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2014-08-18 22:20:58

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2014-08-18 22:20:58

I think the endomorphism check needs some work, since we really want `is` instead of `==`.  Here is a suggestion to simplify things:


```
T=self.domain().change_ring(R)
if self.is_endomorphism():
    H=End(T)
else:
    H=Hom(T,self.codomain().change_ring(R))
```



---

Comment by git created at 2014-08-19 01:58:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2014-08-19 02:00:10

Changing status from needs_work to needs_review.


---

Comment by gjorgenson created at 2014-08-19 02:00:10

Is the use of `is_endomorphism()` more sound than using `==` for the comparison of the domain and codomain?


---

Comment by bhutz created at 2014-08-19 16:34:45

I think it is faster, since you don't have to access and change_ring the codomain unless you really need it and it makes the code easily human readable.

The functionality looks fine at this point, but while you're fixing this function, there are a couple other things to fix

1) there are many instances of trailing white space that need to be removed

2) fix the formatting for the earlier examples for this function

3) the output doesn't seem like an accurate description. Perhaps something more like in the description: a :class:`SchemeMorphism_polynomial` which is `self` coerced to `R`


---

Comment by git created at 2014-08-20 16:53:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2014-08-20 19:45:43

Just removed some extra/trailing white space. This looks good.
----
New commits:


---

Comment by bhutz created at 2014-08-20 19:45:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-20 20:26:05

Author name


---

Comment by vbraun created at 2014-08-20 20:26:05

Changing status from positive_review to needs_work.


---

Comment by bhutz created at 2014-08-20 20:27:18

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-08-21 09:09:14

Resolution: fixed
