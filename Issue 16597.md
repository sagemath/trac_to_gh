# Issue 16597: Change ring fails for affine morphisms.

archive/issues_016597.json:
```json
{
    "body": "Assignee: gjorgenson\n\nCC:  @bhutz\n\nWhen calling the change ring function on affine morphisms an error occurs.\n\n\n```\n\nA.<x> = AffineSpace(QQ,1)\nh = Hom(A,A)\nf = h([1])\nf.change_ring(ZZ)\n\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16834\n\n",
    "created_at": "2014-08-15T18:01:08Z",
    "labels": [
        "component: algebraic geometry",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Change ring fails for affine morphisms.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16597",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
Assignee: gjorgenson

CC:  @bhutz

When calling the change ring function on affine morphisms an error occurs.


```

A.<x> = AffineSpace(QQ,1)
h = Hom(A,A)
f = h([1])
f.change_ring(ZZ)

```


Issue created by migration from https://trac.sagemath.org/ticket/16834





---

archive/issue_comments_218522.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-08-17T18:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218522",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

New commits:



---

archive/issue_comments_218523.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-17T18:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218523",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218524.json:
```json
{
    "body": "I'd like to see the example a little more complex. Say at least dimension 2 with non-constant polynomials.\n\nFor the code itself you can get rid of the helper list F with the following\n\n\n```\nG=[F.change_ring(R) for F in self._polys]\n```\n\n\nAnother thought. What happens when the domain and codomain are different? This code is assuming that the domain and codomain are the same.",
    "created_at": "2014-08-18T00:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218524",
    "user": "https://github.com/bhutz"
}
```

I'd like to see the example a little more complex. Say at least dimension 2 with non-constant polynomials.

For the code itself you can get rid of the helper list F with the following


```
G=[F.change_ring(R) for F in self._polys]
```


Another thought. What happens when the domain and codomain are different? This code is assuming that the domain and codomain are the same.



---

archive/issue_comments_218525.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-18T00:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218525",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218526.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-18T19:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218527.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-18T19:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218527",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218528.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-18T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218528",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218529.json:
```json
{
    "body": "I think the endomorphism check needs some work, since we really want `is` instead of `==`.  Here is a suggestion to simplify things:\n\n\n```\nT=self.domain().change_ring(R)\nif self.is_endomorphism():\n    H=End(T)\nelse:\n    H=Hom(T,self.codomain().change_ring(R))\n```\n",
    "created_at": "2014-08-18T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218529",
    "user": "https://github.com/bhutz"
}
```

I think the endomorphism check needs some work, since we really want `is` instead of `==`.  Here is a suggestion to simplify things:


```
T=self.domain().change_ring(R)
if self.is_endomorphism():
    H=End(T)
else:
    H=Hom(T,self.codomain().change_ring(R))
```




---

archive/issue_comments_218530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T01:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218531.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-19T02:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218531",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218532.json:
```json
{
    "body": "Is the use of `is_endomorphism()` more sound than using `==` for the comparison of the domain and codomain?",
    "created_at": "2014-08-19T02:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218532",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Is the use of `is_endomorphism()` more sound than using `==` for the comparison of the domain and codomain?



---

archive/issue_comments_218533.json:
```json
{
    "body": "I think it is faster, since you don't have to access and change_ring the codomain unless you really need it and it makes the code easily human readable.\n\nThe functionality looks fine at this point, but while you're fixing this function, there are a couple other things to fix\n\n1) there are many instances of trailing white space that need to be removed\n\n2) fix the formatting for the earlier examples for this function\n\n3) the output doesn't seem like an accurate description. Perhaps something more like in the description: a :class:`SchemeMorphism_polynomial` which is `self` coerced to `R`",
    "created_at": "2014-08-19T16:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218533",
    "user": "https://github.com/bhutz"
}
```

I think it is faster, since you don't have to access and change_ring the codomain unless you really need it and it makes the code easily human readable.

The functionality looks fine at this point, but while you're fixing this function, there are a couple other things to fix

1) there are many instances of trailing white space that need to be removed

2) fix the formatting for the earlier examples for this function

3) the output doesn't seem like an accurate description. Perhaps something more like in the description: a :class:`SchemeMorphism_polynomial` which is `self` coerced to `R`



---

archive/issue_comments_218534.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-20T16:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218535.json:
```json
{
    "body": "Just removed some extra/trailing white space. This looks good.\n----\nNew commits:",
    "created_at": "2014-08-20T19:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218535",
    "user": "https://github.com/bhutz"
}
```

Just removed some extra/trailing white space. This looks good.
----
New commits:



---

archive/issue_comments_218536.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-20T19:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218536",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218537.json:
```json
{
    "body": "Author name",
    "created_at": "2014-08-20T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218537",
    "user": "https://github.com/vbraun"
}
```

Author name



---

archive/issue_comments_218538.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-08-20T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218538",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218539.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-08-20T20:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218539",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_218540.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-21T09:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16597#issuecomment-218540",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_016080.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2014-08-21T09:09:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16597",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16597#event-16080"
}
```
