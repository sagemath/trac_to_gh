# Issue 15893: Matrices over Universal Cyclotomic field failing to echelonize/inverse

Issue created by migration from https://trac.sagemath.org/ticket/16130

Original creator: jipilab

Original creation time: 2014-04-11 08:53:59

CC:  sage-combinat nthiery stumpc5 vripoll

Keywords: cyclotomic field, matrix, echelon form, inverse, days57

Here is an instance of smallest failing example.


```
    sage: UCF.<E>=UniversalCyclotomicField()
    sage: MS=MatrixSpace(UCF,2,2)
    sage: bad_mat=MS([-4, 2*E(7)^6, -5*E(13)^3 + 5*E(13)^8 - 4*E(13)^9, 0]) #this matrix was obtained via random_element
    sage: bad_mat._echelon_classical()
    Traceback (most recent call last)
    [...]
    OverflowError: value too large to convert to int
    sage: bad_mat.inverse()
    Traceback (most recent call last)
    [...]
    NotImplementedError: value too large to convert to int
    Echelon form not implemented over 'Universal Cyclotomic Field'.
```


The error handling of inverse should be looked at to reflect the origin of the error. In this case, that the echelonize method converts to integers and therefore fails for too big denominators but is still implemented over Universal Cyclotomic Field. For example, the following case does work:


```
    sage: good_mat=MS([E(4), 0, -2*E(17)^2 - 4*E(17)^3, -2])
    sage: good_mat.echelon_form()
    [1 0]
    [0 1]
    sage: good_mat.inverse()
    [                -E(4)                     0]
    [E(68)^25 + 2*E(68)^29                  -1/2]
```



---

Comment by jipilab created at 2014-04-11 08:56:54

Changing type from PLEASE CHANGE to defect.


---

Comment by jipilab created at 2014-04-11 08:56:54

Changing component from PLEASE CHANGE to number fields.


---

Comment by vdelecroix created at 2015-04-09 22:30:32

Hello,

In #18152, I reimplemented the universal cyclotomic field using libgap (faster and more reliable). In that version the issue disappears. My goal would be to close this ticket as "won't fix" as soon as #18152 would be reviewed.

Vincent


---

Comment by jipilab created at 2015-04-10 06:49:10

Hi Vincent,

This is great! Looking forward to it!

Jean-Philippe


---

Comment by vdelecroix created at 2015-04-10 15:20:08

Hi Jean-Philippe,

It can be even faster if you review it!

Vincent


---

Comment by chapoton created at 2015-05-24 13:37:14

Changing status from new to needs_review.


---

Comment by chapoton created at 2015-05-24 13:37:14

Now works with libgap version


---

Comment by mmezzarobba created at 2015-05-25 10:20:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-19 08:39:40

Resolution: fixed
