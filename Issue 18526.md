# Issue 18526: COIN backend should support basis status and tableau data functions

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2015-06-22 19:30:45

CC:  yzh ncohen

Keywords: lp

Should add `getBInvARow`, `getBInvACol`, `getBasics`
to src/sage/numerical/backends/coin_backend.{pxd,pyx}

Reference to the relevant Clp header file:
https://projects.coin-or.org/Osi/browser/trunk/Osi/src/OsiClp/OsiClpSolverInterface.hpp?rev=1472
This is for #18733 and #18688.


---

Comment by git created at 2015-09-03 04:14:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-05 01:45:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by yzh created at 2015-09-05 01:49:40

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-09-13 02:48:46

Please fill the `Authors` field with your full name.

Instead of `sage_malloc` you could use `check_malloc` (that checks that the memory is indeed allocated and raises an error if not).

Otherwise, everything looks clean and tests run smoothly on my computer (with Coin installed).

Vincent


---

Comment by vdelecroix created at 2015-09-13 02:48:46

Changing status from needs_review to needs_work.


---

Comment by yzh created at 2015-09-13 03:35:57

> Instead of `sage_malloc` you could use `check_malloc` (that checks that the memory is indeed allocated and raises an error if not).
> 
Thanks a lot for reviewing the ticket.
Does one call `sage_free` to free the memory allocated by `check_malloc`?
Since `sage_malloc` is used throughout the file, I was trying to be consistent. Would you suggest replacing them all by `check_malloc`? Or perhaps better to update them using #18868?


---

Comment by vdelecroix created at 2015-09-13 12:38:10

Hi Yuan,

Replying to [comment:7 yzh]:
> > Instead of `sage_malloc` you could use `check_malloc` (that checks that the memory is indeed allocated and raises an error if not).
> > 
> Thanks a lot for reviewing the ticket.
> Does one call `sage_free` to free the memory allocated by `check_malloc`?
> Since `sage_malloc` is used throughout the file, I was trying to be consistent. Would you suggest replacing them all by `check_malloc`? Or perhaps better to update them using #18868?

I do not think that #18868 is good idea in this case. You will create a Python object for nothing.

`check_malloc` is equivalent to `sage_malloc` except that it will raise an error in case the memory was not allocated (where `sage_malloc` just returns `NULL`). So the memory should be freed with `sage_free`. You can safely replace occurrences of `sage_malloc` by `check_malloc`. Moreover you can always replace

```
my_ptr = sage_malloc(12)
if my_ptr == NULL:
    raise MemoryError("allocation failed")
```

by

```
my_ptr = check_malloc(12)
```


Vincent


---

Comment by git created at 2015-09-13 19:56:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by yzh created at 2015-09-13 20:00:31

Changing status from needs_work to needs_review.


---

Comment by yzh created at 2015-09-13 20:00:31

Thank you, Vincent.
I changed `sage_malloc` to `check_malloc`.


---

Comment by vdelecroix created at 2015-09-13 20:43:20

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2015-09-13 20:43:20

The patchbot reported some errors (when cbc is not installed)

```
sage -t --long src/sage/numerical/backends/coin_backend.pyx
**********************************************************************
File "src/sage/numerical/backends/coin_backend.pyx", line 1260, in sage.numerical.backends.coin_backend.CoinBackend.get_basis_status
Failed example:
    p.solve()
    ...
    NameError: name 'p' is not defined
**********************************************************************
File "src/sage/numerical/backends/coin_backend.pyx", line 1285, in sage.numerical.backends.coin_backend.CoinBackend.get_basis_status
Failed example:
    lp_coin = lp.get_backend()
    ...
    NameError: name 'lp' is not defined
**********************************************************************
```



---

Comment by git created at 2015-09-13 20:51:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by yzh created at 2015-09-13 20:53:33

Oops, I forgot to indicate optional - cbc at some places


---

Comment by yzh created at 2015-09-13 20:53:33

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-09-13 21:58:15

Good to go!


---

Comment by vdelecroix created at 2015-09-13 21:58:15

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-09-14 19:01:18

Resolution: fixed
