# Issue 33804: improve and document GAP and libgap memory customisation

Issue created by migration from https://trac.sagemath.org/ticket/34041

Original creator: dimpase

Original creation time: 2022-06-21 09:23:18

CC:  fbissey

it's a FAQ, how to do this. Should be fixed, and a working solution provided.


---

Comment by dimpase created at 2022-06-22 12:15:04

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-06-22 12:15:04

New commits:


---

Comment by git created at 2022-06-22 22:24:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-06-25 18:51:04

-1 on using `os.getenv` directly; this should go through `sage.env`


---

Comment by mkoeppe created at 2022-06-25 18:54:45

Also, the naming scheme used by sage.interfaces gives `SAGE_GAP_COMMAND`, not `SAGE_PEXPECT_GAP_COMMAND`, see #33405


---

Comment by mkoeppe created at 2022-06-25 19:02:16

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2022-06-25 21:27:52

Replying to [comment:4 mkoeppe]:
> -1 on using `os.getenv` directly; this should go through `sage.env`


downstreams don't like sage.env, do they?


---

Comment by mkoeppe created at 2022-06-25 21:46:38

The module `sage.env` is our general interface to access such variables


---

Comment by fbissey created at 2022-06-25 22:06:26

I love `sage.env`. In fact, I had my own equivalent of `sage.env` in sage-on-gentoo before there was one in vanilla sage. Of course that doesn't mean you should put anything and everything in there.

Now, I am not really against using `os.getenv` directly in code to change a behavior on the fly. But if you do, it should fall back to a sensible default or nothing if it is not defined. `sage.env` arguably serves as a single stop to collect such variables that ensure consistent use. But I wouldn't be to bothered if the branch was going as is.


---

Comment by git created at 2022-06-29 21:59:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2022-06-29 22:00:08

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2022-06-29 22:15:00

Thanks for making this change, LGTM


---

Comment by mkoeppe created at 2022-06-29 22:16:58

(but I haven't tested it, so let's wait for the patchbot or the Build&test workflow)


---

Comment by mkoeppe created at 2022-07-03 20:47:23

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-07-03 20:47:23

Tested locally, seems to work fine. I was able to provoke errors in the testsuite by setting a low memory limit


---

Comment by vbraun created at 2022-07-09 22:33:09

Resolution: fixed
