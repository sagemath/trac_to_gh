# Issue 33804: improve and document GAP and libgap memory customisation

archive/issues_033804.json:
```json
{
    "body": "CC:  fbissey\n\nit's a FAQ, how to do this. Should be fixed, and a working solution provided.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34041\n\n",
    "created_at": "2022-06-21T09:23:18Z",
    "labels": [
        "interfaces",
        "major",
        "bug"
    ],
    "title": "improve and document GAP and libgap memory customisation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33804",
    "user": "dimpase"
}
```
CC:  fbissey

it's a FAQ, how to do this. Should be fixed, and a working solution provided.

Issue created by migration from https://trac.sagemath.org/ticket/34041





---

archive/issue_comments_480376.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480376",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480377.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480377",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_480378.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-22T22:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480378",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480379.json:
```json
{
    "body": "-1 on using `os.getenv` directly; this should go through `sage.env`",
    "created_at": "2022-06-25T18:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480379",
    "user": "mkoeppe"
}
```

-1 on using `os.getenv` directly; this should go through `sage.env`



---

archive/issue_comments_480380.json:
```json
{
    "body": "Also, the naming scheme used by sage.interfaces gives `SAGE_GAP_COMMAND`, not `SAGE_PEXPECT_GAP_COMMAND`, see #33405",
    "created_at": "2022-06-25T18:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480380",
    "user": "mkoeppe"
}
```

Also, the naming scheme used by sage.interfaces gives `SAGE_GAP_COMMAND`, not `SAGE_PEXPECT_GAP_COMMAND`, see #33405



---

archive/issue_comments_480381.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-25T19:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480381",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_480382.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> -1 on using `os.getenv` directly; this should go through `sage.env`\n\n\ndownstreams don't like sage.env, do they?",
    "created_at": "2022-06-25T21:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480382",
    "user": "dimpase"
}
```

Replying to [comment:4 mkoeppe]:
> -1 on using `os.getenv` directly; this should go through `sage.env`


downstreams don't like sage.env, do they?



---

archive/issue_comments_480383.json:
```json
{
    "body": "The module `sage.env` is our general interface to access such variables",
    "created_at": "2022-06-25T21:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480383",
    "user": "mkoeppe"
}
```

The module `sage.env` is our general interface to access such variables



---

archive/issue_comments_480384.json:
```json
{
    "body": "I love `sage.env`. In fact, I had my own equivalent of `sage.env` in sage-on-gentoo before there was one in vanilla sage. Of course that doesn't mean you should put anything and everything in there.\n\nNow, I am not really against using `os.getenv` directly in code to change a behavior on the fly. But if you do, it should fall back to a sensible default or nothing if it is not defined. `sage.env` arguably serves as a single stop to collect such variables that ensure consistent use. But I wouldn't be to bothered if the branch was going as is.",
    "created_at": "2022-06-25T22:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480384",
    "user": "fbissey"
}
```

I love `sage.env`. In fact, I had my own equivalent of `sage.env` in sage-on-gentoo before there was one in vanilla sage. Of course that doesn't mean you should put anything and everything in there.

Now, I am not really against using `os.getenv` directly in code to change a behavior on the fly. But if you do, it should fall back to a sensible default or nothing if it is not defined. `sage.env` arguably serves as a single stop to collect such variables that ensure consistent use. But I wouldn't be to bothered if the branch was going as is.



---

archive/issue_comments_480385.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-29T21:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480385",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480386.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-29T22:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480386",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_480387.json:
```json
{
    "body": "Thanks for making this change, LGTM",
    "created_at": "2022-06-29T22:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480387",
    "user": "mkoeppe"
}
```

Thanks for making this change, LGTM



---

archive/issue_comments_480388.json:
```json
{
    "body": "(but I haven't tested it, so let's wait for the patchbot or the Build&test workflow)",
    "created_at": "2022-06-29T22:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480388",
    "user": "mkoeppe"
}
```

(but I haven't tested it, so let's wait for the patchbot or the Build&test workflow)



---

archive/issue_comments_480389.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-03T20:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480389",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_480390.json:
```json
{
    "body": "Tested locally, seems to work fine. I was able to provoke errors in the testsuite by setting a low memory limit",
    "created_at": "2022-07-03T20:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480390",
    "user": "mkoeppe"
}
```

Tested locally, seems to work fine. I was able to provoke errors in the testsuite by setting a low memory limit



---

archive/issue_comments_480391.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33804",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33804#issuecomment-480391",
    "user": "vbraun"
}
```

Resolution: fixed
