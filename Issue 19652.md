# Issue 19652: Fix coding style and documentation style in affine schemes

Issue created by migration from Trac.

Original creator: bhutz

Original creation time: 2016-01-14 17:19:47

Assignee: millerrl

There are number of coding style issues and documentation issues in the affine scheme functionality such as

- `== False` or `== True`

- references to `self` in docs

- no single line description

- formatting of errors

etc.


---

Comment by bhutz created at 2016-01-14 21:53:04

Changing type from task to enhancement.


---

Comment by rlmiller created at 2016-01-14 22:36:27

Changing assignee from millerrl to rlmiller.


---

Comment by rlmiller created at 2016-01-22 19:22:03

Changing status from new to needs_review.


---

Comment by rlmiller created at 2016-01-22 19:22:03

New commits:


---

Comment by git created at 2016-01-28 16:43:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-01-29 21:51:18

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2016-01-29 21:51:18

Most of these are minor. But there are couple places the code can be improved. All changes referenced by line number.

affine_space.py
- 44 - ``x``
- 60 = ``n``, ``R``
- 223,224 - ``F``
- 397+ -> polys should be ``v``
- 419 - ``v``
- 490 - ``R``
- 525 - line too long
- 530 - line too long
- 646 - ``X``
- 744 - self
- 747 - line too long
- 756 - self
- 814 - If sentence in new paragraph

affine_point.py
- 102 - empty line between
- 112 - ',space'
- 139 - line too long
- 146 - empty line between
- 177 - '=' (is this line even needed?)
- 241 - number field, number field order
- 293 - self
- 355-357 - can be OUTPUT: integer.
- 390 - line too long
- 405 - y*z (no space)
- 422 - ,space
- 428,429 - are these really needed

affine_morphism.py
- 174 - line too long
- 176 - line too long
- 192 - Better would be "if the two affine maps defined the same map), line too long
- 229 - same comment as 192
- 330 - line too long
- 343 - line too long
- 347 - line too long
- 358 - ,space
- 383 - line too long
- 439 - line too long
- 501 - line too long
- 583 - ``n``
- 658 - ``n``
- 662 - map's
- 663 - empty line between
- 667 - map's
- 703 - no blank line
- 709 - empty line between
- 743 - fix spaces around =
- 753 - ,space
- 755 - line too long
- 770 - space+space
- 780 - space+space
- 784 - this to do I think is done (#15376), so you can probably remove the special case code.
- 813,814 - single `
- 824 - space-space
- 865 - empty line between
- 996 - line too long
- 1001 - map's
- 1027 - ``x``
- 1066 - line too long, need single line description
- 1071 - OUTPUT: a digraph.


---

Comment by jdemeyer created at 2016-01-29 22:19:58

You shouldn't do this:

```diff
 r"""
-Set of homomorphisms between two affine schemes
+Set of homomorphisms between two affine schemes.
```


The title of a module should not end with a period.


---

Comment by jdemeyer created at 2016-01-29 22:25:29

Some changes go from good to bad I think. In these cases, I prefer the original code:

```diff
-from sage.arith.all import lcm, gcd
+from sage.arith.all                 import lcm, gcd
```

and

```diff
-            if not isinstance(polys, (list, tuple)):
+            if not isinstance(polys,(list, tuple)):
```

and

```diff
-        Construct a point.
+        Constructs a point.
```



---

Comment by bhutz created at 2016-01-29 22:39:23

I wasn't sure of the convention for the imports: have them all lined up or just single space after import?

Yes, those other changes should be un-done. I went through the files looking at what was potentially missed and didn't go through the specific changes yet.


---

Comment by jdemeyer created at 2016-01-29 22:48:27

The column style

```
from sage.arith.all                 import lcm, gcd
```

is annoying for several reasons:
1. it makes lines needlessly long
2. it breaks when you need `from sage.some.module.with.a.really.very.long.name import foo`.
3. it breaks easy search-and-replace: if I decide to change `arith` to `arithmetic` for example, I would have to fix the formatting


---

Comment by bhutz created at 2016-01-29 22:50:15

Those seem like good reasons for single space to me.


---

Comment by git created at 2016-02-03 16:59:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rlmiller created at 2016-02-03 17:08:22

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2016-02-05 16:18:54

There is a minor merge conflict with the latest beta.

The docs do not build, so I wasn't able to look at them for formatting issues. However, I went through the changes are there are some specifics to fix:

undo

```
-            if not isinstance(polys, (list, tuple)):
+            if not isinstance(polys,(list, tuple)):
```


define - this occurs in two places

```
+        - Boolean - True if the two affine maps defined the same map.
+        - Boolean - True if the two affine maps defined the same map.
```



map's

```
+        - ``P`` -- a point in the map domain.
```


extra space

```
+            sage: A.<x,y> =  AffineSpace(FractionField(R), 2)
```


new paragraph for 2nd sentence

```
+        Returns the multiplier of the point ``P`` of period ``n`` by the map.
+        The map must be an endomorphism.
```


of the map instead of extension field

```
+            and codomain of extension field.
```


no period

```
+Scheme morphism for points on affine varieties.
```


undo

```
-        Returns the point `f^n(self)`
+        Returns the point `f^n(point)`
```


'with this point in' instead of 'self if'

```
+        - ``f`` -- a :class:`SchemeMorphism_polynomial` with ``self`` if ``f.domain()``.
```


2nd sentence new paragraph

```
+        Returns the orbit of the point by `f`. If `n` is an integer it returns
+        `[self,f(self), \ldots, f^{n}(self)]`.
```


missing space

```
+            sage: A.<x,y>=AffineSpace(QQ, 2)
+            sage: H = Hom(A, A)
+            sage: f = H([(x-2*y^2)/x,3*x*y])
+            sage: A(9, 3).orbit(f, 3)
```


another special case to remove + associated code

```
-            add heights to integer.pyx and remove special case
+            Add heights to integer.pyx and remove special case.
```


The 2nd sentence should be the 1st. The 1st sentence needs more info ('Since every...finite field, this pair always exists.')

```
+        Every point is preperiodic over a finite field.
+
+        This function returns the pair `[m, n]` where `m` is the
+        preperiod and `n` is the period of the point by ``f``.
```



---

Comment by bhutz created at 2016-02-05 16:18:54

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-02-08 17:28:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-02-11 16:04:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rlmiller created at 2016-02-11 16:05:51

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2016-02-13 18:37:03

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2016-02-13 18:37:03

I'm still not getting the docs to build even after a make doc-clean. I get


```
[schemes  ] /home/ben/sage/sage-test/local/lib/python2.7/site-packages/sage/schemes/affine/affine_morphism.py:docstring of sage.schemes.affine.affine_morphism.SchemeMorphism_polynomial_affine_space.nth_iterate_map:1: WARNING: Inline literal start-string without end-string.
Error building the documentation.
```

It seems to be complaining about the

```
``n``th
```

making it

```
``n``-th
```

seems to fix the issue.

Another small change I missed last time.
- In point.py  orbit. The parameter is N instead of n.


---

Comment by git created at 2016-02-15 00:22:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-02-15 03:15:46

I assume you meant to set this to needs review. The docs build now and I was able to look at them. It looks like some of your line wrapping for INPUT/OUTPUT is not formatting correctly. It is because of the number of spaces indenting the 2nd line. For example look at the input/output of dynatomic_polynomial in affine_morphism. The output formats correctly, but the input does not.

There are a number of such spacing issues in the files.


---

Comment by git created at 2016-02-16 18:18:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rlmiller created at 2016-02-16 18:19:36

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2016-02-16 19:52:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-18 08:24:42

Resolution: fixed


---

Comment by jdemeyer created at 2016-03-22 13:38:25

What do you prefer: "Rebecca Lauren Miller" or "Rebecca Miller"?
