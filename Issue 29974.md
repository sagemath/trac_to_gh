# Issue 29974: Characteristic Classes: Sequences

archive/issues_029974.json:
```json
{
    "body": "CC:  slelievre egourgoulhon tscrim\n\nTo each additive/multiplicative characteristic class corresponds a sequence. Namely, due to the [fundamental theorem of symmetric polynomials](https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial#Fundamental_theorem_of_symmetric_polynomials), each symmetric polynomial can be expressed in terms of the elementary symmetric polynomials. In our setup, the `k`-th elementary symmetric polynomials corresponds to the `k`-th Chern class. This allows us to express additive/multiplicative characteristic classes in terms of Chern classes (or Pontryagin classes in the real case respectively). This is the sequence.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30211\n\n",
    "created_at": "2020-07-24T08:32:25Z",
    "labels": [
        "manifolds",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Characteristic Classes: Sequences",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29974",
    "user": "@mjungmath"
}
```
CC:  slelievre egourgoulhon tscrim

To each additive/multiplicative characteristic class corresponds a sequence. Namely, due to the [fundamental theorem of symmetric polynomials](https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial#Fundamental_theorem_of_symmetric_polynomials), each symmetric polynomial can be expressed in terms of the elementary symmetric polynomials. In our setup, the `k`-th elementary symmetric polynomials corresponds to the `k`-th Chern class. This allows us to express additive/multiplicative characteristic classes in terms of Chern classes (or Pontryagin classes in the real case respectively). This is the sequence.

Issue created by migration from https://trac.sagemath.org/ticket/30211





---

archive/issue_comments_425819.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-07-24T10:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425819",
    "user": "@mjungmath"
}
```

New commits:



---

archive/issue_comments_425820.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-24T10:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425820",
    "user": "@mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425821.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-26T15:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425821",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425822.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-28T10:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425822",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425823.json:
```json
{
    "body": "This ticket is ready for review. Patchbot should turn green after this commit.",
    "created_at": "2020-07-28T10:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425823",
    "user": "@mjungmath"
}
```

This ticket is ready for review. Patchbot should turn green after this commit.



---

archive/issue_comments_425824.json:
```json
{
    "body": "Do you have an example that gives something that is not a symmetric function over `QQ`?\n\nAlso, you are better off using\n\n```python\nm = Sym.m()\nm._from_dict({p: prod(ring(coeff[i]) for i in p)\n              for k in range(len(coeff))\n              for p in Partitions(k))\n```\n\nwhich is faster as it more directly creates the symmmetric function you want.",
    "created_at": "2020-08-03T12:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425824",
    "user": "tscrim"
}
```

Do you have an example that gives something that is not a symmetric function over `QQ`?

Also, you are better off using

```python
m = Sym.m()
m._from_dict({p: prod(ring(coeff[i]) for i in p)
              for k in range(len(coeff))
              for p in Partitions(k))
```

which is faster as it more directly creates the symmmetric function you want.



---

archive/issue_comments_425825.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> Do you have an example that gives something that is not a symmetric function over `QQ`?\n\nSure: `x-y` is no symmetric function over `QQ`.\n\n> \n> Also, you are better off using\n> {{{#!python\n> m = Sym.m()\n> m._from_dict({p: prod(ring(coeff[i]) for i in p)\n>               for k in range(len(coeff))\n>               for p in Partitions(k))\n> }}}\n> which is faster as it more directly creates the symmmetric function you want.\n\nThanks, I'll try this.",
    "created_at": "2020-08-03T15:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425825",
    "user": "@mjungmath"
}
```

Replying to [comment:6 tscrim]:
> Do you have an example that gives something that is not a symmetric function over `QQ`?

Sure: `x-y` is no symmetric function over `QQ`.

> 
> Also, you are better off using
> {{{#!python
> m = Sym.m()
> m._from_dict({p: prod(ring(coeff[i]) for i in p)
>               for k in range(len(coeff))
>               for p in Partitions(k))
> }}}
> which is faster as it more directly creates the symmmetric function you want.

Thanks, I'll try this.



---

archive/issue_comments_425826.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-03T15:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425826",
    "user": "@mjungmath"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_425827.json:
```json
{
    "body": "Apparently, there is something wrong with the code since some doctests fail. I'll check on this.",
    "created_at": "2020-08-03T15:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425827",
    "user": "@mjungmath"
}
```

Apparently, there is something wrong with the code since some doctests fail. I'll check on this.



---

archive/issue_comments_425828.json:
```json
{
    "body": "Replying to [comment:7 gh-mjungmath]:\n> Replying to [comment:6 tscrim]:\n> > Do you have an example that gives something that is not a symmetric function over `QQ`?\n> \n> Sure: `x-y` is no symmetric function over `QQ`.\n\nI know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.",
    "created_at": "2020-08-04T04:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425828",
    "user": "tscrim"
}
```

Replying to [comment:7 gh-mjungmath]:
> Replying to [comment:6 tscrim]:
> > Do you have an example that gives something that is not a symmetric function over `QQ`?
> 
> Sure: `x-y` is no symmetric function over `QQ`.

I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.



---

archive/issue_comments_425829.json:
```json
{
    "body": "Ah, I see. I was already wondering. :D\n\nWell yes, the standard case is `QQ` but at the moment, there is nothing that prevents you having a parameter in `SR`. This might come in useful (I don't know when exactly, but I want to keep the possibility open). Now, I wanted to make sure that the algorithm always works, even in that case, so I chose `SR`.",
    "created_at": "2020-08-04T07:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425829",
    "user": "@mjungmath"
}
```

Ah, I see. I was already wondering. :D

Well yes, the standard case is `QQ` but at the moment, there is nothing that prevents you having a parameter in `SR`. This might come in useful (I don't know when exactly, but I want to keep the possibility open). Now, I wanted to make sure that the algorithm always works, even in that case, so I chose `SR`.



---

archive/issue_comments_425830.json:
```json
{
    "body": "I will try another attempt using power series only. I hope this simplifies the code significantly. Furthermore, this could improve the performance since power series compute things faster than symbolic expressions; also the use of power series is mathematically more rigorous. Finally, power series (over the symbolic ring) allow to distinct between parameters and the actual variable.",
    "created_at": "2020-08-04T17:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425830",
    "user": "@mjungmath"
}
```

I will try another attempt using power series only. I hope this simplifies the code significantly. Furthermore, this could improve the performance since power series compute things faster than symbolic expressions; also the use of power series is mathematically more rigorous. Finally, power series (over the symbolic ring) allow to distinct between parameters and the actual variable.



---

archive/issue_comments_425831.json:
```json
{
    "body": "Replying to [comment:9 tscrim]:\n> Replying to [comment:7 gh-mjungmath]:\n> > Replying to [comment:6 tscrim]:\n> > > Do you have an example that gives something that is not a symmetric function over `QQ`?\n> > \n> > Sure: `x-y` is no symmetric function over `QQ`.\n> \n> I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.\n\nGeneral question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.",
    "created_at": "2020-09-19T19:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425831",
    "user": "@mjungmath"
}
```

Replying to [comment:9 tscrim]:
> Replying to [comment:7 gh-mjungmath]:
> > Replying to [comment:6 tscrim]:
> > > Do you have an example that gives something that is not a symmetric function over `QQ`?
> > 
> > Sure: `x-y` is no symmetric function over `QQ`.
> 
> I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.

General question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.



---

archive/issue_comments_425832.json:
```json
{
    "body": "Replying to [comment:13 gh-mjungmath]:\n> Replying to [comment:9 tscrim]:\n> > Replying to [comment:7 gh-mjungmath]:\n> > > Replying to [comment:6 tscrim]:\n> > > > Do you have an example that gives something that is not a symmetric function over `QQ`?\n> > > \n> > > Sure: `x-y` is no symmetric function over `QQ`.\n> > \n> > I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.\n> \n> General question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.\n\nUncommon is different than mathematically sensible. Since it something you are supporting, it should be tested, even if it is uncommon. Something you could do is have `ring` being `None` and then have the code first try `QQ`, and if that doesn't work, do it again with `SR`. However, that would mean the code becomes more complicated. Another option would be to default to `QQ` with the documentation saying that if it fails over `QQ`, try `SR`.",
    "created_at": "2020-09-22T00:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425832",
    "user": "tscrim"
}
```

Replying to [comment:13 gh-mjungmath]:
> Replying to [comment:9 tscrim]:
> > Replying to [comment:7 gh-mjungmath]:
> > > Replying to [comment:6 tscrim]:
> > > > Do you have an example that gives something that is not a symmetric function over `QQ`?
> > > 
> > > Sure: `x-y` is no symmetric function over `QQ`.
> > 
> > I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.
> 
> General question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.

Uncommon is different than mathematically sensible. Since it something you are supporting, it should be tested, even if it is uncommon. Something you could do is have `ring` being `None` and then have the code first try `QQ`, and if that doesn't work, do it again with `SR`. However, that would mean the code becomes more complicated. Another option would be to default to `QQ` with the documentation saying that if it fails over `QQ`, try `SR`.



---

archive/issue_comments_425833.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-25T09:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425833",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425834.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-10-25T09:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425834",
    "user": "@mjungmath"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_425835.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-25T10:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425835",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425836.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-25T10:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425836",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_425837.json:
```json
{
    "body": "Thanks. This will be good. Just one comment on the code:\n\n```diff\n             from sage.combinat.partition import Partitions\n             # Get the multiplicative sequence in the monomial basis:\n-            mon_pol = Sym.m().sum(prod(ring(coeff[i]) for i in p) * Sym.m()[p]\n+            mon_pol = Sym.m()._from_dict({p: sum(prod(ring(coeff[i]) for i in p)\n                                   for k in range(len(coeff))\n-                                  for p in Partitions(k))\n+                                  for p in Partitions(k)})\n```\n\nThis will create the element faster with far less temporary objects.",
    "created_at": "2020-10-26T00:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425837",
    "user": "tscrim"
}
```

Thanks. This will be good. Just one comment on the code:

```diff
             from sage.combinat.partition import Partitions
             # Get the multiplicative sequence in the monomial basis:
-            mon_pol = Sym.m().sum(prod(ring(coeff[i]) for i in p) * Sym.m()[p]
+            mon_pol = Sym.m()._from_dict({p: sum(prod(ring(coeff[i]) for i in p)
                                   for k in range(len(coeff))
-                                  for p in Partitions(k))
+                                  for p in Partitions(k)})
```

This will create the element faster with far less temporary objects.



---

archive/issue_comments_425838.json:
```json
{
    "body": "You will probably also want to do something similar for the additive case.",
    "created_at": "2020-10-26T00:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425838",
    "user": "tscrim"
}
```

You will probably also want to do something similar for the additive case.



---

archive/issue_comments_425839.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-27T19:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425839",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425840.json:
```json
{
    "body": "Here we go. Wait for patchbot.\n\n`@`Travis: However, I am not sure whether this ticket is still useful since I plan to reconstruct the whole architecture of characteristic classes. Perhaps it is good if you could join my talk on Friday because I plan to explain the rough idea of the current implementation and an outline of what I have in mind.",
    "created_at": "2020-10-27T19:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425840",
    "user": "@mjungmath"
}
```

Here we go. Wait for patchbot.

`@`Travis: However, I am not sure whether this ticket is still useful since I plan to reconstruct the whole architecture of characteristic classes. Perhaps it is good if you could join my talk on Friday because I plan to explain the rough idea of the current implementation and an outline of what I have in mind.



---

archive/issue_comments_425841.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425841",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_425842.json:
```json
{
    "body": "This will be good for now. If things get completely rewritten, then this can be modified/deprecated at that time.",
    "created_at": "2021-05-13T06:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425842",
    "user": "tscrim"
}
```

This will be good for now. If things get completely rewritten, then this can be modified/deprecated at that time.



---

archive/issue_comments_425843.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-13T06:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425843",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425844.json:
```json
{
    "body": "Thank you for the review!",
    "created_at": "2021-05-13T12:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425844",
    "user": "@mjungmath"
}
```

Thank you for the review!



---

archive/issue_comments_425845.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-05-27T20:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29974#issuecomment-425845",
    "user": "vbraun"
}
```

Resolution: fixed
