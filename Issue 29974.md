# Issue 29974: Characteristic Classes: Sequences

Issue created by migration from https://trac.sagemath.org/ticket/30211

Original creator: @mjungmath

Original creation time: 2020-07-24 08:32:25

CC:  slelievre egourgoulhon tscrim

To each additive/multiplicative characteristic class corresponds a sequence. Namely, due to the [fundamental theorem of symmetric polynomials](https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial#Fundamental_theorem_of_symmetric_polynomials), each symmetric polynomial can be expressed in terms of the elementary symmetric polynomials. In our setup, the `k`-th elementary symmetric polynomials corresponds to the `k`-th Chern class. This allows us to express additive/multiplicative characteristic classes in terms of Chern classes (or Pontryagin classes in the real case respectively). This is the sequence.


---

Comment by @mjungmath created at 2020-07-24 10:51:49

New commits:


---

Comment by @mjungmath created at 2020-07-24 10:51:49

Changing status from new to needs_review.


---

Comment by git created at 2020-07-26 15:24:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-07-28 10:42:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-28 10:42:59

This ticket is ready for review. Patchbot should turn green after this commit.


---

Comment by tscrim created at 2020-08-03 12:58:40

Do you have an example that gives something that is not a symmetric function over `QQ`?

Also, you are better off using

```python
m = Sym.m()
m._from_dict({p: prod(ring(coeff[i]) for i in p)
              for k in range(len(coeff))
              for p in Partitions(k))
```

which is faster as it more directly creates the symmmetric function you want.


---

Comment by @mjungmath created at 2020-08-03 15:37:45

Replying to [comment:6 tscrim]:
> Do you have an example that gives something that is not a symmetric function over `QQ`?

Sure: `x-y` is no symmetric function over `QQ`.

> 
> Also, you are better off using
> {{{#!python
> m = Sym.m()
> m._from_dict({p: prod(ring(coeff[i]) for i in p)
>               for k in range(len(coeff))
>               for p in Partitions(k))
> }}}
> which is faster as it more directly creates the symmmetric function you want.

Thanks, I'll try this.


---

Comment by @mjungmath created at 2020-08-03 15:39:05

Changing status from needs_review to needs_work.


---

Comment by @mjungmath created at 2020-08-03 15:39:05

Apparently, there is something wrong with the code since some doctests fail. I'll check on this.


---

Comment by tscrim created at 2020-08-04 04:54:07

Replying to [comment:7 gh-mjungmath]:
> Replying to [comment:6 tscrim]:
> > Do you have an example that gives something that is not a symmetric function over `QQ`?
> 
> Sure: `x-y` is no symmetric function over `QQ`.

I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.


---

Comment by @mjungmath created at 2020-08-04 07:40:52

Ah, I see. I was already wondering. :D

Well yes, the standard case is `QQ` but at the moment, there is nothing that prevents you having a parameter in `SR`. This might come in useful (I don't know when exactly, but I want to keep the possibility open). Now, I wanted to make sure that the algorithm always works, even in that case, so I chose `SR`.


---

Comment by @mjungmath created at 2020-08-04 17:40:02

I will try another attempt using power series only. I hope this simplifies the code significantly. Furthermore, this could improve the performance since power series compute things faster than symbolic expressions; also the use of power series is mathematically more rigorous. Finally, power series (over the symbolic ring) allow to distinct between parameters and the actual variable.


---

Comment by @mjungmath created at 2020-09-19 19:52:05

Replying to [comment:9 tscrim]:
> Replying to [comment:7 gh-mjungmath]:
> > Replying to [comment:6 tscrim]:
> > > Do you have an example that gives something that is not a symmetric function over `QQ`?
> > 
> > Sure: `x-y` is no symmetric function over `QQ`.
> 
> I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.

General question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.


---

Comment by tscrim created at 2020-09-22 00:53:44

Replying to [comment:13 gh-mjungmath]:
> Replying to [comment:9 tscrim]:
> > Replying to [comment:7 gh-mjungmath]:
> > > Replying to [comment:6 tscrim]:
> > > > Do you have an example that gives something that is not a symmetric function over `QQ`?
> > > 
> > > Sure: `x-y` is no symmetric function over `QQ`.
> > 
> > I know what a symmetric function is (that is basically my main research area). What I want is a symmetric function over some other base ring besides `QQ`. Can you add an example where this happens? In the branch, you say don't assume `QQ`, so I want a doctest where that actually occurs.
> 
> General question: do the examples have to be mathematically sensible? For instance, there are plenty of examples where the coefficients of the Taylor expansion are not rationals and `SR` is then a reasonable choice, but such examples are very uncommon in the application of characteristic classes.

Uncommon is different than mathematically sensible. Since it something you are supporting, it should be tested, even if it is uncommon. Something you could do is have `ring` being `None` and then have the code first try `QQ`, and if that doesn't work, do it again with `SR`. However, that would mean the code becomes more complicated. Another option would be to default to `QQ` with the documentation saying that if it fails over `QQ`, try `SR`.


---

Comment by git created at 2020-10-25 09:48:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-10-25 09:49:12

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-10-25 10:43:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-10-25 10:43:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2020-10-26 00:29:14

Thanks. This will be good. Just one comment on the code:

```diff
             from sage.combinat.partition import Partitions
             # Get the multiplicative sequence in the monomial basis:
-            mon_pol = Sym.m().sum(prod(ring(coeff[i]) for i in p) * Sym.m()[p]
+            mon_pol = Sym.m()._from_dict({p: sum(prod(ring(coeff[i]) for i in p)
                                   for k in range(len(coeff))
-                                  for p in Partitions(k))
+                                  for p in Partitions(k)})
```

This will create the element faster with far less temporary objects.


---

Comment by tscrim created at 2020-10-26 00:30:19

You will probably also want to do something similar for the additive case.


---

Comment by git created at 2020-10-27 19:02:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-10-27 19:05:35

Here we go. Wait for patchbot.

`@`Travis: However, I am not sure whether this ticket is still useful since I plan to reconstruct the whole architecture of characteristic classes. Perhaps it is good if you could join my talk on Friday because I plan to explain the rough idea of the current implementation and an outline of what I have in mind.


---

Comment by mkoeppe created at 2021-03-15 22:07:04

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by tscrim created at 2021-05-13 06:40:03

This will be good for now. If things get completely rewritten, then this can be modified/deprecated at that time.


---

Comment by tscrim created at 2021-05-13 06:40:03

Changing status from needs_review to positive_review.


---

Comment by @mjungmath created at 2021-05-13 12:11:22

Thank you for the review!


---

Comment by vbraun created at 2021-05-27 20:29:14

Resolution: fixed
