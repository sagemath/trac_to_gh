# Issue 20772: Fix symbolic GCD to accept any expression

archive/issues_020772.json:
```json
{
    "body": "Visible already in sage-7.1v, difficult to get a good minimal test case.\n\n```\nsage: (1/24*((sqrt(3)*2^(2/3)*gamma(1/3) + I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I)))/x^(1/3)).collect_common_factors()\n1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*x^(1/3))\nsage: (1/24*((I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I)))/x^(1/3)).collect_common_factors()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-6-c25fe41fc3c2> in <module>()\n----> 1 _.collect_common_factors()\n\n/home/ralf/sage-7.1v/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.collect_common_factors (/home/ralf/sage-7.1v/src/build/cythonized/sage/symbolic/expression.cpp:37782)()\n   6649         sig_on()\n   6650         try:\n-> 6651             x = g_collect_common_factors(self._gobj)\n   6652         finally:\n   6653             sig_off()\n\nValueError: gcd: arguments must be polynomials over the rationals\n```\n\nIt is not difficult to fix the symbolic gcd to accept any expression. The method is already implemented in Pynac's giac interface.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21009\n\n",
    "created_at": "2016-07-12T14:52:24Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Fix symbolic GCD to accept any expression",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20772",
    "user": "@rwst"
}
```
Visible already in sage-7.1v, difficult to get a good minimal test case.

```
sage: (1/24*((sqrt(3)*2^(2/3)*gamma(1/3) + I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I)))/x^(1/3)).collect_common_factors()
1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*x^(1/3))
sage: (1/24*((I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I)))/x^(1/3)).collect_common_factors()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-6-c25fe41fc3c2> in <module>()
----> 1 _.collect_common_factors()

/home/ralf/sage-7.1v/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.collect_common_factors (/home/ralf/sage-7.1v/src/build/cythonized/sage/symbolic/expression.cpp:37782)()
   6649         sig_on()
   6650         try:
-> 6651             x = g_collect_common_factors(self._gobj)
   6652         finally:
   6653             sig_off()

ValueError: gcd: arguments must be polynomials over the rationals
```

It is not difficult to fix the symbolic gcd to accept any expression. The method is already implemented in Pynac's giac interface.

Issue created by migration from https://trac.sagemath.org/ticket/21009





---

archive/issue_comments_287054.json:
```json
{
    "body": "We now get with Sage-8.0\n\n```\nsage: (1/24*((I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I))\n....: )/x^(1/3)).collect_common_factors()\n....: \n1/24*2^(2/3)*(4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*x^(1/3))\n```\n",
    "created_at": "2017-08-11T07:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287054",
    "user": "@rwst"
}
```

We now get with Sage-8.0

```
sage: (1/24*((I*2^(2/3)*gamma(1/3))/pi + 4*2^(2/3)*gamma(1/3)/(pi*(sqrt(3) + I))
....: )/x^(1/3)).collect_common_factors()
....: 
1/24*2^(2/3)*(4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*x^(1/3))
```




---

archive/issue_comments_287055.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-11T07:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287055",
    "user": "@rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_287056.json:
```json
{
    "body": "Actually the fix was unintentional and is in Pynac-0.7.10. This will add doctests.",
    "created_at": "2017-08-11T07:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287056",
    "user": "@rwst"
}
```

Actually the fix was unintentional and is in Pynac-0.7.10. This will add doctests.



---

archive/issue_comments_287057.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-11T07:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287057",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_287058.json:
```json
{
    "body": "Sorry.",
    "created_at": "2017-08-11T07:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287058",
    "user": "@rwst"
}
```

Sorry.



---

archive/issue_comments_287059.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-11-26T14:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287059",
    "user": "@rwst"
}
```

New commits:



---

archive/issue_comments_287060.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-11-26T14:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287060",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287061.json:
```json
{
    "body": "If you rebase the branch, I will review this.",
    "created_at": "2019-01-18T17:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287061",
    "user": "@tscrim"
}
```

If you rebase the branch, I will review this.



---

archive/issue_comments_287062.json:
```json
{
    "body": "red branch => needs work",
    "created_at": "2021-01-31T08:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287062",
    "user": "@fchapoton"
}
```

red branch => needs work



---

archive/issue_comments_287063.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-01-31T08:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20772#issuecomment-287063",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.
