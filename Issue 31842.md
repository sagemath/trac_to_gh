# Issue 31842: provide early terminatuion via *_found variable for AC_PATH_PROGS_FEATURE_CHECK

Issue created by migration from https://trac.sagemath.org/ticket/32079

Original creator: dimpase

Original creation time: 2021-06-28 22:54:38

CC:  mkoeppe mjo slelievre

cmake, curl, gfan_version, giac, git, ninja, patch, tox, xz, yasm

have no termination for the loop through `PATH` in their spkg-configure.m4

This results is picking the last in `PATH`, rather than the first. See 
[sage-devel](https://groups.google.com/d/msgid/sage-devel/2c14e0db-46cd-4562-b4b7-50f349be7068n%40googlegroups.com?utm_medium=email&utm_source=footer) post.


---

Comment by dimpase created at 2021-06-29 11:53:39

Changing status from new to needs_review.


---

Comment by dimpase created at 2021-06-29 11:53:39

New commits:


---

Comment by mkoeppe created at 2021-06-29 15:52:32


```
--- a/build/pkgs/curl/spkg-configure.m4
+++ b/build/pkgs/curl/spkg-configure.m4
@@ -4,6 +4,7 @@ SAGE_SPKG_CONFIGURE([curl], [
     AC_CACHE_CHECK([for curl 7.22], [ac_cv_path_CURL], [
         AC_PATH_PROGS_FEATURE_CHECK([CURL], [curl], [
           ${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}
+                    ac_path_CURL_found=:
         ])
```

&& missing

Likewise in `pkgs/git/spkg-configure.m4`, `pkgs/yasm/spkg-configure.m4`


---

Comment by mkoeppe created at 2021-06-29 15:52:44

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-06-29 16:18:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2021-06-29 16:18:56

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-06-29 16:35:25

OK, this looks fine.

Of course, the ticket does not change the fact that most of our `AC_PATH_PROGS_FEATURE_CHECK`s are misleading because we do not use the resulting path variable. For example, `grep CMAKE config.status` reveals that we do not even pass on the information from the configure stage.


---

Comment by mkoeppe created at 2021-06-29 16:35:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-07-27 22:15:39

Resolution: fixed
