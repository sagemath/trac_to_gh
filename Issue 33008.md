# Issue 33008: computation of the integral of e^x/(x^2+1) over [-pi; pi] runs forever

Issue created by migration from https://trac.sagemath.org/ticket/33245

Original creator: ebriand

Original creation time: 2022-01-29 21:46:53

Keywords: integrate, giac

The following computation runs forever (> 20 min):

```
sage: integrate(e^x/(x^2+1), x, -pi, pi)
```

on the following versions/systems:

* Sage 9.4 installed with conda on Mac OS X 10.13.6
* Sage 9.5rc4 on MacOS 11.5.2
* Sage 9.4 and 9.5rc4 on Ubuntu 20.04 (cocalc)
* Sage 9.5rc3 on a 32-bit Debian virtual machine

Interrupting gives the message:

```
^CInterrupting Giac...

integrate(e^x/(x^2 + 1), x, -pi, pi)
```


giac version is 1.6.0

After running once the command, and interrupting, running again the command several times may give wrong answers:

```
sage: integrate(e^x/(x^2+1), x, -pi, pi)
-pi*e^x/(x^2 + 1) - x*e^x/(x^2 + 1)
```

even with integrals of the same function on another interval:

```
sage: integrate(e^x/(x^2+1), x,0, 1)
-x*e^x/(x^2 + 1)
```



The problem does not arise 

* when calculating without giac, e.g.


```
sage: integrate(e^x/(x^2+1), x, -pi, pi, algorithm='maxima')
integrate(e^x/(x^2 + 1), x, -pi, pi)
```



* when integrating the same function on another interval, e.g. [0;pi] or [-pi;0] instead of [-pi; pi] (unless the troublesome command was run and interrupted before).

* in some versions/systems: Sage 9.5.rc1 running in Debian testing, as reported with more details in  https://groups.google.com/d/msgid/sage-devel/aa218dff-79d2-48ee-837f-8f875bb0dbf2n%40googlegroups.com




---

Comment by chapoton created at 2022-01-30 08:55:01

hmmm, giac and libgiac sort of works:

```
sage: giac('int(e^x/(x^2+1),x,-pi,pi)')
5.27595245778
sage: giac('int(e^x/(x^2+1),x)')
(im(Ei(x+i))*tan(1/2)^2-im(Ei(x+i))-im(Ei(x-i))*tan(1/2)^2+im(Ei(x-i))+2*re(Ei(x+i))*tan(1/2)+2*re(Ei(x-i))*tan(1/2))/(2*tan(1/2)^2+2)

sage: libgiac('int(e^x/(x^2+1),x,-pi,pi)')
// Giac share root-directory:/home/chapoton/sage/local/share/giac/
// Giac share root-directory:/home/chapoton/sage/local/share/giac/
Help file /home/chapoton/sage/local/share/giac/doc/fr/aide_cas not found
Added 0 synonyms
5.27595245778
sage: libgiac('int(e^x/(x^2+1),x)')
(im(Ei(x+i))*tan(1/2)^2-im(Ei(x+i))-im(Ei(x-i))*tan(1/2)^2+im(Ei(x-i))+2*re(Ei(x+i))*tan(1/2)+2*re(Ei(x-i))*tan(1/2))/(2*tan(1/2)^2+2)
```

