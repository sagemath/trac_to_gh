# Issue 20936: implement inner and CM twists for newforms

Issue created by migration from https://trac.sagemath.org/ticket/21173

Original creator: klui

Original creation time: 2016-08-05 06:02:00

Keywords: newforms, twists

f.inner_twists() will return a tuple (inner, CM) with inner an array of inner twists and CM an array of CM twists.


---

Comment by klui created at 2016-08-05 09:22:11

Changing priority from major to minor.


---

Comment by klui created at 2016-08-05 09:22:11

Changing keywords from "newforms, twists" to "newforms, twists, inner, CM".


---

Comment by klui created at 2016-08-05 09:22:11

New commits:


---

Comment by klui created at 2016-08-05 09:22:11

Changing status from new to needs_review.


---

Comment by pbruin created at 2016-08-05 16:07:31

Why is it called `inner_twists()` if it returns two kinds of twists?  I would find it clearer to have either two different functions, or one function accepting a flag to specify which twists should be returned (inner, CM or both).


---

Comment by pbruin created at 2016-08-05 16:07:31

Changing status from needs_review to needs_info.


---

Comment by git created at 2016-08-05 18:59:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klui created at 2016-08-05 19:14:30

Replying to [comment:3 pbruin]:
> Why is it called `inner_twists()` if it returns two kinds of twists?  I would find it clearer to have either two different functions, or one function accepting a flag to specify which twists should be returned (inner, CM or both).

I changed the name to inner_and_CM_twists and created two new functions called inner_twists and CM_twists.


---

Comment by klui created at 2016-08-05 19:14:42

Changing status from needs_info to needs_review.


---

Comment by pbruin created at 2016-08-29 05:06:48

Changing status from needs_review to needs_work.


---

Comment by pbruin created at 2016-08-29 05:06:48

I think this needs some work in several respects:
- The new methods need more documentation.  Briefly define what inner/CM twists are, explain more precisely what the output is (the characters, not the forms themselves), make it clear that CM twists are a special case of inner twists (in particular, the terminology "outer twist" does not seem appropriate).  Give a reference to the literature if possible.
- Maybe clarify whether the results are provably correct.  This does not seem to be the case for the corresponding Magma functions; is it the case here?
- Is it possible that there is more than one CM twist?  I thought that for a newform with CM, the character is unique.  In that case it would be more logical to return either the CM character or `None` (for non-CM forms), instead of a list.  If there can be multiple CM twists, could you give an example of such?
- In Python, objects of the form `[1, 2, 3]` are called lists, not arrays.
- In `inner_twists()` and `cm_twists()`, the `OUTPUT` block is not necessary in my opinion.
- I don't think the `OUTPUT` block should be indented.


---

Comment by chapoton created at 2017-04-17 14:44:29

New commits:


---

Comment by git created at 2017-04-17 14:50:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2017-12-07 15:36:26

Related functionality: #19169


---

Comment by git created at 2017-12-07 16:59:24

Branch pushed to git repo; I updated commit sha1. New commits:
