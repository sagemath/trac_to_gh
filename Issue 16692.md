# Issue 16692: Creating SDP interface

Issue created by migration from Trac.

Original creator: ingolfured

Original creation time: 2014-09-03 17:42:04

CC:  dimpase vbraun ncohen

Users who want to solve a Semidefinite Program, using Sage, have to express the problem in a very restrictive standard form which is required by the solvers, rather than in a natural way that follows mathematical conventions. By creating an interface, similar to the MILP interface, the user should have a much easier time solving an SDP. We aim to create an SDP interface and a backend for CVXOPT, capable of solving simple SDP problems.

The code to the interface can be found here 
https://github.com/ingolfured/sageproject/blob/master/src/sage/numerical/sdp.pyx
and the backend for cvxopt can be found here
https://github.com/ingolfured/sageproject/blob/master/src/sage/numerical/backends/cvxopt_sdp_backend.pyx

All tests passed!


---

Comment by dimpase created at 2014-09-03 18:16:16

Changing priority from minor to major.


---

Comment by dimpase created at 2014-11-28 16:47:22

some more testing etc to be done.


---

Comment by jdemeyer created at 2015-06-23 13:49:26

Changing component from interfaces to interfaces: optional.


---

Comment by git created at 2015-11-30 17:41:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-11-30 17:42:37

Changing status from new to needs_review.


---

Comment by dimpase created at 2015-11-30 17:42:37

see how bots will treat it. Not quite ready for a real review yet.


---

Comment by vdelecroix created at 2015-11-30 18:47:48

No bot will ever look at it... First fill appropriately the author name (full name). Then I will allow my patchbot to have a look. If a user did not already has a certain amount of positively reviewed ticket he/she is not trusted by bots by default.


---

Comment by dimpase created at 2015-11-30 19:06:47

Changing component from interfaces: optional to interfaces.


---

Comment by dimpase created at 2015-11-30 19:17:10

Replying to [comment:4 jdemeyer]: this is an interface to cvxopt.


---

Comment by jdemeyer created at 2015-11-30 19:33:51

To test, just run `make ptestlong` yourself... it might take a few hours, but I think it's less effort than messing with the patchbot.


---

Comment by jdemeyer created at 2015-11-30 19:40:55

I know you said it's not ready for review, but some obvious things:

1. In `/src/module_list.py`, I doubt you need `include_dirs`.

2. In `/src/module_list.py`, I doubt you need `libraries=["stdc++"]` (is there any C++ code involved?)

3. In `/src/module_list.py`, add the new modules in the alphabetically correct place.

4. Use the standard copyright template from [http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files](http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files)

5. Adding deprecations to newly-added code makes no sense.

6. Don't `raise Exception(...)`, use a more specific exception class such as `TypeError`, `ValueError` or `ArithmeticError`.

7. Use `print()` statements compatible with Python 3.

8. Try to avoid `include "sage/ext/cdefs.pxi"`, just `cimport` whatever you need.

9. Use indentation with multiples of 4 spaces (this isn't the case in `cpdef int number_of_constraints(self):`)


---

Comment by jdemeyer created at 2015-11-30 19:44:21

10. I think you can replace the whole class `SDPSolverException` by

```python
class SDPSolverException(RuntimeError):
    """
    Exception raised when the solver fails.

    EXAMPLES::
        
        sage: ....
    """
    pass
```



---

Comment by jdemeyer created at 2015-11-30 19:47:28

11. There is no need for hacks like

```
cdef extern from *:
    ctypedef double* const_double_ptr "const double*"
```

(edit: it seems you don't even use this!)


---

Comment by dimpase created at 2015-11-30 22:15:39

Replying to [comment:11 jdemeyer]:
> I know you said it's not ready for review, but some obvious things:

thanks, that's very useful - 99% of the code was written by my student, so 
I'm slowly getting through it myself now.
 
> 
> 1. In `/src/module_list.py`, I doubt you need `include_dirs`.
> 
> 2. In `/src/module_list.py`, I doubt you need `libraries=["stdc++"]` (is there any C++ code involved?)
> 
> 3. In `/src/module_list.py`, add the new modules in the alphabetically correct place.
>
How does one test changes in `/src/module_list.py` without rebuilding the whole thing?

 
> 
> 7. Use `print()` statements compatible with Python 3. 

how does one deal with the differences in behaviour of `print()` in Python 2 vs 3?
(e.g. 

```
Python 2.7.10 (default, Nov 27 2015, 23:12:30) 
[GCC 4.8.4] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> print("The answer is", 2*2)
('The answer is', 4)
```

instead of

```
Python 3.4.3 (default, Oct 14 2015, 20:28:29) 
[GCC 4.8.4] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> print("The answer is", 2*2)
The answer is 4
```


Should I do `from __future__ import print_function` whenever needed?


---

Comment by git created at 2015-11-30 23:03:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-12-01 07:40:24

Replying to [comment:14 dimpase]:
> How does one test changes in `/src/module_list.py` without rebuilding the whole thing?
If you just want to rebuild all modules in `numerical` for example:

```
$ touch src/sage/numerical/*.pyx
$ ./sage -b
```


> > 7. Use `print()` statements compatible with Python 3. 
> 
> how does one deal with the differences in behaviour of `print()` in Python 2 vs 3?
> (e.g. 
> {{{
> Python 2.7.10 (default, Nov 27 2015, 23:12:30) 
> [GCC 4.8.4] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
> >>> print("The answer is", 2*2)
> ('The answer is', 4)
> }}}
> instead of
> {{{
> Python 3.4.3 (default, Oct 14 2015, 20:28:29) 
> [GCC 4.8.4] on linux
> Type "help", "copyright", "credits" or "license" for more information.
> >>> print("The answer is", 2*2)
> The answer is 4
> }}}
I would write this as

```
print("The answer is {}".format(2*2))
```


> Should I do `from __future__ import print_function` whenever needed?
I don't even know if that works in doctests.


---

Comment by jdemeyer created at 2015-12-01 08:33:57

`from __future__ import print_function` is also good for Sage library code, especially if you want more complicated constructions.


---

Comment by jdemeyer created at 2015-12-01 08:35:01

12. Replace `foo.__repr__()` by `repr(foo)`.


---

Comment by jdemeyer created at 2015-12-01 08:37:02

13. The `EXAMPLES` in `def show(self):` are wrongly indented and lack `sage:` prompts.

14. Remove semi-colons at the end of lines, this isn't C.


---

Comment by dimpase created at 2015-12-01 09:44:55

Replying to [comment:17 jdemeyer]:
> `from __future__ import print_function` is also good for Sage library code, especially if you want more complicated constructions.

looks quite important, to avoid ambiguity with `print (a,b)`, to have this import, no?


---

Comment by jdemeyer created at 2015-12-01 10:19:32

For `print(a,b)`, of course you need `from __future__ import print_function`. But for `print(a)` it doesn't matter. That's also why I suggested replacing `print(a,b)` by something of the form `print(a.format(b))`.


---

Comment by git created at 2015-12-01 11:34:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-12-01 18:34:42

removing Ingo as an author of the ticket, to make patchbots happy. Will put him (Ingólfur Eðvarðsson) back once done...


---

Comment by git created at 2015-12-01 20:38:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-04 12:22:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-12-04 12:24:05

OK, here is some Heisenbug (hopefully not).
Let's see if bots are happy this time.

Would it be possible to postpone porting `print` to Python 3 to another ticket?


---

Comment by git created at 2015-12-07 22:44:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-12-07 22:58:52

This should take care of patchbots coverage plugins complaining about missing tests.

What remains is startup plugins.

While I am at it, should I actually do lazy imports of all the stuff in sage/numeric ?


---

Comment by jdemeyer created at 2015-12-08 22:03:07

This hasn't been addressed completely:

4. Use the standard copyright template from ​http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files (you really should mention the version of the GPL)


---

Comment by jdemeyer created at 2015-12-08 22:03:07

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-12-09 11:39:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-09 12:23:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-12-09 12:24:14

Replying to [comment:29 jdemeyer]:
> This hasn't been addressed completely:
> 
> 4. Use the standard copyright template from ​http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files (you really should mention the version of the GPL)

oops, sorry, fixed now --- along with, hopefully, the rest...


---

Comment by dimpase created at 2015-12-09 12:24:14

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-12-09 21:46:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-18 18:59:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-12-19 00:59:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by dimpase created at 2016-01-09 22:09:22

ping?


---

Comment by vbraun created at 2016-01-09 23:35:49

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-10 10:12:19

Resolution: fixed
