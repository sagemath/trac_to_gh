# Issue 23118: affine hull of one point polyhedron

Issue created by migration from https://trac.sagemath.org/ticket/23355

Original creator: moritz

Original creation time: 2017-07-03 09:11:58

CC:  vdelecroix jipilab

Keywords: polyhedron

When using the orthogonal/orthonormal feature of the affine hull function of a polyhedron (introduced in #22804), there is a problem with the one point polyhedron:



```
sage: P = Polyhedron([[7]])
sage: P
A 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex
sage: P.affine_hull()
A 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 verte
sage: P.affine_hull(orthogonal='True')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'
sage: P.affine_hull(orthonormal='True')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'
```


This is how it should be:

```
sage: P = Polyhedron([[7]]); P
A 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex
sage: P.affine_hull()
A 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 vertex
sage: P.affine_hull(orthonormal='True')
A 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex
sage: P.affine_hull(orthogonal='True')
A 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex
```



---

Comment by moritz created at 2017-07-03 09:18:23

Changing status from new to needs_review.


---

Comment by moritz created at 2017-07-03 09:18:23

The reason why this didn't work properly is the fact that if a Matrix is generated from a list it cannot correctly guess its dimensions if the list is empty. The whole fix is simply to exchange the line

```
M = matrix(self.base_ring(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])
}}} 
by
{{{
M = matrix(self.base_ring(), self.dim(), self.ambient_dim(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])
}}} 
giving the dimensions explicitly. I also added a doctest (under the section TESTS) documenting that the bug is fixed.
----
New commits:


---

Comment by jipilab created at 2017-07-12 08:38:38

Hi Moritz,

Could you add a reference to this ticket just before the tests you added?

Apart from that it looks good to me! You can set it to positive review on my behalf once this is done!


---

Comment by git created at 2017-07-13 16:39:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by moritz created at 2017-07-13 16:57:20

thanks for the review, JP!

I added the desired reference and will put it on 'positive review' as you suggested


---

Comment by moritz created at 2017-07-13 16:57:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-08-03 22:11:19

Resolution: fixed
