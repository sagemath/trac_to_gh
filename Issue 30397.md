# Issue 30397: failing internet doctests using mathematica free

Issue created by migration from https://trac.sagemath.org/ticket/30634

Original creator: slabbe

Original creation time: 2020-09-22 20:37:02

CC:  tscrim

With 9.2.beta13, running

```
sage -tp --optional=sage,internet src/sage/symbolic/integration/external.py src/sage/symbolic/integration/integral.py
```

gives

```
sage -t --random-seed=0 src/sage/symbolic/integration/integral.py
**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 72, in sage.symbolic.integration.integral.IndefiniteIntegral.__init__
Failed example:
    (f*f).integrate(x, algorithm="mathematica_free") # optional -- internet
Expected:
    -b*log(e^(-(a - x)/b) + 1) + x + b/(e^(-(a - x)/b) + 1)
Got:
    -b*log(e^(a/b) + e^(x/b)) + x + b/(e^(-(a - x)/b) + 1)
**********************************************************************
1 item had failures:
   1 of  11 in sage.symbolic.integration.integral.IndefiniteIntegral.__init__
    [213 tests, 1 failure, 14.80 s]
sage -t --random-seed=0 src/sage/symbolic/integration/external.py
**********************************************************************
File "src/sage/symbolic/integration/external.py", line 260, in sage.symbolic.integration.external.parse_moutput_from_json
Failed example:
    sorted(L)                                             # optional internet
Expected:
    [u'-Cos[x]', u'{{x == Pi C[1], Element[C[1], Integers]}}']
Got:
    ['-Cos[x]', '{{x == 0}}', '{{x == Pi C[1], Element[C[1], Integers]}}']
**********************************************************************
1 item had failures:
   1 of  10 in sage.symbolic.integration.external.parse_moutput_from_json
    [40 tests, 1 failure, 28.41 s]
----------------------------------------------------------------------
sage -t --random-seed=0 src/sage/symbolic/integration/integral.py  # 1 doctest failed
sage -t --random-seed=0 src/sage/symbolic/integration/external.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by chapoton created at 2020-09-26 06:22:00

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-09-26 06:22:00

Voil√† !
----
New commits:


---

Comment by chapoton created at 2020-09-29 18:59:29

please review


---

Comment by tscrim created at 2020-09-29 22:40:29

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-09-29 22:40:29

LGTM.


---

Comment by git created at 2020-10-01 08:11:57

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-10-01 08:11:57

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by chapoton created at 2020-10-01 08:12:22

trivial rebase, setting back to positive


---

Comment by chapoton created at 2020-10-01 08:12:22

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-10-05 20:12:58

Resolution: fixed
