# Issue 14710: Stuffle algebra

archive/issues_014710.json:
```json
{
    "body": "Assignee: Matthieu Deneufch\u00e2tel\n\nThe stuffle (or quasi shuffle) algebra with counit and coproduct.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14914\n\n",
    "created_at": "2013-07-21T13:55:41Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Stuffle algebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14710",
    "user": "https://trac.sagemath.org/admin/accounts/users/deneufchatel"
}
```
Assignee: Matthieu Deneufch√¢tel

The stuffle (or quasi shuffle) algebra with counit and coproduct.

Issue created by migration from https://trac.sagemath.org/ticket/14914





---

archive/issue_comments_187253.json:
```json
{
    "body": "Attachment [stuffle.patch](tarball://root/attachments/some-uuid/ticket14914/stuffle.patch) by @fchapoton created at 2013-07-22 09:29:46\n\nhere is a first review patch, cleaning up and making sure that all tests pass\n\n(check using sage -bt stuffle_algebra.py)\n\nsome somments:\n\nTAB characters are forbidden in python, you should use 4 spaces. More generally one should avoid whitespaces at the end of the lines (trailing whitespaces) (check your text editor configuration)\n\nthe examples section should look like that:\n\n```\nEXAMPLES::\n\n    sage: 2+2\n    4\n```\n\nnamely, with a shift of 4 spaces\n\nIf you want to work further on this ticket now, you should rather use a third patch on top of the two existing ones.",
    "created_at": "2013-07-22T09:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187253",
    "user": "https://github.com/fchapoton"
}
```

Attachment [stuffle.patch](tarball://root/attachments/some-uuid/ticket14914/stuffle.patch) by @fchapoton created at 2013-07-22 09:29:46

here is a first review patch, cleaning up and making sure that all tests pass

(check using sage -bt stuffle_algebra.py)

some somments:

TAB characters are forbidden in python, you should use 4 spaces. More generally one should avoid whitespaces at the end of the lines (trailing whitespaces) (check your text editor configuration)

the examples section should look like that:

```
EXAMPLES::

    sage: 2+2
    4
```

namely, with a shift of 4 spaces

If you want to work further on this ticket now, you should rather use a third patch on top of the two existing ones.



---

archive/issue_comments_187254.json:
```json
{
    "body": "Hey Matthieu,\n\nIs this patch ready for review (i.e. does it do everything you want it to)?\n\nBest,\n\nTravis",
    "created_at": "2013-08-03T11:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187254",
    "user": "https://github.com/tscrim"
}
```

Hey Matthieu,

Is this patch ready for review (i.e. does it do everything you want it to)?

Best,

Travis



---

archive/issue_comments_187255.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-10T14:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187255",
    "user": "https://trac.sagemath.org/admin/accounts/users/deneufchatel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_187256.json:
```json
{
    "body": "Attachment [trac_14914_stuffle_addon1_fc.patch](tarball://root/attachments/some-uuid/ticket14914/trac_14914_stuffle_addon1_fc.patch) by @fchapoton created at 2013-09-15 11:52:07",
    "created_at": "2013-09-15T11:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187256",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_14914_stuffle_addon1_fc.patch](tarball://root/attachments/some-uuid/ticket14914/trac_14914_stuffle_addon1_fc.patch) by @fchapoton created at 2013-09-15 11:52:07



---

archive/issue_comments_187257.json:
```json
{
    "body": "Changing keywords from \"\" to \"stuffle quasi shuffle\".",
    "created_at": "2015-02-18T09:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187257",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "stuffle quasi shuffle".



---

archive/issue_comments_187258.json:
```json
{
    "body": "turned into a git branch\n----\nNew commits:",
    "created_at": "2015-02-18T09:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187258",
    "user": "https://github.com/fchapoton"
}
```

turned into a git branch
----
New commits:



---

archive/issue_comments_187259.json:
```json
{
    "body": "Attachment [indexed_alphabet.py](tarball://root/attachments/some-uuid/ticket14914/indexed_alphabet.py) by @videlec created at 2015-11-28 14:58:49",
    "created_at": "2015-11-28T14:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187259",
    "user": "https://github.com/videlec"
}
```

Attachment [indexed_alphabet.py](tarball://root/attachments/some-uuid/ticket14914/indexed_alphabet.py) by @videlec created at 2015-11-28 14:58:49



---

archive/issue_comments_187260.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-11-28T14:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187260",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_187261.json:
```json
{
    "body": "The latex command `\\stuffle` is not interpreted in the reference manual.\n\nThe `(see above)` is not appropriate. In this case it makes reference to another function. And indeed, in the reference manual, the class appears first. You can use the syntax `:func:`the_name_of_my_function`` to refer to a function. But in that case I would actually move the definition from the function to the class (since the entry point for the users is the class).\n\nThe first line of `stuffle` is `W = Words(indexed_letters(40, names))`. Why the hardcoded 40? Whatever number you put it will fail for some input! What you actually want to do is to work over the infinite alphabet `a1, a2, ...`. You can find a draft of the kind of set you want in the attached file [indexed_alphabet.py](http://trac.sagemath.org/attachment/ticket/14914/indexed_alphabet.py). With it you have\n\n```\nsage: A = IndexedAlphabet('a', 0, Infinity)\nsage: A\nIndexed alphabet {a0, a1, a2...}\nsage: A[19]\n'a19'\nsage: A.cardinality()\n+Infinity\nsage: W = Words(A)\nsage: W(['a0','a1','a19'])\nword: a0,a1,a19\n```\n\nOnce the above integrated, there is no need for an argument `names` in the function stuffle.\n\nTo test emptyness of a word you can do faster\n\n```\nsage: w = Word()\nsage: if not w: print \"I am empty\"\nI am empty\n```\n",
    "created_at": "2015-11-28T14:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14710#issuecomment-187261",
    "user": "https://github.com/videlec"
}
```

The latex command `\stuffle` is not interpreted in the reference manual.

The `(see above)` is not appropriate. In this case it makes reference to another function. And indeed, in the reference manual, the class appears first. You can use the syntax `:func:`the_name_of_my_function`` to refer to a function. But in that case I would actually move the definition from the function to the class (since the entry point for the users is the class).

The first line of `stuffle` is `W = Words(indexed_letters(40, names))`. Why the hardcoded 40? Whatever number you put it will fail for some input! What you actually want to do is to work over the infinite alphabet `a1, a2, ...`. You can find a draft of the kind of set you want in the attached file [indexed_alphabet.py](http://trac.sagemath.org/attachment/ticket/14914/indexed_alphabet.py). With it you have

```
sage: A = IndexedAlphabet('a', 0, Infinity)
sage: A
Indexed alphabet {a0, a1, a2...}
sage: A[19]
'a19'
sage: A.cardinality()
+Infinity
sage: W = Words(A)
sage: W(['a0','a1','a19'])
word: a0,a1,a19
```

Once the above integrated, there is no need for an argument `names` in the function stuffle.

To test emptyness of a word you can do faster

```
sage: w = Word()
sage: if not w: print "I am empty"
I am empty
```

