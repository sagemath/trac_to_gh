# Issue 34414: Add `multivariate_interpolation` for multivariate polynomial rings

Issue created by migration from https://trac.sagemath.org/ticket/34651

Original creator: @jbirnick

Original creation time: 2022-10-12 16:15:29

CC:  @schmittj vdelecroix

Keywords: interpolation, polynomials

We add a method `multivariate_interpolation` to the `MPolynomialRing_base` class.

Given a bound on the degree and either point/value pairs or a function, it returns the respective interpolation polynomial.


---

Comment by @jbirnick created at 2022-10-12 16:18:04

Set assignee to @jbirnick.


---

Comment by @jbirnick created at 2022-10-12 16:27:43

New commits:


---

Comment by git created at 2022-10-13 10:45:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @jbirnick created at 2022-10-13 10:50:02

The ticket is now ready for review.

As this is my first ever [SageMath](SageMath) contribution, I also want to ask the following questions:

1. Is my way/style of importing correct? Or should I do it differently?                                                                   
2. I use internal functions, i.e. functions defined inside a function. Is this fine as it is or should I rename them with an underscore in front?
3. Is my way of reporting a warning good or is there a better/"sage-style" way?

Also: The status badge says the linting doesn't pass... however from the log I can't really see what is going wrong.


---

Comment by @jbirnick created at 2022-10-13 10:50:31

Changing status from new to needs_review.


---

Comment by @schmittj created at 2022-10-18 09:21:38

Mathematically the code looks very good to me, it has extensive documentation and - from what I can see - it follows the established code conventions for [SageMath](SageMath). So I am happy to give an informal positive review, but it would be good if someone more familiar with Sage would have another look.


---

Comment by lorenz created at 2022-10-19 17:07:43

Welcome to Sage, this looks like a great first patch!

Some comments regarding the docstring formatting (according to the usual Sage conventions):

- Use backticks ` instead of quotes " around variable names inside the text. This will make the HTML documentation render it as code.
- In general, double colons `::` are used if and only if the following block is indented; use a single colon `:` otherwise.
- `NOTE:` → `.. NOTE::`
- `WARNING::` → `.. WARNING::`
- `SEEALSO:` → `.. SEEALSO::`, and insert another blank line after.
- Do not indent the `ALGORITHM:` block.
- No need to indent the enumerated lists either.
- `a evaluable function` → `an evaluable function`, or maybe drop the articles "a" altogether in that list.

I'm also wondering if the method should just be called `interpolation()`: the "multivariate" part follows from its class.


---

Comment by git created at 2022-10-19 19:00:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @jbirnick created at 2022-10-19 19:05:32

Thanks for your feedback! I have fixed the points you mentioned.

Concerning the function name: `interpolation()` is certainly better for users to find the function. However I wanted to somehow make clear that the `lagrange_polynomial()` (for univariate poly rings) and `multivariate_interpolation()` (for multivariate poly rings) are different functions that also have different speed etc., and then only work for one or multiple variables, respectively.

In the end you are the Sage experts, so I'll call it whatever you all think is best, just let me know.


---

Comment by lorenz created at 2022-10-20 05:02:04

Sorry, I got it wrong: Single backticks are for math and double backticks are for code. There are definitely too many similar-but-different markup languages out there. So, for example:

```
        * ``function`` -- evaluable function in `n` variables, where `n` is the
          number of variables of the polynomial ring
```


I also seem to recall that Sage has a preference for formatting exceptions in accordance with Python's own style, i.e., starting with a lowercase letter and omitting the final punctuation, but I can't find a reference for this right now.

The warning about non-uniqueness of the solution can be useful, but I think it can also be very annoying: Imagine running this in a loop and getting spammed with an endless stream of those messages. Perhaps a cleaner way would be to instead introduce an optional keyword argument to additionally return a basis of the vector space of polynomials which evaluate to zero at the interpolation points? Users who wish to ensure uniqueness can then simply check that this basis is an empty list. (If you dislike this suggestion, we should think of some other way for users to silence the warning if desired.)


---

Comment by git created at 2022-10-20 18:38:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @jbirnick created at 2022-10-20 18:47:01

I have fixed the markup.

**Exceptions formatting:** I have scrolled the Sage source and saw both, so I'm not sure. I personally prefer full sentences, so I kept it like that. However if there is any convention, I'll change it.

**Warnings/non-uniqueness:** Isn't the point that warnings are posted via a special warnings class? So people who don't want to see them should be able to somehow supress them. At least that looks like the clean solution to me. _However_, I wanted to imitate the behavior of `M.solve_right(v)`, so I checked what this does. And it doesn't give a warning at all, so I deleted my warning completely.
(Though personally I would prefer warnings.. maybe in a future ticket.)


---

Comment by lorenz created at 2022-11-03 06:01:02

Changing status from needs_review to positive_review.


---

Comment by lorenz created at 2022-11-03 06:01:02

Alright, looks good to me then. Thank you!


---

Comment by mantepse created at 2022-11-03 09:13:58

Sorry for being late: wouldn't it be better to call the method just "interpolation", or even "interpolate"?

There is a single occurrence of `CALL FORMATS` in sagemath currently, but it seems to me that even there, https://doc.sagemath.org/html/en/reference/matrices/sage/matrix/special.html#sage.matrix.special.ones_matrix, the documentation looks wrong and double backticks should be used:


---

Comment by @jbirnick created at 2022-11-03 15:01:23

`@`Martin concerning the name of the function, have you seen my previous comment:

> Concerning the function name: interpolation() is certainly better for users to find the function. However I wanted to somehow make clear that the lagrange_polynomial() (for univariate poly rings) and multivariate_interpolation() (for multivariate poly rings) are different functions that also have different speed etc., and that only work for one or multiple variables, respectively.

However if multiple experienced Sage users want me to change the name, I can do it. Just let me know.

Concerning documentation I didn't get your point.. is there anything wrongly formatted that I should correct?


---

Comment by mantepse created at 2022-11-04 07:53:26

I don't quite understand: doesn't this function also work in the univariate case?  I am not an expert, so it might be best to ask on sage-devel (and set the ticket to needs info in the meantime).  Or did you ask already, and I missed it?  In this case, please go ahead!


---

Comment by @jbirnick created at 2022-11-04 19:47:59

This function theoretically works for one variable, but:

1. The class for univariate polynomial rings is a completely different one. I would have to copy (and simplify) the code there, which I don't because:
2. There already is an interpolation function for one variable (`lagrange_polynomial()`) that works faster.

All in all the classes for univariate and multivariate polynomial rings are completely different, and the algorithms for interpolation are different as well.

That's why I thought the names should reflect that. I will change the name to `interpolation()` now, and hope that people will recognize that the appropriate function for one variable is `lagrange_polynomial()`. (I mentioned this function in my documentation.)


---

Comment by git created at 2022-11-04 19:55:17

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2022-11-04 19:55:17

Changing status from positive_review to needs_review.


---

Comment by @jbirnick created at 2022-11-05 13:13:49

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-11-07 20:25:50

Resolution: fixed
