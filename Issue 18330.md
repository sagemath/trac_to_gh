# Issue 18330: LatticePoset: add maximal_sublattices_iterator()

Issue created by migration from https://trac.sagemath.org/ticket/18567

Original creator: jmantysalo

Original creation time: 2015-06-01 12:38:27

CC:  ncohen kdilks

How to add an iterator over maximal sublattices of a lattice? I think that the algorithm is not too complicated. Basically we from 1 to n on elements.

Lets suppose that sublattice generated by elements 2,4,5 is not whole lattice. Now try to add 6. If it generates element 1 or 3, we will skip it. That's because if for example 1,2,4,6,8 is a maximal sublattice, then it had been generated already (we have tried all sublattices containing 1 before going to those that does not contain 1).

There might be a room for improvement by somehow arranging elements. But time for it is, I think, after we have some working code.


---

Comment by jmantysalo created at 2015-06-10 12:29:16

There is now some code that at least seems to work. This is quite interesting optimization problem. Can this be made to real `maximal_sublattices_iterator()` instead of `maximal_sublattices()` (that internally generates some non-maximal sublattices and then discards them).

I tried googling some time, but find no algorithm for this. This is somewhat ad hoc solution.
----
New commits:


---

Comment by git created at 2015-06-12 09:07:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-08 11:32:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jmantysalo created at 2015-07-08 11:37:16

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2015-07-19 18:50:57

Ping... Anybody wants to look at the code? This is necessary part in the road to `frattini_sublattice()`.


---

Comment by tscrim created at 2015-07-27 04:39:20

Two minor things:

- I think you could change the test `sorted([sorted(list(x)) for x in ms])` to `sorted(ms, key=sorted)` (note that I didn't actually try this).

- Could you add a space around the `<` comparisons to help improve readability?

Kevin, if you want to do the full review, please go ahead. I'm not sure I will have enough time to throughly test this.


---

Comment by git created at 2015-07-27 08:09:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2015-07-27 08:17:32

Here is one test lattice:


```
z={'d': [1,2,3], 1:['l', 4], 2:[4,'c'], 3:['r',4], 4:[5], 5:[6,13], 6:[7,11], 7:[8,14], 8:[9,12], 9:[10,15], 10:['u'], 'l':[11], 11:[12], 12:['u'], 'r':[13], 13:[14], 14:[15], 15:['u'], 'c':[10]}
M3min=LatticePoset(z)
```


(from http://www.math.hawaii.edu/~ralph/Preprints/combined.pdf you can find more). Do you want some test code? You can make a random lattice (for example random poset + `completion_by_cuts()`), and test by adding one random element to maximal sublattice - it should generate whole lattice. Or make a test like #18562 and see if a random maximal sublattice is found in the list of sublattices.


---

Comment by chapoton created at 2015-08-05 18:39:34

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-08-05 18:39:34

needs rebase, does not apply


---

Comment by git created at 2015-08-09 15:23:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jmantysalo created at 2015-08-09 15:29:22

Replying to [comment:12 chapoton]:
> needs rebase, does not apply

Done that, should work now. I will change this to needs_review after checking myself that this compiles and works.


---

Comment by jmantysalo created at 2015-08-09 18:54:22

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-08-23 22:44:06

I made some minor reviewer changes. If you're happy with them, then go ahead and set a positive review.


---

Comment by jmantysalo created at 2015-08-24 03:58:55

?? Branch-field is red, so I guess you made a typo.


---

Comment by tscrim created at 2015-08-24 05:33:21

I think it's because beta3 was just released and my branch is based off beta2.


---

Comment by jmantysalo created at 2015-08-24 05:43:29

Replying to [comment:18 tscrim]:
> I think it's because beta3 was just released and my branch is based off beta2.

But I don't see the "commits"-link, like there is when the code needs rebasing.


---

Comment by git created at 2015-08-24 19:45:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-08-24 19:46:13

It seems like it didn't push it for some reason. Fixed.


---

Comment by jmantysalo created at 2015-08-25 06:14:49

Changing status from needs_review to positive_review.


---

Comment by jmantysalo created at 2015-08-25 06:14:49

Replying to [comment:16 tscrim]:
> I made some minor reviewer changes. If you're happy with them, then go ahead and set a positive review.

Thank you! Compiles & works.

(Now we just put this to production, and wait for someone to come up with better algorithm...)


---

Comment by vbraun created at 2015-08-26 03:00:16

Resolution: fixed
