# Issue 13447: padic _ntl_rep_abs incorrect for extension fields

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2012-10-25 00:12:22

Assignee: roed

CC:  roed

Currently, `_ntl_rep_abs()` is incorrect for some extension fields::


```
sage: K=Zp(3,3)
sage: R.<a>=K[]
sage: L.<a>=K.extension(a^2-3)
sage: L(3)._ntl_rep_abs()
([57], 0)
```


The correct result here would be `([3],0)`.

The attached patch fixes this.


---

Attachment

There was a problem in `_internal_lshift()`. I rewrote it to use multiplications of the form `x^e/p` which can be done without a precision loss.

It initially took me a while to understand what `_ntl_rep_abs()` does. I reformatted it heavily in this patch but I (hopefully) did not change what it does at all. I hope it's easier to understand now.


---

Comment by saraedum created at 2012-10-27 17:00:29

Changing status from new to needs_review.


---

Comment by saraedum created at 2012-10-27 17:00:29

The doctests in the padics directory pass. Let's see what the patchbot thinks about everything else.

----

This also fixes a `todo` in the code:

```
sage: ZZ(W(5)) # todo: this should be different... 
381469726562505 
```


It seems that roed wrote that todo a few years ago. (added him as CC)


---

Comment by saraedum created at 2014-06-25 20:31:03

Changing keywords from "" to "sd59".


---

Comment by vbraun created at 2014-09-23 10:14:50

looks good but branch doesn't apply currently
----
New commits:


---

Comment by saraedum created at 2014-09-23 10:34:40

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2014-09-23 10:34:40

(changed the status so it shows up in my list of tickets needing work)


---

Comment by git created at 2016-03-16 20:30:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2016-03-24 02:21:04

Changing keywords from "sd59" to "sd59, days71".
