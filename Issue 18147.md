# Issue 18147: random_matrix with algorithm "subspaces" doesn't choose the rank correctly

Issue created by migration from https://trac.sagemath.org/ticket/18384

Original creator: ddrake

Original creation time: 2015-05-08 17:17:26

Keywords: matrix random rank

Using Sage 6.5, when I do

```
random_matrix(QQ, 7,4, algorithm='subspaces')
```

almost always it says

```
Error in lines 1-1
Traceback (most recent call last):
File "/projects/e51fbbc4-453b-4f00a470028a1136adeb/.sagemathcloud/sage_server.py", line 879, in execute
exec compile(block+'\n', '', 'single') in namespace, locals
File "", line 1, in <module>
File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-  packages/sage/matrix/constructor.py", line 1364, in random_matrix
return random_subspaces_matrix(parent, *args, **kwds)
File "/usr/local/sage/sage-6.5/local/lib/python2.7/site-  packages/sage/matrix/constructor.py", line 3583, in random_subspaces_matrix
raise ValueError("rank cannot exceed the number of rows or columns.")
ValueError: rank cannot exceed the number of rows or columns.
```

If I run that many times, it does produce a matrix -- perhaps 5-10% of the time.

The documentation says it randomly generates the rank, but it does not seem smart enough to generate a rank that is possible for the given dimensions.
