# Issue 16567: points() has problems with some lists of complexes containing real (i.e imag(x==0)) values.

archive/issues_016567.json:
```json
{
    "body": "CC:  @videlec @tscrim\n\nKeywords: graphics, plot, complex\n\nMotivating example :\n\n`sage: points(map(lambda x:x[0].N(),(z^20+1).roots()), figsize=4, aspect_ratio=1)` works as expected.\n\n`sage: points(map(lambda x:x[0].N(),(z^20-1).roots()), figsize=4, aspect_ratio=1)` gives an error.\n\nOne (namely K. Crisman ) notes ([https://groups.google.com/forum/#!topic/sage-support/uyiSDTxQ_2U](https://groups.google.com/forum/#!topic/sage-support/uyiSDTxQ_2U)) that some of the member of the second set are real (namely -1 and 1) while none of the members of the first set is real.\n\nIndeed :\n\n`points(map(N, [1+I,I,I-1,-1-I,-I,1-I]),figsize=4)` works as expected.\n\n`points(map(N, [0,1,1+I,I,I-1,-1,-1-I,-I,1-I]),figsize=4)` gives an error.\n\nOne also notes that `points([1+I,I,I-1,-1-I,-I,1-I],figsize=4)` while conforming to `points()` documentation, gives another, different error.\n\nWorkaround suggested by K. Crisman :\n\n`sage: points(map(lambda x:CC(x[0].N()),(z^20-1).roots()), figsize=4, aspect_ratio=1)` works as expected.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16804\n\n",
    "created_at": "2014-08-12T17:52:12Z",
    "labels": [
        "component: graphics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "points() has problems with some lists of complexes containing real (i.e imag(x==0)) values.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16567",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
CC:  @videlec @tscrim

Keywords: graphics, plot, complex

Motivating example :

`sage: points(map(lambda x:x[0].N(),(z^20+1).roots()), figsize=4, aspect_ratio=1)` works as expected.

`sage: points(map(lambda x:x[0].N(),(z^20-1).roots()), figsize=4, aspect_ratio=1)` gives an error.

One (namely K. Crisman ) notes ([https://groups.google.com/forum/#!topic/sage-support/uyiSDTxQ_2U](https://groups.google.com/forum/#!topic/sage-support/uyiSDTxQ_2U)) that some of the member of the second set are real (namely -1 and 1) while none of the members of the first set is real.

Indeed :

`points(map(N, [1+I,I,I-1,-1-I,-I,1-I]),figsize=4)` works as expected.

`points(map(N, [0,1,1+I,I,I-1,-1,-1-I,-I,1-I]),figsize=4)` gives an error.

One also notes that `points([1+I,I,I-1,-1-I,-I,1-I],figsize=4)` while conforming to `points()` documentation, gives another, different error.

Workaround suggested by K. Crisman :

`sage: points(map(lambda x:CC(x[0].N()),(z^20-1).roots()), figsize=4, aspect_ratio=1)` works as expected.

Issue created by migration from https://trac.sagemath.org/ticket/16804





---

archive/issue_comments_217787.json:
```json
{
    "body": "The problem seems to be in xydata_from_point_list() that only checks the first element of the list to determine whether it is a [ComplexNumber](ComplexNumber) or not. Getting patched",
    "created_at": "2016-04-05T18:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217787",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

The problem seems to be in xydata_from_point_list() that only checks the first element of the list to determine whether it is a [ComplexNumber](ComplexNumber) or not. Getting patched



---

archive/issue_comments_217788.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-05T18:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217789.json:
```json
{
    "body": "Obviously the patch also fixes the bug. Somehow the commit text was lost.",
    "created_at": "2016-04-05T18:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217789",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Obviously the patch also fixes the bug. Somehow the commit text was lost.



---

archive/issue_comments_217790.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-05T18:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217790",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_217791.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-05T19:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217791",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_217792.json:
```json
{
    "body": "- Please add spaces around the `=` sign in affectation.\n\n- There is a nice `elif` in Python.\n\n- `RealNumber` and `ComplexNumber` is highly restrictive. You should use `numbers.Real` and `numbers.Complex` from Python which works well under inclusion\n\n```\nsage: import numbers\nsage: isinstance(ZZ.an_element(), numbers.Real)\nTrue\nsage: isinstance(1.0r, numbers.Real)\nTrue\nsage: isinstance(CC.an_element(), numbers.Real)\nFalse\n```\n\n  Once done, you should add doctests accordingly.",
    "created_at": "2016-04-05T19:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217792",
    "user": "https://github.com/videlec"
}
```

- Please add spaces around the `=` sign in affectation.

- There is a nice `elif` in Python.

- `RealNumber` and `ComplexNumber` is highly restrictive. You should use `numbers.Real` and `numbers.Complex` from Python which works well under inclusion

```
sage: import numbers
sage: isinstance(ZZ.an_element(), numbers.Real)
True
sage: isinstance(1.0r, numbers.Real)
True
sage: isinstance(CC.an_element(), numbers.Real)
False
```

  Once done, you should add doctests accordingly.



---

archive/issue_comments_217793.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-06T16:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217794.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-06T16:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217794",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_217795.json:
```json
{
    "body": "I think I got all your points.\nI corrected all three motivating examples.",
    "created_at": "2016-04-06T16:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217795",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

I think I got all your points.
I corrected all three motivating examples.



---

archive/issue_comments_217796.json:
```json
{
    "body": "Could you also add doctests for `points` that are at the origin of this ticket like:\n\n```\nsage: points([0, 1, I])\nGraphics object consisting of 1 graphics primitive\nsage: points([0, 1., CC(0,1)])\nGraphics object consisting of 1 graphics primitive\nsage: points((x^5-1).roots(multiplicities=False))\nGraphics object consisting of 1 graphics primitive\n```\n",
    "created_at": "2016-04-06T17:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217796",
    "user": "https://github.com/videlec"
}
```

Could you also add doctests for `points` that are at the origin of this ticket like:

```
sage: points([0, 1, I])
Graphics object consisting of 1 graphics primitive
sage: points([0, 1., CC(0,1)])
Graphics object consisting of 1 graphics primitive
sage: points((x^5-1).roots(multiplicities=False))
Graphics object consisting of 1 graphics primitive
```




---

archive/issue_comments_217797.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-06T19:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217797",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_217798.json:
```json
{
    "body": "while doing the doctest I have discovered a case I haven't take into account. Working on it",
    "created_at": "2016-04-06T19:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217798",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

while doing the doctest I have discovered a case I haven't take into account. Working on it



---

archive/issue_comments_217799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-16T14:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217800.json:
```json
{
    "body": "Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked. `xydata_from_point_list` is widely used across the libraries and in many different ways.\nI have added doctests to point.py and more examples in plot.py.\nMaybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.",
    "created_at": "2016-04-16T14:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217800",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked. `xydata_from_point_list` is widely used across the libraries and in many different ways.
I have added doctests to point.py and more examples in plot.py.
Maybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.



---

archive/issue_comments_217801.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-16T14:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217801",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_217802.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-16T15:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217803.json:
```json
{
    "body": "Replying to [comment:14 jhonrubia6]:\n> Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked.\n\nWhat problems?\n\n> `xydata_from_point_list` is widely used across the libraries and in many different ways.\n> I have added doctests to point.py and more examples in plot.py.\n> Maybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.\n\nApparently not, there are plenty of doctest failures...",
    "created_at": "2016-04-16T19:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217803",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:14 jhonrubia6]:
> Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked.

What problems?

> `xydata_from_point_list` is widely used across the libraries and in many different ways.
> I have added doctests to point.py and more examples in plot.py.
> Maybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.

Apparently not, there are plenty of doctest failures...



---

archive/issue_comments_217804.json:
```json
{
    "body": "Replying to [comment:17 vdelecroix]:\n> Replying to [comment:14 jhonrubia6]:\n> > Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked.\n> \n> What problems?\nIt failed the doctest\n\n\n```\nsage: xydata_from_point_list((1,2))\n        ([1.0], [2.0])\n```\n\nwhen changing `CompleNumber` to `number.Complex` it did not recognize the tuple as such, interpreting it as two complex numbers on the real line. And, as [ComplexNumber](ComplexNumber) was used in the original code I thought it was justified its use. If you'd be so kind to tell me in which cases is better `number.Complex` I will do my best to use it.\n\n> \n> > `xydata_from_point_list` is widely used across the libraries and in many different ways.\n> > I have added doctests to point.py and more examples in plot.py.\n> > Maybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.\n> \n> Apparently not, there are plenty of doctest failures...\n\nI will double-check (right now I am running the full set of tests `sage -t -a ` again), I did it before pushing the commit and all tests passed OK. If you please give me one example of the tests that fails in your setting I will check it with my results asap.",
    "created_at": "2016-04-16T21:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217804",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Replying to [comment:17 vdelecroix]:
> Replying to [comment:14 jhonrubia6]:
> > Reverted back to [ComplexNumber](ComplexNumber). After ` sage -t -a ` with some errors using numbers.Complex I decided to go back to [ComplexNumber](ComplexNumber) and everything worked.
> 
> What problems?
It failed the doctest


```
sage: xydata_from_point_list((1,2))
        ([1.0], [2.0])
```

when changing `CompleNumber` to `number.Complex` it did not recognize the tuple as such, interpreting it as two complex numbers on the real line. And, as [ComplexNumber](ComplexNumber) was used in the original code I thought it was justified its use. If you'd be so kind to tell me in which cases is better `number.Complex` I will do my best to use it.

> 
> > `xydata_from_point_list` is widely used across the libraries and in many different ways.
> > I have added doctests to point.py and more examples in plot.py.
> > Maybe in a different trac ticket somebody can make it work with numbers.complex if it is better as you say (I do not know). As it is the bug is fixed.
> 
> Apparently not, there are plenty of doctest failures...

I will double-check (right now I am running the full set of tests `sage -t -a ` again), I did it before pushing the commit and all tests passed OK. If you please give me one example of the tests that fails in your setting I will check it with my results asap.



---

archive/issue_comments_217805.json:
```json
{
    "body": "There is no need to run the test yourself. There are computers that are doing that for each ticket. If you click on the blob on the up right of the ticket description you access the patchbot reports. Or directly [http://patchbot.sagemath.org/ticket/16804/](http://patchbot.sagemath.org/ticket/16804/).",
    "created_at": "2016-04-16T22:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217805",
    "user": "https://github.com/videlec"
}
```

There is no need to run the test yourself. There are computers that are doing that for each ticket. If you click on the blob on the up right of the ticket description you access the patchbot reports. Or directly [http://patchbot.sagemath.org/ticket/16804/](http://patchbot.sagemath.org/ticket/16804/).



---

archive/issue_comments_217806.json:
```json
{
    "body": "In the commit `327d817` why did you add the line `points = map(N,points)` at the begining?",
    "created_at": "2016-04-16T22:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217806",
    "user": "https://github.com/videlec"
}
```

In the commit `327d817` why did you add the line `points = map(N,points)` at the begining?



---

archive/issue_comments_217807.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-16T22:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217808.json:
```json
{
    "body": "Replying to [comment:20 vdelecroix]:\n> In the commit `327d817` why did you add the line `points = map(N,points)` at the beginning?\nIt was an early unsuccessful attempt to rewrite the code from scratch. After running into many dead ends, I decided to patch the existing code to take into account the new bug, checking if there is at least one complex number within the list, the result is the last commit `df6da21` (except the debugging code line that I forgot to remove)",
    "created_at": "2016-04-16T22:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217808",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Replying to [comment:20 vdelecroix]:
> In the commit `327d817` why did you add the line `points = map(N,points)` at the beginning?
It was an early unsuccessful attempt to rewrite the code from scratch. After running into many dead ends, I decided to patch the existing code to take into account the new bug, checking if there is at least one complex number within the list, the result is the last commit `df6da21` (except the debugging code line that I forgot to remove)



---

archive/issue_comments_217809.json:
```json
{
    "body": "I uploaded the code as an attachment for the sake of clarity",
    "created_at": "2016-04-16T22:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217809",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

I uploaded the code as an attachment for the sake of clarity



---

archive/issue_comments_217810.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-17T09:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217810",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217811.json:
```json
{
    "body": "Attachment [xydata_from_point_list.py](tarball://root/attachments/some-uuid/ticket16804/xydata_from_point_list.py) by jhonrubia6 created at 2016-04-17 09:12:21\n\nPatched code",
    "created_at": "2016-04-17T09:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217811",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Attachment [xydata_from_point_list.py](tarball://root/attachments/some-uuid/ticket16804/xydata_from_point_list.py) by jhonrubia6 created at 2016-04-17 09:12:21

Patched code



---

archive/issue_comments_217812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-17T10:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217812",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217813.json:
```json
{
    "body": "Replying to [comment:19 vdelecroix]:\n> There is no need to run the test yourself. There are computers that are doing that for each ticket. If you click on the blob on the up right of the ticket description you access the patchbot reports. Or directly [http://patchbot.sagemath.org/ticket/16804/](http://patchbot.sagemath.org/ticket/16804/).\nAll test pass ok in my installation. The error I see in the patchbot report does not seem related to this patch.",
    "created_at": "2016-04-21T18:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217813",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Replying to [comment:19 vdelecroix]:
> There is no need to run the test yourself. There are computers that are doing that for each ticket. If you click on the blob on the up right of the ticket description you access the patchbot reports. Or directly [http://patchbot.sagemath.org/ticket/16804/](http://patchbot.sagemath.org/ticket/16804/).
All test pass ok in my installation. The error I see in the patchbot report does not seem related to this patch.



---

archive/issue_comments_217814.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-08T02:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217814",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_217815.json:
```json
{
    "body": "You introduced trailing whitespaces (i.e. space just before the end of a new line). You should get rid of them.\n\nIn the documentation, if there is a comment then you should add two colons and a linebreak before a new test. In other words replace\n\n```\n    but \n        sage: xydata_from_point_list((1,5,2))\n        Traceback (most recent call last):\n        ...\n```\n\nwith\n\n```\n    but::\n\n        sage: xydata_from_point_list((1,5,2))\n        Traceback (most recent call last):\n        ...\n```\n",
    "created_at": "2016-05-08T02:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217815",
    "user": "https://github.com/videlec"
}
```

You introduced trailing whitespaces (i.e. space just before the end of a new line). You should get rid of them.

In the documentation, if there is a comment then you should add two colons and a linebreak before a new test. In other words replace

```
    but 
        sage: xydata_from_point_list((1,5,2))
        Traceback (most recent call last):
        ...
```

with

```
    but::

        sage: xydata_from_point_list((1,5,2))
        Traceback (most recent call last):
        ...
```




---

archive/issue_comments_217816.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-08T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217816",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217817.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-08T16:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217817",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_217818.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-31T05:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217818",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_217819.json:
```json
{
    "body": "There should be a line break at the end of the function `xydata_from_point_list` to separate it from `plot`.\n\nIn your context, it makes no sense to use reduce. You should use either `all` or `any`.\n\nI do not feel very confortable with the syntax\n\n```\nsage: points(CC(0,1))   # only one point !\nsage: points(1)         # one point but does not work!\n```\n\nAs the method is plural, I guess we should just forbid this case. What do you think? Depending on your answer you might want to fix\n\n```\nsage: points(CC(0,1))       # fine\nsage: points(CDF(0,1))      # fine\nsage: points(complex(1j))   # used to work\n```\n\nAnd ideally, numpy complex numbers should also be supported. You would better use `numbers` as adviced in [comment:8 comment:8].",
    "created_at": "2016-05-31T05:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217819",
    "user": "https://github.com/videlec"
}
```

There should be a line break at the end of the function `xydata_from_point_list` to separate it from `plot`.

In your context, it makes no sense to use reduce. You should use either `all` or `any`.

I do not feel very confortable with the syntax

```
sage: points(CC(0,1))   # only one point !
sage: points(1)         # one point but does not work!
```

As the method is plural, I guess we should just forbid this case. What do you think? Depending on your answer you might want to fix

```
sage: points(CC(0,1))       # fine
sage: points(CDF(0,1))      # fine
sage: points(complex(1j))   # used to work
```

And ideally, numpy complex numbers should also be supported. You would better use `numbers` as adviced in [comment:8 comment:8].



---

archive/issue_comments_217820.json:
```json
{
    "body": "Replying to [comment:31 vdelecroix]:\n> There should be a line break at the end of the function `xydata_from_point_list` to separate it from `plot`.\nok, I will do it.\n> \n> In your context, it makes no sense to use reduce. You should use either `all` or `any`.\nok, I will do it.\n\n> I do not feel very confortable with the syntax\n> {{{\n> sage: points(CC(0,1))   # only one point !\n> sage: points(1)         # one point but does not work!\n> }}}\n> As the method is plural, I guess we should just forbid this case. What do you think?\nThe original method is `point` and at the end of the model there is a `points = point` line, so I guess we have to support the 'singular' case of only one point in `xydata_from_point_list` I'll have a look into the failing case `point(1)`.\n\n> Depending on your answer you might want to fix\n> {{{\n> sage: points(CC(0,1))       # fine\n> sage: points(CDF(0,1))      # fine\n> sage: points(complex(1j))   # used to work\n> }}}\nWhat do you mean by 'used to work'? I tested `points(complex(1j))` in cloud.sagemath.com (v6.10) and it doesn't work.\n\n> And ideally, numpy complex numbers should also be supported. You would better use `numbers` as adviced in [comment:8 comment:8].\nok, ok, ok :-) I'll give it another try, last time I tried I wasn't able to make it work.",
    "created_at": "2016-05-31T06:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217820",
    "user": "https://trac.sagemath.org/admin/accounts/users/jhonrubia6"
}
```

Replying to [comment:31 vdelecroix]:
> There should be a line break at the end of the function `xydata_from_point_list` to separate it from `plot`.
ok, I will do it.
> 
> In your context, it makes no sense to use reduce. You should use either `all` or `any`.
ok, I will do it.

> I do not feel very confortable with the syntax
> {{{
> sage: points(CC(0,1))   # only one point !
> sage: points(1)         # one point but does not work!
> }}}
> As the method is plural, I guess we should just forbid this case. What do you think?
The original method is `point` and at the end of the model there is a `points = point` line, so I guess we have to support the 'singular' case of only one point in `xydata_from_point_list` I'll have a look into the failing case `point(1)`.

> Depending on your answer you might want to fix
> {{{
> sage: points(CC(0,1))       # fine
> sage: points(CDF(0,1))      # fine
> sage: points(complex(1j))   # used to work
> }}}
What do you mean by 'used to work'? I tested `points(complex(1j))` in cloud.sagemath.com (v6.10) and it doesn't work.

> And ideally, numpy complex numbers should also be supported. You would better use `numbers` as adviced in [comment:8 comment:8].
ok, ok, ok :-) I'll give it another try, last time I tried I wasn't able to make it work.



---

archive/issue_comments_217821.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-09-21T20:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217821",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_217822.json:
```json
{
    "body": "Here is another tentative\n----\nNew commits:",
    "created_at": "2020-09-21T20:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217822",
    "user": "https://github.com/fchapoton"
}
```

Here is another tentative
----
New commits:



---

archive/issue_comments_217823.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-09-22T06:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217823",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_217824.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-25T17:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217824",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217825.json:
```json
{
    "body": "green bot, please review",
    "created_at": "2020-10-03T07:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217825",
    "user": "https://github.com/fchapoton"
}
```

green bot, please review



---

archive/issue_comments_217826.json:
```json
{
    "body": "I suggest to move the handlings of specials cases to the `plot` definition.\n\n\n```diff\ndiff --git a/src/sage/plot/plot.py b/src/sage/plot/plot.py\nindex 5f78020eec..be5d8ef784 100644\n--- a/src/sage/plot/plot.py\n+++ b/src/sage/plot/plot.py\n@@ -799,21 +799,7 @@ def xydata_from_point_list(points):\n     \"\"\"\n     import numbers\n     zero = float(0)\n-    # input could be a single number\n-    if isinstance(points, numbers.Complex):\n-        return [float(points.real())], [float(points.imag())]\n-    elif isinstance(points, numbers.Real):\n-        return [float(points)], [zero]\n-    # create a list\n-    if not isinstance(points, (list, tuple)):\n-        points = list(points)\n-    # special case for a single 2D or 3D point (resolve ambiguity)\n-    if len(points) == 2:\n-        if all(isinstance(z, numbers.Real) for z in points):\n-            points = [points]\n-    elif len(points) == 3:\n-        if all(isinstance(z, numbers.Real) for z in points):\n-            raise TypeError('not a 2D point')\n+\n     xdata = []\n     ydata = []\n     # otherwise input is an iterable\ndiff --git a/src/sage/plot/point.py b/src/sage/plot/point.py\nindex de9ae7d1d1..531929da0e 100644\n--- a/src/sage/plot/point.py\n+++ b/src/sage/plot/point.py\n@@ -343,7 +343,7 @@ def point(points, **kwds):\n     \"\"\"\n     if isinstance(points, Iterator):\n         points = list(points)\n-        \n+\n     try:\n         return point2d(points, **kwds)\n     except (ValueError, TypeError):\n@@ -464,18 +464,24 @@ def point2d(points, **options):\n     \"\"\"\n     from sage.plot.plot import xydata_from_point_list\n     from sage.plot.all import Graphics\n+\n+    # points could be a single number\n     if isinstance(points, numbers.Complex):\n-        pass\n-    else:\n-        try:\n-            l = len(points)\n-        except TypeError:\n-            # argument is an iterator\n-            points = list(points)\n-            l = len(points)\n-\n-        if l == 0:\n-            return Graphics()\n+        points = [(points.real(), points.imag())]\n+    elif isinstance(points, numbers.Real):\n+        points = [points]\n+    elif not isinstance(points, (list, tuple)):\n+        points = [points]\n+\n+    l = len(points)\n+    if l == 0:\n+        return Graphics()\n+    elif l == 2:  # special case for a single 2D point\n+        if all(isinstance(z, numbers.Real) for z in points):\n+            points = [points]\n+    elif l == 3:  # special case for a single 3D point\n+        if all(isinstance(z, numbers.Real) for z in points):\n+            raise TypeError('not a 2D point')\n \n     xdata, ydata = xydata_from_point_list(points)\n     g = Graphics()                  \n```\n",
    "created_at": "2020-10-07T08:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217826",
    "user": "https://github.com/kwankyu"
}
```

I suggest to move the handlings of specials cases to the `plot` definition.


```diff
diff --git a/src/sage/plot/plot.py b/src/sage/plot/plot.py
index 5f78020eec..be5d8ef784 100644
--- a/src/sage/plot/plot.py
+++ b/src/sage/plot/plot.py
@@ -799,21 +799,7 @@ def xydata_from_point_list(points):
     """
     import numbers
     zero = float(0)
-    # input could be a single number
-    if isinstance(points, numbers.Complex):
-        return [float(points.real())], [float(points.imag())]
-    elif isinstance(points, numbers.Real):
-        return [float(points)], [zero]
-    # create a list
-    if not isinstance(points, (list, tuple)):
-        points = list(points)
-    # special case for a single 2D or 3D point (resolve ambiguity)
-    if len(points) == 2:
-        if all(isinstance(z, numbers.Real) for z in points):
-            points = [points]
-    elif len(points) == 3:
-        if all(isinstance(z, numbers.Real) for z in points):
-            raise TypeError('not a 2D point')
+
     xdata = []
     ydata = []
     # otherwise input is an iterable
diff --git a/src/sage/plot/point.py b/src/sage/plot/point.py
index de9ae7d1d1..531929da0e 100644
--- a/src/sage/plot/point.py
+++ b/src/sage/plot/point.py
@@ -343,7 +343,7 @@ def point(points, **kwds):
     """
     if isinstance(points, Iterator):
         points = list(points)
-        
+
     try:
         return point2d(points, **kwds)
     except (ValueError, TypeError):
@@ -464,18 +464,24 @@ def point2d(points, **options):
     """
     from sage.plot.plot import xydata_from_point_list
     from sage.plot.all import Graphics
+
+    # points could be a single number
     if isinstance(points, numbers.Complex):
-        pass
-    else:
-        try:
-            l = len(points)
-        except TypeError:
-            # argument is an iterator
-            points = list(points)
-            l = len(points)
-
-        if l == 0:
-            return Graphics()
+        points = [(points.real(), points.imag())]
+    elif isinstance(points, numbers.Real):
+        points = [points]
+    elif not isinstance(points, (list, tuple)):
+        points = [points]
+
+    l = len(points)
+    if l == 0:
+        return Graphics()
+    elif l == 2:  # special case for a single 2D point
+        if all(isinstance(z, numbers.Real) for z in points):
+            points = [points]
+    elif l == 3:  # special case for a single 3D point
+        if all(isinstance(z, numbers.Real) for z in points):
+            raise TypeError('not a 2D point')
 
     xdata, ydata = xydata_from_point_list(points)
     g = Graphics()                  
```




---

archive/issue_comments_217827.json:
```json
{
    "body": "you mean to the `point` definition ?",
    "created_at": "2020-10-08T16:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217827",
    "user": "https://github.com/fchapoton"
}
```

you mean to the `point` definition ?



---

archive/issue_comments_217828.json:
```json
{
    "body": "Replying to [comment:38 chapoton]:\n> you mean to the `point` definition ?\n\nYes, `point2d` exactly.",
    "created_at": "2020-10-09T01:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217828",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:38 chapoton]:
> you mean to the `point` definition ?

Yes, `point2d` exactly.



---

archive/issue_comments_217829.json:
```json
{
    "body": "If you have no objection, I am willing to upload a public branch containing the commit I suggested.",
    "created_at": "2020-10-28T09:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217829",
    "user": "https://github.com/kwankyu"
}
```

If you have no objection, I am willing to upload a public branch containing the commit I suggested.



---

archive/issue_comments_217830.json:
```json
{
    "body": "please do so.",
    "created_at": "2020-10-28T09:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217830",
    "user": "https://github.com/fchapoton"
}
```

please do so.



---

archive/issue_comments_217831.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-28T10:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217831",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217832.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-28T10:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217832",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_217833.json:
```json
{
    "body": "Positive review on Fr\u00e9d\u00e9ric's code.\n\nIf you are ok with the last changes, you set the flag on.",
    "created_at": "2020-10-29T00:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217833",
    "user": "https://github.com/kwankyu"
}
```

Positive review on Frédéric's code.

If you are ok with the last changes, you set the flag on.



---

archive/issue_comments_217834.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-31T11:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217834",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_217835.json:
```json
{
    "body": "Green light on a bot.",
    "created_at": "2020-10-31T11:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217835",
    "user": "https://github.com/kwankyu"
}
```

Green light on a bot.



---

archive/issue_comments_217836.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-11-01T01:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217836",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_217837.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2020-11-01T01:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217837",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_217838.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-01T09:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217838",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_217839.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-11-01T09:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217839",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_217840.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-02T00:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217840",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_016057.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-22T15:05:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16567#event-16057"
}
```



---

archive/issue_comments_217841.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-22T15:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217841",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_217842.json:
```json
{
    "body": "The code here has `points.real()`, `points.imag()`,\n`xy.real()`, `xy.imag()`.\n\n\nIn some cases, see #30942, `real(z)` and `imag(z)`\nwork better than `z.real()` and `z.imag()`.",
    "created_at": "2020-11-23T00:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217842",
    "user": "https://github.com/slel"
}
```

The code here has `points.real()`, `points.imag()`,
`xy.real()`, `xy.imag()`.


In some cases, see #30942, `real(z)` and `imag(z)`
work better than `z.real()` and `z.imag()`.



---

archive/issue_comments_217843.json:
```json
{
    "body": "See #30970 for a possible follow up.",
    "created_at": "2020-11-27T12:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16567#issuecomment-217843",
    "user": "https://github.com/egourgoulhon"
}
```

See #30970 for a possible follow up.
