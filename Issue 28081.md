# Issue 28081: linbox for sparse integer matrix

archive/issues_028081.json:
```json
{
    "body": "CC:  cpernet\n\nThe following now seems to works correctly\n\n```\nsage: m = diagonal_matrix(ZZ, [2] * 46)\nsage: m._det_linbox()\n70368744177664\nsage: m = diagonal_matrix(ZZ, [3] * 100)\nsage: m._det_linbox()\n515377520732011331036461129765621272702107522001\n```\n\nThis ticket stands for removing the `#not tested` directive and also put the appropriate `sig_on`/`sig_off` around linbox calls.\n\n\nNote however, linbox is not doing great\n\n```\nsage: M = MatrixSpace(ZZ, 100, 100, sparse=True)\nsage: m = M.random_element(density=0.1)\nsage: %timeit m.__copy__().det()\n100 loops, best of 5: 8.45 ms per loop\nsage: %timeit m._det_linbox()\n10 loops, best of 5: 43.4 ms per loop\n```\n\nAnd it gets worse as the dimension increases\n\n```\nsage: M = MatrixSpace(ZZ, 500, 500, sparse=True)\nsage: m = M.random_element(density=0.1)\nsage: %time d = m.__copy__().det()\nCPU times: user 796 ms, sys: 3 \u00b5s, total: 796 ms\nWall time: 795 ms\nsage: %time m._det_linbox()\nCPU times: user 25.2 s, sys: 44 ms, total: 25.3 s\nWall time: 25.3 s\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28318\n\n",
    "created_at": "2019-08-03T13:58:36Z",
    "labels": [
        "linear algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "linbox for sparse integer matrix",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28081",
    "user": "vdelecroix"
}
```
CC:  cpernet

The following now seems to works correctly

```
sage: m = diagonal_matrix(ZZ, [2] * 46)
sage: m._det_linbox()
70368744177664
sage: m = diagonal_matrix(ZZ, [3] * 100)
sage: m._det_linbox()
515377520732011331036461129765621272702107522001
```

This ticket stands for removing the `#not tested` directive and also put the appropriate `sig_on`/`sig_off` around linbox calls.


Note however, linbox is not doing great

```
sage: M = MatrixSpace(ZZ, 100, 100, sparse=True)
sage: m = M.random_element(density=0.1)
sage: %timeit m.__copy__().det()
100 loops, best of 5: 8.45 ms per loop
sage: %timeit m._det_linbox()
10 loops, best of 5: 43.4 ms per loop
```

And it gets worse as the dimension increases

```
sage: M = MatrixSpace(ZZ, 500, 500, sparse=True)
sage: m = M.random_element(density=0.1)
sage: %time d = m.__copy__().det()
CPU times: user 796 ms, sys: 3 Âµs, total: 796 ms
Wall time: 795 ms
sage: %time m._det_linbox()
CPU times: user 25.2 s, sys: 44 ms, total: 25.3 s
Wall time: 25.3 s
```


Issue created by migration from https://trac.sagemath.org/ticket/28318





---

archive/issue_comments_396769.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-03T14:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396769",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396770.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-08-03T14:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396770",
    "user": "vdelecroix"
}
```

New commits:



---

archive/issue_comments_396771.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-04T13:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396771",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396772.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-04T13:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396772",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396773.json:
```json
{
    "body": "Just a quick note: speed is one thing, but memory usage is also important. Anyways, one little change and then a positive review:\n\n```diff\n-        NOTE: This method is much slower than converting to a dense matrix and\n-        computing the determinant there. There is not much point in making it\n-        available. See :trac:`28318`.\n+        .. NOTE::\n+\n+            This method is much slower than converting to a dense matrix and\n+            computing the determinant there. There is not much point in making\n+            it available. See :trac:`28318`.\n```\n\nThanks.",
    "created_at": "2019-08-09T19:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396773",
    "user": "tscrim"
}
```

Just a quick note: speed is one thing, but memory usage is also important. Anyways, one little change and then a positive review:

```diff
-        NOTE: This method is much slower than converting to a dense matrix and
-        computing the determinant there. There is not much point in making it
-        available. See :trac:`28318`.
+        .. NOTE::
+
+            This method is much slower than converting to a dense matrix and
+            computing the determinant there. There is not much point in making
+            it available. See :trac:`28318`.
```

Thanks.



---

archive/issue_comments_396774.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-09T21:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396774",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396775.json:
```json
{
    "body": "Thanks.",
    "created_at": "2019-08-11T18:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396775",
    "user": "tscrim"
}
```

Thanks.



---

archive/issue_comments_396776.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-11T18:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396776",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396777.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-12T19:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28081#issuecomment-396777",
    "user": "vbraun"
}
```

Resolution: fixed
