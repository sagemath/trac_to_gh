# Issue 33847: Fix bug with comparison to 1 in IndexedFreeModuleElement

archive/issues_033847.json:
```json
{
    "body": "CC:  @tscrim @trevorkarn\n\nKeywords: gsoc2022 one-basis indexed-free-module\n\nThere is a monomial basis comparison to 1 in IndexedFreeModule element. This ticket expands it to a comparison with `.one_basis()`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34084\n\n",
    "created_at": "2022-06-26T03:25:52Z",
    "labels": [
        "linear algebra",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Fix bug with comparison to 1 in IndexedFreeModuleElement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33847",
    "user": "@trevorkarn"
}
```
CC:  @tscrim @trevorkarn

Keywords: gsoc2022 one-basis indexed-free-module

There is a monomial basis comparison to 1 in IndexedFreeModule element. This ticket expands it to a comparison with `.one_basis()`.

Issue created by migration from https://trac.sagemath.org/ticket/34084





---

archive/issue_comments_480820.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-26T03:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480820",
    "user": "@trevorkarn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480821.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-27T02:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480821",
    "user": "@tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_480822.json:
```json
{
    "body": "This is dangerous as a module does not have to implement a `one_basis()` (in fact, some of them do not because it is not an element of the basis). I agree with the principle of this change, but you should pull out getting the `self.parent().one_basis()` outside of the loops and into a `try`-`except AttributeError:` block. I would set the stored `one_basis` variable you'll need to `None` for the exception branch.\n\nThe same change should be done in `_unicode_art_` as well.",
    "created_at": "2022-06-27T02:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480822",
    "user": "@tscrim"
}
```

This is dangerous as a module does not have to implement a `one_basis()` (in fact, some of them do not because it is not an element of the basis). I agree with the principle of this change, but you should pull out getting the `self.parent().one_basis()` outside of the loops and into a `try`-`except AttributeError:` block. I would set the stored `one_basis` variable you'll need to `None` for the exception branch.

The same change should be done in `_unicode_art_` as well.



---

archive/issue_comments_480823.json:
```json
{
    "body": "Sounds good. Is there any examples of modules that don\u2019t implement .one_basis that come to mind? I want to make sure I can add an example in the doctest where the fix I had breaks.",
    "created_at": "2022-06-29T13:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480823",
    "user": "@trevorkarn"
}
```

Sounds good. Is there any examples of modules that don’t implement .one_basis that come to mind? I want to make sure I can add an example in the doctest where the fix I had breaks.



---

archive/issue_comments_480824.json:
```json
{
    "body": "I think one of the bases for the `DescentAlgebra` doesn\u2019t have a `one_basis()` since `one()` is a sum of basis elements. There is also a basis of one of the combinatorial Hopf algebras called the orbit basis that also has this IIRC.",
    "created_at": "2022-06-29T13:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480824",
    "user": "@tscrim"
}
```

I think one of the bases for the `DescentAlgebra` doesn’t have a `one_basis()` since `one()` is a sum of basis elements. There is also a basis of one of the combinatorial Hopf algebras called the orbit basis that also has this IIRC.



---

archive/issue_comments_480825.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-25T15:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480825",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480826.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-25T15:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480826",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480827.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-25T15:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480827",
    "user": "@trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_480828.json:
```json
{
    "body": "Thanks. LGTM.",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480828",
    "user": "@tscrim"
}
```

Thanks. LGTM.



---

archive/issue_comments_480829.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480829",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_480830.json:
```json
{
    "body": "Changing keywords from \"gsoc2022 one-basis indexed-free-module\" to \"gsoc2022, one basis, indexed free module\".",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480830",
    "user": "@tscrim"
}
```

Changing keywords from "gsoc2022 one-basis indexed-free-module" to "gsoc2022, one basis, indexed free module".



---

archive/issue_comments_480831.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-04T22:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33847#issuecomment-480831",
    "user": "@vbraun"
}
```

Resolution: fixed
