# Issue 33847: Fix bug with comparison to 1 in IndexedFreeModuleElement

Issue created by migration from https://trac.sagemath.org/ticket/34084

Original creator: tkarn

Original creation time: 2022-06-26 03:25:52

CC:  tscrim tkarn

Keywords: gsoc2022 one-basis indexed-free-module

There is a monomial basis comparison to 1 in IndexedFreeModule element. This ticket expands it to a comparison with `.one_basis()`.


---

Comment by tkarn created at 2022-06-26 03:26:16

Changing status from new to needs_review.


---

Comment by tscrim created at 2022-06-27 02:26:12

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2022-06-27 02:26:12

This is dangerous as a module does not have to implement a `one_basis()` (in fact, some of them do not because it is not an element of the basis). I agree with the principle of this change, but you should pull out getting the `self.parent().one_basis()` outside of the loops and into a `try`-`except AttributeError:` block. I would set the stored `one_basis` variable you'll need to `None` for the exception branch.

The same change should be done in `_unicode_art_` as well.


---

Comment by tkarn created at 2022-06-29 13:25:39

Sounds good. Is there any examples of modules that don’t implement .one_basis that come to mind? I want to make sure I can add an example in the doctest where the fix I had breaks.


---

Comment by tscrim created at 2022-06-29 13:50:51

I think one of the bases for the `DescentAlgebra` doesn’t have a `one_basis()` since `one()` is a sum of basis elements. There is also a basis of one of the combinatorial Hopf algebras called the orbit basis that also has this IIRC.


---

Comment by git created at 2022-07-25 15:08:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-07-25 15:27:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tkarn created at 2022-07-25 15:27:50

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2022-07-28 01:58:04

Thanks. LGTM.


---

Comment by tscrim created at 2022-07-28 01:58:04

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2022-07-28 01:58:04

Changing keywords from "gsoc2022 one-basis indexed-free-module" to "gsoc2022, one basis, indexed free module".


---

Comment by vbraun created at 2022-08-04 22:45:09

Resolution: fixed
