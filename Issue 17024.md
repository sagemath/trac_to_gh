# Issue 17024: Coercions from the modular group to the Theta subgroup

Issue created by migration from https://trac.sagemath.org/ticket/17261

Original creator: jj

Original creation time: 2014-10-30 13:37:01

CC:  snark mraum vdelecroix

Keywords: hecke triangle group coercion

This ticket adds support for coercions from form spaces/rings over the full
modular group to form spaces/rings over the Theta subgroup (which are both
Hecke triangle groups). In all other cases coercions between groups are disabled
since there is no "nice" common subgroup.



---

Comment by jj created at 2014-10-30 16:04:57

Changing status from new to needs_review.


---

Comment by git created at 2015-01-25 21:19:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-02-22 17:42:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Snark created at 2015-03-12 07:52:14

Changing status from needs_review to needs_work.


---

Comment by Snark created at 2015-03-12 07:52:14

Hmmmm... it doesn't seem to compile here... perhaps because I already compiled parts of sage from develop, while the branch is based off 6.6.beta1.

Could you rebase it?


---

Comment by jj created at 2015-03-12 18:26:49

Hi

Hmm, running "make clean; make doc-clean; make" worked for me.
I'm a bit hesitant to rebase since I have a lot of work based on this branch.
Is it 100% save to rebase? What would be the exact command?
How would I propagate this change to the other dependent branches?

I could merge 6.6.beta3 instead?

Best
Jonas


---

Comment by git created at 2015-03-12 19:13:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jj created at 2015-03-12 19:20:17

Changing status from needs_work to needs_review.


---

Comment by Snark created at 2015-03-12 20:32:12

Yes, of course cleaning and rebuilding would have done the trick, but the point is that you want a review so it gets into sage... so the code should be at least a little synchronized with the current state of sage.

Concerning the question of whether to "git rebase 6.6.beta3" or "git merge 6.6.beta3", and what happens to other branches... I don't know exactly ; I think rebasing is better, but you might want to check if the sage developer manual has something about it (I think there's some kind of git crash-course within).


---

Comment by git created at 2015-03-12 22:49:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jj created at 2015-03-12 22:52:13

I rebased on 6.6.beta3.


---

Comment by git created at 2015-04-16 16:40:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jj created at 2015-04-16 16:41:29

Rebased on 6.7.beta1


---

Comment by chapoton created at 2015-09-13 18:58:45

I have just corrected the doc formatting in the readme file.
----
New commits:


---

Comment by git created at 2015-09-13 18:59:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jj created at 2015-09-14 14:24:23

Question: Can/should I rebase on develop?

I saw there was already a merge commit, so maybe not.
In any case this seems like a simple change, can we put this to reviewed?


---

Comment by chapoton created at 2015-09-14 14:27:45

I have done the merge with the latest develop in my commits. Sorry if this forces you to update your sage to the latest beta.

I *may* have time to do a review, but I am not an expert in the field.


---

Comment by jj created at 2015-09-14 14:53:57

Replying to [comment:20 chapoton]:
> I have done the merge with the latest develop in my commits. Sorry if this forces you to update your sage to the latest beta.
> 
> I *may* have time to do a review, but I am not an expert in the field.

It should be straight-forward, it's just that someone has to review it before it gets applied...

As a summary:

Before there were no relations (coercions) between spaces over different groups but actually for certain groups (namly infinity and 3) there is a (canonical) relation. For this case I modified it such that it coerces elements accordingly.


---

Comment by chapoton created at 2015-09-15 10:10:19

Comparison to None should use "group is None" 
instead of

```
if group == None
```

currently used in src/sage/modular/modform_hecketriangle/functors.py


---

Comment by jj created at 2015-09-15 19:31:49

Replying to [comment:22 chapoton]:
> Comparison to None should use "group is None" 
> instead of
> {{{
> if group == None
> }}}
> currently used in src/sage/modular/modform_hecketriangle/functors.py

Does it mean the rest is ok/reviewed?


---

Comment by chapoton created at 2015-09-15 20:02:03

No, I just have not yet looked at the rest..


---

Comment by jj created at 2015-09-22 15:56:49

Can you have a look at it? I am waiting for a review since a very very long time...


---

Comment by chapoton created at 2015-10-15 07:22:20

In this kind of thing (appearing at least twice in your code):

```
+                num1   = el_f.numerator().subs(   x=(y**2 + 3*x)/ZZ(4), y=(9*x*y - y**3)/ZZ(8), z=(3*z - y)/ZZ(2)).numerator()
+                num2   = el_f.denominator().subs( x=(y**2 + 3*x)/ZZ(4), y=(9*x*y - y**3)/ZZ(8), z=(3*z - y)/ZZ(2)).denominator()
+                denom1 = el_f.denominator().subs( x=(y**2 + 3*x)/ZZ(4), y=(9*x*y - y**3)/ZZ(8), z=(3*z - y)/ZZ(2)).numerator()
+                denom2 = el_f.numerator().subs(   x=(y**2 + 3*x)/ZZ(4), y=(9*x*y - y**3)/ZZ(8), z=(3*z - y)/ZZ(2)).denominator()
```

it is possible to substitute only twice. Please do so.

Could you also please remove the following imports (if possible):

```
src/sage/modular/modform_hecketriangle/abstract_ring.py:21: 'bernoulli' imported but unused
src/sage/modular/modform_hecketriangle/abstract_ring.py:21: 'sigma' imported but unused
src/sage/modular/modform_hecketriangle/abstract_ring.py:26: 'HeckeTriangleGroup' imported but unused
src/sage/modular/modform_hecketriangle/abstract_ring.py:27: 'rational_type' imported but unused
```


After that, and once the bot has given a green light again, I will agree to set a positive review.


---

Comment by chapoton created at 2015-10-15 14:26:22

Changing status from needs_review to needs_work.


---

Comment by jj created at 2015-10-15 17:48:49

Changing status from needs_work to needs_review.


---

Comment by jj created at 2015-10-15 17:48:49

Corrected. I rebased the branch on develop.
----
New commits:


---

Comment by jj created at 2015-10-15 21:41:18

The theta expansion is kind of an interesting side remark (maybe)...


---

Comment by chapoton created at 2015-10-16 07:38:26

Changing status from needs_review to positive_review.


---

Attachment

ok, bot is happy, positive review.


---

Comment by jj created at 2015-10-16 15:47:16

Thanks. :-)


---

Comment by vbraun created at 2015-10-16 18:42:46

Resolution: fixed
