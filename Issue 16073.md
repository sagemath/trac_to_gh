# Issue 16073: Snake graph perfect matching formula for cluster variables

Issue created by migration from https://trac.sagemath.org/ticket/16310

Original creator: egunawan

Original creation time: 2014-05-08 23:05:29

CC:  chapoton khlee @kelleye tscrim gmoose05

Keywords: cluster algebras from surfaces

Enhancement to the cluster_algebra_quiver package: User can define a cluster algebra seed by entering a triangulation T of a surface. User can then compute the T-expansion of an arc or loop gamma by entering the arcs of T  that gamma crosses. 

The algorithm used is the perfect matching formula from the following papers:
"Positivity for cluster algebras from surfaces" http://arxiv.org/abs/0906.0748 (section 4).
"Bases for cluster algebras from surfaces" http://arxiv.org/abs/1110.4364 (section 3).


---

Comment by chapoton created at 2014-06-03 14:18:48

Hello ! If this just a wish, or do you have code in preparation ?


---

Comment by egunawan created at 2014-06-03 15:57:10

Hi, the code is in preparation. -Emily


---

Comment by egunawan created at 2014-11-24 09:20:58

Warning: this version introduces a bug for http://www.sagemath.org/doc/reference/combinat/sage/combinat/cluster_algebra_quiver/cluster_seed.html class when user gives a list of edges as input. To be fixed in later versions.


---

Comment by chapoton created at 2014-11-24 11:03:46

Hello,

I just had a quick look. Some remarks:

* every line with `EXAMPLES::` (or ending with `::`) must be followed by an empty line

* try no to use comments (with #) in the doc. You can just make sentences.

* do not put space after the name of a function:
`def mything(myarg):`
and not
`def mything (myarg):`
----
New commits:


---

Comment by chapoton created at 2014-11-24 12:14:14

And citations of references such as MSW1 should be written `[MSW1]_`


---

Comment by chapoton created at 2014-11-24 20:27:07

you should not use `if something == True` and `if something != True`

but rather just `if something` and `if not something`


---

Comment by chapoton created at 2014-11-26 16:28:05

Same thing for `None`. One should use `if something is None` or `if not(something is None)` rather than `== None` and `!= None`

Also please avoid using `;` : rather separate the commands on several lines

And last but not least, every single function must be doctested:

```
sage -coverage src/sage/combinat/cluster_algebra_quiver/surface.py
------------------------------------------------------------------------
SCORE src/sage/combinat/cluster_algebra_quiver/surface.py: 6.7% (3 of 45)
```



---

Comment by git created at 2014-12-16 06:54:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2014-12-16 07:00:01

(Note: This commit only contains A FEW of the changes requested above)


---

Comment by git created at 2015-02-17 02:10:50

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by egunawan created at 2015-02-17 02:14:52

Changing status from new to needs_review.


---

Comment by egunawan created at 2015-02-17 02:14:52

When I run "./sage -docbuild reference/combinat html" I get errors and I have not been able to figure out how to fix them.

When pushing to trac, I did "git push --set-upstream trac HEAD:u/egunawan/ticket/16310". Was this the correct command?


---

Comment by chapoton created at 2015-02-17 08:54:17

Ok, I am currently cleaning the doc so that it will build.

The main point is that you did something like that (many times)

```
EXAMPLES::

    Here is my favorite example::

        sage: 1 + 1 == 3
```

where it should be instead

```
EXAMPLES:

Here is my favorite example::

    sage: 1 + 1 == 3
```


One other important point is that reference should be only given **once** in all the sage library. You should not duplicate the same reference in distinct files. Sage is able to find them in any place, so you can use citations from references in any other file.


---

Comment by chapoton created at 2015-02-17 10:07:36

Hello,

I have made a branch `public/ticket/16310` based on `u/egunawan/ticket/16310` on top of sage 6.5.rc3

If you were working with sage 6.4.1, you should before go to 6.5.rc3 or later. You can then pull this branch using `git pull public/ticket/16310`

Doc now builds. I have tried not to touch the code, but could not completely stop myself to do that. I should not have broken anything, but please check that it still works.
----
New commits:


---

Comment by chapoton created at 2015-02-17 15:50:59

There are two failing doctests:

```
File "src/sage/combinat/cluster_algebra_quiver/surface.py", line 1041, in sage.combinat.cluster_algebra_quiver.surface.GetMonomialTerm
Failed example:
    GetMonomialTerm(G,pm_a,boundary_edges=T._boundary_edges_vars)
Expected:
    x3^2*x4^2*x8^3
Got:
    x1^2*x2^2*x6^3
**********************************************************************
File "src/sage/combinat/cluster_algebra_quiver/surface.py", line 1052, in sage.combinat.cluster_algebra_quiver.surface.GetMonomialTerm
Failed example:
    GetMonomialTerm(G,pm_b,boundary_edges=T._boundary_edges_vars)
Expected:
    x3^2*x4*x5*x6*x7*x8*x9
Got:
    x1^2*x2*x3*x4*x5*x6*x7
```



---

Comment by egunawan created at 2015-02-18 20:52:11

Thank you for fixing my code!

Question 1:
The two failing doctests above happen in Version 6.5.rc2 but all tests (in cluster_algebra_quiver folder) pass in Version 6.5.rc3.

list.sort() method behaves differently in Version 6.5.rc2 and Version 6.5.rc3. Should I change my doctests so that my doctests do not depend on the behavior of list.sort()?

Sage Version 6.5.rc3 and Version 6.4:
sage: li = [1,2,3,'r','ell']
sage: li.sort()
sage: li
['ell', 'r', 1, 2, 3]

=============

Sage Version 6.5.rc2:
sage: li = [1,2,3,'r','ell']
sage: li.sort()
sage: li
[1, 2, 3, 'ell', 'r']


Question 2:
In the future, when I need to push new commits to the public branch "public/ticket/16310", do I type
"git push --set-upstream trac HEAD:public/ticket/16310" or do I need to do something different?

In several months, we would like to enhance this code so that user can work with a surface cluster algebra *with principal coefficients*. Do we create a new ticket and branch or continue with this ticket?


---

Comment by chapoton created at 2015-02-18 21:16:20

Replying to [comment:17 egunawan]:
> Thank you for fixing my code!

My pleasure.

> Question 1:
> The two failing doctests above happen in Version 6.5.rc2 but all tests (in cluster_algebra_quiver folder) pass in Version 6.5.rc3.
> 
> list.sort() method behaves differently in Version 6.5.rc2 and Version 6.5.rc3. Should I change my doctests so that my doctests do not depend on the behavior of list.sort()?
> 
> Sage Version 6.5.rc3 and Version 6.4:
> sage: li = [1,2,3,'r','ell']
> sage: li.sort()
> sage: li
> ['ell', 'r', 1, 2, 3]
> 
> =============
> 
> Sage Version 6.5.rc2:
> sage: li = [1,2,3,'r','ell']
> sage: li.sort()
> sage: li
> [1, 2, 3, 'ell', 'r']

Well, all tests must pass in the most recent version.

It seems very strange to use lists that mix integers and letters. Is this really what you use in the code ? Could you try to avoid that ? 

> Question 2:
> In the future, when I need to push new commits to the public branch "public/ticket/16310", do I type
> "git push --set-upstream trac HEAD:public/ticket/16310" or do I need to do something different?

The set-upstream is a convenience, not a necessity. You can just use

"git push trac HEAD:public/ticket/16310"

But in fact, it is not necessary that you work with the `public/ticket/16310` branch

Instead I think that you can do that:

1) git checkout "your local name for the branch u/egunawan/ticket/16310"
So you are "sitting on your branch"
2) git pull trac public/ticket/16310
So you have included "public/ticket/16310" in your branch
3) then you can just use "git push trac HEAD:u/egunawan/ticket/16310" as before to push into trac under that name
4) you can put back "u/egunawan/ticket/16310" in the branch field of trac

But I am not a git wizard, so be careful..

I suggest you click on the "commits" links at right of the Branch field (above here) to see what happens to the various branches : they coexist. Currently yours is behind public, but it can very well go back to leading position, if you do what I suggest.

> In several months, we would like to enhance this code so that user can work with a surface cluster algebra *with principal coefficients*. Do we create a new ticket and branch or continue with this ticket?

Well, it depends on your priorities. In my opinion, there is still some work to be done here before this can enter [SageMath](SageMath). Adding another layer of complexity can only make things take longer. So I would suggest to make another ticket, depending on this one.


---

Comment by chapoton created at 2015-02-27 09:35:18

There seem to be still a duplicate citation:

```
OSError: [combinat ] /home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/cluster_triangulation.py:
docstring of sage.combinat.cluster_algebra_quiver.cluster_triangulation:15:
WARNING: duplicate citation MSW_Positivity,
other instance in /home/patchbot/sage-patchbot/src/doc/en/reference/combinat/sage/combinat/cluster_algebra_quiver/cluster_seed.rst
```



---

Comment by git created at 2015-03-07 12:00:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-07 14:19:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Snark created at 2015-03-15 20:40:25

Uh... That ticket was set to needs_review four weeks ago, but there have been changes eight days ago to fix doc building... so is it ready or not ?

Also notice that Volker doesn't like needs_review tickets without "Authors:" :-P


---

Comment by egunawan created at 2015-03-15 21:26:26

Changing status from needs_review to needs_work.


---

Comment by egunawan created at 2015-03-15 21:39:48

Thanks for the comment. I changed the status to needs_work because we will do a mathematical review first before it's ready for review.

Whenever there is a new beta in the develop branch (for example, currently 6.6 beta 5) should I merge this ticket branch into the latest beta, and how? If someone pulls this ticket branch on top of the latest sage (6.6 beta 5), will it work OK?


---

Comment by Snark created at 2015-03-16 06:44:36

You should probably rebase before you ask for a review ; it's explained in the sage developer's guide.

That will show you if your code conflicts with what is now in sage, and allow you to fix the discrepancies.


---

Comment by egunawan created at 2015-03-17 17:50:34

Changing keywords from "cluster algebras from surfaces" to "days64, cluster algebras, triangulations".


---

Comment by git created at 2015-03-18 01:31:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2015-06-01 15:52:13

Last 10 new commits:


---

Comment by git created at 2015-06-02 04:34:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-02 04:50:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2015-06-02 04:54:08

Changing keywords from "days64, cluster algebras, triangulations" to "days64, days64.5, cluster algebras, triangulations".


---

Comment by git created at 2015-06-03 04:47:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-04 17:08:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-04 19:25:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-05 05:12:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2015-06-05 20:55:06

Documentation won't build for me. Can't easily see what the problem is from the error, though.


---

Comment by chapoton created at 2015-06-06 07:30:45

looks like some unicode problem (hidden space characters, long dashes, whatever..)


---

Comment by egunawan created at 2015-06-06 08:07:17

What happened was that I added this word in the documentation:

Salomón

After I replaced the "ó" with a plain "o", make doc was successful.


---

Comment by egunawan created at 2015-06-06 08:07:17

Changing keywords from "days64, days64.5, cluster algebras, triangulations" to "days64, days64.5, days65, cluster algebras, triangulations".


---

Comment by chapoton created at 2015-06-08 11:50:45

please commit the change and push the branch here


---

Comment by git created at 2015-06-08 17:16:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2015-06-08 17:20:54

Fyi, one of the reasons why I haven't set this to "need review" is that major changes to the cluster algebra package are coming (during Sage Days 64.5 last week) and I will need to adjust the ClusterTriangulation class to these changes.


---

Comment by git created at 2015-06-11 19:26:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-06-12 15:15:51

* Four (easy?) failing doctests (shifted numbering of variables), see patchbot report by clicking on the round icon at top right of this page.

* Do not use .show() but .plot()

  For example, instead of a method ending with
  {{{
  drawing.show ( axes=False, figsize=fig_size )
  }}}
  use instead as the last line
  {{{
  return drawing.plot(axes=False, figsize=fig_size)
  }}}


---

Comment by git created at 2015-06-13 03:46:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-13 21:54:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-08-04 20:54:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-09-13 08:49:54

Authors and Reviewers fields must me filled with full names.


---

Comment by git created at 2015-10-04 18:05:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2015-10-04 18:07:33

I am aware that this version (after merging with Sage 6.8) does not pass doctests, but I push it here so that Kyu-Hwan can use it right away.


---

Comment by mattmills created at 2016-07-27 22:03:41

Made minor edits to make most of the ClusterTriangulation package work in Sage 7.3. The mutation method doesn't work.


---

Comment by chapoton created at 2017-01-21 10:29:55

for python3 compatibility, do not use xrange (you can do "`from six.moves import range`" if you need an iterator)

and use the python3 syntax for print:

https://wiki.sagemath.org/Python3-compatible%20code
----
New commits:


---

Comment by @kelleye created at 2018-07-26 21:47:27

Changing keywords from "days64, days64.5, days65, cluster algebras, triangulations" to "days64, days64.5, days65, cluster algebras, triangulations, sagedays@icerm".


---

Comment by @kelleye created at 2018-07-26 21:47:27

Merge to 8.2
----
Last 10 new commits:


---

Comment by egunawan created at 2018-07-26 22:09:27

Correction for merging to 8.2
----
New commits:


---

Comment by git created at 2018-07-27 21:31:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-27 22:45:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-23 18:46:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egunawan created at 2019-07-24 19:33:59

New commits:


---

Comment by git created at 2019-07-25 21:49:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-26 17:08:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-07-29 21:24:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-08-25 08:16:10

Please use python3 syntax (for print in particular),
see https://wiki.sagemath.org/Python3-compatible%20code

More generally, developpement should now be done using sage running python3.


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
