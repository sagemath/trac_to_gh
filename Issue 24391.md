# Issue 24391: fix pcre build on Solaris 11

Issue created by migration from https://trac.sagemath.org/ticket/24628

Original creator: dimpase

Original creation time: 2018-02-01 01:41:56

CC:  mkoeppe dimpase charpent

it fails its self-tests, segfaulting (see #24596)


---

Comment by dimpase created at 2018-02-05 10:01:42

I believe PCRE is used in Polymake, and in Sage's polymake interface. I guess without JIT they (as well as R, as R is using it too) might get slower...


---

Comment by jdemeyer created at 2018-02-05 10:12:39

Replying to [comment:3 dimpase]:
> I believe PCRE is used in Polymake, and in Sage's polymake interface. I guess without JIT they (as well as R, as R is using it too) might get slower...

Slower but functional should be acceptable. Note that my patch still uses JIT on systems where it is supported.
----
New commits:


---

Comment by jdemeyer created at 2018-02-05 11:25:18

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-02-05 11:25:44


```
real    9m46.453s
user    7m32.365s
sys     2m2.237s
Copying package files from temporary location /datapool/jeroen/sage/local/var/tmp/sage/build/pcre-8.40.p1/inst to /datapool/jeroen/sage/local
Successfully installed pcre-8.40.p1
Deleting temporary build directory
/datapool/jeroen/sage/local/var/tmp/sage/build/pcre-8.40.p1
Finished installing pcre-8.40.p1.spkg
```



---

Comment by dimpase created at 2018-02-05 12:56:03

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2018-02-05 12:56:03

looks good to me


---

Comment by vbraun created at 2018-02-09 08:03:48

Resolution: fixed


---

Comment by embray created at 2018-02-16 15:00:39

Wish someone had CC'd me on this (I don't read every ticket that gets opened).  The test suite for PCRE has always failed on Cygwin (with or without JIT) so this broke the build on Cygwin.


---

Comment by dimpase created at 2018-02-16 15:07:32

IMHO on Cygwin, and, in fact on any system that provides PCRE,
we should just use the system's one.


---

Comment by embray created at 2018-02-16 15:44:58

Replying to [comment:11 dimpase]:
> IMHO on Cygwin, and, in fact on any system that provides PCRE,
> we should just use the system's one.

Agreed. Working on that :)


---

Comment by charpent created at 2018-02-16 15:51:42

Replying to [comment:12 embray]:
> Replying to [comment:11 dimpase]:
> > IMHO on Cygwin, and, in fact on any system that provides PCRE,
> > we should just use the system's one.
> 
> Agreed. Working on that :)

This is a **general** need : unless we have specific needs not solvable in an interface, we should use whatever is installed systemwide.

A mechanism to do that in the toplevel configuration file would be useful. IIRC, Erik has undertaken to refactor parts of this cofiguraion system (that's why I haven't yet progresed much on OpenSSL, BTW : I'm waiting for the dust to settle a bit...), this might be one of his objectives.

However, I can think of difficulties to extende such a mechanism to //library// interfaces...


---

Comment by embray created at 2018-02-16 16:06:44

I already have a prototype for this that I'm pretty happy with, but I've been waiting, as you say, for the dust to settle on #21524 before moving forward on it.  That ticket is ready for review BTW.
