# Issue 15965: implement the agm(x,y) function

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2014-04-22 07:17:54

CC:  mforets

https://en.wikipedia.org/wiki/Arithmetic-geometric_mean

Pari has a numeric implementation:

```
? 1/agm(1,sqrt(2))
%1 = 0.83462684167407318628142973279904680900
```

but Wikipedia provides a closed form integral expression, and if we had the "complete elliptic integral of the first kind" this would be even simpler.


---

Comment by kcrisman created at 2014-04-22 14:38:12

Do you mean [elliptic_kc](http://www.sagemath.org/doc/reference/functions/sage/functions/special.html?highlight=elliptic_kc#sage.functions.special.EllipticKC)?  This is indeed in Maxima, though not yet a "Sage symbolic function".  See also [the symbolics page on Trac](http://trac.sagemath.org/wiki/symbolics/functions) where a few things about this are mentioned.

Oh, I see what you mean about the elliptic - like [this Rosetta stone](https://github.com/acmeism/RosettaCodeData/blob/master/Task/Arithmetic-geometric-mean/Maxima/arithmetic-geometric-mean.maxima).  Anyway, I would think that we can do this fairly easily - also note mpmath has [the agm](http://sage.math.washington.edu/home/fredrik/mpmath/doc/0.18/functions/powers.html?highlight=agm#mpmath.agm) and [the elliptic integral in question](http://sage.math.washington.edu/home/fredrik/mpmath/doc/0.18/functions/elliptic.html?highlight=elliptic#ellipk), and mpmath is probably a go-to for numerical evaluation of our most recent implementations of special functions.


---

Comment by kcrisman created at 2014-04-22 14:39:03

Sorry, to clarify - if we implement `elliptic_kc` as a symbolic function, you could do this easily as you say, or we can try to combine this with mpmath as well.


---

Comment by chapoton created at 2018-06-27 20:10:46

There is already

```
sage: a=CDF(1)
sage: b=CDF(sqrt(2))
sage: 1/a.agm(b)
0.834626841674073
```



---

Comment by rws created at 2018-06-30 13:33:57

Also

```
            sage: RBF(sqrt(2)).agm(1)^(-1)
            [0.83462684167407 +/- 3.9...e-15]
```

