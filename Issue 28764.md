# Issue 28764: PKG_CHECK_VAR missing on pkgconfig < 0.28

Issue created by migration from https://trac.sagemath.org/ticket/29001

Original creator: embray

Original creation time: 2020-01-13 13:43:50

CC:  dimpase

#27870 (and one or two other tickets) introduced use of an autoconf macro `PKG_CHECK_VAR` which is included with pkg-config, but only since version 0.28.

Previously there was no problem with using a slightly older pkg-config; in my case:


```
$ pkg-config --version
0.26
```


I think this can be easily worked around by providing a definition of the macro in case it's missing.


---

Comment by embray created at 2020-01-13 13:49:57

Changing status from new to needs_review.


---

Comment by embray created at 2020-01-13 13:49:57

This works for me; should confirm that it doesn't interfere in cases where the macro _is_ already present.
----
New commits:


---

Comment by dimpase created at 2020-01-13 13:57:34

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-01-13 13:57:34

OK, this works with a modern pkg-config.


---

Comment by @mwageringel created at 2020-01-13 15:10:56

Thank you. I also have this problem on CentOS 7.7 with pkg-config 0.27.1, and for some reason the problem persisted even after installing pkg-config 0.29.2. With this branch, bootstrapping works now.

It still looks like a bug to me that `./bootstrap -d` can fail, though. As far as I understand, it should resort to the configure tarball, in this case.


---

Comment by vbraun created at 2020-01-20 21:17:38

Resolution: fixed
