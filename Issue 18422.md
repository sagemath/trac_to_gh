# Issue 18422: Python 3 preparation: Change more integer divisions from / to // (part 2)

Issue created by migration from https://trac.sagemath.org/ticket/18659

Original creator: wluebbe

Original creation time: 2015-06-10 08:52:24

CC:  aapitzsch tscrim jdemeyer

Keywords: python3

The attached patch is part of the enabling of Sage for Py2/3.
Py2 integer division `/` is changed to P2/3 floor division `//` (see #15995).
This ticket is similar to #16371 which already performed such changes.


---

Comment by chapoton created at 2016-04-24 09:44:36

New commits:


---

Comment by chapoton created at 2016-04-24 09:44:36

Changing status from new to needs_review.


---

Comment by git created at 2016-04-24 09:58:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-04-24 11:06:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-04-24 11:12:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2016-04-24 20:11:37

The line

```
them does euclidean division (in Python2) or float division (in Python3)::
```

does not correspond to the code which does `//`.


---

Comment by jdemeyer created at 2016-04-24 20:11:37

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-04-24 20:12:04

```2//3`` return ``0``.`: `return` should be `returns`


---

Comment by jdemeyer created at 2016-04-24 20:14:01

I feel that this ticket does too much at once. Most changes are non-trivial and require some work to review. It's too much for me anyway.


---

Comment by chapoton created at 2016-04-27 15:26:57

should I split it in smaller chunks ? it is already only a small step in all the changes that have to be made...


---

Comment by chapoton created at 2016-04-28 06:17:48

Changing component from misc to python3.


---

Comment by git created at 2016-04-28 06:45:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-04-28 06:45:48

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2016-04-28 14:15:38

I don't think your changes in `rigged_configurations/*` are correct as they should all be Sage integers and, in certain cases, allowed to be rationals. Although perhaps it ends up being okay as there are no doctest failures, but I need to check (which I am doing now).


---

Comment by tscrim created at 2016-04-28 14:18:59

Actually, it does seem to handle the division to rationals okay, but now it has values which are floats that should be integers.


---

Comment by tscrim created at 2016-04-28 14:18:59

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2016-04-28 14:37:05

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2016-04-28 14:37:05

Okay, this should take care of the issues in `rigged_configurations/*`.
----
New commits:


---

Comment by jdemeyer created at 2016-05-02 13:27:59

Replying to [comment:9 chapoton]:
> should I split it in smaller chunks ? it is already only a small step in all the changes that have to be made...

I cannot speak for others, but *for me* it would improve the chances that I will review it.


---

Comment by jdemeyer created at 2016-05-02 13:30:43

Splitting the ticket also means that we don't need an "all or nothing" approach. For example #15994 was rejected because of problems in one particular module. That is a pity, because the other changes are probably good.


---

Comment by chapoton created at 2016-05-02 13:56:07

I have split into 2 tickets, the other one being #20533 for the combinat folder
----
New commits:


---

Comment by chapoton created at 2016-05-03 10:07:48

I think only the changes in

*1 algebras/steenrod/steenrod_algebra_bases.py
*2 graphs/generic_graph.py
*3 modular/arithgroup/arithgroup_perm.py

really need to be checked seriously. All others are very simple.

For *1, there is a sentence that explain that all dimensions are divided by the given factor. Being dimensions, they surely must be integers.

For *2, the end result must be an integer (Wiener index), and we are simply dividing an even integer by 2.

For *3, it seems to be about cusp widths, that are in principle integers, as far as I understand.


---

Comment by tscrim created at 2016-05-12 19:02:27

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-05-12 19:02:27

As far as I can tell, these are correct.


---

Comment by chapoton created at 2016-05-12 19:05:45

Thanks a lot.


---

Comment by vbraun created at 2016-05-17 07:16:42

Resolution: fixed


---

Comment by chapoton created at 2016-05-22 11:24:55

This ticket has had seriously wrong consequences about the work done in #20533.


---

Comment by chapoton created at 2016-05-22 11:27:47

This ticket's changes are plain wrong ! 

EDIT: can we easily undo this, quickly, please ??


---

Comment by vbraun created at 2016-05-22 12:01:24

This is already in 7.3.beta0 so we can't undo it. You added 488db3dddfa94779c0ba612fd552239aec80ea5d that reverts some changes, so thats what you got.


---

Comment by chapoton created at 2016-05-22 12:12:55

Yes, I guess that's my fault. Jeroen asked me to split a ticket, so I did it (as I could) by reverting some changes, and putting them in another ticket. Then the other ticket went in sage first, and this one after. And just undid everything done in the other ticket.

I will have to re-do the division clean-up in combinat. I am not happy about that.


---

Comment by vbraun created at 2016-05-22 12:39:35

you can use `git revert`


---

Comment by embray created at 2018-02-23 13:32:37

Changing keywords from "python3" to "divison".
