# Issue 19436: Makefile for OSX app

archive/issues_019436.json:
```json
{
    "body": "CC:  fbissey\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19673\n\n",
    "created_at": "2015-12-06T23:21:27Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Makefile for OSX app",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19436",
    "user": "vbraun"
}
```
CC:  fbissey



Issue created by migration from https://trac.sagemath.org/ticket/19673





---

archive/issue_comments_267250.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build.",
    "created_at": "2015-12-06T23:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267250",
    "user": "vbraun"
}
```

Changing component from PLEASE CHANGE to build.



---

archive/issue_comments_267251.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-12-06T23:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267251",
    "user": "vbraun"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_267252.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-12-08T23:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267252",
    "user": "vbraun"
}
```

New commits:



---

archive/issue_comments_267253.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-12-08T23:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267253",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_267254.json:
```json
{
    "body": "Shouldn't the \"branch inside sage-bdist\" be changed to call this new `Makefile` instead?",
    "created_at": "2015-12-09T08:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267254",
    "user": "jdemeyer"
}
```

Shouldn't the "branch inside sage-bdist" be changed to call this new `Makefile` instead?



---

archive/issue_comments_267255.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-09T08:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267255",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_267256.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-09T08:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267256",
    "user": "vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_267257.json:
```json
{
    "body": "sage-bdist will be deleted when the transition to the new binary packging is done, so no need to beautify it. It still would be nice to use the new mac app Makefile during the transition.",
    "created_at": "2015-12-09T08:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267257",
    "user": "vbraun"
}
```

sage-bdist will be deleted when the transition to the new binary packging is done, so no need to beautify it. It still would be nice to use the new mac app Makefile during the transition.



---

archive/issue_comments_267258.json:
```json
{
    "body": "Still needs review...",
    "created_at": "2016-01-25T20:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267258",
    "user": "vbraun"
}
```

Still needs review...



---

archive/issue_comments_267259.json:
```json
{
    "body": "Replying to [comment:5 vbraun]:\n> sage-bdist will be deleted when the transition to the new binary packging is done\n\nLet me know when this happens.",
    "created_at": "2016-01-25T20:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267259",
    "user": "jdemeyer"
}
```

Replying to [comment:5 vbraun]:
> sage-bdist will be deleted when the transition to the new binary packging is done

Let me know when this happens.



---

archive/issue_comments_267260.json:
```json
{
    "body": "The new binary packaging is done, all OSX binaries use the Makefile that is introduced here.",
    "created_at": "2016-01-25T21:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267260",
    "user": "vbraun"
}
```

The new binary packaging is done, all OSX binaries use the Makefile that is introduced here.



---

archive/issue_comments_267261.json:
```json
{
    "body": "I made a few small improvements and fixed two bugs.  I also took the liberty of rebasing onto the latest develop.  The two bugs fixed were that rebuilding the app portion would cause Sage.app to be copied inside the already existant Sage-VERSION.app.  The other was that rsync would rerun every time even though there was nothing to be copied.\n\nAlso, the rsync command copies the .git folder.  This doesn't seem desirable to me, but perhaps it was intended, so I put it as the last commit.  Thus if you want to push all but that commit you can.\n----\nNew commits:",
    "created_at": "2016-02-28T04:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267261",
    "user": "iandrus"
}
```

I made a few small improvements and fixed two bugs.  I also took the liberty of rebasing onto the latest develop.  The two bugs fixed were that rebuilding the app portion would cause Sage.app to be copied inside the already existant Sage-VERSION.app.  The other was that rsync would rerun every time even though there was nothing to be copied.

Also, the rsync command copies the .git folder.  This doesn't seem desirable to me, but perhaps it was intended, so I put it as the last commit.  Thus if you want to push all but that commit you can.
----
New commits:



---

archive/issue_comments_267262.json:
```json
{
    "body": "I tried it out on Mac OS X 10.11.3 and it works like a charm.\n\nThe Makefile has (almost) not a single comment in it and at least I would find it helpful if it had comments about\n- what it is basically for: it is producing a dmg containing the Sage App, to be called directly with make and after sage itself has already been build with make at the root\n- the relocability of the resulting App (as far as I understand, the path where we compiled sage needs to be longer than the relocation target?)\n- whether the binaries compiled previously by calling make at the root are suitable for distribution to older processors which might not have all the capabilities of the host machine\n- maybe a line explaining the $(APP) target",
    "created_at": "2016-03-01T05:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267262",
    "user": "mgoerner"
}
```

I tried it out on Mac OS X 10.11.3 and it works like a charm.

The Makefile has (almost) not a single comment in it and at least I would find it helpful if it had comments about
- what it is basically for: it is producing a dmg containing the Sage App, to be called directly with make and after sage itself has already been build with make at the root
- the relocability of the resulting App (as far as I understand, the path where we compiled sage needs to be longer than the relocation target?)
- whether the binaries compiled previously by calling make at the root are suitable for distribution to older processors which might not have all the capabilities of the host machine
- maybe a line explaining the $(APP) target



---

archive/issue_comments_267263.json:
```json
{
    "body": "I mostly agree with this. It's a `Makefile` which is basically hidden in `src/mac-app` with no clear interface. And the relation between `sage-bdist` and this `Makefile` should be made more clear.",
    "created_at": "2016-03-01T20:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267263",
    "user": "jdemeyer"
}
```

I mostly agree with this. It's a `Makefile` which is basically hidden in `src/mac-app` with no clear interface. And the relation between `sage-bdist` and this `Makefile` should be made more clear.



---

archive/issue_comments_267264.json:
```json
{
    "body": "I've added the documentation. Ivan's changes are good.\n----\nNew commits:",
    "created_at": "2016-03-01T21:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267264",
    "user": "vbraun"
}
```

I've added the documentation. Ivan's changes are good.
----
New commits:



---

archive/issue_comments_267265.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-02T04:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267265",
    "user": "iandrus"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_267266.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-02T17:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267266",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_267267.json:
```json
{
    "body": "I guess we should remove the following line from https://github.com/sagemath/binary-pkg/blob/master/sage.yaml now:\n\n cp ../../sage-osx-makefile {path}/src/mac-app/Makefile",
    "created_at": "2016-03-09T20:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267267",
    "user": "mgoerner"
}
```

I guess we should remove the following line from https://github.com/sagemath/binary-pkg/blob/master/sage.yaml now:

 cp ../../sage-osx-makefile {path}/src/mac-app/Makefile



---

archive/issue_comments_267268.json:
```json
{
    "body": "> I guess we should remove the following line from https://github.com/sagemath/binary-pkg/blob/master/sage.yaml now:\n> \n>  cp ../../sage-osx-makefile {path}/src/mac-app/Makefile\n\n\nFor full reference ... that was done at [this commit](https://github.com/sagemath/binary-pkg/commit/4d827f34da028563e69b066bda5ffba91c937eaa).",
    "created_at": "2017-07-10T18:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19436",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19436#issuecomment-267268",
    "user": "kcrisman"
}
```

> I guess we should remove the following line from https://github.com/sagemath/binary-pkg/blob/master/sage.yaml now:
> 
>  cp ../../sage-osx-makefile {path}/src/mac-app/Makefile


For full reference ... that was done at [this commit](https://github.com/sagemath/binary-pkg/commit/4d827f34da028563e69b066bda5ffba91c937eaa).
