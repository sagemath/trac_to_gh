# Issue 10331: isPositiveSemiDefinite not accessible

Issue created by migration from https://trac.sagemath.org/ticket/10332

Original creator: monniaux

Original creation time: 2010-11-25 22:10:03

Assignee: cpernet

CC:  mjo @kliem @mwageringel dimpase rbeezer

Keywords: psd, semidefinite positive

I would like to test rational matrices for semidefinite positiveness. There is such a function in linbox, apparently (isPositiveSemiDefinite, from is-positive-semidefinite.h), but it is not accessible from Sage.


---

Comment by jdemeyer created at 2013-03-28 22:50:56

Changing component from linbox to linear algebra.


---

Comment by jdemeyer created at 2013-03-28 22:50:56

Changing assignee from cpernet to jason, was.


---

Comment by mjo created at 2020-09-26 02:27:44

I went down a rabbit hole with the cholesky inverse and wound up here. The inverse of a positive-definite matrix can actually be computed a tiiiiny bit faster through the `indefinite_factorization` method, which returns a naive (suitable only in exact arithmetic) LDLT factorization.

If we modify the `indefinite_factorization` to pivot (put the zeros at the bottom of `D`), we could also perform an LDLT factorization for positive-SEMIdefinite matrices, making the goal of this ticket attainable.

Note also that some people have asked for square roots of PSD matrices in #23424 and #25464. Right now that's only implemented for positive-definite matrices, due to the aforementioned limitation of the LDLT factorization, so we could potentially improve that too.


---

Comment by mjo created at 2020-09-29 15:26:34

I'm slowly working on a pivoted LDLT factorization at

  http://gitweb.michael.orlitzky.com/?p=sage.d.git;a=blob;f=mjo/ldlt.py

At some point I will have to carefully check (unless someone has a reference) how it can be used to determine positive-semidefiniteness, especially with complex matrices.


---

Comment by mjo created at 2020-10-07 21:21:00

This is nearing presentability.

My branch has a numerically stable block-LDLT factorization that works for indefinite matrices and in inexact arithmetic. The cited paper shows why we can use it to determine positive-semidefiniteness: each 2x2 diagonal block corresponds to one positive and one negative eigenvalue, and Sylvester's inertia theorem handles the rest.. I've added an `is_positive_semidefinite()` method for matrices based on that.

Compared to `is_positive_definite()`, the new method...

1. Doesn't distinguish between real/complex algorithms. We simply insist that the matrix be Hermitian (which is true of real symmetric matrices, of course), and always use `conjugate_transpose()`. This is not hugely expensive and cleans up the user interface a lot.
2. Doesn't do any checks on the input matrix. So long as the matrix is Hermitian, you should be okay -- but you're in charge of checking that. Running `if not A.is_hermitian()...` on your own is a lot simpler than asking the method to check it for you, and then waiting to catch an exception. And when you want it to be fast, there's no need to disable the checks; it's already fast.

This could conceivably also be used to speed up `solve_left` and `solve_right` for Hermitian matrices.


---

Comment by mjo created at 2021-01-26 13:18:42

Since I haven't changed anything in four months I guess this is ready for review.


---

Comment by mjo created at 2021-01-26 13:18:42

Changing status from new to needs_review.


---

Comment by git created at 2021-01-26 16:09:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mjo created at 2021-01-26 16:10:01

Rebased onto develop.


---

Comment by dimpase created at 2021-01-27 10:06:05

matrix2.pyx  is long overdue for splitting, it's 670K !!! (unless we aim for Guinness Book of Records, of course).


---

Comment by dimpase created at 2021-01-27 11:39:17

otherwise, OK.


---

Comment by dimpase created at 2021-01-27 11:39:17

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2021-01-27 13:29:15

Thanks!


---

Comment by vbraun created at 2021-02-20 10:46:42

Resolution: fixed
