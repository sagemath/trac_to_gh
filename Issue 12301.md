# Issue 12301: remove gcc builtin functions in ratpoints

Issue created by migration from https://trac.sagemath.org/ticket/12473

Original creator: ohanar

Original creation time: 2012-02-08 16:00:54

Assignee: GeorgSWeber

CC:  fbissey

these won't work for most other compilers


---

Comment by dimpase created at 2016-09-24 00:15:33

here is a fix : http://users.ox.ac.uk/~coml0531/sage/ratpoints-2.1.3.tar.bz2
(I moved the only nested function outside; it works with gcc, and passes the tests (in sage)). Wonder how it goes with clang...

Still needs a bit of cleaning.


---

Comment by fbissey created at 2016-09-24 02:13:39

Seems to works. I'll work on turning into a patch later.


---

Comment by dimpase created at 2016-09-25 17:32:07

Changing status from new to needs_review.


---

Comment by dimpase created at 2016-09-25 17:32:07

here is a cleaned up patch, with more const qualifiers added.
----
New commits:


---

Comment by fbissey created at 2016-09-29 21:40:02

Just touching `spkg-install` since `-fnested-functions` is not needed anywhere anymore.
----
New commits:


---

Comment by fbissey created at 2016-09-29 21:40:55

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2016-09-29 21:51:36

Thanks!


---

Comment by fbissey created at 2016-09-29 21:54:42

I meant to do that ;)


---

Comment by jdemeyer created at 2016-09-30 11:35:25

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2016-09-30 11:35:25

You should bump the package version number if you make non-trivial changes.


---

Comment by jdemeyer created at 2016-09-30 11:35:48

Changing component from build to packages: standard.


---

Comment by jdemeyer created at 2016-09-30 11:37:25

Actually, I have the feeling something is missing on this branch, since it _only_ changes `CCFLAGS` but nothing else.


---

Comment by dimpase created at 2016-09-30 16:15:19

Replying to [comment:15 jdemeyer]:
> Actually, I have the feeling something is missing on this branch, since it _only_ changes `CCFLAGS` but nothing else.

Francois, the ball is in your court now... (you didn't ask for a review too :))


---

Comment by fbissey created at 2016-09-30 19:00:04

Yes indeed, it looks like I messed up when importing Dima's branch.

As for the version bump. Yes I know we could do that. But really we didn't change any functionality, we just made it possible to compile with other compilers. But OK the patch is not trivial.


---

Comment by git created at 2016-10-01 02:43:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2016-10-01 02:45:05

Should all be better now.


---

Comment by fbissey created at 2016-10-01 02:45:05

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2016-10-01 15:08:50

OK, looks good.


---

Comment by dimpase created at 2016-10-01 15:08:50

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2016-10-01 17:52:23

Replying to [comment:17 fbissey]:
> As for the version bump. Yes I know we could do that. But really we didn't change any functionality, we just made it possible to compile with other compilers. But OK the patch is not trivial.

The reason I asked for this is mainly to increase testing coverage. If you bump the version, then everybody who upgrades Sage will rebuild the package with the new patch.


---

Comment by vbraun created at 2016-10-03 22:41:58

Resolution: fixed


---

Comment by jdemeyer created at 2018-01-12 14:48:10

Just commenting that the functionality that `ratpoints` provides should be replaced with PARI. It seems that PARI is slowly replacing all number-theoretical packages inside Sage. This already happened with `genus2red` and it should be possible for `lcalc` and `ratpoints` too.


---

Comment by dimpase created at 2018-01-12 22:20:45

replacing sounds a bit drastic; adding another backend?


---

Comment by fbissey created at 2018-01-13 02:40:32

Replying to [comment:25 dimpase]:
> replacing sounds a bit drastic; adding another backend?

Honestly, it doesn't. Reducing your number of dependencies because another one, better maintained, can provide the same functionality is not controversial in my opinion. Who doesn't like less maintenance.


---

Comment by dimpase created at 2018-01-13 10:47:29

ratpoints implements a very tricky mathematics, not something anybody can write. Having more than one implementation is a blessing.


---

Comment by jdemeyer created at 2018-01-14 09:32:22

I opened #24531 for that, by the way.


---

Comment by jdemeyer created at 2018-01-14 14:53:09

Replying to [comment:27 dimpase]:
> ratpoints implements a very tricky mathematics, not something anybody can write.

The PARI developers are not just "anybody" :-) I trust that they know number theory. Besides, the way that I understand things, the code in PARI is actually based on this `ratpoints` package. They didn't write it from scratch.


---

Comment by jdemeyer created at 2018-01-14 14:54:30

Replying to [comment:26 fbissey]:
> Replying to [comment:25 dimpase]:
> > replacing sounds a bit drastic; adding another backend?
> 
> Honestly, it doesn't. Reducing your number of dependencies because another one, better maintained

"better" maintained? I don't think that `ratpoints` is maintained _at all_ given that the latest release is from 2011.
