# Issue 11565: "integrate" fails to integrate a convergent integral (sin(x^2)/x^2).

Issue created by migration from https://trac.sagemath.org/ticket/11737

Original creator: lfousse

Original creation time: 2011-08-24 14:29:27

Assignee: burcin

sage: N(integrate(sin(x<sup>2)/(x</sup>2), x, 1, infinity))
[...]
ValueError: Integral is divergent.

This worked fine until v4.5.3, fails from v4.6.1 onward.
The expected output is:

0.2862504407259549


---

Comment by lfousse created at 2011-08-24 14:37:13

Changing type from PLEASE CHANGE to defect.


---

Comment by kcrisman created at 2011-08-24 17:29:33

This is in Maxima.  In the latest:

```

(%i1) integrate(sin(x^2)/(x^2),x,1,inf);

defint: integral is divergent.
```

It used to just return the integral.

```

(%i1) integrate(sin(x^2)/(x^2),x,1,inf);
                                 inf
                                /         2
                                [    sin(x )
(%o1)                           I    ------- dx
                                ]       2
                                /      x
                                 1
```


I think this integral should converge, right?  By the p-test (well, with absolute values) for p=2?  And `numerical_integral` agrees with your thing.  This is probably a bug in Maxima, I'll put it there.


---

Comment by kcrisman created at 2011-08-24 17:31:57

This is tracked at [this Maxima bug artifact](https://sourceforge.net/tracker/?func=detail&aid=3397562&group_id=4933&atid=104933).


---

Comment by lfousse created at 2011-08-24 17:41:39

The absolute value of the function is dominated by `1/x^2`, which is integrable on this particular interval.


---

Comment by kcrisman created at 2011-08-24 17:44:15

You say potato, I say potahto :)


---

Comment by zimmerma created at 2011-12-02 14:42:59

Karl-Dieter, please can you check the bug is fixed upstream? Laurent (Fousse) says it was caused by commit `59775311e53ef8a8fb5a3ad067a6c1cc153075d2` of maxima.

Paul


---

Comment by kcrisman created at 2011-12-02 15:57:52

As far as I can tell, it's not fixed upstream - I have 5.25.1.  The bug report had a resolution but it was something where they apparently typed in the wrong integral.  

I am ignorant of how to use git and I can't do a text search for that commit line, unfortunately, so I'll take Laurent's word for it.   I've put that info on the bug tracker as well.


---

Comment by zimmerma created at 2011-12-03 07:40:43

Laurent tested with both 5.24.0 and the last git maxima version (commit 01679c735de525a39fa1d893f9e1d9f86bd65f91) and he got:

```
    % ./maxima-local
    Maxima 5.25post/branch-5_25-base-231-g01679c7
    http://maxima.sourceforge.net
    using Lisp CLISP 2.49 (2010-07-07)
    Distributed under the GNU Public License. See the file COPYING.
    Dedicated to the memory of William Schelter.
    The function bug_report() provides bug reporting information.
    (%i1) integrate(sin(x^2)/(x^2),x,1,inf);
    defint: integral is divergent.
     -- an error. To debug this try: debugmode(true);
```

Please can you add this to the maxima bug tracker?

Paul


---

Comment by kcrisman created at 2011-12-03 15:28:10

> Please can you add this to the maxima bug tracker?
I think that you may have missed the fact that I already did so in comment:4 three months ago.   The person from Maxima who first looked at it must have tried something else incorrect, and I updated it yesterday with your information about the commit in question.


---

Comment by kcrisman created at 2012-05-15 02:05:12

This is now fixed upstream.

```
(%i1) display2d:false;
(%o1) false
(%i2) float(integrate(sin(x^2)/(x^2),x,1,inf));
(%o2) -.1767766952966368*(.2733129188747918*%i-.5348723621187719)*%i
 +.1767766952966368*(-.2733129188747918*%i-.5348723621187719)*%i
 -.1767766952966368*(.2733129188747918*%i-.5348723621187719)
 -.1767766952966368*(-.2733129188747918*%i-.5348723621187719)
(%i3) integrate(sin(x^2)/(x^2),x,1,inf);
(%o3) %i*gamma_incomplete(-1/2,%i)/2^(5/2)
 -gamma_incomplete(-1/2,%i)/2^(5/2)-%i*gamma_incomplete(-1/2,-%i)/2^(5/2)
 -gamma_incomplete(-1/2,-%i)/2^(5/2)
```



---

Comment by zimmerma created at 2012-05-15 08:33:53

Karl-Dieter, do you know in which release of Maxima this will be fixed?
Or is there a simple patch we can integrate in Sage?

Paul


---

Comment by kcrisman created at 2012-05-15 12:44:16

It's in the latest stable release, 5.27.0.  Probably it will be easiest to just upgrade.


---

Comment by dimpase created at 2012-12-29 10:44:45

Both new Maxima and [Wolfram Alpha](http://www.wolframalpha.com/input/?i=integrate%5Bsin%28x%5E2%29%2F%28x%5E2%29%2C+x%2C+1%2C+infinity%5D) give the value about 0.2857367, and not 0.28625044 (what you see in the ticket description). Changing the latter to reflect the reality.


---

Comment by kcrisman created at 2013-01-03 20:32:21

Changing status from new to needs_review.


---

Comment by kcrisman created at 2013-01-03 20:32:21

This is fixed (and doctested) at #13364.


---

Comment by kcrisman created at 2013-01-03 20:32:41

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-01-17 07:34:16

Resolution: fixed


---

Comment by rws created at 2014-08-09 15:24:21

Replying to [comment:14 dimpase]:
> Both new Maxima and [Wolfram Alpha](http://www.wolframalpha.com/input/?i=integrate%5Bsin%28x%5E2%29%2F%28x%5E2%29%2C+x%2C+1%2C+infinity%5D) give the value about 0.2857367, and not 0.28625044 (what you see in the ticket description). Changing the latter to reflect the reality.
The value was still off in the last digit given in the test. Fixed in #16697
