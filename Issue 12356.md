# Issue 12356: Little optimizations in CombinatorialFreeModule

Issue created by migration from https://trac.sagemath.org/ticket/12528

Original creator: nthiery

Original creation time: 2012-02-17 10:33:19

Assignee: jason, was

CC:  sage-combinat jhpalmieri

With the attached optimizations, the following typical calculation from Andrew Matthas goes twice faster (it involves a lot of arithmetic on module elements with very few terms)::


```
    sage: W = SymmetricGroup(4)
    sage: W.cartan_type = lambda: CartanType("A3")
    sage: R=FractionField(PolynomialRing(ZZ,'x')); x=R.gen()
    sage: H=IwahoriHeckeAlgebraT(W,x,base_ring = R)
    sage: L=[H.one()];                   # define Jucys-Murphy elements
    sage: for k in xrange(1,4): L.append(H._q1**-1*H.algebra_generators()[k]*L[k-1]*H.algebra_generators()[k])

    sage: content=[0,1,-1,0]   # content vector for Tableau([[1,2],[3,4]])

    sage: %time prod( (L[k]-x**c)/(x**content[k]-x**c) for k in xrange(len(content)) for c in xrange(-k,k+1) if c<>content[k])
    CPU times: user 2.26 s, sys: 0.00 s, total: 2.27 s
    Wall time: 2.27 s
```

Was 4.5s before the patch.

The patch also involve two changes in the Iwahori Hecke Algebra code to use better primitives of CombinatorialFreeModule.


---

Comment by nthiery created at 2012-02-17 10:46:47

Changing status from new to needs_review.


---

Comment by nthiery created at 2012-02-17 23:19:47

The new patch fixes a (trivial?) doctest failure in sage.algebra/steenrod_algebra/steenrod_algebra.py (John, please double check it!), and includes further review improvements from Florent.

All test pass. I let Florent put the final positive review once John will have given his green light.


---

Comment by hivert created at 2012-02-18 10:43:12

Replying to [comment:3 nthiery]:
> All test pass. I let Florent put the final positive review once John will have given his green light.

While we are waiting for John, can you add a proper commit message ? Jeroen will ask you to do so anyway...


---

Attachment


---

Comment by nthiery created at 2012-02-18 13:27:30

Replying to [comment:4 hivert]:
> While we are waiting for John, can you add a proper commit message ? Jeroen will ask you to do so anyway...

Shoot, I was sure I had done it. Well, now its done :-)


---

Comment by jhpalmieri created at 2012-02-18 16:00:57

The Steenrod algebra change looks fine to me.


---

Comment by hivert created at 2012-02-18 16:07:52

Replying to [comment:6 jhpalmieri]:
> The Steenrod algebra change looks fine to me.

Then it's good to go !


---

Comment by hivert created at 2012-02-18 16:07:52

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-02-27 11:23:09

Resolution: fixed
