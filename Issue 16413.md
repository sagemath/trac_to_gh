# Issue 16413: Integrate APNG into show and save methods

Issue created by migration from Trac.

Original creator: gagern

Original creation time: 2014-07-12 18:32:18

CC:  niles

Keywords: notebook, animate

Once #16571 and #7298 get merged, it is time to add support for animapted PNGs (APNG) to the `Animation.show()` and `Animation.save()` methods, and also to update the doctests to use `show(format="png")` for these.


---

Comment by gagern created at 2014-07-12 21:31:24

Changing status from new to needs_review.


---

Comment by gagern created at 2014-07-12 21:33:00

Only the last commit is really new. The merge before that did resolve a conflict, but in a pretty obvious way. Everything else is from the named dependencies.
----
Last 10 new commits:


---

Comment by git created at 2014-09-02 21:25:40

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-01-06 17:40:58

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by gagern created at 2015-03-12 00:57:29

The recent changes from #17234 prevent our dependency #7298 from being merged, and at the moment I'm far from sure how to rebase that code, see comment:48:ticket:7298. Once I get that rebased, there is one question regarding this ticket here as well:

Should we reuse the PNG format description, or introduce a new one?

On the one hand, APNG (as opposed to MNG) is very much about graceful degradation, so it makes sense to treat it as PNG in most places. On the other hand, perhaps the display manager can decide whether a client is actually capable of displaying APNG or not. If so, we might prefer supported APNG over GIF, but GIF over unsupported APNG interpreted as still PNG. If the display manager does not know about APNG support, but does know that PNG is supported, then the user should at least be able to choose APNG format manually, even though it might not be the auto-selected default in that case.


---

Comment by gagern created at 2015-03-12 00:57:29

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2015-03-12 10:49:33

Do not reuse `OutputImagePng`, that is for non-animated png.

Another basic output format should be a sequence of PNG, which can easily be displayed in a web browser with javascript (embed images as necessary). Perhaps the easiest animation format.


---

Comment by gagern created at 2015-03-12 11:07:32

Replying to [comment:9 vbraun]:
> Another basic output format should be a sequence of PNG, which can easily be displayed in a web browser with javascript (embed images as necessary). Perhaps the easiest animation format.

I'm not sure how much such a format would suffer from HTTP overhead, particularly for a large number of small frames. I guess it depends on the network connection (for the cloud in particular) whether that factor outweights the overhead of concatenating all PNGs to a single APNG file.

But if you are willing to use custom JavaScript code for animations, you could also use [existing code](http://www.devthought.com/projects/mootools/apng/) which provides APNG support on browsers which don't support it natively.


---

Comment by vbraun created at 2015-03-12 12:11:32

I'm thinking about base64-encoded inline images, especially since IPython doesn't allow you to return arbitrary collections of files. Though an apng polyfill would work, too.


---

Comment by gagern created at 2015-08-26 07:15:53

I intend not to work on this until #7298 gets reviewed and ready for merge.


---

Comment by git created at 2015-08-26 15:06:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-08-26 15:07:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by gagern created at 2015-08-26 15:10:07

Changing status from needs_work to needs_review.


---

Comment by gagern created at 2015-08-26 15:10:07

Since #7298 received a positive review just now, here is a rebased version of this modification here. With the new rich representations framework, there was a lot more to do than in the original commits. But it integrates APNG nicely with all the rest.


---

Comment by chapoton created at 2018-04-15 11:50:34

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-04-15 11:50:34

does not apply
