# Issue 26550: Use C++11 at least as default C++ standard

archive/issues_026550.json:
```json
{
    "body": "CC:  @embray\n\nWe should raise the default standard of C++ used to compile sage to C++11 minimum across all standard (and in time) optional packages.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26787\n\n",
    "created_at": "2018-11-29T01:51:13Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Use C++11 at least as default C++ standard",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26550",
    "user": "https://github.com/kiwifb"
}
```
CC:  @embray

We should raise the default standard of C++ used to compile sage to C++11 minimum across all standard (and in time) optional packages.

Issue created by migration from https://trac.sagemath.org/ticket/26787





---

archive/issue_comments_372816.json:
```json
{
    "body": "What do you mean? We already require a C++11 compiler.",
    "created_at": "2018-11-29T08:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372816",
    "user": "https://github.com/jdemeyer"
}
```

What do you mean? We already require a C++11 compiler.



---

archive/issue_comments_372817.json:
```json
{
    "body": "Replying to [comment:1 jdemeyer]:\n> What do you mean? We already require a C++11 compiler.\n\nYeah but we don't enforce compilation with at least that standard - at least not everywhere. See #25532.",
    "created_at": "2018-11-29T08:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372817",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:1 jdemeyer]:
> What do you mean? We already require a C++11 compiler.

Yeah but we don't enforce compilation with at least that standard - at least not everywhere. See #25532.



---

archive/issue_comments_372818.json:
```json
{
    "body": "Replying to [comment:2 fbissey]:\n> we don't enforce compilation with at least that standard\n\nWhy should Sage enforce C++11 for every package? I would leave that decision to each package individually.",
    "created_at": "2018-11-29T09:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372818",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:2 fbissey]:
> we don't enforce compilation with at least that standard

Why should Sage enforce C++11 for every package? I would leave that decision to each package individually.



---

archive/issue_comments_372819.json:
```json
{
    "body": "Individual packages can over-ride if needed, but as a base we should have a standard that allows ABI compatibility between dependencies. I am talking to have sensible default out of the box for packages, and gnu++98 is not that anymore.\n\nWe shouldn't have to play whack-a-mole on a packages dependency just because it uses and enforce c++11 and your compiler doesn't default to at least that. Alternatively you raise the bar on the compiler to get to that default. Hint: default C++ ABI for most recent distro release is c++14. All the problems in #25532 is because some older distro have a compiler that is recent enough to compile sage but doesn't default to at least c++11.",
    "created_at": "2018-11-29T09:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372819",
    "user": "https://github.com/kiwifb"
}
```

Individual packages can over-ride if needed, but as a base we should have a standard that allows ABI compatibility between dependencies. I am talking to have sensible default out of the box for packages, and gnu++98 is not that anymore.

We shouldn't have to play whack-a-mole on a packages dependency just because it uses and enforce c++11 and your compiler doesn't default to at least that. Alternatively you raise the bar on the compiler to get to that default. Hint: default C++ ABI for most recent distro release is c++14. All the problems in #25532 is because some older distro have a compiler that is recent enough to compile sage but doesn't default to at least c++11.



---

archive/issue_comments_372820.json:
```json
{
    "body": "OK, I see your point now...",
    "created_at": "2018-11-29T11:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372820",
    "user": "https://github.com/jdemeyer"
}
```

OK, I see your point now...



---

archive/issue_comments_372821.json:
```json
{
    "body": "Changing keywords from \"\" to \"C++11\".",
    "created_at": "2018-11-29T12:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372821",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "C++11".



---

archive/issue_comments_372822.json:
```json
{
    "body": "I have started by updating some macros and I have come to hate one particular commit\nhttp://git.savannah.gnu.org/gitweb/?p=autoconf-archive.git;a=commitdiff;h=bbb60ca79952c20ee0b187208533d98206b156d1;hp=ad15d52fd1e552bc3d7fcfb3d7bc6a2681f364d8\n\nIn short, even if you compiler doesn't need a flag to compile c++11 code by default, it will be added nonetheless. Potentially lowering the standard applied (which may or may not be a bad thing).",
    "created_at": "2018-12-05T20:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372822",
    "user": "https://github.com/kiwifb"
}
```

I have started by updating some macros and I have come to hate one particular commit
http://git.savannah.gnu.org/gitweb/?p=autoconf-archive.git;a=commitdiff;h=bbb60ca79952c20ee0b187208533d98206b156d1;hp=ad15d52fd1e552bc3d7fcfb3d7bc6a2681f364d8

In short, even if you compiler doesn't need a flag to compile c++11 code by default, it will be added nonetheless. Potentially lowering the standard applied (which may or may not be a bad thing).



---

archive/issue_comments_372823.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-05T20:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372823",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372824.json:
```json
{
    "body": "This should be enough.\n----\nNew commits:",
    "created_at": "2018-12-05T20:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372824",
    "user": "https://github.com/kiwifb"
}
```

This should be enough.
----
New commits:



---

archive/issue_comments_372825.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-05T20:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372825",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372826.json:
```json
{
    "body": "There is an associated clean up that should be done.",
    "created_at": "2018-12-05T20:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372826",
    "user": "https://github.com/kiwifb"
}
```

There is an associated clean up that should be done.



---

archive/issue_comments_372827.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-05T20:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372827",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_372828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-05T20:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372828",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372829.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-05T21:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372829",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372830.json:
```json
{
    "body": "A number of spkg added `-std=c++11` or `-std=gnu++11` in spkg-*. I removed most of these since by default gnu++11 will be selected. The only exception being `fplll` which enforce c++11 in configure but needs gnu++11 on cygwin. The addition was already redundant in brial since I made the latest version default to at least gnu++11 upstream.\n\nThere is also a makefile patch in frobby which I decided not to touch. I'd rather someone interested in the optional frobby package to update the patch next time it needs touching.\n\nIt will need testing on cygwin in particular.",
    "created_at": "2018-12-05T21:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372830",
    "user": "https://github.com/kiwifb"
}
```

A number of spkg added `-std=c++11` or `-std=gnu++11` in spkg-*. I removed most of these since by default gnu++11 will be selected. The only exception being `fplll` which enforce c++11 in configure but needs gnu++11 on cygwin. The addition was already redundant in brial since I made the latest version default to at least gnu++11 upstream.

There is also a makefile patch in frobby which I decided not to touch. I'd rather someone interested in the optional frobby package to update the patch next time it needs touching.

It will need testing on cygwin in particular.



---

archive/issue_comments_372831.json:
```json
{
    "body": "I'm a bit lost what this ticket does. I know that I already asked, but I still don't quite understand.",
    "created_at": "2019-01-06T17:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372831",
    "user": "https://github.com/jdemeyer"
}
```

I'm a bit lost what this ticket does. I know that I already asked, but I still don't quite understand.



---

archive/issue_comments_372832.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2019-01-06T17:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372832",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_372833.json:
```json
{
    "body": "I think you knew, but forgot - it's needed to stop package-wise bikeshedding on C++ versions, to make sure not accidentally incompatible C++ ABIs are created.",
    "created_at": "2019-01-11T14:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372833",
    "user": "https://github.com/dimpase"
}
```

I think you knew, but forgot - it's needed to stop package-wise bikeshedding on C++ versions, to make sure not accidentally incompatible C++ ABIs are created.



---

archive/issue_comments_372834.json:
```json
{
    "body": "So does the word \"default\" in the ticket title and description have any meaning? Maybe that's part what is confusing me.",
    "created_at": "2019-01-11T14:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372834",
    "user": "https://github.com/jdemeyer"
}
```

So does the word "default" in the ticket title and description have any meaning? Maybe that's part what is confusing me.



---

archive/issue_comments_372835.json:
```json
{
    "body": "Note that different versions of C++ compilers have differently set default values of the `std` parameter. And so it must be enforced in global `CXXFLAGS`. Does the changed title make more sense to you?",
    "created_at": "2019-01-11T14:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372835",
    "user": "https://github.com/dimpase"
}
```

Note that different versions of C++ compilers have differently set default values of the `std` parameter. And so it must be enforced in global `CXXFLAGS`. Does the changed title make more sense to you?



---

archive/issue_comments_372836.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-01-11T14:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372836",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_372837.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2019-01-11T15:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372837",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_372838.json:
```json
{
    "body": "I still don't see how the ticket title and Dima's explanation corresponds to the actual branch. The branch is *removing* C++11 stuff.",
    "created_at": "2019-01-11T15:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372838",
    "user": "https://github.com/jdemeyer"
}
```

I still don't see how the ticket title and Dima's explanation corresponds to the actual branch. The branch is *removing* C++11 stuff.



---

archive/issue_comments_372839.json:
```json
{
    "body": "No, it's removing per-package C++ flags and replacing them with the globally set stuff.",
    "created_at": "2019-01-11T15:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372839",
    "user": "https://github.com/dimpase"
}
```

No, it's removing per-package C++ flags and replacing them with the globally set stuff.



---

archive/issue_comments_372840.json:
```json
{
    "body": "I am sorry I am not more responsive across the board. I am on summer holydays after all :)\n\nI'll rebase and check things over once 8.6 is released - no way we'll get that in now.",
    "created_at": "2019-01-12T22:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372840",
    "user": "https://github.com/kiwifb"
}
```

I am sorry I am not more responsive across the board. I am on summer holydays after all :)

I'll rebase and check things over once 8.6 is released - no way we'll get that in now.



---

archive/issue_comments_372841.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372841",
    "user": "https://github.com/embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_372842.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-27T02:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372842",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372843.json:
```json
{
    "body": "Rebased.",
    "created_at": "2019-01-27T02:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372843",
    "user": "https://github.com/kiwifb"
}
```

Rebased.



---

archive/issue_comments_372844.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-01-27T02:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372844",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_372845.json:
```json
{
    "body": "In the context of this ticket, I'd like to recall the difference between \n`BLAH=foo ./configure ...` and `./configure BLAH=foo ...`. Could you remind me please?",
    "created_at": "2019-01-27T06:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372845",
    "user": "https://github.com/dimpase"
}
```

In the context of this ticket, I'd like to recall the difference between 
`BLAH=foo ./configure ...` and `./configure BLAH=foo ...`. Could you remind me please?



---

archive/issue_comments_372846.json:
```json
{
    "body": "Replying to [comment:27 dimpase]:\n> In the context of this ticket, I'd like to recall the difference between \n> `BLAH=foo ./configure ...` and `./configure BLAH=foo ...`. Could you remind me please?\n\nI must say I cannot think of a functional difference on top of my head, but that doesn't mean there isn't any. I usually prefer `./configure BLAH=foo ...` because then `BLAH=foo ...` is recorded in `config.log`. While in the other form it isn't. That can make debugging unpleasant when all you are given is `config.log`.",
    "created_at": "2019-01-27T09:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372846",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:27 dimpase]:
> In the context of this ticket, I'd like to recall the difference between 
> `BLAH=foo ./configure ...` and `./configure BLAH=foo ...`. Could you remind me please?

I must say I cannot think of a functional difference on top of my head, but that doesn't mean there isn't any. I usually prefer `./configure BLAH=foo ...` because then `BLAH=foo ...` is recorded in `config.log`. While in the other form it isn't. That can make debugging unpleasant when all you are given is `config.log`.



---

archive/issue_comments_372847.json:
```json
{
    "body": "Now I remember why you ask the question. You had a problem with a non autoconf configure script. Anyway there is one important difference.\n\n* in `BLAH=foo ./configure ` you set an environment to run configure.\n* in `./configure BLAH=foo ...` `BLAH=foo ...` becomes an argument to configure. Which is why is it is recorded.\n\nIn the case you had `BLAH=foo` was actually parsed as a configuration option by the script and because it was a configuration option, prepending it didn't work.",
    "created_at": "2019-01-27T10:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372847",
    "user": "https://github.com/kiwifb"
}
```

Now I remember why you ask the question. You had a problem with a non autoconf configure script. Anyway there is one important difference.

* in `BLAH=foo ./configure ` you set an environment to run configure.
* in `./configure BLAH=foo ...` `BLAH=foo ...` becomes an argument to configure. Which is why is it is recorded.

In the case you had `BLAH=foo` was actually parsed as a configuration option by the script and because it was a configuration option, prepending it didn't work.



---

archive/issue_comments_372848.json:
```json
{
    "body": "Replying to [comment:29 fbissey]:\n> Now I remember why you ask the question. You had a problem with a non autoconf configure script.\n\nYes, that was exactly the thing. (The case in hand was probably flint or mpir, I don't quite recall now).",
    "created_at": "2019-01-27T10:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372848",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:29 fbissey]:
> Now I remember why you ask the question. You had a problem with a non autoconf configure script.

Yes, that was exactly the thing. (The case in hand was probably flint or mpir, I don't quite recall now).



---

archive/issue_comments_372849.json:
```json
{
    "body": "Replying to [comment:29 fbissey]:\n> Now I remember why you ask the question. You had a problem with a non autoconf configure script. Anyway there is one important difference.\n> \n> * in `BLAH=foo ./configure ` you set an environment to run configure.\n> * in `./configure BLAH=foo ...` `BLAH=foo ...` becomes an argument to configure. Which is why is it is recorded.\n> \n> In the case you had `BLAH=foo` was actually parsed as a configuration option by the script and because it was a configuration option, prepending it didn't work.\n\nThere is also a question what actually happens to `BLAH=foo`  after the `./configure` run.\nFor some of variables such as `BLAH` the values provided \nare getting stored somewhere, e.g. for `FC` and `CC`.\nIs there a list of such stored variables anywhere? E.g. would `FFLAGS` value be stored somewhere?",
    "created_at": "2019-01-28T11:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372849",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:29 fbissey]:
> Now I remember why you ask the question. You had a problem with a non autoconf configure script. Anyway there is one important difference.
> 
> * in `BLAH=foo ./configure ` you set an environment to run configure.
> * in `./configure BLAH=foo ...` `BLAH=foo ...` becomes an argument to configure. Which is why is it is recorded.
> 
> In the case you had `BLAH=foo` was actually parsed as a configuration option by the script and because it was a configuration option, prepending it didn't work.

There is also a question what actually happens to `BLAH=foo`  after the `./configure` run.
For some of variables such as `BLAH` the values provided 
are getting stored somewhere, e.g. for `FC` and `CC`.
Is there a list of such stored variables anywhere? E.g. would `FFLAGS` value be stored somewhere?



---

archive/issue_comments_372850.json:
```json
{
    "body": "Some of the values from configuration, like compilers are saved in `sage-env-config`. The rest are not preserved in any way. For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example. There is another ticket somewhere about preserving most of `SAGE_*` and other variable set at configure time in `sage-env-config` but this is not this ticket.",
    "created_at": "2019-01-28T19:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372850",
    "user": "https://github.com/kiwifb"
}
```

Some of the values from configuration, like compilers are saved in `sage-env-config`. The rest are not preserved in any way. For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example. There is another ticket somewhere about preserving most of `SAGE_*` and other variable set at configure time in `sage-env-config` but this is not this ticket.



---

archive/issue_comments_372851.json:
```json
{
    "body": "Replying to [comment:32 fbissey]:\n> For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.\n\nI think that this is finally the explanation that I asked for.\n\nBut that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?",
    "created_at": "2019-01-29T13:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372851",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:32 fbissey]:
> For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.

I think that this is finally the explanation that I asked for.

But that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?



---

archive/issue_comments_372852.json:
```json
{
    "body": "Replying to [comment:33 jdemeyer]:\n> Replying to [comment:32 fbissey]:\n> > For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.\n> \n> I think that this is finally the explanation that I asked for.\n> \n> But that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?\n\nI think that this branch puts stuff in CXXFLAGS, not in CXX.",
    "created_at": "2019-01-29T13:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372852",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:33 jdemeyer]:
> Replying to [comment:32 fbissey]:
> > For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.
> 
> I think that this is finally the explanation that I asked for.
> 
> But that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?

I think that this branch puts stuff in CXXFLAGS, not in CXX.



---

archive/issue_comments_372853.json:
```json
{
    "body": "Replying to [comment:34 dimpase]:\n> Replying to [comment:33 jdemeyer]:\n> > Replying to [comment:32 fbissey]:\n> > > For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.\n> > \n> > I think that this is finally the explanation that I asked for.\n> > \n> > But that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?\n\nBy putting it in `CXX` you make your compiler c++11 compliant whether it is called with `CXXFLAGS` (as you should) or not.\n\n> \n> I think that this branch puts stuff in CXXFLAGS, not in CXX.\n\nThen the documentation at https://www.gnu.org/software/autoconf-archive/ax_cxx_compile_stdcxx.html would be wrong. And I don't believe that's the case.",
    "created_at": "2019-01-29T18:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372853",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:34 dimpase]:
> Replying to [comment:33 jdemeyer]:
> > Replying to [comment:32 fbissey]:
> > > For the C++11 flags (and C99 when it applies) this is saved as part of the definition of the compiler. That is `CXX=g++ -std=gnu++11` for example.
> > 
> > I think that this is finally the explanation that I asked for.
> > 
> > But that raises the question: why should these flags become part of `CXX` and not `CXXFLAGS`?

By putting it in `CXX` you make your compiler c++11 compliant whether it is called with `CXXFLAGS` (as you should) or not.

> 
> I think that this branch puts stuff in CXXFLAGS, not in CXX.

Then the documentation at https://www.gnu.org/software/autoconf-archive/ax_cxx_compile_stdcxx.html would be wrong. And I don't believe that's the case.



---

archive/issue_comments_372854.json:
```json
{
    "body": "You are right. Hopefully there are no packages in Sage that try to parse `$CXX` (IIRC, GAP used to parse `$CC`)...",
    "created_at": "2019-01-30T16:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372854",
    "user": "https://github.com/dimpase"
}
```

You are right. Hopefully there are no packages in Sage that try to parse `$CXX` (IIRC, GAP used to parse `$CC`)...



---

archive/issue_comments_372855.json:
```json
{
    "body": "Replying to [comment:36 dimpase]:\n> You are right. Hopefully there are no packages in Sage that try to parse `$CXX` (IIRC, GAP used to parse `$CC`)...\n\nHum, I can't do it right now (location and timing). Can you try install `boost` (and not `boost_cropped`) with it?",
    "created_at": "2019-01-30T18:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372855",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:36 dimpase]:
> You are right. Hopefully there are no packages in Sage that try to parse `$CXX` (IIRC, GAP used to parse `$CC`)...

Hum, I can't do it right now (location and timing). Can you try install `boost` (and not `boost_cropped`) with it?



---

archive/issue_comments_372856.json:
```json
{
    "body": "Well building boost was no problem. I do some parsing in there. The patch bot seems relatively happy. Any more questions?",
    "created_at": "2019-02-04T00:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372856",
    "user": "https://github.com/kiwifb"
}
```

Well building boost was no problem. I do some parsing in there. The patch bot seems relatively happy. Any more questions?



---

archive/issue_comments_372857.json:
```json
{
    "body": "Do I get it right that one might not see an explicit `-std=` in the logs, it depends upon the compiler being old enough for these to show up?",
    "created_at": "2019-02-04T01:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372857",
    "user": "https://github.com/dimpase"
}
```

Do I get it right that one might not see an explicit `-std=` in the logs, it depends upon the compiler being old enough for these to show up?



---

archive/issue_comments_372858.json:
```json
{
    "body": "It used to be the case, but I believe that with the macro I put in this ticket it should always be there. Which is annoying because my intent was ensuring a minimum standard but with the macro at hand it become the standard used not a minimum one. See http://git.savannah.gnu.org/gitweb/?p=autoconf-archive.git;a=commitdiff;h=bbb60ca79952c20ee0b187208533d98206b156d1;hp=ad15d52fd1e552bc3d7fcfb3d7bc6a2681f364d8",
    "created_at": "2019-02-04T01:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372858",
    "user": "https://github.com/kiwifb"
}
```

It used to be the case, but I believe that with the macro I put in this ticket it should always be there. Which is annoying because my intent was ensuring a minimum standard but with the macro at hand it become the standard used not a minimum one. See http://git.savannah.gnu.org/gitweb/?p=autoconf-archive.git;a=commitdiff;h=bbb60ca79952c20ee0b187208533d98206b156d1;hp=ad15d52fd1e552bc3d7fcfb3d7bc6a2681f364d8



---

archive/issue_comments_372859.json:
```json
{
    "body": "For info `sage-env-config` with gcc-8.2.0\n\n```\n# -*- shell-script -*-\n\n###########################################################################\n#\n#  Set some environment variables for Sage.\n#  This file is generated from sage-env-config.in by configure.\n#\n#  NOTES:\n#  - You must *source* this script instead of executing.\n#  - Use \"return\" instead of \"exit\" to signal a failure.  Since this\n#    file is sourced, an \"exit\" here will actually exit src/bin/sage,\n#    which is probably not intended.\n#  - All environment variables set here should be *exported*, otherwise\n#    they won't be available in child programs.\n#\n##########################################################################\n\n# SAGE_LOCAL is the installation prefix and can be customized by using\n# ./configure --prefix\nexport SAGE_LOCAL=\"/home/fbissey/sandbox/git-fork/sage/local\"\n\n#######################################\n# Compilers set at configuration time\n#######################################\nexport CONFIGURED_CC=\"gcc\"\nexport CONFIGURED_CXX=\"g++ -std=gnu++11\"\nexport CONFIGURED_FC=\"gfortran\"\nexport CONFIGURED_OBJC=\"gcc\"\nexport CONFIGURED_OBJCXX=\"g++\"\n\n#######################################\n# Other configuration\n#######################################\nexport SAGE_PYTHON_VERSION=2\nif [ \"$SAGE_PYTHON_VERSION\" = 3 ]; then\n    export SAGE_PYTHON3=yes\nfi\n```\n\nAs you can see even though my compiler default to gnu++14, `-std=gnu++11` is added.",
    "created_at": "2019-02-04T01:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372859",
    "user": "https://github.com/kiwifb"
}
```

For info `sage-env-config` with gcc-8.2.0

```
# -*- shell-script -*-

###########################################################################
#
#  Set some environment variables for Sage.
#  This file is generated from sage-env-config.in by configure.
#
#  NOTES:
#  - You must *source* this script instead of executing.
#  - Use "return" instead of "exit" to signal a failure.  Since this
#    file is sourced, an "exit" here will actually exit src/bin/sage,
#    which is probably not intended.
#  - All environment variables set here should be *exported*, otherwise
#    they won't be available in child programs.
#
##########################################################################

# SAGE_LOCAL is the installation prefix and can be customized by using
# ./configure --prefix
export SAGE_LOCAL="/home/fbissey/sandbox/git-fork/sage/local"

#######################################
# Compilers set at configuration time
#######################################
export CONFIGURED_CC="gcc"
export CONFIGURED_CXX="g++ -std=gnu++11"
export CONFIGURED_FC="gfortran"
export CONFIGURED_OBJC="gcc"
export CONFIGURED_OBJCXX="g++"

#######################################
# Other configuration
#######################################
export SAGE_PYTHON_VERSION=2
if [ "$SAGE_PYTHON_VERSION" = 3 ]; then
    export SAGE_PYTHON3=yes
fi
```

As you can see even though my compiler default to gnu++14, `-std=gnu++11` is added.



---

archive/issue_comments_372860.json:
```json
{
    "body": "looks good to me, also checked with clang 6.0.1 on FreeBSD.",
    "created_at": "2019-02-04T02:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372860",
    "user": "https://github.com/dimpase"
}
```

looks good to me, also checked with clang 6.0.1 on FreeBSD.



---

archive/issue_comments_372861.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-04T02:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372861",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_024669.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-02-05T16:57:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26550#event-24669"
}
```



---

archive/issue_comments_372862.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-05T16:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372862",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_372863.json:
```json
{
    "body": "This broke giac on some platforms: #27252",
    "created_at": "2019-02-10T17:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372863",
    "user": "https://github.com/vbraun"
}
```

This broke giac on some platforms: #27252



---

archive/issue_comments_372864.json:
```json
{
    "body": "I guess the question is, how would I *undo* this for  single package?  How can I revert `-std=gnu++11` at least when building giac?",
    "created_at": "2019-02-12T17:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372864",
    "user": "https://github.com/embray"
}
```

I guess the question is, how would I *undo* this for  single package?  How can I revert `-std=gnu++11` at least when building giac?



---

archive/issue_comments_372865.json:
```json
{
    "body": "This broke building of gfan and lcalc on systems with gcc 4.9.3: #27422",
    "created_at": "2019-03-04T16:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26550#issuecomment-372865",
    "user": "https://github.com/jdemeyer"
}
```

This broke building of gfan and lcalc on systems with gcc 4.9.3: #27422
