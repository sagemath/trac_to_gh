# Issue 23487: Allow random sampling for unit testing

archive/issues_023487.json:
```json
{
    "body": "CC:  @nthiery\n\n#16244 removed random sampling, but there are times when it would be nice to have.  This ticket adds it back in, but optionally.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23724\n\n",
    "created_at": "2017-08-26T04:10:20Z",
    "labels": [
        "doctest framework",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Allow random sampling for unit testing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23487",
    "user": "@roed314"
}
```
CC:  @nthiery

#16244 removed random sampling, but there are times when it would be nice to have.  This ticket adds it back in, but optionally.

Issue created by migration from https://trac.sagemath.org/ticket/23724





---

archive/issue_comments_329153.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-26T04:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329153",
    "user": "@roed314"
}
```

New commits:



---

archive/issue_comments_329154.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-26T04:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329154",
    "user": "@roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_329155.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-28T20:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329155",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_329156.json:
```json
{
    "body": "What about also changing `some_tuples` for consistency?",
    "created_at": "2017-08-29T03:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329156",
    "user": "@tscrim"
}
```

What about also changing `some_tuples` for consistency?



---

archive/issue_comments_329157.json:
```json
{
    "body": "Changing how?  Adding an optional keyword argument to use sampling instead?  Something like\n\n\n```\ndef some_tuples(elements, repeat, bound, sampling=False):\n    from itertools import islice, product\n    from random import sample\n    P = product(elements, repeat=repeat)\n    if sampling:\n        try:\n            return random.sample(P, bound)\n        except ValueError:\n            return P\n    else:\n        return islice(product(elements, repeat=repeat), bound)\n```\n",
    "created_at": "2017-08-29T04:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329157",
    "user": "@roed314"
}
```

Changing how?  Adding an optional keyword argument to use sampling instead?  Something like


```
def some_tuples(elements, repeat, bound, sampling=False):
    from itertools import islice, product
    from random import sample
    P = product(elements, repeat=repeat)
    if sampling:
        try:
            return random.sample(P, bound)
        except ValueError:
            return P
    else:
        return islice(product(elements, repeat=repeat), bound)
```




---

archive/issue_comments_329158.json:
```json
{
    "body": "I was thinking it would have the same idiom as the `TestSuite` with a `max_samples=None` argument, but basically, yes.",
    "created_at": "2017-08-29T05:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329158",
    "user": "@tscrim"
}
```

I was thinking it would have the same idiom as the `TestSuite` with a `max_samples=None` argument, but basically, yes.



---

archive/issue_comments_329159.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-05T05:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329159",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_329160.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-09-06T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329160",
    "user": "@saraedum"
}
```

New commits:



---

archive/issue_comments_329161.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-06T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329161",
    "user": "@saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_329162.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-09-06T17:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329162",
    "user": "@saraedum"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_329163.json:
```json
{
    "body": "I am confused about the patchbots errors. I first thought that was noise but it seems to be consistent for several patchbots.",
    "created_at": "2017-09-06T17:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329163",
    "user": "@saraedum"
}
```

I am confused about the patchbots errors. I first thought that was noise but it seems to be consistent for several patchbots.



---

archive/issue_comments_329164.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-06T17:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329164",
    "user": "@saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_329165.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-11T13:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23487#issuecomment-329165",
    "user": "@vbraun"
}
```

Resolution: fixed
