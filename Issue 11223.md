# Issue 11223: Upgrade Gfan to latest release (version 0.5)

archive/issues_011223.json:
```json
{
    "body": "Assignee: tbd\n\nKeywords: tropical geometry\n\nFrom the [Gfan page](http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html):\n\"Gfan version 0.5 (January 23th 2011, major update, Gr\u00f6bner bases/fans over the integers (experimental), p-adic Gr\u00f6bner bases/complexes (experimental), fan homology computations, exporting of fans in Polymake's new xml format, performance improvements (gfan is now faster than TOPCOM for secondary fan computations) and much more.) Updated January 25th 2011 (xml format and installation instructions). \"\n\nWe should upgrade to this release.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11395\n\n",
    "created_at": "2011-05-28T03:55:48Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.5",
    "title": "Upgrade Gfan to latest release (version 0.5)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11223",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```
Assignee: tbd

Keywords: tropical geometry

From the [Gfan page](http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html):
"Gfan version 0.5 (January 23th 2011, major update, Gröbner bases/fans over the integers (experimental), p-adic Gröbner bases/complexes (experimental), fan homology computations, exporting of fans in Polymake's new xml format, performance improvements (gfan is now faster than TOPCOM for secondary fan computations) and much more.) Updated January 25th 2011 (xml format and installation instructions). "

We should upgrade to this release.

Issue created by migration from https://trac.sagemath.org/ticket/11395





---

archive/issue_comments_123347.json:
```json
{
    "body": "On Gentoo we already did this, so here a little summary what to do:\n\n- in sage/interfaces/gfan.py, we have to change `cmd = 'gfan'` to `cmd = 'gfan_bases'` because the earlier is deprecated. If we do not do this, gfan prints:\n\n This is the Gfan program for computing Groebner fans and tropical varieties.\n Use the command \"gfan list\" to view all subcommands.\n The command \"gfan\" is deprecate for computing all Groebner bases of an ideal.\n Please use subcommand \"gfan _bases\" instead. Awaiting input. <Ctrl>-D to end.\n\n This confuses the current error detection code which assumes every output before commands as an error.\n\n- after adjusting the interface code, we have to review the failing doctests. On my box these are:\n  - sage -t  -force_lib devel/sage-main/doc/fr/tutorial/tour_advanced.rst\n  - sage -t  -force_lib devel/sage-main/doc/en/tutorial/tour_advanced.rst\n  - sage -t  -force_lib devel/sage-main/sage/rings/polynomial/groebner_fan.py\n\n I did not have a closer look at them, but they look like gfan-0.5 reorders its output.",
    "created_at": "2011-05-28T09:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123347",
    "user": "https://trac.sagemath.org/admin/accounts/users/cschwan"
}
```

On Gentoo we already did this, so here a little summary what to do:

- in sage/interfaces/gfan.py, we have to change `cmd = 'gfan'` to `cmd = 'gfan_bases'` because the earlier is deprecated. If we do not do this, gfan prints:

 This is the Gfan program for computing Groebner fans and tropical varieties.
 Use the command "gfan list" to view all subcommands.
 The command "gfan" is deprecate for computing all Groebner bases of an ideal.
 Please use subcommand "gfan _bases" instead. Awaiting input. <Ctrl>-D to end.

 This confuses the current error detection code which assumes every output before commands as an error.

- after adjusting the interface code, we have to review the failing doctests. On my box these are:
  - sage -t  -force_lib devel/sage-main/doc/fr/tutorial/tour_advanced.rst
  - sage -t  -force_lib devel/sage-main/doc/en/tutorial/tour_advanced.rst
  - sage -t  -force_lib devel/sage-main/sage/rings/polynomial/groebner_fan.py

 I did not have a closer look at them, but they look like gfan-0.5 reorders its output.



---

archive/issue_comments_123348.json:
```json
{
    "body": "A candidate package is at \n[http://sage.math.washington.edu/home/mhampton/gfan-0.5.spkg](http://sage.math.washington.edu/home/mhampton/gfan-0.5.spkg)\n\nI will take your suggestion on patching the interface.  I am aware of some other issues that need to be fixed; I was going to put those on another ticket but if 0.5 changes its output anyway I suppose it makes sense to put both the update and interface patches in one ticket.",
    "created_at": "2011-05-28T15:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123348",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

A candidate package is at 
[http://sage.math.washington.edu/home/mhampton/gfan-0.5.spkg](http://sage.math.washington.edu/home/mhampton/gfan-0.5.spkg)

I will take your suggestion on patching the interface.  I am aware of some other issues that need to be fixed; I was going to put those on another ticket but if 0.5 changes its output anyway I suppose it makes sense to put both the update and interface patches in one ticket.



---

archive/issue_comments_123349.json:
```json
{
    "body": "I had kind of started work on that. I am starting to hate when sage-on-gentoo is too much ahead and it breaks tests in non trivial ways. Most of the tests mentioned by Christopher are broken by trivial changes of formatting or ordering. But that one I think needs careful checking:\n\n```\n**********************************************************************                                                              \nFile \"/usr/share/sage/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 606:                                             \n    sage: g.weight_vectors()                                                                                                        \nExpected:                                                                                                                           \n    [(3, 7, 1), (5, 1, 2), (7, 1, 4), (1, 1, 4), (1, 1, 1), (1, 4, 1), (1, 4, 10)]                                                  \nGot:                                                                                                                                \n    [(3, 7, 1), (5, 1, 2), (7, 1, 4), (5, 1, 4), (1, 1, 1), (1, 4, 8), (1, 4, 10)]\n**********************************************************************\n```\n\nIt is not obvious that the two answers are equivalent, I was going to submit it to the opinion of sage-devel on Monday. \n\nOn another note, do you know what this section of the Makefile is all about\n\n```\nifeq ($(sagepath),)\nSAGE_LINKOPTIONS = \nSAGE_INCLUDEOPTIONS =\nelse\nSAGE_LINKOPTIONS = -L$(sagepath)/ -lpython2.6 -lcsage -lsingular\nSAGE_INCLUDEOPTIONS = -I $(sagepath)/\nSAGE_OBJECTS = sage.o sage_link.so\n\nsage_link.so: sage_link.pyx setup.py\n       python setup.py build_ext --inplace --pyrex-include-dirs=$(SAGE_ROOT)/devel/sage/\nendif\n```\n\nIt is not build by default and the cython source is missing (the resulting .cpp is present) but it looks like someone is looking at producing their own sage-extension.",
    "created_at": "2011-05-28T19:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123349",
    "user": "https://github.com/kiwifb"
}
```

I had kind of started work on that. I am starting to hate when sage-on-gentoo is too much ahead and it breaks tests in non trivial ways. Most of the tests mentioned by Christopher are broken by trivial changes of formatting or ordering. But that one I think needs careful checking:

```
**********************************************************************                                                              
File "/usr/share/sage/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 606:                                             
    sage: g.weight_vectors()                                                                                                        
Expected:                                                                                                                           
    [(3, 7, 1), (5, 1, 2), (7, 1, 4), (1, 1, 4), (1, 1, 1), (1, 4, 1), (1, 4, 10)]                                                  
Got:                                                                                                                                
    [(3, 7, 1), (5, 1, 2), (7, 1, 4), (5, 1, 4), (1, 1, 1), (1, 4, 8), (1, 4, 10)]
**********************************************************************
```

It is not obvious that the two answers are equivalent, I was going to submit it to the opinion of sage-devel on Monday. 

On another note, do you know what this section of the Makefile is all about

```
ifeq ($(sagepath),)
SAGE_LINKOPTIONS = 
SAGE_INCLUDEOPTIONS =
else
SAGE_LINKOPTIONS = -L$(sagepath)/ -lpython2.6 -lcsage -lsingular
SAGE_INCLUDEOPTIONS = -I $(sagepath)/
SAGE_OBJECTS = sage.o sage_link.so

sage_link.so: sage_link.pyx setup.py
       python setup.py build_ext --inplace --pyrex-include-dirs=$(SAGE_ROOT)/devel/sage/
endif
```

It is not build by default and the cython source is missing (the resulting .cpp is present) but it looks like someone is looking at producing their own sage-extension.



---

archive/issue_comments_123350.json:
```json
{
    "body": "I just had a quick look at your spkg. You didn't use \"hg rm\" to remove the files that are not needed anymore in patches. So hg status says this\n\n```\nfrancois@vrooom ~/Downloads/gfan-0.5 $ hg status\n! patches/gcc45_linalg.cpp.patch\n! patches/gcc45_matrix.h.patch\n! patches/linalg.cpp\n! patches/matrix.h\n! patches/polynomial.cpp\n! patches/polynomial.cpp.diff\n```\n",
    "created_at": "2011-05-28T19:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123350",
    "user": "https://github.com/kiwifb"
}
```

I just had a quick look at your spkg. You didn't use "hg rm" to remove the files that are not needed anymore in patches. So hg status says this

```
francois@vrooom ~/Downloads/gfan-0.5 $ hg status
! patches/gcc45_linalg.cpp.patch
! patches/gcc45_matrix.h.patch
! patches/linalg.cpp
! patches/matrix.h
! patches/polynomial.cpp
! patches/polynomial.cpp.diff
```




---

archive/issue_comments_123351.json:
```json
{
    "body": "OK, I removed the unneeded patches.  \n\nI don't think we want to change 'gfan' to 'gfan_bases' in the interface, that should be done in rings/polynomial/groebner_fan.py.  I'll try to do that this week, along with other interface updates.",
    "created_at": "2011-05-31T15:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123351",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

OK, I removed the unneeded patches.  

I don't think we want to change 'gfan' to 'gfan_bases' in the interface, that should be done in rings/polynomial/groebner_fan.py.  I'll try to do that this week, along with other interface updates.



---

archive/issue_comments_123352.json:
```json
{
    "body": "OK, looks better now. SPKG.txt could be more verbose about your changes (you dropped patches because they are not needed anymore and so on). However the spkg looks in good shape now. I'll give you a review (hopefully positive) once you post the patches.",
    "created_at": "2011-05-31T22:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123352",
    "user": "https://github.com/kiwifb"
}
```

OK, looks better now. SPKG.txt could be more verbose about your changes (you dropped patches because they are not needed anymore and so on). However the spkg looks in good shape now. I'll give you a review (hopefully positive) once you post the patches.



---

archive/issue_comments_123353.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-02-27T15:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123353",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_123354.json:
```json
{
    "body": "We need some patch to use gfan 5.0 without at least generating noise. Putting in needs_work.",
    "created_at": "2012-02-27T17:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123354",
    "user": "https://github.com/kiwifb"
}
```

We need some patch to use gfan 5.0 without at least generating noise. Putting in needs_work.



---

archive/issue_comments_123355.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-02-27T17:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123355",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_123356.json:
```json
{
    "body": "This probably needs to get rebased on #12760 (not yet merged, no positive review yet, but hopefully...)\n\n(#12760 fixes C++11 issues with upstream code in 0.4plus, and also cleans up Sage's part.)",
    "created_at": "2012-03-28T17:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123356",
    "user": "https://github.com/nexttime"
}
```

This probably needs to get rebased on #12760 (not yet merged, no positive review yet, but hopefully...)

(#12760 fixes C++11 issues with upstream code in 0.4plus, and also cleans up Sage's part.)



---

archive/issue_comments_123357.json:
```json
{
    "body": "Is the patch safe to use with earlier version of gcc? c++, any standard, is a always a major source of headaches too me.",
    "created_at": "2012-03-28T20:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123357",
    "user": "https://github.com/kiwifb"
}
```

Is the patch safe to use with earlier version of gcc? c++, any standard, is a always a major source of headaches too me.



---

archive/issue_comments_123358.json:
```json
{
    "body": "I hope to make some progress on this ticket for Sage-Combinat Days 40, July 9-13.\nSo far, I have a working spkg on my mac, but I need to figure out if the gcc-4.5.0 patches need to be rebased for portability.  I also want to add in some interface improvements (supporting symmetry for example).\n\nIn case anyone is interested in helping I will post my progress.\nWorking spkg: [http://sage.math.washington.edu/home/mhampton/gfan-0.5.p0.spkg](http://sage.math.washington.edu/home/mhampton/gfan-0.5.p0.spkg)\n\nCurrent patch: [http://sage.math.washington.edu/home/mhampton/trac_11395_update_gfan_to_0.5.patch](http://sage.math.washington.edu/home/mhampton/trac_11395_update_gfan_to_0.5.patch)",
    "created_at": "2012-07-07T19:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123358",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I hope to make some progress on this ticket for Sage-Combinat Days 40, July 9-13.
So far, I have a working spkg on my mac, but I need to figure out if the gcc-4.5.0 patches need to be rebased for portability.  I also want to add in some interface improvements (supporting symmetry for example).

In case anyone is interested in helping I will post my progress.
Working spkg: [http://sage.math.washington.edu/home/mhampton/gfan-0.5.p0.spkg](http://sage.math.washington.edu/home/mhampton/gfan-0.5.p0.spkg)

Current patch: [http://sage.math.washington.edu/home/mhampton/trac_11395_update_gfan_to_0.5.patch](http://sage.math.washington.edu/home/mhampton/trac_11395_update_gfan_to_0.5.patch)



---

archive/issue_comments_123359.json:
```json
{
    "body": "It is a pleasure to see some progress on this. I will have a look.",
    "created_at": "2012-07-08T21:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123359",
    "user": "https://github.com/kiwifb"
}
```

It is a pleasure to see some progress on this. I will have a look.



---

archive/issue_comments_123360.json:
```json
{
    "body": "Patch works great but there are more instances of tests of gfan in the documentation:\n\n```\nsage -t -long -force_lib \"devel/sage/doc/fr/tutorial/tour_advanced.rst\"\n**********************************************************************\nFile \"/usr/share/sage/devel/sage/doc/fr/tutorial/tour_advanced.rst\", line 68:\n    sage: F.reduced_groebner_bases ()\nExpected:\n    [[-c^2 + b*d, -b*c + a*d, -b^2 + a*c],\n     [c^2 - b*d, -b*c + a*d, -b^2 + a*c],\n     [c^2 - b*d, b*c - a*d, -b^2 + a*c, -b^3 + a^2*d],\n     [c^2 - b*d, b*c - a*d, b^3 - a^2*d, -b^2 + a*c],\n     [c^2 - b*d, b*c - a*d, b^2 - a*c],\n     [-c^2 + b*d, b^2 - a*c, -b*c + a*d],\n     [-c^2 + b*d, b*c - a*d, b^2 - a*c, -c^3 + a*d^2],\n     [c^3 - a*d^2, -c^2 + b*d, b*c - a*d, b^2 - a*c]]\nGot:\n    [[-c^2 + b*d, -b*c + a*d, -b^2 + a*c], [-c^2 + b*d, b^2 - a*c, -b*c + a*d], [-c^2 + b*d, b*c - a*d, b^2 - a*c, -c^3 + a*d^2], [c^3 - a*d^2, -c^2 + b*d, b*c - a*d, b^2 - a*c], [c^2 - b*d, -b*c + a*d, -b^2 + a*c], [c^2 - b*d, b*c - a*d, -b^2 + a*c, -b^3 + a^2*d], [c^2 - b*d, b*c - a*d, b^3 - a^2*d, -b^2 + a*c], [c^2 - b*d, b*c - a*d, b^2 - a*c]]\n\n```\n\nThat's the French one but we have the same in English, Russian and German (de) version.",
    "created_at": "2012-07-09T01:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123360",
    "user": "https://github.com/kiwifb"
}
```

Patch works great but there are more instances of tests of gfan in the documentation:

```
sage -t -long -force_lib "devel/sage/doc/fr/tutorial/tour_advanced.rst"
**********************************************************************
File "/usr/share/sage/devel/sage/doc/fr/tutorial/tour_advanced.rst", line 68:
    sage: F.reduced_groebner_bases ()
Expected:
    [[-c^2 + b*d, -b*c + a*d, -b^2 + a*c],
     [c^2 - b*d, -b*c + a*d, -b^2 + a*c],
     [c^2 - b*d, b*c - a*d, -b^2 + a*c, -b^3 + a^2*d],
     [c^2 - b*d, b*c - a*d, b^3 - a^2*d, -b^2 + a*c],
     [c^2 - b*d, b*c - a*d, b^2 - a*c],
     [-c^2 + b*d, b^2 - a*c, -b*c + a*d],
     [-c^2 + b*d, b*c - a*d, b^2 - a*c, -c^3 + a*d^2],
     [c^3 - a*d^2, -c^2 + b*d, b*c - a*d, b^2 - a*c]]
Got:
    [[-c^2 + b*d, -b*c + a*d, -b^2 + a*c], [-c^2 + b*d, b^2 - a*c, -b*c + a*d], [-c^2 + b*d, b*c - a*d, b^2 - a*c, -c^3 + a*d^2], [c^3 - a*d^2, -c^2 + b*d, b*c - a*d, b^2 - a*c], [c^2 - b*d, -b*c + a*d, -b^2 + a*c], [c^2 - b*d, b*c - a*d, -b^2 + a*c, -b^3 + a^2*d], [c^2 - b*d, b*c - a*d, b^3 - a^2*d, -b^2 + a*c], [c^2 - b*d, b*c - a*d, b^2 - a*c]]

```

That's the French one but we have the same in English, Russian and German (de) version.



---

archive/issue_comments_123361.json:
```json
{
    "body": "Attachment [trac11395-fix_tutorial.patch](tarball://root/attachments/some-uuid/ticket11395/trac11395-fix_tutorial.patch) by @kiwifb created at 2012-07-09 02:59:13\n\nFix tutorial with gfan 0.5",
    "created_at": "2012-07-09T02:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123361",
    "user": "https://github.com/kiwifb"
}
```

Attachment [trac11395-fix_tutorial.patch](tarball://root/attachments/some-uuid/ticket11395/trac11395-fix_tutorial.patch) by @kiwifb created at 2012-07-09 02:59:13

Fix tutorial with gfan 0.5



---

archive/issue_comments_123362.json:
```json
{
    "body": "Attaching a patch for the tutorial. Do you want me to clean up your spkg a little bit? We should only keep the patch for gcc 4.7 and really switch to patch. Of course SPKG.txt needs updating and cleaning after your work. There doesn't seem to be any tests so spkg-check. I can do some of that clean up if you want.",
    "created_at": "2012-07-09T03:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123362",
    "user": "https://github.com/kiwifb"
}
```

Attaching a patch for the tutorial. Do you want me to clean up your spkg a little bit? We should only keep the patch for gcc 4.7 and really switch to patch. Of course SPKG.txt needs updating and cleaning after your work. There doesn't seem to be any tests so spkg-check. I can do some of that clean up if you want.



---

archive/issue_comments_123363.json:
```json
{
    "body": "If you can do some of that soon (next two or three days), then go for it, that would be great. In the meantime I will focus on adding support for symmetry and maybe some other new things in gfan-0.5 like computing over ZZ.",
    "created_at": "2012-07-09T13:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123363",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

If you can do some of that soon (next two or three days), then go for it, that would be great. In the meantime I will focus on adding support for symmetry and maybe some other new things in gfan-0.5 like computing over ZZ.



---

archive/issue_comments_123364.json:
```json
{
    "body": "OK I am doing this now. A bit more work than I had expected but doable.",
    "created_at": "2012-07-10T23:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123364",
    "user": "https://github.com/kiwifb"
}
```

OK I am doing this now. A bit more work than I had expected but doable.



---

archive/issue_comments_123365.json:
```json
{
    "body": "The file app_minkowski.cpp had changes in it that are not in the patch file you shipped. I cannot see the equivalent modification in Gentoo for gcc-4.7.0 so I am skipping it.",
    "created_at": "2012-07-11T00:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123365",
    "user": "https://github.com/kiwifb"
}
```

The file app_minkowski.cpp had changes in it that are not in the patch file you shipped. I cannot see the equivalent modification in Gentoo for gcc-4.7.0 so I am skipping it.



---

archive/issue_comments_123366.json:
```json
{
    "body": "OK put a new spkg up. I have gone through the whole TODO list so the changes have been a bit invasive. I made a new Makefile that uses CXXFLAGS, LDFLAGS and CPPFLAGS - it could possibly use a little bit more love before sending upstream. Scrap that it would need a fair rewrite to get rid of a lot of stuff. Patch is now used throughout. Removal of the old gfan install is now done after the build and done correctly - which it wasn't before because of a misplaced double-quote.\n\nI think that sums it up. Over to you Marshall to see if you like the whole thing.",
    "created_at": "2012-07-11T01:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123366",
    "user": "https://github.com/kiwifb"
}
```

OK put a new spkg up. I have gone through the whole TODO list so the changes have been a bit invasive. I made a new Makefile that uses CXXFLAGS, LDFLAGS and CPPFLAGS - it could possibly use a little bit more love before sending upstream. Scrap that it would need a fair rewrite to get rid of a lot of stuff. Patch is now used throughout. Removal of the old gfan install is now done after the build and done correctly - which it wasn't before because of a misplaced double-quote.

I think that sums it up. Over to you Marshall to see if you like the whole thing.



---

archive/issue_comments_123367.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-11T01:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123367",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_123368.json:
```json
{
    "body": "I credited you (Fran\u00e7ois Bissey) in the SPKG.txt, and I have uploaded a patch for the interface that I think greatly improves the functionality as well as supporting the new version.  I am tempted to do more refactoring so I will not flag this for review quite yet.",
    "created_at": "2012-07-12T22:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123368",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I credited you (François Bissey) in the SPKG.txt, and I have uploaded a patch for the interface that I think greatly improves the functionality as well as supporting the new version.  I am tempted to do more refactoring so I will not flag this for review quite yet.



---

archive/issue_comments_123369.json:
```json
{
    "body": "I should mention that I am not really qualified to review the changes made to the spkg-install, but I will test this on a few more linux and OS X systems at least.",
    "created_at": "2012-07-12T22:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123369",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I should mention that I am not really qualified to review the changes made to the spkg-install, but I will test this on a few more linux and OS X systems at least.



---

archive/issue_comments_123370.json:
```json
{
    "body": "Actually I may make one more change. I defined PREFIX on the line calling make but the variable is never used. It would be if we were using the makefile to perform the installation but we don't. I tested the spkg on linux on power7. And as a final note I should add that gfan itself doesn't come with either tests or documentation. A curiosity is that gfan seem to be mostly c++ but link against libgmp rather than libgmpxx.",
    "created_at": "2012-07-12T22:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123370",
    "user": "https://github.com/kiwifb"
}
```

Actually I may make one more change. I defined PREFIX on the line calling make but the variable is never used. It would be if we were using the makefile to perform the installation but we don't. I tested the spkg on linux on power7. And as a final note I should add that gfan itself doesn't come with either tests or documentation. A curiosity is that gfan seem to be mostly c++ but link against libgmp rather than libgmpxx.



---

archive/issue_comments_123371.json:
```json
{
    "body": "OK I updated the spkg. In the end I kept the gcc-4.7 patch for app_minkowsky.cpp as before to minimize the burden of review. \n\nAs mentioned I removed the setting of PREFIX and made a comment about it.",
    "created_at": "2012-07-23T00:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123371",
    "user": "https://github.com/kiwifb"
}
```

OK I updated the spkg. In the end I kept the gcc-4.7 patch for app_minkowsky.cpp as before to minimize the burden of review. 

As mentioned I removed the setting of PREFIX and made a comment about it.



---

archive/issue_comments_123372.json:
```json
{
    "body": "I get a doctest error on sage-5.4.beta1 due to #12544\n\n```\nsage -t  devel/sage-main/sage/rings/polynomial/groebner_fan.py\n**********************************************************************\nFile \"/home/vbraun/opt/sage-5.4.beta1/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 504:\n    sage: [q.facet_normals() for q in fan]\nExpected:\n    [(M(0, -1, 0), M(-1, 0, 0)), (M(0, 0, -1), M(-1, 0, 0)), (M(0, 0, 1), M(-1, 0, 0)), (M(0, 1, 0), M(-1, 0, 0)), (M(0, 0, -1), M(0, -1, 0)), (M(0, 0, 1), M(0, -1, 0)), (M(0, 1, 0), M(0, 0, -1)), (M(0, 1, 0), M(0, 0, 1)), (M(1, 0, 0), M(0, -1, 0)), (M(1, 0, 0), M(0, 0, -1)), (M(1, 0, 0), M(0, 0, 1)), (M(1, 0, 0), M(0, 1, 0))]\nGot:\n    [M( 0, -1, 0),\n    M(-1,  0, 0)\n    in 3-d lattice M, M( 0, 0, -1),\n    M(-1, 0,  0)\n    in 3-d lattice M, M( 0, 0, 1),\n    M(-1, 0, 0)\n    in 3-d lattice M, M( 0, 1, 0),\n    M(-1, 0, 0)\n    in 3-d lattice M, M(0,  0, -1),\n    M(0, -1,  0)\n    in 3-d lattice M, M(0,  0, 1),\n    M(0, -1, 0)\n    in 3-d lattice M, M(0, 1,  0),\n    M(0, 0, -1)\n    in 3-d lattice M, M(0, 1, 0),\n    M(0, 0, 1)\n    in 3-d lattice M, M(1,  0, 0),\n    M(0, -1, 0)\n    in 3-d lattice M, M(1, 0,  0),\n    M(0, 0, -1)\n    in 3-d lattice M, M(1, 0, 0),\n    M(0, 0, 1)\n    in 3-d lattice M, M(1, 0, 0),\n    M(0, 1, 0)\n    in 3-d lattice M]\n```\n",
    "created_at": "2012-09-17T09:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123372",
    "user": "https://github.com/vbraun"
}
```

I get a doctest error on sage-5.4.beta1 due to #12544

```
sage -t  devel/sage-main/sage/rings/polynomial/groebner_fan.py
**********************************************************************
File "/home/vbraun/opt/sage-5.4.beta1/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 504:
    sage: [q.facet_normals() for q in fan]
Expected:
    [(M(0, -1, 0), M(-1, 0, 0)), (M(0, 0, -1), M(-1, 0, 0)), (M(0, 0, 1), M(-1, 0, 0)), (M(0, 1, 0), M(-1, 0, 0)), (M(0, 0, -1), M(0, -1, 0)), (M(0, 0, 1), M(0, -1, 0)), (M(0, 1, 0), M(0, 0, -1)), (M(0, 1, 0), M(0, 0, 1)), (M(1, 0, 0), M(0, -1, 0)), (M(1, 0, 0), M(0, 0, -1)), (M(1, 0, 0), M(0, 0, 1)), (M(1, 0, 0), M(0, 1, 0))]
Got:
    [M( 0, -1, 0),
    M(-1,  0, 0)
    in 3-d lattice M, M( 0, 0, -1),
    M(-1, 0,  0)
    in 3-d lattice M, M( 0, 0, 1),
    M(-1, 0, 0)
    in 3-d lattice M, M( 0, 1, 0),
    M(-1, 0, 0)
    in 3-d lattice M, M(0,  0, -1),
    M(0, -1,  0)
    in 3-d lattice M, M(0,  0, 1),
    M(0, -1, 0)
    in 3-d lattice M, M(0, 1,  0),
    M(0, 0, -1)
    in 3-d lattice M, M(0, 1, 0),
    M(0, 0, 1)
    in 3-d lattice M, M(1,  0, 0),
    M(0, -1, 0)
    in 3-d lattice M, M(1, 0,  0),
    M(0, 0, -1)
    in 3-d lattice M, M(1, 0, 0),
    M(0, 0, 1)
    in 3-d lattice M, M(1, 0, 0),
    M(0, 1, 0)
    in 3-d lattice M]
```




---

archive/issue_comments_123373.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-10-05T15:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123373",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_123374.json:
```json
{
    "body": "needs_work because of Volker's failure.",
    "created_at": "2012-10-05T15:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123374",
    "user": "https://github.com/jdemeyer"
}
```

needs_work because of Volker's failure.



---

archive/issue_comments_123375.json:
```json
{
    "body": "Attachment [trac_11395_doctest_fix.patch](tarball://root/attachments/some-uuid/ticket11395/trac_11395_doctest_fix.patch) by @vbraun created at 2012-10-23 18:21:47\n\nInitial patch",
    "created_at": "2012-10-23T18:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123375",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_11395_doctest_fix.patch](tarball://root/attachments/some-uuid/ticket11395/trac_11395_doctest_fix.patch) by @vbraun created at 2012-10-23 18:21:47

Initial patch



---

archive/issue_comments_123376.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-10-23T18:24:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123376",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_029582.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-23T18:24:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11223#event-29582"
}
```



---

archive/issue_comments_123377.json:
```json
{
    "body": "Added a trivial fix, setting it back to positive review.",
    "created_at": "2012-10-23T18:24:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123377",
    "user": "https://github.com/vbraun"
}
```

Added a trivial fix, setting it back to positive review.



---

archive/issue_comments_123378.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-10-30T08:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123378",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_123379.json:
```json
{
    "body": "The first patch needs a proper commit message.",
    "created_at": "2012-10-30T08:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123379",
    "user": "https://github.com/jdemeyer"
}
```

The first patch needs a proper commit message.



---

archive/issue_comments_123380.json:
```json
{
    "body": "Added commit message",
    "created_at": "2012-11-06T01:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123380",
    "user": "https://github.com/vbraun"
}
```

Added commit message



---

archive/issue_comments_123381.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-11-06T01:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123381",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_123382.json:
```json
{
    "body": "Attachment [trac_11395_update_gfan_vb.patch](tarball://root/attachments/some-uuid/ticket11395/trac_11395_update_gfan_vb.patch) by @vbraun created at 2012-11-06 01:53:11\n\nI've added the missing commit message.",
    "created_at": "2012-11-06T01:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123382",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_11395_update_gfan_vb.patch](tarball://root/attachments/some-uuid/ticket11395/trac_11395_update_gfan_vb.patch) by @vbraun created at 2012-11-06 01:53:11

I've added the missing commit message.



---

archive/issue_comments_123383.json:
```json
{
    "body": "Thanks I had completely forgotten about this.",
    "created_at": "2012-11-06T01:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123383",
    "user": "https://github.com/kiwifb"
}
```

Thanks I had completely forgotten about this.



---

archive/issue_comments_123384.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-11-12T21:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11223#issuecomment-123384",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_029583.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-12T21:57:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11223",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11223#event-29583"
}
```
