# Issue 12157: Removed unneeded dependencies of the Sage library

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2012-01-20 09:42:28

Assignee: GeorgSWeber

According to `spkg/standard/deps`, the sage library depends on:

```
$(INST)/$(SAGE): $(BASE) \
         $(INST)/$(SAGE_SCRIPTS) \
         $(INST)/$(ATLAS) \
         $(INST)/$(CEPHES) \
         $(INST)/$(CLIQUER) \
         $(INST)/$(CONWAY) \
         $(INST)/$(CYTHON) \
         $(INST)/$(DOCUTILS) \
         $(INST)/$(ECL) \
         $(INST)/$(ECLIB) \
         $(INST)/$(ECM) \
         $(INST)/$(ELLIPTIC_CURVES) \
         $(INST)/$(EXTCODE) \
         $(INST)/$(FLINT) \
         $(INST)/$(FPLLL) \
         $(INST)/$(GDMODULE) \
         $(INST)/$(GRAPHS) \
         $(INST)/$(GIVARO) \
         $(INST)/$(GLPK) \
         $(INST)/$(GSL) \
         $(INST)/$(IML) \
         $(INST)/$(IPYTHON) \
         $(INST)/$(LCALC) \
         $(INST)/$(LIBM4RI) \
         $(INST)/$(LIBM4RIE) \
         $(INST)/$(LINBOX) \
         $(INST)/$(MATPLOTLIB) \
         $(INST)/$(MERCURIAL) \
         $(INST)/$(MPFI) \
         $(INST)/$(MPFR) \
         $(INST)/$(MPIR) \
         $(INST)/$(MPMATH) \
         $(INST)/$(NETWORKX) \
         $(INST)/$(NTL) \
         $(INST)/$(NUMPY) \
         $(INST)/$(PARI) \
         $(INST)/$(PEXPECT) \
         $(INST)/$(POLYBORI) \
         $(INST)/$(PPL) \
         $(INST)/$(PYCRYPTO) \
         $(INST)/$(PYNAC) \
         $(INST)/$(PYTHON) \
         $(INST)/$(R) \
         $(INST)/$(RATPOINTS) \
         $(INST)/$(RUBIKS) \
         $(INST)/$(SAGENB) \
         $(INST)/$(SCONS) \
         $(INST)/$(SETUPTOOLS) \
         $(INST)/$(SINGULAR) \
         $(INST)/$(SYMMETRICA) \
         $(INST)/$(SYMPY) \
         $(INST)/$(ZNPOLY)
```

However, only components which are needed at build-time should be listed here.  I think for example R can be removed.


---

Comment by jdemeyer created at 2012-01-20 12:37:54

Changing status from new to needs_review.


---

Comment by ohanar created at 2012-01-27 09:27:37

I'm fairly certain the sage library does not need $(INST)/$(ELLIPTIC_CURVES) either (all that package does is install a couple of databases to SAGE_DATA).


---

Comment by jdemeyer created at 2012-01-27 10:12:57

You are right, I confused with `ECLIB` (which certainly is needed).  New patch, needs review.


---

Comment by fbissey created at 2012-01-27 18:26:56

Coming from sage-on-gentoo, I am not sure at all that GRAPHS needs to be there. We very much build sage without needing mercurial but we do things a bit differently so that one needs caution. I don't think mpmath is needed to build either if it is we have a bug in sage-on-gentoo.


---

Comment by fbissey created at 2012-01-27 20:40:01

While gdmodule is not needed gd actually is and so is png.

```
    Extension('sage.matrix.matrix_mod2_dense',
              sources = ['sage/matrix/matrix_mod2_dense.pyx'],
              libraries = ['gmp','m4ri', 'gd', 'png12', 'z'],
              depends = [SAGE_ROOT + "/local/include/png.h", SAGE_ROOT + "/local/include/m4ri/m4ri.h"]),
```

for example from module_list.py. Of course these two are needed for polybori so you are probably covered. readline is also there but other dependencies may include it. I cannot check right now.


---

Comment by jdemeyer created at 2012-01-29 11:01:21

Okay, added `GD`, `LIBPNG`, `READLINE`.  Removed `GRAPHS`, `MPMATH`.  Testing now.


---

Comment by jdemeyer created at 2012-01-29 11:01:21

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2012-01-29 11:02:17

Mercurial is needed in the `spkg-install` (at least for upgrades), so we cannot remove that.


---

Comment by jdemeyer created at 2012-01-29 11:25:04

The new patch works!  Needs review.


---

Comment by jdemeyer created at 2012-01-29 11:25:04

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2012-01-30 00:16:39

Looks good to me, I fully agree with that list and cannot see it failing.


---

Comment by fbissey created at 2012-01-30 00:16:39

Changing status from needs_review to positive_review.


---

Attachment

I replaced the "sageruntime" target by a "$(SAGERUNTIME)" variable, similar to the "$(BASE)" variable.


---

Comment by jdemeyer created at 2012-02-02 12:54:39

Resolution: fixed
