# Issue 22814: inline cache access of matrices

Issue created by migration from https://trac.sagemath.org/ticket/23051

Original creator: vdelecroix

Original creation time: 2017-05-22 08:21:26

inline cache access of matrices in `matrix0.pyx`


---

Comment by vdelecroix created at 2017-05-22 08:21:55

New commits:


---

Comment by vdelecroix created at 2017-05-22 08:22:26

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-05-22 08:40:50

Declaring methods as `inline` is wrong: https://github.com/cython/cython/issues/1706#issuecomment-302347613


---

Comment by jdemeyer created at 2017-05-22 08:40:50

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-06-01 19:42:16

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2017-06-01 19:43:40

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2017-06-02 12:50:23

Replying to [ticket:23051 vdelecroix]:
> - remove the public access to the `_cache` attribute

Why? Surely `X._cache` is more readable and easier to grasp than `X._get_cache()`.


---

Comment by jdemeyer created at 2017-06-02 12:51:54

I also don't like this `return 0`. If the return type `int` is only meant for checking exceptions, I usually don't write a `return`. Cython knows to `return 0` in that case.


---

Comment by jdemeyer created at 2017-06-02 12:53:02

And why have `clear_cache` and `_clear_cache` methods which do exactly the same? That's what `cpdef` methods were invented for.


---

Comment by jdemeyer created at 2017-06-02 12:54:32

I think these can raise exceptions too, so better declare them as `cdef int ... except -1`:

```
cdef void cache(self, key, x)
cdef void clear_cache(self)
```



---

Comment by jdemeyer created at 2017-06-02 12:55:27

And obviously, some of these caching mechanisms are re-inventing the `cached_method` wheel... (not saying that you need to fix this, just pointing it out).


---

Comment by jdemeyer created at 2017-06-02 12:55:27

Changing status from needs_review to needs_work.
