# Issue 33939: update curl to version 7.84

Issue created by migration from https://trac.sagemath.org/ticket/34176

Original creator: dimpase

Original creation time: 2022-07-13 10:24:51

our 7.62 does not build on Ubuntu 22.04, as [reported on sage-release](https://groups.google.com/g/sage-release/c/-0luW4DPEPs/m/Tp4wkBmdAAAJ)

The tarball is here 
https://curl.se/download/curl-7.84.0.tar.bz2


---

Comment by dimpase created at 2022-07-13 10:48:32

This unfortunately doesn't "just work".
On Debian stable this branch leads to

```
[curl-7.84.0] configure: error: select TLS backend(s) or disable TLS with --without-ssl.
[curl-7.84.0] 
[curl-7.84.0] Select from these:
[curl-7.84.0] 
[curl-7.84.0]   --with-amissl
[curl-7.84.0]   --with-bearssl
[curl-7.84.0]   --with-gnutls
[curl-7.84.0]   --with-mbedtls
[curl-7.84.0]   --with-nss
[curl-7.84.0]   --with-openssl (also works for BoringSSL and libressl)
[curl-7.84.0]   --with-rustls
[curl-7.84.0]   --with-schannel
[curl-7.84.0]   --with-secure-transport
[curl-7.84.0]   --with-wolfssl
[curl-7.84.0] 
```


and this is the usual OpenSSL dance here, which I don't know how to do.

IMHO we cannot just disable TLS.

----
New commits:


---

Comment by dimpase created at 2022-07-13 10:48:44

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-07-13 10:49:18

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2022-07-13 10:50:37

I'd rather just insist on curl coming from the system...


---

Comment by mkoeppe created at 2022-07-13 17:04:24

dup of #31260


---

Comment by dimpase created at 2022-07-13 17:23:20

except the version is too old in #31260


---

Comment by mkoeppe created at 2022-07-13 17:25:03

OK, so let's close #31260


---

Comment by mkoeppe created at 2022-07-13 17:32:00

I think we can do `--with-openssl`


---

Comment by dimpase created at 2022-07-13 20:51:14

it is not clear what is needed on Darwin. Do we still need the workaround for it in spkg-install


---

Comment by mkoeppe created at 2022-07-13 20:53:45

Probably not, we have openssl now


---

Comment by git created at 2022-07-14 08:17:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2022-07-14 08:19:20

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2022-07-14 08:19:20

OK, openssl is now a dependency. This branch works on Linux and with macOS Homebrew.


---

Comment by mkoeppe created at 2022-07-16 17:05:24

Please rebase so that the CI runs with the current platforms. This ran `centos-7-i386` and shows a failure for this platform (which we replaced in #33822)


---

Comment by mkoeppe created at 2022-07-16 19:02:24

Never mind, I've tested `centos-7-devtoolset-gcc_9-minimal` manually.


---

Comment by mkoeppe created at 2022-07-16 19:02:24

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2022-07-16 19:52:01

Thanks!


---

Comment by vbraun created at 2022-08-01 20:23:05

Resolution: fixed


---

Comment by mkoeppe created at 2022-08-14 20:12:58

Follow-up in #34360
