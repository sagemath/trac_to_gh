# Issue 25886: residue field of a valuation on a function field should be a function field when possible

Issue created by migration from https://trac.sagemath.org/ticket/26123

Original creator: saraedum

Original creation time: 2018-08-25 10:31:53

CC:  swewers

Currently, the residue field of a non-classical valuation on a function field is not a real function field:

```
sage: R.<x> = QQ[]
sage: v = GaussValuation(R, QQ.valuation(2))
sage: K.<x> = FunctionField(QQ)
sage: v = K.valuation(v)
sage: v.residue_field()
Fraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)
```


This ticket changes this to be `Rational function field in x over Finite Field of size 2`.


---

Comment by saraedum created at 2018-08-25 10:33:04

Changing priority from major to minor.


---

Comment by saraedum created at 2018-08-25 14:40:04

Changing status from new to needs_review.


---

Comment by swewers created at 2018-08-25 15:38:28

There should be a test that `v.reduce(f)` works in this situation. 
The docstring for `reduce` test this only for standard valuations,
where the residue field is not a function field. 
----
New commits:


---

Comment by saraedum created at 2018-08-26 11:53:37

We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.


---

Comment by saraedum created at 2018-08-26 11:56:29

Hmâ€¦so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)


---

Comment by git created at 2018-08-27 15:16:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-08-27 15:16:58

New commits:


---

Comment by swewers created at 2018-08-28 08:41:03

Trivial pyflakes error:

   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used

Otherwise, everything is fine.


---

Comment by swewers created at 2018-08-28 08:41:03

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-08-29 01:22:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-08-29 01:22:53

Changing status from needs_work to needs_review.


---

Comment by swewers created at 2018-08-29 07:18:37

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-09-03 23:29:39

Resolution: fixed
