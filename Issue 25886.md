# Issue 25886: residue field of a valuation on a function field should be a function field when possible

archive/issues_025886.json:
```json
{
    "body": "CC:  swewers\n\nCurrently, the residue field of a non-classical valuation on a function field is not a real function field:\n\n```\nsage: R.<x> = QQ[]\nsage: v = GaussValuation(R, QQ.valuation(2))\nsage: K.<x> = FunctionField(QQ)\nsage: v = K.valuation(v)\nsage: v.residue_field()\nFraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)\n```\n\n\nThis ticket changes this to be `Rational function field in x over Finite Field of size 2`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26123\n\n",
    "created_at": "2018-08-25T10:31:53Z",
    "labels": [
        "commutative algebra",
        "major",
        "enhancement"
    ],
    "title": "residue field of a valuation on a function field should be a function field when possible",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25886",
    "user": "saraedum"
}
```
CC:  swewers

Currently, the residue field of a non-classical valuation on a function field is not a real function field:

```
sage: R.<x> = QQ[]
sage: v = GaussValuation(R, QQ.valuation(2))
sage: K.<x> = FunctionField(QQ)
sage: v = K.valuation(v)
sage: v.residue_field()
Fraction Field of Univariate Polynomial Ring in x over Finite Field of size 2 (using GF2X)
```


This ticket changes this to be `Rational function field in x over Finite Field of size 2`.

Issue created by migration from https://trac.sagemath.org/ticket/26123





---

archive/issue_comments_365392.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2018-08-25T10:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365392",
    "user": "saraedum"
}
```

Changing priority from major to minor.



---

archive/issue_comments_365393.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-25T14:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365393",
    "user": "saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_365394.json:
```json
{
    "body": "There should be a test that `v.reduce(f)` works in this situation. \nThe docstring for `reduce` test this only for standard valuations,\nwhere the residue field is not a function field. \n----\nNew commits:",
    "created_at": "2018-08-25T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365394",
    "user": "swewers"
}
```

There should be a test that `v.reduce(f)` works in this situation. 
The docstring for `reduce` test this only for standard valuations,
where the residue field is not a function field. 
----
New commits:



---

archive/issue_comments_365395.json:
```json
{
    "body": "We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.",
    "created_at": "2018-08-26T11:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365395",
    "user": "saraedum"
}
```

We have `_test_reduce` in `valuation_space.py` that tests generically that `v.reduce(f)` is in `v.residue_ring()`. So let's add a check there that `v.residue_ring()` coerces into `v.residue_field()`.



---

archive/issue_comments_365396.json:
```json
{
    "body": "Hm\u2026so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)",
    "created_at": "2018-08-26T11:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365396",
    "user": "saraedum"
}
```

Hmâ€¦so since `residue_ring()` and `residue_field()` are the same in this case, I don't think we need this here ;)



---

archive/issue_comments_365397.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-27T15:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365397",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_365398.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-08-27T15:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365398",
    "user": "saraedum"
}
```

New commits:



---

archive/issue_comments_365399.json:
```json
{
    "body": "Trivial pyflakes error:\n\n   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used\n\nOtherwise, everything is fine.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365399",
    "user": "swewers"
}
```

Trivial pyflakes error:

   src/sage/rings/valuation/valuation_space.py:1563: local variable 'r' is assigned to but never used

Otherwise, everything is fine.



---

archive/issue_comments_365400.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-28T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365400",
    "user": "swewers"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_365401.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-29T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365401",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_365402.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-29T01:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365402",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_365403.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-29T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365403",
    "user": "swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_365404.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-03T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25886#issuecomment-365404",
    "user": "vbraun"
}
```

Resolution: fixed
