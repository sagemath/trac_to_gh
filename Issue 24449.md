# Issue 24449: Integration of complex piecewise analytic functions using arb

Issue created by migration from Trac.

Original creator: mmezzarobba

Original creation time: 2018-02-07 16:58:07

CC:  fredrik.johansson vdelecroix cheuberg




---

Comment by mmezzarobba created at 2018-02-07 17:00:06

New commits:


---

Comment by git created at 2018-02-07 17:20:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-02-07 17:23:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-02-08 07:58:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-08 08:04:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2018-02-08 08:04:53

Sorry, I wrongly included a commit from another ticket... cleaner now!


---

Comment by vdelecroix created at 2018-02-08 10:09:10

Changing keywords from "" to "thursdaysbdx".


---

Comment by git created at 2018-02-08 16:09:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-08 16:17:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-08 17:51:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-09 17:05:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mmezzarobba created at 2018-02-09 17:05:47

Changing status from new to needs_review.


---

Comment by git created at 2018-02-09 17:46:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-02-09 17:52:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-02-09 21:49:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-09 23:42:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-10 12:16:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-12 09:22:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2018-02-13 19:06:08

I am not sure it is wise to have all of

```
    cdef IntegrationContext ctx = <IntegrationContext>param
    if ctx.exn_type is not None or order >= 2:
        acb_indeterminate(out)
        return 0
    cdef ComplexBall x = ComplexBall.__new__(ComplexBall)
    assert prec == ctx.parent._prec
```

inside `sig_on`/`sig_off`.


---

Comment by vdelecroix created at 2018-02-13 19:13:34

What is the point of

```
        if isinstance(a, (RealBall, ComplexBall)):
            ca = <ComplexBall> self(a)
        else:
            ca = <ComplexBall> self.coerce(a)
```

instead of the direct `<ComplexBall> self.coerce(a)`?


---

Comment by mmezzarobba created at 2018-02-14 08:31:41

Replying to [comment:21 vdelecroix]:
> I am not sure it is wise to have all of
> {{{
>     cdef IntegrationContext ctx = <IntegrationContext>param
>     if ctx.exn_type is not None or order >= 2:
>         acb_indeterminate(out)
>         return 0
>     cdef ComplexBall x = ComplexBall.__new__(ComplexBall)
>     assert prec == ctx.parent._prec
> }}}
> inside `sig_on`/`sig_off`.

I guess you are right, the `__new__` probably shouldn't be inside, thanks!


---

Comment by mmezzarobba created at 2018-02-14 08:32:29

Replying to [comment:22 vdelecroix]:
> What is the point of
> {{{
>         if isinstance(a, (RealBall, ComplexBall)):
>             ca = <ComplexBall> self(a)
>         else:
>             ca = <ComplexBall> self.coerce(a)
> }}}
> instead of the direct `<ComplexBall> self.coerce(a)`?

It accepts balls of lower precision.


---

Comment by vdelecroix created at 2018-02-14 11:35:21

Replying to [comment:24 mmezzarobba]:
> Replying to [comment:22 vdelecroix]:
> > What is the point of
> > {{{
> >         if isinstance(a, (RealBall, ComplexBall)):
> >             ca = <ComplexBall> self(a)
> >         else:
> >             ca = <ComplexBall> self.coerce(a)
> > }}}
> > instead of the direct `<ComplexBall> self.coerce(a)`?
> 
> It accepts balls of lower precision.

Do we want this? What is guaranteed by the conversion `self(a)` when `a` is a ball in lower precision?


---

Comment by vdelecroix created at 2018-02-14 11:36:28

Replying to [comment:23 mmezzarobba]:
> Replying to [comment:21 vdelecroix]:
> > I am not sure it is wise to have all of
> > {{{
> >     cdef IntegrationContext ctx = <IntegrationContext>param
> >     if ctx.exn_type is not None or order >= 2:
> >         acb_indeterminate(out)
> >         return 0
> >     cdef ComplexBall x = ComplexBall.__new__(ComplexBall)
> >     assert prec == ctx.parent._prec
> > }}}
> > inside `sig_on`/`sig_off`.
> 
> I guess you are right, the `__new__` probably shouldn't be inside, thanks!

The cast `cdef IntegrationContext ctx = <IntegrationContext>param` and the `assert` are also concerned.


---

Comment by git created at 2018-02-14 13:52:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2018-02-14 13:53:16

Replying to [comment:25 vdelecroix]:
> Do we want this? What is guaranteed by the conversion `self(a)` when `a` is a ball in lower precision?

I think we do. It stays exactly the same ball.


---

Comment by vdelecroix created at 2018-02-18 20:18:59

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2018-02-18 20:18:59

I just reread the code. I believe we did enough cross review to have a decent version!


---

Comment by vbraun created at 2018-02-20 23:08:22

Resolution: fixed
