# Issue 13004: Upgrade sage-mode to 0.7

archive/issues_013004.json:
```json
{
    "body": "Assignee: was\n\nCC:  iandrus ncalexan\n\nKeywords: sage-mode\n\nThere is a little confusion about the latest sage-mode - see, for example, [this ask.sagemath.org question](http://ask.sagemath.org/question/1567/sage-mode-does-not-work). On the more or less official [wiki page](http://wiki.sagemath.org/sage-mode), it is definitely at 0.7, but on the optional spkg page (and when downloading via `sage -i sage-mode` one only gets 0.6.  This needs an upgrade.\n\n#1861 and #2666 are related, but ancient.  The SPKG.txt should at least be updated a little; maybe #1861's concern about making the inheritance from ipython.el should be dealt with here as well.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13176\n\n",
    "created_at": "2012-06-28T13:58:41Z",
    "labels": [
        "user interface",
        "minor",
        "enhancement"
    ],
    "title": "Upgrade sage-mode to 0.7",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13004",
    "user": "kcrisman"
}
```
Assignee: was

CC:  iandrus ncalexan

Keywords: sage-mode

There is a little confusion about the latest sage-mode - see, for example, [this ask.sagemath.org question](http://ask.sagemath.org/question/1567/sage-mode-does-not-work). On the more or less official [wiki page](http://wiki.sagemath.org/sage-mode), it is definitely at 0.7, but on the optional spkg page (and when downloading via `sage -i sage-mode` one only gets 0.6.  This needs an upgrade.

#1861 and #2666 are related, but ancient.  The SPKG.txt should at least be updated a little; maybe #1861's concern about making the inheritance from ipython.el should be dealt with here as well.

Issue created by migration from https://trac.sagemath.org/ticket/13176





---

archive/issue_comments_157232.json:
```json
{
    "body": "Along the way, note the litany of errors reported with 0.7 at the [ask.sagemath question](http://ask.sagemath.org/question/1567/sage-mode-does-not-work).",
    "created_at": "2012-06-28T14:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157232",
    "user": "kcrisman"
}
```

Along the way, note the litany of errors reported with 0.7 at the [ask.sagemath question](http://ask.sagemath.org/question/1567/sage-mode-does-not-work).



---

archive/issue_comments_157233.json:
```json
{
    "body": "With respect to #1861, when upgrading, make sure that somewhere in the documentation, wiki, bitbucket, whatever, there is a place that says this was inspired by ipython.el originally.  It sounds like the current version isn't really adapted from it at all, though.",
    "created_at": "2012-06-28T16:11:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157233",
    "user": "kcrisman"
}
```

With respect to #1861, when upgrading, make sure that somewhere in the documentation, wiki, bitbucket, whatever, there is a place that says this was inspired by ipython.el originally.  It sounds like the current version isn't really adapted from it at all, though.



---

archive/issue_comments_157234.json:
```json
{
    "body": "#1861's issues have already been dealt with on the [wiki](http://wiki.sagemath.org/sage-mode), which is more or less official, so that is good now.\n\nThe spkg is located [here](http://wiki.sagemath.org/sage-mode?action=AttachFile&do=get&target=sage-mode-0.7.spkg).  I see that 0.8 has all the other good changes mentioned at #1861 and elsewhere.\n\nA question about the 0.8 spkg, though perhaps that doesn't belong here:\n\n```\n$ hg st\n? emacs/sage-load.el\n```\n\n\nIvan, do you think the goal of this ticket should be 0.7 on the optional spkg?  If so, then since Nick wrote it, you can review it.  For 0.8, though, you'd have to find someone else to review it, and that could take a while.  I recommend the former course.  In that case we can open another ticket for 0.8, where all these doc issues are 100% taken care of, I already given positive review to that stuff and the spkg qua spkg (well, except for the thing above!).",
    "created_at": "2012-06-29T12:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157234",
    "user": "kcrisman"
}
```

#1861's issues have already been dealt with on the [wiki](http://wiki.sagemath.org/sage-mode), which is more or less official, so that is good now.

The spkg is located [here](http://wiki.sagemath.org/sage-mode?action=AttachFile&do=get&target=sage-mode-0.7.spkg).  I see that 0.8 has all the other good changes mentioned at #1861 and elsewhere.

A question about the 0.8 spkg, though perhaps that doesn't belong here:

```
$ hg st
? emacs/sage-load.el
```


Ivan, do you think the goal of this ticket should be 0.7 on the optional spkg?  If so, then since Nick wrote it, you can review it.  For 0.8, though, you'd have to find someone else to review it, and that could take a while.  I recommend the former course.  In that case we can open another ticket for 0.8, where all these doc issues are 100% taken care of, I already given positive review to that stuff and the spkg qua spkg (well, except for the thing above!).



---

archive/issue_comments_157235.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-06-29T12:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157235",
    "user": "kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_157236.json:
```json
{
    "body": "Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.",
    "created_at": "2012-06-29T12:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157236",
    "user": "kcrisman"
}
```

Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.



---

archive/issue_comments_157237.json:
```json
{
    "body": "Replying to [comment:5 kcrisman]:\n> Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.\n\nWell it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  I think this is bad, so I changed it, but I do need to change the documentation for 0.8.",
    "created_at": "2012-06-29T13:17:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157237",
    "user": "iandrus"
}
```

Replying to [comment:5 kcrisman]:
> Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.

Well it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  I think this is bad, so I changed it, but I do need to change the documentation for 0.8.



---

archive/issue_comments_157238.json:
```json
{
    "body": "Replying to [comment:3 kcrisman]:\n> A question about the 0.8 spkg, though perhaps that doesn't belong here:\n> {{{\n> $ hg st\n> ? emacs/sage-load.el\n> }}}\n\nThat's a generated file (when the spkg is created).  Perhaps it should be generated as part of spkg-install, but it doesn't depend on the version of emacs being used etc. so it's kind of like running autoconf before distributing.  I have added it to hgignore so the repository will be clean.\n\n> Ivan, do you think the goal of this ticket should be 0.7 on the optional spkg?  If so, then since Nick wrote it, you can review it.  For 0.8, though, you'd have to find someone else to review it, and that could take a while.  I recommend the former course.  In that case we can open another ticket for 0.8, where all these doc issues are 100% taken care of, I already given positive review to that stuff and the spkg qua spkg (well, except for the thing above!).\n\nThat is a good question.  If we want 0.7 to get out that's fine.  I can review it, even though there are a few known bugs in it.",
    "created_at": "2012-06-29T13:29:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157238",
    "user": "iandrus"
}
```

Replying to [comment:3 kcrisman]:
> A question about the 0.8 spkg, though perhaps that doesn't belong here:
> {{{
> $ hg st
> ? emacs/sage-load.el
> }}}

That's a generated file (when the spkg is created).  Perhaps it should be generated as part of spkg-install, but it doesn't depend on the version of emacs being used etc. so it's kind of like running autoconf before distributing.  I have added it to hgignore so the repository will be clean.

> Ivan, do you think the goal of this ticket should be 0.7 on the optional spkg?  If so, then since Nick wrote it, you can review it.  For 0.8, though, you'd have to find someone else to review it, and that could take a while.  I recommend the former course.  In that case we can open another ticket for 0.8, where all these doc issues are 100% taken care of, I already given positive review to that stuff and the spkg qua spkg (well, except for the thing above!).

That is a good question.  If we want 0.7 to get out that's fine.  I can review it, even though there are a few known bugs in it.



---

archive/issue_comments_157239.json:
```json
{
    "body": "Replying to [comment:6 iandrus]:\n> Replying to [comment:5 kcrisman]:\n> > Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.\n> \n> Well it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  \n\nYikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.\n\n> I think this is bad, so I changed it, but I do need to change the documentation for 0.8.\n\nYes. Again, or even 0.7.\n\n> If we want 0.7 to get out that's fine. I can review it, even though there are a few known bugs in it.\nWell, if you think that 0.8 is bug-free and can get someone to review it, we can do that here too.  But your big warnings about being EXPERIMENTAL and so forth kind of made me think that you weren't too keen on that yet :)",
    "created_at": "2012-06-29T13:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157239",
    "user": "kcrisman"
}
```

Replying to [comment:6 iandrus]:
> Replying to [comment:5 kcrisman]:
> > Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.
> 
> Well it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  

Yikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.

> I think this is bad, so I changed it, but I do need to change the documentation for 0.8.

Yes. Again, or even 0.7.

> If we want 0.7 to get out that's fine. I can review it, even though there are a few known bugs in it.
Well, if you think that 0.8 is bug-free and can get someone to review it, we can do that here too.  But your big warnings about being EXPERIMENTAL and so forth kind of made me think that you weren't too keen on that yet :)



---

archive/issue_comments_157240.json:
```json
{
    "body": "Replying to [comment:8 kcrisman]:\n> Replying to [comment:6 iandrus]:\n> > Replying to [comment:5 kcrisman]:\n> > > Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.\n> > \n> > Well it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  \n> \n> Yikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.\n\nBut it's been that way for a long time, so IMHO it's not worth recreating the 0.7 spkg just for that.  Can you tell I'm lazy? :-)\n\n> > I think this is bad, so I changed it, but I do need to change the documentation for 0.8.\n> \n> Yes. Again, or even 0.7.\n> \n> > If we want 0.7 to get out that's fine. I can review it, even though there are a few known bugs in it.\n> Well, if you think that 0.8 is bug-free and can get someone to review it, we can do that here too.  But your big warnings about being EXPERIMENTAL and so forth kind of made me think that you weren't too keen on that yet :)\n\nWell, I've been trying to get it to work with changes in the latest python.el (a complete rewrite that will be in Emacs 24.2 when it gets released).  It still doesn't fully work, but neither does 0.7 or before, so releasing 0.8 wouldn't be worse.  However, I'm afraid that while updating I may have broken compatibility with the old python.el.  Since I build Emacs directly from bzr it's slightly non-trivial (and boring) for me to test with old versions.  However, it's something I definitely need to do\u2014I just need to bite the bullet and do it.  In fact I'll go do it now...",
    "created_at": "2012-06-29T13:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157240",
    "user": "iandrus"
}
```

Replying to [comment:8 kcrisman]:
> Replying to [comment:6 iandrus]:
> > Replying to [comment:5 kcrisman]:
> > > Oh, one more thing - your 0.8 spkg that you posted on the wiki is called `sage_mode` not `sage-mode`, but you'll need to do the latter because otherwise people will do `sage -i sage-mode` and still get 0.7 or nothing.  Probably that was just a typo.
> > 
> > Well it's not really a typo.  The reason I changed it to underscore is because sage uses a dash to separate the version from the spkg so calling `sage -i sage` actually installs the sage-mode-0.6 package!  
> 
> Yikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.

But it's been that way for a long time, so IMHO it's not worth recreating the 0.7 spkg just for that.  Can you tell I'm lazy? :-)

> > I think this is bad, so I changed it, but I do need to change the documentation for 0.8.
> 
> Yes. Again, or even 0.7.
> 
> > If we want 0.7 to get out that's fine. I can review it, even though there are a few known bugs in it.
> Well, if you think that 0.8 is bug-free and can get someone to review it, we can do that here too.  But your big warnings about being EXPERIMENTAL and so forth kind of made me think that you weren't too keen on that yet :)

Well, I've been trying to get it to work with changes in the latest python.el (a complete rewrite that will be in Emacs 24.2 when it gets released).  It still doesn't fully work, but neither does 0.7 or before, so releasing 0.8 wouldn't be worse.  However, I'm afraid that while updating I may have broken compatibility with the old python.el.  Since I build Emacs directly from bzr it's slightly non-trivial (and boring) for me to test with old versions.  However, it's something I definitely need to do—I just need to bite the bullet and do it.  In fact I'll go do it now...



---

archive/issue_comments_157241.json:
```json
{
    "body": "> > Yikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.\n> \n> But it's been that way for a long time, so IMHO it's not worth recreating the 0.7 spkg just for that.  Can you tell I'm lazy? :-)\nNot lazy, just more efficient with your time than I am.  \n\nSo does that mean you are ok with this spkg as is?  I mean, it's been out there six months...  I mean, if the point of sage-mode is to be functional, not bug-free, and has been for a while, then this is not necessarily horrible.  Sage isn't bug-free either.  Are the bugs documented?  As long as they aren't nasty silent failures, I guess.\n\n> Well, I've been trying to get it to work with changes in the latest python.el (a complete rewrite that will be in Emacs 24.2 when it gets released).  It still doesn't fully work, but neither does 0.7 or before, so releasing 0.8 wouldn't be worse.  However, I'm afraid that while updating I may have broken compatibility with the old python.el.  Since I build Emacs directly from bzr it's slightly non-trivial (and boring) for me to test with old versions.  However, it's something I definitely need to do\u2014I just need to bite the bullet and do it.  In fact I'll go do it now...\n\nJust let me know, or (better) open your own ticket for that, then, and let's get this out the door.  I can only review the dumb stuff like above, since I don't use, nor know how to use, nor have interest in learning how to use, emacs.",
    "created_at": "2012-06-29T13:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157241",
    "user": "kcrisman"
}
```

> > Yikes!  Yeah, and the (few) spkgs in a similar situation are like your new one.  Good eye.  Maybe this is something that should even be changed for the 0.7 spkg, to be honest... too bad about backward compatibility, but this is pretty important.
> 
> But it's been that way for a long time, so IMHO it's not worth recreating the 0.7 spkg just for that.  Can you tell I'm lazy? :-)
Not lazy, just more efficient with your time than I am.  

So does that mean you are ok with this spkg as is?  I mean, it's been out there six months...  I mean, if the point of sage-mode is to be functional, not bug-free, and has been for a while, then this is not necessarily horrible.  Sage isn't bug-free either.  Are the bugs documented?  As long as they aren't nasty silent failures, I guess.

> Well, I've been trying to get it to work with changes in the latest python.el (a complete rewrite that will be in Emacs 24.2 when it gets released).  It still doesn't fully work, but neither does 0.7 or before, so releasing 0.8 wouldn't be worse.  However, I'm afraid that while updating I may have broken compatibility with the old python.el.  Since I build Emacs directly from bzr it's slightly non-trivial (and boring) for me to test with old versions.  However, it's something I definitely need to do—I just need to bite the bullet and do it.  In fact I'll go do it now...

Just let me know, or (better) open your own ticket for that, then, and let's get this out the door.  I can only review the dumb stuff like above, since I don't use, nor know how to use, nor have interest in learning how to use, emacs.



---

archive/issue_comments_157242.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-29T14:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157242",
    "user": "iandrus"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_157243.json:
```json
{
    "body": "I gave it positive review since all the bugs I know about in 0.7 also exist in 0.6.  I tested on Emacs 24.1 and Emacs 23.1 on OS X 10.6.8.",
    "created_at": "2012-06-29T14:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157243",
    "user": "iandrus"
}
```

I gave it positive review since all the bugs I know about in 0.7 also exist in 0.6.  I tested on Emacs 24.1 and Emacs 23.1 on OS X 10.6.8.



---

archive/issue_comments_157244.json:
```json
{
    "body": "Probably makes sense to at least test that it builds on Linux and/or Solaris, though one would assume that Emacs, if anything was pretty portable!  Sort of the point, right?",
    "created_at": "2012-06-29T15:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157244",
    "user": "kcrisman"
}
```

Probably makes sense to at least test that it builds on Linux and/or Solaris, though one would assume that Emacs, if anything was pretty portable!  Sort of the point, right?



---

archive/issue_comments_157245.json:
```json
{
    "body": "Changing component from user interface to optional packages.",
    "created_at": "2012-06-29T15:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157245",
    "user": "jdemeyer"
}
```

Changing component from user interface to optional packages.



---

archive/issue_comments_157246.json:
```json
{
    "body": "spkg moved to the servers",
    "created_at": "2012-07-02T12:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157246",
    "user": "schilly"
}
```

spkg moved to the servers



---

archive/issue_comments_157247.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-07-02T12:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13004#issuecomment-157247",
    "user": "jdemeyer"
}
```

Resolution: fixed
