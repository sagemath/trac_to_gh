# Issue 11583: Allow running Sage.app by someone other than it was installed by

Issue created by migration from Trac.

Original creator: iandrus

Original creation time: 2011-08-29 08:05:50

Assignee: iandrus

CC:  kcrisman dimpase

Keywords: mac app

Since Sage.app checks if it moved every time upon startup, any user who runs the application needs to be able to write to `local/lib/sage-current-location.txt`.  This files seems to default to 0644 permissions.  

We can either change the Sage.app code so that it doesn't need to check every time or make the file world writable.


---

Comment by leif created at 2011-08-29 08:58:18

That's a matter of the current umask, but we could of course change the file permission on updates to that file. On the other hand, opening an existing file for writing shouldn't change the permissions in the first place. If the file gets deleted inbetween, an ordinary user would also need write permissions _on the directory_ the file is located / recreated in, i.e. `$SAGE_ROOT/local/lib/`.

It's not immediately clear to me why an ordinary user would have to move Sage though, just to run the application. (But I don't use apples.)

Allowing the _group_ to write to this file would certainly be better, putting potential users (that move the installation) into that group. (But they still won't be able to actually modify / fix hardcoded paths, which is the whole purpose of `sage-current-location.txt`, so the installation might actually break if it _really_ moved. A better detection in the code that attempts to update that file is another alternative.)

The whole issue might be related to #5852 (and previously #11707), such that after this ticket is resolved, changing the permissions may no longer be necessary.


---

Comment by jhpalmieri created at 2011-09-20 03:06:31

Replying to [comment:1 leif]:
> It's not immediately clear to me why an ordinary user would have to move Sage though, just to run the application. (But I don't use apples.)

If an ordinary user moves Sage, then presumably they have write permissions to the new SAGE_ROOT/local/lib, so there won't be any problems, will there?

This all happens in the script `sage-location`, right?  If Sage detects that its location has moved, then it tries to update various library and pkg-config files.  If the user doesn't have permission to do this, then we could just print a warning ("Have your sysadmin do ..." and/or "Try copying the Sage installation to ...") and either bail out or keep going and hope for the best.

In fact, I posted a patch doing some of this (it doesn't print the warning) at #5155.  Perhaps we should try to fix this issue here and deal with the other issues from #5155 there.


---

Comment by jdemeyer created at 2011-09-26 20:58:34

Changing component from user interface to relocation.


---

Comment by jdemeyer created at 2011-09-26 20:58:34

Changing keywords from "mac app" to "mac app SAGE_ROOT".


---

Comment by mkoeppe created at 2021-01-21 00:02:05

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-01-21 00:02:05

Outdated, should be closed


---

Comment by jhpalmieri created at 2021-01-21 22:42:45

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2021-01-21 22:42:45

Sure.


---

Comment by chapoton created at 2021-04-01 06:39:43

Resolution: invalid
