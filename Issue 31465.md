# Issue 31465: PolyhedronRepresentation richcmp compares two representation objects with different types

archive/issues_031465.json:
```json
{
    "body": "CC:  @mkoeppe @kliem @jplab\n\nKeywords: richcmp, polyhedra, vrepresentation, hrepresentation\n\nCurrently, the comparison is implemented only for two objects of the same type (vertex/ray/line or inequality/equation), as follows\n\n```\nif type(self) != type(other):\n    return NotImplemented\nreturn richcmp(self._vector*self._comparison_scalar(), other._vector*other._comparison_scalar(), op)\n```\n\n\nIt might be good to extend the comparison to objects of different types, using the numeric values for the output of the type() method: \n`INEQUALITY = 0`; `EQUATION = 1`; `VERTEX = 2`; `RAY = 3`; `LINE = 4`.\nThat is, instead of `return NotImplemented`, we return something like\n\n```\nrichcmp((type(self), self._vector*self._comparison_scalar()), (type(other), other._vector*other._comparison_scalar()), op)\n```\n\n\nIn this way, we will be able to sort a list of polyhedra according to their Vrepresentations.\n\n```\nsage: P = Polyhedron(vertices=[(0,0),(1,1)])                                       \nsage: Q = Polyhedron(vertices=[(0,0)], rays=[(1,1)])                               \nsage: [P, Q].sort(key=lambda p: p.Vrepresentation())                               \nTraceback (most recent call \n...\nTypeError: '<' not supported between instances of 'Ray' and 'Vertex'\n```\n\n\nDoes such change make sense? Will it break anything?\n\nIssue created by migration from https://trac.sagemath.org/ticket/31702\n\n",
    "created_at": "2021-04-20T11:59:41Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "PolyhedronRepresentation richcmp compares two representation objects with different types",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31465",
    "user": "@yuan-zhou"
}
```
CC:  @mkoeppe @kliem @jplab

Keywords: richcmp, polyhedra, vrepresentation, hrepresentation

Currently, the comparison is implemented only for two objects of the same type (vertex/ray/line or inequality/equation), as follows

```
if type(self) != type(other):
    return NotImplemented
return richcmp(self._vector*self._comparison_scalar(), other._vector*other._comparison_scalar(), op)
```


It might be good to extend the comparison to objects of different types, using the numeric values for the output of the type() method: 
`INEQUALITY = 0`; `EQUATION = 1`; `VERTEX = 2`; `RAY = 3`; `LINE = 4`.
That is, instead of `return NotImplemented`, we return something like

```
richcmp((type(self), self._vector*self._comparison_scalar()), (type(other), other._vector*other._comparison_scalar()), op)
```


In this way, we will be able to sort a list of polyhedra according to their Vrepresentations.

```
sage: P = Polyhedron(vertices=[(0,0),(1,1)])                                       
sage: Q = Polyhedron(vertices=[(0,0)], rays=[(1,1)])                               
sage: [P, Q].sort(key=lambda p: p.Vrepresentation())                               
Traceback (most recent call 
...
TypeError: '<' not supported between instances of 'Ray' and 'Vertex'
```


Does such change make sense? Will it break anything?

Issue created by migration from https://trac.sagemath.org/ticket/31702





---

archive/issue_comments_450057.json:
```json
{
    "body": "As long as you don't break #30954, it should be fine.\n\nIt is somehow inherited from vectors, which does lexicographic comparison. Indeed you can make this comparison consistent by using rich comparison on the types, if the types differ. I don't need it, but I don't mind it either.\n\nI would consider it to be bad practice to rely on an `NotImplementedError`, because it is somehow a deprecation message by itself implicitly telling you \"this might change in the future\".",
    "created_at": "2021-04-20T12:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450057",
    "user": "@kliem"
}
```

As long as you don't break #30954, it should be fine.

It is somehow inherited from vectors, which does lexicographic comparison. Indeed you can make this comparison consistent by using rich comparison on the types, if the types differ. I don't need it, but I don't mind it either.

I would consider it to be bad practice to rely on an `NotImplementedError`, because it is somehow a deprecation message by itself implicitly telling you "this might change in the future".



---

archive/issue_comments_450058.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-04-20T16:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450058",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_450059.json:
```json
{
    "body": "if you add author name and set it to \"needs review\", the patchbot will run it",
    "created_at": "2021-04-20T16:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450059",
    "user": "@mkoeppe"
}
```

if you add author name and set it to "needs review", the patchbot will run it



---

archive/issue_comments_450060.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-20T18:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450060",
    "user": "@yuan-zhou"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_450061.json:
```json
{
    "body": "This needs doctests that illustrate the new behavior.",
    "created_at": "2021-04-21T01:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450061",
    "user": "@mkoeppe"
}
```

This needs doctests that illustrate the new behavior.



---

archive/issue_comments_450062.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-21T01:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450062",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_450063.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-21T08:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450063",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_450064.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-21T08:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450064",
    "user": "@yuan-zhou"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_450065.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-21T17:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450065",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_450066.json:
```json
{
    "body": "The wording \"Check :trac:`31702`\" suggests that this is a test for a bug -- but this ticket adds a feature, rather than fixing a bug.\n\nIt would be better to reword it so that it becomes part of the documentation of the sorting order. There is no need to refer to a ticket number for non-bugfix tickets.",
    "created_at": "2021-04-21T17:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450066",
    "user": "@mkoeppe"
}
```

The wording "Check :trac:`31702`" suggests that this is a test for a bug -- but this ticket adds a feature, rather than fixing a bug.

It would be better to reword it so that it becomes part of the documentation of the sorting order. There is no need to refer to a ticket number for non-bugfix tickets.



---

archive/issue_comments_450067.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-21T17:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450067",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_450068.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-21T17:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450068",
    "user": "@yuan-zhou"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_450069.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-22T16:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450069",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_450070.json:
```json
{
    "body": "The documentation only explains when two objects are equal.",
    "created_at": "2021-04-22T16:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450070",
    "user": "@mkoeppe"
}
```

The documentation only explains when two objects are equal.



---

archive/issue_comments_450071.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-24T05:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450071",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_450072.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-24T05:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450072",
    "user": "@yuan-zhou"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_450073.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-24T06:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450073",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_450074.json:
```json
{
    "body": "LGTM.",
    "created_at": "2021-04-24T06:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450074",
    "user": "@mkoeppe"
}
```

LGTM.



---

archive/issue_comments_450075.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-21T21:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31465#issuecomment-450075",
    "user": "@vbraun"
}
```

Resolution: fixed
