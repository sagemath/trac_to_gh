# Issue 31228: Division with remainder for univariate polynomial matrices

Issue created by migration from https://trac.sagemath.org/ticket/31465

Original creator: @vneiger

Original creation time: 2021-03-07 20:22:22

CC:  @ke456

Keywords: polynomial matrix; division with remainder

New functionality: division with remainder for matrices over the univariate polynomials. The existing functions for weak Popov form, and the forthcoming functions for Popov form and truncated matrix inverse expansions, should allow to easily add this tool, in good generality:
* left division or right division,
* core tool: handling a divisor matrix in square, nonsingular, reduced form (column reduced if right division),
* general case (rectangular, arbitrary-rank divisor) reducing to the core tool via computing the Popov form and the associated transformation.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by git created at 2021-08-02 08:46:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-08-02 23:38:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-08-04 09:46:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-08-04 11:14:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vneiger created at 2021-08-04 11:16:37

Changing status from new to needs_review.


---

Comment by @vneiger created at 2021-08-04 11:16:37

Functionalities are done, as expected, with an extra method for ``reduce`` in order to provide this directly to the user. Documentation is written, along with many tests.

There might still be some minor doc improvements to do, but a first round of review could be useful at this stage.


---

Comment by @vneiger created at 2021-08-04 21:59:44

Kevin agreed to review the ticket.


---

Comment by @vneiger created at 2021-08-04 21:59:44

Set assignee to @ke456.


---

Comment by git created at 2021-08-07 16:44:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vneiger created at 2021-08-07 16:47:37

After small fixes and improvements in the documentation and examples, this is ready for review. One question: is the doc clear enough on the use of `reduce` for `right_quo_rem` in the third situation described in the function documentation? Should it be better if more detailed, or less detailed? Thanks.


---

Comment by @ke456 created at 2021-08-08 00:27:48

The documentation and tests look good. To answer the question above, I think it's the use of reduce is clear and well outlined. However, the approach of using the appropriate shifts should be verified.


---

Comment by @vneiger created at 2021-08-08 16:35:07

Ok, I just checked the details (unfortunately I am not aware of a reference for this), and here is the proof of correctness.

Starting from any pair of matrices `A` and `B` with the same number of columns (recall `A` is `self`), we want to prove that: there is a "valid remainder `R`" in the division of `A` by `B` if and only if the `s`-normal form of `A` with respect to `B` is such a valid remainder, for the shift `s` chosen as the negation of the column degrees of `B`. Recall that "valid remainder" means that `A = QB + R` for some matrices `Q` and `R` and `R` has column degrees (strictly) bounded from above by the column degrees of `B`, or equivalently, `R` has (strictly) negative `s`-row degree.

Without loss of generality we can prove this for the case of a vector `A`, instead of a matrix (just apply the following argument to each row separately).

* First case: there is no valid remainder. Then, obviously, the `s`-normal form of `A` cannot be a valid remainder.
* Second case: there is a valid remainder. That means we can write `A = QB + R` with `R` having negative `s`-row degree. We want to prove that the `s`-normal form `N` of `A` with respect to `B` is also a valid remainder, i.e. `N` has negative `s`-row degree. If `N` has `s`-row degree smaller than or equal to that of `R`, then the conclusion follows by definition of `R`. Now assume `N` has `s`-row degree strictly larger than that of `R`. So the `s`-row degree and `s`-leading position of `N-R` are equal respectively to `s`-row degree and `s`-leading position of `N`. On the other hand, since both `R` and `N` are equal up to a left-multiple of `B`, `N-R` is in the row space of `B`, so the `s`-leading position of `N-R` is among the `s`-leading positions of the rows of the `s`-Popov form `P` of `B` (this is a consequence of the extended predictable degree property). This means that the `s`-leading position of `N` is among the `s`-leading positions of the rows of `P`; and since `N` is reduced modulo `P`, the `s`-row degree of `N` is less than the `s`-row degree of the row of `P` having that same `s`-leading position. Since `P` is the `s`-Popov form of `B`, and the `s`-row degree of `B` is uniformly zero, `P` has nonpositive `s`-row degree, and therefore `N` has negative `s`-row degree, which contradicts our assumption.


---

Comment by @ke456 created at 2021-08-08 16:43:35

Changing status from needs_review to positive_review.


---

Comment by @ke456 created at 2021-08-08 16:43:35

I have not read the proof in great detail, but it seems correct. With this, I believe the goal of the ticket has been met.


---

Comment by git created at 2021-08-08 20:14:25

Changing status from positive_review to needs_review.


---

Comment by git created at 2021-08-08 20:14:25

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @vneiger created at 2021-08-08 20:17:41

Thanks for reviewing. I see there were minor issues with the doc code style (if I understood the log correctly). This commit tries to fix this.


---

Comment by @vneiger created at 2021-08-08 22:28:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-08-29 09:37:40

Resolution: fixed
