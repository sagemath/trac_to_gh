# Issue 22920: py3: some work on cmp in geometry folder

Issue created by migration from https://trac.sagemath.org/ticket/23157

Original creator: chapoton

Original creation time: 2017-06-07 12:58:45

CC:  tscrim jdemeyer jhpalmieri

as another step towards py3 comparison


---

Comment by chapoton created at 2017-06-07 12:59:06

New commits:


---

Comment by chapoton created at 2017-06-12 12:15:45

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-06-12 12:19:14

Are you forgetting #23103?


---

Comment by jdemeyer created at 2017-06-12 12:20:06

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-06-12 12:23:09

This

```
        c = cmp(self.ambient_dim(), other.ambient_dim())
        if c != 0: return c
```

and this

```
        if self.ambient_dim() != other.ambient_dim():
            return False
```

are not equivalent.

And this is also dubious:

```
        if self._Vrepresentation is None or other._Vrepresentation is None:
            return False   # make sure deleted polyhedra are not used in cache
```

I wonder if an exception would be better here.


---

Comment by git created at 2017-06-12 13:56:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-06-12 14:10:52

better like that ?


---

Comment by chapoton created at 2017-06-12 14:10:52

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-06-13 14:12:05

bot is green, please review


---

Comment by chapoton created at 2017-06-16 14:04:42

ping ?


---

Comment by jhpalmieri created at 2017-06-16 21:48:43

Can we restore this doctest?

```diff
diff --git a/src/sage/geometry/hyperplane_arrangement/arrangement.py b/src/sage/geometry/hyperplane_arrangement/arrangement.py
index 6b5b6393ae..0e742392c7 100644
--- a/src/sage/geometry/hyperplane_arrangement/arrangement.py
+++ b/src/sage/geometry/hyperplane_arrangement/arrangement.py
@@ -557,6 +557,8 @@ class HyperplaneArrangementElement(Element):
             sage: H.<x,y,z> = HyperplaneArrangements(QQ)
             sage: H(x) == H(y)
             False
+            sage: H(x) == 0
+            False
         """
         return richcmp(self._hyperplanes, other._hyperplanes, op)
 
```

Also, I hope the exception that you've added is what Jeroen had in mind. Do we ever expect to see that exception? Can we add a doctest for it? (I don't know anything about this code, so I don't know if `self._Vrepresentation` can ever by `None` if `self` has been properly initialized.)


---

Comment by git created at 2017-06-17 06:04:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-06-17 07:12:57

I have added the doctest you wanted.

For the raise message in case of None, I do no know the meaning of this line. I was tempted to just remove all that, but Jeroen did not agree. I think this is not worse than before, which was returning an arbitrary result.


---

Comment by chapoton created at 2017-06-19 17:13:03

Bot is green again. Is there anything else to do ?


---

Comment by jhpalmieri created at 2017-06-19 18:24:20

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2017-06-19 18:24:20

Okay, I think this is good now.


---

Comment by vbraun created at 2017-06-22 07:24:23

Resolution: fixed
