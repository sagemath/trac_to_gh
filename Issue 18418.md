# Issue 18418: MV Polytopes and PBW crystals

archive/issues_018418.json:
```json
{
    "body": "CC:  ptingley @bsalisbury1 @tscrim @anneschilling @dwbump\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18655\n\n",
    "created_at": "2015-06-09T16:31:33Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "MV Polytopes and PBW crystals",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18418",
    "user": "dmuthiah"
}
```
CC:  ptingley @bsalisbury1 @tscrim @anneschilling @dwbump



Issue created by migration from https://trac.sagemath.org/ticket/18655





---

archive/issue_comments_250153.json:
```json
{
    "body": "Changing keywords from \"\" to \"days65\".",
    "created_at": "2015-06-09T17:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250153",
    "user": "dmuthiah"
}
```

Changing keywords from "" to "days65".



---

archive/issue_comments_250154.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-06-09T17:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250154",
    "user": "dmuthiah"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_250155.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2015-06-11T17:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250155",
    "user": "@bsalisbury1"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_250156.json:
```json
{
    "body": "Changing keywords from \"days65\" to \"days65, sage-combinat,crystals\".",
    "created_at": "2015-06-11T17:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250156",
    "user": "@bsalisbury1"
}
```

Changing keywords from "days65" to "days65, sage-combinat,crystals".



---

archive/issue_comments_250157.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-11-13T04:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250157",
    "user": "@tscrim"
}
```

New commits:



---

archive/issue_comments_250158.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-02-23T21:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250158",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_250159.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-25T06:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250159",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250160.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T05:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250160",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250161.json:
```json
{
    "body": "Hey Peter and Dinakar,\n\nIt would be great if one or both of you would add some general documentation (in particular, a description of the model/crystal structure) and check that my changes are good with you. Also, if you could implement type G<sub>2</sub>, that would be appreciated; otherwise, we can set that to raise a `NotImplementedError` for the time being. That way we can get this merged into Sage.\n\nThanks,\nTravis",
    "created_at": "2016-03-05T15:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250161",
    "user": "@tscrim"
}
```

Hey Peter and Dinakar,

It would be great if one or both of you would add some general documentation (in particular, a description of the model/crystal structure) and check that my changes are good with you. Also, if you could implement type G<sub>2</sub>, that would be appreciated; otherwise, we can set that to raise a `NotImplementedError` for the time being. That way we can get this merged into Sage.

Thanks,
Travis



---

archive/issue_comments_250162.json:
```json
{
    "body": "Hi all,\n\nI have some questions about this code.  \n\n- I think that `.star()` is misbehaving.  Here is some evidence.  Consider \n\n```\nsage: MV = crystals.infinity.MVPolytopes(\"A2\")\nsage: p0 = MV.module_generators[0]\nsage: p = p0.f_string([1,2,1,2,2]); p\nMV polytope with Lusztig datum (0, 2, 1)\nsage: p.star()\nMV polytope with Lusztig datum (1, 2, 0)\n```\n\n   However, when I compute by hand (using the PBW rule from Kamnitzer's paper (based on the work of Lusztig and Berenstein-Zelevinsky)), I believe the resulting data should actually be `(2,0,3)`.  Using the PBW crystal code:\n\n```\nsage: B = crystals.infinity.PBW(\"A2\")\nsage: b0 = B.module_generators[0]\nsage: b = b0.f_string([1,2,1,2,2]); b\nPBW monomial with Lusztig datum (0, 2, 1)\nsage: b.lusztig_datum(word=[2,1,2])\n(3, 0, 2)\n```\n\n   The reversal of the last output should correspond to `p.star()`.  Moreover, when I check against some previously implemented *-crystal code, it also agrees with my calculation by hand:\n\n```\nsage: MVs = crystals.infinity.Star(MV)\nsage: ps = MVs.module_generators[0].f_string([1,2,1,2,2])\nsage: ps\nMV polytope with Lusztig datum (2, 0, 3)\n\nsage: Bs = crystals.infinity.Star(B)\nsage: bs = Bs.module_generators[0].f_string([1,2,1,2,2])\nsage: bs\nPBW monomial with Lusztig datum (2, 0, 3)\n```\n\n  Maybe I am misunderstanding how the *-operator is supposed to act?\n\n- Perhaps `braid_move_calculator.py` should go with the Coxeter group code.  I believe it is more robust than simply crystals code, and Coxeter group users may also find it beneficial.  \n\n- Is it possible initialize an MV polytope without applying a string of crystal operators from the highest weight?  If so, tests should be added that show this behavior.  If not, then it may be desirable to users if one could initialize an MV polytope using polytope vertices or from a Lusztig datum.\n\n- Less important, but maybe it may be a good idea to group `pbw_crystal.py` and `pbw_datum.py` into a single file.  They are closely related, so having less files in the crystals folder may be a good idea.  I do not feel very strongly about this, but it is something that came up.  \n\nThanks for working on this!!  This patch will be a spectacular addition to Sage when it is completed!",
    "created_at": "2016-04-15T15:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250162",
    "user": "@bsalisbury1"
}
```

Hi all,

I have some questions about this code.  

- I think that `.star()` is misbehaving.  Here is some evidence.  Consider 

```
sage: MV = crystals.infinity.MVPolytopes("A2")
sage: p0 = MV.module_generators[0]
sage: p = p0.f_string([1,2,1,2,2]); p
MV polytope with Lusztig datum (0, 2, 1)
sage: p.star()
MV polytope with Lusztig datum (1, 2, 0)
```

   However, when I compute by hand (using the PBW rule from Kamnitzer's paper (based on the work of Lusztig and Berenstein-Zelevinsky)), I believe the resulting data should actually be `(2,0,3)`.  Using the PBW crystal code:

```
sage: B = crystals.infinity.PBW("A2")
sage: b0 = B.module_generators[0]
sage: b = b0.f_string([1,2,1,2,2]); b
PBW monomial with Lusztig datum (0, 2, 1)
sage: b.lusztig_datum(word=[2,1,2])
(3, 0, 2)
```

   The reversal of the last output should correspond to `p.star()`.  Moreover, when I check against some previously implemented *-crystal code, it also agrees with my calculation by hand:

```
sage: MVs = crystals.infinity.Star(MV)
sage: ps = MVs.module_generators[0].f_string([1,2,1,2,2])
sage: ps
MV polytope with Lusztig datum (2, 0, 3)

sage: Bs = crystals.infinity.Star(B)
sage: bs = Bs.module_generators[0].f_string([1,2,1,2,2])
sage: bs
PBW monomial with Lusztig datum (2, 0, 3)
```

  Maybe I am misunderstanding how the *-operator is supposed to act?

- Perhaps `braid_move_calculator.py` should go with the Coxeter group code.  I believe it is more robust than simply crystals code, and Coxeter group users may also find it beneficial.  

- Is it possible initialize an MV polytope without applying a string of crystal operators from the highest weight?  If so, tests should be added that show this behavior.  If not, then it may be desirable to users if one could initialize an MV polytope using polytope vertices or from a Lusztig datum.

- Less important, but maybe it may be a good idea to group `pbw_crystal.py` and `pbw_datum.py` into a single file.  They are closely related, so having less files in the crystals folder may be a good idea.  I do not feel very strongly about this, but it is something that came up.  

Thanks for working on this!!  This patch will be a spectacular addition to Sage when it is completed!



---

archive/issue_comments_250163.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-17T14:42:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250163",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250164.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-12T21:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250164",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250165.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-04T00:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250165",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250166.json:
```json
{
    "body": "\n```\nFile \"src/sage/combinat/root_system/root_lattice_realizations.py\", line 3063, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?\nFailed example:\n    L.plot_fundamental_weights() + L.plot_mv_polytope(p)\nExpected:\n    Graphics object consisting of 14 graphics primitives\nGot:\n    Graphics object consisting of 11 graphics primitives\n**********************************************************************\nFile \"src/sage/combinat/root_system/root_lattice_realizations.py\", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?\nFailed example:\n    L.plot_mv_polytope(p)\nExpected nothing\nGot:\n    Graphics3d Object\n```\n",
    "created_at": "2016-10-04T09:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250166",
    "user": "@fchapoton"
}
```


```
File "src/sage/combinat/root_system/root_lattice_realizations.py", line 3063, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?
Failed example:
    L.plot_fundamental_weights() + L.plot_mv_polytope(p)
Expected:
    Graphics object consisting of 14 graphics primitives
Got:
    Graphics object consisting of 11 graphics primitives
**********************************************************************
File "src/sage/combinat/root_system/root_lattice_realizations.py", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?
Failed example:
    L.plot_mv_polytope(p)
Expected nothing
Got:
    Graphics3d Object
```




---

archive/issue_comments_250167.json:
```json
{
    "body": "Travis wrote the code for this function in root_lattice_realizations.py,\nso I want to double-check with him before changing the tests. Let me comment on the two failed tests. \n\n>File \"src/sage/combinat/root_system/root_lattice_realizations.py\", line 3063, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?\n>Failed example:\n>    L.plot_fundamental_weights() + L.plot_mv_polytope(p)\n>Expected:\n>    Graphics object consisting of 14 graphics primitives\n>Got:\n>    Graphics object consisting of 11 graphics primitives\n\nThis error is because the tropical Plucker relations for B2 and C2 were incorrectly switched before. I've fixed this, and the test should be changed.\n\n>File \"src/sage/combinat/root_system/root_lattice_realizations.py\", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?\n>Failed example:\n>    L.plot_mv_polytope(p)\n>Expected nothing\n>Got:\n>    Graphics3d Object\n\nI don't know what should be the correct behavior here. When I try to run each of these tests in the repl by hand it complains that I don't have jmol installed. What is the doctest doing differently?",
    "created_at": "2016-10-04T21:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250167",
    "user": "dmuthiah"
}
```

Travis wrote the code for this function in root_lattice_realizations.py,
so I want to double-check with him before changing the tests. Let me comment on the two failed tests. 

>File "src/sage/combinat/root_system/root_lattice_realizations.py", line 3063, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?
>Failed example:
>    L.plot_fundamental_weights() + L.plot_mv_polytope(p)
>Expected:
>    Graphics object consisting of 14 graphics primitives
>Got:
>    Graphics object consisting of 11 graphics primitives

This error is because the tropical Plucker relations for B2 and C2 were incorrectly switched before. I've fixed this, and the test should be changed.

>File "src/sage/combinat/root_system/root_lattice_realizations.py", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?
>Failed example:
>    L.plot_mv_polytope(p)
>Expected nothing
>Got:
>    Graphics3d Object

I don't know what should be the correct behavior here. When I try to run each of these tests in the repl by hand it complains that I don't have jmol installed. What is the doctest doing differently?



---

archive/issue_comments_250168.json:
```json
{
    "body": "Replying to [comment:15 dmuthiah]:\n> >File \"src/sage/combinat/root_system/root_lattice_realizations.py\", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?\n> >Failed example:\n> >    L.plot_mv_polytope(p)\n> >Expected nothing\n> >Got:\n> >    Graphics3d Object\n> \n> I don't know what should be the correct behavior here. When I try to run each of these tests in the repl by hand it complains that I don't have jmol installed. What is the doctest doing differently?\n\nThis doctest would normally try to open JMol, but in order to avoid this, in doctest mode (i.e., running `sage -t filename.py`) we just print out `Graphics3d Object`. It is a straightforward change.",
    "created_at": "2016-10-04T21:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250168",
    "user": "@tscrim"
}
```

Replying to [comment:15 dmuthiah]:
> >File "src/sage/combinat/root_system/root_lattice_realizations.py", line 3072, in sage.combinat.root_system.root_lattice_realizations.RootLatticeRealizations.ParentMethods.?
> >Failed example:
> >    L.plot_mv_polytope(p)
> >Expected nothing
> >Got:
> >    Graphics3d Object
> 
> I don't know what should be the correct behavior here. When I try to run each of these tests in the repl by hand it complains that I don't have jmol installed. What is the doctest doing differently?

This doctest would normally try to open JMol, but in order to avoid this, in doctest mode (i.e., running `sage -t filename.py`) we just print out `Graphics3d Object`. It is a straightforward change.



---

archive/issue_comments_250169.json:
```json
{
    "body": "Thank you Dinakar for adding the G<sub>2</sub> case. I plan to look at it in detail and take care of Ben's comments. Modulo Ben's comments, this should be ready for review, correct?",
    "created_at": "2016-10-04T21:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250169",
    "user": "@tscrim"
}
```

Thank you Dinakar for adding the G<sub>2</sub> case. I plan to look at it in detail and take care of Ben's comments. Modulo Ben's comments, this should be ready for review, correct?



---

archive/issue_comments_250170.json:
```json
{
    "body": "You've (re)introduced a mixup between type B<sub>n</sub> and C<sub>n</sub> with [a81b213](https://git.sagemath.org/sage.git/commit/?id=a81b2134f04acc6abcccf49284be7c5c1f6d3be3):\n\n```\nsage: G = crystals.infinity.PBW(['B',3]).subcrystal(max_depth=7).digraph()\nsage: Gp = crystals.infinity.Tableaux(['C',3]).subcrystal(max_depth=7).digraph()\nsage: Gp.is_isomorphic(G, edge_labels=True)\nTrue\n```\n\nThere also seems to be too many vertices for type G<sub>2</sub>:\n\n```\nsage: G = crystals.infinity.PBW(['G',2]).subcrystal(max_depth=7).digraph()\nsage: G\nDigraph on 137 vertices\nsage: Gp = crystals.infinity.Tableaux(['G',2]).subcrystal(max_depth=7).digraph()\nsage: Gp\nDigraph on 116 vertices\n```\n",
    "created_at": "2016-10-09T17:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250170",
    "user": "@tscrim"
}
```

You've (re)introduced a mixup between type B<sub>n</sub> and C<sub>n</sub> with [a81b213](https://git.sagemath.org/sage.git/commit/?id=a81b2134f04acc6abcccf49284be7c5c1f6d3be3):

```
sage: G = crystals.infinity.PBW(['B',3]).subcrystal(max_depth=7).digraph()
sage: Gp = crystals.infinity.Tableaux(['C',3]).subcrystal(max_depth=7).digraph()
sage: Gp.is_isomorphic(G, edge_labels=True)
True
```

There also seems to be too many vertices for type G<sub>2</sub>:

```
sage: G = crystals.infinity.PBW(['G',2]).subcrystal(max_depth=7).digraph()
sage: G
Digraph on 137 vertices
sage: Gp = crystals.infinity.Tableaux(['G',2]).subcrystal(max_depth=7).digraph()
sage: Gp
Digraph on 116 vertices
```




---

archive/issue_comments_250171.json:
```json
{
    "body": "doc does not build, see bot's report\n\n```\nsage/combinat/crystals/pbw_datum.py:\ndocstring of sage.combinat.crystals.pbw_datum.tropical_plucker_relation:24:\nERROR: Unexpected indentation.\n```\n",
    "created_at": "2016-10-11T08:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250171",
    "user": "@fchapoton"
}
```

doc does not build, see bot's report

```
sage/combinat/crystals/pbw_datum.py:
docstring of sage.combinat.crystals.pbw_datum.tropical_plucker_relation:24:
ERROR: Unexpected indentation.
```




---

archive/issue_comments_250172.json:
```json
{
    "body": "Replying to [comment:18 tscrim]:\n> You've (re)introduced a mixup between type B<sub>n</sub> and C<sub>n</sub> with [a81b213](https://git.sagemath.org/sage.git/commit/?id=a81b2134f04acc6abcccf49284be7c5c1f6d3be3):\nOkay, I will try to sort this out.\n\n> {{{\n> sage: G = crystals.infinity.PBW(['B',3]).subcrystal(max_depth=7).digraph()\n> sage: Gp = crystals.infinity.Tableaux(['C',3]).subcrystal(max_depth=7).digraph()\n> sage: Gp.is_isomorphic(G, edge_labels=True)\n> True\n> }}}\n> There also seems to be too many vertices for type G<sub>2</sub>:\n> {{{\n> sage: G = crystals.infinity.PBW(['G',2]).subcrystal(max_depth=7).digraph()\n> sage: G\n> Digraph on 137 vertices\n> sage: Gp = crystals.infinity.Tableaux(['G',2]).subcrystal(max_depth=7).digraph()\n> sage: Gp\n> Digraph on 116 vertices\n> }}}\nI will look into this. Mainly I will check if I've made a transcription error from Berenstein-Zelevinsky. Unfortunately, if there is a typo in the Berenstein-Zelevinsky reference, finding the correct formulas will be a difficult task.",
    "created_at": "2016-10-11T15:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250172",
    "user": "dmuthiah"
}
```

Replying to [comment:18 tscrim]:
> You've (re)introduced a mixup between type B<sub>n</sub> and C<sub>n</sub> with [a81b213](https://git.sagemath.org/sage.git/commit/?id=a81b2134f04acc6abcccf49284be7c5c1f6d3be3):
Okay, I will try to sort this out.

> {{{
> sage: G = crystals.infinity.PBW(['B',3]).subcrystal(max_depth=7).digraph()
> sage: Gp = crystals.infinity.Tableaux(['C',3]).subcrystal(max_depth=7).digraph()
> sage: Gp.is_isomorphic(G, edge_labels=True)
> True
> }}}
> There also seems to be too many vertices for type G<sub>2</sub>:
> {{{
> sage: G = crystals.infinity.PBW(['G',2]).subcrystal(max_depth=7).digraph()
> sage: G
> Digraph on 137 vertices
> sage: Gp = crystals.infinity.Tableaux(['G',2]).subcrystal(max_depth=7).digraph()
> sage: Gp
> Digraph on 116 vertices
> }}}
I will look into this. Mainly I will check if I've made a transcription error from Berenstein-Zelevinsky. Unfortunately, if there is a typo in the Berenstein-Zelevinsky reference, finding the correct formulas will be a difficult task.



---

archive/issue_comments_250173.json:
```json
{
    "body": "I see at least one transcription error: in `pi1`, it should be `t1+t2+2*t3+t4`.",
    "created_at": "2016-10-11T16:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250173",
    "user": "@tscrim"
}
```

I see at least one transcription error: in `pi1`, it should be `t1+t2+2*t3+t4`.



---

archive/issue_comments_250174.json:
```json
{
    "body": "Also, don't you have to translate, e.g., `3 t` into `t + 3`?",
    "created_at": "2016-10-11T16:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250174",
    "user": "@tscrim"
}
```

Also, don't you have to translate, e.g., `3 t` into `t + 3`?



---

archive/issue_comments_250175.json:
```json
{
    "body": "Another error: `3*pi2-pi2-pi4` should be `3*pi2-pi3-pi4`. Otherwise I think everything else matches.",
    "created_at": "2016-10-11T16:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250175",
    "user": "@tscrim"
}
```

Another error: `3*pi2-pi2-pi4` should be `3*pi2-pi3-pi4`. Otherwise I think everything else matches.



---

archive/issue_comments_250176.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-11T17:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250176",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250177.json:
```json
{
    "body": "Replying to [comment:22 tscrim]:\n> Also, don't you have to translate, e.g., `3 t` into `t + 3`?\n\nI think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.\n\nAbout the G2 errors: I also saw these two. I also fixed the B2<->C2 error.\n\nThe G2 case now matches the infinity tableau crystal with 116 nodes.",
    "created_at": "2016-10-11T17:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250177",
    "user": "dmuthiah"
}
```

Replying to [comment:22 tscrim]:
> Also, don't you have to translate, e.g., `3 t` into `t + 3`?

I think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.

About the G2 errors: I also saw these two. I also fixed the B2<->C2 error.

The G2 case now matches the infinity tableau crystal with 116 nodes.



---

archive/issue_comments_250178.json:
```json
{
    "body": "Replying to [comment:25 dmuthiah]:\n> Replying to [comment:22 tscrim]:\n> > Also, don't you have to translate, e.g., `3 t` into `t + 3`?\n> \n> I think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.\n> \n> About the G2 errors: I also saw these two. I also fixed the B2<->C2 error.\n> \n> The G2 case now matches the infinity tableau crystal with 116 nodes.\n> \n> \n\nI still didn't fix the documentation issue. I think it is an issue with the indentation for the REFERENCES.",
    "created_at": "2016-10-11T17:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250178",
    "user": "dmuthiah"
}
```

Replying to [comment:25 dmuthiah]:
> Replying to [comment:22 tscrim]:
> > Also, don't you have to translate, e.g., `3 t` into `t + 3`?
> 
> I think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.
> 
> About the G2 errors: I also saw these two. I also fixed the B2<->C2 error.
> 
> The G2 case now matches the infinity tableau crystal with 116 nodes.
> 
> 

I still didn't fix the documentation issue. I think it is an issue with the indentation for the REFERENCES.



---

archive/issue_comments_250179.json:
```json
{
    "body": "The error probably comes from a missing whiteline after\n\n```\nREFERENCES:\n```\n",
    "created_at": "2016-10-11T19:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250179",
    "user": "@fchapoton"
}
```

The error probably comes from a missing whiteline after

```
REFERENCES:
```




---

archive/issue_comments_250180.json:
```json
{
    "body": "Replying to [comment:25 dmuthiah]:\n> Replying to [comment:22 tscrim]:\n> > Also, don't you have to translate, e.g., `3 t` into `t + 3`?\n> \n> I think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.\n\nAh, right.\n\n> About the G2 errors: I also saw these two. I also fixed the B2<->C2 error.\n> \n> The G2 case now matches the infinity tableau crystal with 116 nodes.\n\nGreat! Thank you for adding this. I can work on Ben's and Fr\u00e9d\u00e9ric's comments.",
    "created_at": "2016-10-11T19:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250180",
    "user": "@tscrim"
}
```

Replying to [comment:25 dmuthiah]:
> Replying to [comment:22 tscrim]:
> > Also, don't you have to translate, e.g., `3 t` into `t + 3`?
> 
> I think you interpret 3t as t+t+t, which you tropicalize to min(t,t,t)=t.

Ah, right.

> About the G2 errors: I also saw these two. I also fixed the B2<->C2 error.
> 
> The G2 case now matches the infinity tableau crystal with 116 nodes.

Great! Thank you for adding this. I can work on Ben's and Frédéric's comments.



---

archive/issue_comments_250181.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-11T21:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250181",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250182.json:
```json
{
    "body": "I also fixed the one in comment:21, but now it works up to depth 15. So I am satisfied.",
    "created_at": "2016-10-11T21:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250182",
    "user": "@tscrim"
}
```

I also fixed the one in comment:21, but now it works up to depth 15. So I am satisfied.



---

archive/issue_comments_250183.json:
```json
{
    "body": "However, if you (or Peter) could take care of the star involution issue; see comment:9. I can take care of the rest.",
    "created_at": "2016-10-11T21:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250183",
    "user": "@tscrim"
}
```

However, if you (or Peter) could take care of the star involution issue; see comment:9. I can take care of the rest.



---

archive/issue_comments_250184.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-08T18:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250184",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250185.json:
```json
{
    "body": "see patchbot report:\n\n* many failing doctests\n\n* do not use xrange\n\n* do not use cmp()\n\n* doc still does not build",
    "created_at": "2016-11-09T16:20:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250185",
    "user": "@fchapoton"
}
```

see patchbot report:

* many failing doctests

* do not use xrange

* do not use cmp()

* doc still does not build



---

archive/issue_comments_250186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-11T21:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250186",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250187.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-14T00:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250187",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250188.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-14T01:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250188",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250189.json:
```json
{
    "body": "I moved the `braid_move_calculator` to the `root_system` folder as that is the closest place for Coxeter groups currently. I also fixed the failing doctests and removed the `cmp`. I moved the reference to the big master file. Lastly, I cythonized `pbw_datum.py`, which led to a 4x speedup when computing the entire subcrystal.",
    "created_at": "2016-11-14T01:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250189",
    "user": "@tscrim"
}
```

I moved the `braid_move_calculator` to the `root_system` folder as that is the closest place for Coxeter groups currently. I also fixed the failing doctests and removed the `cmp`. I moved the reference to the big master file. Lastly, I cythonized `pbw_datum.py`, which led to a 4x speedup when computing the entire subcrystal.



---

archive/issue_comments_250190.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-14T03:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250190",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250191.json:
```json
{
    "body": "I believe the only issue left is to deal with the star.",
    "created_at": "2016-11-14T03:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250191",
    "user": "@tscrim"
}
```

I believe the only issue left is to deal with the star.



---

archive/issue_comments_250192.json:
```json
{
    "body": "doc does not build, because of a bad reference to the old location of braid_move_calculator",
    "created_at": "2016-11-14T19:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250192",
    "user": "@fchapoton"
}
```

doc does not build, because of a bad reference to the old location of braid_move_calculator



---

archive/issue_comments_250193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-14T21:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250193",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250194.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-15T16:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250194",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250195.json:
```json
{
    "body": "Okay, I've fixed the star involution issue: it just needed a twisting by the diagram automorphism induced from the w<sub>0</sub> action.",
    "created_at": "2016-11-15T16:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250195",
    "user": "@tscrim"
}
```

Okay, I've fixed the star involution issue: it just needed a twisting by the diagram automorphism induced from the w<sub>0</sub> action.



---

archive/issue_comments_250196.json:
```json
{
    "body": "So I believe this is at the needs review stage.",
    "created_at": "2016-11-15T16:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250196",
    "user": "@tscrim"
}
```

So I believe this is at the needs review stage.



---

archive/issue_comments_250197.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-11-15T16:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250197",
    "user": "@tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_250198.json:
```json
{
    "body": "one doctest trivially failing",
    "created_at": "2016-11-16T07:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250198",
    "user": "@fchapoton"
}
```

one doctest trivially failing



---

archive/issue_comments_250199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-16T15:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250199",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250200.json:
```json
{
    "body": "Hi all,\n\nI'm in the process of reviewing this and I have some comments/concerns, mostly about the documentation.\n\n- Dinakar's name should be added to the top of the `mv_polytopes.py` file as the initial author.\n- Dinakar's (preferred) email should be added to the copyright of each file.\n- Background information on the crystal of MV polytopes needs to be added to the documentation.  Also, even though the attributes seem to inherit from the PBW crystal, it still may be beneficial to the user to include element attributes for an MV polytope in its documentation.  In particular, `.star()` and `.lusztig_datum()` should be added.\n- Background information on the PBW crystal needs to be added to the documentation.\n- Documentation for `braid_move_calculator.py` needs to be linked from the `Root_System` page.\n- Should the `pbw_datum.pyx` documentation be linked somewhere?  \n\nAlso, one question I brought up earlier in comment:9: is it possible/advantageous to define an MV polytope using a Lusztig datum, or using vertices, or something else than generating one from the highest weight polytope?  For example, being able to do this would be great:\n\n\n```\nsage: PBW = crystals.infinity.PBW(\"C2\")\nsage: PBW.set_default_long_word([1,2,1,2])\nsage: b = PBW((1,2,1,2),(3,5,2,1))\nsage: MV = crystals.infinity.MVPolytopes(\"C2\")\nsage: p = MV(b)\n```\n\n\nOther than these comments, I think the patch is ready to go.  I'm happy to read over the changes/additions once their finished!  It'll be great to get this merged!\n\nThanks Dinakar (and Travis) for getting this finished!\n\np.s. Typo in PBW crystal documentation: \"Plucker\" --> \"Pl\\\"{u}cker\"",
    "created_at": "2016-11-21T01:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250200",
    "user": "@bsalisbury1"
}
```

Hi all,

I'm in the process of reviewing this and I have some comments/concerns, mostly about the documentation.

- Dinakar's name should be added to the top of the `mv_polytopes.py` file as the initial author.
- Dinakar's (preferred) email should be added to the copyright of each file.
- Background information on the crystal of MV polytopes needs to be added to the documentation.  Also, even though the attributes seem to inherit from the PBW crystal, it still may be beneficial to the user to include element attributes for an MV polytope in its documentation.  In particular, `.star()` and `.lusztig_datum()` should be added.
- Background information on the PBW crystal needs to be added to the documentation.
- Documentation for `braid_move_calculator.py` needs to be linked from the `Root_System` page.
- Should the `pbw_datum.pyx` documentation be linked somewhere?  

Also, one question I brought up earlier in comment:9: is it possible/advantageous to define an MV polytope using a Lusztig datum, or using vertices, or something else than generating one from the highest weight polytope?  For example, being able to do this would be great:


```
sage: PBW = crystals.infinity.PBW("C2")
sage: PBW.set_default_long_word([1,2,1,2])
sage: b = PBW((1,2,1,2),(3,5,2,1))
sage: MV = crystals.infinity.MVPolytopes("C2")
sage: p = MV(b)
```


Other than these comments, I think the patch is ready to go.  I'm happy to read over the changes/additions once their finished!  It'll be great to get this merged!

Thanks Dinakar (and Travis) for getting this finished!

p.s. Typo in PBW crystal documentation: "Plucker" --> "Pl\"{u}cker"



---

archive/issue_comments_250201.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-16T22:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250201",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250202.json:
```json
{
    "body": "This should take care of all of [comment:47 Ben's comments]. I don't think we should add in `star` and `lusztig_datum` because they can be easily found in the superclass's documentation and are already there from the interactive command line. We have `pbw_datum.pyx` in the combinat module list, but I don't think we need to link it from elsewhere since it is an implementation detail. Hopefully we can (finally) get this merged.",
    "created_at": "2017-04-16T22:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250202",
    "user": "@tscrim"
}
```

This should take care of all of [comment:47 Ben's comments]. I don't think we should add in `star` and `lusztig_datum` because they can be easily found in the superclass's documentation and are already there from the interactive command line. We have `pbw_datum.pyx` in the combinat module list, but I don't think we need to link it from elsewhere since it is an implementation detail. Hopefully we can (finally) get this merged.



---

archive/issue_comments_250203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-30T22:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250203",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250204.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-30T22:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250204",
    "user": "@bsalisbury1"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_250205.json:
```json
{
    "body": "Thank you! :D",
    "created_at": "2017-04-30T22:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250205",
    "user": "@tscrim"
}
```

Thank you! :D



---

archive/issue_comments_250206.json:
```json
{
    "body": "PDF docs don't bulid",
    "created_at": "2017-05-03T06:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250206",
    "user": "@vbraun"
}
```

PDF docs don't bulid



---

archive/issue_comments_250207.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-03T06:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250207",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_250208.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-03T16:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250208",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250209.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-05-03T16:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250209",
    "user": "@tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_250210.json:
```json
{
    "body": "Fixed; pdf doc now builds for me.",
    "created_at": "2017-05-03T16:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250210",
    "user": "@tscrim"
}
```

Fixed; pdf doc now builds for me.



---

archive/issue_comments_250211.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-08T21:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18418#issuecomment-250211",
    "user": "@vbraun"
}
```

Resolution: fixed
