# Issue 32653: Unstable doctest in hmm/chmm.pyx

Issue created by migration from https://trac.sagemath.org/ticket/32890

Original creator: @kliem

Original creation time: 2021-11-17 16:16:40

CC:  mjo

Part of #32544:


```
sage -t --long --warn-long 42.1 --random-seed=30462179883676183063850454726642654182 src/sage/stats/hmm/chmm.pyx
**********************************************************************
File "src/sage/stats/hmm/chmm.pyx", line 136, in sage.stats.hmm.chmm.GaussianHiddenMarkovModel
Failed example:
    try:
        p, s = m.baum_welch(obs)
        assert p > log_likelihood
        assert (4 <= s < 200)
    except RuntimeError:
        pass
Exception raised:
    Traceback (most recent call last):
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.stats.hmm.chmm.GaussianHiddenMarkovModel[12]>", line 4, in <module>
        assert (Integer(4) <= s < Integer(200))
    AssertionError
**********************************************************************
1 item had failures:
   1 of  15 in sage.stats.hmm.chmm.GaussianHiddenMarkovModel
    [119 tests, 1 failure, 0.53 s]
```



---

Comment by mjo created at 2021-12-29 12:48:17

The return value `s` here is a number of iterations, and should probably lie between zero (or maybe one) and the `max_iter` of the `baum_welch()` method, inclusive.


---

Comment by mjo created at 2021-12-29 18:48:29

Changing status from new to needs_review.


---

Comment by mjo created at 2021-12-29 18:48:29

Last 10 new commits:


---

Comment by @mwageringel created at 2022-01-03 17:42:12

Changing status from needs_review to positive_review.


---

Comment by @mwageringel created at 2022-01-03 17:42:12

The last commit looks good to me. Let me add the dependency for completeness.


---

Comment by vbraun created at 2022-01-31 23:30:59

Resolution: fixed
