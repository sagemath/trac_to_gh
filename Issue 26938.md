# Issue 26938: fix spkg-configure.m4 for libffi

Issue created by migration from https://trac.sagemath.org/ticket/27175

Original creator: dimpase

Original creation time: 2019-01-30 14:47:46

CC:  jdemeyer embray

libffi upstream hides headers behind ABI-specific directories. On gentoo this leads to failing ./configure checks for ffi.h, as
autoconf by itself is not aware of it. 
See e.g. https://bugs.gentoo.org/643582
for details. A fix would be to call
pkg-config in case of failing checks for the header:

```
$ pkg-config --cflags libffi
-I/usr/lib64/libffi-3.3_rc0/include
```

More precisely, the right `PKG_...` autoconf macro.

On the other hand, this might be a gcc gentoo bug, as on Debian the location is still not /usr/include, but something including `x86_64` in its name, yet the compiler finds the header just fine.



---

Comment by embray created at 2019-01-31 12:30:04

This is already handled by #27114.


---

Comment by embray created at 2019-01-31 12:30:04

Resolution: duplicate
