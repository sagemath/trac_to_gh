# Issue 25426: py3: do not use isinstance(  ,file) in graph_list

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2018-06-26 07:09:52

CC:  embray jdemeyer fbissey




---

Comment by chapoton created at 2018-06-26 07:10:26

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-06-26 07:10:26

New commits:


---

Comment by vklein created at 2018-06-26 08:14:07

Set assignee to vklein.


---

Comment by chapoton created at 2018-06-26 09:55:17

green bot, please review


---

Comment by vklein created at 2018-06-26 09:56:23

I am on it.


---

Comment by vklein created at 2018-06-26 13:09:59

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-06-26 13:38:51

This will break with Python 2 `file` objects, which are not subclasses of `io.IOBase` (they still exist entirely outside the framework of the new `io` module, which I don't like very much but there are probably Reasons).

I believe much of the code in this module would benefit from some duck-typing instead.  I might have already done that in my Python 3 branch--I remember looking at this module before--but I'm not sure.


---

Comment by embray created at 2018-06-26 13:38:51

Changing status from positive_review to needs_work.


---

Comment by embray created at 2018-06-26 13:47:06

Heh, the docstring for `from_whatever` is pretty brazen too


```
-  ``data`` - can be a string, a list of strings, or a
   file stream, or whatever.
```


except not "whatever", because if it's passed anything but a string, a list, or a file it silently returns `None` :/


---

Comment by embray created at 2018-06-26 13:48:15

Indeed, I already had some updates to this file in my python3 branch, but now that I look at it it wasn't even enough.


---

Comment by vklein created at 2018-06-26 13:49:17

Remove assignee vklein.


---

Comment by embray created at 2018-06-27 10:36:18

FWIW here's my branch if you want to give it a try.  It's a bit more of an extensive refactoring (albeit maybe not worth the trouble--it's unclear how much those functions are actually used). But in the process it should work equally well on Python 2 and 3: https://git.sagemath.org/sage.git/diff/?h=u/embray/python3/ticket-25663&id=31bc055dd9f7c8ffe80701b496880b6586cd5b4b&id2=develop


---

Comment by chapoton created at 2018-07-24 19:54:19

New commits:


---

Comment by embray created at 2018-09-06 13:43:29

I rebased my branch and fixed a test failure on Python 2.  Frédéric, by setting my branch are you also giving this positive review?  Shall we wait for a patchbot again?


---

Comment by embray created at 2018-09-06 13:43:29

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-09-06 19:27:43

Let us wait for the patchbot, just launched mine on the task.


---

Comment by chapoton created at 2018-09-07 06:14:52

patchbot is not happy


---

Comment by chapoton created at 2018-09-07 06:14:52

Changing status from needs_review to needs_work.


---

Comment by embray created at 2018-09-07 09:20:11

Oh. It looks like for some reason I didn't push the commit that fixed the tests.


---

Comment by git created at 2018-09-07 09:21:31

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-09-07 09:22:17

For some reason I had the wrong default remote for that branch.


---

Comment by embray created at 2018-09-07 09:22:17

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-09-07 11:39:16

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-09-07 11:39:16

ok, now


---

Comment by embray created at 2018-09-07 12:13:11

Thank you!


---

Comment by vbraun created at 2018-09-09 07:38:44

Resolution: fixed
