# Issue 13635: Let lrcalc build as a shared library on Cygwin.

Issue created by migration from Trac.

Original creator: jpflori

Original creation time: 2012-12-17 15:44:38

Assignee: tbd

CC:  kcrisman dimpase nthiery

Keywords: lrcalc spkg

We need to pass the -no-undefined flag to libtool to build a shared library on Cygwin.

As lrcalc is now more or less dealt with by Sage developper the fix is directly implemented here and tracked in the hg history.

Nonetheless, this was reported upstream as well and should get integrated (i.e. an official release based on the one we distribute should be made).


---

Attachment

Spkg diff, for review only.


---

Comment by jpflori created at 2012-12-17 16:25:52

New spkg uploaded.

I've rerun autoreconf with recent versions of the tool as the current state of the build system looked messy (and trying to use Jeroen smart spkg to produce a minimal diff complained a little and produced something broken).

It works fine on Linux, I won't be able to check on Cygwin before this night or tomorrow.


---

Comment by jpflori created at 2012-12-17 16:25:52

Changing keywords from "lrcalc spkg" to "lrcalc spkg cygwin".


---

Comment by jpflori created at 2012-12-17 16:25:52

Changing status from new to needs_review.


---

Comment by jpflori created at 2012-12-17 17:20:41

Upstream is ready to distribute an alternative official package using autotools, in addition to the original one using a custom build system.

So I propose to wait for everybody to be happy with the spkg here, send it upstream, repackage it "properly" here and merge it.


---

Comment by nthiery created at 2012-12-17 22:18:54

I checked the changes in the diff, and am happy with them. Feel free to set a positive review on my behalf (I'll be offline the next couple days).


---

Comment by jpflori created at 2012-12-18 14:54:47

Just a confirmation that this works as expected on Cygwin.

After our discussion with upstream, I will remove tracking of the src directory from the spkg and repost a new spkg.
The src directory will now be tracked in a separate hg tree kept upstream.


---

Attachment

Spkg diff, for review only.


---

Comment by kcrisman created at 2012-12-18 15:39:13

Wait, did this not work right?  Or is this just an enhancement?  (I know there is a parent ticket, but I forget the number.)


---

Comment by jpflori created at 2012-12-18 15:42:10

It was not build as shared before.
I cannot say that the static archive produced was dysfunctional, I've not run the tests, so we can consider it an enhancement if not a defect.


---

Comment by jpflori created at 2013-02-08 10:04:27

Changing status from needs_review to needs_work.


---

Comment by jpflori created at 2013-02-08 10:04:27

There have been some minimal changes to the tarball posted upstream so we need to resync.


---

Comment by jpflori created at 2013-02-19 10:16:20

Changing status from needs_work to needs_review.


---

Comment by jpflori created at 2013-02-19 10:16:20

I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.

Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?


---

Attachment

Spkg diff, for review only.


---

Comment by dimpase created at 2013-02-19 11:29:47

Replying to [comment:10 jpflori]:
> I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.
> 
> Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?

It builds on cygwin, but fails tests. More precisely the following fails:

```
sage: from sage.libs.lcalc.lcalc_Lfunction import *
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-015a4f363123> in <module>()
----> 1 from sage.libs.lcalc.lcalc_Lfunction import *

ImportError: No such file or directory
sage:
```

Is it just me?


---

Comment by dimpase created at 2013-02-19 11:29:47

Changing status from needs_review to needs_info.


---

Comment by jpflori created at 2013-02-19 11:32:08

Didn't you mess lcalc and lrcalc together?


---

Comment by dimpase created at 2013-02-19 11:40:10

Changing status from needs_info to needs_review.


---

Comment by dimpase created at 2013-02-19 11:40:10

Replying to [comment:12 jpflori]:
> Didn't you mess lcalc and lrcalc together?
oops, indeed. lrcalc works. Positive review.


---

Comment by dimpase created at 2013-02-19 11:40:22

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-22 19:12:24

Resolution: fixed
