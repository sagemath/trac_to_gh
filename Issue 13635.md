# Issue 13635: Let lrcalc build as a shared library on Cygwin.

archive/issues_013635.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  kcrisman dimpase nthiery\n\nKeywords: lrcalc spkg\n\nWe need to pass the -no-undefined flag to libtool to build a shared library on Cygwin.\n\nAs lrcalc is now more or less dealt with by Sage developper the fix is directly implemented here and tracked in the hg history.\n\nNonetheless, this was reported upstream as well and should get integrated (i.e. an official release based on the one we distribute should be made).\n\nIssue created by migration from https://trac.sagemath.org/ticket/13839\n\n",
    "created_at": "2012-12-17T15:44:38Z",
    "labels": [
        "porting: Cygwin",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "Let lrcalc build as a shared library on Cygwin.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13635",
    "user": "jpflori"
}
```
Assignee: tbd

CC:  kcrisman dimpase nthiery

Keywords: lrcalc spkg

We need to pass the -no-undefined flag to libtool to build a shared library on Cygwin.

As lrcalc is now more or less dealt with by Sage developper the fix is directly implemented here and tracked in the hg history.

Nonetheless, this was reported upstream as well and should get integrated (i.e. an official release based on the one we distribute should be made).

Issue created by migration from https://trac.sagemath.org/ticket/13839





---

archive/issue_comments_168730.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6beta2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.diff) by jpflori created at 2012-12-17 16:22:09\n\nSpkg diff, for review only.",
    "created_at": "2012-12-17T16:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168730",
    "user": "jpflori"
}
```

Attachment [lrcalc-1.1.6beta2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.diff) by jpflori created at 2012-12-17 16:22:09

Spkg diff, for review only.



---

archive/issue_comments_168731.json:
```json
{
    "body": "New spkg uploaded.\n\nI've rerun autoreconf with recent versions of the tool as the current state of the build system looked messy (and trying to use Jeroen smart spkg to produce a minimal diff complained a little and produced something broken).\n\nIt works fine on Linux, I won't be able to check on Cygwin before this night or tomorrow.",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168731",
    "user": "jpflori"
}
```

New spkg uploaded.

I've rerun autoreconf with recent versions of the tool as the current state of the build system looked messy (and trying to use Jeroen smart spkg to produce a minimal diff complained a little and produced something broken).

It works fine on Linux, I won't be able to check on Cygwin before this night or tomorrow.



---

archive/issue_comments_168732.json:
```json
{
    "body": "Changing keywords from \"lrcalc spkg\" to \"lrcalc spkg cygwin\".",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168732",
    "user": "jpflori"
}
```

Changing keywords from "lrcalc spkg" to "lrcalc spkg cygwin".



---

archive/issue_comments_168733.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168733",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_168734.json:
```json
{
    "body": "Upstream is ready to distribute an alternative official package using autotools, in addition to the original one using a custom build system.\n\nSo I propose to wait for everybody to be happy with the spkg here, send it upstream, repackage it \"properly\" here and merge it.",
    "created_at": "2012-12-17T17:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168734",
    "user": "jpflori"
}
```

Upstream is ready to distribute an alternative official package using autotools, in addition to the original one using a custom build system.

So I propose to wait for everybody to be happy with the spkg here, send it upstream, repackage it "properly" here and merge it.



---

archive/issue_comments_168735.json:
```json
{
    "body": "I checked the changes in the diff, and am happy with them. Feel free to set a positive review on my behalf (I'll be offline the next couple days).",
    "created_at": "2012-12-17T22:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168735",
    "user": "nthiery"
}
```

I checked the changes in the diff, and am happy with them. Feel free to set a positive review on my behalf (I'll be offline the next couple days).



---

archive/issue_comments_168736.json:
```json
{
    "body": "Just a confirmation that this works as expected on Cygwin.\n\nAfter our discussion with upstream, I will remove tracking of the src directory from the spkg and repost a new spkg.\nThe src directory will now be tracked in a separate hg tree kept upstream.",
    "created_at": "2012-12-18T14:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168736",
    "user": "jpflori"
}
```

Just a confirmation that this works as expected on Cygwin.

After our discussion with upstream, I will remove tracking of the src directory from the spkg and repost a new spkg.
The src directory will now be tracked in a separate hg tree kept upstream.



---

archive/issue_comments_168737.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6beta2.2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.2.diff) by jpflori created at 2012-12-18 15:22:06\n\nSpkg diff, for review only.",
    "created_at": "2012-12-18T15:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168737",
    "user": "jpflori"
}
```

Attachment [lrcalc-1.1.6beta2.2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.2.diff) by jpflori created at 2012-12-18 15:22:06

Spkg diff, for review only.



---

archive/issue_comments_168738.json:
```json
{
    "body": "Wait, did this not work right?  Or is this just an enhancement?  (I know there is a parent ticket, but I forget the number.)",
    "created_at": "2012-12-18T15:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168738",
    "user": "kcrisman"
}
```

Wait, did this not work right?  Or is this just an enhancement?  (I know there is a parent ticket, but I forget the number.)



---

archive/issue_comments_168739.json:
```json
{
    "body": "It was not build as shared before.\nI cannot say that the static archive produced was dysfunctional, I've not run the tests, so we can consider it an enhancement if not a defect.",
    "created_at": "2012-12-18T15:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168739",
    "user": "jpflori"
}
```

It was not build as shared before.
I cannot say that the static archive produced was dysfunctional, I've not run the tests, so we can consider it an enhancement if not a defect.



---

archive/issue_comments_168740.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-08T10:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168740",
    "user": "jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_168741.json:
```json
{
    "body": "There have been some minimal changes to the tarball posted upstream so we need to resync.",
    "created_at": "2013-02-08T10:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168741",
    "user": "jpflori"
}
```

There have been some minimal changes to the tarball posted upstream so we need to resync.



---

archive/issue_comments_168742.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-19T10:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168742",
    "user": "jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_168743.json:
```json
{
    "body": "I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.\n\nNicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?",
    "created_at": "2013-02-19T10:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168743",
    "user": "jpflori"
}
```

I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.

Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?



---

archive/issue_comments_168744.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6.diff) by jpflori created at 2013-02-19 10:16:45\n\nSpkg diff, for review only.",
    "created_at": "2013-02-19T10:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168744",
    "user": "jpflori"
}
```

Attachment [lrcalc-1.1.6.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6.diff) by jpflori created at 2013-02-19 10:16:45

Spkg diff, for review only.



---

archive/issue_comments_168745.json:
```json
{
    "body": "Replying to [comment:10 jpflori]:\n> I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.\n> \n> Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?\n\nIt builds on cygwin, but fails tests. More precisely the following fails:\n\n```\nsage: from sage.libs.lcalc.lcalc_Lfunction import *\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-015a4f363123> in <module>()\n----> 1 from sage.libs.lcalc.lcalc_Lfunction import *\n\nImportError: No such file or directory\nsage:\n```\n\nIs it just me?",
    "created_at": "2013-02-19T11:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168745",
    "user": "dimpase"
}
```

Replying to [comment:10 jpflori]:
> I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.
> 
> Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?

It builds on cygwin, but fails tests. More precisely the following fails:

```
sage: from sage.libs.lcalc.lcalc_Lfunction import *
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-015a4f363123> in <module>()
----> 1 from sage.libs.lcalc.lcalc_Lfunction import *

ImportError: No such file or directory
sage:
```

Is it just me?



---

archive/issue_comments_168746.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-02-19T11:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168746",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_168747.json:
```json
{
    "body": "Didn't you mess lcalc and lrcalc together?",
    "created_at": "2013-02-19T11:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168747",
    "user": "jpflori"
}
```

Didn't you mess lcalc and lrcalc together?



---

archive/issue_comments_168748.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-02-19T11:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168748",
    "user": "dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_168749.json:
```json
{
    "body": "Replying to [comment:12 jpflori]:\n> Didn't you mess lcalc and lrcalc together?\noops, indeed. lrcalc works. Positive review.",
    "created_at": "2013-02-19T11:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168749",
    "user": "dimpase"
}
```

Replying to [comment:12 jpflori]:
> Didn't you mess lcalc and lrcalc together?
oops, indeed. lrcalc works. Positive review.



---

archive/issue_comments_168750.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-19T11:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168750",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_168751.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-22T19:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13635#issuecomment-168751",
    "user": "jdemeyer"
}
```

Resolution: fixed
