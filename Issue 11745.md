# Issue 11745: Memory leaks with LP Solvers

Issue created by migration from https://trac.sagemath.org/ticket/11917

Original creator: ncohen

Original creation time: 2011-10-12 14:17:17

Assignee: tbd

As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.

This patch solves it !

Nathann

Reported by Peter Mueller on :
https://groups.google.com/forum/?hl=fr#!topic/sage-support/QZZfhz4Kogs


---

Comment by ncohen created at 2011-10-12 14:19:03

Changing status from new to needs_review.


---

Attachment


---

Comment by ncohen created at 2011-10-12 16:01:58

Changing component from PLEASE CHANGE to linear programming.


---

Comment by zimmerma created at 2011-10-12 18:03:36

Changing type from PLEASE CHANGE to defect.


---

Comment by zimmerma created at 2011-10-12 18:08:23

Changing status from needs_review to needs_work.


---

Comment by zimmerma created at 2011-10-12 18:08:23

the patch fails to apply to 4.7.1:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Sage library. Current Mercurial branch is: 11917
sage: hg_sage.import_patch("/tmp/trac_11917.patch")
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg status
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg status
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg import   "/tmp/trac_11917.patch"
applying /tmp/trac_11917.patch
patching file sage/numerical/backends/coin_backend.pxd
Hunk #1 FAILED at 97
1 out of 1 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pxd.rej
patching file sage/numerical/backends/coin_backend.pyx
Hunk #3 FAILED at 986
1 out of 3 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pyx.rej
abort: patch failed to apply
```

Paul


---

Comment by leif created at 2011-10-12 19:59:40

Replying to [comment:4 zimmerma]:
> the patch fails to apply to 4.7.1:

That's most probably due to #11588, merged into Sage 4.7.2.alpha3.


---

Comment by zimmerma created at 2011-10-12 20:02:14

> That's most probably due to #11588, merged into Sage 4.7.2.alpha3.

if so it should be clearly indicated to which version the patch applies.

Paul


---

Comment by leif created at 2011-10-12 20:37:17

Patch also applies clean to Sage 4.7.2.alpha4.

IMHO all patches should in general be based on the latest _devel_ release (or at least still apply to it); an attachment comment stating on which version a patch is based is of course not bad, especially as time goes by.

I really don't understand why the patchbot still uses 4.7.1; as such, it is almost useless.  Worse, it reports failures for patches that apply (and work) well.  (And often hangs such that the HTTP connections for trac pages are kept open...)


---

Comment by leif created at 2011-10-12 20:37:17

Changing status from needs_work to needs_review.


---

Comment by leif created at 2011-10-12 21:14:36

Passes all (long) tests in `sage/numerical/`, and Peter Mueller's example (at first glance) doesn't eat up memory as it did before.

Haven't looked at the code though.


---

Comment by pmueller created at 2011-10-17 13:00:41

The patch installed fine in sage-4.7.2alpha, and passed all the tests in sage/numerical/

I ran my original program again which goes through thousands of different small ilp problems. The memory usage was basically constant, so the memory leak apparently is fixed.

As this patch just fixed a bug and didn't add new features, I guess it is save to close the ticket.

- Peter Mueller


---

Comment by pmueller created at 2011-10-17 13:00:41

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2011-10-17 13:04:11

Thaaaaaaaaaaaaaaaaaanks ! `:-)`

Nathann


---

Comment by zimmerma created at 2011-10-17 13:24:45

why did the milestone change? Is 4.7.2 already out? I don't see it on sagemath.org.

Paul


---

Comment by jdemeyer created at 2011-10-17 13:30:35

Replying to [comment:13 zimmerma]:
> Is 4.7.2 already out?
Not yet, but it should be _almost_ out.  A release candidate is in preparation.


---

Comment by leif created at 2011-10-18 05:01:34

Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 zimmerma]:
> > Is 4.7.2 already out?
> Not yet, but it should be _almost_ out.  A release candidate is in preparation.

So a small patch only fixing a memory leak isn't worth getting into the final?


---

Comment by jdemeyer created at 2011-10-22 20:54:28

Resolution: fixed


---

Comment by zimmerma created at 2011-10-22 20:58:50

I wonder why you already work on sage-4.7.3, since 4.7.2 is not yet available (even in source
form) on sagemath.org...

Paul


---

Comment by jdemeyer created at 2011-11-03 16:14:43

Milestone sage-4.7.3 deleted
