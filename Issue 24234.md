# Issue 24234: Don't put non-built Cython extensions in sage_build_cython.extensions

archive/issues_024234.json:
```json
{
    "body": "CC:  @embray\n\nThe `OptionalExtension` mechanism (see `src/sage_setup/optional_extension.py`) allows for Cython modules to be cythonized but not compiled by distutils (by some logic in the `sage_build_ext` build command).\n\nInstead of just skipping the build of those extensions, they should really never be added to `ext_modules` in the first place. This affects `clean_install_dir` because optional-but-non-built extensions should not be importable.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24471\n\n",
    "created_at": "2018-01-04T13:11:24Z",
    "labels": [
        "build",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Don't put non-built Cython extensions in sage_build_cython.extensions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24234",
    "user": "@jdemeyer"
}
```
CC:  @embray

The `OptionalExtension` mechanism (see `src/sage_setup/optional_extension.py`) allows for Cython modules to be cythonized but not compiled by distutils (by some logic in the `sage_build_ext` build command).

Instead of just skipping the build of those extensions, they should really never be added to `ext_modules` in the first place. This affects `clean_install_dir` because optional-but-non-built extensions should not be importable.

Issue created by migration from https://trac.sagemath.org/ticket/24471





---

archive/issue_comments_339386.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-04T13:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339386",
    "user": "@jdemeyer"
}
```

New commits:



---

archive/issue_comments_339387.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-04T13:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339387",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_339388.json:
```json
{
    "body": "Makes sense to me.  It might be nice to have a test for this but that would involve adding more tests for `sage_setup` in general--something I know we've been meaning to do for a while.",
    "created_at": "2018-01-05T12:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339388",
    "user": "@embray"
}
```

Makes sense to me.  It might be nice to have a test for this but that would involve adding more tests for `sage_setup` in general--something I know we've been meaning to do for a while.



---

archive/issue_comments_339389.json:
```json
{
    "body": "Replying to [comment:5 embray]:\n> It might be nice to have a test for this but that would involve adding more tests for `sage_setup` in general\n\nThe problem is that it's not really possible to test `sage_setup` without `setup.py`. So that would require that most logic of `setup.py` would be moved to the `sage_setup` module such that it can be imported for testing. I agree that this makes sense, but not for this ticket.",
    "created_at": "2018-01-05T12:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339389",
    "user": "@jdemeyer"
}
```

Replying to [comment:5 embray]:
> It might be nice to have a test for this but that would involve adding more tests for `sage_setup` in general

The problem is that it's not really possible to test `sage_setup` without `setup.py`. So that would require that most logic of `setup.py` would be moved to the `sage_setup` module such that it can be imported for testing. I agree that this makes sense, but not for this ticket.



---

archive/issue_comments_339390.json:
```json
{
    "body": "Yep.",
    "created_at": "2018-01-05T13:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339390",
    "user": "@embray"
}
```

Yep.



---

archive/issue_comments_339391.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-05T13:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339391",
    "user": "@embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_339392.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-13T11:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24234#issuecomment-339392",
    "user": "@vbraun"
}
```

Resolution: fixed
