# Issue 13134: Generators for Queen, King, and Knight graphs

archive/issues_013134.json:
```json
{
    "body": "Assignee: jason, ncohen, rlm\n\nKeywords: graph, generator\n\nThis patch implements the generators for Queen, King, and Knight graphs.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13306\n\n",
    "created_at": "2012-07-27T18:30:47Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "Generators for Queen, King, and Knight graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13134",
    "user": "dcoudert"
}
```
Assignee: jason, ncohen, rlm

Keywords: graph, generator

This patch implements the generators for Queen, King, and Knight graphs.

Issue created by migration from https://trac.sagemath.org/ticket/13306





---

archive/issue_comments_159901.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-27T18:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159901",
    "user": "dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_159902.json:
```json
{
    "body": "Two comments:\n\n1) What about supporting d-dimensional chess boards?\ni.e. G = graphs.QueenGraph(2, 2, 2) \nor G = graphs.QueenGraph(5,6,7,8,9) \n\n2) Your input checks require n to be of type Integer. This excludes python ints and other things considered an integer. What about: \"if n not in ZZ:\"?",
    "created_at": "2012-07-27T19:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159902",
    "user": "sluther"
}
```

Two comments:

1) What about supporting d-dimensional chess boards?
i.e. G = graphs.QueenGraph(2, 2, 2) 
or G = graphs.QueenGraph(5,6,7,8,9) 

2) Your input checks require n to be of type Integer. This excludes python ints and other things considered an integer. What about: "if n not in ZZ:"?



---

archive/issue_comments_159903.json:
```json
{
    "body": "Replying to [comment:2 sluther]:\n> Two comments:\n> \n> 1) What about supporting d-dimensional chess boards?\n> i.e. G = graphs.QueenGraph(2, 2, 2) \n> or G = graphs.QueenGraph(5,6,7,8,9) \n\nWhy not, but what would be the definition of valid movements?\n- It is obvious for rook's (clique on each dimension). \n- For a knight, it will still be +1 in one dimension and +2 in another dimension. So it should be ok\n- For a king it is already more difficult to define legal and illegal movements.\n- Same for the queen: what is legal and illegal?\n\n \n> 2) Your input checks require n to be of type Integer. This excludes python ints and other things considered an integer. What about: \"if n not in ZZ:\"?\n\nYes, that's much better.\n\nThanks,\nD.",
    "created_at": "2012-07-27T22:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159903",
    "user": "dcoudert"
}
```

Replying to [comment:2 sluther]:
> Two comments:
> 
> 1) What about supporting d-dimensional chess boards?
> i.e. G = graphs.QueenGraph(2, 2, 2) 
> or G = graphs.QueenGraph(5,6,7,8,9) 

Why not, but what would be the definition of valid movements?
- It is obvious for rook's (clique on each dimension). 
- For a knight, it will still be +1 in one dimension and +2 in another dimension. So it should be ok
- For a king it is already more difficult to define legal and illegal movements.
- Same for the queen: what is legal and illegal?

 
> 2) Your input checks require n to be of type Integer. This excludes python ints and other things considered an integer. What about: "if n not in ZZ:"?

Yes, that's much better.

Thanks,
D.



---

archive/issue_comments_159904.json:
```json
{
    "body": "I'd think in directions. There are two types. The first type is defined by the nearest neighbours in the d-dimensional lattice, i.e. those points that change one coordinate by one.\nThe second type is defined by the second nearest heighbours, i.e. those points that change the coordinate in two different dimensions by one each.\n\nThe allowed directions then are:\n\nKing: 1 + 2 \\\\\nRook: 1 \\\\\nBishop: 2 \\\\\nQueen: 1 + 2 \\\\\n\nYour definition for the knight makes sense.",
    "created_at": "2012-07-28T07:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159904",
    "user": "sluther"
}
```

I'd think in directions. There are two types. The first type is defined by the nearest neighbours in the d-dimensional lattice, i.e. those points that change one coordinate by one.
The second type is defined by the second nearest heighbours, i.e. those points that change the coordinate in two different dimensions by one each.

The allowed directions then are:

King: 1 + 2 \\
Rook: 1 \\
Bishop: 2 \\
Queen: 1 + 2 \\

Your definition for the knight makes sense.



---

archive/issue_comments_159905.json:
```json
{
    "body": "I found a nice and generic way to implement all the chessboard graphs. I'm using a hidden function that takes many parameters and allows to add edges to all vertices along one dimension and/or on the diagonals of any pairs of dimensions and/or knight-like movements in any pairs of dimensions. The function also allows to control the radius of the visibility ball (could be useful).\n\nHope you'll like it.",
    "created_at": "2012-07-29T17:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159905",
    "user": "dcoudert"
}
```

I found a nice and generic way to implement all the chessboard graphs. I'm using a hidden function that takes many parameters and allows to add edges to all vertices along one dimension and/or on the diagonals of any pairs of dimensions and/or knight-like movements in any pairs of dimensions. The function also allows to control the radius of the visibility ball (could be useful).

Hope you'll like it.



---

archive/issue_comments_159906.json:
```json
{
    "body": "Excellent idea to organize it that way!\n\nSome coding comments though.\n\n\n```\ntry: \n \t8297\t            if isinstance(dim_list,dict): \n \t8298\t                dim = [dim_list[a] for a in dim_list] \n \t8299\t            else: \n \t8300\t                dim = [a for a in dim_list] \n \t8301\t            nb_dim = len(dim) \n \t8302\t        except: \n \t8303\t            raise ValueError('The first parameter must be an iterable object.') \n```\n\n\n1) if dim is a dict the keys aren't ordered. This means dim = {1: 2, 2: 3} might end up as dim = [3, 2] instead of [2,3]. Suggestion: dim = [dim_list[a] for a in sorted(dim_list)] \n\n2) \"dim = [a for a in dim_list]\" can be replaced with \"dim = list(dim_list)\"\n\n3) Never use except statements without an exception type to be catched. The reason is that this also catches things like SystemExit, which is raised by CTRL+C. Suggestion: \"except TypeError:\"\n\n\n```\ndimstr = '' \n \t8307\t        for a in dim: \n \t8308\t            if not a in ZZ or a < 1: \n \t8309\t                raise ValueError('The dimensions must be positive integers larger than 1.') \n \t8310\t            if dimstr == '': \n \t8311\t                dimstr = '('+str(a) \n \t8312\t            else: \n \t8313\t                dimstr += ','+str(a) \n \t8314\t        dimstr += ')' \n```\n\n4) This could be split into:\n\n```\nif any(a not in ZZ or a < 1 for a in dim):\n    raise ValueError('The dimensions must be positive integers larger than 1.')\ndimstr = '(%s)' % \"\".join(dim)\n```\n\n\n5) In the code flowing code, there are checks like \"rook_radius < 1 or not rook_radius in ZZ:\". These could be reversed, i.e. \"not rook_radius in ZZ or rook_radius < 1\". The reason is that the comparison might raise an exception if it doesn't make sense.\\\\\n6)\n\n```\n        8331\t        v = [0 for a in dim]\n \t8332\t        V = [v] \n```\n\n\n```\n \t8332\t        V = [ [0]*nb_dim ] \n```\n\n7) In the code below, there are some instances of \"u = [x for x in v]\". These should be replaced by \"u = v[:]\". \\\\\n8)\n\n```\n8343\t        combin = combinations([i for i in xrange(nb_dim)],2) \n```\n\n\n```\n8343\t        combin = combinations(range(nb_dim),2) \n```\n\nI hope I don't discourage you with my nitpicking. Most the comments concern only style and efficiency, the only show stopper is 3).",
    "created_at": "2012-07-29T18:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159906",
    "user": "sluther"
}
```

Excellent idea to organize it that way!

Some coding comments though.


```
try: 
 	8297	            if isinstance(dim_list,dict): 
 	8298	                dim = [dim_list[a] for a in dim_list] 
 	8299	            else: 
 	8300	                dim = [a for a in dim_list] 
 	8301	            nb_dim = len(dim) 
 	8302	        except: 
 	8303	            raise ValueError('The first parameter must be an iterable object.') 
```


1) if dim is a dict the keys aren't ordered. This means dim = {1: 2, 2: 3} might end up as dim = [3, 2] instead of [2,3]. Suggestion: dim = [dim_list[a] for a in sorted(dim_list)] 

2) "dim = [a for a in dim_list]" can be replaced with "dim = list(dim_list)"

3) Never use except statements without an exception type to be catched. The reason is that this also catches things like SystemExit, which is raised by CTRL+C. Suggestion: "except TypeError:"


```
dimstr = '' 
 	8307	        for a in dim: 
 	8308	            if not a in ZZ or a < 1: 
 	8309	                raise ValueError('The dimensions must be positive integers larger than 1.') 
 	8310	            if dimstr == '': 
 	8311	                dimstr = '('+str(a) 
 	8312	            else: 
 	8313	                dimstr += ','+str(a) 
 	8314	        dimstr += ')' 
```

4) This could be split into:

```
if any(a not in ZZ or a < 1 for a in dim):
    raise ValueError('The dimensions must be positive integers larger than 1.')
dimstr = '(%s)' % "".join(dim)
```


5) In the code flowing code, there are checks like "rook_radius < 1 or not rook_radius in ZZ:". These could be reversed, i.e. "not rook_radius in ZZ or rook_radius < 1". The reason is that the comparison might raise an exception if it doesn't make sense.\\
6)

```
        8331	        v = [0 for a in dim]
 	8332	        V = [v] 
```


```
 	8332	        V = [ [0]*nb_dim ] 
```

7) In the code below, there are some instances of "u = [x for x in v]". These should be replaced by "u = v[:]". \\
8)

```
8343	        combin = combinations([i for i in xrange(nb_dim)],2) 
```


```
8343	        combin = combinations(range(nb_dim),2) 
```

I hope I don't discourage you with my nitpicking. Most the comments concern only style and efficiency, the only show stopper is 3).



---

archive/issue_comments_159907.json:
```json
{
    "body": "Thanks for the propositions. I have incorporated all of them but the following which causes a type error\n\n```\nsage: dim = [2,3,4,5]\nsage: dimstr = '(%s)' % \"\".join(dim)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/dcoudert/<ipython console> in <module>()\n\nTypeError: sequence item 0: expected string, int found\n```\n\nInstead, I use the following code which is in fact easier:\n\n``` \ndimstr = str(tuple(dim)) \n```\n\n\nThis is much better now !",
    "created_at": "2012-07-29T19:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159907",
    "user": "dcoudert"
}
```

Thanks for the propositions. I have incorporated all of them but the following which causes a type error

```
sage: dim = [2,3,4,5]
sage: dimstr = '(%s)' % "".join(dim)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/dcoudert/<ipython console> in <module>()

TypeError: sequence item 0: expected string, int found
```

Instead, I use the following code which is in fact easier:

``` 
dimstr = str(tuple(dim)) 
```


This is much better now !



---

archive/issue_comments_159908.json:
```json
{
    "body": "1) There are white space issues, see patchbot output.\n\n2) I would have expected the following:\n\n```\nG = graphs.QueenGraph( [3,3,3], radius=1 );\nlen(G.neighbors((1,1,1))) == 26\n```\n\nbut the result is 18. This is because the second nearest neighbors in the third dimension are missing.",
    "created_at": "2012-07-30T10:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159908",
    "user": "sluther"
}
```

1) There are white space issues, see patchbot output.

2) I would have expected the following:

```
G = graphs.QueenGraph( [3,3,3], radius=1 );
len(G.neighbors((1,1,1))) == 26
```

but the result is 18. This is because the second nearest neighbors in the third dimension are missing.



---

archive/issue_comments_159909.json:
```json
{
    "body": "Replying to [comment:8 sluther]:\n> 1) There are white space issues, see patchbot output.\nRemoved. Why isn't it automatic :(\n\n> 2) I would have expected the following:\n> {{{\n> G = graphs.QueenGraph( [3,3,3], radius=1 );\n> len(G.neighbors((1,1,1))) == 26\n> }}}\n> but the result is 18. This is because the second nearest neighbors in the third dimension are missing.\n\nI disagree. The correct result is 18.\n- 26 is not multiple of 3. so you could have expected 24\n- Although we have 8 neighbors per pairs of dimensions, the sum is not 24 but 18 since you must remove redundancy. \n  - in x,y you have 8 neighbors\n  - in x,z you also have 8 neighbors, but 2 of them were found with x,y => 6 more\n  - in y,z you have 8 neighbors, but 2 were already in x,y and 2 in x,z => 4 more\n  - 8+6+4 = 18",
    "created_at": "2012-07-30T11:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159909",
    "user": "dcoudert"
}
```

Replying to [comment:8 sluther]:
> 1) There are white space issues, see patchbot output.
Removed. Why isn't it automatic :(

> 2) I would have expected the following:
> {{{
> G = graphs.QueenGraph( [3,3,3], radius=1 );
> len(G.neighbors((1,1,1))) == 26
> }}}
> but the result is 18. This is because the second nearest neighbors in the third dimension are missing.

I disagree. The correct result is 18.
- 26 is not multiple of 3. so you could have expected 24
- Although we have 8 neighbors per pairs of dimensions, the sum is not 24 but 18 since you must remove redundancy. 
  - in x,y you have 8 neighbors
  - in x,z you also have 8 neighbors, but 2 of them were found with x,y => 6 more
  - in y,z you have 8 neighbors, but 2 were already in x,y and 2 in x,z => 4 more
  - 8+6+4 = 18



---

archive/issue_comments_159910.json:
```json
{
    "body": "Replying to [comment:9 dcoudert]:\n> Replying to [comment:8 sluther]:\n> > 2) I would have expected the following:\n> > {{{\n> > G = graphs.QueenGraph( [3,3,3], radius=1 );\n> > len(G.neighbors((1,1,1))) == 26\n> > }}}\n> > but the result is 18. This is because the second nearest neighbors in the third dimension are missing.\n> \n> I disagree. The correct result is 18.\n> - 26 is not multiple of 3. so you could have expected 24\n> - Although we have 8 neighbors per pairs of dimensions, the sum is not 24 but 18 since you must remove redundancy. \n>  - in x,y you have 8 neighbors\n>  - in x,z you also have 8 neighbors, but 2 of them were found with x,y => 6 more\n>  - in y,z you have 8 neighbors, but 2 were already in x,y and 2 in x,z => 4 more\n>  - 8+6+4 = 18\n`26 = 3**3-1` \\\\\nIn general I would expect `3**d -1` directions. They are defined by the `3^d` points in ` {-1,0,1}^d `. Only the central point doesn't define a direction.",
    "created_at": "2012-07-31T04:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159910",
    "user": "sluther"
}
```

Replying to [comment:9 dcoudert]:
> Replying to [comment:8 sluther]:
> > 2) I would have expected the following:
> > {{{
> > G = graphs.QueenGraph( [3,3,3], radius=1 );
> > len(G.neighbors((1,1,1))) == 26
> > }}}
> > but the result is 18. This is because the second nearest neighbors in the third dimension are missing.
> 
> I disagree. The correct result is 18.
> - 26 is not multiple of 3. so you could have expected 24
> - Although we have 8 neighbors per pairs of dimensions, the sum is not 24 but 18 since you must remove redundancy. 
>  - in x,y you have 8 neighbors
>  - in x,z you also have 8 neighbors, but 2 of them were found with x,y => 6 more
>  - in y,z you have 8 neighbors, but 2 were already in x,y and 2 in x,z => 4 more
>  - 8+6+4 = 18
`26 = 3**3-1` \\
In general I would expect `3**d -1` directions. They are defined by the `3^d` points in ` {-1,0,1}^d `. Only the central point doesn't define a direction.



---

archive/issue_comments_159911.json:
```json
{
    "body": "We said before (#comment:4) that the Queen could move either in 1 dimension or in 2 dimensions, and adding an edge from (1,1,1) to (2,2,2) means moving in the 3 dimensions. That's why 8 points are not reachable from (1,1,1).\n\n> In general I would expect `3**d -1` directions. They are defined by the `3^d` points in `{-1,0,1}^d`. Only the central point doesn't define a direction. \nI don't understand.",
    "created_at": "2012-07-31T07:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159911",
    "user": "dcoudert"
}
```

We said before (#comment:4) that the Queen could move either in 1 dimension or in 2 dimensions, and adding an edge from (1,1,1) to (2,2,2) means moving in the 3 dimensions. That's why 8 points are not reachable from (1,1,1).

> In general I would expect `3**d -1` directions. They are defined by the `3^d` points in `{-1,0,1}^d`. Only the central point doesn't define a direction. 
I don't understand.



---

archive/issue_comments_159912.json:
```json
{
    "body": "Replying to [comment:11 dcoudert]:\n> We said before (#comment:4) that the Queen could move either in 1 dimension or in 2 > dimensions, and adding an edge from (1,1,1) to (2,2,2) means moving in the 3 dimensions. That's why 8 points are not reachable from (1,1,1).\n\nYou're right that's what I said, but not what I meant. Sorry.\n\n> \n> > In general I would expect `3**d -1` directions. They are defined by the `3^d` points in `{-1,0,1}^d`. Only the central point doesn't define a direction. \n> I don't understand.\n\nA point in the d-dimensional lattice has d integer coordinates, say x_i (i=1..d). \nAll points with x_i restricted to the set {-1,0,1} (for all i), lie in a hypercube. \\\\\nThis hypercube:\\\\\n* is centered at the origin \\\\\n* has all edges parralel to the coordinate axes \\\\\n* has only edges of lenght 2 \\\\\n* contains exactly `3^d` lattice points \\\\\n\nNow define a valid direction as the vector from the origin (0,0,...,0) to any other of the `3^d-1` points. \\\\\n\nAnd here is the fun question: Which definition makes more sense?\\\\\nI'd propse the following: If you don't feel like putting more work into this, we'll leave it as is. If you're willing to work on it: What about adding a parameter, say 'higher_diagonals' that switches between the two definitions?",
    "created_at": "2012-07-31T08:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159912",
    "user": "sluther"
}
```

Replying to [comment:11 dcoudert]:
> We said before (#comment:4) that the Queen could move either in 1 dimension or in 2 > dimensions, and adding an edge from (1,1,1) to (2,2,2) means moving in the 3 dimensions. That's why 8 points are not reachable from (1,1,1).

You're right that's what I said, but not what I meant. Sorry.

> 
> > In general I would expect `3**d -1` directions. They are defined by the `3^d` points in `{-1,0,1}^d`. Only the central point doesn't define a direction. 
> I don't understand.

A point in the d-dimensional lattice has d integer coordinates, say x_i (i=1..d). 
All points with x_i restricted to the set {-1,0,1} (for all i), lie in a hypercube. \\
This hypercube:\\
* is centered at the origin \\
* has all edges parralel to the coordinate axes \\
* has only edges of lenght 2 \\
* contains exactly `3^d` lattice points \\

Now define a valid direction as the vector from the origin (0,0,...,0) to any other of the `3^d-1` points. \\

And here is the fun question: Which definition makes more sense?\\
I'd propse the following: If you don't feel like putting more work into this, we'll leave it as is. If you're willing to work on it: What about adding a parameter, say 'higher_diagonals' that switches between the two definitions?



---

archive/issue_comments_159913.json:
```json
{
    "body": "I prefer to let the patch as it is for now. \n\nIf one needs it, we can latter add this \"super-queen\" definition. Also, your alternative definition should also be used for bishops and it would make bishops much more powerful than rooks (only able to move along one dimension at a time). And what about knights?",
    "created_at": "2012-08-01T07:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159913",
    "user": "dcoudert"
}
```

I prefer to let the patch as it is for now. 

If one needs it, we can latter add this "super-queen" definition. Also, your alternative definition should also be used for bishops and it would make bishops much more powerful than rooks (only able to move along one dimension at a time). And what about knights?



---

archive/issue_comments_159914.json:
```json
{
    "body": "The `n\\equiv 1,5 \\pmod(6)` in the QueenGraph doc string looks strange, both on the command line and in the html doc.\n\nOnce this is fixed, I'll give it a positive review.",
    "created_at": "2012-08-01T11:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159914",
    "user": "sluther"
}
```

The `n\equiv 1,5 \pmod(6)` in the QueenGraph doc string looks strange, both on the command line and in the html doc.

Once this is fixed, I'll give it a positive review.



---

archive/issue_comments_159915.json:
```json
{
    "body": "I changed it to `n\\equiv 1,5 \\bmod{6}` and the output is now correct: n\\equiv 1,5 (mod 6).",
    "created_at": "2012-08-01T22:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159915",
    "user": "dcoudert"
}
```

I changed it to `n\equiv 1,5 \bmod{6}` and the output is now correct: n\equiv 1,5 (mod 6).



---

archive/issue_comments_159916.json:
```json
{
    "body": "Tests good, docs good -> positive review",
    "created_at": "2012-08-02T11:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159916",
    "user": "sluther"
}
```

Tests good, docs good -> positive review



---

archive/issue_comments_159917.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-02T11:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159917",
    "user": "sluther"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_159918.json:
```json
{
    "body": "Many thanks for the help improving this patch.",
    "created_at": "2012-08-02T11:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159918",
    "user": "dcoudert"
}
```

Many thanks for the help improving this patch.



---

archive/issue_comments_159919.json:
```json
{
    "body": "This patch adds again a considerable amount of code to `sage/graphs/graph_generators.py`.\n\nAt some point, I will have to refuse such patches before that file gets really too big.",
    "created_at": "2012-08-02T12:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159919",
    "user": "jdemeyer"
}
```

This patch adds again a considerable amount of code to `sage/graphs/graph_generators.py`.

At some point, I will have to refuse such patches before that file gets really too big.



---

archive/issue_comments_159920.json:
```json
{
    "body": "Then what could be the solution: split the file into several pieces (graph_generators_1.py, graph_generators_2.py, etc...) with a bounded number of lines per file ?",
    "created_at": "2012-08-02T13:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159920",
    "user": "dcoudert"
}
```

Then what could be the solution: split the file into several pieces (graph_generators_1.py, graph_generators_2.py, etc...) with a bounded number of lines per file ?



---

archive/issue_comments_159921.json:
```json
{
    "body": "Replying to [comment:19 dcoudert]:\n> Then what could be the solution: split the file into several pieces (graph_generators_1.py, graph_generators_2.py, etc...) with a bounded number of lines per file ? \nPerhaps, although a better solution would be to group \"related\" graphs together.\n\nFor example, put all the code added in this ticket inside a new file\n\n```\nsage/graphs/generators/chessboard.py\n```\n",
    "created_at": "2012-08-02T13:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159921",
    "user": "jdemeyer"
}
```

Replying to [comment:19 dcoudert]:
> Then what could be the solution: split the file into several pieces (graph_generators_1.py, graph_generators_2.py, etc...) with a bounded number of lines per file ? 
Perhaps, although a better solution would be to group "related" graphs together.

For example, put all the code added in this ticket inside a new file

```
sage/graphs/generators/chessboard.py
```




---

archive/issue_comments_159922.json:
```json
{
    "body": "I can try to do that, but I don't know how to expose the functions inside the GraphGenerators class. \nShould I use something like \n\n```\nimport types\nimport sage.graphs.generators.chessboard \nGraphGenerators.QueenGraph = types.MethodType(sage.graphs.generators.chessboard.QueenGraph, None, Graph) \n```\n\nI tried but it produces an error: `ImportError: No module named generators.chessboard`\n\nAny help is more than welcome.",
    "created_at": "2012-08-02T15:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159922",
    "user": "dcoudert"
}
```

I can try to do that, but I don't know how to expose the functions inside the GraphGenerators class. 
Should I use something like 

```
import types
import sage.graphs.generators.chessboard 
GraphGenerators.QueenGraph = types.MethodType(sage.graphs.generators.chessboard.QueenGraph, None, Graph) 
```

I tried but it produces an error: `ImportError: No module named generators.chessboard`

Any help is more than welcome.



---

archive/issue_comments_159923.json:
```json
{
    "body": "Did you add an `__init__.py` to sage/graphs/generators?",
    "created_at": "2012-08-03T05:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159923",
    "user": "sluther"
}
```

Did you add an `__init__.py` to sage/graphs/generators?



---

archive/issue_comments_159924.json:
```json
{
    "body": "I added such a file but it's still not working.\n\nIs the procedure documented somewhere? I haven't find it in the documentation yet.",
    "created_at": "2012-08-03T08:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159924",
    "user": "dcoudert"
}
```

I added such a file but it's still not working.

Is the procedure documented somewhere? I haven't find it in the documentation yet.



---

archive/issue_comments_159925.json:
```json
{
    "body": "See [1] for how to add a new directory. But I'd say you should skip the addition of all.py and the addition to the existing all.py files as you want these things to be visible through the GraphGenerators class only.\n\nAfter that add an import like \"import sage.graphs.generators.chessboard\" to graph_generators.py.\n\nThen:\n\n```\nclass GraphGenerators():\n   [...]\n   QueenGraph = sage.graphs.generators.chessboard.QueenGraph\n```\n\n\n\n[1] http://www.sagemath.org/doc/developer/coding_in_python.html#creating-a-new-directory",
    "created_at": "2012-08-03T11:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159925",
    "user": "sluther"
}
```

See [1] for how to add a new directory. But I'd say you should skip the addition of all.py and the addition to the existing all.py files as you want these things to be visible through the GraphGenerators class only.

After that add an import like "import sage.graphs.generators.chessboard" to graph_generators.py.

Then:

```
class GraphGenerators():
   [...]
   QueenGraph = sage.graphs.generators.chessboard.QueenGraph
```



[1] http://www.sagemath.org/doc/developer/coding_in_python.html#creating-a-new-directory



---

archive/issue_comments_159926.json:
```json
{
    "body": "OK! it took me some time but know it's working!\nFrom my computer, everything is working (build, doc, tests,...).\nI have not added the new file for docbuild since the documentation of the functions are build with the documentation of graph_generator.py.\n\nI hope this new version will satisfy everyone.",
    "created_at": "2012-08-03T13:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159926",
    "user": "dcoudert"
}
```

OK! it took me some time but know it's working!
From my computer, everything is working (build, doc, tests,...).
I have not added the new file for docbuild since the documentation of the functions are build with the documentation of graph_generator.py.

I hope this new version will satisfy everyone.



---

archive/issue_comments_159927.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-08-03T13:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159927",
    "user": "dcoudert"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_159928.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-03T13:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159928",
    "user": "dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_159929.json:
```json
{
    "body": "Addition of line ```# This file is not empty !``` in file ```__init__.py``` as Nathann told me we should not have empty files.",
    "created_at": "2012-08-03T13:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159929",
    "user": "dcoudert"
}
```

Addition of line ```# This file is not empty !``` in file ```__init__.py``` as Nathann told me we should not have empty files.



---

archive/issue_comments_159930.json:
```json
{
    "body": "Could anyone review this patch ?\nThanks.",
    "created_at": "2012-08-18T00:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159930",
    "user": "dcoudert"
}
```

Could anyone review this patch ?
Thanks.



---

archive/issue_comments_159931.json:
```json
{
    "body": "(cc me)",
    "created_at": "2012-10-02T13:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159931",
    "user": "ncohen"
}
```

(cc me)



---

archive/issue_comments_159932.json:
```json
{
    "body": "Do we really need to import sage.graphs.generators.chessboard at startup?",
    "created_at": "2012-10-02T17:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159932",
    "user": "robertwb"
}
```

Do we really need to import sage.graphs.generators.chessboard at startup?



---

archive/issue_comments_159933.json:
```json
{
    "body": "Replying to [comment:30 robertwb]:\n> Do we really need to import sage.graphs.generators.chessboard at startup?\n\nI don't know.\n\nFollowing Jeroen's suggestion, I have created a new directory to store graph generators instead of continuously increasing the size of sage.graphs.graph_generators.py. Later, we could split the graph_generators file and create smaller files, easier to read, faster to test, etc. in the generators directory.\n\nNow, the question is how to make these functions accessible from graphs (e.g., graphs.QueenGraph()) without importing the file at startup. Is there a way to import them the first time they are used? or any other interesting trick I'm not aware of?",
    "created_at": "2012-10-02T22:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159933",
    "user": "dcoudert"
}
```

Replying to [comment:30 robertwb]:
> Do we really need to import sage.graphs.generators.chessboard at startup?

I don't know.

Following Jeroen's suggestion, I have created a new directory to store graph generators instead of continuously increasing the size of sage.graphs.graph_generators.py. Later, we could split the graph_generators file and create smaller files, easier to read, faster to test, etc. in the generators directory.

Now, the question is how to make these functions accessible from graphs (e.g., graphs.QueenGraph()) without importing the file at startup. Is there a way to import them the first time they are used? or any other interesting trick I'm not aware of?



---

archive/issue_comments_159934.json:
```json
{
    "body": "You could try using lazy import. However, ignore that for now, as I think all of graph_generators should be lazily imported. #13562",
    "created_at": "2012-10-02T23:59:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159934",
    "user": "robertwb"
}
```

You could try using lazy import. However, ignore that for now, as I think all of graph_generators should be lazily imported. #13562



---

archive/issue_comments_159935.json:
```json
{
    "body": "Mostly looks good, but I would remove the double underscores around __ChessboardGraphGenerator__",
    "created_at": "2012-10-03T00:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159935",
    "user": "robertwb"
}
```

Mostly looks good, but I would remove the double underscores around __ChessboardGraphGenerator__



---

archive/issue_comments_159936.json:
```json
{
    "body": "Attachment [trac_13306-queen-king-knight-graphs-v2.patch](tarball://root/attachments/some-uuid/ticket13306/trac_13306-queen-king-knight-graphs-v2.patch) by dcoudert created at 2012-10-03 07:29:51",
    "created_at": "2012-10-03T07:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159936",
    "user": "dcoudert"
}
```

Attachment [trac_13306-queen-king-knight-graphs-v2.patch](tarball://root/attachments/some-uuid/ticket13306/trac_13306-queen-king-knight-graphs-v2.patch) by dcoudert created at 2012-10-03 07:29:51



---

archive/issue_comments_159937.json:
```json
{
    "body": "Done.",
    "created_at": "2012-10-03T07:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159937",
    "user": "dcoudert"
}
```

Done.



---

archive/issue_comments_159938.json:
```json
{
    "body": "Helloooooooooooooooooooooooooooooo !!\n\nWell, that patch was muuuuuuch cleaner than I feared, given its size `:-)`\n\nHere is a list of comments, and a small innocent reviewer's patch.\n\n* Default values : rook = True, bishop = True, knight = False : that's weird. Why not set them all to True or all to False ?\n* dim_list : it takes any iterable as an input, and you say that it takes sets or even dicts ! That's asking for trouble because the order in which the elements are listed in sets and dicts is platform-dependent, but then you specifically SORT the elements by key value when the inout is a dict, and take the VALUES into account. That's not what it is expected. A dict is an iterable, but list(my_dict) lists its keys, not values ! It would make more sense to remove the part of the code that deals with dict (why especially dicts, by the way ? One can make custom iterables !), and just use your ``dim = list(dim_list)`` which is perfect as it is.\n* I replaced \"at least\" or \"least\" by \">=\". This way you know whether \">=\" or \">\" is intended, which is never clear with \"at least\" :-P\n* Replaced a block of code by itertools.product\n* Added many \"`\" for tuples that could appear in LaTeX instead.\n\nNathann",
    "created_at": "2012-10-03T09:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159938",
    "user": "ncohen"
}
```

Helloooooooooooooooooooooooooooooo !!

Well, that patch was muuuuuuch cleaner than I feared, given its size `:-)`

Here is a list of comments, and a small innocent reviewer's patch.

* Default values : rook = True, bishop = True, knight = False : that's weird. Why not set them all to True or all to False ?
* dim_list : it takes any iterable as an input, and you say that it takes sets or even dicts ! That's asking for trouble because the order in which the elements are listed in sets and dicts is platform-dependent, but then you specifically SORT the elements by key value when the inout is a dict, and take the VALUES into account. That's not what it is expected. A dict is an iterable, but list(my_dict) lists its keys, not values ! It would make more sense to remove the part of the code that deals with dict (why especially dicts, by the way ? One can make custom iterables !), and just use your ``dim = list(dim_list)`` which is perfect as it is.
* I replaced "at least" or "least" by ">=". This way you know whether ">=" or ">" is intended, which is never clear with "at least" :-P
* Replaced a block of code by itertools.product
* Added many "`" for tuples that could appear in LaTeX instead.

Nathann



---

archive/issue_comments_159939.json:
```json
{
    "body": "I'm unable to install the review patch. Have you make it using the file I have uploaded this morning in which I have removed double underscores ?\n\n>     * Default values : rook = True, bishop = True, knight = False : that's weird. Why not set them all to True or all to False ?\nThat way the default behavior is QueenGraph, which is the most common chessboard graph. But all default parameters are OK for me.\n\n>     * dim_list : it takes any iterable as an input, and you say that it takes sets or even dicts ! That's asking for trouble because the order in which the elements are listed in sets and dicts is platform-dependent, but then you specifically SORT the elements by key value when the inout is a dict, and take the VALUES into account. That's not what it is expected. A dict is an iterable, but list(my_dict) lists its keys, not values ! It would make more sense to remove the part of the code that deals with dict (why especially dicts, by the way ? One can make custom iterables !), and just use your ``dim = list(dim_list)`` which is perfect as it is.\n\nThat's right. Can you insert this in the review patch?\n\n>     * I replaced \"at least\" or \"least\" by \">=\". This way you know whether \">=\" or \">\" is intended, which is never clear with \"at least\" :-P\n>     * Replaced a block of code by itertools.product\nI didn't know that command. Very nice.\n\n>     * Added many \"`\" for tuples that could appear in LaTeX instead.",
    "created_at": "2012-10-03T11:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159939",
    "user": "dcoudert"
}
```

I'm unable to install the review patch. Have you make it using the file I have uploaded this morning in which I have removed double underscores ?

>     * Default values : rook = True, bishop = True, knight = False : that's weird. Why not set them all to True or all to False ?
That way the default behavior is QueenGraph, which is the most common chessboard graph. But all default parameters are OK for me.

>     * dim_list : it takes any iterable as an input, and you say that it takes sets or even dicts ! That's asking for trouble because the order in which the elements are listed in sets and dicts is platform-dependent, but then you specifically SORT the elements by key value when the inout is a dict, and take the VALUES into account. That's not what it is expected. A dict is an iterable, but list(my_dict) lists its keys, not values ! It would make more sense to remove the part of the code that deals with dict (why especially dicts, by the way ? One can make custom iterables !), and just use your ``dim = list(dim_list)`` which is perfect as it is.

That's right. Can you insert this in the review patch?

>     * I replaced "at least" or "least" by ">=". This way you know whether ">=" or ">" is intended, which is never clear with "at least" :-P
>     * Replaced a block of code by itertools.product
I didn't know that command. Very nice.

>     * Added many "`" for tuples that could appear in LaTeX instead.



---

archive/issue_comments_159940.json:
```json
{
    "body": "> I'm unable to install the review patch. Have you make it using the file I have uploaded this morning in which I have removed double underscores ?\n`O_o`\nI thought I did. And none of the patch I had applied before changed chessboard.py. Well, I saw the errors when applying the patches and rebased it. Weird, but done.\n\n> That way the default behavior is QueenGraph, which is the most common chessboard graph. But all default parameters are OK for me.\n\nJust set them all to ``True``\n\n> That's right. Can you insert this in the review patch?\nDone.\n\nPatch updated !\n\nNathann",
    "created_at": "2012-10-03T14:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159940",
    "user": "ncohen"
}
```

> I'm unable to install the review patch. Have you make it using the file I have uploaded this morning in which I have removed double underscores ?
`O_o`
I thought I did. And none of the patch I had applied before changed chessboard.py. Well, I saw the errors when applying the patches and rebased it. Weird, but done.

> That way the default behavior is QueenGraph, which is the most common chessboard graph. But all default parameters are OK for me.

Just set them all to ``True``

> That's right. Can you insert this in the review patch?
Done.

Patch updated !

Nathann



---

archive/issue_comments_159941.json:
```json
{
    "body": "Attachment [trac_13306-review.patch](tarball://root/attachments/some-uuid/ticket13306/trac_13306-review.patch) by ncohen created at 2012-10-03 14:15:54",
    "created_at": "2012-10-03T14:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159941",
    "user": "ncohen"
}
```

Attachment [trac_13306-review.patch](tarball://root/attachments/some-uuid/ticket13306/trac_13306-review.patch) by ncohen created at 2012-10-03 14:15:54



---

archive/issue_comments_159942.json:
```json
{
    "body": "Now it's working and the doc is nicer. Thanks.\nI didn't know the `product` function and the way you use it is really nice.",
    "created_at": "2012-10-03T14:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159942",
    "user": "dcoudert"
}
```

Now it's working and the doc is nicer. Thanks.
I didn't know the `product` function and the way you use it is really nice.



---

archive/issue_comments_159943.json:
```json
{
    "body": "Well.. Then \"if you agree with those changes\", let's get this ticket in `:-)`\n\nNathann",
    "created_at": "2012-10-03T15:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159943",
    "user": "ncohen"
}
```

Well.. Then "if you agree with those changes", let's get this ticket in `:-)`

Nathann



---

archive/issue_comments_159944.json:
```json
{
    "body": "I agree with your changes. Thanks.",
    "created_at": "2012-10-03T15:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159944",
    "user": "dcoudert"
}
```

I agree with your changes. Thanks.



---

archive/issue_comments_159945.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-10-03T15:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159945",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_159946.json:
```json
{
    "body": "Arf. I thought you would change the ticket's status `:-)`\n\nNathann",
    "created_at": "2012-10-03T15:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159946",
    "user": "ncohen"
}
```

Arf. I thought you would change the ticket's status `:-)`

Nathann



---

archive/issue_comments_159947.json:
```json
{
    "body": "Thanks!",
    "created_at": "2012-10-03T15:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159947",
    "user": "dcoudert"
}
```

Thanks!



---

archive/issue_comments_159948.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-10-17T21:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13134",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13134#issuecomment-159948",
    "user": "jdemeyer"
}
```

Resolution: fixed
