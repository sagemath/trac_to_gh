# Issue 26118: Classes DegenerateManifold and DegenerateSubmanifold

Issue created by migration from https://trac.sagemath.org/ticket/26355

Original creator: Dicolevrai

Original creation time: 2018-09-27 14:39:46

Keywords: Degenerate (or lightlike) submanifold

An *embedded (resp. immersed) degenerate submanifold of a proper 
pseudo-Riemannian manifold* `(M,g)` is an embedded (resp. immersed) 
submanifold `H` of `M` as a differentiable manifold such that pull 
back of the metric tensor `g` via the embedding (resp. immersion) 
endows `H` with the structure of a degenerate manifold.

Degenerate submanifolds are study in many fields of mathematics and physics,
for instance in Differential Geometry (especially in geometry of
lightlike submanifold) and in General Relativity. In geometry of lightlike 
submanifolds, according to the dimension `r` of the radical distribution
(see below for definition of radical distribution), degenerate submanifolds 
have been classify into 4 subgroups: `r-`lightlike submanifolds, Coisotropic 
submanifolds, Isotropic submanifolds and Totally lightlike submanifolds.
(See the book of Krishan L. Duggal and Aurel Bejancu in *REFERENCES*.) 

In the present module, you can definie any of the 4 types but most of the
methods are implemented only for degenerate hypersurfaces who belong to
`r-`lightlike submanifolds. However, their might be generalized to
`1-`lightlike submanifolds. In the litterature there is a new approach
(the rigging technique) for studying `1-`lightlike submanifolds but
here we we the method of Krishan L. Duggal and Aurel Bejancu base on
the screen distribution.

Let `H` be a lightlike hypersurface of a pseudo-Riemannian manifold
`(M,g)`. Then the normal bundle `T^\perp H` intersect the tangent 
bundle `TH`. The radical distribution is defined as
'Rad(TH)=TH\cap T^\perp H'. In case of hypersurfaces, and more
generally `1-`lightlike submanifolds, this is a rank 1 distribution. 
A screen distribution `S(TH)` is a complementary of `Rad(TH)` in `TH`.

Giving a screen distribution `S(TH)` and a null vector field `\xi` 
locally defined and spanning `Rad(TH)`, there exists a unique 
transversal null vector field 'N' locally defined and such that 
`g(N,\xi)=1`. From a transverse vector 'v', the null rigging 'N'
is giving by the formula

.. MATH::

    N = \frac{1}{g(\xi, v)}\left(v-\frac{g(v,v)}{2g(xi, v)}\xi\right)

Tensors on the ambient manifold 'M' are projected on 'H' along 'N'
to obtain induced objects. For instance, induced connection is the
linear connexion defined on H through the Levi-Civitta connection of
'g' along `N`.

To work on a degenerate submanifold, after defining `H` as an instance
of :class:`~sage.manifolds.differentiable.manifold.DifferentiableManifold`,
with the keyword *structure='degenerate'*, you have to set a transvervector
`v` and screen distribution together with the radical distribution.

An example of degenerate submanifold from General Relativity is the
horizon of the Shawrzschild black hole. Allow us to recall that 
Shawrzschild black hole is the first non-trivial solution of Einstein's
equations. It describes the metric inside a star of radius `R = 2m`,
being `m` the inertial mass of the star. It can be seen as an open
ball in a Lorentzian manifold structure on `\RR^4`::


---

Comment by Dicolevrai created at 2018-09-27 23:03:01

New commits:


---

Comment by Dicolevrai created at 2018-09-27 23:03:01

Changing status from new to needs_info.


---

Comment by git created at 2018-09-28 18:30:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2018-10-25 05:30:09

New commits:


---

Comment by Dicolevrai created at 2018-10-25 05:30:09

Changing status from needs_info to needs_review.


---

Comment by git created at 2018-10-29 09:46:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2018-10-29 10:20:51

The keyword value ``degenerate`` by ``degenerate_metric`` for the keyword ``structure`` of the constructor :function:`~sage.manifolds.manifold`, and all doctests have been written.


---

Comment by embray created at 2019-01-15 18:15:21

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.


---

Comment by git created at 2019-01-22 12:06:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Attachment

To create the class Degenerate Submanifold


---

Attachment

To create the class Degenerate Manifold


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by Dicolevrai created at 2019-04-10 07:37:12

New commits:


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by Dicolevrai created at 2019-08-30 12:00:29

Dear,

All tests passed this time. I will be happy if you would find time to review.
----
New commits:


---

Comment by git created at 2019-08-30 14:22:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-08-30 14:28:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-08-30 17:01:32

New commits:


---

Comment by egourgoulhon created at 2019-09-04 15:32:21

The documentation does not build (it looks like a file `degenerate_metric.rst` is missing in `src/doc/en/reference/manifolds`)


---

Comment by egourgoulhon created at 2019-09-04 15:32:21

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-09-06 14:49:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by Dicolevrai created at 2019-09-06 14:53:30

Changing status from needs_work to needs_review.


---

Comment by Dicolevrai created at 2019-09-06 14:53:30

New commits:


---

Comment by egourgoulhon created at 2019-09-19 19:12:40

The documentation does not build: I get the error message

```
OSError: /home/eric/sage/py3/local/lib/python3.7/site-packages/sage/manifolds/differentiable/degenerate_submanifold.py:docstring of sage.manifolds.differentiable.degenerate_submanifold:7: WARNING: Inline interpreted text or phrase reference start-string without end-string.
```


See also the error in line 1772 of `src/doc/en/reference/references/index.rst` reported by the patchbot.


---

Comment by jhpalmieri created at 2019-09-19 20:26:48

Shouldn't "Shawrzschild" be "Schwarzschild" (appears several places).

Regarding the documentation, I skimmed it for formatting and fixed some of the problems. I am pretty sure there are more, for example cases where `'M'` should be ``M`` (you want backquotes so the symbol will appear in math mode, not in quotes). In `adapted_frame`, do you want to use `\xi` instead of `xi`?

I strongly encourage running `make` and then opening up the reference manual (e.g. with `./sage -c 'reference()'`, and then proofreading for both formatting and content. I just made formatting changes, no changes to the content.


---

Comment by git created at 2019-09-19 20:28:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2019-09-19 20:31:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2019-10-04 18:16:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-11-30 10:38:38

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2019-11-30 13:24:54

Changing status from positive_review to needs_review.


---

Comment by egourgoulhon created at 2019-11-30 13:24:54

Sorry for not having been able to do the review up to now. I will do it this week.


---

Comment by chapoton created at 2019-12-08 18:00:53

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2019-12-08 18:00:53

red branch


---

Comment by egourgoulhon created at 2019-12-08 18:13:07

Replying to [comment:34 chapoton]:
> red branch
I'll perform a review in the coming days and will start by fixing the merge conflicts. They are due to the numerous tickets merged in the manifold section since the current ticket was prepared.


---

Comment by git created at 2019-12-09 20:45:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2019-12-09 20:48:07

The merge conflict is fixed. Let the patchbot run...


---

Comment by egourgoulhon created at 2019-12-09 20:48:07

Changing status from needs_work to needs_review.


---

Comment by egourgoulhon created at 2019-12-10 20:45:54

Changing status from needs_review to needs_work.


---

Comment by egourgoulhon created at 2019-12-10 20:45:54

An issue is the time spent in doctesting the file `degenerate_submanifold.py`: on my computer (core i7 processor), this takes 247 seconds. This is too long. For instance, doctesting `pseudo_riemannian_submanifold.py` takes 95 seconds, which is already very long! Could you rewrite the doctests to reduce this time? (for instance by reducing the dimensionality). From the [doctest section of the developer manual](https://doc.sagemath.org/html/en/developer/doctesting.html#run-long-doctests): _long doctests should ideally complete in 5 seconds or less. We know that you (the author) want to show off the capabilities of your code, but this is not the place to do so. Long-running tests will sooner or later hurt our ability to run the testsuite. Really, doctests should be as fast as possible while providing coverage for the code._

If you want to show capabilities of your code that requires rather long computations, please consider preparing a Jupyter notebook, that could be posted e.g. on the [page of manifold examples](https://sagemanifolds.obspm.fr/examples.html). 

Note that to track the long doctests, you can use the option `--warn-long`; for instance

```
./sage -t --long --warn-long 5 src/sage/manifolds/differentiable/degenerate_submanifold.py
```

shows all doctests that takes more than 5 seconds.

Besides, there are some pyflakes errors:

```
degenerate_submanifold.py:174: 'sage.functions.other.factorial' imported but unused
degenerate_submanifold.py:175: 'sage.symbolic.ring.SR' imported but unused
degenerate_submanifold.py:176: 'sage.misc.cachefunc.cached_method' imported but unused
degenerate_submanifold.py:177: 'sage.rings.integer.Integer' imported but unused
degenerate_submanifold.py:178: 'queue.Queue' imported but unused
degenerate_submanifold.py:582: local variable 'normal' is assigned to but never used
degenerate_submanifold.py:2135: 'sage.tensor.modules.tensor_with_indices.TensorWithIndices' imported but unused
```



---

Comment by git created at 2019-12-14 06:45:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-12-14 07:06:19

Time spent in doctesting the file `degenerate_submanifold.py` has been considerably reduced. All imported but unused local variables have been deleted. I will be happy to post some Jupyter notebook to the [page of manifold examples](https://sagemanifolds.obspm.fr/examples.html)


---

Comment by Dicolevrai created at 2019-12-14 07:06:19

Changing status from needs_work to needs_review.


---

Comment by egourgoulhon created at 2019-12-15 16:43:26

Replying to [comment:40 Dicolevrai]:
> Time spent in doctesting the file `degenerate_submanifold.py` has been considerably reduced. 
Thanks.

>All imported but unused local variables have been deleted. I will be happy to post some Jupyter notebook to the [page of manifold examples](https://sagemanifolds.obspm.fr/examples.html)

You have added a Jupyter notebook at the root of Sage directory in the last commit. I guess this is an error. In any case, Trac branches are not the place for this. Only source code (Python, Cython, reStructuredText, etc.) should be present. Could you remove it? A good place for publishing Jupyter notebooks is a public git repository, on which one can make a link via nbviewer or binder.


---

Comment by git created at 2019-12-17 09:09:51

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by Dicolevrai created at 2019-12-17 09:26:02

I have removed the Jupyter notebook `ClassDegenerateMetric.ipynb` added by mistake.


---

Comment by git created at 2019-12-21 17:56:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2019-12-21 18:13:13

I've fix some issues in the last commit. Some of them were revealed by the patchbot:
- the documentation failed to build, due to the duplicate reference `[DS2010]` in `src/doc/en/reference/references/index.rst`
- the startup time was increased due to these unnecessary import statements in `src/sage/manifolds/all.py`:

```
import sage.manifolds.differentiable.degenerate
import sage.manifolds.differentiable.degenerate_submanifold
```


Other fixes:
- the files `degenerate.py` and `degenerate_submanifold.py` were in executable mode; I've removed this
- there was a regression regarding the unique tag of manifolds in `src/sage/manifolds/manifold.py`; I've restored the change introduced in #28365
- many typos in the documentation

Besides, I've added some authorship mention, with your name, as well as the standard GPL notice (there should be one in each source file). 

As usual, you can see the changes by clicking on the blue commit number 6b5e586 in comment:44.


---

Comment by egourgoulhon created at 2019-12-21 18:32:25

About the `Cc` field: there is no need to add me, since I participate in the ticket discussion and therefore receive all notifications. The `Cc` field is useful only if you want to draw the attention of someone who has not taken part yet in the ticket discussion. Moreover, you should fill this field with his/her username, not real name (NB: this is the opposite of the `Authors` and `Reviewers` fields, which must be filled by real names).


---

Comment by egourgoulhon created at 2019-12-22 16:37:20

The patchbot is green, but the documentation still requires some improvements.
For instance

- the method `mean_curvature()` of class `DegenerateSubmanifold` has an `OUTPUT` section reduced to _a dictionary_. This is not sufficient, you should tell what are the keys and the values of that dictionary. Same thing for `principal_directions()`.
- there are unnecessary semicolons at the end of the `INPUT` and `OUTPUT` fields in `projection()` (and maybe elsewhere)
- the description of `screen_projection()` is not understandable: _...T′(v1,…,vr) is the projection of T(v1,…,vr) on the bundle spans by screen along the bundle spans by the transversal plus the radical vector fields provided._ Should _spans_ be _spanned_? Same thing in `projection()`. 
- A `Phi` sould be `\Phi`

Could you please check the html output of the documentation and correct other possible errors?


---

Comment by egourgoulhon created at 2019-12-22 16:37:20

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-12-23 15:48:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-12-23 16:12:32

Changing status from needs_work to needs_review.


---

Comment by Dicolevrai created at 2019-12-23 16:12:32

I have fixed the documentations of the methods `mean_curvature()`, `principal_directions()`, `projection()`, `screen_projection()`, `projection()`, and some others.


---

Comment by git created at 2019-12-27 14:08:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2019-12-27 14:16:42

Replying to [comment:50 Dicolevrai]:
> I have fixed the documentations of the methods `mean_curvature()`, `principal_directions()`, `projection()`, `screen_projection()`, `projection()`, and some others. 

Thanks. In the last commit, I've corrected some typos.

The classes `TangentTensor` and `Screen` are missing an `EXAMPLE` section.


---

Comment by git created at 2019-12-27 20:17:02

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by Dicolevrai created at 2019-12-27 20:23:24

Section `EXAMPLE` added in classes `TangentTensor` and `Screen`.


---

Comment by git created at 2019-12-28 11:01:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2019-12-28 11:09:13

Replying to [comment:54 Dicolevrai]:
> Section `EXAMPLE` added in classes `TangentTensor` and `Screen`.

Thanks. You performed a forced push with your changes on a branch which was not the latest one and hence did not contain the typo fixes introduced in comment:51. The latter are reintroduced in the above commit (comment:55), as well as a bunch of other fixes in the documentation.


---

Comment by git created at 2019-12-28 13:37:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-12-28 13:42:36

Replying to [comment:56 egourgoulhon]:
> Replying to [comment:54 Dicolevrai]:
> > Section `EXAMPLE` added in classes `TangentTensor` and `Screen`.
> 
> Thanks. You performed a forced push with your changes on a branch which was not the latest one and hence did not contain the typo fixes introduced in comment:51. The latter are reintroduced in the above commit (comment:55), as well as a bunch of other fixes in the documentation.

I'm so sorry. I solved the problem, thank you.


---

Comment by egourgoulhon created at 2019-12-31 11:18:35

I am not sure that the two commits added in comment:57 were necessary, but anyway...

There is an error revealed by the patchbot: in `degenerate_submanifold.py`, `EXAMPLE:` must be changed to `EXAMPLES:`.


---

Comment by git created at 2019-12-31 11:29:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Dicolevrai created at 2019-12-31 11:32:04

Replying to [comment:59 egourgoulhon]:
> There is an error revealed by the patchbot: in `degenerate_submanifold.py`, `EXAMPLE:` must be changed to `EXAMPLES:`. 

I did it, thanks!


---

Comment by egourgoulhon created at 2019-12-31 14:47:21

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2019-12-31 14:47:21

The patchbot is now green and it is time for this to go into Sage. Thank you for your work on this ticket!


---

Comment by chapoton created at 2020-01-01 21:01:32

9.0 is out


---

Comment by vbraun created at 2020-01-05 15:47:49

Resolution: fixed
