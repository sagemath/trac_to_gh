# Issue 32618: Meta-ticket: support macOS 12 Monterey

Issue created by migration from https://trac.sagemath.org/ticket/32855

Original creator: dimpase

Original creation time: 2021-11-11 21:34:55

CC:  mkoeppe jhpalmieri




---

Comment by jhpalmieri created at 2021-11-13 19:21:10

I don't know if this has to do with Monterey, but I am having problems with plotting. Not actual plotting — that seems to be okay in interactive Sage sessions — but plotting in the documentation and doctests:
- the inventory build for `reference/plotting` hangs.
- lots of doctests time out, and the message always lists a plotting command as the last one before the timeout. For example:

```
Tests run before process (pid=77565) timed out:
sage: plot(x^2, (x,-2,2)) ## line 60 ##
Graphics object consisting of 1 graphics primitive
sage: regular = plot(x^2, (x,-2,2), color= 'purple') ## line 67 ##
sage: skinny = plot(4*x^2, (x,-2,2), color = 'green') ## line 68 ##
sage: regular + skinny ## line 69 ##
Graphics object consisting of 2 graphics primitives
sage: plot(1+e^(-x^2), xmin=-2, xmax=2, ymin=0, ymax=2.5, figsize=10) ## line 79 ##
Graphics object consisting of 1 graphics primitive
sage: exponential = plot(1+e^(-x^2), xmin=-2, xmax=2, ymin=0, ymax=2.5) ## line 88 ##
sage: max_line = plot(2, xmin=-2, xmax=2, linestyle='-.', color = 'red') ## line 89 ##
sage: min_line = plot(1, xmin=-2, xmax=2, linestyle=':', color = 'red') ## line 90 ##
sage: exponential + max_line + min_line ## line 91 ##
Graphics object consisting of 3 graphics primitives
sage: exponential = plot(1+e^(-x^2), xmin=-2, xmax=2, ymin=0, ymax=2.5, fill=0.5, fillcolor='grey', fillalpha=0.3) ## line 99 ##
sage: min_line = plot(1, xmin=-2, xmax=2, linestyle='-', thickness= 6, color = 'red') ## line 100 ##
sage: exponential + min_line ## line 101 ##
Graphics object consisting of 3 graphics primitives
sage: sum([plot(x^n,(x,0,1),color=rainbow(5)[n]) for n in [0..4]]) ## line 106 ##
Graphics object consisting of 5 graphics primitives
sage: t = var('t') ## line 128 ##
sage: parametric_plot([cos(t) + 3 * cos(t/9), sin(t) - 3 * sin(t/9)], (t, 0, 18*pi), fill = True, aspect_ratio=1) ## line 129 ##
Graphics object consisting of 2 graphics primitives
sage: t = var('t') ## line 149 ##
sage: parametric_plot((t^2,sin(t)), (t,0,pi)) ## line 150 ##
Graphics object consisting of 1 graphics primitive
sage: parametric_plot((t^2,sin(t),cos(t)), (t,0,pi)) ## line 155 ##
------------------------------------------------------------------------
0   signals.cpython-39-darwin.so        0x000000010427c6c2 print_backtrace + 66
1   signals.cpython-39-darwin.so        0x0000000104280517 sigdie + 39
2   signals.cpython-39-darwin.so        0x00000001042803a0 cysigs_signal_handler + 288
3   libsystem_platform.dylib            0x00007ff811061e2d _sigtramp + 29
4   ???                                 0x0000000102f46040 0x0 + 4344537152
5   Python                              0x00000001032d90ac cfunction_vectorcall_FASTCALL + 95
6   Python                              0x0000000103386058 call_function + 168
7   Python                              0x000000010337f773 _PyEval_EvalFrameDefault + 27880
8   Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
9   Python                              0x0000000103386058 call_function + 168
10  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
11  Python                              0x0000000103377991 _PyEval_EvalCode + 411
12  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
13  Python                              0x0000000103290423 method_vectorcall + 160
14  Python                              0x0000000103386058 call_function + 168
15  Python                              0x000000010337db59 _PyEval_EvalFrameDefault + 20686
16  Python                              0x0000000103377991 _PyEval_EvalCode + 411
17  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
18  Python                              0x0000000103290423 method_vectorcall + 160
19  Python                              0x0000000103386058 call_function + 168
20  Python                              0x000000010337db59 _PyEval_EvalFrameDefault + 20686
21  Python                              0x0000000103377991 _PyEval_EvalCode + 411
22  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
23  Python                              0x0000000103386058 call_function + 168
24  Python                              0x000000010337db59 _PyEval_EvalFrameDefault + 20686
25  Python                              0x0000000103377991 _PyEval_EvalCode + 411
26  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
27  Python                              0x0000000103290423 method_vectorcall + 160
28  Python                              0x000000010328d4e0 PyVectorcall_Call + 164
29  base.cpython-39-darwin.so           0x000000015ebcf68e __pyx_pf_4sage_4plot_6plot3d_4base_10Graphics3d_10_rich_repr_jmol + 7870
30  base.cpython-39-darwin.so           0x000000015ebb494b __pyx_pw_4sage_4plot_6plot3d_4base_10Graphics3d_11_rich_repr_jmol + 171
31  Python                              0x00000001032d8701 cfunction_call + 52
32  base.cpython-39-darwin.so           0x000000015ebb04e6 __pyx_pw_4sage_4plot_6plot3d_4base_10Graphics3d_7_rich_repr_ + 3622
33  Python                              0x00000001032994db method_vectorcall_VARARGS_KEYWORDS + 163
34  Python                              0x0000000103386058 call_function + 168
35  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
36  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
37  Python                              0x0000000103386058 call_function + 168
38  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
39  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
40  Python                              0x0000000103386058 call_function + 168
41  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
42  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
43  Python                              0x0000000103290423 method_vectorcall + 160
44  Python                              0x000000010337e257 _PyEval_EvalFrameDefault + 22476
45  Python                              0x0000000103377991 _PyEval_EvalCode + 411
46  Python                              0x00000001033726d9 builtin_exec + 389
47  Python                              0x00000001032d90ac cfunction_vectorcall_FASTCALL + 95
48  Python                              0x0000000103386058 call_function + 168
49  Python                              0x000000010337da95 _PyEval_EvalFrameDefault + 20490
50  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
51  Python                              0x0000000103386058 call_function + 168
52  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
53  Python                              0x0000000103377991 _PyEval_EvalCode + 411
54  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
55  Python                              0x0000000103386058 call_function + 168
56  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
57  Python                              0x0000000103377991 _PyEval_EvalCode + 411
58  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
59  Python                              0x0000000103386058 call_function + 168
60  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
61  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
62  Python                              0x0000000103386058 call_function + 168
63  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
64  Python                              0x0000000103377991 _PyEval_EvalCode + 411
65  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
66  Python                              0x000000010328d017 _PyObject_FastCallDictTstate + 87
67  Python                              0x00000001032fae18 slot_tp_call + 187
68  Python                              0x000000010328cde6 _PyObject_MakeTpCall + 129
69  Python                              0x00000001033860c7 call_function + 279
70  Python                              0x000000010337da95 _PyEval_EvalFrameDefault + 20490
71  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
72  Python                              0x0000000103386058 call_function + 168
73  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
74  Python                              0x0000000103377991 _PyEval_EvalCode + 411
75  Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
76  Python                              0x0000000103290423 method_vectorcall + 160
77  Python                              0x0000000103386058 call_function + 168
78  Python                              0x000000010337db59 _PyEval_EvalFrameDefault + 20686
79  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
80  Python                              0x0000000103386058 call_function + 168
81  Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
82  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
83  Python                              0x000000010328d017 _PyObject_FastCallDictTstate + 87
84  Python                              0x00000001032fc21f slot_tp_init + 192
85  Python                              0x0000000103301666 type_call + 272
86  Python                              0x000000010328cde6 _PyObject_MakeTpCall + 129
87  Python                              0x00000001033860c7 call_function + 279
88  Python                              0x000000010337da95 _PyEval_EvalFrameDefault + 20490
89  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
90  Python                              0x0000000103386058 call_function + 168
91  Python                              0x000000010337f773 _PyEval_EvalFrameDefault + 27880
92  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
93  Python                              0x0000000103386058 call_function + 168
94  Python                              0x000000010337f773 _PyEval_EvalFrameDefault + 27880
95  Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
96  Python                              0x0000000103290423 method_vectorcall + 160
97  Python                              0x0000000103386058 call_function + 168
98  Python                              0x000000010337f773 _PyEval_EvalFrameDefault + 27880
99  Python                              0x0000000103377991 _PyEval_EvalCode + 411
100 Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
101 Python                              0x0000000103386058 call_function + 168
102 Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
103 Python                              0x0000000103377991 _PyEval_EvalCode + 411
104 Python                              0x000000010328d8f4 _PyFunction_Vectorcall + 373
105 Python                              0x0000000103386058 call_function + 168
106 Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
107 Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
108 Python                              0x0000000103386058 call_function + 168
109 Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
110 Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
111 Python                              0x0000000103386058 call_function + 168
112 Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
113 Python                              0x000000010328d83f _PyFunction_Vectorcall + 192
114 Python                              0x0000000103386058 call_function + 168
115 Python                              0x000000010337e7b0 _PyEval_EvalFrameDefault + 23845
116 Python                              0x0000000103377991 _PyEval_EvalCode + 411
117 Python                              0x00000001033d2e26 run_eval_code_obj + 128
118 Python                              0x00000001033d2d74 run_mod + 96
119 Python                              0x00000001033d05a3 pyrun_file + 167
120 Python                              0x00000001033cff94 pyrun_simple_file + 271
121 Python                              0x00000001033cfe5f PyRun_SimpleFileExFlags + 67
122 Python                              0x00000001033efafa pymain_run_file + 326
123 Python                              0x00000001033ef33e Py_RunMain + 990
124 Python                              0x00000001033f0400 pymain_main + 35
125 Python                              0x00000001033f06d6 Py_BytesMain + 42
126 dyld                                0x000000011068b4fe start + 462
127 ???                                 0x0000000000000000 0x0 + 0
128 Python                              0x0000000102dbd000 __dso_handle + 0
```

 (This particular example is from a build using a merge of branches from #32852 and #32759, with `make distclean && ./configure && make ptest`, and also with `SAGE_DOCBUILD_OPTS=' --no-plot'` so that the docs actually build.)


---

Comment by jhpalmieri created at 2021-11-13 19:24:32

I would be happy to hear suggestions for system (homebrew) packages to disable, in case some of them might be the culprits.


---

Comment by jhpalmieri created at 2021-11-17 05:11:12

After reinstalling my `homebrew` packages several times and restarting the computer several times, the problem has gone away.


---

Comment by dimpase created at 2021-11-17 13:56:40

OK, so it seems that macOS 11 -> macOS 12 transition is quite smooth (as opposed to macOS 10 -> macOS 11).


---

Comment by chapoton created at 2022-01-29 08:58:50

bump to 9.6


---

Comment by mkoeppe created at 2022-03-04 23:27:47

We can probably close this one


---

Comment by mkoeppe created at 2022-03-04 23:27:47

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2022-03-04 23:30:13

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2022-03-04 23:30:13

Yes, I agree.


---

Comment by mkoeppe created at 2022-05-11 02:14:43

Resolution: invalid
