# Issue 29053: sage.schemes.elliptic_curves.mod_sym_num breaks Cygwin build (9.1.beta6)

Issue created by migration from https://trac.sagemath.org/ticket/29290

Original creator: @darijgr

Original creation time: 2020-03-06 22:36:50

CC:  embray dimpase fbissey wuthrich

Keywords: cython, elliptic curves, schemes

Installing sage 9.1.beta6 on Cygwin currently chokes on sage/schemes/elliptic_curves/mod_sym_num.c (which comes from sage/schemes/elliptic_curves/mod_sym_num.pyx):


```
[sagelib-9.1.beta6] [467/509] gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I./sage/cpython -I/home/skraeling/sage/local/lib/python3.7/site-packages/cypari2 -I./sage/libs/ntl -I/home/skraeling/sage/local/lib/python3.7/site-packages/cysignals -I/home/skraeling/sage/local/include -I/home/skraeling/sage/src -I/home/skraeling/sage/src/sage/ext -I/home/skraeling/sage/local/include/python3.7m -I/home/skraeling/sage/local/lib/python3.7/site-packages/numpy/core/include -Ibuild/cythonized -I/home/skraeling/sage/local/include/python3.7m -c build/cythonized/sage/schemes/elliptic_curves/mod_sym_num.c -o build/temp.cygwin-3.0.7-x86_64-3.7/build/cythonized/sage/schemes/elliptic_curves/mod_sym_num.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=gnu99
[sagelib-9.1.beta6] In file included from /home/skraeling/sage/local/include/python3.7m/unicodeobject.h:58:0,
[sagelib-9.1.beta6]                  from /home/skraeling/sage/local/include/python3.7m/Python.h:99,
[sagelib-9.1.beta6]                  from build/cythonized/sage/schemes/elliptic_curves/mod_sym_num.c:51:
[sagelib-9.1.beta6] build/cythonized/sage/schemes/elliptic_curves/mod_sym_num.c:1838:64: error: expected identifier or â€˜(â€™ before numeric constant
[sagelib-9.1.beta6]    __pyx_t_4sage_7schemes_15elliptic_curves_11mod_sym_num_llong _N;
[sagelib-9.1.beta6]                                                                 ^
```


... and tons and tons of other errors that all seem to come from `_N` attributes in that pyx file.

I don't understand C well enough to trace this back to its origins, but it looks like a clash of variable names.


---

Comment by @darijgr created at 2020-03-09 18:14:22

Still broken on beta7.


---

Comment by mkoeppe created at 2020-04-20 06:25:12

Changing priority from major to blocker.


---

Comment by mkoeppe created at 2020-04-20 07:08:12

New commits:


---

Comment by mkoeppe created at 2020-04-20 07:08:12

Changing status from new to needs_review.


---

Comment by fbissey created at 2020-04-20 07:33:52

I have to ask, why `_N4711`?


---

Comment by mkoeppe created at 2020-04-20 07:35:18

to mask the odor


---

Comment by fbissey created at 2020-04-20 07:37:08

Replying to [comment:9 mkoeppe]:
> to mask the odor

It sure does smell, but I may miss some context if there is an allusion.


---

Comment by wuthrich created at 2020-04-20 10:30:01

I would really prefer if that is `_N_E` or `_conductor` or `_NE` rather than the very confusing `_N4711`.

I  don't think I can review the patch as I don't have cygwin.


---

Comment by dimpase created at 2020-04-20 11:05:27

Replying to [comment:11 wuthrich]:
> I would really prefer if that is `_N_E` or `_conductor` or `_NE` rather than the very confusing `_N4711`.
> 
> I  don't think I can review the patch as I don't have cygwin. 

all you need to build on cygwin is a github account, if you followed the latest trends.


---

Comment by wuthrich created at 2020-04-20 14:52:13

I change the names _N to something meaningful.
----
New commits:


---

Comment by dimpase created at 2020-04-20 15:18:46

here https://github.com/sagemath/sagetrac-mirror/blob/master/src/doc/en/developer/portability_testing.rst?id=1f7e16a72e39fb0a154cfb3d4eec1c3cbe9877da#n831 (it's already merged in the latest develop) you can read how to run tests on Cygwin etc via [GitHub](GitHub).

Basically, you need a fork of sage repo on [GitHub](GitHub), then you can make a pull request to the develop branch of your fork from a branch incorporating this ticket, and then in about 12 hours you get the results with tests etc.


---

Comment by mkoeppe created at 2020-04-20 15:56:25

Replying to [comment:13 wuthrich]:
> I change the names _N to something meaningful.

Thanks! I was hoping for that.


---

Comment by wuthrich created at 2020-04-20 18:01:04

> Basically, you need a fork of sage repo on [GitHub](GitHub), then you can make a pull request to the develop branch of your fork from a branch incorporating this ticket, and then in about 12 hours you get the results with tests etc.

Thanks for the explanation, but I really need to focus the little time I have left on different things than this. Sorry.


---

Comment by mkoeppe created at 2020-04-20 21:50:47

There's a stray comma at the end of a line in the patch


---

Comment by mkoeppe created at 2020-04-20 23:26:16

New commits:


---

Comment by mkoeppe created at 2020-04-20 23:28:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-04-23 22:33:28

Resolution: fixed
