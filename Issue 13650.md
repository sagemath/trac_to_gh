# Issue 13650: Fix of _matrix_times_vector_

Issue created by migration from https://trac.sagemath.org/ticket/13854

Original creator: tfeulner

Original creation time: 2012-12-20 10:30:44

Assignee: AlexGhitza

Keywords: non-commutative ring, matrix vector product

For non-commutative rings the method `Matrix_sparse._matrix_times_vector_` does not take care of the right multiplication order in the ring, for example:
 

```
sage: A.<x,y> = FreeAlgebra(QQ, 2)
sage: P.<x,y> = A.g_algebra(relations={y*x:-x*y}, order = 'lex')
sage: M = Matrix([[x]])
sage: v = vector([y])
sage: M*v
(x*y)
sage: M.sparse_matrix()*v
(-x*y)
```


This patch fixes this bug.



---

Comment by tfeulner created at 2012-12-20 10:39:24

Changing status from new to needs_review.


---

Comment by tscrim created at 2012-12-30 03:00:29

Could you add some doctests showing this issue is fixed with a message like `Fixed right multiplication order in :trac:`13854`::`

Thanks,

Travis


---

Comment by tfeulner created at 2012-12-31 08:37:52

Replying to [comment:2 tscrim]:
> Could you add some doctests showing this issue is fixed with a message like `Fixed right multiplication order in :trac:`13854`::`
> 
> Thanks,

> Travis

Done. I was not sure how to catch the UserWarning on modules over non-commutative
rings. Is this the right way?

Best wishes,

Thomas


---

Comment by tscrim created at 2012-12-31 17:47:57

Hey Thomas,

I don't think so. The best way is to have the warning output in the doctest (or if possible, change the doctest to avoid the warning).

Thanks,

Travis


---

Comment by tfeulner created at 2013-01-02 14:12:19

Replying to [comment:4 tscrim]:
> Hey Thomas,
> 
> I don't think so. The best way is to have the warning output in the doctest (or if possible, change the doctest to avoid the warning).
> 
> Thanks,

> Travis

Hey Travis,
thanks, for your help. Now, the patch also contains these warnings.

Best wishes,

Thomas


---

Comment by tscrim created at 2013-01-02 14:51:04

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-01-02 14:51:04

Looks good to me. Thank you.


---

Comment by jdemeyer created at 2013-01-03 10:48:23

The indentation in the doctest isn't right. It should be

```
    EXAMPLES::

        sage: ...

    Some text explaining what happens next::

        sage: ...
```



---

Attachment

Replying to [comment:7 jdemeyer]:
> The indentation in the doctest isn't right. It should be
> {{{
>     EXAMPLES::
> 
>         sage: ...
> 
>     Some text explaining what happens next::
> 
>         sage: ...
> }}}
Sorry for that. This patch corrects the wrong indentation in `Matrix_sparse._vector_times_matrix`, too.

Thomas_


---

Comment by jdemeyer created at 2013-01-04 09:02:08

Thanks!


---

Comment by jdemeyer created at 2013-01-07 20:56:41

Resolution: fixed
