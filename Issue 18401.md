# Issue 18401: component() fails for some linear matroids

archive/issues_018401.json:
```json
{
    "body": "CC:  rudi\n\nThe code introduced in ticket:18591 fails on some `LinearMatroid`. \n\nConsider the following examples\n\n```\nsage: M = Matroid(Matrix([[1,0,0,0,1,0,0],\n[0,1,0,0,0,1,0],\n[0,0,1,0,0,1,1],\n[0,0,0,1,1,0,1]]))\nsage: M2 = Matroid(circuits=[[2, 3, 5, 6],\n[0, 1, 2, 3, 5],\n[2, 3, 4],\n[0, 1, 6],\n[0, 1, 4, 5],\n[4, 5, 6]])\nsage: set(M.components()) # the components share an element\n{frozenset({1, 2, 5, 6}), frozenset({0, 3, 4, 6})}\nsage: set(M2.components())\n{frozenset({0, 1, 2, 3, 4, 5, 6})}\nsage: M2.is_isomorphic(M)\nTrue\nsage: set(M.components()) # strange, the result become correct after isomorphism testing\n{frozenset({0, 1, 2, 3, 4, 5, 6})}\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18638\n\n",
    "created_at": "2015-06-08T17:02:08Z",
    "labels": [
        "matroid theory",
        "major",
        "bug"
    ],
    "title": "component() fails for some linear matroids",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18401",
    "user": "chaoxu"
}
```
CC:  rudi

The code introduced in ticket:18591 fails on some `LinearMatroid`. 

Consider the following examples

```
sage: M = Matroid(Matrix([[1,0,0,0,1,0,0],
[0,1,0,0,0,1,0],
[0,0,1,0,0,1,1],
[0,0,0,1,1,0,1]]))
sage: M2 = Matroid(circuits=[[2, 3, 5, 6],
[0, 1, 2, 3, 5],
[2, 3, 4],
[0, 1, 6],
[0, 1, 4, 5],
[4, 5, 6]])
sage: set(M.components()) # the components share an element
{frozenset({1, 2, 5, 6}), frozenset({0, 3, 4, 6})}
sage: set(M2.components())
{frozenset({0, 1, 2, 3, 4, 5, 6})}
sage: M2.is_isomorphic(M)
True
sage: set(M.components()) # strange, the result become correct after isomorphism testing
{frozenset({0, 1, 2, 3, 4, 5, 6})}
```


Issue created by migration from https://trac.sagemath.org/ticket/18638





---

archive/issue_comments_249920.json:
```json
{
    "body": "Hi Chao,\n\nSomehow I had overlooked the fact that there exists a command for testing if two bitsets intersect when I wrote this method. \nAnd so cooked up a fiddly method for checking bitset intersection. Surely that is the problem. It apparently fails to detect the intersection when it happens only at the last element. \n\nI'll upload a fix as soon as Sage is compiled.\n\nCheers,\nRudi",
    "created_at": "2015-06-08T17:45:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249920",
    "user": "Rudi"
}
```

Hi Chao,

Somehow I had overlooked the fact that there exists a command for testing if two bitsets intersect when I wrote this method. 
And so cooked up a fiddly method for checking bitset intersection. Surely that is the problem. It apparently fails to detect the intersection when it happens only at the last element. 

I'll upload a fix as soon as Sage is compiled.

Cheers,
Rudi



---

archive/issue_comments_249921.json:
```json
{
    "body": "Hmm, something else was subtly wrong: the order in which I checked intersections did not guarantee that the final set was a partition. I now use the same order as Matroid.components() again.\n\n```\nsage: M = Matroid(Matrix([[1,0,0,0,1,0,0],\n[0,1,0,0,0,1,0],\n[0,0,1,0,0,1,1],\n[0,0,0,1,1,0,1]]))\nsage: list(M.components())\n[frozenset({0, 1, 2, 3, 4, 5, 6})]\nsage: M = Matroid(MatrixSpace(GF(2), 500,1000).random_element())\nsage: timeit(\"M.components()\")\n625 loops, best of 3: 210 \u00b5s per loop\n```\n\n----\nNew commits:",
    "created_at": "2015-06-08T18:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249921",
    "user": "Rudi"
}
```

Hmm, something else was subtly wrong: the order in which I checked intersections did not guarantee that the final set was a partition. I now use the same order as Matroid.components() again.

```
sage: M = Matroid(Matrix([[1,0,0,0,1,0,0],
[0,1,0,0,0,1,0],
[0,0,1,0,0,1,1],
[0,0,0,1,1,0,1]]))
sage: list(M.components())
[frozenset({0, 1, 2, 3, 4, 5, 6})]
sage: M = Matroid(MatrixSpace(GF(2), 500,1000).random_element())
sage: timeit("M.components()")
625 loops, best of 3: 210 Âµs per loop
```

----
New commits:



---

archive/issue_comments_249922.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-08T18:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249922",
    "user": "Rudi"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_249923.json:
```json
{
    "body": "Tested on a large random sample of matrices and behavior is correct.",
    "created_at": "2015-06-10T18:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249923",
    "user": "chaoxu"
}
```

Tested on a large random sample of matrices and behavior is correct.



---

archive/issue_comments_249924.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-06-10T18:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249924",
    "user": "chaoxu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_249925.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-11T22:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18401#issuecomment-249925",
    "user": "vbraun"
}
```

Resolution: fixed
