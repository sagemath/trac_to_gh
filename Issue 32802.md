# Issue 32802: Random doctest failure in continued_fraction_gosper

Issue created by migration from https://trac.sagemath.org/ticket/33039

Original creator: @kliem

Original creation time: 2021-12-17 14:49:17


```
sage -t --long --random-seed=129865150212556213443045001147722733023 src/sage/rings/continued_fraction_gosper.py
**********************************************************************
File "src/sage/rings/continued_fraction_gosper.py", line 109, in sage.rings.continued_fraction_gosper.gosper_iterator.__iter__
Failed example:
    lg = [next(ig) for _ in range(10)]; lcf = [next(icf) for _ in range(10)];
Exception raised:
    Traceback (most recent call last):
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.continued_fraction_gosper.gosper_iterator.__iter__[4]>", line 1, in <module>
        lg = [next(ig) for _ in range(Integer(10))]; lcf = [next(icf) for _ in range(Integer(10))];
      File "<doctest sage.rings.continued_fraction_gosper.gosper_iterator.__iter__[4]>", line 1, in <listcomp>
        lg = [next(ig) for _ in range(Integer(10))]; lcf = [next(icf) for _ in range(Integer(10))];
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/rings/continued_fraction_gosper.py", line 138, in __next__
        raise StopIteration
    StopIteration
**********************************************************************
File "src/sage/rings/continued_fraction_gosper.py", line 110, in sage.rings.continued_fraction_gosper.gosper_iterator.__iter__
Failed example:
    lg == lcf
Exception raised:
    Traceback (most recent call last):
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.continued_fraction_gosper.gosper_iterator.__iter__[5]>", line 1, in <module>
        lg == lcf
    NameError: name 'lg' is not defined
**********************************************************************
File "src/sage/rings/continued_fraction_gosper.py", line 125, in sage.rings.continued_fraction_gosper.gosper_iterator.__next__
Failed example:
    for i in range(10):
        assert next(ig) == next(icf)
Exception raised:
    Traceback (most recent call last):
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.continued_fraction_gosper.gosper_iterator.__next__[4]>", line 2, in <module>
        assert next(ig) == next(icf)
      File "/home/jonathan/Applications/sage/local/lib/python3.8/site-packages/sage/rings/continued_fraction_gosper.py", line 138, in __next__
        raise StopIteration
    StopIteration
**********************************************************************
2 items had failures:
   2 of   7 in sage.rings.continued_fraction_gosper.gosper_iterator.__iter__
   1 of   6 in sage.rings.continued_fraction_gosper.gosper_iterator.__next__
    [40 tests, 3 failures, 0.04 s]
----------------------------------------------------------------------
sage -t --long --random-seed=129865150212556213443045001147722733023 src/sage/rings/continued_fraction_gosper.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

Comment by @kliem created at 2021-12-17 14:52:54

New commits:


---

Comment by @kliem created at 2021-12-17 14:52:54

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-12-18 08:53:50

break rather than pass, maybe ?


---

Comment by git created at 2021-12-18 09:44:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-12-18 09:45:25

I also added a new doctest for `__next__`, as it is completely pointless to have two times the same tests.


---

Comment by chapoton created at 2021-12-18 19:02:11

ok, thanx


---

Comment by chapoton created at 2021-12-18 19:02:11

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2022-01-30 15:39:13

Setting milestone to 9.6 now that 9.5 is out.


---

Comment by vbraun created at 2022-02-12 22:05:19

Resolution: fixed
