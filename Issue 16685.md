# Issue 16685: find_brouwer_van_rees_with_one_truncated_column

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2014-09-02 16:33:51

CC:  vdelecroix

Here is what we have been waiting for. Removes a lot of '-', but in parts of the table that we do not see `:-P`


---

Comment by ncohen created at 2014-09-02 16:34:08

Changing status from new to needs_review.


---

Comment by git created at 2014-09-02 16:36:55

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by vdelecroix created at 2014-10-26 12:01:44

Hi Nathann,

I got a lot of segmentation error while running the tests with this branch! Do you know what happen?

Vincent


---

Comment by vdelecroix created at 2014-10-26 12:01:44

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2014-10-26 12:26:02

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2014-10-26 12:26:02

Sorry about that. Don't know where the segfaults came from, but when I solved the bug about the "more than 4 values needed to unpack" there was none left.

Also, I rewrote history to move this last commit above its dependencies (in which commits had been added in the meantime).

This should be better now.

By the way: the current implementation may look a bit "hacky". The thing is that it is 'a bit too early' to implement this construction, because at the moment there are no 'nice' functions to query the database of incomplete orthogonal arrays, and there is none yet because caching incomplete orthogonal arrays is much harder than caching orthogonal arrays (more parameters, mainly !). In the future we may even have find functions for incomplete orthogonal arrays and stuff.

Well, I have to write that and because it is not exactly straightforward to get a good design (and because it requires a lot of 'administrative' code) I implemented that first.

Still, it works and it is not so bad.

Well, just know that I am not intending to leave that code in the current state. Though I tried to not make it too awful either, and of course the review is there to fix anything you will not like.

Branch updated.

Nathann


---

Comment by git created at 2014-10-26 12:28:50

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-10-26 15:36:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-10-26 15:40:12

Hi Nathann,

I changed the complexity of `multiple` by one order. And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).

Have a look and tell me if it is worth it to add this cut.

Vincent


---

Comment by ncohen created at 2014-10-26 15:52:16

> I changed the complexity of `multiple` by one order. 

True, True. Well done `O_o`

> And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).

Well, technically can't we do it with `log(k)` iterations instead of `k` ?

I mean, if you call `S^n={x_1+...+x_n: x_i \in S}` then you can use the log algorithm to compute the power of a matrix, can't you ? And you can do even faster is you initialize `D` with `D = {r*x:tuple([x]*r) for x in S for r in tuple(range(cutoff/x+1))}`.

Keep in mind that this function will change, somehow. I mean... If we want to be able to do the same for the Brouwer-van Rees decomposition with 2 truncated columns, the problem is very different: in each column you can have any combinations of 'allowed value', but you cannot have a multiplier x in column 1 and a multiplier y in column 2 unless you have an `OA(k,m+x+y)-OA(k,x)-OA(k,y)`.

I still don't know how to write that nicely `T_T`

Nathann


---

Comment by ncohen created at 2014-10-26 15:58:16

Yo !

> Have a look and tell me if it is worth it to add this cut.

It is up to you. I am not sure that it is necessary at the moment: I hope that this will all be rewritten in not so long to handle two columns.

Nathann


---

Comment by git created at 2014-10-26 16:26:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-10-26 16:27:49

All right. Done.

I find it much clearer. Perhaps less nicer to make it works for two columns...

Vincent


---

Comment by ncohen created at 2014-10-26 22:24:44

What is the point of making it decrease toward zero ? `O_o`

To have more meaningful comments like
`if (vv > 0 and   # The new integer i is too big` ?

Honestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?

You even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...

Nathann


---

Comment by vdelecroix created at 2014-10-27 11:11:44

Replying to [comment:12 ncohen]:
> What is the point of making it decrease toward zero ? `O_o`
> 
> To have more meaningful comments like
> `if (vv > 0 and   # The new integer i is too big` ?
> 
> Honestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?
> 
> You even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...

Hum. `j` *is* useful as it is the remaining number of steps and allow to cut branches when the maximum number of steps allowed (i.e. `k_max`) is relatively small.

```
+ if (vv > 0 and            # The new integer i is too big
+     vv <= j*max_value and # The new integer i is too small
+     vv not in D and       # We had it in D already
+     vv not in new_D):     # We had it in new_D already
```


Vincent


---

Comment by ncohen created at 2014-10-27 12:29:38

This code is awful.

Anyway, I will rewrite it soon.

Nathann


---

Comment by ncohen created at 2014-10-27 13:09:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-10-29 10:39:53

Resolution: fixed
