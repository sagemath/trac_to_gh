# Issue 21694: Hypergraph: is_berge_acyclic method

Issue created by migration from Trac.

Original creator: pelegm

Original creation time: 2016-11-22 15:39:42

CC:  dcoudert vdelecroix

Keywords: hypergraph,days79

Wasn't sure, perhaps the method name `is_acyclic` is better?


---

Comment by pelegm created at 2016-11-22 15:40:08

Changing status from new to needs_review.


---

Comment by jipilab created at 2016-11-23 14:01:31

Could you give a reference (a book or an article) to the notion in the docstring? For example if _berge_ makes more sense than is_acyclic because it is used in several references. Is it the Berge from the book on graph theory? Could you then give that reference.

You can put your complete name in the Author field.

What is the most common usage? is_acyclic I would say is more explicit than _berge_

Then, in the docstring, you could mention that it is also sometimes called "Berge acyclic".

All test passed on Sage7.5.b3.


---

Comment by jipilab created at 2016-11-23 14:01:42

Changing status from needs_review to needs_work.


---

Comment by pelegm created at 2016-11-23 14:51:27

Thanks for your feedback!

I will add the proper definitions + references here, and later on I will add them to the docstrings.

a //k//-uniform **Berge cycle** of length is a cyclic list of distinct //k//-sets //F_1,...,F_l//, l>1, and distinct vertices //C = {v_1,...,v_l}// such that for each //1<=i<=l//, //F_i// contains //v_i// and //v_{i+1}// (where //v_{l+1} = v_1//).

This definition appears, for example, here:

- Füredi, Zoltán, and Tao Jiang. "Hypergraph Turán numbers of linear cycles." Journal of Combinatorial Theory, Series A 123.1 (2014): 252-270.

According to Wikipedia, this definition goes back to Claude Berge's book **Graphs and Hypergraphs**.
I saw it in the book by the following book of Berge:

- Berge, Claude. Hypergraphs: combinatorics of finite sets. Vol. 45. Elsevier, 1984.

It is not difficult to see that a hypergraph contains a Berge cycle if and only if its incidence graph contains a cycle.  This is also mentioned in the wikipedia page about hypergraphs.

The notions of **Berge-cyclic** and **Berge-acyclic** appear, for example, in the following paper:

- Fagin, Ronald. "Degrees of acyclicity for hypergraphs and relational database schemes." Journal of the ACM (JACM) 30.3 (1983): 514-550.

According to that paper, a hypergraph is Berge-cyclic if it has a Berge cycle; otherwise, it is Berge-acyclic.

Since this is the first known notion of cycles in hypergraphs, it makes sense to call it simply **cyclic** or **acyclic**, and these are indeed the notions that Berge has used; however, it seems like later authors have used the **Berge-** prefix, to make it less vague. I think, therefore, that we should keep the `berge_` prefix, and perhaps also add a `is_berge_cyclic` method as well.


---

Comment by pelegm created at 2016-11-23 15:59:52

Will rebase to `develop`.


---

Comment by pelegm created at 2016-11-25 09:10:41

Set assignee to pelegm.


---

Comment by git created at 2016-11-25 09:10:58

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by pelegm created at 2016-11-25 09:12:32

I have rebased to `develop`.  TODOs:

* add `is_berge_cyclic`
* extend docstring and add references


---

Comment by git created at 2016-11-25 11:21:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pelegm created at 2016-11-25 11:22:09

Changing status from needs_work to needs_review.


---

Comment by pelegm created at 2016-12-07 14:06:02

There are some typos, and I should probably move references to the main index file.


---

Comment by pelegm created at 2016-12-07 14:06:02

Changing status from needs_review to needs_work.


---

Comment by jipilab created at 2017-02-27 22:37:15

Ping!?


---

Comment by pelegm created at 2017-02-28 07:52:35

Sorry, busy days... will do it probably in a couple of weeks.


---

Comment by jipilab created at 2017-02-28 08:08:48

Hi Peleg,

There is a Sagedays from today. It would be good to have it ready for review!


---

Comment by git created at 2017-03-10 13:15:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by pelegm created at 2017-03-10 13:15:46

Rebased for develop; hope to finish it today.


---

Comment by git created at 2017-03-10 16:02:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-03-10 16:04:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pelegm created at 2017-03-10 16:08:52

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2017-05-04 07:12:14

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2017-05-04 07:12:14

- Could you make the reference labels uniform? You added `[Fag83]` and `[FT14]` while all others are of the form `[Fe1997]`, `[Fu1993]`.

- typo in the doc: `of length is a`

- I don't think it is necessary to have both `is_berge_acyclic` and `is_berge_cyclic`. Such duplication will moreover slow down the tab completion

```
sage: H.is_berge_<TAB>   # <-- nothing will happen with your version
```


- In the definition you do not mention that the hypergraph needs to be uniform but you do in the code


---

Comment by git created at 2017-05-12 10:33:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pelegm created at 2017-05-12 10:43:21

Passes tests now.


---

Comment by pelegm created at 2017-05-12 10:43:21

Changing status from needs_work to needs_review.


---

Comment by asante created at 2018-06-28 16:00:45

Patchbot complains about merge problems again (maybe due to changes to the global references file?)


---

Comment by asante created at 2018-06-28 16:00:45

Changing status from needs_review to needs_work.


---

Comment by asante created at 2018-06-28 16:00:45

Changing keywords from "hypergraph,days79" to "hypergraph,days79,days94".


---

Comment by pelegm created at 2018-06-29 06:20:24

Changing status from needs_work to needs_review.


---

Comment by pelegm created at 2018-06-29 06:20:24

Rebased.
----
New commits:


---

Comment by lftabera created at 2018-06-30 11:24:09

Looks good to me.

Some small issues:

In the documentation, "of length is a", I guess it lacks an \ell

In the references: it seems that there is no fixed style, but you can write the title of the references in italics using *asterisks*


---

Comment by lftabera created at 2018-06-30 11:24:09

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-06-30 11:39:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by @vipul79321 created at 2020-04-04 15:47:12

Changing status from needs_work to needs_info.


---

Comment by @vipul79321 created at 2020-04-04 15:47:12

After going through all the comment and definition of berge_acyclicity on Wikipedia[https://en.wikipedia.org/wiki/Hypergraph](https://en.wikipedia.org/wiki/Hypergraph)

We can add the following methods with proper reference and documentation

```
def is_berge_acyclic(self):
    if not self.is_uniform()
        raise TypeError("Berge cycles are defined for uniform hypergraphs only")

    return self.incidence_graph().is_forest()
```


----


```
def is_berge_cyclic(self):
    if not self.is_uniform():
        raise TypeError("Berge cycles are defined for uniform hypergraphs only")

    return not self.incidence_graph().is_forest()
```


If currently, nobody is pursuing this ticket, Maybe I can give it a try.


---

Comment by @vipul79321 created at 2020-04-15 13:31:59

Changing status from needs_info to needs_review.


---

Comment by git created at 2020-04-15 13:32:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-04-15 13:34:56

Replying to [comment:31 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[f2b0b2c](https://git.sagemath.org/sage.git/commit/?id=f2b0b2c70330556326830c8fd0799a1cdcabb321)||`added is_berge_cyclic for uniform hypergraphs`||

I have added `is_berge_cyclic` method for uniform hypergraphs with proper documentation and doc-test. \\
I have intentionally left `is_berge_acyclic`, because it kind of seemed duplicate in some sense.\\
Any feedback will be helpful


---

Comment by dcoudert created at 2020-04-15 17:05:48

Why raising an error and not simply returning False ?


---

Comment by @vipul79321 created at 2020-04-19 11:14:11

Replying to [comment:33 dcoudert]:
> Why raising an error and not simply returning False ?

As it is mentioned in Wikipedia -[https://en.wikipedia.org/wiki/Hypergraph](https://en.wikipedia.org/wiki/Hypergraph)\\

"In contrast with ordinary undirected graphs for which there is a single natural notion of cycles and acyclic graphs, there are multiple natural non-equivalent definitions of acyclicity for hypergraphs which collapse to ordinary graph acyclicity for the special case of ordinary graphs."\\

Due to the above-mentioned comment and also the definition which is written in the documentation of the method is for uniform hypergraph. That's why it is raising error for not being uniform, to be on the safe side.\\

PS: Although, I didn't find any text, restricting Berge acyclicity to uniform hypergraph. And also I am no expert in the matter of hypergraphs. So we can discuss whether to keep it as such or modify it.


---

Comment by dcoudert created at 2020-04-19 12:34:15

OK, let it as is.

Some corrections / complements

```diff
-        Test whether uniform hypergraph is Berge-Cyclic.
+        Check whether ``self`` is a Berge-Cyclic uniform hypergraph.
```



```diff
-        For more information, see [Fag1983]_
+        For more information, see [Fag1983]_ and :wikipedia:`Hypergraph`.
```


Also, have you checked corner cases like empty hypergraph ?


---

Comment by git created at 2020-04-21 18:04:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-04-21 18:15:53

Replying to [comment:36 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[ff5df19](https://git.sagemath.org/sage.git/commit/?id=ff5df1952b8e5f23105973025c326052beec8e57)||`Finalized and checked`||
I have updated according to suggestions in comment 35. And about boundary case of empty hypergraph, it gives the expected behavior. Since empty hypergraph is not uniform it is raising error(As expected).


---

Comment by dcoudert created at 2020-04-22 11:57:46

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-04-22 11:57:46

LGTM.


---

Comment by vbraun created at 2020-04-23 22:33:16

Resolution: fixed
