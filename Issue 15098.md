# Issue 15098: do not import sagenb at startup

Issue created by migration from https://trac.sagemath.org/ticket/15335

Original creator: chapoton

Original creation time: 2013-10-27 21:07:04

As explained here https://groups.google.com/forum/#!topic/sage-devel/zu9Oy1IwlEA

let us try to avoid importing sage.server.all *


---

Attachment

not ready, work in progress


---

Comment by chapoton created at 2013-10-28 08:29:47

Changing keywords from "" to "startup".


---

Comment by chapoton created at 2013-10-28 20:21:22

I suspect that the line

```
# For doctesting.
import sagenb
```

in sagenb/notebook/all.py could be the culprit. Could one juste remove this line ?


---

Comment by jdemeyer created at 2014-01-08 14:47:35

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-01-08 14:47:35

Changing component from interact to misc.


---

Comment by jdemeyer created at 2014-01-08 14:47:35

New commits:


---

Comment by tscrim created at 2014-01-08 19:39:04

I get close to a 25% speedup in startup time. I've fixed the failing doctest from the patchbot in `misc/dev_tools.py` that I could reproduce, so if that also works for you Jeroen, then this is a positive review from me.
----
New commits:


---

Comment by chapoton created at 2014-01-08 19:44:53

When running sage -t -a, I got a failure (same as the bot) in src/sage/all.py


---

Comment by jdemeyer created at 2014-01-08 19:47:08

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-01-08 19:47:08

The problem is some of these doctests now depend on the `--sagenb` option given to the doctester.


---

Comment by jdemeyer created at 2014-01-08 19:47:38

This works:

```
./sage -t src/sage/all.py
```


This doesn't:

```
./sage -t --sagenb src/sage/all.py
```



---

Comment by jdemeyer created at 2014-01-08 19:57:10

New commits:


---

Comment by jdemeyer created at 2014-01-08 19:57:53

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-01-08 19:57:53

Travis: agreed with your change.

[http://git.sagemath.org/sage.git/commit/?id=214bf49a7f28dd69489a874aba8037b4f9b64194](http://git.sagemath.org/sage.git/commit/?id=214bf49a7f28dd69489a874aba8037b4f9b64194) needs review to fix the `--sagenb` option issue.


---

Comment by tscrim created at 2014-01-08 20:22:48

LGTM<sup>TM</sup>.


---

Comment by tscrim created at 2014-01-08 20:22:48

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2014-01-09 08:54:01

Never mind.


---

Comment by jdemeyer created at 2014-01-09 08:54:01

Changing status from positive_review to needs_review.


---

Comment by jdemeyer created at 2014-01-09 08:56:59

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-01-20 23:52:00

Resolution: fixed


---

Comment by ppurka created at 2014-02-01 17:06:02

This has broken latex in the notebook. See https://github.com/sagemath/sagenb/issues/195 for details.


---

Comment by jdemeyer created at 2014-02-01 18:31:09

Sorry guys :-(


---

Comment by tscrim created at 2014-02-02 05:37:08

Sorry!
