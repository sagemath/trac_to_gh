# Issue 21959: export using the binary STL file format

archive/issues_021959.json:
```json
{
    "body": "CC:  ohanar kcrisman niles vivianepons ams\n\nKeywords: STL\n\nbecause this is much better for large shapes with many triangles\n\nIssue created by migration from https://trac.sagemath.org/ticket/22196\n\n",
    "created_at": "2017-01-17T16:34:15Z",
    "labels": [
        "graphics",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "export using the binary STL file format",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21959",
    "user": "chapoton"
}
```
CC:  ohanar kcrisman niles vivianepons ams

Keywords: STL

because this is much better for large shapes with many triangles

Issue created by migration from https://trac.sagemath.org/ticket/22196





---

archive/issue_comments_305318.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-01-17T16:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305318",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_305319.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-01-17T16:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305319",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_305320.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-18T20:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305320",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305321.json:
```json
{
    "body": "ping ? anybody for a review ? this essentially just means checking that the export works as well as before, with a better (more compact) binary format for STL files.",
    "created_at": "2017-01-27T20:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305321",
    "user": "chapoton"
}
```

ping ? anybody for a review ? this essentially just means checking that the export works as well as before, with a better (more compact) binary format for STL files.



---

archive/issue_comments_305322.json:
```json
{
    "body": "I'll do the review. It's very useful to have it more lightweight. \n\nSorry for not reacting before. It's the end of semester in my lab, so everybody is kind of overwhelmed with the everyday work.",
    "created_at": "2017-01-28T22:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305322",
    "user": "ams"
}
```

I'll do the review. It's very useful to have it more lightweight. 

Sorry for not reacting before. It's the end of semester in my lab, so everybody is kind of overwhelmed with the everyday work.



---

archive/issue_comments_305323.json:
```json
{
    "body": "I tested with an implicit plot\n\n\n```\nvar('x,y,z')\nG = implicit_plot3d((x^2+y^2+2*z^2-1/3)^2==((z-1/2)^2-2*x^2)*((z+1/2)^2-2*y^2),(x,-1,1),(y,-1,1),(z,-0.5,0.5))\nG.save('implicit.stl')\n```\n\n\nthe Moebius surface \n\n\n```\nfrom sage.plot.plot3d.parametric_surface import MoebiusStrip\nS = MoebiusStrip(1,.2)\nS.save('Moebius.stl')\n```\n\n\nand the buckyball polyhedron  \n\n\n```\nG = plot(polytopes.buckyball())\nG.all[-1].save('buckyball.stl')\n```\n\n\nI looked at the saved stl files in Blender. They looked fine, normals where coherent when possible. \n\nOne remark, unrelated to the binary format: the implicit plot had some \"double points\" (points very close to each other) which causes tiny triangles.",
    "created_at": "2017-01-28T23:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305323",
    "user": "ams"
}
```

I tested with an implicit plot


```
var('x,y,z')
G = implicit_plot3d((x^2+y^2+2*z^2-1/3)^2==((z-1/2)^2-2*x^2)*((z+1/2)^2-2*y^2),(x,-1,1),(y,-1,1),(z,-0.5,0.5))
G.save('implicit.stl')
```


the Moebius surface 


```
from sage.plot.plot3d.parametric_surface import MoebiusStrip
S = MoebiusStrip(1,.2)
S.save('Moebius.stl')
```


and the buckyball polyhedron  


```
G = plot(polytopes.buckyball())
G.all[-1].save('buckyball.stl')
```


I looked at the saved stl files in Blender. They looked fine, normals where coherent when possible. 

One remark, unrelated to the binary format: the implicit plot had some "double points" (points very close to each other) which causes tiny triangles.



---

archive/issue_comments_305324.json:
```json
{
    "body": "so, positive review ?\n\nFor the question about tiny triangles, this would be for another ticket maybe. We are using something called a \"marching cubes\" algorithm. Maybe there is room for improvement, but this is not for me and not for now.",
    "created_at": "2017-01-30T08:35:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305324",
    "user": "chapoton"
}
```

so, positive review ?

For the question about tiny triangles, this would be for another ticket maybe. We are using something called a "marching cubes" algorithm. Maybe there is room for improvement, but this is not for me and not for now.



---

archive/issue_comments_305325.json:
```json
{
    "body": "Yes, in principle.\nI just had to leave home before all the doctests finished (it's sooo slooow). \nNow I am running them on the cloud, but I had to rebuilt the whole thing first, that's why it is taking some time. As soon as it's done, it will be a positive review. \n\nActually, just doctesting sage/plot/plot3d/base.pyx was quite fast and it worked fine. But if I understand well I am supposed to doctest everything, right ?",
    "created_at": "2017-01-30T09:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305325",
    "user": "ams"
}
```

Yes, in principle.
I just had to leave home before all the doctests finished (it's sooo slooow). 
Now I am running them on the cloud, but I had to rebuilt the whole thing first, that's why it is taking some time. As soon as it's done, it will be a positive review. 

Actually, just doctesting sage/plot/plot3d/base.pyx was quite fast and it worked fine. But if I understand well I am supposed to doctest everything, right ?



---

archive/issue_comments_305326.json:
```json
{
    "body": "not really, because a patchbot has done that for you (green icon at top right of this page).. You are supposed to look at the code, test the code by using it, and check the doc. I think you did enough already.",
    "created_at": "2017-01-30T09:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305326",
    "user": "chapoton"
}
```

not really, because a patchbot has done that for you (green icon at top right of this page).. You are supposed to look at the code, test the code by using it, and check the doc. I think you did enough already.



---

archive/issue_comments_305327.json:
```json
{
    "body": "Done.",
    "created_at": "2017-01-30T10:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305327",
    "user": "ams"
}
```

Done.



---

archive/issue_comments_305328.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-01-30T10:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305328",
    "user": "ams"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_305329.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-02T22:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305329",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_305330.json:
```json
{
    "body": "Changing keywords from \"STL\" to \"STL, 3D\".",
    "created_at": "2018-03-21T22:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305330",
    "user": "slelievre"
}
```

Changing keywords from "STL" to "STL, 3D".



---

archive/issue_comments_305331.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-03-21T22:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21959",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21959#issuecomment-305331",
    "user": "slelievre"
}
```

Changing type from PLEASE CHANGE to enhancement.
