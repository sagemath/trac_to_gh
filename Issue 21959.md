# Issue 21959: export using the binary STL file format

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-01-17 16:34:15

CC:  ohanar kcrisman niles vivianepons ams

Keywords: STL

because this is much better for large shapes with many triangles


---

Comment by chapoton created at 2017-01-17 16:34:46

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-01-17 16:34:46

New commits:


---

Comment by git created at 2017-01-18 20:00:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-01-27 20:29:55

ping ? anybody for a review ? this essentially just means checking that the export works as well as before, with a better (more compact) binary format for STL files.


---

Comment by ams created at 2017-01-28 22:08:09

I'll do the review. It's very useful to have it more lightweight. 

Sorry for not reacting before. It's the end of semester in my lab, so everybody is kind of overwhelmed with the everyday work.


---

Comment by ams created at 2017-01-28 23:04:17

I tested with an implicit plot


```
var('x,y,z')
G = implicit_plot3d((x^2+y^2+2*z^2-1/3)^2==((z-1/2)^2-2*x^2)*((z+1/2)^2-2*y^2),(x,-1,1),(y,-1,1),(z,-0.5,0.5))
G.save('implicit.stl')
```


the Moebius surface 


```
from sage.plot.plot3d.parametric_surface import MoebiusStrip
S = MoebiusStrip(1,.2)
S.save('Moebius.stl')
```


and the buckyball polyhedron  


```
G = plot(polytopes.buckyball())
G.all[-1].save('buckyball.stl')
```


I looked at the saved stl files in Blender. They looked fine, normals where coherent when possible. 

One remark, unrelated to the binary format: the implicit plot had some "double points" (points very close to each other) which causes tiny triangles.


---

Comment by chapoton created at 2017-01-30 08:35:11

so, positive review ?

For the question about tiny triangles, this would be for another ticket maybe. We are using something called a "marching cubes" algorithm. Maybe there is room for improvement, but this is not for me and not for now.


---

Comment by ams created at 2017-01-30 09:44:49

Yes, in principle.
I just had to leave home before all the doctests finished (it's sooo slooow). 
Now I am running them on the cloud, but I had to rebuilt the whole thing first, that's why it is taking some time. As soon as it's done, it will be a positive review. 

Actually, just doctesting sage/plot/plot3d/base.pyx was quite fast and it worked fine. But if I understand well I am supposed to doctest everything, right ?


---

Comment by chapoton created at 2017-01-30 09:49:17

not really, because a patchbot has done that for you (green icon at top right of this page).. You are supposed to look at the code, test the code by using it, and check the doc. I think you did enough already.


---

Comment by ams created at 2017-01-30 10:03:09

Done.


---

Comment by ams created at 2017-01-30 10:03:09

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-02 22:09:24

Resolution: fixed


---

Comment by slelievre created at 2018-03-21 22:07:57

Changing keywords from "STL" to "STL, 3D".


---

Comment by slelievre created at 2018-03-21 22:07:57

Changing type from PLEASE CHANGE to enhancement.
