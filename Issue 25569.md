# Issue 25569: Pass --no-readline to R

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2018-07-09 09:20:13

CC:  fbissey arojas infinity0 jdemeyer embray

Conda and Gentoo (and apparently also ArchLinux and Debian) suffer from hangs when talking to R through the pexpect interface on the first invocation in a Sage session. It is unclear what is the underlying issue. Shortening Sage's R prompt seems to fix the issue as does passing `--no-readline` to R.

Is there any reason why we should keep readline support when talking to R with the pexpect interface? Otherwise, we should just pass on that flag even though we do not fully understand why it fixes that particular issue.

See https://github.com/conda-forge/sagelib-feedstock/issues/19#issuecomment-402557595, and https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/dt-r-no-readline.patch.


---

Comment by saraedum created at 2018-07-09 09:23:16

Changing status from new to needs_review.


---

Comment by saraedum created at 2018-07-09 09:23:16

New commits:


---

Comment by git created at 2018-07-09 09:35:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2018-07-09 09:36:46

This makes sense to me.  There is a similar issue #25363 where it was needed to disable prompt_toolkit for Cantor's pexect interface to Sage to work (I believe Cantor is wrong to use pexpect to wrap Sage in the first place, but that's a different story).

I don't know why this would be a problem on some platforms but not others.
----
New commits:


---

Comment by embray created at 2018-07-09 09:36:46

Changing status from needs_review to positive_review.


---

Comment by saraedum created at 2018-07-09 09:39:35

Changing status from positive_review to needs_review.


---

Comment by saraedum created at 2018-07-09 09:39:35

Great. Let's wait for the patchbot to actually pass as I have not run doctests for this myself.


---

Comment by tmonteil created at 2018-07-17 16:04:09

#25503 does this already, and should ease downstream packaging (still needs review).

Replying to [comment:5 embray]:
[...]
> I don't know why this would be a problem on some platforms but not others.

To what i understand, this is not a platform issue, but a version issue: our interface does not work with readline 7.


---

Comment by saraedum created at 2018-08-15 19:15:28

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-17 21:14:13

Resolution: fixed


---

Comment by saraedum created at 2018-10-14 19:16:00

I might have misunderstood what the milestone stands for but I thought it would be the release of Sage that includes this. So, this is not in 8.3 yet but will only be in 8.4.
