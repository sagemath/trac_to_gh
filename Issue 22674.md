# Issue 22674: Reorganize some methods for loops

archive/issues_022674.json:
```json
{
    "body": "We have 2 methods for returning the loops of a (di)graph, ``loops`` and ``loop_edges``, and one is faster than the other.\n\n```\nsage: G = Graph(10, loops=True)\nsage: G.add_edges([(u,u) for u in G])\nsage: %time L1 = G.loop_edges()\nCPU times: user 68 \u00b5s, sys: 23 \u00b5s, total: 91 \u00b5s\nWall time: 73 \u00b5s\nsage: %time L2 = G.loops()\nCPU times: user 181 \u00b5s, sys: 50 \u00b5s, total: 231 \u00b5s\nWall time: 194 \u00b5s\nsage: L1 == L2\nTrue\nsage: D = digraphs.DeBruijn(10,1)\nsage: %time L1 = D.loop_edges()\nCPU times: user 80 \u00b5s, sys: 18 \u00b5s, total: 98 \u00b5s\nWall time: 86.1 \u00b5s\nsage: %time L2 = D.loops()\nCPU times: user 333 \u00b5s, sys: 76 \u00b5s, total: 409 \u00b5s\nWall time: 344 \u00b5s\nsage: L1 == L2\nTrue\n```\n\nNote however that the slower (``loops``) has an extra parameter for edge labels. Let's try to clean that.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22911\n\n",
    "created_at": "2017-04-30T14:41:25Z",
    "labels": [
        "graph theory",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Reorganize some methods for loops",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22674",
    "user": "@dcoudert"
}
```
We have 2 methods for returning the loops of a (di)graph, ``loops`` and ``loop_edges``, and one is faster than the other.

```
sage: G = Graph(10, loops=True)
sage: G.add_edges([(u,u) for u in G])
sage: %time L1 = G.loop_edges()
CPU times: user 68 µs, sys: 23 µs, total: 91 µs
Wall time: 73 µs
sage: %time L2 = G.loops()
CPU times: user 181 µs, sys: 50 µs, total: 231 µs
Wall time: 194 µs
sage: L1 == L2
True
sage: D = digraphs.DeBruijn(10,1)
sage: %time L1 = D.loop_edges()
CPU times: user 80 µs, sys: 18 µs, total: 98 µs
Wall time: 86.1 µs
sage: %time L2 = D.loops()
CPU times: user 333 µs, sys: 76 µs, total: 409 µs
Wall time: 344 µs
sage: L1 == L2
True
```

Note however that the slower (``loops``) has an extra parameter for edge labels. Let's try to clean that.

Issue created by migration from https://trac.sagemath.org/ticket/22911





---

archive/issue_comments_316206.json:
```json
{
    "body": "So far I have let both methods and improved the `loop_edges` method.\n\nI don't know what's the best option:\n1. deprecate one of the methods and ensure the fastest code is in the other one\n2. make the slowest method an alias for the fastest one and so let both names\n\nAny advice / opinion is welcome. Option 2 is the easiest one, but...\n----\nNew commits:",
    "created_at": "2017-04-30T15:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316206",
    "user": "@dcoudert"
}
```

So far I have let both methods and improved the `loop_edges` method.

I don't know what's the best option:
1. deprecate one of the methods and ensure the fastest code is in the other one
2. make the slowest method an alias for the fastest one and so let both names

Any advice / opinion is welcome. Option 2 is the easiest one, but...
----
New commits:



---

archive/issue_comments_316207.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-30T15:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316207",
    "user": "@dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_316208.json:
```json
{
    "body": "I would not deprecate the method, but just make `loops` and alias for `loop_edges` (with the extra parameter).\n\nAlso, while you're moving methods around in the file (something I try to avoid doing because it can create trivial conflicts easily), I would clean up the docstrings `Returns` -> `Return` and\n\n```\n- ``labels`` -- whether returned edges have labels (``(u,v,l)``) or not (``(u,v)``)\n```\n",
    "created_at": "2017-04-30T16:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316208",
    "user": "@tscrim"
}
```

I would not deprecate the method, but just make `loops` and alias for `loop_edges` (with the extra parameter).

Also, while you're moving methods around in the file (something I try to avoid doing because it can create trivial conflicts easily), I would clean up the docstrings `Returns` -> `Return` and

```
- ``labels`` -- whether returned edges have labels (``(u,v,l)``) or not (``(u,v)``)
```




---

archive/issue_comments_316209.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-30T17:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316209",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316210.json:
```json
{
    "body": "Should be better now.",
    "created_at": "2017-04-30T17:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316210",
    "user": "@dcoudert"
}
```

Should be better now.



---

archive/issue_comments_316211.json:
```json
{
    "body": "Last thing, we should move those doctests from `loops` into `loop_edges` as they cover a few other cases now not tested (at least from looking at the diff).",
    "created_at": "2017-04-30T17:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316211",
    "user": "@tscrim"
}
```

Last thing, we should move those doctests from `loops` into `loop_edges` as they cover a few other cases now not tested (at least from looking at the diff).



---

archive/issue_comments_316212.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-30T17:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316212",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316213.json:
```json
{
    "body": "I have merged the doctests. Some cases are may be not covered, but I don't know which one.",
    "created_at": "2017-04-30T17:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316213",
    "user": "@dcoudert"
}
```

I have merged the doctests. Some cases are may be not covered, but I don't know which one.



---

archive/issue_comments_316214.json:
```json
{
    "body": "Hmm...maybe I misparsed the graphs in my mind. Thanks. Just remove the period in the `INPUT:` and you can set a positive review on my behalf.",
    "created_at": "2017-04-30T17:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316214",
    "user": "@tscrim"
}
```

Hmm...maybe I misparsed the graphs in my mind. Thanks. Just remove the period in the `INPUT:` and you can set a positive review on my behalf.



---

archive/issue_comments_316215.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-30T17:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316215",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316216.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-30T17:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316216",
    "user": "@dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_316217.json:
```json
{
    "body": "Thank you Travis.",
    "created_at": "2017-04-30T17:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316217",
    "user": "@dcoudert"
}
```

Thank you Travis.



---

archive/issue_comments_316218.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-08T21:18:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22674",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22674#issuecomment-316218",
    "user": "@vbraun"
}
```

Resolution: fixed
