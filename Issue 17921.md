# Issue 17921: `__getitem__` for libGap_Element

archive/issues_017921.json:
```json
{
    "body": "CC:  @vbraun @dimpase\n\nThere are two issue with `__getitem__` on gap vs libgap elements:\n- gap indices start with `1`. This is respected with the gap interface but not with the libgap interface\n- most libgap elements lacks a `__getitem__`\n\nCompare:\n\n```\nsage: irr = libgap.Irr(libgap.CharacterTable(S))\nsage: irr[0]\nCharacter( CharacterTable( Sym( [ 1 .. 10 ] ) ), [ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )\nsage: irr[0][0]\nTraceback (most recent call last):\n...\nTypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n```\n\nwith\n\n```\nsage: irr = gap.Irr(gap.CharacterTable(S))\nsage: irr[1]\nCharacter( CharacterTable( SymmetricGroup( [ 1 .. 10 ] ) ), \n[ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, \n  -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )\nsage: irr[1][1]\n1\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18158\n\n",
    "created_at": "2015-04-11T11:20:07Z",
    "labels": [
        "component: interfaces",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "`__getitem__` for libGap_Element",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17921",
    "user": "https://github.com/videlec"
}
```
CC:  @vbraun @dimpase

There are two issue with `__getitem__` on gap vs libgap elements:
- gap indices start with `1`. This is respected with the gap interface but not with the libgap interface
- most libgap elements lacks a `__getitem__`

Compare:

```
sage: irr = libgap.Irr(libgap.CharacterTable(S))
sage: irr[0]
Character( CharacterTable( Sym( [ 1 .. 10 ] ) ), [ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )
sage: irr[0][0]
Traceback (most recent call last):
...
TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'
```

with

```
sage: irr = gap.Irr(gap.CharacterTable(S))
sage: irr[1]
Character( CharacterTable( SymmetricGroup( [ 1 .. 10 ] ) ), 
[ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 
  -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )
sage: irr[1][1]
1
```


Issue created by migration from https://trac.sagemath.org/ticket/18158





---

archive/issue_comments_240326.json:
```json
{
    "body": "libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`",
    "created_at": "2015-04-11T12:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240326",
    "user": "https://github.com/vbraun"
}
```

libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`



---

archive/issue_comments_240327.json:
```json
{
    "body": "Replying to [comment:1 vbraun]:\n> libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`\n\ngap lists are Python iterable as well\n\n```\nsage: list(gap.List([1,2,3]))\n[1, 2, 3]\n```\n\nand having `list(x)[0] != x[0]` is not breaking any rule.",
    "created_at": "2015-04-11T12:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240327",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:1 vbraun]:
> libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`

gap lists are Python iterable as well

```
sage: list(gap.List([1,2,3]))
[1, 2, 3]
```

and having `list(x)[0] != x[0]` is not breaking any rule.



---

archive/issue_comments_240328.json:
```json
{
    "body": "It does break the rule of least surprise, e.g.\n\n```\nsage: l = some_computation()\nsage: l \n[ 1, 2, 3 ]\nsage: l[0]     # guess what?\n```\n",
    "created_at": "2015-04-11T12:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240328",
    "user": "https://github.com/vbraun"
}
```

It does break the rule of least surprise, e.g.

```
sage: l = some_computation()
sage: l 
[ 1, 2, 3 ]
sage: l[0]     # guess what?
```




---

archive/issue_comments_240329.json:
```json
{
    "body": "Replying to [comment:3 vbraun]:\n> It does break the rule of least surprise, e.g.\n> {{{\n> sage: l = some_computation()\n> sage: l \n> [ 1, 2, 3 ]\n> sage: l[0]     # guess what?\n> }}}\n\nI agree with your example. On the other hand, gap permutations starts at 1 and it is coherent with their lists starting at 1.\n\nMore importantly, for who is intended the gap/libgap interface objects (and more generally Sage interface objects):\n- everybody\n- Sage programmers\n- users knowing gap (pari, singular, etc)\n- ?\nI rarely use `._pari_()`, `._gap_()` when doing actual computations. When I do, it is that Sage is lacking some interface.\n\nVincent",
    "created_at": "2015-04-11T12:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240329",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:3 vbraun]:
> It does break the rule of least surprise, e.g.
> {{{
> sage: l = some_computation()
> sage: l 
> [ 1, 2, 3 ]
> sage: l[0]     # guess what?
> }}}

I agree with your example. On the other hand, gap permutations starts at 1 and it is coherent with their lists starting at 1.

More importantly, for who is intended the gap/libgap interface objects (and more generally Sage interface objects):
- everybody
- Sage programmers
- users knowing gap (pari, singular, etc)
- ?
I rarely use `._pari_()`, `._gap_()` when doing actual computations. When I do, it is that Sage is lacking some interface.

Vincent



---

archive/issue_comments_240330.json:
```json
{
    "body": "Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):\n\n```\nsage: pari(\"[1,2,3][1]\")\n1\nsage: pari(\"[1,2,3]\")[1]\n2\n```\n",
    "created_at": "2015-04-11T12:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240330",
    "user": "https://github.com/jdemeyer"
}
```

Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):

```
sage: pari("[1,2,3][1]")
1
sage: pari("[1,2,3]")[1]
2
```




---

archive/issue_comments_240331.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):\n> {{{\n> sage: pari(\"[1,2,3][1]\")\n> 1\n> sage: pari(\"[1,2,3]\")[1]\n> 2\n> }}}\n\nAll right, this is as much consistent as gap vs libgap\n\n```\nsage: pari(\"[1,2,3]\")[1]\n2\nsage: gp(\"[1,2,3]\")[1]\n1\n```\n\n\nI will just add some warning in the doc and try to implement this `__getitem__` support in libgap.\n\nVincent",
    "created_at": "2015-04-11T13:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240331",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:5 jdemeyer]:
> Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):
> {{{
> sage: pari("[1,2,3][1]")
> 1
> sage: pari("[1,2,3]")[1]
> 2
> }}}

All right, this is as much consistent as gap vs libgap

```
sage: pari("[1,2,3]")[1]
2
sage: gp("[1,2,3]")[1]
1
```


I will just add some warning in the doc and try to implement this `__getitem__` support in libgap.

Vincent



---

archive/issue_comments_240332.json:
```json
{
    "body": "I guess this is far from being optimal but it is at least very useful to me!\n\nVincent\n----\nNew commits:",
    "created_at": "2015-04-11T14:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240332",
    "user": "https://github.com/videlec"
}
```

I guess this is far from being optimal but it is at least very useful to me!

Vincent
----
New commits:



---

archive/issue_comments_240333.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-11T14:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240333",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_240334.json:
```json
{
    "body": "Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`",
    "created_at": "2015-06-19T08:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240334",
    "user": "https://github.com/vbraun"
}
```

Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`



---

archive/issue_comments_240335.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-30T21:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240336.json:
```json
{
    "body": "Replying to [comment:8 vbraun]:\n> Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`\n\nIndeed it is much more robust and general. That way libgap vectors and matrices are also considered as lists\n\n```\nsage: M = libgap.eval('SL(2,GF(5))').GeneratorsOfGroup()[1]\nsage: M\n[ [ Z(5)^2, Z(5)^0 ], [ Z(5)^2, 0*Z(5) ] ]\nsage: M[0]\n[ Z(5)^2, Z(5)^0 ]\n```\n",
    "created_at": "2016-04-30T21:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240336",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:8 vbraun]:
> Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`

Indeed it is much more robust and general. That way libgap vectors and matrices are also considered as lists

```
sage: M = libgap.eval('SL(2,GF(5))').GeneratorsOfGroup()[1]
sage: M
[ [ Z(5)^2, Z(5)^0 ], [ Z(5)^2, 0*Z(5) ] ]
sage: M[0]
[ Z(5)^2, Z(5)^0 ]
```




---

archive/issue_comments_240337.json:
```json
{
    "body": "I don't really get the purpose of this ticket; e.g.\n`m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')`\ncan just as well be done as follows, without an `eval`:\n\n```\nF=libgap.GF(4)\na=F.PrimitiveElement()\nm = libgap([[a,a^0],[0*a,a^2]])\n```\n",
    "created_at": "2016-05-03T18:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240337",
    "user": "https://github.com/dimpase"
}
```

I don't really get the purpose of this ticket; e.g.
`m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')`
can just as well be done as follows, without an `eval`:

```
F=libgap.GF(4)
a=F.PrimitiveElement()
m = libgap([[a,a^0],[0*a,a^2]])
```




---

archive/issue_comments_240338.json:
```json
{
    "body": "What are you exactly complaining about? With the branch, I am providing access to `__getitem__` and `__len__` for more gap objects. What `eval` has to do with all of this!?",
    "created_at": "2016-05-03T20:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240338",
    "user": "https://github.com/videlec"
}
```

What are you exactly complaining about? With the branch, I am providing access to `__getitem__` and `__len__` for more gap objects. What `eval` has to do with all of this!?



---

archive/issue_comments_240339.json:
```json
{
    "body": "Sorry, well, look at your branch yourself. It seems that you have removed and re-inserted a big chunk. Namely, that `m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')` is from \"green\" part, and so I assumed that is a part of the ticket contribution...",
    "created_at": "2016-05-03T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240339",
    "user": "https://github.com/dimpase"
}
```

Sorry, well, look at your branch yourself. It seems that you have removed and re-inserted a big chunk. Namely, that `m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')` is from "green" part, and so I assumed that is a part of the ticket contribution...



---

archive/issue_comments_240340.json:
```json
{
    "body": "Indeed, I moved `matrix` and `vector` from `GapElement` to `GapElement_List`.\n\nThough, I can simplify the line that you don't like.",
    "created_at": "2016-05-03T21:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240340",
    "user": "https://github.com/videlec"
}
```

Indeed, I moved `matrix` and `vector` from `GapElement` to `GapElement_List`.

Though, I can simplify the line that you don't like.



---

archive/issue_comments_240341.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-03T21:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240341",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240342.json:
```json
{
    "body": "Is the description helpful enough? I can revamp the commits if you like.",
    "created_at": "2016-05-08T03:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240342",
    "user": "https://github.com/videlec"
}
```

Is the description helpful enough? I can revamp the commits if you like.



---

archive/issue_comments_240343.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-09T14:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240343",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_240344.json:
```json
{
    "body": "looks good to me.",
    "created_at": "2016-05-09T14:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240344",
    "user": "https://github.com/dimpase"
}
```

looks good to me.



---

archive/issue_comments_240345.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-17T07:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17921#issuecomment-240345",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_017212.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2016-05-17T07:16:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17921",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17921#event-17212"
}
```
