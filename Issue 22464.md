# Issue 22464: Setting up a Polyhedron from both Vrep and Hrep

Issue created by migration from https://trac.sagemath.org/ticket/22701

Original creator: mkoeppe

Original creation time: 2017-03-28 18:25:43

CC:  jipilab mforets moritz novoselt tscrim

Keywords: polytope, geometry, days84

Currently, only one of the two is allowed.
For at least some backends (certainly, the generic (`"field"`) backend and polymake (#22683)), it makes sense to initialize with both if they are known, to avoid expensive recomputation. 
Users should also be allowed to indicate whether the given presentations are already minimal.

In particular this could help to implement a fast version of `change_backend()` (#22575) and could be the basis of code that delegates to a particular backend for particular features.


---

Comment by mforets created at 2017-04-11 15:40:51

in another software you can instantiate a polyhedron with "just" the h-rep (or v-rep), and compute the complementary representation on-demand. this is useful especially when you work in high dimensions, and makes sense because there are questions which only rely on having just one representation.

so i wonder if this can be considered in this ticket, something like a keyword argument  `compute_complementary_representation` which is true by default, to cover those use cases.


---

Comment by mkoeppe created at 2017-04-11 15:44:57

I think we could have a separate "lazy" backend that can only hold a given Hrep or Vrep. Whenever anything needs to be computed that requires the other representation, one could change to an actual backend.


---

Comment by mkoeppe created at 2018-09-30 05:53:51

New commits:


---

Comment by mkoeppe created at 2018-09-30 05:53:51

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-09-30 07:54:50

One little thing:

```diff
-raise ValueError("If both Vrep and Hrep are provided, they must be minimal and Vrep_minimal and Hrep_minimal must be set True to indicate this.")
+raise ValueError("if both Vrep and Hrep are provided, they must be minimal"
                  " and Vrep_minimal and Hrep_minimal must both be True")
```

Otherwise LGTM.

----

One good way to do things lazily is use the ``@`lazy_attribute`. It also works well when setting `self._foo = x`.

```
sage: class Foo(object):
....:     @lazy_attribute
....:     def test(self):
....:         return [x for x in WeylGroup(['E',8],prefix='s')]
....:     
sage: F = Foo()
sage: F.test = 5
sage: F.test
5
sage: B = Foo()
sage: B.test  # This will take a while
```



---

Comment by git created at 2018-09-30 08:46:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2018-09-30 08:58:21

(Thanks for the info on lazy_attribute. I've opened ticket #26366 for possible discussion of a lazy backend; but I do not plan to work on it.)


---

Comment by tscrim created at 2018-09-30 13:11:02

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-09-30 13:11:02

Thanks.


---

Comment by mkoeppe created at 2018-09-30 17:15:07

Thank you for the review.


---

Comment by vbraun created at 2018-10-01 22:35:47

Resolution: fixed
