# Issue 24599: py3: cleanup sage.interfaces.sage0

Issue created by migration from https://trac.sagemath.org/ticket/24836

Original creator: embray

Original creation time: 2018-02-26 11:56:09

Keywords: interfaces

Various cleanup and minor fixes to `sage.interfaces.sage0`.

The most significant issue here is again handling file opening/closing in such a way that we don't get `ResourceWarning`s in the tests.

I found the best way to do this was to ensure that when the remote sage loads a pickle it does so wrapped in a `with open(...):` block, but doing this required adding the ability to process multi-line statements.


---

Comment by embray created at 2018-03-12 11:05:51

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-05-13 09:53:43

Two minor comments

1. Instead of

```
+        elif isinstance(init_code, list):
+            init_code = list(init_code)
```

  I would rather use a `else` or adding a `else` that raises a `TypeError`.

2. Do you mind changing `(b">>> ")` to `b'>>>'` for consistency?


---

Comment by vdelecroix created at 2018-05-13 09:53:43

Changing status from needs_review to needs_work.


---

Comment by embray created at 2018-05-14 15:47:11

I don't think that feature is used much if at all anyways, but I agree it should be better.  It should also handle being passed a string...


---

Comment by git created at 2018-05-14 15:53:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2018-05-14 15:53:27

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2018-05-15 07:09:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-18 17:04:20

Resolution: fixed
