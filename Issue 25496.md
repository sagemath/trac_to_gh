# Issue 25496: Speed up SBox.boomerang_connectivity_matrix

Issue created by migration from Trac.

Original creator: asante

Original creation time: 2018-07-01 17:24:54

CC:  ruhm

Keywords: sbox, bct, speed, days94

Dunkelman proposed an algorithm for computing the BCT which decreases the runtime by a factor of 2^n.


---

Comment by asante created at 2018-07-01 17:26:46

New commits:


---

Comment by asante created at 2018-07-01 17:26:46

Set assignee to asante.


---

Comment by asante created at 2018-07-01 17:27:02

Changing status from new to needs_review.


---

Comment by asante created at 2018-07-01 17:31:07

The naive algorithm:

```sage
sage: for j in range(10):
....:      S = [x for x in range(256)];shuffle(S)
....:      S = sage.crypto.sbox.SBox(S)
....:      %time _ = S.boomerang_connectivity_matrix()
....: 
CPU times: user 1min 21s, sys: 44 ms, total: 1min 21s
Wall time: 1min 24s
CPU times: user 1min 21s, sys: 24 ms, total: 1min 21s
Wall time: 1min 24s
CPU times: user 1min 20s, sys: 4 ms, total: 1min 20s
Wall time: 1min 22s
CPU times: user 1min 20s, sys: 24 ms, total: 1min 20s
Wall time: 1min 24s
CPU times: user 1min 21s, sys: 8 ms, total: 1min 21s
Wall time: 1min 24s
CPU times: user 1min 14s, sys: 8 ms, total: 1min 14s
Wall time: 1min 16s
CPU times: user 36.5 s, sys: 4 ms, total: 36.5 s
Wall time: 36.5 s
CPU times: user 36.4 s, sys: 4 ms, total: 36.4 s
Wall time: 36.4 s
CPU times: user 1min 6s, sys: 24 ms, total: 1min 7s
Wall time: 1min 8s
CPU times: user 1min 21s, sys: 56 ms, total: 1min 21s
Wall time: 1min 27s
```

vs the improved algorithm:

```sage
sage: for j in range(10):
....:      S = [x for x in range(256)];shuffle(S)
....:      S = sage.crypto.sbox.SBox(S)
....:      %time _ = S.boomerang_connectivity_matrix()
....:     
CPU times: user 312 ms, sys: 0 ns, total: 312 ms
Wall time: 322 ms
CPU times: user 308 ms, sys: 0 ns, total: 308 ms
Wall time: 319 ms
CPU times: user 308 ms, sys: 0 ns, total: 308 ms
Wall time: 318 ms
CPU times: user 304 ms, sys: 4 ms, total: 308 ms
Wall time: 321 ms
CPU times: user 312 ms, sys: 0 ns, total: 312 ms
Wall time: 315 ms
CPU times: user 312 ms, sys: 0 ns, total: 312 ms
Wall time: 318 ms
CPU times: user 312 ms, sys: 0 ns, total: 312 ms
Wall time: 321 ms
CPU times: user 308 ms, sys: 0 ns, total: 308 ms
Wall time: 333 ms
CPU times: user 300 ms, sys: 8 ms, total: 308 ms
Wall time: 325 ms
CPU times: user 304 ms, sys: 0 ns, total: 304 ms
Wall time: 312 ms
```



---

Comment by ruhm created at 2018-07-18 10:40:11

Friedrich,

The line `row = [0 for _ in range(ncols)]` can be simplified to `[0]*ncols`. The rest looks good to me (doctests passed and I have confirmed the performance speedup).

Rusydi


---

Comment by ruhm created at 2018-07-18 20:21:00

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-07-19 08:54:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2018-07-19 08:55:14

Changing status from needs_work to needs_review.


---

Comment by ruhm created at 2018-07-19 11:55:48

All good.


---

Comment by ruhm created at 2018-07-19 11:55:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-05 08:17:28

Resolution: fixed
