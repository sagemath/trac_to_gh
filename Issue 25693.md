# Issue 25693: implementation of different basis of WQSym

Issue created by migration from Trac.

Original creator: hmlodecki

Original creation time: 2018-07-25 21:25:17

CC:  tscrim darij zabrocki alauve amypang hmlodecki fhivert vivianepons embray chapoton mantepse

Keywords: sagedays@icerm, packed words, ordered set partition, CHAs, WQSym,

This ticket is created to implement different basis of WQSym defined by Yannic Vargas  (F, G, E, H...) for the autoduality of WQSym.


---

Comment by hmlodecki created at 2019-01-17 15:22:12

The first thing I'm going to do is split the `wqsym` file into several files because there will be too many different bases after that.


---

Comment by tscrim created at 2019-01-17 16:28:28

Replying to [comment:2 hmlodecki]:
> The first thing I'm going to do is split the `wqsym` file into several files because there will be too many different bases after that.

I might consider thinking a little more on that. If the various bases do not require a lot of code, then the file might still remain (relatively) small. Having one file makes maintenance a little easier by having the code (and hence the documentation) more localized. I am not saying you shouldn't, but just that it might be better to see about splitting it after you add the additional bases.


---

Comment by git created at 2019-01-17 17:17:20

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2019-01-18 14:17:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-21 17:21:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-28 15:12:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by alauve created at 2019-01-31 23:14:29

Made branch public. (I hope I did this correctly.)


---

Comment by alauve created at 2019-01-31 23:26:35

Oh, I see it probably wasn't yet meant for public consumption. My apologies!
Let me know, Hugo, where I can help.


---

Comment by tscrim created at 2019-01-31 23:33:12

The only difference between a public branch and a trac-name branch is that anyone can push to a public. Otherwise they can pull and then set their own branch here.


---

Comment by hmlodecki created at 2019-02-01 15:34:20

Replying to [comment:11 alauve]:
> Oh, I see it probably wasn't yet meant for public consumption. My apologies!
> Let me know, Hugo, where I can help.


For now I'm steel working on having a first correct base, I've chosen the H basis, but I'm confronted to some complexity issues that I think is due to the convertions into `PackedWords`...
I have a lot of comments in french but the main problem is that in this version there is this test 

```
sage: t0 = time.time(); m4HQ = matr_chgmt_base_osp(H,Q,4); print time.time() - t0; m4QH = matr_chgm
....: t_base_osp(Q,H,4); print time.time() - t0
16.4242839813
51.6398468018
```

and in my personel version where I've impleted WQSym on `Packed Words` I have these times :

```
sage: t0 = time.time(); m4HQ = matr_chgmt_base_pw(GL,L,4); print
....:  time.time() - t0; m4QH = matr_chgmt_base_pw(L,GL,4); prin
....: t time.time() - t0
6.23473000526
13.2976300716
```


I do not really know how to get around the problem...


---

Comment by alauve created at 2019-02-04 14:26:39

Do you suppose this is coming from the fact that you cannot simply write "unitriangular=true" in the change of basis code to setup the inverse change-of-basis? (For those unaware, the ordering used for PackedWords is different from the ordering on set compositions... at least, for the standard bijection between the two.)

Or do you think it is a different problem?

How about adding a ``@`cached_method` flag?


---

Comment by hmlodecki created at 2019-02-04 15:28:11

Replying to [comment:14 alauve]:
> Do you suppose this is coming from the fact that you cannot simply write "unitriangular=true" in the change of basis code to setup the inverse change-of-basis? (For those unaware, the ordering used for `PackedWords` is different from the ordering on set compositions... at least, for the standard bijection between the two.)
> 
> Or do you think it is a different problem?
> 
> How about adding a ``@`cached_method` flag?


I thought my method was cached but you are right, it was only this... Thank you for suggesting it!
Do you think this solution of `new_rank` is a good solution ?


---

Comment by alauve created at 2019-02-04 15:50:34

Replying to [comment:15 hmlodecki]:
> 
> I thought my method was cached but you are right, it was only this... Thank you for suggesting it!
> Do you think this solution of `new_rank` is a good solution ?

I thought it was a great idea! Yet, it didn't give you much speedup? 
In your original code (implemented with packed words), do you have the change of basis method cached or not?

Perhaps it would be good to use `%prun` or `runsnake` to see where most of the time is being spent? ([Profiling](http://doc.sagemath.org/html/en/thematic_tutorials/profiling.html))


---

Comment by git created at 2019-02-13 11:12:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-02-27 16:59:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-03-18 13:53:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-03-18 13:57:20

Branch pushed to git repo; I updated commit sha1. New commits:
