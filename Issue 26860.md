# Issue 26860: Remove IndexedFreeModuleElement._coefficient_fast

Issue created by migration from https://trac.sagemath.org/ticket/27097

Original creator: jdemeyer

Original creation time: 2019-01-23 14:27:55

CC:  tscrim

The method `_coefficient_fast` serves no purpose at all:

1. It actually makes `__getitem__` slower because of the extra indirection.

2. Special methods in extension classes are very fast already, as fast as a Cython `cdef` function.

3. When called from Python (not Cython), a special method is much faster than a method.


---

Comment by jdemeyer created at 2019-01-23 14:49:35

New commits:


---

Comment by jdemeyer created at 2019-01-23 14:49:35

Changing status from new to needs_review.


---

Comment by tscrim created at 2019-01-23 17:33:30

Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra` (although it is not practically so useful because of the index set of the basis). Moreover, it is something that could be used in the wild by something in `ModulesWithBasis` that is not a subclass of `IndexedFreeModuleElement`. So -1 on removing it.


---

Comment by jdemeyer created at 2019-01-23 20:09:06

Replying to [comment:6 tscrim]:
> Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`

Removing it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?


---

Comment by tscrim created at 2019-01-23 20:10:24

Replying to [comment:7 jdemeyer]:
> Replying to [comment:6 tscrim]:
> > Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`
> 
> Removing it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?

This should do it:

```
sage: W.<x,y,z> = DifferentialWeylAlgebra(QQ)
sage: x[((1,0,0),(0,0,0))]
1
```



---

Comment by git created at 2019-01-23 20:59:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2019-01-23 20:59:25

Done, needs review again.


---

Comment by tscrim created at 2019-01-23 21:36:29

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-01-23 21:36:29

Thank you. LGTM.


---

Comment by vbraun created at 2019-01-26 15:53:40

Resolution: fixed
