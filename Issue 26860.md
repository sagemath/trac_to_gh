# Issue 26860: Remove IndexedFreeModuleElement._coefficient_fast

archive/issues_026860.json:
```json
{
    "body": "CC:  tscrim\n\nThe method `_coefficient_fast` serves no purpose at all:\n\n1. It actually makes `__getitem__` slower because of the extra indirection.\n\n2. Special methods in extension classes are very fast already, as fast as a Cython `cdef` function.\n\n3. When called from Python (not Cython), a special method is much faster than a method.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27097\n\n",
    "created_at": "2019-01-23T14:27:55Z",
    "labels": [
        "performance",
        "major",
        "enhancement"
    ],
    "title": "Remove IndexedFreeModuleElement._coefficient_fast",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26860",
    "user": "jdemeyer"
}
```
CC:  tscrim

The method `_coefficient_fast` serves no purpose at all:

1. It actually makes `__getitem__` slower because of the extra indirection.

2. Special methods in extension classes are very fast already, as fast as a Cython `cdef` function.

3. When called from Python (not Cython), a special method is much faster than a method.

Issue created by migration from https://trac.sagemath.org/ticket/27097





---

archive/issue_comments_377834.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-01-23T14:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377834",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_377835.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-23T14:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377835",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_377836.json:
```json
{
    "body": "Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra` (although it is not practically so useful because of the index set of the basis). Moreover, it is something that could be used in the wild by something in `ModulesWithBasis` that is not a subclass of `IndexedFreeModuleElement`. So -1 on removing it.",
    "created_at": "2019-01-23T17:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377836",
    "user": "tscrim"
}
```

Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra` (although it is not practically so useful because of the index set of the basis). Moreover, it is something that could be used in the wild by something in `ModulesWithBasis` that is not a subclass of `IndexedFreeModuleElement`. So -1 on removing it.



---

archive/issue_comments_377837.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`\n\nRemoving it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?",
    "created_at": "2019-01-23T20:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377837",
    "user": "jdemeyer"
}
```

Replying to [comment:6 tscrim]:
> Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`

Removing it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?



---

archive/issue_comments_377838.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> Replying to [comment:6 tscrim]:\n> > Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`\n> \n> Removing it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?\n\nThis should do it:\n\n```\nsage: W.<x,y,z> = DifferentialWeylAlgebra(QQ)\nsage: x[((1,0,0),(0,0,0))]\n1\n```\n",
    "created_at": "2019-01-23T20:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377838",
    "user": "tscrim"
}
```

Replying to [comment:7 jdemeyer]:
> Replying to [comment:6 tscrim]:
> > Everything is fine with me except for removing the `__getitem__` from `ModulesWithBasis`. It is used by the elements of `DifferentialWeylAlgebra`
> 
> Removing it doesn't cause any doctest failures (see patchbot). If we keep it, there should at least be one doctest that relies on it (i.e. that would break if we remove this). Could you come up with such a test?

This should do it:

```
sage: W.<x,y,z> = DifferentialWeylAlgebra(QQ)
sage: x[((1,0,0),(0,0,0))]
1
```




---

archive/issue_comments_377839.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-23T20:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377839",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377840.json:
```json
{
    "body": "Done, needs review again.",
    "created_at": "2019-01-23T20:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377840",
    "user": "jdemeyer"
}
```

Done, needs review again.



---

archive/issue_comments_377841.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-23T21:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377841",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_377842.json:
```json
{
    "body": "Thank you. LGTM.",
    "created_at": "2019-01-23T21:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377842",
    "user": "tscrim"
}
```

Thank you. LGTM.



---

archive/issue_comments_377843.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-26T15:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26860#issuecomment-377843",
    "user": "vbraun"
}
```

Resolution: fixed
