# Issue 12040: Lack of comparisons between polydic.ETuple and tuples and consequences

archive/issues_011868.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: P.<t> = PolynomialRing(QQ)\nsage: F.<a> = FractionField(P)\nsage: Pxy.<x,y> = PolynomialRing(F,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: E = EllipticCurve(f)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/kohel/<ipython console> in <module>()\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j)\n    235         if f.degree() != 3:\n    236             raise ValueError, \"Elliptic curves must be defined by a cubic polynomial.\"\n--> 237         if f.degrees() == (3,2):\n    238             x, y = f.parent().gens()\n    239         elif f.degree() == (2,3):\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polydict.so in sage.rings.polynomial.polydict.ETuple.__richcmp__ (sage/rings/polynomial/polydict.c:11114)()\n\nTypeError: Argument 'other' has incorrect type (expected sage.rings.polynomial.polydict.ETuple, got tuple)\n\nThe problem arises from the type of the return argument for f.degrees():\n\nsage: type(f.degrees())\n<type 'sage.rings.polynomial.polydict.ETuple'>\n\nIn contrast for a polynomial over QQ:\n\nsage: Pxy.<x,y> = PolynomialRing(QQ,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: type(f.degrees())\n<type 'tuple'>\n```\nThe elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.\n\n**Assignee:** @williamstein\n\n**Author:** David Kohel\n\nIssue created by migration from https://trac.sagemath.org/ticket/12040\n\n",
    "created_at": "2011-11-15T10:37:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Lack of comparisons between polydic.ETuple and tuples and consequences",
    "type": "issue",
    "updated_at": "2018-01-17T12:34:06Z",
    "url": "https://github.com/sagemath/sage/issues/12040",
    "user": "https://github.com/sagetrac-kohel"
}
```

```
sage: P.<t> = PolynomialRing(QQ)
sage: F.<a> = FractionField(P)
sage: Pxy.<x,y> = PolynomialRing(F,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: E = EllipticCurve(f)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/kohel/<ipython console> in <module>()

/usr/local/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j)
    235         if f.degree() != 3:
    236             raise ValueError, "Elliptic curves must be defined by a cubic polynomial."
--> 237         if f.degrees() == (3,2):
    238             x, y = f.parent().gens()
    239         elif f.degree() == (2,3):

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polydict.so in sage.rings.polynomial.polydict.ETuple.__richcmp__ (sage/rings/polynomial/polydict.c:11114)()

TypeError: Argument 'other' has incorrect type (expected sage.rings.polynomial.polydict.ETuple, got tuple)

The problem arises from the type of the return argument for f.degrees():

sage: type(f.degrees())
<type 'sage.rings.polynomial.polydict.ETuple'>

In contrast for a polynomial over QQ:

sage: Pxy.<x,y> = PolynomialRing(QQ,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: type(f.degrees())
<type 'tuple'>
```
The elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.

**Assignee:** @williamstein

**Author:** David Kohel

Issue created by migration from https://trac.sagemath.org/ticket/12040





---

archive/issue_events_137551.json:
```json
{
    "actor": "https://github.com/sagetrac-kohel",
    "created_at": "2011-11-15T10:37:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137551"
}
```



---

archive/issue_events_137552.json:
```json
{
    "actor": "https://github.com/sagetrac-kohel",
    "created_at": "2011-11-15T10:37:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "08517b",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137552"
}
```



---

archive/issue_events_137553.json:
```json
{
    "actor": "https://github.com/sagetrac-kohel",
    "created_at": "2011-11-15T10:37:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137553"
}
```



---

archive/issue_events_137554.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137554"
}
```



---

archive/issue_events_137555.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137555"
}
```



---

archive/issue_events_137556.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137556"
}
```



---

archive/issue_events_137557.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137557"
}
```



---

archive/issue_events_137558.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137558"
}
```



---

archive/issue_events_137559.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137559"
}
```



---

archive/issue_events_137560.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137560"
}
```



---

archive/issue_events_137561.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137561"
}
```



---

archive/issue_events_137562.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-17T12:30:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137562"
}
```



---

archive/issue_events_137563.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-17T12:30:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12040#event-137563"
}
```



---

archive/issue_comments_130316.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,11 @@\n+\n+```\n sage: P.<t> = PolynomialRing(QQ)\n sage: F.<a> = FractionField(P)\n sage: Pxy.<x,y> = PolynomialRing(F,2)\n sage: f = y^2 - x*(x-1)*(x-2)\n sage: E = EllipticCurve(f)\n-\n----\n+---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n \n /Users/kohel/<ipython console> in <module>()\n@@ -31,5 +32,5 @@\n sage: f = y^2 - x*(x-1)*(x-2)\n sage: type(f.degrees())\n <type 'tuple'>\n-\n+```\n The elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.\n``````\n",
    "created_at": "2018-01-17T12:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12040#issuecomment-130316",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,11 @@
+
+```
 sage: P.<t> = PolynomialRing(QQ)
 sage: F.<a> = FractionField(P)
 sage: Pxy.<x,y> = PolynomialRing(F,2)
 sage: f = y^2 - x*(x-1)*(x-2)
 sage: E = EllipticCurve(f)
-
----
+---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
 
 /Users/kohel/<ipython console> in <module>()
@@ -31,5 +32,5 @@
 sage: f = y^2 - x*(x-1)*(x-2)
 sage: type(f.degrees())
 <type 'tuple'>
-
+```
 The elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.
``````




---

archive/issue_comments_130317.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nSimplified issue:\n\n```\nsage: F = FractionField(PolynomialRing(QQ,'t'))\nsage: Pxy.<x,y> = PolynomialRing(F,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: f.degrees()\n(3, 2)\nsage: f.degrees() == (3,2)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-94-a14e4537ede5> in <module>()\n----> 1 f.degrees() == (Integer(3),Integer(2))\n\nTypeError: Argument 'other' has incorrect type (expected \nsage.rings.polynomial.polydict.ETuple, got tuple)\n```",
    "created_at": "2018-01-17T12:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12040#issuecomment-130317",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'>**Comment 6:**</a>
Simplified issue:

```
sage: F = FractionField(PolynomialRing(QQ,'t'))
sage: Pxy.<x,y> = PolynomialRing(F,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: f.degrees()
(3, 2)
sage: f.degrees() == (3,2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-94-a14e4537ede5> in <module>()
----> 1 f.degrees() == (Integer(3),Integer(2))

TypeError: Argument 'other' has incorrect type (expected 
sage.rings.polynomial.polydict.ETuple, got tuple)
```
