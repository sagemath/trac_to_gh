# Issue 12449: Improve the way that sage evaluates symbolic functions on basic types

archive/issues_012277.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-bober"
    ],
    "body": "Currently when a symbolic function (e.g. gamma(), exp(), sin()) gets a python float, it passes it off to ginac, and let's ginac evaluate it. This can be very slow, e.g.:\n\n```\nsage: timeit('exp(6.0r)')\n625 loops, best of 3: 476 \u00b5s per loop\n```\nThis also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.\n\nTo fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.\n\nNow we have\n\n```\nsage: timeit('exp(6.0r)')\n625 loops, best of 3: 1.02 \u00b5s per loop\n```\nFor the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.\n\nI think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )\n\nFinally, I'll remark that these improvements could probably be much better. The above timings should be compared to\n\n```\nsage: timeit('math.exp(6.0r)')\n625 loops, best of 3: 112 ns per loop\n```\nApply:\n\n* [attachment: trac12449.patch](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)\n\nDepends on #4498\nDepends on #12507\nDepends on #9130\n\nCC:  @SnarkBoojum @eviatarbach\n\nKeywords: **gamma function**\n\nReviewer: **Burcin Erocal, Jonathan Bober**\n\nAuthor: **Jonathan Bober, Burcin Erocal**\n\nComponent: **symbolics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12449_\n\n",
    "closed_at": "2018-08-14T17:43:26Z",
    "created_at": "2012-02-05T21:53:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/worksforme"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve the way that sage evaluates symbolic functions on basic types",
    "type": "issue",
    "updated_at": "2018-08-14T17:43:26Z",
    "url": "https://github.com/sagemath/sage/issues/12449",
    "user": "https://github.com/sagetrac-bober"
}
```
Currently when a symbolic function (e.g. gamma(), exp(), sin()) gets a python float, it passes it off to ginac, and let's ginac evaluate it. This can be very slow, e.g.:

```
sage: timeit('exp(6.0r)')
625 loops, best of 3: 476 µs per loop
```
This also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.

To fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.

Now we have

```
sage: timeit('exp(6.0r)')
625 loops, best of 3: 1.02 µs per loop
```
For the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.

I think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )

Finally, I'll remark that these improvements could probably be much better. The above timings should be compared to

```
sage: timeit('math.exp(6.0r)')
625 loops, best of 3: 112 ns per loop
```
Apply:

* [attachment: trac12449.patch](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)

Depends on #4498
Depends on #12507
Depends on #9130

CC:  @SnarkBoojum @eviatarbach

Keywords: **gamma function**

Reviewer: **Burcin Erocal, Jonathan Bober**

Author: **Jonathan Bober, Burcin Erocal**

Component: **symbolics**

_Issue created by migration from https://trac.sagemath.org/ticket/12449_





---

archive/issue_events_170216.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-05T21:53:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170216"
}
```



---

archive/issue_events_170217.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-05T21:53:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170217"
}
```



---

archive/issue_events_170218.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-05T21:53:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170218"
}
```



---

archive/issue_events_170219.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-05T21:53:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170219"
}
```



---

archive/issue_events_170220.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-05T21:53:23Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "subject": "https://github.com/sagetrac-bober",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170220"
}
```



---

archive/issue_events_170221.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-08T00:06:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170221"
}
```



---

archive/issue_comments_137257.json:
```json
{
    "body": "Author: **bober**",
    "created_at": "2012-02-08T00:06:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137257",
    "user": "https://github.com/sagetrac-bober"
}
```

Author: **bober**



---

archive/issue_comments_137258.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,15 +1,28 @@\n-There are numerical inaccuracies in the gamma function on python floats on some platforms. See, e.g. \n-http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c\n-\n-Also, the current implementation is slower than it should be on basic types:\n+Currently when a symbolic function (e.g. gamma(), exp(), sin()) gets a python float, it passes it off to ginac, and let's ginac evaluate it. This can be very slow, e.g.:\n \n ```\n-sage: timeit('gamma(6.0r)')\n-625 loops, best of 3: 32 \u00b5s per loop\n-sage: timeit('gamma(6r)')\n-625 loops, best of 3: 44.3 \u00b5s per loop\n-sage: timeit('gamma(6.0)')\n-625 loops, best of 3: 22.9 \u00b5s per loop\n-sage: timeit('gamma(6)')\n-625 loops, best of 3: 3.29 \u00b5s per loop\n+sage: timeit('exp(6.0r)')\n+625 loops, best of 3: 476 \u00b5s per loop\n ```\n+\n+This also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.\n+\n+To fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.\n+\n+Now we have\n+\n+```\n+sage: timeit('exp(6.0r)')\n+625 loops, best of 3: 1.02 \u00b5s per loop\n+```\n+\n+For the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.\n+\n+I think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )\n+\n+Finally, I'll remark that these improvements could probably be much better. The above timings should be compared to\n+\n+```\n+sage: timeit('math.exp(6.0r)')\n+625 loops, best of 3: 112 ns per loop\n+```\n``````\n",
    "created_at": "2012-02-08T00:06:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137258",
    "user": "https://github.com/sagetrac-bober"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,15 +1,28 @@
-There are numerical inaccuracies in the gamma function on python floats on some platforms. See, e.g. 
-http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c
-
-Also, the current implementation is slower than it should be on basic types:
+Currently when a symbolic function (e.g. gamma(), exp(), sin()) gets a python float, it passes it off to ginac, and let's ginac evaluate it. This can be very slow, e.g.:
 
 ```
-sage: timeit('gamma(6.0r)')
-625 loops, best of 3: 32 µs per loop
-sage: timeit('gamma(6r)')
-625 loops, best of 3: 44.3 µs per loop
-sage: timeit('gamma(6.0)')
-625 loops, best of 3: 22.9 µs per loop
-sage: timeit('gamma(6)')
-625 loops, best of 3: 3.29 µs per loop
+sage: timeit('exp(6.0r)')
+625 loops, best of 3: 476 µs per loop
 ```
+
+This also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.
+
+To fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.
+
+Now we have
+
+```
+sage: timeit('exp(6.0r)')
+625 loops, best of 3: 1.02 µs per loop
+```
+
+For the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.
+
+I think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )
+
+Finally, I'll remark that these improvements could probably be much better. The above timings should be compared to
+
+```
+sage: timeit('math.exp(6.0r)')
+625 loops, best of 3: 112 ns per loop
+```
``````




---

archive/issue_events_170222.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-08T00:06:24Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "title_is": "Improve the way that sage evaluates symbolic functions on basic types",
    "title_was": "Improve the gamma function",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170222"
}
```



---

archive/issue_events_170223.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-08T00:06:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170223"
}
```



---

archive/issue_events_170224.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-08T00:06:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170224"
}
```



---

archive/issue_events_170225.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-08T12:28:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170225"
}
```



---

archive/issue_events_170226.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-08T12:28:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170226"
}
```



---

archive/issue_comments_137259.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThanks for the patch. I agree that considering float and complex types separately in the fast evaluation path makes sense for speed. However, this causes inconsistencies with the results you get when a value is substituted into the expression.\n\nWe still need to modify the `py_tgamma()` function in `sage/symbolic/pynac.pyx` to fix this:\n\n```\nsage: gamma(x).subs(x=6.r)          \n120.0\n```\n\nAFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.\n\nThis would be a good occasion to merge my patch from [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)I'll try to rebase your patch on top of that.",
    "created_at": "2012-02-08T12:28:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137259",
    "user": "https://github.com/burcin"
}
```

<div id="comment:2" align="right">comment:2</div>

Thanks for the patch. I agree that considering float and complex types separately in the fast evaluation path makes sense for speed. However, this causes inconsistencies with the results you get when a value is substituted into the expression.

We still need to modify the `py_tgamma()` function in `sage/symbolic/pynac.pyx` to fix this:

```
sage: gamma(x).subs(x=6.r)          
120.0
```

AFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.

This would be a good occasion to merge my patch from [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)I'll try to rebase your patch on top of that.



---

archive/issue_comments_137260.json:
```json
{
    "body": "Changed author from **bober** to **Jonathan Bober**",
    "created_at": "2012-02-08T12:28:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137260",
    "user": "https://github.com/burcin"
}
```

Changed author from **bober** to **Jonathan Bober**



---

archive/issue_comments_137261.json:
```json
{
    "body": "Reviewer: **Burcin Erocal**",
    "created_at": "2012-02-08T12:28:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137261",
    "user": "https://github.com/burcin"
}
```

Reviewer: **Burcin Erocal**



---

archive/issue_comments_137262.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@burcin](#comment:2):\n\n> AFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.\n\nSorry. I was looking at the code after applying [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)There is no `try/except` block in the original code.\n\nRegarding the changes to `sage/rings/real_double.pyx`: IIRC, python's math module just calls the underlying libc functions. On ARM won't this introduce new errors?",
    "created_at": "2012-02-08T12:45:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137262",
    "user": "https://github.com/burcin"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@burcin](#comment:2):

> AFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.

Sorry. I was looking at the code after applying [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)There is no `try/except` block in the original code.

Regarding the changes to `sage/rings/real_double.pyx`: IIRC, python's math module just calls the underlying libc functions. On ARM won't this introduce new errors?



---

archive/issue_comments_137263.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@burcin](#comment:3):\n> Replying to [@burcin](#comment:2):\n> \n> > AFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.\n\n> \n> Sorry. I was looking at the code after applying [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)There is no `try/except` block in the original code.\n> \n> Regarding the changes to `sage/rings/real_double.pyx`: IIRC, python's math module just calls the underlying libc functions. On ARM won't this introduce new errors?\n\nFor the gamma function, at least, python has its own implementation. Of course, that function itself might call some underlying libc functions, so maybe it won't be entirely consistent, now that I think about it.\n\nIn the bit of testing that I did, math.gamma was less accurate than tgammal on my computer, but much more accurate than gsl's gamma function.",
    "created_at": "2012-02-08T12:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137263",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@burcin](#comment:3):
> Replying to [@burcin](#comment:2):
> 
> > AFAICT (without applying the patch and testing), [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz) removes the `try/except` block around `return getattr(args[0], self._name)()`, disabling the call to `BuiltinFunction.__call__` later on in the function body.

> 
> Sorry. I was looking at the code after applying [attachment: trac_1173-move_call.patch:ticket:1173](https://github.com/sagemath/sage/files/ticket12449/5f4170beaed5bdf5603adfab4f054c23.gz)There is no `try/except` block in the original code.
> 
> Regarding the changes to `sage/rings/real_double.pyx`: IIRC, python's math module just calls the underlying libc functions. On ARM won't this introduce new errors?

For the gamma function, at least, python has its own implementation. Of course, that function itself might call some underlying libc functions, so maybe it won't be entirely consistent, now that I think about it.

In the bit of testing that I did, math.gamma was less accurate than tgammal on my computer, but much more accurate than gsl's gamma function.



---

archive/issue_comments_137264.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,3 +26,7 @@\n sage: timeit('math.exp(6.0r)')\n 625 loops, best of 3: 112 ns per loop\n ```\n+\n+Apply:\n+- [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)\n+- [attachment: trac_12449-py_tgamma.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449-py_tgamma.patch.gz)\n``````\n",
    "created_at": "2012-02-13T11:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137264",
    "user": "https://github.com/burcin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,3 +26,7 @@
 sage: timeit('math.exp(6.0r)')
 625 loops, best of 3: 112 ns per loop
 ```
+
+Apply:
+- [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)
+- [attachment: trac_12449-py_tgamma.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449-py_tgamma.patch.gz)
``````




---

archive/issue_comments_137265.json:
```json
{
    "body": "Changed author from **Jonathan Bober** to **Jonathan Bober, Burcin Erocal**",
    "created_at": "2012-02-13T11:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137265",
    "user": "https://github.com/burcin"
}
```

Changed author from **Jonathan Bober** to **Jonathan Bober, Burcin Erocal**



---

archive/issue_events_170227.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-13T11:08:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170227"
}
```



---

archive/issue_events_170228.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-13T11:08:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170228"
}
```



---

archive/issue_comments_137266.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt turns out that Python implements the gamma function itself:\n\nhttp://hg.python.org/cpython/file/58bd6a58365d/Modules/mathmodule.c#l226\n\nI uploaded a new patch that changes `py_tgamma()` in `sage/symbolic/pynac.pyx` to use Python's gamma implementation.\n\nI give a positive review to [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)If someone can review my patch we can switch this to positive review.\n\nBTW, this will fix #9162. We should close that as a duplicate.",
    "created_at": "2012-02-13T11:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137266",
    "user": "https://github.com/burcin"
}
```

<div id="comment:5" align="right">comment:5</div>

It turns out that Python implements the gamma function itself:

http://hg.python.org/cpython/file/58bd6a58365d/Modules/mathmodule.c#l226

I uploaded a new patch that changes `py_tgamma()` in `sage/symbolic/pynac.pyx` to use Python's gamma implementation.

I give a positive review to [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)If someone can review my patch we can switch this to positive review.

BTW, this will fix #9162. We should close that as a duplicate.



---

archive/issue_comments_137267.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI uploaded a new version of my patch since the previous function had a typo that make doctests fail.",
    "created_at": "2012-02-13T14:31:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137267",
    "user": "https://github.com/burcin"
}
```

<div id="comment:6" align="right">comment:6</div>

I uploaded a new version of my patch since the previous function had a typo that make doctests fail.



---

archive/issue_comments_137268.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWell, I suppose that I will just go ahead and give it a positive review, since your changes are simple and orthogonal to mine (and I checked that all tests still pass on my machine). I would like to get some confirmation that this fixes things on ARM, but I suppose that we'll find that out eventually; that's a secondary point as far as this patch goes, though, so it isn't that important.",
    "created_at": "2012-02-15T06:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137268",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:7" align="right">comment:7</div>

Well, I suppose that I will just go ahead and give it a positive review, since your changes are simple and orthogonal to mine (and I checked that all tests still pass on my machine). I would like to get some confirmation that this fixes things on ARM, but I suppose that we'll find that out eventually; that's a secondary point as far as this patch goes, though, so it isn't that important.



---

archive/issue_comments_137269.json:
```json
{
    "body": "Changed reviewer from **Burcin Erocal** to **Burcin Erocal, Jonathan Bober**",
    "created_at": "2012-02-15T06:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137269",
    "user": "https://github.com/sagetrac-bober"
}
```

Changed reviewer from **Burcin Erocal** to **Burcin Erocal, Jonathan Bober**



---

archive/issue_events_170229.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-15T06:17:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170229"
}
```



---

archive/issue_events_170230.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-15T06:17:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170230"
}
```



---

archive/issue_comments_137270.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThis should be rebased to #4498 + #12507 + #9130.",
    "created_at": "2012-02-24T08:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137270",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

This should be rebased to #4498 + #12507 + #9130.



---

archive/issue_comments_137271.json:
```json
{
    "body": "Dependencies: **#4498, #12507, #9130**",
    "created_at": "2012-02-24T08:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137271",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#4498, #12507, #9130**



---

archive/issue_events_170231.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-24T08:34:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170231"
}
```



---

archive/issue_events_170232.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-24T08:34:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170232"
}
```



---

archive/issue_comments_137272.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,5 +28,4 @@\n ```\n \n Apply:\n-- [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)\n-- [attachment: trac_12449-py_tgamma.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449-py_tgamma.patch.gz)\n+- [attachment: trac_12449_rebase.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase.patch.gz)\n``````\n",
    "created_at": "2012-02-28T01:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137272",
    "user": "https://github.com/sagetrac-bober"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,5 +28,4 @@
 ```
 
 Apply:
-- [attachment: 12449.patch](https://github.com/sagemath/sage/files/ticket12449/12449.patch.gz)
-- [attachment: trac_12449-py_tgamma.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449-py_tgamma.patch.gz)
+- [attachment: trac_12449_rebase.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase.patch.gz)
``````




---

archive/issue_comments_137273.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI've attached a patch rebased to 5.0-beta5. I had no problem applying the patches, so I just made sure all tests still pass.\n\nMaybe I should just go ahead and put it back to positive review, but I'll give Burcin a day or so to take a look at it.",
    "created_at": "2012-02-28T01:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137273",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:9" align="right">comment:9</div>

I've attached a patch rebased to 5.0-beta5. I had no problem applying the patches, so I just made sure all tests still pass.

Maybe I should just go ahead and put it back to positive review, but I'll give Burcin a day or so to take a look at it.



---

archive/issue_events_170233.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-28T01:03:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170233"
}
```



---

archive/issue_events_170234.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-02-28T01:03:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170234"
}
```



---

archive/issue_events_170235.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-28T07:57:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170235"
}
```



---

archive/issue_events_170236.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-02-28T07:57:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170236"
}
```



---

archive/issue_comments_137274.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nLooks good to me.",
    "created_at": "2012-02-28T07:57:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137274",
    "user": "https://github.com/burcin"
}
```

<div id="comment:10" align="right">comment:10</div>

Looks good to me.



---

archive/issue_comments_137275.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRebasing to sage-5.0.beta5 isn't sufficient, since #9130 was only merged in sage-5.0.beta**6**.  So, this patch still needs an extra rebase.",
    "created_at": "2012-02-28T21:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137275",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Rebasing to sage-5.0.beta5 isn't sufficient, since #9130 was only merged in sage-5.0.beta**6**.  So, this patch still needs an extra rebase.



---

archive/issue_events_170237.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-28T21:36:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170237"
}
```



---

archive/issue_events_170238.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-28T21:36:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170238"
}
```



---

archive/issue_comments_137276.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOops. I guess that explains why I didn't actually need to do anything to rebase. I'll try to remember to update this later today.",
    "created_at": "2012-02-28T23:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137276",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:12" align="right">comment:12</div>

Oops. I guess that explains why I didn't actually need to do anything to rebase. I'll try to remember to update this later today.



---

archive/issue_comments_137277.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,4 +28,4 @@\n ```\n \n Apply:\n-- [attachment: trac_12449_rebase.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase.patch.gz)\n+- [attachment: trac_12449_rebase_beta7.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase_beta7.patch.gz)\n``````\n",
    "created_at": "2012-03-06T07:22:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137277",
    "user": "https://github.com/sagetrac-bober"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,4 +28,4 @@
 ```
 
 Apply:
-- [attachment: trac_12449_rebase.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase.patch.gz)
+- [attachment: trac_12449_rebase_beta7.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase_beta7.patch.gz)
``````




---

archive/issue_events_170239.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-03-06T07:23:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170239"
}
```



---

archive/issue_events_170240.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-03-06T07:23:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170240"
}
```



---

archive/issue_comments_137278.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOk, now it is rebased to 5.0beta7.",
    "created_at": "2012-03-06T07:23:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137278",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:14" align="right">comment:14</div>

Ok, now it is rebased to 5.0beta7.



---

archive/issue_events_170241.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-12T12:58:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170241"
}
```



---

archive/issue_events_170242.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-12T12:58:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170242"
}
```



---

archive/issue_comments_137279.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThere is numerical noise.  On hawk (OpenSolaris 06.2009-32):\n\n```\nsage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx\nWarning: divide by zero encountered in divide\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.0.beta8/devel/sage-main/sage/symbolic/function.pyx\", line 185:\n    sage: cot(complex(1,2))\nExpected:\n    (0.03279775553375259-0.9843292264581908j)\nGot:\n    (0.03279775553375261-0.9843292264581911j)\n**********************************************************************\nsage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py\nWarning: divide by zero encountered in divide\nWarning: divide by zero encountered in divide\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.0.beta8/devel/sage-main/sage/functions/hyperbolic.py\", line 543:\n    sage: float(arccoth(2))\nExpected:\n    0.5493061443340548\nGot:\n    0.5493061443340549\n**********************************************************************\n```",
    "created_at": "2012-03-12T12:58:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137279",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

There is numerical noise.  On hawk (OpenSolaris 06.2009-32):

```
sage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx
Warning: divide by zero encountered in divide
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.0.beta8/devel/sage-main/sage/symbolic/function.pyx", line 185:
    sage: cot(complex(1,2))
Expected:
    (0.03279775553375259-0.9843292264581908j)
Got:
    (0.03279775553375261-0.9843292264581911j)
**********************************************************************
sage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py
Warning: divide by zero encountered in divide
Warning: divide by zero encountered in divide
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.0.beta8/devel/sage-main/sage/functions/hyperbolic.py", line 543:
    sage: float(arccoth(2))
Expected:
    0.5493061443340548
Got:
    0.5493061443340549
**********************************************************************
```



---

archive/issue_comments_137280.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOn bsd (OS X 10.6 64-bit):\n\n```\nsage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py\nWarning: divide by zero encountered in divide\nWarning: divide by zero encountered in divide\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-5.0.beta8/devel/sage-main/sage/functions/hyperbolic.py\", line 543:\n    sage: float(arccoth(2))\nExpected:\n    0.5493061443340548\nGot:\n    0.5493061443340549\n**********************************************************************\n```",
    "created_at": "2012-03-12T13:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137280",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

On bsd (OS X 10.6 64-bit):

```
sage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py
Warning: divide by zero encountered in divide
Warning: divide by zero encountered in divide
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-5.0.beta8/devel/sage-main/sage/functions/hyperbolic.py", line 543:
    sage: float(arccoth(2))
Expected:
    0.5493061443340548
Got:
    0.5493061443340549
**********************************************************************
```



---

archive/issue_comments_137281.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOn iras (ia64):\n\n```\nsage -t  --long -force_lib devel/sage/sage/rings/arith.py\n**********************************************************************\nFile \"/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-5.0.beta8/devel/sage-main/sage/rings/arith.py\", line 3066:\n    sage: abs(binomial(0.5r, 5) - 0.02734375) < 1e-17r\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```",
    "created_at": "2012-03-12T20:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137281",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

On iras (ia64):

```
sage -t  --long -force_lib devel/sage/sage/rings/arith.py
**********************************************************************
File "/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-5.0.beta8/devel/sage-main/sage/rings/arith.py", line 3066:
    sage: abs(binomial(0.5r, 5) - 0.02734375) < 1e-17r
Expected:
    True
Got:
    False
**********************************************************************
```



---

archive/issue_comments_137282.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jdemeyer](#comment:17):\n> On iras (ia64):\n> \n> ```\n> sage -t  --long -force_lib devel/sage/sage/rings/arith.py\n> **********************************************************************\n> File \"/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-5.0.beta8/devel/sage-main/sage/rings/arith.py\", line 3066:\n>     sage: abs(binomial(0.5r, 5) - 0.02734375) < 1e-17r\n> Expected:\n>     True\n> Got:\n>     False\n> **********************************************************************\n> ```\n\nThree remarks:\n1. that test is also one that is failing on ARM ; and there's a trac ticket about binomial's implementation being pretty wrong (#12448).\n2. should that test use \"#tol abs\" instead of doing the computation itself?\n3. shouldn't it be even a \"#tol rel\" ?",
    "created_at": "2012-03-13T06:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137282",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jdemeyer](#comment:17):
> On iras (ia64):
> 
> ```
> sage -t  --long -force_lib devel/sage/sage/rings/arith.py
> **********************************************************************
> File "/home/buildbot/build/sage/cleo-1/cleo_full/build/sage-5.0.beta8/devel/sage-main/sage/rings/arith.py", line 3066:
>     sage: abs(binomial(0.5r, 5) - 0.02734375) < 1e-17r
> Expected:
>     True
> Got:
>     False
> **********************************************************************
> ```

Three remarks:
1. that test is also one that is failing on ARM ; and there's a trac ticket about binomial's implementation being pretty wrong (#12448).
2. should that test use "#tol abs" instead of doing the computation itself?
3. shouldn't it be even a "#tol rel" ?



---

archive/issue_comments_137283.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOn cicero (Linux i386):\n\n```\nsage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx\nWarning: divide by zero encountered in divide\n**********************************************************************\nFile \"/home/buildbot/build/sage/cicero-1/cicero_full/build/sage-5.0.beta8/devel/sage-main/sage/symbolic/function.pyx\", line 185:\n    sage: cot(complex(1,2))\nExpected:\n    (0.03279775553375259-0.9843292264581908j)\nGot:\n    (0.032797755533752596-0.9843292264581911j)\n**********************************************************************\n```",
    "created_at": "2012-03-13T12:44:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137283",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

On cicero (Linux i386):

```
sage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx
Warning: divide by zero encountered in divide
**********************************************************************
File "/home/buildbot/build/sage/cicero-1/cicero_full/build/sage-5.0.beta8/devel/sage-main/sage/symbolic/function.pyx", line 185:
    sage: cot(complex(1,2))
Expected:
    (0.03279775553375259-0.9843292264581908j)
Got:
    (0.032797755533752596-0.9843292264581911j)
**********************************************************************
```



---

archive/issue_events_170243.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-05-25T03:11:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170243"
}
```



---

archive/issue_events_170244.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-05-25T03:11:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170244"
}
```



---

archive/issue_comments_137284.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,6 @@\n sage: timeit('exp(6.0r)')\n 625 loops, best of 3: 476 \u00b5s per loop\n ```\n-\n This also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.\n \n To fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.\n@@ -15,7 +14,6 @@\n sage: timeit('exp(6.0r)')\n 625 loops, best of 3: 1.02 \u00b5s per loop\n ```\n-\n For the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.\n \n I think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )\n@@ -26,6 +24,6 @@\n sage: timeit('math.exp(6.0r)')\n 625 loops, best of 3: 112 ns per loop\n ```\n+Apply:\n \n-Apply:\n-- [attachment: trac_12449_rebase_beta7.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase_beta7.patch.gz)\n+* [attachment: trac12449.patch](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)\n``````\n",
    "created_at": "2012-05-25T03:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137284",
    "user": "https://github.com/sagetrac-bober"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,6 @@
 sage: timeit('exp(6.0r)')
 625 loops, best of 3: 476 µs per loop
 ```
-
 This also leads to possibly undesirable inconsistencies across different platforms: for example, ginac ends up calling the local libc tgammal to evaluate the gamma function, and even when this tgammal is evaluated by the same version of eglibc on two different platforms the answer varies depending on whether 80 bit doubles are available.
 
 To fix this, we make Sage check its types which correspond most closely to python type for the function that should be called, and use the functions for those types if available.
@@ -15,7 +14,6 @@
 sage: timeit('exp(6.0r)')
 625 loops, best of 3: 1.02 µs per loop
 ```
-
 For the specific case of the gamma function, the is also a change here to make RDF use python's math.gamma(). It is more accurate than gsl. It is perhaps not as accurate as eglibc's gamma(), but it should give reliable results on different platforms.
 
 I think this will fix 3 of the 4 failing numerical accuracy doctests on ARM, though the test for binomial(.5r, 5) had to be weakened slightly.  (see http://groups.google.com/group/sage-devel/browse_thread/thread/3c8c61ea113ea60c ) binomial() is currently not computed in a very good way, though, so it is reasonable to weaken this test temporarily. (see https://github.com/sagemath/sage/issues/12448 )
@@ -26,6 +24,6 @@
 sage: timeit('math.exp(6.0r)')
 625 loops, best of 3: 112 ns per loop
 ```
+Apply:
 
-Apply:
-- [attachment: trac_12449_rebase_beta7.patch](https://github.com/sagemath/sage/files/ticket12449/trac_12449_rebase_beta7.patch.gz)
+* [attachment: trac12449.patch](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)
``````




---

archive/issue_comments_137285.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOk, here is a version that should quiet those numerical errors. I'm leaving this as need review for the moment instead of putting it back to positive review in case someone wants to revisit the issue of whether or not we might want to make sure that we don't return different results on different machines.",
    "created_at": "2012-05-25T03:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137285",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:21" align="right">comment:21</div>

Ok, here is a version that should quiet those numerical errors. I'm leaving this as need review for the moment instead of putting it back to positive review in case someone wants to revisit the issue of whether or not we might want to make sure that we don't return different results on different machines.



---

archive/issue_comments_137286.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI think it's better to use `RR` (= `RealField(53)`) or `CC` (=`ComplexField(53)`) instead of `RDF` or `CDF`.  That should give more consistent results.",
    "created_at": "2012-05-25T05:07:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137286",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

I think it's better to use `RR` (= `RealField(53)`) or `CC` (=`ComplexField(53)`) instead of `RDF` or `CDF`.  That should give more consistent results.



---

archive/issue_comments_137287.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nMissing \"-\":\n\n```\n            sage: abs(float(arccoth(2)) - 0.5493061443340548) < 1e16 \n```",
    "created_at": "2012-05-25T17:55:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137287",
    "user": "https://github.com/sagetrac-dsm"
}
```

<div id="comment:23" align="right">comment:23</div>

Missing "-":

```
            sage: abs(float(arccoth(2)) - 0.5493061443340548) < 1e16 
```



---

archive/issue_comments_137288.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@sagetrac-dsm](#comment:23):\n> Missing \"-\":\n> \n> ```\n>             sage: abs(float(arccoth(2)) - 0.5493061443340548) < 1e16 \n> ```\n\nOops. That is fixed, and the 16 is changed to a 15, since 16 is actually too large, I think. I also took the opportunity to write a better commit message. \n\nOf course, I'm still not sure if this is the right way to do things.",
    "created_at": "2012-05-27T21:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137288",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@sagetrac-dsm](#comment:23):
> Missing "-":
> 
> ```
>             sage: abs(float(arccoth(2)) - 0.5493061443340548) < 1e16 
> ```

Oops. That is fixed, and the 16 is changed to a 15, since 16 is actually too large, I think. I also took the opportunity to write a better commit message. 

Of course, I'm still not sure if this is the right way to do things.



---

archive/issue_events_170245.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-05-31T22:28:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170245"
}
```



---

archive/issue_events_170246.json:
```json
{
    "actor": "https://github.com/sagetrac-bober",
    "created_at": "2012-05-31T22:28:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170246"
}
```



---

archive/issue_comments_137289.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nAttachment: **[trac12449.patch.gz](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)**\n\nOk, after a brief discussion at SD 40.5 (after Jeroen went to sleep and wasn't there to complain) I'm restoring this to positive review. A few people seemed to agree that if a function is called on a machine floating point type then it is reasonable for it to give machine dependent answers.\n\nI hope that all the tests actually pass now. Also, I've twice updated the patch to remove trailing whitespace, so I hope that I actually got it all this time.\n\n(Of course, Jeroen will still have an opportunity to object...)",
    "created_at": "2012-05-31T22:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137289",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:25" align="right">comment:25</div>

Attachment: **[trac12449.patch.gz](https://github.com/sagemath/sage/files/ticket12449/trac12449.patch.gz)**

Ok, after a brief discussion at SD 40.5 (after Jeroen went to sleep and wasn't there to complain) I'm restoring this to positive review. A few people seemed to agree that if a function is called on a machine floating point type then it is reasonable for it to give machine dependent answers.

I hope that all the tests actually pass now. Also, I've twice updated the patch to remove trailing whitespace, so I hope that I actually got it all this time.

(Of course, Jeroen will still have an opportunity to object...)



---

archive/issue_events_170247.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-01T08:51:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170247"
}
```



---

archive/issue_events_170248.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-01T08:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170248"
}
```



---

archive/issue_comments_137290.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@sagetrac-bober](#comment:25):\n> A few people seemed to agree that if a function is called on a machine floating point type then it is reasonable for it to give machine dependent answers.\n\nObviously the following comment doesn't apply then:\n\n```\n# It is more accurate than gsl's gamma function and \n# should provide consistant results across platforms. \n```\n\nAlso: you should add tests for the infinity stuff that you added.",
    "created_at": "2012-06-01T08:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137290",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@sagetrac-bober](#comment:25):
> A few people seemed to agree that if a function is called on a machine floating point type then it is reasonable for it to give machine dependent answers.

Obviously the following comment doesn't apply then:

```
# It is more accurate than gsl's gamma function and 
# should provide consistant results across platforms. 
```

Also: you should add tests for the infinity stuff that you added.



---

archive/issue_comments_137291.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n*** ping ***\n\nThe issues I mentioned in the last comment are fairly trivial.",
    "created_at": "2013-04-17T16:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137291",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

*** ping ***

The issues I mentioned in the last comment are fairly trivial.



---

archive/issue_events_170249.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170249"
}
```



---

archive/issue_events_170250.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170250"
}
```



---

archive/issue_events_170251.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170251"
}
```



---

archive/issue_events_170252.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170252"
}
```



---

archive/issue_events_170253.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170253"
}
```



---

archive/issue_events_170254.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170254"
}
```



---

archive/issue_events_170255.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170255"
}
```



---

archive/issue_events_170256.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170256"
}
```



---

archive/issue_comments_137292.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThe patch actually contains code that switches FP `sage_tgamma1` from GSL to `python_gamma` which might be a good thing, but requires a separate ticket. The timings are identical, so I suspect that the implementation might be too.",
    "created_at": "2015-02-02T15:05:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137292",
    "user": "https://github.com/rwst"
}
```

<div id="comment:33" align="right">comment:33</div>

The patch actually contains code that switches FP `sage_tgamma1` from GSL to `python_gamma` which might be a good thing, but requires a separate ticket. The timings are identical, so I suspect that the implementation might be too.



---

archive/issue_comments_137293.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n@jdemeyer: Is the patch still relevant after the changes you made to `BuiltinFunction.__call__`?",
    "created_at": "2015-02-02T15:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137293",
    "user": "https://github.com/rwst"
}
```

<div id="comment:34" align="right">comment:34</div>

@jdemeyer: Is the patch still relevant after the changes you made to `BuiltinFunction.__call__`?



---

archive/issue_events_170257.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T15:58:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170257"
}
```



---

archive/issue_events_170258.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T15:58:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170258"
}
```



---

archive/issue_comments_137294.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@rwst](#comment:34):\n> @jdemeyer: Is the patch still relevant after the changes you made to `BuiltinFunction.__call__`?\n\nNo, this overlaps a lot with #17130.",
    "created_at": "2015-02-02T16:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137294",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@rwst](#comment:34):
> @jdemeyer: Is the patch still relevant after the changes you made to `BuiltinFunction.__call__`?

No, this overlaps a lot with #17130.



---

archive/issue_events_170259.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-16T07:45:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170259"
}
```



---

archive/issue_events_170260.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-16T07:45:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170260"
}
```



---

archive/issue_events_170261.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-16T07:45:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170261"
}
```



---

archive/issue_events_170262.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-16T07:45:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170262"
}
```



---

archive/issue_events_170263.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-16T07:45:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170263"
}
```



---

archive/issue_comments_137295.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThe original issue seems resolved:\n\n```\nsage: %timeit('exp(6.0r)')\n100000000 loops, best of 3: 7.31 ns per loop\nsage: %timeit('math.exp(6.0r)')\n100000000 loops, best of 3: 7.28 ns per loop\n```",
    "created_at": "2018-03-16T07:45:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12449#issuecomment-137295",
    "user": "https://github.com/rwst"
}
```

<div id="comment:37" align="right">comment:37</div>

The original issue seems resolved:

```
sage: %timeit('exp(6.0r)')
100000000 loops, best of 3: 7.31 ns per loop
sage: %timeit('math.exp(6.0r)')
100000000 loops, best of 3: 7.28 ns per loop
```



---

archive/issue_events_170264.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:43:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170264"
}
```



---

archive/issue_events_170265.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:43:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170265"
}
```



---

archive/issue_events_170266.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:43:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12449",
    "label": "https://github.com/sagemath/sage/labels/worksforme",
    "label_color": "a6a6a6",
    "label_name": "worksforme",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12449#event-170266"
}
```
