# Issue 12629: Completely disable the LinBox commentator

archive/issues_012457.json:
```json
{
    "body": "Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.\n\nBut Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n\nThis causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.\n\nProposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n\n**Reviewer:** Martin Albrecht\n\n**Author:** Jeroen Demeyer\n\n**Merged:** sage-5.0.beta8\n\nIssue created by migration from https://trac.sagemath.org/ticket/12629\n\n",
    "closed_at": "2012-03-13T08:25:27Z",
    "created_at": "2012-03-04T22:52:42Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Completely disable the LinBox commentator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12629",
    "user": "https://github.com/jdemeyer"
}
```
Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.

But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.

This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.

Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)

**Reviewer:** Martin Albrecht

**Author:** Jeroen Demeyer

**Merged:** sage-5.0.beta8

Issue created by migration from https://trac.sagemath.org/ticket/12629





---

archive/issue_comments_175539.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,3 @@\n-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  Because the Sage library is built with the commentator disabled, this creates the following problem:\n+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n-1. The disabled commentator is constructed using a dummy constructor.\n-2. That commentator is then destructed using the real destructor, causing havoc.\n+Proposed solution: in the \"disabled\" commentator, still keep the member variables of the real commentator, disable only the member functions.\n``````\n",
    "created_at": "2012-03-05T09:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175539",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,3 @@
-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  Because the Sage library is built with the commentator disabled, this creates the following problem:
+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
-1. The disabled commentator is constructed using a dummy constructor.
-2. That commentator is then destructed using the real destructor, causing havoc.
+Proposed solution: in the "disabled" commentator, still keep the member variables of the real commentator, disable only the member functions.
``````




---

archive/issue_comments_175540.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n-Proposed solution: in the \"disabled\" commentator, still keep the member variables of the real commentator, disable only the member functions.\n+Proposed solution: **always** disable the commentator.\n``````\n",
    "created_at": "2012-03-05T11:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175540",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
-Proposed solution: in the "disabled" commentator, still keep the member variables of the real commentator, disable only the member functions.
+Proposed solution: **always** disable the commentator.
``````




---

archive/issue_comments_175541.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2012-03-05T12:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175541",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_comments_175542.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n Proposed solution: **always** disable the commentator.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n``````\n",
    "created_at": "2012-03-05T12:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175542",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
 Proposed solution: **always** disable the commentator.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
``````




---

archive/issue_comments_175543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n-Proposed solution: **always** disable the commentator.\n+Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n``````\n",
    "created_at": "2012-03-05T13:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175543",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
-Proposed solution: **always** disable the commentator.
+Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
``````




---

archive/issue_events_039644.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "rename": {
        "from": "Fix Linbox DISABLE_COMMENTATOR",
        "to": "Completely disable the LinBox commentator"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12629#event-39644"
}
```



---

archive/issue_comments_175544.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,7 @@\n-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.\n \n-Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.\n+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n+\n+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n``````\n",
    "created_at": "2012-03-05T13:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175544",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,7 @@
-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.
 
-Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.
+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
+
+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
``````




---

archive/issue_comments_175545.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,8 @@\n \n But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n+This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.\n+\n Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n``````\n",
    "created_at": "2012-03-06T13:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175545",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,8 @@
 
 But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
+This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.
+
 Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
``````




---

archive/issue_comments_175546.json:
```json
{
    "body": "Diff for the linbox spkg, for review only",
    "created_at": "2012-03-06T13:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175546",
    "user": "https://github.com/jdemeyer"
}
```

Diff for the linbox spkg, for review only



---

archive/attachments_016982.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "linbox-1.1.6.p7.diff",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12629/linbox-1.1.6.p7.diff",
    "created_at": "2012-03-06T13:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.diff",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_175547.json:
```json
{
    "body": "<a id='comment:8'></a>\n",
    "created_at": "2012-03-06T13:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175547",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>




---

archive/issue_comments_175548.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-03-06T13:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175548",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_175549.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175549",
    "user": "https://github.com/malb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_175550.json:
```json
{
    "body": "<a id='comment:9'></a>\n* patch looks good\n  * SPKG has no obvious problems (hg status, hg log etc.)\n  * doctests pass.\n\nI am satisfied and assume that any possibly outstanding issues will be caught by the buildbot.",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175550",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>
* patch looks good
  * SPKG has no obvious problems (hg status, hg log etc.)
  * doctests pass.

I am satisfied and assume that any possibly outstanding issues will be caught by the buildbot.



---

archive/issue_comments_175551.json:
```json
{
    "body": "**Reviewer:** Martin Albrecht",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175551",
    "user": "https://github.com/malb"
}
```

**Reviewer:** Martin Albrecht



---

archive/issue_comments_175552.json:
```json
{
    "body": "**Merged:** sage-5.0.beta8",
    "created_at": "2012-03-13T08:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175552",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta8



---

archive/issue_events_039645.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-13T08:25:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12629#event-39645"
}
```



---

archive/issue_comments_175553.json:
```json
{
    "body": "<a id='comment:11'></a>\nSee #12762 for a follow-up.  (The \"disable commentator\" patch in the p7 breaks building the test suite; fixed in a p8 there, which [of course] also adds an `spkg-check` file.)",
    "created_at": "2012-04-07T21:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-175553",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
See #12762 for a follow-up.  (The "disable commentator" patch in the p7 breaks building the test suite; fixed in a p8 there, which [of course] also adds an `spkg-check` file.)
