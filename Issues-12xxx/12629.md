# Issue 12629: Completely disable the LinBox commentator

archive/issues_012457.json:
```json
{
    "body": "Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.\n\nBut Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n\nThis causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.\n\nProposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n\nAssignee: tbd\n\nReviewer: Martin Albrecht\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.0.beta8\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12629\n\n",
    "closed_at": "2012-03-13T08:25:27Z",
    "created_at": "2012-03-04T22:52:42Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Completely disable the LinBox commentator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12629",
    "user": "https://github.com/jdemeyer"
}
```
Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.

But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.

This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.

Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)

Assignee: tbd

Reviewer: Martin Albrecht

Author: Jeroen Demeyer

Merged: sage-5.0.beta8

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12629





---

archive/issue_comments_181869.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2012-03-04T22:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181869",
    "user": "https://github.com/jdemeyer"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_181870.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  Because the Sage library is built with the commentator disabled, this creates the following problem:\n+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n-1. The disabled commentator is constructed using a dummy constructor.\n-2. That commentator is then destructed using the real destructor, causing havoc.\n+Proposed solution: in the \"disabled\" commentator, still keep the member variables of the real commentator, disable only the member functions.\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-05T09:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181870",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
-Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  Because the Sage library is built with the commentator disabled, this creates the following problem:
+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
-1. The disabled commentator is constructed using a dummy constructor.
-2. That commentator is then destructed using the real destructor, causing havoc.
+Proposed solution: in the "disabled" commentator, still keep the member variables of the real commentator, disable only the member functions.
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181871.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n+Proposed solution: **always** disable the commentator.\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-05T11:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181871",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
+Proposed solution: **always** disable the commentator.
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181872.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2012-03-05T11:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181872",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_181873.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2012-03-05T12:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181873",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_181874.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n+Proposed solution: **always** disable the commentator.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-05T12:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181874",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
+Proposed solution: **always** disable the commentator.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181875.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n \n+Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-05T13:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181875",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
+Linbox has its infamous `DISABLE_COMMENTATOR` #define.  When compiling code with this flag set, the commentator is disabled.  But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
 
+Proposed solution: **always** disable the commentator.  A patch is needed (backported from Linbox-1.2.2) to actually allow this.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181876.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.\n \n+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n+\n+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-05T13:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181876",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.
 
+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
+
+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181877.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.\n \n+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.\n+\n+This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.\n+\n+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)\n \n Type: PLEASE CHANGE\n \n``````\n",
    "created_at": "2012-03-06T13:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181877",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+Linbox has its infamous commentator, regularly causing trouble on various systems.  This commentator can be disabled by building with `-DDISABLE_COMMENTATOR`, this is done in the parts of the Sage library which use Linbox.
 
+But Linbox itself is compiled with the commentator enabled.  The problem is that commentator-enabled code is not compatible with commentator-disabled code because of C++ constructors/destructors.
+
+This causes problems in particular with GCC-4.6.3 (#12369) on OS X 10.4 PPC, but problems with the Linbox commentator have been observed on different systems too.
+
+Proposed solution: **always** disable the commentator by using `-DDISABLE_COMMENTATOR` in the Linbox spkg.  A patch is needed (backported from Linbox-1.2.2) to actually allow building Linbox like this.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/linbox-1.1.6.p7.spkg)
 
 Type: PLEASE CHANGE
 
``````




---

archive/issue_comments_181878.json:
```json
{
    "body": "Diff for the linbox spkg, for review only",
    "created_at": "2012-03-06T13:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181878",
    "user": "https://github.com/jdemeyer"
}
```

Diff for the linbox spkg, for review only



---

archive/issue_comments_181879.json:
```json
{
    "body": "<a id='comment:8'></a>Attachment [linbox-1.1.6.p7.diff](tarball://root/attachments/some-uuid/ticket12629/linbox-1.1.6.p7.diff) by @jdemeyer created at 2012-03-06 13:10:45",
    "created_at": "2012-03-06T13:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181879",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Attachment [linbox-1.1.6.p7.diff](tarball://root/attachments/some-uuid/ticket12629/linbox-1.1.6.p7.diff) by @jdemeyer created at 2012-03-06 13:10:45



---

archive/issue_comments_181880.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-06T13:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181880",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_181881.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181881",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_181882.json:
```json
{
    "body": "<a id='comment:9'></a>* patch looks good\n  * SPKG has no obvious problems (hg status, hg log etc.)\n  * doctests pass.\n\nI am satisfied and assume that any possibly outstanding issues will be caught by the buildbot.",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181882",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>* patch looks good
  * SPKG has no obvious problems (hg status, hg log etc.)
  * doctests pass.

I am satisfied and assume that any possibly outstanding issues will be caught by the buildbot.



---

archive/issue_comments_181883.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Albrecht\"",
    "created_at": "2012-03-06T14:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181883",
    "user": "https://github.com/malb"
}
```

Changing reviewer from "" to "Martin Albrecht"



---

archive/issue_comments_181884.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.0.beta8\"",
    "created_at": "2012-03-13T08:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181884",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.0.beta8"



---

archive/issue_events_034220.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-13T08:25:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12629#event-34220"
}
```



---

archive/issue_comments_181885.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-03-13T08:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181885",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_181886.json:
```json
{
    "body": "<a id='comment:11'></a>See #12762 for a follow-up.  (The \"disable commentator\" patch in the p7 breaks building the test suite; fixed in a p8 there, which [of course] also adds an `spkg-check` file.)",
    "created_at": "2012-04-07T21:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12629",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12629#issuecomment-181886",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>See #12762 for a follow-up.  (The "disable commentator" patch in the p7 breaks building the test suite; fixed in a p8 there, which [of course] also adds an `spkg-check` file.)
