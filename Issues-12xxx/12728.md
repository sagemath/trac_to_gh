# Issue 12728: sage's spkg sources should use correct include paths instead of having ../../../../whatever everywhere

archive/issues_012556.json:
```json
{
    "assignees": [
        "https://github.com/SnarkBoojum"
    ],
    "body": "**Problem**\n\nThere are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).\n\n**Solution**\nThose should be removed, and the right path added to the include line.\n\n\nThe first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.\n\nApply \n* [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)\n* [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)\n* [attachment: trac_12728_docbuild_workaround.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)\n\nReviewer: **Volker Braun, Jeroen Demeyer, Julien Puydt**\n\nAuthor: **Julien Puydt**\n\nMerged: **sage-5.10.beta5**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12728_\n\n",
    "closed_at": "2013-05-24T09:39:55Z",
    "created_at": "2012-03-22T13:46:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage's spkg sources should use correct include paths instead of having ../../../../whatever everywhere",
    "type": "issue",
    "updated_at": "2013-05-24T09:39:55Z",
    "url": "https://github.com/sagemath/sage/issues/12728",
    "user": "https://github.com/SnarkBoojum"
}
```
**Problem**

There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).

**Solution**
Those should be removed, and the right path added to the include line.


The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.

Apply 
* [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)
* [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)
* [attachment: trac_12728_docbuild_workaround.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)

Reviewer: **Volker Braun, Jeroen Demeyer, Julien Puydt**

Author: **Julien Puydt**

Merged: **sage-5.10.beta5**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/12728_





---

archive/issue_events_173488.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-22T13:46:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173488"
}
```



---

archive/issue_events_173489.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-22T13:46:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173489"
}
```



---

archive/issue_events_173490.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-22T13:46:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173490"
}
```



---

archive/issue_events_173491.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-22T13:46:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173491"
}
```



---

archive/issue_events_173492.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-22T13:46:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "subject": "https://github.com/SnarkBoojum",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173492"
}
```



---

archive/issue_events_173493.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2012-03-24T08:30:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173493"
}
```



---

archive/issue_comments_142442.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI don't like [attachment: compile_with_no_up_in_includes.patch](https://github.com/sagemath/sage/files/ticket12728/compile_with_no_up_in_includes.patch.gz).  I would prefer the patch to add only `SAGE_ROOT/devel/sage` and not all those other directories.",
    "created_at": "2012-04-02T09:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142442",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

I don't like [attachment: compile_with_no_up_in_includes.patch](https://github.com/sagemath/sage/files/ticket12728/compile_with_no_up_in_includes.patch.gz).  I would prefer the patch to add only `SAGE_ROOT/devel/sage` and not all those other directories.



---

archive/issue_comments_142443.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere are two problems with \"../../../../..\" :\n1. it doesn't give any serious information, so why is it here?\n2. the code is supposed to provide features ; it shouldn't worry about building.\n\nIt's better to have the build system provide ten \"-I\" flags than having a thousand places in the code where those ten paths are engraved, for maintainability reasons.",
    "created_at": "2012-04-02T10:38:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142443",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:3" align="right">comment:3</div>

There are two problems with "../../../../.." :
1. it doesn't give any serious information, so why is it here?
2. the code is supposed to provide features ; it shouldn't worry about building.

It's better to have the build system provide ten "-I" flags than having a thousand places in the code where those ten paths are engraved, for maintainability reasons.



---

archive/issue_comments_142444.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nPlease fill in your real name as Author.",
    "created_at": "2012-07-27T20:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142444",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Please fill in your real name as Author.



---

archive/issue_comments_142445.json:
```json
{
    "body": "Author: **Julien Puydt**",
    "created_at": "2012-08-06T13:17:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142445",
    "user": "https://github.com/SnarkBoojum"
}
```

Author: **Julien Puydt**



---

archive/issue_comments_142446.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSome dedication here. The second patch at least will need rebasing against at least 5.2. I am not sure you should add all these paths to CYTHON_INCLUDE_DIRS. Is there a reason why they are not in their own variable. Do you need all these and not just SAGE_ROOT + '/devel/sage/sage/'?",
    "created_at": "2012-08-08T11:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142446",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">comment:6</div>

Some dedication here. The second patch at least will need rebasing against at least 5.2. I am not sure you should add all these paths to CYTHON_INCLUDE_DIRS. Is there a reason why they are not in their own variable. Do you need all these and not just SAGE_ROOT + '/devel/sage/sage/'?



---

archive/issue_comments_142447.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYes, it's now old and deprecated. And yes, I think it was needed to add all those paths.\n\nI plan to rework on the matter differently -- the question is when. The plan would be to have some script with a list of the included headers with their full paths and their wanted path, which would normalize the paths in includes. That might still require changing CYTHON_INCLUDE_DIRS, but hopefully adding less paths.",
    "created_at": "2012-08-08T12:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142447",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:7" align="right">comment:7</div>

Yes, it's now old and deprecated. And yes, I think it was needed to add all those paths.

I plan to rework on the matter differently -- the question is when. The plan would be to have some script with a list of the included headers with their full paths and their wanted path, which would normalize the paths in includes. That might still require changing CYTHON_INCLUDE_DIRS, but hopefully adding less paths.



---

archive/issue_events_173494.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-08T12:40:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173494"
}
```



---

archive/issue_events_173495.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-08T12:40:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173495"
}
```



---

archive/issue_comments_142448.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOn Sage-devel, you reported that by changing the include paths the answers to some doctest in sage.misc.sageinspect changed. I'll see where that comes from, but I guess sageinspect needs a fix concerning temporary Cython code anyway.",
    "created_at": "2013-01-06T12:25:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142448",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:9" align="right">comment:9</div>

On Sage-devel, you reported that by changing the include paths the answers to some doctest in sage.misc.sageinspect changed. I'll see where that comes from, but I guess sageinspect needs a fix concerning temporary Cython code anyway.



---

archive/issue_comments_142449.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nSee #13916.",
    "created_at": "2013-01-06T12:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142449",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

See #13916.



---

archive/issue_comments_142450.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThat shell script has a bug where everything before stdsage.pxi might get eaten -- that is the reason why there's a failing doctest. Not ready for review yet :-P",
    "created_at": "2013-01-06T15:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142450",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:11" align="right">comment:11</div>

That shell script has a bug where everything before stdsage.pxi might get eaten -- that is the reason why there's a failing doctest. Not ready for review yet :-P



---

archive/issue_comments_142451.json:
```json
{
    "body": "Attachment: **[updirectories-sed.sh.gz](https://github.com/sagemath/sage/files/ticket12728/updirectories-sed.sh.gz)**\n\nShell script which patches 99,99% of the issues",
    "created_at": "2013-01-06T20:07:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142451",
    "user": "https://github.com/SnarkBoojum"
}
```

Attachment: **[updirectories-sed.sh.gz](https://github.com/sagemath/sage/files/ticket12728/updirectories-sed.sh.gz)**

Shell script which patches 99,99% of the issues



---

archive/issue_comments_142452.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOk, the new version of the updirectories-sed shell script passes all doctests: it needs review. It won't fix 100% of the problem, but the rest can be patched by hand, at it concerns only a handful of cases.",
    "created_at": "2013-01-07T07:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142452",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:12" align="right">comment:12</div>

Ok, the new version of the updirectories-sed shell script passes all doctests: it needs review. It won't fix 100% of the problem, but the rest can be patched by hand, at it concerns only a handful of cases.



---

archive/issue_events_173496.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2013-01-07T07:44:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173496"
}
```



---

archive/issue_events_173497.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2013-01-07T07:44:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173497"
}
```



---

archive/issue_comments_142453.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nPlease make it clear what should be applied.",
    "created_at": "2013-01-12T22:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142453",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Please make it clear what should be applied.



---

archive/issue_comments_142454.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe updirectories-sed.sh shell script needs to be reviewed:\n1. read ;\n2. run (from the right directory) ;\n3. compile ;\n4. make ptestlong ;\n5. report success (very likely) or failure (very unlikely).",
    "created_at": "2013-01-13T10:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142454",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:14" align="right">comment:14</div>

The updirectories-sed.sh shell script needs to be reviewed:
1. read ;
2. run (from the right directory) ;
3. compile ;
4. make ptestlong ;
5. report success (very likely) or failure (very unlikely).



---

archive/issue_comments_142455.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI think that's not how we want to proceed hence, Jeroen's question. Having the script is nice for testing but once you have run it you should generate a patch with mercurial and post it here for inclusion. \nThe script is nice for stuff that will be included in the future... there is a ticket somewhere where someone is making a similar mess - I didn't have the heart to shoot him early.",
    "created_at": "2013-01-13T10:11:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142455",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

I think that's not how we want to proceed hence, Jeroen's question. Having the script is nice for testing but once you have run it you should generate a patch with mercurial and post it here for inclusion. 
The script is nice for stuff that will be included in the future... there is a ticket somewhere where someone is making a similar mess - I didn't have the heart to shoot him early.



---

archive/issue_comments_142456.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI'll generate an mercurial patch if that is what you want. It will be thousands of lines long, but if you prefer to review that... every taste is in nature.",
    "created_at": "2013-01-13T10:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142456",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:16" align="right">comment:16</div>

I'll generate an mercurial patch if that is what you want. It will be thousands of lines long, but if you prefer to review that... every taste is in nature.



---

archive/issue_comments_142457.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSize of the patch is just a technical problem. It just makes it harder to find a problem if there is any but no more so than with just applying your script.",
    "created_at": "2013-01-13T10:32:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142457",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

Size of the patch is just a technical problem. It just makes it harder to find a problem if there is any but no more so than with just applying your script.



---

archive/issue_comments_142458.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@SnarkBoojum](#comment:16):\n> I'll generate an mercurial patch if that is what you want.\n\nNo, that's not needed.  But you should really explain **in the ticket description** which patches should be applied/which scripts should be run.  From the previous ticket description, it was a absolutely totally utterly completely not clear that the script should be run instead of applying any patches.",
    "created_at": "2013-01-13T10:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142458",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@SnarkBoojum](#comment:16):
> I'll generate an mercurial patch if that is what you want.

No, that's not needed.  But you should really explain **in the ticket description** which patches should be applied/which scripts should be run.  From the previous ticket description, it was a absolutely totally utterly completely not clear that the script should be run instead of applying any patches.



---

archive/issue_comments_142459.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,11 @@\n There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).\n \n-Those should be removed, and the right path added to the include\n-line.\n+Those should be removed, and the right path added to the include line.\n \n-I'll work on it in the coming days ; this ticket is so I can be pestered about it if I have no patch ready soon enough.\n+**Run**:\n+\n+```\n+cd \"$SAGE_ROOT/devel/sage/sage\"\n+source updirectories-sed.sh\n+hg commit -m \"Trac #12728: Update include directories\"\n+```\n``````\n",
    "created_at": "2013-01-13T10:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142459",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,11 @@
 There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).
 
-Those should be removed, and the right path added to the include
-line.
+Those should be removed, and the right path added to the include line.
 
-I'll work on it in the coming days ; this ticket is so I can be pestered about it if I have no patch ready soon enough.
+**Run**:
+
+```
+cd "$SAGE_ROOT/devel/sage/sage"
+source updirectories-sed.sh
+hg commit -m "Trac #12728: Update include directories"
+```
``````




---

archive/issue_comments_142460.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI don't like editing the ticket description because that breaks the flow of comments. And notice that running the shell script fixes a huge percentage of the updirectory includes, but doesn't fix them all : I'll still need to hand-edit the remaining ones afterwards.",
    "created_at": "2013-01-13T11:07:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142460",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:19" align="right">comment:19</div>

I don't like editing the ticket description because that breaks the flow of comments. And notice that running the shell script fixes a huge percentage of the updirectory includes, but doesn't fix them all : I'll still need to hand-edit the remaining ones afterwards.



---

archive/issue_comments_142461.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@SnarkBoojum](#comment:19):\n> I don't like editing the ticket description because that breaks the flow of comments.\n\nSo you expect the release manager to read **all the comments** in **every** ticket just to know which patches should be applied?  That's not going to happen.\n\nAnd even from reading the comments, it's not that clear that the shell script replaces the usual patch.",
    "created_at": "2013-01-13T11:51:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142461",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@SnarkBoojum](#comment:19):
> I don't like editing the ticket description because that breaks the flow of comments.

So you expect the release manager to read **all the comments** in **every** ticket just to know which patches should be applied?  That's not going to happen.

And even from reading the comments, it's not that clear that the shell script replaces the usual patch.



---

archive/issue_comments_142462.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYou rejected the patches, but trac doesn't allow to mark them as rejected as far as I know... so they still sit there, unfortunately.",
    "created_at": "2013-01-13T12:12:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142462",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:21" align="right">comment:21</div>

You rejected the patches, but trac doesn't allow to mark them as rejected as far as I know... so they still sit there, unfortunately.



---

archive/issue_comments_142463.json:
```json
{
    "body": "Patch created applying the script agains 5.10.beta3",
    "created_at": "2013-05-18T11:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142463",
    "user": "https://github.com/SnarkBoojum"
}
```

Patch created applying the script agains 5.10.beta3



---

archive/issue_comments_142464.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[trac_12728_5.10.beta3.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz)**\n\nOk, I applied the script on sage 5.10.beta3 ; it doesn't make new doctests fail (the quadratic forms code doesn't work correctly on this box anyway).",
    "created_at": "2013-05-18T11:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142464",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[trac_12728_5.10.beta3.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz)**

Ok, I applied the script on sage 5.10.beta3 ; it doesn't make new doctests fail (the quadratic forms code doesn't work correctly on this box anyway).



---

archive/issue_comments_142465.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,5 @@\n source updirectories-sed.sh\n hg commit -m \"Trac #12728: Update include directories\"\n ```\n+\n+**or alternatively, for sage-5.10.beta3, apply** trac_12728_5.10.beta3.patch.\n``````\n",
    "created_at": "2013-05-18T11:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142465",
    "user": "https://github.com/SnarkBoojum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,5 @@
 source updirectories-sed.sh
 hg commit -m "Trac #12728: Update include directories"
 ```
+
+**or alternatively, for sage-5.10.beta3, apply** trac_12728_5.10.beta3.patch.
``````




---

archive/issue_comments_142466.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,5 @@\n hg commit -m \"Trac #12728: Update include directories\"\n ```\n \n-**or alternatively, for sage-5.10.beta3, apply** trac_12728_5.10.beta3.patch.\n+\n+Jeroen: apply trac_12728_5.10.beta3.patch.\n``````\n",
    "created_at": "2013-05-18T11:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142466",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,5 @@
 hg commit -m "Trac #12728: Update include directories"
 ```
 
-**or alternatively, for sage-5.10.beta3, apply** trac_12728_5.10.beta3.patch.
+
+Jeroen: apply trac_12728_5.10.beta3.patch.
``````




---

archive/issue_comments_142467.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nLooks good to me!",
    "created_at": "2013-05-18T11:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142467",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

Looks good to me!



---

archive/issue_comments_142468.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2013-05-18T11:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142468",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_events_173498.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-18T11:59:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173498"
}
```



---

archive/issue_events_173499.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-18T11:59:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173499"
}
```



---

archive/issue_comments_142469.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nYou may have made some publicity for it earlier ... ;-)",
    "created_at": "2013-05-18T13:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142469",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:25" align="right">comment:25</div>

You may have made some publicity for it earlier ... ;-)



---

archive/issue_comments_142470.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nIf the patch built by my script gets applied for 5.10.beta4, there's even a chance I'll be able to work on the remaining problems for 5.10 :-)",
    "created_at": "2013-05-20T14:04:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142470",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:26" align="right">comment:26</div>

If the patch built by my script gets applied for 5.10.beta4, there's even a chance I'll be able to work on the remaining problems for 5.10 :-)



---

archive/issue_comments_142471.json:
```json
{
    "body": "Hand-crafted finalization of the fix",
    "created_at": "2013-05-21T06:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142471",
    "user": "https://github.com/SnarkBoojum"
}
```

Hand-crafted finalization of the fix



---

archive/issue_comments_142472.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAttachment: **[trac_12728_5.10.beta3_hand.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz)**",
    "created_at": "2013-05-21T06:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142472",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Attachment: **[trac_12728_5.10.beta3_hand.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz)**



---

archive/issue_events_173500.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T06:59:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173500"
}
```



---

archive/issue_events_173501.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T06:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173501"
}
```



---

archive/issue_events_173502.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T06:59:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173502"
}
```



---

archive/issue_events_173503.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T06:59:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173503"
}
```



---

archive/issue_comments_142473.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nIf [attachment: trac_12728_5.10.beta3_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz) should be applied, it should be reviewed and mentioned in the ticket description.",
    "created_at": "2013-05-21T07:00:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142473",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

If [attachment: trac_12728_5.10.beta3_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz) should be applied, it should be reviewed and mentioned in the ticket description.



---

archive/issue_comments_142474.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI also don't like two ways of applying a patch, because which one is \"correct\"? Either only mention the script, or only the patch.",
    "created_at": "2013-05-21T07:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142474",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

I also don't like two ways of applying a patch, because which one is "correct"? Either only mention the script, or only the patch.



---

archive/issue_comments_142475.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,13 +2,6 @@\n \n Those should be removed, and the right path added to the include line.\n \n-**Run**:\n+Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.\n \n-```\n-cd \"$SAGE_ROOT/devel/sage/sage\"\n-source updirectories-sed.sh\n-hg commit -m \"Trac #12728: Update include directories\"\n-```\n-\n-\n-Jeroen: apply trac_12728_5.10.beta3.patch.\n+(The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)\n``````\n",
    "created_at": "2013-05-21T12:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142475",
    "user": "https://github.com/SnarkBoojum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,13 +2,6 @@
 
 Those should be removed, and the right path added to the include line.
 
-**Run**:
+Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.
 
-```
-cd "$SAGE_ROOT/devel/sage/sage"
-source updirectories-sed.sh
-hg commit -m "Trac #12728: Update include directories"
-```
-
-
-Jeroen: apply trac_12728_5.10.beta3.patch.
+(The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)
``````




---

archive/issue_comments_142476.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.\n \n (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)\n+\n+(The first patch was already reviewed by Volker, but not the second)\n``````\n",
    "created_at": "2013-05-21T12:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142476",
    "user": "https://github.com/SnarkBoojum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.
 
 (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)
+
+(The first patch was already reviewed by Volker, but not the second)
``````




---

archive/issue_comments_142477.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nCan you rediff the first patch for sage-5.10.beta4",
    "created_at": "2013-05-21T12:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142477",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

Can you rediff the first patch for sage-5.10.beta4



---

archive/issue_comments_142478.json:
```json
{
    "body": "Work Issues: **rebase**",
    "created_at": "2013-05-21T13:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142478",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **rebase**



---

archive/issue_comments_142479.json:
```json
{
    "body": "Changed reviewer from **Volker Braun** to **Volker Braun, Jeroen Demeyer**",
    "created_at": "2013-05-21T13:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142479",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Volker Braun** to **Volker Braun, Jeroen Demeyer**



---

archive/issue_comments_142480.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nPositive review to [attachment: trac_12728_5.10.beta3_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz)",
    "created_at": "2013-05-21T13:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142480",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Positive review to [attachment: trac_12728_5.10.beta3_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3_hand.patch.gz)



---

archive/issue_events_173504.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T13:59:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173504"
}
```



---

archive/issue_events_173505.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-21T13:59:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173505"
}
```



---

archive/issue_comments_142481.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,8 +2,8 @@\n \n Those should be removed, and the right path added to the include line.\n \n-Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.\n+Apply [attachment: trac_12728_5.10.beta3.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz) and [attachment: trac_12728_5.10.beta3-hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3-hand.patch.gz)\n \n (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)\n \n-(The first patch was already reviewed by Volker, but not the second)\n+(The first patch was reviewed by Volker, the second by Jeroen)\n``````\n",
    "created_at": "2013-05-21T13:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142481",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,8 +2,8 @@
 
 Those should be removed, and the right path added to the include line.
 
-Apply trac_12728_5.10.beta3.patch and trac_12728_5.10.beta3-hand.patch.
+Apply [attachment: trac_12728_5.10.beta3.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz) and [attachment: trac_12728_5.10.beta3-hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3-hand.patch.gz)
 
 (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)
 
-(The first patch was already reviewed by Volker, but not the second)
+(The first patch was reviewed by Volker, the second by Jeroen)
``````




---

archive/issue_comments_142482.json:
```json
{
    "body": "Attachment: **[trac_12728_5.10.beta4_auto.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)**\n\nPatch created applying the script agains 5.10.beta4",
    "created_at": "2013-05-21T19:37:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142482",
    "user": "https://github.com/SnarkBoojum"
}
```

Attachment: **[trac_12728_5.10.beta4_auto.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)**

Patch created applying the script agains 5.10.beta4



---

archive/issue_comments_142483.json:
```json
{
    "body": "Attachment: **[trac_12728_5.10.beta4_hand.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)**\n\nHand-crafted finalization of the fix",
    "created_at": "2013-05-21T19:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142483",
    "user": "https://github.com/SnarkBoojum"
}
```

Attachment: **[trac_12728_5.10.beta4_hand.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)**

Hand-crafted finalization of the fix



---

archive/issue_comments_142484.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,10 @@\n+\"\"Problem\"\"\n+\n There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).\n \n+\"\"Solution\"\"\n Those should be removed, and the right path added to the include line.\n \n-Apply [attachment: trac_12728_5.10.beta3.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz) and [attachment: trac_12728_5.10.beta3-hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3-hand.patch.gz)\n+Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)\n \n (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)\n-\n-(The first patch was reviewed by Volker, the second by Jeroen)\n``````\n",
    "created_at": "2013-05-21T19:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142484",
    "user": "https://github.com/SnarkBoojum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,10 @@
+""Problem""
+
 There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).
 
+""Solution""
 Those should be removed, and the right path added to the include line.
 
-Apply [attachment: trac_12728_5.10.beta3.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3.patch.gz) and [attachment: trac_12728_5.10.beta3-hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta3-hand.patch.gz)
+Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)
 
 (The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)
-
-(The first patch was reviewed by Volker, the second by Jeroen)
``````




---

archive/issue_events_173506.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2013-05-21T19:39:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173506"
}
```



---

archive/issue_events_173507.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2013-05-21T19:39:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173507"
}
```



---

archive/issue_comments_142485.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n-\"\"Problem\"\"\n+**Problem**\n \n There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).\n \n-\"\"Solution\"\"\n+**Solution**\n Those should be removed, and the right path added to the include line.\n \n Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)\n``````\n",
    "created_at": "2013-05-21T19:40:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142485",
    "user": "https://github.com/SnarkBoojum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
-""Problem""
+**Problem**
 
 There are many places in sage's spkg sources where inclusions are made with a filename which looks like ../../../../../whatever (no exageration: up to *five* levels!).
 
-""Solution""
+**Solution**
 Those should be removed, and the right path added to the include line.
 
 Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)
``````




---

archive/issue_comments_142486.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nLooks good. \n\nJeroen, can we merge this in beta5?",
    "created_at": "2013-05-22T10:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142486",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:37" align="right">comment:37</div>

Looks good. 

Jeroen, can we merge this in beta5?



---

archive/issue_events_173508.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-22T10:47:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173508"
}
```



---

archive/issue_events_173509.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-22T10:47:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173509"
}
```



---

archive/issue_comments_142487.json:
```json
{
    "body": "Changed work issues from **rebase** to none",
    "created_at": "2013-05-22T13:38:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142487",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **rebase** to none



---

archive/issue_events_173510.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-23T08:53:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173510"
}
```



---

archive/issue_events_173511.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-23T08:53:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173511"
}
```



---

archive/issue_comments_142488.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThis causes problems with the HTML documentation:\n\n```\ndochtml.log:[rings_sta] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/rings_standard/sage/rings/integer.rst:11: WARNING: error while formatting signature for sage.rings.integer.parent: 'NoneType' object has no attribute 'find'\ndochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.OP_represent: 'NoneType' object has no attribute 'find'\ndochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.PS_represent: 'NoneType' object has no attribute 'find'\ndochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.SC_test_list_perms: 'NoneType' object has no attribute 'find'\n```",
    "created_at": "2013-05-23T08:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142488",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

This causes problems with the HTML documentation:

```
dochtml.log:[rings_sta] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/rings_standard/sage/rings/integer.rst:11: WARNING: error while formatting signature for sage.rings.integer.parent: 'NoneType' object has no attribute 'find'
dochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.OP_represent: 'NoneType' object has no attribute 'find'
dochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.PS_represent: 'NoneType' object has no attribute 'find'
dochtml.log:[structure] /mazur/release/merger/sage-5.10.beta5/devel/sage/doc/en/reference/structure/sage/sets/disjoint_set.rst:11: WARNING: error while formatting signature for sage.sets.disjoint_set.SC_test_list_perms: 'NoneType' object has no attribute 'find'
```



---

archive/issue_comments_142489.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nYour error message doesn't look at all like it's related to my changes (no error looking like \"File not found\"), but I'll investigate...",
    "created_at": "2013-05-23T09:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142489",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:40" align="right">comment:40</div>

Your error message doesn't look at all like it's related to my changes (no error looking like "File not found"), but I'll investigate...



---

archive/issue_comments_142490.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThis is what broke:\n\n```\nsage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-1-b9940f7f2356> in <module>()\n----> 1 sage_getargspec(sage.sets.disjoint_set.OP_represent)\n\nNameError: name 'sage_getargspec' is not defined\nsage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-2-ee04891bf854> in <module>()\n----> 1 sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)\n\n/home/vbraun/opt/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/misc/sageinspect.pyc in sage_getargspec(obj)\n   1332         except TypeError: # arg is not a code object\n   1333         # The above \"hopefully\" was wishful thinking:\n-> 1334             return inspect.ArgSpec(*_sage_getargspec_cython(sage_getsource(obj)))\n   1335             #return _sage_getargspec_from_ast(sage_getsource(obj))\n   1336     try:\n\n/home/vbraun/opt/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/misc/sageinspect.pyc in _sage_getargspec_cython(source)\n    984 \n    985     \"\"\"\n--> 986     defpos = source.find('def ')\n    987     assert defpos > -1, \"The given source does not contain 'def'\"\n    988     s = source[defpos:].strip()\n\nAttributeError: 'NoneType' object has no attribute 'find'\n```\nused to be \n\n```\nsage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)\nArgSpec(args=['n', 'merges', 'perm'], varargs=None, keywords=None, defaults=None)\n```",
    "created_at": "2013-05-23T10:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142490",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:41" align="right">comment:41</div>

This is what broke:

```
sage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-1-b9940f7f2356> in <module>()
----> 1 sage_getargspec(sage.sets.disjoint_set.OP_represent)

NameError: name 'sage_getargspec' is not defined
sage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-2-ee04891bf854> in <module>()
----> 1 sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)

/home/vbraun/opt/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/misc/sageinspect.pyc in sage_getargspec(obj)
   1332         except TypeError: # arg is not a code object
   1333         # The above "hopefully" was wishful thinking:
-> 1334             return inspect.ArgSpec(*_sage_getargspec_cython(sage_getsource(obj)))
   1335             #return _sage_getargspec_from_ast(sage_getsource(obj))
   1336     try:

/home/vbraun/opt/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/misc/sageinspect.pyc in _sage_getargspec_cython(source)
    984 
    985     """
--> 986     defpos = source.find('def ')
    987     assert defpos > -1, "The given source does not contain 'def'"
    988     s = source[defpos:].strip()

AttributeError: 'NoneType' object has no attribute 'find'
```
used to be 

```
sage: sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent)
ArgSpec(args=['n', 'merges', 'perm'], varargs=None, keywords=None, defaults=None)
```



---

archive/issue_comments_142491.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\n@vbraun: thanks ; it still doesn't look like a missing file, but at least it's a place I can start digging.\n\nMy plan was the following :\n1. freshly unpack a sage-5.10.beta4 tarball ;\n2. make build\n3. apply the patches\n4. ./sage -ba-force\n5. make doc-html\n\nnow step 5 is to start from this sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent).",
    "created_at": "2013-05-23T10:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142491",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:42" align="right">comment:42</div>

@vbraun: thanks ; it still doesn't look like a missing file, but at least it's a place I can start digging.

My plan was the following :
1. freshly unpack a sage-5.10.beta4 tarball ;
2. make build
3. apply the patches
4. ./sage -ba-force
5. make doc-html

now step 5 is to start from this sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent).



---

archive/issue_comments_142492.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nOk, I determined that sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent) gets interpreted in sageinspect.py like this:\n1. is it an abstract method, line 1284? No.\n2. is it callable, line 1287? Yes.\n3. try to read the argspec, line 1290 - AttributeError line 1291, pass (line 1292)!\n4. is it a function, line 1293? No.\n5. is it a method, line 1295? No.\n6. is it a class instance, line 1297? No.\n7. is it a class, line 1311? No.\n8. does it have some attributes, line 1314? No.\n9. fallback to the 'else' of line 1318!\n10. let's call sage_getsource, line 1320, and get None.\n21. line 1321-1324: since we got None, we set func_obj=obj.\n32. try something line 1328 and fail with AttributeError\n43. catch this exception and try something else line 1331 and fail with TypeError\n54. catch this exception line 1332\n65. let's do (no try this time): \"return inspect.ArgSpec(*_sage_getargspec_cython(sage_getsource(obj)))\", because obviously, the fact that a few lines above sage_getsource got us None already won't be a problem! BOOM!\n\nI interpret those findings as meaning that something with my patches has made sage_getsource(obj) return None, and this then uncovered a nice bug in sageinspect. Does this sound sensible? Should I then file a bug against sageinspect.py? [Of course, I'll now investigate why None gets returned]",
    "created_at": "2013-05-23T12:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142492",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:43" align="right">comment:43</div>

Ok, I determined that sage.misc.sageinspect.sage_getargspec(sage.sets.disjoint_set.OP_represent) gets interpreted in sageinspect.py like this:
1. is it an abstract method, line 1284? No.
2. is it callable, line 1287? Yes.
3. try to read the argspec, line 1290 - AttributeError line 1291, pass (line 1292)!
4. is it a function, line 1293? No.
5. is it a method, line 1295? No.
6. is it a class instance, line 1297? No.
7. is it a class, line 1311? No.
8. does it have some attributes, line 1314? No.
9. fallback to the 'else' of line 1318!
10. let's call sage_getsource, line 1320, and get None.
21. line 1321-1324: since we got None, we set func_obj=obj.
32. try something line 1328 and fail with AttributeError
43. catch this exception and try something else line 1331 and fail with TypeError
54. catch this exception line 1332
65. let's do (no try this time): "return inspect.ArgSpec(*_sage_getargspec_cython(sage_getsource(obj)))", because obviously, the fact that a few lines above sage_getsource got us None already won't be a problem! BOOM!

I interpret those findings as meaning that something with my patches has made sage_getsource(obj) return None, and this then uncovered a nice bug in sageinspect. Does this sound sensible? Should I then file a bug against sageinspect.py? [Of course, I'll now investigate why None gets returned]



---

archive/issue_comments_142493.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nOh, I forgot to make explicit the remark that sage_getsource returning None could be related to a \"File not found\" problem -- so now it makes sense that the problem can be related to my patches. Something which wasn't that clear. So now I'm looking for a problem, and I believe in it :-P",
    "created_at": "2013-05-23T12:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142493",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:44" align="right">comment:44</div>

Oh, I forgot to make explicit the remark that sage_getsource returning None could be related to a "File not found" problem -- so now it makes sense that the problem can be related to my patches. Something which wasn't that clear. So now I'm looking for a problem, and I believe in it :-P



---

archive/issue_comments_142494.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI now determined how sage_getsource(sage.sets.disjoint_set.OP_represent) gets interpreted in sageinspect.py:\n1. try to use the `_sage_src_` method and raise an AttributeError, line 1552 (gets pass-ed)\n2. try to use sage_getsourcelines, line 1556 and get None\n3. after a test of the previous value, return None, line 1558\n\nThe problems turns into: why does sage_getsourcelines(sage.sets.disjoint_set.OP_represent) return None? Let's follow the trail again:\n1. try to use the `_sage_src_lines_` method and raise an AttributeError line 1783 (gets pass-ed)\n2. is it a class instance, line 1791? No.\n3. get a nice-looking doctring line 1802, except that the filename reads 'res_pyx.pxi'\n4. try to use _extract_embedded_position on it... get to line 200... where the filename gets obtained by os.path.join(SAGE_SRC, res.group('FILENAME'))\n5. from there, the rest is history: we have a wrong filename in a wrong path, so it's no surprise things get messy. \n\n\nSo now I see two problems there: first, the only file with a name looking like this is sage/groups/perm_gps/partn_ref/data_structures_pyx.pxi, and second, the way the full path is obtained from the filename looks too naive.\n\nHow can I debug the first problem?",
    "created_at": "2013-05-23T12:50:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142494",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:45" align="right">comment:45</div>

I now determined how sage_getsource(sage.sets.disjoint_set.OP_represent) gets interpreted in sageinspect.py:
1. try to use the `_sage_src_` method and raise an AttributeError, line 1552 (gets pass-ed)
2. try to use sage_getsourcelines, line 1556 and get None
3. after a test of the previous value, return None, line 1558

The problems turns into: why does sage_getsourcelines(sage.sets.disjoint_set.OP_represent) return None? Let's follow the trail again:
1. try to use the `_sage_src_lines_` method and raise an AttributeError line 1783 (gets pass-ed)
2. is it a class instance, line 1791? No.
3. get a nice-looking doctring line 1802, except that the filename reads 'res_pyx.pxi'
4. try to use _extract_embedded_position on it... get to line 200... where the filename gets obtained by os.path.join(SAGE_SRC, res.group('FILENAME'))
5. from there, the rest is history: we have a wrong filename in a wrong path, so it's no surprise things get messy. 


So now I see two problems there: first, the only file with a name looking like this is sage/groups/perm_gps/partn_ref/data_structures_pyx.pxi, and second, the way the full path is obtained from the filename looks too naive.

How can I debug the first problem?



---

archive/issue_comments_142495.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\n\"sage.sets.disjoint_set.OP_represent\" is defined in sage/groups/perm_gps/partn_ref/data_structures_pyx.pxi, and indeed at line 125 as I see in the docstring.\nThe line number is correct ; only the filename looks like it has been eaten.",
    "created_at": "2013-05-23T13:09:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142495",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:46" align="right">comment:46</div>

"sage.sets.disjoint_set.OP_represent" is defined in sage/groups/perm_gps/partn_ref/data_structures_pyx.pxi, and indeed at line 125 as I see in the docstring.
The line number is correct ; only the filename looks like it has been eaten.



---

archive/issue_comments_142496.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nOn the non-patched sage-5.10.beta5 the filename is \"sage/sets/../groups/perm_gps/partn_ref/data_structures_pyx.pxi\".",
    "created_at": "2013-05-23T13:11:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142496",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:47" align="right">comment:47</div>

On the non-patched sage-5.10.beta5 the filename is "sage/sets/../groups/perm_gps/partn_ref/data_structures_pyx.pxi".



---

archive/issue_comments_142497.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThe filename is already wrong in the Cythonized `disjoint_set.c`:\n\n```\nstatic char __pyx_doc_4sage_4sets_12disjoint_set_OP_represent[] = \"File: pyx.pxi (starting at line 125)\\n\\n    Demonstration and testing.\\n    \\n    TESTS::\\n\\n        [...]        Done.\\n\\n    \";\n```\nSo there is nothing in this ticket that is responsible for it.",
    "created_at": "2013-05-23T14:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142497",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

The filename is already wrong in the Cythonized `disjoint_set.c`:

```
static char __pyx_doc_4sage_4sets_12disjoint_set_OP_represent[] = "File: pyx.pxi (starting at line 125)\n\n    Demonstration and testing.\n    \n    TESTS::\n\n        [...]        Done.\n\n    ";
```
So there is nothing in this ticket that is responsible for it.



---

archive/issue_comments_142498.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThe bug is in Cython `Nodes.relative_position`, which assumes that you can make the path relative by stripping off `len(os.path.abspath(os.getcwd()))` characters. Thats of course totally wrong when the file was discovered through a search path.",
    "created_at": "2013-05-23T15:06:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142498",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:49" align="right">comment:49</div>

The bug is in Cython `Nodes.relative_position`, which assumes that you can make the path relative by stripping off `len(os.path.abspath(os.getcwd()))` characters. Thats of course totally wrong when the file was discovered through a search path.



---

archive/issue_comments_142499.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nSee #14634 for the Cython bug",
    "created_at": "2013-05-23T15:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142499",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">comment:50</div>

See #14634 for the Cython bug



---

archive/issue_events_173512.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-23T15:11:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173512"
}
```



---

archive/issue_events_173513.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-23T15:11:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173513"
}
```



---

archive/issue_events_173514.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-23T15:59:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173514"
}
```



---

archive/issue_events_173515.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-23T15:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173515"
}
```



---

archive/issue_comments_142500.json:
```json
{
    "body": "Dependencies: **#14634**",
    "created_at": "2013-05-23T15:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142500",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#14634**



---

archive/issue_comments_142501.json:
```json
{
    "body": "Initial patch",
    "created_at": "2013-05-23T17:48:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142501",
    "user": "https://github.com/vbraun"
}
```

Initial patch



---

archive/issue_events_173516.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-23T17:50:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173516"
}
```



---

archive/issue_events_173517.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-23T17:50:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173517"
}
```



---

archive/issue_comments_142502.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nAttachment: **[trac_12728_docbuild_workaround.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)**\n\nI suggest we just revert the two includes that trigger the Cython bug.",
    "created_at": "2013-05-23T17:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142502",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">comment:52</div>

Attachment: **[trac_12728_docbuild_workaround.patch.gz](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)**

I suggest we just revert the two includes that trigger the Cython bug.



---

archive/issue_comments_142503.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,10 @@\n **Solution**\n Those should be removed, and the right path added to the include line.\n \n-Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)\n \n-(The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)\n+The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.\n+\n+Apply \n+* [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)\n+* [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)\n+* [attachment: trac_12728_docbuild_workaround.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)\n``````\n",
    "created_at": "2013-05-23T17:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142503",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,10 @@
 **Solution**
 Those should be removed, and the right path added to the include line.
 
-Apply [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz) and [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)
 
-(The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.)
+The first patch was obtained by running the attached script and the second one by hand-editing the remaining occurrences.
+
+Apply 
+* [attachment: trac_12728_5.10.beta4_auto.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_auto.patch.gz)
+* [attachment: trac_12728_5.10.beta4_hand.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_5.10.beta4_hand.patch.gz)
+* [attachment: trac_12728_docbuild_workaround.patch](https://github.com/sagemath/sage/files/ticket12728/trac_12728_docbuild_workaround.patch.gz)
``````




---

archive/issue_comments_142504.json:
```json
{
    "body": "Changed dependencies from **#14634** to none",
    "created_at": "2013-05-23T17:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142504",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#14634** to none



---

archive/issue_comments_142505.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI'm happy with your solution. I rebuilt sagelib adding your patch to my two patches, then built the doc from there : perfect. Positive review!",
    "created_at": "2013-05-23T19:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142505",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:53" align="right">comment:53</div>

I'm happy with your solution. I rebuilt sagelib adding your patch to my two patches, then built the doc from there : perfect. Positive review!



---

archive/issue_comments_142506.json:
```json
{
    "body": "Changed reviewer from **Volker Braun, Jeroen Demeyer** to **Volker Braun, Jeroen Demeyer, Julien Puydt**",
    "created_at": "2013-05-23T19:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142506",
    "user": "https://github.com/SnarkBoojum"
}
```

Changed reviewer from **Volker Braun, Jeroen Demeyer** to **Volker Braun, Jeroen Demeyer, Julien Puydt**



---

archive/issue_events_173518.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-24T09:39:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173518"
}
```



---

archive/issue_events_173519.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-24T09:39:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12728#event-173519"
}
```



---

archive/issue_comments_142507.json:
```json
{
    "body": "Merged: **sage-5.10.beta5**",
    "created_at": "2013-05-24T09:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12728",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12728#issuecomment-142507",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.10.beta5**
