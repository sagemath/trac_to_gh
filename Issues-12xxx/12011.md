# Issue 12011: cvxopt: fix illegal BLAS call and fix Solaris build

archive/issues_011839.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nOn OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.\n\nCVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.\n\nThis spkg also fixes an issue building with GCC on Solaris 10.  There already was a fix for this in the spkg, but it was only enabled for GCC versions < 4.5 (without any mention of why).  Enable this fix for all GCC versions.\n\n---\n\nNew spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)\n\n\nDepends on #12519\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nCC:  @dimpase @vbraun\n\nComponent: **packages: standard**\n\nKeywords: **Lion Darwin cvxopt atlas blas Solaris**\n\nAuthor: **Jeroen Demeyer, John Palmieri**\n\nReviewer: **Jeroen Demeyer, John Palmieri**\n\nMerged: **sage-5.0.beta13**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12011_\n\n",
    "closed_at": "2012-04-04T19:27:35Z",
    "created_at": "2011-11-11T06:40:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20solaris"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "cvxopt: fix illegal BLAS call and fix Solaris build",
    "type": "issue",
    "updated_at": "2012-04-04T19:27:35Z",
    "url": "https://github.com/sagemath/sage/issues/12011",
    "user": "https://github.com/jhpalmieri"
}
```
<div id="comment:0"></div>

On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.

CVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.

This spkg also fixes an issue building with GCC on Solaris 10.  There already was a fix for this in the spkg, but it was only enabled for GCC versions < 4.5 (without any mention of why).  Enable this fix for all GCC versions.

---

New spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)


Depends on #12519

Upstream: **Fixed upstream, in a later stable release.**

CC:  @dimpase @vbraun

Component: **packages: standard**

Keywords: **Lion Darwin cvxopt atlas blas Solaris**

Author: **Jeroen Demeyer, John Palmieri**

Reviewer: **Jeroen Demeyer, John Palmieri**

Merged: **sage-5.0.beta13**

_Issue created by migration from https://trac.sagemath.org/ticket/12011_





---

archive/issue_events_160935.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-11-11T06:40:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160935"
}
```



---

archive/issue_events_160936.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-11-11T06:40:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160936"
}
```



---

archive/issue_events_160937.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-11-11T06:40:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160937"
}
```



---

archive/issue_events_160938.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-11-11T06:40:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160938"
}
```



---

archive/issue_events_160939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-02T13:12:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160939"
}
```



---

archive/issue_events_160940.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-02T13:12:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160940"
}
```



---

archive/issue_comments_127533.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIn a related matter, we should patch spkg-check to exit with a nonzero return value if tests fail.  We can either exit immediately once there's a failure, or we can run all tests and then exit.  I'm not sure which of these is better.  In general I would suggest the latter, but since it's actually hanging on OS X Lion (after at least one failed test), I might lean toward the former...\n\nAlso, should we upgrade to version 1.1.4?",
    "created_at": "2012-02-01T06:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127533",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

In a related matter, we should patch spkg-check to exit with a nonzero return value if tests fail.  We can either exit immediately once there's a failure, or we can run all tests and then exit.  I'm not sure which of these is better.  In general I would suggest the latter, but since it's actually hanging on OS X Lion (after at least one failed test), I might lean toward the former...

Also, should we upgrade to version 1.1.4?



---

archive/issue_comments_127534.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSee #12519 for a new cvxopt spkg.  I fixed `spkg-check` such that it now actually exists when there is a failure.  However, it still fails on OS X Lion.",
    "created_at": "2012-02-16T11:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127534",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

See #12519 for a new cvxopt spkg.  I fixed `spkg-check` such that it now actually exists when there is a failure.  However, it still fails on OS X Lion.



---

archive/issue_comments_127535.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nDima: any ideas about the self-test failures?",
    "created_at": "2012-02-20T04:36:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127535",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

Dima: any ideas about the self-test failures?



---

archive/issue_comments_127536.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@jhpalmieri](#comment%3A4):\n> Dima: any ideas about the self-test failures?\n\nI just asked  upstream [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/PekNsa2yP-IJ).\nIs there a way to get access to 10.7 for me?\n\nDima",
    "created_at": "2012-02-20T10:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127536",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@jhpalmieri](#comment%3A4):
> Dima: any ideas about the self-test failures?

I just asked  upstream [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/PekNsa2yP-IJ).
Is there a way to get access to 10.7 for me?

Dima



---

archive/issue_comments_127537.json:
```json
{
    "body": "Upstream: **Reported upstream. Little or no feedback.**",
    "created_at": "2012-02-20T10:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127537",
    "user": "https://github.com/dimpase"
}
```

Upstream: **Reported upstream. Little or no feedback.**



---

archive/issue_events_160941.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-02-20T12:42:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160941"
}
```



---

archive/issue_comments_127538.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@dimpase](#comment%3A5):\n> Replying to [@jhpalmieri](#comment%3A4):\n> > Dima: any ideas about the self-test failures?\n> \n> \n> I just asked  upstream [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/PekNsa2yP-IJ).\n> Is there a way to get access to 10.7 for me?\n> \n> Dima\n\n[here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.\n\nIt would be great if you tested this with the newest Xcode...",
    "created_at": "2012-02-20T12:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127538",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@dimpase](#comment%3A5):
> Replying to [@jhpalmieri](#comment%3A4):
> > Dima: any ideas about the self-test failures?
> 
> 
> I just asked  upstream [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/PekNsa2yP-IJ).
> Is there a way to get access to 10.7 for me?
> 
> Dima

[here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.

It would be great if you tested this with the newest Xcode...



---

archive/issue_comments_127539.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@dimpase](#comment%3A6):\n> [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.\n\nDo you mean Apple's ATLAS? We don't build ATLAS on Mac OS X, we just use the system's libraries.  What should I do to try this out? Can I just make some changes in the spkg-install script?\n \n> It would be great if you tested this with the newest Xcode...\n\nI've tried this with various versions of Xcode, including the newly released 4.3, and I get failures in all of them.",
    "created_at": "2012-02-20T23:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127539",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@dimpase](#comment%3A6):
> [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.

Do you mean Apple's ATLAS? We don't build ATLAS on Mac OS X, we just use the system's libraries.  What should I do to try this out? Can I just make some changes in the spkg-install script?
 
> It would be great if you tested this with the newest Xcode...

I've tried this with various versions of Xcode, including the newly released 4.3, and I get failures in all of them.



---

archive/issue_comments_127540.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBy the way, it might make sense to base further discussion on the new cvxopt package at #12519.",
    "created_at": "2012-02-20T23:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127540",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">comment:8</div>

By the way, it might make sense to base further discussion on the new cvxopt package at #12519.



---

archive/issue_comments_127541.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jhpalmieri](#comment%3A7):\n> Replying to [@dimpase](#comment%3A6):\n> > [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.\n> \n> \n> Do you mean Apple's ATLAS? We don't build ATLAS on Mac OS X, we just use the system's libraries.  What should I do to try this out? Can I just make some changes in the spkg-install script?\n\nWell, no. We need to build ATLAS spkg (or get some other non-Apple lapack/blas somehow) and use it.\nActually, if I recall right, this (native lapack/blas) is an artefact of the PPC support. We can perfectly well use Atlas\non x86, right?\n\n\n>  \n> > It would be great if you tested this with the newest Xcode...\n> \n> \n> I've tried this with various versions of Xcode, including the newly released 4.3, and I get failures in all of them.",
    "created_at": "2012-02-21T03:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127541",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jhpalmieri](#comment%3A7):
> Replying to [@dimpase](#comment%3A6):
> > [here](https://groups.google.com/d/msg/cvxopt/cTZo0LYDo0c/T2gs1V7gyygJ) it is written that it's probably a bug in Apple's blas/lapack. A workaround is to use Atlas. I have no way to check this at the moment, but it looks very reasonable to me.
> 
> 
> Do you mean Apple's ATLAS? We don't build ATLAS on Mac OS X, we just use the system's libraries.  What should I do to try this out? Can I just make some changes in the spkg-install script?

Well, no. We need to build ATLAS spkg (or get some other non-Apple lapack/blas somehow) and use it.
Actually, if I recall right, this (native lapack/blas) is an artefact of the PPC support. We can perfectly well use Atlas
on x86, right?


>  
> > It would be great if you tested this with the newest Xcode...
> 
> 
> I've tried this with various versions of Xcode, including the newly released 4.3, and I get failures in all of them.



---

archive/issue_events_160942.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-06T10:46:26Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "title_is": "Build ATLAS on OS X Lion",
    "title_was": "OS X Lion: cvxopt fails self tests",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160942"
}
```



---

archive/issue_comments_127542.json:
```json
{
    "body": "Changed keywords from **Lion Darwin cvxopt** to **Lion Darwin cvxopt atlas blas**",
    "created_at": "2012-03-06T10:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127542",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **Lion Darwin cvxopt** to **Lion Darwin cvxopt atlas blas**



---

archive/issue_comments_127543.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,3 @@\n-On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See\n+On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.\n \n- [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log)\n-\n-for the install log.\n-\n+The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.\n``````\n",
    "created_at": "2012-03-06T10:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127543",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,3 @@
-On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See
+On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.
 
- [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log)
-
-for the install log.
-
+The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.
``````




---

archive/issue_comments_127544.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.\n \n The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.\n+\n+**spkg** (untested!): [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg)\n``````\n",
    "created_at": "2012-03-06T11:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127544",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.
 
 The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.
+
+**spkg** (untested!): [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg)
``````




---

archive/issue_comments_127545.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\ndoesnt work on OSX10.6:\n\n```\nCalling sage-spkg on 'http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg'\natlas-3.8.4.p2\nMachine:\nDarwin nash 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386\nDeleting directories from past builds of previous/current versions of atlas-3.8.4.p2\n/usr/local/src/sage/sage-4.8.alpha4/local/bin/sage-spkg: file atlas-3.8.4.p2 does not exist\nAttempting to download it.\nhttp://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg --> atlas-3.8.4.p2.spkg\n[..................................................]\nExtracting package /usr/local/src/sage/sage-4.8.alpha4/spkg/optional/atlas-3.8.4.p2.spkg ...\n-rw-r--r--  1 dima  staff  2866339 Mar  6 19:27 /usr/local/src/sage/sage-4.8.alpha4/spkg/optional/atlas-3.8.4.p2.spkg\nFinished extraction\n****************************************************\nHost system\nuname -a:\nDarwin nash 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: i686-apple-darwin10\nConfigured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Apple Inc. build 5666) (dot 3)\n****************************************************\nTraceback (most recent call last):\n  File \"./spkg-install\", line 13, in <module>\n    from configuration import conf, cp, try_run, edit_in_place\n  File \"/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2/configuration.py\", line 108, in <module>\n    conf['release'] = subprocess.check_output(['uname', '-r'])\nAttributeError: 'module' object has no attribute 'check_output'\n\nreal\t0m0.092s\nuser\t0m0.038s\nsys\t0m0.044s\n************************************************************************\nError installing package atlas-3.8.4.p2\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the relevant part of the log file\n  /usr/local/src/sage/sage-4.8.alpha4/spkg/logs/atlas-3.8.4.p2.log\nDescribe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2 and type 'make' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n  (cd '/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2' && '/usr/local/src/sage/sage-4.8.alpha4/sage' -sh)\nWhen you are done debugging, you can type \"exit\" to leave the subshell.\n************************************************************************\nError: Failed to install package 'atlas-3.8.4.p2'.\nnash:sage-5.0.beta6 dima$ \n\n```",
    "created_at": "2012-03-06T11:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127545",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

doesnt work on OSX10.6:

```
Calling sage-spkg on 'http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg'
atlas-3.8.4.p2
Machine:
Darwin nash 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386
Deleting directories from past builds of previous/current versions of atlas-3.8.4.p2
/usr/local/src/sage/sage-4.8.alpha4/local/bin/sage-spkg: file atlas-3.8.4.p2 does not exist
Attempting to download it.
http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg --> atlas-3.8.4.p2.spkg
[..................................................]
Extracting package /usr/local/src/sage/sage-4.8.alpha4/spkg/optional/atlas-3.8.4.p2.spkg ...
-rw-r--r--  1 dima  staff  2866339 Mar  6 19:27 /usr/local/src/sage/sage-4.8.alpha4/spkg/optional/atlas-3.8.4.p2.spkg
Finished extraction
****************************************************
Host system
uname -a:
Darwin nash 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: i686-apple-darwin10
Configured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Apple Inc. build 5666) (dot 3)
****************************************************
Traceback (most recent call last):
  File "./spkg-install", line 13, in <module>
    from configuration import conf, cp, try_run, edit_in_place
  File "/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2/configuration.py", line 108, in <module>
    conf['release'] = subprocess.check_output(['uname', '-r'])
AttributeError: 'module' object has no attribute 'check_output'

real	0m0.092s
user	0m0.038s
sys	0m0.044s
************************************************************************
Error installing package atlas-3.8.4.p2
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the relevant part of the log file
  /usr/local/src/sage/sage-4.8.alpha4/spkg/logs/atlas-3.8.4.p2.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/usr/local/src/sage/sage-4.8.alpha4/spkg/build/atlas-3.8.4.p2' && '/usr/local/src/sage/sage-4.8.alpha4/sage' -sh)
When you are done debugging, you can type "exit" to leave the subshell.
************************************************************************
Error: Failed to install package 'atlas-3.8.4.p2'.
nash:sage-5.0.beta6 dima$ 

```



---

archive/issue_comments_127546.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYou're using a too old version of Sage.",
    "created_at": "2012-03-06T11:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127546",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

You're using a too old version of Sage.



---

archive/issue_comments_127547.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A13):\n> You're using a too old version of Sage.\n\n/me bangs head on the kbd...",
    "created_at": "2012-03-06T11:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127547",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A13):
> You're using a too old version of Sage.

/me bangs head on the kbd...



---

archive/issue_comments_127548.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nDoes this *only* build ATLAS in Lion, or all Mac?  Seems silly to do it from scratch on others, maybe we can check Dima's program mentioned at #12519 on older versions...",
    "created_at": "2012-03-06T14:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127548",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:15" align="right">comment:15</div>

Does this *only* build ATLAS in Lion, or all Mac?  Seems silly to do it from scratch on others, maybe we can check Dima's program mentioned at #12519 on older versions...



---

archive/issue_comments_127549.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kcrisman](#comment%3A15):\n> Does this *only* build ATLAS in Lion, or all Mac?\n\nOnly on Lion.",
    "created_at": "2012-03-06T14:46:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127549",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kcrisman](#comment%3A15):
> Does this *only* build ATLAS in Lion, or all Mac?

Only on Lion.



---

archive/issue_comments_127550.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAfter more than 3 hours, it finally managed to **fail** to build on `sqrt5`:\n\n```\nATLAS install complete.  Examine\nATLAS/bin/<arch>/INSTALL_LOG/SUMMARY.LOG for details.\nmake -j1 clean\nrm -f *.o x* config?.out *core*\nrm: xarchinfo_freebsd.dSYM: is a directory\nrm: xarchinfo_x86.dSYM: is a directory\nrm: xconfig.dSYM: is a directory\nrm: xprobe_gas_x8632.dSYM: is a directory\nrm: xprobe_gas_x8664.dSYM: is a directory\nrm: xspew.dSYM: is a directory\nmake[1]: *** [clean] Error 1\nmake: *** [build] Error 2\nATLAS failed to build, possibly because of a loaded system.\nTraceback (most recent call last):\n  File \"./spkg-install\", line 473, in <module>\n    assert rc==0, 'Failed to build ATLAS.'\nAssertionError: Failed to build ATLAS.\n\nreal    202m1.081s\nuser    182m33.861s\nsys     10m48.195s\n```\n\nWeird that it reported that the build succeeded, but still it failed somehow.",
    "created_at": "2012-03-06T16:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127550",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

After more than 3 hours, it finally managed to **fail** to build on `sqrt5`:

```
ATLAS install complete.  Examine
ATLAS/bin/<arch>/INSTALL_LOG/SUMMARY.LOG for details.
make -j1 clean
rm -f *.o x* config?.out *core*
rm: xarchinfo_freebsd.dSYM: is a directory
rm: xarchinfo_x86.dSYM: is a directory
rm: xconfig.dSYM: is a directory
rm: xprobe_gas_x8632.dSYM: is a directory
rm: xprobe_gas_x8664.dSYM: is a directory
rm: xspew.dSYM: is a directory
make[1]: *** [clean] Error 1
make: *** [build] Error 2
ATLAS failed to build, possibly because of a loaded system.
Traceback (most recent call last):
  File "./spkg-install", line 473, in <module>
    assert rc==0, 'Failed to build ATLAS.'
AssertionError: Failed to build ATLAS.

real    202m1.081s
user    182m33.861s
sys     10m48.195s
```

Weird that it reported that the build succeeded, but still it failed somehow.



---

archive/issue_comments_127551.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplace a \"rm -f\" by \"rm -rf\" probably will solve this problem.\n\nThis explain the dSYM directories: [http://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos](http://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos)",
    "created_at": "2012-03-06T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127551",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replace a "rm -f" by "rm -rf" probably will solve this problem.

This explain the dSYM directories: [http://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos](http://stackoverflow.com/questions/584825/dsym-directories-while-compiling-c-code-in-macos)



---

archive/issue_comments_127552.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nAah, you beat me by five seconds!   I concur.",
    "created_at": "2012-03-06T16:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127552",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:19" align="right">comment:19</div>

Aah, you beat me by five seconds!   I concur.



---

archive/issue_comments_127553.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI put up a new version hopefully fixing this, currently building on `sqrt5`...",
    "created_at": "2012-03-06T16:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127553",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

I put up a new version hopefully fixing this, currently building on `sqrt5`...



---

archive/issue_comments_127554.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n:-(\n\n```\nATLAS install complete.  Examine\nATLAS/bin/<arch>/INSTALL_LOG/SUMMARY.LOG for details.\nmake -j1 clean\n# Xcode (OS X) may create directories like xspew.dSYM.\n# Add -r option to delete also these.\nrm -rf *.o x* config?.out *core*\nFinished building ATLAS core.\nFinished building ATLAS core.\nRunning make -j1 shared cshared\nrm -f libatlas.so liblapack.so\nmake -j1 libatlas.so liblapack.so libf77blas.so libcblas.so liblapack.so\nld -melf_x86_64 -shared -soname libatlas.so -o libatlas.so \\\n        --whole-archive libatlas.a --no-whole-archive -lc -lpthread -lm\nld: unknown option: -melf_x86_64\nmake[1]: *** [libatlas.so] Error 1\nmake: *** [shared] Error 2\nTraceback (most recent call last):\n  File \"./spkg-install\", line 480, in <module>\n    assert rc==0, 'Building shared ATLAS library failed.'\nAssertionError: Building shared ATLAS library failed.\n```",
    "created_at": "2012-03-06T17:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127554",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

:-(

```
ATLAS install complete.  Examine
ATLAS/bin/<arch>/INSTALL_LOG/SUMMARY.LOG for details.
make -j1 clean
# Xcode (OS X) may create directories like xspew.dSYM.
# Add -r option to delete also these.
rm -rf *.o x* config?.out *core*
Finished building ATLAS core.
Finished building ATLAS core.
Running make -j1 shared cshared
rm -f libatlas.so liblapack.so
make -j1 libatlas.so liblapack.so libf77blas.so libcblas.so liblapack.so
ld -melf_x86_64 -shared -soname libatlas.so -o libatlas.so \
        --whole-archive libatlas.a --no-whole-archive -lc -lpthread -lm
ld: unknown option: -melf_x86_64
make[1]: *** [libatlas.so] Error 1
make: *** [shared] Error 2
Traceback (most recent call last):
  File "./spkg-install", line 480, in <module>
    assert rc==0, 'Building shared ATLAS library failed.'
AssertionError: Building shared ATLAS library failed.
```



---

archive/issue_comments_127555.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWe need to totally rewrite the command line\n\n```\nld -melf_x86_64 -shared -soname libatlas.so -o libatlas.so \\\n        --whole-archive libatlas.a --no-whole-archive -lc -lpthread -lm\n```\n\nI unfortunately don't know enough about Apple's linker to know what to do here...",
    "created_at": "2012-03-06T20:20:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127555",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

We need to totally rewrite the command line

```
ld -melf_x86_64 -shared -soname libatlas.so -o libatlas.so \
        --whole-archive libatlas.a --no-whole-archive -lc -lpthread -lm
```

I unfortunately don't know enough about Apple's linker to know what to do here...



---

archive/issue_comments_127556.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2012-03-06T20:20:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127556",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_events_160943.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-06T20:20:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160943"
}
```



---

archive/issue_events_160944.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-06T20:20:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160944"
}
```



---

archive/issue_events_160945.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-06T20:20:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160945"
}
```



---

archive/issue_events_160946.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-06T20:20:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160946"
}
```



---

archive/issue_comments_127557.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAccording to Clint Whaley, only ATLAS 3.9+ supports building a shared library on OSX:\n\nhttp://sourceforge.net/tracker/?func=detail&aid=3178751&group_id=23725&atid=379483",
    "created_at": "2012-03-06T22:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127557",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>

According to Clint Whaley, only ATLAS 3.9+ supports building a shared library on OSX:

http://sourceforge.net/tracker/?func=detail&aid=3178751&group_id=23725&atid=379483



---

archive/issue_comments_127558.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI've made a new atlas spkg here:\n\nhttp://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg\n\nTesting will take some time...",
    "created_at": "2012-03-07T01:45:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127558",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

I've made a new atlas spkg here:

http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg

Testing will take some time...



---

archive/issue_comments_127559.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@vbraun](#comment%3A25):\n> I've made a new atlas spkg here:\n> \n> http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg\n> \n> Testing will take some time...\n\non sqrt5 with Sage 5.0.beta7:\n\n```\n...\n    Intel?: True\n    processor: i386\nInstalling ATLAS on OS X Lion, as the BLAS shipped with the system\nis broken, see https://github.com/sagemath/sage/issues/12011\nCopying patches/Makefile to src/CONFIG/src/Makefile\nCopying patches/archinfo_linux.c to src/CONFIG/src/backend/archinfo_linux.c\nCopying patches/archinfo_x86.c to src/CONFIG/src/backend/archinfo_x86.c\nCopying patches/probe_comp.c to src/CONFIG/src/probe_comp.c\nFirst attempt: automatic tuning.\nRunning configure with arch = None and isa extensions None\nTraceback (most recent call last):\n  File \"./spkg-install\", line 408, in <module>\n    rc = build()\n  File \"./spkg-install\", line 396, in build\n    rc = configure(arch, isa_ext)    \n  File \"./spkg-install\", line 278, in configure\n    cmd += ' -O'+atlas_system\nTypeError: cannot concatenate 'str' and 'int' objects\n```",
    "created_at": "2012-03-07T02:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127559",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@vbraun](#comment%3A25):
> I've made a new atlas spkg here:
> 
> http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg
> 
> Testing will take some time...

on sqrt5 with Sage 5.0.beta7:

```
...
    Intel?: True
    processor: i386
Installing ATLAS on OS X Lion, as the BLAS shipped with the system
is broken, see https://github.com/sagemath/sage/issues/12011
Copying patches/Makefile to src/CONFIG/src/Makefile
Copying patches/archinfo_linux.c to src/CONFIG/src/backend/archinfo_linux.c
Copying patches/archinfo_x86.c to src/CONFIG/src/backend/archinfo_x86.c
Copying patches/probe_comp.c to src/CONFIG/src/probe_comp.c
First attempt: automatic tuning.
Running configure with arch = None and isa extensions None
Traceback (most recent call last):
  File "./spkg-install", line 408, in <module>
    rc = build()
  File "./spkg-install", line 396, in build
    rc = configure(arch, isa_ext)    
  File "./spkg-install", line 278, in configure
    cmd += ' -O'+atlas_system
TypeError: cannot concatenate 'str' and 'int' objects
```



---

archive/issue_comments_127560.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@dimpase](#comment%3A26):\n \n> on sqrt5 with Sage 5.0.beta7:\n\n\n```\n  File \"./spkg-install\", line 278, in configure\n    cmd += ' -O'+atlas_system\n```\n\nReplace this line with \n\n```\ncmd += ' -O '+str(atlas_system)\n```\n(note the space after O!)\n\nThe result can be obtained here: [http://boxen.math.washington.edu/home/dima/packages/atlas-3.9.68.spkg](http://boxen.math.washington.edu/home/dima/packages/atlas-3.9.68.spkg)\n\nThen is starts building. I'll report when it's done.",
    "created_at": "2012-03-07T03:21:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127560",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@dimpase](#comment%3A26):
 
> on sqrt5 with Sage 5.0.beta7:


```
  File "./spkg-install", line 278, in configure
    cmd += ' -O'+atlas_system
```

Replace this line with 

```
cmd += ' -O '+str(atlas_system)
```
(note the space after O!)

The result can be obtained here: [http://boxen.math.washington.edu/home/dima/packages/atlas-3.9.68.spkg](http://boxen.math.washington.edu/home/dima/packages/atlas-3.9.68.spkg)

Then is starts building. I'll report when it's done.



---

archive/issue_comments_127561.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI've also fixed the spkg in the meantime, for the record",
    "created_at": "2012-03-07T03:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127561",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:28" align="right">comment:28</div>

I've also fixed the spkg in the meantime, for the record



---

archive/issue_comments_127562.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@vbraun](#comment%3A28):\n> I've also fixed the spkg in the meantime, for the record\n\n```\nsqrt5:standard dima$ mailx vbraun\nSubject: let's not try to build 2 atlaces at the same time \nOK? :)\nEOT\n```",
    "created_at": "2012-03-07T03:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127562",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@vbraun](#comment%3A28):
> I've also fixed the spkg in the meantime, for the record

```
sqrt5:standard dima$ mailx vbraun
Subject: let's not try to build 2 atlaces at the same time 
OK? :)
EOT
```



---

archive/issue_comments_127563.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nUnrelated to this ticket, but why include LAPACK inside the ATLAS spkg?",
    "created_at": "2012-03-07T09:56:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127563",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Unrelated to this ticket, but why include LAPACK inside the ATLAS spkg?



---

archive/issue_comments_127564.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe following code (compile with Sage's gfortran, with -lblas library option) crashes not only on OSX 10.7, but also on \nOSX 10.6.\n\nShould we also provide Atlas on 10.6 ?\n\n```\n        PROGRAM TEST\n        COMPLEX*16 A(1), B(1),C\n        COMPLEX*16 ZDOTC\n        EXTERNAL ZDOTC\n        A(1)=1;\n        B(1)=2;\n        C=ZDOTC( 1, A, 1, B, 1 )\n        WRITE (*,*) C\n        END\n```",
    "created_at": "2012-03-07T12:19:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127564",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

The following code (compile with Sage's gfortran, with -lblas library option) crashes not only on OSX 10.7, but also on 
OSX 10.6.

Should we also provide Atlas on 10.6 ?

```
        PROGRAM TEST
        COMPLEX*16 A(1), B(1),C
        COMPLEX*16 ZDOTC
        EXTERNAL ZDOTC
        A(1)=1;
        B(1)=2;
        C=ZDOTC( 1, A, 1, B, 1 )
        WRITE (*,*) C
        END
```



---

archive/issue_comments_127565.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nwell, no, no luck yet. atlas-3.9.68 fails on sqrt5 with plenty of `ld: unknown option: -melf_x86_64` messages at the end.\n\n```\n...\nmake[2]: *** [LDTRY] Error 1\nld -melf_x86_64 -shared -soname /Users/dima/Sage/sage-5.0.beta7/local/lib/libtatlas.so -o libtatlas.so \\\n           -rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib \\\n           --whole-archive libptlapack.a libptf77blas.a libptcblas.a libatlas.a --no-whole-archive -lpthread -lm\nld: unknown option: -melf_x86_64\nmake[2]: *** [LDTRY] Error 1\ngcc -fPIC -m64 -shared -o libtatlas.so -Wl,\"rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib\" \\\n           -Wl,--whole-archive libptlapack.a libptf77blas.a libptcblas.a libatlas.a -Wl,--no-whole-archive -lpthread -lm\nld: file not found: rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib\ncollect2: ld returned 1 exit status\nmake[2]: *** [GCCTRY] Error 1\nmake[1]: *** [TRYALL] Error 2\nmake: *** [fat_ptshared] Error 2\nTraceback (most recent call last):\n  File \"./spkg-install\", line 431, in <module>\n    assert rc==0, 'Building shared ATLAS library failed.'\nAssertionError: Building shared ATLAS library failed.\n\nreal    683m42.661s\nuser    200m29.372s\nsys     36m57.615s\n************************************************************************\nError installing package atlas-3.9.68\n************************************************************************\n```",
    "created_at": "2012-03-07T15:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127565",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

well, no, no luck yet. atlas-3.9.68 fails on sqrt5 with plenty of `ld: unknown option: -melf_x86_64` messages at the end.

```
...
make[2]: *** [LDTRY] Error 1
ld -melf_x86_64 -shared -soname /Users/dima/Sage/sage-5.0.beta7/local/lib/libtatlas.so -o libtatlas.so \
           -rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib \
           --whole-archive libptlapack.a libptf77blas.a libptcblas.a libatlas.a --no-whole-archive -lpthread -lm
ld: unknown option: -melf_x86_64
make[2]: *** [LDTRY] Error 1
gcc -fPIC -m64 -shared -o libtatlas.so -Wl,"rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib" \
           -Wl,--whole-archive libptlapack.a libptf77blas.a libptcblas.a libatlas.a -Wl,--no-whole-archive -lpthread -lm
ld: file not found: rpath-link /Users/dima/Sage/sage-5.0.beta7/local/lib
collect2: ld returned 1 exit status
make[2]: *** [GCCTRY] Error 1
make[1]: *** [TRYALL] Error 2
make: *** [fat_ptshared] Error 2
Traceback (most recent call last):
  File "./spkg-install", line 431, in <module>
    assert rc==0, 'Building shared ATLAS library failed.'
AssertionError: Building shared ATLAS library failed.

real    683m42.661s
user    200m29.372s
sys     36m57.615s
************************************************************************
Error installing package atlas-3.9.68
************************************************************************
```



---

archive/issue_comments_127566.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\natlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).\n\nFortunately, atlas-3.9.68 has actually make targets for OSX dylibs so fixing the remaining issue should be easy. Updated spkg at http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg, though its still compiling of course...",
    "created_at": "2012-03-08T00:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127566",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

atlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).

Fortunately, atlas-3.9.68 has actually make targets for OSX dylibs so fixing the remaining issue should be easy. Updated spkg at http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg, though its still compiling of course...



---

archive/issue_comments_127567.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI am not thrilled by atlas-3.9.xx. Do we know if they have have finally solved some of the problems they have in dgemm? At least 3.9.68 seems to have all the symbols unlike 3.9.67 which somehow left a pile of lapack symbols behind.",
    "created_at": "2012-03-08T02:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127567",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:34" align="right">comment:34</div>

I am not thrilled by atlas-3.9.xx. Do we know if they have have finally solved some of the problems they have in dgemm? At least 3.9.68 seems to have all the symbols unlike 3.9.67 which somehow left a pile of lapack symbols behind.



---

archive/issue_comments_127568.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nFor the record, I've tentatively run some tests on Linux haven't found any breakage so far with atlas-3.9.68.",
    "created_at": "2012-03-08T03:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127568",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">comment:35</div>

For the record, I've tentatively run some tests on Linux haven't found any breakage so far with atlas-3.9.68.



---

archive/issue_comments_127569.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nDidn't test 3.9.68 (last one I checked was 3.9.49). The following tests were historically failing with 3.9.xx:\n\n```\nsage -t -force_lib \"devel/sage/sage/modular/modsym/space.py\"\nsage -t -force_lib \"devel/sage/sage/calculus/interpolators.pyx\"\n```",
    "created_at": "2012-03-08T03:59:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127569",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:36" align="right">comment:36</div>

Didn't test 3.9.68 (last one I checked was 3.9.49). The following tests were historically failing with 3.9.xx:

```
sage -t -force_lib "devel/sage/sage/modular/modsym/space.py"
sage -t -force_lib "devel/sage/sage/calculus/interpolators.pyx"
```



---

archive/issue_comments_127570.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,8 @@\n \n The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.\n \n-**spkg** (untested!): [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg)\n+To test:\n+* Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard\n+* Apply [attachment: trac_10508_spkg_install.patch](https://github.com/sagemath/sage/files/ticket12011/trac_10508_spkg_install.patch.gz) to the root repository.\n+\n+\n``````\n",
    "created_at": "2012-03-08T05:19:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127570",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,8 @@
 
 The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.
 
-**spkg** (untested!): [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.8.4.p2.spkg)
+To test:
+* Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard
+* Apply [attachment: trac_10508_spkg_install.patch](https://github.com/sagemath/sage/files/ticket12011/trac_10508_spkg_install.patch.gz) to the root repository.
+
+
``````




---

archive/issue_comments_127571.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@vbraun](#comment%3A33):\n> atlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).\n\nDoes this imply we have to build ATLAS+LAPACK on *every* system (we used to build LAPACK on every system)?  Not saying this is a bad thing, just asking...\n\nPutting `lapack` in patches is just weird, you should probably distribute it extracted (either inside `src` or in a `lapack` top-level directory in the spkg).",
    "created_at": "2012-03-08T08:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127571",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@vbraun](#comment%3A33):
> atlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).

Does this imply we have to build ATLAS+LAPACK on *every* system (we used to build LAPACK on every system)?  Not saying this is a bad thing, just asking...

Putting `lapack` in patches is just weird, you should probably distribute it extracted (either inside `src` or in a `lapack` top-level directory in the spkg).



---

archive/issue_comments_127572.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nIf you patch `spkg/install`, please keep in mind #10492 (which has positive_review).",
    "created_at": "2012-03-08T08:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127572",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

If you patch `spkg/install`, please keep in mind #10492 (which has positive_review).



---

archive/issue_comments_127573.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@jdemeyer](#comment%3A38):\n> Replying to [@vbraun](#comment%3A33):\n> > atlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).\n> \n> \n> Does this imply we have to build ATLAS+LAPACK on *every* system (we used to build LAPACK on every system)?  Not saying this is a bad thing, just asking...\n\n\nhmm, all? \nAre we dropping OSX PPC support? IMHO Atlas doesn't run on OSX PPC. Also, I don't think we build Atlas on ARM.\n(And Linux ARM support sort of works, it's matter of just a little bit more work)\n\n> \n> Putting `lapack` in patches is just weird, you should probably distribute it extracted (either inside `src` or in a `lapack` top-level directory in the spkg).",
    "created_at": "2012-03-08T08:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127573",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@jdemeyer](#comment%3A38):
> Replying to [@vbraun](#comment%3A33):
> > atlas-3.9 is designed to build lapack as part of its build process. This is why lapack is now included and can be removed as separate spkg (see discussion at #10508).
> 
> 
> Does this imply we have to build ATLAS+LAPACK on *every* system (we used to build LAPACK on every system)?  Not saying this is a bad thing, just asking...


hmm, all? 
Are we dropping OSX PPC support? IMHO Atlas doesn't run on OSX PPC. Also, I don't think we build Atlas on ARM.
(And Linux ARM support sort of works, it's matter of just a little bit more work)

> 
> Putting `lapack` in patches is just weird, you should probably distribute it extracted (either inside `src` or in a `lapack` top-level directory in the spkg).



---

archive/issue_comments_127574.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThe new ATLAS spkg builds for me on several OS X Lion machines. The self-tests are disabled on Darwin (I realized after installing it), so they didn't run; I'm trying again after modifying `spkg-check`. In an existing Sage build (one in which lapack and blas were already installed), after building ATLAS, the cvxopt spkg still fails self-tests. Do we need to modify that spkg to tell it where to find the ATLAS libraries? Or could there be a problem with the old lapack or blas?",
    "created_at": "2012-03-08T14:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127574",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">comment:41</div>

The new ATLAS spkg builds for me on several OS X Lion machines. The self-tests are disabled on Darwin (I realized after installing it), so they didn't run; I'm trying again after modifying `spkg-check`. In an existing Sage build (one in which lapack and blas were already installed), after building ATLAS, the cvxopt spkg still fails self-tests. Do we need to modify that spkg to tell it where to find the ATLAS libraries? Or could there be a problem with the old lapack or blas?



---

archive/issue_comments_127575.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nAs far as installing this on OS X: I think we can test the existing ATLAS and/or BLAS libraries with Python, and Python is a prerequisite for this spkg. So why not test to see if the system libraries seem to be functioning; if so, don't install this. Then we shouldn't install this on pre-Lion machines, and if Apple ever fixes their system libraries, we won't install it then either.",
    "created_at": "2012-03-08T15:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127575",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:42" align="right">comment:42</div>

As far as installing this on OS X: I think we can test the existing ATLAS and/or BLAS libraries with Python, and Python is a prerequisite for this spkg. So why not test to see if the system libraries seem to be functioning; if so, don't install this. Then we shouldn't install this on pre-Lion machines, and if Apple ever fixes their system libraries, we won't install it then either.



---

archive/issue_comments_127576.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI think we have some more work to do until we can ship the new atlas on any system, you are a bit premature in discussing how to support old systems.\n\nThe only way to be sure that you don't have statically linked to another blas is to build Sage from source with the new atlas spkg. This doesn't add much overhead over building atlas.\n\nAlso, the atlas shared libraries are now named `lib{t,s}atlas.{so,dylib}` for threaded/singlethreaded and unix/osx respectively. We need to change `modules_list.py` and `sage/misc/cython.py` to actually use the new libraries. How about one of you with an actual OSX machine makes these config changes.\n\nAlso, on Linux I'm getting\n\n```\n/home/vbraun/opt/sage-atlas/sage-5.0.beta7/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_\n```\nwhen installing scipy. I'll try to track this down.",
    "created_at": "2012-03-08T18:05:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127576",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:43" align="right">comment:43</div>

I think we have some more work to do until we can ship the new atlas on any system, you are a bit premature in discussing how to support old systems.

The only way to be sure that you don't have statically linked to another blas is to build Sage from source with the new atlas spkg. This doesn't add much overhead over building atlas.

Also, the atlas shared libraries are now named `lib{t,s}atlas.{so,dylib}` for threaded/singlethreaded and unix/osx respectively. We need to change `modules_list.py` and `sage/misc/cython.py` to actually use the new libraries. How about one of you with an actual OSX machine makes these config changes.

Also, on Linux I'm getting

```
/home/vbraun/opt/sage-atlas/sage-5.0.beta7/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_
```
when installing scipy. I'll try to track this down.



---

archive/issue_comments_127577.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@vbraun](#comment%3A43):\n> I think we have some more work to do until we can ship the new atlas on any system, you are a bit premature in discussing how to support old systems.\n> \n> The only way to be sure that you don't have statically linked to another blas is to build Sage from source with the new atlas spkg. This doesn't add much overhead over building atlas.\n> \n> Also, the atlas shared libraries are now named `lib{t,s}atlas.{so,dylib}` for threaded/singlethreaded and unix/osx respectively. We need to change `modules_list.py` and `sage/misc/cython.py` to actually use the new libraries. How about one of you with an actual OSX machine makes these config changes.\n> \n> Also, on Linux I'm getting\n> \n> ```\n> /home/vbraun/opt/sage-atlas/sage-5.0.beta7/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_\n> ```\n> when installing scipy. I'll try to track this down.\n\nWhich lapack version are you using in the package. We had quite a few problem of that kind in Gentoo and Sebastien Fabbro (the package maintainer of atlas) did go from\nlapack-3.4.0_p20120215 back to lapack-3.4.0 to solve the problem.",
    "created_at": "2012-03-08T21:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127577",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@vbraun](#comment%3A43):
> I think we have some more work to do until we can ship the new atlas on any system, you are a bit premature in discussing how to support old systems.
> 
> The only way to be sure that you don't have statically linked to another blas is to build Sage from source with the new atlas spkg. This doesn't add much overhead over building atlas.
> 
> Also, the atlas shared libraries are now named `lib{t,s}atlas.{so,dylib}` for threaded/singlethreaded and unix/osx respectively. We need to change `modules_list.py` and `sage/misc/cython.py` to actually use the new libraries. How about one of you with an actual OSX machine makes these config changes.
> 
> Also, on Linux I'm getting
> 
> ```
> /home/vbraun/opt/sage-atlas/sage-5.0.beta7/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_
> ```
> when installing scipy. I'll try to track this down.

Which lapack version are you using in the package. We had quite a few problem of that kind in Gentoo and Sebastien Fabbro (the package maintainer of atlas) did go from
lapack-3.4.0_p20120215 back to lapack-3.4.0 to solve the problem.



---

archive/issue_comments_127578.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI'm using lapack-3.4.0 in atlas-3.9.68 (did you mean lapack-3.3.0?)",
    "created_at": "2012-03-08T21:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127578",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:45" align="right">comment:45</div>

I'm using lapack-3.4.0 in atlas-3.9.68 (did you mean lapack-3.3.0?)



---

archive/issue_comments_127579.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@vbraun](#comment%3A45):\n> I'm using lapack-3.4.0 in atlas-3.9.68 (did you mean lapack-3.3.0?)\n\nNo I meant 3.4.0, the reports that we had were for a different symbols but there could have been several missing for all I know. dpotrf_ is definitely present in my system install of atlas-lapack which is atlas 3.9.68 + lapack-3.4.0. But it may be worth a try with 3.3.1. I am looking at the spkg (I am on irc right now).",
    "created_at": "2012-03-08T21:42:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127579",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@vbraun](#comment%3A45):
> I'm using lapack-3.4.0 in atlas-3.9.68 (did you mean lapack-3.3.0?)

No I meant 3.4.0, the reports that we had were for a different symbols but there could have been several missing for all I know. dpotrf_ is definitely present in my system install of atlas-lapack which is atlas 3.9.68 + lapack-3.4.0. But it may be worth a try with 3.3.1. I am looking at the spkg (I am on irc right now).



---

archive/issue_comments_127580.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nNow on OS X Lion, with Sage built from scratch (using the root repo patch from this ticket), this spkg passes its self-tests, but cvxopt doesn't:\n\n```\nRunning the test suite for cvxopt-1.1.3.p1...\nTesting in /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/spkg/build/cvxopt-1.1.3.p1/src/examples/doc/chap10\nTesting l1svc.py ...\nTraceback (most recent call last):\n  File \"l1svc.py\", line 12, in <module>\n    op(sum(abs(x)) + sum(u), [A*x >= 1-u, u >= 0]).solve()\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/modeling.py\", line 2575, in solve\n    sol = solvers.lp(c[:], G, h, A, b, solver=solver)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/coneprog.py\", line 2794, in lp\n    from cvxopt import base, blas, misc\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/misc.py\", line 20, in <module>\n    from cvxopt import base, blas, lapack, cholmod, misc_solvers\nImportError: dlopen(/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so, 2): Symbol not found: _ATL_cGetNB\n  Referenced from: /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so\n  Expected in: flat namespace\n in /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so\nError: test /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/spkg/build/cvxopt-1.1.3.p1/src/examples/doc/chap10/l1svc.py failed\n```",
    "created_at": "2012-03-09T00:38:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127580",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:47" align="right">comment:47</div>

Now on OS X Lion, with Sage built from scratch (using the root repo patch from this ticket), this spkg passes its self-tests, but cvxopt doesn't:

```
Running the test suite for cvxopt-1.1.3.p1...
Testing in /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/spkg/build/cvxopt-1.1.3.p1/src/examples/doc/chap10
Testing l1svc.py ...
Traceback (most recent call last):
  File "l1svc.py", line 12, in <module>
    op(sum(abs(x)) + sum(u), [A*x >= 1-u, u >= 0]).solve()
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/modeling.py", line 2575, in solve
    sol = solvers.lp(c[:], G, h, A, b, solver=solver)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/coneprog.py", line 2794, in lp
    from cvxopt import base, blas, misc
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/misc.py", line 20, in <module>
    from cvxopt import base, blas, lapack, cholmod, misc_solvers
ImportError: dlopen(/Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so, 2): Symbol not found: _ATL_cGetNB
  Referenced from: /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so
  Expected in: flat namespace
 in /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so
Error: test /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/spkg/build/cvxopt-1.1.3.p1/src/examples/doc/chap10/l1svc.py failed
```



---

archive/issue_comments_127581.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nWe talked on irc with Volker it is not impossible that you didn't link against the right library because there is a slightly difference in naming scheme in 3.9.68. What does\n\n```\notool -L /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so\n```\nsays?",
    "created_at": "2012-03-09T00:44:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127581",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:48" align="right">comment:48</div>

We talked on irc with Volker it is not impossible that you didn't link against the right library because there is a slightly difference in naming scheme in 3.9.68. What does

```
otool -L /Users/palmieri/Desktop/Sage_stuff/sage_builds/new-atlas/sage-5.0.beta7-gcc/local/lib/python2.7/site-packages/cvxopt/lapack.so
```
says?



---

archive/issue_comments_127582.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nIn fact, there is no urgent need to build Atlas on OSX 10.7, as I just learned. \nit turns out to be a CVXOPT bug. Please see this  [message](https://groups.google.com/d/msg/sage-devel/f1XvpcK0KxE/oSFsKrA7MfkJ) and this [discussion](https://discussions.apple.com/message/17795537))",
    "created_at": "2012-03-09T00:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127582",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:49" align="right">comment:49</div>

In fact, there is no urgent need to build Atlas on OSX 10.7, as I just learned. 
it turns out to be a CVXOPT bug. Please see this  [message](https://groups.google.com/d/msg/sage-devel/f1XvpcK0KxE/oSFsKrA7MfkJ) and this [discussion](https://discussions.apple.com/message/17795537))



---

archive/issue_events_160947.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-03-09T00:57:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160947"
}
```



---

archive/issue_events_160948.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-03-09T00:57:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160948"
}
```



---

archive/issue_comments_127583.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,9 @@\n On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.\n \n-The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.\n+CVXOPT devs claimed that  Apple shipped a totally broken BLAS.  \n+(But it turns out that they cannot provide valid examples showing this; they do not adhere to a de facto BLAS standard).\n+\n+Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.\n \n To test:\n * Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard\n``````\n",
    "created_at": "2012-03-09T01:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127583",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,9 @@
 On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.
 
-The problem is due to Apple shipping a totally broken BLAS.  Therefore, we need to build ATLAS.
+CVXOPT devs claimed that  Apple shipped a totally broken BLAS.  
+(But it turns out that they cannot provide valid examples showing this; they do not adhere to a de facto BLAS standard).
+
+Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.
 
 To test:
 * Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard
``````




---

archive/issue_comments_127584.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@dimpase](#comment%3A49):\n> In fact, there is no urgent need to build Atlas on OSX 10.7, as I just learned. \n> it turns out to be a CVXOPT bug. Please see this  [message](https://groups.google.com/d/msg/sage-devel/f1XvpcK0KxE/oSFsKrA7MfkJ) and this [discussion](https://discussions.apple.com/message/17795537))\n> \n\nwhat is true is that in OSX 10.7 there is a change in behavour of Apple's BLAS on a technically illegal input. What used to work as (wrongly!) expected does not work  any more.",
    "created_at": "2012-03-09T01:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127584",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@dimpase](#comment%3A49):
> In fact, there is no urgent need to build Atlas on OSX 10.7, as I just learned. 
> it turns out to be a CVXOPT bug. Please see this  [message](https://groups.google.com/d/msg/sage-devel/f1XvpcK0KxE/oSFsKrA7MfkJ) and this [discussion](https://discussions.apple.com/message/17795537))
> 

what is true is that in OSX 10.7 there is a change in behavour of Apple's BLAS on a technically illegal input. What used to work as (wrongly!) expected does not work  any more.



---

archive/issue_comments_127585.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2012-03-09T03:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127585",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_127586.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.\n \n-CVXOPT devs claimed that  Apple shipped a totally broken BLAS.  \n-(But it turns out that they cannot provide valid examples showing this; they do not adhere to a de facto BLAS standard).\n+CVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.\n \n Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.\n \n``````\n",
    "created_at": "2012-03-09T03:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127586",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
 On OS X Lion, if you set `SAGE_CHECK=yes` and build cvxopt, some tests fail and then it hangs before completing the tests.  See [http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.3.log) for the install log.
 
-CVXOPT devs claimed that  Apple shipped a totally broken BLAS.  
-(But it turns out that they cannot provide valid examples showing this; they do not adhere to a de facto BLAS standard).
+CVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.
 
 Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.
 
``````




---

archive/issue_events_160949.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-09T07:37:26Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "title_is": "Fix illegal BLAS call in cvxopt",
    "title_was": "Build ATLAS on OS X Lion",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160949"
}
```



---

archive/issue_comments_127587.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,8 +4,3 @@\n \n Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.\n \n-To test:\n-* Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard\n-* Apply [attachment: trac_10508_spkg_install.patch](https://github.com/sagemath/sage/files/ticket12011/trac_10508_spkg_install.patch.gz) to the root repository.\n-\n-\n``````\n",
    "created_at": "2012-03-10T10:06:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127587",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,8 +4,3 @@
 
 Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.
 
-To test:
-* Copy http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.9.68.spkg to SAGE_ROOT/spkg/standard
-* Apply [attachment: trac_10508_spkg_install.patch](https://github.com/sagemath/sage/files/ticket12011/trac_10508_spkg_install.patch.gz) to the root repository.
-
-
``````




---

archive/issue_comments_127588.json:
```json
{
    "body": "Dependencies: **#12519**",
    "created_at": "2012-03-10T10:06:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127588",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#12519**



---

archive/issue_comments_127589.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nAny news from upstream CVXOPT?",
    "created_at": "2012-03-28T08:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127589",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

Any news from upstream CVXOPT?



---

archive/issue_comments_127590.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2012-03-31T06:52:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127590",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_127591.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@jdemeyer](#comment%3A55):\n> Any news from upstream CVXOPT?\n\nThey have released 1.1.5 [fixing](http://abel.ee.ucla.edu/cvxopt/documentation/index.html) this issue.\nAny takers to update the cvxopt spkg ? I,  right now, have too many other things to do.",
    "created_at": "2012-03-31T06:52:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127591",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@jdemeyer](#comment%3A55):
> Any news from upstream CVXOPT?

They have released 1.1.5 [fixing](http://abel.ee.ucla.edu/cvxopt/documentation/index.html) this issue.
Any takers to update the cvxopt spkg ? I,  right now, have too many other things to do.



---

archive/issue_comments_127592.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@dimpase](#comment%3A56):\n> They have released 1.1.5 [fixing](http://abel.ee.ucla.edu/cvxopt/documentation/index.html) this issue.\n> Any takers to update the cvxopt spkg ? I,  right now, have too many other things to do.\n\nI'm working on it. More details in a few minutes.",
    "created_at": "2012-03-31T18:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127592",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@dimpase](#comment%3A56):
> They have released 1.1.5 [fixing](http://abel.ee.ucla.edu/cvxopt/documentation/index.html) this issue.
> Any takers to update the cvxopt spkg ? I,  right now, have too many other things to do.

I'm working on it. More details in a few minutes.



---

archive/issue_events_160950.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-03-31T18:55:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160950"
}
```



---

archive/issue_events_160951.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-03-31T18:55:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160951"
}
```



---

archive/issue_comments_127593.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nI'm posting a new spkg, but not a perfect one. The flaw is that it is version 1.1.4 rather than 1.1.5. I looked at 1.1.4 and 1.1.5, and (using `diff -r ...`) I found two changes in the code: the file `src/C/dense.c` was modified, and I imported that change into the 1.1.4 spkg. With this change, it builds and self-tests pass on OS X Lion, and also on sage.math and OpenSolaris. So that's the version I'm posting here.\n\nThe other change was to `setup.py`, and I don't understand enough of the changes in our patch to modify it. That is, `setup.py` in version 1.1.4 was almost identical to the version in 1.1.3, so it was easy to rebase our patch, but I couldn't figure out how to rebase to 1.1.5. C'est la vie.",
    "created_at": "2012-03-31T18:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127593",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:58" align="right">comment:58</div>

I'm posting a new spkg, but not a perfect one. The flaw is that it is version 1.1.4 rather than 1.1.5. I looked at 1.1.4 and 1.1.5, and (using `diff -r ...`) I found two changes in the code: the file `src/C/dense.c` was modified, and I imported that change into the 1.1.4 spkg. With this change, it builds and self-tests pass on OS X Lion, and also on sage.math and OpenSolaris. So that's the version I'm posting here.

The other change was to `setup.py`, and I don't understand enough of the changes in our patch to modify it. That is, `setup.py` in version 1.1.4 was almost identical to the version in 1.1.3, so it was easy to rebase our patch, but I couldn't figure out how to rebase to 1.1.5. C'est la vie.



---

archive/issue_comments_127594.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, John Palmieri**",
    "created_at": "2012-03-31T18:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127594",
    "user": "https://github.com/jhpalmieri"
}
```

Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, John Palmieri**



---

archive/issue_comments_127595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,7 @@\n \n Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.\n \n+---\n+\n+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg)\n+\n``````\n",
    "created_at": "2012-03-31T18:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127595",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,7 @@
 
 Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.
 
+---
+
+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg)
+
``````




---

archive/issue_comments_127596.json:
```json
{
    "body": "patch for cvxopt spkg; for review only",
    "created_at": "2012-03-31T18:56:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127596",
    "user": "https://github.com/jhpalmieri"
}
```

patch for cvxopt spkg; for review only



---

archive/issue_comments_127597.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAttachment: **[trac_12011-cvxopt.patch.gz](https://github.com/sagemath/sage/files/ticket12011/trac_12011-cvxopt.patch.gz)**\n\nUnfortunately, I don't have access anymore to a OS X 10.7 machine.",
    "created_at": "2012-04-03T13:01:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127597",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

Attachment: **[trac_12011-cvxopt.patch.gz](https://github.com/sagemath/sage/files/ticket12011/trac_12011-cvxopt.patch.gz)**

Unfortunately, I don't have access anymore to a OS X 10.7 machine.



---

archive/issue_comments_127598.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nThis spkg is included in [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/) for testing.",
    "created_at": "2012-04-03T13:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127598",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

This spkg is included in [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/) for testing.



---

archive/issue_comments_127599.json:
```json
{
    "body": "Diff for the cvxopt spkg (p0->p1). For review only",
    "created_at": "2012-04-03T13:53:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127599",
    "user": "https://github.com/jdemeyer"
}
```

Diff for the cvxopt spkg (p0->p1). For review only



---

archive/issue_comments_127600.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2012-04-03T14:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127600",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_127601.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,9 +2,9 @@\n \n CVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.\n \n-Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.\n+This spkg also fixes an issue building with GCC on Solaris 10.  There already was a fix for this in the spkg, but it was only enabled for GCC versions < 4.5 (without any mention of why).  Enable this fix for all GCC versions.\n \n ---\n \n-New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg)\n+New spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)\n \n``````\n",
    "created_at": "2012-04-03T14:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127601",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,9 +2,9 @@
 
 CVXOPT devs claimed that Apple shipped a broken BLAS. But it turned out that they cannot provide valid examples showing this; they did not adhere to a de facto BLAS standard, and they agreed to fix the corresponding CVXOPT bug quickly.
 
-Thus we don't really need to build ATLAS on OSX 10.7, at least not until a real proof of bugs is found.
+This spkg also fixes an issue building with GCC on Solaris 10.  There already was a fix for this in the spkg, but it was only enabled for GCC versions < 4.5 (without any mention of why).  Enable this fix for all GCC versions.
 
 ---
 
-New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/cvxopt-1.1.4.p0.spkg)
+New spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)
 
``````




---

archive/issue_events_160952.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-03T14:00:26Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "title_is": "cvxopt: fix illegal BLAS call and fix Solaris build",
    "title_was": "Fix illegal BLAS call in cvxopt",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160952"
}
```



---

archive/issue_comments_127602.json:
```json
{
    "body": "Changed keywords from **Lion Darwin cvxopt atlas blas** to **Lion Darwin cvxopt atlas blas Solaris**",
    "created_at": "2012-04-03T14:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127602",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **Lion Darwin cvxopt atlas blas** to **Lion Darwin cvxopt atlas blas Solaris**



---

archive/issue_events_160953.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-03T14:00:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20solaris",
    "label_color": "0000b0",
    "label_name": "c: porting: solaris",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160953"
}
```



---

archive/issue_comments_127603.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nAttachment: **[cvxopt-1.1.4.p1.diff.gz](https://github.com/sagemath/sage/files/ticket12011/cvxopt-1.1.4.p1.diff.gz)**\n\nReviewer spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)\n\nChanges: [attachment: cvxopt-1.1.4.p1.diff](https://github.com/sagemath/sage/files/ticket12011/cvxopt-1.1.4.p1.diff.gz)\n\nJohn, if you confirm that my spkg builds with SAGE_CHECK=yes on OS X Lion and you agree with my changes, you may set this to positive review.",
    "created_at": "2012-04-03T14:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127603",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">comment:61</div>

Attachment: **[cvxopt-1.1.4.p1.diff.gz](https://github.com/sagemath/sage/files/ticket12011/cvxopt-1.1.4.p1.diff.gz)**

Reviewer spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cvxopt-1.1.4.p1.spkg)

Changes: [attachment: cvxopt-1.1.4.p1.diff](https://github.com/sagemath/sage/files/ticket12011/cvxopt-1.1.4.p1.diff.gz)

John, if you confirm that my spkg builds with SAGE_CHECK=yes on OS X Lion and you agree with my changes, you may set this to positive review.



---

archive/issue_comments_127604.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, John Palmieri**",
    "created_at": "2012-04-03T18:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127604",
    "user": "https://github.com/jhpalmieri"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, John Palmieri**



---

archive/issue_events_160954.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-04-03T18:44:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160954"
}
```



---

archive/issue_events_160955.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-04-03T18:44:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160955"
}
```



---

archive/issue_comments_127605.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nChanges look good and this passes tests on OS X Lion (and OpenSolaris, which I tried just for fun).",
    "created_at": "2012-04-03T18:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127605",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:62" align="right">comment:62</div>

Changes look good and this passes tests on OS X Lion (and OpenSolaris, which I tried just for fun).



---

archive/issue_comments_127606.json:
```json
{
    "body": "Merged: **sage-5.0.beta13**",
    "created_at": "2012-04-04T19:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12011#issuecomment-127606",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.0.beta13**



---

archive/issue_events_160956.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-04T19:27:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160956"
}
```



---

archive/issue_events_160957.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-04T19:27:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12011",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12011#event-160957"
}
```
