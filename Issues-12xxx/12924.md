# Issue 12924: SchubertPolynomialRing causes symmetrica and Sage to crash on bad input

archive/issues_012752.json:
```json
{
    "body": "The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !\n\n```\nsage: S = SchubertPolynomialRing(ZZ)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \nsage: pol = S([2,1,3])\nsage: pol.expand()\nx0\nsage: pol = S([2,1,1])\nsage: pol.expand()\nfunction: mult_apply_integer(2) \npython: function: mult_apply_integer(2) \n: Operation not permitted\n```\nSo the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not.\n\nNew behaviour is now :\n\n```\nsage: X = SchubertPolynomialRing(QQ)\nsage: X._element_constructor_([1,2,1])\nTraceback (most recent call last):\n...\nValueError: The input [1, 2, 1] is not a valid permutation\nsage: X._element_constructor_(Permutation([1,2,1]))\nTraceback (most recent call last):\n...\nValueError: The input [1, 2, 1] is not a valid permutation\n\n```\nTests have been added into the documentation.\n\nThe patch is attached to the ticket and also available into Sage-Combinat\n\nAssignee: @VivianePons\n\nCC:  sage-combinat @nthiery\n\nKeywords: days38, Schubert polynomials\n\nReviewer: Mike Hansen\n\nAuthor: Viviane Pons\n\nMerged: sage-5.3.beta1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12924\n\n",
    "closed_at": "2012-08-12T18:59:38Z",
    "created_at": "2012-05-08T15:16:12Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "SchubertPolynomialRing causes symmetrica and Sage to crash on bad input",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12924",
    "user": "https://github.com/VivianePons"
}
```
The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !

```
sage: S = SchubertPolynomialRing(ZZ)                                  
sage: pol = S([2,1,3])
sage: pol.expand()
x0
sage: pol = S([2,1,1])
sage: pol.expand()
function: mult_apply_integer(2) 
python: function: mult_apply_integer(2) 
: Operation not permitted
```
So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not.

New behaviour is now :

```
sage: X = SchubertPolynomialRing(QQ)
sage: X._element_constructor_([1,2,1])
Traceback (most recent call last):
...
ValueError: The input [1, 2, 1] is not a valid permutation
sage: X._element_constructor_(Permutation([1,2,1]))
Traceback (most recent call last):
...
ValueError: The input [1, 2, 1] is not a valid permutation

```
Tests have been added into the documentation.

The patch is attached to the ticket and also available into Sage-Combinat

Assignee: @VivianePons

CC:  sage-combinat @nthiery

Keywords: days38, Schubert polynomials

Reviewer: Mike Hansen

Author: Viviane Pons

Merged: sage-5.3.beta1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12924





---

archive/issue_comments_162339.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-08T18:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162339",
    "user": "https://github.com/VivianePons"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_162340.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash ! \n+The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !\n \n ```\n sage: S = SchubertPolynomialRing(ZZ)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n@@ -11,8 +11,23 @@\n python: function: mult_apply_integer(2) \n : Operation not permitted\n ```\n-So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not. \n+So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not.\u00a0\n \n+New behaviour is now :\n+\n+```\n+sage: X = SchubertPolynomialRing(QQ)\n+sage: X._element_constructor_([1,2,1])\n+Traceback (most recent call last):\n+...\n+ValueError: The input [1, 2, 1] is not a valid permutation\n+sage: X._element_constructor_(Permutation([1,2,1]))\n+Traceback (most recent call last):\n+...\n+ValueError: The input [1, 2, 1] is not a valid permutation\n+\n+```\n+Tests have been added into the documentation.\n \n Issue created by migration from https://trac.sagemath.org/ticket/12924\n \n```\n",
    "created_at": "2012-05-08T18:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162340",
    "user": "https://github.com/VivianePons"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash ! 
+The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !
 
 ```
 sage: S = SchubertPolynomialRing(ZZ)                                  
@@ -11,8 +11,23 @@
 python: function: mult_apply_integer(2) 
 : Operation not permitted
 ```
-So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not. 
+So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not. 
 
+New behaviour is now :
+
+```
+sage: X = SchubertPolynomialRing(QQ)
+sage: X._element_constructor_([1,2,1])
+Traceback (most recent call last):
+...
+ValueError: The input [1, 2, 1] is not a valid permutation
+sage: X._element_constructor_(Permutation([1,2,1]))
+Traceback (most recent call last):
+...
+ValueError: The input [1, 2, 1] is not a valid permutation
+
+```
+Tests have been added into the documentation.
 
 Issue created by migration from https://trac.sagemath.org/ticket/12924
 
```




---

archive/issue_comments_162341.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [trac_12924-Schubert-polynomials-input-bug-vp.patch](tarball://root/attachments/some-uuid/ticket12924/trac_12924-Schubert-polynomials-input-bug-vp.patch) by @VivianePons created at 2012-05-08 18:44:32",
    "created_at": "2012-05-08T18:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162341",
    "user": "https://github.com/VivianePons"
}
```

<a id='comment:1'></a>Attachment [trac_12924-Schubert-polynomials-input-bug-vp.patch](tarball://root/attachments/some-uuid/ticket12924/trac_12924-Schubert-polynomials-input-bug-vp.patch) by @VivianePons created at 2012-05-08 18:44:32



---

archive/issue_comments_162342.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,35 @@\n+The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !\n \n+```\n+sage: S = SchubertPolynomialRing(ZZ)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n+sage: pol = S([2,1,3])\n+sage: pol.expand()\n+x0\n+sage: pol = S([2,1,1])\n+sage: pol.expand()\n+function: mult_apply_integer(2) \n+python: function: mult_apply_integer(2) \n+: Operation not permitted\n+```\n+So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not.\n+\n+New behaviour is now :\n+\n+```\n+sage: X = SchubertPolynomialRing(QQ)\n+sage: X._element_constructor_([1,2,1])\n+Traceback (most recent call last):\n+...\n+ValueError: The input [1, 2, 1] is not a valid permutation\n+sage: X._element_constructor_(Permutation([1,2,1]))\n+Traceback (most recent call last):\n+...\n+ValueError: The input [1, 2, 1] is not a valid permutation\n+\n+```\n+Tests have been added into the documentation.\n+\n+The patch is attached to the ticket and also available into Sage-Combinat\n \n Issue created by migration from https://trac.sagemath.org/ticket/12924\n \n```\n",
    "created_at": "2012-05-08T18:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162342",
    "user": "https://github.com/VivianePons"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,35 @@
+The SchubertPolynomialRing expects a permutation as an index. When a list is given which is not a permutation, the object is created anyway. The problem comes when one tries to expand the polynomial, if the index is not a valid permutation, it makes symmetrica crash which makes Sage crash !
 
+```
+sage: S = SchubertPolynomialRing(ZZ)                                  
+sage: pol = S([2,1,3])
+sage: pol.expand()
+x0
+sage: pol = S([2,1,1])
+sage: pol.expand()
+function: mult_apply_integer(2) 
+python: function: mult_apply_integer(2) 
+: Operation not permitted
+```
+So the idea would be to check when the polynomial is created that the input is correct and raise an exception at this point if it's not.
+
+New behaviour is now :
+
+```
+sage: X = SchubertPolynomialRing(QQ)
+sage: X._element_constructor_([1,2,1])
+Traceback (most recent call last):
+...
+ValueError: The input [1, 2, 1] is not a valid permutation
+sage: X._element_constructor_(Permutation([1,2,1]))
+Traceback (most recent call last):
+...
+ValueError: The input [1, 2, 1] is not a valid permutation
+
+```
+Tests have been added into the documentation.
+
+The patch is attached to the ticket and also available into Sage-Combinat
 
 Issue created by migration from https://trac.sagemath.org/ticket/12924
 
```




---

archive/issue_comments_162343.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [trac_12924-doc_fix.patch](tarball://root/attachments/some-uuid/ticket12924/trac_12924-doc_fix.patch) by @mwhansen created at 2012-07-31 22:18:29\n\nI've fixed some of the formatting.  If you're fine with these changes, you can mark this ticket as positive_review.",
    "created_at": "2012-07-31T22:18:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162343",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:3'></a>Attachment [trac_12924-doc_fix.patch](tarball://root/attachments/some-uuid/ticket12924/trac_12924-doc_fix.patch) by @mwhansen created at 2012-07-31 22:18:29

I've fixed some of the formatting.  If you're fine with these changes, you can mark this ticket as positive_review.



---

archive/issue_comments_162344.json:
```json
{
    "body": "<a id='comment:4'></a>It's ok with me ! Thank's for the review",
    "created_at": "2012-08-02T02:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162344",
    "user": "https://github.com/VivianePons"
}
```

<a id='comment:4'></a>It's ok with me ! Thank's for the review



---

archive/issue_comments_162345.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-02T02:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162345",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_162346.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-12T18:59:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-162346",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_035331.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-12T18:59:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12924#event-35331"
}
```
