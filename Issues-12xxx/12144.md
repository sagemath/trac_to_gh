# Issue 12144: better document a technical confusing point in the Hidden Markov Model code

archive/issues_011972.json:
```json
{
    "body": "I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  \n\nThere is small change in the code itself, where I had checked for \"0\" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. \n\nSee all #12146 for feature enhancements. \n\nAssignee: amhou\n\nResolution: fixed\n\nAuthor: William Stein\n\nReviewer: Jason Grout\n\nMerged: sage-5.0.beta3\n\nIssue created by migration from https://trac.sagemath.org/ticket/12144\n\n",
    "closed_at": "2012-02-06T21:25:40Z",
    "created_at": "2011-12-11T22:17:43Z",
    "labels": [
        "component: statistics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "better document a technical confusing point in the Hidden Markov Model code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12144",
    "user": "https://github.com/williamstein"
}
```
I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  

There is small change in the code itself, where I had checked for "0" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. 

See all #12146 for feature enhancements. 

Assignee: amhou

Resolution: fixed

Author: William Stein

Reviewer: Jason Grout

Merged: sage-5.0.beta3

Issue created by migration from https://trac.sagemath.org/ticket/12144





---

archive/issue_comments_169277.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-12-11T22:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169277",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_169278.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-12T06:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169278",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_169279.json:
```json
{
    "body": "Attachment [trac_12144.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.patch) by @williamstein created at 2011-12-12 06:30:45\n\nshould apply to any sage since about sage-4.0",
    "created_at": "2011-12-12T06:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169279",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_12144.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.patch) by @williamstein created at 2011-12-12 06:30:45

should apply to any sage since about sage-4.0



---

archive/issue_comments_169280.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-12T06:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169280",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_169281.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  \n \n-There is also a 1-line very tiny change in the code itself, where I had checked for \"0\" instead of checking for smaller than eps in one line.   This changes a few low order bits in a doctest. \n+There is small change in the code itself, where I had checked for \"0\" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. \n+\n+See all #12146 for feature enhancements. \n``````\n",
    "created_at": "2011-12-12T06:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169281",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  
 
-There is also a 1-line very tiny change in the code itself, where I had checked for "0" instead of checking for smaller than eps in one line.   This changes a few low order bits in a doctest. 
+There is small change in the code itself, where I had checked for "0" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. 
+
+See all #12146 for feature enhancements. 
``````




---

archive/issue_comments_169282.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jason Grout\"",
    "created_at": "2011-12-13T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169282",
    "user": "https://github.com/jasongrout"
}
```

Changing reviewer from "" to "Jason Grout"



---

archive/issue_comments_169283.json:
```json
{
    "body": "<a id='comment:5'></a>Thanks for the doc clarifications, and the math changes make sense, though I'm certainly not a HMM expert, so I don't know how to judge the idea that the changes are more useful.  However, it does apply and passes tests, so if this \"review\" is enough, set this to positive review.",
    "created_at": "2011-12-13T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169283",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>Thanks for the doc clarifications, and the math changes make sense, though I'm certainly not a HMM expert, so I don't know how to judge the idea that the changes are more useful.  However, it does apply and passes tests, so if this "review" is enough, set this to positive review.



---

archive/issue_comments_169284.json:
```json
{
    "body": "Changing author from \"\" to \"William Stein\"",
    "created_at": "2011-12-13T16:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169284",
    "user": "https://github.com/jasongrout"
}
```

Changing author from "" to "William Stein"



---

archive/issue_comments_169285.json:
```json
{
    "body": "<a id='comment:7'></a>No one else has looked at this, so I guess my review will stand.  Positive review, and thanks for the work!",
    "created_at": "2012-01-17T23:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169285",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>No one else has looked at this, so I guess my review will stand.  Positive review, and thanks for the work!



---

archive/issue_comments_169286.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-01-17T23:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169286",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_032286.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:11:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-32286"
}
```



---

archive/issue_comments_169287.json:
```json
{
    "body": "<a id='comment:9'></a>I get a numerical noise doctest error against sage-5.0.beta1.  I lost the exact doctest error, but it's something trivial.",
    "created_at": "2012-01-22T21:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169287",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>I get a numerical noise doctest error against sage-5.0.beta1.  I lost the exact doctest error, but it's something trivial.



---

archive/issue_comments_169288.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-01-22T21:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169288",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_169289.json:
```json
{
    "body": "Attachment [trac_12144.2.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.2.patch) by @williamstein created at 2012-01-24 06:37:52\n\napply only this; fixes the noise issue (I hope)",
    "created_at": "2012-01-24T06:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169289",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_12144.2.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.2.patch) by @williamstein created at 2012-01-24 06:37:52

apply only this; fixes the noise issue (I hope)



---

archive/issue_comments_169290.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-24T06:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169290",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_169291.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-01-29T23:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169291",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_169292.json:
```json
{
    "body": "<a id='comment:12'></a>There is still numerical noise on 32-bit systems:\n\n```\nsage -t  --long -force_lib devel/sage/sage/stats/hmm/chmm.pyx\n**********************************************************************\nFile \"/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.0.beta2/devel/sage-main/sage/stats/hmm/chmm.pyx\", line 1354:\n    sage: m.baum_welch(v, min_sd=1)\nExpected:\n    (-12.617885761692419, 1000)\nGot:\n    (-12.617885761692417, 1000)\n**********************************************************************\n```",
    "created_at": "2012-02-01T10:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169292",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>There is still numerical noise on 32-bit systems:

```
sage -t  --long -force_lib devel/sage/sage/stats/hmm/chmm.pyx
**********************************************************************
File "/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.0.beta2/devel/sage-main/sage/stats/hmm/chmm.pyx", line 1354:
    sage: m.baum_welch(v, min_sd=1)
Expected:
    (-12.617885761692419, 1000)
Got:
    (-12.617885761692417, 1000)
**********************************************************************
```



---

archive/issue_comments_169293.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-02-01T10:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169293",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_169294.json:
```json
{
    "body": "Attachment [trac_12144.3.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.3.patch) by @williamstein created at 2012-02-02 13:57:03\n\napply only this; fixes final numerical noise issue ?",
    "created_at": "2012-02-02T13:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169294",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_12144.3.patch](tarball://root/attachments/some-uuid/ticket12144/trac_12144.3.patch) by @williamstein created at 2012-02-02 13:57:03

apply only this; fixes final numerical noise issue ?



---

archive/issue_comments_169295.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-02T13:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169295",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_169296.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-02-02T14:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169296",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_169297.json:
```json
{
    "body": "<a id='comment:14'></a>All tests in the file still pass for me; positive review.  I see that the doctest above is fixed as well so it should pass.",
    "created_at": "2012-02-02T14:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169297",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:14'></a>All tests in the file still pass for me; positive review.  I see that the doctest above is fixed as well so it should pass.



---

archive/issue_comments_169298.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-02-06T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169298",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_032287.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-06T21:25:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-32287"
}
```



---

archive/issue_comments_169299.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.0.beta3\"",
    "created_at": "2012-02-06T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-169299",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.0.beta3"
