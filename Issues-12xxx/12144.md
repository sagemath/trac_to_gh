# Issue 12144: better document a technical confusing point in the Hidden Markov Model code

archive/issues_011972.json:
```json
{
    "body": "I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  \n\nThere is small change in the code itself, where I had checked for \"0\" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. \n\nSee all #12146 for feature enhancements. \n\n**Assignee:** amhou\n\n**Author:** William Stein\n\n**Reviewer:** Jason Grout\n\n**Merged:** sage-5.0.beta3\n\nIssue created by migration from https://trac.sagemath.org/ticket/12144\n\n",
    "closed_at": "2012-02-06T21:25:40Z",
    "created_at": "2011-12-11T22:17:43Z",
    "labels": [
        "component: statistics",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "better document a technical confusing point in the Hidden Markov Model code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12144",
    "user": "https://github.com/williamstein"
}
```
I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  

There is small change in the code itself, where I had checked for "0" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. 

See all #12146 for feature enhancements. 

**Assignee:** amhou

**Author:** William Stein

**Reviewer:** Jason Grout

**Merged:** sage-5.0.beta3

Issue created by migration from https://trac.sagemath.org/ticket/12144





---

archive/issue_events_100916.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-11T22:18:06Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "rename": {
        "from": "better document a technical confusing points in the Hidden Markov Model code",
        "to": "better document a technical confusing point in the Hidden Markov Model code"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100916"
}
```



---

archive/issue_events_100917.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-11T22:19:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100917"
}
```



---

archive/issue_events_100918.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-12T06:00:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100918"
}
```



---

archive/issue_events_100919.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-12T06:00:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100919"
}
```



---

archive/attachments_016189.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12144.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12144/trac_12144.patch",
    "created_at": "2011-12-12T06:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/williamstein"
}
```



---

archive/issue_comments_133943.json:
```json
{
    "body": "should apply to any sage since about sage-4.0",
    "created_at": "2011-12-12T06:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133943",
    "user": "https://github.com/williamstein"
}
```

should apply to any sage since about sage-4.0



---

archive/issue_events_100920.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-12T06:32:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100920"
}
```



---

archive/issue_events_100921.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-12T06:32:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100921"
}
```



---

archive/issue_comments_133944.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  \n \n-There is also a 1-line very tiny change in the code itself, where I had checked for \"0\" instead of checking for smaller than eps in one line.   This changes a few low order bits in a doctest. \n+There is small change in the code itself, where I had checked for \"0\" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. \n+\n+See all #12146 for feature enhancements. \n``````\n",
    "created_at": "2011-12-12T06:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133944",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 I was reading the Continuous Hidden Markov Model code and trying to understand how probabilities are defined in a certain context, and got confused.   So I added some comments to de-confuse me.  Hence this patch.  
 
-There is also a 1-line very tiny change in the code itself, where I had checked for "0" instead of checking for smaller than eps in one line.   This changes a few low order bits in a doctest. 
+There is small change in the code itself, where I had checked for "0" instead of checking for smaller than min_sd in one line.   This makes the code (1) work much better with actual real world examples, and (2) is consistent with the old ghmm C library from sage-3.x that this code was supposed to replace. 
+
+See all #12146 for feature enhancements. 
``````




---

archive/issue_comments_133945.json:
```json
{
    "body": "**Reviewer:** Jason Grout",
    "created_at": "2011-12-13T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133945",
    "user": "https://github.com/jasongrout"
}
```

**Reviewer:** Jason Grout



---

archive/issue_comments_133946.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the doc clarifications, and the math changes make sense, though I'm certainly not a HMM expert, so I don't know how to judge the idea that the changes are more useful.  However, it does apply and passes tests, so if this \"review\" is enough, set this to positive review.",
    "created_at": "2011-12-13T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133946",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>
Thanks for the doc clarifications, and the math changes make sense, though I'm certainly not a HMM expert, so I don't know how to judge the idea that the changes are more useful.  However, it does apply and passes tests, so if this "review" is enough, set this to positive review.



---

archive/issue_comments_133947.json:
```json
{
    "body": "**Author:** William Stein",
    "created_at": "2011-12-13T16:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133947",
    "user": "https://github.com/jasongrout"
}
```

**Author:** William Stein



---

archive/issue_comments_133948.json:
```json
{
    "body": "<a id='comment:7'></a>\nNo one else has looked at this, so I guess my review will stand.  Positive review, and thanks for the work!",
    "created_at": "2012-01-17T23:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133948",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>
No one else has looked at this, so I guess my review will stand.  Positive review, and thanks for the work!



---

archive/issue_events_100922.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-17T23:30:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100922"
}
```



---

archive/issue_events_100923.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-17T23:30:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100923"
}
```



---

archive/issue_events_100924.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:11:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100924"
}
```



---

archive/issue_events_100925.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:11:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100925"
}
```



---

archive/issue_comments_133949.json:
```json
{
    "body": "<a id='comment:9'></a>\nI get a numerical noise doctest error against sage-5.0.beta1.  I lost the exact doctest error, but it's something trivial.",
    "created_at": "2012-01-22T21:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133949",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
I get a numerical noise doctest error against sage-5.0.beta1.  I lost the exact doctest error, but it's something trivial.



---

archive/issue_events_100926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-22T21:22:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100926"
}
```



---

archive/issue_events_100927.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-22T21:22:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100927"
}
```



---

archive/attachments_016190.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12144.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12144/trac_12144.2.patch",
    "created_at": "2012-01-24T06:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/williamstein"
}
```



---

archive/issue_comments_133950.json:
```json
{
    "body": "apply only this; fixes the noise issue (I hope)",
    "created_at": "2012-01-24T06:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133950",
    "user": "https://github.com/williamstein"
}
```

apply only this; fixes the noise issue (I hope)



---

archive/issue_events_100928.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-24T06:38:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100928"
}
```



---

archive/issue_events_100929.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-24T06:38:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100929"
}
```



---

archive/issue_events_100930.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-29T23:35:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100930"
}
```



---

archive/issue_events_100931.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-29T23:35:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100931"
}
```



---

archive/issue_comments_133951.json:
```json
{
    "body": "<a id='comment:12'></a>\nThere is still numerical noise on 32-bit systems:\n\n```\nsage -t  --long -force_lib devel/sage/sage/stats/hmm/chmm.pyx\n**********************************************************************\nFile \"/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.0.beta2/devel/sage-main/sage/stats/hmm/chmm.pyx\", line 1354:\n    sage: m.baum_welch(v, min_sd=1)\nExpected:\n    (-12.617885761692419, 1000)\nGot:\n    (-12.617885761692417, 1000)\n**********************************************************************\n```",
    "created_at": "2012-02-01T10:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133951",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
There is still numerical noise on 32-bit systems:

```
sage -t  --long -force_lib devel/sage/sage/stats/hmm/chmm.pyx
**********************************************************************
File "/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.0.beta2/devel/sage-main/sage/stats/hmm/chmm.pyx", line 1354:
    sage: m.baum_welch(v, min_sd=1)
Expected:
    (-12.617885761692419, 1000)
Got:
    (-12.617885761692417, 1000)
**********************************************************************
```



---

archive/issue_events_100932.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-01T10:04:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100932"
}
```



---

archive/issue_events_100933.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-01T10:04:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100933"
}
```



---

archive/attachments_016191.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12144.3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12144/trac_12144.3.patch",
    "created_at": "2012-02-02T13:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/williamstein"
}
```



---

archive/issue_comments_133952.json:
```json
{
    "body": "apply only this; fixes final numerical noise issue ?",
    "created_at": "2012-02-02T13:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133952",
    "user": "https://github.com/williamstein"
}
```

apply only this; fixes final numerical noise issue ?



---

archive/issue_events_100934.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-02-02T13:57:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100934"
}
```



---

archive/issue_events_100935.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-02-02T13:57:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100935"
}
```



---

archive/issue_events_100936.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-02-02T14:04:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100936"
}
```



---

archive/issue_events_100937.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-02-02T14:04:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100937"
}
```



---

archive/issue_comments_133953.json:
```json
{
    "body": "<a id='comment:14'></a>\nAll tests in the file still pass for me; positive review.  I see that the doctest above is fixed as well so it should pass.",
    "created_at": "2012-02-02T14:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133953",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:14'></a>
All tests in the file still pass for me; positive review.  I see that the doctest above is fixed as well so it should pass.



---

archive/issue_events_100938.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-06T21:25:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100938"
}
```



---

archive/issue_events_100939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-06T21:25:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12144#event-100939"
}
```



---

archive/issue_comments_133954.json:
```json
{
    "body": "**Merged:** sage-5.0.beta3",
    "created_at": "2012-02-06T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12144#issuecomment-133954",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta3
