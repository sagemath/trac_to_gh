# Issue 12129: MPolynomial_libsingular.is_squarefree fails with linear factors

archive/issues_011957.json:
```json
{
    "body": "\n```\nsage: x, y = QQ['x','y'].gens()\nsage: f = x*y\nsage: f.is_squarefree()\nFalse\nsage: f = (x+y)*(x+3)\nsage: f.is_squarefree()\nFalse\n```\n\nThis may be related to an inconsistency in the Singular sqrfree function, which sometimes includes a unit in the square free factorization, but other times does not.\n\n**Assignee:** @aghitza\n\n**CC:**  jakobkroeker\n\n**Keywords:** square free\n\n**Branch:** [u/cremona/12129](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/12129)\n\n**Commit:** [17fdcc12d73b82446e8122cb3e0de3fbcb1671ba](https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba)\n\n**Stopgaps:** todo\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Paul Zimmermann, John Cremona\n\nIssue created by migration from https://trac.sagemath.org/ticket/12129\n\n",
    "closed_at": "2017-12-12T08:23:33Z",
    "created_at": "2011-12-09T03:17:27Z",
    "labels": [
        "component: algebra",
        "bug",
        "wontfix"
    ],
    "title": "MPolynomial_libsingular.is_squarefree fails with linear factors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12129",
    "user": "https://github.com/culler"
}
```

```
sage: x, y = QQ['x','y'].gens()
sage: f = x*y
sage: f.is_squarefree()
False
sage: f = (x+y)*(x+3)
sage: f.is_squarefree()
False
```

This may be related to an inconsistency in the Singular sqrfree function, which sometimes includes a unit in the square free factorization, but other times does not.

**Assignee:** @aghitza

**CC:**  jakobkroeker

**Keywords:** square free

**Branch:** [u/cremona/12129](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/12129)

**Commit:** [17fdcc12d73b82446e8122cb3e0de3fbcb1671ba](https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba)

**Stopgaps:** todo

**Reviewer:** Travis Scrimshaw

**Author:** Paul Zimmermann, John Cremona

Issue created by migration from https://trac.sagemath.org/ticket/12129





---

archive/issue_comments_133638.json:
```json
{
    "body": "<a id='comment:1'></a>\nsee also #12198 and #12404. Maybe some of those tickets can be removed as duplicate.\n\nPaul",
    "created_at": "2012-05-11T07:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133638",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:1'></a>
see also #12198 and #12404. Maybe some of those tickets can be removed as duplicate.

Paul



---

archive/issue_events_100750.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100750"
}
```



---

archive/issue_events_100751.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100751"
}
```



---

archive/issue_events_100752.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100752"
}
```



---

archive/issue_events_100753.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100753"
}
```



---

archive/issue_events_100754.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100754"
}
```



---

archive/issue_events_100755.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100755"
}
```



---

archive/issue_events_100756.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100756"
}
```



---

archive/issue_events_100757.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100757"
}
```



---

archive/issue_comments_133639.json:
```json
{
    "body": "**Stopgaps:** todo",
    "created_at": "2015-08-25T16:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133639",
    "user": "https://trac.sagemath.org/admin/accounts/users/jakobkroeker"
}
```

**Stopgaps:** todo



---

archive/issue_comments_133640.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis can surely be closed as the examples posted are now computed correctly.  Same as at #12198.",
    "created_at": "2017-11-12T13:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133640",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>
This can surely be closed as the examples posted are now computed correctly.  Same as at #12198.



---

archive/issue_events_100758.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T00:54:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100758"
}
```



---

archive/issue_events_100759.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T00:54:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100759"
}
```



---

archive/issue_comments_133641.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2017-11-13T00:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133641",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_events_100760.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T00:54:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100760"
}
```



---

archive/issue_events_100761.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T00:54:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100761"
}
```



---

archive/issue_events_100762.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T00:54:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100762"
}
```



---

archive/issue_comments_133642.json:
```json
{
    "body": "<a id='comment:11'></a>\nshouldn't we include a non-regression test?",
    "created_at": "2017-11-13T06:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133642",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:11'></a>
shouldn't we include a non-regression test?



---

archive/issue_comments_133643.json:
```json
{
    "body": "<a id='comment:12'></a>\nI am not opposed. Feel free to use this ticket for that.",
    "created_at": "2017-11-13T06:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133643",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
I am not opposed. Feel free to use this ticket for that.



---

archive/issue_comments_133644.json:
```json
{
    "body": "<a id='comment:13'></a>\nhere is a corresponding patch:\n\n```\n--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n@@ -4734,6 +4734,18 @@ cdef class MPolynomial_libsingular(MPolynomial):\n             sage: h = f^2\n             sage: h.is_squarefree()\n             False\n+\n+        TESTS::\n+\n+Check if :trac:`12129` is fixed::\n+\n+            sage: x, y = QQ['x','y'].gens()\n+            sage: f = x*y\n+            sage: f.is_squarefree()\n+            True\n+            sage: f = (x+y)*(x+3)\n+            sage: f.is_squarefree()\n+            True\n         \"\"\"\n         # TODO:  Use Singular (4.x) intrinsics.  (Temporary solution from #17254.)\n         return all([ e == 1 for (f, e) in self.factor() ])\n```",
    "created_at": "2017-11-13T08:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133644",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:13'></a>
here is a corresponding patch:

```
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -4734,6 +4734,18 @@ cdef class MPolynomial_libsingular(MPolynomial):
             sage: h = f^2
             sage: h.is_squarefree()
             False
+
+        TESTS::
+
+Check if :trac:`12129` is fixed::
+
+            sage: x, y = QQ['x','y'].gens()
+            sage: f = x*y
+            sage: f.is_squarefree()
+            True
+            sage: f = (x+y)*(x+3)
+            sage: f.is_squarefree()
+            True
         """
         # TODO:  Use Singular (4.x) intrinsics.  (Temporary solution from #17254.)
         return all([ e == 1 for (f, e) in self.factor() ])
```



---

archive/issue_comments_133645.json:
```json
{
    "body": "<a id='comment:14'></a>\nI agree that tests should be added, both here and at #12198, but was a little too lazy to do it myself.",
    "created_at": "2017-11-13T09:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133645",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:14'></a>
I agree that tests should be added, both here and at #12198, but was a little too lazy to do it myself.



---

archive/issue_events_100763.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-11-13T09:41:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100763"
}
```



---

archive/issue_events_100764.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-11-13T09:41:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100764"
}
```



---

archive/issue_comments_133646.json:
```json
{
    "body": "<a id='comment:15'></a>\nTravis could you re-review this?  I thought that this doctest would do for both tickets.  Thanks.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba\">17fdcc1</a></td><td><code>#12129: add doctest to show issue has been fixed</code></td></tr></table>\n",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133646",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
Travis could you re-review this?  I thought that this doctest would do for both tickets.  Thanks.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba">17fdcc1</a></td><td><code>#12129: add doctest to show issue has been fixed</code></td></tr></table>




---

archive/issue_comments_133647.json:
```json
{
    "body": "**Author:** Paul Zimmermann, John Cremona",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133647",
    "user": "https://github.com/JohnCremona"
}
```

**Author:** Paul Zimmermann, John Cremona



---

archive/issue_comments_133648.json:
```json
{
    "body": "**Branch:** [u/cremona/12129](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/12129)",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133648",
    "user": "https://github.com/JohnCremona"
}
```

**Branch:** [u/cremona/12129](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/12129)



---

archive/issue_comments_133649.json:
```json
{
    "body": "**Commit:** [17fdcc12d73b82446e8122cb3e0de3fbcb1671ba](https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba)",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133649",
    "user": "https://github.com/JohnCremona"
}
```

**Commit:** [17fdcc12d73b82446e8122cb3e0de3fbcb1671ba](https://github.com/sagemath/sagetrac-mirror/commit/17fdcc12d73b82446e8122cb3e0de3fbcb1671ba)



---

archive/issue_events_100765.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T10:41:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100765"
}
```



---

archive/issue_events_100766.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-11-13T10:41:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100766"
}
```



---

archive/issue_comments_133650.json:
```json
{
    "body": "<a id='comment:16'></a>\nI was also a little too lazy to do it as well. `^^;;` Thanks Paul and John.",
    "created_at": "2017-11-13T10:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12129#issuecomment-133650",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>
I was also a little too lazy to do it as well. `^^;;` Thanks Paul and John.



---

archive/issue_events_100767.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100767"
}
```



---

archive/issue_events_100768.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100768"
}
```



---

archive/issue_events_100769.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12129",
    "label": "wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12129#event-100769"
}
```
