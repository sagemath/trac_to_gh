# Issue 12372: maxima.eval('1+1;;') hangs

archive/issues_012200.json:
```json
{
    "assignees": [],
    "body": "\n```\nmaxima.eval('1+1;;')\n``` \nhangs Sage. Now, this *is* a syntax error\n\n```\n\n(%i4) 1+1;;\n\n(%o4) 2\n\nstdin:76667:incorrect syntax: Premature termination of input at ;.\n;\n ^\n```\nbut at least we should fail gracefully, and maybe even give an answer.  \n\nThis was first reported at #8439, and separated from it.\n\nAssignee: **@williamstein**\n\nCC:  @orlitzky @nbruin @dimpase\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12372_\n\n",
    "created_at": "2012-01-28T03:03:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "maxima.eval('1+1;;') hangs",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/12372",
    "user": "https://github.com/kcrisman"
}
```

```
maxima.eval('1+1;;')
``` 
hangs Sage. Now, this *is* a syntax error

```

(%i4) 1+1;;

(%o4) 2

stdin:76667:incorrect syntax: Premature termination of input at ;.
;
 ^
```
but at least we should fail gracefully, and maybe even give an answer.  

This was first reported at #8439, and separated from it.

Assignee: **@williamstein**

CC:  @orlitzky @nbruin @dimpase

_Issue created by migration from https://trac.sagemath.org/ticket/12372_





---

archive/issue_events_149082.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-01-28T03:03:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149082"
}
```



---

archive/issue_events_149083.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-01-28T03:03:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149083"
}
```



---

archive/issue_events_149084.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-01-28T03:03:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149084"
}
```



---

archive/issue_events_149085.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-01-28T03:03:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149085"
}
```



---

archive/issue_comments_137286.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nOne way of looking at this example is that it's two commands: A grammatical and an erroneous one. The pexpect interface for maxima does not seem to support parsing the output of multiple commands:\n\n```\nsage: maxima.eval(\"1+2;3+4;\")\n'3(%o17)7'\n```\nonly a little better:\n\n```\nsage: from sage.interfaces.maxima_lib import maxima\nsage: sage: maxima.eval(\"1+2;3+4;\")\n'37'\nsage: maxima.eval(\"1+2;;\")\n'3'\n```\nThis could be as easy as replacing \";<any whitespace>*;\" by \";\", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.",
    "created_at": "2012-01-28T03:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137286",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:1'>Comment 1:</a>
One way of looking at this example is that it's two commands: A grammatical and an erroneous one. The pexpect interface for maxima does not seem to support parsing the output of multiple commands:

```
sage: maxima.eval("1+2;3+4;")
'3(%o17)7'
```
only a little better:

```
sage: from sage.interfaces.maxima_lib import maxima
sage: sage: maxima.eval("1+2;3+4;")
'37'
sage: maxima.eval("1+2;;")
'3'
```
This could be as easy as replacing ";<any whitespace>*;" by ";", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.



---

archive/issue_comments_137287.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\n> This could be as easy as replacing \";<any whitespace>*;\" by \";\", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.\n\nGood point, but I figured I might as well open the ticket :)",
    "created_at": "2012-01-28T03:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137287",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'>Comment 2:</a>
> This could be as easy as replacing ";<any whitespace>*;" by ";", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.

Good point, but I figured I might as well open the ticket :)



---

archive/issue_comments_137288.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nReplying to [@kcrisman](#comment%3A2):t\n> > This could be as easy as replacing \";<any whitespace>*;\" by \";\", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.\n\n> Good point, but I figured I might as well open the ticket :)\n\nCareful not to do that replace inside of string literals.",
    "created_at": "2012-01-28T05:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137288",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'>Comment 3:</a>
Replying to [@kcrisman](#comment%3A2):t
> > This could be as easy as replacing ";<any whitespace>*;" by ";", but I'm not sure the slow-down of the extra regex is worth catching this corner-case.

> Good point, but I figured I might as well open the ticket :)

Careful not to do that replace inside of string literals.



---

archive/issue_comments_137289.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nStill hanging after 8 years",
    "created_at": "2020-07-08T16:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137289",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>Comment 4:</a>
Still hanging after 8 years



---

archive/issue_events_149086.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T16:37:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149086"
}
```



---

archive/issue_comments_137290.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nNot that important because there's a better interface to maxima now:\n\n```\nsage: from sage.interfaces.maxima_lib import maxima_lib\nsage: maxima_lib.eval(\"1+1;;\")\n'2'\n```",
    "created_at": "2020-07-08T17:05:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137290",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:5'>Comment 5:</a>
Not that important because there's a better interface to maxima now:

```
sage: from sage.interfaces.maxima_lib import maxima_lib
sage: maxima_lib.eval("1+1;;")
'2'
```



---

archive/issue_events_149087.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149087"
}
```



---

archive/issue_events_149088.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149088"
}
```



---

archive/issue_events_149089.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149089"
}
```



---

archive/issue_events_149090.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149090"
}
```



---

archive/issue_comments_137291.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-04-07T19:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12372#issuecomment-137291",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>Comment 7:</a>
Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_149091.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149091"
}
```



---

archive/issue_events_149092.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149092"
}
```



---

archive/issue_events_149093.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149093"
}
```



---

archive/issue_events_149094.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149094"
}
```



---

archive/issue_events_149095.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149095"
}
```



---

archive/issue_events_149096.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149096"
}
```



---

archive/issue_events_149097.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149097"
}
```



---

archive/issue_events_149098.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12372",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12372#event-149098"
}
```
