# Issue 12940: Combinatorial implementation of the affine symmetric group

archive/issues_012768.json:
```json
{
    "assignees": [],
    "body": "This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.\n\nApply:\n- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)\n\n\nDepends on #14673\nDepends on #8392\n\nAssignee: **tom denton**\n\nCC:  @nthiery @anneschilling chrisjamesberg\n\nKeywords: **affine, combinatorics, days38, days49**\n\nReviewer: **Chris Berg, Anne Schilling**\n\nAuthor: **Tom Denton**\n\nMerged: **sage-5.11.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12940_\n\n",
    "closed_at": "2013-07-31T12:53:26Z",
    "created_at": "2012-05-11T19:25:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.11",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Combinatorial implementation of the affine symmetric group",
    "type": "issue",
    "updated_at": "2013-07-31T12:53:26Z",
    "url": "https://github.com/sagemath/sage/issues/12940",
    "user": "https://github.com/sdenton4"
}
```
This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.

Apply:
- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)


Depends on #14673
Depends on #8392

Assignee: **tom denton**

CC:  @nthiery @anneschilling chrisjamesberg

Keywords: **affine, combinatorics, days38, days49**

Reviewer: **Chris Berg, Anne Schilling**

Author: **Tom Denton**

Merged: **sage-5.11.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/12940_





---

archive/issue_events_158181.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2012-05-11T19:25:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158181"
}
```



---

archive/issue_events_158182.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2012-05-11T19:25:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158182"
}
```



---

archive/issue_events_158183.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2012-05-11T19:25:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158183"
}
```



---

archive/issue_comments_148853.json:
```json
{
    "body": "Attachment: **[affine_permutations.pyx.gz](https://github.com/sagemath/sage/files/ticket12940/affine_permutations.pyx.gz)**\n\naffine permutations class.  (Attach this first, if testing.)",
    "created_at": "2012-05-11T19:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148853",
    "user": "https://github.com/sdenton4"
}
```

Attachment: **[affine_permutations.pyx.gz](https://github.com/sagemath/sage/files/ticket12940/affine_permutations.pyx.gz)**

affine permutations class.  (Attach this first, if testing.)



---

archive/issue_comments_148854.json:
```json
{
    "body": "Attachment: **[affine_symmetric_group.py.gz](https://github.com/sagemath/sage/files/ticket12940/affine_symmetric_group.py.gz)**\n\nAffine symmetric group class file.",
    "created_at": "2012-05-11T19:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148854",
    "user": "https://github.com/sdenton4"
}
```

Attachment: **[affine_symmetric_group.py.gz](https://github.com/sagemath/sage/files/ticket12940/affine_symmetric_group.py.gz)**

Affine symmetric group class file.



---

archive/issue_events_158184.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2012-05-17T18:47:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158184"
}
```



---

archive/issue_comments_148855.json:
```json
{
    "body": "Attachment: **[affine_permutations.py.gz](https://github.com/sagemath/sage/files/ticket12940/affine_permutations.py.gz)**",
    "created_at": "2012-05-17T18:48:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148855",
    "user": "https://github.com/sdenton4"
}
```

Attachment: **[affine_permutations.py.gz](https://github.com/sagemath/sage/files/ticket12940/affine_permutations.py.gz)**



---

archive/issue_comments_148856.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nRemoved the cython-ified version of the affine permutations class as it was creating issues, and wasn't really improving run times that much.  Made numerous algorithm improvements, though; the patch is now int he sage-combinat queue as well.",
    "created_at": "2012-05-17T18:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148856",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:2'>Comment 2:</a>
Removed the cython-ified version of the affine permutations class as it was creating issues, and wasn't really improving run times that much.  Made numerous algorithm improvements, though; the patch is now int he sage-combinat queue as well.



---

archive/issue_comments_148857.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nHi Tom,\n\nIt looks like that Affine Permutations really need to be integrated into the sage file system. At the moment this seems to be a stand-alone patch!\n\nBest,\n\nAnne",
    "created_at": "2012-08-25T04:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148857",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:3'>Comment 3:</a>
Hi Tom,

It looks like that Affine Permutations really need to be integrated into the sage file system. At the moment this seems to be a stand-alone patch!

Best,

Anne



---

archive/issue_comments_148858.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nOk, at long last, I've fixed up the sage combinat patch and exported; it's the attachment above.  It should also patch the sage files that point out that the new directory and file exist!",
    "created_at": "2012-10-07T13:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148858",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:4'>Comment 4:</a>
Ok, at long last, I've fixed up the sage combinat patch and exported; it's the attachment above.  It should also patch the sage files that point out that the new directory and file exist!



---

archive/issue_comments_148859.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nHi Tom,\n\nCould we entice you to add a to_core method? Also, some of your documentation using INPUT: etc is not standard and needs to be fixed. And ... please put your patch on the sage-combinat queue.\n\nCheers,\n\nAnne",
    "created_at": "2012-10-08T05:23:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148859",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:5'>Comment 5:</a>
Hi Tom,

Could we entice you to add a to_core method? Also, some of your documentation using INPUT: etc is not standard and needs to be fixed. And ... please put your patch on the sage-combinat queue.

Cheers,

Anne



---

archive/issue_comments_148860.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nOk, changed the documentation, updated the patch in the combinat queue, and added some new functions.\n\nThere are two ways to pull a dominant element out of an affine permutation: one is to sort the Lehmer code, and the other is to write x=g*f, where g is dominant and f is finite type (0-parabolic).  The to_dominant method does the sorting, and the grassmannian_quotient() method returns the pair (g,f).  (Or (f,g) if you specify side='left'.)  I also put in a to_core method, which uses the sorting approach.  One can get the core for the quotient element by doing x.grassmannian_quotient()[0].to_core().\n\nBest,\n-tom",
    "created_at": "2012-10-16T08:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148860",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:6'>Comment 6:</a>
Ok, changed the documentation, updated the patch in the combinat queue, and added some new functions.

There are two ways to pull a dominant element out of an affine permutation: one is to sort the Lehmer code, and the other is to write x=g*f, where g is dominant and f is finite type (0-parabolic).  The to_dominant method does the sorting, and the grassmannian_quotient() method returns the pair (g,f).  (Or (f,g) if you specify side='left'.)  I also put in a to_core method, which uses the sorting approach.  One can get the core for the quotient element by doing x.grassmannian_quotient()[0].to_core().

Best,
-tom



---

archive/issue_comments_148861.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nHi Tom,\n\nWithout looking at the mathematics yet, here are some Sage specific requirements that your patch does not yet fulfill:\n\n- You need 100% coverage:\n\n```\n$affine_permutations anne$ sage -coverage affine_permutations.py \n----------------------------------------------------------------------\naffine_permutations.py\nERROR: Please add a `TestSuite(s).run()` doctest.\nSCORE affine_permutations.py: 95% (46 of 48)\n\nMissing doctests:\n\t * __init__(self, parent, lst, check=True):\n\t * random_element(self, n):\n\n\nPossibly wrong (function name doesn't occur in doctests):\n\t * _repr_(self):\n\t * check(self):\n\t * lower_covers(self,side=\"right\"):\n\t * _element_constructor_(self, *args, **keywords):\n\t * _repr_(self):\n\t * is_crystallographic(self):\n\t * _an_element_(self):\n```\n\n- The preamble of your patch needs to start with #12940: Title + then a summary of what this patch implements.\n\n- The indents of your tests are not right for many of your methods. You need\n\n```\n    EXAMPLES::\n\n        sage: ....\n```\nLook at your documentation by building it via \n\n```\nsage -docbuild reference html\n```\nI can already see many places where you forgot ` for math display such as in `\\ZZ`.\n\nSo much for now,\n\nAnne",
    "created_at": "2012-10-24T02:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148861",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:7'>Comment 7:</a>
Hi Tom,

Without looking at the mathematics yet, here are some Sage specific requirements that your patch does not yet fulfill:

- You need 100% coverage:

```
$affine_permutations anne$ sage -coverage affine_permutations.py 
----------------------------------------------------------------------
affine_permutations.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE affine_permutations.py: 95% (46 of 48)

Missing doctests:
	 * __init__(self, parent, lst, check=True):
	 * random_element(self, n):


Possibly wrong (function name doesn't occur in doctests):
	 * _repr_(self):
	 * check(self):
	 * lower_covers(self,side="right"):
	 * _element_constructor_(self, *args, **keywords):
	 * _repr_(self):
	 * is_crystallographic(self):
	 * _an_element_(self):
```

- The preamble of your patch needs to start with #12940: Title + then a summary of what this patch implements.

- The indents of your tests are not right for many of your methods. You need

```
    EXAMPLES::

        sage: ....
```
Look at your documentation by building it via 

```
sage -docbuild reference html
```
I can already see many places where you forgot ` for math display such as in `\ZZ`.

So much for now,

Anne



---

archive/issue_comments_148862.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nOk, fixed up the docs.  I hadn't seen the -coverage command before.  The ones that are giving warnings now are methods (like `_repr_`) that are implicitly called within the doc test for that function.\n\nI went through and fixed up latex parts by hand, and am still waiting on the documentation to build to really make a visual check...\n\nBest,\n-tom",
    "created_at": "2012-10-24T07:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148862",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:8'>Comment 8:</a>
Ok, fixed up the docs.  I hadn't seen the -coverage command before.  The ones that are giving warnings now are methods (like `_repr_`) that are implicitly called within the doc test for that function.

I went through and fixed up latex parts by hand, and am still waiting on the documentation to build to really make a visual check...

Best,
-tom



---

archive/issue_comments_148863.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThanks, tom. You can put #indirect doctest in the line after your test to calm the \n\n```\nsage -coverage\n```\ncommand, if the test indeed indirectly tests the method.\n\nAnne",
    "created_at": "2012-10-24T15:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148863",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:9'>Comment 9:</a>
Thanks, tom. You can put #indirect doctest in the line after your test to calm the 

```
sage -coverage
```
command, if the test indeed indirectly tests the method.

Anne



---

archive/issue_comments_148864.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nHi tom,\n\nSome more Sage comments:\n\n- Currently you have a directory in /sage/combinat called affine_permutations, but there is only one file in there, namely affine_permutations.py. Unless you forsee the addition of further file to break up the code, I would strongly suggest to get rid of the directory and just put affine_permutations.py in /sage/cominbat as is done for permutations, partitions etc..\n\n- For the documentation you need to put a link in /doc/en/reference/combinat\n\nBest,\n\nAnne",
    "created_at": "2012-10-24T16:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148864",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:10'>Comment 10:</a>
Hi tom,

Some more Sage comments:

- Currently you have a directory in /sage/combinat called affine_permutations, but there is only one file in there, namely affine_permutations.py. Unless you forsee the addition of further file to break up the code, I would strongly suggest to get rid of the directory and just put affine_permutations.py in /sage/cominbat as is done for permutations, partitions etc..

- For the documentation you need to put a link in /doc/en/reference/combinat

Best,

Anne



---

archive/issue_comments_148865.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nHi Tom!\n\nFor the directory structure, you may want to follow that of permutation groups. Something like:\n\n```\n    sage/groups/affine_permutation_groups/affine_permutation.py\n                                          affine_symmetric_group.py\n                                          affine_permutation_group.py\n```\n\nWhich just made me think: is there a way to generalize the algorithmic\nfor permutation groups (see\nhttp://en.wikipedia.org/wiki/Strong_generating_set) to subgroups of\nthe affine symmetric group? Hmm, if this hasn't been done yet, that\ncould be a fun research project. Of course, the obvious first\ncandidates to play with would be the affine coxeter groups realized as\ngroups of permutations as we had discussed in Montreal.\n\nCheers,\n                           Nicolas",
    "created_at": "2012-10-25T10:39:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148865",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:11'>Comment 11:</a>
Hi Tom!

For the directory structure, you may want to follow that of permutation groups. Something like:

```
    sage/groups/affine_permutation_groups/affine_permutation.py
                                          affine_symmetric_group.py
                                          affine_permutation_group.py
```

Which just made me think: is there a way to generalize the algorithmic
for permutation groups (see
http://en.wikipedia.org/wiki/Strong_generating_set) to subgroups of
the affine symmetric group? Hmm, if this hasn't been done yet, that
could be a fun research project. Of course, the obvious first
candidates to play with would be the affine coxeter groups realized as
groups of permutations as we had discussed in Montreal.

Cheers,
                           Nicolas



---

archive/issue_comments_148866.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nHello!\n\nI've been trying to get this expanded and finished up.  The following changes happened lately:\n\n* Changed the names of things to AffinePermutation and AffinePermutationGroup, because:\n* I added affine permutation groups of types ABCDG.  (E and F are in Eriksson, but are ugly; I want to think about whether there's a cleaner way to go about these ones.)\n* Everything is just in the file affine_permutations.py, which sits directly in sage/combinat\n\nI'm now getting a problem I can't figure out, though: Sage is refusing to import the AffinePermutationGroup name.  It doesn't seem to be previously defined, and when I disable all of the import statements I still get an error (so it can't be an import loop; also, nothing calls my file...).  I can manually attach the file just fine, too.\n\nI've stared at this a good long time and haven't been able to figure out what's going wrong...",
    "created_at": "2013-01-21T12:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148866",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:12'>Comment 12:</a>
Hello!

I've been trying to get this expanded and finished up.  The following changes happened lately:

* Changed the names of things to AffinePermutation and AffinePermutationGroup, because:
* I added affine permutation groups of types ABCDG.  (E and F are in Eriksson, but are ugly; I want to think about whether there's a cleaner way to go about these ones.)
* Everything is just in the file affine_permutations.py, which sits directly in sage/combinat

I'm now getting a problem I can't figure out, though: Sage is refusing to import the AffinePermutationGroup name.  It doesn't seem to be previously defined, and when I disable all of the import statements I still get an error (so it can't be an import loop; also, nothing calls my file...).  I can manually attach the file just fine, too.

I've stared at this a good long time and haven't been able to figure out what's going wrong...



---

archive/issue_comments_148867.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@sdenton4](#comment%3A12):\n> Hello!\n> \n> I've been trying to get this expanded and finished up.  The following changes happened lately:\n> \n> * Changed the names of things to AffinePermutation and AffinePermutationGroup, because:\n> * I added affine permutation groups of types ABCDG.  (E and F are in Eriksson, but are ugly; I want to think about whether there's a cleaner way to go about these ones.)\n> * Everything is just in the file affine_permutations.py, which sits directly in sage/combinat\n> \n> I'm now getting a problem I can't figure out, though: Sage is refusing to import the AffinePermutationGroup name.  It doesn't seem to be previously defined, and when I disable all of the import statements I still get an error (so it can't be an import loop; also, nothing calls my file...).  I can manually attach the file just fine, too.\n> \n> I've stared at this a good long time and haven't been able to figure out what's going wrong...\n\nAnne tries to write: Don't you mean non-twisted rather than non-exceptional? Type G is exceptional!",
    "created_at": "2013-01-22T09:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148867",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@sdenton4](#comment%3A12):
> Hello!
> 
> I've been trying to get this expanded and finished up.  The following changes happened lately:
> 
> * Changed the names of things to AffinePermutation and AffinePermutationGroup, because:
> * I added affine permutation groups of types ABCDG.  (E and F are in Eriksson, but are ugly; I want to think about whether there's a cleaner way to go about these ones.)
> * Everything is just in the file affine_permutations.py, which sits directly in sage/combinat
> 
> I'm now getting a problem I can't figure out, though: Sage is refusing to import the AffinePermutationGroup name.  It doesn't seem to be previously defined, and when I disable all of the import statements I still get an error (so it can't be an import loop; also, nothing calls my file...).  I can manually attach the file just fine, too.
> 
> I've stared at this a good long time and haven't been able to figure out what's going wrong...

Anne tries to write: Don't you mean non-twisted rather than non-exceptional? Type G is exceptional!



---

archive/issue_comments_148868.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nHi Tom,\n\nI just answered your question on sage-combinat. In short, you need to remove some old files left over from your /combinat/affine_permutations/ directory by hand since it gets confused about the file and the directory.\n\nAlso, to be consistent with permutation.py, core.py, etc, shouldn't your file be called affine_permutation.py (without the s)?\n\nIn the documentation of AffinePermuation you says\n\n```\n    These are combinatorial implmentations of the affine Weyl groups of\n    non-exceptional type as permutations of the set of all integers.\n    the basic algorithms are derived from Bjorner and Brenti's `Combinatorics\n    of Coxeter Groups.'\n```\n\nDon't you mean non-twisted rather than non-exceptional. Type G is exceptional!\n\nBest,\n\nAnne",
    "created_at": "2013-01-22T09:53:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148868",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:14'>Comment 14:</a>
Hi Tom,

I just answered your question on sage-combinat. In short, you need to remove some old files left over from your /combinat/affine_permutations/ directory by hand since it gets confused about the file and the directory.

Also, to be consistent with permutation.py, core.py, etc, shouldn't your file be called affine_permutation.py (without the s)?

In the documentation of AffinePermuation you says

```
    These are combinatorial implmentations of the affine Weyl groups of
    non-exceptional type as permutations of the set of all integers.
    the basic algorithms are derived from Bjorner and Brenti's `Combinatorics
    of Coxeter Groups.'
```

Don't you mean non-twisted rather than non-exceptional. Type G is exceptional!

Best,

Anne



---

archive/issue_comments_148869.json:
```json
{
    "body": "Replying to [ticket:12940 sdenton]:\n> This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  The basic idea should be easily extensible to the combinatorial interpretations of the other affine types with window notations, and I've discussed a bit with N. Thiery about hacking together a kind of window notation for the other types.",
    "created_at": "2013-02-10T20:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148869",
    "user": "https://github.com/sdenton4"
}
```

Replying to [ticket:12940 sdenton]:
> This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  The basic idea should be easily extensible to the combinatorial interpretations of the other affine types with window notations, and I've discussed a bit with N. Thiery about hacking together a kind of window notation for the other types.



---

archive/issue_comments_148870.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  The basic idea should be easily extensible to the combinatorial interpretations of the other affine types with window notations, and I've discussed a bit with N. Thiery about hacking together a kind of window notation for the other types.\n+This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.\n``````\n",
    "created_at": "2013-02-10T20:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148870",
    "user": "https://github.com/sdenton4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  The basic idea should be easily extensible to the combinatorial interpretations of the other affine types with window notations, and I've discussed a bit with N. Thiery about hacking together a kind of window notation for the other types.
+This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.
``````




---

archive/issue_comments_148871.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nRecent changes:\n* Moved everything into a single file, as per reviewer request\n* Expanded to include types affine A,B,C,D,G\n* added TestSuite runs, for better coverage\n* fixed a bug with apply_simple_reflection_left in Type G",
    "created_at": "2013-02-10T23:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148871",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:16'>Comment 16:</a>
Recent changes:
* Moved everything into a single file, as per reviewer request
* Expanded to include types affine A,B,C,D,G
* added TestSuite runs, for better coverage
* fixed a bug with apply_simple_reflection_left in Type G



---

archive/issue_comments_148872.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nAdded is_fully_commutative to type A.\nRebased to fix an issue with the new documentation system.",
    "created_at": "2013-03-17T20:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148872",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:17'>Comment 17:</a>
Added is_fully_commutative to type A.
Rebased to fix an issue with the new documentation system.



---

archive/issue_events_158185.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2013-03-17T20:37:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158185"
}
```



---

archive/issue_comments_148873.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nNicolas volunteered me to review the patch. =)\nI sent my comments directly to Tom. When he posts a new version, I can review that.\n\nChris",
    "created_at": "2013-03-24T16:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148873",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

<a id='comment:19'>Comment 19:</a>
Nicolas volunteered me to review the patch. =)
I sent my comments directly to Tom. When he posts a new version, I can review that.

Chris



---

archive/issue_comments_148874.json:
```json
{
    "body": "Reviewer: **Chris Berg**",
    "created_at": "2013-03-24T16:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148874",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

Reviewer: **Chris Berg**



---

archive/issue_comments_148875.json:
```json
{
    "body": "Dependencies: **#14673**",
    "created_at": "2013-06-01T17:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148875",
    "user": "https://github.com/tscrim"
}
```

Dependencies: **#14673**



---

archive/issue_comments_148876.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nThis will need to have a minor rebase over #14673.",
    "created_at": "2013-06-01T17:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148876",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'>Comment 20:</a>
This will need to have a minor rebase over #14673.



---

archive/issue_comments_148877.json:
```json
{
    "body": "Changed keywords from **affine, combinatorics, days38** to **affine, combinatorics, days38, days49**",
    "created_at": "2013-06-18T08:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148877",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

Changed keywords from **affine, combinatorics, days38** to **affine, combinatorics, days38, days49**



---

archive/issue_comments_148878.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nHi Tom,\n\nI think you need to rebase your patch on top of #8392. There is a conflict with the all.py file!\n\nAlso, would it be possible to explain the input of AffinePermutations in the header, since this is what the user will see if (s)he types AffinePermutations??.\n\nThank you!\n\nAnne",
    "created_at": "2013-06-18T08:53:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148878",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:22'>Comment 22:</a>
Hi Tom,

I think you need to rebase your patch on top of #8392. There is a conflict with the all.py file!

Also, would it be possible to explain the input of AffinePermutations in the header, since this is what the user will see if (s)he types AffinePermutations??.

Thank you!

Anne



---

archive/issue_comments_148879.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nHi Tom,\n\nI put a rebased version of the patch on the sage-combinat queue. But please also add the input information for the AffinePermutations.\n\nAnne",
    "created_at": "2013-06-18T09:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148879",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:23'>Comment 23:</a>
Hi Tom,

I put a rebased version of the patch on the sage-combinat queue. But please also add the input information for the AffinePermutations.

Anne



---

archive/issue_comments_148880.json:
```json
{
    "body": "Changed reviewer from **Chris Berg** to **Chris Berg, Anne Schilling**",
    "created_at": "2013-06-18T09:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148880",
    "user": "https://github.com/anneschilling"
}
```

Changed reviewer from **Chris Berg** to **Chris Berg, Anne Schilling**



---

archive/issue_comments_148881.json:
```json
{
    "body": "Changed dependencies from **#14673** to **#14673, #8392**",
    "created_at": "2013-06-18T09:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148881",
    "user": "https://github.com/anneschilling"
}
```

Changed dependencies from **#14673** to **#14673, #8392**



---

archive/issue_comments_148882.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nHi Tom,\n\nHere are some more comments about your patch:\n\n-  is_i_grassmannian(i=0, side='right') needs a description of the input (like the i).\n\n- Please explain the input of to_weyl_group_element(W=None)\n\n- has_right_descent has a description of an option which is not there ('right' or 'left').\nSame for has_left_descent.\n\n- Everywhere in the file you seem to use OPTIONS:. This should be replaced by or combined with INPUT. Also, as far as I know the syntax is\n\n```\n- ``variable`` -- description of what it does.\n```\n\nTom, could you make the above changes? Also, I left a review patch called trac_12940-review-as.patch on the sage-combinat queue. Please fold it into the rebased patch on the sage-combinat queue.\n\nThanks!\n\nAnne",
    "created_at": "2013-06-18T13:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148882",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:25'>Comment 25:</a>
Hi Tom,

Here are some more comments about your patch:

-  is_i_grassmannian(i=0, side='right') needs a description of the input (like the i).

- Please explain the input of to_weyl_group_element(W=None)

- has_right_descent has a description of an option which is not there ('right' or 'left').
Same for has_left_descent.

- Everywhere in the file you seem to use OPTIONS:. This should be replaced by or combined with INPUT. Also, as far as I know the syntax is

```
- ``variable`` -- description of what it does.
```

Tom, could you make the above changes? Also, I left a review patch called trac_12940-review-as.patch on the sage-combinat queue. Please fold it into the rebased patch on the sage-combinat queue.

Thanks!

Anne



---

archive/issue_comments_148883.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nHi Tom,\n\nOne more comment: please use\n\nREFERENCE:\n\n[XXX] blaba\n\nfor references and cite them via [XXX]_. See elsewhere in Sage how this is done!\n\nAnne",
    "created_at": "2013-06-18T13:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148883",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:26'>Comment 26:</a>
Hi Tom,

One more comment: please use

REFERENCE:

[XXX] blaba

for references and cite them via [XXX]_. See elsewhere in Sage how this is done!

Anne



---

archive/issue_comments_148884.json:
```json
{
    "body": "Attachment: **[trac_12940_affine_permutations-td.2.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.2.patch.gz)**",
    "created_at": "2013-06-19T07:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148884",
    "user": "https://github.com/sdenton4"
}
```

Attachment: **[trac_12940_affine_permutations-td.2.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.2.patch.gz)**



---

archive/issue_events_158186.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-19T10:26:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158186"
}
```



---

archive/issue_events_158187.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-19T10:26:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158187"
}
```



---

archive/issue_comments_148885.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.\n+\n+Apply:\n+- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)\n+\n``````\n",
    "created_at": "2013-06-19T10:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148885",
    "user": "https://github.com/anneschilling"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.
+
+Apply:
+- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)
+
``````




---

archive/issue_comments_148886.json:
```json
{
    "body": "Changed author from **tom denton** to **Tom Denton**",
    "created_at": "2013-06-19T11:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148886",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **tom denton** to **Tom Denton**



---

archive/issue_events_158188.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T07:16:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158188"
}
```



---

archive/issue_events_158189.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T07:16:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158189"
}
```



---

archive/issue_comments_148887.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nThe patch needs a proper commit message (use hg qrefresh -e to change the message).",
    "created_at": "2013-06-20T07:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148887",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'>Comment 29:</a>
The patch needs a proper commit message (use hg qrefresh -e to change the message).



---

archive/issue_comments_148888.json:
```json
{
    "body": "Attachment: **[trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)**",
    "created_at": "2013-06-20T08:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148888",
    "user": "https://github.com/anneschilling"
}
```

Attachment: **[trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)**



---

archive/issue_comments_148889.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.\n \n Apply:\n-- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)\n+- [attachment: trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)\n \n``````\n",
    "created_at": "2013-06-20T08:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148889",
    "user": "https://github.com/anneschilling"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.
 
 Apply:
-- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)
+- [attachment: trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)
 
``````




---

archive/issue_events_158190.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-20T08:31:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158190"
}
```



---

archive/issue_events_158191.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-20T08:31:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158191"
}
```



---

archive/issue_events_158192.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2013-06-20T08:32:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158192"
}
```



---

archive/issue_events_158193.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2013-06-20T08:32:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158193"
}
```



---

archive/issue_comments_148890.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nApply: trac_12940_affine_permutations-td.3.patch",
    "created_at": "2013-06-20T08:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148890",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

<a id='comment:31'>Comment 31:</a>
Apply: trac_12940_affine_permutations-td.3.patch



---

archive/issue_comments_148891.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nThis patch badly abuses `assert` statements. Assertions should be used to check correctness of the code, not to validate user input. Any `AssertionError` caused by the use of public functions is by definition a bug.",
    "created_at": "2013-06-20T09:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148891",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'>Comment 32:</a>
This patch badly abuses `assert` statements. Assertions should be used to check correctness of the code, not to validate user input. Any `AssertionError` caused by the use of public functions is by definition a bug.



---

archive/issue_events_158194.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T09:11:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158194"
}
```



---

archive/issue_events_158195.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T09:11:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158195"
}
```



---

archive/issue_comments_148892.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nAlso, while you're at it, could you use the new style doctest continuations:\n\n```\nsage: for a in CP: \n....:     p.to_lehmer_code(a[0],a[1])\n```\ninstead of\n\n```\nsage: for a in CP: \n...     p.to_lehmer_code(a[0],a[1])\n```",
    "created_at": "2013-06-20T09:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148892",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'>Comment 33:</a>
Also, while you're at it, could you use the new style doctest continuations:

```
sage: for a in CP: 
....:     p.to_lehmer_code(a[0],a[1])
```
instead of

```
sage: for a in CP: 
...     p.to_lehmer_code(a[0],a[1])
```



---

archive/issue_comments_148893.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nI'm confused, then; my understanding of the clonable array class was that it needs to have a check method which throws assertion errors if the 'checked' clonable array doesn't actually check out as a proper object.  This checks simultaneously for user errors and for code errors.\n\nCould you point me to a discussion or coding convention on proper ways to use assert statements or check for input correctness?",
    "created_at": "2013-06-20T09:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148893",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:34'>Comment 34:</a>
I'm confused, then; my understanding of the clonable array class was that it needs to have a check method which throws assertion errors if the 'checked' clonable array doesn't actually check out as a proper object.  This checks simultaneously for user errors and for code errors.

Could you point me to a discussion or coding convention on proper ways to use assert statements or check for input correctness?



---

archive/issue_events_158196.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2013-06-20T10:13:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158196"
}
```



---

archive/issue_events_158197.json:
```json
{
    "actor": "https://github.com/sdenton4",
    "created_at": "2013-06-20T10:13:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158197"
}
```



---

archive/issue_comments_148894.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.\n \n Apply:\n-- [attachment: trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)\n+- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)\n \n``````\n",
    "created_at": "2013-06-20T10:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148894",
    "user": "https://github.com/sdenton4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This is a combinatorial implementation of the affine symmetric group, providing a second implementation of the WeylGroup(['A',k,1]), but quite a bit faster.  Also included are combinatorial implmenetations of affine types B,C,D and G.  Extension to types E and F should be possible.
 
 Apply:
-- [attachment: trac_12940_affine_permutations-td.3.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.3.patch.gz)
+- [attachment: trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)
 
``````




---

archive/issue_comments_148895.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nChanged all assert statements outside of the 'check' and '_test.+' methods into ValueErrors.  Others left as 'assert' according to conventions in:\nhttp://www.sagemath.org/doc/reference/structure/sage/structure/list_clone.html",
    "created_at": "2013-06-20T10:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148895",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:36'>Comment 36:</a>
Changed all assert statements outside of the 'check' and '_test.+' methods into ValueErrors.  Others left as 'assert' according to conventions in:
http://www.sagemath.org/doc/reference/structure/sage/structure/list_clone.html



---

archive/issue_comments_148896.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [@sdenton4](#comment%3A34):\n> Could you point me to a discussion or coding convention on proper ways to use assert statements or check for input correctness?\n\nThis has been discussed before, but I can't find the discussion anymore. There is some discussion at [http://stackoverflow.com/questions/944592/best-practice-for-python-assert/945135#945135](http://stackoverflow.com/questions/944592/best-practice-for-python-assert/945135#945135)\n\nAssertions (and this is not specific to Sage or Python) are internal checks for code correctness. Don't forget that assertions can be turned off (run Python with `-O` switch) and you don't want user code to depend on whether on not assertions are enabled.\n\nI think of assertion failures as serious as a crash due to a Segmentation Fault: it is always a bug in the program if one occurs.\n\nMost of the assertions in this ticket should be replaced by something of the form\n\n```\nif not some_condition:\n    raise ValueError(\"some_condition failed\")\n```\nor `TypeError` depending on the kind of error.",
    "created_at": "2013-06-20T10:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148896",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [@sdenton4](#comment%3A34):
> Could you point me to a discussion or coding convention on proper ways to use assert statements or check for input correctness?

This has been discussed before, but I can't find the discussion anymore. There is some discussion at [http://stackoverflow.com/questions/944592/best-practice-for-python-assert/945135#945135](http://stackoverflow.com/questions/944592/best-practice-for-python-assert/945135#945135)

Assertions (and this is not specific to Sage or Python) are internal checks for code correctness. Don't forget that assertions can be turned off (run Python with `-O` switch) and you don't want user code to depend on whether on not assertions are enabled.

I think of assertion failures as serious as a crash due to a Segmentation Fault: it is always a bug in the program if one occurs.

Most of the assertions in this ticket should be replaced by something of the form

```
if not some_condition:
    raise ValueError("some_condition failed")
```
or `TypeError` depending on the kind of error.



---

archive/issue_events_158198.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2013-06-20T10:21:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158198"
}
```



---

archive/issue_events_158199.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2013-06-20T10:21:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158199"
}
```



---

archive/issue_comments_148897.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nReplying to [@sdenton4](#comment%3A36):\n> Changed all assert statements outside of the 'check' and '_test.+' methods into ValueErrors.  Others left as 'assert' according to conventions in:\n> http://www.sagemath.org/doc/reference/structure/sage/structure/list_clone.html\n\nI think that `IncreasingArray` is doing things wrongly, so don't copy from that. It's not so bad though, since `IncreasingArray` is not meant to be used directly by users (it's a \"small extension class for testing `ClonableArray`\").",
    "created_at": "2013-06-20T10:23:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148897",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'>Comment 39:</a>
Replying to [@sdenton4](#comment%3A36):
> Changed all assert statements outside of the 'check' and '_test.+' methods into ValueErrors.  Others left as 'assert' according to conventions in:
> http://www.sagemath.org/doc/reference/structure/sage/structure/list_clone.html

I think that `IncreasingArray` is doing things wrongly, so don't copy from that. It's not so bad though, since `IncreasingArray` is not meant to be used directly by users (it's a "small extension class for testing `ClonableArray`").



---

archive/issue_comments_148898.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nI think that's the whole idea of the check methods: they aren't directly accessed by the user, but called to check the integrity of the object.",
    "created_at": "2013-06-20T10:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148898",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:40'>Comment 40:</a>
I think that's the whole idea of the check methods: they aren't directly accessed by the user, but called to check the integrity of the object.



---

archive/issue_comments_148899.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nSimilarly, should one use asserts or exceptions in test suite methods?",
    "created_at": "2013-06-20T10:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148899",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:41'>Comment 41:</a>
Similarly, should one use asserts or exceptions in test suite methods?



---

archive/issue_comments_148900.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nReplying to [@sdenton4](#comment%3A41):\n> Similarly, should one use asserts or exceptions in test suite methods?\n\nIn test suites, assertions are fine.",
    "created_at": "2013-06-20T10:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148900",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'>Comment 42:</a>
Replying to [@sdenton4](#comment%3A41):
> Similarly, should one use asserts or exceptions in test suite methods?

In test suites, assertions are fine.



---

archive/issue_comments_148901.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nThe following is still a bug. It's a clear example of bad user input leading to an `AssertionError`:\n\n```\nsage: AffinePermutationGroup(['A',8,1])([0])\n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\n...\nAssertionError: Length of list must be k+1=9.\n```",
    "created_at": "2013-06-20T10:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148901",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'>Comment 43:</a>
The following is still a bug. It's a clear example of bad user input leading to an `AssertionError`:

```
sage: AffinePermutationGroup(['A',8,1])([0])
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
...
AssertionError: Length of list must be k+1=9.
```



---

archive/issue_events_158200.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T10:30:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158200"
}
```



---

archive/issue_events_158201.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-20T10:30:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158201"
}
```



---

archive/issue_comments_148902.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nReplying to [@sdenton4](#comment%3A40):\n> I think that's the whole idea of the check methods: they aren't directly accessed by the user\n\nIt doesn't matter if they are directly or indirectly accessed by the user, what matters is that these \"check\" methods are used for validating user input.",
    "created_at": "2013-06-20T10:32:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148902",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'>Comment 44:</a>
Replying to [@sdenton4](#comment%3A40):
> I think that's the whole idea of the check methods: they aren't directly accessed by the user

It doesn't matter if they are directly or indirectly accessed by the user, what matters is that these "check" methods are used for validating user input.



---

archive/issue_comments_148903.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nRead this sentence again: **I think of assertion failures as serious as a crash due to a Segmentation Fault: it is always a bug in the program if one occurs.**",
    "created_at": "2013-06-20T10:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148903",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'>Comment 45:</a>
Read this sentence again: **I think of assertion failures as serious as a crash due to a Segmentation Fault: it is always a bug in the program if one occurs.**



---

archive/issue_comments_148904.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nPlease don't use `ClonableArray` as an example, it shouldn't be using assertions that way.",
    "created_at": "2013-06-20T10:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148904",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'>Comment 46:</a>
Please don't use `ClonableArray` as an example, it shouldn't be using assertions that way.



---

archive/issue_comments_148905.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nOne more way to think of assertions: they express \"I *know* this condition is true\", not \"I want to *check* that this condition is true\".",
    "created_at": "2013-06-20T11:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148905",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'>Comment 47:</a>
One more way to think of assertions: they express "I *know* this condition is true", not "I want to *check* that this condition is true".



---

archive/issue_comments_148906.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nHi Jeroen,\n\nThank you for your comments! The asserts in the check methods of ClonableArrays/Lists seem to be in a grey area, since they are used for both the user input check as well as internal checks. Is assert ok here? If not, I would strongly suggest to change the documentation of ClonableArray to show how things are supposed to be used!\n\nThank you,\n\nAnne\n\nReplying to [@jdemeyer](#comment%3A47):\n> One more way to think of assertions: they express \"I *know* this condition is true\", not \"I want to *check* that this condition is true\".",
    "created_at": "2013-06-20T12:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148906",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:48'>Comment 48:</a>
Hi Jeroen,

Thank you for your comments! The asserts in the check methods of ClonableArrays/Lists seem to be in a grey area, since they are used for both the user input check as well as internal checks. Is assert ok here? If not, I would strongly suggest to change the documentation of ClonableArray to show how things are supposed to be used!

Thank you,

Anne

Replying to [@jdemeyer](#comment%3A47):
> One more way to think of assertions: they express "I *know* this condition is true", not "I want to *check* that this condition is true".



---

archive/issue_comments_148907.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nIf this is the accepted usage of asserts vs ValueErrors in Sage, they should be written up as such in the developer's guide; there wasn't any way for me to know this was the local convention.  Additionally, a bug+patch should be made for the Cloneable Array class.\n\nThe line between internal assumptions and user input becomes very thin in Sage, and this is an example of a very close case.  The idea of the Cloneable Array is that it's a simple data type with some extra assumptions.  When making a new one of these objects, you might break those assumptions temporarily, but should end up with something that satisfies the assumptions, and the 'check' methods are intended to check that your methods have actually made this transformation effectively.  This is a machine use of the check method, but - as you say - the check method also works well to check user input.  After all, user input IS code in Sage!  It's not a bug in my code if buggy input fails to run.  It's a very, very different situation from taking user input from, say, a web form and getting an Assertion Error.  Users can run arbitrary code, so if you want to avoid assertion errors at all cost, it should simply be completely off-limits to use assert statements at all.  I have, as a user, definitely used statements like ``X._test_whatever()``, which, as you say, are fine to have assert statements.\n\nIn short, if an assertion error happens in my code, yes, it's a bug in the program.  If one happens due to code that's been supplied by the user, it's a bug in the user's input.  \n\nThe only reason I can actually get behind to switch to ValueErrors is that it's possible to turn off assertion errors at the Python level.  But this doesn't seem to be why you think they're as bad as segmentation faults....\n\nIn any case, I've refactored the code, and am attaching a new version of the patch.",
    "created_at": "2013-06-20T13:03:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148907",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:49'>Comment 49:</a>
If this is the accepted usage of asserts vs ValueErrors in Sage, they should be written up as such in the developer's guide; there wasn't any way for me to know this was the local convention.  Additionally, a bug+patch should be made for the Cloneable Array class.

The line between internal assumptions and user input becomes very thin in Sage, and this is an example of a very close case.  The idea of the Cloneable Array is that it's a simple data type with some extra assumptions.  When making a new one of these objects, you might break those assumptions temporarily, but should end up with something that satisfies the assumptions, and the 'check' methods are intended to check that your methods have actually made this transformation effectively.  This is a machine use of the check method, but - as you say - the check method also works well to check user input.  After all, user input IS code in Sage!  It's not a bug in my code if buggy input fails to run.  It's a very, very different situation from taking user input from, say, a web form and getting an Assertion Error.  Users can run arbitrary code, so if you want to avoid assertion errors at all cost, it should simply be completely off-limits to use assert statements at all.  I have, as a user, definitely used statements like ``X._test_whatever()``, which, as you say, are fine to have assert statements.

In short, if an assertion error happens in my code, yes, it's a bug in the program.  If one happens due to code that's been supplied by the user, it's a bug in the user's input.  

The only reason I can actually get behind to switch to ValueErrors is that it's possible to turn off assertion errors at the Python level.  But this doesn't seem to be why you think they're as bad as segmentation faults....

In any case, I've refactored the code, and am attaching a new version of the patch.



---

archive/issue_comments_148908.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nReplying to [@sdenton4](#comment%3A49):\n> If this is the accepted usage of asserts vs ValueErrors in Sage, they should be written up as such in the developer's guide; there wasn't any way for me to know this was the local convention.\n\nIt's not a local convention, it is a general convention independent of Sage or Python. I think you will find that [http://en.wikipedia.org/wiki/Assertion_(software_development)#Comparison_with_error_handling](http://en.wikipedia.org/wiki/Assertion_(software_development)#Comparison_with_error_handling) mostly agrees with me.\n\n> After all, user input IS code in Sage!\n\nI don't understand what you mean with this.\n\n> It's a very, very different situation from taking user input from, say, a web form and getting an Assertion Error.\n\nWhy? What makes calling `AffinePermutationGroup()` so different from filling in a web form?\n\n> I have, as a user, definitely used statements like ``X._test_whatever()``, which, as you say, are fine to have assert statements.\n\nUnderscored methods are supposed to be private, so you're expected to know what you're doing. Everything I said applies to using public, documented functions. Of course, everything can happen if you mess with internal data structures.\n\n> It's not a bug in my code if buggy input fails to run.\n\nThat's perhaps a matter of opinion. Would you find it a bug in the `rm` command if it crashed with a Segmentation Fault if the file could not be found? Would you find it a bug in your web browser if it crashed every time you fill in a non-existing URL?",
    "created_at": "2013-06-20T14:02:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148908",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'>Comment 50:</a>
Replying to [@sdenton4](#comment%3A49):
> If this is the accepted usage of asserts vs ValueErrors in Sage, they should be written up as such in the developer's guide; there wasn't any way for me to know this was the local convention.

It's not a local convention, it is a general convention independent of Sage or Python. I think you will find that [http://en.wikipedia.org/wiki/Assertion_(software_development)#Comparison_with_error_handling](http://en.wikipedia.org/wiki/Assertion_(software_development)#Comparison_with_error_handling) mostly agrees with me.

> After all, user input IS code in Sage!

I don't understand what you mean with this.

> It's a very, very different situation from taking user input from, say, a web form and getting an Assertion Error.

Why? What makes calling `AffinePermutationGroup()` so different from filling in a web form?

> I have, as a user, definitely used statements like ``X._test_whatever()``, which, as you say, are fine to have assert statements.

Underscored methods are supposed to be private, so you're expected to know what you're doing. Everything I said applies to using public, documented functions. Of course, everything can happen if you mess with internal data structures.

> It's not a bug in my code if buggy input fails to run.

That's perhaps a matter of opinion. Would you find it a bug in the `rm` command if it crashed with a Segmentation Fault if the file could not be found? Would you find it a bug in your web browser if it crashed every time you fill in a non-existing URL?



---

archive/issue_comments_148909.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nPerhaps this should be a `NotImplementedError`:\n\n```\nraise ValueError('Cartan type provided is not implemented as an affine permutation group.')\n```",
    "created_at": "2013-06-20T14:09:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148909",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'>Comment 51:</a>
Perhaps this should be a `NotImplementedError`:

```
raise ValueError('Cartan type provided is not implemented as an affine permutation group.')
```



---

archive/issue_comments_148910.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nSwitched to NotImplementedError in the indicated place.  Can this finally get out the door now?",
    "created_at": "2013-06-20T15:16:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148910",
    "user": "https://github.com/sdenton4"
}
```

<a id='comment:52'>Comment 52:</a>
Switched to NotImplementedError in the indicated place.  Can this finally get out the door now?



---

archive/issue_comments_148911.json:
```json
{
    "body": "Patch file.",
    "created_at": "2013-06-20T16:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148911",
    "user": "https://github.com/sdenton4"
}
```

Patch file.



---

archive/issue_events_158202.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-20T16:45:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158202"
}
```



---

archive/issue_events_158203.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-20T16:45:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158203"
}
```



---

archive/issue_comments_148912.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nAttachment: **[trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)**",
    "created_at": "2013-06-20T16:45:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148912",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:53'>Comment 53:</a>
Attachment: **[trac_12940_affine_permutations-td.patch.gz](https://github.com/sagemath/sage/files/ticket12940/trac_12940_affine_permutations-td.patch.gz)**



---

archive/issue_events_158204.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-31T12:53:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158204"
}
```



---

archive/issue_events_158205.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-31T12:53:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12940#event-158205"
}
```



---

archive/issue_comments_148913.json:
```json
{
    "body": "Merged: **sage-5.11.rc0**",
    "created_at": "2013-07-31T12:53:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12940#issuecomment-148913",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.11.rc0**
