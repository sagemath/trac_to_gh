# Issue 12990: Add another doctest to connecting conversion maps

archive/issues_012818.json:
```json
{
    "body": "between 4.7.x and 5.x series, the following error was introduced:\n\n```\nK = NumberField([x^2-2, x^2-3], 'a,b')\nM = K.absolute_field('c')\nM_to_K, K_to_M = M.structure()\nM.register_coercion(K_to_M)\nK.register_coercion(M_to_K)\nM.coerce_map_from(QQ)\n...\nUnboundLocalError: local variable 'connecting' referenced before assignment\n```\n\nThis error was fixed in #12919. We propose to add a new test to that fix.\n\n**Assignee:** @robertwb\n\n**CC:**  simonking\n\n**Reviewer:** Keshav Kini, Marco Streng\n\n**Author:** Simon King, Luis Felipe Tabera Alonso\n\n**Merged:** sage-5.3.beta2\n\nIssue created by migration from https://trac.sagemath.org/ticket/12990\n\n",
    "closed_at": "2012-08-14T07:03:33Z",
    "created_at": "2012-05-22T16:58:46Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "Add another doctest to connecting conversion maps",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12990",
    "user": "https://github.com/lftabera"
}
```
between 4.7.x and 5.x series, the following error was introduced:

```
K = NumberField([x^2-2, x^2-3], 'a,b')
M = K.absolute_field('c')
M_to_K, K_to_M = M.structure()
M.register_coercion(K_to_M)
K.register_coercion(M_to_K)
M.coerce_map_from(QQ)
...
UnboundLocalError: local variable 'connecting' referenced before assignment
```

This error was fixed in #12919. We propose to add a new test to that fix.

**Assignee:** @robertwb

**CC:**  simonking

**Reviewer:** Keshav Kini, Marco Streng

**Author:** Simon King, Luis Felipe Tabera Alonso

**Merged:** sage-5.3.beta2

Issue created by migration from https://trac.sagemath.org/ticket/12990





---

archive/issue_comments_183401.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe solution was found by Simon King discussing #12269",
    "created_at": "2012-05-22T18:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183401",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:1'></a>
The solution was found by Simon King discussing #12269



---

archive/issue_comments_183402.json:
```json
{
    "body": "**Author:** Simon King, Luis Felipe Tabera Alonso",
    "created_at": "2012-05-22T18:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183402",
    "user": "https://github.com/lftabera"
}
```

**Author:** Simon King, Luis Felipe Tabera Alonso



---

archive/issue_comments_183403.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-05-22T18:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183403",
    "user": "https://github.com/lftabera"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_183404.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK, nevermind [attachment:trac_12990.patch]. Overlapping time windows! Just go with the first patch. The typo was introduced in #7420, which was merged in 4.3. Apparently changes after 4.7.1 made it so that the example in the ticket activates this code path.",
    "created_at": "2012-05-22T18:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183404",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:3'></a>
OK, nevermind [attachment:trac_12990.patch]. Overlapping time windows! Just go with the first patch. The typo was introduced in #7420, which was merged in 4.3. Apparently changes after 4.7.1 made it so that the example in the ticket activates this code path.



---

archive/issue_comments_183405.json:
```json
{
    "body": "<a id='comment:4'></a>\npatchbot: apply connecting.patch",
    "created_at": "2012-05-22T19:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183405",
    "user": "https://github.com/kini"
}
```

<a id='comment:4'></a>
patchbot: apply connecting.patch



---

archive/issue_comments_183406.json:
```json
{
    "body": "**Reviewer:** Keshav Kini",
    "created_at": "2012-05-22T20:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183406",
    "user": "https://github.com/kini"
}
```

**Reviewer:** Keshav Kini



---

archive/issue_comments_183407.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-05-22T20:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183407",
    "user": "https://github.com/kini"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_183408.json:
```json
{
    "body": "<a id='comment:5'></a>\nLooks good to go.",
    "created_at": "2012-05-22T20:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183408",
    "user": "https://github.com/kini"
}
```

<a id='comment:5'></a>
Looks good to go.



---

archive/issue_comments_183409.json:
```json
{
    "body": "<a id='comment:6'></a>\nLooks like like a duplicate of #12919.",
    "created_at": "2012-05-26T17:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183409",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Looks like like a duplicate of #12919.



---

archive/issue_comments_183410.json:
```json
{
    "body": "**Changing status** from positive_review to needs_info.",
    "created_at": "2012-05-26T17:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183410",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from positive_review to needs_info.



---

archive/issue_comments_183411.json:
```json
{
    "body": "<a id='comment:7'></a>\nWell would you look at that... hmm. Maybe we can keep the doctest from this patch. I've posted a comment on #12919.",
    "created_at": "2012-05-26T17:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183411",
    "user": "https://github.com/kini"
}
```

<a id='comment:7'></a>
Well would you look at that... hmm. Maybe we can keep the doctest from this patch. I've posted a comment on #12919.



---

archive/issue_comments_183412.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes, whis is a clear duplicate of #12919, however, I would like to keep also the doctest of this patch, 12919 doctest is a an ad-hoc class for testing the bug. In this patch is a \"real-life\" situation where the bug is triggered.\n\nShould I clear the patch to keep only the doctest and possibli be merged?",
    "created_at": "2012-05-31T07:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183412",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:8'></a>
Yes, whis is a clear duplicate of #12919, however, I would like to keep also the doctest of this patch, 12919 doctest is a an ad-hoc class for testing the bug. In this patch is a "real-life" situation where the bug is triggered.

Should I clear the patch to keep only the doctest and possibli be merged?



---

archive/issue_comments_183413.json:
```json
{
    "body": "<a id='comment:9'></a>\nSounds good to me.",
    "created_at": "2012-05-31T07:35:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183413",
    "user": "https://github.com/kini"
}
```

<a id='comment:9'></a>
Sounds good to me.



---

archive/issue_comments_183414.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2012-06-22T17:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183414",
    "user": "https://github.com/lftabera"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_events_041745.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "rename": {
        "from": "typo in connecting conversion maps",
        "to": "Add another doctest to connecting conversion maps"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12990#event-41745"
}
```



---

archive/issue_comments_183415.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-We currently have this error\n+between 4.7.x and 5.x series, the following error was introduced:\n \n ```\n K = NumberField([x^2-2, x^2-3], 'a,b')\n@@ -11,4 +11,4 @@\n UnboundLocalError: local variable 'connecting' referenced before assignment\n ```\n \n-This error was not present in 4.7.x series\n+This error was fixed in #12919. We propose to add a new test to that fix.\n``````\n",
    "created_at": "2012-06-22T17:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183415",
    "user": "https://github.com/lftabera"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-We currently have this error
+between 4.7.x and 5.x series, the following error was introduced:
 
 ```
 K = NumberField([x^2-2, x^2-3], 'a,b')
@@ -11,4 +11,4 @@
 UnboundLocalError: local variable 'connecting' referenced before assignment
 ```
 
-This error was not present in 4.7.x series
+This error was fixed in #12919. We propose to add a new test to that fix.
``````




---

archive/issue_comments_183416.json:
```json
{
    "body": "**Changing reviewer** from \"Keshav Kini\" to \"Keshav Kini, Marco Streng\".",
    "created_at": "2012-08-06T13:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183416",
    "user": "https://github.com/mstreng"
}
```

**Changing reviewer** from "Keshav Kini" to "Keshav Kini, Marco Streng".



---

archive/attachments_017539.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "connecting.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12990/connecting.patch",
    "created_at": "2012-08-06T13:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mstreng"
}
```



---

archive/issue_comments_183417.json:
```json
{
    "body": "<a id='comment:11'></a>\n",
    "created_at": "2012-08-06T13:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183417",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:11'></a>




---

archive/issue_comments_183418.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-08-06T13:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183418",
    "user": "https://github.com/mstreng"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_183419.json:
```json
{
    "body": "<a id='comment:12'></a>\nWhoops, forgot about this ticket. Thanks for the positive review, mstreng.",
    "created_at": "2012-08-06T13:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183419",
    "user": "https://github.com/kini"
}
```

<a id='comment:12'></a>
Whoops, forgot about this ticket. Thanks for the positive review, mstreng.



---

archive/issue_events_041746.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-14T07:03:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12990#event-41746"
}
```



---

archive/issue_comments_183420.json:
```json
{
    "body": "**Merged:** sage-5.3.beta2",
    "created_at": "2012-08-14T07:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12990#issuecomment-183420",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.3.beta2
