# Issue 12752: resulant of two polynomials returns incorrect value

archive/issues_012580.json:
```json
{
    "body": "The resultant of two homogeneous polynomials can return an incorrect value:\nR.<x,y>=PolynomialRing(ZZ)\n\nf=6*x<sup>2</sup> + x*y + y<sup>2</sup>\n\ng=y<sup>2</sup>\nprint f.resultant(g)\n\nm=matrix([[6,1,1,0],[0,6,1,1],[0,0,1,0],[0,0,0,1]])\n\nm.determinant()\n\nnotice that the coefficient of the f.resultant(g) does not match the integer determinant (they should be the same).  I believe this is because the .resultant function is actually calling the pari library, which is interpreting y<sup>2</sup> as a single variable polynomial.  Thus it builds the wrong matrix. Probably the following:\n\nm=matrix([[6,1,1,0],[0,6,1,1],[1,0,0,0],[0,1,0,0]])\n\nm.determinant()\n\nwhich is the value Sage is returning. The correct value is returned in Sage from\n\nm=f.sylvester_matrix(g,x)\n\nm.determinant()\n\nAssignee: tba\n\nKeywords: polynomial resultant\n\nReviewer: Nils Bruin\n\nResolution: wontfix\n\nIssue created by migration from https://trac.sagemath.org/ticket/12752\n\n",
    "closed_at": "2012-06-02T13:28:03Z",
    "created_at": "2012-03-26T19:55:16Z",
    "labels": [
        "component: basic arithmetic",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "resulant of two polynomials returns incorrect value",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12752",
    "user": "https://github.com/bhutz"
}
```
The resultant of two homogeneous polynomials can return an incorrect value:
R.<x,y>=PolynomialRing(ZZ)

f=6*x<sup>2</sup> + x*y + y<sup>2</sup>

g=y<sup>2</sup>
print f.resultant(g)

m=matrix([[6,1,1,0],[0,6,1,1],[0,0,1,0],[0,0,0,1]])

m.determinant()

notice that the coefficient of the f.resultant(g) does not match the integer determinant (they should be the same).  I believe this is because the .resultant function is actually calling the pari library, which is interpreting y<sup>2</sup> as a single variable polynomial.  Thus it builds the wrong matrix. Probably the following:

m=matrix([[6,1,1,0],[0,6,1,1],[1,0,0,0],[0,1,0,0]])

m.determinant()

which is the value Sage is returning. The correct value is returned in Sage from

m=f.sylvester_matrix(g,x)

m.determinant()

Assignee: tba

Keywords: polynomial resultant

Reviewer: Nils Bruin

Resolution: wontfix

Issue created by migration from https://trac.sagemath.org/ticket/12752





---

archive/issue_comments_185052.json:
```json
{
    "body": "Changing component from number theory to basic arithmetic.",
    "created_at": "2012-03-27T16:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185052",
    "user": "https://github.com/nbruin"
}
```

Changing component from number theory to basic arithmetic.



---

archive/issue_comments_185053.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2012-03-27T16:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185053",
    "user": "https://github.com/nbruin"
}
```

Changing priority from major to minor.



---

archive/issue_events_034670.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2012-03-27T16:01:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12752#event-34670"
}
```



---

archive/issue_comments_185054.json:
```json
{
    "body": "<a id='comment:1'></a>\nSee [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/c15d8628b25517ca?hl=en). The documented use of f.resultant(g,<var>) is to take the resultant of f,g with respect to <var>. This is useful for eliminating variables when doing computations with polynomials. As documented, f.resultant(g) takes the resultant relative to the first parameter.\n\nThe resultant operation expected/requested in the ticket is a different one: It is the \"bivariate form\" resultant. You can compute it by taking a univariate polynomial resultant of dehomogenized forms and compensating for degree-drop by multiplying by the right power of some leading coefficients (if both forms drop in degree then they have a common root at infinity and the resultant is 0). Note that this routine should raise an error if any of its parameters is not homogeneous or not bivariate.\n\nThe resultant method on multivariate polynomials basically has to be the ordinary polynomial resultant. If you really want to have the form-resultant you can implement it as a separate function:\n\n```\ndef form_resultant(F,G):\n    \"\"\"debugging, error checking and better coercion left as an exercise\"\"\"\n    R=F.base_ring()\n    Rt=PolynomialRing(R,'t')\n    f=F(Rt.0,1)\n    lcF=F.coefficient([F.degree(),0])\n    g=G(Rt.0,1)\n    lcG=G.coefficient([G.degree(),0])\n    return lcF^(G.degree()-g.degree())*lcG^(F.degree()-f.degree())*f.resultant(g)\n```\n\nIf there is a class somewhere that symbolizes homogeneous bivariate forms, you could hang that function off it as \"form_resultant\".\n\nNote that in general, computing with bivariate forms is done most efficiently by representing them by a univariate polynomial together with a degree (to keep track of leading 0 coefficients). Univariate polynomials tend to have much more efficient implementations.\n\nChanging to \"invalid\". If you want to track an enhancement proposal to implement a \"forms\" class, it's probably better to open a new ticket. I think it will be tricky to come up with a useful design for that, though.",
    "created_at": "2012-03-27T16:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185054",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:1'></a>
See [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/c15d8628b25517ca?hl=en). The documented use of f.resultant(g,<var>) is to take the resultant of f,g with respect to <var>. This is useful for eliminating variables when doing computations with polynomials. As documented, f.resultant(g) takes the resultant relative to the first parameter.

The resultant operation expected/requested in the ticket is a different one: It is the "bivariate form" resultant. You can compute it by taking a univariate polynomial resultant of dehomogenized forms and compensating for degree-drop by multiplying by the right power of some leading coefficients (if both forms drop in degree then they have a common root at infinity and the resultant is 0). Note that this routine should raise an error if any of its parameters is not homogeneous or not bivariate.

The resultant method on multivariate polynomials basically has to be the ordinary polynomial resultant. If you really want to have the form-resultant you can implement it as a separate function:

```
def form_resultant(F,G):
    """debugging, error checking and better coercion left as an exercise"""
    R=F.base_ring()
    Rt=PolynomialRing(R,'t')
    f=F(Rt.0,1)
    lcF=F.coefficient([F.degree(),0])
    g=G(Rt.0,1)
    lcG=G.coefficient([G.degree(),0])
    return lcF^(G.degree()-g.degree())*lcG^(F.degree()-f.degree())*f.resultant(g)
```

If there is a class somewhere that symbolizes homogeneous bivariate forms, you could hang that function off it as "form_resultant".

Note that in general, computing with bivariate forms is done most efficiently by representing them by a univariate polynomial together with a degree (to keep track of leading 0 coefficients). Univariate polynomials tend to have much more efficient implementations.

Changing to "invalid". If you want to track an enhancement proposal to implement a "forms" class, it's probably better to open a new ticket. I think it will be tricky to come up with a useful design for that, though.



---

archive/issue_comments_185055.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-23T19:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185055",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_185056.json:
```json
{
    "body": "<a id='comment:3'></a>\nSince this ticket has been set to invalid, I believe this ticket can be\nclosed.",
    "created_at": "2012-05-23T19:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185056",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

<a id='comment:3'></a>
Since this ticket has been set to invalid, I believe this ticket can be
closed.



---

archive/issue_comments_185057.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-23T19:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185057",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_034671.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T13:28:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12752#event-34671"
}
```



---

archive/issue_comments_185058.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2012-06-02T13:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185058",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: wontfix



---

archive/issue_comments_185059.json:
```json
{
    "body": "Changing stopgaps from \"todo\" to \"\"",
    "created_at": "2012-06-02T13:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185059",
    "user": "https://github.com/jdemeyer"
}
```

Changing stopgaps from "todo" to ""



---

archive/issue_comments_185060.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nils Bruin\"",
    "created_at": "2012-06-02T13:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12752",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12752#issuecomment-185060",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Nils Bruin"
