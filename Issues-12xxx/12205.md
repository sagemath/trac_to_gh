# Issue 12205: rewrite conway polynomial spkg and code in Sage library to not use ZODB

archive/issues_012033.json:
```json
{
    "assignees": [],
    "body": "This is necessary so we can dump the ZODB spkg from Sage.\n\n---\n**Installation Instructions**\n* Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).\n* Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library\n* Apply [attachment:12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch) to the sage root repository\n\n\nDepends on #13896\n\nDepends on #13963\n\n**Assignee:** @williamstein\n\n**CC:**  @kini\n\n**Reviewer:** Fran\u00e7ois Bissey\n\n**Author:** R. Andrew Ohana\n\n**Merged:** sage-5.7.beta0\n\nIssue created by migration from https://trac.sagemath.org/ticket/12205\n\n",
    "closed_at": "2013-01-21T21:12:55Z",
    "created_at": "2011-12-20T18:59:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20huge"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "rewrite conway polynomial spkg and code in Sage library to not use ZODB",
    "type": "issue",
    "updated_at": "2013-02-07T02:57:14Z",
    "url": "https://github.com/sagemath/sage/issues/12205",
    "user": "https://github.com/williamstein"
}
```
This is necessary so we can dump the ZODB spkg from Sage.

---
**Installation Instructions**
* Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).
* Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library
* Apply [attachment:12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch) to the sage root repository


Depends on #13896

Depends on #13963

**Assignee:** @williamstein

**CC:**  @kini

**Reviewer:** Fran√ßois Bissey

**Author:** R. Andrew Ohana

**Merged:** sage-5.7.beta0

Issue created by migration from https://trac.sagemath.org/ticket/12205





---

archive/issue_events_140061.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-20T18:59:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140061"
}
```



---

archive/issue_events_140062.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-20T18:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20huge",
    "label_color": "08517b",
    "label_name": "component: packages: huge",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140062"
}
```



---

archive/issue_events_140063.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-20T18:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140063"
}
```



---

archive/issue_events_140064.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-20T18:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140064"
}
```



---

archive/issue_comments_133662.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nI did some work on this on the airplane, and better post a link before I forget about it or loose it:  http://wstein.org/patches/conway_polynomials-0.3.spkg\n\nBasically, the database is tiny so it can easily and very efficiently just be stored as a standard sobj.   Using ZODB is silly.",
    "created_at": "2012-01-27T20:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133662",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'>**Comment 2:**</a>
I did some work on this on the airplane, and better post a link before I forget about it or loose it:  http://wstein.org/patches/conway_polynomials-0.3.spkg

Basically, the database is tiny so it can easily and very efficiently just be stored as a standard sobj.   Using ZODB is silly.



---

archive/issue_comments_133663.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nThat's a good start. Now we need to put SPKG.txt and spkg-install in proper shape. I suppose there need to be more work sage side to use the sobj rather than zodb.",
    "created_at": "2012-01-28T00:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133663",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'>**Comment 3:**</a>
That's a good start. Now we need to put SPKG.txt and spkg-install in proper shape. I suppose there need to be more work sage side to use the sobj rather than zodb.



---

archive/issue_events_140065.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-06-18T05:46:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140065"
}
```



---

archive/issue_comments_133664.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nWilliam, do you have a work-in-progress patch for the sage library? I would like to finish this task.\n\nEdit: Other than a description in the SPKG.txt, [this spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg) should final.\n\nEdit2: Ok, there is now a small description, and it is rebased off of the spkg that I made for #13123.",
    "created_at": "2012-06-18T05:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133664",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:4'>**Comment 4:**</a>
William, do you have a work-in-progress patch for the sage library? I would like to finish this task.

Edit: Other than a description in the SPKG.txt, [this spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg) should final.

Edit2: Ok, there is now a small description, and it is rebased off of the spkg that I made for #13123.



---

archive/issue_events_140066.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-06-18T05:46:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140066"
}
```



---

archive/issue_comments_133665.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nLooks like I missed your work on this ohanar getting rid of zodb would be good news all around. Do this need any rebasing?",
    "created_at": "2012-12-29T08:51:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133665",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'>**Comment 5:**</a>
Looks like I missed your work on this ohanar getting rid of zodb would be good news all around. Do this need any rebasing?



---

archive/issue_comments_133666.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nWhat's the status? According to [comment:4](#comment%3A4), [conway_polynomials-0.4.spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg) should be final. So, needs review?\n\nWhat should be done to test whether this is really enough to get rid of zodb? I mean: How can one remove zodb from an existing Sage install?",
    "created_at": "2012-12-29T10:58:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133666",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:6'>**Comment 6:**</a>
What's the status? According to [comment:4](#comment%3A4), [conway_polynomials-0.4.spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg) should be final. So, needs review?

What should be done to test whether this is really enough to get rid of zodb? I mean: How can one remove zodb from an existing Sage install?



---

archive/issue_comments_133667.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nWell, a patch is also needed to the sage library, and unfortunately William never provided that. It probably wouldn't be that hard to reverse engineer what he was thinking from the SPKG, but I haven't really looked into it.\n\nThe only other database in sage that used zodb was the Cremona database, but I rewrote that a year and a half ago to use sqlite3, so this is the only thing that should really be using zope at all (there may be other things that stupidly depend on it, but they should be easy to fix to not use zope).",
    "created_at": "2012-12-29T11:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133667",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:7'>**Comment 7:**</a>
Well, a patch is also needed to the sage library, and unfortunately William never provided that. It probably wouldn't be that hard to reverse engineer what he was thinking from the SPKG, but I haven't really looked into it.

The only other database in sage that used zodb was the Cremona database, but I rewrote that a year and a half ago to use sqlite3, so this is the only thing that should really be using zope at all (there may be other things that stupidly depend on it, but they should be easy to fix to not use zope).



---

archive/issue_comments_133668.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nI think all that needs to be changed are the files: databases/compressed_storage.py, databases/db.py and databases/conway.py. conway.py is where we will have to be careful to present the same interface to the rest of sage so has not to break anything.",
    "created_at": "2012-12-30T10:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133668",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'>**Comment 8:**</a>
I think all that needs to be changed are the files: databases/compressed_storage.py, databases/db.py and databases/conway.py. conway.py is where we will have to be careful to present the same interface to the rest of sage so has not to break anything.



---

archive/issue_comments_133669.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nOK rewrite of conway.py belongs here and the other two files belong to #10353. I am looking at conway.py and see if it is in my abilities.",
    "created_at": "2012-12-30T23:48:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133669",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'>**Comment 9:**</a>
OK rewrite of conway.py belongs here and the other two files belong to #10353. I am looking at conway.py and see if it is in my abilities.



---

archive/issue_comments_133670.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nI think it is easy but it will be question of getting the syntax right. In the mean time I found that the stein-watkins optional \"huge\" database also use zodb and will need a similar treatment.",
    "created_at": "2012-12-31T00:08:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133670",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'>**Comment 10:**</a>
I think it is easy but it will be question of getting the syntax right. In the mean time I found that the stein-watkins optional "huge" database also use zodb and will need a similar treatment.



---

archive/issue_comments_133671.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nIn the end I am hitting a brick wall here. Possibly due to my lack of python skills and my will to only have minimal changes in conway.py. The issue is that the created sobj is a double dictionary and that the call to the ConwayPolynomials() class follow the same pattern as a double dictionary. You have calls of the kind:\nConwayPolynomials()[3][21]\n\nImplementing the class as a dictionary allows sage to start \n\n```\nimport os\n\nfrom sage.structure.sage_object import load\nfrom sage.misc.misc import SAGE_DATA\n\n_CONWAYDATA = os.path.join(SAGE_DATA,'conway_polynomials')\n\nclass ConwayPolynomials(dict):\n    def __init__(self,*arg,**kw):\n        \"\"\"\n        Initialize the database.\n        \"\"\"\n        super(ConwayPolynomials, self).__init__(*arg, **kw)\n\n    def _init(self):\n        if not os.path.exists(_CONWAYDATA):\n            raise RuntimeError, \"In order to initialize the database, the directory must exist.\"%_CONWAYDATA\n        os.chdir(_CONWAYDATA)\n        self = load(os.path.join(_CONWAYDATA, 'conway_polynomials'))\n```\nbut unfortunately but I get key errors:\n\n```\nsage: sage.databases.conway.ConwayPolynomials()[3][21]\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n\n/home/fbissey/Work/Overlays/BlueFern/sci-mathematics/sage/<ipython console> in <module>()\n\nKeyError: 3\nsage: sage.databases.conway.ConwayPolynomials().keys()\n[]\n```\n I was hoping that inheriting the dict class the access problem would be solved but I am obviously doing something wrong here. Loading the sobj directly from sage is totally usable, it is just when trying to put it in a class.",
    "created_at": "2013-01-02T09:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133671",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'>**Comment 11:**</a>
In the end I am hitting a brick wall here. Possibly due to my lack of python skills and my will to only have minimal changes in conway.py. The issue is that the created sobj is a double dictionary and that the call to the ConwayPolynomials() class follow the same pattern as a double dictionary. You have calls of the kind:
ConwayPolynomials()[3][21]

Implementing the class as a dictionary allows sage to start 

```
import os

from sage.structure.sage_object import load
from sage.misc.misc import SAGE_DATA

_CONWAYDATA = os.path.join(SAGE_DATA,'conway_polynomials')

class ConwayPolynomials(dict):
    def __init__(self,*arg,**kw):
        """
        Initialize the database.
        """
        super(ConwayPolynomials, self).__init__(*arg, **kw)

    def _init(self):
        if not os.path.exists(_CONWAYDATA):
            raise RuntimeError, "In order to initialize the database, the directory must exist."%_CONWAYDATA
        os.chdir(_CONWAYDATA)
        self = load(os.path.join(_CONWAYDATA, 'conway_polynomials'))
```
but unfortunately but I get key errors:

```
sage: sage.databases.conway.ConwayPolynomials()[3][21]
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)

/home/fbissey/Work/Overlays/BlueFern/sci-mathematics/sage/<ipython console> in <module>()

KeyError: 3
sage: sage.databases.conway.ConwayPolynomials().keys()
[]
```
 I was hoping that inheriting the dict class the access problem would be solved but I am obviously doing something wrong here. Loading the sobj directly from sage is totally usable, it is just when trying to put it in a class.



---

archive/issue_comments_133672.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nReplying to [@kiwifb](#comment%3A11):\n> `self = load(os.path.join(_CONWAYDATA, 'conway_polynomials'))`\n\nThis only changes the meaning of the `self` variable in the local scope. To modify the `self` object, use `self.update(load(\u2026))` instead.",
    "created_at": "2013-01-02T09:53:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133672",
    "user": "https://github.com/gagern"
}
```

<a id='comment:12'>**Comment 12:**</a>
Replying to [@kiwifb](#comment%3A11):
> `self = load(os.path.join(_CONWAYDATA, 'conway_polynomials'))`

This only changes the meaning of the `self` variable in the local scope. To modify the `self` object, use `self.update(load(‚Ä¶))` instead.



---

archive/issue_comments_133673.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nInteresting point but here it will call update() from the dict class which I don't think is what you meant. I still get the same results after doing your suggested replacement.",
    "created_at": "2013-01-02T10:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133673",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'>**Comment 13:**</a>
Interesting point but here it will call update() from the dict class which I don't think is what you meant. I still get the same results after doing your suggested replacement.



---

archive/issue_comments_133674.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nReplying to [@kiwifb](#comment%3A11):\n> In the end I am hitting a brick wall here. Possibly due to my lack of python skills and my will to only have minimal changes in conway.py.\n\nI don't think `_init` is a magic python method that automatically gets called. It may well be part of a protocol involved in sage.databases.db.Database. However, when you want to implement this as inheriting from `dict`, you'll have to call `_init` yourself in `__init__`, or better: just make `_init` part of it.\n\nTo make the dictionary read-only, you may want to override the dictionary modification methods too. Plus you probably want to amend pickling (interesting question: How should this pickle? Should it write its content to a file or should it pickle to \"initialize ConwayPolynomials() for unpickling\"?",
    "created_at": "2013-01-02T17:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133674",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:14'>**Comment 14:**</a>
Replying to [@kiwifb](#comment%3A11):
> In the end I am hitting a brick wall here. Possibly due to my lack of python skills and my will to only have minimal changes in conway.py.

I don't think `_init` is a magic python method that automatically gets called. It may well be part of a protocol involved in sage.databases.db.Database. However, when you want to implement this as inheriting from `dict`, you'll have to call `_init` yourself in `__init__`, or better: just make `_init` part of it.

To make the dictionary read-only, you may want to override the dictionary modification methods too. Plus you probably want to amend pickling (interesting question: How should this pickle? Should it write its content to a file or should it pickle to "initialize ConwayPolynomials() for unpickling"?



---

archive/issue_comments_133675.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nThanks Nils. I actually though about that _init method as it was strange to have two. Merging the two didn't improve my problems however. I wouldn't know about the pickling. I'd like this to give me the correct behaviour of the class first. I'll retry merging inits as there may have been caching getting in the way.",
    "created_at": "2013-01-02T18:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133675",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'>**Comment 15:**</a>
Thanks Nils. I actually though about that _init method as it was strange to have two. Merging the two didn't improve my problems however. I wouldn't know about the pickling. I'd like this to give me the correct behaviour of the class first. I'll retry merging inits as there may have been caching getting in the way.



---

archive/issue_comments_133676.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nI found a way to properly initialise the database. It is a bit ugly but we may be able to move to the other problems: pickling and dict method override. I'll post a patch when I am on something else than that iPad.",
    "created_at": "2013-01-03T00:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133676",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'>**Comment 16:**</a>
I found a way to properly initialise the database. It is a bit ugly but we may be able to move to the other problems: pickling and dict method override. I'll post a patch when I am on something else than that iPad.



---

archive/issue_comments_133677.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nActually, what you *should* do is just write the ConwayPolynomials class without thinking about how to initialize from an sobj at all, but just as either a normal class that has an attribute storing the info or inheriting from dict and ensure that pickling works. Then you just have to make sure that the `.sobj` is a pickled version of it with the appropriate content. (and you may store in the documentation somewhere a script that can produce this pickle from a human-readable file)",
    "created_at": "2013-01-03T04:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133677",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:17'>**Comment 17:**</a>
Actually, what you *should* do is just write the ConwayPolynomials class without thinking about how to initialize from an sobj at all, but just as either a normal class that has an attribute storing the info or inheriting from dict and ensure that pickling works. Then you just have to make sure that the `.sobj` is a pickled version of it with the appropriate content. (and you may store in the documentation somewhere a script that can produce this pickle from a human-readable file)



---

archive/issue_comments_133678.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nRather than inheriting from `dict`, I think it makes more sense to inherit from `collections.Mapping` since we only want read functionality. I uploaded a patch that does this, and uses the current dictionary format in the background (I don't see a good alternative to this storage method, but I'm open to suggestions).",
    "created_at": "2013-01-03T08:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133678",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:18'>**Comment 18:**</a>
Rather than inheriting from `dict`, I think it makes more sense to inherit from `collections.Mapping` since we only want read functionality. I uploaded a patch that does this, and uses the current dictionary format in the background (I don't see a good alternative to this storage method, but I'm open to suggestions).



---

archive/issue_comments_133679.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nI think we have to stick with the dictionary format since the code in sage is littered with calls to ConwayPolynomials()[p][n] and changing the storage would imply changing an enormous amount of code. I trust that your python foo is way ahead of mine. I would never have produced that getitem and didn't find any examples to do that with google. Your patch is longer than my current one but probably better behaved in the long run. It is very educative to me too.",
    "created_at": "2013-01-03T08:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133679",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'>**Comment 19:**</a>
I think we have to stick with the dictionary format since the code in sage is littered with calls to ConwayPolynomials()[p][n] and changing the storage would imply changing an enormous amount of code. I trust that your python foo is way ahead of mine. I would never have produced that getitem and didn't find any examples to do that with google. Your patch is longer than my current one but probably better behaved in the long run. It is very educative to me too.



---

archive/issue_comments_133680.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nLooks great! Two questions:\n- How do we (re)produce the *.sobj file? I think we do want to be able to bootstap sage from human-readable formats? Just documenting how to obtain the appropriate *.sobj is probably sufficient.\n- Do you have a good reason to inherit from `UniqueRepresentation`? Doing so is definitely not free. It makes instantiation a much more expensive affair and there'll be a cache floating around. You should only do so if you need it and I don't think you do here (`ConwayPolynomials` is not a parent).",
    "created_at": "2013-01-03T08:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133680",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:20'>**Comment 20:**</a>
Looks great! Two questions:
- How do we (re)produce the *.sobj file? I think we do want to be able to bootstap sage from human-readable formats? Just documenting how to obtain the appropriate *.sobj is probably sufficient.
- Do you have a good reason to inherit from `UniqueRepresentation`? Doing so is definitely not free. It makes instantiation a much more expensive affair and there'll be a cache floating around. You should only do so if you need it and I don't think you do here (`ConwayPolynomials` is not a parent).



---

archive/issue_comments_133681.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nI can answer the first question: It is generated in the spkg attached in this ticket from a python table in text format look it up. Technically it doesn't have to be a sobj the previous spkg was installing a bzipped version of the python table and then inserting it in the database. We could do something similar, not sure about the cost.",
    "created_at": "2013-01-03T08:48:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133681",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'>**Comment 21:**</a>
I can answer the first question: It is generated in the spkg attached in this ticket from a python table in text format look it up. Technically it doesn't have to be a sobj the previous spkg was installing a bzipped version of the python table and then inserting it in the database. We could do something similar, not sure about the cost.



---

archive/issue_comments_133682.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nReplying to [@kiwifb](#comment%3A19):\n> I think we have to stick with the dictionary format ...\n\nAs much as I understand, the \"format\" (in the sense of the \"interface to retrieve data\") does not change. That's exactly the point: If you wanted to inherit from dict, then you'd also have to have a `__setitem__` method - but we don't want to set data in an interactive session. All what we want is that during initialisation, data are obtained from a file, and then the user can retrieve these data (which is granted by the `__getitem__` method).\n\n> ... since the code in sage is littered with calls to ConwayPolynomials()[p][n]\n\nWould that be changed by the patch? Looking at the lines\n\n```\n    def __getitem__(self, key): \n        try: \n            return self._store[key] \n        except KeyError, err: \n            try: \n                if isinstance(key, (tuple, list)): \n                    if len(key) == 2: \n                        return self._store[key[0]][key[1]] \n            except KeyError: \n                pass \n            raise err \n```\nit seems to me that `ConwayPolynomials()[p][n]` is still a possible syntax (that's `return self._store[key]`), but *in addition to the old syntax* we now also allow the syntax `ConwayPolynomials()[p, n]` (that's `return self._store[key[0]][key[1]]`).\n\n> and changing the storage would imply changing an enormous amount of code.\n\nBy \"storage\", I understand the format of the data stored in the .sobj file containing the data base. I don't think that would be a problem, as long as there is a function that is able to read old data and transforms it into the new format.\n\n> I trust that your python foo is way ahead of mine. I would never have produced that getitem and didn't find any examples to do that with google.\n\nThat's in [dive into python](http://www.diveintopython.net/object_oriented_framework/special_class_methods.html) or other Python introductions, or in the [Python documentation](http://docs.python.org/2/reference/datamodel.html#special-method-names).",
    "created_at": "2013-01-03T08:55:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133682",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:22'>**Comment 22:**</a>
Replying to [@kiwifb](#comment%3A19):
> I think we have to stick with the dictionary format ...

As much as I understand, the "format" (in the sense of the "interface to retrieve data") does not change. That's exactly the point: If you wanted to inherit from dict, then you'd also have to have a `__setitem__` method - but we don't want to set data in an interactive session. All what we want is that during initialisation, data are obtained from a file, and then the user can retrieve these data (which is granted by the `__getitem__` method).

> ... since the code in sage is littered with calls to ConwayPolynomials()[p][n]

Would that be changed by the patch? Looking at the lines

```
    def __getitem__(self, key): 
        try: 
            return self._store[key] 
        except KeyError, err: 
            try: 
                if isinstance(key, (tuple, list)): 
                    if len(key) == 2: 
                        return self._store[key[0]][key[1]] 
            except KeyError: 
                pass 
            raise err 
```
it seems to me that `ConwayPolynomials()[p][n]` is still a possible syntax (that's `return self._store[key]`), but *in addition to the old syntax* we now also allow the syntax `ConwayPolynomials()[p, n]` (that's `return self._store[key[0]][key[1]]`).

> and changing the storage would imply changing an enormous amount of code.

By "storage", I understand the format of the data stored in the .sobj file containing the data base. I don't think that would be a problem, as long as there is a function that is able to read old data and transforms it into the new format.

> I trust that your python foo is way ahead of mine. I would never have produced that getitem and didn't find any examples to do that with google.

That's in [dive into python](http://www.diveintopython.net/object_oriented_framework/special_class_methods.html) or other Python introductions, or in the [Python documentation](http://docs.python.org/2/reference/datamodel.html#special-method-names).



---

archive/issue_comments_133683.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nI noticed a a flaw with what I did -- `ConwayPolynomials()[p]` returns a mutable Python dict, so you can actually write to the database. I'll post a fix for this in a moment. \n\nThere is no good reason as far as I can tell to use anything but plain text in the SPKG considering how small the database is.\n\nAs for the second question, the only concern would be that the entire database is loaded into memory with each instance (granted this might not be a huge concern due to the small size of the database). The main reason I added the inheritance of `UniqueRepresentation` was because of a comment I seem to recall being told that Sage databases should be unique. It is simple enough to remove if we deem it not necessary.",
    "created_at": "2013-01-03T09:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133683",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:23'>**Comment 23:**</a>
I noticed a a flaw with what I did -- `ConwayPolynomials()[p]` returns a mutable Python dict, so you can actually write to the database. I'll post a fix for this in a moment. 

There is no good reason as far as I can tell to use anything but plain text in the SPKG considering how small the database is.

As for the second question, the only concern would be that the entire database is loaded into memory with each instance (granted this might not be a huge concern due to the small size of the database). The main reason I added the inheritance of `UniqueRepresentation` was because of a comment I seem to recall being told that Sage databases should be unique. It is simple enough to remove if we deem it not necessary.



---

archive/issue_comments_133684.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\n@simon-king-jena: overall you read my terrible prose correctly. I read the patch carefuly and in spite of call changes in the class I understood that the old way of accessing the class was preserved. You make a good point that it doesn't need to be preserved internally - just that we provide the right method of access.\nI used to have a copy of \"dive into python\" wonder what happened to it. Probably lost last time I moved. I would say I read the python documentation but my python skill are not advanced enough that I could have crafted a getitem accessing something like [p][n] - [p,n] is easy the former is more tricky to me.\n\n@ohanar: going with plain text would remove the requirement of installing sage before this spkg. As it is sage needs to be installed first to produce the sobj. The spkg could then be installed at any time.",
    "created_at": "2013-01-03T09:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133684",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:24'>**Comment 24:**</a>
@simon-king-jena: overall you read my terrible prose correctly. I read the patch carefuly and in spite of call changes in the class I understood that the old way of accessing the class was preserved. You make a good point that it doesn't need to be preserved internally - just that we provide the right method of access.
I used to have a copy of "dive into python" wonder what happened to it. Probably lost last time I moved. I would say I read the python documentation but my python skill are not advanced enough that I could have crafted a getitem accessing something like [p][n] - [p,n] is easy the former is more tricky to me.

@ohanar: going with plain text would remove the requirement of installing sage before this spkg. As it is sage needs to be installed first to produce the sobj. The spkg could then be installed at any time.



---

archive/issue_comments_133685.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,8 @@\n This is necessary so we can dump the ZODB spkg from Sage.\n+\n+---\n+**Installation Instructions**\n+* Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).\n+* Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library\n+* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.patch) to the sage root repository\n+\n``````\n",
    "created_at": "2013-01-03T09:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133685",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,8 @@
 This is necessary so we can dump the ZODB spkg from Sage.
+
+---
+**Installation Instructions**
+* Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).
+* Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library
+* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.patch) to the sage root repository
+
``````




---

archive/issue_comments_133686.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nAny reason you changed \"[]\" to \"()\" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.",
    "created_at": "2013-01-03T09:28:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133686",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'>**Comment 26:**</a>
Any reason you changed "[]" to "()" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.



---

archive/issue_comments_133687.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nReplying to [@ohanar](#comment%3A23):\n> As for the second question, the only concern would be that the entire database is loaded into memory with each instance (granted this might not be a huge concern due to the small size of the database).\n\nPerhaps store the database in a module-level variable then? Modules naturally have a unique instance (or at least you have to work very hard to get multiple instances). If the nature of the instance is known at compile time (such as with a data base!) you might as well use the mechanism to your advantage.\n\n(for data bases in general: Especially for writable data bases, you wouldn't want multiple instances backed by the same file)",
    "created_at": "2013-01-03T09:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133687",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:27'>**Comment 27:**</a>
Replying to [@ohanar](#comment%3A23):
> As for the second question, the only concern would be that the entire database is loaded into memory with each instance (granted this might not be a huge concern due to the small size of the database).

Perhaps store the database in a module-level variable then? Modules naturally have a unique instance (or at least you have to work very hard to get multiple instances). If the nature of the instance is known at compile time (such as with a data base!) you might as well use the mechanism to your advantage.

(for data bases in general: Especially for writable data bases, you wouldn't want multiple instances backed by the same file)



---

archive/issue_comments_133688.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nReplying to [@kiwifb](#comment%3A26):\n> Any reason you changed \"[]\" to \"()\" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.\n\nI updated the database to use tuples (updated the spkg), rather than lists, as they are not mutable. I don't believe there are other breakages, but I haven't run the full doctest suit (just a few files I found through greping).\n\nReplying to [@nbruin](#comment%3A27):\n> Perhaps store the database in a module-level variable then?\n\nYes, that sounds like a plan.",
    "created_at": "2013-01-03T09:37:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133688",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:28'>**Comment 28:**</a>
Replying to [@kiwifb](#comment%3A26):
> Any reason you changed "[]" to "()" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.

I updated the database to use tuples (updated the spkg), rather than lists, as they are not mutable. I don't believe there are other breakages, but I haven't run the full doctest suit (just a few files I found through greping).

Replying to [@nbruin](#comment%3A27):
> Perhaps store the database in a module-level variable then?

Yes, that sounds like a plan.



---

archive/issue_comments_133689.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nReplying to [@ohanar](#comment%3A28):\n> Replying to [@kiwifb](#comment%3A26):\n> > Any reason you changed \"[]\" to \"()\" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.\n\n> \n> I updated the database to use tuples (updated the spkg), rather than lists, as they are not mutable. I don't believe there are other breakages, but I haven't run the full doctest suit (just a few files I found through greping).\n> \n\nOK will run some tests as well. I didn't know you had updated the spkg.",
    "created_at": "2013-01-03T09:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133689",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:29'>**Comment 29:**</a>
Replying to [@ohanar](#comment%3A28):
> Replying to [@kiwifb](#comment%3A26):
> > Any reason you changed "[]" to "()" in the polynomial method doctest? It wasn't in the previous patch and I would hope that if it is correct it doesn't lead to other breakages in the rest of sage.

> 
> I updated the database to use tuples (updated the spkg), rather than lists, as they are not mutable. I don't believe there are other breakages, but I haven't run the full doctest suit (just a few files I found through greping).
> 

OK will run some tests as well. I didn't know you had updated the spkg.



---

archive/issue_comments_133690.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nReplying to [@kiwifb](#comment%3A29):\n> OK will run some tests as well. I didn't know you had updated the spkg.\n\nSorry about that, I noticed it wouldn't install on 5.6-beta1, so I updated it (and changed to tuples at the same time).\n\nOk, added a updated the patch to add some doctests and remove `UniqueRepresentation` in favor of a module level variable.",
    "created_at": "2013-01-03T10:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133690",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:30'>**Comment 30:**</a>
Replying to [@kiwifb](#comment%3A29):
> OK will run some tests as well. I didn't know you had updated the spkg.

Sorry about that, I noticed it wouldn't install on 5.6-beta1, so I updated it (and changed to tuples at the same time).

Ok, added a updated the patch to add some doctests and remove `UniqueRepresentation` in favor of a module level variable.



---

archive/issue_comments_133691.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nAll tests past on 5.5 with the next to last patch. Since the the last changes are internal I don't think it will change the tests results. Thanks ohanar for the splendid work.",
    "created_at": "2013-01-03T10:27:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133691",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:31'>**Comment 31:**</a>
All tests past on 5.5 with the next to last patch. Since the the last changes are internal I don't think it will change the tests results. Thanks ohanar for the splendid work.



---

archive/issue_events_140067.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-01-03T11:07:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140067"
}
```



---

archive/issue_comments_133692.json:
```json
{
    "body": "**Author:** R. Andrew Ohana",
    "created_at": "2013-01-03T11:07:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133692",
    "user": "https://github.com/ohanar"
}
```

**Author:** R. Andrew Ohana



---

archive/issue_comments_133693.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nOk, all doctests are now filled and all functionality should be there, so I'm marking this as needs review.",
    "created_at": "2013-01-03T11:07:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133693",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:32'>**Comment 32:**</a>
Ok, all doctests are now filled and all functionality should be there, so I'm marking this as needs review.



---

archive/issue_comments_133694.json:
```json
{
    "body": "apply to sage library",
    "created_at": "2013-01-03T11:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133694",
    "user": "https://github.com/ohanar"
}
```

apply to sage library



---

archive/issue_comments_133695.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\n**Attachment:** [trac12205.patch.gz](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch.gz)\n\nwell, apparently sage doesn't like docstrings surrounded by `'''` instead of `\"\"\"`, so that is now fixed",
    "created_at": "2013-01-03T11:20:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133695",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:33'>**Comment 33:**</a>
**Attachment:** [trac12205.patch.gz](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch.gz)

well, apparently sage doesn't like docstrings surrounded by `'''` instead of `"""`, so that is now fixed



---

archive/issue_comments_133696.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nThis is very bizzare I had no doctests failures with the previous version of the patch (on top of 5.5) but with this new one I get \n\n```\nsage -t -long \"devel/sage-main/sage/algebras/free_algebra.py\"\nThe doctested process was killed by signal 11\n         [1.4 s]\n```\nBut if I add \"-verbose\" the test pass. There are no obvious relation with this ticket (and #10353 on which I am working at the same time) apart from the fact that it appeared out of the blue after application.",
    "created_at": "2013-01-04T10:02:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133696",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:34'>**Comment 34:**</a>
This is very bizzare I had no doctests failures with the previous version of the patch (on top of 5.5) but with this new one I get 

```
sage -t -long "devel/sage-main/sage/algebras/free_algebra.py"
The doctested process was killed by signal 11
         [1.4 s]
```
But if I add "-verbose" the test pass. There are no obvious relation with this ticket (and #10353 on which I am working at the same time) apart from the fact that it appeared out of the blue after application.



---

archive/issue_comments_133697.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nReplying to [@kiwifb](#comment%3A34):\n> This is very bizzare I had no doctests failures with the previous version of the patch (on top of 5.5) but with this new one I get \n> \n> ```\n> sage -t -long \"devel/sage-main/sage/algebras/free_algebra.py\"\n> The doctested process was killed by signal 11\n>          [1.4 s]\n> ```\n> But if I add \"-verbose\" the test pass.\n\nThat is very likely caused by an upstream bug in Cython that became immanent with #715.\n\nCan you try with the new Cython spkg from #13896? I.e., install that spkg and do sage -ba.",
    "created_at": "2013-01-04T10:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133697",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:35'>**Comment 35:**</a>
Replying to [@kiwifb](#comment%3A34):
> This is very bizzare I had no doctests failures with the previous version of the patch (on top of 5.5) but with this new one I get 
> 
> ```
> sage -t -long "devel/sage-main/sage/algebras/free_algebra.py"
> The doctested process was killed by signal 11
>          [1.4 s]
> ```
> But if I add "-verbose" the test pass.

That is very likely caused by an upstream bug in Cython that became immanent with #715.

Can you try with the new Cython spkg from #13896? I.e., install that spkg and do sage -ba.



---

archive/issue_comments_133698.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nThanks Simon. I have no time to do it tonight, I'll try tomorrow. As far as I am concerned this is the only thing that stand against a positive review. But I suspect it is as you say, and is just something bitting from another corner.",
    "created_at": "2013-01-04T10:42:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133698",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:36'>**Comment 36:**</a>
Thanks Simon. I have no time to do it tonight, I'll try tomorrow. As far as I am concerned this is the only thing that stand against a positive review. But I suspect it is as you say, and is just something bitting from another corner.



---

archive/issue_comments_133699.json:
```json
{
    "body": "**Reviewer:** Fran\u00e7ois Bissey",
    "created_at": "2013-01-05T08:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133699",
    "user": "https://github.com/kiwifb"
}
```

**Reviewer:** Fran√ßois Bissey



---

archive/issue_comments_133700.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nYup. Upgrading cython fixed the problem. I also checked that the thing would build properly not just upgrade from an existing sage. I am giving this a positive review.",
    "created_at": "2013-01-05T08:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133700",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:37'>**Comment 37:**</a>
Yup. Upgrading cython fixed the problem. I also checked that the thing would build properly not just upgrade from an existing sage. I am giving this a positive review.



---

archive/issue_events_140068.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-05T08:41:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140068"
}
```



---

archive/issue_events_140069.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-05T08:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140069"
}
```



---

archive/issue_comments_133701.json:
```json
{
    "body": "**Dependencies:** #13896",
    "created_at": "2013-01-05T09:36:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133701",
    "user": "https://github.com/simon-king-jena"
}
```

**Dependencies:** #13896



---

archive/issue_comments_133702.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nReplying to [@kiwifb](#comment%3A37):\n> Yup. Upgrading cython fixed the problem. I also checked that the thing would build properly not just upgrade from an existing sage. I am giving this a positive review.\n\nGreat! To be on the safe side, I add #13896 as a dependency, even though #13896 is a blocker with positive review (hence, is assumed to be in the next release).",
    "created_at": "2013-01-05T09:36:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133702",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:38'>**Comment 38:**</a>
Replying to [@kiwifb](#comment%3A37):
> Yup. Upgrading cython fixed the problem. I also checked that the thing would build properly not just upgrade from an existing sage. I am giving this a positive review.

Great! To be on the safe side, I add #13896 as a dependency, even though #13896 is a blocker with positive review (hence, is assumed to be in the next release).



---

archive/issue_events_140070.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-07T22:13:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140070"
}
```



---

archive/issue_events_140071.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-07T22:13:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140071"
}
```



---

archive/issue_comments_133703.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\nWhat is preventing this from being merged in 5.6?",
    "created_at": "2013-01-07T22:22:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133703",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:40'>**Comment 40:**</a>
What is preventing this from being merged in 5.6?



---

archive/issue_comments_133704.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nNothing really, but I feel like this should be merged while removing ZODB.",
    "created_at": "2013-01-07T22:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133704",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'>**Comment 41:**</a>
Nothing really, but I feel like this should be merged while removing ZODB.



---

archive/issue_comments_133705.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nI am not fussy about it. I think #10353 is ready but if you want it in two stages that's fine. Zodb is now gone from sage-on-gentoo and maintenance wise we won't miss it :).",
    "created_at": "2013-01-08T03:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133705",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'>**Comment 42:**</a>
I am not fussy about it. I think #10353 is ready but if you want it in two stages that's fine. Zodb is now gone from sage-on-gentoo and maintenance wise we won't miss it :).



---

archive/issue_events_140072.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-10T10:31:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140072"
}
```



---

archive/issue_events_140073.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-10T10:31:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140073"
}
```



---

archive/issue_comments_133706.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nThe sage-root patch needs to be rebased to sage-5.6.beta3.",
    "created_at": "2013-01-10T10:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133706",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'>**Comment 43:**</a>
The sage-root patch needs to be rebased to sage-5.6.beta3.



---

archive/issue_comments_133707.json:
```json
{
    "body": "**Attachment:** [trac12205_root.2.patch.gz](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch.gz)\n\nupdated sage_root repo patch",
    "created_at": "2013-01-14T10:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133707",
    "user": "https://github.com/kiwifb"
}
```

**Attachment:** [trac12205_root.2.patch.gz](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch.gz)

updated sage_root repo patch



---

archive/issue_comments_133708.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,5 +4,5 @@\n **Installation Instructions**\n * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).\n * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library\n-* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.patch) to the sage root repository\n+* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository\n \n``````\n",
    "created_at": "2013-01-14T10:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133708",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,5 +4,5 @@
 **Installation Instructions**
 * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).
 * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library
-* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.patch) to the sage root repository
+* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository
 
``````




---

archive/issue_events_140074.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-14T10:28:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140074"
}
```



---

archive/issue_events_140075.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-14T10:28:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140075"
}
```



---

archive/issue_comments_133709.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nI put a rebased version of the root repo patch and updated the ticket instructions accordingly. The rebasing was done against 5.6.rc0.",
    "created_at": "2013-01-14T10:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133709",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:44'>**Comment 44:**</a>
I put a rebased version of the root repo patch and updated the ticket instructions accordingly. The rebasing was done against 5.6.rc0.



---

archive/issue_comments_133710.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nPutting back to positive review.",
    "created_at": "2013-01-14T10:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133710",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:45'>**Comment 45:**</a>
Putting back to positive review.



---

archive/issue_events_140076.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-14T10:30:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140076"
}
```



---

archive/issue_events_140077.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2013-01-14T10:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140077"
}
```



---

archive/issue_comments_133711.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,5 +4,5 @@\n **Installation Instructions**\n * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).\n * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library\n-* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository\n+* Apply [attachment:trac12205_root.2.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository\n \n``````\n",
    "created_at": "2013-01-14T15:03:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133711",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,5 +4,5 @@
 **Installation Instructions**
 * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).
 * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library
-* Apply [trac12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository
+* Apply [attachment:trac12205_root.2.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository
 
``````




---

archive/issue_events_140078.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T10:26:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140078"
}
```



---

archive/issue_events_140079.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T10:26:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140079"
}
```



---

archive/issue_comments_133712.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,5 +4,5 @@\n **Installation Instructions**\n * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).\n * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library\n-* Apply [attachment:trac12205_root.2.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository\n+* Apply [attachment:12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch) to the sage root repository\n \n``````\n",
    "created_at": "2013-01-15T10:26:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133712",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,5 +4,5 @@
 **Installation Instructions**
 * Install the [new spkg](http://wstein.org/home/ohanar/spkgs/conway_polynomials-0.4.spkg).
 * Apply [trac12205.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205.patch) to the sage library
-* Apply [attachment:trac12205_root.2.patch](https://github.com/sagemath/sage/files/ticket12205/trac12205_root.2.patch) to the sage root repository
+* Apply [attachment:12205_root.patch](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch) to the sage root repository
 
``````




---

archive/issue_comments_133713.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\n**Attachment:** [12205_root.patch.gz](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch.gz)\n\nThis needs to depend on `$(SAGERUNTIME)`, not only the Sage library because we actually run Sage code.  See new patch.\n\nMoreover, this causes build problems for `sagenb`:\n\n```\nProcessing dependencies for Twisted==12.1.0\nSearching for zope.interface\n\nLink to http://pypi.python.org/simple/zope.interface/ ***BLOCKED*** by --allow-hosts\n\nCouldn't find index page for 'zope.interface' (maybe misspelled?)\nScanning index of all packages (this may take a while)\n\nLink to http://pypi.python.org/simple/ ***BLOCKED*** by --allow-hosts\n\nNo local packages or download links found for zope.interface\nerror: Could not find suitable distribution for Requirement.parse('zope.interface')\nError installing Twisted-12.1.0.tar.bz2 !\n```",
    "created_at": "2013-01-15T10:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133713",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'>**Comment 48:**</a>
**Attachment:** [12205_root.patch.gz](https://github.com/sagemath/sage/files/ticket12205/12205_root.patch.gz)

This needs to depend on `$(SAGERUNTIME)`, not only the Sage library because we actually run Sage code.  See new patch.

Moreover, this causes build problems for `sagenb`:

```
Processing dependencies for Twisted==12.1.0
Searching for zope.interface

Link to http://pypi.python.org/simple/zope.interface/ ***BLOCKED*** by --allow-hosts

Couldn't find index page for 'zope.interface' (maybe misspelled?)
Scanning index of all packages (this may take a while)

Link to http://pypi.python.org/simple/ ***BLOCKED*** by --allow-hosts

No local packages or download links found for zope.interface
error: Could not find suitable distribution for Requirement.parse('zope.interface')
Error installing Twisted-12.1.0.tar.bz2 !
```



---

archive/issue_comments_133714.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\nSAGERUNTIME? I hadn't seen that. I should have paid more attention to the originating ticket. OK I hadn't thought of twisted but the comment really is for #10353. I shall try to update the sagenb spkg to include zope.interface sometime this week.",
    "created_at": "2013-01-15T10:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133714",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:49'>**Comment 49:**</a>
SAGERUNTIME? I hadn't seen that. I should have paid more attention to the originating ticket. OK I hadn't thought of twisted but the comment really is for #10353. I shall try to update the sagenb spkg to include zope.interface sometime this week.



---

archive/issue_comments_133715.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nReplying to [@kiwifb](#comment%3A49):\n> SAGERUNTIME? I hadn't seen that.\n\nBasically, `$(INST)/$(SAGE)` is purely the Sage library (i.e. the stuff in `devel/sage`).  But actually starting Sage or running Sage code requires more, because things are imported from other packages, for example the notebook.  That stuff is in `$(SAGERUNTIME)`.\n\nIt used to be the case that `$(INST)/$(SAGE)` was what is essentially `$(SAGERUNTIME)` now.  But that's silly because it adds extra unneeded build-time dependencies for `$(INST)/$(SAGE)`, which needs a long time to build.",
    "created_at": "2013-01-15T10:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133715",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'>**Comment 50:**</a>
Replying to [@kiwifb](#comment%3A49):
> SAGERUNTIME? I hadn't seen that.

Basically, `$(INST)/$(SAGE)` is purely the Sage library (i.e. the stuff in `devel/sage`).  But actually starting Sage or running Sage code requires more, because things are imported from other packages, for example the notebook.  That stuff is in `$(SAGERUNTIME)`.

It used to be the case that `$(INST)/$(SAGE)` was what is essentially `$(SAGERUNTIME)` now.  But that's silly because it adds extra unneeded build-time dependencies for `$(INST)/$(SAGE)`, which needs a long time to build.



---

archive/issue_comments_133716.json:
```json
{
    "body": "<a id='comment:51'>**Comment 51:**</a>\nUnderstood. But zope.interface shouldn't be a blocker for this ticket, only for #10353.",
    "created_at": "2013-01-15T10:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133716",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:51'>**Comment 51:**</a>
Understood. But zope.interface shouldn't be a blocker for this ticket, only for #10353.



---

archive/issue_comments_133717.json:
```json
{
    "body": "<a id='comment:52'>**Comment 52:**</a>\nReplying to [@kiwifb](#comment%3A51):\n> Understood. But zope.interface shouldn't be a blocker for this ticket, only for #10353.\n\nFair enough, I always confuse these two tickets.",
    "created_at": "2013-01-15T10:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133717",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'>**Comment 52:**</a>
Replying to [@kiwifb](#comment%3A51):
> Understood. But zope.interface shouldn't be a blocker for this ticket, only for #10353.

Fair enough, I always confuse these two tickets.



---

archive/issue_events_140080.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T10:45:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140080"
}
```



---

archive/issue_events_140081.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T10:45:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140081"
}
```



---

archive/issue_comments_133718.json:
```json
{
    "body": "**Changing dependencies** from \"#13896\" to \"#13896, #13963\".",
    "created_at": "2013-01-17T11:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133718",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#13896" to "#13896, #13963".



---

archive/issue_comments_133719.json:
```json
{
    "body": "<a id='comment:54'>**Comment 54:**</a>\nPotential build failures due to #13963.",
    "created_at": "2013-01-17T11:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133719",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:54'>**Comment 54:**</a>
Potential build failures due to #13963.



---

archive/issue_comments_133720.json:
```json
{
    "body": "<a id='comment:55'>**Comment 55:**</a>\nCould this have caused (note this is over `GF(8)`):\n\n```\nsage -t  \"devel/sage-main/sage/rings/polynomial/polynomial_ring.py\"\n**********************************************************************\nFile \"/release/merger/sage-5.7.beta0/devel/sage-main/sage/rings/polynomial/polynomial_ring.py\", line 1641:\n    sage: R.lagrange_polynomial([(a^2+a,a),(a,1),(a^2,a^2+a+1)], algorithm=\"neville\", previous_row=p)[-1]\nExpected:\n    a^2*x^2 + a^2*x + a^2\nGot:\n    a^2*x^2 + a*x + a^2 + a\n**********************************************************************\n```",
    "created_at": "2013-01-18T08:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133720",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'>**Comment 55:**</a>
Could this have caused (note this is over `GF(8)`):

```
sage -t  "devel/sage-main/sage/rings/polynomial/polynomial_ring.py"
**********************************************************************
File "/release/merger/sage-5.7.beta0/devel/sage-main/sage/rings/polynomial/polynomial_ring.py", line 1641:
    sage: R.lagrange_polynomial([(a^2+a,a),(a,1),(a^2,a^2+a+1)], algorithm="neville", previous_row=p)[-1]
Expected:
    a^2*x^2 + a^2*x + a^2
Got:
    a^2*x^2 + a*x + a^2 + a
**********************************************************************
```



---

archive/issue_comments_133721.json:
```json
{
    "body": "<a id='comment:56'>**Comment 56:**</a>\nIs it a new doctest? I see this on unreleased 5.7.beta0. I agressively patched sage-on-gentoo (5.5) to get rid of zodb and we haven't seen that anywhere. I'll admit the move to new gap is giving me trouble but it should be unrelated - or should it?",
    "created_at": "2013-01-18T08:21:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133721",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:56'>**Comment 56:**</a>
Is it a new doctest? I see this on unreleased 5.7.beta0. I agressively patched sage-on-gentoo (5.5) to get rid of zodb and we haven't seen that anywhere. I'll admit the move to new gap is giving me trouble but it should be unrelated - or should it?



---

archive/issue_comments_133722.json:
```json
{
    "body": "<a id='comment:57'>**Comment 57:**</a>\nReplying to [@kiwifb](#comment%3A56):\n> Is it a new doctest?\n\nNo, it's not.  On first sight, it doesn't seem to use anything besides basic polynomial arithmetic.  But if basic polynomial arithmetic were broken, we would see a lot more doctests failing.\n\nI'm not at all saying that this ticket has anything to do with it, I merge a bunch of tickets and when there's a failure I have to guess which ticket caused it.",
    "created_at": "2013-01-18T08:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133722",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:57'>**Comment 57:**</a>
Replying to [@kiwifb](#comment%3A56):
> Is it a new doctest?

No, it's not.  On first sight, it doesn't seem to use anything besides basic polynomial arithmetic.  But if basic polynomial arithmetic were broken, we would see a lot more doctests failing.

I'm not at all saying that this ticket has anything to do with it, I merge a bunch of tickets and when there's a failure I have to guess which ticket caused it.



---

archive/issue_events_140082.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T21:12:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140082"
}
```



---

archive/issue_events_140083.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T21:12:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12205#event-140083"
}
```



---

archive/issue_comments_133723.json:
```json
{
    "body": "**Merged:** sage-5.7.beta0",
    "created_at": "2013-01-21T21:12:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133723",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.7.beta0



---

archive/issue_comments_133724.json:
```json
{
    "body": "<a id='comment:59'>**Comment 59:**</a>\nHas anybody noticed the very very long string of primes you get when installing this spkg yet?  This is with beta1 + #6495, but I assume it is part of this spkg.  See [the log](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.log).",
    "created_at": "2013-01-30T03:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133724",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:59'>**Comment 59:**</a>
Has anybody noticed the very very long string of primes you get when installing this spkg yet?  This is with beta1 + #6495, but I assume it is part of this spkg.  See [the log](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.log).



---

archive/issue_comments_133725.json:
```json
{
    "body": "<a id='comment:60'>**Comment 60:**</a>\nIt is part of the spkg. Don't ask me why ohanar put a \"print p \" in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.",
    "created_at": "2013-01-30T03:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133725",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:60'>**Comment 60:**</a>
It is part of the spkg. Don't ask me why ohanar put a "print p " in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.



---

archive/issue_comments_133726.json:
```json
{
    "body": "<a id='comment:61'>**Comment 61:**</a>\n> It is part of the spkg. Don't ask me why ohanar put a \"print p \" in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.\n\nDon't worry, it wasn't directed at anyone in particular!  Presumably it's something left over from debugging.  Shall I assume this is to be considered non-optimal and a ticket should be opened?",
    "created_at": "2013-01-30T03:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133726",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:61'>**Comment 61:**</a>
> It is part of the spkg. Don't ask me why ohanar put a "print p " in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.

Don't worry, it wasn't directed at anyone in particular!  Presumably it's something left over from debugging.  Shall I assume this is to be considered non-optimal and a ticket should be opened?



---

archive/issue_comments_133727.json:
```json
{
    "body": "<a id='comment:62'>**Comment 62:**</a>\nfbissey: sage-on-gentoo is like a third level of ticket review after the official reviewer and the release manager! :D",
    "created_at": "2013-01-30T17:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133727",
    "user": "https://github.com/kini"
}
```

<a id='comment:62'>**Comment 62:**</a>
fbissey: sage-on-gentoo is like a third level of ticket review after the official reviewer and the release manager! :D



---

archive/issue_comments_133728.json:
```json
{
    "body": "<a id='comment:63'>**Comment 63:**</a>\n> > It is part of the spkg. Don't ask me why ohanar put a \"print p \" in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.\n\n> Don't worry, it wasn't directed at anyone in particular!  Presumably it's something left over from debugging.  Shall I assume this is to be considered non-optimal and a ticket should be opened?\n\nSo... should I open a ticket?  It does seem bizarre, and apparently easily fixed?  But if it was necessary, I don't want to.",
    "created_at": "2013-02-07T02:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133728",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:63'>**Comment 63:**</a>
> > It is part of the spkg. Don't ask me why ohanar put a "print p " in there. I don't mind the spam but I had a complaint about it in sage-on-gentoo and removed it there.

> Don't worry, it wasn't directed at anyone in particular!  Presumably it's something left over from debugging.  Shall I assume this is to be considered non-optimal and a ticket should be opened?

So... should I open a ticket?  It does seem bizarre, and apparently easily fixed?  But if it was necessary, I don't want to.



---

archive/issue_comments_133729.json:
```json
{
    "body": "<a id='comment:64'>**Comment 64:**</a>\nThat's very easy to fix but opening a ticket is pretty much the only way it will ever get merged.",
    "created_at": "2013-02-07T02:19:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133729",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'>**Comment 64:**</a>
That's very easy to fix but opening a ticket is pretty much the only way it will ever get merged.



---

archive/issue_comments_133730.json:
```json
{
    "body": "<a id='comment:65'>**Comment 65:**</a>\n> That's very easy to fix but opening a ticket is pretty much the only way it will ever get merged.\n\n#14075",
    "created_at": "2013-02-07T02:57:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12205#issuecomment-133730",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:65'>**Comment 65:**</a>
> That's very easy to fix but opening a ticket is pretty much the only way it will ever get merged.

#14075
