# Issue 12402: Make a three.js backend for 3d plotting

archive/issues_012230.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/williamstein"
    ],
    "body": "Usage: `show( plot3d, viewer='threejs' )` or `plot3d( ..., viewer='threejs')`\n\n---\n\nSEE https://github.com/mrdoob/three.js/\n\nSee the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2\n\nSome resources:\n\nhttp://learningthreejs.com/\n\nhttp://aerotwist.com/lab/getting-started-with-three-js/\n\nhttp://dev.opera.com/articles/view/porting-3d-graphics-to-the-web-webgl-intro-part-2/\n\nhttps://github.com/mrdoob/three.js\n\nhttp://sagenb.org/home/pub/4176/ (experiment in sage)\n\nCC:  @kini @novoselt @sagetrac-mbejger @gagern @egourgoulhon @paulmasson @yuan-zhou @mkoeppe\n\nBranch: **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**\n\nReviewer: **Eric Gourgoulhon, Andrey Novoseltsev, William Stein**\n\nAuthor: **Paul Masson**\n\nComponent: **graphics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12402_\n\n",
    "closed_at": "2016-12-01T22:32:46Z",
    "created_at": "2012-01-31T14:26:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make a three.js backend for 3d plotting",
    "type": "issue",
    "updated_at": "2021-10-25T14:11:37Z",
    "url": "https://github.com/sagemath/sage/issues/12402",
    "user": "https://github.com/jasongrout"
}
```
Usage: `show( plot3d, viewer='threejs' )` or `plot3d( ..., viewer='threejs')`

---

SEE https://github.com/mrdoob/three.js/

See the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2

Some resources:

http://learningthreejs.com/

http://aerotwist.com/lab/getting-started-with-three-js/

http://dev.opera.com/articles/view/porting-3d-graphics-to-the-web-webgl-intro-part-2/

https://github.com/mrdoob/three.js

http://sagenb.org/home/pub/4176/ (experiment in sage)

CC:  @kini @novoselt @sagetrac-mbejger @gagern @egourgoulhon @paulmasson @yuan-zhou @mkoeppe

Branch: **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**

Reviewer: **Eric Gourgoulhon, Andrey Novoseltsev, William Stein**

Author: **Paul Masson**

Component: **graphics**

_Issue created by migration from https://trac.sagemath.org/ticket/12402_





---

archive/issue_events_169920.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169920"
}
```



---

archive/issue_events_169921.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169921"
}
```



---

archive/issue_events_169922.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169922"
}
```



---

archive/issue_events_169923.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169923"
}
```



---

archive/issue_events_169924.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "subject": "https://github.com/jasongrout",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169924"
}
```



---

archive/issue_events_169925.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-31T14:26:29Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "subject": "https://github.com/jasongrout",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169925"
}
```



---

archive/issue_comments_135449.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+SEE https://github.com/mrdoob/three.js/\n+\n See the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2\n \n Some resources:\n``````\n",
    "created_at": "2012-02-29T20:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135449",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+SEE https://github.com/mrdoob/three.js/
+
 See the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2
 
 Some resources:
``````




---

archive/issue_comments_135450.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nJason, William, can you put whatever code exists on here since public worksheets are disabled?  We don't want this just in the cloud.sagemath :-)",
    "created_at": "2013-06-19T23:46:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135450",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

Jason, William, can you put whatever code exists on here since public worksheets are disabled?  We don't want this just in the cloud.sagemath :-)



---

archive/issue_comments_135451.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[three.js.sws.gz](https://github.com/sagemath/sage/files/ticket12402/three.js.sws.gz)**\n\nhttps://github.com/williamstein/sd48/blob/master/threejs/grout-demo.sagews",
    "created_at": "2013-06-20T00:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135451",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[three.js.sws.gz](https://github.com/sagemath/sage/files/ticket12402/three.js.sws.gz)**

https://github.com/williamstein/sd48/blob/master/threejs/grout-demo.sagews



---

archive/issue_comments_135452.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nJust as an update, this is now apparently working in cloud.sagemath.",
    "created_at": "2013-07-05T14:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135452",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

Just as an update, this is now apparently working in cloud.sagemath.



---

archive/issue_comments_135453.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@kcrisman](#comment:6):\n> Just as an update, this is now apparently working in cloud.sagemath.\n\nIt sort of works, but it isn't included by default.   It will be soon though, so that anybody can at least test out some minimal functionality.  I'll post when that happens.",
    "created_at": "2013-07-05T19:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135453",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@kcrisman](#comment:6):
> Just as an update, this is now apparently working in cloud.sagemath.

It sort of works, but it isn't included by default.   It will be soon though, so that anybody can at least test out some minimal functionality.  I'll post when that happens.



---

archive/issue_events_169926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169926"
}
```



---

archive/issue_events_169927.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169927"
}
```



---

archive/issue_events_169928.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169928"
}
```



---

archive/issue_events_169929.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169929"
}
```



---

archive/issue_events_169930.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169930"
}
```



---

archive/issue_events_169931.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169931"
}
```



---

archive/issue_comments_135454.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nJust FYI, there are now three different threejs backends: SMC, the threejs command in the sage cell, and the pythreejs-based backend that works in the sage cell too.",
    "created_at": "2014-06-11T00:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135454",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:12" align="right">comment:12</div>

Just FYI, there are now three different threejs backends: SMC, the threejs command in the sage cell, and the pythreejs-based backend that works in the sage cell too.



---

archive/issue_comments_135455.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nJason - what is the status of the last one? Will it be pushed to get \"standard\" or there is still work to be done there and with your switch nobody is available to steer it?\n\nThe first two were definitely lacking features, in particular \"things that don't scale with zoom\" plus some transparency issues.",
    "created_at": "2014-06-11T00:34:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135455",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:13" align="right">comment:13</div>

Jason - what is the status of the last one? Will it be pushed to get "standard" or there is still work to be done there and with your switch nobody is available to steer it?

The first two were definitely lacking features, in particular "things that don't scale with zoom" plus some transparency issues.



---

archive/issue_comments_135456.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe transparency issues are not fixed---those are inherent in how three.js draws things, and stem from limitations of webgl (there are experiements overcoming them in webgl, which might be interesting to look at, though; the author of mathbox is looking at them, for example).\n\nI think that anything \"pushed to standard\" should be supported by SMC and the sage cell.  Right now, the pythreejs solution requires an communication framework that is/emulates the ipython comm/widget framework.  Something like that would need to be implemented for SMC to get it to work there.  I think that would be a great project in itself, though---there is starting to be some good development of interactive things for the IPython notebook, and it would be great to use those things from SMC too.",
    "created_at": "2014-06-11T02:16:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135456",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:14" align="right">comment:14</div>

The transparency issues are not fixed---those are inherent in how three.js draws things, and stem from limitations of webgl (there are experiements overcoming them in webgl, which might be interesting to look at, though; the author of mathbox is looking at them, for example).

I think that anything "pushed to standard" should be supported by SMC and the sage cell.  Right now, the pythreejs solution requires an communication framework that is/emulates the ipython comm/widget framework.  Something like that would need to be implemented for SMC to get it to work there.  I think that would be a great project in itself, though---there is starting to be some good development of interactive things for the IPython notebook, and it would be great to use those things from SMC too.



---

archive/issue_comments_135457.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n> I think that anything \"pushed to standard\" should be supported by SMC and the sage cell.  Right now, the pythreejs solution requires an communication framework that is/emulates the ipython comm/widget framework.  Something like that would need to be implemented for SMC to get it to work there.  I think that would be a great project in itself, though---there is starting to be some good development of interactive things for the IPython notebook, and it would be great to use those things from SMC too.\n\nBut I thought SMC only uses the js plotting - does it also do Jmols too?  (You'll notice I still haven't had time to properly try out SMC, and won't for some time).\n\n---\n\nSee also #16004 as a related ticket I also haven't had enough time to review properly.",
    "created_at": "2014-06-11T02:30:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135457",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:15" align="right">comment:15</div>

> I think that anything "pushed to standard" should be supported by SMC and the sage cell.  Right now, the pythreejs solution requires an communication framework that is/emulates the ipython comm/widget framework.  Something like that would need to be implemented for SMC to get it to work there.  I think that would be a great project in itself, though---there is starting to be some good development of interactive things for the IPython notebook, and it would be great to use those things from SMC too.

But I thought SMC only uses the js plotting - does it also do Jmols too?  (You'll notice I still haven't had time to properly try out SMC, and won't for some time).

---

See also #16004 as a related ticket I also haven't had enough time to review properly.



---

archive/issue_comments_135458.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jasongrout](#comment:12):\n> Just FYI, there are now three different threejs backends: SMC, the threejs command in the sage cell, and the pythreejs-based backend that works in the sage cell too.\n\nThanks :-) I am interested in enhancing the capabilities of SageManifolds (#14865), which is still under development, so I guess the most natural thing would be to somehow use threejs locally. Probably this question was asked already many times, but what is the current status of threejs in sage notebook (local ipython notebook)?",
    "created_at": "2014-06-11T08:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135458",
    "user": "https://github.com/sagetrac-mbejger"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jasongrout](#comment:12):
> Just FYI, there are now three different threejs backends: SMC, the threejs command in the sage cell, and the pythreejs-based backend that works in the sage cell too.

Thanks :-) I am interested in enhancing the capabilities of SageManifolds (#14865), which is still under development, so I guess the most natural thing would be to somehow use threejs locally. Probably this question was asked already many times, but what is the current status of threejs in sage notebook (local ipython notebook)?



---

archive/issue_comments_135459.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n> Thanks :-) I am interested in enhancing the capabilities of SageManifolds (#14865), which is still under development, so I guess the most natural thing would be to somehow use threejs locally. Probably this question was asked already many times, but what is the current status of threejs in sage notebook (local ipython notebook)?\n\nThe Sagenb is not really at all an Ipython notebook, though it may have inspired earlier versions thereof.  Anyway, the current status is that you can get it to work - see the examples above - but no one has put time into this.  Partly because the sagenb is in maintenance mode currently (though it would be nice to have it more actively developed) but also because of the slight backwards functionality loss involved as you see in previous comments.",
    "created_at": "2014-06-11T12:26:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135459",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:17" align="right">comment:17</div>

> Thanks :-) I am interested in enhancing the capabilities of SageManifolds (#14865), which is still under development, so I guess the most natural thing would be to somehow use threejs locally. Probably this question was asked already many times, but what is the current status of threejs in sage notebook (local ipython notebook)?

The Sagenb is not really at all an Ipython notebook, though it may have inspired earlier versions thereof.  Anyway, the current status is that you can get it to work - see the examples above - but no one has put time into this.  Partly because the sagenb is in maintenance mode currently (though it would be nice to have it more actively developed) but also because of the slight backwards functionality loss involved as you see in previous comments.



---

archive/issue_events_169932.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169932"
}
```



---

archive/issue_events_169933.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169933"
}
```



---

archive/issue_comments_135460.json:
```json
{
    "body": "Branch: **[u/paulmasson/12402](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/12402)**",
    "created_at": "2016-09-29T23:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135460",
    "user": "https://github.com/paulmasson"
}
```

Branch: **[u/paulmasson/12402](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/12402)**



---

archive/issue_events_169934.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-09-30T00:05:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169934"
}
```



---

archive/issue_comments_135461.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n+Usage: `threejs( plot3d )`\n+\n+---\n+\n SEE https://github.com/mrdoob/three.js/\n \n See the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2\n``````\n",
    "created_at": "2016-09-30T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135461",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
+Usage: `threejs( plot3d )`
+
+---
+
 SEE https://github.com/mrdoob/three.js/
 
 See the big discussion at http://groups.google.com/group/sage-devel/browse_thread/thread/d3e4a24aebc906a2
``````




---

archive/issue_comments_135462.json:
```json
{
    "body": "Commit: **[`7cedf75`](https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05)**",
    "created_at": "2016-09-30T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135462",
    "user": "https://github.com/paulmasson"
}
```

Commit: **[`7cedf75`](https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05)**



---

archive/issue_comments_135463.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nHere's some basic Three.js support for `Graphics3d` objects. It is modeled on the corresponding function in SageMathCell: simply use `threejs()` to wrap any combination of points, lines and surfaces. This will save an HTML file with the JavaScript needed to render the scene and open it in a browser.\n\nThere are a great many features that can be added in the future, but I first would like to see how much interest there is in this. There have been problems surfacing with Jmol (#20978 for example) and I certainly think it would be preferable to have a native viewer that can be updated more quickly. The HTML format is also more portable than Jmol files, since it only requires a modern browser to run.\n\nThis version relies on an external CDN to retrieve the Three.js library, since it does not currently download to the hard drive during the build process. I'll need help on figuring out how to change that at some point, since I'm sure people will want to be able to view saved files offline.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d1cd2a50af427948e452384a4e9b718219f3d11\"><code>3d1cd2a</code></a></td><td><code>Handle nested lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efb3d0ad837cf9dfb0586b9406e0fa221fe6c029\"><code>efb3d0a</code></a></td><td><code>Handle nested lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f70ac3d88444db0e433d529f9d43a659365e21c7\"><code>f70ac3d</code></a></td><td><code>Add line plots</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55f12e66a429c7b6e1516ee567c5b378b27ea40b\"><code>55f12e6</code></a></td><td><code>Add point plots</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4c8414646fb0560134cfb76b3eb76fb89442b58\"><code>b4c8414</code></a></td><td><code>Adjust centering and camera</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/374809a0bf1bab09a75be56f609f92efc96dc6e5\"><code>374809a</code></a></td><td><code>Rebase to move point bounds off points</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a42352c4146dff0d9d065bed7b180f6281b99e6\"><code>9a42352</code></a></td><td><code>Add auto z-aspect</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5606831d2412b2503e84e8c74a97b49193341ea\"><code>d560683</code></a></td><td><code>Minor rebase</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa322adf4ec1b5867e9e18729233d86d058830dd\"><code>aa322ad</code></a></td><td><code>Add axis labels</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05\"><code>7cedf75</code></a></td><td><code>Check for equal bounds</code></td></tr></table>\n",
    "created_at": "2016-09-30T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135463",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:23" align="right">comment:23</div>

Here's some basic Three.js support for `Graphics3d` objects. It is modeled on the corresponding function in SageMathCell: simply use `threejs()` to wrap any combination of points, lines and surfaces. This will save an HTML file with the JavaScript needed to render the scene and open it in a browser.

There are a great many features that can be added in the future, but I first would like to see how much interest there is in this. There have been problems surfacing with Jmol (#20978 for example) and I certainly think it would be preferable to have a native viewer that can be updated more quickly. The HTML format is also more portable than Jmol files, since it only requires a modern browser to run.

This version relies on an external CDN to retrieve the Three.js library, since it does not currently download to the hard drive during the build process. I'll need help on figuring out how to change that at some point, since I'm sure people will want to be able to view saved files offline.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d1cd2a50af427948e452384a4e9b718219f3d11"><code>3d1cd2a</code></a></td><td><code>Handle nested lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efb3d0ad837cf9dfb0586b9406e0fa221fe6c029"><code>efb3d0a</code></a></td><td><code>Handle nested lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f70ac3d88444db0e433d529f9d43a659365e21c7"><code>f70ac3d</code></a></td><td><code>Add line plots</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55f12e66a429c7b6e1516ee567c5b378b27ea40b"><code>55f12e6</code></a></td><td><code>Add point plots</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4c8414646fb0560134cfb76b3eb76fb89442b58"><code>b4c8414</code></a></td><td><code>Adjust centering and camera</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/374809a0bf1bab09a75be56f609f92efc96dc6e5"><code>374809a</code></a></td><td><code>Rebase to move point bounds off points</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a42352c4146dff0d9d065bed7b180f6281b99e6"><code>9a42352</code></a></td><td><code>Add auto z-aspect</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5606831d2412b2503e84e8c74a97b49193341ea"><code>d560683</code></a></td><td><code>Minor rebase</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa322adf4ec1b5867e9e18729233d86d058830dd"><code>aa322ad</code></a></td><td><code>Add axis labels</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05"><code>7cedf75</code></a></td><td><code>Check for equal bounds</code></td></tr></table>




---

archive/issue_events_169935.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-09-30T00:05:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169935"
}
```



---

archive/issue_events_169936.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-09-30T00:05:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169936"
}
```



---

archive/issue_comments_135464.json:
```json
{
    "body": "Author: **Paul Masson**",
    "created_at": "2016-09-30T00:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135464",
    "user": "https://github.com/paulmasson"
}
```

Author: **Paul Masson**



---

archive/issue_comments_135465.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nWow! I've just tried it and it's very nice! Thank you very much for this enhancement!\n\nA question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?",
    "created_at": "2016-09-30T14:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135465",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:25" align="right">comment:25</div>

Wow! I've just tried it and it's very nice! Thank you very much for this enhancement!

A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?



---

archive/issue_comments_135466.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n> A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?\n\nSee e.g. [here](https://ask.sagemath.org/question/32890/axes-labels-on-3d-plots/) - this would be a very good enhancement, though I guess it would have to then depend on the backend.\n\nCan you think of anything it does *not* do?  I seem to recall that there were things jsmol did with shading etc. that three.js couldn't, when this was discussed ~ 5 years ago.",
    "created_at": "2016-09-30T14:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135466",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:26" align="right">comment:26</div>

> A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?

See e.g. [here](https://ask.sagemath.org/question/32890/axes-labels-on-3d-plots/) - this would be a very good enhancement, though I guess it would have to then depend on the backend.

Can you think of anything it does *not* do?  I seem to recall that there were things jsmol did with shading etc. that three.js couldn't, when this was discussed ~ 5 years ago.



---

archive/issue_comments_135467.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@kcrisman](#comment:26):\n> > A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?\n\n> See e.g. [here](https://ask.sagemath.org/question/32890/axes-labels-on-3d-plots/) \n\nYes, `set_axes_labels` is the (not very satisfactory) workaround I wrote to deal with this when using Jmol ;-)\n\n>- this would be a very good enhancement, though I guess it would have to then depend on the backend.\n\nMaybe not: looking at the source code, in line 155 of `src/sage/plot/plot3d/threejs.py`, there is\n\n```\naddLabel( 'x=' + ( xMid ).toFixed(d).toString(), xMid, b[1].y+offset, a[2]*b[0].z );\n```\n\nIt seems easy to replace `'x='` by another string. \n\n> \n> Can you think of anything it does *not* do?\n\nNot at the moment. I'll play with it further.",
    "created_at": "2016-09-30T14:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135467",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@kcrisman](#comment:26):
> > A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?

> See e.g. [here](https://ask.sagemath.org/question/32890/axes-labels-on-3d-plots/) 

Yes, `set_axes_labels` is the (not very satisfactory) workaround I wrote to deal with this when using Jmol ;-)

>- this would be a very good enhancement, though I guess it would have to then depend on the backend.

Maybe not: looking at the source code, in line 155 of `src/sage/plot/plot3d/threejs.py`, there is

```
addLabel( 'x=' + ( xMid ).toFixed(d).toString(), xMid, b[1].y+offset, a[2]*b[0].z );
```

It seems easy to replace `'x='` by another string. 

> 
> Can you think of anything it does *not* do?

Not at the moment. I'll play with it further.



---

archive/issue_comments_135468.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nPS: Another relevant project is K3D, which was presented at Sage Days 74:\n\nhttps://wiki.sagemath.org/K3D-tools",
    "created_at": "2016-09-30T14:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135468",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:28" align="right">comment:28</div>

PS: Another relevant project is K3D, which was presented at Sage Days 74:

https://wiki.sagemath.org/K3D-tools



---

archive/issue_comments_135469.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@egourgoulhon](#comment:28):\n> PS: Another relevant project is K3D, which was presented at Sage Days 74:\n> \n> https://wiki.sagemath.org/K3D-tools\n\nIt's good to know about this project, but I'm aiming for something more general and not focused just on notebooks. Matplotlib lets you create and save image files for 2d plots. I'd like something equivalent for 3d plots, which for Three.js is a self-contained HTML file.",
    "created_at": "2016-09-30T20:05:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135469",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@egourgoulhon](#comment:28):
> PS: Another relevant project is K3D, which was presented at Sage Days 74:
> 
> https://wiki.sagemath.org/K3D-tools

It's good to know about this project, but I'm aiming for something more general and not focused just on notebooks. Matplotlib lets you create and save image files for 2d plots. I'd like something equivalent for 3d plots, which for Three.js is a self-contained HTML file.



---

archive/issue_comments_135470.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@egourgoulhon](#comment:27):\n> Replying to [@kcrisman](#comment:26):\n> >- this would be a very good enhancement, though I guess it would have to then depend on the backend.\n\n> \n> Maybe not: looking at the source code, in line 155 of `src/sage/plot/plot3d/threejs.py`, there is\n> \n> ```\n> addLabel( 'x=' + ( xMid ).toFixed(d).toString(), xMid, b[1].y+offset, a[2]*b[0].z );\n> ```\n> \n> It seems easy to replace `'x='` by another string. \n\nSince this is done in a browswer, and they all understand Unicode now, there won't be issues with missing fonts like in matplotlib. This is an easy customization.",
    "created_at": "2016-09-30T20:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135470",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@egourgoulhon](#comment:27):
> Replying to [@kcrisman](#comment:26):
> >- this would be a very good enhancement, though I guess it would have to then depend on the backend.

> 
> Maybe not: looking at the source code, in line 155 of `src/sage/plot/plot3d/threejs.py`, there is
> 
> ```
> addLabel( 'x=' + ( xMid ).toFixed(d).toString(), xMid, b[1].y+offset, a[2]*b[0].z );
> ```
> 
> It seems easy to replace `'x='` by another string. 

Since this is done in a browswer, and they all understand Unicode now, there won't be issues with missing fonts like in matplotlib. This is an easy customization.



---

archive/issue_comments_135471.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@kcrisman](#comment:26):\n> Can you think of anything it does *not* do?  I seem to recall that there were things jsmol did with shading etc. that three.js couldn't, when this was discussed ~ 5 years ago.\n\nI would find it difficult to believe that current Three.js can't match anything in Jmol. The transparency issue mentioned above can likely be handled with the `alphaMap` property that appeared in Three.js about the same time as the comment, and if not that way then by a custom shader which isn't difficult to implement.",
    "created_at": "2016-09-30T20:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135471",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@kcrisman](#comment:26):
> Can you think of anything it does *not* do?  I seem to recall that there were things jsmol did with shading etc. that three.js couldn't, when this was discussed ~ 5 years ago.

I would find it difficult to believe that current Three.js can't match anything in Jmol. The transparency issue mentioned above can likely be handled with the `alphaMap` property that appeared in Three.js about the same time as the comment, and if not that way then by a custom shader which isn't difficult to implement.



---

archive/issue_comments_135472.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@egourgoulhon](#comment:25):\n> Wow! I've just tried it and it's very nice! Thank you very much for this enhancement!\n> \n> A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?\n\nThanks for trying it out! I'm trying to decide between reading the `show()` options of the plots fed into `threejs()` or just have a separate dictionary, but should probably do the latter. That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.\n\nThere is already automatic scaling in the z-direction to avoid the tall thin box that appears in the current version on the cell server (and SMC), but that can easily be overridden. I can also easily add face colors to support surfaces with color maps. Lights for the scene are meant to be customizable as well and can stand some additional improvement.\n\nThe initial camera position is not yet completely adaptive to the possible variety of input plots, so ideas on that would be welcome.",
    "created_at": "2016-09-30T20:30:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135472",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@egourgoulhon](#comment:25):
> Wow! I've just tried it and it's very nice! Thank you very much for this enhancement!
> 
> A question: is it possible to customize the axes labels (e.g. via the keyword argument `axes_labels`, as in 2D plots)?

Thanks for trying it out! I'm trying to decide between reading the `show()` options of the plots fed into `threejs()` or just have a separate dictionary, but should probably do the latter. That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.

There is already automatic scaling in the z-direction to avoid the tall thin box that appears in the current version on the cell server (and SMC), but that can easily be overridden. I can also easily add face colors to support surfaces with color maps. Lights for the scene are meant to be customizable as well and can stand some additional improvement.

The initial camera position is not yet completely adaptive to the possible variety of input plots, so ideas on that would be welcome.



---

archive/issue_comments_135473.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nWe most definitely want this in, so please keep working!!!\n\nNote that we have optional threejs package (SageMathCell is using it) - if we have a functioning viewer we can easily make is standard as it is small and very fast to install.\n\nInterface-wise let's stick to `show` for the actual showing of stuff and `plot/plot3d` for producing plots that can be further manipulated. `threejs` command if it exists at all should do something like set up a low-level threejs scene that can be tweaked as advanced users please. Presumably, it is possible to just pass some HTML/JavaScript code that will be inserted into generated files?",
    "created_at": "2016-10-02T19:25:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135473",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:34" align="right">comment:34</div>

We most definitely want this in, so please keep working!!!

Note that we have optional threejs package (SageMathCell is using it) - if we have a functioning viewer we can easily make is standard as it is small and very fast to install.

Interface-wise let's stick to `show` for the actual showing of stuff and `plot/plot3d` for producing plots that can be further manipulated. `threejs` command if it exists at all should do something like set up a low-level threejs scene that can be tweaked as advanced users please. Presumably, it is possible to just pass some HTML/JavaScript code that will be inserted into generated files?



---

archive/issue_comments_135474.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nFile-wise: perhaps instead of raw string it is possible to have `template_three.js` file that will be read/cached by the Python function? Perhaps with `template_three.js.html` to further wrap it into a standalone page. One of the advantages for development - syntax highlighting of this long template.",
    "created_at": "2016-10-02T19:29:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135474",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:35" align="right">comment:35</div>

File-wise: perhaps instead of raw string it is possible to have `template_three.js` file that will be read/cached by the Python function? Perhaps with `template_three.js.html` to further wrap it into a standalone page. One of the advantages for development - syntax highlighting of this long template.



---

archive/issue_comments_135475.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nSo it seems that at the moment opacity is ignored and line thickness is not taken into account - is it possible to implement these?\n\nAlso when I scale the image text grows/shrinks and then \"becomes normal again\" - is it possible to always keep it the same size throughout the transition?",
    "created_at": "2016-10-02T21:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135475",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:36" align="right">comment:36</div>

So it seems that at the moment opacity is ignored and line thickness is not taken into account - is it possible to implement these?

Also when I scale the image text grows/shrinks and then "becomes normal again" - is it possible to always keep it the same size throughout the transition?



---

archive/issue_comments_135476.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nWhat about embedding the resulting plots into web-page, i.e. how easy it is for someone-not-really-knowing-anything to take a plot from Sage and have it running on their web-page? (No using [SageMathCell](../wiki/SageMathCell), just having the three.js stuff properly saved/inserted somewhere.)",
    "created_at": "2016-10-02T21:22:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135476",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:37" align="right">comment:37</div>

What about embedding the resulting plots into web-page, i.e. how easy it is for someone-not-really-knowing-anything to take a plot from Sage and have it running on their web-page? (No using [SageMathCell](../wiki/SageMathCell), just having the three.js stuff properly saved/inserted somewhere.)



---

archive/issue_comments_135477.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@novoselt](#comment:37):\n> What about embedding the resulting plots into web-page, i.e. how easy it is for someone-not-really-knowing-anything to take a plot from Sage and have it running on their web-page? (No using [SageMathCell](../wiki/SageMathCell), just having the three.js stuff properly saved/inserted somewhere.)\n\nThe entire aim is to have a self-contained HTML file with everything, all geometric data and the JavaScript to process it. Then it's simply a matter of adding an `iframe` to a web page and setting its `src` attribute to the HTML file. Easy peasy!",
    "created_at": "2016-10-02T23:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135477",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@novoselt](#comment:37):
> What about embedding the resulting plots into web-page, i.e. how easy it is for someone-not-really-knowing-anything to take a plot from Sage and have it running on their web-page? (No using [SageMathCell](../wiki/SageMathCell), just having the three.js stuff properly saved/inserted somewhere.)

The entire aim is to have a self-contained HTML file with everything, all geometric data and the JavaScript to process it. Then it's simply a matter of adding an `iframe` to a web page and setting its `src` attribute to the HTML file. Easy peasy!



---

archive/issue_comments_135478.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@novoselt](#comment:36):\n> So it seems that at the moment opacity is ignored and line thickness is not taken into account - is it possible to implement these?\n\nOpacity should be simple. Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.\n> Also when I scale the image text grows/shrinks and then \"becomes normal again\" - is it possible to always keep it the same size throughout the transition?\n\nThought I had this figured out. For a plot with the origin at the center it behaves as you expect, but not when the center is displaced. Will definitely work on this.",
    "created_at": "2016-10-02T23:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135478",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@novoselt](#comment:36):
> So it seems that at the moment opacity is ignored and line thickness is not taken into account - is it possible to implement these?

Opacity should be simple. Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.
> Also when I scale the image text grows/shrinks and then "becomes normal again" - is it possible to always keep it the same size throughout the transition?

Thought I had this figured out. For a plot with the origin at the center it behaves as you expect, but not when the center is displaced. Will definitely work on this.



---

archive/issue_comments_135479.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@paulmasson](#comment:39):\n> Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.\n\nI consider this to be a major flaw, no matter whose fault it is - on the one hand it is nice to use different thicknesses and on the other - single pixel width typically looks bad when used with projectors... Are there any sensible workarounds? Like text seems to be scaled and then scaled back - can it be done with lines too?",
    "created_at": "2016-10-02T23:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135479",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@paulmasson](#comment:39):
> Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.

I consider this to be a major flaw, no matter whose fault it is - on the one hand it is nice to use different thicknesses and on the other - single pixel width typically looks bad when used with projectors... Are there any sensible workarounds? Like text seems to be scaled and then scaled back - can it be done with lines too?



---

archive/issue_comments_135480.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@novoselt](#comment:34):\n> We most definitely want this in, so please keep working!!!\n> Interface-wise let's stick to `show` for the actual showing of stuff and `plot/plot3d` for producing plots that can be further manipulated. `threejs` command if it exists at all should do something like set up a low-level threejs scene that can be tweaked as advanced users please.\n\nA scene in Sage is a collection of `Graphics3d` objects. Three.js, like Jmol/JSmol, is merely a way to render the scene. I don't see the use for command to set up a separate Three.js scene from scratch.\n\nUntil this Three.js viewer is integrated into the Rich Output backend, I don't have a way to display the scene without a command other than `show`, which will default to Jmol/JSmol. That can change later once an initial version is working acceptably. I've spent enough time reading the Rich Output backend to know where to make those changes, and at that point `show` can then be set to default to a Three.js viewer if desired. For now I need the separate command!\n>Presumably, it is possible to just pass some HTML/JavaScript code that will be inserted into generated files?\n\nSee the next comment for this.",
    "created_at": "2016-10-02T23:38:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135480",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@novoselt](#comment:34):
> We most definitely want this in, so please keep working!!!
> Interface-wise let's stick to `show` for the actual showing of stuff and `plot/plot3d` for producing plots that can be further manipulated. `threejs` command if it exists at all should do something like set up a low-level threejs scene that can be tweaked as advanced users please.

A scene in Sage is a collection of `Graphics3d` objects. Three.js, like Jmol/JSmol, is merely a way to render the scene. I don't see the use for command to set up a separate Three.js scene from scratch.

Until this Three.js viewer is integrated into the Rich Output backend, I don't have a way to display the scene without a command other than `show`, which will default to Jmol/JSmol. That can change later once an initial version is working acceptably. I've spent enough time reading the Rich Output backend to know where to make those changes, and at that point `show` can then be set to default to a Three.js viewer if desired. For now I need the separate command!
>Presumably, it is possible to just pass some HTML/JavaScript code that will be inserted into generated files?

See the next comment for this.



---

archive/issue_comments_135481.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nNo problem with having a separate command now, but what I meant is - let's not introduce and then deprecate it in Sage, so using rich output should be done on this ticket as well.",
    "created_at": "2016-10-02T23:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135481",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:42" align="right">comment:42</div>

No problem with having a separate command now, but what I meant is - let's not introduce and then deprecate it in Sage, so using rich output should be done on this ticket as well.



---

archive/issue_comments_135482.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@novoselt](#comment:35):\n> File-wise: perhaps instead of raw string it is possible to have `template_three.js` file that will be read/cached by the Python function? Perhaps with `template_three.js.html` to further wrap it into a standalone page. One of the advantages for development - syntax highlighting of this long template.\n\nI can only think of two ways to communicate data from Python to JavaScript at the command line: either with the Python-formatted string I'm using, or by appending data to a URL as a query string and processing it from there. This second way leads to monstrous URLs that can be bookmarked but not saved as stand-alone files. With what I'm doing all of the data is embedded in the HTML file: saving the file saves the entire scene.\n\nOn the server you have other options for processing data, but running something like that at the command line seems to me to be massive overkill. If I'm missing something in your comment, please let me know a better way to transfer the data to the browser.\n\nAlso, the raw string is not proper JavaScript because all curly brackets are doubled to become literals during Python formatting. Saving that as a separate file would produce parsing errors.",
    "created_at": "2016-10-02T23:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135482",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@novoselt](#comment:35):
> File-wise: perhaps instead of raw string it is possible to have `template_three.js` file that will be read/cached by the Python function? Perhaps with `template_three.js.html` to further wrap it into a standalone page. One of the advantages for development - syntax highlighting of this long template.

I can only think of two ways to communicate data from Python to JavaScript at the command line: either with the Python-formatted string I'm using, or by appending data to a URL as a query string and processing it from there. This second way leads to monstrous URLs that can be bookmarked but not saved as stand-alone files. With what I'm doing all of the data is embedded in the HTML file: saving the file saves the entire scene.

On the server you have other options for processing data, but running something like that at the command line seems to me to be massive overkill. If I'm missing something in your comment, please let me know a better way to transfer the data to the browser.

Also, the raw string is not proper JavaScript because all curly brackets are doubled to become literals during Python formatting. Saving that as a separate file would produce parsing errors.



---

archive/issue_comments_135483.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nSorry I was not clear again: what I meant is take your current template, save it as js file in the same Sage source folder, then in Python code open this file, read it as string, and do the same processing as what you do now. So it will not affect the end result for the user, just, IMHO, makes it easier to maintain this template inside of Sage.",
    "created_at": "2016-10-02T23:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135483",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:44" align="right">comment:44</div>

Sorry I was not clear again: what I meant is take your current template, save it as js file in the same Sage source folder, then in Python code open this file, read it as string, and do the same processing as what you do now. So it will not affect the end result for the user, just, IMHO, makes it easier to maintain this template inside of Sage.



---

archive/issue_comments_135484.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@novoselt](#comment:40):\n> Replying to [@paulmasson](#comment:39):\n> > Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.\n\n> I consider this to be a major flaw, no matter whose fault it is - on the one hand it is nice to use different thicknesses and on the other - single pixel width typically looks bad when used with projectors... Are there any sensible workarounds? Like text seems to be scaled and then scaled back - can it be done with lines too?\n\nText is done on an HTML canvas, so that's completely different from WebGL lines. There are workarounds, but I'd have to think about it more and then would process lines the same way for all browsers.",
    "created_at": "2016-10-02T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135484",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@novoselt](#comment:40):
> Replying to [@paulmasson](#comment:39):
> > Line thickness can be included, but will not be consistent across operating systems because of a limitation in Microsoft's implementation of WebGL.

> I consider this to be a major flaw, no matter whose fault it is - on the one hand it is nice to use different thicknesses and on the other - single pixel width typically looks bad when used with projectors... Are there any sensible workarounds? Like text seems to be scaled and then scaled back - can it be done with lines too?

Text is done on an HTML canvas, so that's completely different from WebGL lines. There are workarounds, but I'd have to think about it more and then would process lines the same way for all browsers.



---

archive/issue_comments_135485.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@novoselt](#comment:44):\n> Sorry I was not clear again: what I meant is take your current template, save it as js file in the same Sage source folder, then in Python code open this file, read it as string, and do the same processing as what you do now. So it will not affect the end result for the user, just, IMHO, makes it easier to maintain this template inside of Sage.\n\nWhen the Python part of this file is integrated with the Rich Output backend, then all that will be left in this file will be the template, so sure. But again, this is not proper JavaScript because of the curly bracket doubling.",
    "created_at": "2016-10-03T00:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135485",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@novoselt](#comment:44):
> Sorry I was not clear again: what I meant is take your current template, save it as js file in the same Sage source folder, then in Python code open this file, read it as string, and do the same processing as what you do now. So it will not affect the end result for the user, just, IMHO, makes it easier to maintain this template inside of Sage.

When the Python part of this file is integrated with the Rich Output backend, then all that will be left in this file will be the template, so sure. But again, this is not proper JavaScript because of the curly bracket doubling.



---

archive/issue_comments_135486.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nAh, and that's because you want to use `.format(..)` with this string. An alternative is to use `%s` substitution if it makes sense or just regular string replacement, but if you prefer doubling so be it since you are doing the actual work ;-)",
    "created_at": "2016-10-03T00:07:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135486",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:47" align="right">comment:47</div>

Ah, and that's because you want to use `.format(..)` with this string. An alternative is to use `%s` substitution if it makes sense or just regular string replacement, but if you prefer doubling so be it since you are doing the actual work ;-)



---

archive/issue_comments_135487.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nJust wanted to say this sounds like a great discussion, keep it up!  It would be great to have something reliable.  Also you may want to check out how this looks/works in the Jupyter notebook as well as sagenb.",
    "created_at": "2016-10-03T14:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135487",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:48" align="right">comment:48</div>

Just wanted to say this sounds like a great discussion, keep it up!  It would be great to have something reliable.  Also you may want to check out how this looks/works in the Jupyter notebook as well as sagenb.



---

archive/issue_comments_135488.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\n(I assume it will be fine, just mentioning.)",
    "created_at": "2016-10-03T14:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135488",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:49" align="right">comment:49</div>

(I assume it will be fine, just mentioning.)



---

archive/issue_events_169937.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-10-03T19:32:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169937"
}
```



---

archive/issue_events_169938.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-10-03T19:32:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169938"
}
```



---

archive/issue_comments_135489.json:
```json
{
    "body": "Changed commit from **[`7cedf75`](https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05)** to **[`f4b1c03`](https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be)**",
    "created_at": "2016-10-03T23:07:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135489",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7cedf75`](https://github.com/sagemath/sagetrac-mirror/commit/7cedf75db69671cfb0a201435e5148d1041f0f05)** to **[`f4b1c03`](https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be)**



---

archive/issue_comments_135490.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be\"><code>f4b1c03</code></a></td><td><code>Move template to separate file</code></td></tr></table>\n",
    "created_at": "2016-10-03T23:07:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135490",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be"><code>f4b1c03</code></a></td><td><code>Move template to separate file</code></td></tr></table>




---

archive/issue_comments_135491.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@novoselt](#comment:47):\n> Ah, and that's because you want to use `.format(..)` with this string. An alternative is to use `%s` substitution if it makes sense or just regular string replacement, but if you prefer doubling so be it since you are doing the actual work ;-)\n\nShould have thought of string replacement! Template now separate. Much preferable to have proper JavaScript in it.",
    "created_at": "2016-10-03T23:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135491",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@novoselt](#comment:47):
> Ah, and that's because you want to use `.format(..)` with this string. An alternative is to use `%s` substitution if it makes sense or just regular string replacement, but if you prefer doubling so be it since you are doing the actual work ;-)

Should have thought of string replacement! Template now separate. Much preferable to have proper JavaScript in it.



---

archive/issue_comments_135492.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df51bde8d214a9732255749dbe614b215fcf5e4b\"><code>df51bde</code></a></td><td><code>Update initial camera position</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c\"><code>4f7075d</code></a></td><td><code>Fix label scaling</code></td></tr></table>\n",
    "created_at": "2016-10-04T21:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135492",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df51bde8d214a9732255749dbe614b215fcf5e4b"><code>df51bde</code></a></td><td><code>Update initial camera position</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c"><code>4f7075d</code></a></td><td><code>Fix label scaling</code></td></tr></table>




---

archive/issue_comments_135493.json:
```json
{
    "body": "Changed commit from **[`f4b1c03`](https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be)** to **[`4f7075d`](https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c)**",
    "created_at": "2016-10-04T21:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135493",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f4b1c03`](https://github.com/sagemath/sagetrac-mirror/commit/f4b1c03a27ec37fc9d6470879f4364300bcda1be)** to **[`4f7075d`](https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c)**



---

archive/issue_comments_135494.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@paulmasson](#comment:39):\n> Replying to [@novoselt](#comment:36):\n\n> > Also when I scale the image text grows/shrinks and then \"becomes normal again\" - is it possible to always keep it the same size throughout the transition?\n\n> Thought I had this figured out. For a plot with the origin at the center it behaves as you expect, but not when the center is displaced. Will definitely work on this.\n\nThis should be fixed now.",
    "created_at": "2016-10-04T21:28:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135494",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@paulmasson](#comment:39):
> Replying to [@novoselt](#comment:36):

> > Also when I scale the image text grows/shrinks and then "becomes normal again" - is it possible to always keep it the same size throughout the transition?

> Thought I had this figured out. For a plot with the origin at the center it behaves as you expect, but not when the center is displaced. Will definitely work on this.

This should be fixed now.



---

archive/issue_comments_135495.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@paulmasson](#comment:32):\n> That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.\n> \n\nIt would be nice to have some (customizable) ticks along the bounding box, but this is probably somewhat tricky and should be the topic of another ticket.\n\nBesides, what about `text3d`? \n\nAt the moment, when running `threejs` from the Jupyter notebook, the 3d plot is rendered in another tab of the browser. Could it be embedded in the notebook instead? (maybe this is related to the Rich Output issue). \n\nThanks again for your work on this!",
    "created_at": "2016-10-05T13:17:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135495",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@paulmasson](#comment:32):
> That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.
> 

It would be nice to have some (customizable) ticks along the bounding box, but this is probably somewhat tricky and should be the topic of another ticket.

Besides, what about `text3d`? 

At the moment, when running `threejs` from the Jupyter notebook, the 3d plot is rendered in another tab of the browser. Could it be embedded in the notebook instead? (maybe this is related to the Rich Output issue). 

Thanks again for your work on this!



---

archive/issue_comments_135496.json:
```json
{
    "body": "<div id=\"comment:56\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d\"><code>62e7a8b</code></a></td><td><code>Integrate with IPython command line</code></td></tr></table>\n",
    "created_at": "2016-10-05T21:46:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135496",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:56"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d"><code>62e7a8b</code></a></td><td><code>Integrate with IPython command line</code></td></tr></table>




---

archive/issue_comments_135497.json:
```json
{
    "body": "Changed commit from **[`4f7075d`](https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c)** to **[`62e7a8b`](https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d)**",
    "created_at": "2016-10-05T21:46:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135497",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4f7075d`](https://github.com/sagemath/sagetrac-mirror/commit/4f7075dfcd3cfcca01e3e6f14cc4e5153748c67c)** to **[`62e7a8b`](https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d)**



---

archive/issue_comments_135498.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nBasic integration with the backend for the IPython command line has been added, and the usage has changed accordingly. This was important to understand how options are passed through the backend. Integration with notebooks will be added after basic display options are in place.",
    "created_at": "2016-10-05T22:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135498",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:57" align="right">comment:57</div>

Basic integration with the backend for the IPython command line has been added, and the usage has changed accordingly. This was important to understand how options are passed through the backend. Integration with notebooks will be added after basic display options are in place.



---

archive/issue_comments_135499.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Usage: `threejs( plot3d )`\n+Usage: `show( plot3d, viewer='threejs' )`\n \n ---\n \n``````\n",
    "created_at": "2016-10-05T22:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135499",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Usage: `threejs( plot3d )`
+Usage: `show( plot3d, viewer='threejs' )`
 
 ---
 
``````




---

archive/issue_comments_135500.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@egourgoulhon](#comment:55):\n> Replying to [@paulmasson](#comment:32):\n> > That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.\n> > \n\n> It would be nice to have some (customizable) ticks along the bounding box, but this is probably somewhat tricky and should be the topic of another ticket.\n\nIndeed!\n> Besides, what about `text3d`? \n\nThis object does not have a `json_repr` and that would be overkill anyway. I can easily add optional text labels like those on the frame, but would need to think about how to automatically extract `text3d` from other `Graphics3d` objects.\n> At the moment, when running `threejs` from the Jupyter notebook, the 3d plot is rendered in another tab of the browser. Could it be embedded in the notebook instead? (maybe this is related to the Rich Output issue). \n\nIt can certainly be embedded, and that is precisely dependent on integration with the Rich Output backend. To be done.\n> Thanks again for your work on this!",
    "created_at": "2016-10-05T22:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135500",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@egourgoulhon](#comment:55):
> Replying to [@paulmasson](#comment:32):
> > That would include options for setting axes labels, setting digits after the decimal in labels, turning off axes labels altogether, turning off the bounding box and setting an explicit aspect ratio in all directions. Let me know what other options would be interesting.
> > 

> It would be nice to have some (customizable) ticks along the bounding box, but this is probably somewhat tricky and should be the topic of another ticket.

Indeed!
> Besides, what about `text3d`? 

This object does not have a `json_repr` and that would be overkill anyway. I can easily add optional text labels like those on the frame, but would need to think about how to automatically extract `text3d` from other `Graphics3d` objects.
> At the moment, when running `threejs` from the Jupyter notebook, the 3d plot is rendered in another tab of the browser. Could it be embedded in the notebook instead? (maybe this is related to the Rich Output issue). 

It can certainly be embedded, and that is precisely dependent on integration with the Rich Output backend. To be done.
> Thanks again for your work on this!



---

archive/issue_comments_135501.json:
```json
{
    "body": "Changed commit from **[`62e7a8b`](https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d)** to **[`4f2b9f1`](https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3)**",
    "created_at": "2016-10-06T01:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135501",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`62e7a8b`](https://github.com/sagemath/sagetrac-mirror/commit/62e7a8baaf9f4f193fbf1ff8b3406f2aa634d68d)** to **[`4f2b9f1`](https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3)**



---

archive/issue_comments_135502.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a93418a509336af08a7e94e8c9f228215f57939f\"><code>a93418a</code></a></td><td><code>Implement basic options</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3\"><code>4f2b9f1</code></a></td><td><code>Update temporary threejs() command</code></td></tr></table>\n",
    "created_at": "2016-10-06T01:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135502",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a93418a509336af08a7e94e8c9f228215f57939f"><code>a93418a</code></a></td><td><code>Implement basic options</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3"><code>4f2b9f1</code></a></td><td><code>Update temporary threejs() command</code></td></tr></table>




---

archive/issue_events_169939.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-10-06T01:40:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169939"
}
```



---

archive/issue_events_169940.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-10-06T01:40:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169940"
}
```



---

archive/issue_comments_135503.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nI've now implement several basic display options:\n\n`frame` (bool) display bounding box or not\n\n`aspect_ratio` (list) individual aspect multipliers for each axis\n\n`axes_labels` (list) labels to display. If set to false, all labels are removed.\n\n`decimals` (integer) decimal points in labels\n\n`opacity` (float) overall opacity for surfaces. Currently set for the entire scene.\n\nI've also updated the temporary `threejs()` command so that it has the new options. This command will be maintained until integration with both notebook backends is complete.",
    "created_at": "2016-10-06T01:40:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135503",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:60" align="right">comment:60</div>

I've now implement several basic display options:

`frame` (bool) display bounding box or not

`aspect_ratio` (list) individual aspect multipliers for each axis

`axes_labels` (list) labels to display. If set to false, all labels are removed.

`decimals` (integer) decimal points in labels

`opacity` (float) overall opacity for surfaces. Currently set for the entire scene.

I've also updated the temporary `threejs()` command so that it has the new options. This command will be maintained until integration with both notebook backends is complete.



---

archive/issue_comments_135504.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI've tried the display options: they work well, except for `aspect_ratio`: \n\n```\nthreejs(icosahedron(), aspect_ratio=[0.5, 1., 0.8])\n```\nreturns\n\n```\nTypeError: 0.500000000000000 is not JSON serializable\n```",
    "created_at": "2016-10-07T08:39:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135504",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:61" align="right">comment:61</div>

I've tried the display options: they work well, except for `aspect_ratio`: 

```
threejs(icosahedron(), aspect_ratio=[0.5, 1., 0.8])
```
returns

```
TypeError: 0.500000000000000 is not JSON serializable
```



---

archive/issue_comments_135505.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nMay I ask about the status of this? \nAs I understand, except for the `aspect_ratio` option and the Rich Output backend, this is almost ready. It would be so nice if this could be shipped with Sage 7.5!",
    "created_at": "2016-11-02T10:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135505",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:62" align="right">comment:62</div>

May I ask about the status of this? 
As I understand, except for the `aspect_ratio` option and the Rich Output backend, this is almost ready. It would be so nice if this could be shipped with Sage 7.5!



---

archive/issue_comments_135506.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI somehow just looked at this for a few minutes -- take or leave these comments.  Feel free to ignore them...\n\nThe first thing I see (in https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/plot/plot3d/threejs_template.html?id=67930e843d29652f143c67329aaf32be4ab120a8) is:\n\n```\n<script src=http://rawgit.com/mrdoob/three.js/r80/build/three.js></script>\n<script src=http://rawgit.com/mrdoob/three.js/r80/examples/js/controls/OrbitControls.js></script>\n```\n\nA concern is that this won't work offline -- 3d graphics will just be completely broken without an external internet connection.   Also, this is making 3d graphics display in Sage depend on \"some random site\" (rawgit.com) which says on their page: \"The catch: this is a free service, so there are no uptime or support guarantees.\"...\n\nThis provides absolutely no Jupyter notebook integration at all as far as I can tell.  It's just creating a single standalone local website for the image and popping that up in the users browser.   If you do something more serious that does try to integrate with Jupyter, you might find it is a lot of work to get Chrome with more than about 10+ 3d plots on the same page..   That was a big problem when I implemented WebGL based 3d graphics for SageMathCloud, which involved quite a bit of work (involving great care with the renderer, swapping things out with static png's etc.).  When you're just trying to get a demo working you don't worry about such scale.  However, if you're teaching, you can easily have many plots in one notebook.   Anyway, this is one reason that the SMC Javascript is longer and more complicated.\n\nAnother question is how much of 3d plot rendering have you actually implemented?   For example, I recently added arrowheads to lines to SMC, since I had missed those and you expect them when plotting 3d vector fields.   I don't see any code in threejs_template.html for that. \n\n\nI guess you just only support WebGL, even though three.js can support canvas too....  Maybe that's fine these days, but again supporting both is something I put a lot of work into. \n  \n\n\nThe SMC implementation: \n\n- client side -- https://github.com/sagemathinc/smc/blob/master/src/smc-webapp/3d.coffee\n- server side -- https://github.com/sagemathinc/smc/blob/master/src/smc_sagews/smc_sagews/graphics.py",
    "created_at": "2016-11-02T12:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135506",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:63" align="right">comment:63</div>

I somehow just looked at this for a few minutes -- take or leave these comments.  Feel free to ignore them...

The first thing I see (in https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/plot/plot3d/threejs_template.html?id=67930e843d29652f143c67329aaf32be4ab120a8) is:

```
<script src=http://rawgit.com/mrdoob/three.js/r80/build/three.js></script>
<script src=http://rawgit.com/mrdoob/three.js/r80/examples/js/controls/OrbitControls.js></script>
```

A concern is that this won't work offline -- 3d graphics will just be completely broken without an external internet connection.   Also, this is making 3d graphics display in Sage depend on "some random site" (rawgit.com) which says on their page: "The catch: this is a free service, so there are no uptime or support guarantees."...

This provides absolutely no Jupyter notebook integration at all as far as I can tell.  It's just creating a single standalone local website for the image and popping that up in the users browser.   If you do something more serious that does try to integrate with Jupyter, you might find it is a lot of work to get Chrome with more than about 10+ 3d plots on the same page..   That was a big problem when I implemented WebGL based 3d graphics for SageMathCloud, which involved quite a bit of work (involving great care with the renderer, swapping things out with static png's etc.).  When you're just trying to get a demo working you don't worry about such scale.  However, if you're teaching, you can easily have many plots in one notebook.   Anyway, this is one reason that the SMC Javascript is longer and more complicated.

Another question is how much of 3d plot rendering have you actually implemented?   For example, I recently added arrowheads to lines to SMC, since I had missed those and you expect them when plotting 3d vector fields.   I don't see any code in threejs_template.html for that. 


I guess you just only support WebGL, even though three.js can support canvas too....  Maybe that's fine these days, but again supporting both is something I put a lot of work into. 
  


The SMC implementation: 

- client side -- https://github.com/sagemathinc/smc/blob/master/src/smc-webapp/3d.coffee
- server side -- https://github.com/sagemathinc/smc/blob/master/src/smc_sagews/smc_sagews/graphics.py



---

archive/issue_comments_135507.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nGreat comments, especially the offline bit.",
    "created_at": "2016-11-02T14:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135507",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:64" align="right">comment:64</div>

Great comments, especially the offline bit.



---

archive/issue_comments_135508.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@williamstein](#comment:63):\n> A concern is that this won't work offline -- 3d graphics will just be completely broken without an external internet connection.\n\nThis is easily fixed by adding a second pair of `script` tags pointing to a local source. Since Three.js does not currently download during the build process, adding this feature will have to change that and is more appropriate for another ticket.\n>Also, this is making 3d graphics display in Sage depend on \"some random site\" (rawgit.com) which says on their page: \"The catch: this is a free service, so there are no uptime or support guarantees.\"...\n\nRawgit.com is hardly some random site for GitHub people. That being said it's irrelevant where the code is hosted as long as it is available somewhere. The intent is to make the interactive image as portable as a PNG, so it can't depend entirely on one's local installation: an external CDN link is vital.\n> This provides absolutely no Jupyter notebook integration at all as far as I can tell.  It's just creating a single standalone local website for the image and popping that up in the users browser.   \n\nThe process here of creating 3D images exactly parallels that of 2D plots: a file is generated, saved to disc and displayed in the best possible viewer as determined by the rich output backend. It's not a local website, it's a file that can be saved and used elsewhere as desired, exactly as for static 2D plots.\n>If you do something more serious that does try to integrate with Jupyter, you might find it is a lot of work to get Chrome with more than about 10+ 3d plots on the same page..  That was a big problem when I implemented WebGL based 3d graphics for SageMathCloud, which involved quite a bit of work (involving great care with the renderer, swapping things out with static png's etc.).\n\nI'm well aware of the limitations of multiple WebGL contexts in a single web page. The real way to handle this is using scissoring on a single renderer: I wrote an [example](https://threejs.org/examples/?q=mul#webgl_multiple_elements_text) for the Three.js repository to do just that. Since this approach is not immediately modular, the fallback is to manage `iframe` content as it scrolls into view. While I was figuring out scissoring, a coding friend of mine [explored](https://github.com/jaanga/jaanga.github.io/tree/master/documents/threejs-viewers) that very subject to [good effect](http://jaanga.github.io/documents/threejs-viewers/index.html), so we have an available resource for dealing with this issue as well. It's also a topic for another ticket, since it would require modifying notebook behavior. I can't control all of that in the process of creating stand-alone files. The motivation here is to bring Three.js to the command line interface first.\n> Another question is how much of 3d plot rendering have you actually implemented?   For example, I recently added arrowheads to lines to SMC, since I had missed those and you expect them when plotting 3d vector fields.   I don't see any code in threejs_template.html for that. \n\nThe code will currently render anything that returns a `json_repr`. This includes the `arrow` graphics primitive, which appears just fine, but not for example `text3d`. 3D vector fields don't have arrow heads in Sage 7.4 anyway, so that is something that can be added on another ticket.\n> I guess you just only support WebGL, even though three.js can support canvas too....  Maybe that's fine these days, but again supporting both is something I put a lot of work into. \n\nThis is also easily fixed by testing rendering capabilities, but I'd rather look forward for the initial version.",
    "created_at": "2016-11-03T00:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135508",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@williamstein](#comment:63):
> A concern is that this won't work offline -- 3d graphics will just be completely broken without an external internet connection.

This is easily fixed by adding a second pair of `script` tags pointing to a local source. Since Three.js does not currently download during the build process, adding this feature will have to change that and is more appropriate for another ticket.
>Also, this is making 3d graphics display in Sage depend on "some random site" (rawgit.com) which says on their page: "The catch: this is a free service, so there are no uptime or support guarantees."...

Rawgit.com is hardly some random site for GitHub people. That being said it's irrelevant where the code is hosted as long as it is available somewhere. The intent is to make the interactive image as portable as a PNG, so it can't depend entirely on one's local installation: an external CDN link is vital.
> This provides absolutely no Jupyter notebook integration at all as far as I can tell.  It's just creating a single standalone local website for the image and popping that up in the users browser.   

The process here of creating 3D images exactly parallels that of 2D plots: a file is generated, saved to disc and displayed in the best possible viewer as determined by the rich output backend. It's not a local website, it's a file that can be saved and used elsewhere as desired, exactly as for static 2D plots.
>If you do something more serious that does try to integrate with Jupyter, you might find it is a lot of work to get Chrome with more than about 10+ 3d plots on the same page..  That was a big problem when I implemented WebGL based 3d graphics for SageMathCloud, which involved quite a bit of work (involving great care with the renderer, swapping things out with static png's etc.).

I'm well aware of the limitations of multiple WebGL contexts in a single web page. The real way to handle this is using scissoring on a single renderer: I wrote an [example](https://threejs.org/examples/?q=mul#webgl_multiple_elements_text) for the Three.js repository to do just that. Since this approach is not immediately modular, the fallback is to manage `iframe` content as it scrolls into view. While I was figuring out scissoring, a coding friend of mine [explored](https://github.com/jaanga/jaanga.github.io/tree/master/documents/threejs-viewers) that very subject to [good effect](http://jaanga.github.io/documents/threejs-viewers/index.html), so we have an available resource for dealing with this issue as well. It's also a topic for another ticket, since it would require modifying notebook behavior. I can't control all of that in the process of creating stand-alone files. The motivation here is to bring Three.js to the command line interface first.
> Another question is how much of 3d plot rendering have you actually implemented?   For example, I recently added arrowheads to lines to SMC, since I had missed those and you expect them when plotting 3d vector fields.   I don't see any code in threejs_template.html for that. 

The code will currently render anything that returns a `json_repr`. This includes the `arrow` graphics primitive, which appears just fine, but not for example `text3d`. 3D vector fields don't have arrow heads in Sage 7.4 anyway, so that is something that can be added on another ticket.
> I guess you just only support WebGL, even though three.js can support canvas too....  Maybe that's fine these days, but again supporting both is something I put a lot of work into. 

This is also easily fixed by testing rendering capabilities, but I'd rather look forward for the initial version.



---

archive/issue_comments_135509.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@egourgoulhon](#comment:62):\n> May I ask about the status of this? \n> As I understand, except for the `aspect_ratio` option and the Rich Output backend, this is almost ready. It would be so nice if this could be shipped with Sage 7.5!\n\nEric, there's a bit more work to be done:\n\n1) All numeric input parameters need to be made JSON serializable. This is easy to do.\n\n2) The Three.js `Geometry` that I used for convenience needs to be replaced with `BufferGeometry`. This will improve use of available memory and avoid possible browser issues, as well as prepare for stability in notebooks. This is straightforward.\n\n3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. \n\n4) Notebook integration needs to be added and tested. Since I am not familiar with the details of notebooks, this may not be straightforward without input from those more familiar. Adding a few Three.js files to a notebook page should be easy, but more than that may require modifying how the notebook dynamically handles `iframe` content. That might also be better dealt with on a separate ticket.\n\nI've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!",
    "created_at": "2016-11-03T00:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135509",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@egourgoulhon](#comment:62):
> May I ask about the status of this? 
> As I understand, except for the `aspect_ratio` option and the Rich Output backend, this is almost ready. It would be so nice if this could be shipped with Sage 7.5!

Eric, there's a bit more work to be done:

1) All numeric input parameters need to be made JSON serializable. This is easy to do.

2) The Three.js `Geometry` that I used for convenience needs to be replaced with `BufferGeometry`. This will improve use of available memory and avoid possible browser issues, as well as prepare for stability in notebooks. This is straightforward.

3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. 

4) Notebook integration needs to be added and tested. Since I am not familiar with the details of notebooks, this may not be straightforward without input from those more familiar. Adding a few Three.js files to a notebook page should be easy, but more than that may require modifying how the notebook dynamically handles `iframe` content. That might also be better dealt with on a separate ticket.

I've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!



---

archive/issue_events_169941.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-03T00:44:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169941"
}
```



---

archive/issue_events_169942.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-03T00:44:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169942"
}
```



---

archive/issue_events_169943.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-03T00:44:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169943"
}
```



---

archive/issue_events_169944.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-03T00:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169944"
}
```



---

archive/issue_comments_135510.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@paulmasson](#comment:66):\n\nThanks for your answers.\n\n> 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. \n\nI would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. \n\n> \n> I've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!\n\nThanks!",
    "created_at": "2016-11-03T09:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135510",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@paulmasson](#comment:66):

Thanks for your answers.

> 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. 

I would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. 

> 
> I've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!

Thanks!



---

archive/issue_comments_135511.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@egourgoulhon](#comment:68):\n> Replying to [@paulmasson](#comment:66):\n> \n> Thanks for your answers.\n> \n> > 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. \n\n> \n> I would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. \n\nTrue, Windows line thickness could be its own ticket, and making three.js the default viewer could be another ticket depending on it.\n \n\n> > I've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!\n\n> \n> Thanks!\n\nExcellent. A recent\n[Ask Sage question about tick marks on the frame of 3d plots](https://ask.sagemath.org/question/35411/how-to-add-tick-marks-or-control-them-in-the-frame-of-3d-plots/)\npoints to the timeliness of this.",
    "created_at": "2016-11-04T15:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135511",
    "user": "https://github.com/slel"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@egourgoulhon](#comment:68):
> Replying to [@paulmasson](#comment:66):
> 
> Thanks for your answers.
> 
> > 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. 

> 
> I would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. 

True, Windows line thickness could be its own ticket, and making three.js the default viewer could be another ticket depending on it.
 

> > I've been distracted in the last couple weeks with trying to transpile Sage libraries with Emscripten for use directly in the browser, but since that's more work that I thought it would be I can set it aside for awhile and get back to this!

> 
> Thanks!

Excellent. A recent
[Ask Sage question about tick marks on the frame of 3d plots](https://ask.sagemath.org/question/35411/how-to-add-tick-marks-or-control-them-in-the-frame-of-3d-plots/)
points to the timeliness of this.



---

archive/issue_comments_135512.json:
```json
{
    "body": "<div id=\"comment:70\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1dd3f800acf2821603ea56714c89e1224cdc17d1\"><code>1dd3f80</code></a></td><td><code>Fix points background</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638\"><code>0fea750</code></a></td><td><code>Fix JSON serialization error</code></td></tr></table>\n",
    "created_at": "2016-11-05T00:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135512",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:70"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1dd3f800acf2821603ea56714c89e1224cdc17d1"><code>1dd3f80</code></a></td><td><code>Fix points background</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638"><code>0fea750</code></a></td><td><code>Fix JSON serialization error</code></td></tr></table>




---

archive/issue_comments_135513.json:
```json
{
    "body": "Changed commit from **[`4f2b9f1`](https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3)** to **[`0fea750`](https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638)**",
    "created_at": "2016-11-05T00:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135513",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4f2b9f1`](https://github.com/sagemath/sagetrac-mirror/commit/4f2b9f1c5677582a8e4ba9bf1a74d0b896ad98c3)** to **[`0fea750`](https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638)**



---

archive/issue_comments_135514.json:
```json
{
    "body": "<div id=\"comment:71\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53d6dec197c63be3e51eaee4e15d23008f4f648f\"><code>53d6dec</code></a></td><td><code>Minor edit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cabe3ee891468e957a0f0c3b74c0737cf98413b1\"><code>cabe3ee</code></a></td><td><code>Add basic Jupyter notebook support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e19bfc67c9b8d473264cb79a8319f070cd5d884\"><code>0e19bfc</code></a></td><td><code>Add basic Sage notebook support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d\"><code>46dcb96</code></a></td><td><code>Improvements to labels</code></td></tr></table>\n",
    "created_at": "2016-11-06T22:22:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135514",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:71"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53d6dec197c63be3e51eaee4e15d23008f4f648f"><code>53d6dec</code></a></td><td><code>Minor edit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cabe3ee891468e957a0f0c3b74c0737cf98413b1"><code>cabe3ee</code></a></td><td><code>Add basic Jupyter notebook support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e19bfc67c9b8d473264cb79a8319f070cd5d884"><code>0e19bfc</code></a></td><td><code>Add basic Sage notebook support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d"><code>46dcb96</code></a></td><td><code>Improvements to labels</code></td></tr></table>




---

archive/issue_comments_135515.json:
```json
{
    "body": "Changed commit from **[`0fea750`](https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638)** to **[`46dcb96`](https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d)**",
    "created_at": "2016-11-06T22:22:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135515",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0fea750`](https://github.com/sagemath/sagetrac-mirror/commit/0fea7503fbb586beda18b4f83ba54a6ed7143638)** to **[`46dcb96`](https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d)**



---

archive/issue_comments_135516.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nTurns out the `BufferGeometry` isn't necessary for getting this working in notebooks. I've added some basic integration for both notebook types parallel to how JSmol is embedded in each.\n\nCaveat: WebGL is limited to 16 active contexts at a time, so while all the data is in the notebooks the figures may not be active until the cell is reevaluated. I have a basic idea of how to fix this in the future, but it would require a modification to the notebooks themselves which would be a separate ticket.\n\nI haven't worked on the line thickness issue yet.",
    "created_at": "2016-11-06T22:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135516",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:72" align="right">comment:72</div>

Turns out the `BufferGeometry` isn't necessary for getting this working in notebooks. I've added some basic integration for both notebook types parallel to how JSmol is embedded in each.

Caveat: WebGL is limited to 16 active contexts at a time, so while all the data is in the notebooks the figures may not be active until the cell is reevaluated. I have a basic idea of how to fix this in the future, but it would require a modification to the notebooks themselves which would be a separate ticket.

I haven't worked on the line thickness issue yet.



---

archive/issue_comments_135517.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Usage: `show( plot3d, viewer='threejs' )`\n+Usage: `show( plot3d, viewer='threejs' )` or `plot3d( ..., viewer='threejs')`\n \n ---\n \n``````\n",
    "created_at": "2016-11-06T22:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135517",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Usage: `show( plot3d, viewer='threejs' )`
+Usage: `show( plot3d, viewer='threejs' )` or `plot3d( ..., viewer='threejs')`
 
 ---
 
``````




---

archive/issue_events_169945.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-06T22:33:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169945"
}
```



---

archive/issue_events_169946.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-11-06T22:33:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169946"
}
```



---

archive/issue_comments_135518.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nThank you for all these improvements! \nIt's nice to have `viewer='threejs'` among the `show` options!\n\nThere is an issue when plotting the sum of two objects that are themselves sums: only the first object is shown:\n\n\n```\nplot1 = line([(0,0,0), (0,1,0)]) + line([(0,1,0), (1,0,0)])\nplot2 = line([(0,0,1), (0,1,1)]) + line([(0,1,1), (1,0,1)])\nshow(plot1 + plot2, viewer='threejs')  # only plot1 is shown\nshow(plot2 + plot1, viewer='threejs')  # only plot2 is shown\n```",
    "created_at": "2016-11-07T22:32:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135518",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:73" align="right">comment:73</div>

Thank you for all these improvements! 
It's nice to have `viewer='threejs'` among the `show` options!

There is an issue when plotting the sum of two objects that are themselves sums: only the first object is shown:


```
plot1 = line([(0,0,0), (0,1,0)]) + line([(0,1,0), (1,0,0)])
plot2 = line([(0,0,1), (0,1,1)]) + line([(0,1,1), (1,0,1)])
show(plot1 + plot2, viewer='threejs')  # only plot1 is shown
show(plot2 + plot1, viewer='threejs')  # only plot2 is shown
```



---

archive/issue_comments_135519.json:
```json
{
    "body": "Changed commit from **[`46dcb96`](https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d)** to **[`f51c4cc`](https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba)**",
    "created_at": "2016-11-10T02:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135519",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`46dcb96`](https://github.com/sagemath/sagetrac-mirror/commit/46dcb962b6888cdc83b4262f58c4596db70b5f2d)** to **[`f51c4cc`](https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba)**



---

archive/issue_comments_135520.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba\"><code>f51c4cc</code></a></td><td><code>Flatten potentially nested Graphics3dGroup</code></td></tr></table>\n",
    "created_at": "2016-11-10T02:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135520",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba"><code>f51c4cc</code></a></td><td><code>Flatten potentially nested Graphics3dGroup</code></td></tr></table>




---

archive/issue_comments_135521.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@egourgoulhon](#comment:73):\n> Thank you for all these improvements! \n> It's nice to have `viewer='threejs'` among the `show` options!\n> \n> There is an issue when plotting the sum of two objects that are themselves sums: only the first object is shown:\n> \n> \n> ```\n> plot1 = line([(0,0,0), (0,1,0)]) + line([(0,1,0), (1,0,0)])\n> plot2 = line([(0,0,1), (0,1,1)]) + line([(0,1,1), (1,0,1)])\n> show(plot1 + plot2, viewer='threejs')  # only plot1 is shown\n> show(plot2 + plot1, viewer='threejs')  # only plot2 is shown\n> ```\n\nGood catch! Should be fixed now.",
    "created_at": "2016-11-10T02:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135521",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@egourgoulhon](#comment:73):
> Thank you for all these improvements! 
> It's nice to have `viewer='threejs'` among the `show` options!
> 
> There is an issue when plotting the sum of two objects that are themselves sums: only the first object is shown:
> 
> 
> ```
> plot1 = line([(0,0,0), (0,1,0)]) + line([(0,1,0), (1,0,0)])
> plot2 = line([(0,0,1), (0,1,1)]) + line([(0,1,1), (1,0,1)])
> show(plot1 + plot2, viewer='threejs')  # only plot1 is shown
> show(plot2 + plot1, viewer='threejs')  # only plot2 is shown
> ```

Good catch! Should be fixed now.



---

archive/issue_comments_135522.json:
```json
{
    "body": "Changed commit from **[`f51c4cc`](https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba)** to **[`e978ff8`](https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0)**",
    "created_at": "2016-11-10T02:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135522",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f51c4cc`](https://github.com/sagemath/sagetrac-mirror/commit/f51c4ccb982b8811f1507aaa6cb8e3c254fe8fba)** to **[`e978ff8`](https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0)**



---

archive/issue_comments_135523.json:
```json
{
    "body": "<div id=\"comment:76\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0\"><code>e978ff8</code></a></td><td><code>Remove temporary threejs() command</code></td></tr></table>\n",
    "created_at": "2016-11-10T02:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135523",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:76"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0"><code>e978ff8</code></a></td><td><code>Remove temporary threejs() command</code></td></tr></table>




---

archive/issue_comments_135524.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nThe temporary `threejs()` command is no longer needed and has been removed.",
    "created_at": "2016-11-10T02:15:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135524",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:77" align="right">comment:77</div>

The temporary `threejs()` command is no longer needed and has been removed.



---

archive/issue_comments_135525.json:
```json
{
    "body": "<div id=\"comment:78\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ed849ee2640c40552bf0c40126a4130bb8be6f2\"><code>5ed849e</code></a></td><td><code>Basic documentation for threejs viewer</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4088310a92f29f488249ac182d31a50da29b77d7\"><code>4088310</code></a></td><td><code>Add option for drawing axes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3\"><code>1267458</code></a></td><td><code>Turn off axes labels with frame</code></td></tr></table>\n",
    "created_at": "2016-11-10T22:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135525",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ed849ee2640c40552bf0c40126a4130bb8be6f2"><code>5ed849e</code></a></td><td><code>Basic documentation for threejs viewer</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4088310a92f29f488249ac182d31a50da29b77d7"><code>4088310</code></a></td><td><code>Add option for drawing axes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3"><code>1267458</code></a></td><td><code>Turn off axes labels with frame</code></td></tr></table>




---

archive/issue_comments_135526.json:
```json
{
    "body": "Changed commit from **[`e978ff8`](https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0)** to **[`1267458`](https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3)**",
    "created_at": "2016-11-10T22:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135526",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e978ff8`](https://github.com/sagemath/sagetrac-mirror/commit/e978ff866a537cae0ab7aac32bbee77f1f54b4c0)** to **[`1267458`](https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3)**



---

archive/issue_comments_135527.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nThanks for these changes. I've tested the latest version with plots of charts, vector fields and curves on the 2-sphere. Everything works well as you can see on [this notebook](http://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_sphere_threejs.ipynb).\n\nAnother issue with sums: the option `opacity` (and maybe other options) is propagated to all objects. For instance in \n\n```\nshow(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs') \n```\nthe cube is displayed with an opacity of 0.2.\n\nThere are also some missing doctests, as revealed by `sage -coverage src/sage/plot/plot3d/base.pyx`:\n\n```\nMissing doctests:\n     * line 344: def _rich_repr_threejs(self, **kwds)\n```",
    "created_at": "2016-11-13T16:43:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135527",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:79" align="right">comment:79</div>

Thanks for these changes. I've tested the latest version with plots of charts, vector fields and curves on the 2-sphere. Everything works well as you can see on [this notebook](http://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_sphere_threejs.ipynb).

Another issue with sums: the option `opacity` (and maybe other options) is propagated to all objects. For instance in 

```
show(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs') 
```
the cube is displayed with an opacity of 0.2.

There are also some missing doctests, as revealed by `sage -coverage src/sage/plot/plot3d/base.pyx`:

```
Missing doctests:
     * line 344: def _rich_repr_threejs(self, **kwds)
```



---

archive/issue_comments_135528.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nThe propagation may be related to #10657 though that is about arrays and not sums - but there may be some similar lacking logic.",
    "created_at": "2016-11-14T18:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135528",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:80" align="right">comment:80</div>

The propagation may be related to #10657 though that is about arrays and not sums - but there may be some similar lacking logic.



---

archive/issue_comments_135529.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@kcrisman](#comment:80):\n> The propagation may be related to #10657 though that is about arrays and not sums - but there may be some similar lacking logic.\n\nIn any case, this is somehow related to the three.js viewer, since neither jmol nor tachyon have this issue.",
    "created_at": "2016-11-14T19:25:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135529",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@kcrisman](#comment:80):
> The propagation may be related to #10657 though that is about arrays and not sums - but there may be some similar lacking logic.

In any case, this is somehow related to the three.js viewer, since neither jmol nor tachyon have this issue.



---

archive/issue_comments_135530.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@egourgoulhon](#comment:79):\n\n> Another issue with sums: the option `opacity` (and maybe other options) is propagated to all objects. For instance in \n> \n> ```\n> show(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs') \n> ```\n> the cube is displayed with an opacity of 0.2.\n\nCurrently the code is setting global values for all optional keywords and this should of course change for `opacity` and `thickness`. The behavior you're seeing is because an option set in the `_extra_kwds` for one graph propagates up to the corresponding dictionary for the group, with the last occurrence of a setting taking precedence over previous settings.\n\nI'd like to keep the option of a global setting for `opacity` and `thickness` and extract the settings for each component graph as an override, if that sounds reasonable.\n\nOne other question is what do to with the remaining settings, which I'm assuming should be global. Leave the default behavior that the last graph sets them all or try to change the existing behavior for graphics groups?\n\nAlso, should `aspect_ratio` be settable for each graph? That doesn't make much sense to me but would anyone expect that? The code for that would get messy.",
    "created_at": "2016-11-15T02:00:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135530",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@egourgoulhon](#comment:79):

> Another issue with sums: the option `opacity` (and maybe other options) is propagated to all objects. For instance in 
> 
> ```
> show(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs') 
> ```
> the cube is displayed with an opacity of 0.2.

Currently the code is setting global values for all optional keywords and this should of course change for `opacity` and `thickness`. The behavior you're seeing is because an option set in the `_extra_kwds` for one graph propagates up to the corresponding dictionary for the group, with the last occurrence of a setting taking precedence over previous settings.

I'd like to keep the option of a global setting for `opacity` and `thickness` and extract the settings for each component graph as an override, if that sounds reasonable.

One other question is what do to with the remaining settings, which I'm assuming should be global. Leave the default behavior that the last graph sets them all or try to change the existing behavior for graphics groups?

Also, should `aspect_ratio` be settable for each graph? That doesn't make much sense to me but would anyone expect that? The code for that would get messy.



---

archive/issue_comments_135531.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nIf you're asking about summing several objects in one graph and them having different aspect ratios, I would definitely say no.  I think that somewhere in the 2d code the last explicit aspect ratio is the one used, and this might even be documented.  By the way, I'll note that in experimenting just now I couldn't get \"last explicit aspect ratio\" less than one to be recognized, only in single graphs...",
    "created_at": "2016-11-15T02:22:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135531",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:83" align="right">comment:83</div>

If you're asking about summing several objects in one graph and them having different aspect ratios, I would definitely say no.  I think that somewhere in the 2d code the last explicit aspect ratio is the one used, and this might even be documented.  By the way, I'll note that in experimenting just now I couldn't get "last explicit aspect ratio" less than one to be recognized, only in single graphs...



---

archive/issue_comments_135532.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nReplying to [@kcrisman](#comment:83):\n> If you're asking about summing several objects in one graph and them having different aspect ratios, I would definitely say no. \n\n+1\n\nReplying to [@paulmasson](#comment:82):\n> I'd like to keep the option of a global setting for `opacity` and `thickness` and extract the settings for each component graph as an override, if that sounds reasonable. \n\nIMHO, one should distinguish two kinds of options:\n- those that are inherently global, like `aspect_ratio`, `axes_labels`, etc.\n- those that pertain to individual objects, like `opacity`, `thickness`, etc.\nI would vote for not propagating the \"individual\" options to all objects in a sum. Imagine for instance a plot with a lot of lines with the default thickness. Then one adds a line of thickness 3 and suddenly, all lines appear with that thickness. Even if documented, this is most surprising to the user. Being obliged to specify `thickness=1` for all the lines of the first group to overcome this would be cumbersome and somehow would contradict the concept of default value. One could argue for a new option, e.g. `global_thickness`, to force all individual objects to be drawn with a given thickness, but this is clearly beyond the scope of this ticket. \n\nJust for curiosity: how is it that, in the current settings, Jmol and Tachyon treat `opacity` in a sum as a genuine individual option, contrary to the three.js viewer? (note also that the three.js viewer of SMC behaves in the same way as Jmol and Tachyon).",
    "created_at": "2016-11-15T09:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135532",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:84" align="right">comment:84</div>

Replying to [@kcrisman](#comment:83):
> If you're asking about summing several objects in one graph and them having different aspect ratios, I would definitely say no. 

+1

Replying to [@paulmasson](#comment:82):
> I'd like to keep the option of a global setting for `opacity` and `thickness` and extract the settings for each component graph as an override, if that sounds reasonable. 

IMHO, one should distinguish two kinds of options:
- those that are inherently global, like `aspect_ratio`, `axes_labels`, etc.
- those that pertain to individual objects, like `opacity`, `thickness`, etc.
I would vote for not propagating the "individual" options to all objects in a sum. Imagine for instance a plot with a lot of lines with the default thickness. Then one adds a line of thickness 3 and suddenly, all lines appear with that thickness. Even if documented, this is most surprising to the user. Being obliged to specify `thickness=1` for all the lines of the first group to overcome this would be cumbersome and somehow would contradict the concept of default value. One could argue for a new option, e.g. `global_thickness`, to force all individual objects to be drawn with a given thickness, but this is clearly beyond the scope of this ticket. 

Just for curiosity: how is it that, in the current settings, Jmol and Tachyon treat `opacity` in a sum as a genuine individual option, contrary to the three.js viewer? (note also that the three.js viewer of SMC behaves in the same way as Jmol and Tachyon).



---

archive/issue_comments_135533.json:
```json
{
    "body": "<div id=\"comment:85\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a\"><code>202278b</code></a></td><td><code>Add missing doctest</code></td></tr></table>\n",
    "created_at": "2016-11-16T22:15:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135533",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:85"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a"><code>202278b</code></a></td><td><code>Add missing doctest</code></td></tr></table>




---

archive/issue_comments_135534.json:
```json
{
    "body": "Changed commit from **[`1267458`](https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3)** to **[`202278b`](https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a)**",
    "created_at": "2016-11-16T22:15:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135534",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1267458`](https://github.com/sagemath/sagetrac-mirror/commit/1267458e9063856f99d6e9a9af21065b5c9677a3)** to **[`202278b`](https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a)**



---

archive/issue_comments_135535.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nBecause of how the individual opacities/thicknesses propagate upward, my idea of a simple global override isn't possible. That would require an additional keyword as Eric pointed out, so I'll let it go for now. Only individual opacities/thicknesses will be set on graphs.",
    "created_at": "2016-11-16T23:56:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135535",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:86" align="right">comment:86</div>

Because of how the individual opacities/thicknesses propagate upward, my idea of a simple global override isn't possible. That would require an additional keyword as Eric pointed out, so I'll let it go for now. Only individual opacities/thicknesses will be set on graphs.



---

archive/issue_comments_135536.json:
```json
{
    "body": "Changed commit from **[`202278b`](https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a)** to **[`dd5e63e`](https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581)**",
    "created_at": "2016-11-17T21:30:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135536",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`202278b`](https://github.com/sagemath/sagetrac-mirror/commit/202278ba0569c04c3799fe446eddaa799c00334a)** to **[`dd5e63e`](https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581)**



---

archive/issue_comments_135537.json:
```json
{
    "body": "<div id=\"comment:87\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581\"><code>dd5e63e</code></a></td><td><code>Set opacity by individual plot</code></td></tr></table>\n",
    "created_at": "2016-11-17T21:30:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135537",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:87"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581"><code>dd5e63e</code></a></td><td><code>Set opacity by individual plot</code></td></tr></table>




---

archive/issue_comments_135538.json:
```json
{
    "body": "Changed commit from **[`dd5e63e`](https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581)** to **[`191b7ae`](https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c)**",
    "created_at": "2016-11-17T22:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135538",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dd5e63e`](https://github.com/sagemath/sagetrac-mirror/commit/dd5e63e6626c6d00550024080ce88a0cd2db2581)** to **[`191b7ae`](https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c)**



---

archive/issue_comments_135539.json:
```json
{
    "body": "<div id=\"comment:88\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c\"><code>191b7ae</code></a></td><td><code>Remove negative zero in labels</code></td></tr></table>\n",
    "created_at": "2016-11-17T22:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135539",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:88"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c"><code>191b7ae</code></a></td><td><code>Remove negative zero in labels</code></td></tr></table>




---

archive/issue_comments_135540.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nOpacity issue should now be fixed, along with an irritating negative zero that appeared in the labels of Eric's test notebook.",
    "created_at": "2016-11-17T22:24:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135540",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:89" align="right">comment:89</div>

Opacity issue should now be fixed, along with an irritating negative zero that appeared in the labels of Eric's test notebook.



---

archive/issue_comments_135541.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@paulmasson](#comment:89):\n> Opacity issue should now be fixed, \n\nIt seems that there is still an issue with opacity:\n\n```\nshow(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs')\n```\ndraws the sphere with an opacity of 1.\n\nBesides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? \n\n> along with an irritating negative zero that appeared in the labels of Eric's test notebook.\n\nThis one is fixed indeed. Thanks!",
    "created_at": "2016-11-18T16:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135541",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@paulmasson](#comment:89):
> Opacity issue should now be fixed, 

It seems that there is still an issue with opacity:

```
show(cube() + sphere((2,0,0), opacity=0.2), viewer='threejs')
```
draws the sphere with an opacity of 1.

Besides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? 

> along with an irritating negative zero that appeared in the labels of Eric's test notebook.

This one is fixed indeed. Thanks!



---

archive/issue_comments_135542.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nReplying to [@egourgoulhon](#comment:90):\n> Besides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? \n\nThis is an explicit round-off in the JavaScript: the option `decimals` for the number of decimal points in labels defaults to zero. I thought that `decimals` might be a useful option, for example when the bounding box returns an irrational number. Either the `decimals` option can be removed entirely or only applied when explicity set.\n\nThe number in the label with axes labels is currently the average of the two bounding limits. If `decimals` is removed that number would show an unexpected value when not close to an integer. That's why the `-0` was turning up in your notebook: the number before rounding was a bit less than zero.\n\nThe opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking...",
    "created_at": "2016-11-18T21:59:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135542",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:91" align="right">comment:91</div>

Replying to [@egourgoulhon](#comment:90):
> Besides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? 

This is an explicit round-off in the JavaScript: the option `decimals` for the number of decimal points in labels defaults to zero. I thought that `decimals` might be a useful option, for example when the bounding box returns an irrational number. Either the `decimals` option can be removed entirely or only applied when explicity set.

The number in the label with axes labels is currently the average of the two bounding limits. If `decimals` is removed that number would show an unexpected value when not close to an integer. That's why the `-0` was turning up in your notebook: the number before rounding was a bit less than zero.

The opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking...



---

archive/issue_comments_135543.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nReplying to [@paulmasson](#comment:91):\n> Replying to [@egourgoulhon](#comment:90):\n> > Besides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? \n\n> This is an explicit round-off in the JavaScript: the option `decimals` for the number of decimal points in labels defaults to zero. I thought that `decimals` might be a useful option, for example when the bounding box returns an irrational number. Either the `decimals` option can be removed entirely or only applied when explicity set.\n\nIMHO, it's a very usefull option and it should be maintained.\nCould the default be set to 1? This would solve the above issue (i.e. x_min appears as -0.5). \n> \n> The number in the label with axes labels is currently the average of the two bounding limits. If `decimals` is removed that number would show an unexpected value when not close to an integer. That's why the `-0` was turning up in your notebook: the number before rounding was a bit less than zero.\n\nEven in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. \n> \n> The opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking...\n\nDo you think this is reasonable for the current ticket?",
    "created_at": "2016-11-20T13:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135543",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:92" align="right">comment:92</div>

Replying to [@paulmasson](#comment:91):
> Replying to [@egourgoulhon](#comment:90):
> > Besides, in the same plot, the lower bound of the frame box x-axis is displayed as -1, while it should be -0.5 (since -0.5 is the cube's min(x)). Maybe a round-off issue? 

> This is an explicit round-off in the JavaScript: the option `decimals` for the number of decimal points in labels defaults to zero. I thought that `decimals` might be a useful option, for example when the bounding box returns an irrational number. Either the `decimals` option can be removed entirely or only applied when explicity set.

IMHO, it's a very usefull option and it should be maintained.
Could the default be set to 1? This would solve the above issue (i.e. x_min appears as -0.5). 
> 
> The number in the label with axes labels is currently the average of the two bounding limits. If `decimals` is removed that number would show an unexpected value when not close to an integer. That's why the `-0` was turning up in your notebook: the number before rounding was a bit less than zero.

Even in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. 
> 
> The opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking...

Do you think this is reasonable for the current ticket?



---

archive/issue_comments_135544.json:
```json
{
    "body": "Changed commit from **[`191b7ae`](https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c)** to **[`898a554`](https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c)**",
    "created_at": "2016-11-21T23:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135544",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`191b7ae`](https://github.com/sagemath/sagetrac-mirror/commit/191b7ae8ef13e8e6e146b13ca91acf0670e4cd1c)** to **[`898a554`](https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c)**



---

archive/issue_comments_135545.json:
```json
{
    "body": "<div id=\"comment:93\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15ccb33fe386f17903d66486eb4227f131bdfe98\"><code>15ccb33</code></a></td><td><code>Default decimals to 2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10e0766040c71e3c0e9f58fb0466c7948f67c64b\"><code>10e0766</code></a></td><td><code>Add extra keywords to parametric surface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c\"><code>898a554</code></a></td><td><code>Add extra keywords to implicit surface</code></td></tr></table>\n",
    "created_at": "2016-11-21T23:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135545",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:93"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15ccb33fe386f17903d66486eb4227f131bdfe98"><code>15ccb33</code></a></td><td><code>Default decimals to 2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10e0766040c71e3c0e9f58fb0466c7948f67c64b"><code>10e0766</code></a></td><td><code>Add extra keywords to parametric surface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c"><code>898a554</code></a></td><td><code>Add extra keywords to implicit surface</code></td></tr></table>




---

archive/issue_comments_135546.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nReplying to [@egourgoulhon](#comment:92):\n> Replying to [@paulmasson](#comment:91):\n> > Replying to [@egourgoulhon](#comment:90):\n\n> Even in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. \n\nWe want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. I've defaulted `decimals` to 2 for now so we can move forward.\n> > The opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking... \n\n> Do you think this is reasonable for the current ticket?\n\nI think I've found the minimal changes necessary to get this to work. The `_extra_kwds` for `ParametricSurface` (which is used for `sphere()`) and `ImplicitSurface` were both empty when their respective `json_repr`s were called, so I set them both explicitly in the `__init__` functions. I think this is a harmless change, since it just duplicates what is done outside the classes with instances of geometries dependent on them, and it certainly gets things working right now. If it causes problems down the line we'll have to rethink the entire `json_repr` structure and that would certainly be another ticket.",
    "created_at": "2016-11-21T23:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135546",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:94" align="right">comment:94</div>

Replying to [@egourgoulhon](#comment:92):
> Replying to [@paulmasson](#comment:91):
> > Replying to [@egourgoulhon](#comment:90):

> Even in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. 

We want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. I've defaulted `decimals` to 2 for now so we can move forward.
> > The opacity issue for different shapes is occurring because `_extra_kwds` is not being set explicitly for all different paths to `IndexFaceSet`, which is the underlying class. This will take a bit of tracking... 

> Do you think this is reasonable for the current ticket?

I think I've found the minimal changes necessary to get this to work. The `_extra_kwds` for `ParametricSurface` (which is used for `sphere()`) and `ImplicitSurface` were both empty when their respective `json_repr`s were called, so I set them both explicitly in the `__init__` functions. I think this is a harmless change, since it just duplicates what is done outside the classes with instances of geometries dependent on them, and it certainly gets things working right now. If it causes problems down the line we'll have to rethink the entire `json_repr` structure and that would certainly be another ticket.



---

archive/issue_comments_135547.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nReplying to [@paulmasson](#comment:94):\n> Replying to [@egourgoulhon](#comment:92):\n> > Even in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. \n\n> We want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. \n\nLet me insist: since xmin=-0.5 and xmax=3.0, the half-way is x=1.75.\n\n>I've defaulted `decimals` to 2 for now so we can move forward.\n\nOK, thanks. \n\n> I think I've found the minimal changes necessary to get this to work. The `_extra_kwds` for `ParametricSurface` (which is used for `sphere()`) and `ImplicitSurface` were both empty when their respective `json_repr`s were called, so I set them both explicitly in the `__init__` functions. I think this is a harmless change, since it just duplicates what is done outside the classes with instances of geometries dependent on them, and it certainly gets things working right now. If it causes problems down the line we'll have to rethink the entire `json_repr` structure and that would certainly be another ticket. \n\nVery good. The `opacity` option works well now!\n\nBy the way, what about `thickness`? It does not seem to be effective at the moment, even on a Linux computer (cf. [comment:69](#comment:69)):\n\n```\nshow(line([(0,0,0), (1,1,1)]) + line([(1,0,0), (1,1,1)], thickness=4), \n     viewer='threejs')\n```\ndisplays two lines of thickness 1, while replacing `'threejs'` by `'jmol'` or `'tachyon'` shows correctly the second line thicker than the first one.",
    "created_at": "2016-11-22T10:45:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135547",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:95" align="right">comment:95</div>

Replying to [@paulmasson](#comment:94):
> Replying to [@egourgoulhon](#comment:92):
> > Even in the current settings, there seems to be some issue with that: considering again the example of [comment:90](#comment:90) with `decimals=2`, we get the label `x=1.25`, while it should be `x=1.75`. 

> We want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. 

Let me insist: since xmin=-0.5 and xmax=3.0, the half-way is x=1.75.

>I've defaulted `decimals` to 2 for now so we can move forward.

OK, thanks. 

> I think I've found the minimal changes necessary to get this to work. The `_extra_kwds` for `ParametricSurface` (which is used for `sphere()`) and `ImplicitSurface` were both empty when their respective `json_repr`s were called, so I set them both explicitly in the `__init__` functions. I think this is a harmless change, since it just duplicates what is done outside the classes with instances of geometries dependent on them, and it certainly gets things working right now. If it causes problems down the line we'll have to rethink the entire `json_repr` structure and that would certainly be another ticket. 

Very good. The `opacity` option works well now!

By the way, what about `thickness`? It does not seem to be effective at the moment, even on a Linux computer (cf. [comment:69](#comment:69)):

```
show(line([(0,0,0), (1,1,1)]) + line([(1,0,0), (1,1,1)], thickness=4), 
     viewer='threejs')
```
displays two lines of thickness 1, while replacing `'threejs'` by `'jmol'` or `'tachyon'` shows correctly the second line thicker than the first one.



---

archive/issue_comments_135548.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@egourgoulhon](#comment:95):\n> \n> Very good. The `opacity` option works well now!\n> \n\nWell, not completely: in the example\n\n```\nshow(cube(opacity=0.2) + sphere((2,0,0)), viewer='threejs')\n```\nthe sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.",
    "created_at": "2016-11-22T10:58:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135548",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@egourgoulhon](#comment:95):
> 
> Very good. The `opacity` option works well now!
> 

Well, not completely: in the example

```
show(cube(opacity=0.2) + sphere((2,0,0)), viewer='threejs')
```
the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.



---

archive/issue_comments_135549.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nReplying to [@egourgoulhon](#comment:96):\n> Replying to [@egourgoulhon](#comment:95):\n> > \n> > Very good. The `opacity` option works well now!\n> > \n\n> Well, not completely: in the example\n> \n> ```\n> show(cube(opacity=0.2) + sphere((2,0,0)), viewer='threejs')\n> ```\n> the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  \n\nI'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.",
    "created_at": "2016-11-23T21:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135549",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:97" align="right">comment:97</div>

Replying to [@egourgoulhon](#comment:96):
> Replying to [@egourgoulhon](#comment:95):
> > 
> > Very good. The `opacity` option works well now!
> > 

> Well, not completely: in the example
> 
> ```
> show(cube(opacity=0.2) + sphere((2,0,0)), viewer='threejs')
> ```
> the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  

I'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.



---

archive/issue_comments_135550.json:
```json
{
    "body": "Attachment: **[cube_sphere_threejs.png](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_threejs.png)**",
    "created_at": "2016-11-23T21:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135550",
    "user": "https://github.com/egourgoulhon"
}
```

Attachment: **[cube_sphere_threejs.png](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_threejs.png)**



---

archive/issue_comments_135551.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nAttachment: **[cube_sphere_jmol.png](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_jmol.png)**\n\nReplying to [@paulmasson](#comment:97):\n> >  the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  \n\n> I'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.\n\nIf you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:\n\n![](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_threejs.png)\n\nOn the contrary, with jmol, you can see the sphere through the cube:\n\n![](https://github.com/sagemath/sage/files/ticket12402/6b6c8ce591a91532afc15b6da6febc17.png\u200b)",
    "created_at": "2016-11-23T21:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135551",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:98" align="right">comment:98</div>

Attachment: **[cube_sphere_jmol.png](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_jmol.png)**

Replying to [@paulmasson](#comment:97):
> >  the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  

> I'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.

If you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:

![](https://github.com/sagemath/sage/files/ticket12402/cube_sphere_threejs.png)

On the contrary, with jmol, you can see the sphere through the cube:

![](https://github.com/sagemath/sage/files/ticket12402/6b6c8ce591a91532afc15b6da6febc17.png)



---

archive/issue_comments_135552.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nNote that if you permute the cube and the sphere in the graphic sum, i.e. run\n\n```\nshow(sphere((2,0,0)) + cube(opacity=0.2), viewer='threejs')\n```\nit works well (the output is similar to the jmol one above).",
    "created_at": "2016-11-23T22:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135552",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:99" align="right">comment:99</div>

Note that if you permute the cube and the sphere in the graphic sum, i.e. run

```
show(sphere((2,0,0)) + cube(opacity=0.2), viewer='threejs')
```
it works well (the output is similar to the jmol one above).



---

archive/issue_comments_135553.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34\"><code>2c33155</code></a></td><td><code>Add line thickness to extra keywords</code></td></tr></table>\n",
    "created_at": "2016-11-23T22:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135553",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34"><code>2c33155</code></a></td><td><code>Add line thickness to extra keywords</code></td></tr></table>




---

archive/issue_comments_135554.json:
```json
{
    "body": "Changed commit from **[`898a554`](https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c)** to **[`2c33155`](https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34)**",
    "created_at": "2016-11-23T22:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135554",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`898a554`](https://github.com/sagemath/sagetrac-mirror/commit/898a5547814a4fec2213c62befba9709709d1b6c)** to **[`2c33155`](https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34)**



---

archive/issue_comments_135555.json:
```json
{
    "body": "Changed commit from **[`2c33155`](https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34)** to **[`e1f8460`](https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1)**",
    "created_at": "2016-11-23T22:46:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135555",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2c33155`](https://github.com/sagemath/sagetrac-mirror/commit/2c3315527aacadd75176bc7b57ff27aa5367ee34)** to **[`e1f8460`](https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1)**



---

archive/issue_comments_135556.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1\"><code>e1f8460</code></a></td><td><code>Fix transparency issue</code></td></tr></table>\n",
    "created_at": "2016-11-23T22:46:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135556",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1"><code>e1f8460</code></a></td><td><code>Fix transparency issue</code></td></tr></table>




---

archive/issue_comments_135557.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nReplying to [@egourgoulhon](#comment:98):\n> Replying to [@paulmasson](#comment:97):\n> > >  the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  \n\n> > I'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.\n\n> \n> If you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:\n\nGot it! Should be fixed now.",
    "created_at": "2016-11-23T22:48:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135557",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:102" align="right">comment:102</div>

Replying to [@egourgoulhon](#comment:98):
> Replying to [@paulmasson](#comment:97):
> > >  the sphere is totally hidden by the cube. Again `viewer='jmol'` works fine in this case.  

> > I'm not understanding the problem here: this example looks fine to me. The default axes in Three.js are rotated relative to Jmol but that's the only difference I see.

> 
> If you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:

Got it! Should be fixed now.



---

archive/issue_comments_135558.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@egourgoulhon](#comment:95):\n> Replying to [@paulmasson](#comment:94):\n> > Replying to [@egourgoulhon](#comment:92):\n\n> By the way, what about `thickness`? It does not seem to be effective at the moment, even on a Linux computer (cf. [comment:69](#comment:69)):\n\nThe keyword `thickness` is missing from `_extra_kwds` for objects created with `line3d` but not strangely enough for `parametric_plot3d` which calls `line3d`: a quirk of keyword arguments. I've added it explicitly for the purposes of this ticket.\n\nA better way to handle this situation is to define `json_repr` for `Line` and `Point` just as it already exists for `IndexFaceSet`. That would require a complete rewrite of `_rich_repr_threejs` and I'd rather do that on a separate ticket, so hopefully the simple change to `line3d` is sufficient for a first version.",
    "created_at": "2016-11-23T22:53:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135558",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@egourgoulhon](#comment:95):
> Replying to [@paulmasson](#comment:94):
> > Replying to [@egourgoulhon](#comment:92):

> By the way, what about `thickness`? It does not seem to be effective at the moment, even on a Linux computer (cf. [comment:69](#comment:69)):

The keyword `thickness` is missing from `_extra_kwds` for objects created with `line3d` but not strangely enough for `parametric_plot3d` which calls `line3d`: a quirk of keyword arguments. I've added it explicitly for the purposes of this ticket.

A better way to handle this situation is to define `json_repr` for `Line` and `Point` just as it already exists for `IndexFaceSet`. That would require a complete rewrite of `_rich_repr_threejs` and I'd rather do that on a separate ticket, so hopefully the simple change to `line3d` is sufficient for a first version.



---

archive/issue_comments_135559.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@egourgoulhon](#comment:95):\n> Replying to [@paulmasson](#comment:94):\n> > Replying to [@egourgoulhon](#comment:92):\n> > We want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. \n\n> \n> Let me insist: since xmin=-0.5 and xmax=3.0, the half-way is x=1.75.\n\nIf the lower endpoint were xmin=0 the midpoint would be 1.5, right? If the lower endpont moves up to +.5 then I agree the midpoint would be 1.75, but if the lower endpoint moves below zero to -.5 then the midpoint moves below 1.5 to 1.25.",
    "created_at": "2016-11-23T22:56:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135559",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@egourgoulhon](#comment:95):
> Replying to [@paulmasson](#comment:94):
> > Replying to [@egourgoulhon](#comment:92):
> > We want the middle label to show the point halfway between the two ends: that's 1.25, not 1.75. 

> 
> Let me insist: since xmin=-0.5 and xmax=3.0, the half-way is x=1.75.

If the lower endpoint were xmin=0 the midpoint would be 1.5, right? If the lower endpont moves up to +.5 then I agree the midpoint would be 1.75, but if the lower endpoint moves below zero to -.5 then the midpoint moves below 1.5 to 1.25.



---

archive/issue_comments_135560.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@slel](#comment:69):\n> Replying to [@egourgoulhon](#comment:68):\n> > Replying to [@paulmasson](#comment:66):\n> > \n> > Thanks for your answers.\n> > \n> > > 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. \n\n> > \n> > I would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. \n\n> \n> True, Windows line thickness could be its own ticket, and making three.js the default viewer could be another ticket depending on it.\n\nIn the process of fixing a line thickness problem, I came across an existing keyword `radius` for drawing lines. This already solves the problem of drawing thicker lines since they are rendered as cylindrical segments.\n\nLine thickness in WebGL is very hardware dependent even apart from the Windows problem. It will max out around 10 on Mac OS X, with higher values not having any effect. There's no problem leaving `linethickness` in place for those who want to use it, but the `radius` option is perhaps better and works already.",
    "created_at": "2016-11-23T23:11:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135560",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@slel](#comment:69):
> Replying to [@egourgoulhon](#comment:68):
> > Replying to [@paulmasson](#comment:66):
> > 
> > Thanks for your answers.
> > 
> > > 3) The code used for `line` objects needs to be completely rewritten. There is a hardware driver limitation on Windows machines that prevents rendering of line thickness in WebGL that is not going away soon, and I'm still thinking about the best way around this. Andrey certainly won't approve this ticket without line thickness rendering decently across hardware platforms, and I agree with him on that. 

> > 
> > I would be on a different tone here: as long as three.js is not Sage's default 3D viewer, I see no reason to defer its use for Linux and MacOS users, simply because Windows is limited. When decision is taken to make three.js the default viewer, it's of course a different matter. So IMHO the Windows line thickness issue could be postponed to another ticket. 

> 
> True, Windows line thickness could be its own ticket, and making three.js the default viewer could be another ticket depending on it.

In the process of fixing a line thickness problem, I came across an existing keyword `radius` for drawing lines. This already solves the problem of drawing thicker lines since they are rendered as cylindrical segments.

Line thickness in WebGL is very hardware dependent even apart from the Windows problem. It will max out around 10 on Mac OS X, with higher values not having any effect. There's no problem leaving `linethickness` in place for those who want to use it, but the `radius` option is perhaps better and works already.



---

archive/issue_comments_135561.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nReplying to [@paulmasson](#comment:104):\n> If the lower endpoint were xmin=0 the midpoint would be 1.5, right? If the lower endpont moves up to +.5 then I agree the midpoint would be 1.75, but if the lower endpoint moves below zero to -.5 then the midpoint moves below 1.5 to 1.25.\n\nOups... you are perfectly right! Sorry for the confusion...",
    "created_at": "2016-11-23T23:16:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135561",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:106" align="right">comment:106</div>

Replying to [@paulmasson](#comment:104):
> If the lower endpoint were xmin=0 the midpoint would be 1.5, right? If the lower endpont moves up to +.5 then I agree the midpoint would be 1.75, but if the lower endpoint moves below zero to -.5 then the midpoint moves below 1.5 to 1.25.

Oups... you are perfectly right! Sorry for the confusion...



---

archive/issue_comments_135562.json:
```json
{
    "body": "Changed commit from **[`e1f8460`](https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1)** to **[`6ee4d31`](https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4)**",
    "created_at": "2016-11-23T23:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e1f8460`](https://github.com/sagemath/sagetrac-mirror/commit/e1f8460243038fb3bde40a41070c5f1b27e3d0c1)** to **[`6ee4d31`](https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4)**



---

archive/issue_comments_135563.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4\"><code>6ee4d31</code></a></td><td><code>Document radius option for lines</code></td></tr></table>\n",
    "created_at": "2016-11-23T23:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4"><code>6ee4d31</code></a></td><td><code>Document radius option for lines</code></td></tr></table>




---

archive/issue_comments_135564.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nReplying to [@paulmasson](#comment:102):\n> > If you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:\n\n> Got it! Should be fixed now.\n\nIndeed! Thanks!",
    "created_at": "2016-11-23T23:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135564",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:108" align="right">comment:108</div>

Replying to [@paulmasson](#comment:102):
> > If you rotate the figure to put the cube in front of the sphere, you cannot see the sphere through it, i.e. the cube is fully opaque:

> Got it! Should be fixed now.

Indeed! Thanks!



---

archive/issue_comments_135565.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThanks for the `radius` and `thickness` options! IMHO this is very close to positive review. A few last points, maybe some of them can be defered to another ticket:\n\n- The documentation about the use of `threejs` in the 3D Graphics section of the\n  reference manual is rather poor. It would be nice to have an entry (even a small one) in \n  the  \"Backends\" subsection (for the time being there is only one such entry: \n  \"The Tachyon 3D Ray Tracer\"), in particular to document options like `decimals`, which are\n  specific to `threejs`. \n- As discussed in [comment:63](#comment:63), an internet connection is required (by \n  `src/sage/plot/plot3d/threejs_template.html`) to access to the files \n  [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and \n  [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it\n  possible/meaningful to integrate a copy of them in Sage's sources files, so that\n  the threejs viewer can be used off-line?\n- What about `text3d`, which seems to be the last major missing functionality?. Would this\n  require another ticket?\n- The `save` method of 3D graphic objects, which generates a static png image, does not accept \n  the option `viewer='threejs'`:\n\n  ```\n  sphere().save('figure.png', viewer='jmol')     # OK\n  sphere().save('figure.png', viewer='tachyon')  # OK\n  sphere().save('figure.png', viewer='threejs') \n  ValueError: cannot use viewer=threejs to render image\n  ```",
    "created_at": "2016-11-24T14:56:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135565",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:9" align="right">comment:9</div>

Thanks for the `radius` and `thickness` options! IMHO this is very close to positive review. A few last points, maybe some of them can be defered to another ticket:

- The documentation about the use of `threejs` in the 3D Graphics section of the
  reference manual is rather poor. It would be nice to have an entry (even a small one) in 
  the  "Backends" subsection (for the time being there is only one such entry: 
  "The Tachyon 3D Ray Tracer"), in particular to document options like `decimals`, which are
  specific to `threejs`. 
- As discussed in [comment:63](#comment:63), an internet connection is required (by 
  `src/sage/plot/plot3d/threejs_template.html`) to access to the files 
  [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and 
  [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it
  possible/meaningful to integrate a copy of them in Sage's sources files, so that
  the threejs viewer can be used off-line?
- What about `text3d`, which seems to be the last major missing functionality?. Would this
  require another ticket?
- The `save` method of 3D graphic objects, which generates a static png image, does not accept 
  the option `viewer='threejs'`:

  ```
  sphere().save('figure.png', viewer='jmol')     # OK
  sphere().save('figure.png', viewer='tachyon')  # OK
  sphere().save('figure.png', viewer='threejs') 
  ValueError: cannot use viewer=threejs to render image
  ```



---

archive/issue_comments_135566.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e5627bd3f6141c3ea3832675ec1c2d9ac5580c2\"><code>8e5627b</code></a></td><td><code>Update doctest to remove long line</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33fcccfdd8141cffa45a998e55358b0208bfc48d\"><code>33fcccf</code></a></td><td><code>JSON cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97c74355ed25eae639fbbd51b45ba03c1b7e6232\"><code>97c7435</code></a></td><td><code>Add basic text3d support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65\"><code>b32d3ae</code></a></td><td><code>Documentation clarifications</code></td></tr></table>\n",
    "created_at": "2016-11-25T21:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135566",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e5627bd3f6141c3ea3832675ec1c2d9ac5580c2"><code>8e5627b</code></a></td><td><code>Update doctest to remove long line</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33fcccfdd8141cffa45a998e55358b0208bfc48d"><code>33fcccf</code></a></td><td><code>JSON cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97c74355ed25eae639fbbd51b45ba03c1b7e6232"><code>97c7435</code></a></td><td><code>Add basic text3d support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65"><code>b32d3ae</code></a></td><td><code>Documentation clarifications</code></td></tr></table>




---

archive/issue_comments_135567.json:
```json
{
    "body": "Changed commit from **[`6ee4d31`](https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4)** to **[`b32d3ae`](https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65)**",
    "created_at": "2016-11-25T21:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135567",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6ee4d31`](https://github.com/sagemath/sagetrac-mirror/commit/6ee4d31c63a69f10bc659bef7647273c4a298dc4)** to **[`b32d3ae`](https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65)**



---

archive/issue_comments_135568.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nReplying to [@egourgoulhon](#comment:109):\n> - The documentation about the use of `threejs` in the 3D Graphics section of the\n>   reference manual is rather poor. It would be nice to have an entry (even a small one) in \n>   the  \"Backends\" subsection (for the time being there is only one such entry: \n>   \"The Tachyon 3D Ray Tracer\"), in particular to document options like `decimals`, which are\n>   specific to `threejs`. \n\nThe tachyon entry is there because its class is a separate Python file. I could make a separate file for Three.js but it won't have anything but documentation and examples, since all of the code is in `Graphics3d._rich_repr_threejs`.\n> - As discussed in [comment:63](#comment:63), an internet connection is required (by \n>   `src/sage/plot/plot3d/threejs_template.html`) to access to the files \n>   [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and \n>   [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it\n>   possible/meaningful to integrate a copy of them in Sage's sources files, so that\n>   the threejs viewer can be used off-line?\n\nThis is a planned feature and there is a standard [method](http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go) for switching to local JavaScript when there is no connection. I don't want to include it on this ticket because it will require a modification to the Sage build process to download the two files. I haven't made that sort of change yet and will want feedback from Volker as to the best location for the files to be accessed by both types of existing notebooks.\n> - What about `text3d`, which seems to be the last major missing functionality?. Would this\n>   require another ticket?\n\nI've added basic support for this, with the caveat that it only works when `text3d` is not the only object viewed. This is because `text3d` is a packaged in a `TransformationGroup` and the process of flattening the input mangles the text location stored in the property `_trans`. The current behavior appears to work like Jmol but I'm not completely happy with it. The `text3d` object modifies the bounding box for the entire `GraphicsGroup3d`, so the text often ends up sitting on the frame. A future feature would be to add a `labels` global option that would be an array of text objects that could be placed anywhere, even outside the frame.\n> - The `save` method of 3D graphic objects, which generates a static png image, does not accept \n>   the option `viewer='threejs'`:\n> \n>   ```\n>   sphere().save('figure.png', viewer='jmol')     # OK\n>   sphere().save('figure.png', viewer='tachyon')  # OK\n>   sphere().save('figure.png', viewer='threejs') \n>   ValueError: cannot use viewer=threejs to render image\n>   ```\n\nJmol and Tachyon are their own renderers, so they are capable of producing preview images. The rendering of Three.js occurs entirely in the browser, so this Python method is never going to work for it. What I can add later is a right-context menu for the HTML page that will save image data to a file. That would best be done as a separate ticket.",
    "created_at": "2016-11-25T22:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135568",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:111" align="right">comment:111</div>

Replying to [@egourgoulhon](#comment:109):
> - The documentation about the use of `threejs` in the 3D Graphics section of the
>   reference manual is rather poor. It would be nice to have an entry (even a small one) in 
>   the  "Backends" subsection (for the time being there is only one such entry: 
>   "The Tachyon 3D Ray Tracer"), in particular to document options like `decimals`, which are
>   specific to `threejs`. 

The tachyon entry is there because its class is a separate Python file. I could make a separate file for Three.js but it won't have anything but documentation and examples, since all of the code is in `Graphics3d._rich_repr_threejs`.
> - As discussed in [comment:63](#comment:63), an internet connection is required (by 
>   `src/sage/plot/plot3d/threejs_template.html`) to access to the files 
>   [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and 
>   [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it
>   possible/meaningful to integrate a copy of them in Sage's sources files, so that
>   the threejs viewer can be used off-line?

This is a planned feature and there is a standard [method](http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go) for switching to local JavaScript when there is no connection. I don't want to include it on this ticket because it will require a modification to the Sage build process to download the two files. I haven't made that sort of change yet and will want feedback from Volker as to the best location for the files to be accessed by both types of existing notebooks.
> - What about `text3d`, which seems to be the last major missing functionality?. Would this
>   require another ticket?

I've added basic support for this, with the caveat that it only works when `text3d` is not the only object viewed. This is because `text3d` is a packaged in a `TransformationGroup` and the process of flattening the input mangles the text location stored in the property `_trans`. The current behavior appears to work like Jmol but I'm not completely happy with it. The `text3d` object modifies the bounding box for the entire `GraphicsGroup3d`, so the text often ends up sitting on the frame. A future feature would be to add a `labels` global option that would be an array of text objects that could be placed anywhere, even outside the frame.
> - The `save` method of 3D graphic objects, which generates a static png image, does not accept 
>   the option `viewer='threejs'`:
> 
>   ```
>   sphere().save('figure.png', viewer='jmol')     # OK
>   sphere().save('figure.png', viewer='tachyon')  # OK
>   sphere().save('figure.png', viewer='threejs') 
>   ValueError: cannot use viewer=threejs to render image
>   ```

Jmol and Tachyon are their own renderers, so they are capable of producing preview images. The rendering of Three.js occurs entirely in the browser, so this Python method is never going to work for it. What I can add later is a right-context menu for the HTML page that will save image data to a file. That would best be done as a separate ticket.



---

archive/issue_comments_135569.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@paulmasson](#comment:111):\n> Replying to [@egourgoulhon](#comment:109):\n> > - The documentation about the use of `threejs` in the 3D Graphics section of the\n> >   reference manual is rather poor. It would be nice to have an entry (even a small one) in \n> >   the  \"Backends\" subsection (for the time being there is only one such entry: \n> >   \"The Tachyon 3D Ray Tracer\"), in particular to document options like `decimals`, which are\n> >   specific to `threejs`. \n\n> The tachyon entry is there because its class is a separate Python file. I could make a separate file for Three.js but it won't have anything but documentation and examples, since all of the code is in `Graphics3d._rich_repr_threejs`.\n\nOK, but note that one can set up a pure documentation file, with only docstrings and no Python code; an example is `src/sage/plot/plot3d/examples.py`. Maybe you should just add a few lines to that file.\n\n> > - As discussed in [comment:63](#comment:63), an internet connection is required (by \n> >   `src/sage/plot/plot3d/threejs_template.html`) to access to the files \n> >   [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and \n> >   [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it\n> >   possible/meaningful to integrate a copy of them in Sage's sources files, so that\n> >   the threejs viewer can be used off-line?\n\n> This is a planned feature and there is a standard [method](http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go) for switching to local JavaScript when there is no connection. I don't want to include it on this ticket because it will require a modification to the Sage build process to download the two files. I haven't made that sort of change yet and will want feedback from Volker as to the best location for the files to be accessed by both types of existing notebooks.\n\nOK very good.\n\n> I've added basic support for this, with the caveat that it only works when `text3d` is not the only object viewed. This is because `text3d` is a packaged in a `TransformationGroup` and the process of flattening the input mangles the text location stored in the property `_trans`. The current behavior appears to work like Jmol but I'm not completely happy with it. The `text3d` object modifies the bounding box for the entire `GraphicsGroup3d`, so the text often ends up sitting on the frame. A future feature would be to add a `labels` global option that would be an array of text objects that could be placed anywhere, even outside the frame.\n\nOK, thank you very much for the addition of `text3d`! \n\n> Jmol and Tachyon are their own renderers, so they are capable of producing preview images. The rendering of Three.js occurs entirely in the browser, so this Python method is never going to work for it. What I can add later is a right-context menu for the HTML page that will save image data to a file. That would best be done as a separate ticket.\n\nOK fine. \n\nPlaying with the latest version, I've noticed an issue with `point3d`: running\n\n```\nshow(cube() + point3d((0,0,1)), viewer='threejs')\n```\nresults in a frame box that is too high: z_max = 2, whereas it should be 1. With Jmol or Tachyon, the frame box is fine.",
    "created_at": "2016-11-26T14:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135569",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@paulmasson](#comment:111):
> Replying to [@egourgoulhon](#comment:109):
> > - The documentation about the use of `threejs` in the 3D Graphics section of the
> >   reference manual is rather poor. It would be nice to have an entry (even a small one) in 
> >   the  "Backends" subsection (for the time being there is only one such entry: 
> >   "The Tachyon 3D Ray Tracer"), in particular to document options like `decimals`, which are
> >   specific to `threejs`. 

> The tachyon entry is there because its class is a separate Python file. I could make a separate file for Three.js but it won't have anything but documentation and examples, since all of the code is in `Graphics3d._rich_repr_threejs`.

OK, but note that one can set up a pure documentation file, with only docstrings and no Python code; an example is `src/sage/plot/plot3d/examples.py`. Maybe you should just add a few lines to that file.

> > - As discussed in [comment:63](#comment:63), an internet connection is required (by 
> >   `src/sage/plot/plot3d/threejs_template.html`) to access to the files 
> >   [three.js](https://github.com/mrdoob/three.js/blob/dev/build/three.js) and 
> >   [OrbitControls.js](https://github.com/mrdoob/three.js/blob/dev/examples/js/controls/OrbitControls.js). Apparently these files are released under a MIT license. Is it
> >   possible/meaningful to integrate a copy of them in Sage's sources files, so that
> >   the threejs viewer can be used off-line?

> This is a planned feature and there is a standard [method](http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go) for switching to local JavaScript when there is no connection. I don't want to include it on this ticket because it will require a modification to the Sage build process to download the two files. I haven't made that sort of change yet and will want feedback from Volker as to the best location for the files to be accessed by both types of existing notebooks.

OK very good.

> I've added basic support for this, with the caveat that it only works when `text3d` is not the only object viewed. This is because `text3d` is a packaged in a `TransformationGroup` and the process of flattening the input mangles the text location stored in the property `_trans`. The current behavior appears to work like Jmol but I'm not completely happy with it. The `text3d` object modifies the bounding box for the entire `GraphicsGroup3d`, so the text often ends up sitting on the frame. A future feature would be to add a `labels` global option that would be an array of text objects that could be placed anywhere, even outside the frame.

OK, thank you very much for the addition of `text3d`! 

> Jmol and Tachyon are their own renderers, so they are capable of producing preview images. The rendering of Three.js occurs entirely in the browser, so this Python method is never going to work for it. What I can add later is a right-context menu for the HTML page that will save image data to a file. That would best be done as a separate ticket.

OK fine. 

Playing with the latest version, I've noticed an issue with `point3d`: running

```
show(cube() + point3d((0,0,1)), viewer='threejs')
```
results in a frame box that is too high: z_max = 2, whereas it should be 1. With Jmol or Tachyon, the frame box is fine.



---

archive/issue_comments_135570.json:
```json
{
    "body": "Changed commit from **[`b32d3ae`](https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65)** to **[`d329b81`](https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c)**",
    "created_at": "2016-11-26T21:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135570",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b32d3ae`](https://github.com/sagemath/sagetrac-mirror/commit/b32d3ae908f8605fda159c9e10d7b27cde8b7b65)** to **[`d329b81`](https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c)**



---

archive/issue_comments_135571.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c\"><code>d329b81</code></a></td><td><code>Remove moveBoundsOffPoint</code></td></tr></table>\n",
    "created_at": "2016-11-26T21:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135571",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c"><code>d329b81</code></a></td><td><code>Remove moveBoundsOffPoint</code></td></tr></table>




---

archive/issue_comments_135572.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nReplying to [@egourgoulhon](#comment:112):\n> Replying to [@paulmasson](#comment:111):\n> > Replying to [@egourgoulhon](#comment:109):\n\n> OK, but note that one can set up a pure documentation file, with only docstrings and no Python code; an example is `src/sage/plot/plot3d/examples.py`. Maybe you should just add a few lines to that file.\n\nI have a much better idea for this. I'll work on it tomorrow. \n> Playing with the latest version, I've noticed an issue with `point3d`: running\n> \n> ```\n> show(cube() + point3d((0,0,1)), viewer='threejs')\n> ```\n> results in a frame box that is too high: z_max = 2, whereas it should be 1. With Jmol or Tachyon, the frame box is fine.\n\nThe original commit had a function to move points off the bounding frame to help me determine that the points were being rendered. Since this is unexpected behavior, I've removed that function.",
    "created_at": "2016-11-26T21:08:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135572",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:114" align="right">comment:114</div>

Replying to [@egourgoulhon](#comment:112):
> Replying to [@paulmasson](#comment:111):
> > Replying to [@egourgoulhon](#comment:109):

> OK, but note that one can set up a pure documentation file, with only docstrings and no Python code; an example is `src/sage/plot/plot3d/examples.py`. Maybe you should just add a few lines to that file.

I have a much better idea for this. I'll work on it tomorrow. 
> Playing with the latest version, I've noticed an issue with `point3d`: running
> 
> ```
> show(cube() + point3d((0,0,1)), viewer='threejs')
> ```
> results in a frame box that is too high: z_max = 2, whereas it should be 1. With Jmol or Tachyon, the frame box is fine.

The original commit had a function to move points off the bounding frame to help me determine that the points were being rendered. Since this is unexpected behavior, I've removed that function.



---

archive/issue_comments_135573.json:
```json
{
    "body": "Changed commit from **[`d329b81`](https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c)** to **[`98102b5`](https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117)**",
    "created_at": "2016-11-28T22:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135573",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d329b81`](https://github.com/sagemath/sagetrac-mirror/commit/d329b81a84d2aea4a7f7c9a21ee229583ab6a66c)** to **[`98102b5`](https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117)**



---

archive/issue_comments_135574.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034029a8889ba63b87e8d42726f1734c78a8b3e3\"><code>034029a</code></a></td><td><code>Standardize indentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d22cf0d8dfe1046a010c480e43026281750e460\"><code>5d22cf0</code></a></td><td><code>Remove JS eval()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117\"><code>98102b5</code></a></td><td><code>Move documentation to separate file</code></td></tr></table>\n",
    "created_at": "2016-11-28T22:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135574",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034029a8889ba63b87e8d42726f1734c78a8b3e3"><code>034029a</code></a></td><td><code>Standardize indentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d22cf0d8dfe1046a010c480e43026281750e460"><code>5d22cf0</code></a></td><td><code>Remove JS eval()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117"><code>98102b5</code></a></td><td><code>Move documentation to separate file</code></td></tr></table>




---

archive/issue_comments_135575.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nDocumentation is now in a separate file and can be accessed easily from a link in the \"Backends\" section of the index. I've also added a couple live examples for the HTML version. I'll add more later after other fixes/features are addressed on future tickets, particularly making the viewer work offline.\n\nI also made some changes to remove the JavaScript `eval` function from the template. I had it there for convenience but don't want an insecure method in the final version.",
    "created_at": "2016-11-28T22:10:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135575",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:6" align="right">comment:6</div>

Documentation is now in a separate file and can be accessed easily from a link in the "Backends" section of the index. I've also added a couple live examples for the HTML version. I'll add more later after other fixes/features are addressed on future tickets, particularly making the viewer work offline.

I also made some changes to remove the JavaScript `eval` function from the template. I had it there for convenience but don't want an insecure method in the final version.



---

archive/issue_comments_135576.json:
```json
{
    "body": "<div id=\"comment:117\" align=\"right\">comment:117</div>\n\nThanks a lot for all these changes!\nThe documentation looks very nice.\nAs revealed by the patchbot, there are however 2 doctest errors in `src/doc/en/reference/plot3d/threejs.rst` (I could reproduce those on my computer). Once this is fixed, I would go for a positive review. \n \n\nPS: I've updated the [notebook about plotting fields on the 2-sphere](http://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_sphere_threejs.ipynb), which works very well (note that since Sage 7.5.beta4, you do no longer need to install SageManifolds to run it).",
    "created_at": "2016-11-29T16:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135576",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:117" align="right">comment:117</div>

Thanks a lot for all these changes!
The documentation looks very nice.
As revealed by the patchbot, there are however 2 doctest errors in `src/doc/en/reference/plot3d/threejs.rst` (I could reproduce those on my computer). Once this is fixed, I would go for a positive review. 
 

PS: I've updated the [notebook about plotting fields on the 2-sphere](http://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_sphere_threejs.ipynb), which works very well (note that since Sage 7.5.beta4, you do no longer need to install SageManifolds to run it).



---

archive/issue_comments_135577.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b\"><code>b0b2c14</code></a></td><td><code>Fix backend for doctests</code></td></tr></table>\n",
    "created_at": "2016-11-29T23:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135577",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b"><code>b0b2c14</code></a></td><td><code>Fix backend for doctests</code></td></tr></table>




---

archive/issue_comments_135578.json:
```json
{
    "body": "Changed commit from **[`98102b5`](https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117)** to **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**",
    "created_at": "2016-11-29T23:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135578",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`98102b5`](https://github.com/sagemath/sagetrac-mirror/commit/98102b5d2e3e2c3421c7f2f3f1307c87a0a90117)** to **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**



---

archive/issue_comments_135579.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nReplying to [@egourgoulhon](#comment:117):\n> As revealed by the patchbot, there are however 2 doctest errors in `src/doc/en/reference/plot3d/threejs.rst` \n\nDone.",
    "created_at": "2016-11-29T23:08:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135579",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:119" align="right">comment:119</div>

Replying to [@egourgoulhon](#comment:117):
> As revealed by the patchbot, there are however 2 doctest errors in `src/doc/en/reference/plot3d/threejs.rst` 

Done.



---

archive/issue_events_169947.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2016-11-30T07:11:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169947"
}
```



---

archive/issue_events_169948.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2016-11-30T07:11:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169948"
}
```



---

archive/issue_comments_135580.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThank you very much for your work. This is a great enhancement for Sage!",
    "created_at": "2016-11-30T07:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135580",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:0" align="right">comment:0</div>

Thank you very much for your work. This is a great enhancement for Sage!



---

archive/issue_comments_135581.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman, Eric Gourgoulhon, Andrey Novoseltsev, William Stein**",
    "created_at": "2016-11-30T07:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135581",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Karl-Dieter Crisman, Eric Gourgoulhon, Andrey Novoseltsev, William Stein**



---

archive/issue_comments_135582.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI just asked a few dumb questions, so removing name - but nice work!!!",
    "created_at": "2016-11-30T17:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135582",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:1" align="right">comment:1</div>

I just asked a few dumb questions, so removing name - but nice work!!!



---

archive/issue_comments_135583.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman, Eric Gourgoulhon, Andrey Novoseltsev, William Stein** to **Eric Gourgoulhon, Andrey Novoseltsev, William Stein**",
    "created_at": "2016-11-30T17:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135583",
    "user": "https://github.com/kcrisman"
}
```

Changed reviewer from **Karl-Dieter Crisman, Eric Gourgoulhon, Andrey Novoseltsev, William Stein** to **Eric Gourgoulhon, Andrey Novoseltsev, William Stein**



---

archive/issue_comments_135584.json:
```json
{
    "body": "Changed branch from **[u/paulmasson/12402](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/12402)** to **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**",
    "created_at": "2016-12-01T22:32:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135584",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/paulmasson/12402](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/12402)** to **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)**



---

archive/issue_events_169949.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-12-01T22:32:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169949"
}
```



---

archive/issue_events_169950.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "909d9e1808921ea493a398d6440a63f517c4579e",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-12-01T22:32:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12402#event-169950"
}
```



---

archive/issue_comments_135585.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere is a `threejs` (optional) package in Sage already. Do you really need to fetch files from a CDN (without user prior consent), and not those provided by the package ? What would be missing ?",
    "created_at": "2016-12-02T08:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135585",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:3" align="right">comment:3</div>

There is a `threejs` (optional) package in Sage already. Do you really need to fetch files from a CDN (without user prior consent), and not those provided by the package ? What would be missing ?



---

archive/issue_comments_135586.json:
```json
{
    "body": "Changed commit from **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)** to none",
    "created_at": "2016-12-02T08:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135586",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed commit from **[`b0b2c14`](https://github.com/sagemath/sagetrac-mirror/commit/b0b2c148ad7fa9a0030b5b7d9e1efe2d7ff63e8b)** to none



---

archive/issue_comments_135587.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nsee https://groups.google.com/d/msg/sage-release/__wlsF1jv_Y/VQc35Pf7CAAJ : \n\n```\n         from sage.env import SAGE_SRC \n         filename = os.path.join(SAGE_SRC, 'sage', \n                                 'plot', 'plot3d', 'threejs_template.html') \n         f = open(filename, 'r') \n         html = f.read() \n         f.close() \n```\nis bad, as SAGE_SRC should not be used at runtime: all these files should be installed in SAGE_LOCAL, oe whatever the right place is.\n\nMatthias and Jeroen know more on how this should be properly set up.",
    "created_at": "2016-12-02T09:41:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135587",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

see https://groups.google.com/d/msg/sage-release/__wlsF1jv_Y/VQc35Pf7CAAJ : 

```
         from sage.env import SAGE_SRC 
         filename = os.path.join(SAGE_SRC, 'sage', 
                                 'plot', 'plot3d', 'threejs_template.html') 
         f = open(filename, 'r') 
         html = f.read() 
         f.close() 
```
is bad, as SAGE_SRC should not be used at runtime: all these files should be installed in SAGE_LOCAL, oe whatever the right place is.

Matthias and Jeroen know more on how this should be properly set up.



---

archive/issue_comments_135588.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFor this, you should put the `threejs_template.html` file in some `SAGE_ROOT/src/ext/threejs/` directory (or replace threejs by something more appropriate if you think it is a good idea). Then it will be automatically copied to `SAGE_ROOT/local/share/sage/ext/threejs/`, and you should access it with `os.path.join(SAGE_EXTCODE, 'threejs', 'threejs_template.html')` because some distros split the stuff and do not have such thing as `SAGE_ROOT`.",
    "created_at": "2016-12-02T10:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135588",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:5" align="right">comment:5</div>

For this, you should put the `threejs_template.html` file in some `SAGE_ROOT/src/ext/threejs/` directory (or replace threejs by something more appropriate if you think it is a good idea). Then it will be automatically copied to `SAGE_ROOT/local/share/sage/ext/threejs/`, and you should access it with `os.path.join(SAGE_EXTCODE, 'threejs', 'threejs_template.html')` because some distros split the stuff and do not have such thing as `SAGE_ROOT`.



---

archive/issue_comments_135589.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nFollow-up : #22014",
    "created_at": "2016-12-03T12:39:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135589",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:6" align="right">comment:6</div>

Follow-up : #22014



---

archive/issue_comments_135590.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFollow-up at #32560 regarding auto-scaling-down\nthe z direction when aspect ratio is [1, 1, 1].",
    "created_at": "2021-10-25T14:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12402#issuecomment-135590",
    "user": "https://github.com/slel"
}
```

<div id="comment:7" align="right">comment:7</div>

Follow-up at #32560 regarding auto-scaling-down
the z direction when aspect ratio is [1, 1, 1].
