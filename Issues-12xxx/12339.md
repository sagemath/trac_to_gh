# Issue 12339: Free Groups

archive/issues_012167.json:
```json
{
    "assignees": [],
    "body": "I aim to write some classes to implement free groups, finitely presented groups and braid groups. Mostly it would consist in wrapping gap functions, so maybe it would need to be rewritten in the future if libgap is finished. \n\nI don't have any previous experience in implementing new classes or using the category framework, but so far i have started with a little proof of concept. I would really apreciate any feedback or help.\n\nThis is an example of some things that you can do so far:\n\nBasic arithmetic in Free and Finitely presented groups:\n\n```\nsage: G.<a,b,c,d,e> = FreeGroup()\nsage: a*b*c*d/a/a/e\na*b*c*d*a^-2*e^-1\nsage: H = G / [a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e]\nsage: H.gens()\n(a, b, c, d, e)\nsage: H([1,2,3]) / H([3,2,1])\na*b*c*a^-1*b^-1*c^-1\n```\n\nFox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):\n\n```\nsage: G<a,b,c> = FreeGroup()    \nsage: a*b*c/a/a/c  \na*b*c*a^-2*c^-1\nsage: H = G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              \nsage: H.gens()\n(a, b, c)\nsage: H([1,2,3])/H([3,2,1])\na*b*c*a^-1*b^-1*c^-1\nsage: (a*b*a/b/a).fox_derivative(a)\nB[1] + B[a*b] - B[a*b*a*b^-1*a^-1]\nsage: H.alexander_matrix()\n[                           B[1] + B[x0]                                       0                                       0]\n[                                      0                            B[1] + B[x1]                                       0]\n[                                      0                                       0                  B[1] + B[x2] + B[x2^2]]\n[                        B[1] + B[x0*x1]                     B[x0] + B[x0*x1*x0]                                       0]\n[                        B[1] + B[x0*x2]                                       0                     B[x0] + B[x0*x2*x0]]\n[                                      0        B[1] + B[x1*x2] + B[x1*x2*x1*x2] B[x1] + B[x1*x2*x1] + B[x1*x2*x1*x2*x1]]\n```\n\nSome properties of finitely presented groups. \n\n```\nsage: G = FreeGroup(3)          \nsage: G.inject_variables()\nDefining x0, x1, x2\nsage: H = G / [x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2]\nsage: H.simplification_isomorphism()\nGeneric morphism:\n  From: Finitely presented group < x0, x1, x2 | x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2 >\n  To:   Finitely presented group < x1, x2 | x2^2, x1*x2*x1*x2 >\nsage: H.abelian_invariants()\n(2, 2)\nsage: H.simplification_isomorphism()(x0)\n1\nsage: H.simplification_isomorphism()(x1)\nx1\nsage: H.simplification_isomorphism()(x2)\nx2\nsage: H.abelian_invariants()\n(2, 2)\n```\n\nCaution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.\n\n\n```\nsage: G = FreeGroup(3)\nsage: G.inject_variables()\nDefining x0, x1, x2\nsage: H = G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])\nsage: H.abelian_invariants()\n(2,)\nsage: H.simplification_isomorphism()\nGeneric morphism:\n  From: Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >\n  To:   Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >\nsage: H.cardinality()\n24\nsage: H.as_permutation_group()\nPermutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]\n```\n\nFor Braid groups, the way to work is similar.\n\n```\nsage: B=BraidGroup(4)\nsage: B\nBraid group on 4 strands\nsage: B([1,2,3,-1,2,-1])\ns0*s1*s2*s0^-1*s1*s0^-1\nsage: b=B([1,2,3,-1,2,-1])\nsage: b.left_normal_form()\n[s0^-1*s1^-1*s2^-1*s0^-1*s1^-1*s0^-2*s1^-1*s2^-1*s0^-1*s1^-1*s0^-1, s0*s1*s2*s1*s0, s0*s2*s1*s0, s0*s1*s0*s2*s1]\nsage: b.permutation()\n[4, 3, 2, 1]\nsage: b.burau_matrix()\n[                -t + 1               -t^2 + t             -t^3 + t^2                    t^3]\n[             -1 + t^-1          -t + 2 - t^-1                      t                      0]\n[    -1 + 2*t^-1 - t^-2 -t + 3 - 2*t^-1 + t^-2                  t - 1                      0]\n[                  t^-1               1 - t^-1                      0                      0]\nsage: b.LKB_matrix()\n[                                                                                                                                             0                                                                                                                                              0                                                                                                         -x^6*y + x^5*y - x^3*y + 2*x^2*y - x*y                                                                                                                                              0                                                                                                                 -x^6*y + x^5*y - x^3*y + x^2*y                                                                                                                         -x^6*y + x^5*y - x^4*y]\n[                                                                                                                                             0                                                                                                                                              0                                                                                                                   -x^5*y + x^4*y - x^2*y + x*y                                                                                                                                              0                                                                                                                         -x^5*y + x^4*y - x^2*y                                                                                                                                 -x^5*y + x^4*y]\n[                                                                                                                                             0                                                                                                                                              0                                                                                                                         -x^4*y + x^3*y - x^2*y                                                                                                                                              0                                                                                                                                 -x^4*y + x^3*y                                                                                                                                              0]\n[                                                                                                                        -x^-3*y^-2 + x^-4*y^-2                                                            -y^-1 + 2*x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2 x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - 2*x*y + 3*x + y - 3 + x^-1 + x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2                                                                                                                  -y^-1 + x^-1*y^-1 - x^-2*y^-1                                                                  x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - x*y + 2*x - 1 + x^-1*y^-1 - x^-2*y^-1                                                                                                            x^5*y - 2*x^4*y + x^3*y - x^3 + x^2]\n[                                                                                                                        -x^-2*y^-1 + x^-3*y^-1                                                                 -x^2*y + x*y - x - y + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                  x^4*y - 2*x^3*y + 2*x^2*y - x*y - x + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                                                                                    -x^2*y + x*y - x + 2 - x^-1                                                                                                         x^4*y - 2*x^3*y + x^2*y - x + 2 - x^-1                                                                                                                                              0]\n[                                                                                                                                    -x^-3*y^-1                                                                                                     -1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                        x^3*y - 2*x^2*y + 2*x*y - y - 1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                                                                                      -1 + x^-1                                                                                                               x^3*y - 2*x^2*y + x*y - 1 + x^-1                                                                                                                                              0]\n\n```\n\nAlso b.plot() and b.plot3d() would plot the braid.\n\n\nThere is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n\nTo install it, just make sure you have applied #6391, #13211, and then apply \n* [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), \n* [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n* [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)\n* [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)\n* [attachment: trac_12339_pickling.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)\n\nDepends on #6391\nDepends on #13687\nDepends on #13588\n\nAssignee: **@wdjoyner**\n\nCC:  @sagetrac-sage-combinat @sagetrac-sydahmad @videlec @jhpalmieri @sagetrac-tjolivet @rbeezer @dimpase\n\nKeywords: **free groups, finitely presented groups, braids**\n\nReviewer: **Volker Braun**\n\nAuthor: **Miguel Marco, Volker Braun**\n\nMerged: **sage-5.7.beta3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12339_\n\n",
    "closed_at": "2013-02-05T08:17:50Z",
    "created_at": "2012-01-21T21:28:41Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Free Groups",
    "type": "issue",
    "updated_at": "2023-01-14T13:33:15Z",
    "url": "https://github.com/sagemath/sage/issues/12339",
    "user": "https://github.com/miguelmarco"
}
```
I aim to write some classes to implement free groups, finitely presented groups and braid groups. Mostly it would consist in wrapping gap functions, so maybe it would need to be rewritten in the future if libgap is finished. 

I don't have any previous experience in implementing new classes or using the category framework, but so far i have started with a little proof of concept. I would really apreciate any feedback or help.

This is an example of some things that you can do so far:

Basic arithmetic in Free and Finitely presented groups:

```
sage: G.<a,b,c,d,e> = FreeGroup()
sage: a*b*c*d/a/a/e
a*b*c*d*a^-2*e^-1
sage: H = G / [a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e]
sage: H.gens()
(a, b, c, d, e)
sage: H([1,2,3]) / H([3,2,1])
a*b*c*a^-1*b^-1*c^-1
```

Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):

```
sage: G<a,b,c> = FreeGroup()    
sage: a*b*c/a/a/c  
a*b*c*a^-2*c^-1
sage: H = G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              
sage: H.gens()
(a, b, c)
sage: H([1,2,3])/H([3,2,1])
a*b*c*a^-1*b^-1*c^-1
sage: (a*b*a/b/a).fox_derivative(a)
B[1] + B[a*b] - B[a*b*a*b^-1*a^-1]
sage: H.alexander_matrix()
[                           B[1] + B[x0]                                       0                                       0]
[                                      0                            B[1] + B[x1]                                       0]
[                                      0                                       0                  B[1] + B[x2] + B[x2^2]]
[                        B[1] + B[x0*x1]                     B[x0] + B[x0*x1*x0]                                       0]
[                        B[1] + B[x0*x2]                                       0                     B[x0] + B[x0*x2*x0]]
[                                      0        B[1] + B[x1*x2] + B[x1*x2*x1*x2] B[x1] + B[x1*x2*x1] + B[x1*x2*x1*x2*x1]]
```

Some properties of finitely presented groups. 

```
sage: G = FreeGroup(3)          
sage: G.inject_variables()
Defining x0, x1, x2
sage: H = G / [x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2]
sage: H.simplification_isomorphism()
Generic morphism:
  From: Finitely presented group < x0, x1, x2 | x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2 >
  To:   Finitely presented group < x1, x2 | x2^2, x1*x2*x1*x2 >
sage: H.abelian_invariants()
(2, 2)
sage: H.simplification_isomorphism()(x0)
1
sage: H.simplification_isomorphism()(x1)
x1
sage: H.simplification_isomorphism()(x2)
x2
sage: H.abelian_invariants()
(2, 2)
```

Caution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.


```
sage: G = FreeGroup(3)
sage: G.inject_variables()
Defining x0, x1, x2
sage: H = G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])
sage: H.abelian_invariants()
(2,)
sage: H.simplification_isomorphism()
Generic morphism:
  From: Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >
  To:   Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >
sage: H.cardinality()
24
sage: H.as_permutation_group()
Permutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]
```

For Braid groups, the way to work is similar.

```
sage: B=BraidGroup(4)
sage: B
Braid group on 4 strands
sage: B([1,2,3,-1,2,-1])
s0*s1*s2*s0^-1*s1*s0^-1
sage: b=B([1,2,3,-1,2,-1])
sage: b.left_normal_form()
[s0^-1*s1^-1*s2^-1*s0^-1*s1^-1*s0^-2*s1^-1*s2^-1*s0^-1*s1^-1*s0^-1, s0*s1*s2*s1*s0, s0*s2*s1*s0, s0*s1*s0*s2*s1]
sage: b.permutation()
[4, 3, 2, 1]
sage: b.burau_matrix()
[                -t + 1               -t^2 + t             -t^3 + t^2                    t^3]
[             -1 + t^-1          -t + 2 - t^-1                      t                      0]
[    -1 + 2*t^-1 - t^-2 -t + 3 - 2*t^-1 + t^-2                  t - 1                      0]
[                  t^-1               1 - t^-1                      0                      0]
sage: b.LKB_matrix()
[                                                                                                                                             0                                                                                                                                              0                                                                                                         -x^6*y + x^5*y - x^3*y + 2*x^2*y - x*y                                                                                                                                              0                                                                                                                 -x^6*y + x^5*y - x^3*y + x^2*y                                                                                                                         -x^6*y + x^5*y - x^4*y]
[                                                                                                                                             0                                                                                                                                              0                                                                                                                   -x^5*y + x^4*y - x^2*y + x*y                                                                                                                                              0                                                                                                                         -x^5*y + x^4*y - x^2*y                                                                                                                                 -x^5*y + x^4*y]
[                                                                                                                                             0                                                                                                                                              0                                                                                                                         -x^4*y + x^3*y - x^2*y                                                                                                                                              0                                                                                                                                 -x^4*y + x^3*y                                                                                                                                              0]
[                                                                                                                        -x^-3*y^-2 + x^-4*y^-2                                                            -y^-1 + 2*x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2 x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - 2*x*y + 3*x + y - 3 + x^-1 + x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2                                                                                                                  -y^-1 + x^-1*y^-1 - x^-2*y^-1                                                                  x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - x*y + 2*x - 1 + x^-1*y^-1 - x^-2*y^-1                                                                                                            x^5*y - 2*x^4*y + x^3*y - x^3 + x^2]
[                                                                                                                        -x^-2*y^-1 + x^-3*y^-1                                                                 -x^2*y + x*y - x - y + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                  x^4*y - 2*x^3*y + 2*x^2*y - x*y - x + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                                                                                    -x^2*y + x*y - x + 2 - x^-1                                                                                                         x^4*y - 2*x^3*y + x^2*y - x + 2 - x^-1                                                                                                                                              0]
[                                                                                                                                    -x^-3*y^-1                                                                                                     -1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                        x^3*y - 2*x^2*y + 2*x*y - y - 1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                                                                                      -1 + x^-1                                                                                                               x^3*y - 2*x^2*y + x*y - 1 + x^-1                                                                                                                                              0]

```

Also b.plot() and b.plot3d() would plot the braid.


There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.

To install it, just make sure you have applied #6391, #13211, and then apply 
* [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), 
* [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
* [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)
* [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)
* [attachment: trac_12339_pickling.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)

Depends on #6391
Depends on #13687
Depends on #13588

Assignee: **@wdjoyner**

CC:  @sagetrac-sage-combinat @sagetrac-sydahmad @videlec @jhpalmieri @sagetrac-tjolivet @rbeezer @dimpase

Keywords: **free groups, finitely presented groups, braids**

Reviewer: **Volker Braun**

Author: **Miguel Marco, Volker Braun**

Merged: **sage-5.7.beta3**

_Issue created by migration from https://trac.sagemath.org/ticket/12339_





---

archive/issue_events_153799.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-01-21T21:28:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "component: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153799"
}
```



---

archive/issue_events_153800.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-01-21T21:28:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153800"
}
```



---

archive/issue_events_153801.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-01-21T21:28:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153801"
}
```



---

archive/issue_comments_136462.json:
```json
{
    "body": "a proof of concept of the free group implementation",
    "created_at": "2012-01-21T21:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136462",
    "user": "https://github.com/miguelmarco"
}
```

a proof of concept of the free group implementation



---

archive/issue_comments_136463.json:
```json
{
    "body": "Attachment: **[freegroups.py.gz](https://github.com/sagemath/sage/files/ticket12339/freegroups.py.gz)**",
    "created_at": "2012-02-14T21:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136463",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[freegroups.py.gz](https://github.com/sagemath/sage/files/ticket12339/freegroups.py.gz)**



---

archive/issue_comments_136464.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nAttachment: **[freegroups.2.py.gz](https://github.com/sagemath/sage/files/ticket12339/freegroups.2.py.gz)**\n\nAdded a new version with finitely presented groups.",
    "created_at": "2012-02-14T21:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136464",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:1" align="right">Comment 1</div>

Attachment: **[freegroups.2.py.gz](https://github.com/sagemath/sage/files/ticket12339/freegroups.2.py.gz)**

Added a new version with finitely presented groups.



---

archive/issue_events_153802.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-02-27T20:45:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153802"
}
```



---

archive/issue_comments_136465.json:
```json
{
    "body": "Author: **Miguel Marco**",
    "created_at": "2012-02-27T20:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136465",
    "user": "https://github.com/miguelmarco"
}
```

Author: **Miguel Marco**



---

archive/issue_comments_136466.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI have added a patch with the free groups, finitely presented groups and braid groups.",
    "created_at": "2012-04-27T20:02:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136466",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:3" align="right">Comment 3</div>

I have added a patch with the free groups, finitely presented groups and braid groups.



---

archive/issue_comments_136467.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nIt isn't a bad idea, if you write in the desc that people need to apply all three patches.",
    "created_at": "2012-04-28T07:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136467",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:4" align="right">Comment 4</div>

It isn't a bad idea, if you write in the desc that people need to apply all three patches.



---

archive/issue_comments_136468.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nActuually, you don't. The last patch does all the work.",
    "created_at": "2012-04-28T15:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136468",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:6" align="right">Comment 6</div>

Actuually, you don't. The last patch does all the work.



---

archive/issue_events_153803.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2012-04-29T13:48:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153803"
}
```



---

archive/issue_events_153804.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2012-04-29T13:48:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153804"
}
```



---

archive/issue_comments_136469.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nHello,\n\nIt will be nice to have that in Sage. First of all, before putting a patch in \"needs review\" you have to verify few things that are in the Developer Guide of Sage. In particular, you should correct:\n\n0.a) There are many trailing whitespaces that you should remove (you can use sed in a console).\n\n0.b) There are 8 doctests that fail  (you may use \"sage -t my_file.py\").\n\n0.c) You should pay attention to the documentation: comment your examples and explain how do they work (both from mathematical and user point of vue). This is very important the reviewer and the future Sage user.\n\nThen there are other possible ways of improvement.\n\n1) I can not multiply braids\n\n```\nsage: B = BraidGroup(4)\nisage: B.inject_variables()\nDefining sigma0, sigma1, sigma2, sigma3\nsage: b=sigma0*sigma1\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: unsupported operand type(s) for *: 'Braid' and 'Braid'\n```\n\n2) I think that the free group should go in a dedicated file (you can not consider it simply as a particular case of a finitely presented group). There are many notions, algorithms and techniques which apply only to it: the notion of rank for subgroups, the notion of free factor, the automorphism dynamics (reducibility, decomposition into Nielsen transformations, action on CV space, train-track representations, ...). I have the same feeling for braid groups.\n\n3) I don't know if a systematic call to GAP is needed for the free group especially in terms of efficiency\n\n```\nsage: F = FreeGroup('a,b')\nsage: a,b = F.generators()\nsage: a*b \na*b\nsage: timeit(\"a*b\")\n5 loops, best of 3: 512 ms per loop\n```\nI have a naive implementation of it which is based on sage.combinat.words.* and works more than 1000 times faster! But don't be to careful with that, it is dedicated to another patch.\n\n... and many more to come. In other words, the patch is not ready at all but it is an important piece that Sage needs.\n\nVincent",
    "created_at": "2012-04-29T13:48:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136469",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">Comment 7</div>

Hello,

It will be nice to have that in Sage. First of all, before putting a patch in "needs review" you have to verify few things that are in the Developer Guide of Sage. In particular, you should correct:

0.a) There are many trailing whitespaces that you should remove (you can use sed in a console).

0.b) There are 8 doctests that fail  (you may use "sage -t my_file.py").

0.c) You should pay attention to the documentation: comment your examples and explain how do they work (both from mathematical and user point of vue). This is very important the reviewer and the future Sage user.

Then there are other possible ways of improvement.

1) I can not multiply braids

```
sage: B = BraidGroup(4)
isage: B.inject_variables()
Defining sigma0, sigma1, sigma2, sigma3
sage: b=sigma0*sigma1
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: unsupported operand type(s) for *: 'Braid' and 'Braid'
```

2) I think that the free group should go in a dedicated file (you can not consider it simply as a particular case of a finitely presented group). There are many notions, algorithms and techniques which apply only to it: the notion of rank for subgroups, the notion of free factor, the automorphism dynamics (reducibility, decomposition into Nielsen transformations, action on CV space, train-track representations, ...). I have the same feeling for braid groups.

3) I don't know if a systematic call to GAP is needed for the free group especially in terms of efficiency

```
sage: F = FreeGroup('a,b')
sage: a,b = F.generators()
sage: a*b 
a*b
sage: timeit("a*b")
5 loops, best of 3: 512 ms per loop
```
I have a naive implementation of it which is based on sage.combinat.words.* and works more than 1000 times faster! But don't be to careful with that, it is dedicated to another patch.

... and many more to come. In other words, the patch is not ready at all but it is an important piece that Sage needs.

Vincent



---

archive/issue_comments_136470.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThanks for the comments, Vincent. I will keep working on it (and any help would be more than welcome).\n\nYou are right about the problem of multiplying braids. It is strange, since at some point it did work, but i can't identify what did i change that produces the error. It should work, since the `_mul_` methods works fine.\n\nI will try to improve the documentation and examples.",
    "created_at": "2012-04-29T16:06:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136470",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:9" align="right">Comment 9</div>

Thanks for the comments, Vincent. I will keep working on it (and any help would be more than welcome).

You are right about the problem of multiplying braids. It is strange, since at some point it did work, but i can't identify what did i change that produces the error. It should work, since the `_mul_` methods works fine.

I will try to improve the documentation and examples.



---

archive/issue_comments_136471.json:
```json
{
    "body": "Updated, fully doctested",
    "created_at": "2012-05-05T15:25:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136471",
    "user": "https://github.com/miguelmarco"
}
```

Updated, fully doctested



---

archive/issue_comments_136472.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nAttachment: **[16190.patch.gz](https://github.com/sagemath/sage/files/ticket12339/16190.patch.gz)**\n\nI have updated the patch. I have separated braid group from the rest. Free groups and finitely presented groups can not be separated, since FreeGroup.quotient() calls FinitelyPresentdGroup, and FinitelyPresentedGroup calls FreeGroup, so splitting them in separated files makes circular dependencies.",
    "created_at": "2012-05-05T15:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136472",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:10" align="right">Comment 10</div>

Attachment: **[16190.patch.gz](https://github.com/sagemath/sage/files/ticket12339/16190.patch.gz)**

I have updated the patch. I have separated braid group from the rest. Free groups and finitely presented groups can not be separated, since FreeGroup.quotient() calls FinitelyPresentdGroup, and FinitelyPresentedGroup calls FreeGroup, so splitting them in separated files makes circular dependencies.



---

archive/issue_comments_136473.json:
```json
{
    "body": "solved a minor issue, apply over the previous one",
    "created_at": "2012-05-14T21:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136473",
    "user": "https://github.com/miguelmarco"
}
```

solved a minor issue, apply over the previous one



---

archive/issue_comments_136474.json:
```json
{
    "body": "Attachment: **[12339-minor.patch.gz](https://github.com/sagemath/sage/files/ticket12339/12339-minor.patch.gz)**\n\nadded comparison of braids, apply over 12339-minor.patch",
    "created_at": "2012-05-14T21:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136474",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[12339-minor.patch.gz](https://github.com/sagemath/sage/files/ticket12339/12339-minor.patch.gz)**

added comparison of braids, apply over 12339-minor.patch



---

archive/issue_comments_136475.json:
```json
{
    "body": "Attachment: **[12339-cmp.patch.gz](https://github.com/sagemath/sage/files/ticket12339/12339-cmp.patch.gz)**\n\nfor using with libgap. apply over 16190.patch. deppends on 6391",
    "created_at": "2012-05-14T21:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136475",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[12339-cmp.patch.gz](https://github.com/sagemath/sage/files/ticket12339/12339-cmp.patch.gz)**

for using with libgap. apply over 16190.patch. deppends on 6391



---

archive/issue_comments_136476.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nAttachment: **[16192.patch.gz](https://github.com/sagemath/sage/files/ticket12339/16192.patch.gz)**\n\nAdded patches 12339-minor.patch and 12339-cmp.patch. They solve an issue with left normal form, and adds comparison of braids.\n\nAll doctests passed, but the testuite fails in pickling (no clue about how to solve it, i think its a problem with gap objects).\n\n\nAs an experiment, i have also added a 16192.patch to make this work with libgap. It deppends on #6391. To make it work, apply #6391, and 16190.patch and then 16192.patch. It works much faster, but there are two problems related to libgap: random segfaults occur, and libgap doesn't handle the simplification isomorphism for finite presentations.",
    "created_at": "2012-05-14T21:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136476",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:11" align="right">Comment 11</div>

Attachment: **[16192.patch.gz](https://github.com/sagemath/sage/files/ticket12339/16192.patch.gz)**

Added patches 12339-minor.patch and 12339-cmp.patch. They solve an issue with left normal form, and adds comparison of braids.

All doctests passed, but the testuite fails in pickling (no clue about how to solve it, i think its a problem with gap objects).


As an experiment, i have also added a 16192.patch to make this work with libgap. It deppends on #6391. To make it work, apply #6391, and 16190.patch and then 16192.patch. It works much faster, but there are two problems related to libgap: random segfaults occur, and libgap doesn't handle the simplification isomorphism for finite presentations.



---

archive/issue_comments_136477.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nAdded a new patch with a cleaned up version. All doctests passed (except a few related with the r interface, but thos failed also on my clean sage install, so i don't think they are related with the patch).\n\nTestsuites for free groups and finitely presented groups passed. _test_category for braids fails, but i really don't understand why, since finitely presented groups pass it, and braid inherit directly from them.",
    "created_at": "2012-05-22T21:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136477",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:12" align="right">Comment 12</div>

Added a new patch with a cleaned up version. All doctests passed (except a few related with the r interface, but thos failed also on my clean sage install, so i don't think they are related with the patch).

Testsuites for free groups and finitely presented groups passed. _test_category for braids fails, but i really don't understand why, since finitely presented groups pass it, and braid inherit directly from them.



---

archive/issue_events_153805.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-22T21:26:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153805"
}
```



---

archive/issue_events_153806.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-22T21:26:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153806"
}
```



---

archive/issue_comments_136478.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,114 @@\n I aim to write some classes to implement free groups, finitely presented groups and braid groups. Mostly it would consist in wrapping gap functions, so maybe it would need to be rewritten in the future if libgap is finished. \n \n I don't have any previous experience in implementing new classes or using the category framework, but so far i have started with a little proof of concept. I would really apreciate any feedback or help.\n+\n+This is an example of some things that you can do so far:\n+\n+Basic arithmetic in Free and Finitely presented groups:\n+\n+```\n+sage: G=FreeGroup('a,b,c,d,e')\n+sage: G.inject_variables()\n+Defining a, b, c, d, e\n+sage: a*b*c*d/a/a/e\n+a*b*c*d*a^-2*e^-1\n+sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e])\n+sage: H.gens()\n+(a, b, c, d, e)\n+sage: H([1,2,3])/H([3,2,1])\n+a*b*c*a^-1*b^-1*c^-1\n+```\n+\n+Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is not given on the group algebra, but in a Laurent polynomial ring):\n+\n+```\n+sage: (a*b*a/b/a).fox_derivative(a)\n+t0*t1 - t0 + 1\n+sage: H.alexander_matrix()\n+[            t0*t1 + 1          t0^2*t1 + t0                     0                     0                     0]\n+[               t0 + 1                     0                     0                     0                     0]\n+[                    0                t1 + 1                     0                     0                     0]\n+[                    0                     0                t2 + 1                     0                     0]\n+[                    0                     0                     0                t3 + 1                     0]\n+[                    0                     0                     0                     0                t4 + 1]\n+[   t0*t1*t2*t3*t4 + 1 t0^2*t1*t2*t3*t4 + t0                 t0*t1              t0*t1*t2           t0*t1*t2*t3]\n+[                    0                     0          t2*t3*t4 + 1       t2^2*t3*t4 + t2  t2^2*t3^2*t4 + t2*t3]\n+[                    0                     0                     0             t3*t4 + 1          t3^2*t4 + t3]\n+```\n+\n+Some properties of finitely presented groups. \n+\n+```\n+sage: G=FreeGroup(3)          \n+sage: G.inject_variables()\n+Defining x0, x1, x2\n+sage: H=G.quotient([x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2])\n+sage: H.simplification_isomorphism()\n+Generic morphism:\n+  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')\n+ and relations (x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2)\n+  To:   Finitely Presented Group on generators ('x1', 'x2')\n+ and relations (x2^2, x1*x2*x1*x2)\n+sage: H.abelian_invariants()\n+[2, 2]\n+sage: H.simplification_isomorphism()(x0)\n+<identity ...>\n+sage: H.simplification_isomorphism()(x1)\n+x1\n+sage: H.simplification_isomorphism()(x2)\n+x2\n+sage: H.abelian_invariants()\n+[2, 2]\n+```\n+\n+Caution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.\n+\n+\n+```\n+sage: G=FreeGroup(3)\n+sage: G.inject_variables()\n+Defining x0, x1, x2\n+sage: H=G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])\n+sage: H.abelian_invariants()\n+[2]\n+sage: H.simplification_isomorphism()\n+Generic morphism:\n+  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')\n+ and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)\n+  To:   Finitely Presented Group on generators ('x0', 'x1', 'x2')\n+ and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)\n+sage: H.size()\n+24\n+sage: H.permutation_group()\n+Permutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]\n+```\n+\n+For Braid groups, the way to work is similar.\n+\n+```\n+sage: B=BraidGroup(4)\n+sage: B\n+Braid group on 4 strands\n+sage: B([1,2,3,-1,2,-1])\n+s0*s1*s2*s0^-1*s1*s0^-1\n+sage: b=B([1,2,3,-1,2,-1])\n+sage: b.left_normal_form()\n+[s0^-1*s1^-1*s2^-1*s0^-1*s1^-1*s0^-2*s1^-1*s2^-1*s0^-1*s1^-1*s0^-1, s0*s1*s2*s1*s0, s0*s2*s1*s0, s0*s1*s0*s2*s1]\n+sage: b.permutation()\n+[4, 3, 2, 1]\n+sage: b.burau_matrix()\n+[                -t + 1               -t^2 + t             -t^3 + t^2                    t^3]\n+[             -1 + t^-1          -t + 2 - t^-1                      t                      0]\n+[    -1 + 2*t^-1 - t^-2 -t + 3 - 2*t^-1 + t^-2                  t - 1                      0]\n+[                  t^-1               1 - t^-1                      0                      0]\n+sage: b.LKB_matrix()\n+[                                                                                                                                             0                                                                                                                                              0                                                                                                         -x^6*y + x^5*y - x^3*y + 2*x^2*y - x*y                                                                                                                                              0                                                                                                                 -x^6*y + x^5*y - x^3*y + x^2*y                                                                                                                         -x^6*y + x^5*y - x^4*y]\n+[                                                                                                                                             0                                                                                                                                              0                                                                                                                   -x^5*y + x^4*y - x^2*y + x*y                                                                                                                                              0                                                                                                                         -x^5*y + x^4*y - x^2*y                                                                                                                                 -x^5*y + x^4*y]\n+[                                                                                                                                             0                                                                                                                                              0                                                                                                                         -x^4*y + x^3*y - x^2*y                                                                                                                                              0                                                                                                                                 -x^4*y + x^3*y                                                                                                                                              0]\n+[                                                                                                                        -x^-3*y^-2 + x^-4*y^-2                                                            -y^-1 + 2*x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2 x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - 2*x*y + 3*x + y - 3 + x^-1 + x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2                                                                                                                  -y^-1 + x^-1*y^-1 - x^-2*y^-1                                                                  x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - x*y + 2*x - 1 + x^-1*y^-1 - x^-2*y^-1                                                                                                            x^5*y - 2*x^4*y + x^3*y - x^3 + x^2]\n+[                                                                                                                        -x^-2*y^-1 + x^-3*y^-1                                                                 -x^2*y + x*y - x - y + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                  x^4*y - 2*x^3*y + 2*x^2*y - x*y - x + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                                                                                    -x^2*y + x*y - x + 2 - x^-1                                                                                                         x^4*y - 2*x^3*y + x^2*y - x + 2 - x^-1                                                                                                                                              0]\n+[                                                                                                                                    -x^-3*y^-1                                                                                                     -1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                        x^3*y - 2*x^2*y + 2*x*y - y - 1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                                                                                      -1 + x^-1                                                                                                               x^3*y - 2*x^2*y + x*y - 1 + x^-1                                                                                                                                              0]\n+\n+```\n+\n+Also b.plot() and b.plot3d() would plot the braid.\n``````\n",
    "created_at": "2012-06-24T12:15:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136478",
    "user": "https://github.com/miguelmarco"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,114 @@
 I aim to write some classes to implement free groups, finitely presented groups and braid groups. Mostly it would consist in wrapping gap functions, so maybe it would need to be rewritten in the future if libgap is finished. 
 
 I don't have any previous experience in implementing new classes or using the category framework, but so far i have started with a little proof of concept. I would really apreciate any feedback or help.
+
+This is an example of some things that you can do so far:
+
+Basic arithmetic in Free and Finitely presented groups:
+
+```
+sage: G=FreeGroup('a,b,c,d,e')
+sage: G.inject_variables()
+Defining a, b, c, d, e
+sage: a*b*c*d/a/a/e
+a*b*c*d*a^-2*e^-1
+sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e])
+sage: H.gens()
+(a, b, c, d, e)
+sage: H([1,2,3])/H([3,2,1])
+a*b*c*a^-1*b^-1*c^-1
+```
+
+Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is not given on the group algebra, but in a Laurent polynomial ring):
+
+```
+sage: (a*b*a/b/a).fox_derivative(a)
+t0*t1 - t0 + 1
+sage: H.alexander_matrix()
+[            t0*t1 + 1          t0^2*t1 + t0                     0                     0                     0]
+[               t0 + 1                     0                     0                     0                     0]
+[                    0                t1 + 1                     0                     0                     0]
+[                    0                     0                t2 + 1                     0                     0]
+[                    0                     0                     0                t3 + 1                     0]
+[                    0                     0                     0                     0                t4 + 1]
+[   t0*t1*t2*t3*t4 + 1 t0^2*t1*t2*t3*t4 + t0                 t0*t1              t0*t1*t2           t0*t1*t2*t3]
+[                    0                     0          t2*t3*t4 + 1       t2^2*t3*t4 + t2  t2^2*t3^2*t4 + t2*t3]
+[                    0                     0                     0             t3*t4 + 1          t3^2*t4 + t3]
+```
+
+Some properties of finitely presented groups. 
+
+```
+sage: G=FreeGroup(3)          
+sage: G.inject_variables()
+Defining x0, x1, x2
+sage: H=G.quotient([x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2])
+sage: H.simplification_isomorphism()
+Generic morphism:
+  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')
+ and relations (x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2)
+  To:   Finitely Presented Group on generators ('x1', 'x2')
+ and relations (x2^2, x1*x2*x1*x2)
+sage: H.abelian_invariants()
+[2, 2]
+sage: H.simplification_isomorphism()(x0)
+<identity ...>
+sage: H.simplification_isomorphism()(x1)
+x1
+sage: H.simplification_isomorphism()(x2)
+x2
+sage: H.abelian_invariants()
+[2, 2]
+```
+
+Caution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.
+
+
+```
+sage: G=FreeGroup(3)
+sage: G.inject_variables()
+Defining x0, x1, x2
+sage: H=G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])
+sage: H.abelian_invariants()
+[2]
+sage: H.simplification_isomorphism()
+Generic morphism:
+  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')
+ and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)
+  To:   Finitely Presented Group on generators ('x0', 'x1', 'x2')
+ and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)
+sage: H.size()
+24
+sage: H.permutation_group()
+Permutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]
+```
+
+For Braid groups, the way to work is similar.
+
+```
+sage: B=BraidGroup(4)
+sage: B
+Braid group on 4 strands
+sage: B([1,2,3,-1,2,-1])
+s0*s1*s2*s0^-1*s1*s0^-1
+sage: b=B([1,2,3,-1,2,-1])
+sage: b.left_normal_form()
+[s0^-1*s1^-1*s2^-1*s0^-1*s1^-1*s0^-2*s1^-1*s2^-1*s0^-1*s1^-1*s0^-1, s0*s1*s2*s1*s0, s0*s2*s1*s0, s0*s1*s0*s2*s1]
+sage: b.permutation()
+[4, 3, 2, 1]
+sage: b.burau_matrix()
+[                -t + 1               -t^2 + t             -t^3 + t^2                    t^3]
+[             -1 + t^-1          -t + 2 - t^-1                      t                      0]
+[    -1 + 2*t^-1 - t^-2 -t + 3 - 2*t^-1 + t^-2                  t - 1                      0]
+[                  t^-1               1 - t^-1                      0                      0]
+sage: b.LKB_matrix()
+[                                                                                                                                             0                                                                                                                                              0                                                                                                         -x^6*y + x^5*y - x^3*y + 2*x^2*y - x*y                                                                                                                                              0                                                                                                                 -x^6*y + x^5*y - x^3*y + x^2*y                                                                                                                         -x^6*y + x^5*y - x^4*y]
+[                                                                                                                                             0                                                                                                                                              0                                                                                                                   -x^5*y + x^4*y - x^2*y + x*y                                                                                                                                              0                                                                                                                         -x^5*y + x^4*y - x^2*y                                                                                                                                 -x^5*y + x^4*y]
+[                                                                                                                                             0                                                                                                                                              0                                                                                                                         -x^4*y + x^3*y - x^2*y                                                                                                                                              0                                                                                                                                 -x^4*y + x^3*y                                                                                                                                              0]
+[                                                                                                                        -x^-3*y^-2 + x^-4*y^-2                                                            -y^-1 + 2*x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2 x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - 2*x*y + 3*x + y - 3 + x^-1 + x^-1*y^-1 - 2*x^-2*y^-1 + x^-2*y^-2 + x^-3*y^-1 - 2*x^-3*y^-2 + x^-4*y^-2                                                                                                                  -y^-1 + x^-1*y^-1 - x^-2*y^-1                                                                  x^5*y - 2*x^4*y + x^3*y + x^2*y - x^2 - x*y + 2*x - 1 + x^-1*y^-1 - x^-2*y^-1                                                                                                            x^5*y - 2*x^4*y + x^3*y - x^3 + x^2]
+[                                                                                                                        -x^-2*y^-1 + x^-3*y^-1                                                                 -x^2*y + x*y - x - y + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                  x^4*y - 2*x^3*y + 2*x^2*y - x*y - x + 3 - 3*x^-1 + x^-1*y^-1 + x^-2 - 2*x^-2*y^-1 + x^-3*y^-1                                                                                                                    -x^2*y + x*y - x + 2 - x^-1                                                                                                         x^4*y - 2*x^3*y + x^2*y - x + 2 - x^-1                                                                                                                                              0]
+[                                                                                                                                    -x^-3*y^-1                                                                                                     -1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                        x^3*y - 2*x^2*y + 2*x*y - y - 1 + 2*x^-1 - x^-2 + x^-2*y^-1 - x^-3*y^-1                                                                                                                                      -1 + x^-1                                                                                                               x^3*y - 2*x^2*y + x*y - 1 + x^-1                                                                                                                                              0]
+
+```
+
+Also b.plot() and b.plot3d() would plot the braid.
``````




---

archive/issue_comments_136479.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nIt looks like this resolves #876.",
    "created_at": "2012-07-07T03:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136479",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:15" align="right">Comment 15</div>

It looks like this resolves #876.



---

archive/issue_comments_136480.json:
```json
{
    "body": "Newer version",
    "created_at": "2012-07-07T18:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136480",
    "user": "https://github.com/miguelmarco"
}
```

Newer version



---

archive/issue_comments_136481.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,21 +19,27 @@\n a*b*c*a^-1*b^-1*c^-1\n ```\n \n-Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is not given on the group algebra, but in a Laurent polynomial ring):\n+Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):\n \n ```\n+sage: G=FreeGroup('a,b,c')    \n+sage: G.inject_variables()\n+Defining a, b, c\n+sage: a*b*c/a/a/c  \n+a*b*c*a^-2*c^-1\n+sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              \n+sage: H.gens()\n+(a, b, c)\n+sage: H([1,2,3])/H([3,2,1])\n+a*b*c*a^-1*b^-1*c^-1\n sage: (a*b*a/b/a).fox_derivative(a)\n-t0*t1 - t0 + 1\n+B[<identity ...>] + B[a*b] - B[a*b*a*b^-1*a^-1]\n sage: H.alexander_matrix()\n-[            t0*t1 + 1          t0^2*t1 + t0                     0                     0                     0]\n-[               t0 + 1                     0                     0                     0                     0]\n-[                    0                t1 + 1                     0                     0                     0]\n-[                    0                     0                t2 + 1                     0                     0]\n-[                    0                     0                     0                t3 + 1                     0]\n-[                    0                     0                     0                     0                t4 + 1]\n-[   t0*t1*t2*t3*t4 + 1 t0^2*t1*t2*t3*t4 + t0                 t0*t1              t0*t1*t2           t0*t1*t2*t3]\n-[                    0                     0          t2*t3*t4 + 1       t2^2*t3*t4 + t2  t2^2*t3^2*t4 + t2*t3]\n-[                    0                     0                     0             t3*t4 + 1          t3^2*t4 + t3]\n+[  B[<identity ...>] + B[a*b]              B[a] + B[a*b*a]                            0]\n+[    B[<identity ...>] + B[a]                            0                            0]\n+[                           0     B[<identity ...>] + B[b]                            0]\n+[                           0                            0     B[<identity ...>] + B[c]]\n+[B[<identity ...>] + B[a*b*c]            B[a] + B[a*b*c*a]        B[a*b] + B[a*b*c*a*b]]\n ```\n \n Some properties of finitely presented groups. \n``````\n",
    "created_at": "2012-07-07T18:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136481",
    "user": "https://github.com/miguelmarco"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,21 +19,27 @@
 a*b*c*a^-1*b^-1*c^-1
 ```
 
-Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is not given on the group algebra, but in a Laurent polynomial ring):
+Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):
 
 ```
+sage: G=FreeGroup('a,b,c')    
+sage: G.inject_variables()
+Defining a, b, c
+sage: a*b*c/a/a/c  
+a*b*c*a^-2*c^-1
+sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              
+sage: H.gens()
+(a, b, c)
+sage: H([1,2,3])/H([3,2,1])
+a*b*c*a^-1*b^-1*c^-1
 sage: (a*b*a/b/a).fox_derivative(a)
-t0*t1 - t0 + 1
+B[<identity ...>] + B[a*b] - B[a*b*a*b^-1*a^-1]
 sage: H.alexander_matrix()
-[            t0*t1 + 1          t0^2*t1 + t0                     0                     0                     0]
-[               t0 + 1                     0                     0                     0                     0]
-[                    0                t1 + 1                     0                     0                     0]
-[                    0                     0                t2 + 1                     0                     0]
-[                    0                     0                     0                t3 + 1                     0]
-[                    0                     0                     0                     0                t4 + 1]
-[   t0*t1*t2*t3*t4 + 1 t0^2*t1*t2*t3*t4 + t0                 t0*t1              t0*t1*t2           t0*t1*t2*t3]
-[                    0                     0          t2*t3*t4 + 1       t2^2*t3*t4 + t2  t2^2*t3^2*t4 + t2*t3]
-[                    0                     0                     0             t3*t4 + 1          t3^2*t4 + t3]
+[  B[<identity ...>] + B[a*b]              B[a] + B[a*b*a]                            0]
+[    B[<identity ...>] + B[a]                            0                            0]
+[                           0     B[<identity ...>] + B[b]                            0]
+[                           0                            0     B[<identity ...>] + B[c]]
+[B[<identity ...>] + B[a*b*c]            B[a] + B[a*b*c*a]        B[a*b] + B[a*b*c*a*b]]
 ```
 
 Some properties of finitely presented groups. 
``````




---

archive/issue_comments_136482.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nAttachment: **[trac_12339_fpgroups.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz)**",
    "created_at": "2012-07-07T18:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136482",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:16" align="right">Comment 16</div>

Attachment: **[trac_12339_fpgroups.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz)**



---

archive/issue_comments_136483.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\napply trac_12339_fpgroups.patch",
    "created_at": "2012-07-10T10:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136483",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:17" align="right">Comment 17</div>

apply trac_12339_fpgroups.patch



---

archive/issue_comments_136484.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nSeveral comments:\n\n- I'm very excited that we can get this into Sage soon; I would like to use this for computing fundamental groups of simplicial complexes, among other things.\n\n- `FreeGroup(n)` should work if n is zero!\n\n- `FreeGroup(gens)` should allow gens to be much more general. For simplicial complexes, for instance, I would want to label the generators as edges in a graph. Take a look at CombinatorialFreeModule (in sage.combinat.free_module): you can have the generators be given by any family of mathematical objects (and not just strings for them, but the objects themselves). That sort of functionality would be very useful. Anyway, I'm imagining that gens could be a string of the current form, but also any iterable, or possibly something more general like the families that you can use in CombinatorialFreeModule.",
    "created_at": "2012-07-13T03:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136484",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">Comment 20</div>

Several comments:

- I'm very excited that we can get this into Sage soon; I would like to use this for computing fundamental groups of simplicial complexes, among other things.

- `FreeGroup(n)` should work if n is zero!

- `FreeGroup(gens)` should allow gens to be much more general. For simplicial complexes, for instance, I would want to label the generators as edges in a graph. Take a look at CombinatorialFreeModule (in sage.combinat.free_module): you can have the generators be given by any family of mathematical objects (and not just strings for them, but the objects themselves). That sort of functionality would be very useful. Anyway, I'm imagining that gens could be a string of the current form, but also any iterable, or possibly something more general like the families that you can use in CombinatorialFreeModule.



---

archive/issue_comments_136485.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nI have been thinking about how to rewrite the code to allow arbitrary objects as generators, but i don't see how to do it. My code is basically a wrapper around gap freegroups and finitely generated groups. So internally we have to stick to the gap structure. Maybe it could be possible to \"cheat\" by just creating a dictionary that relates the arbitrary generators and the string generators, in such a way that you can change the output.\n\nRight now i am in a conference, so i can't work on the code until next week. And even then, there are other things that have higher priority on my to-do list. But if someone wants to step up and make a patch with the feature you mentioned, that would be great.\n\nAnyways, i think that it would be better to have something simpler but that works fine for the moment, and once that is merged, start working on extending functionalty.",
    "created_at": "2012-07-17T07:21:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136485",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:21" align="right">Comment 21</div>

I have been thinking about how to rewrite the code to allow arbitrary objects as generators, but i don't see how to do it. My code is basically a wrapper around gap freegroups and finitely generated groups. So internally we have to stick to the gap structure. Maybe it could be possible to "cheat" by just creating a dictionary that relates the arbitrary generators and the string generators, in such a way that you can change the output.

Right now i am in a conference, so i can't work on the code until next week. And even then, there are other things that have higher priority on my to-do list. But if someone wants to step up and make a patch with the feature you mentioned, that would be great.

Anyways, i think that it would be better to have something simpler but that works fine for the moment, and once that is merged, start working on extending functionalty.



---

archive/issue_comments_136486.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nFirst of all, thanks for writing in this code, this is something that we totally need to get into Sage!\n\nI have been playing around with some finitely presented groups and found a few oddities\n\n```\nsage: G = FreeGroup(\"x,y\")\nsage: G.inject_variables()\nDefining x, y\nsage: H = G.quotient([x^5, y^4, y*x*y^3*x^3])\nsage: xx = H(x)\nsage: xx^5\nx^5\n```\nI expected that to show 1 or `Identity`. GAP also behaves strangely on this front. \nAt least equality seems to behave properly:\n\n```\nsage: xx^5 == H(1)\nTrue\n```\nHowever, it gets completely broken when going to the group ring, which is bad:\n\n```\nsage: R = GroupAlgebra(H)\nsage: R(xx)^5\nx^5\nsage: R(xx)^5 == R(1)\nFalse\nsage: R(xx^5) == R(1)\nFalse\n```\nFinally there are some constructions that I'd expect to work but don't, for instance `H` is an almost dihedral group of order 20, which can be computed in GAP but not in Sage:\n\n```\nsage: H.order()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n...\n```\nI haven't really read the code, but if you are wrapping the GAP code this can be sorted out by calling the `gap.Order()`method on the underlying gap object. Which, incidentally, also doesn't work:\n\n```\nsage: gap(H)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\n\nsage: H._gap_()\n---------------------------------------------------------------------------\nTypeError\n...\n```\nThis last part should be very easy to fix and would probably ease wrapping up other GAP functions.",
    "created_at": "2012-07-17T23:07:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136486",
    "user": "https://github.com/sagetrac-jlopez"
}
```

<div id="comment:22" align="right">Comment 22</div>

First of all, thanks for writing in this code, this is something that we totally need to get into Sage!

I have been playing around with some finitely presented groups and found a few oddities

```
sage: G = FreeGroup("x,y")
sage: G.inject_variables()
Defining x, y
sage: H = G.quotient([x^5, y^4, y*x*y^3*x^3])
sage: xx = H(x)
sage: xx^5
x^5
```
I expected that to show 1 or `Identity`. GAP also behaves strangely on this front. 
At least equality seems to behave properly:

```
sage: xx^5 == H(1)
True
```
However, it gets completely broken when going to the group ring, which is bad:

```
sage: R = GroupAlgebra(H)
sage: R(xx)^5
x^5
sage: R(xx)^5 == R(1)
False
sage: R(xx^5) == R(1)
False
```
Finally there are some constructions that I'd expect to work but don't, for instance `H` is an almost dihedral group of order 20, which can be computed in GAP but not in Sage:

```
sage: H.order()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
```
I haven't really read the code, but if you are wrapping the GAP code this can be sorted out by calling the `gap.Order()`method on the underlying gap object. Which, incidentally, also doesn't work:

```
sage: gap(H)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...

sage: H._gap_()
---------------------------------------------------------------------------
TypeError
...
```
This last part should be very easy to fix and would probably ease wrapping up other GAP functions.



---

archive/issue_comments_136487.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nGap doesn't try to reduce elements of finitely presented groups to normal form because, in general, it is an undecideable problem. The package kbmag has some algorithms to look for confluent rewriting systems and automatic structures, which would allow a normal form reduction in some cases. I have thought about including this in my code, but since it deppends on an external package (which is not even in the optional gap_packes spkg) i would prefear to tackle that in an external spkg that would include also kbmag.\n\nI don't know why comparison doesn't work in the group algebra. I should take a look at the group algebra code to see what is going on.\n\nTo compute the order of a group, use the .size method. You will either get an answer or exhaust the system memory, kill the internal gap session, and get a mess. You can even get an expression as symmetric group.\n\nIn your example:\n\n``` \nsage: G = FreeGroup(\"x,y\") \nsage: G.inject_variables() \nDefining x, y \nsage: H = G.quotient([x^5, y^4, y*x*y^3*x^3]) \nsage: H.size()\n20\nsage: H.permutation_group()\nPermutation Group with generators [(1,2,6,9,3)(4,12,10,7,13)(5,15,8,11,16)(14,18,20,19,17), (1,4,14,5)(2,7,17,8)(3,10,18,11)(6,12,19,16)(9,13,20,15)]\n```\n\nFinally, the method .gap() gives you the gap representation of the objects (that is, an object of the class sage.interfaces.gap.GapElement). So if you want to call some gap function foo on one of this objects, you just need to call something like H.gap().foo() .\n\nMaybe i should write a comprehensive documentation. That's another item on the to-do list.",
    "created_at": "2012-07-18T08:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136487",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:23" align="right">Comment 23</div>

Gap doesn't try to reduce elements of finitely presented groups to normal form because, in general, it is an undecideable problem. The package kbmag has some algorithms to look for confluent rewriting systems and automatic structures, which would allow a normal form reduction in some cases. I have thought about including this in my code, but since it deppends on an external package (which is not even in the optional gap_packes spkg) i would prefear to tackle that in an external spkg that would include also kbmag.

I don't know why comparison doesn't work in the group algebra. I should take a look at the group algebra code to see what is going on.

To compute the order of a group, use the .size method. You will either get an answer or exhaust the system memory, kill the internal gap session, and get a mess. You can even get an expression as symmetric group.

In your example:

``` 
sage: G = FreeGroup("x,y") 
sage: G.inject_variables() 
Defining x, y 
sage: H = G.quotient([x^5, y^4, y*x*y^3*x^3]) 
sage: H.size()
20
sage: H.permutation_group()
Permutation Group with generators [(1,2,6,9,3)(4,12,10,7,13)(5,15,8,11,16)(14,18,20,19,17), (1,4,14,5)(2,7,17,8)(3,10,18,11)(6,12,19,16)(9,13,20,15)]
```

Finally, the method .gap() gives you the gap representation of the objects (that is, an object of the class sage.interfaces.gap.GapElement). So if you want to call some gap function foo on one of this objects, you just need to call something like H.gap().foo() .

Maybe i should write a comprehensive documentation. That's another item on the to-do list.



---

archive/issue_comments_136488.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nI am aware of the problem of finding a normal form for elements. My (badly made) point is that it should be clearly documented as this is the kind of thing that would get a student easily confused. The group algebra comparison is a real problem, though.\n\nSomething that might be useful here would be to allow the user give some reduction rules. In my example, it is very clear that all the group elements can be written as `x<sup>ay</sup>b` for suitable `a` and `b`; in an ideal world, I could tell Sage to simplify my elements by repeatedly using the three rules\n1. \"Reduce powers of `x` modulo 5\"\n2. \"Reduce powers of `y` modulo 4\"\n3. \"Replace each `y<sup>ax</sup>b` by `x<sup>(2a+2b)y</sup>b`\"\nuntil none of them can be further applied. Mathematica excels at this type of operation (reduction by pattern matching). Perhaps the combinat guys have just the right tool for doing this, but anyway this is certainly a matter for a follow-up ticket once we have the basic functionality running.\n\nThe `.gap()` method didn't work for me with your patch, but maybe I didn't use it properly, I will try again when I get home.",
    "created_at": "2012-07-18T11:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136488",
    "user": "https://github.com/sagetrac-jlopez"
}
```

<div id="comment:24" align="right">Comment 24</div>

I am aware of the problem of finding a normal form for elements. My (badly made) point is that it should be clearly documented as this is the kind of thing that would get a student easily confused. The group algebra comparison is a real problem, though.

Something that might be useful here would be to allow the user give some reduction rules. In my example, it is very clear that all the group elements can be written as `x<sup>ay</sup>b` for suitable `a` and `b`; in an ideal world, I could tell Sage to simplify my elements by repeatedly using the three rules
1. "Reduce powers of `x` modulo 5"
2. "Reduce powers of `y` modulo 4"
3. "Replace each `y<sup>ax</sup>b` by `x<sup>(2a+2b)y</sup>b`"
until none of them can be further applied. Mathematica excels at this type of operation (reduction by pattern matching). Perhaps the combinat guys have just the right tool for doing this, but anyway this is certainly a matter for a follow-up ticket once we have the basic functionality running.

The `.gap()` method didn't work for me with your patch, but maybe I didn't use it properly, I will try again when I get home.



---

archive/issue_comments_136489.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nI would suggest replacing `size` with `cardinality`. That's more in line with other components of Sage. I would also suggest having a method which returns the codomain of `G.simplification_isomorphism()`; if I have generators and relations, I would like to see if there is a nice accessible simplification. Also, and this is probably related to one of my comments above:\n\n```\n    sage: G = FreeGroup('g')\n    sage: E = G.quotient((G.gen(0),))\n    sage: E.simplification_isomorphism()\n```\ndoesn't work, complaining that `ValueError: variable name must be nonempty`.\n\nThe .gap method seems to work okay, although I haven't tested it very thoroughly. From looking at other files in sage/groups/, it looks like you should instead implement both `G._gap_()` (to return the GAP object corresponding to G) and `G._gap_init_()` (to return the string representation of the corresponding GAP object). But I'm not sure about this: maybe you only need one of these methods. Anyway, if you do it right, then `gap(G)` will return the GAP version of G.\n\nOverall, your code should be consistent with the other groups available in Sage, both in terms of public methods (for example, using `cardinality` instead of `size`) and private ones (`_gap_`, `_gap_init_`, etc.)",
    "created_at": "2012-07-27T23:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136489",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">Comment 26</div>

I would suggest replacing `size` with `cardinality`. That's more in line with other components of Sage. I would also suggest having a method which returns the codomain of `G.simplification_isomorphism()`; if I have generators and relations, I would like to see if there is a nice accessible simplification. Also, and this is probably related to one of my comments above:

```
    sage: G = FreeGroup('g')
    sage: E = G.quotient((G.gen(0),))
    sage: E.simplification_isomorphism()
```
doesn't work, complaining that `ValueError: variable name must be nonempty`.

The .gap method seems to work okay, although I haven't tested it very thoroughly. From looking at other files in sage/groups/, it looks like you should instead implement both `G._gap_()` (to return the GAP object corresponding to G) and `G._gap_init_()` (to return the string representation of the corresponding GAP object). But I'm not sure about this: maybe you only need one of these methods. Anyway, if you do it right, then `gap(G)` will return the GAP version of G.

Overall, your code should be consistent with the other groups available in Sage, both in terms of public methods (for example, using `cardinality` instead of `size`) and private ones (`_gap_`, `_gap_init_`, etc.)



---

archive/issue_comments_136490.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@jhpalmieri](#comment%3A26):\n> I would suggest replacing `size` with `cardinality`. \n\nCan we have `order` as an alias for `cardinality()` in the case of groups?  It seems totally foreign to **not** have it.\n\n> The .gap method seems to work okay, although I haven't tested it very thoroughly. From looking at other files in sage/groups/, it looks like you should instead implement both `G._gap_()` (to return the GAP object corresponding to G) and `G._gap_init_()` (to return the string representation of the corresponding GAP object). But I'm not sure about this: maybe you only need one of these methods. Anyway, if you do it right, then `gap(G)` will return the GAP version of G.\n\nI've only just figured out some of this in the last 48 hours as I have been building an automorphism group of permutation groups.  I think that if `_gap_init_()` returns a string which would cause GAP to create the desired object, then everything else, like `_gap_()` for sure, and I'd guess `gap()` as well, just seems to come along for the ride.  `gap.eval(<command>)` outputs strings you can save/manipulate to use as return values for `_gap_init_()`.",
    "created_at": "2012-07-28T02:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136490",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@jhpalmieri](#comment%3A26):
> I would suggest replacing `size` with `cardinality`. 

Can we have `order` as an alias for `cardinality()` in the case of groups?  It seems totally foreign to **not** have it.

> The .gap method seems to work okay, although I haven't tested it very thoroughly. From looking at other files in sage/groups/, it looks like you should instead implement both `G._gap_()` (to return the GAP object corresponding to G) and `G._gap_init_()` (to return the string representation of the corresponding GAP object). But I'm not sure about this: maybe you only need one of these methods. Anyway, if you do it right, then `gap(G)` will return the GAP version of G.

I've only just figured out some of this in the last 48 hours as I have been building an automorphism group of permutation groups.  I think that if `_gap_init_()` returns a string which would cause GAP to create the desired object, then everything else, like `_gap_()` for sure, and I'd guess `gap()` as well, just seems to come along for the ride.  `gap.eval(<command>)` outputs strings you can save/manipulate to use as return values for `_gap_init_()`.



---

archive/issue_comments_136491.json:
```json
{
    "body": "Attachment: **[trac_12339_fpgroups.2.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.2.patch.gz)**\n\nApply over 12339_fpgroups.patch",
    "created_at": "2012-07-28T13:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136491",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[trac_12339_fpgroups.2.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.2.patch.gz)**

Apply over 12339_fpgroups.patch



---

archive/issue_comments_136492.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nI have added the `_gap_` and the `_gap_init_` methods for free groups, but still gap(self) does not work its magic. I couldn't find an acceptable way for FinitelyPresentedGroup._gap_init_ since gap requires to create first the free group (and give it a name) in order to create a FPGroup.\n\n\nSolved the problem with free groups of rank 0.\n\nAdded cardinality and order as aliases for size.\n\nAdded FinitelyPresentedGroup.simplify_presentation that returns the codomain of simplification_isomorphisms.\n\nIt is all implemented in a new patch that should be aplyed over the previous one.",
    "created_at": "2012-07-28T14:01:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136492",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:28" align="right">Comment 28</div>

I have added the `_gap_` and the `_gap_init_` methods for free groups, but still gap(self) does not work its magic. I couldn't find an acceptable way for FinitelyPresentedGroup._gap_init_ since gap requires to create first the free group (and give it a name) in order to create a FPGroup.


Solved the problem with free groups of rank 0.

Added cardinality and order as aliases for size.

Added FinitelyPresentedGroup.simplify_presentation that returns the codomain of simplification_isomorphisms.

It is all implemented in a new patch that should be aplyed over the previous one.



---

archive/issue_comments_136493.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\napply trac_12339_fpgroups.patch  trac_12339_fpgroups.2.patch",
    "created_at": "2012-07-28T17:21:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136493",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:29" align="right">Comment 29</div>

apply trac_12339_fpgroups.patch  trac_12339_fpgroups.2.patch



---

archive/issue_comments_136494.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nCan you please make simple speed benchmarks in different systems? I have observed a big speed difference from my gentoo box to a mandriva system (where sage runs in a ubuntu chroot). I suspect it has to do with the sage-gap communication (maybe something with the way shm or pts work?)\n\n\nHere are my benchmarks:\n\nIn my gentoo box (intel core i7, 6GB RAM)\n\n```\nsage: time F=FreeGroup(4)\nTime: CPU 0.00 s, Wall: 0.00 s\nsage: time F.inject_variables()\nDefining x0, x1, x2, x3\nTime: CPU 0.03 s, Wall: 0.04 s\nsage: time x=F([1,2,3,4,1,2,3,4])\nTime: CPU 0.01 s, Wall: 0.01 s\nsage: time x^2\nx0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3\nTime: CPU 0.07 s, Wall: 0.08 s\n```\n\nIn the mandriva-chroot-ubuntu (two AMD-opteron 6100, 16 cores in total, 128 GB RAM):\n\n```\nsage: time F=FreeGroup(4)\nTime: CPU 0.03 s, Wall: 0.50 s\nsage: time F.inject_variables()\nDefining x0, x1, x2, x3\nTime: CPU 0.04 s, Wall: 2.32 s\nsage: time x=F([1,2,3,4,1,2,3,4])\nTime: CPU 0.02 s, Wall: 0.86 s\nsage: time x^2\nx0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3\nTime: CPU 0.10 s, Wall: 5.34 s\n```\n\nIt really makes no sense such a slowdown. Any ideas?",
    "created_at": "2012-07-28T19:52:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136494",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:30" align="right">Comment 30</div>

Can you please make simple speed benchmarks in different systems? I have observed a big speed difference from my gentoo box to a mandriva system (where sage runs in a ubuntu chroot). I suspect it has to do with the sage-gap communication (maybe something with the way shm or pts work?)


Here are my benchmarks:

In my gentoo box (intel core i7, 6GB RAM)

```
sage: time F=FreeGroup(4)
Time: CPU 0.00 s, Wall: 0.00 s
sage: time F.inject_variables()
Defining x0, x1, x2, x3
Time: CPU 0.03 s, Wall: 0.04 s
sage: time x=F([1,2,3,4,1,2,3,4])
Time: CPU 0.01 s, Wall: 0.01 s
sage: time x^2
x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3
Time: CPU 0.07 s, Wall: 0.08 s
```

In the mandriva-chroot-ubuntu (two AMD-opteron 6100, 16 cores in total, 128 GB RAM):

```
sage: time F=FreeGroup(4)
Time: CPU 0.03 s, Wall: 0.50 s
sage: time F.inject_variables()
Defining x0, x1, x2, x3
Time: CPU 0.04 s, Wall: 2.32 s
sage: time x=F([1,2,3,4,1,2,3,4])
Time: CPU 0.02 s, Wall: 0.86 s
sage: time x^2
x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3
Time: CPU 0.10 s, Wall: 5.34 s
```

It really makes no sense such a slowdown. Any ideas?



---

archive/issue_comments_136495.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nReplying to [@miguelmarco](#comment%3A30):\n> It really makes no sense such a slowdown. Any ideas?\n\nThere was a definite problem with Sage-GAP communication in Ubuntu.  It was Ubuntu's fault if I recall correctly.  Do you have a recent Ubuntu?  I first noticed this about a year ago, and it seems to be better (fixed?) now (with 12.04).  \n\nHere's one indicator (I didn't look very hard for the root explanation):\n\nhttps://groups.google.com/d/msg/sage-release/vLGiLlGXH-U/X4qsKwTK57kJ\n\nTry doctesting the sandpile.py module, it takes forever in the presence of this problem.\n\nRob",
    "created_at": "2012-07-28T20:46:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136495",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:31" align="right">Comment 31</div>

Replying to [@miguelmarco](#comment%3A30):
> It really makes no sense such a slowdown. Any ideas?

There was a definite problem with Sage-GAP communication in Ubuntu.  It was Ubuntu's fault if I recall correctly.  Do you have a recent Ubuntu?  I first noticed this about a year ago, and it seems to be better (fixed?) now (with 12.04).  

Here's one indicator (I didn't look very hard for the root explanation):

https://groups.google.com/d/msg/sage-release/vLGiLlGXH-U/X4qsKwTK57kJ

Try doctesting the sandpile.py module, it takes forever in the presence of this problem.

Rob



---

archive/issue_comments_136496.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nThe ubuntu chroot is 12.04. Also, i have similar slowdowns in previous versions of sage under mandriva (i couldn't compile the last versions because of the bug in the time command).\n\nTesting sandpile takes forever indeed.\n\nIn the link you gave Dima says that the kernel is to blame.\n\nCan you test it in different systems?",
    "created_at": "2012-07-28T21:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136496",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:32" align="right">Comment 32</div>

The ubuntu chroot is 12.04. Also, i have similar slowdowns in previous versions of sage under mandriva (i couldn't compile the last versions because of the bug in the time command).

Testing sandpile takes forever indeed.

In the link you gave Dima says that the kernel is to blame.

Can you test it in different systems?



---

archive/issue_comments_136497.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@miguelmarco](#comment%3A32):\n> Can you test it in different systems?\n\nAny machine with I have with Sage is Ubuntu 12.04.  That won't help, will it?",
    "created_at": "2012-07-30T00:55:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136497",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@miguelmarco](#comment%3A32):
> Can you test it in different systems?

Any machine with I have with Sage is Ubuntu 12.04.  That won't help, will it?



---

archive/issue_comments_136498.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nWell, at least it would help to know that ubuntu 12.04 is not affected.",
    "created_at": "2012-07-30T08:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136498",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:34" align="right">Comment 34</div>

Well, at least it would help to know that ubuntu 12.04 is not affected.



---

archive/issue_comments_136499.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nOn OS X 10.7:\n\n```\nsage: time F=FreeGroup(4)\nTime: CPU 0.00 s, Wall: 0.00 s\nsage: time F.inject_variables()\nDefining x0, x1, x2, x3\nTime: CPU 0.04 s, Wall: 0.06 s\nsage: time x=F([1,2,3,4,1,2,3,4])\nTime: CPU 0.01 s, Wall: 0.02 s\nsage: time x^2\nx0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3\nTime: CPU 0.09 s, Wall: 0.09 s\n```\nWall time is completely reasonable.",
    "created_at": "2012-07-30T21:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136499",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">Comment 35</div>

On OS X 10.7:

```
sage: time F=FreeGroup(4)
Time: CPU 0.00 s, Wall: 0.00 s
sage: time F.inject_variables()
Defining x0, x1, x2, x3
Time: CPU 0.04 s, Wall: 0.06 s
sage: time x=F([1,2,3,4,1,2,3,4])
Time: CPU 0.01 s, Wall: 0.02 s
sage: time x^2
x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3
Time: CPU 0.09 s, Wall: 0.09 s
```
Wall time is completely reasonable.



---

archive/issue_comments_136500.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nOn 64-bit Ubuntu 12.05, Sage 5.1.rc1, hardware is a 4-core Intel about 18 months old.\n\nSeems similar to what John is seeing (roughly).\n\n```\nsage: time F=FreeGroup(4)  \nTime: CPU 0.02 s, Wall: 0.08 s\nsage: time F.inject_variables()  \nDefining x0, x1, x2, x3\nTime: CPU 0.03 s, Wall: 0.04 s\nsage: time x=F([1,2,3,4,1,2,3,4])\nTime: CPU 0.02 s, Wall: 0.02 s\nsage: sage: time x^2             \nx0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3\nTime: CPU 0.06 s, Wall: 0.08 s\n```",
    "created_at": "2012-07-31T01:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136500",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:36" align="right">Comment 36</div>

On 64-bit Ubuntu 12.05, Sage 5.1.rc1, hardware is a 4-core Intel about 18 months old.

Seems similar to what John is seeing (roughly).

```
sage: time F=FreeGroup(4)  
Time: CPU 0.02 s, Wall: 0.08 s
sage: time F.inject_variables()  
Defining x0, x1, x2, x3
Time: CPU 0.03 s, Wall: 0.04 s
sage: time x=F([1,2,3,4,1,2,3,4])
Time: CPU 0.02 s, Wall: 0.02 s
sage: sage: time x^2             
x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3*x0*x1*x2*x3
Time: CPU 0.06 s, Wall: 0.08 s
```



---

archive/issue_comments_136501.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nThanks, so it seems that the issue is specific on some older kernels.",
    "created_at": "2012-07-31T08:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136501",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:37" align="right">Comment 37</div>

Thanks, so it seems that the issue is specific on some older kernels.



---

archive/issue_comments_136502.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -118,3 +118,8 @@\n ```\n \n Also b.plot() and b.plot3d() would plot the braid.\n+\n+\n+There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n+\n+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_libgap.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)\n``````\n",
    "created_at": "2012-09-27T18:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136502",
    "user": "https://github.com/miguelmarco"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -118,3 +118,8 @@
 ```
 
 Also b.plot() and b.plot3d() would plot the braid.
+
+
+There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
+
+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_libgap.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)
``````




---

archive/issue_comments_136503.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nLooks great! Some libgap notes:\n* libgap makes sure to lazy import itself, since gap startup takes some time. Hence `sage/libs/all.py` defines\n\n    ```\n    from sage.misc.lazy_import import lazy_import\n    lazy_import('sage.libs.gap.libgap', 'libgap')\n  ```\n  You should either follow the same pattern and lazily import your own code from `sage/groups/all.py`. This will help Sage in the long run to avoid long startup times. Also, its better to import libgap as `from sage.libs.all import libgap`, then you get the lazy importer.\n\nThere are a couple of code style and documentation issues:\n* Always put an empty line before function/method declarations (that is, before \"def ...\")\n* Space after comma: `def __init__(self, ll=[], parent=None)` instead of `def __init__(self,ll=[],parent=None)`\n* Use\n\n    ```\n    EXAMPLES::\n       \n        sage: 1+1\n  ```\n  instead of the multi-line \n\n    ```\n    EXAMPLES: \n\n    :: \n\n        sage: 1+1\t\n  ```\n* Its encouraged to generate intermediate variables instead of very long lines:\n\n    ```\n    self._gap_repr_=parent.gap().One().FamilyObj().ElementOfFpGroup(libgap.eval(str(l)).AbstractWordTietzeWord(parent.gap().FreeGroupOfFpGroup().GeneratorsOfGroup())) \n  ```\n  would be more legible as\n\n    ```\n    gap = parent.gap()\n    gens = gap.FreeGroupOfFpGroup().GeneratorsOfGroup()\n    element = gap.One().FamilyObj().ElementOfFpGroup(libgap.eval(str(l))\n    self._gap_rep = element.AbstractTietzeWord(gens)\n  ```\n* Module-level documentation for the new files, and add them to the reference manual index  (that is, to `doc/en/reference/groups.rst`) so the documentation is actually built.\n* Input parameters need to be documented consistently. That is, consistently use `INPUT:` and `OUTPUT:` sections in the docstrings. You know what the methods are for, but we don't ;-)",
    "created_at": "2012-10-09T11:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136503",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">Comment 39</div>

Looks great! Some libgap notes:
* libgap makes sure to lazy import itself, since gap startup takes some time. Hence `sage/libs/all.py` defines

    ```
    from sage.misc.lazy_import import lazy_import
    lazy_import('sage.libs.gap.libgap', 'libgap')
  ```
  You should either follow the same pattern and lazily import your own code from `sage/groups/all.py`. This will help Sage in the long run to avoid long startup times. Also, its better to import libgap as `from sage.libs.all import libgap`, then you get the lazy importer.

There are a couple of code style and documentation issues:
* Always put an empty line before function/method declarations (that is, before "def ...")
* Space after comma: `def __init__(self, ll=[], parent=None)` instead of `def __init__(self,ll=[],parent=None)`
* Use

    ```
    EXAMPLES::
       
        sage: 1+1
  ```
  instead of the multi-line 

    ```
    EXAMPLES: 

    :: 

        sage: 1+1	
  ```
* Its encouraged to generate intermediate variables instead of very long lines:

    ```
    self._gap_repr_=parent.gap().One().FamilyObj().ElementOfFpGroup(libgap.eval(str(l)).AbstractWordTietzeWord(parent.gap().FreeGroupOfFpGroup().GeneratorsOfGroup())) 
  ```
  would be more legible as

    ```
    gap = parent.gap()
    gens = gap.FreeGroupOfFpGroup().GeneratorsOfGroup()
    element = gap.One().FamilyObj().ElementOfFpGroup(libgap.eval(str(l))
    self._gap_rep = element.AbstractTietzeWord(gens)
  ```
* Module-level documentation for the new files, and add them to the reference manual index  (that is, to `doc/en/reference/groups.rst`) so the documentation is actually built.
* Input parameters need to be documented consistently. That is, consistently use `INPUT:` and `OUTPUT:` sections in the docstrings. You know what the methods are for, but we don't ;-)



---

archive/issue_events_153807.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-09T11:20:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153807"
}
```



---

archive/issue_events_153808.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-09T11:20:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153808"
}
```



---

archive/issue_comments_136504.json:
```json
{
    "body": "Dependencies: **#6391**",
    "created_at": "2012-10-09T11:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136504",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#6391**



---

archive/issue_events_153809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-09T11:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153809"
}
```



---

archive/issue_comments_136505.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2012-10-09T11:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136505",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_136506.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nI have addressed the issues. Please review it.",
    "created_at": "2012-10-14T10:23:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136506",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:41" align="right">Comment 41</div>

I have addressed the issues. Please review it.



---

archive/issue_comments_136507.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\napply trac_12339_fpgroups_libgap.patch",
    "created_at": "2012-10-14T10:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136507",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:42" align="right">Comment 42</div>

apply trac_12339_fpgroups_libgap.patch



---

archive/issue_comments_136508.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nThis is a really nice contribution!\n\n`ParentWithGens` is deprecated, see the beginning of `sage/structure/parent_gens.pyx`. You should use `Parents.__init__(self, gens=..., category=Groups())` or so. I know thats not as well-documented as it should be. You do already import `Groups` but don't use it. Did you have any problems with the new parents?\n\nFor comparison you should override `_cmp_` in elements, otherwise you circumvent the coercion system. \n\nAnother minor issue, don't use catch-all `except:`. You almost certainly don't want to catch `KeyboardInterrupt`, for example. Use `except StandardError:` to catch all *errors*.\n\nSince there isn't any example yet for how to use libGAP, I though it would be nice to use the finitely generated groups to demonstrate what it can be used for. Do you have any other patches that you have already based on this ticket? Otherwise I'd like to make some changes to use libgap better.",
    "created_at": "2012-10-27T17:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136508",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:43" align="right">Comment 43</div>

This is a really nice contribution!

`ParentWithGens` is deprecated, see the beginning of `sage/structure/parent_gens.pyx`. You should use `Parents.__init__(self, gens=..., category=Groups())` or so. I know thats not as well-documented as it should be. You do already import `Groups` but don't use it. Did you have any problems with the new parents?

For comparison you should override `_cmp_` in elements, otherwise you circumvent the coercion system. 

Another minor issue, don't use catch-all `except:`. You almost certainly don't want to catch `KeyboardInterrupt`, for example. Use `except StandardError:` to catch all *errors*.

Since there isn't any example yet for how to use libGAP, I though it would be nice to use the finitely generated groups to demonstrate what it can be used for. Do you have any other patches that you have already based on this ticket? Otherwise I'd like to make some changes to use libgap better.



---

archive/issue_comments_136509.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nOk, i will try to wee if swtiching from parentwithgens to parents is not too painful.\n I remember i tried different ways of inheritingt, and finally decided this one, but i don't remember exactly why.\n\nWhat do you mean exactly by overrode _cmp_? isn't that what i do already?\n\nI have no ither patches that deppend on this, but i was just planning to start with something to give support to the kbmag gap package, which would allow to deal with reduced forms of the elements of finitely presented groups (when Knuth-Bendix or the search for automatic structure succeeds).",
    "created_at": "2012-10-27T19:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136509",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:44" align="right">Comment 44</div>

Ok, i will try to wee if swtiching from parentwithgens to parents is not too painful.
 I remember i tried different ways of inheritingt, and finally decided this one, but i don't remember exactly why.

What do you mean exactly by overrode _cmp_? isn't that what i do already?

I have no ither patches that deppend on this, but i was just planning to start with something to give support to the kbmag gap package, which would allow to deal with reduced forms of the elements of finitely presented groups (when Knuth-Bendix or the search for automatic structure succeeds).



---

archive/issue_comments_136510.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nI see the problem now: Group inherits from ParentWithGens. Should i not inherit from Group then?",
    "created_at": "2012-10-27T19:49:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136510",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:45" align="right">Comment 45</div>

I see the problem now: Group inherits from ParentWithGens. Should i not inherit from Group then?



---

archive/issue_comments_136511.json:
```json
{
    "body": "minor changes to the previous version. Should be applied over the previous one.",
    "created_at": "2012-10-27T20:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136511",
    "user": "https://github.com/miguelmarco"
}
```

minor changes to the previous version. Should be applied over the previous one.



---

archive/issue_comments_136512.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nAttachment: **[trac_12339_fpgroups_libgap_minor_changes.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap_minor_changes.patch.gz)**\n\nI think i have addressed the issues you commented. Made a small patch with the changes. Please check it up and tell me what you think.\n\nOn a side question: do you have any clue about why the testsuite for braid groups fails?\n\nOh, and by the way, feel more than welcome to make any improvements that you consider.",
    "created_at": "2012-10-27T20:47:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136512",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:46" align="right">Comment 46</div>

Attachment: **[trac_12339_fpgroups_libgap_minor_changes.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap_minor_changes.patch.gz)**

I think i have addressed the issues you commented. Made a small patch with the changes. Please check it up and tell me what you think.

On a side question: do you have any clue about why the testsuite for braid groups fails?

Oh, and by the way, feel more than welcome to make any improvements that you consider.



---

archive/issue_comments_136513.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nThe `Element` class has a `__cmp__` method, you are still overriding it. You should only provide a `_cmp_`. The parent `__cmp__` will then call `_cmp_`, possibly after coercing arguments.\n\nI guess one should change Group to derive from Parent, though that might be a bigger effort. I'll send an email to sage-devel to gauge interest ;-)",
    "created_at": "2012-10-27T20:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136513",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:47" align="right">Comment 47</div>

The `Element` class has a `__cmp__` method, you are still overriding it. You should only provide a `_cmp_`. The parent `__cmp__` will then call `_cmp_`, possibly after coercing arguments.

I guess one should change Group to derive from Parent, though that might be a bigger effort. I'll send an email to sage-devel to gauge interest ;-)



---

archive/issue_comments_136514.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nHm, i am now forgeting about the `__cmp__` method, and just implementing comparison through `_cmp_` ... but that makes comparison by equality not working.\n\nI get something like this:\n\n```\nsage: F=FreeGroup('a,b,c')\nsage: F.inject_variables()\nDefining a, b, c\nsage: a._cmp_(a*b/b)\n0\nsage: cmp(a,a*b/b)\n0\nsage: a.__cmp__(a*b/b)\n0\n```\n\nbut \n\n```\nsage: a==a*b/b\nFalse\n```\n\nThat didn't happen in the previous version.",
    "created_at": "2012-10-27T21:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136514",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:48" align="right">Comment 48</div>

Hm, i am now forgeting about the `__cmp__` method, and just implementing comparison through `_cmp_` ... but that makes comparison by equality not working.

I get something like this:

```
sage: F=FreeGroup('a,b,c')
sage: F.inject_variables()
Defining a, b, c
sage: a._cmp_(a*b/b)
0
sage: cmp(a,a*b/b)
0
sage: a.__cmp__(a*b/b)
0
```

but 

```
sage: a==a*b/b
False
```

That didn't happen in the previous version.



---

archive/issue_comments_136515.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nSomething is wrong with trac_12339_fpgroups_libgap.patch, it seems like two concatenated patches. Patch creates `sage/groups/braid.py` twice, for example.\n\nGetting `cmp` and/or `richcmp` right is usually tricky. The best reference is reading `sage/structure/element.pyx`, I'm afraid. I can give it a whirl if you fix the original patch ;-)",
    "created_at": "2012-10-31T18:07:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136515",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:49" align="right">Comment 49</div>

Something is wrong with trac_12339_fpgroups_libgap.patch, it seems like two concatenated patches. Patch creates `sage/groups/braid.py` twice, for example.

Getting `cmp` and/or `richcmp` right is usually tricky. The best reference is reading `sage/structure/element.pyx`, I'm afraid. I can give it a whirl if you fix the original patch ;-)



---

archive/issue_comments_136516.json:
```json
{
    "body": "Changed dependencies from **#6391** to **#6391, #13687**",
    "created_at": "2012-11-06T01:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136516",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#6391** to **#6391, #13687**



---

archive/issue_events_153810.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-06T01:11:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153810"
}
```



---

archive/issue_events_153811.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-06T01:11:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153811"
}
```



---

archive/issue_comments_136517.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nCan you rebase it the patch on top of #13687? Also, the current patch is corrupted.\n\nFor elements implemented in Python you are supposed to override `__cmp__`, I think. So ignore my previous comment on that.",
    "created_at": "2012-11-06T01:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136517",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">Comment 50</div>

Can you rebase it the patch on top of #13687? Also, the current patch is corrupted.

For elements implemented in Python you are supposed to override `__cmp__`, I think. So ignore my previous comment on that.



---

archive/issue_comments_136518.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nOk, i have submited a rebased version of the patch, with the `__cmp__` methods overriden.\n\nNow the classes inherit from Parent, but not from Group, so a few generic methods for groups are lost (very few in fact). It shouldn't be hard to get back to Group when it derives from Parent.",
    "created_at": "2012-11-06T09:13:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136518",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:51" align="right">Comment 51</div>

Ok, i have submited a rebased version of the patch, with the `__cmp__` methods overriden.

Now the classes inherit from Parent, but not from Group, so a few generic methods for groups are lost (very few in fact). It shouldn't be hard to get back to Group when it derives from Parent.



---

archive/issue_comments_136519.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nSorry if I wasn't clear, #13687 bases `sage.groups.group.Group` on `Parent`. So you should just derive from `Group`.",
    "created_at": "2012-11-06T17:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136519",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">Comment 52</div>

Sorry if I wasn't clear, #13687 bases `sage.groups.group.Group` on `Parent`. So you should just derive from `Group`.



---

archive/issue_comments_136520.json:
```json
{
    "body": "Attachment: **[trac_12339_fpgroups_libgap.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)**\n\nRebased version",
    "created_at": "2012-11-06T18:23:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136520",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[trac_12339_fpgroups_libgap.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)**

Rebased version



---

archive/issue_comments_136521.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nOk, thanks for the work. It is all fixed now.\n\nAlthough this tocket is starting to depend on so many others (gap update, libgap, parent...) that i just fear it will never get merged ;)\n\nI have some new features and improvements in mind, but i think it is better to get this stabilized and merged first, and then start working in improving it.",
    "created_at": "2012-11-06T18:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136521",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:53" align="right">Comment 53</div>

Ok, thanks for the work. It is all fixed now.

Although this tocket is starting to depend on so many others (gap update, libgap, parent...) that i just fear it will never get merged ;)

I have some new features and improvements in mind, but i think it is better to get this stabilized and merged first, and then start working in improving it.



---

archive/issue_comments_136522.json:
```json
{
    "body": "Changed keywords from **free groups** to **free groups, finitely presented groups, braids**",
    "created_at": "2012-11-16T00:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136522",
    "user": "https://github.com/vbraun"
}
```

Changed keywords from **free groups** to **free groups, finitely presented groups, braids**



---

archive/issue_comments_136523.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,85 +7,78 @@\n Basic arithmetic in Free and Finitely presented groups:\n \n ```\n-sage: G=FreeGroup('a,b,c,d,e')\n-sage: G.inject_variables()\n-Defining a, b, c, d, e\n+sage: G.<a,b,c,d,e> = FreeGroup()\n sage: a*b*c*d/a/a/e\n a*b*c*d*a^-2*e^-1\n-sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e])\n+sage: H = G / [a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e]\n sage: H.gens()\n (a, b, c, d, e)\n-sage: H([1,2,3])/H([3,2,1])\n+sage: H([1,2,3]) / H([3,2,1])\n a*b*c*a^-1*b^-1*c^-1\n ```\n \n Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):\n \n ```\n-sage: G=FreeGroup('a,b,c')    \n-sage: G.inject_variables()\n-Defining a, b, c\n+sage: G<a,b,c> = FreeGroup()    \n sage: a*b*c/a/a/c  \n a*b*c*a^-2*c^-1\n-sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              \n+sage: H = G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              \n sage: H.gens()\n (a, b, c)\n sage: H([1,2,3])/H([3,2,1])\n a*b*c*a^-1*b^-1*c^-1\n sage: (a*b*a/b/a).fox_derivative(a)\n-B[<identity ...>] + B[a*b] - B[a*b*a*b^-1*a^-1]\n+B[1] + B[a*b] - B[a*b*a*b^-1*a^-1]\n sage: H.alexander_matrix()\n-[  B[<identity ...>] + B[a*b]              B[a] + B[a*b*a]                            0]\n-[    B[<identity ...>] + B[a]                            0                            0]\n-[                           0     B[<identity ...>] + B[b]                            0]\n-[                           0                            0     B[<identity ...>] + B[c]]\n-[B[<identity ...>] + B[a*b*c]            B[a] + B[a*b*c*a]        B[a*b] + B[a*b*c*a*b]]\n+[                           B[1] + B[x0]                                       0                                       0]\n+[                                      0                            B[1] + B[x1]                                       0]\n+[                                      0                                       0                  B[1] + B[x2] + B[x2^2]]\n+[                        B[1] + B[x0*x1]                     B[x0] + B[x0*x1*x0]                                       0]\n+[                        B[1] + B[x0*x2]                                       0                     B[x0] + B[x0*x2*x0]]\n+[                                      0        B[1] + B[x1*x2] + B[x1*x2*x1*x2] B[x1] + B[x1*x2*x1] + B[x1*x2*x1*x2*x1]]\n ```\n \n Some properties of finitely presented groups. \n \n ```\n-sage: G=FreeGroup(3)          \n+sage: G = FreeGroup(3)          \n sage: G.inject_variables()\n Defining x0, x1, x2\n-sage: H=G.quotient([x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2])\n+sage: H = G / [x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2]\n sage: H.simplification_isomorphism()\n Generic morphism:\n-  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')\n- and relations (x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2)\n-  To:   Finitely Presented Group on generators ('x1', 'x2')\n- and relations (x2^2, x1*x2*x1*x2)\n+  From: Finitely presented group < x0, x1, x2 | x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2 >\n+  To:   Finitely presented group < x1, x2 | x2^2, x1*x2*x1*x2 >\n sage: H.abelian_invariants()\n-[2, 2]\n+(2, 2)\n sage: H.simplification_isomorphism()(x0)\n-<identity ...>\n+1\n sage: H.simplification_isomorphism()(x1)\n x1\n sage: H.simplification_isomorphism()(x2)\n x2\n sage: H.abelian_invariants()\n-[2, 2]\n+(2, 2)\n ```\n \n Caution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.\n \n \n ```\n-sage: G=FreeGroup(3)\n+sage: G = FreeGroup(3)\n sage: G.inject_variables()\n Defining x0, x1, x2\n-sage: H=G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])\n+sage: H = G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])\n sage: H.abelian_invariants()\n-[2]\n+(2,)\n sage: H.simplification_isomorphism()\n Generic morphism:\n-  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')\n- and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)\n-  To:   Finitely Presented Group on generators ('x0', 'x1', 'x2')\n- and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)\n-sage: H.size()\n+  From: Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >\n+  To:   Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >\n+sage: H.cardinality()\n 24\n-sage: H.permutation_group()\n+sage: H.as_permutation_group()\n Permutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]\n ```\n \n@@ -122,4 +115,4 @@\n \n There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n \n-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_libgap.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)\n+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n``````\n",
    "created_at": "2012-11-16T00:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136523",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,85 +7,78 @@
 Basic arithmetic in Free and Finitely presented groups:
 
 ```
-sage: G=FreeGroup('a,b,c,d,e')
-sage: G.inject_variables()
-Defining a, b, c, d, e
+sage: G.<a,b,c,d,e> = FreeGroup()
 sage: a*b*c*d/a/a/e
 a*b*c*d*a^-2*e^-1
-sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e])
+sage: H = G / [a*b*a*b,a^2,b^2,c^2,d^2,e^2,a*b*c*d*e*a*b,c*d*e*c*d*e,d*e*d*e]
 sage: H.gens()
 (a, b, c, d, e)
-sage: H([1,2,3])/H([3,2,1])
+sage: H([1,2,3]) / H([3,2,1])
 a*b*c*a^-1*b^-1*c^-1
 ```
 
 Fox derivatives of free group elements, and Alexander matrices of finitely presented groups (the result is given on the group algebra):
 
 ```
-sage: G=FreeGroup('a,b,c')    
-sage: G.inject_variables()
-Defining a, b, c
+sage: G<a,b,c> = FreeGroup()    
 sage: a*b*c/a/a/c  
 a*b*c*a^-2*c^-1
-sage: H=G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              
+sage: H = G.quotient([a*b*a*b,a^2,b^2,c^2,a*b*c*a*b*c])                              
 sage: H.gens()
 (a, b, c)
 sage: H([1,2,3])/H([3,2,1])
 a*b*c*a^-1*b^-1*c^-1
 sage: (a*b*a/b/a).fox_derivative(a)
-B[<identity ...>] + B[a*b] - B[a*b*a*b^-1*a^-1]
+B[1] + B[a*b] - B[a*b*a*b^-1*a^-1]
 sage: H.alexander_matrix()
-[  B[<identity ...>] + B[a*b]              B[a] + B[a*b*a]                            0]
-[    B[<identity ...>] + B[a]                            0                            0]
-[                           0     B[<identity ...>] + B[b]                            0]
-[                           0                            0     B[<identity ...>] + B[c]]
-[B[<identity ...>] + B[a*b*c]            B[a] + B[a*b*c*a]        B[a*b] + B[a*b*c*a*b]]
+[                           B[1] + B[x0]                                       0                                       0]
+[                                      0                            B[1] + B[x1]                                       0]
+[                                      0                                       0                  B[1] + B[x2] + B[x2^2]]
+[                        B[1] + B[x0*x1]                     B[x0] + B[x0*x1*x0]                                       0]
+[                        B[1] + B[x0*x2]                                       0                     B[x0] + B[x0*x2*x0]]
+[                                      0        B[1] + B[x1*x2] + B[x1*x2*x1*x2] B[x1] + B[x1*x2*x1] + B[x1*x2*x1*x2*x1]]
 ```
 
 Some properties of finitely presented groups. 
 
 ```
-sage: G=FreeGroup(3)          
+sage: G = FreeGroup(3)          
 sage: G.inject_variables()
 Defining x0, x1, x2
-sage: H=G.quotient([x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2])
+sage: H = G / [x0*x1*x2*x0*x1*x2,x1*x2*x0*x1*x2,x2^2]
 sage: H.simplification_isomorphism()
 Generic morphism:
-  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')
- and relations (x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2)
-  To:   Finitely Presented Group on generators ('x1', 'x2')
- and relations (x2^2, x1*x2*x1*x2)
+  From: Finitely presented group < x0, x1, x2 | x0*x1*x2*x0*x1*x2, x1*x2*x0*x1*x2, x2^2 >
+  To:   Finitely presented group < x1, x2 | x2^2, x1*x2*x1*x2 >
 sage: H.abelian_invariants()
-[2, 2]
+(2, 2)
 sage: H.simplification_isomorphism()(x0)
-<identity ...>
+1
 sage: H.simplification_isomorphism()(x1)
 x1
 sage: H.simplification_isomorphism()(x2)
 x2
 sage: H.abelian_invariants()
-[2, 2]
+(2, 2)
 ```
 
 Caution: some methods are no granted to finish, specially if the group is infinite. In that case, the system memory would be exhausted, and the underlying gap session killed, leaving orphaned objects. It would be nice to have a security system that would interrupt the computation before arriving to that, giving just an error message. It's on the to-do list.
 
 
 ```
-sage: G=FreeGroup(3)
+sage: G = FreeGroup(3)
 sage: G.inject_variables()
 Defining x0, x1, x2
-sage: H=G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])
+sage: H = G.quotient([x0^2,x1^2,x2^3,(x0*x1)^2,(x0*x2)^2,(x1*x2)^3])
 sage: H.abelian_invariants()
-[2]
+(2,)
 sage: H.simplification_isomorphism()
 Generic morphism:
-  From: Finitely Presented Group on generators ('x0', 'x1', 'x2')
- and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)
-  To:   Finitely Presented Group on generators ('x0', 'x1', 'x2')
- and relations (x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2)
-sage: H.size()
+  From: Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >
+  To:   Finitely presented group < x0, x1, x2 | x0^2, x1^2, x2^3, x0*x1*x0*x1, x0*x2*x0*x2, x1*x2*x1*x2*x1*x2 >
+sage: H.cardinality()
 24
-sage: H.permutation_group()
+sage: H.as_permutation_group()
 Permutation Group with generators [(1,2)(3,6)(4,8)(5,7)(9,14)(10,13)(11,16)(12,15)(17,22)(18,21)(19,24)(20,23), (1,3)(2,6)(4,11)(5,12)(7,15)(8,16)(9,17)(10,18)(13,21)(14,22)(19,20)(23,24), (1,4,5)(2,7,8)(3,9,10)(6,13,14)(11,18,19)(12,20,17)(15,22,23)(16,24,21)]
 ```
 
@@ -122,4 +115,4 @@
 
 There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
 
-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_libgap.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_libgap.patch.gz)
+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
``````




---

archive/issue_comments_136524.json:
```json
{
    "body": "Improved patch",
    "created_at": "2012-11-16T00:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136524",
    "user": "https://github.com/vbraun"
}
```

Improved patch



---

archive/issue_comments_136525.json:
```json
{
    "body": "Attachment: **[trac_12339_fpgroups.3.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz)**\n\nAttachment: **[trac_12339_braids.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)**\n\nsplit patch",
    "created_at": "2012-11-16T00:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136525",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_12339_fpgroups.3.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz)**

Attachment: **[trac_12339_braids.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)**

split patch



---

archive/issue_comments_136526.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nI've factored out repeated code for implementing Sage parents/elements on top of LibGAP groups/elements into `libgap_wrapper.pyx`.\n* Don't import everything into the global namespace. Lots of doctests\n  were failing because lazy importing '*' is not what you want. Generally speaking, never  import `*`.\n* `Group.__init__` already calls `Parent.__init__`, don't call it twice\n* Support the `G.<a,b> = FreeGroup()` syntax\n* use `_assign_names()` to store generator names, no point in storing\n  them again in `_gens_str_`.\n* The first line of the docstring should be imperative: \"Return x\"\n  instead of \"Returns x\"\n* I've shortened some method names, e.g. `g.TietzeList()` -> `g.Tietze`\n* I don't think we need `G.size()` in addition to `G.cardinality()` and\n  `G.order()`. \n* Method names shouldn't sound like they mutate the object,\n  e.g. `G.simplified()` instead of `G.simplify()`\n* To convert different group presentations I'd prefer\n  `G.as_permutation_group()` instead of `G.permutation_group()`. In\n  particular since GAP knows so many ways to write a group, so it'll\n  be less confusing in the long run.\n\nI worked my way through everything but the braid group stuff. That is, I think anything but `braid.py` is good to go. The braid groups still need some work as the base classes changed a bit. The following still needs to be done:\n\n* Support `B.<s,t,u> = BraidGroup()` syntax\n* remove `__cmp__` to use GAP's internal comparison methods\n* remove unused imports\n* move imports that are used only once (e.g. plotting) into the method that uses them. This helps to avoid circular imports in the long run.\n\nI won't have time to work on this for at least a week, if you are interested please give it a try!",
    "created_at": "2012-11-16T00:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136526",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:55" align="right">Comment 55</div>

I've factored out repeated code for implementing Sage parents/elements on top of LibGAP groups/elements into `libgap_wrapper.pyx`.
* Don't import everything into the global namespace. Lots of doctests
  were failing because lazy importing '*' is not what you want. Generally speaking, never  import `*`.
* `Group.__init__` already calls `Parent.__init__`, don't call it twice
* Support the `G.<a,b> = FreeGroup()` syntax
* use `_assign_names()` to store generator names, no point in storing
  them again in `_gens_str_`.
* The first line of the docstring should be imperative: "Return x"
  instead of "Returns x"
* I've shortened some method names, e.g. `g.TietzeList()` -> `g.Tietze`
* I don't think we need `G.size()` in addition to `G.cardinality()` and
  `G.order()`. 
* Method names shouldn't sound like they mutate the object,
  e.g. `G.simplified()` instead of `G.simplify()`
* To convert different group presentations I'd prefer
  `G.as_permutation_group()` instead of `G.permutation_group()`. In
  particular since GAP knows so many ways to write a group, so it'll
  be less confusing in the long run.

I worked my way through everything but the braid group stuff. That is, I think anything but `braid.py` is good to go. The braid groups still need some work as the base classes changed a bit. The following still needs to be done:

* Support `B.<s,t,u> = BraidGroup()` syntax
* remove `__cmp__` to use GAP's internal comparison methods
* remove unused imports
* move imports that are used only once (e.g. plotting) into the method that uses them. This helps to avoid circular imports in the long run.

I won't have time to work on this for at least a week, if you are interested please give it a try!



---

archive/issue_comments_136527.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -115,4 +115,4 @@\n \n There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n \n-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.3.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n``````\n",
    "created_at": "2012-11-16T00:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136527",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -115,4 +115,4 @@
 
 There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
 
-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.3.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
``````




---

archive/issue_comments_136528.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nWow, thanks for the great work. I will try to go through the braid code following your steps. \n\nI have an issue thoough. I don't know which patch is exactly to blame, but the documentation does not build:\n\n```\nmmarco@neumann ~/sage-5.5.beta0 $ ./sage -docbuild reference html\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\nTraceback (most recent call last):\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 1083, in <module>\n    getattr(get_builder(name), type)()\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 347, in _wrapper\n    self.write_auto_rest_file(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 606, in write_auto_rest_file\n    title = self.get_module_docstring_title(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 564, in get_module_docstring_title\n    __import__(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/local/lib/python2.7/site-packages/sage/groups/braid.py\", line 446, in <module>\n    class BraidGroup(FinitelyPresentedGroup):\nNameError: name 'FinitelyPresentedGroup' is not defined\n```",
    "created_at": "2012-11-17T00:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136528",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:56" align="right">Comment 56</div>

Wow, thanks for the great work. I will try to go through the braid code following your steps. 

I have an issue thoough. I don't know which patch is exactly to blame, but the documentation does not build:

```
mmarco@neumann ~/sage-5.5.beta0 $ ./sage -docbuild reference html
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
Traceback (most recent call last):
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 1083, in <module>
    getattr(get_builder(name), type)()
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 347, in _wrapper
    self.write_auto_rest_file(module_name)
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 606, in write_auto_rest_file
    title = self.get_module_docstring_title(module_name)
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 564, in get_module_docstring_title
    __import__(module_name)
  File "/home/mmarco/sage-5.5.beta0/local/lib/python2.7/site-packages/sage/groups/braid.py", line 446, in <module>
    class BraidGroup(FinitelyPresentedGroup):
NameError: name 'FinitelyPresentedGroup' is not defined
```



---

archive/issue_comments_136529.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nWith the previous patch ([attachment: trac_12339_fpgroups_libgap.patch]), the file `devel/sage/sage/groups/finitely_presented.py` passes all tests. With the new patches, I get a ton of doctest failures in both `finitely_presented.py` and `free_group.py`.",
    "created_at": "2012-11-17T01:12:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136529",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:57" align="right">Comment 57</div>

With the previous patch ([attachment: trac_12339_fpgroups_libgap.patch]), the file `devel/sage/sage/groups/finitely_presented.py` passes all tests. With the new patches, I get a ton of doctest failures in both `finitely_presented.py` and `free_group.py`.



---

archive/issue_comments_136530.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nI've recently updated the libgap patch #13687, make sure that you have the newest version.\n\nIf you just apply trac_12339_fpgroups.3.patch then everything should be fine. At least all doctests pass for me. The braid patchs needs to be updated, though.\n\nAlso note that I've removed `FinitelyPresentedGroup` from the global namespace. Since you need to constrcut a `FreeGroup` first there is no point in having an extra symbol; just create finitely presented groups as quotients.",
    "created_at": "2012-11-17T05:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136530",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:58" align="right">Comment 58</div>

I've recently updated the libgap patch #13687, make sure that you have the newest version.

If you just apply trac_12339_fpgroups.3.patch then everything should be fine. At least all doctests pass for me. The braid patchs needs to be updated, though.

Also note that I've removed `FinitelyPresentedGroup` from the global namespace. Since you need to constrcut a `FreeGroup` first there is no point in having an extra symbol; just create finitely presented groups as quotients.



---

archive/issue_comments_136531.json:
```json
{
    "body": "Changed dependencies from **#6391, #13687** to **#6391, #13687, #13588**",
    "created_at": "2012-11-17T05:46:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136531",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#6391, #13687** to **#6391, #13687, #13588**



---

archive/issue_comments_136532.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nI meant the updated libgap patch at #13588. I just noticed that its wasn't in the dependencies, sorry about the confusion.",
    "created_at": "2012-11-17T05:46:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136532",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:59" align="right">Comment 59</div>

I meant the updated libgap patch at #13588. I just noticed that its wasn't in the dependencies, sorry about the confusion.



---

archive/issue_comments_136533.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nAnd about Miguel's error\n\n```\nTraceback (most recent call last):\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 1083, in <module>\n    getattr(get_builder(name), type)()\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 347, in _wrapper\n    self.write_auto_rest_file(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 606, in write_auto_rest_file\n    title = self.get_module_docstring_title(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py\", line 564, in get_module_docstring_title\n    __import__(module_name)\n  File \"/home/mmarco/sage-5.5.beta0/local/lib/python2.7/site-packages/sage/groups/braid.py\", line 446, in <module>\n    class BraidGroup(FinitelyPresentedGroup):\nNameError: name 'FinitelyPresentedGroup' is not defined\n```\nif you only apply trac_12339_fpgroups.3.patch: You should delete the file `$SAGE_ROOT//devel/sage/doc/en/reference/sage/groups/braid.rst` in the Sage source tree. Sphinx doesn't remove its intermediate files under some circumstances, breaking the docbuild if these files reference no longer existing modules.",
    "created_at": "2012-11-17T05:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136533",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:60" align="right">Comment 60</div>

And about Miguel's error

```
Traceback (most recent call last):
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 1083, in <module>
    getattr(get_builder(name), type)()
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 347, in _wrapper
    self.write_auto_rest_file(module_name)
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 606, in write_auto_rest_file
    title = self.get_module_docstring_title(module_name)
  File "/home/mmarco/sage-5.5.beta0/devel/sage/doc/common/builder.py", line 564, in get_module_docstring_title
    __import__(module_name)
  File "/home/mmarco/sage-5.5.beta0/local/lib/python2.7/site-packages/sage/groups/braid.py", line 446, in <module>
    class BraidGroup(FinitelyPresentedGroup):
NameError: name 'FinitelyPresentedGroup' is not defined
```
if you only apply trac_12339_fpgroups.3.patch: You should delete the file `$SAGE_ROOT//devel/sage/doc/en/reference/sage/groups/braid.rst` in the Sage source tree. Sphinx doesn't remove its intermediate files under some circumstances, breaking the docbuild if these files reference no longer existing modules.



---

archive/issue_comments_136534.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nGood, the patch from #13588 fixes things. Thanks. \n\nI'm running into another problem, which I found by working on #13254. I'm not sure what the issue is: two different presentations for the same group? Anyway, I'm getting a segfault, at least on OS X 10.8:\n\n```\nsage: G.<e0, e1, e2, e3, e4, e5, e6, e7, e8, e9> = FreeGroup()\nsage: rels = [e6, e5, e3, e9, e4*e7^-1*e6, e9*e7^-1*e0, e0*e1^-1*e2, e5*e1^-1*e8, e4*e3^-1*e8, e2]\nsage: G.quotient(rels)\nFinitely presented group < e0, e1, e2, e3, e4, e5, e6, e7, e8, e9 | e6, e5, e3, e9, e4*e7^-1*e6, e9*e7^-1*e0, e0*e1^-1*e2, e5*e1^-1*e8, e4*e3^-1*e8, e2 >\nsage: G.quotient(rels).simplified()\nFinitely presented group < e0 | e0^2 >\nsage: H.<e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, e10, e11, e12, e13, e14, e15, e16, e17, e18, e19, e20, e21, e22, e23, e24, e25, e26, e27, e28, e29, e30, e31, e32, e33, e34, e35, e36, e37, e38, e39, e40> = FreeGroup()\nsage: rels = [e31*e20^-1*e23, e6, e4*e8^-1*e37, e24*e5^-1*e33, e36*e38^-1*e4, e35, e7*e25^-1*e24, e27*e5^-1*e23, e25, e26*e13^-1*e40, e3*e37^-1*e40, e31*e14^-1*e15, e28*e20^-1*e5, e21, e10*e20^-1*e34, e18*e34^-1*e23, e32*e13^-1*e37, e39*e34^-1*e21, e32*e26^-1*e3, e38, e28, e27, e3, e13*e12^-1*e33, e26, e1, e15, e36*e29^-1*e1, e31, e35*e9^-1*e8, e11*e9^-1*e37, e10*e11^-1*e6, e25*e16^-1*e17, e17*e33^-1*e19, e32, e39*e25^-1*e8, e9, e28*e9^-1*e24, e14, e19, e6*e16^-1*e2, e34, e38*e27^-1*e3, e0*e21^-1*e23, e38*e29^-1*e2, e1*e21^-1*e19, e39*e18^-1*e0, e26*e30^-1*e15, e18*e16^-1*e15, e10*e14^-1*e16, e30, e35*e14^-1*e1, e37*e22^-1*e33, e6*e34^-1*e22, e8, e35*e11^-1*e4, e32*e12^-1*e22, e29*e5^-1*e19, e24*e29^-1*e17, e13*e30^-1*e17, e36*e27^-1*e0, e7, e24, e11*e14^-1*e2, e12, e11*e20^-1*e22, e40*e15^-1*e17, e36*e5^-1*e21, e28*e31^-1*e27, e4*e0^-1*e3, e30*e12^-1*e19, e39, e7*e16^-1*e29, e18*e25^-1*e40, e22, e0*e8^-1*e40, e9*e20^-1*e33, e4*e1^-1*e2, e10*e31^-1*e18, e7*e6^-1*e38]\nsage: H.quotient(rels)\nFinitely presented group < e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, e10, e11, e12, e13, e14, e15, e16, e17, e18, e19, e20, e21, e22, e23, e24, e25, e26, e27, e28, e29, e30, e31, e32, e33, e34, e35, e36, e37, e38, e39, e40 | e31*e20^-1*e23, e6, e4*e8^-1*e37, e24*e5^-1*e33, e36*e38^-1*e4, e35, e7*e25^-1*e24, e27*e5^-1*e23, e25, e26*e13^-1*e40, e3*e37^-1*e40, e31*e14^-1*e15, e28*e20^-1*e5, e21, e10*e20^-1*e34, e18*e34^-1*e23, e32*e13^-1*e37, e39*e34^-1*e21, e32*e26^-1*e3, e38, e28, e27, e3, e13*e12^-1*e33, e26, e1, e15, e36*e29^-1*e1, e31, e35*e9^-1*e8, e11*e9^-1*e37, e10*e11^-1*e6, e25*e16^-1*e17, e17*e33^-1*e19, e32, e39*e25^-1*e8, e9, e28*e9^-1*e24, e14, e19, e6*e16^-1*e2, e34, e38*e27^-1*e3, e0*e21^-1*e23, e38*e29^-1*e2, e1*e21^-1*e19, e39*e18^-1*e0, e26*e30^-1*e15, e18*e16^-1*e15, e10*e14^-1*e16, e30, e35*e14^-1*e1, e37*e22^-1*e33, e6*e34^-1*e22, e8, e35*e11^-1*e4, e32*e12^-1*e22, e29*e5^-1*e19, e24*e29^-1*e17, e13*e30^-1*e17, e36*e27^-1*e0, e7, e24, e11*e14^-1*e2, e12, e11*e20^-1*e22, e40*e15^-1*e17, e36*e5^-1*e21, e28*e31^-1*e27, e4*e0^-1*e3, e30*e12^-1*e19, e39, e7*e16^-1*e29, e18*e25^-1*e40, e22, e0*e8^-1*e40, e9*e20^-1*e33, e4*e1^-1*e2, e10*e31^-1*e18, e7*e6^-1*e38 >\nsage: H.quotient(rels).simplified() # should be Finitely presented group < e0 | e0^2 >\nException RuntimeError: \"Error, no method found! For debugging hints type ?Recovery from NoMethodFound\\nError, no 1st choice method found for `<' on 2 arguments\\n\" in 'sage.libs.gap.util.error_handler' ignored\n\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off(). You might\nwant to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate.\n------------------------------------------------------------------------\n```",
    "created_at": "2012-11-17T07:03:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136534",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:61" align="right">Comment 61</div>

Good, the patch from #13588 fixes things. Thanks. 

I'm running into another problem, which I found by working on #13254. I'm not sure what the issue is: two different presentations for the same group? Anyway, I'm getting a segfault, at least on OS X 10.8:

```
sage: G.<e0, e1, e2, e3, e4, e5, e6, e7, e8, e9> = FreeGroup()
sage: rels = [e6, e5, e3, e9, e4*e7^-1*e6, e9*e7^-1*e0, e0*e1^-1*e2, e5*e1^-1*e8, e4*e3^-1*e8, e2]
sage: G.quotient(rels)
Finitely presented group < e0, e1, e2, e3, e4, e5, e6, e7, e8, e9 | e6, e5, e3, e9, e4*e7^-1*e6, e9*e7^-1*e0, e0*e1^-1*e2, e5*e1^-1*e8, e4*e3^-1*e8, e2 >
sage: G.quotient(rels).simplified()
Finitely presented group < e0 | e0^2 >
sage: H.<e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, e10, e11, e12, e13, e14, e15, e16, e17, e18, e19, e20, e21, e22, e23, e24, e25, e26, e27, e28, e29, e30, e31, e32, e33, e34, e35, e36, e37, e38, e39, e40> = FreeGroup()
sage: rels = [e31*e20^-1*e23, e6, e4*e8^-1*e37, e24*e5^-1*e33, e36*e38^-1*e4, e35, e7*e25^-1*e24, e27*e5^-1*e23, e25, e26*e13^-1*e40, e3*e37^-1*e40, e31*e14^-1*e15, e28*e20^-1*e5, e21, e10*e20^-1*e34, e18*e34^-1*e23, e32*e13^-1*e37, e39*e34^-1*e21, e32*e26^-1*e3, e38, e28, e27, e3, e13*e12^-1*e33, e26, e1, e15, e36*e29^-1*e1, e31, e35*e9^-1*e8, e11*e9^-1*e37, e10*e11^-1*e6, e25*e16^-1*e17, e17*e33^-1*e19, e32, e39*e25^-1*e8, e9, e28*e9^-1*e24, e14, e19, e6*e16^-1*e2, e34, e38*e27^-1*e3, e0*e21^-1*e23, e38*e29^-1*e2, e1*e21^-1*e19, e39*e18^-1*e0, e26*e30^-1*e15, e18*e16^-1*e15, e10*e14^-1*e16, e30, e35*e14^-1*e1, e37*e22^-1*e33, e6*e34^-1*e22, e8, e35*e11^-1*e4, e32*e12^-1*e22, e29*e5^-1*e19, e24*e29^-1*e17, e13*e30^-1*e17, e36*e27^-1*e0, e7, e24, e11*e14^-1*e2, e12, e11*e20^-1*e22, e40*e15^-1*e17, e36*e5^-1*e21, e28*e31^-1*e27, e4*e0^-1*e3, e30*e12^-1*e19, e39, e7*e16^-1*e29, e18*e25^-1*e40, e22, e0*e8^-1*e40, e9*e20^-1*e33, e4*e1^-1*e2, e10*e31^-1*e18, e7*e6^-1*e38]
sage: H.quotient(rels)
Finitely presented group < e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, e10, e11, e12, e13, e14, e15, e16, e17, e18, e19, e20, e21, e22, e23, e24, e25, e26, e27, e28, e29, e30, e31, e32, e33, e34, e35, e36, e37, e38, e39, e40 | e31*e20^-1*e23, e6, e4*e8^-1*e37, e24*e5^-1*e33, e36*e38^-1*e4, e35, e7*e25^-1*e24, e27*e5^-1*e23, e25, e26*e13^-1*e40, e3*e37^-1*e40, e31*e14^-1*e15, e28*e20^-1*e5, e21, e10*e20^-1*e34, e18*e34^-1*e23, e32*e13^-1*e37, e39*e34^-1*e21, e32*e26^-1*e3, e38, e28, e27, e3, e13*e12^-1*e33, e26, e1, e15, e36*e29^-1*e1, e31, e35*e9^-1*e8, e11*e9^-1*e37, e10*e11^-1*e6, e25*e16^-1*e17, e17*e33^-1*e19, e32, e39*e25^-1*e8, e9, e28*e9^-1*e24, e14, e19, e6*e16^-1*e2, e34, e38*e27^-1*e3, e0*e21^-1*e23, e38*e29^-1*e2, e1*e21^-1*e19, e39*e18^-1*e0, e26*e30^-1*e15, e18*e16^-1*e15, e10*e14^-1*e16, e30, e35*e14^-1*e1, e37*e22^-1*e33, e6*e34^-1*e22, e8, e35*e11^-1*e4, e32*e12^-1*e22, e29*e5^-1*e19, e24*e29^-1*e17, e13*e30^-1*e17, e36*e27^-1*e0, e7, e24, e11*e14^-1*e2, e12, e11*e20^-1*e22, e40*e15^-1*e17, e36*e5^-1*e21, e28*e31^-1*e27, e4*e0^-1*e3, e30*e12^-1*e19, e39, e7*e16^-1*e29, e18*e25^-1*e40, e22, e0*e8^-1*e40, e9*e20^-1*e33, e4*e1^-1*e2, e10*e31^-1*e18, e7*e6^-1*e38 >
sage: H.quotient(rels).simplified() # should be Finitely presented group < e0 | e0^2 >
Exception RuntimeError: "Error, no method found! For debugging hints type ?Recovery from NoMethodFound\nError, no 1st choice method found for `<' on 2 arguments\n" in 'sage.libs.gap.util.error_handler' ignored

------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off(). You might
want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate.
------------------------------------------------------------------------
```



---

archive/issue_comments_136535.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nI have done the changes you suggested to braid groups, except for the `__cmp__` method: we make use of the fact that word problem is solvable in braid groups, because of the normal form. This way, we really check if two braids, that can look really different, are the same or not.\n\nIt seems to solve the problem with the documentation building.",
    "created_at": "2012-11-17T17:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136535",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:62" align="right">Comment 62</div>

I have done the changes you suggested to braid groups, except for the `__cmp__` method: we make use of the fact that word problem is solvable in braid groups, because of the normal form. This way, we really check if two braids, that can look really different, are the same or not.

It seems to solve the problem with the documentation building.



---

archive/issue_comments_136536.json:
```json
{
    "body": "Attachment: **[trac_12339_braid_groups_4.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)**\n\napply over volker's last patch.",
    "created_at": "2012-11-17T17:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136536",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[trac_12339_braid_groups_4.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)**

apply over volker's last patch.



---

archive/issue_comments_136537.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nFor what it's worth, I get the same error [as above](#comment%3A61) on sage.math. A simpler example:\n\n```\nsage: G.<e0> = FreeGroup()\nsage: relns_G = [e0^2]\nsage: H.<e0, e1> = FreeGroup()\nsage: relns_H = [e0^2, e1]\nsage: G2 = G / relns_G\nsage: H2 = H / relns_H\nsage: G2.simplified()\nFinitely presented group < e0 | e0^2 >\nsage: H2.simplified()\nException RuntimeError: \"Error, no method found! For debugging hints type ?Recovery from NoMethodFound\\nError, no 1st choice method found for `<' on 2 arguments\\n\" in 'sage.libs.gap.util.error_handler' ignored\n/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(print_backtrace+0x31)[0x7f5a11f63207]\n/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(sigdie+0x14)[0x7f5a11f63239]\n/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(sage_signal_handler+0x216)[0x7f5a11f62e16]\n/lib/libpthread.so.0[0x7f5a171797d0]\n[0x7f58e53e47d0]\n\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off(). You might\nwant to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate.\n------------------------------------------------------------------------\n```\nIt looks like the issue is using the same generator names for `G` and `H`: if I change it so `H` is defined by `H.<f0, f1> = FreeGroup()`, I don't get this problem. I think this needs to be dealt with, and a doctest needs to be added verifying that it has been dealt with.",
    "created_at": "2012-11-18T05:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136537",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:63" align="right">Comment 63</div>

For what it's worth, I get the same error [as above](#comment%3A61) on sage.math. A simpler example:

```
sage: G.<e0> = FreeGroup()
sage: relns_G = [e0^2]
sage: H.<e0, e1> = FreeGroup()
sage: relns_H = [e0^2, e1]
sage: G2 = G / relns_G
sage: H2 = H / relns_H
sage: G2.simplified()
Finitely presented group < e0 | e0^2 >
sage: H2.simplified()
Exception RuntimeError: "Error, no method found! For debugging hints type ?Recovery from NoMethodFound\nError, no 1st choice method found for `<' on 2 arguments\n" in 'sage.libs.gap.util.error_handler' ignored
/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(print_backtrace+0x31)[0x7f5a11f63207]
/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(sigdie+0x14)[0x7f5a11f63239]
/scratch/palmieri/sage-5.5.rc0/local/lib/libcsage.so(sage_signal_handler+0x216)[0x7f5a11f62e16]
/lib/libpthread.so.0[0x7f5a171797d0]
[0x7f58e53e47d0]

------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off(). You might
want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate.
------------------------------------------------------------------------
```
It looks like the issue is using the same generator names for `G` and `H`: if I change it so `H` is defined by `H.<f0, f1> = FreeGroup()`, I don't get this problem. I think this needs to be dealt with, and a doctest needs to be added verifying that it has been dealt with.



---

archive/issue_comments_136538.json:
```json
{
    "body": "Improved patch",
    "created_at": "2012-11-20T01:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136538",
    "user": "https://github.com/vbraun"
}
```

Improved patch



---

archive/issue_comments_136539.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -115,4 +115,4 @@\n \n There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n \n-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.3.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n``````\n",
    "created_at": "2012-11-20T01:27:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136539",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -115,4 +115,4 @@
 
 There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
 
-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups.3.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups.3.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
+To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
``````




---

archive/issue_comments_136540.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nAttachment: **[trac_12339_fpgroups_vb.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz)**\n\nThe problem was that GAP doesn't allow comparison of some objects (e.g. FreeGroup). Since the finitely presented group is unique, you could only call `wrap_FreeGroup` once; the second time fails. Because the comparison in libgap wasn't properly wrapped in `sig_on/off` this then aborted. Fixed in the attached patch and the updated libgap at #13588.",
    "created_at": "2012-11-20T01:27:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136540",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:64" align="right">Comment 64</div>

Attachment: **[trac_12339_fpgroups_vb.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz)**

The problem was that GAP doesn't allow comparison of some objects (e.g. FreeGroup). Since the finitely presented group is unique, you could only call `wrap_FreeGroup` once; the second time fails. Because the comparison in libgap wasn't properly wrapped in `sig_on/off` this then aborted. Fixed in the attached patch and the updated libgap at #13588.



---

archive/issue_comments_136541.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nThanks, Volker, your new patches fixed my problem. It sounds like you're saying that there is no good way to have\n\n```\nsage: G.<e0> = FreeGroup()\nsage: relns_G = [e0^2]\nsage: H.<e0, e1> = FreeGroup()\nsage: relns_H = [e0^2, e1]\nsage: G2 = G / relns_G\nsage: H2 = H / relns_H\nsage: G2 == H2\n```\nreturn True? That's unfortunate. Should `__eq__` raise a `NotImplementedError` instead, or is that too unpythonic?",
    "created_at": "2012-11-20T04:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136541",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:65" align="right">Comment 65</div>

Thanks, Volker, your new patches fixed my problem. It sounds like you're saying that there is no good way to have

```
sage: G.<e0> = FreeGroup()
sage: relns_G = [e0^2]
sage: H.<e0, e1> = FreeGroup()
sage: relns_H = [e0^2, e1]
sage: G2 = G / relns_G
sage: H2 = H / relns_H
sage: G2 == H2
```
return True? That's unfortunate. Should `__eq__` raise a `NotImplementedError` instead, or is that too unpythonic?



---

archive/issue_comments_136542.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nReplying to [@jhpalmieri](#comment%3A65):\n> Thanks, Volker, your new patches fixed my problem. It sounds like you're saying that there is no good way to have\n> \n> ```\n> sage: G.<e0> = FreeGroup()\n> sage: relns_G = [e0^2]\n> sage: H.<e0, e1> = FreeGroup()\n> sage: relns_H = [e0^2, e1]\n> sage: G2 = G / relns_G\n> sage: H2 = H / relns_H\n> sage: G2 == H2\n> ```\n> return True? That's unfortunate. Should `__eq__` raise a `NotImplementedError` instead, or is that too unpythonic?\n\nit seems to be more subtle, as the group presentations are different.\nGAP has [several](http://www.gap-system.org/Gap3/Manual3/C023S008.htm) different classes of objects for finitely presented groups, with some of them having presentation explicit.\n\nGAP can check for finite group isomorphism.\n\nThe concept of free group in Sage ought to be better defined, i.e. currently it seems to be a group with an attached presentation. It would be good to have this explicitly explained in documentation.\n>",
    "created_at": "2012-11-20T04:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136542",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:66" align="right">Comment 66</div>

Replying to [@jhpalmieri](#comment%3A65):
> Thanks, Volker, your new patches fixed my problem. It sounds like you're saying that there is no good way to have
> 
> ```
> sage: G.<e0> = FreeGroup()
> sage: relns_G = [e0^2]
> sage: H.<e0, e1> = FreeGroup()
> sage: relns_H = [e0^2, e1]
> sage: G2 = G / relns_G
> sage: H2 = H / relns_H
> sage: G2 == H2
> ```
> return True? That's unfortunate. Should `__eq__` raise a `NotImplementedError` instead, or is that too unpythonic?

it seems to be more subtle, as the group presentations are different.
GAP has [several](http://www.gap-system.org/Gap3/Manual3/C023S008.htm) different classes of objects for finitely presented groups, with some of them having presentation explicit.

GAP can check for finite group isomorphism.

The concept of free group in Sage ought to be better defined, i.e. currently it seems to be a group with an attached presentation. It would be good to have this explicitly explained in documentation.
>



---

archive/issue_comments_136543.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nReplying to [@vbraun](#comment%3A60):\n> And about Miguel's error\n>   [snip ...]\n> if you only apply trac_12339_fpgroups.3.patch: You should delete the file `$SAGE_ROOT//devel/sage/doc/en/reference/sage/groups/braid.rst` in the Sage source tree. Sphinx doesn't remove its intermediate files under some circumstances, breaking the docbuild if these files reference no longer existing modules.\n\nI think the issue is that line 93 of braid.py should be changed from\n\n```\nfrom sage.groups.finitely_presented import FinitelyPresentedGroupElement\n```\nto\n\n```\nfrom sage.groups.finitely_presented import FinitelyPresentedGroup, FinitelyPresentedGroupElement\n```",
    "created_at": "2012-11-20T05:16:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136543",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:67" align="right">Comment 67</div>

Replying to [@vbraun](#comment%3A60):
> And about Miguel's error
>   [snip ...]
> if you only apply trac_12339_fpgroups.3.patch: You should delete the file `$SAGE_ROOT//devel/sage/doc/en/reference/sage/groups/braid.rst` in the Sage source tree. Sphinx doesn't remove its intermediate files under some circumstances, breaking the docbuild if these files reference no longer existing modules.

I think the issue is that line 93 of braid.py should be changed from

```
from sage.groups.finitely_presented import FinitelyPresentedGroupElement
```
to

```
from sage.groups.finitely_presented import FinitelyPresentedGroup, FinitelyPresentedGroupElement
```



---

archive/issue_comments_136544.json:
```json
{
    "body": "Initial patch",
    "created_at": "2012-11-20T09:37:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136544",
    "user": "https://github.com/vbraun"
}
```

Initial patch



---

archive/issue_comments_136545.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nAttachment: **[trac_12339_braid_groups_review.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)**\n\nThe final patch adds:\n\n* Indentation & spacing fixed\n\n* Renamed `BraidGroup_class.MappingClassGroup()` -> `BraidGroup_class.mapping_class_group()`. Use CamelCase for classes, lower-case underscore names for methods.\n\n* Let the coercion system discover mapping group actions on suitable free groups, so the following works without further ado:\n\n  ```\n  sage: B.<b0,b1,b2> = BraidGroup() \n  sage: F.<f0,f1,f2,f3> = FreeGroup() \n  sage: f1 * b1 \n  f1*f2*f1^-1\n  ```\n\nAs far as I'm concerned this ticket is good (enough) to go.\n\nComparison should be fixed, of course. By default, `==` should just compare the presentation of the group and not up to isomorphism. Checking up to isomorphism should be done with an `is_isomorphic()` method so its not used in caching.",
    "created_at": "2012-11-20T09:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136545",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:68" align="right">Comment 68</div>

Attachment: **[trac_12339_braid_groups_review.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)**

The final patch adds:

* Indentation & spacing fixed

* Renamed `BraidGroup_class.MappingClassGroup()` -> `BraidGroup_class.mapping_class_group()`. Use CamelCase for classes, lower-case underscore names for methods.

* Let the coercion system discover mapping group actions on suitable free groups, so the following works without further ado:

  ```
  sage: B.<b0,b1,b2> = BraidGroup() 
  sage: F.<f0,f1,f2,f3> = FreeGroup() 
  sage: f1 * b1 
  f1*f2*f1^-1
  ```

As far as I'm concerned this ticket is good (enough) to go.

Comparison should be fixed, of course. By default, `==` should just compare the presentation of the group and not up to isomorphism. Checking up to isomorphism should be done with an `is_isomorphic()` method so its not used in caching.



---

archive/issue_events_153812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-20T09:48:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153812"
}
```



---

archive/issue_events_153813.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-20T09:48:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153813"
}
```



---

archive/issue_comments_136546.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -115,4 +115,9 @@\n \n There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n \n-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n+To install it, just make sure you have applied #6391, and then apply \n+* [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), \n+* [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n+* [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)\n+* [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)\n+\n``````\n",
    "created_at": "2012-11-20T09:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136546",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -115,4 +115,9 @@
 
 There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
 
-To install it, just make sure you have applied #6391, and then apply [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
+To install it, just make sure you have applied #6391, and then apply 
+* [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), 
+* [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
+* [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)
+* [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)
+
``````




---

archive/issue_comments_136547.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -115,9 +115,8 @@\n \n There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.\n \n-To install it, just make sure you have applied #6391, and then apply \n+To install it, just make sure you have applied #6391, #13211, and then apply \n * [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), \n * [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n * [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)\n * [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)\n-\n``````\n",
    "created_at": "2012-11-20T09:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136547",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -115,9 +115,8 @@
 
 There is a new version to be used with the libgap interface (much faster than the old pexpect one). Since libgap seems to be stable and ready, i plan to focus on this version.
 
-To install it, just make sure you have applied #6391, and then apply 
+To install it, just make sure you have applied #6391, #13211, and then apply 
 * [attachment: trac_12339_fpgroups_vb.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_fpgroups_vb.patch.gz), 
 * [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
 * [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)
 * [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)
-
``````




---

archive/issue_comments_136548.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nVolker, since you have contributed significantly to the code, would it be apropriate if you gave the positive review? Or should somebody else review it?",
    "created_at": "2012-11-22T11:54:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136548",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:70" align="right">Comment 70</div>

Volker, since you have contributed significantly to the code, would it be apropriate if you gave the positive review? Or should somebody else review it?



---

archive/issue_comments_136549.json:
```json
{
    "body": "Changed author from **Miguel Marco** to **Miguel Marco, Volker Braun**",
    "created_at": "2012-11-22T15:26:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136549",
    "user": "https://github.com/vbraun"
}
```

Changed author from **Miguel Marco** to **Miguel Marco, Volker Braun**



---

archive/issue_comments_136550.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">Comment 71</div>\n\nIts fairly common that the set of authors equals the set of reviewers. As I said before, I'm fine with the current state and everything that I wanted changed is changed. If you agree with my changes then add yourself to the reviewers and let's call it a day!",
    "created_at": "2012-11-22T15:26:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136550",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:71" align="right">Comment 71</div>

Its fairly common that the set of authors equals the set of reviewers. As I said before, I'm fine with the current state and everything that I wanted changed is changed. If you agree with my changes then add yourself to the reviewers and let's call it a day!



---

archive/issue_comments_136551.json:
```json
{
    "body": "Solved minor issue with braid pickling",
    "created_at": "2012-11-22T18:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136551",
    "user": "https://github.com/miguelmarco"
}
```

Solved minor issue with braid pickling



---

archive/issue_comments_136552.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nAttachment: **[trac_12339_pickling.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)**",
    "created_at": "2012-11-22T18:45:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136552",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:72" align="right">Comment 72</div>

Attachment: **[trac_12339_pickling.patch.gz](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)**



---

archive/issue_events_153814.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-11-22T18:45:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153814"
}
```



---

archive/issue_events_153815.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-11-22T18:45:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153815"
}
```



---

archive/issue_comments_136553.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -120,3 +120,4 @@\n * [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)\n * [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)\n * [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)\n+* [attachment: trac_12339_pickling.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)\n``````\n",
    "created_at": "2012-11-22T18:45:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136553",
    "user": "https://github.com/miguelmarco"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -120,3 +120,4 @@
 * [attachment: trac_12339_braids.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braids.patch.gz)
 * [attachment: trac_12339_braid_groups_4.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_4.patch.gz)
 * [attachment: trac_12339_braid_groups_review.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_braid_groups_review.patch.gz)
+* [attachment: trac_12339_pickling.patch](https://github.com/sagemath/sage/files/ticket12339/trac_12339_pickling.patch.gz)
``````




---

archive/issue_comments_136554.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">Comment 73</div>\n\nOk, i just added a minor correction to braid pickling. Now all doctests and testsuites run fine.",
    "created_at": "2012-11-22T18:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136554",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:73" align="right">Comment 73</div>

Ok, i just added a minor correction to braid pickling. Now all doctests and testsuites run fine.



---

archive/issue_events_153816.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-27T03:10:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153816"
}
```



---

archive/issue_events_153817.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-27T03:10:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153817"
}
```



---

archive/issue_events_153818.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-01-25T13:10:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153818"
}
```



---

archive/issue_events_153819.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-01-25T13:10:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153819"
}
```



---

archive/issue_comments_136555.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">Comment 75</div>\n\nI have some comments regarding this patch. I myself can not give much technical input, but I have a colleague here who has been trying to use this and has come across some inconsistencies.\n\n1. Is there a reason why a `FreeGroupElement` does not have the `__call__` method? A `FreeMonoidElement` does have the `__call__` method. This is needed to make the following work\n\n```python\nsage: G.<a,b> = FreeGroup()\nsage: a.subs(a=1,b=2) # We would expect the answer to be 1\na\n```\n2. Related to the implementation of the `__call__` method is the following problem. Suppose in order to make `subs()` work, we implement the `__call__` method. The current code has to call `a.Tietze()` to get the index of the free generator `a` and its exponent. For a more complicated expression the output is as follows, and we would have to go along and parse the output tuple to find out the exponent by counting. Is there any method (maybe in GAP) which outputs just a list of tuples `[(generator1, exponent1), (generator2, exponent2),...]`. This is again how `FreeMonoid` is implemented.\n\n```\nsage: (a^2 * b^-3).Tietze()\n(1, 1, -2, -2, -2)\nsage: (a^2 * b^-3).some_function() # some function which gives (generator, exponent) tuples\n[(a, 2), (b, -3)]\n```\n3. There is also this inconsistency in the output of the following two functions. In language, they say the same thing, but they are not mathematically equal (according to the current implementation):\n\n```python\nsage: G.<a,b> = FreeGroup()\nsage: test = (a).fox_derivative(a)\nsage: f = test.parent()\nsage: g = GroupAlgebra(G, ZZ)\nsage: print f\nGroup algebra of Free Group on generators {a, b, c, d, e} over Integer Ring\nsage: print g\nGroup algebra of group \"Free Group on generators {a, b, c, d, e}\" over base ring Integer Ring\nsage: print f == g\nFalse\n```",
    "created_at": "2013-01-25T13:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136555",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:75" align="right">Comment 75</div>

I have some comments regarding this patch. I myself can not give much technical input, but I have a colleague here who has been trying to use this and has come across some inconsistencies.

1. Is there a reason why a `FreeGroupElement` does not have the `__call__` method? A `FreeMonoidElement` does have the `__call__` method. This is needed to make the following work

```python
sage: G.<a,b> = FreeGroup()
sage: a.subs(a=1,b=2) # We would expect the answer to be 1
a
```
2. Related to the implementation of the `__call__` method is the following problem. Suppose in order to make `subs()` work, we implement the `__call__` method. The current code has to call `a.Tietze()` to get the index of the free generator `a` and its exponent. For a more complicated expression the output is as follows, and we would have to go along and parse the output tuple to find out the exponent by counting. Is there any method (maybe in GAP) which outputs just a list of tuples `[(generator1, exponent1), (generator2, exponent2),...]`. This is again how `FreeMonoid` is implemented.

```
sage: (a^2 * b^-3).Tietze()
(1, 1, -2, -2, -2)
sage: (a^2 * b^-3).some_function() # some function which gives (generator, exponent) tuples
[(a, 2), (b, -3)]
```
3. There is also this inconsistency in the output of the following two functions. In language, they say the same thing, but they are not mathematically equal (according to the current implementation):

```python
sage: G.<a,b> = FreeGroup()
sage: test = (a).fox_derivative(a)
sage: f = test.parent()
sage: g = GroupAlgebra(G, ZZ)
sage: print f
Group algebra of Free Group on generators {a, b, c, d, e} over Integer Ring
sage: print g
Group algebra of group "Free Group on generators {a, b, c, d, e}" over base ring Integer Ring
sage: print f == g
False
```



---

archive/issue_comments_136556.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nCan you open a new ticket for feature requests? I'm happy to help but not on this ticket.\n\n3) is a consequence of the combinat guys having their own group algebra implementation:\n\n```\nsage: type(f)\n<class 'sage.combinat.free_module.CombinatorialFreeModule_with_category'>\nsage: type(g)\n<class 'sage.algebras.group_algebra_new.GroupAlgebra_with_category'>\n```",
    "created_at": "2013-01-25T13:23:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136556",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:76" align="right">Comment 76</div>

Can you open a new ticket for feature requests? I'm happy to help but not on this ticket.

3) is a consequence of the combinat guys having their own group algebra implementation:

```
sage: type(f)
<class 'sage.combinat.free_module.CombinatorialFreeModule_with_category'>
sage: type(g)
<class 'sage.algebras.group_algebra_new.GroupAlgebra_with_category'>
```



---

archive/issue_events_153820.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-25T13:23:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153820"
}
```



---

archive/issue_events_153821.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-25T13:23:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153821"
}
```



---

archive/issue_events_153822.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-25T13:26:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153822"
}
```



---

archive/issue_events_153823.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-25T13:26:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153823"
}
```



---

archive/issue_comments_136557.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\nI posted your observation to combinat-devel, let's see what they have to say: https://groups.google.com/d/topic/sage-combinat-devel/f_Und2NDyFE/discussion",
    "created_at": "2013-01-25T13:33:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136557",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:78" align="right">Comment 78</div>

I posted your observation to combinat-devel, let's see what they have to say: https://groups.google.com/d/topic/sage-combinat-devel/f_Und2NDyFE/discussion



---

archive/issue_comments_136558.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">Comment 79</div>\n\nOpened #14010 to track the discussion.",
    "created_at": "2013-01-25T14:37:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136558",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:79" align="right">Comment 79</div>

Opened #14010 to track the discussion.



---

archive/issue_events_153824.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2013-01-26T11:54:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153824"
}
```



---

archive/issue_events_153825.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2013-01-26T11:54:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153825"
}
```



---

archive/issue_comments_136559.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">Comment 81</div>\n\nThe ticket is ready, and their dependencies are either already merged or almost ready to be merged. So i moved its milestone from sage-pending to sage-5.7",
    "created_at": "2013-01-26T11:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136559",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:81" align="right">Comment 81</div>

The ticket is ready, and their dependencies are either already merged or almost ready to be merged. So i moved its milestone from sage-pending to sage-5.7



---

archive/issue_events_153826.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-05T08:17:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153826"
}
```



---

archive/issue_events_153827.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-05T08:17:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12339#event-153827"
}
```



---

archive/issue_comments_136560.json:
```json
{
    "body": "Merged: **sage-5.7.beta3**",
    "created_at": "2013-02-05T08:17:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12339#issuecomment-136560",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta3**
