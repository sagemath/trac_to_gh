# Issue 12340: the optional polymake doctests are seriously misformatted so never run

archive/issues_012168.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: search_src('polymake')\n```\nreveals many tests marked `# optional: needs polymake`.\nThese will *NOT* get run by doing\n\n```\nsage -t -only_optional=polymake geometry/polytope.py\n```\n\nThey should be formatted as\n\n```\n#optional - polymake\n```\n\nBy the way, this test works fine without polymake is installed, because it doesn't do anything, so improve that by adding another test right after this that actually exercise the optional package.\n\n```\nsage: P = polymake.convex_hull([[1,0,0,0], [1,0,0,1], [1,0,1,0], [1,0,1,1],  [1,1,0,0], [1,1,0,1], [1,1,1,0], [1,1,1,1]])\n```\n\n\nAssignee: **@sagetrac-mvngu**\n\nKeywords: **sd40.5**\n\nReviewer: **Mike Hansen**\n\nAuthor: **Benjamin Jones**\n\nMerged: **sage-5.1.beta3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12340_\n\n",
    "closed_at": "2012-06-05T06:45:54Z",
    "created_at": "2012-01-21T21:36:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "the optional polymake doctests are seriously misformatted so never run",
    "type": "issue",
    "updated_at": "2012-06-05T06:45:54Z",
    "url": "https://github.com/sagemath/sage/issues/12340",
    "user": "https://github.com/williamstein"
}
```

```
sage: search_src('polymake')
```
reveals many tests marked `# optional: needs polymake`.
These will *NOT* get run by doing

```
sage -t -only_optional=polymake geometry/polytope.py
```

They should be formatted as

```
#optional - polymake
```

By the way, this test works fine without polymake is installed, because it doesn't do anything, so improve that by adding another test right after this that actually exercise the optional package.

```
sage: P = polymake.convex_hull([[1,0,0,0], [1,0,0,1], [1,0,1,0], [1,0,1,1],  [1,1,0,0], [1,1,0,1], [1,1,1,0], [1,1,1,1]])
```


Assignee: **@sagetrac-mvngu**

Keywords: **sd40.5**

Reviewer: **Mike Hansen**

Author: **Benjamin Jones**

Merged: **sage-5.1.beta3**

_Issue created by migration from https://trac.sagemath.org/ticket/12340_





---

archive/issue_events_153828.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-21T21:36:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153828"
}
```



---

archive/issue_events_153829.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-21T21:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153829"
}
```



---

archive/issue_events_153830.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-21T21:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153830"
}
```



---

archive/issue_events_153831.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-21T21:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153831"
}
```



---

archive/issue_comments_136561.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nBy the way, this code is from my commit 271, i.e., ancient history, before there was an infrastructure for how optional package tests worked.  But it would be good to update this.",
    "created_at": "2012-01-21T21:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136561",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:1" align="right">Comment 1</div>

By the way, this code is from my commit 271, i.e., ancient history, before there was an infrastructure for how optional package tests worked.  But it would be good to update this.



---

archive/issue_comments_136562.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI'm working on this, looks like polymake appears in `geometry/polytope.py`, `rings/polynomial/groebner_fan.py`, and `rings/polynomial/multi_polynomial.pyx`.",
    "created_at": "2012-05-26T03:48:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136562",
    "user": "https://github.com/benjaminfjones"
}
```

<div id="comment:2" align="right">Comment 2</div>

I'm working on this, looks like polymake appears in `geometry/polytope.py`, `rings/polynomial/groebner_fan.py`, and `rings/polynomial/multi_polynomial.pyx`.



---

archive/issue_comments_136563.json:
```json
{
    "body": "Attachment: **[trac_12340.patch.gz](https://github.com/sagemath/sage/files/ticket12340/trac_12340.patch.gz)**\n\nmark doctests requiring polymake correctly",
    "created_at": "2012-05-26T06:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136563",
    "user": "https://github.com/benjaminfjones"
}
```

Attachment: **[trac_12340.patch.gz](https://github.com/sagemath/sage/files/ticket12340/trac_12340.patch.gz)**

mark doctests requiring polymake correctly



---

archive/issue_events_153832.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-05-26T06:45:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153832"
}
```



---

archive/issue_comments_136564.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI could add doctests to a bunch of functions here, but I can't get the the polymake spkg to build on pretty much any platform, see #5488. But in the meantime, the attached patch corrects the optional doctests.",
    "created_at": "2012-05-26T06:45:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136564",
    "user": "https://github.com/benjaminfjones"
}
```

<div id="comment:3" align="right">Comment 3</div>

I could add doctests to a bunch of functions here, but I can't get the the polymake spkg to build on pretty much any platform, see #5488. But in the meantime, the attached patch corrects the optional doctests.



---

archive/issue_comments_136565.json:
```json
{
    "body": "Reviewer: **Mike Hansen**",
    "created_at": "2012-05-27T23:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136565",
    "user": "https://github.com/mwhansen"
}
```

Reviewer: **Mike Hansen**



---

archive/issue_comments_136566.json:
```json
{
    "body": "Author: **Benjamin Jones**",
    "created_at": "2012-05-27T23:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136566",
    "user": "https://github.com/mwhansen"
}
```

Author: **Benjamin Jones**



---

archive/issue_comments_136567.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nLooks good to me.",
    "created_at": "2012-05-27T23:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136567",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:4" align="right">Comment 4</div>

Looks good to me.



---

archive/issue_events_153833.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2012-05-27T23:09:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153833"
}
```



---

archive/issue_events_153834.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2012-05-27T23:09:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153834"
}
```



---

archive/issue_comments_136568.json:
```json
{
    "body": "Changed keywords from none to **sd40.5**",
    "created_at": "2012-05-27T23:13:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136568",
    "user": "https://github.com/mwhansen"
}
```

Changed keywords from none to **sd40.5**



---

archive/issue_events_153835.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-05T06:45:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153835"
}
```



---

archive/issue_events_153836.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-05T06:45:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12340#event-153836"
}
```



---

archive/issue_comments_136569.json:
```json
{
    "body": "Merged: **sage-5.1.beta3**",
    "created_at": "2012-06-05T06:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12340#issuecomment-136569",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta3**
