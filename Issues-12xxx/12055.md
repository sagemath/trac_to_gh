# Issue 12055: Upgrade PALP

archive/issues_011883.json:
```json
{
    "body": "This ticket is about upgrading to PALP-2.0. \n\nThe new spkg builds PALP multiple times with different values for the maximal dimension `POLY_Dmax`. This is useful because we want high dimension limits to be general but some features only work with particular low dimension limits, for example the 4-d Hodge database requires PALP to be built with `PALP_Dmax=4`.\n\n**spkg** superseded by #7071 (which provides palp-2.0.p1.spkg)\n\n**Apply** [attachment:trac-12055-SAGELOCAL_BIN.patch] to the SAGE_LOCAL/bin repository. \n\nAssignee: @aghitza\n\nCC:  @novoselt @kiwifb\n\nReviewer: Andrey Novoseltsev, Jeroen Demeyer, R. Andrew Ohana\n\nAuthor: Volker Braun\n\nMerged: sage-5.0.beta7\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12055\n\n",
    "closed_at": "2012-03-04T21:19:10Z",
    "created_at": "2011-11-19T15:51:59Z",
    "labels": [
        "component: algebraic geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Upgrade PALP",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12055",
    "user": "https://github.com/vbraun"
}
```
This ticket is about upgrading to PALP-2.0. 

The new spkg builds PALP multiple times with different values for the maximal dimension `POLY_Dmax`. This is useful because we want high dimension limits to be general but some features only work with particular low dimension limits, for example the 4-d Hodge database requires PALP to be built with `PALP_Dmax=4`.

**spkg** superseded by #7071 (which provides palp-2.0.p1.spkg)

**Apply** [attachment:trac-12055-SAGELOCAL_BIN.patch] to the SAGE_LOCAL/bin repository. 

Assignee: @aghitza

CC:  @novoselt @kiwifb

Reviewer: Andrey Novoseltsev, Jeroen Demeyer, R. Andrew Ohana

Author: Volker Braun

Merged: sage-5.0.beta7

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12055





---

archive/issue_comments_135825.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-11-19T16:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135825",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135826.json:
```json
{
    "body": "<a id='comment:3'></a>Looks good to me and seems to work fine! Just a couple of comments on spkg-install:\n\nLine 3: \"the the\"\n\nLines 34 and 45: since there is now mori.x application, perhaps it should be added?",
    "created_at": "2011-11-20T01:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135826",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>Looks good to me and seems to work fine! Just a couple of comments on spkg-install:

Line 3: "the the"

Lines 34 and 45: since there is now mori.x application, perhaps it should be added?



---

archive/issue_comments_135827.json:
```json
{
    "body": "<a id='comment:4'></a>I don't foresee any use of mori.x in Sage, what we already have in the toric geometry package is more general (e.g. the fan need not be simplicial to compute the Kahler cone, plus no dimension/number of ray restrictions). Max's students implemented a expect interface to Singular in C to compute the Stanley-Reisner ideal, but Sage has libSingular. Though I guess we might just as well install it since it is built by default. I've updated the spkg accordingly.",
    "created_at": "2011-11-20T11:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135827",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>I don't foresee any use of mori.x in Sage, what we already have in the toric geometry package is more general (e.g. the fan need not be simplicial to compute the Kahler cone, plus no dimension/number of ray restrictions). Max's students implemented a expect interface to Singular in C to compute the Stanley-Reisner ideal, but Sage has libSingular. Though I guess we might just as well install it since it is built by default. I've updated the spkg accordingly.



---

archive/issue_comments_135828.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-20T22:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135828",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_135829.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-11-22T14:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135829",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_135830.json:
```json
{
    "body": "<a id='comment:6'></a>Could this have caused\n\n```\nThe following tests failed:\n\n        sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py # 94 doctests failed\n        sage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py # 18 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 1317.4 seconds\n```\n\nJust a few examples of the failures:\n\n```\nsage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py\n**********************************************************************\nFile \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/geometry/lattice_polytope.py\", line 4347:\n    sage: print s\nExpected:\n    M:27 8 N:7 6  codim=2 #part=5\n     P:0 V:2 4 5       0sec  0cpu\n     P:2 V:3 4 5       0sec  0cpu\n     P:3 V:4 5       0sec  0cpu\n    np=3 d:1 p:1    0sec     0cpu\nGot:\n    M:27 8 N:7 6  codim=2 #part=0\n    np=0 d:0 p:0    0sec     0cpu\n    <BLANKLINE>\n**********************************************************************\nFile \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/geometry/lattice_polytope.py\", line 4353:\n    sage: lattice_polytope._read_nef_x_partitions(s)\nExpected:\n    [[2, 4, 5], [3, 4, 5], [4, 5]]\nGot:\n    []\n**********************************************************************\nsage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py\n**********************************************************************\nFile \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/schemes/generic/fano_toric_variety.py\", line 1098:\n    sage: np = p.nef_partitions()[1]\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_13[3]>\", line 1, in <module>\n        np = p.nef_partitions()[Integer(1)]###line 1098:\n    sage: np = p.nef_partitions()[1]\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py\", line 2128, in nef_partitions\n        self._read_nef_partitions(self.nef_x(keys))\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py\", line 2162, in nef_x\n        return self._palp(\"nef.x -f \" + keys)\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py\", line 991, in _palp\n        fn = _palp(command, [self], reduce_dimension)\n      File \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py\", line 4322, in _palp\n        + \"\\nOutput:\\n%s\") % (command, err)\n    RuntimeError: Error executing \"nef.x -f -N -V -D -P -p\" for a polytope sequence!\n    Output:\n    nef.x: Nefpart.c:551: Initial_Conditions: Assertion `(_Y[0].X[0][0] == 1) || (_Y[0].X[0][0] == -1)' failed.\n    Aborted\n\n**********************************************************************\n```",
    "created_at": "2011-11-22T14:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135830",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Could this have caused

```
The following tests failed:

        sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py # 94 doctests failed
        sage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py # 18 doctests failed
----------------------------------------------------------------------
Total time for all tests: 1317.4 seconds
```

Just a few examples of the failures:

```
sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/geometry/lattice_polytope.py", line 4347:
    sage: print s
Expected:
    M:27 8 N:7 6  codim=2 #part=5
     P:0 V:2 4 5       0sec  0cpu
     P:2 V:3 4 5       0sec  0cpu
     P:3 V:4 5       0sec  0cpu
    np=3 d:1 p:1    0sec     0cpu
Got:
    M:27 8 N:7 6  codim=2 #part=0
    np=0 d:0 p:0    0sec     0cpu
    <BLANKLINE>
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/geometry/lattice_polytope.py", line 4353:
    sage: lattice_polytope._read_nef_x_partitions(s)
Expected:
    [[2, 4, 5], [3, 4, 5], [4, 5]]
Got:
    []
**********************************************************************
sage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-xyzzy/sage/schemes/generic/fano_toric_variety.py", line 1098:
    sage: np = p.nef_partitions()[1]
Exception raised:
    Traceback (most recent call last):
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_13[3]>", line 1, in <module>
        np = p.nef_partitions()[Integer(1)]###line 1098:
    sage: np = p.nef_partitions()[1]
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py", line 2128, in nef_partitions
        self._read_nef_partitions(self.nef_x(keys))
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py", line 2162, in nef_x
        return self._palp("nef.x -f " + keys)
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py", line 991, in _palp
        fn = _palp(command, [self], reduce_dimension)
      File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/local/lib/python/site-packages/sage/geometry/lattice_polytope.py", line 4322, in _palp
        + "\nOutput:\n%s") % (command, err)
    RuntimeError: Error executing "nef.x -f -N -V -D -P -p" for a polytope sequence!
    Output:
    nef.x: Nefpart.c:551: Initial_Conditions: Assertion `(_Y[0].X[0][0] == 1) || (_Y[0].X[0][0] == -1)' failed.
    Aborted

**********************************************************************
```



---

archive/issue_comments_135831.json:
```json
{
    "body": "<a id='comment:7'></a>I have done the following: unpack sage-4.8.alpha1.tar, remove old PALP package from standard and add Volker's new one. Then run make ptestlong and I didn't see any failures...",
    "created_at": "2011-11-22T14:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135831",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:7'></a>I have done the following: unpack sage-4.8.alpha1.tar, remove old PALP package from standard and add Volker's new one. Then run make ptestlong and I didn't see any failures...



---

archive/issue_comments_135832.json:
```json
{
    "body": "<a id='comment:8'></a>In particular the very first error shows that PALP just does not work correctly anymore, i.e. it is not some kind of an ordering/parsing issue.\n\nI have just rerun tests on `lattice_polytope` separately - they still pass.\n\nCan it be some kind of a platform issue that prevents new version of PALP from building? The package install script is quite simple and seems to do all it is trying to do just fine.",
    "created_at": "2011-11-22T15:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135832",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>In particular the very first error shows that PALP just does not work correctly anymore, i.e. it is not some kind of an ordering/parsing issue.

I have just rerun tests on `lattice_polytope` separately - they still pass.

Can it be some kind of a platform issue that prevents new version of PALP from building? The package install script is quite simple and seems to do all it is trying to do just fine.



---

archive/issue_comments_135833.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2011-11-22T15:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135833",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_135834.json:
```json
{
    "body": "<a id='comment:9'></a>Jeroen, this is again on sage.math, right? It does work for me on sage.math:\n\n```\nvbraun@sage:~/Sage/sage-4.8.alpha2$ ./sage -t --long devel/sage/sage/geometry/lattice_polytope.py \nsage -t --long \"devel/sage/sage/geometry/lattice_polytope.py\"\n\t [52.5 s]\nvbraun@sage:~/Sage/sage-4.8.alpha2$ ./sage -t --long devel/sage/sage/schemes/generic/fano_toric_variety.py \nsage -t --long \"devel/sage/sage/schemes/generic/fano_toric_variety.py\"\n\t [22.9 s]\n```\nGiven the mysterious (at least to me) build failure for R, did you get any other strange errors while testing? It could be a hardware problem. But if R and PALP are the only two issues then its unlikely that I would be on both tickets....",
    "created_at": "2011-11-22T15:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135834",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>Jeroen, this is again on sage.math, right? It does work for me on sage.math:

```
vbraun@sage:~/Sage/sage-4.8.alpha2$ ./sage -t --long devel/sage/sage/geometry/lattice_polytope.py 
sage -t --long "devel/sage/sage/geometry/lattice_polytope.py"
	 [52.5 s]
vbraun@sage:~/Sage/sage-4.8.alpha2$ ./sage -t --long devel/sage/sage/schemes/generic/fano_toric_variety.py 
sage -t --long "devel/sage/sage/schemes/generic/fano_toric_variety.py"
	 [22.9 s]
```
Given the mysterious (at least to me) build failure for R, did you get any other strange errors while testing? It could be a hardware problem. But if R and PALP are the only two issues then its unlikely that I would be on both tickets....



---

archive/issue_comments_135835.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 vbraun]:\n> Jeroen, this is again on sage.math, right?\n\nYes.\n\n> Given the mysterious (at least to me) build failure for R, did you get any other strange errors while testing?\n\nNo, only the lattice polytope stuff.  Of course it could be a build failure for PALP, that PALP somehow miscompiled.\n\n> It could be a hardware problem.\n\nThen other people on sage.math would find problems.\n\n> But if R and PALP are the only two issues then its unlikely that I would be on both tickets....\n\n??? I don't understand what you mean here.\n\nBut yes, R and PALP were the only two issues.",
    "created_at": "2011-11-22T15:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135835",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:9 vbraun]:
> Jeroen, this is again on sage.math, right?

Yes.

> Given the mysterious (at least to me) build failure for R, did you get any other strange errors while testing?

No, only the lattice polytope stuff.  Of course it could be a build failure for PALP, that PALP somehow miscompiled.

> It could be a hardware problem.

Then other people on sage.math would find problems.

> But if R and PALP are the only two issues then its unlikely that I would be on both tickets....

??? I don't understand what you mean here.

But yes, R and PALP were the only two issues.



---

archive/issue_comments_135836.json:
```json
{
    "body": "<a id='comment:11'></a>I am now building sage-4.8.alpha2 with *only* the new R and PALP packages, no other changes.  I will report back later.",
    "created_at": "2011-11-22T16:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135836",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>I am now building sage-4.8.alpha2 with *only* the new R and PALP packages, no other changes.  I will report back later.



---

archive/issue_comments_135837.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 jdemeyer]:\n> I am now building sage-4.8.alpha2 with *only* the new R and PALP packages, no other changes.\n\n\nIt works now...\n\nHowever, the new PALP adds many files in `SAGE_ROOT/local/bin` which should be added to `.hgignore`:\n\n```\n? class-11d.x\n? class-4d.x\n? class-5d.x\n? class-6d.x\n? cws-11d.x\n? cws-4d.x\n? cws-5d.x\n? cws-6d.x\n? mori-11d.x\n? mori-4d.x\n? mori-5d.x\n? mori-6d.x\n? mori.x\n? nef-11d.x\n? nef-4d.x\n? nef-5d.x\n? nef-6d.x\n? poly-11d.x\n? poly-4d.x\n? poly-5d.x\n? poly-6d.x\n```",
    "created_at": "2011-11-23T20:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135837",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:11 jdemeyer]:
> I am now building sage-4.8.alpha2 with *only* the new R and PALP packages, no other changes.


It works now...

However, the new PALP adds many files in `SAGE_ROOT/local/bin` which should be added to `.hgignore`:

```
? class-11d.x
? class-4d.x
? class-5d.x
? class-6d.x
? cws-11d.x
? cws-4d.x
? cws-5d.x
? cws-6d.x
? mori-11d.x
? mori-4d.x
? mori-5d.x
? mori-6d.x
? mori.x
? nef-11d.x
? nef-4d.x
? nef-5d.x
? nef-6d.x
? poly-11d.x
? poly-4d.x
? poly-5d.x
? poly-6d.x
```



---

archive/issue_comments_135838.json:
```json
{
    "body": "<a id='comment:13'></a>Also, could you change the following permissions in the spkg (they would better be 0755):\n\n```\n445673875    0 drwx------   4 jdemeyer jdemeyer      140 Nov 20 11:02 .\n445673877    0 drwx------   2 jdemeyer jdemeyer      600 Jul  1 17:25 ./src\n```",
    "created_at": "2011-11-23T21:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135838",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Also, could you change the following permissions in the spkg (they would better be 0755):

```
445673875    0 drwx------   4 jdemeyer jdemeyer      140 Nov 20 11:02 .
445673877    0 drwx------   2 jdemeyer jdemeyer      600 Jul  1 17:25 ./src
```



---

archive/issue_comments_135839.json:
```json
{
    "body": "Initial patch, for SAGE_LOCAL/bin",
    "created_at": "2011-11-24T12:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135839",
    "user": "https://github.com/vbraun"
}
```

Initial patch, for SAGE_LOCAL/bin



---

archive/issue_comments_135840.json:
```json
{
    "body": "<a id='comment:14'></a>Attachment [trac-12055-SAGELOCAL_BIN.patch](tarball://root/attachments/some-uuid/ticket12055/trac-12055-SAGELOCAL_BIN.patch) by @vbraun created at 2011-11-24 12:14:15\n\nThe permissions are fine here:\n\n```\n[vbraun@volker-desktop r-2.14.0.p0]$ ll\ntotal 164\ndrwxr-xr-x.  2 vbraun vbraun   4096 Nov 19 22:09 patches\n-rw-r--r--.  1 vbraun vbraun 135549 Dec 27  2009 rpy2-2.0.8.spkg\n-rwxr-xr-x.  1 vbraun vbraun    220 Jan 26  2008 spkg-check\n-rwxr-xr-x.  1 vbraun vbraun   7097 Sep 25  2010 spkg-install\n-rw-r--r--.  1 vbraun vbraun   4720 Nov 23 11:32 SPKG.txt\ndrwxr-xr-x. 10 vbraun vbraun   4096 Oct 31 08:08 src\n[vbraun@volker-desktop r-2.14.0.p0]$ umask\n0002\n```\nJeroen, can you check your umask / mount point options?",
    "created_at": "2011-11-24T12:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135840",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>Attachment [trac-12055-SAGELOCAL_BIN.patch](tarball://root/attachments/some-uuid/ticket12055/trac-12055-SAGELOCAL_BIN.patch) by @vbraun created at 2011-11-24 12:14:15

The permissions are fine here:

```
[vbraun@volker-desktop r-2.14.0.p0]$ ll
total 164
drwxr-xr-x.  2 vbraun vbraun   4096 Nov 19 22:09 patches
-rw-r--r--.  1 vbraun vbraun 135549 Dec 27  2009 rpy2-2.0.8.spkg
-rwxr-xr-x.  1 vbraun vbraun    220 Jan 26  2008 spkg-check
-rwxr-xr-x.  1 vbraun vbraun   7097 Sep 25  2010 spkg-install
-rw-r--r--.  1 vbraun vbraun   4720 Nov 23 11:32 SPKG.txt
drwxr-xr-x. 10 vbraun vbraun   4096 Oct 31 08:08 src
[vbraun@volker-desktop r-2.14.0.p0]$ umask
0002
```
Jeroen, can you check your umask / mount point options?



---

archive/issue_comments_135841.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-11-24T12:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135841",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_135842.json:
```json
{
    "body": "<a id='comment:15'></a>This is about PALP, not R.",
    "created_at": "2011-11-24T12:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135842",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>This is about PALP, not R.



---

archive/issue_comments_135843.json:
```json
{
    "body": "<a id='comment:16'></a>Uh-oh too early in the morning %-)\n\nFixed in the new spkg (same location)",
    "created_at": "2011-11-24T12:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135843",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>Uh-oh too early in the morning %-)

Fixed in the new spkg (same location)



---

archive/issue_comments_135844.json:
```json
{
    "body": "<a id='comment:17'></a>positive review",
    "created_at": "2011-11-29T10:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135844",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>positive review



---

archive/issue_events_032001.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-29T10:03:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32001"
}
```



---

archive/issue_comments_135845.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-29T10:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135845",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_135846.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-11-29T18:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135846",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_032002.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-29T18:05:04Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32002"
}
```



---

archive/issue_comments_135847.json:
```json
{
    "body": "<a id='comment:18'></a>I think there is something wrong with the PALP spkg.  I tried merging sage-4.8.alpha3 again with this ticket.  Even though it might have succeeded a few times, I now got essentially the same error as before:\n\n```\nsage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py\n**********************************************************************\nFile \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-main/sage/geometry/lattice_polytope.py\", line 4347:\n    sage: print s\nExpected:\n    M:27 8 N:7 6  codim=2 #part=5\n     P:0 V:2 4 5       0sec  0cpu\n     P:2 V:3 4 5       0sec  0cpu\n     P:3 V:4 5       0sec  0cpu\n    np=3 d:1 p:1    0sec     0cpu\nGot:\n    M:27 8 N:7 6  codim=2 #part=0\n    np=0 d:0 p:0    0sec     0cpu\n    <BLANKLINE>\n**********************************************************************\nFile \"/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-main/sage/geometry/lattice_polytope.py\", line 4353:\n    sage: lattice_polytope._read_nef_x_partitions(s)\nExpected:\n    [[2, 4, 5], [3, 4, 5], [4, 5]]\nGot:\n    []\n**********************************************************************\n...\nThe following tests failed:\n\n        sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py # 94 doctests failed\n        sage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py # 18 doctests failed\n----------------------------------------------------------------------\n```\n\nI'm attaching my palp log file, even though I don't see anything suspicious.",
    "created_at": "2011-11-29T18:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135847",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>I think there is something wrong with the PALP spkg.  I tried merging sage-4.8.alpha3 again with this ticket.  Even though it might have succeeded a few times, I now got essentially the same error as before:

```
sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-main/sage/geometry/lattice_polytope.py", line 4347:
    sage: print s
Expected:
    M:27 8 N:7 6  codim=2 #part=5
     P:0 V:2 4 5       0sec  0cpu
     P:2 V:3 4 5       0sec  0cpu
     P:3 V:4 5       0sec  0cpu
    np=3 d:1 p:1    0sec     0cpu
Got:
    M:27 8 N:7 6  codim=2 #part=0
    np=0 d:0 p:0    0sec     0cpu
    <BLANKLINE>
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.alpha3/devel/sage-main/sage/geometry/lattice_polytope.py", line 4353:
    sage: lattice_polytope._read_nef_x_partitions(s)
Expected:
    [[2, 4, 5], [3, 4, 5], [4, 5]]
Got:
    []
**********************************************************************
...
The following tests failed:

        sage -t  -force_lib devel/sage/sage/geometry/lattice_polytope.py # 94 doctests failed
        sage -t  -force_lib devel/sage/sage/schemes/generic/fano_toric_variety.py # 18 doctests failed
----------------------------------------------------------------------
```

I'm attaching my palp log file, even though I don't see anything suspicious.



---

archive/issue_comments_135848.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-11-29T18:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135848",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_135849.json:
```json
{
    "body": "<a id='comment:19'></a>Jeroen, are you using a different compiler than /usr/bin/gcc? Or perhaps some funky CFLAGS? Our binaries are not the same on sage.math, so something is fishy here:\n\n```\nvbraun@sage:~/Sage$ ll /mnt/usb1/scratch/jdemeyer/sage*/local/bin/nef-6d.x\n-rwxr-xr-x 1 jdemeyer jdemeyer 1112924 2011-11-29 10:23 /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x\nvbraun@sage:~/Sage$ ll /home/vbraun/Sage/sage-4.8.alpha2/local/bin/nef-6d.x\n-rwxr-xr-x 1 vbraun vbraun 1016813 2011-11-29 11:22 /home/vbraun/Sage/sage-4.8.alpha2/local/bin/nef-6d.x\n```\nWhen I run my version in valgrind I get no errors, but when I run your version in valgrind I get lots of uninitialized variable errors:\n\n```\n\nvbraun@sage:~/Sage$ ~/Sage/valgrind/valgrind-3.7.0/vg-in-place /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x -N -f -p < /tmp/palp_in \n==9884== Memcheck, a memory error detector\n==9884== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.\n==9884== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info\n==9884== Command: /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x -N -f -p\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x43A0A6: part_nef (Nefpart.c:569)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x40EE3A: GLZ_Make_Trian_NF (Polynf.c:142)\n==9884==    by 0x439CF1: part_nef (Nefpart.c:818)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x40EE87: GLZ_Make_Trian_NF (Polynf.c:145)\n==9884==    by 0x439CF1: part_nef (Nefpart.c:818)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x40F0A7: GLZ_Make_Trian_NF (Polynf.c:159)\n==9884==    by 0x439CF1: part_nef (Nefpart.c:818)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x40F300: GLZ_Make_Trian_NF (Polynf.c:166)\n==9884==    by 0x439CF1: part_nef (Nefpart.c:818)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x4389A1: Initial_Conditions (Nefpart.c:551)\n==9884==    by 0x439D88: part_nef (Nefpart.c:820)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x4389FC: Initial_Conditions (Nefpart.c:551)\n==9884==    by 0x439D88: part_nef (Nefpart.c:820)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x439143: Select_Sv (Nefpart.c:733)\n==9884==    by 0x439DD9: part_nef (Nefpart.c:821)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \n==9884== Conditional jump or move depends on uninitialised value(s)\n==9884==    at 0x4391C9: Select_Sv (Nefpart.c:469)\n==9884==    by 0x439DD9: part_nef (Nefpart.c:821)\n==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)\n==9884==    by 0x402AEF: main (nef.c:294)\n==9884== \nM:27 8 N:7 6  codim=2 #part=0\nnp=0 d:0 p:0    0sec     0cpu\n==9884== \n==9884== HEAP SUMMARY:\n==9884==     in use at exit: 0 bytes in 0 blocks\n==9884==   total heap usage: 42 allocs, 42 frees, 543,330,152 bytes allocated\n==9884== \n==9884== All heap blocks were freed -- no leaks are possible\n==9884== \n==9884== For counts of detected and suppressed errors, rerun with: -v\n==9884== Use --track-origins=yes to see where uninitialised values come from\n==9884== ERROR SUMMARY: 1367 errors from 9 contexts (suppressed: 2 from 2)\n```",
    "created_at": "2011-11-29T19:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135849",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'></a>Jeroen, are you using a different compiler than /usr/bin/gcc? Or perhaps some funky CFLAGS? Our binaries are not the same on sage.math, so something is fishy here:

```
vbraun@sage:~/Sage$ ll /mnt/usb1/scratch/jdemeyer/sage*/local/bin/nef-6d.x
-rwxr-xr-x 1 jdemeyer jdemeyer 1112924 2011-11-29 10:23 /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x
vbraun@sage:~/Sage$ ll /home/vbraun/Sage/sage-4.8.alpha2/local/bin/nef-6d.x
-rwxr-xr-x 1 vbraun vbraun 1016813 2011-11-29 11:22 /home/vbraun/Sage/sage-4.8.alpha2/local/bin/nef-6d.x
```
When I run my version in valgrind I get no errors, but when I run your version in valgrind I get lots of uninitialized variable errors:

```

vbraun@sage:~/Sage$ ~/Sage/valgrind/valgrind-3.7.0/vg-in-place /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x -N -f -p < /tmp/palp_in 
==9884== Memcheck, a memory error detector
==9884== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==9884== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==9884== Command: /mnt/usb1/scratch/jdemeyer/sage-4.8.alpha3_PALP_failure/local/bin/nef-6d.x -N -f -p
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x43A0A6: part_nef (Nefpart.c:569)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x40EE3A: GLZ_Make_Trian_NF (Polynf.c:142)
==9884==    by 0x439CF1: part_nef (Nefpart.c:818)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x40EE87: GLZ_Make_Trian_NF (Polynf.c:145)
==9884==    by 0x439CF1: part_nef (Nefpart.c:818)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x40F0A7: GLZ_Make_Trian_NF (Polynf.c:159)
==9884==    by 0x439CF1: part_nef (Nefpart.c:818)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x40F300: GLZ_Make_Trian_NF (Polynf.c:166)
==9884==    by 0x439CF1: part_nef (Nefpart.c:818)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x4389A1: Initial_Conditions (Nefpart.c:551)
==9884==    by 0x439D88: part_nef (Nefpart.c:820)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x4389FC: Initial_Conditions (Nefpart.c:551)
==9884==    by 0x439D88: part_nef (Nefpart.c:820)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x439143: Select_Sv (Nefpart.c:733)
==9884==    by 0x439DD9: part_nef (Nefpart.c:821)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
==9884== Conditional jump or move depends on uninitialised value(s)
==9884==    at 0x4391C9: Select_Sv (Nefpart.c:469)
==9884==    by 0x439DD9: part_nef (Nefpart.c:821)
==9884==    by 0x43557A: Make_E_Poly (E_Poly.c:1266)
==9884==    by 0x402AEF: main (nef.c:294)
==9884== 
M:27 8 N:7 6  codim=2 #part=0
np=0 d:0 p:0    0sec     0cpu
==9884== 
==9884== HEAP SUMMARY:
==9884==     in use at exit: 0 bytes in 0 blocks
==9884==   total heap usage: 42 allocs, 42 frees, 543,330,152 bytes allocated
==9884== 
==9884== All heap blocks were freed -- no leaks are possible
==9884== 
==9884== For counts of detected and suppressed errors, rerun with: -v
==9884== Use --track-origins=yes to see where uninitialised values come from
==9884== ERROR SUMMARY: 1367 errors from 9 contexts (suppressed: 2 from 2)
```



---

archive/issue_comments_135850.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 vbraun]:\n> Jeroen, are you using a different compiler than /usr/bin/gcc?\n\nYes, I am using gcc 4.5.1 (compiled myself, `/home/jdemeyer/local/bin/gcc`).  Default `CFLAGS`.\n\nBut I also realized that I **have** compiled and tested PALP successfully before, so the problem is not always reproducible.  Could there be a race condition in the `spkg-install` or `Makefile`?",
    "created_at": "2011-11-29T19:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135850",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>Replying to [comment:19 vbraun]:
> Jeroen, are you using a different compiler than /usr/bin/gcc?

Yes, I am using gcc 4.5.1 (compiled myself, `/home/jdemeyer/local/bin/gcc`).  Default `CFLAGS`.

But I also realized that I **have** compiled and tested PALP successfully before, so the problem is not always reproducible.  Could there be a race condition in the `spkg-install` or `Makefile`?



---

archive/issue_comments_135851.json:
```json
{
    "body": "<a id='comment:21'></a>Actually, never mind the gcc version, I did use gcc 4.2.4, see also the log I posted.  My merger script uses a default `PATH`.",
    "created_at": "2011-11-29T19:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135851",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Actually, never mind the gcc version, I did use gcc 4.2.4, see also the log I posted.  My merger script uses a default `PATH`.



---

archive/issue_comments_135852.json:
```json
{
    "body": "<a id='comment:22'></a>This is interesting: when built in parallel, I do **not** get the error anymore.  So it is some kind of reverse race condition.\n\nCould you try simply installing palp serially from a working Sage:\n\n```\n./sage -f spkg/standard/palp-2.0.p0.spkg\n```\nAnd then doing\n\n```\n./sage -t devel/sage/sage/geometry/lattice_polytope.py\n```",
    "created_at": "2011-11-29T19:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135852",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>This is interesting: when built in parallel, I do **not** get the error anymore.  So it is some kind of reverse race condition.

Could you try simply installing palp serially from a working Sage:

```
./sage -f spkg/standard/palp-2.0.p0.spkg
```
And then doing

```
./sage -t devel/sage/sage/geometry/lattice_polytope.py
```



---

archive/issue_comments_135853.json:
```json
{
    "body": "<a id='comment:23'></a>Something else: your `make` in `spkg-install` should probably be `$MAKE`.",
    "created_at": "2011-11-29T19:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135853",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Something else: your `make` in `spkg-install` should probably be `$MAKE`.



---

archive/issue_comments_135854.json:
```json
{
    "body": "<a id='comment:24'></a>I think I got it: Sage.math runs ext3 which has a 1-second timestamp granularity. My new does compile - monkeypatch - recompile in a loop. If you have a reasonably fast disk like /mnt/usb1/scratch then you can do the patch step in less than a second, so make fails to see that anything changed. Whereas I compiled sage on /home which is might be a higher-latency disk since its shared with lots of people. Or use ext4 with nanosecond timestamps on my own computers.",
    "created_at": "2011-11-29T20:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135854",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>I think I got it: Sage.math runs ext3 which has a 1-second timestamp granularity. My new does compile - monkeypatch - recompile in a loop. If you have a reasonably fast disk like /mnt/usb1/scratch then you can do the patch step in less than a second, so make fails to see that anything changed. Whereas I compiled sage on /home which is might be a higher-latency disk since its shared with lots of people. Or use ext4 with nanosecond timestamps on my own computers.



---

archive/issue_comments_135855.json:
```json
{
    "body": "<a id='comment:25'></a>I've replaced the palp spkg with a new version that does a make clean in-between each recompile loop. I'm pretty confident that it fixes the problem. Can you try it? \n\nI also just tripped over the fact that sage -f will happily use the old cached spkg, so make sure to delete the cached old version.",
    "created_at": "2011-11-29T20:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135855",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>I've replaced the palp spkg with a new version that does a make clean in-between each recompile loop. I'm pretty confident that it fixes the problem. Can you try it? 

I also just tripped over the fact that sage -f will happily use the old cached spkg, so make sure to delete the cached old version.



---

archive/issue_comments_135856.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-11-29T20:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135856",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135857.json:
```json
{
    "body": "<a id='comment:26'></a>I'm wondering about the portability of \"install\", the previous version used \"cp\".  I think it would be safer to install using \"cp -p\".",
    "created_at": "2011-11-30T08:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135857",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>I'm wondering about the portability of "install", the previous version used "cp".  I think it would be safer to install using "cp -p".



---

archive/issue_comments_135858.json:
```json
{
    "body": "<a id='comment:27'></a>Well \"install\" works on Sparc solaris with is generally the yardstick for how weird systems we support ;-) I think that install is a better choice because\n* its designed for the job\n* cp -p might preserve ACLs or other extended attributes which you don't want (not the GNU coreutils, mind you)\n* autotools use it, probably for a reason",
    "created_at": "2011-11-30T09:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135858",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>Well "install" works on Sparc solaris with is generally the yardstick for how weird systems we support ;-) I think that install is a better choice because
* its designed for the job
* cp -p might preserve ACLs or other extended attributes which you don't want (not the GNU coreutils, mind you)
* autotools use it, probably for a reason



---

archive/issue_comments_135859.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 vbraun]:\n> Well \"install\" works on Sparc solaris with is generally the yardstick for how weird systems we support ;-)\n\nIt actually doesn't on `hawk`.  True, the command `install` exists, but it certainly does no do what you want:\n\n```\nuname -a:\nSunOS hawk 5.11 snv_134 i86pc i386 i86pc\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/local/gcc-4.5.0/libexec/gcc/i386-pc-solaris2.10/4.5.0/lto-wrapper\nTarget: i386-pc-solaris2.10\nConfigured with: ../gcc-4.5.0/configure --prefix=/usr/local/gcc-4.5.0 --build=i386-pc-solaris2.10 --enable-languages=c,c++,fortran --with-\ngmp=/usr/local/gcc-4.5.0 --with-mpfr=/usr/local/gcc-4.5.0 --disable-nls --enable-checking=release --enable-werror=no --enable-multilib -wi\nth-system-zlib --enable-bootstrap --with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld\nThread model: posix\ngcc version 4.5.0 (GCC)\n****************************************************\nBuilding PALP optimized for 4 dimensions\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o poly.o poly.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Coord.o Coord.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Rat.o Rat.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Vertex.o Vertex.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Polynf.o Polynf.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o LG.o LG.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o class.o class.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subpoly.o Subpoly.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subadd.o Subadd.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subdb.o Subdb.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o cws.o cws.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o nef.o nef.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o E_Poly.o E_Poly.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Nefpart.o Nefpart.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o mori.o mori.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o MoriCone.o MoriCone.c\nMoriCone.c: In function 'Compatible_Tri':\nMoriCone.c:938:76: warning: unused parameter 'p'\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o SingularInput.o SingularInput.c\nSubadd.c: In function 'Add_Polya_2_Polyi':\nSubadd.c:1111:31: warning: 'vA' may be used uninitialized in this function\nSubadd.c:1111:35: warning: 'nuA' may be used uninitialized in this function\nMoriCone.c: In function 'Triang3dSFan':\nMoriCone.c:666:25: warning: 'k' may be used uninitialized in this function\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o poly.x poly.o Coord.o Rat.o Vertex.o Polynf.o LG.o\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o class.x class.o Coord.o Rat.o Vertex.o Polynf.o Subpoly.o Subadd.o Subdb\n.o\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o cws.x cws.o Coord.o Rat.o Vertex.o Polynf.o LG.o\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o nef.x nef.o Coord.o Rat.o Vertex.o Polynf.o E_Poly.o Nefpart.o LG.o\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o mori.x mori.o Coord.o Rat.o Vertex.o Polynf.o MoriCone.o SingularInput.o\n LG.o\nfind: stat() error /export/home/buildbot/sage-4.8.alpha2/local/bin/poly-4d.x: No such file or directory\nfind: cannot read dir /etc/flash/preexit: Permission denied\nfind: cannot read dir /etc/flash/precreation: Permission denied\nfind: cannot read dir /etc/flash/postcreation: Permission denied\nfind: cannot read dir /etc/sfw/openssl/private: Permission denied\nfind: cannot read dir /etc/openssl/private: Permission denied\nfind: cannot read dir /etc/inet/secret: Permission denied\nfind: cycle detected for /lib/secure/32/\nfind: cycle detected for /lib/32/\nfind: cycle detected for /lib/crypto/32/\nfind: cycle detected for /usr/lib/lwp/32/\nfind: cycle detected for /usr/lib/32/\nfind: cycle detected for /usr/lib/link_audit/32/\nfind: cycle detected for /usr/lib/elfedit/32/\nfind: cycle detected for /usr/lib/locale/en_US.UTF-8/32/\nfind: cycle detected for /usr/lib/locale/en_US.UTF-8/LC_CTYPE/32/\nfind: cycle detected for /usr/lib/locale/en_US.UTF-8/LO_LTYPE/32/\nfind: cycle detected for /usr/lib/secure/32/\ninstall: poly.x was not found anywhere!\nError installing PALP.\n```",
    "created_at": "2011-11-30T10:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135859",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Replying to [comment:27 vbraun]:
> Well "install" works on Sparc solaris with is generally the yardstick for how weird systems we support ;-)

It actually doesn't on `hawk`.  True, the command `install` exists, but it certainly does no do what you want:

```
uname -a:
SunOS hawk 5.11 snv_134 i86pc i386 i86pc
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/local/gcc-4.5.0/libexec/gcc/i386-pc-solaris2.10/4.5.0/lto-wrapper
Target: i386-pc-solaris2.10
Configured with: ../gcc-4.5.0/configure --prefix=/usr/local/gcc-4.5.0 --build=i386-pc-solaris2.10 --enable-languages=c,c++,fortran --with-
gmp=/usr/local/gcc-4.5.0 --with-mpfr=/usr/local/gcc-4.5.0 --disable-nls --enable-checking=release --enable-werror=no --enable-multilib -wi
th-system-zlib --enable-bootstrap --with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld
Thread model: posix
gcc version 4.5.0 (GCC)
****************************************************
Building PALP optimized for 4 dimensions
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o poly.o poly.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Coord.o Coord.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Rat.o Rat.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Vertex.o Vertex.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Polynf.o Polynf.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o LG.o LG.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o class.o class.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subpoly.o Subpoly.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subadd.o Subadd.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Subdb.o Subdb.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o cws.o cws.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o nef.o nef.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o E_Poly.o E_Poly.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Nefpart.o Nefpart.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o mori.o mori.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o MoriCone.o MoriCone.c
MoriCone.c: In function 'Compatible_Tri':
MoriCone.c:938:76: warning: unused parameter 'p'
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o SingularInput.o SingularInput.c
Subadd.c: In function 'Add_Polya_2_Polyi':
Subadd.c:1111:31: warning: 'vA' may be used uninitialized in this function
Subadd.c:1111:35: warning: 'nuA' may be used uninitialized in this function
MoriCone.c: In function 'Triang3dSFan':
MoriCone.c:666:25: warning: 'k' may be used uninitialized in this function
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o poly.x poly.o Coord.o Rat.o Vertex.o Polynf.o LG.o
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o class.x class.o Coord.o Rat.o Vertex.o Polynf.o Subpoly.o Subadd.o Subdb
.o
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o cws.x cws.o Coord.o Rat.o Vertex.o Polynf.o LG.o
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o nef.x nef.o Coord.o Rat.o Vertex.o Polynf.o E_Poly.o Nefpart.o LG.o
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -o mori.x mori.o Coord.o Rat.o Vertex.o Polynf.o MoriCone.o SingularInput.o
 LG.o
find: stat() error /export/home/buildbot/sage-4.8.alpha2/local/bin/poly-4d.x: No such file or directory
find: cannot read dir /etc/flash/preexit: Permission denied
find: cannot read dir /etc/flash/precreation: Permission denied
find: cannot read dir /etc/flash/postcreation: Permission denied
find: cannot read dir /etc/sfw/openssl/private: Permission denied
find: cannot read dir /etc/openssl/private: Permission denied
find: cannot read dir /etc/inet/secret: Permission denied
find: cycle detected for /lib/secure/32/
find: cycle detected for /lib/32/
find: cycle detected for /lib/crypto/32/
find: cycle detected for /usr/lib/lwp/32/
find: cycle detected for /usr/lib/32/
find: cycle detected for /usr/lib/link_audit/32/
find: cycle detected for /usr/lib/elfedit/32/
find: cycle detected for /usr/lib/locale/en_US.UTF-8/32/
find: cycle detected for /usr/lib/locale/en_US.UTF-8/LC_CTYPE/32/
find: cycle detected for /usr/lib/locale/en_US.UTF-8/LO_LTYPE/32/
find: cycle detected for /usr/lib/secure/32/
install: poly.x was not found anywhere!
Error installing PALP.
```



---

archive/issue_comments_135860.json:
```json
{
    "body": "<a id='comment:29'></a>Awesome! Solaris strikes again...\n\nI switched the spkg back to cp -p.",
    "created_at": "2011-11-30T10:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135860",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>Awesome! Solaris strikes again...

I switched the spkg back to cp -p.



---

archive/issue_comments_135861.json:
```json
{
    "body": "<a id='comment:30'></a>Not sure why the need for `$MV`, `$CP` and the likes (who's idea was that?), but positive_review.",
    "created_at": "2011-12-01T08:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135861",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Not sure why the need for `$MV`, `$CP` and the likes (who's idea was that?), but positive_review.



---

archive/issue_events_032003.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-01T08:13:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32003"
}
```



---

archive/issue_comments_135862.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-12-01T08:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135862",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_135863.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-12-01T09:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135863",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_135864.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-12-01T09:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135864",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_032004.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-01T09:09:08Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32004"
}
```



---

archive/issue_comments_135865.json:
```json
{
    "body": "<a id='comment:31'></a>On OS X 10.6:\n\n```\nHost system\nuname -a:\nDarwin bsd.math.washington.edu 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: i686-apple-darwin10\nConfigured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Apple Inc. build 5666) (dot 3)\n****************************************************\nBuilding PALP optimized for 4 dimensions\nmake[2]: warning: -jN forced in submake: disabling jobserver mode.\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o poly.o poly.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Coord.o Coord.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Rat.o Rat.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Vertex.o Vertex.c\ngcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Polynf.o Polynf.c\nPolynf.c: In function 'Fano5d':\nPolynf.c:2444: error: nested functions are disabled, use -fnested-functions to re-enable\nmake[2]: *** [Polynf.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nError building PALP.\n```",
    "created_at": "2011-12-01T09:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135865",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>On OS X 10.6:

```
Host system
uname -a:
Darwin bsd.math.washington.edu 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: i686-apple-darwin10
Configured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Apple Inc. build 5666) (dot 3)
****************************************************
Building PALP optimized for 4 dimensions
make[2]: warning: -jN forced in submake: disabling jobserver mode.
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o poly.o poly.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Coord.o Coord.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Rat.o Rat.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Vertex.o Vertex.c
gcc -O3 -g -W -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE   -c -o Polynf.o Polynf.c
Polynf.c: In function 'Fano5d':
Polynf.c:2444: error: nested functions are disabled, use -fnested-functions to re-enable
make[2]: *** [Polynf.o] Error 1
make[2]: *** Waiting for unfinished jobs....
Error building PALP.
```



---

archive/issue_comments_135866.json:
```json
{
    "body": "<a id='comment:32'></a>See also [http://lists.apple.com/archives/Xcode-users/2005/Nov/msg00274.html](http://lists.apple.com/archives/Xcode-users/2005/Nov/msg00274.html)",
    "created_at": "2011-12-01T09:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135866",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>See also [http://lists.apple.com/archives/Xcode-users/2005/Nov/msg00274.html](http://lists.apple.com/archives/Xcode-users/2005/Nov/msg00274.html)



---

archive/issue_comments_135867.json:
```json
{
    "body": "<a id='comment:33'></a>I've asked upstream whether they can get rid of the use of nested functions, I think it is used only once. Really no need to make it non-portable just for that. In the meantime, I've updated the palp spkg with a special case for `UNAME=Darwin` to enable `-fnested-functions` on OSX. I tested the new spkg on bsd.math and it compiles fine.",
    "created_at": "2011-12-01T09:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135867",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'></a>I've asked upstream whether they can get rid of the use of nested functions, I think it is used only once. Really no need to make it non-portable just for that. In the meantime, I've updated the palp spkg with a special case for `UNAME=Darwin` to enable `-fnested-functions` on OSX. I tested the new spkg on bsd.math and it compiles fine.



---

archive/issue_comments_135868.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-12-01T09:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135868",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135869.json:
```json
{
    "body": "<a id='comment:35'></a>I see in the spkg you patched \"Polynf.c\".  But please use `patch` for patching instead of `cp`.",
    "created_at": "2011-12-01T18:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135869",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>I see in the spkg you patched "Polynf.c".  But please use `patch` for patching instead of `cp`.



---

archive/issue_comments_135870.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-01T18:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135870",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_135871.json:
```json
{
    "body": "<a id='comment:36'></a>Harald Skarke told me that the problematic function is actually unused, so we can just remove it. I've updated the spkg with this alternate fix, so now it should not rely on any GNU C extension any more. \n\nI thought this would fix it but unfortunately nested functions are used elsewhere, too. I'm waiting for Harald to get back to me...",
    "created_at": "2011-12-01T18:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135871",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>Harald Skarke told me that the problematic function is actually unused, so we can just remove it. I've updated the spkg with this alternate fix, so now it should not rely on any GNU C extension any more. 

I thought this would fix it but unfortunately nested functions are used elsewhere, too. I'm waiting for Harald to get back to me...



---

archive/issue_comments_135872.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-17T21:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135872",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_135873.json:
```json
{
    "body": "<a id='comment:37'></a>I got the fix from upstream and it does compile on OSX now without problems.",
    "created_at": "2011-12-17T21:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135873",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:37'></a>I got the fix from upstream and it does compile on OSX now without problems.



---

archive/issue_comments_135874.json:
```json
{
    "body": "<a id='comment:38'></a>Volker, if you're adding new patches, please add only the .patch file and use `patch` in `spkg-install` (unless you have a good reason not to do so).\n\nAlso, it would be nice to put the ticket number (#12055) in the `SPKG.txt` changelog.",
    "created_at": "2011-12-18T13:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135874",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>Volker, if you're adding new patches, please add only the .patch file and use `patch` in `spkg-install` (unless you have a good reason not to do so).

Also, it would be nice to put the ticket number (#12055) in the `SPKG.txt` changelog.



---

archive/issue_comments_135875.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-18T13:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135875",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_135876.json:
```json
{
    "body": "<a id='comment:39'></a>Upstream gave me the files as they are, so I would argue that its preferable to just copy them in this case than to create a patch between different upstream versions. Presumably they will be in the next release in this form.\n\nI've added the ticket reference to the SPKG.txt, the updated package is at the same location.",
    "created_at": "2011-12-18T14:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135876",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'></a>Upstream gave me the files as they are, so I would argue that its preferable to just copy them in this case than to create a patch between different upstream versions. Presumably they will be in the next release in this form.

I've added the ticket reference to the SPKG.txt, the updated package is at the same location.



---

archive/issue_comments_135877.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-18T14:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135877",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_135878.json:
```json
{
    "body": "<a id='comment:40'></a>The upstream patched files have one blank line between **every** source code line.  Are you sure this is intentional and not a consequence of some bad CR/LF-related conversion?",
    "created_at": "2011-12-18T14:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135878",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>The upstream patched files have one blank line between **every** source code line.  Are you sure this is intentional and not a consequence of some bad CR/LF-related conversion?



---

archive/issue_comments_135879.json:
```json
{
    "body": "<a id='comment:41'></a>I'm pretty sure this is not intentional :-) But since it is C source code extra whitespace is irrelevant.",
    "created_at": "2011-12-18T15:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135879",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:41'></a>I'm pretty sure this is not intentional :-) But since it is C source code extra whitespace is irrelevant.



---

archive/issue_comments_135880.json:
```json
{
    "body": "<a id='comment:42'></a>I got the files sent again, this time without the CR/LF problem. Updated spkg at the same location.",
    "created_at": "2011-12-19T17:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135880",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'></a>I got the files sent again, this time without the CR/LF problem. Updated spkg at the same location.



---

archive/issue_comments_135881.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-02-27T00:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135881",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_135882.json:
```json
{
    "body": "<a id='comment:43'></a>This works well for me",
    "created_at": "2012-02-27T00:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135882",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:43'></a>This works well for me



---

archive/issue_events_032005.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-02-27T01:05:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32005"
}
```



---

archive/issue_comments_135883.json:
```json
{
    "body": "<a id='comment:44'></a>Superseded by #7071 (which provides palp-2.0.p1.spkg)",
    "created_at": "2012-02-27T01:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135883",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:44'></a>Superseded by #7071 (which provides palp-2.0.p1.spkg)



---

archive/issue_comments_135884.json:
```json
{
    "body": "<a id='comment:45'></a>Is the spkg on #7071 based on this one?  If yes, this ticket should be closed normally and marked as merged, not as duplicate/invalid/wontfix.",
    "created_at": "2012-03-02T13:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135884",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>Is the spkg on #7071 based on this one?  If yes, this ticket should be closed normally and marked as merged, not as duplicate/invalid/wontfix.



---

archive/issue_events_032006.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-03-02T21:58:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32006"
}
```



---

archive/issue_events_032007.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-03-02T21:58:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32007"
}
```



---

archive/issue_comments_135885.json:
```json
{
    "body": "<a id='comment:46'></a>Ok good then please merge it..",
    "created_at": "2012-03-02T21:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135885",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:46'></a>Ok good then please merge it..



---

archive/issue_comments_135886.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-03-04T21:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12055#issuecomment-135886",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_032008.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-04T21:19:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12055#event-32008"
}
```
