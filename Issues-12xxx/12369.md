# Issue 12369: Add a gcc package

archive/issues_012197.json:
```json
{
    "body": "The aim is to add a GCC package (GNU compiler collection) to Sage with compilers for C, C++ and Fortran.  We don't always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n\n**Apply**:\n1. [and [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/1934b915299e9ad988c00198ed25a5cd.patch)) to the `SAGE_ROOT` repository.\n2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n\n**See also**:\n1. #12782: When building GCC, build MPIR without the C++ interface (superseded by #11616).\n\nDepends on #12479\n\nDepends on #12602\n\nDepends on #12608\n\nDepends on #12609\n\nDepends on #12647\n\nDepends on #10492\n\nDepends on #12367\n\nDepends on #12368\n\nDepends on #12405\n\nDepends on #12570\n\nDepends on #12574\n\nDepends on #12423\n\nDepends on #12425\n\nDepends on #12456\n\nDepends on #12363\n\nDepends on #12223\n\nDepends on #12515\n\nDepends on #12519\n\nDepends on #12548\n\nDepends on #12562\n\nDepends on #12629\n\nDepends on #12638\n\nDepends on #12714\n\nDepends on #12647\n\nDepends on #12739\n\nDepends on #12112\n\nDepends on #12631\n\n**CC:**  @vbraun\n\n**Reviewer:** Simon King\n\n**Author:** Jeroen Demeyer\n\n**Merged:** sage-5.0.beta13\n\nIssue created by migration from https://trac.sagemath.org/ticket/12369\n\n",
    "closed_at": "2012-04-07T15:07:53Z",
    "created_at": "2012-01-27T13:34:34Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.0",
    "title": "Add a gcc package",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/12369",
    "user": "https://github.com/jdemeyer"
}
```
The aim is to add a GCC package (GNU compiler collection) to Sage with compilers for C, C++ and Fortran.  We don't always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)

**Apply**:
1. [and [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/1934b915299e9ad988c00198ed25a5cd.patch)) to the `SAGE_ROOT` repository.
2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.

**See also**:
1. #12782: When building GCC, build MPIR without the C++ interface (superseded by #11616).

Depends on #12479

Depends on #12602

Depends on #12608

Depends on #12609

Depends on #12647

Depends on #10492

Depends on #12367

Depends on #12368

Depends on #12405

Depends on #12570

Depends on #12574

Depends on #12423

Depends on #12425

Depends on #12456

Depends on #12363

Depends on #12223

Depends on #12515

Depends on #12519

Depends on #12548

Depends on #12562

Depends on #12629

Depends on #12638

Depends on #12714

Depends on #12647

Depends on #12739

Depends on #12112

Depends on #12631

**CC:**  @vbraun

**Reviewer:** Simon King

**Author:** Jeroen Demeyer

**Merged:** sage-5.0.beta13

Issue created by migration from https://trac.sagemath.org/ticket/12369





---

archive/issue_comments_136952.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)\n``````\n",
    "created_at": "2012-01-27T13:36:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136952",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)
``````




---

archive/issue_events_101302.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-27T13:36:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "rename": {
        "from": "Create a gcc package",
        "to": "Add a gcc package"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101302"
}
```



---

archive/issue_comments_136953.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.\n+The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)\n``````\n",
    "created_at": "2012-01-27T13:36:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136953",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.
+The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)
``````




---

archive/issue_comments_136954.json:
```json
{
    "body": "**Changing dependencies** from \"#12366, #12367, #12368\" to \"#12366, #12367, #12368, #10492\".",
    "created_at": "2012-01-31T11:16:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136954",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12366, #12367, #12368" to "#12366, #12367, #12368, #10492".



---

archive/issue_comments_136955.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)\n+\n+**Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n``````\n",
    "created_at": "2012-01-31T13:52:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136955",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)
+
+**Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
``````




---

archive/issue_comments_136956.json:
```json
{
    "body": "**Changing dependencies** from \"#12366, #12367, #12368, #10492\" to \"#11073, #12366, #12367, #12368, #10492, #12405\".",
    "created_at": "2012-01-31T22:43:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136956",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12366, #12367, #12368, #10492" to "#11073, #12366, #12367, #12368, #10492, #12405".



---

archive/issue_events_101303.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-31T23:00:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101303"
}
```



---

archive/issue_comments_136957.json:
```json
{
    "body": "<a id='comment:7'></a>\n\n```\n# Install gcc if the system-provided one is older than gcc-4.4. \n```\nBut that is all Macs.  This seems overkill to me; why not only do this on Lion?   \n\nOr would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?\n\nCould the message \"installing GCC because...\" occur several times here?",
    "created_at": "2012-02-01T01:51:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136957",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>

```
# Install gcc if the system-provided one is older than gcc-4.4. 
```
But that is all Macs.  This seems overkill to me; why not only do this on Lion?   

Or would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?

Could the message "installing GCC because..." occur several times here?



---

archive/issue_comments_136958.json:
```json
{
    "body": "<a id='comment:8'></a>\nUpdated spkg at http://www.stp.dias.ie/~vbraun/Sage/spkg/gcc-4.6.2.spkg\n\nIt turns out to be tricky to convince gcc to use `lib64` for glibc but put its own libraries into `lib`. But I think its safe to just move the generated shared libraries to `SAGE_LOCAL/lib`. Also, I updated to the newest gcc, install in single-thread, and disabled multilib.",
    "created_at": "2012-02-01T08:14:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136958",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>
Updated spkg at http://www.stp.dias.ie/~vbraun/Sage/spkg/gcc-4.6.2.spkg

It turns out to be tricky to convince gcc to use `lib64` for glibc but put its own libraries into `lib`. But I think its safe to just move the generated shared libraries to `SAGE_LOCAL/lib`. Also, I updated to the newest gcc, install in single-thread, and disabled multilib.



---

archive/issue_comments_136959.json:
```json
{
    "body": "<a id='comment:9'></a>\nFirst of all: this spkg is all pretty-much proof-of-concept.  I haven't even managed to install Sage from source with this spkg.\n\nReplying to [kcrisman](#comment%3A7):\n> \n> ```\n> # Install gcc if the system-provided one is older than gcc-4.4. \n> ```\n> But that is all Macs.  This seems overkill to me; why not only do this on Lion?   \n\nMaybe you are right, but my idea was to install this gcc spkg if the gcc we ship is more recent than the one the user has.  I think many people would benefit from using a more recent compiler.\n\n> Or would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?\n\nNo, this is a gcc from source.  I certainly don't want to include gcc binaries for every platform, that would increase the size way too much.\n\n> Could the message \"installing GCC because...\" occur several times here?\n\nSure.",
    "created_at": "2012-02-01T09:37:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136959",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
First of all: this spkg is all pretty-much proof-of-concept.  I haven't even managed to install Sage from source with this spkg.

Replying to [kcrisman](#comment%3A7):
> 
> ```
> # Install gcc if the system-provided one is older than gcc-4.4. 
> ```
> But that is all Macs.  This seems overkill to me; why not only do this on Lion?   

Maybe you are right, but my idea was to install this gcc spkg if the gcc we ship is more recent than the one the user has.  I think many people would benefit from using a more recent compiler.

> Or would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?

No, this is a gcc from source.  I certainly don't want to include gcc binaries for every platform, that would increase the size way too much.

> Could the message "installing GCC because..." occur several times here?

Sure.



---

archive/issue_comments_136960.json:
```json
{
    "body": "<a id='comment:10'></a>\n> First of all: this spkg is all pretty-much proof-of-concept.  I haven't even managed to install Sage from source with this spkg.\n\nOf course; I'm just asking early questions.\n> > But that is all Macs.  This seems overkill to me; why not only do this on Lion?   \n\n> Maybe you are right, but my idea was to install this gcc spkg if the gcc we ship is more recent than the one the user has.  I think many people would benefit from using a more recent compiler.\n\nPossibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.  Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install (from a disk which they've probably thrown out, as William pointed out on sage-devel) XCode anyway, in which case we might as well only worry about Lion anyway.\n> > Or would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?\n\n> No, this is a gcc from source.  I certainly don't want to include gcc binaries for every platform, that would increase the size way too much.\n\nThat's what I figured, but just wanted to clarify.\n> > Could the message \"installing GCC because...\" occur several times here?\n\n> Sure.\n\nOk.   I suppose it doesn't really matter, but could be confusing/alarming.",
    "created_at": "2012-02-01T18:50:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136960",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
> First of all: this spkg is all pretty-much proof-of-concept.  I haven't even managed to install Sage from source with this spkg.

Of course; I'm just asking early questions.
> > But that is all Macs.  This seems overkill to me; why not only do this on Lion?   

> Maybe you are right, but my idea was to install this gcc spkg if the gcc we ship is more recent than the one the user has.  I think many people would benefit from using a more recent compiler.

Possibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.  Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install (from a disk which they've probably thrown out, as William pointed out on sage-devel) XCode anyway, in which case we might as well only worry about Lion anyway.
> > Or would this eliminate having Xcode as a prerequisite to building Sage on OS X in general (even for those for which XCode is free, though sometimes annoying to get)?  That might be a nice move.  I assume this is a prebuilt gcc like our current Fortran package?

> No, this is a gcc from source.  I certainly don't want to include gcc binaries for every platform, that would increase the size way too much.

That's what I figured, but just wanted to clarify.
> > Could the message "installing GCC because..." occur several times here?

> Sure.

Ok.   I suppose it doesn't really matter, but could be confusing/alarming.



---

archive/issue_comments_136961.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [kcrisman](#comment%3A10):\n> Possibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.\n\nMy hope is that the non-gcc C compiler shipped with XCode 4 might be able to build GCC.\n\n> Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install\n\nThat \"vast majority\" of users will be happy with a binary distribution of Sage (which could actually contain GCC if I manage to make this spkg work).",
    "created_at": "2012-02-01T19:39:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136961",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Replying to [kcrisman](#comment%3A10):
> Possibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.

My hope is that the non-gcc C compiler shipped with XCode 4 might be able to build GCC.

> Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install

That "vast majority" of users will be happy with a binary distribution of Sage (which could actually contain GCC if I manage to make this spkg work).



---

archive/issue_comments_136962.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jdemeyer](#comment%3A11):\n> Replying to [kcrisman](#comment%3A10):\n> > Possibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.\n\n> My hope is that the non-gcc C compiler shipped with XCode 4 might be able to build GCC.\n\nInteresting!  Now I see the point of all this.\n> > Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install\n\n> That \"vast majority\" of users will be happy with a binary distribution of Sage \n\nGood point - until they need to change any code.  But this \n> (which could actually contain GCC if I manage to make this spkg work).\n\nInteresting, as I said.  I wonder if this would work:\n* Sage compiled with XCode 4, including compiling gcc\n* Sage bdisted from this machine\n* Sage downloaded in that bdist to a machine WITHOUT Xcode (or MacPorts, or any other compilers)\n* gcc included with Sage allows full Sage building fun\nGood luck!",
    "created_at": "2012-02-01T19:54:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136962",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Replying to [jdemeyer](#comment%3A11):
> Replying to [kcrisman](#comment%3A10):
> > Possibly.  I guess what I'm wondering is how one would *build* this gcc if one didn't have gcc... but this may betray my ignorance.

> My hope is that the non-gcc C compiler shipped with XCode 4 might be able to build GCC.

Interesting!  Now I see the point of all this.
> > Anyway, the vast majority of Mac users will not have a way to build this gcc if they need gcc until they download/install

> That "vast majority" of users will be happy with a binary distribution of Sage 

Good point - until they need to change any code.  But this 
> (which could actually contain GCC if I manage to make this spkg work).

Interesting, as I said.  I wonder if this would work:
* Sage compiled with XCode 4, including compiling gcc
* Sage bdisted from this machine
* Sage downloaded in that bdist to a machine WITHOUT Xcode (or MacPorts, or any other compilers)
* gcc included with Sage allows full Sage building fun
Good luck!



---

archive/issue_comments_136963.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #12366, #12367, #12368, #10492, #12405\" to \"#11073, #12366, #12367, #12368, #10492, #12405, #12416\".",
    "created_at": "2012-02-02T20:47:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136963",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #12366, #12367, #12368, #10492, #12405" to "#11073, #12366, #12367, #12368, #10492, #12405, #12416".



---

archive/issue_comments_136964.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #12366, #12367, #12368, #10492, #12405, #12416\" to \"#11073, #12366, #12367, #12368, #10492, #12405, #12416, #12422\".",
    "created_at": "2012-02-03T23:15:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136964",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #12366, #12367, #12368, #10492, #12405, #12416" to "#11073, #12366, #12367, #12368, #10492, #12405, #12416, #12422".



---

archive/issue_comments_136965.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #12366, #12367, #12368, #10492, #12405, #12416, #12422\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423\".",
    "created_at": "2012-02-03T23:47:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136965",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #12366, #12367, #12368, #10492, #12405, #12416, #12422" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423".



---

archive/issue_comments_136966.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425\".",
    "created_at": "2012-02-04T12:47:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136966",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425".



---

archive/issue_comments_136967.json:
```json
{
    "body": "<a id='comment:17'></a>\nI haven't looked at the spkg yet (which is probably old anyway), but looking at the root patch that you wrote, I have a few of requests:\n\n1. I agree with Karl. Do not install gcc if gcc is new enough (>=4.0.1), this will cause every mac developer to have to build gcc upon building sage (significantly increasing the build time). I'm not a mac user, but I know that if I had to do this on my system, I would be annoyed.\n\n2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).\n\n3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.\n\n\nAnd a couple comments:\n\n1. You assume that CC supports -dumpversion when determining if you should upgrade gcc. I'm fairly certain this is not an option supported by all compilers. Also, the value you would get would be meaningless anyway, since it wouldn't be a gcc version anyway (well, unless it is clang).\n\n2. For OBJC and OBJCXX, I would point to /usr/bin/cc and /usr/bin/cpp instead. If/when apple stops distributing gcc/g++, then these will continue to point to valid compilers.\n\n\nIn response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).",
    "created_at": "2012-02-05T01:36:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136967",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:17'></a>
I haven't looked at the spkg yet (which is probably old anyway), but looking at the root patch that you wrote, I have a few of requests:

1. I agree with Karl. Do not install gcc if gcc is new enough (>=4.0.1), this will cause every mac developer to have to build gcc upon building sage (significantly increasing the build time). I'm not a mac user, but I know that if I had to do this on my system, I would be annoyed.

2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).

3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.


And a couple comments:

1. You assume that CC supports -dumpversion when determining if you should upgrade gcc. I'm fairly certain this is not an option supported by all compilers. Also, the value you would get would be meaningless anyway, since it wouldn't be a gcc version anyway (well, unless it is clang).

2. For OBJC and OBJCXX, I would point to /usr/bin/cc and /usr/bin/cpp instead. If/when apple stops distributing gcc/g++, then these will continue to point to valid compilers.


In response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).



---

archive/issue_comments_136968.json:
```json
{
    "body": "<a id='comment:18'></a>\n> In response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).\n\nRight, that makes sense.  I didn't know exactly what comes from Xcode and what is just pre-included.",
    "created_at": "2012-02-05T01:51:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136968",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>
> In response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).

Right, that makes sense.  I didn't know exactly what comes from Xcode and what is just pre-included.



---

archive/issue_comments_136969.json:
```json
{
    "body": "<a id='comment:19'></a>\nI've been wondering for a while if we should change Sage to use autoconf. (When I say \"we\", I don't actually mean me, since I don't know anything about writing `configure` scripts, nor do I want to learn.) This could replace spkg-install (especially with the modifications at #10492 that create a Makefile on the fly). Does this make sense as an enhancement? Should I poll sage-devel about it, and then open a ticket if the response is positive?",
    "created_at": "2012-02-05T17:13:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136969",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
I've been wondering for a while if we should change Sage to use autoconf. (When I say "we", I don't actually mean me, since I don't know anything about writing `configure` scripts, nor do I want to learn.) This could replace spkg-install (especially with the modifications at #10492 that create a Makefile on the fly). Does this make sense as an enhancement? Should I poll sage-devel about it, and then open a ticket if the response is positive?



---

archive/issue_comments_136970.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jhpalmieri](#comment%3A19):\n> I've been wondering for a while if we should change Sage to use autoconf. (When I say \"we\", I don't actually mean me, since I don't know anything about writing `configure` scripts, nor do I want to learn.) This could replace spkg-install (especially with the modifications at #10492 that create a Makefile on the fly). Does this make sense as an enhancement?\n\nI don't know how much additional functionality it would add, but I would argue for it since it is more unix user friendly than our current custom setup (SAGE_ATLAS_LIB is not as user friendly as a fairly standard --with-system-atlas argument for configure). My guess is that it would be a fairly large endeavour to implement a first version of such a change (I don't know autoconf, so I'm just guessing here), although it would hopefully be easier to maintain than spkg-install.\n\n> Should I poll sage-devel about it, and then open a ticket if the response is positive?\n\nI don't think it could hurt. Also, that would be a better place to discuss it than on this ticket.",
    "created_at": "2012-02-05T17:26:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136970",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:20'></a>
Replying to [jhpalmieri](#comment%3A19):
> I've been wondering for a while if we should change Sage to use autoconf. (When I say "we", I don't actually mean me, since I don't know anything about writing `configure` scripts, nor do I want to learn.) This could replace spkg-install (especially with the modifications at #10492 that create a Makefile on the fly). Does this make sense as an enhancement?

I don't know how much additional functionality it would add, but I would argue for it since it is more unix user friendly than our current custom setup (SAGE_ATLAS_LIB is not as user friendly as a fairly standard --with-system-atlas argument for configure). My guess is that it would be a fairly large endeavour to implement a first version of such a change (I don't know autoconf, so I'm just guessing here), although it would hopefully be easier to maintain than spkg-install.

> Should I poll sage-devel about it, and then open a ticket if the response is positive?

I don't think it could hurt. Also, that would be a better place to discuss it than on this ticket.



---

archive/issue_comments_136971.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [ohanar](#comment%3A17):\n> 2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).\n\nActually, thinking a bit more about it, I think it would be better if we required SAGE_PORT to be set if CC and/or CXX is set.",
    "created_at": "2012-02-06T08:38:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136971",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:21'></a>
Replying to [ohanar](#comment%3A17):
> 2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).

Actually, thinking a bit more about it, I think it would be better if we required SAGE_PORT to be set if CC and/or CXX is set.



---

archive/issue_comments_136972.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [ohanar](#comment%3A17):\n> I haven't looked at the spkg yet (which is probably old anyway), but looking at the root patch that you wrote, I have a few of requests:\n> \n> 1. I agree with Karl. Do not install gcc if gcc is new enough (>=4.0.1), this will cause every mac developer to have to build gcc upon building sage (significantly increasing the build time). I'm not a mac user, but I know that if I had to do this on my system, I would be annoyed.\n\nWell, we *do* need to build Fortran on a Mac (I'm assuming that the fortran spkg will go away).  And Sage seems to require that the gcc and gfortran versions are the same.  It is true that the build time of gcc is significant:\n\n```\nreal    21m4.603s\nuser    15m56.183s\nsys     4m26.492s\nSuccessfully installed gcc-4.4.6\n```\n(on bsd.math, single-threaded),  but it's not that bad.  I think the \"plus\" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the \"minus\" of 25 minutes longer build time.\n\n> 2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).\n\nWell, I was thinking anyway of adding an environment variable (or future `./configure` option) to either force installation of gcc, or disable installation of gcc.  Don't forget that GCC has a few dependencies, and one might set `CC` to build those dependencies, but still want GCC to be installed.  Anyway, I don't care much about this.\n\n> 3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.\n\nI thought gcc and gfortran needed to be the same versions?\n\n> And a couple comments:\n> \n> 1. You assume that CC supports -dumpversion when determining if you should upgrade gcc. I'm fairly certain this is not an option supported by all compilers. Also, the value you would get would be meaningless anyway, since it wouldn't be a gcc version anyway (well, unless it is clang).\n\nAgreed.\n\n> 2. For OBJC and OBJCXX, I would point to /usr/bin/cc and /usr/bin/cpp instead. If/when apple stops distributing gcc/g++, then these will continue to point to valid compilers.\n\nAgreed (modulo the fact that you mean `c++` instead of the preprocessor `cpp`).\n\n> In response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).\n\nTrue...",
    "created_at": "2012-02-06T08:52:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136972",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [ohanar](#comment%3A17):
> I haven't looked at the spkg yet (which is probably old anyway), but looking at the root patch that you wrote, I have a few of requests:
> 
> 1. I agree with Karl. Do not install gcc if gcc is new enough (>=4.0.1), this will cause every mac developer to have to build gcc upon building sage (significantly increasing the build time). I'm not a mac user, but I know that if I had to do this on my system, I would be annoyed.

Well, we *do* need to build Fortran on a Mac (I'm assuming that the fortran spkg will go away).  And Sage seems to require that the gcc and gfortran versions are the same.  It is true that the build time of gcc is significant:

```
real    21m4.603s
user    15m56.183s
sys     4m26.492s
Successfully installed gcc-4.4.6
```
(on bsd.math, single-threaded),  but it's not that bad.  I think the "plus" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the "minus" of 25 minutes longer build time.

> 2. Assume the user knows what they are doing it CC is set (like you do for CXX and SAGE_FORTRAN). While not a very common use case, it would be helpful to not have to go hack the installation file if you were trying to port sage to another compiler (like I am right now).

Well, I was thinking anyway of adding an environment variable (or future `./configure` option) to either force installation of gcc, or disable installation of gcc.  Don't forget that GCC has a few dependencies, and one might set `CC` to build those dependencies, but still want GCC to be installed.  Anyway, I don't care much about this.

> 3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.

I thought gcc and gfortran needed to be the same versions?

> And a couple comments:
> 
> 1. You assume that CC supports -dumpversion when determining if you should upgrade gcc. I'm fairly certain this is not an option supported by all compilers. Also, the value you would get would be meaningless anyway, since it wouldn't be a gcc version anyway (well, unless it is clang).

Agreed.

> 2. For OBJC and OBJCXX, I would point to /usr/bin/cc and /usr/bin/cpp instead. If/when apple stops distributing gcc/g++, then these will continue to point to valid compilers.

Agreed (modulo the fact that you mean `c++` instead of the preprocessor `cpp`).

> In response to Karl about a replacement for Xcode (or tools on any platform). This does not provide one, even in binary distributions of sage since we need binutils and make, neither of which this would provide (and neither of which are on OSX without Xcode).

True...



---

archive/issue_comments_136973.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [jdemeyer](#comment%3A22):\n> Well, we *do* need to build Fortran on a Mac (I'm assuming that the fortran spkg will go away).\n\nAgreed, which is why I would like only fortran to be built if it is the only language needed.\n> I think the \"plus\" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the \"minus\" of 25 minutes longer build time.\n\nI think this is something that should be brought to the listserv. Once I get a clang port up and running (which shouldn't be too bad on osx, since atlas looks like it will be the only package that is going to be hell to port), this can be resolved by changing the default compiler on osx to clang.\n> > 3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.\n\n> I thought gcc and gfortran needed to be the same versions?\n\nI'm not sure about this, I'm using a mixture of clang (which dumps its version as 4.2.1) and gfortran-4.5.3, and occasionally gcc-4.2.4 and g++-4.2.4 to build sage, and currently the entire test suite is passing.",
    "created_at": "2012-02-06T09:10:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136973",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:23'></a>
Replying to [jdemeyer](#comment%3A22):
> Well, we *do* need to build Fortran on a Mac (I'm assuming that the fortran spkg will go away).

Agreed, which is why I would like only fortran to be built if it is the only language needed.
> I think the "plus" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the "minus" of 25 minutes longer build time.

I think this is something that should be brought to the listserv. Once I get a clang port up and running (which shouldn't be too bad on osx, since atlas looks like it will be the only package that is going to be hell to port), this can be resolved by changing the default compiler on osx to clang.
> > 3. (You might be doing this already) If fortran is the only language that needs to be built (such as on macs), please do not build gcc and g++.

> I thought gcc and gfortran needed to be the same versions?

I'm not sure about this, I'm using a mixture of clang (which dumps its version as 4.2.1) and gfortran-4.5.3, and occasionally gcc-4.2.4 and g++-4.2.4 to build sage, and currently the entire test suite is passing.



---

archive/issue_comments_136974.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [ohanar](#comment%3A23):\n> Agreed, which is why I would like only fortran to be built if it is the only language needed.\n\nIs build time your only concern here?  Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.",
    "created_at": "2012-02-06T09:21:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136974",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [ohanar](#comment%3A23):
> Agreed, which is why I would like only fortran to be built if it is the only language needed.

Is build time your only concern here?  Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.



---

archive/issue_comments_136975.json:
```json
{
    "body": "<a id='comment:25'></a>\nI would like to add that my goal is beyond OS X 10.7 but more generally all systems with bad compilers.  That's also why I went for the more stable gcc-4.4.6 as opposed to the more recent (and therefore buggy) gcc-4.6.2.",
    "created_at": "2012-02-06T09:35:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136975",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
I would like to add that my goal is beyond OS X 10.7 but more generally all systems with bad compilers.  That's also why I went for the more stable gcc-4.4.6 as opposed to the more recent (and therefore buggy) gcc-4.6.2.



---

archive/issue_comments_136976.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [jdemeyer](#comment%3A22):\n> I think the \"plus\" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the \"minus\" of 25 minutes longer build time.\n\nTo be fair, the current situation requires only one package (symmetrica) to be compiled without optimization, and then only if the extra gcc-4.2 package is not present.",
    "created_at": "2012-02-06T15:08:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136976",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
Replying to [jdemeyer](#comment%3A22):
> I think the "plus" of having a working Sage compiled with optimizations (as opposed to using XCode 4 with many packages compiled with -O0) outweighs the "minus" of 25 minutes longer build time.

To be fair, the current situation requires only one package (symmetrica) to be compiled without optimization, and then only if the extra gcc-4.2 package is not present.



---

archive/issue_comments_136977.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jdemeyer](#comment%3A25):\n> I would like to add that my goal is beyond OS X 10.7 but more generally all systems with bad compilers.\n\nI have compiled gcc too often on clusters that have only old versions installed.\n\nPersonally, gcc-4.6.2 seems to work very well. I'm not saying we should jump on every .0, mind you ;-)",
    "created_at": "2012-02-06T18:19:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136977",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>
Replying to [jdemeyer](#comment%3A25):
> I would like to add that my goal is beyond OS X 10.7 but more generally all systems with bad compilers.

I have compiled gcc too often on clusters that have only old versions installed.

Personally, gcc-4.6.2 seems to work very well. I'm not saying we should jump on every .0, mind you ;-)



---

archive/issue_comments_136978.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [jdemeyer](#comment%3A24):\n> Is build time your only concern here? Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.\n\nYes, I guess that is true, there is probably minimal savings by not building c++. I guess then as long as we don't add this to the critical path for most systems it should be fine. Do you have a current spkg that I could look at? I would like to see if there is any quick ways to reduce build time (e.g. disabling multilib on 64-bit systems).\n\nReplying to [vbraun](#comment%3A27):\n> Personally, gcc-4.6.2 seems to work very well. I'm not saying we should jump on every .0, mind you ;-)\n\nSame here (plus it compiles with clang, unlike 4.4.6, from my experimenting), however it adds mpc as a dependency.",
    "created_at": "2012-02-06T21:28:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136978",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:28'></a>
Replying to [jdemeyer](#comment%3A24):
> Is build time your only concern here? Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.

Yes, I guess that is true, there is probably minimal savings by not building c++. I guess then as long as we don't add this to the critical path for most systems it should be fine. Do you have a current spkg that I could look at? I would like to see if there is any quick ways to reduce build time (e.g. disabling multilib on 64-bit systems).

Replying to [vbraun](#comment%3A27):
> Personally, gcc-4.6.2 seems to work very well. I'm not saying we should jump on every .0, mind you ;-)

Same here (plus it compiles with clang, unlike 4.4.6, from my experimenting), however it adds mpc as a dependency.



---

archive/issue_comments_136979.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)\n \n **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n+\n+**Testing release**: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)\n``````\n",
    "created_at": "2012-02-06T21:37:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136979",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)
 
 **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
+
+**Testing release**: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)
``````




---

archive/issue_comments_136980.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [ohanar](#comment%3A28):\n> Yes, I guess that is true, there is probably minimal savings by not building c++. I guess then as long as we don't add this to the critical path for most systems it should be fine. Do you have a current spkg that I could look at?\n\nThe spkg on this ticket is current.",
    "created_at": "2012-02-06T21:37:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136980",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
Replying to [ohanar](#comment%3A28):
> Yes, I guess that is true, there is probably minimal savings by not building c++. I guess then as long as we don't add this to the critical path for most systems it should be fine. Do you have a current spkg that I could look at?

The spkg on this ticket is current.



---

archive/issue_comments_136981.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [ohanar](#comment%3A28):\n> I guess then as long as we don't add this to the critical path for most systems it should be fine.\n\nIf it gets built, it will be on the critical path (since it effectively blocks the build).  However, that's not a problem since the GCC build paralellizes well: I managed to build it in 4 minutes using \"make -j24\":\n\n```\nreal    4m7.170s\nuser    20m58.059s\nsys     4m29.269s\nSuccessfully installed gcc-4.4.6\n```",
    "created_at": "2012-02-06T22:47:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136981",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [ohanar](#comment%3A28):
> I guess then as long as we don't add this to the critical path for most systems it should be fine.

If it gets built, it will be on the critical path (since it effectively blocks the build).  However, that's not a problem since the GCC build paralellizes well: I managed to build it in 4 minutes using "make -j24":

```
real    4m7.170s
user    20m58.059s
sys     4m29.269s
Successfully installed gcc-4.4.6
```



---

archive/issue_comments_136982.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [ohanar](#comment%3A28):\n> any quick ways to reduce build time (e.g. disabling multilib on 64-bit systems).\n\nMy gcc-4.6.2 spkg disables multilib already\n\n> Same here (plus it compiles with clang, unlike 4.4.6, from my experimenting), however it adds mpc as a dependency.\n\nFor the record, mpc is contained in the gcc-4.6.2 spkg.",
    "created_at": "2012-02-06T23:08:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136982",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>
Replying to [ohanar](#comment%3A28):
> any quick ways to reduce build time (e.g. disabling multilib on 64-bit systems).

My gcc-4.6.2 spkg disables multilib already

> Same here (plus it compiles with clang, unlike 4.4.6, from my experimenting), however it adds mpc as a dependency.

For the record, mpc is contained in the gcc-4.6.2 spkg.



---

archive/issue_comments_136983.json:
```json
{
    "body": "<a id='comment:32'></a>\nI posted a patch for the gcc-4.4.6 spkg, it disables multilib, and fixes clang build (it also disables warnings, since gcc throws so many of them, I actually noticed a small speed up from disabling them).",
    "created_at": "2012-02-06T23:17:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136983",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:32'></a>
I posted a patch for the gcc-4.4.6 spkg, it disables multilib, and fixes clang build (it also disables warnings, since gcc throws so many of them, I actually noticed a small speed up from disabling them).



---

archive/issue_comments_136984.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [jdemeyer](#comment%3A30):\n> If it gets built, it will be on the critical path (since it effectively blocks the build).\n\nBut you also need to consider that we are building the mpir and mpfr twice as well as adding one copy of those builds to the critical path. I still think there is value to distinguishing between when gcc is needed, and when only fortran is needed. In the latter case, this should actually negligibly shorten the critical path (with the removal of the fortran spkg) plus mpir+mpfr don't have to be rebuilt.\n\nMy concern is that sage already takes a good while to build, and this spkg adds a fairly significant time to that for only a few feature gains and relatively minor performance gains (compared to implementing new/better algorithms).",
    "created_at": "2012-02-06T23:35:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136984",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:33'></a>
Replying to [jdemeyer](#comment%3A30):
> If it gets built, it will be on the critical path (since it effectively blocks the build).

But you also need to consider that we are building the mpir and mpfr twice as well as adding one copy of those builds to the critical path. I still think there is value to distinguishing between when gcc is needed, and when only fortran is needed. In the latter case, this should actually negligibly shorten the critical path (with the removal of the fortran spkg) plus mpir+mpfr don't have to be rebuilt.

My concern is that sage already takes a good while to build, and this spkg adds a fairly significant time to that for only a few feature gains and relatively minor performance gains (compared to implementing new/better algorithms).



---

archive/issue_comments_136985.json:
```json
{
    "body": "<a id='comment:34'></a>\nBy the way, I know you weren't using the word \"path\" this way, but regarding the path, note for example #10822: on some platforms, apparently, we may not be able to guarantee that `SAGE_ROOT/local/bin` comes first in the path.  So in the patch for the root repo, would it better to replace\n\n```\nCC=gcc \n```\nby\n\n```\nCC=\"$SAGE_LOCAL/bin/gcc\"\n```\non line 418 of sage-env, and similarly for CXX?",
    "created_at": "2012-02-06T23:50:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136985",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
By the way, I know you weren't using the word "path" this way, but regarding the path, note for example #10822: on some platforms, apparently, we may not be able to guarantee that `SAGE_ROOT/local/bin` comes first in the path.  So in the patch for the root repo, would it better to replace

```
CC=gcc 
```
by

```
CC="$SAGE_LOCAL/bin/gcc"
```
on line 418 of sage-env, and similarly for CXX?



---

archive/issue_comments_136986.json:
```json
{
    "body": "<a id='comment:35'></a>\nMy *personal* opinion on the build time is the following: I don't care much about it.  I much rather have a Sage which works and is fast than a Sage which builds fast.\n\nThere is no need to rebuild mpir and mpfr, except for speed gains (the newer GCC's might have better support for newer processors).",
    "created_at": "2012-02-07T07:23:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136986",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>
My *personal* opinion on the build time is the following: I don't care much about it.  I much rather have a Sage which works and is fast than a Sage which builds fast.

There is no need to rebuild mpir and mpfr, except for speed gains (the newer GCC's might have better support for newer processors).



---

archive/issue_comments_136987.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [jhpalmieri](#comment%3A34):\n> \n> ```\n> CC=\"$SAGE_LOCAL/bin/gcc\"\n> ```\n> on line 418 of sage-env, and similarly for CXX?\n\nUnfortunately, this would break if \"$SAGE_LOCAL\" contains spaces or other weird characters since $CC is usually used unquoted.\n\nI believe the zsh \"sage -sh\" issues are beyond gcc (it totally breaks everything) and should be fixed on #10822, not here.",
    "created_at": "2012-02-07T09:44:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136987",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
Replying to [jhpalmieri](#comment%3A34):
> 
> ```
> CC="$SAGE_LOCAL/bin/gcc"
> ```
> on line 418 of sage-env, and similarly for CXX?

Unfortunately, this would break if "$SAGE_LOCAL" contains spaces or other weird characters since $CC is usually used unquoted.

I believe the zsh "sage -sh" issues are beyond gcc (it totally breaks everything) and should be fixed on #10822, not here.



---

archive/issue_comments_136988.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457\".",
    "created_at": "2012-02-07T10:15:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136988",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457".



---

archive/issue_comments_136989.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12459\".",
    "created_at": "2012-02-07T10:18:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136989",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12459".



---

archive/issue_comments_136990.json:
```json
{
    "body": "<a id='comment:39'></a>\nWhy is `-std=c89` needed?",
    "created_at": "2012-02-07T12:29:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136990",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>
Why is `-std=c89` needed?



---

archive/issue_comments_136991.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [jdemeyer](#comment%3A39):\n> Why is `-std=c89` needed?\n\n` -std=gnu89 ` is not needed for gcc, but is needed for clang, and since I'm working on porting sage to clang, I would rather have this package work on it out of the gate (rather than make a ticket for something that could just be fixed now). Alternatively, we could use a more recent version of gcc in the spkg, since, at the very least, gcc-4.6.2 uses gnu99, the default standard for clang.\n\nI would also suggest using making cc and c++ be the default compiler when building gcc and its dependencies. Like OBJC and OBJCXX, this is more future thinking when it comes to apple platforms (plus more forward thinking for any platform with an unsupported compiler, from which we can build gcc).",
    "created_at": "2012-02-07T14:52:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136991",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:40'></a>
Replying to [jdemeyer](#comment%3A39):
> Why is `-std=c89` needed?

` -std=gnu89 ` is not needed for gcc, but is needed for clang, and since I'm working on porting sage to clang, I would rather have this package work on it out of the gate (rather than make a ticket for something that could just be fixed now). Alternatively, we could use a more recent version of gcc in the spkg, since, at the very least, gcc-4.6.2 uses gnu99, the default standard for clang.

I would also suggest using making cc and c++ be the default compiler when building gcc and its dependencies. Like OBJC and OBJCXX, this is more future thinking when it comes to apple platforms (plus more forward thinking for any platform with an unsupported compiler, from which we can build gcc).



---

archive/issue_comments_136992.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12459\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457\".",
    "created_at": "2012-02-07T15:51:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136992",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12459" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457".



---

archive/issue_comments_136993.json:
```json
{
    "body": "<a id='comment:42'></a>\nVolker, I just had a quick look at your spkg:\n1. --enable-languages can be omitted if you ship only the source of the C, C++ and Fortran compiler (as I would do)\n2. --libdir doesn't matter since GCC doesn't respect it (don't know why).\n3. --with-ppl doesn't matter either since PPL is only used in combination with CLooG which we don't ship.  I agree that it is cool that GCC can use PPL though.\n4. There is no need to install with \"-j1\".",
    "created_at": "2012-02-07T16:24:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136993",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>
Volker, I just had a quick look at your spkg:
1. --enable-languages can be omitted if you ship only the source of the C, C++ and Fortran compiler (as I would do)
2. --libdir doesn't matter since GCC doesn't respect it (don't know why).
3. --with-ppl doesn't matter either since PPL is only used in combination with CLooG which we don't ship.  I agree that it is cool that GCC can use PPL though.
4. There is no need to install with "-j1".



---

archive/issue_comments_136994.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)\n \n **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n \n``````\n",
    "created_at": "2012-02-07T17:16:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136994",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.4.6.spkg)
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)
 
 **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
 
``````




---

archive/issue_comments_136995.json:
```json
{
    "body": "<a id='comment:44'></a>\nWow, compiling this spkg with `SAGE_CHECK=yes` is pretty painful: on my Mac (which has only two cores), it took 89 minutes.",
    "created_at": "2012-02-07T22:13:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136995",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>
Wow, compiling this spkg with `SAGE_CHECK=yes` is pretty painful: on my Mac (which has only two cores), it took 89 minutes.



---

archive/issue_comments_136996.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [jhpalmieri](#comment%3A44):\n> Wow, compiling this spkg with `SAGE_CHECK=yes` is pretty painful: on my Mac (which has only two cores), it took 89 minutes.\n\nNote that compiling GCC with `SAGE_CHECK=yes` will actually make *every* spkg build slower, because it enables run-time checks inside GCC.\n\nI think this is not a problem and fits with the spirit of `SAGE_CHECK=yes`.",
    "created_at": "2012-02-07T22:18:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136996",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>
Replying to [jhpalmieri](#comment%3A44):
> Wow, compiling this spkg with `SAGE_CHECK=yes` is pretty painful: on my Mac (which has only two cores), it took 89 minutes.

Note that compiling GCC with `SAGE_CHECK=yes` will actually make *every* spkg build slower, because it enables run-time checks inside GCC.

I think this is not a problem and fits with the spirit of `SAGE_CHECK=yes`.



---

archive/issue_comments_136997.json:
```json
{
    "body": "<a id='comment:46'></a>\nYes, the gcc testsuite is pretty big!",
    "created_at": "2012-02-07T22:22:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136997",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:46'></a>
Yes, the gcc testsuite is pretty big!



---

archive/issue_comments_136998.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [vbraun](#comment%3A46):\n> Yes, the gcc testsuite is pretty big!\n\nI'm not actually shipping nor running the gcc testsuite.  It would add 6MB to the spkg size.",
    "created_at": "2012-02-07T22:23:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136998",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>
Replying to [vbraun](#comment%3A46):
> Yes, the gcc testsuite is pretty big!

I'm not actually shipping nor running the gcc testsuite.  It would add 6MB to the spkg size.



---

archive/issue_comments_136999.json:
```json
{
    "body": "<a id='comment:48'></a>\nI've built the \"testing release\" on OS X Lion with `SAGE_CHECK=yes`.  The results:\n\n- python failed self-tests, as always.\n- ppl failed self-tests.  I haven't seen this before.  Near the end of the log file:\n\n```\nmake  check-TESTS\nPASS: ascii_dump_load1\n/bin/sh: line 1: 22675 Abort trap: 6           ${dir}$tst\nFAIL: exceptions1\nPASS: pipproblem1\nPASS: pipproblem2\nPASS: pipproblem3\n```\n- cvxopt failed self-tests.  This one can be tricky to notice, since if self-tests fail, spkg-check still exits with a return code of 0, so the build proceeds.  But there are errors in the log file.  See #12011.\n- zn_poly failed self-tests.  This seems to happen frequently on Lion on a heavily loaded system, regardless of the compiler.  Typically it fails if I'm executing `make` on Sage with `MAKE=\"make -j2\"` so that other compilations are going on at the same time, but it often passes if I just do `./sage -i spkg/standard/zn_poly...`.\n- gsl and pari passed self-tests (they fail with the default compiler -- #12319 and #12315).  The relevant file (schur.pxi) in the Sage library passes doctests, so symmetrica seems to work (#12424).  This is all good news.\n- the testing release already includes the fix from #11967 (removing lib/python/config/libpython2.7.a).  Do you know if that's necessary when building this way?  I guess since Sage seems to function without this file, it doesn't hurt to delete it.\n\nDoctests haven't finished yet.",
    "created_at": "2012-02-08T06:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-136999",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>
I've built the "testing release" on OS X Lion with `SAGE_CHECK=yes`.  The results:

- python failed self-tests, as always.
- ppl failed self-tests.  I haven't seen this before.  Near the end of the log file:

```
make  check-TESTS
PASS: ascii_dump_load1
/bin/sh: line 1: 22675 Abort trap: 6           ${dir}$tst
FAIL: exceptions1
PASS: pipproblem1
PASS: pipproblem2
PASS: pipproblem3
```
- cvxopt failed self-tests.  This one can be tricky to notice, since if self-tests fail, spkg-check still exits with a return code of 0, so the build proceeds.  But there are errors in the log file.  See #12011.
- zn_poly failed self-tests.  This seems to happen frequently on Lion on a heavily loaded system, regardless of the compiler.  Typically it fails if I'm executing `make` on Sage with `MAKE="make -j2"` so that other compilations are going on at the same time, but it often passes if I just do `./sage -i spkg/standard/zn_poly...`.
- gsl and pari passed self-tests (they fail with the default compiler -- #12319 and #12315).  The relevant file (schur.pxi) in the Sage library passes doctests, so symmetrica seems to work (#12424).  This is all good news.
- the testing release already includes the fix from #11967 (removing lib/python/config/libpython2.7.a).  Do you know if that's necessary when building this way?  I guess since Sage seems to function without this file, it doesn't hurt to delete it.

Doctests haven't finished yet.



---

archive/issue_comments_137000.json:
```json
{
    "body": "<a id='comment:49'></a>\nPARI doesn't work with gcc-4.6.2 on OS X 10.6 and 10.7 systems.  Luckily, the new PARI (#12363) fixes this.",
    "created_at": "2012-02-08T07:41:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137000",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>
PARI doesn't work with gcc-4.6.2 on OS X 10.6 and 10.7 systems.  Luckily, the new PARI (#12363) fixes this.



---

archive/issue_comments_137001.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12363\".",
    "created_at": "2012-02-08T07:41:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137001",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12363".



---

archive/issue_comments_137002.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,4 +4,6 @@\n \n **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n \n-**Testing release**: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)\n+**Testing releases**:\n+1. GCC-4.4.6: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)\n+2. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)\n``````\n",
    "created_at": "2012-02-08T07:42:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137002",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,4 +4,6 @@
 
 **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
 
-**Testing release**: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)
+**Testing releases**:
+1. GCC-4.4.6: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)
+2. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)
``````




---

archive/issue_comments_137003.json:
```json
{
    "body": "<a id='comment:52'></a>\nMore data: with SAGE_CHECK=yes and testing release 1 (gcc-4.4.6), I bypassed the failing packages by installing them without running self-tests.  At the end there were a number of doctest failures:\n\n```\n\tsage -t  --long -force_lib devel/sage/sage/symbolic/expression.pyx # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/matrix/matrix2.pyx # 4 doctests failed\n\tsage -t  --long -force_lib devel/sage/sage/rings/polynomial/polynomial_element.pyx # 1 doctests failed\n\tsage -t  --long -force_lib devel/sage/sage/matrix/matrix_symbolic_dense.pyx # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/calculus/wester.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/calculus/functional.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/symbolic/integration/integral.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/calculus/tests.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/functions/trig.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx # 4 doctests failed\n\tsage -t  --long -force_lib devel/sage/sage/functions/min_max.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/interfaces/maxima_lib.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/libs/ppl.pyx # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/tensor/differential_form_element.py # Killed/crashed\n\tsage -t  --long -force_lib devel/sage/sage/tensor/differential_forms.py # Killed/crashed\n```\nThe ones not marked \"Killed/crashed\" are the familiar ones from #11881.\n\nNext, I tried to compile with SAGE_CHECK unset, and gd failed to build:\n\n```\ngcc -fPIC -g -I/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/include -I/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/include/freetype2/ -o .libs/gdparttopng gdparttopng.o  -L/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib ./.libs/libgd.dylib -liconv /Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib/libfreetype.dylib /Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib/libpng12.dylib -lz\nUndefined symbols for architecture x86_64:\n  \"_gdImageCreateFromGd2Part\", referenced from:\n      _main in gdparttopng.o\nld: symbol(s) not found for architecture x86_64\ncollect2: ld returned 1 exit status\nmake[4]: *** [gdparttopng] Error 1\nmake[3]: *** [all-recursive] Error 1\nmake[2]: *** [all] Error 2\nError building gd.\n```\nI just did `./sage -i spkg/standard/gd-...`, and it seems to have built fine.  I don't know what went wrong the first time, and I haven't had time to continue the build or to start it over.\n\nNext, I worked with testing release 2 (gcc-4.6.2).  As jdemeyer has noted, pari-2.5.0 won't build, so after verifying that (actually, it claims to have built, but it failed all (!) self-tests), I dropped in the new Pari spkg from #12363.  That worked.  Python failed its self-tests, so I installed it with SAGE_CHECK unset.  cvxopt failed self-tests, as before.  Everything else passed (including ppl).  Sage failed to start up, and it looks like the issue at #11967, so right now I'm rebuilding with a newer Python spkg.  I'll report back when that's done.",
    "created_at": "2012-02-08T22:31:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137003",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'></a>
More data: with SAGE_CHECK=yes and testing release 1 (gcc-4.4.6), I bypassed the failing packages by installing them without running self-tests.  At the end there were a number of doctest failures:

```
	sage -t  --long -force_lib devel/sage/sage/symbolic/expression.pyx # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/matrix/matrix2.pyx # 4 doctests failed
	sage -t  --long -force_lib devel/sage/sage/rings/polynomial/polynomial_element.pyx # 1 doctests failed
	sage -t  --long -force_lib devel/sage/sage/matrix/matrix_symbolic_dense.pyx # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/calculus/wester.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/calculus/functional.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/symbolic/integration/integral.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/calculus/tests.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/functions/trig.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/functions/hyperbolic.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/symbolic/function.pyx # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/matrix/matrix_double_dense.pyx # 4 doctests failed
	sage -t  --long -force_lib devel/sage/sage/functions/min_max.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/interfaces/maxima_lib.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/libs/ppl.pyx # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/tensor/differential_form_element.py # Killed/crashed
	sage -t  --long -force_lib devel/sage/sage/tensor/differential_forms.py # Killed/crashed
```
The ones not marked "Killed/crashed" are the familiar ones from #11881.

Next, I tried to compile with SAGE_CHECK unset, and gd failed to build:

```
gcc -fPIC -g -I/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/include -I/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/include/freetype2/ -o .libs/gdparttopng gdparttopng.o  -L/Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib ./.libs/libgd.dylib -liconv /Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib/libfreetype.dylib /Applications/sage_builds/GCC-no-check/sage-5.0.beta1-gcc/local/lib/libpng12.dylib -lz
Undefined symbols for architecture x86_64:
  "_gdImageCreateFromGd2Part", referenced from:
      _main in gdparttopng.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make[4]: *** [gdparttopng] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
Error building gd.
```
I just did `./sage -i spkg/standard/gd-...`, and it seems to have built fine.  I don't know what went wrong the first time, and I haven't had time to continue the build or to start it over.

Next, I worked with testing release 2 (gcc-4.6.2).  As jdemeyer has noted, pari-2.5.0 won't build, so after verifying that (actually, it claims to have built, but it failed all (!) self-tests), I dropped in the new Pari spkg from #12363.  That worked.  Python failed its self-tests, so I installed it with SAGE_CHECK unset.  cvxopt failed self-tests, as before.  Everything else passed (including ppl).  Sage failed to start up, and it looks like the issue at #11967, so right now I'm rebuilding with a newer Python spkg.  I'll report back when that's done.



---

archive/issue_comments_137004.json:
```json
{
    "body": "<a id='comment:53'></a>\ngcc-4.6.2 is certainly the way to go.  Sage builds, and there is only one doctest failing (with a Segmentation Fault):\n\n```\n$ ./sage -t --long  devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx\nsage -t --long \"devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx\"\nThe doctested process was killed by signal 11\n         [5.1 s]\n\n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t --long \"devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx\" # Killed/crashed\nTotal time for all tests: 5.1 seconds\n```",
    "created_at": "2012-02-09T07:58:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137004",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>
gcc-4.6.2 is certainly the way to go.  Sage builds, and there is only one doctest failing (with a Segmentation Fault):

```
$ ./sage -t --long  devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx
sage -t --long "devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx"
The doctested process was killed by signal 11
         [5.1 s]

----------------------------------------------------------------------
The following tests failed:


        sage -t --long "devel/sage/sage/rings/padics/padic_ZZ_pX_CR_element.pyx" # Killed/crashed
Total time for all tests: 5.1 seconds
```



---

archive/issue_comments_137005.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,5 +5,4 @@\n **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n \n **Testing releases**:\n-1. GCC-4.4.6: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)\n-2. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)\n+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)\n``````\n",
    "created_at": "2012-02-09T08:01:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137005",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,5 +5,4 @@
 **Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
 
 **Testing releases**:
-1. GCC-4.4.6: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta1-gcc/)
-2. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)
+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)
``````




---

archive/issue_comments_137006.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12363\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363\".",
    "created_at": "2012-02-09T08:01:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137006",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #12422, #12423, #12425, #12456, #12457, #12363" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363".



---

archive/issue_comments_137007.json:
```json
{
    "body": "<a id='comment:55'></a>\nI created ticket #12480 for the `padic_ZZ_pX_CR_element.pyx` segfault.",
    "created_at": "2012-02-09T10:29:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137007",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'></a>
I created ticket #12480 for the `padic_ZZ_pX_CR_element.pyx` segfault.



---

archive/issue_comments_137008.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12480\".",
    "created_at": "2012-02-09T10:29:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137008",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12480".



---

archive/issue_comments_137009.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12480\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363\".",
    "created_at": "2012-02-09T19:05:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137009",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12480" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363".



---

archive/issue_comments_137010.json:
```json
{
    "body": "<a id='comment:56'></a>\nRemoving #12480 as a dependency, since it really has nothing to do with OS X 10.7.",
    "created_at": "2012-02-09T19:05:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137010",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>
Removing #12480 as a dependency, since it really has nothing to do with OS X 10.7.



---

archive/attachments_017196.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12369_scripts_hgignore.patch",
    "asset_url": "tarball://root/attachments/ticket12369/12369_scripts_hgignore.patch",
    "created_at": "2012-02-10T10:37:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_137011.json:
```json
{
    "body": "**Attachment:** [12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch)",
    "created_at": "2012-02-10T10:37:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137011",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch)



---

archive/issue_comments_137012.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,9 @@\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)\n \n-**Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n+**Apply**:\n+1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n+2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n \n **Testing releases**:\n-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)\n+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)\n``````\n",
    "created_at": "2012-02-10T10:38:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137012",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,9 @@
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)
 
-**Apply** [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
+**Apply**:
+1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
+2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 
 **Testing releases**:
-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta2-gcc/)
+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)
``````




---

archive/issue_comments_137013.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,3 +8,4 @@\n \n **Testing releases**:\n 1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)\n+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n``````\n",
    "created_at": "2012-02-10T21:56:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137013",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,3 +8,4 @@
 
 **Testing releases**:
 1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)
+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
``````




---

archive/issue_comments_137014.json:
```json
{
    "body": "<a id='comment:59'></a>\nI've tried the testing release on several machines.  On all but one, everything seems fine, but on one, gcc fails to compile.  Any ideas why?  [Here's the log file](http://sage.math.washington.edu/home/palmieri/misc/gcc-4.6.2.log); note the lines\n\n```\ncc1: internal compiler error: Segmentation fault: 11\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <http://gcc.gnu.org/bugs.html> for instructions.\n```",
    "created_at": "2012-02-11T17:00:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137014",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:59'></a>
I've tried the testing release on several machines.  On all but one, everything seems fine, but on one, gcc fails to compile.  Any ideas why?  [Here's the log file](http://sage.math.washington.edu/home/palmieri/misc/gcc-4.6.2.log); note the lines

```
cc1: internal compiler error: Segmentation fault: 11
Please submit a full bug report,
with preprocessed source if appropriate.
See <http://gcc.gnu.org/bugs.html> for instructions.
```



---

archive/issue_comments_137015.json:
```json
{
    "body": "<a id='comment:60'></a>\nTo clarify, I should have said that I've tried testing the release on several OS X Lion machines, and it's failing on one of them.",
    "created_at": "2012-02-11T17:06:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137015",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:60'></a>
To clarify, I should have said that I've tried testing the release on several OS X Lion machines, and it's failing on one of them.



---

archive/issue_comments_137016.json:
```json
{
    "body": "<a id='comment:61'></a>\n1) Do you have MAKE=\"make -jN\" set or such?\n\n2) Does it fail consistently in the same spot if you try again?\n\n3) Try building gcc with SAGE_CHECK=yes\n\n4) Try building gcc with CFLAGS=\"-O0\" or CFLAGS_FOR_BUILD=\"-O0\"",
    "created_at": "2012-02-11T20:35:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137016",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:61'></a>
1) Do you have MAKE="make -jN" set or such?

2) Does it fail consistently in the same spot if you try again?

3) Try building gcc with SAGE_CHECK=yes

4) Try building gcc with CFLAGS="-O0" or CFLAGS_FOR_BUILD="-O0"



---

archive/issue_comments_137017.json:
```json
{
    "body": "<a id='comment:62'></a>\nReplying to [jdemeyer](#comment%3A61):\n> 1) Do you have MAKE=\"make -jN\" set or such?\n\nI had `MAKE=\"make -j2\"`, but I unset it and that didn't help.\n\n> 2) Does it fail consistently in the same spot if you try again?\n\nSame spot, every time.a\n \n> 3) Try building gcc with SAGE_CHECK=yes\n\nI did that, but it didn't help: with `SAGE_CHECK=yes` and `MAKE` unset, it still fails in the same spot.\n\n> 4) Try building gcc with CFLAGS=\"-O0\" or CFLAGS_FOR_BUILD=\"-O0\"\n\nDo you mean just setting these variables, or do I need to modify the spkg? Just setting them (along with SAGE_CHECK and MAKE as above) doesn't help.\n\nI also tried temporarily clearing out /usr/local in case some old files there were causing conflicts, but no help.",
    "created_at": "2012-02-11T23:25:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137017",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:62'></a>
Replying to [jdemeyer](#comment%3A61):
> 1) Do you have MAKE="make -jN" set or such?

I had `MAKE="make -j2"`, but I unset it and that didn't help.

> 2) Does it fail consistently in the same spot if you try again?

Same spot, every time.a
 
> 3) Try building gcc with SAGE_CHECK=yes

I did that, but it didn't help: with `SAGE_CHECK=yes` and `MAKE` unset, it still fails in the same spot.

> 4) Try building gcc with CFLAGS="-O0" or CFLAGS_FOR_BUILD="-O0"

Do you mean just setting these variables, or do I need to modify the spkg? Just setting them (along with SAGE_CHECK and MAKE as above) doesn't help.

I also tried temporarily clearing out /usr/local in case some old files there were causing conflicts, but no help.



---

archive/issue_comments_137018.json:
```json
{
    "body": "<a id='comment:63'></a>\n(Actually, regarding item 2, it stops at one place if `MAKE=\"make -j2\"`, and another if `MAKE` is unset, as you might expect.  But in each case, it's consistent.)",
    "created_at": "2012-02-11T23:26:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137018",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:63'></a>
(Actually, regarding item 2, it stops at one place if `MAKE="make -j2"`, and another if `MAKE` is unset, as you might expect.  But in each case, it's consistent.)



---

archive/issue_comments_137019.json:
```json
{
    "body": "<a id='comment:64'></a>\nCould you also post a list of all your environment variables (see for example the top of `SAGE_ROOT/install.log`)",
    "created_at": "2012-02-11T23:46:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137019",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:64'></a>
Could you also post a list of all your environment variables (see for example the top of `SAGE_ROOT/install.log`)



---

archive/issue_comments_137020.json:
```json
{
    "body": "<a id='comment:65'></a>\nHere's the top of install.log:\n\n```\nInstalling GCC because a Fortran compiler is missing.\nInstalling GCC because your 'gcc' is not so recent.\n*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***\nApple_PubSub_Socket_Render=/tmp/launch-OIACLZ/Render\nApple_Ubiquity_Message=/tmp/launch-7Be69V/Apple_Ubiquity_Message\nBIBINPUTS=/Users/palmieri/Documents/uw/tex/inputs/bibtex:.:\nCOMMAND_MODE=unix2003\nDISPLAY=/tmp/launch-zCNApn/org.x:0\nEDITOR=/usr/bin/emacs\nFIGNORE=.log:.aux:.blg:.dvi:.aux:.bbl:.toc:.lof:.flc:.elc\nHISTCONTROL=ignoreboth\nHOME=/Users/palmieri\nLANG=en_US.UTF-8\nLOGNAME=palmieri\nMAKE=make -j2\nMAKEFLAGS=\nMAKELEVEL=1\nMFLAGS=\nPATH=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg/bin:/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local/bin:/Users/palmieri/bin:/opt/local/bin:/opt/local/sbin:/Applications/sage/:/usr/texbin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin\nPWD=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg\nPYTHONPATH=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local\nSAGEMATH=palmieri@sage.math.washington.edu:.\nSAGE_DOC_JSMATH=yes\nSAGE_LOCAL=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local\nSAGE_LOGS=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg/logs\nSAGE_PARALLEL_SPKG_BUILD=yes\nSAGE_PORT=yes\nSAGE_ROOT=/Applications/sage_builds/clean/sage-5.0.beta3-gcc\nSHELL=/bin/bash\nSHLVL=4\nSSH_AUTH_SOCK=/tmp/launch-Y3Ezc9/Listeners\nTERM=xterm-color\nTERM_PROGRAM=Apple_Terminal\nTERM_PROGRAM_VERSION=303\nTERM_SESSION_ID=7E69A75B-352B-4367-A920-892CA994DAB8\nTEXINPUTS=/Applications/sage/local/share/texmf//:/Users/palmieri/Documents/uw/tex/inputs//:.:\nTMPDIR=/var/folders/qk/gyt9gwv171df7_3lt94z5pqc0000gn/T/\nTRANSFERS=jpalmier@homer.u.washington.edu:transfers\nUSER=palmieri\n_=/usr/bin/env\n__CF_USER_TEXT_ENCODING=0x1F5:0:0\n***********************************************\n```\n(There is no directory `/opt`, so any references to it are not important. I should probably delete that part of my PATH.)",
    "created_at": "2012-02-12T00:05:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137020",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:65'></a>
Here's the top of install.log:

```
Installing GCC because a Fortran compiler is missing.
Installing GCC because your 'gcc' is not so recent.
*** ALL ENVIRONMENT VARIABLES BEFORE BUILD: ***
Apple_PubSub_Socket_Render=/tmp/launch-OIACLZ/Render
Apple_Ubiquity_Message=/tmp/launch-7Be69V/Apple_Ubiquity_Message
BIBINPUTS=/Users/palmieri/Documents/uw/tex/inputs/bibtex:.:
COMMAND_MODE=unix2003
DISPLAY=/tmp/launch-zCNApn/org.x:0
EDITOR=/usr/bin/emacs
FIGNORE=.log:.aux:.blg:.dvi:.aux:.bbl:.toc:.lof:.flc:.elc
HISTCONTROL=ignoreboth
HOME=/Users/palmieri
LANG=en_US.UTF-8
LOGNAME=palmieri
MAKE=make -j2
MAKEFLAGS=
MAKELEVEL=1
MFLAGS=
PATH=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg/bin:/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local/bin:/Users/palmieri/bin:/opt/local/bin:/opt/local/sbin:/Applications/sage/:/usr/texbin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin
PWD=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg
PYTHONPATH=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local
SAGEMATH=palmieri@sage.math.washington.edu:.
SAGE_DOC_JSMATH=yes
SAGE_LOCAL=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/local
SAGE_LOGS=/Applications/sage_builds/clean/sage-5.0.beta3-gcc/spkg/logs
SAGE_PARALLEL_SPKG_BUILD=yes
SAGE_PORT=yes
SAGE_ROOT=/Applications/sage_builds/clean/sage-5.0.beta3-gcc
SHELL=/bin/bash
SHLVL=4
SSH_AUTH_SOCK=/tmp/launch-Y3Ezc9/Listeners
TERM=xterm-color
TERM_PROGRAM=Apple_Terminal
TERM_PROGRAM_VERSION=303
TERM_SESSION_ID=7E69A75B-352B-4367-A920-892CA994DAB8
TEXINPUTS=/Applications/sage/local/share/texmf//:/Users/palmieri/Documents/uw/tex/inputs//:.:
TMPDIR=/var/folders/qk/gyt9gwv171df7_3lt94z5pqc0000gn/T/
TRANSFERS=jpalmier@homer.u.washington.edu:transfers
USER=palmieri
_=/usr/bin/env
__CF_USER_TEXT_ENCODING=0x1F5:0:0
***********************************************
```
(There is no directory `/opt`, so any references to it are not important. I should probably delete that part of my PATH.)



---

archive/issue_comments_137021.json:
```json
{
    "body": "<a id='comment:66'></a>\nThe $TMPDIR looks suspicious, but it seems to be added by Apple on all OS X 10.7 systems, so it can't be that.  Otherwise, I don't see anything special in your environment.",
    "created_at": "2012-02-12T09:06:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137021",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:66'></a>
The $TMPDIR looks suspicious, but it seems to be added by Apple on all OS X 10.7 systems, so it can't be that.  Otherwise, I don't see anything special in your environment.



---

archive/issue_comments_137022.json:
```json
{
    "body": "<a id='comment:67'></a>\nReplying to [jdemeyer](#comment%3A24):\n> Replying to [ohanar](#comment%3A23):\n> > Agreed, which is why I would like only fortran to be built if it is the only language needed.\n\n> Is build time your only concern here?  Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.\n\nI'm 95% sure you will need to build the complete gcc - not just the stage 1, even if you only want fortran, so I doubt trying to build just fortran would save much, if any, time. Building g++ probably takes a non-significant amount of extra time, but I'd think it much more sensible to have all the compilers at the same version, and not a mixture. \n\nWe currently enforce the versions of gcc/g++/gfortran in Sage to be the same. Strictly speaking they don't need to be, but it increases the chances of the build going ok if the same versions are used. We can also attempt to replicate bugs reported much easier if all versions are the same. \n\n\nDave",
    "created_at": "2012-02-13T22:03:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137022",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:67'></a>
Replying to [jdemeyer](#comment%3A24):
> Replying to [ohanar](#comment%3A23):
> > Agreed, which is why I would like only fortran to be built if it is the only language needed.

> Is build time your only concern here?  Because if you need to build Fortran, you most likely need to build a stage 1 C compiler anyway.

I'm 95% sure you will need to build the complete gcc - not just the stage 1, even if you only want fortran, so I doubt trying to build just fortran would save much, if any, time. Building g++ probably takes a non-significant amount of extra time, but I'd think it much more sensible to have all the compilers at the same version, and not a mixture. 

We currently enforce the versions of gcc/g++/gfortran in Sage to be the same. Strictly speaking they don't need to be, but it increases the chances of the build going ok if the same versions are used. We can also attempt to replicate bugs reported much easier if all versions are the same. 


Dave



---

archive/issue_comments_137023.json:
```json
{
    "body": "<a id='comment:68'></a>\nI removed mpc from the gcc spkg and propose to add a separate mpc spkg, which might also benefit Sage in other ways: #12515.",
    "created_at": "2012-02-15T15:00:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137023",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>
I removed mpc from the gcc spkg and propose to add a separate mpc spkg, which might also benefit Sage in other ways: #12515.



---

archive/issue_comments_137024.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12515\".",
    "created_at": "2012-02-15T15:00:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137024",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12515".



---

archive/issue_comments_137025.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12515\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515\".",
    "created_at": "2012-02-15T16:23:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137025",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12515" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515".



---

archive/issue_comments_137026.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519\".",
    "created_at": "2012-02-16T11:37:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137026",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519".



---

archive/issue_comments_137027.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n \n **Testing releases**:\n-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)\n-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/)\n+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n``````\n",
    "created_at": "2012-02-17T12:41:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137027",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 
 **Testing releases**:
-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gcc/)
-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta3-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/)
+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
``````




---

archive/issue_comments_137028.json:
```json
{
    "body": "<a id='comment:72'></a>\nSeveral times I've had the build fail in the middle when building with `MAKE=\"make -j2\"`.  I think what happens is this: mpfr gets built for a second time, and during that build (or installation), its library gets deleted, and then the other spkg being built at the same time fails.  For example, I just got this while building ntl:\n\n```\ng++ -I../include -I.  -O2 -g  -fno-common  -c  lzz_pXFactoring.c\ng++ -I../include -I.  -O2 -g  -fno-common  -c  mat_GF2.c\ng++ -I../include -I.  -O2 -g  -fno-common  -c  mat_GF2E.c\ng++ -I../include -I.  -O2 -g  -fno-common  -c  mat_RR.c\ndyld: Library not loaded: /Applications/sage_builds/GCC-clang-no-check/sage-5.0.beta4-gcc/local/lib/libmpfr.1.dylib\n  Referenced from: /Applications/sage_builds/GCC-clang-no-check/sage-5.0.beta4-gcc/local/libexec/gcc/x86_64-apple-darwin11.3.0/4.6.2/cc1plus\n  Reason: image not found\ng++: internal compiler error: Trace/BPT trap: 5 (program cc1plus)\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <http://gcc.gnu.org/bugs.html> for instructions.\nmake[3]: *** [mat_RR.o] Error 4\nmake[2]: *** [libntl.dylib] Error 2\nFailed to build NTL dylib.\n```\nSo maybe mpir and mpfr should be built right after gcc, to avoid this?",
    "created_at": "2012-02-18T05:11:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137028",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:72'></a>
Several times I've had the build fail in the middle when building with `MAKE="make -j2"`.  I think what happens is this: mpfr gets built for a second time, and during that build (or installation), its library gets deleted, and then the other spkg being built at the same time fails.  For example, I just got this while building ntl:

```
g++ -I../include -I.  -O2 -g  -fno-common  -c  lzz_pXFactoring.c
g++ -I../include -I.  -O2 -g  -fno-common  -c  mat_GF2.c
g++ -I../include -I.  -O2 -g  -fno-common  -c  mat_GF2E.c
g++ -I../include -I.  -O2 -g  -fno-common  -c  mat_RR.c
dyld: Library not loaded: /Applications/sage_builds/GCC-clang-no-check/sage-5.0.beta4-gcc/local/lib/libmpfr.1.dylib
  Referenced from: /Applications/sage_builds/GCC-clang-no-check/sage-5.0.beta4-gcc/local/libexec/gcc/x86_64-apple-darwin11.3.0/4.6.2/cc1plus
  Reason: image not found
g++: internal compiler error: Trace/BPT trap: 5 (program cc1plus)
Please submit a full bug report,
with preprocessed source if appropriate.
See <http://gcc.gnu.org/bugs.html> for instructions.
make[3]: *** [mat_RR.o] Error 4
make[2]: *** [libntl.dylib] Error 2
Failed to build NTL dylib.
```
So maybe mpir and mpfr should be built right after gcc, to avoid this?



---

archive/issue_comments_137029.json:
```json
{
    "body": "<a id='comment:73'></a>\nThanks John, I already noticed this myself.  I see two solutions:\n\n1. rebuild mpir, mpfr, mpc after GCC without building anything else.\n\n2. don't delete the old libraries in the mpir, mpfr, mpc (at least if gcc is installed).\n\nI'm more inclined to go for option 2.  I never quite understood why we have to delete old libraries anyway.",
    "created_at": "2012-02-18T09:24:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137029",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:73'></a>
Thanks John, I already noticed this myself.  I see two solutions:

1. rebuild mpir, mpfr, mpc after GCC without building anything else.

2. don't delete the old libraries in the mpir, mpfr, mpc (at least if gcc is installed).

I'm more inclined to go for option 2.  I never quite understood why we have to delete old libraries anyway.



---

archive/issue_comments_137030.json:
```json
{
    "body": "<a id='comment:74'></a>\nI don't know if it's the new version of Xcode (4.3) or if it's due to modifications in the latest gcc spkg, but the latest testing release builds fine with the default compiler on a laptop where it failed before and on a desktop where it succeeded before.  (\"Builds fine\" means built and passed all of Sage's doctests.  I have to rebuild with `SAGE_CHECK=yes` to see how that goes.  I'll also try with clang.)",
    "created_at": "2012-02-19T05:58:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137030",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:74'></a>
I don't know if it's the new version of Xcode (4.3) or if it's due to modifications in the latest gcc spkg, but the latest testing release builds fine with the default compiler on a laptop where it failed before and on a desktop where it succeeded before.  ("Builds fine" means built and passed all of Sage's doctests.  I have to rebuild with `SAGE_CHECK=yes` to see how that goes.  I'll also try with clang.)



---

archive/issue_comments_137031.json:
```json
{
    "body": "<a id='comment:75'></a>\nReplying to [jhpalmieri](#comment%3A74):\n> I don't know if it's the new version of Xcode (4.3)\n\nIf you upgraded XCode on that laptop, that would be the likely reason why it suddenly works.",
    "created_at": "2012-02-19T19:19:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137031",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>
Replying to [jhpalmieri](#comment%3A74):
> I don't know if it's the new version of Xcode (4.3)

If you upgraded XCode on that laptop, that would be the likely reason why it suddenly works.



---

archive/issue_comments_137032.json:
```json
{
    "body": "<a id='comment:76'></a>\nReplying to [jdemeyer](#comment%3A73):\n> 2. don't delete the old libraries in the mpir, mpfr, mpc (at least if gcc is installed).\n> \n> I'm more inclined to go for option 2.  I never quite understood why we have to delete old libraries anyway.\n\nRight, this makes sense to me, and `$MAKE install` overwrites the old libraries anyway.\n\nBy the way, I've built with and without `CC=clang` (etc.) and with and without `SAGE_CHECK=yes`, on several different Lion machines, and I've had no problems except for python and cvxopt failing self-tests. I don't know what's going on with cvxopt. Could it be an atlas problem on Lion?  In any case, the new Xcode seems to be a good choice for those people willing to upgrade from earlier versions of Lion to OS X 10.7.3.",
    "created_at": "2012-02-20T04:18:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137032",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:76'></a>
Replying to [jdemeyer](#comment%3A73):
> 2. don't delete the old libraries in the mpir, mpfr, mpc (at least if gcc is installed).
> 
> I'm more inclined to go for option 2.  I never quite understood why we have to delete old libraries anyway.

Right, this makes sense to me, and `$MAKE install` overwrites the old libraries anyway.

By the way, I've built with and without `CC=clang` (etc.) and with and without `SAGE_CHECK=yes`, on several different Lion machines, and I've had no problems except for python and cvxopt failing self-tests. I don't know what's going on with cvxopt. Could it be an atlas problem on Lion?  In any case, the new Xcode seems to be a good choice for those people willing to upgrade from earlier versions of Lion to OS X 10.7.3.



---

archive/issue_comments_137033.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548\".",
    "created_at": "2012-02-20T08:22:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137033",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548".



---

archive/issue_comments_137034.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548\" to \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\".",
    "created_at": "2012-02-22T10:39:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137034",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548" to "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562".



---

archive/issue_comments_137035.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n \n **Testing releases**:\n-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/)\n-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)\n+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n``````\n",
    "created_at": "2012-02-22T13:17:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137035",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 
 **Testing releases**:
-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gcc/)
-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta4-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
+1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)
+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
``````




---

archive/issue_comments_137036.json:
```json
{
    "body": "<a id='comment:80'></a>\nThere needs to be a couple of changes for Solaris - in particular, the ability to specify the assembler and linker to be used, since the Sun assembler is not suitable for gcc on x86, So when configuring gcc, one might specify\n\n```\n--with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld\n```\n\nThe above specifies the GNU assembler is used, where it is, the Sun linker is used, and where it is. I'd suggest we have environment variables to specify the locations of the linker and assembler. (Perhaps **SAGE_PATH_TO_ASSEMBLER** and **SAGE_PATH_TO_LINKER** or something similar). I suspect this could be useful sometimes on Linux too, as people might have more than one copy of the assembler and/or linker present. \n\nAlthough I personally always specify `--with-gnu-as` or {{{--without-gnu-as}}], and similar for the linker, I don't think this is strictly necessary, as the gcc configure script will determine if linker and assembler specified are the GNU ones or not. \n\nDo you want a patch on another ticket, or this one? \n\nDave",
    "created_at": "2012-02-23T05:37:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137036",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:80'></a>
There needs to be a couple of changes for Solaris - in particular, the ability to specify the assembler and linker to be used, since the Sun assembler is not suitable for gcc on x86, So when configuring gcc, one might specify

```
--with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld
```

The above specifies the GNU assembler is used, where it is, the Sun linker is used, and where it is. I'd suggest we have environment variables to specify the locations of the linker and assembler. (Perhaps **SAGE_PATH_TO_ASSEMBLER** and **SAGE_PATH_TO_LINKER** or something similar). I suspect this could be useful sometimes on Linux too, as people might have more than one copy of the assembler and/or linker present. 

Although I personally always specify `--with-gnu-as` or {{{--without-gnu-as}}], and similar for the linker, I don't think this is strictly necessary, as the gcc configure script will determine if linker and assembler specified are the GNU ones or not. 

Do you want a patch on another ticket, or this one? 

Dave



---

archive/issue_comments_137037.json:
```json
{
    "body": "<a id='comment:81'></a>\nReplying to [drkirkby](#comment%3A80):\n> I'd suggest we have environment variables to specify the locations of the linker and assembler.\n\nGCC respects the standard `$LD` and `$AS` environment variables, so I don't see any need for this.",
    "created_at": "2012-02-23T10:49:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137037",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:81'></a>
Replying to [drkirkby](#comment%3A80):
> I'd suggest we have environment variables to specify the locations of the linker and assembler.

GCC respects the standard `$LD` and `$AS` environment variables, so I don't see any need for this.



---

archive/issue_comments_137038.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\" to \"#11073, #10492, #12367, #12368, #12405, #12570, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\".",
    "created_at": "2012-02-23T11:08:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137038",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12366, #12367, #12368, #12405, #12416, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562" to "#11073, #10492, #12367, #12368, #12405, #12570, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562".



---

archive/issue_comments_137039.json:
```json
{
    "body": "<a id='comment:83'></a>\nApparently, `$AS` and `$LD` are only used to build GCC itself, so we would still need to add --with-as=$AS --with-ld=$LD.",
    "created_at": "2012-02-23T12:50:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137039",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:83'></a>
Apparently, `$AS` and `$LD` are only used to build GCC itself, so we would still need to add --with-as=$AS --with-ld=$LD.



---

archive/issue_comments_137040.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12367, #12368, #12405, #12570, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\" to \"#11073, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\".",
    "created_at": "2012-02-23T19:19:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137040",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12367, #12368, #12405, #12570, #11967, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562" to "#11073, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562".



---

archive/issue_comments_137041.json:
```json
{
    "body": "<a id='comment:85'></a>\nReplying to [drkirkby](#comment%3A80):\n> the Sun assembler is not suitable for gcc on x86\n\nI don't think this is true.  I found only one issue with `-pipe` (#12562).  Apart from that, Sage builds fine with the Sun assembler.\n\nAnyway, I fixed the GCC spkg to use the `AS` and `LD` environment variables as arguments for --with-as and --with-ld.",
    "created_at": "2012-02-24T14:18:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137041",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:85'></a>
Replying to [drkirkby](#comment%3A80):
> the Sun assembler is not suitable for gcc on x86

I don't think this is true.  I found only one issue with `-pipe` (#12562).  Apart from that, Sage builds fine with the Sun assembler.

Anyway, I fixed the GCC spkg to use the `AS` and `LD` environment variables as arguments for --with-as and --with-ld.



---

archive/issue_comments_137042.json:
```json
{
    "body": "<a id='comment:86'></a>\nReplying to [jdemeyer](#comment%3A85):\n> Replying to [drkirkby](#comment%3A80):\n> > the Sun assembler is not suitable for gcc on x86\n\n> I don't think this is true.  I found only one issue with `-pipe` (#12562).  Apart from that, Sage builds fine with the Sun assembler.\n> \n> Anyway, I fixed the GCC spkg to use the `AS` and `LD` environment variables as arguments for --with-as and --with-ld.\n\nIMHO, which is shared by the GCC documentation, the Sun assembler should be used, so unless AS is set, it would be wise to use /usr/ccs/bin/as. (On Solaris 11 and OpenSolaris, there's a link to /usr/bin/as, but that's not true on  Solaris 10). \n\nhttp://gcc.gnu.org/install/specific.html#ix86-x-solaris210\n\nsays on the Solaris x86 notes. \n\n---\n*It is recommended that you configure GCC to use the GNU assembler, in /usr/sfw/bin/gas. The versions included in Solaris 10, from GNU binutils 2.15, and Solaris 11, from GNU binutils 2.19, work fine, although the current version, from GNU binutils 2.21, is known to work, too. Recent versions of the Sun assembler in /usr/ccs/bin/as work almost as well, though.*\n\n*For linking, the Sun linker, is preferred.*\n\nIt also says *It may be necessary to configure with --without-gnu-ld --with-ld=/usr/ccs/bin/ld to guarantee use of Sun ld.*\n\n---\n\nI thought the configure script would work out the --without-gnu-ld, but it might be worth adding the option unless LD is set.\n\nI don't know what the status of t2.math is. William said he was going to switch it on a couple of weeks ago, but last time I looked it was down. Also, not sure about SkyNet. \n\nIf we need a Solaris 11 x86 machine I have one. A bit limited in performance (pair of dual core 2.8 GHz Opterons and 8 GB RAM, but it is useable. It's running the latest release of Solaris 11. I really need to work out how to use the remote management on it, as it is very noisy, must be placed in the garage, but I don't know how to manage it properly on it's management port. \n\n\n\nDave",
    "created_at": "2012-02-25T22:26:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137042",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:86'></a>
Replying to [jdemeyer](#comment%3A85):
> Replying to [drkirkby](#comment%3A80):
> > the Sun assembler is not suitable for gcc on x86

> I don't think this is true.  I found only one issue with `-pipe` (#12562).  Apart from that, Sage builds fine with the Sun assembler.
> 
> Anyway, I fixed the GCC spkg to use the `AS` and `LD` environment variables as arguments for --with-as and --with-ld.

IMHO, which is shared by the GCC documentation, the Sun assembler should be used, so unless AS is set, it would be wise to use /usr/ccs/bin/as. (On Solaris 11 and OpenSolaris, there's a link to /usr/bin/as, but that's not true on  Solaris 10). 

http://gcc.gnu.org/install/specific.html#ix86-x-solaris210

says on the Solaris x86 notes. 

---
*It is recommended that you configure GCC to use the GNU assembler, in /usr/sfw/bin/gas. The versions included in Solaris 10, from GNU binutils 2.15, and Solaris 11, from GNU binutils 2.19, work fine, although the current version, from GNU binutils 2.21, is known to work, too. Recent versions of the Sun assembler in /usr/ccs/bin/as work almost as well, though.*

*For linking, the Sun linker, is preferred.*

It also says *It may be necessary to configure with --without-gnu-ld --with-ld=/usr/ccs/bin/ld to guarantee use of Sun ld.*

---

I thought the configure script would work out the --without-gnu-ld, but it might be worth adding the option unless LD is set.

I don't know what the status of t2.math is. William said he was going to switch it on a couple of weeks ago, but last time I looked it was down. Also, not sure about SkyNet. 

If we need a Solaris 11 x86 machine I have one. A bit limited in performance (pair of dual core 2.8 GHz Opterons and 8 GB RAM, but it is useable. It's running the latest release of Solaris 11. I really need to work out how to use the remote management on it, as it is very noisy, must be placed in the garage, but I don't know how to manage it properly on it's management port. 



Dave



---

archive/issue_comments_137043.json:
```json
{
    "body": "<a id='comment:87'></a>\nWith sage-5.0.beta4-gcc, `CC=clang` and `CXX=clang++`, things built fine on OS X Lion, Xcode 4.3.  With sage-5.0.beta5-gcc, though, polybori fails to build when I try this: at the very start of the build, I get this:\n\n```\n****************************************************\nStarting build...\nRemoving old PolyBoRi install...\nDone removing old PolyBoRi install.\nRunning build_polybori...\nscons: Reading SConscript files ...\nPlatform:  darwin\nDetecting type sizes... no\nCould not detect type sizes (maybe compile/link flags trouble)! Exiting.\nError building PolyBoRi.\n```\nI wonder what differences between beta4-gcc and beta5-gcc caused this.\n\nI haven't seen this problem when using the default gcc instead of clang.",
    "created_at": "2012-02-25T22:35:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137043",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:87'></a>
With sage-5.0.beta4-gcc, `CC=clang` and `CXX=clang++`, things built fine on OS X Lion, Xcode 4.3.  With sage-5.0.beta5-gcc, though, polybori fails to build when I try this: at the very start of the build, I get this:

```
****************************************************
Starting build...
Removing old PolyBoRi install...
Done removing old PolyBoRi install.
Running build_polybori...
scons: Reading SConscript files ...
Platform:  darwin
Detecting type sizes... no
Could not detect type sizes (maybe compile/link flags trouble)! Exiting.
Error building PolyBoRi.
```
I wonder what differences between beta4-gcc and beta5-gcc caused this.

I haven't seen this problem when using the default gcc instead of clang.



---

archive/issue_comments_137044.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n \n **Apply**:\n 1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n``````\n",
    "created_at": "2012-03-01T17:21:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137044",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.2.spkg)
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)
 
 **Apply**:
 1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
``````




---

archive/issue_comments_137045.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n \n **Testing releases**:\n-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)\n+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)\n 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n``````\n",
    "created_at": "2012-03-02T13:09:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137045",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 
 **Testing releases**:
-1. GCC-4.6.2: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)
+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)
 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
``````




---

archive/issue_comments_137046.json:
```json
{
    "body": "**Changing dependencies** from \"#11073, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562\" to \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629\".",
    "created_at": "2012-03-05T12:41:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137046",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#11073, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562" to "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629".



---

archive/issue_comments_137047.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n \n **Testing releases**:\n-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)\n-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n``````\n",
    "created_at": "2012-03-05T20:15:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137047",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 
 **Testing releases**:
-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gcc/)
-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta5-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
+2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
``````




---

archive/issue_comments_137048.json:
```json
{
    "body": "**Changing dependencies** from \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629\" to \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011\".",
    "created_at": "2012-03-06T13:24:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137048",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629" to "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011".



---

archive/attachments_017197.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12369_doc.patch",
    "asset_url": "tarball://root/attachments/ticket12369/12369_doc.patch",
    "created_at": "2012-03-06T14:31:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_137049.json:
```json
{
    "body": "<a id='comment:93'></a>\n**Attachment:** [12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch)",
    "created_at": "2012-03-06T14:31:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137049",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:93'></a>
**Attachment:** [12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch)



---

archive/issue_comments_137050.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,6 +5,7 @@\n **Apply**:\n 1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n+3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n **Testing releases**:\n 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n``````\n",
    "created_at": "2012-03-06T14:31:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137050",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,6 +5,7 @@
 **Apply**:
 1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
+3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
 **Testing releases**:
 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
``````




---

archive/issue_comments_137051.json:
```json
{
    "body": "<a id='comment:94'></a>\nUnfortunately, it seems that GCC 4.6.3 miscompiles PARI on OS X PPC 32-bit, reported upstream at http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52517",
    "created_at": "2012-03-06T23:47:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137051",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:94'></a>
Unfortunately, it seems that GCC 4.6.3 miscompiles PARI on OS X PPC 32-bit, reported upstream at http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52517



---

archive/issue_comments_137052.json:
```json
{
    "body": "<a id='comment:95'></a>\nWell, the old gcc works fine on OS X PPC, so we can just keep using that, right?",
    "created_at": "2012-03-07T01:31:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137052",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:95'></a>
Well, the old gcc works fine on OS X PPC, so we can just keep using that, right?



---

archive/issue_comments_137053.json:
```json
{
    "body": "<a id='comment:96'></a>\nYeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.",
    "created_at": "2012-03-07T01:42:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137053",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:96'></a>
Yeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.



---

archive/issue_comments_137054.json:
```json
{
    "body": "<a id='comment:97'></a>\nReplying to [kcrisman](#comment%3A96):\n> Yeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.\n\nWe need to build GCC to have Fortran.  Or we have to ship Fortran sources **and** binaries which makes no sense at all.\n\nYou could argue that we shouldn't use the `gcc` that we built.  But I would expect gcc-4.6.3 to be better than Apple's gcc-4.0.1 (even though it contains bugs).",
    "created_at": "2012-03-07T08:53:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137054",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:97'></a>
Replying to [kcrisman](#comment%3A96):
> Yeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.

We need to build GCC to have Fortran.  Or we have to ship Fortran sources **and** binaries which makes no sense at all.

You could argue that we shouldn't use the `gcc` that we built.  But I would expect gcc-4.6.3 to be better than Apple's gcc-4.0.1 (even though it contains bugs).



---

archive/issue_comments_137055.json:
```json
{
    "body": "**Changing dependencies** from \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011\" to \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638\".",
    "created_at": "2012-03-07T09:44:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137055",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011" to "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638".



---

archive/issue_comments_137056.json:
```json
{
    "body": "<a id='comment:99'></a>\nReplying to [jdemeyer](#comment%3A97):\n> Replying to [kcrisman](#comment%3A96):\n> > Yeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.\n\n> \n> We need to build GCC to have Fortran.  Or we have to ship Fortran sources **and** binaries which makes no sense at all.\n> \n\nOh, I see - I forgot about this replacing the Fortran.  \n\n> You could argue that we shouldn't use the `gcc` that we built.  But I would expect gcc-4.6.3 to be better than Apple's gcc-4.0.1 (even though it contains bugs).\n\nWell, but if it won't compile Pari, then maybe we should just stick with that.  Why not just use the old Apple-shipped gcc for 10.4 and 10.5 or something?  That seems very reasonable.  And cuts down on build time for already old slow systems.",
    "created_at": "2012-03-07T14:22:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137056",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:99'></a>
Replying to [jdemeyer](#comment%3A97):
> Replying to [kcrisman](#comment%3A96):
> > Yeah, I really don't see the need to build gcc on older Mac platforms at all.  This unnecessarily complicates things.  I understand if this is necessary for Lion, but might as well stick with what works for the others.

> 
> We need to build GCC to have Fortran.  Or we have to ship Fortran sources **and** binaries which makes no sense at all.
> 

Oh, I see - I forgot about this replacing the Fortran.  

> You could argue that we shouldn't use the `gcc` that we built.  But I would expect gcc-4.6.3 to be better than Apple's gcc-4.0.1 (even though it contains bugs).

Well, but if it won't compile Pari, then maybe we should just stick with that.  Why not just use the old Apple-shipped gcc for 10.4 and 10.5 or something?  That seems very reasonable.  And cuts down on build time for already old slow systems.



---

archive/issue_comments_137057.json:
```json
{
    "body": "<a id='comment:100'></a>\nReplying to [kcrisman](#comment%3A99):\n> Well, but if it won't compile Pari, then maybe we should just stick with that.\n\nIn the mean time, I posted a work-around for PARI at #12638.\n\n> And cuts down on build time for already old slow systems.\n\nSure, it will, but I don't think \"build time\" really matters.\n\nI much prefer run-time performance than build-time performance (if you really want the latter, compile everything with `-O0`).  And one would expect run-time performance to be better with more recent GCC versions (although it will change by at most a few percent).",
    "created_at": "2012-03-07T15:08:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137057",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:100'></a>
Replying to [kcrisman](#comment%3A99):
> Well, but if it won't compile Pari, then maybe we should just stick with that.

In the mean time, I posted a work-around for PARI at #12638.

> And cuts down on build time for already old slow systems.

Sure, it will, but I don't think "build time" really matters.

I much prefer run-time performance than build-time performance (if you really want the latter, compile everything with `-O0`).  And one would expect run-time performance to be better with more recent GCC versions (although it will change by at most a few percent).



---

archive/issue_comments_137058.json:
```json
{
    "body": "<a id='comment:1'></a>\nAnother argument pro GCC-4.6.3 is that fixing things to work with newer GCC versions usually improves portability in general.  For example, I don't think the miscompilation of PARI is specific to OS X PPC.  It would probably fail on Linux PPC too.",
    "created_at": "2012-03-07T15:10:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137058",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
Another argument pro GCC-4.6.3 is that fixing things to work with newer GCC versions usually improves portability in general.  For example, I don't think the miscompilation of PARI is specific to OS X PPC.  It would probably fail on Linux PPC too.



---

archive/issue_comments_137059.json:
```json
{
    "body": "<a id='comment:2'></a>\nI believe this is **ready for review** now.  I don't know of any regressions, in the following sense: for every system on which vanilla sage-5.0.beta7 works, also sage-5.0.beta7-gccdeps and sage-5.0.beta7-gcc work.\n\nIt even builds and passes all tests on OS X 10.7, but there is still a serious issue with ATLAS (#12011, causing a failure in the `cvxopt` test suite).  But I don't believe that should prevent a review of this ticket, as it's unrelated to GCC.",
    "created_at": "2012-03-07T15:30:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137059",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
I believe this is **ready for review** now.  I don't know of any regressions, in the following sense: for every system on which vanilla sage-5.0.beta7 works, also sage-5.0.beta7-gccdeps and sage-5.0.beta7-gcc work.

It even builds and passes all tests on OS X 10.7, but there is still a serious issue with ATLAS (#12011, causing a failure in the `cvxopt` test suite).  But I don't believe that should prevent a review of this ticket, as it's unrelated to GCC.



---

archive/issue_comments_137060.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,3 +10,8 @@\n **Testing releases**:\n 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n+\n+Neither of these releases contain a fixed ATLAS (#12011), as that's work in progress.\n+\n+For systems other than OS X, installing the \"gccdeps\" distribution is equivalent to installing the \"gcc\" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the \"gcc\" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.\n+\n``````\n",
    "created_at": "2012-03-07T15:30:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137060",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,3 +10,8 @@
 **Testing releases**:
 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
+
+Neither of these releases contain a fixed ATLAS (#12011), as that's work in progress.
+
+For systems other than OS X, installing the "gccdeps" distribution is equivalent to installing the "gcc" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the "gcc" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.
+
``````




---

archive/issue_events_101304.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-07T15:30:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101304"
}
```



---

archive/issue_comments_137061.json:
```json
{
    "body": "<a id='comment:103'></a>\n> > Well, but if it won't compile Pari, then maybe we should just stick with that.\n\n> In the mean time, I posted a work-around for PARI at #12638.\n> \n> > And cuts down on build time for already old slow systems.\n\n> Sure, it will, but I don't think \"build time\" really matters.\n\nWell, all fair enough.  Just want to make sure I'm asking the questions, even if they're dumb :)",
    "created_at": "2012-03-07T16:39:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137061",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:103'></a>
> > Well, but if it won't compile Pari, then maybe we should just stick with that.

> In the mean time, I posted a work-around for PARI at #12638.
> 
> > And cuts down on build time for already old slow systems.

> Sure, it will, but I don't think "build time" really matters.

Well, all fair enough.  Just want to make sure I'm asking the questions, even if they're dumb :)



---

archive/issue_comments_137062.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,7 +11,7 @@\n 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n \n-Neither of these releases contain a fixed ATLAS (#12011), as that's work in progress.\n+Neither of these releases contain a fix for cvxopt on OS X 10.7 (#12011), as that's work in progress.\n \n For systems other than OS X, installing the \"gccdeps\" distribution is equivalent to installing the \"gcc\" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the \"gcc\" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.\n \n``````\n",
    "created_at": "2012-03-11T21:40:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137062",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,7 +11,7 @@
 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
 
-Neither of these releases contain a fixed ATLAS (#12011), as that's work in progress.
+Neither of these releases contain a fix for cvxopt on OS X 10.7 (#12011), as that's work in progress.
 
 For systems other than OS X, installing the "gccdeps" distribution is equivalent to installing the "gcc" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the "gcc" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.
 
``````




---

archive/issue_comments_137063.json:
```json
{
    "body": "**Changing dependencies** from \"#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638\" to \"#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638\".",
    "created_at": "2012-03-11T21:41:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137063",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638" to "#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638".



---

archive/issue_comments_137064.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n+The aim is to add a GCC package (GNU compiler collection) to Sage with compilers for C, C++ and Fortran.  We don't always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n \n``````\n",
    "created_at": "2012-03-11T21:44:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137064",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The aim is to add a gcc package to Sage.  We probably don't want to always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
+The aim is to add a GCC package (GNU compiler collection) to Sage with compilers for C, C++ and Fortran.  We don't always build it, we would install it by default only on systems where this is needed.  This would replace the fortran package.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)
 
``````




---

archive/issue_comments_137065.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,7 +11,5 @@\n 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n \n-Neither of these releases contain a fix for cvxopt on OS X 10.7 (#12011), as that's work in progress.\n-\n For systems other than OS X, installing the \"gccdeps\" distribution is equivalent to installing the \"gcc\" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the \"gcc\" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.\n \n``````\n",
    "created_at": "2012-03-12T08:17:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137065",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,7 +11,5 @@
 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
 
-Neither of these releases contain a fix for cvxopt on OS X 10.7 (#12011), as that's work in progress.
-
 For systems other than OS X, installing the "gccdeps" distribution is equivalent to installing the "gcc" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the "gcc" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.
 
``````




---

archive/issue_comments_137066.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638\" to \"#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638\".",
    "created_at": "2012-03-12T08:17:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137066",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12011, #12638" to "#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638".



---

archive/issue_comments_137067.json:
```json
{
    "body": "<a id='comment:8'></a>\nBuilding the gcc spkg really takes an awful lot of time.\n\nOne question: If I want to rebuild Sage with the compiler built by the spkg, perhaps with additional optimizations (provided that the gcc-spkg is able to pick up my system-wide `CLooG` or I manage to make a `CLooG` spkg), how could I do so?\n\nOf course, `sage -ba` would recompile all Cython code in the Sage library, but it would not re-install the spkgs. Is there an easy way to install all standard packages from scratch? I am not talking about an automatic re-installation of the optional packages.\n\nIn particular, would it work to remove all entries in `SAGE_ROOT/spkg/installed` that correspond to standard packages, and do `make` again? Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?",
    "created_at": "2012-03-13T16:36:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137067",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:8'></a>
Building the gcc spkg really takes an awful lot of time.

One question: If I want to rebuild Sage with the compiler built by the spkg, perhaps with additional optimizations (provided that the gcc-spkg is able to pick up my system-wide `CLooG` or I manage to make a `CLooG` spkg), how could I do so?

Of course, `sage -ba` would recompile all Cython code in the Sage library, but it would not re-install the spkgs. Is there an easy way to install all standard packages from scratch? I am not talking about an automatic re-installation of the optional packages.

In particular, would it work to remove all entries in `SAGE_ROOT/spkg/installed` that correspond to standard packages, and do `make` again? Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?



---

archive/issue_comments_137068.json:
```json
{
    "body": "<a id='comment:109'></a>\nReplying to [SimonKing](#comment%3A108):\n> Of course, `sage -ba` would recompile all Cython code in the Sage library, but it would not re-install the spkgs. Is there an easy way to install all standard packages from scratch? I am not talking about an automatic re-installation of the optional packages.\n> \n> In particular, would it work to remove all entries in `SAGE_ROOT/spkg/installed` that correspond to standard packages, and do `make` again?\n\nYes, that should work.\n\n> Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?\n\nI honestly have no idea what would happen if you re-install the Sage library over a patched version.",
    "created_at": "2012-03-13T16:46:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137068",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:109'></a>
Replying to [SimonKing](#comment%3A108):
> Of course, `sage -ba` would recompile all Cython code in the Sage library, but it would not re-install the spkgs. Is there an easy way to install all standard packages from scratch? I am not talking about an automatic re-installation of the optional packages.
> 
> In particular, would it work to remove all entries in `SAGE_ROOT/spkg/installed` that correspond to standard packages, and do `make` again?

Yes, that should work.

> Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?

I honestly have no idea what would happen if you re-install the Sage library over a patched version.



---

archive/issue_comments_137069.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638\" to \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638\".",
    "created_at": "2012-03-13T17:01:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137069",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638" to "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638".



---

archive/issue_comments_137070.json:
```json
{
    "body": "<a id='comment:1'></a>\nHooray, the spkg did install, and it did early enough that I will catch the next bus. But it took long enough that I missed two buses...\n\nOn [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/4e90520289b7b5ba), we discussed whether the gcc package would pick up a system wide installation of `CLooG`. In the install log of the spkg, I do find lines such as\n\n```\ngcc -c   -O0 -DIN_GCC   -W -Wall -Wwrite-strings -Wcast-qual -Wstrict-prototypes -Wmissing-prototypes -Wmissing-format-attribute -pedantic -Wno-long-long -Wno-variadic-macros -Wno-overlength-strings -Wold-style-definition -Wc++-compat -fno-common  -DHAVE_CONFIG_H -I. -I. -I../../src/gcc -I../../src/gcc/. -I../../src/gcc/../include -I../../src/gcc/../libcpp/include -I/home/simon/SAGE/sage-5.0.beta7/local/include -I/home/simon/SAGE/sage-5.0.beta7/local/include -I/home/simon/SAGE/sage-5.0.beta7/local/include  -I../../src/gcc/../libdecnumber -I../../src/gcc/../libdecnumber/bid -I../libdecnumber    ../../src/gcc/graphite-cloog-util.c -o graphite-cloog-util.o\n```\n\nDoes that mean that `CLooG/graphite` will work?\n\nHere is [the log](http://sage.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log).",
    "created_at": "2012-03-13T18:42:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137070",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
Hooray, the spkg did install, and it did early enough that I will catch the next bus. But it took long enough that I missed two buses...

On [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/4e90520289b7b5ba), we discussed whether the gcc package would pick up a system wide installation of `CLooG`. In the install log of the spkg, I do find lines such as

```
gcc -c   -O0 -DIN_GCC   -W -Wall -Wwrite-strings -Wcast-qual -Wstrict-prototypes -Wmissing-prototypes -Wmissing-format-attribute -pedantic -Wno-long-long -Wno-variadic-macros -Wno-overlength-strings -Wold-style-definition -Wc++-compat -fno-common  -DHAVE_CONFIG_H -I. -I. -I../../src/gcc -I../../src/gcc/. -I../../src/gcc/../include -I../../src/gcc/../libcpp/include -I/home/simon/SAGE/sage-5.0.beta7/local/include -I/home/simon/SAGE/sage-5.0.beta7/local/include -I/home/simon/SAGE/sage-5.0.beta7/local/include  -I../../src/gcc/../libdecnumber -I../../src/gcc/../libdecnumber/bid -I../libdecnumber    ../../src/gcc/graphite-cloog-util.c -o graphite-cloog-util.o
```

Does that mean that `CLooG/graphite` will work?

Here is [the log](http://sage.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log).



---

archive/issue_comments_137071.json:
```json
{
    "body": "<a id='comment:2'></a>\nOn sage-devel, Jeroen said that I should look in the configure part of the log. There, I can not find `CLooG` mentioned. Am I right? If that is the case, then I would try to add an optional `CLooG` spkg, which could then use the gmp-5.0.4 spkg.",
    "created_at": "2012-03-13T18:48:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137071",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:2'></a>
On sage-devel, Jeroen said that I should look in the configure part of the log. There, I can not find `CLooG` mentioned. Am I right? If that is the case, then I would try to add an optional `CLooG` spkg, which could then use the gmp-5.0.4 spkg.



---

archive/issue_comments_137072.json:
```json
{
    "body": "<a id='comment:113'></a>\nReplying to [SimonKing](#comment%3A111):\n> Does that mean that `CLooG/graphite` will work?\n\nNo, because it can't find PPL:\n\n```\nchecking for version 0.11 (revision 0 or later) of PPL... no\n```\nIf PPL isn't found, then GCC doesn't even bother looking for CLooG.\n\nI will change the GCC spkg such that it looks for PPL in `$SAGE_LOCAL`.",
    "created_at": "2012-03-13T20:02:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137072",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:113'></a>
Replying to [SimonKing](#comment%3A111):
> Does that mean that `CLooG/graphite` will work?

No, because it can't find PPL:

```
checking for version 0.11 (revision 0 or later) of PPL... no
```
If PPL isn't found, then GCC doesn't even bother looking for CLooG.

I will change the GCC spkg such that it looks for PPL in `$SAGE_LOCAL`.



---

archive/issue_comments_137073.json:
```json
{
    "body": "<a id='comment:4'></a>\nHmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.",
    "created_at": "2012-03-13T20:11:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137073",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Hmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.



---

archive/issue_comments_137074.json:
```json
{
    "body": "<a id='comment:115'></a>\nReplying to [jdemeyer](#comment%3A114):\n> Hmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.\n\n:((\n\nAnyway. I thought it would not hurt to create an optional `CLooG` spkg: See #12666.\n\nThe upgraded optional gmp spkg is at #12661.",
    "created_at": "2012-03-13T20:28:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137074",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:115'></a>
Replying to [jdemeyer](#comment%3A114):
> Hmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.

:((

Anyway. I thought it would not hurt to create an optional `CLooG` spkg: See #12666.

The upgraded optional gmp spkg is at #12661.



---

archive/issue_comments_137075.json:
```json
{
    "body": "<a id='comment:116'></a>\nReplying to [jdemeyer](#comment%3A114):\n> Hmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.\n\nThere is ppl.hh provided by the PPL spkg. But I can not find ppl_c.h in the spkg's sources, and also I can not find any mention of ppl_c.h in the spkg's install log.\n\nSo, where could ppl_c.h come from?",
    "created_at": "2012-03-13T23:06:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137075",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:116'></a>
Replying to [jdemeyer](#comment%3A114):
> Hmm, the problem is not with GCC, but with the PPL in Sage.  It seems Sage-PPL doesn't install `ppl_c.h` which is needed for GCC.  I don't know more about this.

There is ppl.hh provided by the PPL spkg. But I can not find ppl_c.h in the spkg's sources, and also I can not find any mention of ppl_c.h in the spkg's install log.

So, where could ppl_c.h come from?



---

archive/issue_comments_137076.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe PPL spkg does not install the C interface since we only use the native C++ interface in Sage. It would be easy to also build the C interface but I don't quite understand where we are heading here. Nobody is going to have a usable CLooG/Graphite laying around without a working GCC build. On Linux its easier to install a fully working GCC than just CLooG, I daresay. And a quick grep through the install.log suggests that nothing is being built with `-floop*` options.",
    "created_at": "2012-03-13T23:12:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137076",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
The PPL spkg does not install the C interface since we only use the native C++ interface in Sage. It would be easy to also build the C interface but I don't quite understand where we are heading here. Nobody is going to have a usable CLooG/Graphite laying around without a working GCC build. On Linux its easier to install a fully working GCC than just CLooG, I daresay. And a quick grep through the install.log suggests that nothing is being built with `-floop*` options.



---

archive/issue_comments_137077.json:
```json
{
    "body": "<a id='comment:118'></a>\nReplying to [vbraun](#comment%3A117):\n> I don't quite understand where we are heading here.\n\nI guess Simon's idea is to have an optional CLooG spkg in Sage, such that people could build Sage's GCC with PPL+CLooG.",
    "created_at": "2012-03-13T23:20:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137077",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:118'></a>
Replying to [vbraun](#comment%3A117):
> I don't quite understand where we are heading here.

I guess Simon's idea is to have an optional CLooG spkg in Sage, such that people could build Sage's GCC with PPL+CLooG.



---

archive/issue_comments_137078.json:
```json
{
    "body": "<a id='comment:119'></a>\nReplying to [jdemeyer](#comment%3A118):\n> Replying to [vbraun](#comment%3A117):\n> > I don't quite understand where we are heading here.\n\n> \n> I guess Simon's idea is to have an optional CLooG spkg in Sage, such that people could build Sage's GCC with PPL+CLooG.\n\nYes. And of course `-floop*` options aren't used - yet. But according to some statement on sage-devel, sometimes 30% more speed is possible with such options. So, I am curious whether I'd obtain a noticeable speed difference when I add those kind of options to CFLAGS/CXXFLAGS and do sage -ba.",
    "created_at": "2012-03-13T23:38:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137078",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:119'></a>
Replying to [jdemeyer](#comment%3A118):
> Replying to [vbraun](#comment%3A117):
> > I don't quite understand where we are heading here.

> 
> I guess Simon's idea is to have an optional CLooG spkg in Sage, such that people could build Sage's GCC with PPL+CLooG.

Yes. And of course `-floop*` options aren't used - yet. But according to some statement on sage-devel, sometimes 30% more speed is possible with such options. So, I am curious whether I'd obtain a noticeable speed difference when I add those kind of options to CFLAGS/CXXFLAGS and do sage -ba.



---

archive/issue_comments_137079.json:
```json
{
    "body": "<a id='comment:120'></a>\nReplying to [vbraun](#comment%3A117):\n> The PPL spkg does not install the C interface since we only use the native C++ interface in Sage. \n\nThank you! I changed the ppl spkg's install script accordingly, and now I have ppl_c.h in `SAGE_LOCAL/include`.",
    "created_at": "2012-03-13T23:45:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137079",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:120'></a>
Replying to [vbraun](#comment%3A117):
> The PPL spkg does not install the C interface since we only use the native C++ interface in Sage. 

Thank you! I changed the ppl spkg's install script accordingly, and now I have ppl_c.h in `SAGE_LOCAL/include`.



---

archive/issue_comments_137080.json:
```json
{
    "body": "<a id='comment:121'></a>\nReplying to [SimonKing](#comment%3A120):\n> Replying to [vbraun](#comment%3A117):\n> > The PPL spkg does not install the C interface since we only use the native C++ interface in Sage. \n\n> \n> Thank you! I changed the ppl spkg's install script accordingly, and now I have ppl_c.h in `SAGE_LOCAL/include`.\n\nIt didn't help, I'm afraid.\n\nI have ppl_c.h, I have GMP, and I have `CLooG`. However, when building the GCC spkg again, the log contains the line\n\n```\nchecking for installed CLooG PPL Legacy... no\n```\nAny idea what is missing? I am afraid that I was not able to copy the log to sage.math, but I'll try again later.",
    "created_at": "2012-03-14T06:31:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137080",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:121'></a>
Replying to [SimonKing](#comment%3A120):
> Replying to [vbraun](#comment%3A117):
> > The PPL spkg does not install the C interface since we only use the native C++ interface in Sage. 

> 
> Thank you! I changed the ppl spkg's install script accordingly, and now I have ppl_c.h in `SAGE_LOCAL/include`.

It didn't help, I'm afraid.

I have ppl_c.h, I have GMP, and I have `CLooG`. However, when building the GCC spkg again, the log contains the line

```
checking for installed CLooG PPL Legacy... no
```
Any idea what is missing? I am afraid that I was not able to copy the log to sage.math, but I'll try again later.



---

archive/issue_comments_137081.json:
```json
{
    "body": "<a id='comment:2'></a>\nIs it perhaps needed to build `CLooG` again after building PPL with C interface? At least this is what I am trying now.",
    "created_at": "2012-03-14T06:37:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137081",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:2'></a>
Is it perhaps needed to build `CLooG` again after building PPL with C interface? At least this is what I am trying now.



---

archive/issue_comments_137082.json:
```json
{
    "body": "<a id='comment:123'></a>\nReplying to [SimonKing](#comment%3A122):\n> Is it perhaps needed to build `CLooG` again after building PPL with C interface? \n\nNo, it doesn't work. It still says there is no `CLooG PPL Legacy`.",
    "created_at": "2012-03-14T06:40:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137082",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:123'></a>
Replying to [SimonKing](#comment%3A122):
> Is it perhaps needed to build `CLooG` again after building PPL with C interface? 

No, it doesn't work. It still says there is no `CLooG PPL Legacy`.



---

archive/issue_comments_137083.json:
```json
{
    "body": "<a id='comment:4'></a>\nCould it be that there is an important difference between cloog and cloog-ppl?\n\nGoogle pointed me to cloog-ppl, but I could not find sources (although it seems to be a different package than cloog).",
    "created_at": "2012-03-14T06:54:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137083",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
Could it be that there is an important difference between cloog and cloog-ppl?

Google pointed me to cloog-ppl, but I could not find sources (although it seems to be a different package than cloog).



---

archive/issue_comments_137084.json:
```json
{
    "body": "<a id='comment:5'></a>\nI found cloog-ppl sources. But there's the next problem. It says:\n\n```\n...\nCan't find PolyLib.\nchecking for Parma Polyhedral Library (PPL)... not using PPL\n...\nIn file included from source/block.c:41:0:\nsource/../include/cloog/cloog.h:47:30: schwerwiegender Fehler: polylib/missing.h: Datei oder Verzeichnis nicht gefunden\nKompilierung beendet.\n```\n\n`PolyLib` is not listed as a dependency, but ppl is.\n\nSo, why is it (still!) claimed that we are not using PPL, even though we have ppl_c.h and ppl.hh???\n\nI apologize for the fact that it is slightly off topic - but I'd still like to learn how to build your gcc spkg with `-floop*` support.",
    "created_at": "2012-03-14T07:10:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137084",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
I found cloog-ppl sources. But there's the next problem. It says:

```
...
Can't find PolyLib.
checking for Parma Polyhedral Library (PPL)... not using PPL
...
In file included from source/block.c:41:0:
source/../include/cloog/cloog.h:47:30: schwerwiegender Fehler: polylib/missing.h: Datei oder Verzeichnis nicht gefunden
Kompilierung beendet.
```

`PolyLib` is not listed as a dependency, but ppl is.

So, why is it (still!) claimed that we are not using PPL, even though we have ppl_c.h and ppl.hh???

I apologize for the fact that it is slightly off topic - but I'd still like to learn how to build your gcc spkg with `-floop*` support.



---

archive/issue_comments_137085.json:
```json
{
    "body": "<a id='comment:126'></a>\nReplying to [SimonKing](#comment%3A125):\n> Can't find PolyLib.\n> checking for Parma Polyhedral Library (PPL)... not using PPL\n\nHooray! in my cloog_ppl spkg (not submitted yet) I had simply forgotten to add `--with-ppl` to the configuration.\nAnd now, your gcc package says\n\n```\nchecking for installed CLooG PPL Legacy... PPL Legacy\nchecking for version 0.15.5 (or later revision) of CLooG... yes\n```",
    "created_at": "2012-03-14T07:18:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137085",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:126'></a>
Replying to [SimonKing](#comment%3A125):
> Can't find PolyLib.
> checking for Parma Polyhedral Library (PPL)... not using PPL

Hooray! in my cloog_ppl spkg (not submitted yet) I had simply forgotten to add `--with-ppl` to the configuration.
And now, your gcc package says

```
checking for installed CLooG PPL Legacy... PPL Legacy
checking for version 0.15.5 (or later revision) of CLooG... yes
```



---

archive/issue_comments_137086.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n **Testing releases**:\n-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)\n+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/)\n 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n \n For systems other than OS X, installing the \"gccdeps\" distribution is equivalent to installing the \"gcc\" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the \"gcc\" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.\n``````\n",
    "created_at": "2012-03-14T07:58:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137086",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
 **Testing releases**:
-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gcc/)
+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/)
 2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
 
 For systems other than OS X, installing the "gccdeps" distribution is equivalent to installing the "gcc" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the "gcc" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.
``````




---

archive/issue_comments_137087.json:
```json
{
    "body": "<a id='comment:8'></a>\nNot good.\n\nAfter building the compiler with `CLooG PPL` support, I tried to rebuild Sage with \n\n```\nCFLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"\nexport CFLAGS\nCXXFLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"\nexport CXXFLAGS\n```\nThis is what (I think) was suggested on sage-devel.\n\nHowever, it failed very early: It was found that the compiler can not build executables. The compiler was referred to not as gcc, but as\n\n```\n### Compiler was: gcc -g -O3 -march=native -floop-interchange -floop-strip-mine -floop-block\n```\n\nSo, could it be that I misunderstood and the flags have to be passed in a different way?",
    "created_at": "2012-03-14T13:56:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137087",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:8'></a>
Not good.

After building the compiler with `CLooG PPL` support, I tried to rebuild Sage with 

```
CFLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"
export CFLAGS
CXXFLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"
export CXXFLAGS
```
This is what (I think) was suggested on sage-devel.

However, it failed very early: It was found that the compiler can not build executables. The compiler was referred to not as gcc, but as

```
### Compiler was: gcc -g -O3 -march=native -floop-interchange -floop-strip-mine -floop-block
```

So, could it be that I misunderstood and the flags have to be passed in a different way?



---

archive/issue_comments_137088.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn the gcc man pages, I read\n\nThis optimization applies to all the languages supported by GCC and is not limited to Fortran.  To use this code transformation, GCC has to be configured with --with-ppl and --with-cloog to enable the Graphite loop transformation infrastructure.\n\nBut these to options are in fact not used in the gcc spkg!\n\nI am trying to add them (and also providing --libdir, which in some cases seems to be needed on openSuse) and try to build gcc again.",
    "created_at": "2012-03-14T14:03:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137088",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:9'></a>
In the gcc man pages, I read

This optimization applies to all the languages supported by GCC and is not limited to Fortran.  To use this code transformation, GCC has to be configured with --with-ppl and --with-cloog to enable the Graphite loop transformation infrastructure.

But these to options are in fact not used in the gcc spkg!

I am trying to add them (and also providing --libdir, which in some cases seems to be needed on openSuse) and try to build gcc again.



---

archive/issue_comments_137089.json:
```json
{
    "body": "<a id='comment:0'></a>\nI'm pretty sure that compiling everything with -O3 + graphite will break, but I applaud your heroic effort ;-)\n\nFor the record, here is Fedora's gcc configure, that's at least one data point for how to build it:\n\n```\n[vbraun@volker-laptop-two ~]$ gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/4.6.2/lto-wrapper\nTarget: x86_64-redhat-linux\nConfigured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux\nThread model: posix\ngcc version 4.6.2 20111027 (Red Hat 4.6.2-1) (GCC) \n```\nIt seems like you don't need any magic beyond `--with-ppl` and `--with-cloog`",
    "created_at": "2012-03-14T14:26:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137089",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:0'></a>
I'm pretty sure that compiling everything with -O3 + graphite will break, but I applaud your heroic effort ;-)

For the record, here is Fedora's gcc configure, that's at least one data point for how to build it:

```
[vbraun@volker-laptop-two ~]$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/4.6.2/lto-wrapper
Target: x86_64-redhat-linux
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux
Thread model: posix
gcc version 4.6.2 20111027 (Red Hat 4.6.2-1) (GCC) 
```
It seems like you don't need any magic beyond `--with-ppl` and `--with-cloog`



---

archive/issue_comments_137090.json:
```json
{
    "body": "<a id='comment:131'></a>\nReplying to [vbraun](#comment%3A130):\n> It seems like you don't need any magic beyond `--with-ppl` and `--with-cloog`\n\nExactly. But the current version of this optional gcc spkg does not contain the magic.\n\nAnyway. I am now building gcc again (after adding the magical options to spkg-install) and will report later about my heroic failures.",
    "created_at": "2012-03-14T14:30:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137090",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:131'></a>
Replying to [vbraun](#comment%3A130):
> It seems like you don't need any magic beyond `--with-ppl` and `--with-cloog`

Exactly. But the current version of this optional gcc spkg does not contain the magic.

Anyway. I am now building gcc again (after adding the magical options to spkg-install) and will report later about my heroic failures.



---

archive/issue_comments_137091.json:
```json
{
    "body": "<a id='comment:132'></a>\nReplying to [SimonKing](#comment%3A131):\n> Exactly. But the current version of this optional gcc spkg does not contain the magic.\n\nI don't mind adding support for this in a follow-up spkg (it's not entirely trivial, because we have to check whether CLooG is installed or not).  I prefer to wait until this is reviewed and merged, to avoid rebasing in case the current spkg has problems.",
    "created_at": "2012-03-14T15:44:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137091",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:132'></a>
Replying to [SimonKing](#comment%3A131):
> Exactly. But the current version of this optional gcc spkg does not contain the magic.

I don't mind adding support for this in a follow-up spkg (it's not entirely trivial, because we have to check whether CLooG is installed or not).  I prefer to wait until this is reviewed and merged, to avoid rebasing in case the current spkg has problems.



---

archive/issue_comments_137092.json:
```json
{
    "body": "<a id='comment:133'></a>\nReplying to [jdemeyer](#comment%3A132):\n> Replying to [SimonKing](#comment%3A131):\n> I don't mind adding support for this in a follow-up spkg (it's not entirely trivial, because we have to check whether CLooG is installed or not).\n\nOK. But to check whether `CLooG` is installed should not be difficult (at least: to check whether a `CLooG` spkg is installed should be easy).\n\n>    I prefer to wait until this is reviewed and merged, to avoid rebasing in case the current spkg has problems.\n\nOK. But I will keep trying (and I just lost an hour compilation time because of a typo).",
    "created_at": "2012-03-14T15:54:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137092",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:133'></a>
Replying to [jdemeyer](#comment%3A132):
> Replying to [SimonKing](#comment%3A131):
> I don't mind adding support for this in a follow-up spkg (it's not entirely trivial, because we have to check whether CLooG is installed or not).

OK. But to check whether `CLooG` is installed should not be difficult (at least: to check whether a `CLooG` spkg is installed should be easy).

>    I prefer to wait until this is reviewed and merged, to avoid rebasing in case the current spkg has problems.

OK. But I will keep trying (and I just lost an hour compilation time because of a typo).



---

archive/issue_comments_137093.json:
```json
{
    "body": "<a id='comment:134'></a>\nReplying to [SimonKing](#comment%3A133):\n> But to check whether `CLooG` is installed should not be difficult\n\nSee #12609 which deals with this kind of checks.",
    "created_at": "2012-03-14T16:06:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137093",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:134'></a>
Replying to [SimonKing](#comment%3A133):
> But to check whether `CLooG` is installed should not be difficult

See #12609 which deals with this kind of checks.



---

archive/issue_comments_137094.json:
```json
{
    "body": "<a id='comment:135'></a>\nReplying to [vbraun](#comment%3A130):\n> I'm pretty sure that compiling everything with -O3 + graphite will break, but I applaud your heroic effort ;-)\n\nThen you might be surprised that the following worked:\n\n* Build gcc via the spkg\n* Build ppl (with c interface), gmp and cloog-ppl, using\n\n   ```\n   CFLAGS=\"-O3 -march=native\"\n   CXXFLAGS=\"-O3 -march=native\"\n  ```\n* Build gcc again, via the modified spkg (--with-ppl --with-cloog), again with `-O3 -march=native`.\n* Build all of Sage again (all spkgs and sage -ba), using\n\n   ```\n   CFLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"\n   CXXFLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"\n  ```\n* Run more than half of `sage -testall` without error.\n\nNevertheless, it was a heroic failure.\n\nHere are some test times without optimisation, for sage-5.0.beta7 built with my system gcc-4.6.2:\n\n```\nsage -t  -force_lib \"devel/sage/sage/symbolic/function.pyx\" \n         [3.2 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/benchmark.py\" \n         [8.6 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/function_factory.py\"\n         [2.5 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/ring.pyx\"     \n         [4.0 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/relation.py\"  \n         [9.4 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/maxima_wrapper.py\"\n         [2.9 s]\n```\nHere are the same tests, using full optimization, using the gcc-4.6.3 from the spkg with graphite:\n\n```\nsage -t  -force_lib \"devel/sage/sage/symbolic/function.pyx\" \n         [8.0 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/benchmark.py\" \n         [17.4 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/function_factory.py\"\n         [5.7 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/ring.pyx\"     \n         [7.8 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/relation.py\"  \n         [23.7 s]\nsage -t  -force_lib \"devel/sage/sage/symbolic/maxima_wrapper.py\"\n         [43.5 s]\n```\n\nWhat kind of optimization is it, if it makes things MASSIVELY slower???",
    "created_at": "2012-03-15T12:43:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137094",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:135'></a>
Replying to [vbraun](#comment%3A130):
> I'm pretty sure that compiling everything with -O3 + graphite will break, but I applaud your heroic effort ;-)

Then you might be surprised that the following worked:

* Build gcc via the spkg
* Build ppl (with c interface), gmp and cloog-ppl, using

   ```
   CFLAGS="-O3 -march=native"
   CXXFLAGS="-O3 -march=native"
  ```
* Build gcc again, via the modified spkg (--with-ppl --with-cloog), again with `-O3 -march=native`.
* Build all of Sage again (all spkgs and sage -ba), using

   ```
   CFLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"
   CXXFLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"
  ```
* Run more than half of `sage -testall` without error.

Nevertheless, it was a heroic failure.

Here are some test times without optimisation, for sage-5.0.beta7 built with my system gcc-4.6.2:

```
sage -t  -force_lib "devel/sage/sage/symbolic/function.pyx" 
         [3.2 s]
sage -t  -force_lib "devel/sage/sage/symbolic/benchmark.py" 
         [8.6 s]
sage -t  -force_lib "devel/sage/sage/symbolic/function_factory.py"
         [2.5 s]
sage -t  -force_lib "devel/sage/sage/symbolic/ring.pyx"     
         [4.0 s]
sage -t  -force_lib "devel/sage/sage/symbolic/relation.py"  
         [9.4 s]
sage -t  -force_lib "devel/sage/sage/symbolic/maxima_wrapper.py"
         [2.9 s]
```
Here are the same tests, using full optimization, using the gcc-4.6.3 from the spkg with graphite:

```
sage -t  -force_lib "devel/sage/sage/symbolic/function.pyx" 
         [8.0 s]
sage -t  -force_lib "devel/sage/sage/symbolic/benchmark.py" 
         [17.4 s]
sage -t  -force_lib "devel/sage/sage/symbolic/function_factory.py"
         [5.7 s]
sage -t  -force_lib "devel/sage/sage/symbolic/ring.pyx"     
         [7.8 s]
sage -t  -force_lib "devel/sage/sage/symbolic/relation.py"  
         [23.7 s]
sage -t  -force_lib "devel/sage/sage/symbolic/maxima_wrapper.py"
         [43.5 s]
```

What kind of optimization is it, if it makes things MASSIVELY slower???



---

archive/issue_comments_137095.json:
```json
{
    "body": "<a id='comment:6'></a>\nI would be interesting to compare the timings with my GCC spkg, without PPL or CLooG.",
    "created_at": "2012-03-15T13:04:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137095",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
I would be interesting to compare the timings with my GCC spkg, without PPL or CLooG.



---

archive/issue_comments_137096.json:
```json
{
    "body": "<a id='comment:7'></a>\nAlso: can you try exactly the same without building gmp?",
    "created_at": "2012-03-15T13:07:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Also: can you try exactly the same without building gmp?



---

archive/issue_comments_137097.json:
```json
{
    "body": "<a id='comment:138'></a>\nReplying to [jdemeyer](#comment%3A137):\n> Also: can you try exactly the same without building gmp?\n\nThe first thing that I had tried was building CLooG in the Sage shell. It failed during configuration and complained that it needs GMP. So, unless there is a configuration option, I don't see how MPIR could suffice.",
    "created_at": "2012-03-15T13:13:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137097",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:138'></a>
Replying to [jdemeyer](#comment%3A137):
> Also: can you try exactly the same without building gmp?

The first thing that I had tried was building CLooG in the Sage shell. It failed during configuration and complained that it needs GMP. So, unless there is a configuration option, I don't see how MPIR could suffice.



---

archive/issue_comments_137098.json:
```json
{
    "body": "<a id='comment:9'></a>\nWell, it could be that GMP slowed things down, not GCC.",
    "created_at": "2012-03-15T13:16:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137098",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Well, it could be that GMP slowed things down, not GCC.



---

archive/issue_comments_137099.json:
```json
{
    "body": "<a id='comment:140'></a>\nReplying to [jdemeyer](#comment%3A136):\n> I would be interesting to compare the timings with my GCC spkg, without PPL or CLooG.\n\nI wonder: How could I apply all the patches to the sage root/extcode/lib repositories before Sage is built?\n\nOr do you suggest that I start with my existing sage-5.0.beta7, and do the following:\n\n* `rm $SAGE_LOCAL/*/*gcc*`\n* `rm -r $SAGE_LOCAL/*/*gmp*`\n* `rm $SAGE_ROOT/spkg/installed/*`\n* do `sage -f gcc-4.6.3.spkg`, without setting compilation flags, and without the `--with-ppl --with-cloog` options; this would be built using my system's gcc, because of the first step\n* do `make`, which would then use the spkg's gcc",
    "created_at": "2012-03-15T13:25:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137099",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:140'></a>
Replying to [jdemeyer](#comment%3A136):
> I would be interesting to compare the timings with my GCC spkg, without PPL or CLooG.

I wonder: How could I apply all the patches to the sage root/extcode/lib repositories before Sage is built?

Or do you suggest that I start with my existing sage-5.0.beta7, and do the following:

* `rm $SAGE_LOCAL/*/*gcc*`
* `rm -r $SAGE_LOCAL/*/*gmp*`
* `rm $SAGE_ROOT/spkg/installed/*`
* do `sage -f gcc-4.6.3.spkg`, without setting compilation flags, and without the `--with-ppl --with-cloog` options; this would be built using my system's gcc, because of the first step
* do `make`, which would then use the spkg's gcc



---

archive/issue_comments_137100.json:
```json
{
    "body": "<a id='comment:1'></a>\nNo, my previous sage-5.0.beta7 is totally messed up. I have to start from scratch.\n\nI don't know how to do the following cleanly. Anyway, my plan is:\n\n* untar the source ball\n* type make, wait a few seconds, and interrupt, so that \"./sage -sh\" is available\n* replace the old pari and ppl spkgs by the new ones\n* provide `C(XX)FLAGS=\"-O3 -march=native\"`\n* install the standard mpir spkg\n* install the standard (updated) ppl spkg (this is what I am doing right now)\n* install the cloog_ppl spkg\n* install the optional mpc spkg (I lost track where I got that from...).\n* install the modified gcc spkg (using `--with-ppl=\"$SAGE_LOCAL\" --with-cloog=\"$SAGE_LOCAL\"`)\n* switch to `C(XX)FLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"`\n* type make and keep fingers crossed.",
    "created_at": "2012-03-15T14:29:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137100",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
No, my previous sage-5.0.beta7 is totally messed up. I have to start from scratch.

I don't know how to do the following cleanly. Anyway, my plan is:

* untar the source ball
* type make, wait a few seconds, and interrupt, so that "./sage -sh" is available
* replace the old pari and ppl spkgs by the new ones
* provide `C(XX)FLAGS="-O3 -march=native"`
* install the standard mpir spkg
* install the standard (updated) ppl spkg (this is what I am doing right now)
* install the cloog_ppl spkg
* install the optional mpc spkg (I lost track where I got that from...).
* install the modified gcc spkg (using `--with-ppl="$SAGE_LOCAL" --with-cloog="$SAGE_LOCAL"`)
* switch to `C(XX)FLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"`
* type make and keep fingers crossed.



---

archive/issue_comments_137101.json:
```json
{
    "body": "<a id='comment:142'></a>\nReplying to [SimonKing](#comment%3A141):\n> * type make, wait a few seconds, and interrupt, so that \"./sage -sh\" is available\n\n`./sage --sh` should be available right after untarring.  This was a consequence of #11073.\n\n> * install the optional mpc spkg (I lost track where I got that from...)\n\n#12515 (GCC needs it)",
    "created_at": "2012-03-15T14:35:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137101",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:142'></a>
Replying to [SimonKing](#comment%3A141):
> * type make, wait a few seconds, and interrupt, so that "./sage -sh" is available

`./sage --sh` should be available right after untarring.  This was a consequence of #11073.

> * install the optional mpc spkg (I lost track where I got that from...)

#12515 (GCC needs it)



---

archive/issue_comments_137102.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start! That is not acceptable.\n\nSo, this can really only be the last resort, say, if OS X really can not provide adequate compilers.",
    "created_at": "2012-03-15T23:26:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137102",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>
There is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start! That is not acceptable.

So, this can really only be the last resort, say, if OS X really can not provide adequate compilers.



---

archive/issue_comments_137103.json:
```json
{
    "body": "<a id='comment:4'></a>\nI just noticed - after five hours of compilation time - there is yet another round of configuration!!\n\nHow can it be that configuration is not only done in the very beginning? There is the option `--config-cache` used in the spkg-install script! But perhaps I am using it in the wrong way, so that it is in fact not cached and wastes time?",
    "created_at": "2012-03-15T23:40:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137103",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
I just noticed - after five hours of compilation time - there is yet another round of configuration!!

How can it be that configuration is not only done in the very beginning? There is the option `--config-cache` used in the spkg-install script! But perhaps I am using it in the wrong way, so that it is in fact not cached and wastes time?



---

archive/issue_comments_137104.json:
```json
{
    "body": "<a id='comment:145'></a>\nReplying to [SimonKing](#comment%3A143):\n> There is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start!\n\nYou're not using `SAGE_CHECK=yes` by chance?  That slows down GCC significantly.",
    "created_at": "2012-03-16T08:31:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137104",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:145'></a>
Replying to [SimonKing](#comment%3A143):
> There is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start!

You're not using `SAGE_CHECK=yes` by chance?  That slows down GCC significantly.



---

archive/issue_comments_137105.json:
```json
{
    "body": "<a id='comment:146'></a>\nReplying to [jdemeyer](#comment%3A145):\n> Replying to [SimonKing](#comment%3A143):\n> > There is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start!\n\n> You're not using `SAGE_CHECK=yes` by chance?  That slows down GCC significantly.\n\nNo. And, by the way, in the end it needed 509 minutes to build.\n\nThe day before yesterday, I was installing your original package (without graphite) in a fully functional Sage framework. Then, I was using the resulting compiler to build MPC, GMP, PPL, CLooG-PPL and finally GCC with graphite.\n\nNow, I was building MPIR, MPFR, MPC, PPL, CLooG-PPL and GCC in an \"empty\" anvironment. So, much different setting. Next, I am re-building MPIR, MPFR, MPC, PPL and CLooG-PPL using \"gcc+graphite\" in high optimization -- and then I am curious to learn how long it takes to build GCC again.\n\nAnyway. I will post the install logs soon.",
    "created_at": "2012-03-16T09:03:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137105",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:146'></a>
Replying to [jdemeyer](#comment%3A145):
> Replying to [SimonKing](#comment%3A143):
> > There is one aspect that I am very much disappointed about: The time for building this spkg. My laptop is now running for about 5 hours, but gcc is still not built, hence, the compilation of Sage itself didn't even start!

> You're not using `SAGE_CHECK=yes` by chance?  That slows down GCC significantly.

No. And, by the way, in the end it needed 509 minutes to build.

The day before yesterday, I was installing your original package (without graphite) in a fully functional Sage framework. Then, I was using the resulting compiler to build MPC, GMP, PPL, CLooG-PPL and finally GCC with graphite.

Now, I was building MPIR, MPFR, MPC, PPL, CLooG-PPL and GCC in an "empty" anvironment. So, much different setting. Next, I am re-building MPIR, MPFR, MPC, PPL and CLooG-PPL using "gcc+graphite" in high optimization -- and then I am curious to learn how long it takes to build GCC again.

Anyway. I will post the install logs soon.



---

archive/issue_comments_137106.json:
```json
{
    "body": "<a id='comment:7'></a>\nWhat system is that?  This is on a Gentoo Linux laptop with a Intel(R) Core(TM)2 Duo CPU     T5870  @ 2.00GHz, using 1 thread to compile the GCC spkg on this ticket:\n\n```\nreal    70m11.765s\nuser    62m3.177s\nsys     3m14.668s\nSuccessfully installed gcc-4.6.3\nDeleting temporary build directory\n/usr/local/src/sage-5.0.beta7/spkg/build/gcc-4.6.3\nMaking Python scripts relocatable...\nFinished installing gcc-4.6.3.spkg\n```",
    "created_at": "2012-03-16T09:44:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137106",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
What system is that?  This is on a Gentoo Linux laptop with a Intel(R) Core(TM)2 Duo CPU     T5870  @ 2.00GHz, using 1 thread to compile the GCC spkg on this ticket:

```
real    70m11.765s
user    62m3.177s
sys     3m14.668s
Successfully installed gcc-4.6.3
Deleting temporary build directory
/usr/local/src/sage-5.0.beta7/spkg/build/gcc-4.6.3
Making Python scripts relocatable...
Finished installing gcc-4.6.3.spkg
```



---

archive/issue_comments_137107.json:
```json
{
    "body": "<a id='comment:148'></a>\nReplying to [jdemeyer](#comment%3A147):\n> What system is that?  \n\nIntel(R) Core(TM)2 Duo CPU     P7450  @ 2.13GHz, openSUSE 12.1 \"Asparagus\", x86_64 GNU/Linux\n\n> real    70m11.765s\n\nIt took not much longer for me, the day before yesterday. Perhaps something is wrong with my computer, and I should at least reboot.",
    "created_at": "2012-03-16T10:01:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137107",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:148'></a>
Replying to [jdemeyer](#comment%3A147):
> What system is that?  

Intel(R) Core(TM)2 Duo CPU     P7450  @ 2.13GHz, openSUSE 12.1 "Asparagus", x86_64 GNU/Linux

> real    70m11.765s

It took not much longer for me, the day before yesterday. Perhaps something is wrong with my computer, and I should at least reboot.



---

archive/issue_comments_137108.json:
```json
{
    "body": "<a id='comment:149'></a>\nReplying to [SimonKing](#comment%3A148):\n> Replying to [jdemeyer](#comment%3A147):\n> > What system is that?  \n\n> \n> Intel(R) Core(TM)2 Duo CPU     P7450  @ 2.13GHz, openSUSE 12.1 \"Asparagus\", x86_64 GNU/Linux\n> \n> > real    70m11.765s\n\n> \n> It took not much longer for me, the day before yesterday. Perhaps something is wrong with my computer, and I should at least reboot.\n\nPerhaps my laptop had just have a veeeeeeery bad day. I built gcc again (with the gcc that I had built in the 8 hour session before), and it was much faster. Also, my first attempts to build gcc (the day before yesterday) went better.\n\nI have posted two install logs:\n\n* [The first](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/first_gcc.log) was from the day before yesterday, and it was in an existing Sage installation. Note that that install log contains several installations of gcc, with different parameters\n* [The second](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/second_gcc.log) is from yesterday/today and contains the very slow session and also the faster session. Hence, it is again a documentation of two installations of gcc. It was made BEFORE building Sage. That's to say, I have first manually installed the dependencies of gcc+graphite, then gcc, then installed the dependencies with higher optimization, then gcc+graphite again (just to see if it is faster), and then I typed \"make\". The new Sage installation is not done, yet.\n\nPerhaps the experts (i.e., **you! **) can see from the parameters documented in the install logs why it went so slow, yesterday. Note that I use configuration options different from the original options in your spkg.",
    "created_at": "2012-03-16T15:14:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137108",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:149'></a>
Replying to [SimonKing](#comment%3A148):
> Replying to [jdemeyer](#comment%3A147):
> > What system is that?  

> 
> Intel(R) Core(TM)2 Duo CPU     P7450  @ 2.13GHz, openSUSE 12.1 "Asparagus", x86_64 GNU/Linux
> 
> > real    70m11.765s

> 
> It took not much longer for me, the day before yesterday. Perhaps something is wrong with my computer, and I should at least reboot.

Perhaps my laptop had just have a veeeeeeery bad day. I built gcc again (with the gcc that I had built in the 8 hour session before), and it was much faster. Also, my first attempts to build gcc (the day before yesterday) went better.

I have posted two install logs:

* [The first](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/first_gcc.log) was from the day before yesterday, and it was in an existing Sage installation. Note that that install log contains several installations of gcc, with different parameters
* [The second](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/second_gcc.log) is from yesterday/today and contains the very slow session and also the faster session. Hence, it is again a documentation of two installations of gcc. It was made BEFORE building Sage. That's to say, I have first manually installed the dependencies of gcc+graphite, then gcc, then installed the dependencies with higher optimization, then gcc+graphite again (just to see if it is faster), and then I typed "make". The new Sage installation is not done, yet.

Perhaps the experts (i.e., **you! **) can see from the parameters documented in the install logs why it went so slow, yesterday. Note that I use configuration options different from the original options in your spkg.



---

archive/issue_comments_137109.json:
```json
{
    "body": "<a id='comment:0'></a>\nIt seems that GMP was to blame for the performance loss that I observed previously in the test suite.\n\nHere is in all detail how I proceeded:\n\n*   untar the source ball and open a sage shell\n*   replace the old pari and ppl spkgs by the new ones\n*   provide `C(XX)FLAGS=\"-O3 -march=native\"`\n*   install the standard mpir, (updated) ppl and mpfr spkgs\n*   install the optional mpc and cloog_ppl spkgs\n*   install the modified gcc spkg (using \n\n   ```\n   ../src/configure \\\n       --prefix=\"$SAGE_LOCAL\" \\\n       --with-local-prefix=\"$SAGE_LOCAL\" \\\n       --libdir=\"$SAGE_LOCAL/lib\" \\\n       --config-cache --enable-build-with-cxx --disable-ppl-version-check --disable-cloog-version-check \\\n       --with-ppl=\"$SAGE_LOCAL\" --with-cloog=\"$SAGE_LOCAL\" \\\n       --with-gmp=\"$SAGE_LOCAL\" --with-mpfr=\"$SAGE_LOCAL\" --with-mpc=\"$SAGE_LOCAL\" \\\n       --with-system-zlib \\\n       --disable-multilib \\\n       $CONFIGURE_FLAGS \"$CONFIGURE_AS\" \"$CONFIGURE_LD\"\n  ```\n  This took more than 8 hours. But meanwhile I think that my computer had just a bad day.\n*   switch to `C(XX)FLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing\"`\n*   recompile mpir, ppl, mpfr, mpfi, mpc and cloog_ppl (to have the optimization as well)\n*   recompile gcc *with the new level of optimization* (and just to see whether it takes another 8 hours...)\n*   make. Then, the first attempt of building `PolyBoRi` failed. But after closing and reopening the Sage shell, `make` did work on `PolyBoRi`.\n*   After a few seconds, I noticed that I had forgotten to change `C(XX)FLAGS`. So, I interrupted, deleted the items in spkg/installed that came after polybori, set the flags, and tried again... And it still worked!\n*   Strange: ppl, mpir and mpfr, were built again, although I had installed them manually in the very beginning.\n*   When `make` was done, I applied all the dependencies of this ticket (numerous patches to sage-root, sage-extcode and sage-lib.\n*   `sage -b`\n*   `sage -testall`\n\nResult: The whole test suite took 5785.2 seconds when Sage is built with standard CFLAGS, and 5845.7 seconds when it is built with high optimization. So, there is no significant difference with or without optimization. But at least, it works, and it becomes clear that one should keep using MPIR, not GMP.",
    "created_at": "2012-03-17T06:45:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137109",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:0'></a>
It seems that GMP was to blame for the performance loss that I observed previously in the test suite.

Here is in all detail how I proceeded:

*   untar the source ball and open a sage shell
*   replace the old pari and ppl spkgs by the new ones
*   provide `C(XX)FLAGS="-O3 -march=native"`
*   install the standard mpir, (updated) ppl and mpfr spkgs
*   install the optional mpc and cloog_ppl spkgs
*   install the modified gcc spkg (using 

   ```
   ../src/configure \
       --prefix="$SAGE_LOCAL" \
       --with-local-prefix="$SAGE_LOCAL" \
       --libdir="$SAGE_LOCAL/lib" \
       --config-cache --enable-build-with-cxx --disable-ppl-version-check --disable-cloog-version-check \
       --with-ppl="$SAGE_LOCAL" --with-cloog="$SAGE_LOCAL" \
       --with-gmp="$SAGE_LOCAL" --with-mpfr="$SAGE_LOCAL" --with-mpc="$SAGE_LOCAL" \
       --with-system-zlib \
       --disable-multilib \
       $CONFIGURE_FLAGS "$CONFIGURE_AS" "$CONFIGURE_LD"
  ```
  This took more than 8 hours. But meanwhile I think that my computer had just a bad day.
*   switch to `C(XX)FLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing"`
*   recompile mpir, ppl, mpfr, mpfi, mpc and cloog_ppl (to have the optimization as well)
*   recompile gcc *with the new level of optimization* (and just to see whether it takes another 8 hours...)
*   make. Then, the first attempt of building `PolyBoRi` failed. But after closing and reopening the Sage shell, `make` did work on `PolyBoRi`.
*   After a few seconds, I noticed that I had forgotten to change `C(XX)FLAGS`. So, I interrupted, deleted the items in spkg/installed that came after polybori, set the flags, and tried again... And it still worked!
*   Strange: ppl, mpir and mpfr, were built again, although I had installed them manually in the very beginning.
*   When `make` was done, I applied all the dependencies of this ticket (numerous patches to sage-root, sage-extcode and sage-lib.
*   `sage -b`
*   `sage -testall`

Result: The whole test suite took 5785.2 seconds when Sage is built with standard CFLAGS, and 5845.7 seconds when it is built with high optimization. So, there is no significant difference with or without optimization. But at least, it works, and it becomes clear that one should keep using MPIR, not GMP.



---

archive/issue_comments_137110.json:
```json
{
    "body": "<a id='comment:151'></a>\nReplying to [jdemeyer](#comment%3A142):\n> Replying to [SimonKing](#comment%3A141):\n> > * type make, wait a few seconds, and interrupt, so that \"./sage -sh\" is available\n\n> `./sage --sh` should be available right after untarring.  This was a consequence of #11073.\n\nIt isn't. I took sage-5.0.beta8.tar, untarred it, and got:\n\n```\nking@mpc622:/mnt/local/king/SAGE/withgcc/sage-5.0.beta8$ ./sage --sh\n./sage: no Sage installation found in $SAGE_ROOT=/mnt/local/king/lmonade/prefix-20111201/local/share/sage\n```\nSo, should #11073 be re-opened?",
    "created_at": "2012-03-17T16:58:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137110",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:151'></a>
Replying to [jdemeyer](#comment%3A142):
> Replying to [SimonKing](#comment%3A141):
> > * type make, wait a few seconds, and interrupt, so that "./sage -sh" is available

> `./sage --sh` should be available right after untarring.  This was a consequence of #11073.

It isn't. I took sage-5.0.beta8.tar, untarred it, and got:

```
king@mpc622:/mnt/local/king/SAGE/withgcc/sage-5.0.beta8$ ./sage --sh
./sage: no Sage installation found in $SAGE_ROOT=/mnt/local/king/lmonade/prefix-20111201/local/share/sage
```
So, should #11073 be re-opened?



---

archive/issue_comments_137111.json:
```json
{
    "body": "<a id='comment:152'></a>\nReplying to [SimonKing](#comment%3A151):\n> ./sage: no Sage installation found in $SAGE_ROOT=/mnt/local/king/lmonade/prefix-20111201/local/share/sage\n\nSorry, I accidentally started in a prefix environment. It does work. False alarm. Sorry.",
    "created_at": "2012-03-17T17:04:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137111",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:152'></a>
Replying to [SimonKing](#comment%3A151):
> ./sage: no Sage installation found in $SAGE_ROOT=/mnt/local/king/lmonade/prefix-20111201/local/share/sage

Sorry, I accidentally started in a prefix environment. It does work. False alarm. Sorry.



---

archive/issue_comments_137112.json:
```json
{
    "body": "<a id='comment:3'></a>\nYes, setting `SAGE_ROOT` before running Sage will actually override the Sage root directory.  So, if somebody installs a system-wide `sage` script, the user can set `SAGE_ROOT` himself to his preferred Sage installation.",
    "created_at": "2012-03-17T18:27:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137112",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Yes, setting `SAGE_ROOT` before running Sage will actually override the Sage root directory.  So, if somebody installs a system-wide `sage` script, the user can set `SAGE_ROOT` himself to his preferred Sage installation.



---

archive/issue_comments_137113.json:
```json
{
    "body": "<a id='comment:4'></a>\nNote that apparently it is needed to set something like `--libdir` in the configuration of one or the other package: When I tried to use the gcc spkg on another computer (not `openSuse` this time), the gfan spkg did not build, because libstdc++ was looked for in `/usr/lib64` rather than in `$SAGE_LOCAL/lib`, where it can be found.",
    "created_at": "2012-03-17T21:50:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137113",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
Note that apparently it is needed to set something like `--libdir` in the configuration of one or the other package: When I tried to use the gcc spkg on another computer (not `openSuse` this time), the gfan spkg did not build, because libstdc++ was looked for in `/usr/lib64` rather than in `$SAGE_LOCAL/lib`, where it can be found.



---

archive/issue_comments_137114.json:
```json
{
    "body": "<a id='comment:5'></a>\nA (perhaps related) question: Is it normal that `$SAGE_LOCAL/bin` is not present when one starts to build Sage?",
    "created_at": "2012-03-17T21:52:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137114",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
A (perhaps related) question: Is it normal that `$SAGE_LOCAL/bin` is not present when one starts to build Sage?



---

archive/issue_comments_137115.json:
```json
{
    "body": "<a id='comment:156'></a>\nReplying to [SimonKing](#comment%3A155):\n> A (perhaps related) question: Is it normal that `$SAGE_LOCAL/bin` is not present when one starts to build Sage?\n\nEven `$SAGE_LOCAL` is not present (as far as I know).  There is nothing wrong with this, the directories are created first thing when building Sage.",
    "created_at": "2012-03-17T22:34:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137115",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:156'></a>
Replying to [SimonKing](#comment%3A155):
> A (perhaps related) question: Is it normal that `$SAGE_LOCAL/bin` is not present when one starts to build Sage?

Even `$SAGE_LOCAL` is not present (as far as I know).  There is nothing wrong with this, the directories are created first thing when building Sage.



---

archive/issue_comments_137116.json:
```json
{
    "body": "<a id='comment:157'></a>\nReplying to [SimonKing](#comment%3A154):\n> Note that apparently it is needed to set something like `--libdir` in the configuration of one or the other package: When I tried to use the gcc spkg on another computer (not `openSuse` this time), the gfan spkg did not build, because libstdc++ was looked for in `/usr/lib64` rather than in `$SAGE_LOCAL/lib`, where it can be found.\n\nCan you give more details: which machine is this, which sources did you use, how did you build sage, was it a parallel build, what does the log file say...",
    "created_at": "2012-03-17T22:36:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137116",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:157'></a>
Replying to [SimonKing](#comment%3A154):
> Note that apparently it is needed to set something like `--libdir` in the configuration of one or the other package: When I tried to use the gcc spkg on another computer (not `openSuse` this time), the gfan spkg did not build, because libstdc++ was looked for in `/usr/lib64` rather than in `$SAGE_LOCAL/lib`, where it can be found.

Can you give more details: which machine is this, which sources did you use, how did you build sage, was it a parallel build, what does the log file say...



---

archive/issue_comments_137117.json:
```json
{
    "body": "<a id='comment:158'></a>\nReplying to [jdemeyer](#comment%3A157):\n> Can you give more details: which machine is this, which sources did you use, how did you build sage, was it a parallel build, what does the log file say...\n\nIt is \n\n```\nking@mpc622:~$ uname -a\nLinux mpc622 2.6.34.linuxpool #0 SMP PREEMPT Wed May 19 16:32:19 CEST 2010 x86_64 GNU/Linux\nking@mpc622:~$ cat /etc/issue\nDebian GNU/Linux 6.0 \\n \\l\n```\nand the four processors are\n\n```\nIntel(R) Core(TM) i3 CPU         530  @ 2.93GHz\n```\n\nConcerning the rest of your question: I think it would be best to be a bit more systematic.\n\nMy plan is to build Sage on the machine above in a couple of settings, each time with `MAKE=\"make -j4\"` and `SAGE_PARALLEL_SPKG_BUILD=\"yes\"`:\n\n* Default flags and system gcc\n* `-march=native` and system gcc. Yesterday, I got the impression that Atlas did *not* build in this setting.\n* Default flags and gcc spkg as it is posted here.\n* `-march=native` and the gcc spkg as it is posted here.\n* `-march=native` and the gcc spkg modified so that it is built with graphite; change to `-march=native -floop-...` for building the rest of Sage. I think this was the setting in which gfan failed to build.\n\nI think doing parallel builds, odds are that I will be able to post five install.logs this night.",
    "created_at": "2012-03-18T09:05:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137117",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:158'></a>
Replying to [jdemeyer](#comment%3A157):
> Can you give more details: which machine is this, which sources did you use, how did you build sage, was it a parallel build, what does the log file say...

It is 

```
king@mpc622:~$ uname -a
Linux mpc622 2.6.34.linuxpool #0 SMP PREEMPT Wed May 19 16:32:19 CEST 2010 x86_64 GNU/Linux
king@mpc622:~$ cat /etc/issue
Debian GNU/Linux 6.0 \n \l
```
and the four processors are

```
Intel(R) Core(TM) i3 CPU         530  @ 2.93GHz
```

Concerning the rest of your question: I think it would be best to be a bit more systematic.

My plan is to build Sage on the machine above in a couple of settings, each time with `MAKE="make -j4"` and `SAGE_PARALLEL_SPKG_BUILD="yes"`:

* Default flags and system gcc
* `-march=native` and system gcc. Yesterday, I got the impression that Atlas did *not* build in this setting.
* Default flags and gcc spkg as it is posted here.
* `-march=native` and the gcc spkg as it is posted here.
* `-march=native` and the gcc spkg modified so that it is built with graphite; change to `-march=native -floop-...` for building the rest of Sage. I think this was the setting in which gfan failed to build.

I think doing parallel builds, odds are that I will be able to post five install.logs this night.



---

archive/issue_events_101305.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-03-18T13:01:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101305"
}
```



---

archive/issue_events_101306.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-03-18T13:01:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101306"
}
```



---

archive/issue_comments_137118.json:
```json
{
    "body": "<a id='comment:9'></a>\nOn the machine described in my previous post, I got a total failure with the gcc package that is attached to this ticket.\n\nI did the following:\n\n```\ntar -xf sage-5.0.beta8.tar\ncd sage-5.0.beta8/\n./sage -sh\ncd spkg/standard/\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/mpc-1.0.0dev1126.spkg\nrm pari-2.5.1.p0.spkg\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.1.p2.spkg\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg\ncd ../../\nsage -i spkg/standard/mpir-2.1.3.p9.spkg\nsage -i spkg/standard/mpfr-3.1.0.p0.spkg\nsage -i spkg/standard/mpc-1.0.0dev1126.spkg\n   # note: it ended with /mnt/local/king/SAGE/experiment/gccspkg_native/sage-5.0.beta8/spkg/bin/sage-spkg: Zeile 485: cd: /mnt/local/king/SAGE/experiment/gccspkg_native/sage-5.0.beta8/local/bin: Datei oder Verzeichnis nicht gefunden\nsage -i spkg/standard/gcc-4.6.3.spkg\n   # fails\n```\nThe reason for the failure: During configuration, it is claimed that the suffix of object files can not be determined - which is strange since the suffix has been successfully determined repeatedly during configuration.\n\nPlease have a look at [the log file](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log).",
    "created_at": "2012-03-18T13:01:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137118",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:9'></a>
On the machine described in my previous post, I got a total failure with the gcc package that is attached to this ticket.

I did the following:

```
tar -xf sage-5.0.beta8.tar
cd sage-5.0.beta8/
./sage -sh
cd spkg/standard/
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/mpc-1.0.0dev1126.spkg
rm pari-2.5.1.p0.spkg
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.1.p2.spkg
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg
cd ../../
sage -i spkg/standard/mpir-2.1.3.p9.spkg
sage -i spkg/standard/mpfr-3.1.0.p0.spkg
sage -i spkg/standard/mpc-1.0.0dev1126.spkg
   # note: it ended with /mnt/local/king/SAGE/experiment/gccspkg_native/sage-5.0.beta8/spkg/bin/sage-spkg: Zeile 485: cd: /mnt/local/king/SAGE/experiment/gccspkg_native/sage-5.0.beta8/local/bin: Datei oder Verzeichnis nicht gefunden
sage -i spkg/standard/gcc-4.6.3.spkg
   # fails
```
The reason for the failure: During configuration, it is claimed that the suffix of object files can not be determined - which is strange since the suffix has been successfully determined repeatedly during configuration.

Please have a look at [the log file](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log).



---

archive/issue_comments_137119.json:
```json
{
    "body": "<a id='comment:0'></a>\nI forgot to add: The failure both happens with `MAKE=\"make -j4\"` and `MAKE=make`. I used `CFLAGS=\"-march=native\"` and `CXXFLAGS=\"-march=native\"`.",
    "created_at": "2012-03-18T13:02:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137119",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:0'></a>
I forgot to add: The failure both happens with `MAKE="make -j4"` and `MAKE=make`. I used `CFLAGS="-march=native"` and `CXXFLAGS="-march=native"`.



---

archive/issue_comments_137120.json:
```json
{
    "body": "<a id='comment:1'></a>\nYou should first do\n\n```\ncd spkg && ./install base\n```\nto install the base packages.",
    "created_at": "2012-03-18T13:11:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137120",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
You should first do

```
cd spkg && ./install base
```
to install the base packages.



---

archive/issue_events_101307.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-18T13:11:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101307"
}
```



---

archive/issue_events_101308.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-18T13:11:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101308"
}
```



---

archive/issue_comments_137121.json:
```json
{
    "body": "<a id='comment:162'></a>\nReplying to [jdemeyer](#comment%3A161):\n> You should first do\n> \n> ```\n> cd spkg && ./install base\n> ```\n> to install the base packages.\n\nAh! That is why it originally worked when I did \"make\" and waited a few seconds before hitting Ctrl-C...\n\nOK, I am trying it again, with a parallel build and `-march=native`. And after that, I'll do the same with graphite.",
    "created_at": "2012-03-18T13:34:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137121",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:162'></a>
Replying to [jdemeyer](#comment%3A161):
> You should first do
> 
> ```
> cd spkg && ./install base
> ```
> to install the base packages.

Ah! That is why it originally worked when I did "make" and waited a few seconds before hitting Ctrl-C...

OK, I am trying it again, with a parallel build and `-march=native`. And after that, I'll do the same with graphite.



---

archive/issue_comments_137122.json:
```json
{
    "body": "<a id='comment:3'></a>\nI was able to reproduce the error when building gfan with the gcc from the spkg, as I have reported yesterday.\n\nHere is the [install log](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log).\n\nI was using `MAKE=\"make -j4\"` and `SAGE_PARALLEL_SPKG_BUILD=\"yes\"`, the machine is as described above.",
    "created_at": "2012-03-18T15:49:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137122",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>
I was able to reproduce the error when building gfan with the gcc from the spkg, as I have reported yesterday.

Here is the [install log](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log).

I was using `MAKE="make -j4"` and `SAGE_PARALLEL_SPKG_BUILD="yes"`, the machine is as described above.



---

archive/issue_events_101309.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-03-18T15:49:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101309"
}
```



---

archive/issue_events_101310.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-03-18T15:49:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101310"
}
```



---

archive/issue_comments_137123.json:
```json
{
    "body": "<a id='comment:4'></a>\nIn my next attempt, I added --libdir to the configuration of the gcc spkg. Hence, in spkg-install of the gcc spkg I have\n\n```\n../src/configure \\\n    --prefix=\"$SAGE_LOCAL\" \\\n    --libdir=\"$SAGE_LOCAL/lib\" \\\n    --with-local-prefix=\"$SAGE_LOCAL\" \\\n    --with-gmp=\"$SAGE_LOCAL\" --with-mpfr=\"$SAGE_LOCAL\" --with-mpc=\"$SAGE_LOCAL\" \\\n    --with-system-zlib \\\n    --disable-multilib \\\n    $CONFIGURE_FLAGS \"$CONFIGURE_AS\" \"$CONFIGURE_LD\"\n```\nBut then, I again get the error\n\n```\nchecking for suffix of object files... configure: error: in `/mnt/local/king/SAGE/experiment/gcclibdir_native/sage-5.0.beta8/spkg/build/gcc-4.6.3/gcc-build/x86_64-unknown-linux-gnu/libgcc':\nconfigure: error: cannot compute suffix of object files: cannot compile\n```\neven though the suffix of object files has been computed repeatedly and correctly. From the config.log:\n\n```\nconfigure:4367: checking for suffix of object files\nconfigure:4389: gcc -c -march=native  conftest.c >&5\nconfigure:4393: $? = 0\nconfigure:4414: result: o\n```\n\nSo, why is providing the --libdir configuration option resulting in an error?",
    "created_at": "2012-03-18T16:26:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137123",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
In my next attempt, I added --libdir to the configuration of the gcc spkg. Hence, in spkg-install of the gcc spkg I have

```
../src/configure \
    --prefix="$SAGE_LOCAL" \
    --libdir="$SAGE_LOCAL/lib" \
    --with-local-prefix="$SAGE_LOCAL" \
    --with-gmp="$SAGE_LOCAL" --with-mpfr="$SAGE_LOCAL" --with-mpc="$SAGE_LOCAL" \
    --with-system-zlib \
    --disable-multilib \
    $CONFIGURE_FLAGS "$CONFIGURE_AS" "$CONFIGURE_LD"
```
But then, I again get the error

```
checking for suffix of object files... configure: error: in `/mnt/local/king/SAGE/experiment/gcclibdir_native/sage-5.0.beta8/spkg/build/gcc-4.6.3/gcc-build/x86_64-unknown-linux-gnu/libgcc':
configure: error: cannot compute suffix of object files: cannot compile
```
even though the suffix of object files has been computed repeatedly and correctly. From the config.log:

```
configure:4367: checking for suffix of object files
configure:4389: gcc -c -march=native  conftest.c >&5
configure:4393: $? = 0
configure:4414: result: o
```

So, why is providing the --libdir configuration option resulting in an error?



---

archive/issue_comments_137124.json:
```json
{
    "body": "<a id='comment:5'></a>\nI posted the [config log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-build-config.log) as well as [`SAGE_ROOT/spkg/logs/gcc-4.6.3.log`](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log)",
    "created_at": "2012-03-18T16:32:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137124",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
I posted the [config log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-build-config.log) as well as [`SAGE_ROOT/spkg/logs/gcc-4.6.3.log`](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log)



---

archive/issue_comments_137125.json:
```json
{
    "body": "<a id='comment:6'></a>\nI could imagine that my error report was a bit confusing, since it was in fact two different reports.\n\nThe first, resulting in [this install log](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log), is with the unmodified spkg, and gfan fails to build because something can not be found where it is supposed to.\n\nThe second was with a modified spkg, in the attempt to fix the previous error by defining `--libdir`, but failed as in [config.log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-build-config.log) or [gcc-4.6.3.log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log)\n\nHowever, it seems that the second problem is actually not related with --libdir: Following Jeroen's advice, I did `./install base` in `SAGE_ROOT/spkg`. But apparently that has not been sufficient. Now, just for fun, I did `make` and interrupted after a few seconds -- and when I then tried to install the modified gcc spkg (with --libdir), then the configuration worked. \n\nStrange. So, what was missing in addition to `./install base`?",
    "created_at": "2012-03-18T21:58:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137125",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:6'></a>
I could imagine that my error report was a bit confusing, since it was in fact two different reports.

The first, resulting in [this install log](http://boxen.math.washington.edu/home/SimonKing/SAGE/gcclogs/gccspkg_native.log), is with the unmodified spkg, and gfan fails to build because something can not be found where it is supposed to.

The second was with a modified spkg, in the attempt to fix the previous error by defining `--libdir`, but failed as in [config.log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-build-config.log) or [gcc-4.6.3.log](http://boxen.math.washington.edu/home/SimonKing/SAGE/install_logs/gcc-4.6.3.log)

However, it seems that the second problem is actually not related with --libdir: Following Jeroen's advice, I did `./install base` in `SAGE_ROOT/spkg`. But apparently that has not been sufficient. Now, just for fun, I did `make` and interrupted after a few seconds -- and when I then tried to install the modified gcc spkg (with --libdir), then the configuration worked. 

Strange. So, what was missing in addition to `./install base`?



---

archive/issue_comments_137126.json:
```json
{
    "body": "<a id='comment:167'></a>\nReplying to [SimonKing](#comment%3A166):\n> \n> The second was with a modified spkg, in the attempt to fix the previous error by defining `--libdir`\n\nI am afraid it did *not* fix the trouble with gfan not finding `GLIBCXX_3.4.15` in  usr/lib64/libstdc++.so.6`. That is strange. Is it perhaps needed to explicitly rebuild the packages that I had originally built with the system gcc? Namely, these are mpir, mpfr and mpc. And at least mpc is probably not rebuilt automatically.",
    "created_at": "2012-03-18T22:41:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137126",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:167'></a>
Replying to [SimonKing](#comment%3A166):
> 
> The second was with a modified spkg, in the attempt to fix the previous error by defining `--libdir`

I am afraid it did *not* fix the trouble with gfan not finding `GLIBCXX_3.4.15` in  usr/lib64/libstdc++.so.6`. That is strange. Is it perhaps needed to explicitly rebuild the packages that I had originally built with the system gcc? Namely, these are mpir, mpfr and mpc. And at least mpc is probably not rebuilt automatically.



---

archive/issue_comments_137127.json:
```json
{
    "body": "<a id='comment:8'></a>\nIt is clearly a sign that gfan is looking for libstdc++ in the wrong place. I haven't tried the new gcc spkg yet but we may have to add the location of libstdc++ in LD_LIBRARY_PATH. I am assuming that libstdc++ is not in $SAGE_LOCAL/lib and that's the problem.",
    "created_at": "2012-03-19T00:31:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137127",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
It is clearly a sign that gfan is looking for libstdc++ in the wrong place. I haven't tried the new gcc spkg yet but we may have to add the location of libstdc++ in LD_LIBRARY_PATH. I am assuming that libstdc++ is not in $SAGE_LOCAL/lib and that's the problem.



---

archive/issue_comments_137128.json:
```json
{
    "body": "<a id='comment:9'></a>\nOK so in a normal configuration without modification it lands in $SAGE_LOCAL/lib64 which is addressed in #12405 which is in beta8. So it should be able to find it. At this stage I would like the output of\n\n```\nstrace gfan\n```\nto see what exactly happens and what is opened when.\n\nFor your problem when you pass --libdir=$SAGE_LOCAL/lib you are probably looking at the wrong config.log. The config.log you posted is fine but it is also the top level config.log. The configuration file that fails is further down the building process. From the context of your build log it looks like it is related to libgcc configuring itself for a multilib install. I will try to reproduce the error.",
    "created_at": "2012-03-19T01:44:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137128",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
OK so in a normal configuration without modification it lands in $SAGE_LOCAL/lib64 which is addressed in #12405 which is in beta8. So it should be able to find it. At this stage I would like the output of

```
strace gfan
```
to see what exactly happens and what is opened when.

For your problem when you pass --libdir=$SAGE_LOCAL/lib you are probably looking at the wrong config.log. The config.log you posted is fine but it is also the top level config.log. The configuration file that fails is further down the building process. From the context of your build log it looks like it is related to libgcc configuring itself for a multilib install. I will try to reproduce the error.



---

archive/issue_comments_137129.json:
```json
{
    "body": "<a id='comment:170'></a>\nReplying to [fbissey](#comment%3A168):\n> It is clearly a sign that gfan is looking for libstdc++ in the wrong place. I haven't tried the new gcc spkg yet but we may have to add the location of libstdc++ in LD_LIBRARY_PATH. I am assuming that libstdc++ is not in $SAGE_LOCAL/lib and that's the problem.\n\nI found\n\n```\nsage-5.0.beta8/local/lib64/libstdc++.so.6\n```\n\nIn other words, even though I defined `--libdir=\"$SAGE_LOCAL/lib\"`, the file libstdc++.so.6 is still put into the wrong folder, namely `$SAGE_LOCAL/lib64`. How can that be?",
    "created_at": "2012-03-19T08:26:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137129",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:170'></a>
Replying to [fbissey](#comment%3A168):
> It is clearly a sign that gfan is looking for libstdc++ in the wrong place. I haven't tried the new gcc spkg yet but we may have to add the location of libstdc++ in LD_LIBRARY_PATH. I am assuming that libstdc++ is not in $SAGE_LOCAL/lib and that's the problem.

I found

```
sage-5.0.beta8/local/lib64/libstdc++.so.6
```

In other words, even though I defined `--libdir="$SAGE_LOCAL/lib"`, the file libstdc++.so.6 is still put into the wrong folder, namely `$SAGE_LOCAL/lib64`. How can that be?



---

archive/issue_comments_137130.json:
```json
{
    "body": "<a id='comment:171'></a>\nReplying to [fbissey](#comment%3A169):\n> OK so in a normal configuration without modification it lands in $SAGE_LOCAL/lib64 which is addressed in #12405 which is in beta8. So it should be able to find it. At this stage I would like the output of\n> \n> ```\n> strace gfan\n> ```\n> to see what exactly happens and what is opened when.\n\nCan you elaborate what that means?\n \n> For your problem when you pass --libdir=$SAGE_LOCAL/lib you are probably looking at the wrong config.log. \n\nIt seems to me that these are two separate problems.\n\nFirst problem: If I just do `./install base`, as suggested by Jeroen, then gcc fails to build, because at some point it can not determine the suffix of object files. That has nothing to do with --libdir being defined or not - it happens with or without --libdir.\n\nSecond problem: If one does `make` and interrupts after a few seconds, then gcc builds, regardless whether --libdir is defined or not; so, the first problem is worked around. However, even *if* --libdir is defined during top-level configuration, libstdc++.so.6 is put into a different folder. Note that spkg-install only contains a single call to `./configure` -- that's the one I was providing with --libdir..",
    "created_at": "2012-03-19T08:32:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137130",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:171'></a>
Replying to [fbissey](#comment%3A169):
> OK so in a normal configuration without modification it lands in $SAGE_LOCAL/lib64 which is addressed in #12405 which is in beta8. So it should be able to find it. At this stage I would like the output of
> 
> ```
> strace gfan
> ```
> to see what exactly happens and what is opened when.

Can you elaborate what that means?
 
> For your problem when you pass --libdir=$SAGE_LOCAL/lib you are probably looking at the wrong config.log. 

It seems to me that these are two separate problems.

First problem: If I just do `./install base`, as suggested by Jeroen, then gcc fails to build, because at some point it can not determine the suffix of object files. That has nothing to do with --libdir being defined or not - it happens with or without --libdir.

Second problem: If one does `make` and interrupts after a few seconds, then gcc builds, regardless whether --libdir is defined or not; so, the first problem is worked around. However, even *if* --libdir is defined during top-level configuration, libstdc++.so.6 is put into a different folder. Note that spkg-install only contains a single call to `./configure` -- that's the one I was providing with --libdir..



---

archive/issue_comments_137131.json:
```json
{
    "body": "<a id='comment:2'></a>\nSimon, instead of adding all the patches and spkgs yourself, could you just try the testing tarball mentioned on this ticket:\n[http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/sage-5.0.beta8-gcc.tar](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/sage-5.0.beta8-gcc.tar)",
    "created_at": "2012-03-19T08:50:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137131",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Simon, instead of adding all the patches and spkgs yourself, could you just try the testing tarball mentioned on this ticket:
[http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/sage-5.0.beta8-gcc.tar](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/sage-5.0.beta8-gcc.tar)



---

archive/issue_comments_137132.json:
```json
{
    "body": "<a id='comment:3'></a>\nSimon, try the most simple configuration: no parallel build, no CFLAGS, CXXFLAGS, using the source tarball I pointed out to you.  If that fails, it truly is a problem with this ticket.\n\nIf that works, try adding \"complexity\" gradually, such that we can see more precisely what fails.",
    "created_at": "2012-03-19T08:57:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137132",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Simon, try the most simple configuration: no parallel build, no CFLAGS, CXXFLAGS, using the source tarball I pointed out to you.  If that fails, it truly is a problem with this ticket.

If that works, try adding "complexity" gradually, such that we can see more precisely what fails.



---

archive/issue_comments_137133.json:
```json
{
    "body": "<a id='comment:174'></a>\nReplying to [jdemeyer](#comment%3A173):\n> Simon, try the most simple configuration: no parallel build, no CFLAGS, CXXFLAGS, using the source tarball I pointed out to you.  If that fails, it truly is a problem with this ticket.\n\nOK, I am in the middle of it. gcc has successfully built after about 50 minutes (no flags, no parallel build, no additional patches).\n\nHowever, I am sure that we will eventually have an error. Namely:\n\n```\n$ ls testinggcc/vanilla/sage-5.0.beta8-gcc/local/lib64/\nlibgcc_s.so           libgomp.la        libmudflap.so.0        libquadmath.so        libssp.so.0.0.0\nlibgcc_s.so.1         libgomp.so        libmudflap.so.0.0.0    libquadmath.so.0      libstdc++.a\nlibgfortran.a         libgomp.so.1      libmudflapth.a         libquadmath.so.0.0.0  libstdc++.la\nlibgfortran.la        libgomp.so.1.0.0  libmudflapth.la        libssp.a              libstdc++.so\nlibgfortran.so        libgomp.spec      libmudflapth.so        libssp.la             libstdc++.so.6\nlibgfortran.so.3      libiberty.a       libmudflapth.so.0      libssp_nonshared.a    libstdc++.so.6.0.16\nlibgfortran.so.3.0.0  libmudflap.a      libmudflapth.so.0.0.0  libssp_nonshared.la   libstdc++.so.6.0.16-gdb.py\nlibgfortran.spec      libmudflap.la     libquadmath.a          libssp.so             libsupc++.a\nlibgomp.a             libmudflap.so     libquadmath.la         libssp.so.0           libsupc++.la\n```\nAll that stuff should be in local/lib, not local/lib64.",
    "created_at": "2012-03-19T10:28:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137133",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:174'></a>
Replying to [jdemeyer](#comment%3A173):
> Simon, try the most simple configuration: no parallel build, no CFLAGS, CXXFLAGS, using the source tarball I pointed out to you.  If that fails, it truly is a problem with this ticket.

OK, I am in the middle of it. gcc has successfully built after about 50 minutes (no flags, no parallel build, no additional patches).

However, I am sure that we will eventually have an error. Namely:

```
$ ls testinggcc/vanilla/sage-5.0.beta8-gcc/local/lib64/
libgcc_s.so           libgomp.la        libmudflap.so.0        libquadmath.so        libssp.so.0.0.0
libgcc_s.so.1         libgomp.so        libmudflap.so.0.0.0    libquadmath.so.0      libstdc++.a
libgfortran.a         libgomp.so.1      libmudflapth.a         libquadmath.so.0.0.0  libstdc++.la
libgfortran.la        libgomp.so.1.0.0  libmudflapth.la        libssp.a              libstdc++.so
libgfortran.so        libgomp.spec      libmudflapth.so        libssp.la             libstdc++.so.6
libgfortran.so.3      libiberty.a       libmudflapth.so.0      libssp_nonshared.a    libstdc++.so.6.0.16
libgfortran.so.3.0.0  libmudflap.a      libmudflapth.so.0.0.0  libssp_nonshared.la   libstdc++.so.6.0.16-gdb.py
libgfortran.spec      libmudflap.la     libquadmath.a          libssp.so             libsupc++.a
libgomp.a             libmudflap.so     libquadmath.la         libssp.so.0           libsupc++.la
```
All that stuff should be in local/lib, not local/lib64.



---

archive/issue_comments_137134.json:
```json
{
    "body": "<a id='comment:175'></a>\nReplying to [SimonKing](#comment%3A174):\n> However, I am sure that we will eventually have an error.\n\nI believe this is no longer a problem with #12405.",
    "created_at": "2012-03-19T10:33:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137134",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:175'></a>
Replying to [SimonKing](#comment%3A174):
> However, I am sure that we will eventually have an error.

I believe this is no longer a problem with #12405.



---

archive/issue_comments_137135.json:
```json
{
    "body": "<a id='comment:176'></a>\nReplying to [jdemeyer](#comment%3A175):\n> Replying to [SimonKing](#comment%3A174):\n> > However, I am sure that we will eventually have an error.\n\n> I believe this is no longer a problem with #12405.\n\nIt *was* a problem yesterday, where I was using the sage-5.0.beta8 sources that contain #12405.\n\nWe will see in a few hours...",
    "created_at": "2012-03-19T10:45:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137135",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:176'></a>
Replying to [jdemeyer](#comment%3A175):
> Replying to [SimonKing](#comment%3A174):
> > However, I am sure that we will eventually have an error.

> I believe this is no longer a problem with #12405.

It *was* a problem yesterday, where I was using the sage-5.0.beta8 sources that contain #12405.

We will see in a few hours...



---

archive/issue_comments_137136.json:
```json
{
    "body": "<a id='comment:7'></a>\nConcerning gfan: Why is Singular not built with gfan? During configuration of the Singular spkg, it says:\n\n```\nchecking whether to configure and build omalloc... yes\nchecking whether to configure and build gfan lib... no\nchecking size of long... 8\n...\nchecking which apint package to use... gmp\nchecking gfanlib... can not build with gfan lib\nchecking whether to use libsvd... no\n```\nJust out of curiosity (I was grepping for gfan in the install.log).",
    "created_at": "2012-03-19T11:37:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137136",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>
Concerning gfan: Why is Singular not built with gfan? During configuration of the Singular spkg, it says:

```
checking whether to configure and build omalloc... yes
checking whether to configure and build gfan lib... no
checking size of long... 8
...
checking which apint package to use... gmp
checking gfanlib... can not build with gfan lib
checking whether to use libsvd... no
```
Just out of curiosity (I was grepping for gfan in the install.log).



---

archive/issue_comments_137137.json:
```json
{
    "body": "<a id='comment:178'></a>\nReplying to [SimonKing](#comment%3A166):\n> Following Jeroen's advice, I did `./install base` in `SAGE_ROOT/spkg`. But apparently that has not been sufficient. Now, just for fun, I did `make` and interrupted after a few seconds -- and when I then tried to install the modified gcc spkg (with --libdir), then the configuration worked. \n> \n> Strange. So, what was missing in addition to `./install base`?\n\nI have no idea.  Is `patch` installed on your system (I mean outside of Sage)?",
    "created_at": "2012-03-19T12:52:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137137",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:178'></a>
Replying to [SimonKing](#comment%3A166):
> Following Jeroen's advice, I did `./install base` in `SAGE_ROOT/spkg`. But apparently that has not been sufficient. Now, just for fun, I did `make` and interrupted after a few seconds -- and when I then tried to install the modified gcc spkg (with --libdir), then the configuration worked. 
> 
> Strange. So, what was missing in addition to `./install base`?

I have no idea.  Is `patch` installed on your system (I mean outside of Sage)?



---

archive/issue_comments_137138.json:
```json
{
    "body": "<a id='comment:179'></a>\nReplying to [jdemeyer](#comment%3A178):\n> I have no idea.  Is `patch` installed on your system (I mean outside of Sage)?\n\n\n```\n$ which patch\n/usr/bin/patch\n```\n\nBy the way: It seems that building Sage with gcc from the sources you provided did work. Sage is now building the reference manual. In particular, the gfan spkg did not complain, even though the gcc spkg has put stuff into lib64. That was a single thread, without CFLAGS and without `CLooG-PPL`.\n\nNext, I'll try parallel build.",
    "created_at": "2012-03-19T13:01:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137138",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:179'></a>
Replying to [jdemeyer](#comment%3A178):
> I have no idea.  Is `patch` installed on your system (I mean outside of Sage)?


```
$ which patch
/usr/bin/patch
```

By the way: It seems that building Sage with gcc from the sources you provided did work. Sage is now building the reference manual. In particular, the gfan spkg did not complain, even though the gcc spkg has put stuff into lib64. That was a single thread, without CFLAGS and without `CLooG-PPL`.

Next, I'll try parallel build.



---

archive/issue_comments_137139.json:
```json
{
    "body": "<a id='comment:0'></a>\nReplying to [SimonKing](#comment%3A177):\n> Concerning gfan: Why is Singular not built with gfan? During configuration of the Singular spkg, it says:\n\nThe Singular developers started their own toric varieties package and gfan is used for that. This is somewhat recent, so our Singular spkg doesn't know about it yet. Right now I think there is nothing that Andrey and I haven't already implemented for toric varieties in Sage. Of course it still would be nice to tie everything together.",
    "created_at": "2012-03-19T13:04:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137139",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:0'></a>
Replying to [SimonKing](#comment%3A177):
> Concerning gfan: Why is Singular not built with gfan? During configuration of the Singular spkg, it says:

The Singular developers started their own toric varieties package and gfan is used for that. This is somewhat recent, so our Singular spkg doesn't know about it yet. Right now I think there is nothing that Andrey and I haven't already implemented for toric varieties in Sage. Of course it still would be nice to tie everything together.



---

archive/issue_comments_137140.json:
```json
{
    "body": "<a id='comment:181'></a>\nReplying to [vbraun](#comment%3A180):\n> The Singular developers started their own toric varieties package and gfan is used for that. This is somewhat recent, so our Singular spkg doesn't know about it yet. Right now I think there is nothing that Andrey and I haven't already implemented for toric varieties in Sage. Of course it still would be nice to tie everything together. \n\nWould Singular simply pick gfan up, or would it be needed to have a different configuration in the Singular spkg?  In the former case, we could simply build gfan prior to Singular, and then Singular would use gfan.",
    "created_at": "2012-03-19T13:31:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137140",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:181'></a>
Replying to [vbraun](#comment%3A180):
> The Singular developers started their own toric varieties package and gfan is used for that. This is somewhat recent, so our Singular spkg doesn't know about it yet. Right now I think there is nothing that Andrey and I haven't already implemented for toric varieties in Sage. Of course it still would be nice to tie everything together. 

Would Singular simply pick gfan up, or would it be needed to have a different configuration in the Singular spkg?  In the former case, we could simply build gfan prior to Singular, and then Singular would use gfan.



---

archive/issue_comments_137141.json:
```json
{
    "body": "<a id='comment:182'></a>\nReplying to [SimonKing](#comment%3A181):\n> Would Singular simply pick gfan up, or would it be needed to have a different configuration in the Singular spkg?  In the former case, we could simply build gfan prior to Singular, and then Singular would use gfan.\n\nTo the best of my knowledge they use vanilla gfan, so we just need to build it in the right order.",
    "created_at": "2012-03-19T13:33:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137141",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:182'></a>
Replying to [SimonKing](#comment%3A181):
> Would Singular simply pick gfan up, or would it be needed to have a different configuration in the Singular spkg?  In the former case, we could simply build gfan prior to Singular, and then Singular would use gfan.

To the best of my knowledge they use vanilla gfan, so we just need to build it in the right order.



---

archive/issue_comments_137142.json:
```json
{
    "body": "<a id='comment:183'></a>\nReplying to [vbraun](#comment%3A182):\n> To the best of my knowledge they use vanilla gfan, so we just need to build it in the right order.\n\nIf I want to test it: Am I right that I have to modify spkg/standard/deps, for example by adding\n\n```\n$(INST)/$(SINGULAR): $(BASE) $(INST)/$(PATCH) $(INST)/$(GFAN)\n        +$(PIPE) \"$(SAGE_SPKG) $(SINGULAR) 2>&1\" \"tee -a $(SAGE_LOGS)/$(SINGULAR).log\"\n```\n?",
    "created_at": "2012-03-19T13:49:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137142",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:183'></a>
Replying to [vbraun](#comment%3A182):
> To the best of my knowledge they use vanilla gfan, so we just need to build it in the right order.

If I want to test it: Am I right that I have to modify spkg/standard/deps, for example by adding

```
$(INST)/$(SINGULAR): $(BASE) $(INST)/$(PATCH) $(INST)/$(GFAN)
        +$(PIPE) "$(SAGE_SPKG) $(SINGULAR) 2>&1" "tee -a $(SAGE_LOGS)/$(SINGULAR).log"
```
?



---

archive/issue_comments_137143.json:
```json
{
    "body": "<a id='comment:4'></a>\nCan you make a separate ticket for the Singular/gfan issue?  Simon: yes, you need to add `$(INST)/$(GFAN)` which will ensure Singular is build after gfan.",
    "created_at": "2012-03-19T13:57:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137143",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Can you make a separate ticket for the Singular/gfan issue?  Simon: yes, you need to add `$(INST)/$(GFAN)` which will ensure Singular is build after gfan.



---

archive/issue_comments_137144.json:
```json
{
    "body": "<a id='comment:185'></a>\nReplying to [SimonKing](#comment%3A179):\n> It seems that building Sage with gcc from the sources you provided did work.\n\nThat's what I suspected.  So somehow, something went wrong with your modifications. I would be interested to know exactly what makes it break.",
    "created_at": "2012-03-19T13:58:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137144",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:185'></a>
Replying to [SimonKing](#comment%3A179):
> It seems that building Sage with gcc from the sources you provided did work.

That's what I suspected.  So somehow, something went wrong with your modifications. I would be interested to know exactly what makes it break.



---

archive/issue_comments_137145.json:
```json
{
    "body": "<a id='comment:6'></a>\nI reproduced Simon' problem with:\n\n```\ntar xf sage-5.0.beta8.tar\ncd sage-5.0.beta8/\n\ncd spkg/standard/\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/mpc-1.0.0dev1126.spkg\nrm pari-2.5.1.p0.spkg\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.1.p2.spkg\nwget http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg\ncd ../../\n\nsource spkg/bin/sage-env\nexport CFLAGS=\"-march=native\" CXXFLAGS=\"-march=native\" MAKE=\"make -j32\"\n( cd spkg && ./install base )\n./sage -i spkg/standard/mpir-2.1.3.p9.spkg\n./sage -i spkg/standard/mpfr-3.1.0.p0.spkg\n./sage -i spkg/standard/mpc-1.0.0dev1126.spkg\n./sage -i spkg/standard/gcc-4.6.3.spkg\n```",
    "created_at": "2012-03-19T14:21:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137145",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
I reproduced Simon' problem with:

```
tar xf sage-5.0.beta8.tar
cd sage-5.0.beta8/

cd spkg/standard/
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/mpc-1.0.0dev1126.spkg
rm pari-2.5.1.p0.spkg
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.1.p2.spkg
wget http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg
cd ../../

source spkg/bin/sage-env
export CFLAGS="-march=native" CXXFLAGS="-march=native" MAKE="make -j32"
( cd spkg && ./install base )
./sage -i spkg/standard/mpir-2.1.3.p9.spkg
./sage -i spkg/standard/mpfr-3.1.0.p0.spkg
./sage -i spkg/standard/mpc-1.0.0dev1126.spkg
./sage -i spkg/standard/gcc-4.6.3.spkg
```



---

archive/issue_comments_137146.json:
```json
{
    "body": "<a id='comment:187'></a>\nReplying to [jdemeyer](#comment%3A185):\n> Replying to [SimonKing](#comment%3A179):\n> > It seems that building Sage with gcc from the sources you provided did work.\n\n> That's what I suspected.  So somehow, something went wrong with your modifications. I would be interested to know exactly what makes it break. \n\nI wonder, myself. In one of the posts above, I listed what I did in order to build Sage with gcc \"manually\".\n\nOne question: Is it possible to build Sage by providing the -floop* options? The problem is that my system gcc is not built with graphite, so that the -floop* options would not work before the gcc spkg is built. Is there some option that makes gcc ignore any option that is not supported? Then, the -floop* options would be ignored initially, but used as soon as the gcc spkg is installed.",
    "created_at": "2012-03-19T14:26:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137146",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:187'></a>
Replying to [jdemeyer](#comment%3A185):
> Replying to [SimonKing](#comment%3A179):
> > It seems that building Sage with gcc from the sources you provided did work.

> That's what I suspected.  So somehow, something went wrong with your modifications. I would be interested to know exactly what makes it break. 

I wonder, myself. In one of the posts above, I listed what I did in order to build Sage with gcc "manually".

One question: Is it possible to build Sage by providing the -floop* options? The problem is that my system gcc is not built with graphite, so that the -floop* options would not work before the gcc spkg is built. Is there some option that makes gcc ignore any option that is not supported? Then, the -floop* options would be ignored initially, but used as soon as the gcc spkg is installed.



---

archive/issue_comments_137147.json:
```json
{
    "body": "<a id='comment:188'></a>\nReplying to [jdemeyer](#comment%3A186):\n> I reproduced Simon' problem\n\nGood! So, what does the automatic installation do differently from my manual installation?",
    "created_at": "2012-03-19T14:27:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137147",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:188'></a>
Replying to [jdemeyer](#comment%3A186):
> I reproduced Simon' problem

Good! So, what does the automatic installation do differently from my manual installation?



---

archive/issue_comments_137148.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe fact that you run everything inside one Sage shell is what caused the failures.  If you **don't use the Sage shell** (there is no need to), it works.\n\n`sage-env` has some conditional commands.  One of these commands is setting `LD_LIBRARY_PATH`.  With #12405, only *existing* directories are added to `LD_LIBRARY_PATH`.  Upon entering the Sage shell, `$SAGE_LOCAL/lib` does not exist yet, so that directory isn't added.  Since now `SAGE_ENV_SOURCED=1`, the variable `LD_LIBRARY_PATH` is not changed anymore.",
    "created_at": "2012-03-19T14:34:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137148",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
The fact that you run everything inside one Sage shell is what caused the failures.  If you **don't use the Sage shell** (there is no need to), it works.

`sage-env` has some conditional commands.  One of these commands is setting `LD_LIBRARY_PATH`.  With #12405, only *existing* directories are added to `LD_LIBRARY_PATH`.  Upon entering the Sage shell, `$SAGE_LOCAL/lib` does not exist yet, so that directory isn't added.  Since now `SAGE_ENV_SOURCED=1`, the variable `LD_LIBRARY_PATH` is not changed anymore.



---

archive/issue_events_101311.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-19T14:34:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101311"
}
```



---

archive/issue_events_101312.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-19T14:34:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101312"
}
```



---

archive/issue_comments_137149.json:
```json
{
    "body": "<a id='comment:191'></a>\nReplying to [jdemeyer](#comment%3A189):\n>> `sage-env` has some conditional commands.  One of these commands is setting `LD_LIBRARY_PATH`.  With #12405, only *existing* directories are added to `LD_LIBRARY_PATH`.  Upon entering the Sage shell, `$SAGE_LOCAL/lib` does not exist yet, so that directory isn't added.  Since now `SAGE_ENV_SOURCED=1`, the variable `LD_LIBRARY_PATH` is not changed anymore.\n\nArrgh. Thank you for tracing that down!",
    "created_at": "2012-03-19T14:42:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137149",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:191'></a>
Replying to [jdemeyer](#comment%3A189):
>> `sage-env` has some conditional commands.  One of these commands is setting `LD_LIBRARY_PATH`.  With #12405, only *existing* directories are added to `LD_LIBRARY_PATH`.  Upon entering the Sage shell, `$SAGE_LOCAL/lib` does not exist yet, so that directory isn't added.  Since now `SAGE_ENV_SOURCED=1`, the variable `LD_LIBRARY_PATH` is not changed anymore.

Arrgh. Thank you for tracing that down!



---

archive/issue_comments_137150.json:
```json
{
    "body": "<a id='comment:2'></a>\nSee #12698 for the Sage shell issue.",
    "created_at": "2012-03-19T14:50:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137150",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
See #12698 for the Sage shell issue.



---

archive/issue_comments_137151.json:
```json
{
    "body": "<a id='comment:3'></a>\nI tried to google for an option that makes gcc ignore an option (for example, a -floop* option) if it is not supported, but I had no success. Do you know of such option?",
    "created_at": "2012-03-19T14:56:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137151",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>
I tried to google for an option that makes gcc ignore an option (for example, a -floop* option) if it is not supported, but I had no success. Do you know of such option?



---

archive/issue_comments_137152.json:
```json
{
    "body": "<a id='comment:194'></a>\nReplying to [SimonKing](#comment%3A193):\n> I tried to google for an option that makes gcc ignore an option (for example, a -floop* option) if it is not supported, but I had no success. Do you know of such option?\n\nThere is no such option. The easiest recourse is a wrapper shell script that conditionally removes the option.",
    "created_at": "2012-03-19T15:15:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137152",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:194'></a>
Replying to [SimonKing](#comment%3A193):
> I tried to google for an option that makes gcc ignore an option (for example, a -floop* option) if it is not supported, but I had no success. Do you know of such option?

There is no such option. The easiest recourse is a wrapper shell script that conditionally removes the option.



---

archive/issue_comments_137153.json:
```json
{
    "body": "<a id='comment:5'></a>\nHere are my experiences with [the sources containing gcc](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/). I've put `SAGE_INSTALL_GCC=yes` in all cases.\n\n1. No C(XX)FLAGS, `MAKE=\"make\"`: Installation went smooth, after 210m31.660s of real time was the Sage build complete.\n2. No C(XX)FLAGS, `SAGE_PARALLEL_SPKG_BUILD=yes`, `MAKE=\"make -j4\"`: Installation went smooth, after 93m32.100s of real time was the Sage build complete.\n3. `C(XX)FLAGS=\"-O3 -march=native\"`, `SAGE_PARALLEL_SPKG_BUILD=yes`, `MAKE=\"make -j4\"`: Installation hung for several hours during compilation of some files from the fplll spkg. Note that So, no success in that setting.\n\nSome additional information on the failing setting: After Ctrl-C, I started make again. And now, three cc1plus processes are running for 10 minutes already, namely\n\n```\n19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD generate.d -MF .deps/generate.Tpo -MP -MT generate.o -D_GNU_SOURCE -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 generate.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase generate.cpp -auxbase-strip generate.o -O3 -fPIC -o /tmp/ccPeDeVW.s\n19036 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD llldiff.d -MF .deps/llldiff.Tpo -MP -MT llldiff.o -D_GNU_SOURCE -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 llldiff.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase llldiff.cpp -auxbase-strip llldiff.o -O3 -fPIC -o /tmp/ccxiy3ks.s\n19044 pts/3    R+    10:01 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD fplll_micro-main.d -MF .deps/fplll_micro-main.Tpo -MP -MT fplll_micro-main.o -D_GNU_SOURCE -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DFAST_BUILD main.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase main.cpp -auxbase-strip fplll_micro-main.o -O3 -fPIC -o /tmp/ccGKc3Lc.s\n```\n\nI am not sure whether this means \"needs work\", because `CFLAGS=\"-O3 -march=native\"` is probably not officially supported...",
    "created_at": "2012-03-20T09:57:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137153",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
Here are my experiences with [the sources containing gcc](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/). I've put `SAGE_INSTALL_GCC=yes` in all cases.

1. No C(XX)FLAGS, `MAKE="make"`: Installation went smooth, after 210m31.660s of real time was the Sage build complete.
2. No C(XX)FLAGS, `SAGE_PARALLEL_SPKG_BUILD=yes`, `MAKE="make -j4"`: Installation went smooth, after 93m32.100s of real time was the Sage build complete.
3. `C(XX)FLAGS="-O3 -march=native"`, `SAGE_PARALLEL_SPKG_BUILD=yes`, `MAKE="make -j4"`: Installation hung for several hours during compilation of some files from the fplll spkg. Note that So, no success in that setting.

Some additional information on the failing setting: After Ctrl-C, I started make again. And now, three cc1plus processes are running for 10 minutes already, namely

```
19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD generate.d -MF .deps/generate.Tpo -MP -MT generate.o -D_GNU_SOURCE -DPACKAGE_NAME="libfplll" -DPACKAGE_TARNAME="libfplll" -DPACKAGE_VERSION="3.0.12" -DPACKAGE_STRING="libfplll 3.0.12" -DPACKAGE_BUGREPORT="" -DPACKAGE="libfplll" -DVERSION="3.0.12" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 generate.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase generate.cpp -auxbase-strip generate.o -O3 -fPIC -o /tmp/ccPeDeVW.s
19036 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD llldiff.d -MF .deps/llldiff.Tpo -MP -MT llldiff.o -D_GNU_SOURCE -DPACKAGE_NAME="libfplll" -DPACKAGE_TARNAME="libfplll" -DPACKAGE_VERSION="3.0.12" -DPACKAGE_STRING="libfplll 3.0.12" -DPACKAGE_BUGREPORT="" -DPACKAGE="libfplll" -DVERSION="3.0.12" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 llldiff.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase llldiff.cpp -auxbase-strip llldiff.o -O3 -fPIC -o /tmp/ccxiy3ks.s
19044 pts/3    R+    10:01 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD fplll_micro-main.d -MF .deps/fplll_micro-main.Tpo -MP -MT fplll_micro-main.o -D_GNU_SOURCE -DPACKAGE_NAME="libfplll" -DPACKAGE_TARNAME="libfplll" -DPACKAGE_VERSION="3.0.12" -DPACKAGE_STRING="libfplll 3.0.12" -DPACKAGE_BUGREPORT="" -DPACKAGE="libfplll" -DVERSION="3.0.12" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DFAST_BUILD main.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase main.cpp -auxbase-strip fplll_micro-main.o -O3 -fPIC -o /tmp/ccGKc3Lc.s
```

I am not sure whether this means "needs work", because `CFLAGS="-O3 -march=native"` is probably not officially supported...



---

archive/issue_comments_137154.json:
```json
{
    "body": "<a id='comment:6'></a>\nAfter another Ctrl-C, I retried with \"serial\" make, preserving the CFLAGS. But again, it hangs:\n\n```\n24902 pts/3    R+    12:24 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD generate.d -MF .deps/generate.Tpo -MP -MT generate.o -D_GNU_SOURCE -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 generate.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase generate.cpp -auxbase-strip generate.o -O3 -fPIC -o /tmp/cc7hcSLZ.s\n```\n\nBut I just notice that `-march=native` was actually overridden by `-march=core2`. Anyway, I lack knowledge to analyse that myself.",
    "created_at": "2012-03-20T10:15:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137154",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:6'></a>
After another Ctrl-C, I retried with "serial" make, preserving the CFLAGS. But again, it hangs:

```
24902 pts/3    R+    12:24 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus -quiet -I. -I. -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -I/mnt/local/king/SAGE/testinggcc/native/sage-5.0.beta8-gcc/local/include/ -MD generate.d -MF .deps/generate.Tpo -MP -MT generate.o -D_GNU_SOURCE -DPACKAGE_NAME="libfplll" -DPACKAGE_TARNAME="libfplll" -DPACKAGE_VERSION="3.0.12" -DPACKAGE_STRING="libfplll 3.0.12" -DPACKAGE_BUGREPORT="" -DPACKAGE="libfplll" -DVERSION="3.0.12" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 generate.cpp -march=core2 -mcx16 -msahf -mpopcnt -msse4.2 --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=256 -mtune=core2 -quiet -dumpbase generate.cpp -auxbase-strip generate.o -O3 -fPIC -o /tmp/cc7hcSLZ.s
```

But I just notice that `-march=native` was actually overridden by `-march=core2`. Anyway, I lack knowledge to analyse that myself.



---

archive/issue_comments_137155.json:
```json
{
    "body": "<a id='comment:7'></a>\nWith the Sage-with-gcc version built in parallel without CFLAGS, I tried the following innocent-looking example:\n\n```\nu, v = var('u,v')\nf_x = cos(u)*(4*sqrt(1-v^2)*sin(abs(\nu))^abs(u))\nf_y = sin(u) *(4*sqrt(1-v^2)*sin(abs(u))^abs(u))\nf_z = v\nparametric_plot3d([f_x, f_y, f_z], (u, -pi, pi), (v, -1, 1), frame=False, color=\"red\")\n```\nGuess the result? My computer shut down!!!\n\nIs anybody able to replicate it?",
    "created_at": "2012-03-20T10:38:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137155",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>
With the Sage-with-gcc version built in parallel without CFLAGS, I tried the following innocent-looking example:

```
u, v = var('u,v')
f_x = cos(u)*(4*sqrt(1-v^2)*sin(abs(
u))^abs(u))
f_y = sin(u) *(4*sqrt(1-v^2)*sin(abs(u))^abs(u))
f_z = v
parametric_plot3d([f_x, f_y, f_z], (u, -pi, pi), (v, -1, 1), frame=False, color="red")
```
Guess the result? My computer shut down!!!

Is anybody able to replicate it?



---

archive/issue_comments_137156.json:
```json
{
    "body": "<a id='comment:198'></a>\nReplying to [SimonKing](#comment%3A195):\n> 19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus\n\nThis refers to gcc-4.4.5, which is not the gcc from this package.\n\nAlso, could it be that it just takes a very long time to compile those files?",
    "created_at": "2012-03-20T10:57:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137156",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:198'></a>
Replying to [SimonKing](#comment%3A195):
> 19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus

This refers to gcc-4.4.5, which is not the gcc from this package.

Also, could it be that it just takes a very long time to compile those files?



---

archive/issue_comments_137157.json:
```json
{
    "body": "<a id='comment:199'></a>\nReplying to [jdemeyer](#comment%3A198):\n> Replying to [SimonKing](#comment%3A195):\n> > 19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus\n\n> This refers to gcc-4.4.5, which is not the gcc from this package.\n\nWHAT? O my gosh, then I made a very stupid mistake and forgot to provide the `SAGE_INSTALL_GCC` in that case. So, I need to try again.\n \n> Also, could it be that it just takes a very long time to compile those files?\n\nBut not three hours.",
    "created_at": "2012-03-20T11:27:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137157",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:199'></a>
Replying to [jdemeyer](#comment%3A198):
> Replying to [SimonKing](#comment%3A195):
> > 19031 pts/3    R+    10:21 /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1plus

> This refers to gcc-4.4.5, which is not the gcc from this package.

WHAT? O my gosh, then I made a very stupid mistake and forgot to provide the `SAGE_INSTALL_GCC` in that case. So, I need to try again.
 
> Also, could it be that it just takes a very long time to compile those files?

But not three hours.



---

archive/issue_comments_137158.json:
```json
{
    "body": "<a id='comment:0'></a>\nHooray, building Sage parallelly, using `C(XX)FLAGS=\"-O3 -march=native\"` apparently *did* work! The reference manual is already being built.\n\nIn other words, the gcc spkg allows one to use \"-O3 -march=native\". With my system gcc, it wouldn't be possible, since it hangs with libfplll.",
    "created_at": "2012-03-20T13:19:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137158",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:0'></a>
Hooray, building Sage parallelly, using `C(XX)FLAGS="-O3 -march=native"` apparently *did* work! The reference manual is already being built.

In other words, the gcc spkg allows one to use "-O3 -march=native". With my system gcc, it wouldn't be possible, since it hangs with libfplll.



---

archive/issue_comments_137159.json:
```json
{
    "body": "<a id='comment:1'></a>\nHere some timings on Debian GNU/Linux 6.0: __`sage -testall` in different settings__\n\nWith system gcc 4.6.2 (Sage built in parallel, no CFLAGS)\n\n```\nAll tests passed!\nTotal time for all tests: 4951.8 seconds\n```\n\nWith the gcc spkg (built serially, no CFLAGS)\n\n```\nAll tests passed!\nTotal time for all tests: 5089.6 seconds\n```\n\nWith the gcc spkg (built in parallel, no CFLAGS)\n\n```\nAll tests passed!\nTotal time for all tests: 4974.1 seconds\n```\n\nSo, there is no significant difference. Need to repeat with optimization flags, though.",
    "created_at": "2012-03-21T15:42:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137159",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
Here some timings on Debian GNU/Linux 6.0: __`sage -testall` in different settings__

With system gcc 4.6.2 (Sage built in parallel, no CFLAGS)

```
All tests passed!
Total time for all tests: 4951.8 seconds
```

With the gcc spkg (built serially, no CFLAGS)

```
All tests passed!
Total time for all tests: 5089.6 seconds
```

With the gcc spkg (built in parallel, no CFLAGS)

```
All tests passed!
Total time for all tests: 4974.1 seconds
```

So, there is no significant difference. Need to repeat with optimization flags, though.



---

archive/issue_comments_137160.json:
```json
{
    "body": "**Reviewer:** Simon King",
    "created_at": "2012-03-22T08:33:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137160",
    "user": "https://github.com/simon-king-jena"
}
```

**Reviewer:** Simon King



---

archive/issue_comments_137161.json:
```json
{
    "body": "<a id='comment:202'></a>\nReplying to [SimonKing](#comment%3A201):\n> Here some timings on Debian GNU/Linux 6.0: __`sage -testall` in different settings__\n> \n> ...\n> \n> So, there is no significant difference. Need to repeat with optimization flags, though.\n\nHere it is, with `-O3 -march=native` and built in parallel:\n\n```\nAll tests passed!\nTotal time for all tests: 4804.3 seconds\n```\n\nSo, there is an improvement of 3% compared with my system's gcc without optimization. That's not significant, but at least there is no slow-down.\n\nI can say that this gcc spkg is an interesting contribution, and it works for me. So, from my perspective, it is a positive review. However, I did not test on a machine where the gcc spkg is really needed (OS X, for example). Also, I am not sure if the vote on sage-devel on the inclusion of another standard package has come to a clear conclusion.\n\nHence, I vote in favour of the spkg and insert my name as one reviewer, but I do think that a second or third opinion is needed, which is why I do not just change the ticket into a positive review.",
    "created_at": "2012-03-22T08:33:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137161",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:202'></a>
Replying to [SimonKing](#comment%3A201):
> Here some timings on Debian GNU/Linux 6.0: __`sage -testall` in different settings__
> 
> ...
> 
> So, there is no significant difference. Need to repeat with optimization flags, though.

Here it is, with `-O3 -march=native` and built in parallel:

```
All tests passed!
Total time for all tests: 4804.3 seconds
```

So, there is an improvement of 3% compared with my system's gcc without optimization. That's not significant, but at least there is no slow-down.

I can say that this gcc spkg is an interesting contribution, and it works for me. So, from my perspective, it is a positive review. However, I did not test on a machine where the gcc spkg is really needed (OS X, for example). Also, I am not sure if the vote on sage-devel on the inclusion of another standard package has come to a clear conclusion.

Hence, I vote in favour of the spkg and insert my name as one reviewer, but I do think that a second or third opinion is needed, which is why I do not just change the ticket into a positive review.



---

archive/issue_comments_137162.json:
```json
{
    "body": "<a id='comment:3'></a>\nRebased to #12714 + #12647",
    "created_at": "2012-03-22T08:54:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137162",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Rebased to #12714 + #12647



---

archive/issue_comments_137163.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638\" to \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647\".",
    "created_at": "2012-03-22T08:54:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137163",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638" to "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647".



---

archive/issue_comments_137164.json:
```json
{
    "body": "<a id='comment:4'></a>\nRegarding Simon's comment: this has worked for me on OS X Lion for quite a while. I'm far from an expert in gcc and related issues, so I can't speak to any technical aspects of the ticket. But count me for another portion of a positive review. Is this enough?",
    "created_at": "2012-03-22T16:14:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137164",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Regarding Simon's comment: this has worked for me on OS X Lion for quite a while. I'm far from an expert in gcc and related issues, so I can't speak to any technical aspects of the ticket. But count me for another portion of a positive review. Is this enough?



---

archive/issue_comments_137165.json:
```json
{
    "body": "<a id='comment:5'></a>\nEnough of the bikeshedding :-)",
    "created_at": "2012-03-22T16:58:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137165",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
Enough of the bikeshedding :-)



---

archive/issue_events_101313.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-03-22T16:58:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101313"
}
```



---

archive/issue_events_101314.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-03-22T16:58:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101314"
}
```



---

archive/issue_comments_137166.json:
```json
{
    "body": "<a id='comment:206'></a>\nReplying to [vbraun](#comment%3A205):\n> Enough of the bikeshedding :-)\n\nTrue dat.  And we still have to add in the new notebook to Sage 5.0, so presumably this will get lots of testing \"in real-life situations\" from users who haven't yet tried this out much (like me, though it did work well on my infamous machine, which now has no keyboard...).  Presumably there are still another few betas to go.  This is going to be one amazing release!",
    "created_at": "2012-03-22T17:56:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137166",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:206'></a>
Replying to [vbraun](#comment%3A205):
> Enough of the bikeshedding :-)

True dat.  And we still have to add in the new notebook to Sage 5.0, so presumably this will get lots of testing "in real-life situations" from users who haven't yet tried this out much (like me, though it did work well on my infamous machine, which now has no keyboard...).  Presumably there are still another few betas to go.  This is going to be one amazing release!



---

archive/issue_comments_137167.json:
```json
{
    "body": "<a id='comment:7'></a>\nI have some questions though: How could we make it possible to build the GCC with graphite or with lto-support?\n\nIt should be possible to declare that one wants to build the GCC with these additional features - in that case, the necessary optional packages (the cloog_ppl package that I created respectively a libelf package, that probably needs to be created) would be downloaded and installed before building the gcc spkg.\n\nShould that be done by yet another environment variable? I think there are too many already.\n\nBut perhaps it could be given as a build target to `make`. I think the following would be an acceptable way of usage:\n\n1. `tar -xf sage-x.y.z.tar`, `cd sage-x.y.z/`\n2. `make cloog_ppl libelf gcc` (installs `CLooG-PPL`, `libelf` and gcc with their dependencies, downloading optional packages as required; the install script of the gcc spkg would be modified such that graphite and lto support would be automatically added if cloog-ppl or libelf are present)\n3. `make`, to build the rest of Sage.\n\nGenerally, I suggest that `make foo_bar toto` should install the latest version of the foo_bar and toto spkgs *in the given order* including dependencies (optional or standard), whereas `make` without arguments would install all of Sage. Similarly, adding `parallel` to the make targets should be the same what is now done by `SAGE_PARALLEL_SPKG_BUILD`. To me, having make targets (automatically derived from spkg names) seems nicer than to have hundreds of environment variables.\n\nHow should we proceed with these ideas (provided that you don't say that they're nonsense)? Should there be a *new* ticket for a gcc with an install script that automatically picks up cloog_ppl and libelf? Or should this be done here, suspending the positive review?",
    "created_at": "2012-03-22T22:17:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137167",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>
I have some questions though: How could we make it possible to build the GCC with graphite or with lto-support?

It should be possible to declare that one wants to build the GCC with these additional features - in that case, the necessary optional packages (the cloog_ppl package that I created respectively a libelf package, that probably needs to be created) would be downloaded and installed before building the gcc spkg.

Should that be done by yet another environment variable? I think there are too many already.

But perhaps it could be given as a build target to `make`. I think the following would be an acceptable way of usage:

1. `tar -xf sage-x.y.z.tar`, `cd sage-x.y.z/`
2. `make cloog_ppl libelf gcc` (installs `CLooG-PPL`, `libelf` and gcc with their dependencies, downloading optional packages as required; the install script of the gcc spkg would be modified such that graphite and lto support would be automatically added if cloog-ppl or libelf are present)
3. `make`, to build the rest of Sage.

Generally, I suggest that `make foo_bar toto` should install the latest version of the foo_bar and toto spkgs *in the given order* including dependencies (optional or standard), whereas `make` without arguments would install all of Sage. Similarly, adding `parallel` to the make targets should be the same what is now done by `SAGE_PARALLEL_SPKG_BUILD`. To me, having make targets (automatically derived from spkg names) seems nicer than to have hundreds of environment variables.

How should we proceed with these ideas (provided that you don't say that they're nonsense)? Should there be a *new* ticket for a gcc with an install script that automatically picks up cloog_ppl and libelf? Or should this be done here, suspending the positive review?



---

archive/issue_comments_137168.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n \n **Apply**:\n-1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.\n+1. [and [12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch]) to the `SAGE_ROOT` repository.\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n``````\n",
    "created_at": "2012-03-23T12:31:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137168",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)
 
 **Apply**:
-1. [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to the `SAGE_ROOT` repository.
+1. [and [12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch]) to the `SAGE_ROOT` repository.
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
``````




---

archive/issue_events_101315.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-23T12:31:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101315"
}
```



---

archive/issue_events_101316.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-23T12:31:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101316"
}
```



---

archive/issue_comments_137169.json:
```json
{
    "body": "<a id='comment:9'></a>\nFurther testing revealed that `SAGE_FORTRAN` and `SAGE_FORTRAN_LIB` break stuff.  [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/12369_no_sage_fortran.patch) ensures that `SAGE_FORTRAN` and `SAGE_FORTRAN_LIB` are ignored when building GCC.\n\nNeeds review.",
    "created_at": "2012-03-23T12:32:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137169",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Further testing revealed that `SAGE_FORTRAN` and `SAGE_FORTRAN_LIB` break stuff.  [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/12369_no_sage_fortran.patch) ensures that `SAGE_FORTRAN` and `SAGE_FORTRAN_LIB` are ignored when building GCC.

Needs review.



---

archive/issue_events_101317.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-23T12:32:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101317"
}
```



---

archive/issue_events_101318.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-23T12:32:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101318"
}
```



---

archive/issue_comments_137170.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n \n **Apply**:\n-1. [and [12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch]) to the `SAGE_ROOT` repository.\n+1. [and [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/b5cb325d8df9a0d15488b4f5d860e09c.patch)) to the `SAGE_ROOT` repository.\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n``````\n",
    "created_at": "2012-03-23T14:33:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137170",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)
 
 **Apply**:
-1. [and [12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch]) to the `SAGE_ROOT` repository.
+1. [and [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/b5cb325d8df9a0d15488b4f5d860e09c.patch)) to the `SAGE_ROOT` repository.
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
``````




---

archive/issue_comments_137171.json:
```json
{
    "body": "<a id='comment:211'></a>\nReplying to [SimonKing](#comment%3A207):\n> How should we proceed with these ideas (provided that you don't say that they're nonsense)? Should there be a *new* ticket for a gcc with an install script that automatically picks up cloog_ppl and libelf? Or should this be done here, suspending the positive review?\n\nCertainly not here, and I much prefer a ./configure script to make targets:\n\n```\n$ ./configure --with-optional-packages=cloog_ppl,libelf --enable-install-gcc\n$ make\n```\nI guess having such a ./configure script is a long-term plan for Sage (I think #11073, #10492, #12479, #12602, #12102, #12631 are steps towards that goal).",
    "created_at": "2012-03-23T17:16:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137171",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:211'></a>
Replying to [SimonKing](#comment%3A207):
> How should we proceed with these ideas (provided that you don't say that they're nonsense)? Should there be a *new* ticket for a gcc with an install script that automatically picks up cloog_ppl and libelf? Or should this be done here, suspending the positive review?

Certainly not here, and I much prefer a ./configure script to make targets:

```
$ ./configure --with-optional-packages=cloog_ppl,libelf --enable-install-gcc
$ make
```
I guess having such a ./configure script is a long-term plan for Sage (I think #11073, #10492, #12479, #12602, #12102, #12631 are steps towards that goal).



---

archive/issue_comments_137172.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,9 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n-**Testing releases**:\n-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/)\n-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.\n-\n-For systems other than OS X, installing the \"gccdeps\" distribution is equivalent to installing the \"gcc\" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the \"gcc\" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.\n-\n+**Testing release**:\n+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/)\n``````\n",
    "created_at": "2012-03-23T19:33:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137172",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,9 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
-**Testing releases**:
-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta8-gcc/)
-2. Dependencies only: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta7-gccdeps/): this contains all *dependencies* of this ticket but not this ticket itself, it still includes the old Fortran spkg.
-
-For systems other than OS X, installing the "gccdeps" distribution is equivalent to installing the "gcc" distribution with `SAGE_INSTALL_GCC=no`.  On OS X, the "gcc" distribution normally will not build with `SAGE_INSTALL_GCC=no` because Fortran is missing.
-
+**Testing release**:
+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/)
``````




---

archive/issue_comments_137173.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe `SAGE_FORTRAN` fix doesn't work as is. On the skynet machine cleo, `gfortran` is some old version of fortran (in `/usr/bin`), so when you override the setting in `/usr/local/skynet_bash_profile`, which is\n\n```\n  SAGE_FORTRAN=/usr/local/gcc-4.6.2/ia64-Linux-rhel/bin/gfortran\n  export SAGE_FORTRAN\n```\nthen the prereq script says that there is a version mismatch between gcc and fortran, and quits. Maybe the prereq script shouldn't do this compatibility check if Sage is building gcc?",
    "created_at": "2012-03-23T21:04:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137173",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
The `SAGE_FORTRAN` fix doesn't work as is. On the skynet machine cleo, `gfortran` is some old version of fortran (in `/usr/bin`), so when you override the setting in `/usr/local/skynet_bash_profile`, which is

```
  SAGE_FORTRAN=/usr/local/gcc-4.6.2/ia64-Linux-rhel/bin/gfortran
  export SAGE_FORTRAN
```
then the prereq script says that there is a version mismatch between gcc and fortran, and quits. Maybe the prereq script shouldn't do this compatibility check if Sage is building gcc?



---

archive/issue_events_101319.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-03-23T21:05:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101319"
}
```



---

archive/issue_events_101320.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-03-23T21:05:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101320"
}
```



---

archive/issue_comments_137174.json:
```json
{
    "body": "<a id='comment:215'></a>\nReplying to [jhpalmieri](#comment%3A213):\n> Maybe the prereq script shouldn't do this compatibility check if Sage is building gcc?\n\nIdeally, things would be the other way around: prereq should become a real configure script and `decide` whether or not to build GCC.  But for now, we should go for a quick fix (I really don't want to overhaul prereq now and make GCC depend on that).",
    "created_at": "2012-03-23T21:44:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137174",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:215'></a>
Replying to [jhpalmieri](#comment%3A213):
> Maybe the prereq script shouldn't do this compatibility check if Sage is building gcc?

Ideally, things would be the other way around: prereq should become a real configure script and `decide` whether or not to build GCC.  But for now, we should go for a quick fix (I really don't want to overhaul prereq now and make GCC depend on that).



---

archive/issue_comments_137175.json:
```json
{
    "body": "<a id='comment:6'></a>\nSee #12112.",
    "created_at": "2012-03-23T21:47:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137175",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
See #12112.



---

archive/issue_comments_137176.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647\" to \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12112\".",
    "created_at": "2012-03-23T21:47:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137176",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647" to "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12112".



---

archive/issue_comments_137177.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12112\" to \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112\".",
    "created_at": "2012-03-23T22:36:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137177",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12112" to "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112".



---

archive/issue_comments_137178.json:
```json
{
    "body": "<a id='comment:8'></a>\nHere is another experience:\n\nI patched the gcc spkg as follows:\n\n```diff\ndiff --git a/spkg-install b/spkg-install\n\nIndex: spkg-install\n===================================================================\n--- a/spkg-install\n+++ b/spkg-install\n@@ -82,6 +82,8 @@\n ../src/configure \\\n     --prefix=\"$SAGE_LOCAL\" \\\n     --with-local-prefix=\"$SAGE_LOCAL\" \\\n+    --with-cloog=\"$SAGE_LOCAL\" --with-ppl=\"$SAGE_LOCAL\" \\\n+    --enable-lto \\\n     --with-gmp=\"$SAGE_LOCAL\" --with-mpfr=\"$SAGE_LOCAL\" --with-mpc=\"$SAGE_LOCAL\" \\\n     --with-system-zlib \\\n     --disable-multilib \\\n```\n\nThen, I added the modified gcc spkg to sage-5.0.beta9, replaced the ppl package by the one from #12672, added the cloog-ppl package from #12666, replaced the glpk package by the one from #12703, added a new libelf spkg and of course also added the mpc spkg. I didn't bother to modify the spkg/deps file, but instead built the gcc spkg manually after installing the dependencies for graphite and lto support.\n\nI have tried to build Sage with `C(XX)FLAGS=\"-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing -flto\"` and LDFLAGS=-flto. Singular did not build (see #12738) and R did not build (see #12741), so that I removed `-flto` for these two spkgs.\n\nIn principle, it worked. sage -testall resulted in\n\n```\nAll tests passed!\nTotal time for all tests: 6515.9 seconds\n```\nHowever, that is significantly *slower* than the 4951.8 seconds that sage -testall would take on this machine without optimization flags and with gcc 4.6.2.\n\nNote that Leif pointed out that the failures when building Singular and R might come from a slightly too old ld version on my system. But don't be afraid: I do *not* intend to create a binutils spkg.",
    "created_at": "2012-03-24T14:43:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137178",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:8'></a>
Here is another experience:

I patched the gcc spkg as follows:

```diff
diff --git a/spkg-install b/spkg-install

Index: spkg-install
===================================================================
--- a/spkg-install
+++ b/spkg-install
@@ -82,6 +82,8 @@
 ../src/configure \
     --prefix="$SAGE_LOCAL" \
     --with-local-prefix="$SAGE_LOCAL" \
+    --with-cloog="$SAGE_LOCAL" --with-ppl="$SAGE_LOCAL" \
+    --enable-lto \
     --with-gmp="$SAGE_LOCAL" --with-mpfr="$SAGE_LOCAL" --with-mpc="$SAGE_LOCAL" \
     --with-system-zlib \
     --disable-multilib \
```

Then, I added the modified gcc spkg to sage-5.0.beta9, replaced the ppl package by the one from #12672, added the cloog-ppl package from #12666, replaced the glpk package by the one from #12703, added a new libelf spkg and of course also added the mpc spkg. I didn't bother to modify the spkg/deps file, but instead built the gcc spkg manually after installing the dependencies for graphite and lto support.

I have tried to build Sage with `C(XX)FLAGS="-O3 -march=native -floop-interchange -floop-strip-mine -floop-block -fno-strict-aliasing -flto"` and LDFLAGS=-flto. Singular did not build (see #12738) and R did not build (see #12741), so that I removed `-flto` for these two spkgs.

In principle, it worked. sage -testall resulted in

```
All tests passed!
Total time for all tests: 6515.9 seconds
```
However, that is significantly *slower* than the 4951.8 seconds that sage -testall would take on this machine without optimization flags and with gcc 4.6.2.

Note that Leif pointed out that the failures when building Singular and R might come from a slightly too old ld version on my system. But don't be afraid: I do *not* intend to create a binutils spkg.



---

archive/issue_comments_137179.json:
```json
{
    "body": "<a id='comment:9'></a>\nSimon: what happens if you turn off debugging? I think a lot of Sage packages are built with debugging on by default. Will that conflict with the optimizations at all?",
    "created_at": "2012-03-24T22:24:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137179",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Simon: what happens if you turn off debugging? I think a lot of Sage packages are built with debugging on by default. Will that conflict with the optimizations at all?



---

archive/issue_comments_137180.json:
```json
{
    "body": "<a id='comment:220'></a>\nReplying to [jhpalmieri](#comment%3A219):\n> Simon: what happens if you turn off debugging? I think a lot of Sage packages are built with debugging on by default.\n\nHow can I change it externally if Sage packages internally switch debugging on?\n\n> Will that conflict with the optimizations at all?\n\nSorry, that would be far beyond my knowledge. Currently, I am exploring: People mentioned various compiler and linker optimization flags, and I simply wanted to test them, without having an idea what effects are really to be expected.",
    "created_at": "2012-03-24T22:28:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137180",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:220'></a>
Replying to [jhpalmieri](#comment%3A219):
> Simon: what happens if you turn off debugging? I think a lot of Sage packages are built with debugging on by default.

How can I change it externally if Sage packages internally switch debugging on?

> Will that conflict with the optimizations at all?

Sorry, that would be far beyond my knowledge. Currently, I am exploring: People mentioned various compiler and linker optimization flags, and I simply wanted to test them, without having an idea what effects are really to be expected.



---

archive/issue_comments_137181.json:
```json
{
    "body": "<a id='comment:1'></a>\nSome packages (I don't know how many or which ones) will respect `export SAGE_DEBUG=no`.",
    "created_at": "2012-03-25T05:04:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137181",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
Some packages (I don't know how many or which ones) will respect `export SAGE_DEBUG=no`.



---

archive/issue_comments_137182.json:
```json
{
    "body": "<a id='comment:222'></a>\nReplying to [jhpalmieri](#comment%3A219):\n> Will that conflict with the optimizations at all?\n\nIt shouldn't.  Adding debugging information will make your executables a lot larger, which can cause a slow-down.  But apart from that, the code should not run slower.",
    "created_at": "2012-03-25T09:01:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137182",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:222'></a>
Replying to [jhpalmieri](#comment%3A219):
> Will that conflict with the optimizations at all?

It shouldn't.  Adding debugging information will make your executables a lot larger, which can cause a slow-down.  But apart from that, the code should not run slower.



---

archive/issue_comments_137183.json:
```json
{
    "body": "<a id='comment:3'></a>\nBy the way, the version of polybori in the testing release doesn't match the version in plain sage-5.0.beta10. The included version fails to compile for me on OpenSolaris and Solaris, while the old version seems to be okay.",
    "created_at": "2012-03-27T19:20:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137183",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
By the way, the version of polybori in the testing release doesn't match the version in plain sage-5.0.beta10. The included version fails to compile for me on OpenSolaris and Solaris, while the old version seems to be okay.



---

archive/issue_comments_137184.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n **Testing release**:\n-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/)\n+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)\n``````\n",
    "created_at": "2012-03-28T08:20:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137184",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
 **Testing release**:
-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta10-gcc/)
+1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)
``````




---

archive/issue_comments_137185.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)\n \n **Apply**:\n-1. [and [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/b5cb325d8df9a0d15488b4f5d860e09c.patch)) to the `SAGE_ROOT` repository.\n+1. [and [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/1934b915299e9ad988c00198ed25a5cd.patch)) to the `SAGE_ROOT` repository.\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n``````\n",
    "created_at": "2012-03-28T14:21:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137185",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.6.3.spkg)
 
 **Apply**:
-1. [and [attachment:12369_no_sage_fortran.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/b5cb325d8df9a0d15488b4f5d860e09c.patch)) to the `SAGE_ROOT` repository.
+1. [and [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/59fbd574e7ab33e4d751d2ec7d53fbcf.patch](https://github.com/sagemath/sage/files/ticket12369/1934b915299e9ad988c00198ed25a5cd.patch)) to the `SAGE_ROOT` repository.
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
``````




---

archive/issue_comments_137186.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,3 +9,6 @@\n \n **Testing release**:\n 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)\n+\n+**See also**:\n+1. #12782: When building GCC, build MPIR without the C++ interface\n``````\n",
    "created_at": "2012-03-29T16:29:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137186",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,3 +9,6 @@
 
 **Testing release**:
 1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)
+
+**See also**:
+1. #12782: When building GCC, build MPIR without the C++ interface
``````




---

archive/issue_comments_137187.json:
```json
{
    "body": "<a id='comment:7'></a>\nWith the most recent testing release (beta12 vs. beta10), there is a new doctest failure on OS X Lion:\n\n```\nsage -t  --long -force_lib devel/sage/sage/misc/cachefunc.pyx\nThe doctested process was killed by signal 11\n```\nAny ideas what might be causing this? The file being tested hasn't been changed recently as far as I can tell.",
    "created_at": "2012-03-29T18:19:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137187",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
With the most recent testing release (beta12 vs. beta10), there is a new doctest failure on OS X Lion:

```
sage -t  --long -force_lib devel/sage/sage/misc/cachefunc.pyx
The doctested process was killed by signal 11
```
Any ideas what might be causing this? The file being tested hasn't been changed recently as far as I can tell.



---

archive/issue_comments_137188.json:
```json
{
    "body": "<a id='comment:8'></a>\nShould we add #12785 as a prerequisite?",
    "created_at": "2012-03-29T23:36:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137188",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Should we add #12785 as a prerequisite?



---

archive/issue_comments_137189.json:
```json
{
    "body": "<a id='comment:9'></a>\nCould somebody here please review #12782: it would allow building Sage with only a C compiler (and not a C++ compiler).  Currently, MPIR is built with a C++ interface which obviously requires a C++ compiler.  #12782 changes MPIR such that the C++ interface is not built while building GCC (i.e. when the environment variable `SAGE_BUILD_TOOLCHAIN` is set to `\"yes\"`).  Since MPIR is built again after GCC, the C++ interface is built then.",
    "created_at": "2012-04-01T22:36:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137189",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Could somebody here please review #12782: it would allow building Sage with only a C compiler (and not a C++ compiler).  Currently, MPIR is built with a C++ interface which obviously requires a C++ compiler.  #12782 changes MPIR such that the C++ interface is not built while building GCC (i.e. when the environment variable `SAGE_BUILD_TOOLCHAIN` is set to `"yes"`).  Since MPIR is built again after GCC, the C++ interface is built then.



---

archive/issue_comments_137190.json:
```json
{
    "body": "<a id='comment:0'></a>\nNew testing release sage-5.0.beta12-gcc at the usual location.",
    "created_at": "2012-04-03T13:10:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137190",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:0'></a>
New testing release sage-5.0.beta12-gcc at the usual location.



---

archive/issue_comments_137191.json:
```json
{
    "body": "<a id='comment:1'></a>\nI'm not sure I understand the change related to #3537. If we're upgrading, then sage-env should already have been run (say, by the old sage-sage script), in which case (if it's from an old enough version) `RM` might be set to `rm`, which will break things. So would it be better to do\n\n```sh\nif [ \"$RM\" = \"rm\" ]; then\n    unset RM\nfi\n```\nOr maybe\n\n```sh\nif [ \"$RM\" = \"rm\" ]; then\n    export RM=\"rm -f\"\nfi\n```",
    "created_at": "2012-04-03T19:06:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137191",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I'm not sure I understand the change related to #3537. If we're upgrading, then sage-env should already have been run (say, by the old sage-sage script), in which case (if it's from an old enough version) `RM` might be set to `rm`, which will break things. So would it be better to do

```sh
if [ "$RM" = "rm" ]; then
    unset RM
fi
```
Or maybe

```sh
if [ "$RM" = "rm" ]; then
    export RM="rm -f"
fi
```



---

archive/issue_comments_137192.json:
```json
{
    "body": "<a id='comment:232'></a>\nReplying to [jhpalmieri](#comment%3A231):\n> I'm not sure I understand the change related to #3537. If we're upgrading, then sage-env should already have been run (say, by the old sage-sage script), in which case (if it's from an old enough version) `RM` might be set to `rm`, which will break things.\n\nHmm, you might be right.",
    "created_at": "2012-04-03T23:18:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137192",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:232'></a>
Replying to [jhpalmieri](#comment%3A231):
> I'm not sure I understand the change related to #3537. If we're upgrading, then sage-env should already have been run (say, by the old sage-sage script), in which case (if it's from an old enough version) `RM` might be set to `rm`, which will break things.

Hmm, you might be right.



---

archive/issue_comments_137193.json:
```json
{
    "body": "<a id='comment:3'></a>\nChanged that code to\n\n```sh\n# If spkg/bin/sage-env doesn't exist, we are surely upgrading (sage-env\n# was moved to spkg/bin in sage-5.0).  Manually set SAGE_UPGRADING=yes,\n# as old versions of sage-upgrade didn't do this.\n# Also avoid RM being set to \"rm\":\n#   https://github.com/sagemath/sage/issues/3537\nif [ ! -f \"$SAGE_ROOT/spkg/bin/sage-env\" ]; then\n    SAGE_UPGRADING=yes\n    if [ \"$RM\" = rm ]; then\n        unset RM\n    fi\nfi\n```\nThis should remove the need to do \"unset RM\" in various `spkg-install` files.  This change is unrelated to the ticket, but I put it here because I was patching `spkg/install` anyway and I didn't want to complicate ticket dependencies.",
    "created_at": "2012-04-04T06:51:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137193",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Changed that code to

```sh
# If spkg/bin/sage-env doesn't exist, we are surely upgrading (sage-env
# was moved to spkg/bin in sage-5.0).  Manually set SAGE_UPGRADING=yes,
# as old versions of sage-upgrade didn't do this.
# Also avoid RM being set to "rm":
#   https://github.com/sagemath/sage/issues/3537
if [ ! -f "$SAGE_ROOT/spkg/bin/sage-env" ]; then
    SAGE_UPGRADING=yes
    if [ "$RM" = rm ]; then
        unset RM
    fi
fi
```
This should remove the need to do "unset RM" in various `spkg-install` files.  This change is unrelated to the ticket, but I put it here because I was patching `spkg/install` anyway and I didn't want to complicate ticket dependencies.



---

archive/issue_comments_137194.json:
```json
{
    "body": "**Changing dependencies** from \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112\" to \"#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112, #12631\".",
    "created_at": "2012-04-04T09:43:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137194",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112" to "#12479, #12602, #12608, #12609, #12647, #10492, #12367, #12368, #12405, #12570, #12574, #12423, #12425, #12456, #12363, #12223, #12515, #12519, #12548, #12562, #12629, #12638, #12714, #12647, #12739, #12112, #12631".



---

archive/issue_events_101321.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-04T09:53:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101321"
}
```



---

archive/issue_events_101322.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-04T09:53:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101322"
}
```



---

archive/attachments_017198.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12369_gcc_root.patch",
    "asset_url": "tarball://root/attachments/ticket12369/12369_gcc_root.patch",
    "created_at": "2012-04-04T09:53:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_137195.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Attachment:** [12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch)\n\nRebased [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to apply on top of #12631.  Since this is a simple rebase, I don't think it needs a new review (this change is not yet in the testing release).  The GCC spkg has not changed since the last positive_review.\n\nI have tested the testing release on the buildbot and there are no problems.  I have not yet properly tested upgrading, but will do that soon.\n\n**What needs review**: [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch)",
    "created_at": "2012-04-04T09:53:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137195",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
**Attachment:** [12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch)

Rebased [attachment:12369_gcc_root.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root.patch) to apply on top of #12631.  Since this is a simple rebase, I don't think it needs a new review (this change is not yet in the testing release).  The GCC spkg has not changed since the last positive_review.

I have tested the testing release on the buildbot and there are no problems.  I have not yet properly tested upgrading, but will do that soon.

**What needs review**: [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch)



---

archive/attachments_017199.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12369_gcc_root_part2.patch",
    "asset_url": "tarball://root/attachments/ticket12369/12369_gcc_root_part2.patch",
    "created_at": "2012-04-07T10:58:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_137196.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Attachment:** [12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch)\n\nTested upgrading from sage-4.5, sage-4.7 and sage-4.8.  Everything fine, `hg status` is clean in the root repositories.\n\nAs far as I can tell, there should be no further obstructions to releasing this.  So please review the last patch: [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch).",
    "created_at": "2012-04-07T10:58:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137196",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
**Attachment:** [12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch)

Tested upgrading from sage-4.5, sage-4.7 and sage-4.8.  Everything fine, `hg status` is clean in the root repositories.

As far as I can tell, there should be no further obstructions to releasing this.  So please review the last patch: [attachment:12369_gcc_root_part2.patch](https://github.com/sagemath/sage/files/ticket12369/12369_gcc_root_part2.patch).



---

archive/issue_comments_137197.json:
```json
{
    "body": "<a id='comment:7'></a>\nI read through 12369_gcc_root_part2.patch and it looks great to me (excellent comments!).",
    "created_at": "2012-04-07T14:45:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137197",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:7'></a>
I read through 12369_gcc_root_part2.patch and it looks great to me (excellent comments!).



---

archive/issue_events_101323.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-04-07T14:45:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101323"
}
```



---

archive/issue_events_101324.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-04-07T14:45:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101324"
}
```



---

archive/issue_comments_137198.json:
```json
{
    "body": "**Merged:** sage-5.0.beta13",
    "created_at": "2012-04-07T15:07:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137198",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta13



---

archive/issue_events_101325.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-07T15:07:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101325"
}
```



---

archive/issue_events_101326.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-07T15:07:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12369#event-101326"
}
```



---

archive/issue_comments_137199.json:
```json
{
    "body": "<a id='comment:239'></a>\nReplying to [jdemeyer](#comment%3A109):\n> Replying to [SimonKing](#comment%3A108):\n> > Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?\n\n> I honestly have no idea what would happen if you re-install the Sage library over a patched version.\n\nThat's a noop.  Mercurial notices that your current Sage library is based on the one you're trying to reinstall, so won't destroy your patched one.  (\"Reinstallation\" of the Sage library [spkg] almost always happens if you use `env SAGE_UPGRADING=yes make` after updating/reinstalling some standard spkg.)",
    "created_at": "2012-04-07T22:54:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137199",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:239'></a>
Replying to [jdemeyer](#comment%3A109):
> Replying to [SimonKing](#comment%3A108):
> > Or perhaps better exempt the `sage*` spkgs from re-installation, since my Sage library is patched?

> I honestly have no idea what would happen if you re-install the Sage library over a patched version.

That's a noop.  Mercurial notices that your current Sage library is based on the one you're trying to reinstall, so won't destroy your patched one.  ("Reinstallation" of the Sage library [spkg] almost always happens if you use `env SAGE_UPGRADING=yes make` after updating/reinstalling some standard spkg.)



---

archive/issue_comments_137200.json:
```json
{
    "body": "<a id='comment:240'></a>\nReplying to [jdemeyer](#comment%3A233):\n> Changed that code to\n> \n> ```sh\n> # If spkg/bin/sage-env doesn't exist, we are surely upgrading (sage-env\n> # was moved to spkg/bin in sage-5.0).  Manually set SAGE_UPGRADING=yes,\n> # as old versions of sage-upgrade didn't do this.\n> # Also avoid RM being set to \"rm\":\n> #   https://github.com/sagemath/sage/issues/3537\n> if [ ! -f \"$SAGE_ROOT/spkg/bin/sage-env\" ]; then\n>     SAGE_UPGRADING=yes\n>     if [ \"$RM\" = rm ]; then\n>         unset RM\n>     fi\n> fi\n> ```\n> This should remove the need to do \"unset RM\" in various `spkg-install` files.  This change is unrelated to the ticket, but I put it here because I was patching `spkg/install` anyway and I didn't want to complicate ticket dependencies.\n\nI'd just `unset RM` (or actually check whether `$RM non-existent-file` raises an error), since `RM` could be defined to `rm -i`, `rm -v`, `/bin/rm` or whatever, and not necessarily intentionally set by the user.",
    "created_at": "2012-04-08T00:40:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137200",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:240'></a>
Replying to [jdemeyer](#comment%3A233):
> Changed that code to
> 
> ```sh
> # If spkg/bin/sage-env doesn't exist, we are surely upgrading (sage-env
> # was moved to spkg/bin in sage-5.0).  Manually set SAGE_UPGRADING=yes,
> # as old versions of sage-upgrade didn't do this.
> # Also avoid RM being set to "rm":
> #   https://github.com/sagemath/sage/issues/3537
> if [ ! -f "$SAGE_ROOT/spkg/bin/sage-env" ]; then
>     SAGE_UPGRADING=yes
>     if [ "$RM" = rm ]; then
>         unset RM
>     fi
> fi
> ```
> This should remove the need to do "unset RM" in various `spkg-install` files.  This change is unrelated to the ticket, but I put it here because I was patching `spkg/install` anyway and I didn't want to complicate ticket dependencies.

I'd just `unset RM` (or actually check whether `$RM non-existent-file` raises an error), since `RM` could be defined to `rm -i`, `rm -v`, `/bin/rm` or whatever, and not necessarily intentionally set by the user.



---

archive/issue_comments_137201.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe new code is\n\n```\nif [ \"$RM\" = rm ]; then\n    export RM=\"rm -f\"\nfi\n```",
    "created_at": "2012-04-08T00:44:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137201",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
The new code is

```
if [ "$RM" = rm ]; then
    export RM="rm -f"
fi
```



---

archive/issue_comments_137202.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,8 +7,5 @@\n 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n-**Testing release**:\n-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)\n-\n **See also**:\n 1. #12782: When building GCC, build MPIR without the C++ interface\n``````\n",
    "created_at": "2012-04-08T21:25:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137202",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,8 +7,5 @@
 2. [attachment:12369_scripts_hgignore.patch](https://github.com/sagemath/sage/files/ticket12369/12369_scripts_hgignore.patch) to the `SCRIPTS` repository.
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
-**Testing release**:
-1. GCC-4.6.3: [http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/](http://boxen.math.washington.edu/home/jdemeyer/release/sage-5.0.beta12-gcc/)
-
 **See also**:
 1. #12782: When building GCC, build MPIR without the C++ interface
``````




---

archive/issue_comments_137203.json:
```json
{
    "body": "<a id='comment:3'></a>\nI get GCC build errors on Ubuntu 12.04 (still beta).\n\nApart from that Ubuntu's [broken] GCC 4.6.3 is unable to build MPFR with `-O3` (which I already reported; bug fix is on the way), the GCC from the spkg doesn't find `crti.o`.  After creating a couple of links in `/usr/lib/`, the third attempt fails in compiling `graphite.c`, because of a missing `ppl_c.h`.  (Apparently GCC found some parts of CLooG, or mistakenly assumed it was installed; I didn't have it installed, at least not below  `/usr/`.)\n\nMore to come, either here or on sage-release.",
    "created_at": "2012-04-09T13:01:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137203",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>
I get GCC build errors on Ubuntu 12.04 (still beta).

Apart from that Ubuntu's [broken] GCC 4.6.3 is unable to build MPFR with `-O3` (which I already reported; bug fix is on the way), the GCC from the spkg doesn't find `crti.o`.  After creating a couple of links in `/usr/lib/`, the third attempt fails in compiling `graphite.c`, because of a missing `ppl_c.h`.  (Apparently GCC found some parts of CLooG, or mistakenly assumed it was installed; I didn't have it installed, at least not below  `/usr/`.)

More to come, either here or on sage-release.



---

archive/issue_comments_137204.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.\n \n **See also**:\n-1. #12782: When building GCC, build MPIR without the C++ interface\n+1. #12782: When building GCC, build MPIR without the C++ interface (superseded by #11616).\n``````\n",
    "created_at": "2012-04-09T14:46:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12369#issuecomment-137204",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 3. [attachment:12369_doc.patch](https://github.com/sagemath/sage/files/ticket12369/12369_doc.patch) to the Sage library.
 
 **See also**:
-1. #12782: When building GCC, build MPIR without the C++ interface
+1. #12782: When building GCC, build MPIR without the C++ interface (superseded by #11616).
``````

