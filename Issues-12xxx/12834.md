# Issue 12834: Modify subs so that it can accept multiple equations just like subs_expr

archive/issues_012662.json:
```json
{
    "assignees": [],
    "body": "In this ticket:\n- we make `expr.substitute(in_dict, **kwds)` as `expr.substitute(*args, **kwds)` and make it accepts any kind of arguments (symbolic equalities, dictionnaries or lists of them)\n- we deprecate `subs_expr` as a duplicate of `subs`\n\nThis came up as a method of passing solutions from solve back into symbolic equations:\n\n```\n    f(x,y) = (1-x)^2 + 100*(y - x^2)^2\n    solution = solve([f.diff(ar) for ar in f.args()],f.args())[0]\n\nGives me a list of solutions as:\n\n    [x=1;y=1]\n\nIs there any way to programatically substitute this list of equalities back into f?\n```\n\nThe solution provided by Michael Orlitzky was \n\n```\nf(x,y).subs_expr(*solution)\n```\n\nAnycase, as noted by Michael, it would be nice if subs had the same behaviour:\n\n```\nPassing it one equation does work,\n\n  sage: f.subs(x == 1)\n  y + z + 1\n\nBut more than one doesn't,\n\n  sage: f.subs(x == 1, y == 2)\n  ...\n  TypeError: substitute() takes at most 1 positional argument (2 given)\n\nI guess all that's missing is the ability to pass it multiple equations,\nlike `subs_expr`. It would probably be easy to add that ability to\n`subs` if you want to create a ticket for something.\n```\n\n\nWith the branch applied we have:\n\n```\nsage: f(x,y) = (1-x)^2 + 100*(y - x^2)^2\nsage: solution = solve([f.diff(ar) for ar in f.args()],f.args())\nsage: solution\n[[x == 1, y == 1]]\nsage: f.subs(solution[0])\n(x, y) |--> 0\n```\n\nAssignee: **@aghitza**\n\nCC:  @kcrisman\n\nKeywords: **subs algebra solving**\n\nBranch/Commit: **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**\n\nReviewer: **Vincent Delecroix, Michael Orlitzky**\n\nAuthor: **Michael Orlitzky, Vincent Delecroix**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12834_\n\n",
    "closed_at": "2015-05-20T22:28:21Z",
    "created_at": "2012-04-12T13:03:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Modify subs so that it can accept multiple equations just like subs_expr",
    "type": "issue",
    "updated_at": "2015-05-20T22:28:21Z",
    "url": "https://github.com/sagemath/sage/issues/12834",
    "user": "https://github.com/sagetrac-JoalHeagney"
}
```
In this ticket:
- we make `expr.substitute(in_dict, **kwds)` as `expr.substitute(*args, **kwds)` and make it accepts any kind of arguments (symbolic equalities, dictionnaries or lists of them)
- we deprecate `subs_expr` as a duplicate of `subs`

This came up as a method of passing solutions from solve back into symbolic equations:

```
    f(x,y) = (1-x)^2 + 100*(y - x^2)^2
    solution = solve([f.diff(ar) for ar in f.args()],f.args())[0]

Gives me a list of solutions as:

    [x=1;y=1]

Is there any way to programatically substitute this list of equalities back into f?
```

The solution provided by Michael Orlitzky was 

```
f(x,y).subs_expr(*solution)
```

Anycase, as noted by Michael, it would be nice if subs had the same behaviour:

```
Passing it one equation does work,

  sage: f.subs(x == 1)
  y + z + 1

But more than one doesn't,

  sage: f.subs(x == 1, y == 2)
  ...
  TypeError: substitute() takes at most 1 positional argument (2 given)

I guess all that's missing is the ability to pass it multiple equations,
like `subs_expr`. It would probably be easy to add that ability to
`subs` if you want to create a ticket for something.
```


With the branch applied we have:

```
sage: f(x,y) = (1-x)^2 + 100*(y - x^2)^2
sage: solution = solve([f.diff(ar) for ar in f.args()],f.args())
sage: solution
[[x == 1, y == 1]]
sage: f.subs(solution[0])
(x, y) |--> 0
```

Assignee: **@aghitza**

CC:  @kcrisman

Keywords: **subs algebra solving**

Branch/Commit: **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**

Reviewer: **Vincent Delecroix, Michael Orlitzky**

Author: **Michael Orlitzky, Vincent Delecroix**

_Issue created by migration from https://trac.sagemath.org/ticket/12834_





---

archive/issue_events_162088.json:
```json
{
    "actor": "https://github.com/sagetrac-JoalHeagney",
    "created_at": "2012-04-12T13:03:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162088"
}
```



---

archive/issue_events_162089.json:
```json
{
    "actor": "https://github.com/sagetrac-JoalHeagney",
    "created_at": "2012-04-12T13:03:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162089"
}
```



---

archive/issue_events_162090.json:
```json
{
    "actor": "https://github.com/sagetrac-JoalHeagney",
    "created_at": "2012-04-12T13:03:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162090"
}
```



---

archive/issue_events_162091.json:
```json
{
    "actor": "https://github.com/sagetrac-JoalHeagney",
    "created_at": "2012-04-12T13:03:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162091"
}
```



---

archive/issue_comments_146778.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\n`subs_expr` is already just doing a bit of preprocessing and then calling `subs`, so if the interface of `subs` is changed to accept a wider variety of input then subs_expr can simply be done away with. I'd say\n\n```\nsubs(self,*args,**kwargs):\n   for k in args:\n       if is_symbolic_equation(k):\n            kwargs[k.lhs()]=k.rhs() # but signal an error if key k is already present\n       elif is_dict(k):\n            add entries of k to kwargs # but signal error any key in k is already in kwargs.\n       elif is_iterable(k):\n            for e in k:\n                if is_symbolic_equation(e):\n                    same as before\n                else:\n                    error\n       else:\n            error\n   ...\n```\nNote that behaviour at the moment is a bit random:\n\n```\nsage: x.subs({x:1})\n1\nsage: x.subs({x:1},x=2)\n2\nsage: x.subs(x==1,x=2)\n1\nsage: x.subs(x=1,x=2)\nSyntaxError: keyword argument repeated\n```",
    "created_at": "2012-04-12T19:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146778",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:1" align="right">Comment 1</div>

`subs_expr` is already just doing a bit of preprocessing and then calling `subs`, so if the interface of `subs` is changed to accept a wider variety of input then subs_expr can simply be done away with. I'd say

```
subs(self,*args,**kwargs):
   for k in args:
       if is_symbolic_equation(k):
            kwargs[k.lhs()]=k.rhs() # but signal an error if key k is already present
       elif is_dict(k):
            add entries of k to kwargs # but signal error any key in k is already in kwargs.
       elif is_iterable(k):
            for e in k:
                if is_symbolic_equation(e):
                    same as before
                else:
                    error
       else:
            error
   ...
```
Note that behaviour at the moment is a bit random:

```
sage: x.subs({x:1})
1
sage: x.subs({x:1},x=2)
2
sage: x.subs(x==1,x=2)
1
sage: x.subs(x=1,x=2)
SyntaxError: keyword argument repeated
```



---

archive/issue_comments_146779.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI would argue that we accept the weird behaviour in the cases above, but document it.\n\nMost users are *(hopefully)* unlikely to use such mixed arguments, and trying to predict the desired behaviour of those that do will probably result in the wrong answer.",
    "created_at": "2012-04-13T01:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146779",
    "user": "https://github.com/sagetrac-JoalHeagney"
}
```

<div id="comment:2" align="right">Comment 2</div>

I would argue that we accept the weird behaviour in the cases above, but document it.

Most users are *(hopefully)* unlikely to use such mixed arguments, and trying to predict the desired behaviour of those that do will probably result in the wrong answer.



---

archive/issue_comments_146780.json:
```json
{
    "body": "Attachment: **[sage-trac_12834.patch.gz](https://github.com/sagemath/sage/files/ticket12834/sage-trac_12834.patch.gz)**\n\nMake Expression.subs() accept lists, throw errors on subs conflicts, and doc cleanup.",
    "created_at": "2012-04-13T06:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146780",
    "user": "https://github.com/orlitzky"
}
```

Attachment: **[sage-trac_12834.patch.gz](https://github.com/sagemath/sage/files/ticket12834/sage-trac_12834.patch.gz)**

Make Expression.subs() accept lists, throw errors on subs conflicts, and doc cleanup.



---

archive/issue_events_162092.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2012-04-13T06:43:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162092"
}
```



---

archive/issue_comments_146781.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nSome Cython limitations made this more of an event than it had to be, but the patch implements the requested feature and Nils' suggestions from comment 1.\n\nWhen you pass `subs()` a list, it's processed recursively, which has the nice side effect of allowing you to call `solve()` and pass the result to `subs()` without caring about the form of the return value.\n\nThe new `subs()` throws an error on conflicting substitutions... nobody reads the documentation unless they have to so I think it's better to alert the user that he's likely making a mistake.",
    "created_at": "2012-04-13T06:43:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146781",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:3" align="right">Comment 3</div>

Some Cython limitations made this more of an event than it had to be, but the patch implements the requested feature and Nils' suggestions from comment 1.

When you pass `subs()` a list, it's processed recursively, which has the nice side effect of allowing you to call `solve()` and pass the result to `subs()` without caring about the form of the return value.

The new `subs()` throws an error on conflicting substitutions... nobody reads the documentation unless they have to so I think it's better to alert the user that he's likely making a mistake.



---

archive/issue_comments_146782.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nWell I tried the patch out on my example and it seems to work well.",
    "created_at": "2012-06-09T04:45:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146782",
    "user": "https://github.com/sagetrac-JoalHeagney"
}
```

<div id="comment:5" align="right">Comment 5</div>

Well I tried the patch out on my example and it seems to work well.



---

archive/issue_comments_146783.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nPatch needs to be rediffed for current Sage...",
    "created_at": "2013-02-24T03:52:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146783",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">Comment 6</div>

Patch needs to be rediffed for current Sage...



---

archive/issue_comments_146784.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nAttachment: **[sage-trac_12834.2.patch.gz](https://github.com/sagemath/sage/files/ticket12834/sage-trac_12834.2.patch.gz)**\n\nUpdated!",
    "created_at": "2013-02-25T05:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146784",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:7" align="right">Comment 7</div>

Attachment: **[sage-trac_12834.2.patch.gz](https://github.com/sagemath/sage/files/ticket12834/sage-trac_12834.2.patch.gz)**

Updated!



---

archive/issue_comments_146785.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -39,3 +39,5 @@\n like `subs_expr`. It would probably be easy to add that ability to\n `subs` if you want to create a ticket for something.\n ```\n+\n+Apply sage-trac_12834.2.patch\n``````\n",
    "created_at": "2013-02-25T05:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146785",
    "user": "https://github.com/orlitzky"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -39,3 +39,5 @@
 like `subs_expr`. It would probably be easy to add that ability to
 `subs` if you want to create a ticket for something.
 ```
+
+Apply sage-trac_12834.2.patch
``````




---

archive/issue_events_162093.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162093"
}
```



---

archive/issue_events_162094.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162094"
}
```



---

archive/issue_events_162095.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162095"
}
```



---

archive/issue_events_162096.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162096"
}
```



---

archive/issue_events_162097.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162097"
}
```



---

archive/issue_events_162098.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162098"
}
```



---

archive/issue_events_162099.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162099"
}
```



---

archive/issue_events_162100.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162100"
}
```



---

archive/issue_comments_146786.json:
```json
{
    "body": "Commit: **[045eebf](https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f)**",
    "created_at": "2015-04-26T17:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146786",
    "user": "https://github.com/videlec"
}
```

Commit: **[045eebf](https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f)**



---

archive/issue_comments_146787.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nHello,\n\nI updated the patch as a git branch (trivial conflict) and I propose some cleanup in a second commit. Tell me what you think.\n\nVincent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/447b35d53b8eec0b9d44f145745d54e7ab5cccc2\">447b35d</a></td><td><code>Trac #12834: Allow Expression.subs() to take a list similarly to Expression.subs_expr().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f\">045eebf</a></td><td><code>Trac #12384: simplification and cleanup</code></td></tr></table>\n",
    "created_at": "2015-04-26T17:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146787",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">Comment 12</div>

Hello,

I updated the patch as a git branch (trivial conflict) and I propose some cleanup in a second commit. Tell me what you think.

Vincent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/447b35d53b8eec0b9d44f145745d54e7ab5cccc2">447b35d</a></td><td><code>Trac #12834: Allow Expression.subs() to take a list similarly to Expression.subs_expr().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f">045eebf</a></td><td><code>Trac #12384: simplification and cleanup</code></td></tr></table>




---

archive/issue_comments_146788.json:
```json
{
    "body": "Branch: **[public/12384](https://github.com/sagemath/sagetrac-mirror/tree/public/12384)**",
    "created_at": "2015-04-26T17:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146788",
    "user": "https://github.com/videlec"
}
```

Branch: **[public/12384](https://github.com/sagemath/sagetrac-mirror/tree/public/12384)**



---

archive/issue_comments_146789.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,12 @@\n This came up as a method of passing solutions from solve back into symbolic equations:\n-\n \n ```\n     f(x,y) = (1-x)^2 + 100*(y - x^2)^2\n-\n     solution = solve([f.diff(ar) for ar in f.args()],f.args())[0]\n-\n \n Gives me a list of solutions as:\n \n     [x=1;y=1]\n-\n \n Is there any way to programatically substitute this list of equalities back into f?\n ```\n@@ -40,4 +36,14 @@\n `subs` if you want to create a ticket for something.\n ```\n \n-Apply sage-trac_12834.2.patch\n+\n+With the branch applied we have:\n+\n+```\n+sage: f(x,y) = (1-x)^2 + 100*(y - x^2)^2\n+sage: solution = solve([f.diff(ar) for ar in f.args()],f.args())\n+sage: solution\n+[[x == 1, y == 1]]\n+sage: f.subs(solution[0])\n+(x, y) |--> 0\n+```\n``````\n",
    "created_at": "2015-04-26T17:56:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146789",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,12 @@
 This came up as a method of passing solutions from solve back into symbolic equations:
-
 
 ```
     f(x,y) = (1-x)^2 + 100*(y - x^2)^2
-
     solution = solve([f.diff(ar) for ar in f.args()],f.args())[0]
-
 
 Gives me a list of solutions as:
 
     [x=1;y=1]
-
 
 Is there any way to programatically substitute this list of equalities back into f?
 ```
@@ -40,4 +36,14 @@
 `subs` if you want to create a ticket for something.
 ```
 
-Apply sage-trac_12834.2.patch
+
+With the branch applied we have:
+
+```
+sage: f(x,y) = (1-x)^2 + 100*(y - x^2)^2
+sage: solution = solve([f.diff(ar) for ar in f.args()],f.args())
+sage: solution
+[[x == 1, y == 1]]
+sage: f.subs(solution[0])
+(x, y) |--> 0
+```
``````




---

archive/issue_comments_146790.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nAs it happens, I had started doing my own version of something similar a while ago at a time where I had no internet access and hence without seeing this ticket. The implementation here is probably better, but I pushed mine to `u/mmezzarobba/subs` in case somebody wants to see if there is anything to be salvaged. (I may doit myself in a few days/weeks, but I have no time right now.)",
    "created_at": "2015-04-27T08:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146790",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:14" align="right">Comment 14</div>

As it happens, I had started doing my own version of something similar a while ago at a time where I had no internet access and hence without seeing this ticket. The implementation here is probably better, but I pushed mine to `u/mmezzarobba/subs` in case somebody wants to see if there is anything to be salvaged. (I may doit myself in a few days/weeks, but I have no time right now.)



---

archive/issue_comments_146791.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nHi Marc,\n\nThere is some difference of designs.\n\n- in your version, the rightmost occurrence of a substitution takes precedence, while in Michael's one an error is raised\n- you deprecate `subs_expr` and `substitute_expression` (I think this is good)\n- is this a bug or a feature?\n\n```\nsage: var('x,y,t')\nsage: A = cos(x) + sin(y) + x^2 + y^2 + t\nsage: A.subs({x^2 + y^2: t})\nx^2 + y^2 + t + cos(x) + sin(y)\nsage: A.subs({cos(x) + x^2 + sin(y) + t + + y^2: 1})\n1\n```\n- I like very much the presence of examples involving maple and mathematica\n\nVincent",
    "created_at": "2015-05-08T16:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146791",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">Comment 15</div>

Hi Marc,

There is some difference of designs.

- in your version, the rightmost occurrence of a substitution takes precedence, while in Michael's one an error is raised
- you deprecate `subs_expr` and `substitute_expression` (I think this is good)
- is this a bug or a feature?

```
sage: var('x,y,t')
sage: A = cos(x) + sin(y) + x^2 + y^2 + t
sage: A.subs({x^2 + y^2: t})
x^2 + y^2 + t + cos(x) + sin(y)
sage: A.subs({cos(x) + x^2 + sin(y) + t + + y^2: 1})
1
```
- I like very much the presence of examples involving maple and mathematica

Vincent



---

archive/issue_events_162101.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T16:52:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162101"
}
```



---

archive/issue_events_162102.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T16:52:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162102"
}
```



---

archive/issue_comments_146792.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\n`@`Vincent: Most of your changes look fine to me, thanks for picking this up again. I have a few comments:\n\n1. When making multiple duplicate substitutions, all of the errors are no longer reported. This used to work like,\n\n```\nsage: d1 = {'a': 1, 'b': 2}\nsage: d2 = {'b': 1, 'a': 2}\nsage: _subs_safe_merge(d1, d2)\nValueError: Duplicate substitutions given: a, b\n```\n\nshowing that both `a` and `b` had duplicate substitituons. Now it only shows the error for `a`:\n\n```\nValueError: duplicate substitutions a->1 and a->2\n```\n\nThe test \"We should report all such conflicts...\" was intended to show that =)\n\n2. I like the fact that you show the whole substitution in the error, e.g. `ValueError: duplicate substitutions a->b and a->c`, but I think the arrow notation is confusing. I can't tell at a glance whether `a` or `b` is the variable. In some programming languages, the arrow is used to mean \"take the value of `a` and put that into `b`.\" In other contexts, you could think of it as \"take `a` and make it become `b`\", which is actually the reverse substitution.\n\nAbove, you can deduce which is which (if you think for a minute), but you can also wind up with `ValueError: duplicate substitutions x->y and x->y` where it's totally ambiguous.\n\nIs there some other notation that people generally agree on? Maybe the colon-equals, which defines the thing on the left to be equal to the thing on the right? For example, `x := 3` would mean that `x` is being defined to be `3`; i.e. `3` is substituted for `x`. It's a slight abuse of notation, but we can think of `:=` as \"make the thing on the left equal the thing on the right from now on.\" That's basically what a substitution is.\n\n3. My \"And finally, a list containing one of everything\" test was meant to show that we can handle all three types (symbolic equality, a dict, and another list) at the same time. You noticed that I forgot tuples (thanks!), but can we do them all at the same time? For example,\n\n```\nsage: w, x, y, z = SR.var('w, x, y, z')\nsage: _subs_make_dict([w == 1, {x: 1}, [y == 1], (z == 1,)])\n{w: 1, y: 1, x: 1, z: 1}\n```\n4. I agree that we can deprecate the other substitution methods `subs_expr` and `substitute_expression`.\n\nThat's it, thanks again for taking the time to work on this.",
    "created_at": "2015-05-10T05:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146792",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:16" align="right">Comment 16</div>

`@`Vincent: Most of your changes look fine to me, thanks for picking this up again. I have a few comments:

1. When making multiple duplicate substitutions, all of the errors are no longer reported. This used to work like,

```
sage: d1 = {'a': 1, 'b': 2}
sage: d2 = {'b': 1, 'a': 2}
sage: _subs_safe_merge(d1, d2)
ValueError: Duplicate substitutions given: a, b
```

showing that both `a` and `b` had duplicate substitituons. Now it only shows the error for `a`:

```
ValueError: duplicate substitutions a->1 and a->2
```

The test "We should report all such conflicts..." was intended to show that =)

2. I like the fact that you show the whole substitution in the error, e.g. `ValueError: duplicate substitutions a->b and a->c`, but I think the arrow notation is confusing. I can't tell at a glance whether `a` or `b` is the variable. In some programming languages, the arrow is used to mean "take the value of `a` and put that into `b`." In other contexts, you could think of it as "take `a` and make it become `b`", which is actually the reverse substitution.

Above, you can deduce which is which (if you think for a minute), but you can also wind up with `ValueError: duplicate substitutions x->y and x->y` where it's totally ambiguous.

Is there some other notation that people generally agree on? Maybe the colon-equals, which defines the thing on the left to be equal to the thing on the right? For example, `x := 3` would mean that `x` is being defined to be `3`; i.e. `3` is substituted for `x`. It's a slight abuse of notation, but we can think of `:=` as "make the thing on the left equal the thing on the right from now on." That's basically what a substitution is.

3. My "And finally, a list containing one of everything" test was meant to show that we can handle all three types (symbolic equality, a dict, and another list) at the same time. You noticed that I forgot tuples (thanks!), but can we do them all at the same time? For example,

```
sage: w, x, y, z = SR.var('w, x, y, z')
sage: _subs_make_dict([w == 1, {x: 1}, [y == 1], (z == 1,)])
{w: 1, y: 1, x: 1, z: 1}
```
4. I agree that we can deprecate the other substitution methods `subs_expr` and `substitute_expression`.

That's it, thanks again for taking the time to work on this.



---

archive/issue_comments_146793.json:
```json
{
    "body": "Changed author from **Michael Orlitzky** to **Michael Orlitzky, Vincent Delecroix**",
    "created_at": "2015-05-10T18:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146793",
    "user": "https://github.com/videlec"
}
```

Changed author from **Michael Orlitzky** to **Michael Orlitzky, Vincent Delecroix**



---

archive/issue_comments_146794.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix, Michael Orlitzky**",
    "created_at": "2015-05-10T18:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146794",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix, Michael Orlitzky**



---

archive/issue_comments_146795.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n+In this ticket:\n+- we make `expr.substitute(in_dict, **kwds)` as `expr.substitute(*args, **kwds)` and make it accepts any kind of arguments (symbolic equalities, dictionnaries or lists of them)\n+- we deprecate `subs_expr` as a duplicate of `subs`\n+\n This came up as a method of passing solutions from solve back into symbolic equations:\n \n ```\n``````\n",
    "created_at": "2015-05-10T18:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146795",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
+In this ticket:
+- we make `expr.substitute(in_dict, **kwds)` as `expr.substitute(*args, **kwds)` and make it accepts any kind of arguments (symbolic equalities, dictionnaries or lists of them)
+- we deprecate `subs_expr` as a duplicate of `subs`
+
 This came up as a method of passing solutions from solve back into symbolic equations:
 
 ```
``````




---

archive/issue_comments_146796.json:
```json
{
    "body": "Changed branch from **[public/12384](https://github.com/sagemath/sagetrac-mirror/tree/public/12384)** to **[public/12834](https://github.com/sagemath/sagetrac-mirror/tree/public/12834)**",
    "created_at": "2015-05-10T18:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146796",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[public/12384](https://github.com/sagemath/sagetrac-mirror/tree/public/12384)** to **[public/12834](https://github.com/sagemath/sagetrac-mirror/tree/public/12834)**



---

archive/issue_comments_146797.json:
```json
{
    "body": "Changed commit from **[045eebf](https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f)** to **[02ca484](https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f)**",
    "created_at": "2015-05-10T18:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146797",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[045eebf](https://github.com/sagemath/sagetrac-mirror/commit/045eebfd67858405c6665acfa1eea5f22ca7fc6f)** to **[02ca484](https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f)**



---

archive/issue_comments_146798.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@orlitzky](#comment%3A16):\n> `@`Vincent: Most of your changes look fine to me, thanks for picking this up again. I have a few comments:\n> \n> 1. When making multiple duplicate substitutions, all of the errors are no longer reported. This used to work like,\n\nThis is not really doable and makes no sense if there are a lot of arguments like\n\n```\nsage: expr.subs((a == b), [a == c, x == 3], {a: 4})\n```\nThe dictionary of substitutions is constructed sequentially.\n\nI just removed the problematic doctest. If you prefer to report all collisions, please tell me why...\n \n> 2. I like the fact that you show the whole substitution in the error, e.g. `ValueError: duplicate substitutions a->b and a->c`, but I think the arrow notation is confusing. \n\nYou are perfectly right. This is now a whole sentence\n\n```\nduplicate substitution for a, got values 1 and 2\n```\n\n> 3. My \"And finally, a list containing one of everything\" test was meant to show that we can handle all three types (symbolic equality, a dict, and another list) at the same time. You noticed that I forgot tuples (thanks!), but can we do them all at the same time? For example,\n\n\nThere is a now a doctest for that.\n\n> 4. I agree that we can deprecate the other substitution methods `subs_expr` and `substitute_expression`.\n\nDone.\n\nVincent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0272d29eb24460669dcd59439998937ea52dbeac\">0272d29</a></td><td><code>Trac 12834: merge sage-6.7.beta4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6e196d835e163cc9263374223d453dd8b6dca65\">b6e196d</a></td><td><code>Trac 12834: remove trailing whitespaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a09094a35bb71998e17a3b36031400c9f856727e\">a09094a</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f\">02ca484</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr></table>\n",
    "created_at": "2015-05-10T18:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146798",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@orlitzky](#comment%3A16):
> `@`Vincent: Most of your changes look fine to me, thanks for picking this up again. I have a few comments:
> 
> 1. When making multiple duplicate substitutions, all of the errors are no longer reported. This used to work like,

This is not really doable and makes no sense if there are a lot of arguments like

```
sage: expr.subs((a == b), [a == c, x == 3], {a: 4})
```
The dictionary of substitutions is constructed sequentially.

I just removed the problematic doctest. If you prefer to report all collisions, please tell me why...
 
> 2. I like the fact that you show the whole substitution in the error, e.g. `ValueError: duplicate substitutions a->b and a->c`, but I think the arrow notation is confusing. 

You are perfectly right. This is now a whole sentence

```
duplicate substitution for a, got values 1 and 2
```

> 3. My "And finally, a list containing one of everything" test was meant to show that we can handle all three types (symbolic equality, a dict, and another list) at the same time. You noticed that I forgot tuples (thanks!), but can we do them all at the same time? For example,


There is a now a doctest for that.

> 4. I agree that we can deprecate the other substitution methods `subs_expr` and `substitute_expression`.

Done.

Vincent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0272d29eb24460669dcd59439998937ea52dbeac">0272d29</a></td><td><code>Trac 12834: merge sage-6.7.beta4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6e196d835e163cc9263374223d453dd8b6dca65">b6e196d</a></td><td><code>Trac 12834: remove trailing whitespaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a09094a35bb71998e17a3b36031400c9f856727e">a09094a</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f">02ca484</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr></table>




---

archive/issue_events_162103.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-10T18:39:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162103"
}
```



---

archive/issue_events_162104.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-10T18:39:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162104"
}
```



---

archive/issue_comments_146799.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@videlec](#comment%3A15):\n> - is this a bug or a feature?\n> \n> ```\n> sage: var('x,y,t')\n> sage: A = cos(x) + sin(y) + x^2 + y^2 + t\n> sage: A.subs({x^2 + y^2: t})\n> x^2 + y^2 + t + cos(x) + sin(y)\n> sage: A.subs({cos(x) + x^2 + sin(y) + t + + y^2: 1})\n> 1\n> ```\n\nI opened #18396 for that purpose.",
    "created_at": "2015-05-10T18:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146799",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@videlec](#comment%3A15):
> - is this a bug or a feature?
> 
> ```
> sage: var('x,y,t')
> sage: A = cos(x) + sin(y) + x^2 + y^2 + t
> sage: A.subs({x^2 + y^2: t})
> x^2 + y^2 + t + cos(x) + sin(y)
> sage: A.subs({cos(x) + x^2 + sin(y) + t + + y^2: 1})
> 1
> ```

I opened #18396 for that purpose.



---

archive/issue_comments_146800.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@videlec](#comment%3A18):\n> \n> I just removed the problematic doctest. If you prefer to report all collisions, please tell me why...\n> \n\nIt can be annoying to have to retry the call to `subs()` over and over again getting a different error every time. But it's not a big deal to me.\n\nI made a few more changes noted in the commit messages.. everything seems OK otherwise, pending a ptestlong. I also rebased on top of the develop branch to get a clean commit history.",
    "created_at": "2015-05-10T22:49:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146800",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@videlec](#comment%3A18):
> 
> I just removed the problematic doctest. If you prefer to report all collisions, please tell me why...
> 

It can be annoying to have to retry the call to `subs()` over and over again getting a different error every time. But it's not a big deal to me.

I made a few more changes noted in the commit messages.. everything seems OK otherwise, pending a ptestlong. I also rebased on top of the develop branch to get a clean commit history.



---

archive/issue_comments_146801.json:
```json
{
    "body": "Changed commit from **[02ca484](https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f)** to **[24b98a0](https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8)**",
    "created_at": "2015-05-10T22:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146801",
    "user": "https://github.com/orlitzky"
}
```

Changed commit from **[02ca484](https://github.com/sagemath/sagetrac-mirror/commit/02ca48403e7fa696c368250084d8d9eebd0de14f)** to **[24b98a0](https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8)**



---

archive/issue_comments_146802.json:
```json
{
    "body": "Changed branch from **[public/12834](https://github.com/sagemath/sagetrac-mirror/tree/public/12834)** to **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)**",
    "created_at": "2015-05-10T22:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146802",
    "user": "https://github.com/orlitzky"
}
```

Changed branch from **[public/12834](https://github.com/sagemath/sagetrac-mirror/tree/public/12834)** to **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)**



---

archive/issue_comments_146803.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7eb66e22b0dfe80e0f9de4e1291858f5496dc85\">d7eb66e</a></td><td><code>Trac #12834: Allow Expression.subs() to take a list similarly to Expression.subs_expr().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cf4498ad6f504004fe4dd7134a357c591a2504b\">3cf4498</a></td><td><code>Trac #12384: simplification and cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27bbade79aab8370fba82173815f086b9894efc5\">27bbade</a></td><td><code>Trac 12834: remove trailing whitespaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97215129a28df5f25686973aba66c99855ef2216\">9721512</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb5de825669007a6711033fb3f583b6bc3c4d3d3\">bb5de82</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05492f4cc1e35f1eccf12f6c0c640b6b790d1389\">05492f4</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d34382b06f101f0db8a52724f07c6ad70830b32\">0d34382</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9030aba0e1fb17cfc35bd3e5093bad5896ac9a35\">9030aba</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b0676cd1b5d111fb2dbd5db95d573e4392d44fd\">6b0676c</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8\">24b98a0</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr></table>\n",
    "created_at": "2015-05-10T22:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146803",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:22" align="right">Comment 22</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7eb66e22b0dfe80e0f9de4e1291858f5496dc85">d7eb66e</a></td><td><code>Trac #12834: Allow Expression.subs() to take a list similarly to Expression.subs_expr().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cf4498ad6f504004fe4dd7134a357c591a2504b">3cf4498</a></td><td><code>Trac #12384: simplification and cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27bbade79aab8370fba82173815f086b9894efc5">27bbade</a></td><td><code>Trac 12834: remove trailing whitespaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97215129a28df5f25686973aba66c99855ef2216">9721512</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb5de825669007a6711033fb3f583b6bc3c4d3d3">bb5de82</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05492f4cc1e35f1eccf12f6c0c640b6b790d1389">05492f4</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d34382b06f101f0db8a52724f07c6ad70830b32">0d34382</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9030aba0e1fb17cfc35bd3e5093bad5896ac9a35">9030aba</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b0676cd1b5d111fb2dbd5db95d573e4392d44fd">6b0676c</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8">24b98a0</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr></table>




---

archive/issue_comments_146804.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nHello,\n\nI do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along\n\n```\ndup = [k for k in d2 if k in d1]\nif dup:\n    k = min(dup)   \n    msg = \"duplicate substitution for {}, got values {} and {}\"\n    raise ValueError(msg.format(k, d1[k], d2[k]))\n```\nAnd you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?\n\nIf you have access to `Maple/Mathematica` I would be curious to know what they do for\n\n```\nsage: (x + x^2 + x^4).subs(x + x^2 == 2)\n```\n\nThe other changes are fine to me.\n\nVincent",
    "created_at": "2015-05-11T07:20:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146804",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">Comment 23</div>

Hello,

I do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along

```
dup = [k for k in d2 if k in d1]
if dup:
    k = min(dup)   
    msg = "duplicate substitution for {}, got values {} and {}"
    raise ValueError(msg.format(k, d1[k], d2[k]))
```
And you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?

If you have access to `Maple/Mathematica` I would be curious to know what they do for

```
sage: (x + x^2 + x^4).subs(x + x^2 == 2)
```

The other changes are fine to me.

Vincent



---

archive/issue_events_162105.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-11T07:20:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162105"
}
```



---

archive/issue_events_162106.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-11T07:20:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162106"
}
```



---

archive/issue_events_162107.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-11T08:01:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162107"
}
```



---

archive/issue_events_162108.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-11T08:01:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162108"
}
```



---

archive/issue_comments_146805.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nI just asked some collegues and maple does\n\n```\n>> subs(x = t, x + x^2 + x^3)\n                           3    2\n                          t  + t  + t\n>> subs(x^2 = t, x + x^2 + x^3) \n                            3\n                           x  + t + x\n>> subs(x + x^3 = t, x + x^2 + x^3) \n                           3    2\n                          x  + x  + x\n>> subs(x + x^2 = t, x + x^2 + x^3) \n                           3    2\n                          x  + x  + x\n>> subs(x + x^2 + x^3 = t, x + x^2 + x^3) \n                               t\n\n```\nIt would be cool to have these doctests. I found these examples simpler than what we currently have.",
    "created_at": "2015-05-11T08:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146805",
    "user": "https://github.com/videlec"
}
```

<div id="comment:25" align="right">Comment 25</div>

I just asked some collegues and maple does

```
>> subs(x = t, x + x^2 + x^3)
                           3    2
                          t  + t  + t
>> subs(x^2 = t, x + x^2 + x^3) 
                            3
                           x  + t + x
>> subs(x + x^3 = t, x + x^2 + x^3) 
                           3    2
                          x  + x  + x
>> subs(x + x^2 = t, x + x^2 + x^3) 
                           3    2
                          x  + x  + x
>> subs(x + x^2 + x^3 = t, x + x^2 + x^3) 
                               t

```
It would be cool to have these doctests. I found these examples simpler than what we currently have.



---

archive/issue_comments_146806.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nReplying to [@videlec](#comment%3A23):\n> Hello,\n> \n> I do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along\n> \n> ```\n> dup = [k for k in d2 if k in d1]\n> if dup:\n>     k = min(dup)   \n>     msg = \"duplicate substitution for {}, got values {} and {}\"\n>     raise ValueError(msg.format(k, d1[k], d2[k]))\n> ```\n> And you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?\n\nI guess I wasn't very clear in my commit message =)\n\nThe original code was,\n\n```\nif any(k in d1 for k in d2):\n    k = (k for k in d1 if k in d2).next()\n    raise ValueError...\n```\n\nThe first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,\n\n```\n    k = (k for k in d1 if k in d2).next()\n```\n\n**also** looks through both dictionaries, essentially to do the same thing: to see if there are any duplicates, but this time we write down the first duplicate key.\n\nSince we're going to find the first duplicate key *anyway*, we don't need to do the first `any` check. If the dupe is toward the end of the list, the `any`less version could be a lot faster. Once the `any` check is gone, my version isn't much different than yours. But since I've removed the `any` check, I no longer know that `next()` is safe in\n\n```\nk = (k for k in d1 if k in d2).next()\n```\n\nbecause it could throw a `StopIteration` exception. Instead of catching the exception, I chose to use a \"for ... in\" loop iteration:\n\n```\nfor k in (k for k in d1 if k in d2)\n``` \n\nThat achieves the same thing without having to check whether or not there were any dupes. I tested it with some big dictionaries and it is a little faster. But since I can't force a dupe to be \"at the end\" of a dictionary, I can't check the worst-case.\n\nIn any case, I'm going to push another version that should be faster and simpler than both =)",
    "created_at": "2015-05-11T17:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146806",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:26" align="right">Comment 26</div>

Replying to [@videlec](#comment%3A23):
> Hello,
> 
> I do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along
> 
> ```
> dup = [k for k in d2 if k in d1]
> if dup:
>     k = min(dup)   
>     msg = "duplicate substitution for {}, got values {} and {}"
>     raise ValueError(msg.format(k, d1[k], d2[k]))
> ```
> And you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?

I guess I wasn't very clear in my commit message =)

The original code was,

```
if any(k in d1 for k in d2):
    k = (k for k in d1 if k in d2).next()
    raise ValueError...
```

The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,

```
    k = (k for k in d1 if k in d2).next()
```

**also** looks through both dictionaries, essentially to do the same thing: to see if there are any duplicates, but this time we write down the first duplicate key.

Since we're going to find the first duplicate key *anyway*, we don't need to do the first `any` check. If the dupe is toward the end of the list, the `any`less version could be a lot faster. Once the `any` check is gone, my version isn't much different than yours. But since I've removed the `any` check, I no longer know that `next()` is safe in

```
k = (k for k in d1 if k in d2).next()
```

because it could throw a `StopIteration` exception. Instead of catching the exception, I chose to use a "for ... in" loop iteration:

```
for k in (k for k in d1 if k in d2)
``` 

That achieves the same thing without having to check whether or not there were any dupes. I tested it with some big dictionaries and it is a little faster. But since I can't force a dupe to be "at the end" of a dictionary, I can't check the worst-case.

In any case, I'm going to push another version that should be faster and simpler than both =)



---

archive/issue_comments_146807.json:
```json
{
    "body": "Changed commit from **[24b98a0](https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8)** to **[e195b36](https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51)**",
    "created_at": "2015-05-11T17:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146807",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[24b98a0](https://github.com/sagemath/sagetrac-mirror/commit/24b98a061c140e9f76b171eb3dd1be0fa44d36b8)** to **[e195b36](https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51)**



---

archive/issue_comments_146808.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51\">e195b36</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr></table>\n",
    "created_at": "2015-05-11T17:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146808",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27" align="right">Comment 27</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51">e195b36</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr></table>




---

archive/issue_comments_146809.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nReplying to [@orlitzky](#comment%3A26):\n> Replying to [@videlec](#comment%3A23):\n> > Hello,\n> > \n> > I do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along\n> > \n> > ```\n> > dup = [k for k in d2 if k in d1]\n> > if dup:\n> >     k = min(dup)   \n> >     msg = \"duplicate substitution for {}, got values {} and {}\"\n> >     raise ValueError(msg.format(k, d1[k], d2[k]))\n> > ```\n> > And you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?\n\n> \n> I guess I wasn't very clear in my commit message =)\n> \n> The original code was,\n> \n> ```\n> if any(k in d1 for k in d2):\n>     k = (k for k in d1 if k in d2).next()\n>     raise ValueError...\n> ```\n> \n> The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,\n\nYou are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).",
    "created_at": "2015-05-11T17:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146809",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">Comment 28</div>

Replying to [@orlitzky](#comment%3A26):
> Replying to [@videlec](#comment%3A23):
> > Hello,
> > 
> > I do not agree with your `05492f4` and `0d34382`. First of all, if something is wrong, then it is not a big deal to go through the dictionaries again. Your version is way much too complicated. Please do something along
> > 
> > ```
> > dup = [k for k in d2 if k in d1]
> > if dup:
> >     k = min(dup)   
> >     msg = "duplicate substitution for {}, got values {} and {}"
> >     raise ValueError(msg.format(k, d1[k], d2[k]))
> > ```
> > And you can remark that I iterated over `d2` and this was intentional. The dictionary `d1` is intended to be large compared to `d2` (think about `expr.subs(u == 18, v == 15, w == 19, x == 1, y == 2, z == 3)`). In your commit you reversed that. And you should know that to get the minimum of a list you do not need to sort it ;-) Was the call to `sorted` intentional compared to `min`?

> 
> I guess I wasn't very clear in my commit message =)
> 
> The original code was,
> 
> ```
> if any(k in d1 for k in d2):
>     k = (k for k in d1 if k in d2).next()
>     raise ValueError...
> ```
> 
> The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,

You are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).



---

archive/issue_comments_146810.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nAnd looking at your last commit `k2 in d1.keys()` is O(n) in **any** case whereas `k2 in d1` is a lookup in a hash table.",
    "created_at": "2015-05-11T17:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146810",
    "user": "https://github.com/videlec"
}
```

<div id="comment:29" align="right">Comment 29</div>

And looking at your last commit `k2 in d1.keys()` is O(n) in **any** case whereas `k2 in d1` is a lookup in a hash table.



---

archive/issue_comments_146811.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nAnd if you want to be convinced\n\n```\nsage: l = range(1000)\nsage: timeit(\"-1 in l\", number=2000)\n2000 loops, best of 3: 26.1 \u00b5s per loop\nsage: d = dict.fromkeys(range(1000))\nsage: timeit(\"-1 in d\", number=2000)\n2000 loops, best of 3: 460 ns per loop\n```",
    "created_at": "2015-05-11T17:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146811",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">Comment 30</div>

And if you want to be convinced

```
sage: l = range(1000)
sage: timeit("-1 in l", number=2000)
2000 loops, best of 3: 26.1 s per loop
sage: d = dict.fromkeys(range(1000))
sage: timeit("-1 in d", number=2000)
2000 loops, best of 3: 460 ns per loop
```



---

archive/issue_comments_146812.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nIn other words, just do\n\n```\nfor k in sorted(d2, key=str):\n    if k in d1:\n        ...\n```",
    "created_at": "2015-05-11T17:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146812",
    "user": "https://github.com/videlec"
}
```

<div id="comment:31" align="right">Comment 31</div>

In other words, just do

```
for k in sorted(d2, key=str):
    if k in d1:
        ...
```



---

archive/issue_comments_146813.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nReplying to [@videlec](#comment%3A29):\n> And looking at your last commit `k2 in d1.keys()` is O(n) in **any** case whereas `k2 in d1` is a lookup in a hash table.\n\nYou are definitely right about this, I'll fix it.",
    "created_at": "2015-05-11T18:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146813",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:32" align="right">Comment 32</div>

Replying to [@videlec](#comment%3A29):
> And looking at your last commit `k2 in d1.keys()` is O(n) in **any** case whereas `k2 in d1` is a lookup in a hash table.

You are definitely right about this, I'll fix it.



---

archive/issue_comments_146814.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@videlec](#comment%3A28):\n> > \n> > The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,\n\n> \n> You are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).\n\nRight, but doesn't this\n\n```\nk in d1 for k in d2\n```\n\ndo the `d1[k]` lookup (which is O(n)) m times, once for each key in `d2`?",
    "created_at": "2015-05-11T18:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146814",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@videlec](#comment%3A28):
> > 
> > The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,

> 
> You are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).

Right, but doesn't this

```
k in d1 for k in d2
```

do the `d1[k]` lookup (which is O(n)) m times, once for each key in `d2`?



---

archive/issue_comments_146815.json:
```json
{
    "body": "Changed commit from **[e195b36](https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51)** to **[33fd449](https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619)**",
    "created_at": "2015-05-11T19:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146815",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e195b36](https://github.com/sagemath/sagetrac-mirror/commit/e195b36b27caeeebcb6f2e69f90b048a9e5b9d51)** to **[33fd449](https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619)**



---

archive/issue_comments_146816.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619\">33fd449</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr></table>\n",
    "created_at": "2015-05-11T19:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146816",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619">33fd449</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr></table>




---

archive/issue_comments_146817.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nReplying to [@orlitzky](#comment%3A33):\n> Replying to [@videlec](#comment%3A28):\n> > > \n> > > The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,\n\n> > \n> > You are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).\n\n> \n> Right, but doesn't this\n> \n> ```\n> k in d1 for k in d2\n> ```\n> \n> do the `d1[k]` lookup (which is O(n)) m times, once for each key in `d2`?\n\nThe lookup is O(1). And once for each key in d2 gives O(m). There is no for loop on d1, isn't it?",
    "created_at": "2015-05-11T19:21:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146817",
    "user": "https://github.com/videlec"
}
```

<div id="comment:35" align="right">Comment 35</div>

Replying to [@orlitzky](#comment%3A33):
> Replying to [@videlec](#comment%3A28):
> > > 
> > > The first `any(k in d1 for k in d2)` is probably O(m*n), since it (potentially) has to look through all of both dictionaries to see if there are any duplicates. Then,

> > 
> > You are wrong. A dictionary is a hash table not a list. Assuming that there is no collision this is a O(m) where m=size(d2).

> 
> Right, but doesn't this
> 
> ```
> k in d1 for k in d2
> ```
> 
> do the `d1[k]` lookup (which is O(n)) m times, once for each key in `d2`?

The lookup is O(1). And once for each key in d2 gives O(m). There is no for loop on d1, isn't it?



---

archive/issue_comments_146818.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nLooks good to me. Can I add a commit to show a more relevant example about comparisons of maple/mathematica with respect to substitution?",
    "created_at": "2015-05-11T19:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146818",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">Comment 36</div>

Looks good to me. Can I add a commit to show a more relevant example about comparisons of maple/mathematica with respect to substitution?



---

archive/issue_comments_146819.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@videlec](#comment%3A35):\n> \n> The lookup is O(1). And once for each key in d2 gives O(m). There is no for loop on d1, isn't it?\n\nAh, I was using the worst-case O(n) instead of the average O(1).\n\n\n\n> Looks good to me. Can I add a commit to show a more relevant example about comparisons of maple/mathematica with respect to substitution?\n\nSure.",
    "created_at": "2015-05-11T19:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146819",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@videlec](#comment%3A35):
> 
> The lookup is O(1). And once for each key in d2 gives O(m). There is no for loop on d1, isn't it?

Ah, I was using the worst-case O(n) instead of the average O(1).



> Looks good to me. Can I add a commit to show a more relevant example about comparisons of maple/mathematica with respect to substitution?

Sure.



---

archive/issue_comments_146820.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nSorry for the delay!\n\nI added a more complete example comparing maxima/maple/mathematica. Tested with the last version of maple but I do not have access to Mathematica. So it lacks some test.\n\nI think I am done. So I let you review my last commit.\n\nnote: it is based on 6.7.rc0\n\nVincent\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8b9c05288d4f498960f9c841758723905e90f93\">e8b9c05</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81ebcdc0a33910aee43ca01ea469e46d778dd7d1\">81ebcdc</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7a233b480b9919873fd01eff35023f63a99105f\">f7a233b</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/322981ed8b2da9cb13314d60d5cc54fc569f2c8f\">322981e</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/003fa0061ba7748acfcb00b8097087ac6da1f2b5\">003fa00</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5460cfc00d8429cf3878a8951a70d3019f245238\">5460cfc</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6170948c84d5d790508fdd9598a125fd866e142\">e617094</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37aa1f81724b03fb60c2b8fd0b7e989e3243452a\">37aa1f8</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2d58a312386ed978ebe8d5646561736654186e1\">d2d58a3</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31\">a56c969</a></td><td><code>Trac 12834: more details substitution examples</code></td></tr></table>\n",
    "created_at": "2015-05-17T21:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146820",
    "user": "https://github.com/videlec"
}
```

<div id="comment:38" align="right">Comment 38</div>

Sorry for the delay!

I added a more complete example comparing maxima/maple/mathematica. Tested with the last version of maple but I do not have access to Mathematica. So it lacks some test.

I think I am done. So I let you review my last commit.

note: it is based on 6.7.rc0

Vincent

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8b9c05288d4f498960f9c841758723905e90f93">e8b9c05</a></td><td><code>Trac 12834: review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81ebcdc0a33910aee43ca01ea469e46d778dd7d1">81ebcdc</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7a233b480b9919873fd01eff35023f63a99105f">f7a233b</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/322981ed8b2da9cb13314d60d5cc54fc569f2c8f">322981e</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/003fa0061ba7748acfcb00b8097087ac6da1f2b5">003fa00</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5460cfc00d8429cf3878a8951a70d3019f245238">5460cfc</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6170948c84d5d790508fdd9598a125fd866e142">e617094</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37aa1f81724b03fb60c2b8fd0b7e989e3243452a">37aa1f8</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2d58a312386ed978ebe8d5646561736654186e1">d2d58a3</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31">a56c969</a></td><td><code>Trac 12834: more details substitution examples</code></td></tr></table>




---

archive/issue_comments_146821.json:
```json
{
    "body": "Changed commit from **[33fd449](https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619)** to **[a56c969](https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31)**",
    "created_at": "2015-05-17T21:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146821",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[33fd449](https://github.com/sagemath/sagetrac-mirror/commit/33fd4491e0014487e18bdc1007d21751d74f8619)** to **[a56c969](https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31)**



---

archive/issue_events_162109.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-17T21:38:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162109"
}
```



---

archive/issue_events_162110.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-17T21:38:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162110"
}
```



---

archive/issue_comments_146822.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)** to **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)**",
    "created_at": "2015-05-17T21:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146822",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)** to **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)**



---

archive/issue_comments_146823.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)** to **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)**",
    "created_at": "2015-05-19T00:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146823",
    "user": "https://github.com/orlitzky"
}
```

Changed branch from **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)** to **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)**



---

archive/issue_comments_146824.json:
```json
{
    "body": "Changed commit from **[a56c969](https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31)** to **[66b961c](https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f)**",
    "created_at": "2015-05-19T00:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146824",
    "user": "https://github.com/orlitzky"
}
```

Changed commit from **[a56c969](https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31)** to **[66b961c](https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f)**



---

archive/issue_comments_146825.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nI made some minor cosmetic fixes (typo fix and word-wrap). Other than that it looks good to me. As long as those optional tests work (I don't have maple/mathematica), you can mark it positive review.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81ebcdc0a33910aee43ca01ea469e46d778dd7d1\">81ebcdc</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7a233b480b9919873fd01eff35023f63a99105f\">f7a233b</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/322981ed8b2da9cb13314d60d5cc54fc569f2c8f\">322981e</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/003fa0061ba7748acfcb00b8097087ac6da1f2b5\">003fa00</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5460cfc00d8429cf3878a8951a70d3019f245238\">5460cfc</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6170948c84d5d790508fdd9598a125fd866e142\">e617094</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37aa1f81724b03fb60c2b8fd0b7e989e3243452a\">37aa1f8</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2d58a312386ed978ebe8d5646561736654186e1\">d2d58a3</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31\">a56c969</a></td><td><code>Trac 12834: more details substitution examples</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f\">66b961c</a></td><td><code>Trac #12834: Typo fix and manually word-wrap a few doctests.</code></td></tr></table>\n",
    "created_at": "2015-05-19T00:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146825",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:39" align="right">Comment 39</div>

I made some minor cosmetic fixes (typo fix and word-wrap). Other than that it looks good to me. As long as those optional tests work (I don't have maple/mathematica), you can mark it positive review.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81ebcdc0a33910aee43ca01ea469e46d778dd7d1">81ebcdc</a></td><td><code>Trac 12834: fix the french book that is using subs_expr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7a233b480b9919873fd01eff35023f63a99105f">f7a233b</a></td><td><code>Trac #12834: Avoid iterating over the substitution dict twice.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/322981ed8b2da9cb13314d60d5cc54fc569f2c8f">322981e</a></td><td><code>Trac #12834: Ensure consistent failures by sorting duplicate substitutions.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/003fa0061ba7748acfcb00b8097087ac6da1f2b5">003fa00</a></td><td><code>Trac #12834: Test equality of dictionaries to avoid sorting bugs.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5460cfc00d8429cf3878a8951a70d3019f245238">5460cfc</a></td><td><code>Trac #12834: Mention the tuple representation in _subs_make_dict's docstring.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6170948c84d5d790508fdd9598a125fd866e142">e617094</a></td><td><code>Trac #12834: Manually word-wrap some lines.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37aa1f81724b03fb60c2b8fd0b7e989e3243452a">37aa1f8</a></td><td><code>Trac #12834: Simplify duplicate detection in _dict_update_check_duplicate.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2d58a312386ed978ebe8d5646561736654186e1">d2d58a3</a></td><td><code>Trac #12834: Fix hash lookup in _dict_update_check_duplicate.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a56c96969fd5baa0b4fbe53d9f60cbcd89fd8e31">a56c969</a></td><td><code>Trac 12834: more details substitution examples</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f">66b961c</a></td><td><code>Trac #12834: Typo fix and manually word-wrap a few doctests.</code></td></tr></table>




---

archive/issue_events_162111.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-19T07:10:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162111"
}
```



---

archive/issue_events_162112.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-19T07:10:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162112"
}
```



---

archive/issue_comments_146826.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nThanks for the last fixes!",
    "created_at": "2015-05-19T07:10:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146826",
    "user": "https://github.com/videlec"
}
```

<div id="comment:40" align="right">Comment 40</div>

Thanks for the last fixes!



---

archive/issue_comments_146827.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\n\n```\nsage -t --long --warn-long 26.6 src/sage/doctest/sources.py\n**********************************************************************\nFile \"src/sage/doctest/sources.py\", line 694, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time\n        path = os.path.relpath(path)\n        dirs.sort(); files.sort()\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))\n                FDS._test_enough_doctests(verbose=False)\nExpected:\n    There are 7 tests in sage/combinat/dyck_word.py that are not being run\n    There are 4 tests in sage/combinat/finite_state_machine.py that are not being run\n    There are 6 tests in sage/combinat/interval_posets.py that are not being run\n    There are 18 tests in sage/combinat/partition.py that are not being run\n    There are 15 tests in sage/combinat/permutation.py that are not being run\n    There are 14 tests in sage/combinat/skew_partition.py that are not being run\n    There are 18 tests in sage/combinat/tableau.py that are not being run\n    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run\n    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run\n    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run\n    There are 3 unexpected tests being run in sage/doctest/parsing.py\n    There are 1 unexpected tests being run in sage/doctest/reporting.py\n    There are 9 tests in sage/graphs/graph_plot.py that are not being run\n    There are 3 tests in sage/rings/invariant_theory.py that are not being run\nGot:\n    There are 7 tests in sage/combinat/dyck_word.py that are not being run\n    There are 4 tests in sage/combinat/finite_state_machine.py that are not being run\n    There are 6 tests in sage/combinat/interval_posets.py that are not being run\n    There are 18 tests in sage/combinat/partition.py that are not being run\n    There are 15 tests in sage/combinat/permutation.py that are not being run\n    There are 14 tests in sage/combinat/skew_partition.py that are not being run\n    There are 18 tests in sage/combinat/tableau.py that are not being run\n    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run\n    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run\n    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run\n    There are 3 unexpected tests being run in sage/doctest/parsing.py\n    There are 1 unexpected tests being run in sage/doctest/reporting.py\n    There are 9 tests in sage/graphs/graph_plot.py that are not being run\n    There are 3 tests in sage/rings/invariant_theory.py that are not being run\n    There are 10 tests in sage/symbolic/expression.pyx that are not being run\n```",
    "created_at": "2015-05-19T20:06:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146827",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:41" align="right">Comment 41</div>


```
sage -t --long --warn-long 26.6 src/sage/doctest/sources.py
**********************************************************************
File "src/sage/doctest/sources.py", line 694, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time
        path = os.path.relpath(path)
        dirs.sort(); files.sort()
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))
                FDS._test_enough_doctests(verbose=False)
Expected:
    There are 7 tests in sage/combinat/dyck_word.py that are not being run
    There are 4 tests in sage/combinat/finite_state_machine.py that are not being run
    There are 6 tests in sage/combinat/interval_posets.py that are not being run
    There are 18 tests in sage/combinat/partition.py that are not being run
    There are 15 tests in sage/combinat/permutation.py that are not being run
    There are 14 tests in sage/combinat/skew_partition.py that are not being run
    There are 18 tests in sage/combinat/tableau.py that are not being run
    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run
    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run
    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run
    There are 3 unexpected tests being run in sage/doctest/parsing.py
    There are 1 unexpected tests being run in sage/doctest/reporting.py
    There are 9 tests in sage/graphs/graph_plot.py that are not being run
    There are 3 tests in sage/rings/invariant_theory.py that are not being run
Got:
    There are 7 tests in sage/combinat/dyck_word.py that are not being run
    There are 4 tests in sage/combinat/finite_state_machine.py that are not being run
    There are 6 tests in sage/combinat/interval_posets.py that are not being run
    There are 18 tests in sage/combinat/partition.py that are not being run
    There are 15 tests in sage/combinat/permutation.py that are not being run
    There are 14 tests in sage/combinat/skew_partition.py that are not being run
    There are 18 tests in sage/combinat/tableau.py that are not being run
    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run
    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run
    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run
    There are 3 unexpected tests being run in sage/doctest/parsing.py
    There are 1 unexpected tests being run in sage/doctest/reporting.py
    There are 9 tests in sage/graphs/graph_plot.py that are not being run
    There are 3 tests in sage/rings/invariant_theory.py that are not being run
    There are 10 tests in sage/symbolic/expression.pyx that are not being run
```



---

archive/issue_events_162113.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T20:06:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162113"
}
```



---

archive/issue_events_162114.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T20:06:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162114"
}
```



---

archive/issue_comments_146828.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nMy mistake. Sorry.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0\">cb5347e</a></td><td><code>Trac 12834: move doctests related to the deprecated subs_expr</code></td></tr></table>\n",
    "created_at": "2015-05-20T10:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146828",
    "user": "https://github.com/videlec"
}
```

<div id="comment:42" align="right">Comment 42</div>

My mistake. Sorry.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0">cb5347e</a></td><td><code>Trac 12834: move doctests related to the deprecated subs_expr</code></td></tr></table>




---

archive/issue_comments_146829.json:
```json
{
    "body": "Changed commit from **[66b961c](https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f)** to **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**",
    "created_at": "2015-05-20T10:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146829",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[66b961c](https://github.com/sagemath/sagetrac-mirror/commit/66b961cffbf0e6ba451c36a1b792219a8d63b93f)** to **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**



---

archive/issue_events_162115.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-20T10:52:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162115"
}
```



---

archive/issue_events_162116.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-20T10:52:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162116"
}
```



---

archive/issue_comments_146830.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)** to **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)**",
    "created_at": "2015-05-20T10:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146830",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/mjo/ticket/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/12834)** to **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)**



---

archive/issue_events_162117.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-20T17:32:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162117"
}
```



---

archive/issue_events_162118.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-20T17:32:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162118"
}
```



---

archive/issue_comments_146831.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nThis time all tests pass.",
    "created_at": "2015-05-20T19:05:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146831",
    "user": "https://github.com/videlec"
}
```

<div id="comment:44" align="right">Comment 44</div>

This time all tests pass.



---

archive/issue_comments_146832.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)** to **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**",
    "created_at": "2015-05-20T22:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12834#issuecomment-146832",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/12834](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/12834)** to **[cb5347e](https://github.com/sagemath/sagetrac-mirror/commit/cb5347e9980347a8ce29209e00d586e4d41007b0)**



---

archive/issue_events_162119.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-20T22:28:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162119"
}
```



---

archive/issue_events_162120.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ada387aae2f67814b8ef3dcfe6703b78a83c6765",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-05-20T22:28:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12834",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12834#event-162120"
}
```
