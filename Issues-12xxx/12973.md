# Issue 12973: Cannot copy() instances of GurobiBackend.

archive/issues_012801.json:
```json
{
    "body": "GurobiBackend does not implement copy().\n\nI've attached a patch to add this functionality.\n\nThe patch also corrects a few doctests in the same file, that have solver=\"Gurobi\" instead of solver=\"GUROBI\".\n\n(The patch was created with Sage 4.8.)\n\nAPPLY:\n* [attachment:16400.patch]\n* [attachment:trac_12973-review.patch]\n\nAssignee: jason, jkantor\n\nKeywords: Gurobi, GurobiBackend, MixedIntegerLinearProgram\n\nReviewer: Volker Braun\n\nAuthor: Emil R. Vaughan, Nathann Cohen\n\nMerged: sage-5.10.beta3\n\nDependencies: #14566\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12973\n\n",
    "closed_at": "2013-05-15T08:24:10Z",
    "created_at": "2012-05-18T15:26:03Z",
    "labels": [
        "component: linear programming",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Cannot copy() instances of GurobiBackend.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12973",
    "user": "https://trac.sagemath.org/admin/accounts/users/e.vaughan"
}
```
GurobiBackend does not implement copy().

I've attached a patch to add this functionality.

The patch also corrects a few doctests in the same file, that have solver="Gurobi" instead of solver="GUROBI".

(The patch was created with Sage 4.8.)

APPLY:
* [attachment:16400.patch]
* [attachment:trac_12973-review.patch]

Assignee: jason, jkantor

Keywords: Gurobi, GurobiBackend, MixedIntegerLinearProgram

Reviewer: Volker Braun

Author: Emil R. Vaughan, Nathann Cohen

Merged: sage-5.10.beta3

Dependencies: #14566

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12973





---

archive/issue_comments_190513.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n GurobiBackend does not implement copy().\n+\n+I've attached a patch to add this functionality.\n+\n+The patch also corrects a few doctests in the same file, that have solver=\"Gurobi\" instead of solver=\"GUROBI\".\n``````\n",
    "created_at": "2012-05-18T15:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190513",
    "user": "https://trac.sagemath.org/admin/accounts/users/e.vaughan"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 GurobiBackend does not implement copy().
+
+I've attached a patch to add this functionality.
+
+The patch also corrects a few doctests in the same file, that have solver="Gurobi" instead of solver="GUROBI".
``````




---

archive/issue_comments_190514.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n I've attached a patch to add this functionality.\n \n The patch also corrects a few doctests in the same file, that have solver=\"Gurobi\" instead of solver=\"GUROBI\".\n+\n+(The patch was created with Sage 4.8.)\n``````\n",
    "created_at": "2012-05-18T15:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190514",
    "user": "https://trac.sagemath.org/admin/accounts/users/e.vaughan"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 I've attached a patch to add this functionality.
 
 The patch also corrects a few doctests in the same file, that have solver="Gurobi" instead of solver="GUROBI".
+
+(The patch was created with Sage 4.8.)
``````




---

archive/issue_comments_190515.json:
```json
{
    "body": "Changing keywords from \"\" to \"Gurobi, GurobiBackend, MixedIntegerLinearProgram\".",
    "created_at": "2012-05-18T15:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190515",
    "user": "https://trac.sagemath.org/admin/accounts/users/e.vaughan"
}
```

Changing keywords from "" to "Gurobi, GurobiBackend, MixedIntegerLinearProgram".



---

archive/issue_comments_190516.json:
```json
{
    "body": "<a id='comment:3'></a>\nWow !! Very good patch for a first ! `:-D`\n\nWell, it did not apply cleanly on version 5.1.beta0 but that was to be expected if you worked on 4.8 Actually, the replacement from GUROBI to Gurobi has been done since, and that was the whole reason why it did not apply. I just rebased your patch on 5.1.beta0 and updated it on the trac ticket.\n\nThere is a problem though, for your patch does not *compile*. When I apply it and type \"sage -b\" I get this :\n\n```\nError compiling Cython file:\n------------------------------------------------------------\n...\n            sage: p.set_objective([2, 5])                                           # optional - Gurobi\n            sage: p.write_lp(SAGE_TMP+\"/lp_problem.lp\")                             # optional - Gurobi\n        \"\"\"\n        check(self.env, GRBwrite(self.model[0], filename))\n\n    cpdef GurobiBackend copy(self):\n         ^\n------------------------------------------------------------\n\nsage/numerical/backends/gurobi_backend.pyx:1079:10: C method 'copy' not previously declared in definition part of extension type\nError running command, failed with status 256.\nError installing modified sage library code.\n```\n\nThis is because cdef methods should be added to gurobi_backend.pxd as it is added for glpk in glpk_backend.pxd. I will post another patch to do exactly that.\n\nNathann",
    "created_at": "2012-05-19T12:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190516",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>
Wow !! Very good patch for a first ! `:-D`

Well, it did not apply cleanly on version 5.1.beta0 but that was to be expected if you worked on 4.8 Actually, the replacement from GUROBI to Gurobi has been done since, and that was the whole reason why it did not apply. I just rebased your patch on 5.1.beta0 and updated it on the trac ticket.

There is a problem though, for your patch does not *compile*. When I apply it and type "sage -b" I get this :

```
Error compiling Cython file:
------------------------------------------------------------
...
            sage: p.set_objective([2, 5])                                           # optional - Gurobi
            sage: p.write_lp(SAGE_TMP+"/lp_problem.lp")                             # optional - Gurobi
        """
        check(self.env, GRBwrite(self.model[0], filename))

    cpdef GurobiBackend copy(self):
         ^
------------------------------------------------------------

sage/numerical/backends/gurobi_backend.pyx:1079:10: C method 'copy' not previously declared in definition part of extension type
Error running command, failed with status 256.
Error installing modified sage library code.
```

This is because cdef methods should be added to gurobi_backend.pxd as it is added for glpk in glpk_backend.pxd. I will post another patch to do exactly that.

Nathann



---

archive/issue_comments_190517.json:
```json
{
    "body": "<a id='comment:4'></a>\nNice !\n\nSo I agree with your changes, but as I added something myself you also need to check that everything is fine on your side, and then we will be able to set this ticket to \"positive review\", which means that the release manager can add it to the next release of Sage!\n\nThank you for your patch !!\n\nNathann",
    "created_at": "2012-05-19T12:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190517",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Nice !

So I agree with your changes, but as I added something myself you also need to check that everything is fine on your side, and then we will be able to set this ticket to "positive review", which means that the release manager can add it to the next release of Sage!

Thank you for your patch !!

Nathann



---

archive/issue_comments_190518.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,7 @@\n The patch also corrects a few doctests in the same file, that have solver=\"Gurobi\" instead of solver=\"GUROBI\".\n \n (The patch was created with Sage 4.8.)\n+\n+APPLY:\n+* [attachment:16400.patch]\n+* [attachment:trac_12973-review.patch]\n``````\n",
    "created_at": "2012-05-19T12:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190518",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,7 @@
 The patch also corrects a few doctests in the same file, that have solver="Gurobi" instead of solver="GUROBI".
 
 (The patch was created with Sage 4.8.)
+
+APPLY:
+* [attachment:16400.patch]
+* [attachment:trac_12973-review.patch]
``````




---

archive/issue_comments_190519.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-19T12:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190519",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_190520.json:
```json
{
    "body": "Changing component from numerical to linear programming.",
    "created_at": "2012-05-19T12:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190520",
    "user": "https://github.com/nathanncohen"
}
```

Changing component from numerical to linear programming.



---

archive/issue_comments_190521.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....\n\nAlso, in my original patch, I *did* have a\n \n   `cpdef GurobiBackend copy(self)`\n\nline.... Maybe that bit of the patch didn't apply properly in 5.1?\n\nOne question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)",
    "created_at": "2012-05-19T23:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190521",
    "user": "https://trac.sagemath.org/admin/accounts/users/e.vaughan"
}
```

<a id='comment:6'></a>
Thanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....

Also, in my original patch, I *did* have a
 
   `cpdef GurobiBackend copy(self)`

line.... Maybe that bit of the patch didn't apply properly in 5.1?

One question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)



---

archive/issue_comments_190522.json:
```json
{
    "body": "<a id='comment:7'></a>\nHelloooooo !!!\n\n> Thanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....\n\n\nAhaha. That's understandable `:-D`\nSo the bug happens even when you compile from source ? Scary mac..\n\n> Also, in my original patch, I *did* have a\n>  \n>    `cpdef GurobiBackend copy(self)`\n> \n> line.... Maybe that bit of the patch didn't apply properly in 5.1?\n\n\nOOpps. Yes, probably. I looked at the list of rejected lines and saw so many GUROBI -> Gurobi, I probably missed that one.\n\n> One question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)\n\n\nOops, you are right. Actually, cpef functions are functions that can be called at either C-level or Python level. Well, it more or less changes nothing in this situation, as the code onl calls the copy method from the backends at C level. It's actually totally up to you `:-)`\n\nNathann",
    "created_at": "2012-05-20T07:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190522",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
Helloooooo !!!

> Thanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....


Ahaha. That's understandable `:-D`
So the bug happens even when you compile from source ? Scary mac..

> Also, in my original patch, I *did* have a
>  
>    `cpdef GurobiBackend copy(self)`
> 
> line.... Maybe that bit of the patch didn't apply properly in 5.1?


OOpps. Yes, probably. I looked at the list of rejected lines and saw so many GUROBI -> Gurobi, I probably missed that one.

> One question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)


Oops, you are right. Actually, cpef functions are functions that can be called at either C-level or Python level. Well, it more or less changes nothing in this situation, as the code onl calls the copy method from the backends at C level. It's actually totally up to you `:-)`

Nathann



---

archive/issue_events_035515.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-29T00:15:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12973#event-35515"
}
```



---

archive/issue_comments_190523.json:
```json
{
    "body": "<a id='comment:9'></a>\nPlease fill in your real name as Author.",
    "created_at": "2012-07-27T20:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190523",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Please fill in your real name as Author.



---

archive/issue_comments_190524.json:
```json
{
    "body": "Changing author from \"\" to \"Nathann Cohen\"",
    "created_at": "2012-12-08T10:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190524",
    "user": "https://github.com/nathanncohen"
}
```

Changing author from "" to "Nathann Cohen"



---

archive/issue_comments_190525.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2013-05-11T18:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190525",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_190526.json:
```json
{
    "body": "Changing author from \"Nathann Cohen\" to \"Emil R. Vaughan\"",
    "created_at": "2013-05-11T18:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190526",
    "user": "https://github.com/nathanncohen"
}
```

Changing author from "Nathann Cohen" to "Emil R. Vaughan"



---

archive/issue_comments_190527.json:
```json
{
    "body": "<a id='comment:12'></a>\npatchbot: \napply 16400.patch, trac_12973-review.patch",
    "created_at": "2013-05-11T18:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190527",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
patchbot: 
apply 16400.patch, trac_12973-review.patch



---

archive/issue_comments_190528.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#14566\"",
    "created_at": "2013-05-11T18:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190528",
    "user": "https://github.com/vbraun"
}
```

Changing dependencies from "" to "#14566"



---

archive/issue_comments_190529.json:
```json
{
    "body": "Attachment [16400.patch](tarball://root/attachments/some-uuid/ticket12973/16400.patch) by @nathanncohen created at 2013-05-11 23:29:48",
    "created_at": "2013-05-11T23:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190529",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [16400.patch](tarball://root/attachments/some-uuid/ticket12973/16400.patch) by @nathanncohen created at 2013-05-11 23:29:48



---

archive/issue_comments_190530.json:
```json
{
    "body": "Attachment [trac_12973-review.patch](tarball://root/attachments/some-uuid/ticket12973/trac_12973-review.patch) by @nathanncohen created at 2013-05-11 23:30:19",
    "created_at": "2013-05-11T23:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190530",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_12973-review.patch](tarball://root/attachments/some-uuid/ticket12973/trac_12973-review.patch) by @nathanncohen created at 2013-05-11 23:30:19



---

archive/issue_comments_190531.json:
```json
{
    "body": "<a id='comment:14'></a>\nRebased !\n\nNathann",
    "created_at": "2013-05-11T23:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190531",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>
Rebased !

Nathann



---

archive/issue_comments_190532.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-05-12T18:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190532",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_190533.json:
```json
{
    "body": "<a id='comment:15'></a>\nlgtm",
    "created_at": "2013-05-12T18:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190533",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
lgtm



---

archive/issue_comments_190534.json:
```json
{
    "body": "Changing reviewer from \"Nathann Cohen\" to \"Volker Braun\"",
    "created_at": "2013-05-12T18:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190534",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "Nathann Cohen" to "Volker Braun"



---

archive/issue_comments_190535.json:
```json
{
    "body": "Changing author from \"Emil R. Vaughan\" to \"Emil R. Vaughan, Nathann Cohen\"",
    "created_at": "2013-05-12T18:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190535",
    "user": "https://github.com/vbraun"
}
```

Changing author from "Emil R. Vaughan" to "Emil R. Vaughan, Nathann Cohen"



---

archive/issue_comments_190536.json:
```json
{
    "body": "<a id='comment:16'></a>\nJust learned a new acronym. Thank you very much Volker ! `:-)`\n\nNathann",
    "created_at": "2013-05-12T18:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190536",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
Just learned a new acronym. Thank you very much Volker ! `:-)`

Nathann



---

archive/issue_comments_190537.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-05-15T08:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190537",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_035516.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-15T08:24:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12973#event-35516"
}
```



---

archive/issue_comments_190538.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.10.beta3\"",
    "created_at": "2013-05-15T08:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12973#issuecomment-190538",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.10.beta3"
