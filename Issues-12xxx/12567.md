# Issue 12567: Implement p-adic n-th roots

archive/issues_012395.json:
```json
{
    "body": "We are implementing p-adic n-th roots as a p-adic Sage Days project\n\nAssignee: @roed314\n\nCC:  @roed314 @saraedum dequan serickson reinier\n\nKeywords: padics, n-th roots, sd87, padicIMA\n\nBranch/Commit: 6216be01a3885f6c10eea14afe16ebde6859683d\n\nReviewer: David Roe\n\nAuthor: Xavier Caruso\n\nDependencies: #23218, #25990\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12567\n\n",
    "closed_at": "2018-09-29T11:59:43Z",
    "created_at": "2012-02-22T23:43:10Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Implement p-adic n-th roots",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12567",
    "user": "https://trac.sagemath.org/admin/accounts/users/dequan"
}
```
We are implementing p-adic n-th roots as a p-adic Sage Days project

Assignee: @roed314

CC:  @roed314 @saraedum dequan serickson reinier

Keywords: padics, n-th roots, sd87, padicIMA

Branch/Commit: 6216be01a3885f6c10eea14afe16ebde6859683d

Reviewer: David Roe

Author: Xavier Caruso

Dependencies: #23218, #25990

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12567





---

archive/issue_events_033972.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33972"
}
```



---

archive/issue_events_033973.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33973"
}
```



---

archive/issue_events_033974.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33974"
}
```



---

archive/issue_events_033975.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33975"
}
```



---

archive/issue_events_033976.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33976"
}
```



---

archive/issue_events_033977.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33977"
}
```



---

archive/issue_events_033978.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33978"
}
```



---

archive/issue_comments_180625.json:
```json
{
    "body": "Changing keywords from \"padics, n-th roots\" to \"padics, n-th roots, sd87\".",
    "created_at": "2017-07-17T17:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180625",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "padics, n-th roots" to "padics, n-th roots, sd87".



---

archive/issue_comments_180626.json:
```json
{
    "body": "Changing keywords from \"padics, n-th roots, sd87\" to \"padics, n-th roots, sd87, padicIMA\".",
    "created_at": "2018-07-22T20:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180626",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "padics, n-th roots, sd87" to "padics, n-th roots, sd87, padicIMA".



---

archive/issue_comments_180627.json:
```json
{
    "body": "Changing branch from \"\" to \"u/caruso/padic_nthroot\"",
    "created_at": "2018-07-28T00:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180627",
    "user": "https://github.com/xcaruso"
}
```

Changing branch from "" to "u/caruso/padic_nthroot"



---

archive/issue_comments_180628.json:
```json
{
    "body": "Changing author from \"dequan, serickson, reinier\" to \"Xavier Caruso\"",
    "created_at": "2018-07-28T00:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180628",
    "user": "https://github.com/xcaruso"
}
```

Changing author from "dequan, serickson, reinier" to "Xavier Caruso"



---

archive/issue_comments_180629.json:
```json
{
    "body": "<a id='comment:8'></a>Last 10 new commits:",
    "created_at": "2018-07-28T00:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180629",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:8'></a>Last 10 new commits:



---

archive/issue_comments_180630.json:
```json
{
    "body": "Changing commit from \"\" to \"e639faebca801514e900f5e913b79003c5b02124\"",
    "created_at": "2018-07-28T00:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180630",
    "user": "https://github.com/xcaruso"
}
```

Changing commit from "" to "e639faebca801514e900f5e913b79003c5b02124"



---

archive/issue_comments_180631.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#23218\"",
    "created_at": "2018-07-28T00:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180631",
    "user": "https://github.com/xcaruso"
}
```

Changing dependencies from "" to "#23218"



---

archive/issue_comments_180632.json:
```json
{
    "body": "<a id='comment:9'></a>I just wrote a generic implementation of p-adic nth root, working over any p-adic extension (unramified, totally ramified or mixed).\n\nDoctests are coming soon...",
    "created_at": "2018-07-28T00:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180632",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:9'></a>I just wrote a generic implementation of p-adic nth root, working over any p-adic extension (unramified, totally ramified or mixed).

Doctests are coming soon...



---

archive/issue_comments_180633.json:
```json
{
    "body": "Changing commit from \"e639faebca801514e900f5e913b79003c5b02124\" to \"5a4bf734f4c6ff9481709424c29f54ed4b515b20\"",
    "created_at": "2018-07-28T00:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e639faebca801514e900f5e913b79003c5b02124" to "5a4bf734f4c6ff9481709424c29f54ed4b515b20"



---

archive/issue_comments_180634.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-28T00:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180635.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-28T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180636.json:
```json
{
    "body": "Changing commit from \"5a4bf734f4c6ff9481709424c29f54ed4b515b20\" to \"be503569b13f449375f6ab1daae94055b14e015c\"",
    "created_at": "2018-07-28T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180636",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5a4bf734f4c6ff9481709424c29f54ed4b515b20" to "be503569b13f449375f6ab1daae94055b14e015c"



---

archive/issue_comments_180637.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-28T02:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180637",
    "user": "https://github.com/xcaruso"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_180638.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-28T09:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180638",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180639.json:
```json
{
    "body": "Changing commit from \"be503569b13f449375f6ab1daae94055b14e015c\" to \"d7c39b0d16419f75a1caf3b10c337e0d6c5b3d42\"",
    "created_at": "2018-07-28T09:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "be503569b13f449375f6ab1daae94055b14e015c" to "d7c39b0d16419f75a1caf3b10c337e0d6c5b3d42"



---

archive/issue_comments_180640.json:
```json
{
    "body": "<a id='comment:14'></a>For ease of review, I attach the diff between this ticket and #23218",
    "created_at": "2018-07-30T07:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180640",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:14'></a>For ease of review, I attach the diff between this ticket and #23218



---

archive/issue_comments_180641.json:
```json
{
    "body": "Changing branch from \"u/caruso/padic_nthroot\" to \"u/roed/padic_nthroot\"",
    "created_at": "2018-07-31T19:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180641",
    "user": "https://github.com/roed314"
}
```

Changing branch from "u/caruso/padic_nthroot" to "u/roed/padic_nthroot"



---

archive/issue_comments_180642.json:
```json
{
    "body": "Changing commit from \"d7c39b0d16419f75a1caf3b10c337e0d6c5b3d42\" to \"0324b667a00a264131f512111a7dbb6837fa1c98\"",
    "created_at": "2018-07-31T19:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180642",
    "user": "https://github.com/roed314"
}
```

Changing commit from "d7c39b0d16419f75a1caf3b10c337e0d6c5b3d42" to "0324b667a00a264131f512111a7dbb6837fa1c98"



---

archive/issue_comments_180643.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-31T19:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180643",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_180644.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2018-07-31T19:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180644",
    "user": "https://github.com/roed314"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_180645.json:
```json
{
    "body": "<a id='comment:16'></a>I made some minor changes and tests still pass.  Positive review!\n\n---\nNew commits:",
    "created_at": "2018-07-31T19:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180645",
    "user": "https://github.com/roed314"
}
```

<a id='comment:16'></a>I made some minor changes and tests still pass.  Positive review!

---
New commits:



---

archive/issue_comments_180646.json:
```json
{
    "body": "Changing branch from \"u/roed/padic_nthroot\" to \"u/caruso/padic_nthroot\"",
    "created_at": "2018-07-31T23:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180646",
    "user": "https://github.com/xcaruso"
}
```

Changing branch from "u/roed/padic_nthroot" to "u/caruso/padic_nthroot"



---

archive/issue_comments_180647.json:
```json
{
    "body": "<a id='comment:18'></a>Perfect!\nI've just changed a bit the doctests you added in order to have a test for the case where `p-1` divides `e` (for which the algorithm I've implemented has an extra step).",
    "created_at": "2018-07-31T23:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180647",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:18'></a>Perfect!
I've just changed a bit the doctests you added in order to have a test for the case where `p-1` divides `e` (for which the algorithm I've implemented has an extra step).



---

archive/issue_comments_180648.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2018-07-31T23:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_180649.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2018-07-31T23:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_180650.json:
```json
{
    "body": "Changing commit from \"0324b667a00a264131f512111a7dbb6837fa1c98\" to \"1bf897fc0c685be9f415f3b5608352b1a067e11e\"",
    "created_at": "2018-07-31T23:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0324b667a00a264131f512111a7dbb6837fa1c98" to "1bf897fc0c685be9f415f3b5608352b1a067e11e"



---

archive/issue_comments_180651.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-31T23:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180651",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_180652.json:
```json
{
    "body": "<a id='comment:21'></a>Great!  I'll run the tests again.",
    "created_at": "2018-07-31T23:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180652",
    "user": "https://github.com/roed314"
}
```

<a id='comment:21'></a>Great!  I'll run the tests again.



---

archive/issue_comments_180653.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-08-01T01:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180653",
    "user": "https://github.com/xcaruso"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_180654.json:
```json
{
    "body": "<a id='comment:22'></a>Oops... there's a bug:\n\n```\nsage: K.<a> = Qq(2^3)\nsage: S.<x> = K[]\nsage: L.<pi> = K.extension(x^2 + 2*x + 2)\nsage: elt = L.random_element()^8\nsage: elt.nth_root(8)   # sometimes fails\nTraceback (most recent call last):\n...\nValueError: This element is not a nth power\n```",
    "created_at": "2018-08-01T01:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180654",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:22'></a>Oops... there's a bug:

```
sage: K.<a> = Qq(2^3)
sage: S.<x> = K[]
sage: L.<pi> = K.extension(x^2 + 2*x + 2)
sage: elt = L.random_element()^8
sage: elt.nth_root(8)   # sometimes fails
Traceback (most recent call last):
...
ValueError: This element is not a nth power
```



---

archive/issue_comments_180655.json:
```json
{
    "body": "<a id='comment:23'></a>Here's some more info.  It looks like some chains of repeated square roots work while others fail.\n\n```\nsage: K.<a> = Qq(2^3)\nsage: S.<x> = K[]\nsage: L.<pi> = K.extension(x^2 + 2*x + 2)\nsage: ran = L.random_element(); elt = ran^8; r = elt.nth_root(8)\nValueError: This element is not a nth power\nsage: ran\na*pi^-2 + a*pi^-1 + a + a^2*pi^5 + a^2*pi^6 + (a^2 + 1)*pi^7 + (a^2 + 1)*pi^8 + a^2*pi^9 + a^2*pi^10 + (a + 1)*pi^11 + (a^2 + a + 1)*pi^12 + pi^13 + (a^2 + a)*pi^14 + (a^2 + a + 1)*pi^15 + (a^2 + 1)*pi^16 + a^2*pi^17 + (a^2 + 1)*pi^20 + (a + 1)*pi^21 + (a + 1)*pi^22 + (a^2 + a + 1)*pi^23 + (a^2 + a + 1)*pi^24 + (a^2 + a + 1)*pi^25 + pi^26 + (a + 1)*pi^27 + (a^2 + a)*pi^28 + pi^30 + (a^2 + 1)*pi^31 + a*pi^32 + a^2*pi^33 + pi^34 + a^2*pi^35 + O(pi^36)\nsage: r1 = elt.square_root()\nsage: r2 = r1.square_root()\nsage: r3 = r2.square_root()\nNotImplementedError: extending using the sqrt function not yet implemented\nsage: r1^2==elt\nTrue\nsage: r2^2==r1\nTrue\nsage: s1 = L(-1).square_root()\nsage: ran^2 == s1*r2\nTrue\nsage: r1=-r1\nsage: r2 = -r1.square_root()\nsage: r3 = r2.square_root()\nsage: ran == -r3\nTrue\n```",
    "created_at": "2018-08-02T16:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180655",
    "user": "https://github.com/roed314"
}
```

<a id='comment:23'></a>Here's some more info.  It looks like some chains of repeated square roots work while others fail.

```
sage: K.<a> = Qq(2^3)
sage: S.<x> = K[]
sage: L.<pi> = K.extension(x^2 + 2*x + 2)
sage: ran = L.random_element(); elt = ran^8; r = elt.nth_root(8)
ValueError: This element is not a nth power
sage: ran
a*pi^-2 + a*pi^-1 + a + a^2*pi^5 + a^2*pi^6 + (a^2 + 1)*pi^7 + (a^2 + 1)*pi^8 + a^2*pi^9 + a^2*pi^10 + (a + 1)*pi^11 + (a^2 + a + 1)*pi^12 + pi^13 + (a^2 + a)*pi^14 + (a^2 + a + 1)*pi^15 + (a^2 + 1)*pi^16 + a^2*pi^17 + (a^2 + 1)*pi^20 + (a + 1)*pi^21 + (a + 1)*pi^22 + (a^2 + a + 1)*pi^23 + (a^2 + a + 1)*pi^24 + (a^2 + a + 1)*pi^25 + pi^26 + (a + 1)*pi^27 + (a^2 + a)*pi^28 + pi^30 + (a^2 + 1)*pi^31 + a*pi^32 + a^2*pi^33 + pi^34 + a^2*pi^35 + O(pi^36)
sage: r1 = elt.square_root()
sage: r2 = r1.square_root()
sage: r3 = r2.square_root()
NotImplementedError: extending using the sqrt function not yet implemented
sage: r1^2==elt
True
sage: r2^2==r1
True
sage: s1 = L(-1).square_root()
sage: ran^2 == s1*r2
True
sage: r1=-r1
sage: r2 = -r1.square_root()
sage: r3 = r2.square_root()
sage: ran == -r3
True
```



---

archive/issue_comments_180656.json:
```json
{
    "body": "<a id='comment:24'></a>This makes sense actually, since this field has no 8th root of unity.",
    "created_at": "2018-08-02T16:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180656",
    "user": "https://github.com/roed314"
}
```

<a id='comment:24'></a>This makes sense actually, since this field has no 8th root of unity.



---

archive/issue_comments_180657.json:
```json
{
    "body": "<a id='comment:25'></a>Yes, that's it.\nWe need to check all (or at least more) branches. I'm working on this now and will submit a revised version soon.",
    "created_at": "2018-08-02T17:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180657",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:25'></a>Yes, that's it.
We need to check all (or at least more) branches. I'm working on this now and will submit a revised version soon.



---

archive/issue_comments_180658.json:
```json
{
    "body": "Changing commit from \"1bf897fc0c685be9f415f3b5608352b1a067e11e\" to \"2cef5e09732e863322ae457e06d96c0a614b3a3a\"",
    "created_at": "2018-08-03T00:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180658",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1bf897fc0c685be9f415f3b5608352b1a067e11e" to "2cef5e09732e863322ae457e06d96c0a614b3a3a"



---

archive/issue_comments_180659.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-03T00:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180659",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180660.json:
```json
{
    "body": "<a id='comment:27'></a>OK. The bug should be fixed now.\n\nI'm not completely happy with the algorithm I've implemented since its complexity is possibly linear in p (i.e. exponential in log(p)). Something better should be feasible but I'll do it in another ticket (except if someone else does it now).\n\nI attach a new diff with #23218",
    "created_at": "2018-08-03T00:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180660",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:27'></a>OK. The bug should be fixed now.

I'm not completely happy with the algorithm I've implemented since its complexity is possibly linear in p (i.e. exponential in log(p)). Something better should be feasible but I'll do it in another ticket (except if someone else does it now).

I attach a new diff with #23218



---

archive/issue_comments_180661.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-03T00:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180662.json:
```json
{
    "body": "Changing commit from \"2cef5e09732e863322ae457e06d96c0a614b3a3a\" to \"c76a0a0e98e973fe0aac237132155bba1a4f0c7d\"",
    "created_at": "2018-08-03T00:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2cef5e09732e863322ae457e06d96c0a614b3a3a" to "c76a0a0e98e973fe0aac237132155bba1a4f0c7d"



---

archive/issue_comments_180663.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-03T00:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180663",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_180664.json:
```json
{
    "body": "Changing commit from \"c76a0a0e98e973fe0aac237132155bba1a4f0c7d\" to \"dbd6aada155e7a3fb122d2a3284ce17d354935af\"",
    "created_at": "2018-08-04T23:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c76a0a0e98e973fe0aac237132155bba1a4f0c7d" to "dbd6aada155e7a3fb122d2a3284ce17d354935af"



---

archive/issue_comments_180665.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-04T23:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180665",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180666.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-06T09:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180666",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_180667.json:
```json
{
    "body": "<a id='comment:31'></a>I found other bugs. I'm still working on this ticket...",
    "created_at": "2018-08-06T09:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180667",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:31'></a>I found other bugs. I'm still working on this ticket...



---

archive/issue_comments_180668.json:
```json
{
    "body": "Changing commit from \"dbd6aada155e7a3fb122d2a3284ce17d354935af\" to \"fd786ba03c9cdd8dded7652867e6d2763169d0ba\"",
    "created_at": "2018-08-06T22:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180668",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dbd6aada155e7a3fb122d2a3284ce17d354935af" to "fd786ba03c9cdd8dded7652867e6d2763169d0ba"



---

archive/issue_comments_180669.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-06T22:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180669",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180670.json:
```json
{
    "body": "Attachment [12567-vs-23218.diff](tarball://root/attachments/some-uuid/ticket12567/12567-vs-23218.diff) by @xcaruso created at 2018-08-06 22:07:51",
    "created_at": "2018-08-06T22:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180670",
    "user": "https://github.com/xcaruso"
}
```

Attachment [12567-vs-23218.diff](tarball://root/attachments/some-uuid/ticket12567/12567-vs-23218.diff) by @xcaruso created at 2018-08-06 22:07:51



---

archive/issue_comments_180671.json:
```json
{
    "body": "<a id='comment:33'></a>Finally, I've implemented a faster algorithm with better complexity with respect to `p`.\n\nI've also added doctests demonstrating that the computation of the `n`th root works over various fields (including those having, or having almost, `p`th or `p^2`th roots of unity).\n\nThere are still failing doctests but they are due to the bug reported in #25990.",
    "created_at": "2018-08-06T22:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180671",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:33'></a>Finally, I've implemented a faster algorithm with better complexity with respect to `p`.

I've also added doctests demonstrating that the computation of the `n`th root works over various fields (including those having, or having almost, `p`th or `p^2`th roots of unity).

There are still failing doctests but they are due to the bug reported in #25990.



---

archive/issue_comments_180672.json:
```json
{
    "body": "Changing dependencies from \"#23218\" to \"#23218, #25990\"",
    "created_at": "2018-08-06T22:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180672",
    "user": "https://github.com/xcaruso"
}
```

Changing dependencies from "#23218" to "#23218, #25990"



---

archive/issue_comments_180673.json:
```json
{
    "body": "Changing commit from \"fd786ba03c9cdd8dded7652867e6d2763169d0ba\" to \"49d5c3e9758ca161a278da0818748fab5b8d3578\"",
    "created_at": "2018-08-17T22:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fd786ba03c9cdd8dded7652867e6d2763169d0ba" to "49d5c3e9758ca161a278da0818748fab5b8d3578"



---

archive/issue_comments_180674.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-17T22:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180675.json:
```json
{
    "body": "<a id='comment:35'></a>Now, all tests pass: the ticket is ready for review.",
    "created_at": "2018-08-17T22:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180675",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:35'></a>Now, all tests pass: the ticket is ready for review.



---

archive/issue_comments_180676.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-17T22:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180676",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_180677.json:
```json
{
    "body": "Changing commit from \"49d5c3e9758ca161a278da0818748fab5b8d3578\" to \"265720df550bab2910432bacbe9811e3078e123d\"",
    "created_at": "2018-08-18T06:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "49d5c3e9758ca161a278da0818748fab5b8d3578" to "265720df550bab2910432bacbe9811e3078e123d"



---

archive/issue_comments_180678.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-18T06:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180678",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180679.json:
```json
{
    "body": "<a id='comment:37'></a>Doc doesn't build (see patchbot).\n\nAdditionally EXAMPLES blocks in doc should end in ::  not : I believe if the first thing after is code, (see primitive_root_of_unity and elsewhere).",
    "created_at": "2018-08-21T01:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180679",
    "user": "https://github.com/alexjbest"
}
```

<a id='comment:37'></a>Doc doesn't build (see patchbot).

Additionally EXAMPLES blocks in doc should end in ::  not : I believe if the first thing after is code, (see primitive_root_of_unity and elsewhere).



---

archive/issue_comments_180680.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-21T05:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180681.json:
```json
{
    "body": "Changing commit from \"265720df550bab2910432bacbe9811e3078e123d\" to \"e1cfa9daf47153f2322808e195bede6f42814fb7\"",
    "created_at": "2018-08-21T05:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180681",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "265720df550bab2910432bacbe9811e3078e123d" to "e1cfa9daf47153f2322808e195bede6f42814fb7"



---

archive/issue_comments_180682.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-22T22:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180683.json:
```json
{
    "body": "Changing commit from \"e1cfa9daf47153f2322808e195bede6f42814fb7\" to \"5790a670cc5d6814cab9d2a141b943323161a5bb\"",
    "created_at": "2018-09-22T22:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e1cfa9daf47153f2322808e195bede6f42814fb7" to "5790a670cc5d6814cab9d2a141b943323161a5bb"



---

archive/issue_comments_180684.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-22T22:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180685.json:
```json
{
    "body": "Changing commit from \"5790a670cc5d6814cab9d2a141b943323161a5bb\" to \"a53bf90d0ad12281a089deb7d669a8b9374fc970\"",
    "created_at": "2018-09-22T22:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5790a670cc5d6814cab9d2a141b943323161a5bb" to "a53bf90d0ad12281a089deb7d669a8b9374fc970"



---

archive/issue_comments_180686.json:
```json
{
    "body": "Changing branch from \"u/caruso/padic_nthroot\" to \"u/roed/padic_nthroot\"",
    "created_at": "2018-09-27T20:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180686",
    "user": "https://github.com/roed314"
}
```

Changing branch from "u/caruso/padic_nthroot" to "u/roed/padic_nthroot"



---

archive/issue_comments_180687.json:
```json
{
    "body": "<a id='comment:42'></a>Looks good; just ran `make ptestlong`.\n\n---\nNew commits:",
    "created_at": "2018-09-27T21:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180687",
    "user": "https://github.com/roed314"
}
```

<a id='comment:42'></a>Looks good; just ran `make ptestlong`.

---
New commits:



---

archive/issue_comments_180688.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-27T21:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180688",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_180689.json:
```json
{
    "body": "Changing commit from \"a53bf90d0ad12281a089deb7d669a8b9374fc970\" to \"6216be01a3885f6c10eea14afe16ebde6859683d\"",
    "created_at": "2018-09-27T21:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180689",
    "user": "https://github.com/roed314"
}
```

Changing commit from "a53bf90d0ad12281a089deb7d669a8b9374fc970" to "6216be01a3885f6c10eea14afe16ebde6859683d"



---

archive/issue_comments_180690.json:
```json
{
    "body": "Changing branch from \"u/roed/padic_nthroot\" to \"6216be01a3885f6c10eea14afe16ebde6859683d\"",
    "created_at": "2018-09-29T11:59:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180690",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/roed/padic_nthroot" to "6216be01a3885f6c10eea14afe16ebde6859683d"



---

archive/issue_events_033979.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-29T11:59:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12567#event-33979"
}
```



---

archive/issue_comments_180691.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-29T11:59:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12567#issuecomment-180691",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
