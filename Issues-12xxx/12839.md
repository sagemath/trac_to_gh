# Issue 12839: reduced Groebner basis not unique

archive/issues_012667.json:
```json
{
    "body": "Using sage-4.8\n\n```\nsage: R.<x,y> = PolynomialRing(ZZ)\nsage: I = R*[x^2-y, 2*y]\nsage: J = R*[x^2+y, 2*y]\n```\n\n`I` and `J` are visibly the same ideal, but Sage finds different reduced Groebner bases:\n\n```\nsage: I.groebner_basis()\n[x^2 - y, 2*y]\nsage: J.groebner_basis()\n[x^2 + y, 2*y]\nsage: I == J   // should say True\nFalse\n```\n\n**Assignee:** @malb\n\n**Keywords:** sd40.5, groebner bases, ideals\n\n**Reviewer:** John Perry\n\n**Dependencies:** #12802\n\nIssue created by migration from https://trac.sagemath.org/ticket/12839\n\n",
    "closed_at": "2012-06-19T13:27:57Z",
    "created_at": "2012-04-13T18:51:28Z",
    "labels": [
        "component: commutative algebra",
        "bug",
        "duplicate"
    ],
    "title": "reduced Groebner basis not unique",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12839",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```
Using sage-4.8

```
sage: R.<x,y> = PolynomialRing(ZZ)
sage: I = R*[x^2-y, 2*y]
sage: J = R*[x^2+y, 2*y]
```

`I` and `J` are visibly the same ideal, but Sage finds different reduced Groebner bases:

```
sage: I.groebner_basis()
[x^2 - y, 2*y]
sage: J.groebner_basis()
[x^2 + y, 2*y]
sage: I == J   // should say True
False
```

**Assignee:** @malb

**Keywords:** sd40.5, groebner bases, ideals

**Reviewer:** John Perry

**Dependencies:** #12802

Issue created by migration from https://trac.sagemath.org/ticket/12839





---

archive/issue_comments_146860.json:
```json
{
    "body": "<a id='comment:1'></a>\nCorrect me if I am wrong, but you cannot have a reduced Groebner basis over a ring that is not a field. Besides, the ideals are *not* the same, even if their varieties are.\n\nSingular seems to feel this way:\n\n* Singular is computing the basis.\n* According to Remark 1.6.14 in *A **Singular** Introduction to Commutative Algebra*, if you want to compute a *standard basis over a ring* which is merely Noetherian (not necessarily a field, as in Definition 1.6.1), you need to have agreement of leading *terms* (which includes coefficients), not leading *monomials*.\n* See this answer in [the Singular forums](http://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=1750&p=2349&hilit=std+integer#p2349).\n\nMacaulay also feels this way:\n\n* I installed Macaulay2, computed groebner bases for both I and J, and got the same thing singular computes.\n* Macaulay2's [webpage](http://www.math.uiuc.edu/Macaulay2/doc/Macaulay2-1.4/share/doc/Macaulay2/Macaulay2Doc/html/_simple_sp__Groebner_spbasis_spcomputations_spover_spvarious_springs.html) implies the same.\n\nUnless I'm wrong, this is not a bug.\n\n*Edit:* I had ring and field switched in the first sentence.",
    "created_at": "2012-05-25T19:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146860",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:1'></a>
Correct me if I am wrong, but you cannot have a reduced Groebner basis over a ring that is not a field. Besides, the ideals are *not* the same, even if their varieties are.

Singular seems to feel this way:

* Singular is computing the basis.
* According to Remark 1.6.14 in *A **Singular** Introduction to Commutative Algebra*, if you want to compute a *standard basis over a ring* which is merely Noetherian (not necessarily a field, as in Definition 1.6.1), you need to have agreement of leading *terms* (which includes coefficients), not leading *monomials*.
* See this answer in [the Singular forums](http://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=1750&p=2349&hilit=std+integer#p2349).

Macaulay also feels this way:

* I installed Macaulay2, computed groebner bases for both I and J, and got the same thing singular computes.
* Macaulay2's [webpage](http://www.math.uiuc.edu/Macaulay2/doc/Macaulay2-1.4/share/doc/Macaulay2/Macaulay2Doc/html/_simple_sp__Groebner_spbasis_spcomputations_spover_spvarious_springs.html) implies the same.

Unless I'm wrong, this is not a bug.

*Edit:* I had ring and field switched in the first sentence.



---

archive/issue_comments_146861.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [john_perry](#comment%3A1):\n> Besides, the ideals are *not* the same, even if their varieties are.\n\n\nThis was a dumb thing to say, & I had doubts almost immediately after hitting the Submit button. In fact, Macaulay2 recognizes I==J, even though it computes different gb's. Singular does not recognize this.",
    "created_at": "2012-05-25T19:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146861",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:2'></a>
Replying to [john_perry](#comment%3A1):
> Besides, the ideals are *not* the same, even if their varieties are.


This was a dumb thing to say, & I had doubts almost immediately after hitting the Submit button. In fact, Macaulay2 recognizes I==J, even though it computes different gb's. Singular does not recognize this.



---

archive/issue_comments_146862.json:
```json
{
    "body": "<a id='comment:3'></a>\nI think I see a way to get this to work.\n\nThe first thing that can be tried is whether the groebner bases are equal, which is what we are doing now. If that succeeds, then great.\n\nOtherwise, we can compare by reducing the elements of one groebner basis over the other's groebner basis. If all reductions give us 0, then we return true. Otherwise, we return false.\n\nI think this is related to #12802, and this trick should fix both of them: `__lt__` can test if the first is contained in the second, `__gt__` can check if the second is contained in the first, and `__eq__` checks if both are satisfied.\n\nThis would be easy to implement, but is the algorithm I'm outlining correct?",
    "created_at": "2012-05-25T19:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146862",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:3'></a>
I think I see a way to get this to work.

The first thing that can be tried is whether the groebner bases are equal, which is what we are doing now. If that succeeds, then great.

Otherwise, we can compare by reducing the elements of one groebner basis over the other's groebner basis. If all reductions give us 0, then we return true. Otherwise, we return false.

I think this is related to #12802, and this trick should fix both of them: `__lt__` can test if the first is contained in the second, `__gt__` can check if the second is contained in the first, and `__eq__` checks if both are satisfied.

This would be easy to implement, but is the algorithm I'm outlining correct?



---

archive/issue_events_107091.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-25T23:25:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107091"
}
```



---

archive/issue_comments_146863.json:
```json
{
    "body": "<a id='comment:4'></a>\nHello\n\nI'm still of the opinion that what I wrote about reduced Groebner bases in integer rings is correct, given the behavior of Singular and Macaulay2.\n\nThat said, the incorrect conclusion that `I != J` is easily fixed, using the algorithm I outlined. I have uploaded a patch to #12802 that does precisely this.\n\nAssuming that what I've done there is correct, is there a way to mark this patch as a duplicate, or something similar?",
    "created_at": "2012-05-25T23:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146863",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:4'></a>
Hello

I'm still of the opinion that what I wrote about reduced Groebner bases in integer rings is correct, given the behavior of Singular and Macaulay2.

That said, the incorrect conclusion that `I != J` is easily fixed, using the algorithm I outlined. I have uploaded a patch to #12802 that does precisely this.

Assuming that what I've done there is correct, is there a way to mark this patch as a duplicate, or something similar?



---

archive/issue_comments_146864.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd40.5, groebner bases, ideals\".",
    "created_at": "2012-05-25T23:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146864",
    "user": "https://github.com/johnperry-math"
}
```

**Changing keywords** from "" to "sd40.5, groebner bases, ideals".



---

archive/issue_comments_146865.json:
```json
{
    "body": "<a id='comment:6'></a>\njohn_perry: to mark this as a dup:\n\n1. Set yourself to reviewer\n2. give it positive review\n3. change the milestone to sage-duplicate\n\nWilliam",
    "created_at": "2012-05-26T02:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146865",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:6'></a>
john_perry: to mark this as a dup:

1. Set yourself to reviewer
2. give it positive review
3. change the milestone to sage-duplicate

William



---

archive/issue_events_107092.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-26T05:39:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107092"
}
```



---

archive/issue_comments_146866.json:
```json
{
    "body": "**Reviewer:** john_perry",
    "created_at": "2012-05-26T05:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146866",
    "user": "https://github.com/johnperry-math"
}
```

**Reviewer:** john_perry



---

archive/issue_comments_146867.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [was](#comment%3A6):\n> john_perry: to mark this as a dup:\n\n\nThx. Since testing equality of ideals is equivalent to testing containment both ways, that's what I'll do.",
    "created_at": "2012-05-26T05:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146867",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:7'></a>
Replying to [was](#comment%3A6):
> john_perry: to mark this as a dup:


Thx. Since testing equality of ideals is equivalent to testing containment both ways, that's what I'll do.



---

archive/issue_events_107093.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-26T05:39:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107093"
}
```



---

archive/issue_events_107094.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-26T05:39:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107094"
}
```



---

archive/issue_events_107095.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-26T05:39:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107095"
}
```



---

archive/issue_events_107096.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-05-26T05:39:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107096"
}
```



---

archive/issue_comments_146868.json:
```json
{
    "body": "**Dependencies:** #12802",
    "created_at": "2012-06-19T13:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146868",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #12802



---

archive/issue_events_107097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T13:27:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107097"
}
```



---

archive/issue_events_107098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T13:27:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107098"
}
```



---

archive/issue_events_107099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T13:28:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "label": "duplicate",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12839#event-107099"
}
```



---

archive/issue_comments_146869.json:
```json
{
    "body": "**Changing reviewer** from \"john_perry\" to \"John Perry\".",
    "created_at": "2012-06-20T13:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12839#issuecomment-146869",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "john_perry" to "John Perry".
