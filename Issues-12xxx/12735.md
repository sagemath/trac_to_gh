# Issue 12735: doctest framework bug that was somehow observed via -- "optional magma doctest fails on sage-5.0.beta9"

archive/issues_012563.json:
```json
{
    "body": "The following optional magma doctest fails on sage-5.0.bata9 using\nmagma-2.18-4.\n\n```\neno% ./sage -t -only-optional=magma \"devel/sage/sage/symbolic/integration/integral.py\"\nsage -t -only-optional=magma \"devel/sage/sage/symbolic/integration/integral.py\"\nTraceback (most recent call last):\n  File \"/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest\", line 924, in <module>\n    test_file(argv[1], library_code = library_code)\n  File \"/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest\", line 721, in test_file\n    s = extract_doc(file, library_code=library_code)\n  File \"/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest\", line 551, in extract_doc\n    doc = doc_preparse(F[i:j+3])\n  File \"/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest\", line 370, in doc_preparse\n    v = [i for i in range(len(t)) if only_optional_include(comment_modifiers[i])]\nIndexError: list index out of range\n         [0.2 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -only-optional=magma \"devel/sage/sage/symbolic/integration/integral.py\" # File not found\n```\n\nFixed by #12493.\n\nAssignee: mvngu\n\nCC:  @robertwb @mwhansen @williamstein\n\nKeywords: sd40.5\n\nReviewer: William Stein, Mike Hansen\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/12735\n\n",
    "closed_at": "2012-06-02T13:23:42Z",
    "created_at": "2012-03-23T13:21:40Z",
    "labels": [
        "component: doctest coverage",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "doctest framework bug that was somehow observed via -- \"optional magma doctest fails on sage-5.0.beta9\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12735",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```
The following optional magma doctest fails on sage-5.0.bata9 using
magma-2.18-4.

```
eno% ./sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py"
sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py"
Traceback (most recent call last):
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 924, in <module>
    test_file(argv[1], library_code = library_code)
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 721, in test_file
    s = extract_doc(file, library_code=library_code)
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 551, in extract_doc
    doc = doc_preparse(F[i:j+3])
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 370, in doc_preparse
    v = [i for i in range(len(t)) if only_optional_include(comment_modifiers[i])]
IndexError: list index out of range
         [0.2 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py" # File not found
```

Fixed by #12493.

Assignee: mvngu

CC:  @robertwb @mwhansen @williamstein

Keywords: sd40.5

Reviewer: William Stein, Mike Hansen

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/12735





---

archive/issue_comments_149089.json:
```json
{
    "body": "<a id='comment:1'></a>Is this reproducible?  It seems like more of a problem with `sage-doctest` than anything specific to Magma.",
    "created_at": "2012-05-25T06:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149089",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:1'></a>Is this reproducible?  It seems like more of a problem with `sage-doctest` than anything specific to Magma.



---

archive/issue_comments_149090.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd40.5\".",
    "created_at": "2012-05-25T06:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149090",
    "user": "https://github.com/mwhansen"
}
```

Changing keywords from "" to "sd40.5".



---

archive/issue_comments_149091.json:
```json
{
    "body": "Changing assignee from @williamstein to mvngu.",
    "created_at": "2012-05-25T17:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149091",
    "user": "https://github.com/williamstein"
}
```

Changing assignee from @williamstein to mvngu.



---

archive/issue_comments_149092.json:
```json
{
    "body": "Changing component from interfaces to doctest.",
    "created_at": "2012-05-25T17:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149092",
    "user": "https://github.com/williamstein"
}
```

Changing component from interfaces to doctest.



---

archive/issue_comments_149093.json:
```json
{
    "body": "<a id='comment:3'></a>mhansen -- you are right -- this has nothing to do with Magma, a priori.   I'll change the title of the ticket.    It's a bug in the doctest framework, but I don't yet know how to trigger it.  I just looked through the relevant code in sage-doctest, and it's a mix of code I wrote and then later Robert Bradshaw extended with a \"tolerance\" ability.  My code assumes that the lists t and comment_modifiers have the same length, but I think Robert's doesn't and in some cases adds things to t but not comment_modifiers.",
    "created_at": "2012-05-25T17:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149093",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'></a>mhansen -- you are right -- this has nothing to do with Magma, a priori.   I'll change the title of the ticket.    It's a bug in the doctest framework, but I don't yet know how to trigger it.  I just looked through the relevant code in sage-doctest, and it's a mix of code I wrote and then later Robert Bradshaw extended with a "tolerance" ability.  My code assumes that the lists t and comment_modifiers have the same length, but I think Robert's doesn't and in some cases adds things to t but not comment_modifiers.



---

archive/issue_comments_149094.json:
```json
{
    "body": "<a id='comment:5'></a>This has been fixed in sage-5.0 already as #12493.   I'm closing this as a dup.",
    "created_at": "2012-05-25T18:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149094",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:5'></a>This has been fixed in sage-5.0 already as #12493.   I'm closing this as a dup.



---

archive/issue_events_034613.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-25T18:32:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12735#event-34613"
}
```



---

archive/issue_comments_149095.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2012-05-25T18:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149095",
    "user": "https://github.com/williamstein"
}
```

Resolution: duplicate



---

archive/issue_comments_149096.json:
```json
{
    "body": "Resolution changed from duplicate to ",
    "created_at": "2012-05-26T02:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149096",
    "user": "https://github.com/williamstein"
}
```

Resolution changed from duplicate to 



---

archive/issue_comments_149097.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2012-05-26T02:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149097",
    "user": "https://github.com/williamstein"
}
```

Changing status from closed to new.



---

archive/issue_events_034614.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-26T02:23:01Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12735#event-34614"
}
```



---

archive/issue_comments_149098.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-26T02:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149098",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_149099.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-26T02:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149099",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149100.json:
```json
{
    "body": "<a id='comment:9'></a>This should be closed as a dup.",
    "created_at": "2012-05-26T02:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149100",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:9'></a>This should be closed as a dup.



---

archive/issue_events_034615.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-26T02:24:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12735#event-34615"
}
```



---

archive/issue_comments_149101.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2012-06-02T13:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12735#issuecomment-149101",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_events_034616.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T13:23:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12735#event-34616"
}
```
