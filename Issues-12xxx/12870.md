# Issue 12870: update optional package openssl to version 1.0.1a

archive/issues_012698.json:
```json
{
    "body": "Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.\n\nVersion with tarball removed:\n\n**spkg**: [http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg](http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg)\n\n\n\n\n**Reviewer:** William Stein\n\n**Author:** Mariah Lenox\n\nIssue created by migration from https://trac.sagemath.org/ticket/12870\n\n",
    "closed_at": "2012-05-26T16:29:36Z",
    "created_at": "2012-04-23T20:26:52Z",
    "labels": [
        "component: packages: optional",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "update optional package openssl to version 1.0.1a",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12870",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```
Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.

Version with tarball removed:

**spkg**: [http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg](http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg)




**Reviewer:** William Stein

**Author:** Mariah Lenox

Issue created by migration from https://trac.sagemath.org/ticket/12870





---

archive/issue_events_109890.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mariah",
    "created_at": "2012-04-26T18:35:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109890"
}
```



---

archive/issue_comments_149074.json:
```json
{
    "body": "**Author:** Mariah Lenox",
    "created_at": "2012-04-26T18:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149074",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

**Author:** Mariah Lenox



---

archive/issue_comments_149075.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)\n``````\n",
    "created_at": "2012-04-26T18:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149075",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.
+
+**spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)
``````




---

archive/issue_comments_149076.json:
```json
{
    "body": "<a id='comment:2'></a>\nCan you change the permissions:\n\n```\nwstein@sage:/scratch/wstein/ref/sage-5.0.beta15-boxen-x86_64-Linux$ wget  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n--13:51:00--  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n           => `openssl-1.0.1a.spkg'\nResolving boxen.math.washington.edu... 128.208.160.197\nConnecting to boxen.math.washington.edu|128.208.160.197|:80... connected.\nHTTP request sent, awaiting response... 403 Forbidden\n13:51:00 ERROR 403: Forbidden.\n```",
    "created_at": "2012-04-30T20:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149076",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>
Can you change the permissions:

```
wstein@sage:/scratch/wstein/ref/sage-5.0.beta15-boxen-x86_64-Linux$ wget  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
--13:51:00--  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
           => `openssl-1.0.1a.spkg'
Resolving boxen.math.washington.edu... 128.208.160.197
Connecting to boxen.math.washington.edu|128.208.160.197|:80... connected.
HTTP request sent, awaiting response... 403 Forbidden
13:51:00 ERROR 403: Forbidden.
```



---

archive/issue_comments_149077.json:
```json
{
    "body": "<a id='comment:3'></a>\nDone. Apologies.",
    "created_at": "2012-05-01T14:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149077",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

<a id='comment:3'></a>
Done. Apologies.



---

archive/issue_comments_149078.json:
```json
{
    "body": "<a id='comment:4'></a>\nREPORT:\n\n(this is long, but there is really only one trivial change I want made.)\n\n1. Delete this file -- why is it there?\n\n```\n-rw-r-----  1 wstein wstein  21M 2012-04-19 05:20 openssl-1.0.1a.tar\n```\n\n2. It builds fine on sage.math (64-bit ubuntu).\n\n3. It fails to build on OS X 10.7.3 after building sage-5.0.pre15 out of the box:\n\n```\ngcc -I. -I.. -I../include  -fPIC -fno-common -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -fomit-frame-pointer -DL_ENDIAN -DOPENSSL_BN_ASM_PART_WORDS -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DRMD160_ASM -DAE\nS_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM   -c -o mem_dbg.o mem_dbg.c\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\nmake[1]: *** [cryptlib.o] Error 1\nmake[1]: *** Waiting for unfinished jobs....\nmake[1]: *** [mem.o] Error 1\ngcc: error: i386: No such file or directory\ngcc: error: unrecognized option \u2018-arch\u2019\nmake[1]: *** [mem_dbg.o] Error 1\nmake: *** [build_crypto] Error 1\nError building openssl.\n\nreal\t0m3.738s\nuser\t0m2.527s\nsys\t0m0.910s\n************************************************************************\nError installing package openssl-1.0.1a\n```\n\nThis looks like some OS version detection code is wrong? Note `gcc: error: unrecognized option \u2018-arch\u2019`.  Exactly the same problem happens with the openssl-1.0.0.p0 that we currently have in the optional package repo.\n\n\n4. On Ubuntu 64-bit (sage.math), I tried rebuilding Python after building the new openssl, and that worked fine and did include openssl support. \n\n5. I ran all doctests on ubuntu 64-bit and that worked fine.  This isn't surprising, since I think no doctests use openssl. \n\n6. On OS X 10.6, I tried this:\n\n```\nbsd:sage-5.0.beta8 wstein$ ./sage -i  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg\n```\nand it worked fine. \n\n7. It would be nice if there was an \".hgignore\" file since\n\n```\n$ hg status\n? openssl-1.0.1a.spkg\n? openssl-1.0.1a/SPKG.txt\n? openssl-1.0.1a/openssl-1.0.1a.tar\n? openssl-1.0.1a/src/ACKNOWLEDGMENTS\n? openssl-1.0.1a/src/CHANGES\n? openssl-1.0.1a/src/CHANGES.SSLeay\n? openssl-1.0.1a/src/Configure\n...\n```\n\nSUMMARY: The OS X 10.7.3 issue looks serious, but should not hold this back, because it is already in the current openssl optional package; it should be considered a new bug on a separate ticket.   Otherwise, we just need to delete the upstream tarball which is there for no reason.  Since this is an optional spkg, and we still don't officially support OS X 10.7.3, I don't consider this a total blocker for a positive review. \n\nTHUS: Positive review contingent on deleting that one tar file.",
    "created_at": "2012-05-01T17:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149078",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:4'></a>
REPORT:

(this is long, but there is really only one trivial change I want made.)

1. Delete this file -- why is it there?

```
-rw-r-----  1 wstein wstein  21M 2012-04-19 05:20 openssl-1.0.1a.tar
```

2. It builds fine on sage.math (64-bit ubuntu).

3. It fails to build on OS X 10.7.3 after building sage-5.0.pre15 out of the box:

```
gcc -I. -I.. -I../include  -fPIC -fno-common -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -arch i386 -O3 -fomit-frame-pointer -DL_ENDIAN -DOPENSSL_BN_ASM_PART_WORDS -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DRMD160_ASM -DAE
S_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM   -c -o mem_dbg.o mem_dbg.c
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [cryptlib.o] Error 1
make[1]: *** Waiting for unfinished jobs....
make[1]: *** [mem.o] Error 1
gcc: error: i386: No such file or directory
gcc: error: unrecognized option ‘-arch’
make[1]: *** [mem_dbg.o] Error 1
make: *** [build_crypto] Error 1
Error building openssl.

real	0m3.738s
user	0m2.527s
sys	0m0.910s
************************************************************************
Error installing package openssl-1.0.1a
```

This looks like some OS version detection code is wrong? Note `gcc: error: unrecognized option ‘-arch’`.  Exactly the same problem happens with the openssl-1.0.0.p0 that we currently have in the optional package repo.


4. On Ubuntu 64-bit (sage.math), I tried rebuilding Python after building the new openssl, and that worked fine and did include openssl support. 

5. I ran all doctests on ubuntu 64-bit and that worked fine.  This isn't surprising, since I think no doctests use openssl. 

6. On OS X 10.6, I tried this:

```
bsd:sage-5.0.beta8 wstein$ ./sage -i  http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg
```
and it worked fine. 

7. It would be nice if there was an ".hgignore" file since

```
$ hg status
? openssl-1.0.1a.spkg
? openssl-1.0.1a/SPKG.txt
? openssl-1.0.1a/openssl-1.0.1a.tar
? openssl-1.0.1a/src/ACKNOWLEDGMENTS
? openssl-1.0.1a/src/CHANGES
? openssl-1.0.1a/src/CHANGES.SSLeay
? openssl-1.0.1a/src/Configure
...
```

SUMMARY: The OS X 10.7.3 issue looks serious, but should not hold this back, because it is already in the current openssl optional package; it should be considered a new bug on a separate ticket.   Otherwise, we just need to delete the upstream tarball which is there for no reason.  Since this is an optional spkg, and we still don't officially support OS X 10.7.3, I don't consider this a total blocker for a positive review. 

THUS: Positive review contingent on deleting that one tar file.



---

archive/issue_comments_149079.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.\n \n **spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)\n+\n+Version with tarball removed:\n+\n+**spkg**: [http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg](http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg)\n+\n+\n+\n``````\n",
    "created_at": "2012-05-02T17:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149079",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
 Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.
 
 **spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)
+
+Version with tarball removed:
+
+**spkg**: [http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg](http://wstein.org/home/wstein/patches/openssl-1.0.1a.spkg)
+
+
+
``````




---

archive/issue_events_109891.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-02T17:07:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109891"
}
```



---

archive/issue_events_109892.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-02T17:07:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109892"
}
```



---

archive/issue_events_109893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-06T12:24:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109893"
}
```



---

archive/issue_events_109894.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-06T12:24:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109894"
}
```



---

archive/issue_comments_149080.json:
```json
{
    "body": "**Reviewer:** William Stein",
    "created_at": "2012-05-06T12:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149080",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** William Stein



---

archive/issue_comments_149081.json:
```json
{
    "body": "<a id='comment:6'></a>\nWhich is the correct spkg?",
    "created_at": "2012-05-06T12:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149081",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Which is the correct spkg?



---

archive/issue_comments_149082.json:
```json
{
    "body": "<a id='comment:7'></a>\n***ping***\n\nplease clarify: why are there two spkg's listed?",
    "created_at": "2012-05-09T08:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149082",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
***ping***

please clarify: why are there two spkg's listed?



---

archive/issue_comments_149083.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.\n-\n-**spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)\n \n Version with tarball removed:\n \n``````\n",
    "created_at": "2012-05-23T19:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149083",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
 Upgrade the optional package openssl to version 1.0.1a which was released on 19 April 2012.
-
-**spkg**: [http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg](http://boxen.math.washington.edu/home/mariah/spkg/openssl-1.0.1a.spkg)
 
 Version with tarball removed:
 
``````




---

archive/issue_events_109895.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mariah",
    "created_at": "2012-05-23T19:15:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109895"
}
```



---

archive/issue_events_109896.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mariah",
    "created_at": "2012-05-23T19:15:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109896"
}
```



---

archive/issue_events_109897.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mariah",
    "created_at": "2012-05-23T19:20:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109897"
}
```



---

archive/issue_events_109898.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mariah",
    "created_at": "2012-05-23T19:20:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109898"
}
```



---

archive/issue_comments_149084.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe spkg posted by William supercedes my spkg.  (William's spkg\nremoves a tar file that I mistakenly left in the spkg.)\n\nI have removed my spkg from the Description.\n\nI am setting this back to positive review because William gave it\na positive review.",
    "created_at": "2012-05-23T19:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149084",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

<a id='comment:9'></a>
The spkg posted by William supercedes my spkg.  (William's spkg
removes a tar file that I mistakenly left in the spkg.)

I have removed my spkg from the Description.

I am setting this back to positive review because William gave it
a positive review.



---

archive/issue_comments_149085.json:
```json
{
    "body": "<a id='comment:10'></a>\nspkg is on the webserver+mirros now.",
    "created_at": "2012-05-26T09:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149085",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:10'></a>
spkg is on the webserver+mirros now.



---

archive/issue_events_109899.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-26T16:29:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109899"
}
```



---

archive/issue_events_109900.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-26T16:29:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12870#event-109900"
}
```



---

archive/issue_comments_149086.json:
```json
{
    "body": "<a id='comment:12'></a>\nSee #13126 for a follow-up.",
    "created_at": "2012-06-17T17:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12870",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12870#issuecomment-149086",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
See #13126 for a follow-up.
