# Issue 12821: testcc.sh: allow $CC to contain multiple words

archive/issues_012649.json:
```json
{
    "body": "If CC=\"gcc -m32\" (for example), then the following will fail:\n\n```\n$ testcc.sh $CC\nUsage: spkg/bin/testcc.sh name_or_path_to_the_C_compiler\n[...]\n```\n\nWe should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): \n\n**Apply** [attachment:12821_testcc.patch] to the SAGE_ROOT repository.\n\nWe also need to fix libm4rie, which does `testcc.sh \"$CC\"`: \n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])\n\nAssignee: @jdemeyer\n\nKeywords: sd40.5\n\nReviewer: Leif Leonhardy, R. Andrew Ohana\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.1.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12821\n\n",
    "closed_at": "2012-06-02T12:14:44Z",
    "created_at": "2012-04-09T18:38:48Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "testcc.sh: allow $CC to contain multiple words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12821",
    "user": "https://github.com/jdemeyer"
}
```
If CC="gcc -m32" (for example), then the following will fail:

```
$ testcc.sh $CC
Usage: spkg/bin/testcc.sh name_or_path_to_the_C_compiler
[...]
```

We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): 

**Apply** [attachment:12821_testcc.patch] to the SAGE_ROOT repository.

We also need to fix libm4rie, which does `testcc.sh "$CC"`: 

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])

Assignee: @jdemeyer

Keywords: sd40.5

Reviewer: Leif Leonhardy, R. Andrew Ohana

Author: Jeroen Demeyer

Merged: sage-5.1.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12821





---

archive/issue_comments_191919.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,5 @@\n ```\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n+\n+We also need to fix libm4rie, which does \"`testcc.sh \"$CC\"`.\n``````\n",
    "created_at": "2012-04-09T18:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191919",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,5 @@
 ```
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
+
+We also need to fix libm4rie, which does "`testcc.sh "$CC"`.
``````




---

archive/issue_comments_191920.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n \n-We also need to fix libm4rie, which does \"`testcc.sh \"$CC\"`.\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`.\n``````\n",
    "created_at": "2012-04-09T18:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191920",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
 
-We also need to fix libm4rie, which does "`testcc.sh "$CC"`.
+We also need to fix libm4rie, which does `testcc.sh "$CC"`.
``````




---

archive/issue_comments_191921.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,6 @@\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n \n-We also need to fix libm4rie, which does `testcc.sh \"$CC\"`.\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`:\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])\n``````\n",
    "created_at": "2012-04-09T18:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191921",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,6 @@
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
 
-We also need to fix libm4rie, which does `testcc.sh "$CC"`.
+We also need to fix libm4rie, which does `testcc.sh "$CC"`:
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])
``````




---

archive/issue_comments_191922.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-04-09T18:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191922",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_191923.json:
```json
{
    "body": "Author: Jeroen Demeyer",
    "created_at": "2012-04-09T18:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191923",
    "user": "https://github.com/jdemeyer"
}
```

Author: Jeroen Demeyer



---

archive/issue_comments_191924.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,8 +6,10 @@\n [...]\n ```\n \n-We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n+We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): \n \n-We also need to fix libm4rie, which does `testcc.sh \"$CC\"`:\n+**Apply** [attachment:12821_testcc.patch] to the SAGE_ROOT repository.\n+\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`: \n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])\n``````\n",
    "created_at": "2012-04-09T19:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191924",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,8 +6,10 @@
 [...]
 ```
 
-We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
+We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): 
 
-We also need to fix libm4rie, which does `testcc.sh "$CC"`:
+**Apply** [attachment:12821_testcc.patch] to the SAGE_ROOT repository.
+
+We also need to fix libm4rie, which does `testcc.sh "$CC"`: 
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment:libm4rie-20111004.p3.diff])
``````




---

archive/issue_comments_191925.json:
```json
{
    "body": "<a id='comment:5'></a>\nStylewise, I'd use `[ $# -lt  1 ]`.\n\nThe usage should say \"`$0 name_or_path_to_the_C_compiler [optional arguments]`\".\n\nI'd also use `$`@`` instead of `\"$`@`\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n\nIt's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.  (At least he didn't use `... | cat | ...` ;-) )",
    "created_at": "2012-04-09T21:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191925",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
Stylewise, I'd use `[ $# -lt  1 ]`.

The usage should say "`$0 name_or_path_to_the_C_compiler [optional arguments]`".

I'd also use `$`@`` instead of `"$`@`"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.

It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.  (At least he didn't use `... | cat | ...` ;-) )



---

archive/issue_comments_191926.json:
```json
{
    "body": "Reviewer: Leif Leonhardy",
    "created_at": "2012-04-09T21:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191926",
    "user": "https://github.com/nexttime"
}
```

Reviewer: Leif Leonhardy



---

archive/issue_comments_191927.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [leif](#comment%3A5):\n> Stylewise, I'd use `[ $# -lt  1 ]`.\n\nIn case the user supplies -2 arguments :-)",
    "created_at": "2012-04-09T21:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191927",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Replying to [leif](#comment%3A5):
> Stylewise, I'd use `[ $# -lt  1 ]`.

In case the user supplies -2 arguments :-)



---

archive/issue_comments_191928.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [leif](#comment%3A5):\n> I'd also use `$`@`` instead of `\"$`@`\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n\nI think quoting `$CC` should hurt because it's wrong.\n\nOne must not run\n\n```\n\"$CC\" foo.c -o foo\n```\nso I think one should also not run\n\n```\ntestcc.sh \"$CC\"\n```",
    "created_at": "2012-04-09T22:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191928",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [leif](#comment%3A5):
> I'd also use `$`@`` instead of `"$`@`"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.

I think quoting `$CC` should hurt because it's wrong.

One must not run

```
"$CC" foo.c -o foo
```
so I think one should also not run

```
testcc.sh "$CC"
```



---

archive/issue_comments_191929.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [leif](#comment%3A5):\n> I'd also use `$`@`` instead of `\"$`@`\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n> \n> It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.\n\n\nI.e.,\n\n```sh\n$@ -E $TESTFILE | sed -n '/^[A-Z]/s/ //gp'\n```",
    "created_at": "2012-04-09T22:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191929",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
Replying to [leif](#comment%3A5):
> I'd also use `$`@`` instead of `"$`@`"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.
> 
> It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.


I.e.,

```sh
$@ -E $TESTFILE | sed -n '/^[A-Z]/s/ //gp'
```



---

archive/issue_comments_191930.json:
```json
{
    "body": "Changing assignee from GeorgSWeber to @jdemeyer.",
    "created_at": "2012-04-09T22:04:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191930",
    "user": "https://github.com/jdemeyer"
}
```

Changing assignee from GeorgSWeber to @jdemeyer.



---

archive/issue_comments_191931.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew version, needs review.",
    "created_at": "2012-04-09T22:04:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191931",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
New version, needs review.



---

archive/issue_comments_191932.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jdemeyer](#comment%3A7):\n> Replying to [leif](#comment%3A5):\n> > I'd also use `$`@`` instead of `\"$`@`\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n\n> I think quoting `$CC` should hurt because it's wrong.\n\nYou can't say it's wrong.  But using `\"$`@`\"` would only make sense if one e.g. did\n\n```sh\ntestcc.sh \"$CC\" \"some argument with spaces\" otherargument\n# (if $CC is actually a single pathname with spaces in it)\n\n# or, likewise\ntestcc.sh $CC \"some argument with spaces\" otherargument\n```\nwhich I think nobody will do.",
    "created_at": "2012-04-09T22:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191932",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
Replying to [jdemeyer](#comment%3A7):
> Replying to [leif](#comment%3A5):
> > I'd also use `$`@`` instead of `"$`@`"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.

> I think quoting `$CC` should hurt because it's wrong.

You can't say it's wrong.  But using `"$`@`"` would only make sense if one e.g. did

```sh
testcc.sh "$CC" "some argument with spaces" otherargument
# (if $CC is actually a single pathname with spaces in it)

# or, likewise
testcc.sh $CC "some argument with spaces" otherargument
```
which I think nobody will do.



---

archive/issue_comments_191933.json:
```json
{
    "body": "<a id='comment:11'></a>\nPositive review for the patch to `testcc.sh` **if you remove the extra `grep`**... ;-)\n\n\n\n\nThe (patch to the) M4RIE spkg needs work anyway:\n\n```sh\nif [ \"$COMPILER\"  = \"GNU\" ] ; then \n    ...\n```\n\n(`testcc.sh` never returns `GNU`, at most `GCC`.)",
    "created_at": "2012-04-09T22:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191933",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Positive review for the patch to `testcc.sh` **if you remove the extra `grep`**... ;-)




The (patch to the) M4RIE spkg needs work anyway:

```sh
if [ "$COMPILER"  = "GNU" ] ; then 
    ...
```

(`testcc.sh` never returns `GNU`, at most `GCC`.)



---

archive/issue_comments_191934.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [leif](#comment%3A11):\n> The (patch to the) M4RIE spkg needs work anyway:\n> \n> ```\n> #!sh\n> if [ \"$COMPILER\"  = \"GNU\" ] ; then \n>     ...\n> ```\n> \n> (`testcc.sh` never returns `GNU`, at most `GCC`.)\n\n\nAnd wouldn't using `testcflags.sh -fPIC -Wall -pedantic` there be more appropriate anyway?",
    "created_at": "2012-04-09T22:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191934",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>
Replying to [leif](#comment%3A11):
> The (patch to the) M4RIE spkg needs work anyway:
> 
> ```
> #!sh
> if [ "$COMPILER"  = "GNU" ] ; then 
>     ...
> ```
> 
> (`testcc.sh` never returns `GNU`, at most `GCC`.)


And wouldn't using `testcflags.sh -fPIC -Wall -pedantic` there be more appropriate anyway?



---

archive/issue_comments_191935.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-10T02:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191935",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_191936.json:
```json
{
    "body": "Work_Issues: Fix comparison to `GNU` in the M4RIE spkg.",
    "created_at": "2012-04-10T02:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191936",
    "user": "https://github.com/nexttime"
}
```

Work_Issues: Fix comparison to `GNU` in the M4RIE spkg.



---

archive/issue_comments_191937.json:
```json
{
    "body": "<a id='comment:13'></a>\n... if you change the spkg *here*.\n\n(And the changelog entry should say *\"... **when calling** `testcc.sh`.\"*, provided you don't change `spkg-install` to use `testcflags.sh` of course, the latter being much better.)",
    "created_at": "2012-04-10T02:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191937",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
... if you change the spkg *here*.

(And the changelog entry should say *"... **when calling** `testcc.sh`."*, provided you don't change `spkg-install` to use `testcflags.sh` of course, the latter being much better.)



---

archive/issue_comments_191938.json:
```json
{
    "body": "<a id='comment:14'></a>\nBtw., `testcflags.sh` also needs work, as I already reported on sage-devel a while ago:\n\n```sh\n...\noutfile=testcflags-$$\ncfile=$outfile.c\n...\nrm -f $TESTFILE $OUTFILE\n...\n```\n\n(And there are a few other issues with it.  Wonder who reviewed such, as the temporary files will **always** remain, while completely unrelated files might get deleted(!).)",
    "created_at": "2012-04-10T03:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191938",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Btw., `testcflags.sh` also needs work, as I already reported on sage-devel a while ago:

```sh
...
outfile=testcflags-$$
cfile=$outfile.c
...
rm -f $TESTFILE $OUTFILE
...
```

(And there are a few other issues with it.  Wonder who reviewed such, as the temporary files will **always** remain, while completely unrelated files might get deleted(!).)



---

archive/issue_comments_191939.json:
```json
{
    "body": "<a id='comment:15'></a>\nAdded a fix also for testcflags.sh.",
    "created_at": "2012-04-10T08:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191939",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Added a fix also for testcflags.sh.



---

archive/issue_comments_191940.json:
```json
{
    "body": "Changing work_issues from \"Fix comparison to `GNU` in the M4RIE spkg.\" to \"\"",
    "created_at": "2012-04-10T08:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191940",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "Fix comparison to `GNU` in the M4RIE spkg." to ""



---

archive/issue_comments_191941.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-10T08:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191941",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_191942.json:
```json
{
    "body": "<a id='comment:16'></a>\nAttachment [libm4rie-20111004.p3.diff](tarball://root/attachments/some-uuid/ticket12821/libm4rie-20111004.p3.diff) by @jdemeyer created at 2012-04-10 08:48:51",
    "created_at": "2012-04-10T08:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191942",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
Attachment [libm4rie-20111004.p3.diff](tarball://root/attachments/some-uuid/ticket12821/libm4rie-20111004.p3.diff) by @jdemeyer created at 2012-04-10 08:48:51



---

archive/issue_comments_191943.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe test for the compiler used in M4RIE's `spkg-install` to add specific flags is still a bit weird; you could just use `testcflags.sh` for all of this, although `+ z` is currently a bit problematic (in case the space is really required), because `testcflags.sh` tests the flags one by one, and passing `\"+ z\"` as a single parameter to it might not work either, since the compiler most probably doesn't expect it to be passed as a single argument.\n\nBut the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.\n\n\n\n\n\n\nIf `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.",
    "created_at": "2012-04-11T13:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191943",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>
The test for the compiler used in M4RIE's `spkg-install` to add specific flags is still a bit weird; you could just use `testcflags.sh` for all of this, although `+ z` is currently a bit problematic (in case the space is really required), because `testcflags.sh` tests the flags one by one, and passing `"+ z"` as a single parameter to it might not work either, since the compiler most probably doesn't expect it to be passed as a single argument.

But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.






If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.



---

archive/issue_comments_191944.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [leif](#comment%3A17):\n> But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.\n\n\nOh I see, you've meanwhile fixed that, such that we could now use (e.g.) `testcflags.sh -fPIC -Kpic \"+ z\"`.",
    "created_at": "2012-04-11T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191944",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>
Replying to [leif](#comment%3A17):
> But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.


Oh I see, you've meanwhile fixed that, such that we could now use (e.g.) `testcflags.sh -fPIC -Kpic "+ z"`.



---

archive/issue_comments_191945.json:
```json
{
    "body": "<a id='comment:19'></a>\nW.r.t. `testcflags.sh`:\n\nI'd move the usage instructions from the comment into the error message given if `CC` isn't set, and add `$# -eq 0` (or `$# -lt 1`) to the test, such that calling `testcflags.sh` without arguments outputs its usage.",
    "created_at": "2012-04-11T13:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191945",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>
W.r.t. `testcflags.sh`:

I'd move the usage instructions from the comment into the error message given if `CC` isn't set, and add `$# -eq 0` (or `$# -lt 1`) to the test, such that calling `testcflags.sh` without arguments outputs its usage.



---

archive/issue_comments_191946.json:
```json
{
    "body": "<a id='comment:20'></a>\nA few more comments:\n\n* The scripts could respect `TMP` and `TMPDIR` if set.\n\n* On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.\n\n* Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.\n\n* In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?",
    "created_at": "2012-04-11T13:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191946",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>
A few more comments:

* The scripts could respect `TMP` and `TMPDIR` if set.

* On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.

* Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.

* In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?



---

archive/issue_comments_191947.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [leif](#comment%3A20):\n>  * In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?\n\n\nDoesn't look like.  (Although one can set `SAGE_INSTALL_GCC=no`.)\n\nQuite unrelated, but from `spkg/install` (i.e., while we're at it):\n\n```sh\nif [ -z \"$SAGE_FORTRAN\" ]; then\n    if command -v gfortran >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=gfortran\n    elif command -v g95 >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=g95\n    elif command -v g77 >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=g77\n    fi\nfi\n```\nignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.\n\nThe created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).\n\nDon't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.",
    "created_at": "2012-04-11T14:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191947",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Replying to [leif](#comment%3A20):
>  * In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?


Doesn't look like.  (Although one can set `SAGE_INSTALL_GCC=no`.)

Quite unrelated, but from `spkg/install` (i.e., while we're at it):

```sh
if [ -z "$SAGE_FORTRAN" ]; then
    if command -v gfortran >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=gfortran
    elif command -v g95 >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=g95
    elif command -v g77 >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=g77
    fi
fi
```
ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.

The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).

Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.



---

archive/issue_comments_191948.json:
```json
{
    "body": "<a id='comment:22'></a>\nMore on `spkg/install`: :-)\n\n```sh\ngrep '^\\($\\|[0-3]\\.\\|4\\.[0-3]\\|4\\.6\\.[01]$\\)'\n```\nis GNUism and non-portable; either use\n\n```sh\negrep '^($|[0-3]\\.|4\\.[0-3]|4\\.6\\.[01]$)'\n```\nor, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.",
    "created_at": "2012-04-11T14:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191948",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>
More on `spkg/install`: :-)

```sh
grep '^\($\|[0-3]\.\|4\.[0-3]\|4\.6\.[01]$\)'
```
is GNUism and non-portable; either use

```sh
egrep '^($|[0-3]\.|4\.[0-3]|4\.6\.[01]$)'
```
or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.



---

archive/issue_comments_191949.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [leif](#comment%3A22):\n> More on `spkg/install`: :-)\n> \n> ```\n> #!sh\n> grep '^\\($\\|[0-3]\\.\\|4\\.[0-3]\\|4\\.6\\.[01]$\\)'\n> ```\n> is GNUism and non-portable; either use\n> \n> ```\n> #!sh\n> egrep '^($|[0-3]\\.|4\\.[0-3]|4\\.6\\.[01]$)'\n> ```\n> or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.\n\nSee #12825.",
    "created_at": "2012-04-11T16:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191949",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Replying to [leif](#comment%3A22):
> More on `spkg/install`: :-)
> 
> ```
> #!sh
> grep '^\($\|[0-3]\.\|4\.[0-3]\|4\.6\.[01]$\)'
> ```
> is GNUism and non-portable; either use
> 
> ```
> #!sh
> egrep '^($|[0-3]\.|4\.[0-3]|4\.6\.[01]$)'
> ```
> or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.

See #12825.



---

archive/issue_comments_191950.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [leif](#comment%3A21):\n> Quite unrelated, but from `spkg/install` (i.e., while we're at it):\n> \n> ```\n> #!sh\n> if [ -z \"$SAGE_FORTRAN\" ]; then\n>     if command -v gfortran >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=gfortran\n>     elif command -v g95 >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=g95\n>     elif command -v g77 >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=g77\n>     fi\n> fi\n> ```\n> ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.\n> \n> The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).\n> \n> Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.\n\nYou're certainly right that there are some issues here, but that's totally outside of the scope of this ticket.",
    "created_at": "2012-04-11T16:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191950",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [leif](#comment%3A21):
> Quite unrelated, but from `spkg/install` (i.e., while we're at it):
> 
> ```
> #!sh
> if [ -z "$SAGE_FORTRAN" ]; then
>     if command -v gfortran >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=gfortran
>     elif command -v g95 >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=g95
>     elif command -v g77 >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=g77
>     fi
> fi
> ```
> ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.
> 
> The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).
> 
> Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.

You're certainly right that there are some issues here, but that's totally outside of the scope of this ticket.



---

archive/issue_comments_191951.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [leif](#comment%3A20):\n> The scripts could respect `TMP` and `TMPDIR` if set.\n\nWhat's `TMP`?  I agree on `TMPDIR`, which is the standard way of specifying a temporary directory.\n\n> On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.\n\nFair enough.\n\n>  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.\n\nThose two commands aren't equivalent.\n\n> In `spkg/install`, there should be a way to bypass the installation of GCC.\n\nYou can set `SAGE_INSTALL_GCC=no`.",
    "created_at": "2012-04-11T16:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191951",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
Replying to [leif](#comment%3A20):
> The scripts could respect `TMP` and `TMPDIR` if set.

What's `TMP`?  I agree on `TMPDIR`, which is the standard way of specifying a temporary directory.

> On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.

Fair enough.

>  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.

Those two commands aren't equivalent.

> In `spkg/install`, there should be a way to bypass the installation of GCC.

You can set `SAGE_INSTALL_GCC=no`.



---

archive/issue_comments_191952.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [jdemeyer](#comment%3A25):\n> Replying to [leif](#comment%3A20):\n> >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.\n\n> Thoase two commands aren't equivalent.\n\nThey of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.",
    "created_at": "2012-04-11T18:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191952",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:26'></a>
Replying to [jdemeyer](#comment%3A25):
> Replying to [leif](#comment%3A20):
> >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.

> Thoase two commands aren't equivalent.

They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.



---

archive/issue_comments_191953.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [leif](#comment%3A26):\n> Replying to [jdemeyer](#comment%3A25):\n> > Replying to [leif](#comment%3A20):\n> > >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.\n\n> > Thoase two commands aren't equivalent.\n> \n> They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.\n\nDid you even **try** those commands before saying such non-sense?",
    "created_at": "2012-04-13T09:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191953",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Replying to [leif](#comment%3A26):
> Replying to [jdemeyer](#comment%3A25):
> > Replying to [leif](#comment%3A20):
> > >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.

> > Thoase two commands aren't equivalent.
> 
> They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.

Did you even **try** those commands before saying such non-sense?



---

archive/issue_comments_191954.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [jdemeyer](#comment%3A27):\n> Replying to [leif](#comment%3A26):\n> > Replying to [jdemeyer](#comment%3A25):\n> > > Replying to [leif](#comment%3A20):\n> > > >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.\n\n> > > Those two commands aren't equivalent.\n> > \n> > They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.\n\n> Did you even **try** those commands before saying such non-sense?\n\nI apparently had trailing spaces on the lines with compiler names...\n\n```sh\nsed -n '/^[A-Z]/s/[ ]*//gp'\n```\ndoes it, although we shouldn't have spaces on these lines anyway (in which case the substitution of course would be superfluous).",
    "created_at": "2012-04-13T13:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191954",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:28'></a>
Replying to [jdemeyer](#comment%3A27):
> Replying to [leif](#comment%3A26):
> > Replying to [jdemeyer](#comment%3A25):
> > > Replying to [leif](#comment%3A20):
> > > >  Using `sed -n '/^[A-Z]/s/ //gp'` is much faster than `sed -n 's/ //g;/^[A-Z]/p'`.

> > > Those two commands aren't equivalent.
> > 
> > They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.

> Did you even **try** those commands before saying such non-sense?

I apparently had trailing spaces on the lines with compiler names...

```sh
sed -n '/^[A-Z]/s/[ ]*//gp'
```
does it, although we shouldn't have spaces on these lines anyway (in which case the substitution of course would be superfluous).



---

archive/issue_comments_191955.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [leif](#comment%3A17):\n> If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.\n\n\nThis is still in the diff; haven't downloaded the new spkg (yet).",
    "created_at": "2012-04-13T14:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191955",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:29'></a>
Replying to [leif](#comment%3A17):
> If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.


This is still in the diff; haven't downloaded the new spkg (yet).



---

archive/issue_comments_191956.json:
```json
{
    "body": "<a id='comment:30'></a>\nI have based the new SPKG at\u00a0#12841\u00a0on\u00a0http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg. Additionally, I changed spkg-install to append not prepend -O0.",
    "created_at": "2012-04-13T20:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191956",
    "user": "https://github.com/malb"
}
```

<a id='comment:30'></a>
I have based the new SPKG at #12841 on http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg. Additionally, I changed spkg-install to append not prepend -O0.



---

archive/issue_comments_191957.json:
```json
{
    "body": "<a id='comment:31'></a>\nNew version of [attachment:12821_testcc.patch] needs review.\n\nI disagree about appending `-O0`.  I think the user's `CFLAGS` should always override the SPKG's `CFLAGS` without exceptions.  What if the user for some reason wants `--enable-debug` but still `-O2`?\n\nIn any case, the following would be very inconsistent:\n\n```sh\nif [ \"x$SAGE_DEBUG\" = \"xyes\" ]; then\n   CFLAGS=\"$CFLAGS -O0\"\n   ENABLE_DEBUG=\"--enable-debug\"\nelse\n   CFLAGS=\"-O2 $CFLAGS\"\n   ENABLE_DEBUG=\"\"\nfi\n```",
    "created_at": "2012-04-14T11:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191957",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>
New version of [attachment:12821_testcc.patch] needs review.

I disagree about appending `-O0`.  I think the user's `CFLAGS` should always override the SPKG's `CFLAGS` without exceptions.  What if the user for some reason wants `--enable-debug` but still `-O2`?

In any case, the following would be very inconsistent:

```sh
if [ "x$SAGE_DEBUG" = "xyes" ]; then
   CFLAGS="$CFLAGS -O0"
   ENABLE_DEBUG="--enable-debug"
else
   CFLAGS="-O2 $CFLAGS"
   ENABLE_DEBUG=""
fi
```



---

archive/issue_comments_191958.json:
```json
{
    "body": "<a id='comment:32'></a>\nStill needs review...",
    "created_at": "2012-05-02T18:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191958",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
Still needs review...



---

archive/issue_events_040791.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-02T18:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12821#event-40791"
}
```



---

archive/issue_comments_191959.json:
```json
{
    "body": "<a id='comment:33'></a>\nThe patched version of `testcflags.sh` always produces an empty list of cflags for me. My guess is that it is due to `d` being undefined in the following block of code:\n\n```C\nunsigned long double_to_ulong() \n{ \n    return (unsigned long)d; \n}\n```",
    "created_at": "2012-05-25T00:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191959",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:33'></a>
The patched version of `testcflags.sh` always produces an empty list of cflags for me. My guess is that it is due to `d` being undefined in the following block of code:

```C
unsigned long double_to_ulong() 
{ 
    return (unsigned long)d; 
}
```



---

archive/issue_comments_191960.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-05-25T00:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191960",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_191961.json:
```json
{
    "body": "Attachment [12821_testcc.patch](tarball://root/attachments/some-uuid/ticket12821/12821_testcc.patch) by @jdemeyer created at 2012-05-25 05:04:41",
    "created_at": "2012-05-25T05:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191961",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [12821_testcc.patch](tarball://root/attachments/some-uuid/ticket12821/12821_testcc.patch) by @jdemeyer created at 2012-05-25 05:04:41



---

archive/issue_comments_191962.json:
```json
{
    "body": "<a id='comment:34'></a>\nOf course, I don't know how I missed that...\n\nFixed.",
    "created_at": "2012-05-25T05:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191962",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
Of course, I don't know how I missed that...

Fixed.



---

archive/issue_comments_191963.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-05-25T05:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191963",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_191964.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd40.5\".",
    "created_at": "2012-05-25T05:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191964",
    "user": "https://github.com/ohanar"
}
```

Changing keywords from "" to "sd40.5".



---

archive/issue_comments_191965.json:
```json
{
    "body": "Changing reviewer from \"Leif Leonhardy\" to \"Leif Leonhardy, R. Andrew Ohana\"",
    "created_at": "2012-05-25T05:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191965",
    "user": "https://github.com/ohanar"
}
```

Changing reviewer from "Leif Leonhardy" to "Leif Leonhardy, R. Andrew Ohana"



---

archive/issue_comments_191966.json:
```json
{
    "body": "<a id='comment:35'></a>\nOk, looks good and works well.\n\nTo note, this is not a great test for cflags. For example, clang only throws warnings to bad compiler flags, it does not error.",
    "created_at": "2012-05-25T05:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191966",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:35'></a>
Ok, looks good and works well.

To note, this is not a great test for cflags. For example, clang only throws warnings to bad compiler flags, it does not error.



---

archive/issue_comments_191967.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-25T05:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191967",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_191968.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [ohanar](#comment%3A35):\n> For example, clang only throws warnings to bad compiler flags, it does not error.\n\nThat's stupid:\n\n```\nbsd:~ jdemeyer$ clang -march=foobar foo.c -c -o foo.o\n'foobar' is not a recognized processor for this target (ignoring processor)\nbsd:~ jdemeyer$ echo $?\n0\n```\n\nThis could mean that MPIR for example might produce very suboptimal code because it *thinks* that `-march=foo` is supported when it's not.",
    "created_at": "2012-05-26T05:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191968",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
Replying to [ohanar](#comment%3A35):
> For example, clang only throws warnings to bad compiler flags, it does not error.

That's stupid:

```
bsd:~ jdemeyer$ clang -march=foobar foo.c -c -o foo.o
'foobar' is not a recognized processor for this target (ignoring processor)
bsd:~ jdemeyer$ echo $?
0
```

This could mean that MPIR for example might produce very suboptimal code because it *thinks* that `-march=foo` is supported when it's not.



---

archive/issue_comments_191969.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-02T12:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191969",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_191970.json:
```json
{
    "body": "Merged: sage-5.1.beta2",
    "created_at": "2012-06-02T12:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12821#issuecomment-191970",
    "user": "https://github.com/jdemeyer"
}
```

Merged: sage-5.1.beta2



---

archive/issue_events_040792.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:14:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12821",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12821#event-40792"
}
```
