# Issue 12821: testcc.sh: allow $CC to contain multiple words

archive/issues_012649.json:
```json
{
    "assignees": [
        "https://github.com/jdemeyer"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nIf CC=\"gcc -m32\" (for example), then the following will fail:\n\n```\n$ testcc.sh $CC\nUsage: spkg/bin/testcc.sh name_or_path_to_the_C_compiler\n[...]\n```\n\nWe should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): \n\n**Apply** [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) to the SAGE_ROOT repository.\n\nWe also need to fix libm4rie, which does `testcc.sh \"$CC\"`: \n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))\n\nComponent: **build**\n\nKeywords: **sd40.5**\n\nAuthor: **Jeroen Demeyer**\n\nReviewer: **Leif Leonhardy, R. Andrew Ohana**\n\nMerged: **sage-5.1.beta2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12821_\n\n",
    "closed_at": "2012-06-02T12:14:44Z",
    "created_at": "2012-04-09T18:38:48Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "testcc.sh: allow $CC to contain multiple words",
    "type": "issue",
    "updated_at": "2012-06-02T12:14:44Z",
    "url": "https://github.com/sagemath/sage/issues/12821",
    "user": "https://github.com/jdemeyer"
}
```
<div id="comment:0"></div>

If CC="gcc -m32" (for example), then the following will fail:

```
$ testcc.sh $CC
Usage: spkg/bin/testcc.sh name_or_path_to_the_C_compiler
[...]
```

We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): 

**Apply** [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) to the SAGE_ROOT repository.

We also need to fix libm4rie, which does `testcc.sh "$CC"`: 

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))

Component: **build**

Keywords: **sd40.5**

Author: **Jeroen Demeyer**

Reviewer: **Leif Leonhardy, R. Andrew Ohana**

Merged: **sage-5.1.beta2**

_Issue created by migration from https://trac.sagemath.org/ticket/12821_





---

archive/issue_events_175050.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T18:38:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175050"
}
```



---

archive/issue_events_175051.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T18:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175051"
}
```



---

archive/issue_events_175052.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T18:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175052"
}
```



---

archive/issue_events_175053.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T18:38:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175053"
}
```



---

archive/issue_events_175054.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2012-04-09T18:38:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175054"
}
```



---

archive/issue_comments_144035.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,5 @@\n ```\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n+\n+We also need to fix libm4rie, which does \"`testcc.sh \"$CC\"`.\n``````\n",
    "created_at": "2012-04-09T18:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144035",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,5 @@
 ```
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
+
+We also need to fix libm4rie, which does "`testcc.sh "$CC"`.
``````




---

archive/issue_comments_144036.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n \n-We also need to fix libm4rie, which does \"`testcc.sh \"$CC\"`.\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`.\n``````\n",
    "created_at": "2012-04-09T18:44:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144036",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
 
-We also need to fix libm4rie, which does "`testcc.sh "$CC"`.
+We also need to fix libm4rie, which does `testcc.sh "$CC"`.
``````




---

archive/issue_comments_144037.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,6 @@\n \n We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n \n-We also need to fix libm4rie, which does `testcc.sh \"$CC\"`.\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`:\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))\n``````\n",
    "created_at": "2012-04-09T18:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144037",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,6 @@
 
 We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
 
-We also need to fix libm4rie, which does `testcc.sh "$CC"`.
+We also need to fix libm4rie, which does `testcc.sh "$CC"`:
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))
``````




---

archive/issue_events_175055.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T18:57:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175055"
}
```



---

archive/issue_comments_144038.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2012-04-09T18:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144038",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_144039.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,8 +6,10 @@\n [...]\n ```\n \n-We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.\n+We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): \n \n-We also need to fix libm4rie, which does `testcc.sh \"$CC\"`:\n+**Apply** [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) to the SAGE_ROOT repository.\n+\n+We also need to fix libm4rie, which does `testcc.sh \"$CC\"`: \n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))\n``````\n",
    "created_at": "2012-04-09T19:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144039",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,8 +6,10 @@
 [...]
 ```
 
-We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler.
+We should allow `testcc.sh` to accept multiple arguments and use all of them to run the C compiler (similarly for `testcxx.sh`): 
 
-We also need to fix libm4rie, which does `testcc.sh "$CC"`:
+**Apply** [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) to the SAGE_ROOT repository.
+
+We also need to fix libm4rie, which does `testcc.sh "$CC"`: 
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg) (diff: [attachment: libm4rie-20111004.p3.diff](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz))
``````




---

archive/issue_comments_144040.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nStylewise, I'd use `[ $# -lt  1 ]`.\n\nThe usage should say \"`$0 name_or_path_to_the_C_compiler [optional arguments]`\".\n\nI'd also use `$@` instead of `\"$@\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n\nIt's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.  (At least he didn't use `... | cat | ...` ;-) )",
    "created_at": "2012-04-09T21:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144040",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

Stylewise, I'd use `[ $# -lt  1 ]`.

The usage should say "`$0 name_or_path_to_the_C_compiler [optional arguments]`".

I'd also use `$@` instead of `"$@"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.

It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.  (At least he didn't use `... | cat | ...` ;-) )



---

archive/issue_comments_144041.json:
```json
{
    "body": "Reviewer: **Leif Leonhardy**",
    "created_at": "2012-04-09T21:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144041",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Leif Leonhardy**



---

archive/issue_comments_144042.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@nexttime](#comment%3A5):\n> Stylewise, I'd use `[ $# -lt  1 ]`.\n\nIn case the user supplies -2 arguments :-)",
    "created_at": "2012-04-09T21:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144042",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@nexttime](#comment%3A5):
> Stylewise, I'd use `[ $# -lt  1 ]`.

In case the user supplies -2 arguments :-)



---

archive/issue_comments_144043.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@nexttime](#comment%3A5):\n> I'd also use `$@` instead of `\"$@\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n\nI think quoting `$CC` should hurt because it's wrong.\n\nOne must not run\n\n```\n\"$CC\" foo.c -o foo\n```\nso I think one should also not run\n\n```\ntestcc.sh \"$CC\"\n```",
    "created_at": "2012-04-09T22:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144043",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@nexttime](#comment%3A5):
> I'd also use `$@` instead of `"$@"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.

I think quoting `$CC` should hurt because it's wrong.

One must not run

```
"$CC" foo.c -o foo
```
so I think one should also not run

```
testcc.sh "$CC"
```



---

archive/issue_comments_144044.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@nexttime](#comment%3A5):\n> I'd also use `$@` instead of `\"$@\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n> \n> It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.\n\nI.e.,\n\n```sh\n$@ -E $TESTFILE | sed -n '/^[A-Z]/s/ //gp'\n```",
    "created_at": "2012-04-09T22:03:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144044",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@nexttime](#comment%3A5):
> I'd also use `$@` instead of `"$@"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.
> 
> It's also a bit funny to use `grep ... | sed ...`; a single invocation of `sed` is sufficient.

I.e.,

```sh
$@ -E $TESTFILE | sed -n '/^[A-Z]/s/ //gp'
```



---

archive/issue_events_175056.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2012-04-09T22:04:47Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175056"
}
```



---

archive/issue_events_175057.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-09T22:04:47Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175057"
}
```



---

archive/issue_comments_144045.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nNew version, needs review.",
    "created_at": "2012-04-09T22:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144045",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

New version, needs review.



---

archive/issue_comments_144046.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment%3A7):\n> Replying to [@nexttime](#comment%3A5):\n> > I'd also use `$@` instead of `\"$@\"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.\n> \n> I think quoting `$CC` should hurt because it's wrong.\n\nYou can't say it's wrong.  But using `\"$@\"` would only make sense if one e.g. did\n\n```sh\ntestcc.sh \"$CC\" \"some argument with spaces\" otherargument\n# (if $CC is actually a single pathname with spaces in it)\n\n# or, likewise\ntestcc.sh $CC \"some argument with spaces\" otherargument\n```\nwhich I think nobody will do.",
    "created_at": "2012-04-09T22:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144046",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment%3A7):
> Replying to [@nexttime](#comment%3A5):
> > I'd also use `$@` instead of `"$@"`, then quoting `$CC` doesn't hurt (so you wouldn't have to change the M4RIE spkg either), and the latter won't work as probably expected.
> 
> I think quoting `$CC` should hurt because it's wrong.

You can't say it's wrong.  But using `"$@"` would only make sense if one e.g. did

```sh
testcc.sh "$CC" "some argument with spaces" otherargument
# (if $CC is actually a single pathname with spaces in it)

# or, likewise
testcc.sh $CC "some argument with spaces" otherargument
```
which I think nobody will do.



---

archive/issue_comments_144047.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nPositive review for the patch to `testcc.sh` **if you remove the extra `grep`**... ;-)\n\n\n\n\nThe (patch to the) M4RIE spkg needs work anyway:\n\n```sh\nif [ \"$COMPILER\"  = \"GNU\" ] ; then \n    ...\n```\n\n(`testcc.sh` never returns `GNU`, at most `GCC`.)",
    "created_at": "2012-04-09T22:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144047",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

Positive review for the patch to `testcc.sh` **if you remove the extra `grep`**... ;-)




The (patch to the) M4RIE spkg needs work anyway:

```sh
if [ "$COMPILER"  = "GNU" ] ; then 
    ...
```

(`testcc.sh` never returns `GNU`, at most `GCC`.)



---

archive/issue_comments_144048.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@nexttime](#comment%3A11):\n> The (patch to the) M4RIE spkg needs work anyway:\n> \n> ```sh\n> if [ \"$COMPILER\"  = \"GNU\" ] ; then \n>     ...\n> ```\n> \n> (`testcc.sh` never returns `GNU`, at most `GCC`.)\n\nAnd wouldn't using `testcflags.sh -fPIC -Wall -pedantic` there be more appropriate anyway?",
    "created_at": "2012-04-09T22:38:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144048",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@nexttime](#comment%3A11):
> The (patch to the) M4RIE spkg needs work anyway:
> 
> ```sh
> if [ "$COMPILER"  = "GNU" ] ; then 
>     ...
> ```
> 
> (`testcc.sh` never returns `GNU`, at most `GCC`.)

And wouldn't using `testcflags.sh -fPIC -Wall -pedantic` there be more appropriate anyway?



---

archive/issue_events_175058.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-04-10T02:59:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175058"
}
```



---

archive/issue_events_175059.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-04-10T02:59:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175059"
}
```



---

archive/issue_comments_144049.json:
```json
{
    "body": "Work Issues: **Fix comparison to `GNU` in the M4RIE spkg.**",
    "created_at": "2012-04-10T02:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144049",
    "user": "https://github.com/nexttime"
}
```

Work Issues: **Fix comparison to `GNU` in the M4RIE spkg.**



---

archive/issue_comments_144050.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n... if you change the spkg *here*.\n\n(And the changelog entry should say *\"... **when calling** `testcc.sh`.\"*, provided you don't change `spkg-install` to use `testcflags.sh` of course, the latter being much better.)",
    "created_at": "2012-04-10T02:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144050",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:13" align="right">comment:13</div>

... if you change the spkg *here*.

(And the changelog entry should say *"... **when calling** `testcc.sh`."*, provided you don't change `spkg-install` to use `testcflags.sh` of course, the latter being much better.)



---

archive/issue_comments_144051.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nBtw., `testcflags.sh` also needs work, as I already reported on sage-devel a while ago:\n\n```sh\n...\noutfile=testcflags-$$\ncfile=$outfile.c\n...\nrm -f $TESTFILE $OUTFILE\n...\n```\n\n(And there are a few other issues with it.  Wonder who reviewed such, as the temporary files will **always** remain, while completely unrelated files might get deleted(!).)",
    "created_at": "2012-04-10T03:43:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144051",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

Btw., `testcflags.sh` also needs work, as I already reported on sage-devel a while ago:

```sh
...
outfile=testcflags-$$
cfile=$outfile.c
...
rm -f $TESTFILE $OUTFILE
...
```

(And there are a few other issues with it.  Wonder who reviewed such, as the temporary files will **always** remain, while completely unrelated files might get deleted(!).)



---

archive/issue_comments_144052.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAdded a fix also for testcflags.sh.",
    "created_at": "2012-04-10T08:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144052",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Added a fix also for testcflags.sh.



---

archive/issue_comments_144053.json:
```json
{
    "body": "Changed work issues from **Fix comparison to `GNU` in the M4RIE spkg.** to none",
    "created_at": "2012-04-10T08:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144053",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **Fix comparison to `GNU` in the M4RIE spkg.** to none



---

archive/issue_events_175060.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-10T08:48:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175060"
}
```



---

archive/issue_events_175061.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-10T08:48:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175061"
}
```



---

archive/issue_comments_144054.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[libm4rie-20111004.p3.diff.gz](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz)**",
    "created_at": "2012-04-10T08:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144054",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[libm4rie-20111004.p3.diff.gz](https://github.com/sagemath/sage/files/ticket12821/libm4rie-20111004.p3.diff.gz)**



---

archive/issue_comments_144055.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThe test for the compiler used in M4RIE's `spkg-install` to add specific flags is still a bit weird; you could just use `testcflags.sh` for all of this, although `+ z` is currently a bit problematic (in case the space is really required), because `testcflags.sh` tests the flags one by one, and passing `\"+ z\"` as a single parameter to it might not work either, since the compiler most probably doesn't expect it to be passed as a single argument.\n\nBut the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.\n\n\n\n\n\n\nIf `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.",
    "created_at": "2012-04-11T13:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144055",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:17" align="right">comment:17</div>

The test for the compiler used in M4RIE's `spkg-install` to add specific flags is still a bit weird; you could just use `testcflags.sh` for all of this, although `+ z` is currently a bit problematic (in case the space is really required), because `testcflags.sh` tests the flags one by one, and passing `"+ z"` as a single parameter to it might not work either, since the compiler most probably doesn't expect it to be passed as a single argument.

But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.






If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.



---

archive/issue_comments_144056.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@nexttime](#comment%3A17):\n> But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.\n\nOh I see, you've meanwhile fixed that, such that we could now use (e.g.) `testcflags.sh -fPIC -Kpic \"+ z\"`.",
    "created_at": "2012-04-11T13:23:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144056",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@nexttime](#comment%3A17):
> But the quoting in `testcflags.sh` wouldn't work as expected anyway, so you could just omit the quotes there *when calling the compiler* with previous and the currently to be tested flags.

Oh I see, you've meanwhile fixed that, such that we could now use (e.g.) `testcflags.sh -fPIC -Kpic "+ z"`.



---

archive/issue_comments_144057.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nW.r.t. `testcflags.sh`:\n\nI'd move the usage instructions from the comment into the error message given if `CC` isn't set, and add `$# -eq 0` (or `$# -lt 1`) to the test, such that calling `testcflags.sh` without arguments outputs its usage.",
    "created_at": "2012-04-11T13:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144057",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:19" align="right">comment:19</div>

W.r.t. `testcflags.sh`:

I'd move the usage instructions from the comment into the error message given if `CC` isn't set, and add `$# -eq 0` (or `$# -lt 1`) to the test, such that calling `testcflags.sh` without arguments outputs its usage.



---

archive/issue_comments_144058.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nA few more comments:\n\n* The scripts could respect `TMP` and `TMPDIR` if set.\n\n* On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.\n\n* Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.\n\n* In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?",
    "created_at": "2012-04-11T13:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144058",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:20" align="right">comment:20</div>

A few more comments:

* The scripts could respect `TMP` and `TMPDIR` if set.

* On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.

* Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.

* In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?



---

archive/issue_comments_144059.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@nexttime](#comment%3A20):\n> * In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?\n\nDoesn't look like.  (Although one can set `SAGE_INSTALL_GCC=no`.)\n\nQuite unrelated, but from `spkg/install` (i.e., while we're at it):\n\n```sh\nif [ -z \"$SAGE_FORTRAN\" ]; then\n    if command -v gfortran >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=gfortran\n    elif command -v g95 >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=g95\n    elif command -v g77 >/dev/null 2>/dev/null; then\n        SAGE_FORTRAN=g77\n    fi\nfi\n```\nignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.\n\nThe created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).\n\nDon't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.",
    "created_at": "2012-04-11T14:10:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144059",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@nexttime](#comment%3A20):
> * In `spkg/install`, there should be a way to bypass the installation of GCC (if the compiler isn't GCC), e.g. if `SAGE_PORT=yes` (?).  Or is there already such?

Doesn't look like.  (Although one can set `SAGE_INSTALL_GCC=no`.)

Quite unrelated, but from `spkg/install` (i.e., while we're at it):

```sh
if [ -z "$SAGE_FORTRAN" ]; then
    if command -v gfortran >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=gfortran
    elif command -v g95 >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=g95
    elif command -v g77 >/dev/null 2>/dev/null; then
        SAGE_FORTRAN=g77
    fi
fi
```
ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.

The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).

Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.



---

archive/issue_comments_144060.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nMore on `spkg/install`: :-)\n\n```sh\ngrep '^\\($\\|[0-3]\\.\\|4\\.[0-3]\\|4\\.6\\.[01]$\\)'\n```\nis GNUism and non-portable; either use\n\n```sh\negrep '^($|[0-3]\\.|4\\.[0-3]|4\\.6\\.[01]$)'\n```\nor, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.",
    "created_at": "2012-04-11T14:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144060",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:22" align="right">comment:22</div>

More on `spkg/install`: :-)

```sh
grep '^\($\|[0-3]\.\|4\.[0-3]\|4\.6\.[01]$\)'
```
is GNUism and non-portable; either use

```sh
egrep '^($|[0-3]\.|4\.[0-3]|4\.6\.[01]$)'
```
or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.



---

archive/issue_comments_144061.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@nexttime](#comment%3A22):\n> More on `spkg/install`: :-)\n> \n> ```sh\n> grep '^\\($\\|[0-3]\\.\\|4\\.[0-3]\\|4\\.6\\.[01]$\\)'\n> ```\n> is GNUism and non-portable; either use\n> \n> ```sh\n> egrep '^($|[0-3]\\.|4\\.[0-3]|4\\.6\\.[01]$)'\n> ```\n> or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.\n\nSee #12825.",
    "created_at": "2012-04-11T16:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144061",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@nexttime](#comment%3A22):
> More on `spkg/install`: :-)
> 
> ```sh
> grep '^\($\|[0-3]\.\|4\.[0-3]\|4\.6\.[01]$\)'
> ```
> is GNUism and non-portable; either use
> 
> ```sh
> egrep '^($|[0-3]\.|4\.[0-3]|4\.6\.[01]$)'
> ```
> or, preferably, shell pattern matching, which is reliable, and in which case you could also more easily handle e.g. a 4.6.1 version on Ubuntu.

See #12825.



---

archive/issue_comments_144062.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@nexttime](#comment%3A21):\n> Quite unrelated, but from `spkg/install` (i.e., while we're at it):\n> \n> ```sh\n> if [ -z \"$SAGE_FORTRAN\" ]; then\n>     if command -v gfortran >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=gfortran\n>     elif command -v g95 >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=g95\n>     elif command -v g77 >/dev/null 2>/dev/null; then\n>         SAGE_FORTRAN=g77\n>     fi\n> fi\n> ```\n> ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.\n> \n> The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).\n> \n> Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.\n\nYou're certainly right that there are some issues here, but that's totally outside of the scope of this ticket.",
    "created_at": "2012-04-11T16:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144062",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@nexttime](#comment%3A21):
> Quite unrelated, but from `spkg/install` (i.e., while we're at it):
> 
> ```sh
> if [ -z "$SAGE_FORTRAN" ]; then
>     if command -v gfortran >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=gfortran
>     elif command -v g95 >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=g95
>     elif command -v g77 >/dev/null 2>/dev/null; then
>         SAGE_FORTRAN=g77
>     fi
> fi
> ```
> ignores settings of `FC` and `F77`, the standard variables containing the Fortran compiler.
> 
> The created `sage_fortran` script hardcodes `-m64` (and ignores `FFLAGS`, `FCFLAGS`, `F77FLAGS` etc.).
> 
> Don't know whether that's really intentional, but also the *current setting* of `SAGE_FORTRAN` is hardcoded into the script, such that later changing `SAGE_FORTRAN` has no effect.

You're certainly right that there are some issues here, but that's totally outside of the scope of this ticket.



---

archive/issue_comments_144063.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@nexttime](#comment%3A20):\n> The scripts could respect `TMP` and `TMPDIR` if set.\n\nWhat's `TMP`?  I agree on `TMPDIR`, which is the standard way of specifying a temporary directory.\n\n> On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.\n\nFair enough.\n\n>  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.\n\nThose two commands aren't equivalent.\n\n> In `spkg/install`, there should be a way to bypass the installation of GCC.\n\nYou can set `SAGE_INSTALL_GCC=no`.",
    "created_at": "2012-04-11T16:18:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144063",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@nexttime](#comment%3A20):
> The scripts could respect `TMP` and `TMPDIR` if set.

What's `TMP`?  I agree on `TMPDIR`, which is the standard way of specifying a temporary directory.

> On Cygwin `-o foo` will create `foo.exe`, so that should (also) be removed.

Fair enough.

>  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.

Those two commands aren't equivalent.

> In `spkg/install`, there should be a way to bypass the installation of GCC.

You can set `SAGE_INSTALL_GCC=no`.



---

archive/issue_comments_144064.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> Replying to [@nexttime](#comment%3A20):\n> >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.\n> \n> Thoase two commands aren't equivalent.\n\nThey of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.",
    "created_at": "2012-04-11T18:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144064",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jdemeyer](#comment%3A25):
> Replying to [@nexttime](#comment%3A20):
> >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.
> 
> Thoase two commands aren't equivalent.

They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.



---

archive/issue_comments_144065.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@nexttime](#comment%3A26):\n> Replying to [@jdemeyer](#comment%3A25):\n> > Replying to [@nexttime](#comment%3A20):\n> > >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.\n> > \n> > Thoase two commands aren't equivalent.\n> \n> \n> They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.\n\nDid you even **try** those commands before saying such non-sense?",
    "created_at": "2012-04-13T09:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144065",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@nexttime](#comment%3A26):
> Replying to [@jdemeyer](#comment%3A25):
> > Replying to [@nexttime](#comment%3A20):
> > >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.
> > 
> > Thoase two commands aren't equivalent.
> 
> 
> They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.

Did you even **try** those commands before saying such non-sense?



---

archive/issue_comments_144066.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment%3A27):\n> Replying to [@nexttime](#comment%3A26):\n> > Replying to [@jdemeyer](#comment%3A25):\n> > > Replying to [@nexttime](#comment%3A20):\n> > > >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.\n> > > \n> > > Those two commands aren't equivalent.\n> > \n> > \n> > They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.\n> \n> Did you even **try** those commands before saying such non-sense?\n\nI apparently had trailing spaces on the lines with compiler names...\n\n```sh\nsed -n '/^[A-Z]/s/[ ]*//gp'\n```\ndoes it, although we shouldn't have spaces on these lines anyway (in which case the substitution of course would be superfluous).",
    "created_at": "2012-04-13T13:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144066",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment%3A27):
> Replying to [@nexttime](#comment%3A26):
> > Replying to [@jdemeyer](#comment%3A25):
> > > Replying to [@nexttime](#comment%3A20):
> > > >  Using `sed -n '/^[A-Z]/s/ *gp'` is much faster than `sed -n 's/ *g;/^[A-Z]/p'`.
> > > 
> > > Those two commands aren't equivalent.
> > 
> > 
> > They of course aren't, but in our case have the same (desired) effect; mine is equivalent to what Dave did, while yours isn't.
> 
> Did you even **try** those commands before saying such non-sense?

I apparently had trailing spaces on the lines with compiler names...

```sh
sed -n '/^[A-Z]/s/[ ]*//gp'
```
does it, although we shouldn't have spaces on these lines anyway (in which case the substitution of course would be superfluous).



---

archive/issue_comments_144067.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@nexttime](#comment%3A17):\n> If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.\n\nThis is still in the diff; haven't downloaded the new spkg (yet).",
    "created_at": "2012-04-13T14:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144067",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@nexttime](#comment%3A17):
> If `SAGE_DEBUG=yes`, `-O0` should be **ap**pended to `CFLAGS`, as it was.

This is still in the diff; haven't downloaded the new spkg (yet).



---

archive/issue_comments_144068.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI have based the new SPKG at\u00a0#12841\u00a0on\u00a0http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg. Additionally, I changed spkg-install to append not prepend -O0.",
    "created_at": "2012-04-13T20:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144068",
    "user": "https://github.com/malb"
}
```

<div id="comment:30" align="right">comment:30</div>

I have based the new SPKG at #12841 on http://boxen.math.washington.edu/home/jdemeyer/spkg/libm4rie-20111004.p3.spkg. Additionally, I changed spkg-install to append not prepend -O0.



---

archive/issue_comments_144069.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nNew version of [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) needs review.\n\nI disagree about appending `-O0`.  I think the user's `CFLAGS` should always override the SPKG's `CFLAGS` without exceptions.  What if the user for some reason wants `--enable-debug` but still `-O2`?\n\nIn any case, the following would be very inconsistent:\n\n```sh\nif [ \"x$SAGE_DEBUG\" = \"xyes\" ]; then\n   CFLAGS=\"$CFLAGS -O0\"\n   ENABLE_DEBUG=\"--enable-debug\"\nelse\n   CFLAGS=\"-O2 $CFLAGS\"\n   ENABLE_DEBUG=\"\"\nfi\n```",
    "created_at": "2012-04-14T11:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144069",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

New version of [attachment: 12821_testcc.patch](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz) needs review.

I disagree about appending `-O0`.  I think the user's `CFLAGS` should always override the SPKG's `CFLAGS` without exceptions.  What if the user for some reason wants `--enable-debug` but still `-O2`?

In any case, the following would be very inconsistent:

```sh
if [ "x$SAGE_DEBUG" = "xyes" ]; then
   CFLAGS="$CFLAGS -O0"
   ENABLE_DEBUG="--enable-debug"
else
   CFLAGS="-O2 $CFLAGS"
   ENABLE_DEBUG=""
fi
```



---

archive/issue_comments_144070.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nStill needs review...",
    "created_at": "2012-05-02T18:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144070",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

Still needs review...



---

archive/issue_events_175062.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-02T18:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175062"
}
```



---

archive/issue_events_175063.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-02T18:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175063"
}
```



---

archive/issue_comments_144071.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThe patched version of `testcflags.sh` always produces an empty list of cflags for me. My guess is that it is due to `d` being undefined in the following block of code:\n\n```C\nunsigned long double_to_ulong() \n{ \n    return (unsigned long)d; \n}\n```",
    "created_at": "2012-05-25T00:21:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144071",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:33" align="right">comment:33</div>

The patched version of `testcflags.sh` always produces an empty list of cflags for me. My guess is that it is due to `d` being undefined in the following block of code:

```C
unsigned long double_to_ulong() 
{ 
    return (unsigned long)d; 
}
```



---

archive/issue_events_175064.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-05-25T00:21:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175064"
}
```



---

archive/issue_events_175065.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-05-25T00:21:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175065"
}
```



---

archive/issue_comments_144072.json:
```json
{
    "body": "Attachment: **[12821_testcc.patch.gz](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz)**",
    "created_at": "2012-05-25T05:04:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144072",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12821_testcc.patch.gz](https://github.com/sagemath/sage/files/ticket12821/12821_testcc.patch.gz)**



---

archive/issue_comments_144073.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nOf course, I don't know how I missed that...\n\nFixed.",
    "created_at": "2012-05-25T05:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144073",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Of course, I don't know how I missed that...

Fixed.



---

archive/issue_events_175066.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-25T05:05:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175066"
}
```



---

archive/issue_events_175067.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-25T05:05:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175067"
}
```



---

archive/issue_comments_144074.json:
```json
{
    "body": "Changed keywords from none to **sd40.5**",
    "created_at": "2012-05-25T05:13:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144074",
    "user": "https://github.com/ohanar"
}
```

Changed keywords from none to **sd40.5**



---

archive/issue_comments_144075.json:
```json
{
    "body": "Changed reviewer from **Leif Leonhardy** to **Leif Leonhardy, R. Andrew Ohana**",
    "created_at": "2012-05-25T05:13:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144075",
    "user": "https://github.com/ohanar"
}
```

Changed reviewer from **Leif Leonhardy** to **Leif Leonhardy, R. Andrew Ohana**



---

archive/issue_comments_144076.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nOk, looks good and works well.\n\nTo note, this is not a great test for cflags. For example, clang only throws warnings to bad compiler flags, it does not error.",
    "created_at": "2012-05-25T05:13:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144076",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:35" align="right">comment:35</div>

Ok, looks good and works well.

To note, this is not a great test for cflags. For example, clang only throws warnings to bad compiler flags, it does not error.



---

archive/issue_events_175068.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-05-25T05:13:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175068"
}
```



---

archive/issue_events_175069.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-05-25T05:13:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175069"
}
```



---

archive/issue_comments_144077.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@ohanar](#comment%3A35):\n> For example, clang only throws warnings to bad compiler flags, it does not error.\n\nThat's stupid:\n\n```\nbsd:~ jdemeyer$ clang -march=foobar foo.c -c -o foo.o\n'foobar' is not a recognized processor for this target (ignoring processor)\nbsd:~ jdemeyer$ echo $?\n0\n```\n\nThis could mean that MPIR for example might produce very suboptimal code because it *thinks* that `-march=foo` is supported when it's not.",
    "created_at": "2012-05-26T05:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144077",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@ohanar](#comment%3A35):
> For example, clang only throws warnings to bad compiler flags, it does not error.

That's stupid:

```
bsd:~ jdemeyer$ clang -march=foobar foo.c -c -o foo.o
'foobar' is not a recognized processor for this target (ignoring processor)
bsd:~ jdemeyer$ echo $?
0
```

This could mean that MPIR for example might produce very suboptimal code because it *thinks* that `-march=foo` is supported when it's not.



---

archive/issue_comments_144078.json:
```json
{
    "body": "Merged: **sage-5.1.beta2**",
    "created_at": "2012-06-02T12:14:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12821#issuecomment-144078",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta2**



---

archive/issue_events_175070.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:14:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175070"
}
```



---

archive/issue_events_175071.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:14:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12821",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12821#event-175071"
}
```
