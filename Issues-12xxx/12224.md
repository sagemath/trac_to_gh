# Issue 12224: Language as parent / Word as element

archive/issues_012052.json:
```json
{
    "body": "This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class \"Language\" (= graded set of words) as a Parent and a class \"Word\" as Element.\n\nThree categories are created: Languages, FactorialLanguages and Shifts that gather several methods of finite and infinite words. For speed reason there are base Cython classes for\n* finite word (in sage.combinat.words.finite_word)\n* infinite word (in sage.combinat.words.infinite_word)\n* language (in sage.combinat.languages.language) \n\nEvery implementation must inherit from the class above (it is check in the TestSuite of the related categories).\n\nThe previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.\n\n- #12225 : finite and lazy languages\n- #12227 : adic languages\n\n---\n\nOld pre-git instructions to import the code. To import and apply all patches do\n\n```\ncd SAGE_ROOT/devel/YOUR_BRANCH\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch\nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch\nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch \nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch\nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13801/trac_13801-fix_facade_initialisation-vd.patch\nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch\nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch \nhg qpush\nhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12224/trac_12224-language.patch\nhg qpush\n```\n\nAssignee: @videlec\n\nCC:  @staroste @seblabbe tmonteil @nathanncohen tjolivet jepperlein\n\nKeywords: word, language, symbolic dynamics\n\nWork Issues: pickling, doctests errors, revert changes on repr, ...\n\nReviewer: S\u00e9bastien Labb\u00e9\n\nAuthor: Vincent Delecroix\n\nStatus: needs_work\n\nDependencies: #8920, #12230, #12518, #13778, #13956, #13957, #13801\n\nIssue created by migration from https://trac.sagemath.org/ticket/12224\n\n",
    "created_at": "2011-12-23T10:44:31Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Language as parent / Word as element",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12224",
    "user": "https://github.com/videlec"
}
```
This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class "Language" (= graded set of words) as a Parent and a class "Word" as Element.

Three categories are created: Languages, FactorialLanguages and Shifts that gather several methods of finite and infinite words. For speed reason there are base Cython classes for
* finite word (in sage.combinat.words.finite_word)
* infinite word (in sage.combinat.words.infinite_word)
* language (in sage.combinat.languages.language) 

Every implementation must inherit from the class above (it is check in the TestSuite of the related categories).

The previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.

- #12225 : finite and lazy languages
- #12227 : adic languages

---

Old pre-git instructions to import the code. To import and apply all patches do

```
cd SAGE_ROOT/devel/YOUR_BRANCH
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch 
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13801/trac_13801-fix_facade_initialisation-vd.patch
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch 
hg qpush
hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12224/trac_12224-language.patch
hg qpush
```

Assignee: @videlec

CC:  @staroste @seblabbe tmonteil @nathanncohen tjolivet jepperlein

Keywords: word, language, symbolic dynamics

Work Issues: pickling, doctests errors, revert changes on repr, ...

Reviewer: Sébastien Labbé

Author: Vincent Delecroix

Status: needs_work

Dependencies: #8920, #12230, #12518, #13778, #13956, #13957, #13801

Issue created by migration from https://trac.sagemath.org/ticket/12224





---

archive/issue_comments_171814.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n * consider a word as element of a language and move elsewhere the methods of Word that does not fit to this framework\n * change Words into FreeMonoid\n * coercion\n+\n+see also: #12225, #12227\n``````\n",
    "created_at": "2011-12-23T11:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171814",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 * consider a word as element of a language and move elsewhere the methods of Word that does not fit to this framework
 * change Words into FreeMonoid
 * coercion
+
+see also: #12225, #12227
``````




---

archive/issue_comments_171815.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,14 @@\n-This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...).\n+This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class \"Language\" (= graded set of words) as a Parent and a class \"Word\" as Element.\n \n Roadmap:\n-* implement Language (= set of Word) and its children FactorialLanguage, ProlongableLanguage, etc\n-* consider a word as element of a language and move elsewhere the methods of Word that does not fit to this framework\n-* change Words into FreeMonoid\n-* coercion\n+* Use EnumeratedSets and GradedEnumeratedSets to build a class Language and use it as a base class for sage.combinat.words.words.Words_over_ordered_alphabet \n+* move into a derived class the current methods of Word that does not fit to this framework\n+* Inheritate from Monoid for the language of all words on a given alphabet and see the overlap with the code in sage.monoids.*\n+* coercion between different languages (on the top is the FreeMonoid)\n+\n+To think about:\n+* what should be in the parent, what should be in the element ?\n+* what do we keep of the current methods of Word ?\n+* in general a language is not a monoid... but some of them are (FullShift, the words with the same number of each letter, ...). Find a way to use the Monoid category in these cases. Remark that a language which is also a monoid is completely defined by its irreducible words (the word that can not be built from concatenation of smaller words).\n \n see also: #12225, #12227\n``````\n",
    "created_at": "2012-01-10T17:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171815",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,14 @@
-This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...).
+This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class "Language" (= graded set of words) as a Parent and a class "Word" as Element.
 
 Roadmap:
-* implement Language (= set of Word) and its children FactorialLanguage, ProlongableLanguage, etc
-* consider a word as element of a language and move elsewhere the methods of Word that does not fit to this framework
-* change Words into FreeMonoid
-* coercion
+* Use EnumeratedSets and GradedEnumeratedSets to build a class Language and use it as a base class for sage.combinat.words.words.Words_over_ordered_alphabet 
+* move into a derived class the current methods of Word that does not fit to this framework
+* Inheritate from Monoid for the language of all words on a given alphabet and see the overlap with the code in sage.monoids.*
+* coercion between different languages (on the top is the FreeMonoid)
+
+To think about:
+* what should be in the parent, what should be in the element ?
+* what do we keep of the current methods of Word ?
+* in general a language is not a monoid... but some of them are (FullShift, the words with the same number of each letter, ...). Find a way to use the Monoid category in these cases. Remark that a language which is also a monoid is completely defined by its irreducible words (the word that can not be built from concatenation of smaller words).
 
 see also: #12225, #12227
``````




---

archive/issue_comments_171816.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#10193\"",
    "created_at": "2012-01-10T17:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171816",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "" to "#10193"



---

archive/issue_comments_171817.json:
```json
{
    "body": "Changing dependencies from \"#10193\" to \"#8920, #10193\"",
    "created_at": "2012-08-18T10:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171817",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#10193" to "#8920, #10193"



---

archive/issue_comments_171818.json:
```json
{
    "body": "Changing dependencies from \"#8920, #10193\" to \"#8920, #10193, #13803, #13778\"",
    "created_at": "2012-12-06T09:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171818",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#8920, #10193" to "#8920, #10193, #13803, #13778"



---

archive/issue_comments_171819.json:
```json
{
    "body": "Changing dependencies from \"#8920, #10193, #13803, #13778\" to \"#8920, #13778, #13956\"",
    "created_at": "2013-01-15T11:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171819",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#8920, #10193, #13803, #13778" to "#8920, #13778, #13956"



---

archive/issue_comments_171820.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,13 @@\n This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class \"Language\" (= graded set of words) as a Parent and a class \"Word\" as Element.\n \n-Roadmap:\n-* Use EnumeratedSets and GradedEnumeratedSets to build a class Language and use it as a base class for sage.combinat.words.words.Words_over_ordered_alphabet \n-* move into a derived class the current methods of Word that does not fit to this framework\n-* Inheritate from Monoid for the language of all words on a given alphabet and see the overlap with the code in sage.monoids.*\n-* coercion between different languages (on the top is the FreeMonoid)\n+Three categories are created: Languages, FactorialLanguages and Shifts that gather several methods of finite and infinite words. For speed reason there are base Cython classes for\n+* finite word (in sage.combinat.words.finite_word)\n+* infinite word (in sage.combinat.words.infinite_word)\n+* language (in sage.combinat.languages.language) \n \n-To think about:\n-* what should be in the parent, what should be in the element ?\n-* what do we keep of the current methods of Word ?\n-* in general a language is not a monoid... but some of them are (FullShift, the words with the same number of each letter, ...). Find a way to use the Monoid category in these cases. Remark that a language which is also a monoid is completely defined by its irreducible words (the word that can not be built from concatenation of smaller words).\n+Every implementation must inherit from the class above (it is check in the TestSuite of the related categories).\n+\n+The previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.\n+\n \n see also: #12225, #12227\n``````\n",
    "created_at": "2013-01-15T11:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171820",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,13 @@
 This ticket is a prerequisite to further development in the combinatorics of words and symbolic dynamical systems (adic language, SFT, ...). It concerns the implementation of a class "Language" (= graded set of words) as a Parent and a class "Word" as Element.
 
-Roadmap:
-* Use EnumeratedSets and GradedEnumeratedSets to build a class Language and use it as a base class for sage.combinat.words.words.Words_over_ordered_alphabet 
-* move into a derived class the current methods of Word that does not fit to this framework
-* Inheritate from Monoid for the language of all words on a given alphabet and see the overlap with the code in sage.monoids.*
-* coercion between different languages (on the top is the FreeMonoid)
+Three categories are created: Languages, FactorialLanguages and Shifts that gather several methods of finite and infinite words. For speed reason there are base Cython classes for
+* finite word (in sage.combinat.words.finite_word)
+* infinite word (in sage.combinat.words.infinite_word)
+* language (in sage.combinat.languages.language) 
 
-To think about:
-* what should be in the parent, what should be in the element ?
-* what do we keep of the current methods of Word ?
-* in general a language is not a monoid... but some of them are (FullShift, the words with the same number of each letter, ...). Find a way to use the Monoid category in these cases. Remark that a language which is also a monoid is completely defined by its irreducible words (the word that can not be built from concatenation of smaller words).
+Every implementation must inherit from the class above (it is check in the TestSuite of the related categories).
+
+The previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.
+
 
 see also: #12225, #12227
``````




---

archive/issue_comments_171821.json:
```json
{
    "body": "Changing dependencies from \"#8920, #13778, #13956\" to \"#8920, #13778, #13956, #13957\"",
    "created_at": "2013-01-15T11:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171821",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#8920, #13778, #13956" to "#8920, #13778, #13956, #13957"



---

archive/issue_comments_171822.json:
```json
{
    "body": "Changing dependencies from \"#8920, #13778, #13956, #13957\" to \"#8920, #12230, #12518, #13778, #13956, #13957\"",
    "created_at": "2013-01-15T14:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171822",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#8920, #13778, #13956, #13957" to "#8920, #12230, #12518, #13778, #13956, #13957"



---

archive/issue_comments_171823.json:
```json
{
    "body": "<a id='comment:9'></a>\nAttachment [trac_12224-language.patch](tarball://root/attachments/some-uuid/ticket12224/trac_12224-language.patch) by @videlec created at 2013-01-18 09:44:38\n\nThe patch is still in experimental version but a relatively stable one (all tests pass but the coverage is not 100%)... you may use, test, comment, break and enjoy !\n\nBest,\nVincent",
    "created_at": "2013-01-18T09:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171823",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Attachment [trac_12224-language.patch](tarball://root/attachments/some-uuid/ticket12224/trac_12224-language.patch) by @videlec created at 2013-01-18 09:44:38

The patch is still in experimental version but a relatively stable one (all tests pass but the coverage is not 100%)... you may use, test, comment, break and enjoy !

Best,
Vincent



---

archive/issue_comments_171824.json:
```json
{
    "body": "<a id='comment:10'></a>\nI started the review. Here is a first bunch of comments.\n\n1. **Goal of the ticket: Categories in `sage/combinat/words` library.** The goal of this patch reimplements the code structure of `sage/combinat/words` using categories. It also adds classes for languages which is a good thing that I would need for my own research. It touches other files outside of this folder. It also depends on some particular tickets fixing bugs in Cython (#13957) and other patches that apply on similar files which do not commute with this huge patch. Moreover since it is a huge patch touching many files, it prevents any user/developper to change any code in `sage/combinat/words` without creating conflicts. So I hope this will not take forever to get reviewed because meanwhile it prevents the evolution of the actual code.\n\n2. **Content of the patch.** It is a huge patch (1.3MG). It modifies 40 files, add 27 files and removes 6 files (see detailed list below). It is hard for any reviewer to make sure he doesn't miss a problem possibly added by the patch. Is there a way to cut the patch in different chunks (tickets) which could make it more easy to get it into Sage because easier for reviewers?\n\n```\n~/Applications/sage-5.6.rc0/devel/sage-language/sage/combinat/words $ hg qtop\ntrac_12224-language-vd.patch\n~/Applications/sage-5.6.rc0/devel/sage-language/sage/combinat/words $ hg qst\nM doc/en/reference/categories.rst\nM doc/en/reference/combinat/words.rst\nM module_list.py\nM sage/all.py\nM sage/categories/algebras.py\nM sage/categories/algebras_with_basis.py\nM sage/categories/all.py\nM sage/categories/examples/algebras_with_basis.py\nM sage/categories/modules_with_basis.py\nM sage/categories/primer.py\nM sage/categories/rings.py\nM sage/categories/sets_cat.py\nM sage/combinat/all.py\nM sage/combinat/debruijn_sequence.pyx\nM sage/combinat/e_one_star.py\nM sage/combinat/free_module.py\nM sage/combinat/iet/constructors.py\nM sage/combinat/iet/labelled.py\nM sage/combinat/iet/reduced.py\nM sage/combinat/lyndon_word.py\nM sage/combinat/ribbon.py\nM sage/combinat/ribbon_tableau.py\nM sage/combinat/sf/ns_macdonald.py\nM sage/combinat/skew_tableau.py\nM sage/combinat/tableau.py\nM sage/combinat/words/__init__.py\nM sage/combinat/words/all.py\nM sage/combinat/words/alphabet.py\nM sage/combinat/words/morphism.py\nM sage/combinat/words/notes/history.txt\nM sage/combinat/words/paths.py\nM sage/combinat/words/shuffle_product.py\nM sage/combinat/words/suffix_trees.py\nM sage/combinat/words/word.py\nM sage/combinat/words/word_datatypes.pyx\nM sage/combinat/words/word_generators.py\nM sage/combinat/words/words.py\nM sage/graphs/digraph_generators.py\nM sage/sets/disjoint_set.pyx\nM setup.py\nA sage/categories/examples/languages.py\nA sage/categories/factorial_languages.py\nA sage/categories/languages.py\nA sage/categories/shifts.py\nA sage/combinat/languages/__init__.py\nA sage/combinat/languages/all.py\nA sage/combinat/languages/balanced_languages.py\nA sage/combinat/languages/base_class.py\nA sage/combinat/languages/finite_word_language.py\nA sage/combinat/languages/generators.py\nA sage/combinat/languages/language.pxd\nA sage/combinat/languages/language.pyx\nA sage/combinat/words/finite_word.pxd\nA sage/combinat/words/finite_word.pyx\nA sage/combinat/words/infinite_word.pxd\nA sage/combinat/words/infinite_word.pyx\nA sage/combinat/words/lazy_word.py\nA sage/combinat/words/maps.py\nA sage/combinat/words/notes/categorification.txt\nA sage/combinat/words/word_datatypes.pxd\nA sage/combinat/words/word_deprecation.py\nA sage/combinat/words/word_integer.py\nA sage/dynamics/__init__.py\nA sage/dynamics/all.py\nA sage/dynamics/symbolic/__init__.py\nA sage/dynamics/symbolic/all.py\nA sage/dynamics/symbolic/full_shift.py\nR sage/combinat/words/abstract_word.py\nR sage/combinat/words/finite_word.py\nR sage/combinat/words/infinite_word.py\nR sage/combinat/words/notes/word_inheritance_howto.txt\nR sage/combinat/words/word_infinite_datatypes.py\nR sage/combinat/words/word_options.py\n```\n\n3. **Reject on tableau file.** The actual path creates a reject on the tableau file (I am still using the svn directory for the patches. I will test the patch from the ticket instead soon. Maybe that's the reason for the reject.) :\n\n```\n10 slabbe@pol ~/Applications/sage-5.6.rc0/devel/sage-language $ hg qpush -a\napplying trac_12466-ss.patch\napplying trac_12230-growing_letters-ss.patch\napplying trac_12230-growing_letters-review-vd.patch\napplying trac_13801-fix_facade_initialisation-vd.patch\napplying trac_8920-alphabet-vd.patch\napplying trac_13803-limits.patch\napplying trac_10962-pickle_set_pythontype.patch\napplying trac_13956-shift_argument.patch\napplying trac_13957-catch_value_error.patch\napplying trac_12224-language-vd.patch\npatching file sage/combinat/tableau.py\nHunk #2 FAILED at 434\nHunk #4 FAILED at 584\nHunk #5 FAILED at 2070\n3 out of 5 hunks FAILED -- saving rejects to file sage/combinat/tableau.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_12224-language-vd.patch\n```\n\n4. **Few broken doctests.** Here are some testing errors I get on the my machine as well as on sage.math. Note that I tested only `sage/combinat` folder on my machine. This shows that some doctest are machine dependant (32bit vs 64 bits, ordering of string and int which depends on the machine : 'a'<9 vs 'a'>9 for cmp). Also for one of the doctest, `352` can be replaced by `...` to avoid future problem with lines added before. More precisely,\n\n   The output of `sage -t sage-5.6.rc0/devel/sage-language/sage/combinat/*` run on my machine (32bit) which was first pasted here is now available here : [http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_4.txt](http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_4.txt).\n\n   The output of `sage -t sage-5.6.rc1/devel/sage-12224/sage/*` run on sage.math is here : [http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt).\n\n5. **Testing the sage-main files.** I am interested in knowing whether my own code will continue to work after this ticket get merged. Eventually, I will test my own code during this review. But for now I did only one test : I check whether the doctests defined in the `sage-main` branch `sage-5.6.rc0` still pass or not. I get 618 failures only for `finite_word.py` file. Some of them are `__repr__` modifications that I can accept. But there are a lots of methods that do not exist anymore (maybe it is easy to fix?).\n\n   The output of `sage -t sage-5.6.rc0/devel/sage-main/sage/combinat/*` run on my machine which was first pasted here is now available here: [http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_5.txt](http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_5.txt).\n\n   The output of `sage -t sage-5.6.rc1/devel/sage-main/sage/*` run on sage.math is here : [http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt).",
    "created_at": "2013-01-22T12:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171824",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'></a>
I started the review. Here is a first bunch of comments.

1. **Goal of the ticket: Categories in `sage/combinat/words` library.** The goal of this patch reimplements the code structure of `sage/combinat/words` using categories. It also adds classes for languages which is a good thing that I would need for my own research. It touches other files outside of this folder. It also depends on some particular tickets fixing bugs in Cython (#13957) and other patches that apply on similar files which do not commute with this huge patch. Moreover since it is a huge patch touching many files, it prevents any user/developper to change any code in `sage/combinat/words` without creating conflicts. So I hope this will not take forever to get reviewed because meanwhile it prevents the evolution of the actual code.

2. **Content of the patch.** It is a huge patch (1.3MG). It modifies 40 files, add 27 files and removes 6 files (see detailed list below). It is hard for any reviewer to make sure he doesn't miss a problem possibly added by the patch. Is there a way to cut the patch in different chunks (tickets) which could make it more easy to get it into Sage because easier for reviewers?

```
~/Applications/sage-5.6.rc0/devel/sage-language/sage/combinat/words $ hg qtop
trac_12224-language-vd.patch
~/Applications/sage-5.6.rc0/devel/sage-language/sage/combinat/words $ hg qst
M doc/en/reference/categories.rst
M doc/en/reference/combinat/words.rst
M module_list.py
M sage/all.py
M sage/categories/algebras.py
M sage/categories/algebras_with_basis.py
M sage/categories/all.py
M sage/categories/examples/algebras_with_basis.py
M sage/categories/modules_with_basis.py
M sage/categories/primer.py
M sage/categories/rings.py
M sage/categories/sets_cat.py
M sage/combinat/all.py
M sage/combinat/debruijn_sequence.pyx
M sage/combinat/e_one_star.py
M sage/combinat/free_module.py
M sage/combinat/iet/constructors.py
M sage/combinat/iet/labelled.py
M sage/combinat/iet/reduced.py
M sage/combinat/lyndon_word.py
M sage/combinat/ribbon.py
M sage/combinat/ribbon_tableau.py
M sage/combinat/sf/ns_macdonald.py
M sage/combinat/skew_tableau.py
M sage/combinat/tableau.py
M sage/combinat/words/__init__.py
M sage/combinat/words/all.py
M sage/combinat/words/alphabet.py
M sage/combinat/words/morphism.py
M sage/combinat/words/notes/history.txt
M sage/combinat/words/paths.py
M sage/combinat/words/shuffle_product.py
M sage/combinat/words/suffix_trees.py
M sage/combinat/words/word.py
M sage/combinat/words/word_datatypes.pyx
M sage/combinat/words/word_generators.py
M sage/combinat/words/words.py
M sage/graphs/digraph_generators.py
M sage/sets/disjoint_set.pyx
M setup.py
A sage/categories/examples/languages.py
A sage/categories/factorial_languages.py
A sage/categories/languages.py
A sage/categories/shifts.py
A sage/combinat/languages/__init__.py
A sage/combinat/languages/all.py
A sage/combinat/languages/balanced_languages.py
A sage/combinat/languages/base_class.py
A sage/combinat/languages/finite_word_language.py
A sage/combinat/languages/generators.py
A sage/combinat/languages/language.pxd
A sage/combinat/languages/language.pyx
A sage/combinat/words/finite_word.pxd
A sage/combinat/words/finite_word.pyx
A sage/combinat/words/infinite_word.pxd
A sage/combinat/words/infinite_word.pyx
A sage/combinat/words/lazy_word.py
A sage/combinat/words/maps.py
A sage/combinat/words/notes/categorification.txt
A sage/combinat/words/word_datatypes.pxd
A sage/combinat/words/word_deprecation.py
A sage/combinat/words/word_integer.py
A sage/dynamics/__init__.py
A sage/dynamics/all.py
A sage/dynamics/symbolic/__init__.py
A sage/dynamics/symbolic/all.py
A sage/dynamics/symbolic/full_shift.py
R sage/combinat/words/abstract_word.py
R sage/combinat/words/finite_word.py
R sage/combinat/words/infinite_word.py
R sage/combinat/words/notes/word_inheritance_howto.txt
R sage/combinat/words/word_infinite_datatypes.py
R sage/combinat/words/word_options.py
```

3. **Reject on tableau file.** The actual path creates a reject on the tableau file (I am still using the svn directory for the patches. I will test the patch from the ticket instead soon. Maybe that's the reason for the reject.) :

```
10 slabbe@pol ~/Applications/sage-5.6.rc0/devel/sage-language $ hg qpush -a
applying trac_12466-ss.patch
applying trac_12230-growing_letters-ss.patch
applying trac_12230-growing_letters-review-vd.patch
applying trac_13801-fix_facade_initialisation-vd.patch
applying trac_8920-alphabet-vd.patch
applying trac_13803-limits.patch
applying trac_10962-pickle_set_pythontype.patch
applying trac_13956-shift_argument.patch
applying trac_13957-catch_value_error.patch
applying trac_12224-language-vd.patch
patching file sage/combinat/tableau.py
Hunk #2 FAILED at 434
Hunk #4 FAILED at 584
Hunk #5 FAILED at 2070
3 out of 5 hunks FAILED -- saving rejects to file sage/combinat/tableau.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_12224-language-vd.patch
```

4. **Few broken doctests.** Here are some testing errors I get on the my machine as well as on sage.math. Note that I tested only `sage/combinat` folder on my machine. This shows that some doctest are machine dependant (32bit vs 64 bits, ordering of string and int which depends on the machine : 'a'<9 vs 'a'>9 for cmp). Also for one of the doctest, `352` can be replaced by `...` to avoid future problem with lines added before. More precisely,

   The output of `sage -t sage-5.6.rc0/devel/sage-language/sage/combinat/*` run on my machine (32bit) which was first pasted here is now available here : [http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_4.txt](http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_4.txt).

   The output of `sage -t sage-5.6.rc1/devel/sage-12224/sage/*` run on sage.math is here : [http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt).

5. **Testing the sage-main files.** I am interested in knowing whether my own code will continue to work after this ticket get merged. Eventually, I will test my own code during this review. But for now I did only one test : I check whether the doctests defined in the `sage-main` branch `sage-5.6.rc0` still pass or not. I get 618 failures only for `finite_word.py` file. Some of them are `__repr__` modifications that I can accept. But there are a lots of methods that do not exist anymore (maybe it is easy to fix?).

   The output of `sage -t sage-5.6.rc0/devel/sage-main/sage/combinat/*` run on my machine which was first pasted here is now available here: [http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_5.txt](http://sage.math.washington.edu/home/slabbe/trac_12224/bullet_5.txt).

   The output of `sage -t sage-5.6.rc1/devel/sage-main/sage/*` run on sage.math is here : [http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt).



---

archive/issue_comments_171825.json:
```json
{
    "body": "<a id='comment:11'></a>\nI removed this comment after reorganisation.",
    "created_at": "2013-01-22T14:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171825",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:11'></a>
I removed this comment after reorganisation.



---

archive/issue_comments_171826.json:
```json
{
    "body": "<a id='comment:12'></a>\nI removed this comment after reorganisation.",
    "created_at": "2013-01-22T15:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171826",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:12'></a>
I removed this comment after reorganisation.



---

archive/issue_comments_171827.json:
```json
{
    "body": "<a id='comment:13'></a>\n6. Question. If I understand correctly, the actual ticket does not depend on the following patches :\n\n```\ntrac_13801-fix_facade_initialisation-vd.patch\ntrac_13803-limits.patch\ntrac_10962-pickle_set_pythontype.patch\n```\n\nAm I right?",
    "created_at": "2013-01-22T16:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171827",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'></a>
6. Question. If I understand correctly, the actual ticket does not depend on the following patches :

```
trac_13801-fix_facade_initialisation-vd.patch
trac_13803-limits.patch
trac_10962-pickle_set_pythontype.patch
```

Am I right?



---

archive/issue_comments_171828.json:
```json
{
    "body": "<a id='comment:14'></a>\n3 (bis). I tested on sage-5.6.rc1 with the following tickets, and I still get the reject with the tableau file :\n\n```\n~/sage-5.6.rc1/devel/sage-12224$ hg qapplied\ntrac_8920-alphabet.patch\ntrac_12466-ss.patch\ntrac_12230-growing_letters-ss.patch\ntrac_12230-growing_letters-review-vd.patch\ntrac_13956-shift_argument.patch\ntrac_13957-catch_value_error.patch\n\n~/sage-5.6.rc1/devel/sage-12224$ hg qpush\napplying trac_12224-language.patch\npatching file sage/combinat/tableau.py\nHunk #2 FAILED at 434\nHunk #4 FAILED at 584\nHunk #5 FAILED at 2070\n3 out of 5 hunks FAILED -- saving rejects to file sage/combinat/tableau.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_12224-language.patch\n```\n\nMoreover, with these tickets applied, sage does not start :\n\n```\nslabbe@sage:~/sage-5.6.rc1/devel/sage-12224$ ../../sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n| Sage Version 5.6.rc1, Release Date: 2013-01-18                     |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n\n[...]\n\n/home/slabbe/sage-5.6.rc1/local/lib/python2.7/site-packages/sage/categories/category.pyc in <genexpr>((cat,))\n    144     result = ()\n    145     for category in categories:\n--> 146         if any(cat.is_subcategory(category) for cat in result):\n    147             continue\n    148         result = tuple( cat for cat in result if not category.is_subcategory(cat) ) + (category,)\n\nAttributeError: 'tuple' object has no attribute 'is_subcategory'\nError importing ipy_profile_sage - perhaps you should run %upgrade?\nWARNING: Loading of ipy_profile_sage failed.\n\nsage: 1+1\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n\n/home/slabbe/sage-5.6.rc1/devel/sage-12224/<ipython console> in <module>()\n\nNameError: name 'Integer' is not defined\n\n```\n\nOne need to add ticket #13801 as dependency.",
    "created_at": "2013-01-22T16:08:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171828",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:14'></a>
3 (bis). I tested on sage-5.6.rc1 with the following tickets, and I still get the reject with the tableau file :

```
~/sage-5.6.rc1/devel/sage-12224$ hg qapplied
trac_8920-alphabet.patch
trac_12466-ss.patch
trac_12230-growing_letters-ss.patch
trac_12230-growing_letters-review-vd.patch
trac_13956-shift_argument.patch
trac_13957-catch_value_error.patch

~/sage-5.6.rc1/devel/sage-12224$ hg qpush
applying trac_12224-language.patch
patching file sage/combinat/tableau.py
Hunk #2 FAILED at 434
Hunk #4 FAILED at 584
Hunk #5 FAILED at 2070
3 out of 5 hunks FAILED -- saving rejects to file sage/combinat/tableau.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_12224-language.patch
```

Moreover, with these tickets applied, sage does not start :

```
slabbe@sage:~/sage-5.6.rc1/devel/sage-12224$ ../../sage
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
| Sage Version 5.6.rc1, Release Date: 2013-01-18                     |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |

[...]

/home/slabbe/sage-5.6.rc1/local/lib/python2.7/site-packages/sage/categories/category.pyc in <genexpr>((cat,))
    144     result = ()
    145     for category in categories:
--> 146         if any(cat.is_subcategory(category) for cat in result):
    147             continue
    148         result = tuple( cat for cat in result if not category.is_subcategory(cat) ) + (category,)

AttributeError: 'tuple' object has no attribute 'is_subcategory'
Error importing ipy_profile_sage - perhaps you should run %upgrade?
WARNING: Loading of ipy_profile_sage failed.

sage: 1+1
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)

/home/slabbe/sage-5.6.rc1/devel/sage-12224/<ipython console> in <module>()

NameError: name 'Integer' is not defined

```

One need to add ticket #13801 as dependency.



---

archive/issue_comments_171829.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,3 +11,22 @@\n \n \n see also: #12225, #12227\n+\n+To import and apply all patches do\n+\n+```\n+cd SAGE_ROOT/devel/YOUR_BRANCH\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch\n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch\n+hg qpushhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch \n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch\n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch\n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch \n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12224/trac_12224-language.patch\n+hg qpush\n+```\n``````\n",
    "created_at": "2013-01-22T16:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171829",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,3 +11,22 @@
 
 
 see also: #12225, #12227
+
+To import and apply all patches do
+
+```
+cd SAGE_ROOT/devel/YOUR_BRANCH
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch
+hg qpushhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch 
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch 
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12224/trac_12224-language.patch
+hg qpush
+```
``````




---

archive/issue_comments_171830.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,7 +19,8 @@\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch\n hg qpush\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch\n-hg qpushhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch \n+hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch \n hg qpush\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch\n hg qpush\n``````\n",
    "created_at": "2013-01-22T16:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171830",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,7 +19,8 @@
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/8920/trac_8920-alphabet.patch
 hg qpush
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12466/trac_12466-ss.patch
-hg qpushhg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch 
+hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-ss.patch 
 hg qpush
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch
 hg qpush
``````




---

archive/issue_comments_171831.json:
```json
{
    "body": "<a id='comment:17'></a>\n4 (second bis). I tested the doctests of the whole sage library when applying the following 8 patches on sage-5.6.rc1. \n\n```\ntrac_8920-alphabet.patch\ntrac_12466-ss.patch\ntrac_12230-growing_letters-ss.patch\ntrac_12230-growing_letters-review-vd.patch\ntrac_13801-fix_facade_initialisation-vd.patch\ntrac_13956-shift_argument.patch\ntrac_13957-catch_value_error.patch\ntrac_12224-language.patch\n```\n\nI get errors on the following files. The complete log is [here](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt).\n\n```\nThe following tests failed:\n\n\tsage -t  devel/sage-12224/sage/structure/sage_object.pyx # 1 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/tableau_tuple.py # 2 doctests failed\n\tsage -t  devel/sage-12224/sage/categories/languages.py # 3 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/tableau.py # 3 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/languages/finite_word_language.py # 3 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/words/word_deprecation.py # 1 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/words/word.py # 1 doctests failed\n\tsage -t  devel/sage-12224/sage/combinat/words/maps.py # 22 doctests failed\n----------------------------------------------------------------------\nTimings have been updated.\nTotal time for all tests: 4281.6 seconds\n```\n\nOf course, all of these should be fixed. The first file indicates there are issues with pickling.",
    "created_at": "2013-01-22T17:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171831",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:17'></a>
4 (second bis). I tested the doctests of the whole sage library when applying the following 8 patches on sage-5.6.rc1. 

```
trac_8920-alphabet.patch
trac_12466-ss.patch
trac_12230-growing_letters-ss.patch
trac_12230-growing_letters-review-vd.patch
trac_13801-fix_facade_initialisation-vd.patch
trac_13956-shift_argument.patch
trac_13957-catch_value_error.patch
trac_12224-language.patch
```

I get errors on the following files. The complete log is [here](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224.txt).

```
The following tests failed:

	sage -t  devel/sage-12224/sage/structure/sage_object.pyx # 1 doctests failed
	sage -t  devel/sage-12224/sage/combinat/tableau_tuple.py # 2 doctests failed
	sage -t  devel/sage-12224/sage/categories/languages.py # 3 doctests failed
	sage -t  devel/sage-12224/sage/combinat/tableau.py # 3 doctests failed
	sage -t  devel/sage-12224/sage/combinat/languages/finite_word_language.py # 3 doctests failed
	sage -t  devel/sage-12224/sage/combinat/words/word_deprecation.py # 1 doctests failed
	sage -t  devel/sage-12224/sage/combinat/words/word.py # 1 doctests failed
	sage -t  devel/sage-12224/sage/combinat/words/maps.py # 22 doctests failed
----------------------------------------------------------------------
Timings have been updated.
Total time for all tests: 4281.6 seconds
```

Of course, all of these should be fixed. The first file indicates there are issues with pickling.



---

archive/issue_comments_171832.json:
```json
{
    "body": "Changing dependencies from \"#8920, #12230, #12518, #13778, #13956, #13957\" to \"#8920, #12230, #12518, #13778, #13956, #13957, #13801\"",
    "created_at": "2013-01-22T23:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171832",
    "user": "https://github.com/seblabbe"
}
```

Changing dependencies from "#8920, #12230, #12518, #13778, #13956, #13957" to "#8920, #12230, #12518, #13778, #13956, #13957, #13801"



---

archive/issue_comments_171833.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,6 +24,8 @@\n hg qpush\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch\n hg qpush\n+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13801/trac_13801-fix_facade_initialisation-vd.patch\n+hg qpush\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch\n hg qpush\n hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch \n``````\n",
    "created_at": "2013-01-22T23:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171833",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,6 +24,8 @@
 hg qpush
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12230/trac_12230-growing_letters-review-vd.patch
 hg qpush
+hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13801/trac_13801-fix_facade_initialisation-vd.patch
+hg qpush
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13956/trac_13956-shift_argument.patch
 hg qpush
 hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13957/trac_13957-catch_value_error.patch 
``````




---

archive/issue_comments_171834.json:
```json
{
    "body": "<a id='comment:20'></a>\n5 (second bis). Still to understand if my code will still work after this ticket, I tested the doctests of the **sage-main** of sage-5.6-rc1 when applying the following 8 patches on sage-5.6.rc1.\n\n```\ntrac_8920-alphabet.patch\ntrac_12466-ss.patch\ntrac_12230-growing_letters-ss.patch\ntrac_12230-growing_letters-review-vd.patch\ntrac_13801-fix_facade_initialisation-vd.patch\ntrac_13956-shift_argument.patch\ntrac_13957-catch_value_error.patch\ntrac_12224-language.patch\n```\n\nIt appears that a lot of doctests are failing. The complete log is [here](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt). \n\nOne observation is that the `__repr__` and `__str__` should not be changed in this ticket to help the reviewer. There is enough doctests failing already...\n\n```\nThe following tests failed: \n\n\tsage -t  devel/sage-main/sage/structure/sage_object.pyx # 1 doctests failed\n\tsage -t  devel/sage-main/sage/plot/plot.py # Time out\n\tsage -t  devel/sage-main/sage/combinat/words/finite_word.py # 618 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/tableau_tuple.py # 2 doctests failed\n\tsage -t  devel/sage-main/sage/tests/cmdline.py # Time out\n\tsage -t  devel/sage-main/sage/combinat/words/paths.py # 114 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/e_one_star.py # 6 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/skew_tableau.py # 6 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/tableau.py # 7 doctests failed\n\tsage -t  devel/sage-main/sage/categories/rings.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/categories/primer.py # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/suffix_trees.py # 45 doctests failed\n\tsage -t  devel/sage-main/sage/graphs/digraph_generators.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/ribbon.py # 6 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/iet/reduced.py # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/free_module.py # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/word_generators.py # Time out\n\tsage -t  devel/sage-main/sage/combinat/sf/ns_macdonald.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/morphism.py # Time out\n\tsage -t  devel/sage-main/sage/categories/algebras.py # 6 doctests failed\n\tsage -t  devel/sage-main/sage/categories/sets_cat.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/sets/integer_range.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/sets/finite_set_maps.py # 7 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/iet/template.py # 3 doctests failed\n\tsage -t  devel/sage-main/sage/categories/algebras_with_basis.py # 38 doctests failed\n\tsage -t  devel/sage-main/sage/categories/examples/algebras_with_basis.py # 5 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/word_infinite_datatypes.py # 194 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/word_options.py # 6 doctests failed\n\tsage -t  devel/sage-main/sage/sets/finite_set_map_cy.pyx # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/iet/constructors.py # 3 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/debruijn_sequence.pyx # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/word_datatypes.pyx # 29 doctests failed\n\tsage -t  devel/sage-main/sage/sets/disjoint_set.pyx # 2 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/lyndon_word.py # 23 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/infinite_word.py # 14 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/iet/labelled.py # 20 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/abstract_word.py # 220 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/shuffle_product.py # 16 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/ribbon_tableau.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/word.py # 97 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/words.py # 207 doctests failed\n\tsage -t  devel/sage-main/sage/categories/modules_with_basis.py # 3 doctests failed\n\tsage -t  devel/sage-main/sage/combinat/words/alphabet.py # Time out\n----------------------------------------------------------------------\nTimings have been updated.\nTotal time for all tests: 2331.8 seconds\n```\n\nFor what reason each of these tests are failing? If it is because of a string repr that changed, this should be reverted and postpone in another ticket. If it is some hidden method starting with an underscore that was change : ok. If some result of `type(something)` changed because the class name has changed : ok. But if it is a normal method, it should still work after the ticket.",
    "created_at": "2013-01-23T00:28:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171834",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:20'></a>
5 (second bis). Still to understand if my code will still work after this ticket, I tested the doctests of the **sage-main** of sage-5.6-rc1 when applying the following 8 patches on sage-5.6.rc1.

```
trac_8920-alphabet.patch
trac_12466-ss.patch
trac_12230-growing_letters-ss.patch
trac_12230-growing_letters-review-vd.patch
trac_13801-fix_facade_initialisation-vd.patch
trac_13956-shift_argument.patch
trac_13957-catch_value_error.patch
trac_12224-language.patch
```

It appears that a lot of doctests are failing. The complete log is [here](http://sage.math.washington.edu/home/slabbe/sage-5.6.rc1/testing_12224_on_sage-main.txt). 

One observation is that the `__repr__` and `__str__` should not be changed in this ticket to help the reviewer. There is enough doctests failing already...

```
The following tests failed: 

	sage -t  devel/sage-main/sage/structure/sage_object.pyx # 1 doctests failed
	sage -t  devel/sage-main/sage/plot/plot.py # Time out
	sage -t  devel/sage-main/sage/combinat/words/finite_word.py # 618 doctests failed
	sage -t  devel/sage-main/sage/combinat/tableau_tuple.py # 2 doctests failed
	sage -t  devel/sage-main/sage/tests/cmdline.py # Time out
	sage -t  devel/sage-main/sage/combinat/words/paths.py # 114 doctests failed
	sage -t  devel/sage-main/sage/combinat/e_one_star.py # 6 doctests failed
	sage -t  devel/sage-main/sage/combinat/skew_tableau.py # 6 doctests failed
	sage -t  devel/sage-main/sage/combinat/tableau.py # 7 doctests failed
	sage -t  devel/sage-main/sage/categories/rings.py # 1 doctests failed
	sage -t  devel/sage-main/sage/categories/primer.py # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/suffix_trees.py # 45 doctests failed
	sage -t  devel/sage-main/sage/graphs/digraph_generators.py # 1 doctests failed
	sage -t  devel/sage-main/sage/combinat/ribbon.py # 6 doctests failed
	sage -t  devel/sage-main/sage/combinat/iet/reduced.py # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/free_module.py # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/word_generators.py # Time out
	sage -t  devel/sage-main/sage/combinat/sf/ns_macdonald.py # 1 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/morphism.py # Time out
	sage -t  devel/sage-main/sage/categories/algebras.py # 6 doctests failed
	sage -t  devel/sage-main/sage/categories/sets_cat.py # 1 doctests failed
	sage -t  devel/sage-main/sage/sets/integer_range.py # 1 doctests failed
	sage -t  devel/sage-main/sage/sets/finite_set_maps.py # 7 doctests failed
	sage -t  devel/sage-main/sage/combinat/iet/template.py # 3 doctests failed
	sage -t  devel/sage-main/sage/categories/algebras_with_basis.py # 38 doctests failed
	sage -t  devel/sage-main/sage/categories/examples/algebras_with_basis.py # 5 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/word_infinite_datatypes.py # 194 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/word_options.py # 6 doctests failed
	sage -t  devel/sage-main/sage/sets/finite_set_map_cy.pyx # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/iet/constructors.py # 3 doctests failed
	sage -t  devel/sage-main/sage/combinat/debruijn_sequence.pyx # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/word_datatypes.pyx # 29 doctests failed
	sage -t  devel/sage-main/sage/sets/disjoint_set.pyx # 2 doctests failed
	sage -t  devel/sage-main/sage/combinat/lyndon_word.py # 23 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/infinite_word.py # 14 doctests failed
	sage -t  devel/sage-main/sage/combinat/iet/labelled.py # 20 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/abstract_word.py # 220 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/shuffle_product.py # 16 doctests failed
	sage -t  devel/sage-main/sage/combinat/ribbon_tableau.py # 1 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/word.py # 97 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/words.py # 207 doctests failed
	sage -t  devel/sage-main/sage/categories/modules_with_basis.py # 3 doctests failed
	sage -t  devel/sage-main/sage/combinat/words/alphabet.py # Time out
----------------------------------------------------------------------
Timings have been updated.
Total time for all tests: 2331.8 seconds
```

For what reason each of these tests are failing? If it is because of a string repr that changed, this should be reverted and postpone in another ticket. If it is some hidden method starting with an underscore that was change : ok. If some result of `type(something)` changed because the class name has changed : ok. But if it is a normal method, it should still work after the ticket.



---

archive/issue_comments_171835.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-23T00:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171835",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_171836.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-01-23T00:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171836",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_171837.json:
```json
{
    "body": "Changing work_issues from \"\" to \"pickling, doctests errors, revert changes on repr, ...\"",
    "created_at": "2013-01-23T00:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171837",
    "user": "https://github.com/seblabbe"
}
```

Changing work_issues from "" to "pickling, doctests errors, revert changes on repr, ..."



---

archive/issue_comments_171838.json:
```json
{
    "body": "Changing reviewer from \"\" to \"S\u00e9bastien Labb\u00e9\"",
    "created_at": "2013-01-23T00:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171838",
    "user": "https://github.com/seblabbe"
}
```

Changing reviewer from "" to "Sébastien Labbé"



---

archive/issue_comments_171839.json:
```json
{
    "body": "<a id='comment:23'></a>\nI just reorganized my comments which were all mixed up. See [Comment 10](#comment%3A10) for an up to date summary.",
    "created_at": "2013-01-29T21:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171839",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:23'></a>
I just reorganized my comments which were all mixed up. See [Comment 10](#comment%3A10) for an up to date summary.



---

archive/issue_events_032570.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32570"
}
```



---

archive/issue_events_032571.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32571"
}
```



---

archive/issue_events_032572.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32572"
}
```



---

archive/issue_events_032573.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32573"
}
```



---

archive/issue_events_032574.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32574"
}
```



---

archive/issue_events_032575.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32575"
}
```



---

archive/issue_events_032576.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32576"
}
```



---

archive/issue_comments_171840.json:
```json
{
    "body": "<a id='comment:30'></a>\nVincent, should we close this ticket as \"won't fix\" since some of the issue was dealt partly in several disjoint other tickets (done or still to be done)?",
    "created_at": "2018-12-12T19:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171840",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:30'></a>
Vincent, should we close this ticket as "won't fix" since some of the issue was dealt partly in several disjoint other tickets (done or still to be done)?



---

archive/issue_comments_171841.json:
```json
{
    "body": "<a id='comment:31'></a>\n`Word`/`FiniteWord` does not inherits from `Element`/`Parent`. Why would you want to close this ticket? Where has this problem been dealt with?",
    "created_at": "2018-12-13T10:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171841",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>
`Word`/`FiniteWord` does not inherits from `Element`/`Parent`. Why would you want to close this ticket? Where has this problem been dealt with?



---

archive/issue_comments_171842.json:
```json
{
    "body": "<a id='comment:32'></a>\nI would suggest to start over in a new ticket, or alternatively, can you please update the description of this ticket to the goal you see it has?",
    "created_at": "2018-12-13T13:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171842",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:32'></a>
I would suggest to start over in a new ticket, or alternatively, can you please update the description of this ticket to the goal you see it has?



---

archive/issue_comments_171843.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,10 +9,12 @@\n \n The previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.\n \n+- #12225 : finite and lazy languages\n+- #12227 : adic languages\n \n-see also: #12225, #12227\n+---\n \n-To import and apply all patches do\n+Old pre-git instructions to import the code. To import and apply all patches do\n \n ```\n cd SAGE_ROOT/devel/YOUR_BRANCH\n``````\n",
    "created_at": "2021-11-18T10:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171843",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,10 +9,12 @@
 
 The previous code of Word is dispatched between the ElementMethods of the category and the Cython class FiniteWord. The choice has been made for sake of optimization.
 
+- #12225 : finite and lazy languages
+- #12227 : adic languages
 
-see also: #12225, #12227
+---
 
-To import and apply all patches do
+Old pre-git instructions to import the code. To import and apply all patches do
 
 ```
 cd SAGE_ROOT/devel/YOUR_BRANCH
``````




---

archive/issue_events_032577.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-11-18T10:20:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32577"
}
```



---

archive/issue_comments_171844.json:
```json
{
    "body": "Description changed:\n``````diff\n\n``````\n",
    "created_at": "2021-11-18T10:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12224#issuecomment-171844",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff

``````




---

archive/issue_events_032578.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-05-14T16:34:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12224",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12224#event-32578"
}
```
