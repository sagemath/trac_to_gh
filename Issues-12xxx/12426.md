# Issue 12426: Make Sage build with clang (3.7+) and make it the default on OS X

archive/issues_012254.json:
```json
{
    "body": "Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.\n\n---\n\nPackages failing their tests\n* `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang fixed by #24174\n* `ccache` #22836\n\n---\n\nSupporting clang not only on OSX:\n\n* porting to clang/FreeBSD -- #22679\n\nDepends on #24579\n\n**Assignee:** GeorgSWeber\n\n**CC:**  @nexttime jpflori @dimpase @mkoeppe @isuruf\n\n**Keywords:** clang  porting\n\n**Branch:** [ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)\n\n**Reviewer:** Jeroen Demeyer, John Palmieri, Dima Pasechnik\n\n**Author:** Fran\u00e7ois Bissey\n\nIssue created by migration from https://trac.sagemath.org/ticket/12426\n\n",
    "closed_at": "2018-02-01T19:13:35Z",
    "created_at": "2012-02-04T16:58:12Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "title": "Make Sage build with clang (3.7+) and make it the default on OS X",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/12426",
    "user": "https://github.com/ohanar"
}
```
Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.

---

Packages failing their tests
* `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang fixed by #24174
* `ccache` #22836

---

Supporting clang not only on OSX:

* porting to clang/FreeBSD -- #22679

Depends on #24579

**Assignee:** GeorgSWeber

**CC:**  @nexttime jpflori @dimpase @mkoeppe @isuruf

**Keywords:** clang  porting

**Branch:** [ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)

**Reviewer:** Jeroen Demeyer, John Palmieri, Dima Pasechnik

**Author:** Fran√ßois Bissey

Issue created by migration from https://trac.sagemath.org/ticket/12426





---

archive/issue_comments_138507.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,27 @@\n It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.\n+\n+Spkgs needing fixing:\n+* atlas\n+* eclib\n+* ecm\n+* f2c -- #12427\n+* flint -- #12429\n+* flintqs -- #12428\n+* gap\n+* gfan -- #12440\n+* givaro\n+* lcal -- #12435, #12436, #12437\n+* libfplll\n+* libm4riec\n+* linbox\n+* matplotlib -- #12434\n+* palp -- #12431\n+* polybori\n+* pynac\n+* python -- #12430\n+* ratpoints\n+* sage\n+* singular\n+* symmetrica -- #12439\n+* zlib -- #12432\n+* zn_poly -- #12433\n``````\n",
    "created_at": "2012-02-04T19:32:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138507",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,27 @@
 It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.
+
+Spkgs needing fixing:
+* atlas
+* eclib
+* ecm
+* f2c -- #12427
+* flint -- #12429
+* flintqs -- #12428
+* gap
+* gfan -- #12440
+* givaro
+* lcal -- #12435, #12436, #12437
+* libfplll
+* libm4riec
+* linbox
+* matplotlib -- #12434
+* palp -- #12431
+* polybori
+* pynac
+* python -- #12430
+* ratpoints
+* sage
+* singular
+* symmetrica -- #12439
+* zlib -- #12432
+* zn_poly -- #12433
``````




---

archive/issue_comments_138508.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,9 +10,9 @@\n * gap\n * gfan -- #12440\n * givaro\n-* lcal -- #12435, #12436, #12437\n+* lcalc -- #12435, #12436, #12437\n * libfplll\n-* libm4riec\n+* libm4rie\n * linbox\n * matplotlib -- #12434\n * palp -- #12431\n``````\n",
    "created_at": "2012-02-04T19:57:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138508",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,9 +10,9 @@
 * gap
 * gfan -- #12440
 * givaro
-* lcal -- #12435, #12436, #12437
+* lcalc -- #12435, #12436, #12437
 * libfplll
-* libm4riec
+* libm4rie
 * linbox
 * matplotlib -- #12434
 * palp -- #12431
``````




---

archive/issue_comments_138509.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,7 +21,7 @@\n * python -- #12430\n * ratpoints\n * sage\n-* singular\n+* singular -- #12441, #12442\n * symmetrica -- #12439\n * zlib -- #12432\n * zn_poly -- #12433\n``````\n",
    "created_at": "2012-02-04T20:18:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138509",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,7 +21,7 @@
 * python -- #12430
 * ratpoints
 * sage
-* singular
+* singular -- #12441, #12442
 * symmetrica -- #12439
 * zlib -- #12432
 * zn_poly -- #12433
``````




---

archive/issue_comments_138510.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,7 +20,7 @@\n * pynac\n * python -- #12430\n * ratpoints\n-* sage\n+* sage -- #12443\n * singular -- #12441, #12442\n * symmetrica -- #12439\n * zlib -- #12432\n``````\n",
    "created_at": "2012-02-04T20:49:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138510",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,7 +20,7 @@
 * pynac
 * python -- #12430
 * ratpoints
-* sage
+* sage -- #12443
 * singular -- #12441, #12442
 * symmetrica -- #12439
 * zlib -- #12432
``````




---

archive/issue_comments_138511.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,22 +4,24 @@\n * atlas\n * eclib\n * ecm\n+* gap\n+* libfplll\n+* libm4rie\n+* linbox\n+* polybori\n+* pynac\n+* ratpoints\n+\n+Needing review:\n * f2c -- #12427\n * flint -- #12429\n * flintqs -- #12428\n-* gap\n * gfan -- #12440\n-* givaro\n+* givaro -- #12444\n * lcalc -- #12435, #12436, #12437\n-* libfplll\n-* libm4rie\n-* linbox\n * matplotlib -- #12434\n * palp -- #12431\n-* polybori\n-* pynac\n * python -- #12430\n-* ratpoints\n * sage -- #12443\n * singular -- #12441, #12442\n * symmetrica -- #12439\n``````\n",
    "created_at": "2012-02-04T21:09:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138511",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,22 +4,24 @@
 * atlas
 * eclib
 * ecm
+* gap
+* libfplll
+* libm4rie
+* linbox
+* polybori
+* pynac
+* ratpoints
+
+Needing review:
 * f2c -- #12427
 * flint -- #12429
 * flintqs -- #12428
-* gap
 * gfan -- #12440
-* givaro
+* givaro -- #12444
 * lcalc -- #12435, #12436, #12437
-* libfplll
-* libm4rie
-* linbox
 * matplotlib -- #12434
 * palp -- #12431
-* polybori
-* pynac
 * python -- #12430
-* ratpoints
 * sage -- #12443
 * singular -- #12441, #12442
 * symmetrica -- #12439
``````




---

archive/issue_comments_138512.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,6 +6,7 @@\n * ecm\n * gap\n * libfplll\n+* libgcrypt\n * libm4rie\n * linbox\n * polybori\n``````\n",
    "created_at": "2012-02-04T21:32:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138512",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,6 +6,7 @@
 * ecm
 * gap
 * libfplll
+* libgcrypt
 * libm4rie
 * linbox
 * polybori
``````




---

archive/issue_comments_138513.json:
```json
{
    "body": "<a id='comment:7'></a>\nI guess many of these tickets are useful for porting in general.",
    "created_at": "2012-02-06T16:05:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138513",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I guess many of these tickets are useful for porting in general.



---

archive/issue_comments_138514.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,19 +1,18 @@\n It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.\n \n Spkgs needing fixing:\n-* atlas\n-* eclib\n-* ecm\n-* gap\n+* atlas -- probably impossible without Clint's help\n+* eclib -- builds, but completely broken, no clue why\n+* gap -- #7041\n * libfplll\n-* libgcrypt\n-* libm4rie\n+* libgcrypt -- easy fix, but probably gone soon\n * linbox\n * polybori\n * pynac\n-* ratpoints\n+* ratpoints -- #12473\n \n Needing review:\n+* ecm -- #12472\n * f2c -- #12427\n * flint -- #12429\n * flintqs -- #12428\n``````\n",
    "created_at": "2012-02-08T16:03:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138514",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,19 +1,18 @@
 It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.
 
 Spkgs needing fixing:
-* atlas
-* eclib
-* ecm
-* gap
+* atlas -- probably impossible without Clint's help
+* eclib -- builds, but completely broken, no clue why
+* gap -- #7041
 * libfplll
-* libgcrypt
-* libm4rie
+* libgcrypt -- easy fix, but probably gone soon
 * linbox
 * polybori
 * pynac
-* ratpoints
+* ratpoints -- #12473
 
 Needing review:
+* ecm -- #12472
 * f2c -- #12427
 * flint -- #12429
 * flintqs -- #12428
``````




---

archive/issue_comments_138515.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,12 +9,12 @@\n * linbox\n * polybori\n * pynac\n-* ratpoints -- #12473\n+* ratpoints -- #7038, #12473\n \n Needing review:\n * ecm -- #12472\n-* f2c -- #12427\n-* flint -- #12429\n+* f2c -- #7027\n+* flint -- #7024\n * flintqs -- #12428\n * gfan -- #12440\n * givaro -- #12444\n``````\n",
    "created_at": "2012-02-09T14:41:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138515",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,12 +9,12 @@
 * linbox
 * polybori
 * pynac
-* ratpoints -- #12473
+* ratpoints -- #7038, #12473
 
 Needing review:
 * ecm -- #12472
-* f2c -- #12427
-* flint -- #12429
+* f2c -- #7027
+* flint -- #7024
 * flintqs -- #12428
 * gfan -- #12440
 * givaro -- #12444
``````




---

archive/issue_comments_138516.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,7 +20,7 @@\n * givaro -- #12444\n * lcalc -- #12435, #12436, #12437\n * matplotlib -- #12434\n-* palp -- #12431\n+* palp -- #7071\n * python -- #12430\n * sage -- #12443\n * singular -- #12441, #12442\n``````\n",
    "created_at": "2012-02-09T14:55:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138516",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,7 +20,7 @@
 * givaro -- #12444
 * lcalc -- #12435, #12436, #12437
 * matplotlib -- #12434
-* palp -- #12431
+* palp -- #7071
 * python -- #12430
 * sage -- #12443
 * singular -- #12441, #12442
``````




---

archive/issue_comments_138517.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.\n+It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n \n Spkgs needing fixing:\n * atlas -- probably impossible without Clint's help\n@@ -9,21 +9,21 @@\n * linbox\n * polybori\n * pynac\n-* ratpoints -- #7038, #12473\n+* ratpoints -- #12682, #12473\n \n Needing review:\n * ecm -- #12472\n-* f2c -- #7027\n-* flint -- #7024\n-* flintqs -- #12428\n+* f2c -- #7027; package will be removed soon, see #12714\n+* flint -- #7024; the issue is fixed in FLINT >= 1.5.2\n+* flintqs -- #12428; package should be removed anyway, since FLINT includes a more recent version\n * gfan -- #12440\n * givaro -- #12444\n-* lcalc -- #12435, #12436, #12437\n+* lcalc -- #12681, #12436, #12437\n * matplotlib -- #12434\n * palp -- #7071\n * python -- #12430\n * sage -- #12443\n-* singular -- #12441, #12442\n+* singular -- #12680, #12442\n * symmetrica -- #12439\n * zlib -- #12432\n * zn_poly -- #12433\n``````\n",
    "created_at": "2012-03-22T13:46:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138517",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-It is not unlikely that apple will eventually stop supporting gcc in favour of clang. This is a metaticket to track the status of building sage with clang.
+It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
 
 Spkgs needing fixing:
 * atlas -- probably impossible without Clint's help
@@ -9,21 +9,21 @@
 * linbox
 * polybori
 * pynac
-* ratpoints -- #7038, #12473
+* ratpoints -- #12682, #12473
 
 Needing review:
 * ecm -- #12472
-* f2c -- #7027
-* flint -- #7024
-* flintqs -- #12428
+* f2c -- #7027; package will be removed soon, see #12714
+* flint -- #7024; the issue is fixed in FLINT >= 1.5.2
+* flintqs -- #12428; package should be removed anyway, since FLINT includes a more recent version
 * gfan -- #12440
 * givaro -- #12444
-* lcalc -- #12435, #12436, #12437
+* lcalc -- #12681, #12436, #12437
 * matplotlib -- #12434
 * palp -- #7071
 * python -- #12430
 * sage -- #12443
-* singular -- #12441, #12442
+* singular -- #12680, #12442
 * symmetrica -- #12439
 * zlib -- #12432
 * zn_poly -- #12433
``````




---

archive/issue_comments_138518.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,29 +1,30 @@\n It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n \n Spkgs needing fixing:\n-* atlas -- probably impossible without Clint's help\n+* ATLAS -- probably impossible without Clint's help\n * eclib -- builds, but completely broken, no clue why\n-* gap -- #7041\n+* GAP -- #7041\n * libfplll\n * libgcrypt -- easy fix, but probably gone soon\n-* linbox\n-* polybori\n+* LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)\n+* PolyBoRi; probably fixed by #12750 / #12754 / #12655\n * pynac\n * ratpoints -- #12682, #12473\n \n Needing review:\n-* ecm -- #12472\n+* GMP-ECM -- #12472\n * f2c -- #7027; package will be removed soon, see #12714\n-* flint -- #7024; the issue is fixed in FLINT >= 1.5.2\n-* flintqs -- #12428; package should be removed anyway, since FLINT includes a more recent version\n-* gfan -- #12440\n-* givaro -- #12444\n-* lcalc -- #12681, #12436, #12437\n+* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2\n+* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version\n+* Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)\n+* Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)\n+* Lcalc -- #12681, #12436, #12437\n * matplotlib -- #12434\n * palp -- #7071\n-* python -- #12430\n-* sage -- #12443\n-* singular -- #12680, #12442\n-* symmetrica -- #12439\n+* Python -- #12430\n+* Sage -- #12443\n+* Singular -- #12680, #12442\n+* Symmetrica -- #12439\n * zlib -- #12432\n * zn_poly -- #12433\n+\n``````\n",
    "created_at": "2012-04-08T03:28:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138518",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,29 +1,30 @@
 It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
 
 Spkgs needing fixing:
-* atlas -- probably impossible without Clint's help
+* ATLAS -- probably impossible without Clint's help
 * eclib -- builds, but completely broken, no clue why
-* gap -- #7041
+* GAP -- #7041
 * libfplll
 * libgcrypt -- easy fix, but probably gone soon
-* linbox
-* polybori
+* LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)
+* PolyBoRi; probably fixed by #12750 / #12754 / #12655
 * pynac
 * ratpoints -- #12682, #12473
 
 Needing review:
-* ecm -- #12472
+* GMP-ECM -- #12472
 * f2c -- #7027; package will be removed soon, see #12714
-* flint -- #7024; the issue is fixed in FLINT >= 1.5.2
-* flintqs -- #12428; package should be removed anyway, since FLINT includes a more recent version
-* gfan -- #12440
-* givaro -- #12444
-* lcalc -- #12681, #12436, #12437
+* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2
+* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version
+* Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)
+* Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)
+* Lcalc -- #12681, #12436, #12437
 * matplotlib -- #12434
 * palp -- #7071
-* python -- #12430
-* sage -- #12443
-* singular -- #12680, #12442
-* symmetrica -- #12439
+* Python -- #12430
+* Sage -- #12443
+* Singular -- #12680, #12442
+* Symmetrica -- #12439
 * zlib -- #12432
 * zn_poly -- #12433
+
``````




---

archive/issue_comments_138519.json:
```json
{
    "body": "**Changing keywords** from \"clang\" to \"clang C++11 porting\".",
    "created_at": "2012-04-08T03:28:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138519",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "clang" to "clang C++11 porting".



---

archive/issue_comments_138520.json:
```json
{
    "body": "<a id='comment:13'></a>\nAdded further ticket references.",
    "created_at": "2012-04-08T03:28:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138520",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Added further ticket references.



---

archive/issue_comments_138521.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -28,3 +28,7 @@\n * zlib -- #12432\n * zn_poly -- #12433\n \n+---\n+\n+Probably related:  #14676\n+\n``````\n",
    "created_at": "2013-06-03T10:22:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138521",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -28,3 +28,7 @@
 * zlib -- #12432
 * zn_poly -- #12433
 
+---
+
+Probably related:  #14676
+
``````




---

archive/issue_comments_138522.json:
```json
{
    "body": "<a id='comment:15'></a>\nDescription presumably needs some updating...",
    "created_at": "2013-06-03T10:22:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138522",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>
Description presumably needs some updating...



---

archive/issue_events_101941.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2013-06-03T10:22:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "rename": {
        "from": "make sage build with clang (3.0+)",
        "to": "Make Sage build with clang (3.0+)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101941"
}
```



---

archive/issue_comments_138523.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n * libfplll\n * libgcrypt -- easy fix, but probably gone soon\n * LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)\n+* MPIR: #13948\n * PolyBoRi; probably fixed by #12750 / #12754 / #12655\n * pynac\n * ratpoints -- #12682, #12473\n``````\n",
    "created_at": "2013-06-03T10:26:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138523",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 * libfplll
 * libgcrypt -- easy fix, but probably gone soon
 * LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)
+* MPIR: #13948
 * PolyBoRi; probably fixed by #12750 / #12754 / #12655
 * pynac
 * ratpoints -- #12682, #12473
``````




---

archive/issue_comments_138524.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,33 +1,34 @@\n It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n \n-Spkgs needing fixing:\n+---\n+\n+Packages failing to build with Clang:\n+\n+* matplotlib -- #12434\n+* MPIR: #13948\n+* ratpoints -- #12682, #12473\n+\n * ATLAS -- probably impossible without Clint's help\n * eclib -- builds, but completely broken, no clue why\n * GAP -- #7041\n * libfplll\n-* libgcrypt -- easy fix, but probably gone soon\n * LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)\n-* MPIR: #13948\n * PolyBoRi; probably fixed by #12750 / #12754 / #12655\n * pynac\n-* ratpoints -- #12682, #12473\n-\n-Needing review:\n * GMP-ECM -- #12472\n-* f2c -- #7027; package will be removed soon, see #12714\n-* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2\n-* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version\n * Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)\n * Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)\n * Lcalc -- #12681, #12436, #12437\n-* matplotlib -- #12434\n-* palp -- #7071\n-* Python -- #12430\n-* Sage -- #12443\n * Singular -- #12680, #12442\n * Symmetrica -- #12439\n-* zlib -- #12432\n-* zn_poly -- #12433\n+\n+---\n+\n+Spkgs ignoring CC/CXX environment variables:\n+\n+* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2\n+* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version\n+* Sage -- #12443\n \n ---\n \n``````\n",
    "created_at": "2013-06-03T10:31:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138524",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,33 +1,34 @@
 It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
 
-Spkgs needing fixing:
+---
+
+Packages failing to build with Clang:
+
+* matplotlib -- #12434
+* MPIR: #13948
+* ratpoints -- #12682, #12473
+
 * ATLAS -- probably impossible without Clint's help
 * eclib -- builds, but completely broken, no clue why
 * GAP -- #7041
 * libfplll
-* libgcrypt -- easy fix, but probably gone soon
 * LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)
-* MPIR: #13948
 * PolyBoRi; probably fixed by #12750 / #12754 / #12655
 * pynac
-* ratpoints -- #12682, #12473
-
-Needing review:
 * GMP-ECM -- #12472
-* f2c -- #7027; package will be removed soon, see #12714
-* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2
-* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version
 * Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)
 * Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)
 * Lcalc -- #12681, #12436, #12437
-* matplotlib -- #12434
-* palp -- #7071
-* Python -- #12430
-* Sage -- #12443
 * Singular -- #12680, #12442
 * Symmetrica -- #12439
-* zlib -- #12432
-* zn_poly -- #12433
+
+---
+
+Spkgs ignoring CC/CXX environment variables:
+
+* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2
+* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version
+* Sage -- #12443
 
 ---
 
``````




---

archive/issue_comments_138525.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,22 +4,19 @@\n \n Packages failing to build with Clang:\n \n+* ATLAS -- probably impossible without Clint's help\n+* eclib -- builds, but completely broken, no clue why\n+* libfplll\n+* LinBox\n+* pynac\n+* GMP-ECM -- #12472\n+* Gfan -- #12440\n+* Givaro -- #12444\n+* Lcalc -- #12436, #12437\n * matplotlib -- #12434\n * MPIR: #13948\n * ratpoints -- #12682, #12473\n-\n-* ATLAS -- probably impossible without Clint's help\n-* eclib -- builds, but completely broken, no clue why\n-* GAP -- #7041\n-* libfplll\n-* LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)\n-* PolyBoRi; probably fixed by #12750 / #12754 / #12655\n-* pynac\n-* GMP-ECM -- #12472\n-* Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)\n-* Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)\n-* Lcalc -- #12681, #12436, #12437\n-* Singular -- #12680, #12442\n+* Singular -- #12442\n * Symmetrica -- #12439\n \n ---\n``````\n",
    "created_at": "2013-06-03T10:33:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138525",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,22 +4,19 @@
 
 Packages failing to build with Clang:
 
+* ATLAS -- probably impossible without Clint's help
+* eclib -- builds, but completely broken, no clue why
+* libfplll
+* LinBox
+* pynac
+* GMP-ECM -- #12472
+* Gfan -- #12440
+* Givaro -- #12444
+* Lcalc -- #12436, #12437
 * matplotlib -- #12434
 * MPIR: #13948
 * ratpoints -- #12682, #12473
-
-* ATLAS -- probably impossible without Clint's help
-* eclib -- builds, but completely broken, no clue why
-* GAP -- #7041
-* libfplll
-* LinBox; related: #12762 (doesn't build with GCC 4.7.0 because code doesn't conform to C++11)
-* PolyBoRi; probably fixed by #12750 / #12754 / #12655
-* pynac
-* GMP-ECM -- #12472
-* Gfan -- #12440; see also #12760 (doesn't build with GCC 4.7.0 / conform to C++11)
-* Givaro -- #12444; see also #12761 (doesn't build with GCC 4.7.0 / conform to C++11)
-* Lcalc -- #12681, #12436, #12437
-* Singular -- #12680, #12442
+* Singular -- #12442
 * Symmetrica -- #12439
 
 ---
``````




---

archive/issue_comments_138526.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,7 +15,7 @@\n * Lcalc -- #12436, #12437\n * matplotlib -- #12434\n * MPIR: #13948\n-* ratpoints -- #12682, #12473\n+* ratpoints -- #12473\n * Singular -- #12442\n * Symmetrica -- #12439\n \n``````\n",
    "created_at": "2013-06-03T10:33:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138526",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,7 +15,7 @@
 * Lcalc -- #12436, #12437
 * matplotlib -- #12434
 * MPIR: #13948
-* ratpoints -- #12682, #12473
+* ratpoints -- #12473
 * Singular -- #12442
 * Symmetrica -- #12439
 
``````




---

archive/issue_comments_138527.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n Packages failing to build with Clang:\n \n-* ATLAS -- probably impossible without Clint's help\n+* ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n * eclib -- builds, but completely broken, no clue why\n * libfplll\n * LinBox\n``````\n",
    "created_at": "2013-06-03T14:03:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138527",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 Packages failing to build with Clang:
 
-* ATLAS -- probably impossible without Clint's help
+* ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
 * eclib -- builds, but completely broken, no clue why
 * libfplll
 * LinBox
``````




---

archive/issue_comments_138528.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,7 +11,6 @@\n * pynac\n * GMP-ECM -- #12472\n * Gfan -- #12440\n-* Givaro -- #12444\n * Lcalc -- #12436, #12437\n * matplotlib -- #12434\n * MPIR: #13948\n``````\n",
    "created_at": "2013-06-03T14:42:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138528",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,7 +11,6 @@
 * pynac
 * GMP-ECM -- #12472
 * Gfan -- #12440
-* Givaro -- #12444
 * Lcalc -- #12436, #12437
 * matplotlib -- #12434
 * MPIR: #13948
``````




---

archive/issue_comments_138529.json:
```json
{
    "body": "<a id='comment:22'></a>\neclib has been fixed upstream last year (IIRC) as well; currently re-checking whether *our current version* still builds...",
    "created_at": "2013-06-03T14:51:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138529",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>
eclib has been fixed upstream last year (IIRC) as well; currently re-checking whether *our current version* still builds...



---

archive/issue_comments_138530.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n \n * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n * eclib -- builds, but completely broken, no clue why\n-* libfplll\n+* libfplll -- fixed by #12835\n * LinBox\n * pynac\n * GMP-ECM -- #12472\n``````\n",
    "created_at": "2013-06-03T15:35:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138530",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,7 +6,7 @@
 
 * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
 * eclib -- builds, but completely broken, no clue why
-* libfplll
+* libfplll -- fixed by #12835
 * LinBox
 * pynac
 * GMP-ECM -- #12472
``````




---

archive/issue_comments_138531.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n * eclib -- builds, but completely broken, no clue why\n * libfplll -- fixed by #12835\n-* LinBox\n+* LinBox -- assignment to `const` variable\n * pynac\n * GMP-ECM -- #12472\n * Gfan -- #12440\n``````\n",
    "created_at": "2013-06-03T17:07:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138531",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
 * eclib -- builds, but completely broken, no clue why
 * libfplll -- fixed by #12835
-* LinBox
+* LinBox -- assignment to `const` variable
 * pynac
 * GMP-ECM -- #12472
 * Gfan -- #12440
``````




---

archive/issue_comments_138532.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,7 +13,8 @@\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n * matplotlib -- #12434\n-* MPIR: #13948\n+* MPIR -- #13948\n+* R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n * Singular -- #12442\n * Symmetrica -- #12439\n``````\n",
    "created_at": "2013-06-03T17:10:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138532",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,7 +13,8 @@
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
 * matplotlib -- #12434
-* MPIR: #13948
+* MPIR -- #13948
+* R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
 * Singular -- #12442
 * Symmetrica -- #12439
``````




---

archive/issue_comments_138533.json:
```json
{
    "body": "<a id='comment:26'></a>\nSo on Darwin at least, we'd still have to build `gfortran`... (i.e., GCC with only the Fortran frontend and `libgfortran`.)\n\nOr resort to f2c again... :-)",
    "created_at": "2013-06-03T17:53:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138533",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:26'></a>
So on Darwin at least, we'd still have to build `gfortran`... (i.e., GCC with only the Fortran frontend and `libgfortran`.)

Or resort to f2c again... :-)



---

archive/issue_comments_138534.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [leif](#comment%3A22):\n> eclib has been fixed upstream last year (IIRC) as well; currently re-checking whether *our current version* still builds...\n\n\n(Still) works for me, clang 3.2; `make check` (and some doctests) passed.",
    "created_at": "2013-06-03T20:39:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138534",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>
Replying to [leif](#comment%3A22):
> eclib has been fixed upstream last year (IIRC) as well; currently re-checking whether *our current version* still builds...


(Still) works for me, clang 3.2; `make check` (and some doctests) passed.



---

archive/issue_comments_138535.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,11 +5,10 @@\n Packages failing to build with Clang:\n \n * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n-* eclib -- builds, but completely broken, no clue why\n * libfplll -- fixed by #12835\n * LinBox -- assignment to `const` variable\n * pynac\n-* GMP-ECM -- #12472\n+* GMP-ECM -- #12472 (seems to meanwhile work -- GMP-ECM 6.4.4, clang 3.2, **with** asm redc)\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n * matplotlib -- #12434\n``````\n",
    "created_at": "2013-06-03T20:39:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138535",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,11 +5,10 @@
 Packages failing to build with Clang:
 
 * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
-* eclib -- builds, but completely broken, no clue why
 * libfplll -- fixed by #12835
 * LinBox -- assignment to `const` variable
 * pynac
-* GMP-ECM -- #12472
+* GMP-ECM -- #12472 (seems to meanwhile work -- GMP-ECM 6.4.4, clang 3.2, **with** asm redc)
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
 * matplotlib -- #12434
``````




---

archive/issue_comments_138536.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,11 +7,9 @@\n * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n * libfplll -- fixed by #12835\n * LinBox -- assignment to `const` variable\n-* pynac\n-* GMP-ECM -- #12472 (seems to meanwhile work -- GMP-ECM 6.4.4, clang 3.2, **with** asm redc)\n+* pynac -- C++ template problem\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n-* matplotlib -- #12434\n * MPIR -- #13948\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n``````\n",
    "created_at": "2013-06-04T09:56:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138536",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,11 +7,9 @@
 * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
 * libfplll -- fixed by #12835
 * LinBox -- assignment to `const` variable
-* pynac
-* GMP-ECM -- #12472 (seems to meanwhile work -- GMP-ECM 6.4.4, clang 3.2, **with** asm redc)
+* pynac -- C++ template problem
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
-* matplotlib -- #12434
 * MPIR -- #13948
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
``````




---

archive/issue_comments_138537.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n \n * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n * libfplll -- fixed by #12835\n-* LinBox -- assignment to `const` variable\n+* Givaro -- causes build failure for LinBox: assignment to `const` variable\n * pynac -- C++ template problem\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n``````\n",
    "created_at": "2013-06-04T10:04:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138537",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,7 +6,7 @@
 
 * ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
 * libfplll -- fixed by #12835
-* LinBox -- assignment to `const` variable
+* Givaro -- causes build failure for LinBox: assignment to `const` variable
 * pynac -- C++ template problem
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
``````




---

archive/issue_comments_138538.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,6 +10,7 @@\n * pynac -- C++ template problem\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n+* LinBox -- C++ problem\n * MPIR -- #13948\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n``````\n",
    "created_at": "2013-06-04T10:08:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138538",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,6 +10,7 @@
 * pynac -- C++ template problem
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
+* LinBox -- C++ problem
 * MPIR -- #13948
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
``````




---

archive/issue_comments_138539.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,7 +11,7 @@\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n * LinBox -- C++ problem\n-* MPIR -- #13948\n+* MPIR -- #13948 (**of particular importance since it's needed to build GCC**)\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n * Singular -- #12442\n``````\n",
    "created_at": "2013-06-10T08:21:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138539",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,7 +11,7 @@
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
 * LinBox -- C++ problem
-* MPIR -- #13948
+* MPIR -- #13948 (**of particular importance since it's needed to build GCC**)
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
 * Singular -- #12442
``````




---

archive/issue_comments_138540.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n Packages failing to build with Clang:\n \n-* ATLAS -- probably impossible without Clint's help, but might be a configure-only problem\n+* ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n * libfplll -- fixed by #12835\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n * pynac -- C++ template problem\n@@ -22,10 +22,9 @@\n Spkgs ignoring CC/CXX environment variables:\n \n * FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2\n-* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version\n+* FLINTQS -- #12428\n * Sage -- #12443\n \n ---\n \n-Probably related:  #14676\n-\n+Distantly related: #14676\n``````\n",
    "created_at": "2013-06-21T09:36:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138540",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 Packages failing to build with Clang:
 
-* ATLAS -- probably impossible without Clint's help, but might be a configure-only problem
+* ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
 * libfplll -- fixed by #12835
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
 * pynac -- C++ template problem
@@ -22,10 +22,9 @@
 Spkgs ignoring CC/CXX environment variables:
 
 * FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2
-* FLINTQS -- #12428; package should be removed anyway, since FLINT includes a more recent version
+* FLINTQS -- #12428
 * Sage -- #12443
 
 ---
 
-Probably related:  #14676
-
+Distantly related: #14676
``````




---

archive/issue_comments_138541.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,7 +5,6 @@\n Packages failing to build with Clang:\n \n * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n-* libfplll -- fixed by #12835\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n * pynac -- C++ template problem\n * Gfan -- #12440\n``````\n",
    "created_at": "2013-06-21T09:36:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138541",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,7 +5,6 @@
 Packages failing to build with Clang:
 
 * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
-* libfplll -- fixed by #12835
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
 * pynac -- C++ template problem
 * Gfan -- #12440
``````




---

archive/issue_events_101942.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101942"
}
```



---

archive/issue_events_101943.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101943"
}
```



---

archive/issue_comments_138542.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,7 +10,6 @@\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n * LinBox -- C++ problem\n-* MPIR -- #13948 (**of particular importance since it's needed to build GCC**)\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n * Singular -- #12442\n``````\n",
    "created_at": "2013-10-28T14:03:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138542",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,7 +10,6 @@
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
 * LinBox -- C++ problem
-* MPIR -- #13948 (**of particular importance since it's needed to build GCC**)
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
 * Singular -- #12442
``````




---

archive/issue_comments_138543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n+Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n \n ---\n \n``````\n",
    "created_at": "2013-11-23T10:32:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138543",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-It is not unlikely that Apple will eventually stop supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
+Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
 
 ---
 
``````




---

archive/issue_comments_138544.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -19,7 +19,6 @@\n \n Spkgs ignoring CC/CXX environment variables:\n \n-* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2\n * FLINTQS -- #12428\n * Sage -- #12443\n \n``````\n",
    "created_at": "2013-11-23T10:37:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138544",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -19,7 +19,6 @@
 
 Spkgs ignoring CC/CXX environment variables:
 
-* FLINT -- #7024; the issue is fixed in FLINT >= 1.5.2
 * FLINTQS -- #12428
 * Sage -- #12443
 
``````




---

archive/issue_events_101944.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101944"
}
```



---

archive/issue_events_101945.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101945"
}
```



---

archive/issue_comments_138545.json:
```json
{
    "body": "<a id='comment:39'></a>\nI think the upcoming GCC 4.9 will help us with Clang as well... ;-)",
    "created_at": "2014-04-21T10:52:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138545",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:39'></a>
I think the upcoming GCC 4.9 will help us with Clang as well... ;-)



---

archive/issue_events_101946.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101946"
}
```



---

archive/issue_events_101947.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101947"
}
```



---

archive/issue_comments_138546.json:
```json
{
    "body": "<a id='comment:41'></a>\nChecking current status with Sage 6.2 and clang 3.4.1 ...",
    "created_at": "2014-05-17T02:39:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138546",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:41'></a>
Checking current status with Sage 6.2 and clang 3.4.1 ...



---

archive/issue_comments_138547.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [leif](#comment%3A41):\n> Checking current status with Sage 6.2 and clang 3.4.1 ...\n\n\n```\n The following package(s) may have failed to build:\n \n package: atlas-3.10.1.20140210\n \n package: boehm_gc-7.2d.p0\n \n package: elliptic_curves-0.7\n \n package: gf2x-1.1.p0\n \n package: gfan-0.5.p0\n \n package: lcalc-1.23.p12\n \n package: libgap-4.7.4\n \n package: polybori-0.8.3\n \n package: pynac-0.3.2\n \n package: ratpoints-2.1.3.p3\n \n package: symmetrica-2.0.p9\n \n```\n\n[More to come.]",
    "created_at": "2014-05-17T02:46:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138547",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:42'></a>
Replying to [leif](#comment%3A41):
> Checking current status with Sage 6.2 and clang 3.4.1 ...


```
 The following package(s) may have failed to build:
 
 package: atlas-3.10.1.20140210
 
 package: boehm_gc-7.2d.p0
 
 package: elliptic_curves-0.7
 
 package: gf2x-1.1.p0
 
 package: gfan-0.5.p0
 
 package: lcalc-1.23.p12
 
 package: libgap-4.7.4
 
 package: polybori-0.8.3
 
 package: pynac-0.3.2
 
 package: ratpoints-2.1.3.p3
 
 package: symmetrica-2.0.p9
 
```

[More to come.]



---

archive/issue_comments_138548.json:
```json
{
    "body": "<a id='comment:43'></a>\nGoes on with\n\n```\npackage: eclib-20140128\n\npackage: linbox-1.3.2.p0\n\npackage: numpy-1.7.0\n\npackage: singular-3.1.6.p1\n```",
    "created_at": "2014-05-17T13:02:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138548",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:43'></a>
Goes on with

```
package: eclib-20140128

package: linbox-1.3.2.p0

package: numpy-1.7.0

package: singular-3.1.6.p1
```



---

archive/issue_comments_138549.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [leif](#comment%3A42):\n> \n> ```\n> package: elliptic_curves-0.7\n> ```\n\n\nNo idea what's going on there (`ImportError: No module named _sqlite3`); just recompiling `sqlite` with GCC doesn't help.",
    "created_at": "2014-05-17T13:33:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138549",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:44'></a>
Replying to [leif](#comment%3A42):
> 
> ```
> package: elliptic_curves-0.7
> ```


No idea what's going on there (`ImportError: No module named _sqlite3`); just recompiling `sqlite` with GCC doesn't help.



---

archive/issue_comments_138550.json:
```json
{
    "body": "<a id='comment:45'></a>\nMany of the hundreds of C++ errors are of the form\n\n```\nerror: friend declaration specifying a default argument must be the only declaration\nerror: friend declaration specifying a default argument must be a definition\n```",
    "created_at": "2014-05-17T13:40:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138550",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:45'></a>
Many of the hundreds of C++ errors are of the form

```
error: friend declaration specifying a default argument must be the only declaration
error: friend declaration specifying a default argument must be a definition
```



---

archive/issue_comments_138551.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [leif](#comment%3A44):\n> Replying to [leif](#comment%3A42):\n> > \n> > ```\n> > package: elliptic_curves-0.7\n> > ```\n\n> \n> No idea what's going on there (`ImportError: No module named _sqlite3`); just recompiling `sqlite` with GCC doesn't help.\n\n\nAh, that's a nice one:  Python fails to build the `_sqlite3` extension because of\n\n```\nclang: error: unknown argument: '-R/path/to/sage-6.2-clang-3.4.1/local/lib'\n```",
    "created_at": "2014-05-17T14:13:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138551",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:46'></a>
Replying to [leif](#comment%3A44):
> Replying to [leif](#comment%3A42):
> > 
> > ```
> > package: elliptic_curves-0.7
> > ```

> 
> No idea what's going on there (`ImportError: No module named _sqlite3`); just recompiling `sqlite` with GCC doesn't help.


Ah, that's a nice one:  Python fails to build the `_sqlite3` extension because of

```
clang: error: unknown argument: '-R/path/to/sage-6.2-clang-3.4.1/local/lib'
```



---

archive/issue_comments_138552.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,14 +2,18 @@\n \n ---\n \n-Packages failing to build with Clang:\n+Packages failing to build (or causing other packages to fail to build) with Clang:\n \n * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n+* eclib -- default parameters in `friend` declarations (?)\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n-* pynac -- C++ template problem\n+* gf2x -- uses GCC builtins clang doesn't support (apparently)\n * Gfan -- #12440\n * Lcalc -- #12436, #12437\n+* libGAP -- some preprocessor / macro weirdness?\n * LinBox -- C++ problem\n+* pynac -- C++ template problem\n+* Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n * Singular -- #12442\n``````\n",
    "created_at": "2014-05-17T15:59:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138552",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,14 +2,18 @@
 
 ---
 
-Packages failing to build with Clang:
+Packages failing to build (or causing other packages to fail to build) with Clang:
 
 * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
+* eclib -- default parameters in `friend` declarations (?)
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
-* pynac -- C++ template problem
+* gf2x -- uses GCC builtins clang doesn't support (apparently)
 * Gfan -- #12440
 * Lcalc -- #12436, #12437
+* libGAP -- some preprocessor / macro weirdness?
 * LinBox -- C++ problem
+* pynac -- C++ template problem
+* Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
 * Singular -- #12442
``````




---

archive/issue_comments_138553.json:
```json
{
    "body": "<a id='comment:48'></a>\nLinbox (without the errors caused by Givaro headers):\n\n```\n../../linbox/solutions/solve.h:314:9: error: no matching conversion for functional-style cast from 'const char [19]' to 'LinBox::LinBoxFailure'\n```",
    "created_at": "2014-05-17T17:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138553",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:48'></a>
Linbox (without the errors caused by Givaro headers):

```
../../linbox/solutions/solve.h:314:9: error: no matching conversion for functional-style cast from 'const char [19]' to 'LinBox::LinBoxFailure'
```



---

archive/issue_comments_138554.json:
```json
{
    "body": "<a id='comment:49'></a>\nNumPy fails to build due to (at least) various problems with `xmmintrin.h`.",
    "created_at": "2014-05-17T17:32:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138554",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:49'></a>
NumPy fails to build due to (at least) various problems with `xmmintrin.h`.



---

archive/issue_comments_138555.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,6 +12,7 @@\n * Lcalc -- #12436, #12437\n * libGAP -- some preprocessor / macro weirdness?\n * LinBox -- C++ problem\n+* NumPy -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)\n * pynac -- C++ template problem\n * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n``````\n",
    "created_at": "2014-05-17T17:32:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138555",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,6 +12,7 @@
 * Lcalc -- #12436, #12437
 * libGAP -- some preprocessor / macro weirdness?
 * LinBox -- C++ problem
+* NumPy -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)
 * pynac -- C++ template problem
 * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)
 * R -- problematic due to mixture of C and Fortran code
``````




---

archive/issue_comments_138556.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,11 +8,11 @@\n * eclib -- default parameters in `friend` declarations (?)\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n * gf2x -- uses GCC builtins clang doesn't support (apparently)\n-* Gfan -- #12440\n+* Gfan (0.5) -- #12440\n * Lcalc -- #12436, #12437\n * libGAP -- some preprocessor / macro weirdness?\n * LinBox -- C++ problem\n-* NumPy -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)\n+* NumPy (1.7.0) -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)\n * pynac -- C++ template problem\n * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n``````\n",
    "created_at": "2014-05-17T17:41:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138556",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,11 +8,11 @@
 * eclib -- default parameters in `friend` declarations (?)
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
 * gf2x -- uses GCC builtins clang doesn't support (apparently)
-* Gfan -- #12440
+* Gfan (0.5) -- #12440
 * Lcalc -- #12436, #12437
 * libGAP -- some preprocessor / macro weirdness?
 * LinBox -- C++ problem
-* NumPy -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)
+* NumPy (1.7.0) -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)
 * pynac -- C++ template problem
 * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)
 * R -- problematic due to mixture of C and Fortran code
``````




---

archive/issue_comments_138557.json:
```json
{
    "body": "<a id='comment:51'></a>\nOk, removed gf2x and NumPy again; this was my fault, as clang kept including the wrong `xmmintrin.h` header (i.e., GCC's instead of its own).",
    "created_at": "2014-05-17T18:43:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138557",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:51'></a>
Ok, removed gf2x and NumPy again; this was my fault, as clang kept including the wrong `xmmintrin.h` header (i.e., GCC's instead of its own).



---

archive/issue_comments_138558.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,12 +7,10 @@\n * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n * eclib -- default parameters in `friend` declarations (?)\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n-* gf2x -- uses GCC builtins clang doesn't support (apparently)\n * Gfan (0.5) -- #12440\n * Lcalc -- #12436, #12437\n * libGAP -- some preprocessor / macro weirdness?\n * LinBox -- C++ problem\n-* NumPy (1.7.0) -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)\n * pynac -- C++ template problem\n * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n``````\n",
    "created_at": "2014-05-17T18:43:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138558",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,12 +7,10 @@
 * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
 * eclib -- default parameters in `friend` declarations (?)
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
-* gf2x -- uses GCC builtins clang doesn't support (apparently)
 * Gfan (0.5) -- #12440
 * Lcalc -- #12436, #12437
 * libGAP -- some preprocessor / macro weirdness?
 * LinBox -- C++ problem
-* NumPy (1.7.0) -- various errors with (GCC's) `xmmintrin.h` (including unsupported builtins)
 * pynac -- C++ template problem
 * Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)
 * R -- problematic due to mixture of C and Fortran code
``````




---

archive/issue_comments_138559.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n * libGAP -- some preprocessor / macro weirdness?\n * LinBox -- C++ problem\n * pynac -- C++ template problem\n-* Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)\n+* Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n * ratpoints -- #12473\n * Singular -- #12442\n``````\n",
    "created_at": "2014-05-17T23:53:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138559",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 * libGAP -- some preprocessor / macro weirdness?
 * LinBox -- C++ problem
 * pynac -- C++ template problem
-* Python -- fails to build `_sqlite3` (uses `-R<path>` instead of `-Wl,-rpath,<path>`)
+* Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)
 * R -- problematic due to mixture of C and Fortran code
 * ratpoints -- #12473
 * Singular -- #12442
``````




---

archive/issue_comments_138560.json:
```json
{
    "body": "<a id='comment:52'></a>\nFor Python's distutils, a patch is attached to #16376 in order to not pass `-R` (but `-Wl,-R,...`) to clang, such that e.g. the `_sqlite3` module also builds with clang.",
    "created_at": "2014-05-17T23:53:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138560",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:52'></a>
For Python's distutils, a patch is attached to #16376 in order to not pass `-R` (but `-Wl,-R,...`) to clang, such that e.g. the `_sqlite3` module also builds with clang.



---

archive/issue_comments_138561.json:
```json
{
    "body": "<a id='comment:53'></a>\nBy the way, R 3.0.2 built for me with clang 3.4.1 without any problems (using gfortran 4.9.0).",
    "created_at": "2014-05-18T00:22:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138561",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:53'></a>
By the way, R 3.0.2 built for me with clang 3.4.1 without any problems (using gfortran 4.9.0).



---

archive/issue_comments_138562.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,7 +14,7 @@\n * pynac -- C++ template problem\n * Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)\n * R -- problematic due to mixture of C and Fortran code\n-* ratpoints -- #12473\n+* ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Singular -- #12442\n * Symmetrica -- #12439\n \n``````\n",
    "created_at": "2014-05-18T00:33:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138562",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,7 +14,7 @@
 * pynac -- C++ template problem
 * Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)
 * R -- problematic due to mixture of C and Fortran code
-* ratpoints -- #12473
+* ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Singular -- #12442
 * Symmetrica -- #12439
 
``````




---

archive/issue_events_101948.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101948"
}
```



---

archive/issue_events_101949.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101949"
}
```



---

archive/issue_comments_138563.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n Packages failing to build (or causing other packages to fail to build) with Clang:\n \n * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n-* eclib -- default parameters in `friend` declarations (?)\n+* eclib -- #16852 (default parameters in `friend` declarations)\n * Givaro -- causes build failure for LinBox: assignment to `const` variable\n * Gfan (0.5) -- #12440\n * Lcalc -- #12436, #12437\n``````\n",
    "created_at": "2014-08-19T12:35:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138563",
    "user": "https://github.com/a-andre"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 Packages failing to build (or causing other packages to fail to build) with Clang:
 
 * ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
-* eclib -- default parameters in `friend` declarations (?)
+* eclib -- #16852 (default parameters in `friend` declarations)
 * Givaro -- causes build failure for LinBox: assignment to `const` variable
 * Gfan (0.5) -- #12440
 * Lcalc -- #12436, #12437
``````




---

archive/issue_events_101950.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-04-28T16:58:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101950"
}
```



---

archive/issue_events_101951.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-04-28T16:58:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101951"
}
```



---

archive/issue_comments_138564.json:
```json
{
    "body": "<a id='comment:58'></a>\n*Someone<sup>TM</sup>* should update the list w.r.t. more recent versions of Sage and `clang`...",
    "created_at": "2015-04-29T09:31:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138564",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:58'></a>
*Someone<sup>TM</sup>* should update the list w.r.t. more recent versions of Sage and `clang`...



---

archive/issue_comments_138565.json:
```json
{
    "body": "**Changing keywords** from \"clang C++11 porting\" to \"clang  porting\".",
    "created_at": "2016-09-17T07:38:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138565",
    "user": "https://github.com/kiwifb"
}
```

**Changing keywords** from "clang C++11 porting" to "clang  porting".



---

archive/issue_events_101952.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-09-17T07:38:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101952"
}
```



---

archive/issue_events_101953.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-09-17T07:38:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101953"
}
```



---

archive/issue_comments_138566.json:
```json
{
    "body": "<a id='comment:59'></a>\nI may post a branch here for stuff that I don't feel are in the right shape for their own ticket.",
    "created_at": "2016-09-17T07:38:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138566",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:59'></a>
I may post a branch here for stuff that I don't feel are in the right shape for their own ticket.



---

archive/issue_comments_138567.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,27 +4,19 @@\n \n Packages failing to build (or causing other packages to fail to build) with Clang:\n \n-* ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.\n-* eclib -- #16852 (default parameters in `friend` declarations)\n-* Givaro -- causes build failure for LinBox: assignment to `const` variable\n * Gfan (0.5) -- #12440\n * Lcalc -- #12436, #12437\n-* libGAP -- some preprocessor / macro weirdness?\n-* LinBox -- C++ problem\n-* pynac -- C++ template problem\n-* Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)\n-* R -- problematic due to mixture of C and Fortran code\n+* LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n+* pynac -- C++ problem [https://github.com/pynac/pynac/issues/193](https://github.com/pynac/pynac/issues/193) and [https://github.com/pynac/pynac/pull/192](https://github.com/pynac/pynac/pull/192) so far.\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n-* Singular -- #12442\n * Symmetrica -- #12439\n-\n+* Singular 4 to be checked when it finally lands\n+* fplll-5 to be checked when it finally lands\n+ \n ---\n \n Spkgs ignoring CC/CXX environment variables:\n \n-* FLINTQS -- #12428\n-* Sage -- #12443\n+* Sage -- #12443 ?\n \n----\n \n-Distantly related: #14676\n``````\n",
    "created_at": "2016-09-17T07:38:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138567",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,27 +4,19 @@
 
 Packages failing to build (or causing other packages to fail to build) with Clang:
 
-* ATLAS -- probably impossible without Clint's help. Also mixes Fortran and C code.
-* eclib -- #16852 (default parameters in `friend` declarations)
-* Givaro -- causes build failure for LinBox: assignment to `const` variable
 * Gfan (0.5) -- #12440
 * Lcalc -- #12436, #12437
-* libGAP -- some preprocessor / macro weirdness?
-* LinBox -- C++ problem
-* pynac -- C++ template problem
-* Python -- #16376 (fails to build `_sqlite3`, uses `-R<path>` instead of `-Wl,-R,<path>`)
-* R -- problematic due to mixture of C and Fortran code
+* LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
+* pynac -- C++ problem [https://github.com/pynac/pynac/issues/193](https://github.com/pynac/pynac/issues/193) and [https://github.com/pynac/pynac/pull/192](https://github.com/pynac/pynac/pull/192) so far.
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
-* Singular -- #12442
 * Symmetrica -- #12439
-
+* Singular 4 to be checked when it finally lands
+* fplll-5 to be checked when it finally lands
+ 
 ---
 
 Spkgs ignoring CC/CXX environment variables:
 
-* FLINTQS -- #12428
-* Sage -- #12443
+* Sage -- #12443 ?
 
----
 
-Distantly related: #14676
``````




---

archive/issue_comments_138568.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n * Gfan (0.5) -- #12440\n * Lcalc -- #12436, #12437\n * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n-* pynac -- C++ problem [https://github.com/pynac/pynac/issues/193](https://github.com/pynac/pynac/issues/193) and [https://github.com/pynac/pynac/pull/192](https://github.com/pynac/pynac/pull/192) so far.\n+* pynac -- #21623\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Symmetrica -- #12439\n * Singular 4 to be checked when it finally lands\n``````\n",
    "created_at": "2016-10-03T07:58:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138568",
    "user": "https://github.com/rwst"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 * Gfan (0.5) -- #12440
 * Lcalc -- #12436, #12437
 * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
-* pynac -- C++ problem [https://github.com/pynac/pynac/issues/193](https://github.com/pynac/pynac/issues/193) and [https://github.com/pynac/pynac/pull/192](https://github.com/pynac/pynac/pull/192) so far.
+* pynac -- #21623
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Symmetrica -- #12439
 * Singular 4 to be checked when it finally lands
``````




---

archive/issue_comments_138569.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n Packages failing to build (or causing other packages to fail to build) with Clang:\n \n * Gfan (0.5) -- #12440\n-* Lcalc -- #12436, #12437\n+* Lcalc -- #12437\n * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n * pynac -- #21623\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n``````\n",
    "created_at": "2016-10-03T08:02:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138569",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 Packages failing to build (or causing other packages to fail to build) with Clang:
 
 * Gfan (0.5) -- #12440
-* Lcalc -- #12436, #12437
+* Lcalc -- #12437
 * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
 * pynac -- #21623
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
``````




---

archive/issue_comments_138570.json:
```json
{
    "body": "<a id='comment:62'></a>\nJust to document the problem I had after applying all the patches above. I've given up for now:\n\n```\n[libgap-4.8.3] /usr/lib64/gcc/x86_64-suse-linux/4.8/../../../../x86_64-suse-linux\n/bin/ld: .libs/libgap_la-ariths.o: relocation R_X86_64_32S against `libGAP_ZEROOp\n' can not be used when making a shared object; recompile with -fPIC\n[libgap-4.8.3] .libs/libgap_la-ariths.o: error adding symbols: Bad value\n[libgap-4.8.3] clang-3.7: error: linker command failed with exit code 1 (use -v t\no see invocation)\n[libgap-4.8.3] Makefile:503: recipe for target 'libgap.la' failed\n[libgap-4.8.3] make[5]: *** [libgap.la] Error 1\n```\nOpenSuSE 42.1, clang-3.7, gcc 4.8/5/6 in system, invoked with `make distclean; CC=clang CXX=clang++ make`",
    "created_at": "2016-10-04T13:08:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138570",
    "user": "https://github.com/rwst"
}
```

<a id='comment:62'></a>
Just to document the problem I had after applying all the patches above. I've given up for now:

```
[libgap-4.8.3] /usr/lib64/gcc/x86_64-suse-linux/4.8/../../../../x86_64-suse-linux
/bin/ld: .libs/libgap_la-ariths.o: relocation R_X86_64_32S against `libGAP_ZEROOp
' can not be used when making a shared object; recompile with -fPIC
[libgap-4.8.3] .libs/libgap_la-ariths.o: error adding symbols: Bad value
[libgap-4.8.3] clang-3.7: error: linker command failed with exit code 1 (use -v t
o see invocation)
[libgap-4.8.3] Makefile:503: recipe for target 'libgap.la' failed
[libgap-4.8.3] make[5]: *** [libgap.la] Error 1
```
OpenSuSE 42.1, clang-3.7, gcc 4.8/5/6 in system, invoked with `make distclean; CC=clang CXX=clang++ make`



---

archive/issue_events_101954.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-12T10:31:26Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "rename": {
        "from": "Make Sage build with clang (3.0+)",
        "to": "Make Sage build with clang (3.7+)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101954"
}
```



---

archive/issue_comments_138571.json:
```json
{
    "body": "<a id='comment:63'></a>\nupdated the versions we target to more realistic (Xcode 6.4 was based on 3.6.0svn), and meanwhile we are much further, see\nsee https://gist.github.com/yamaya/2924292",
    "created_at": "2016-10-12T10:31:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138571",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:63'></a>
updated the versions we target to more realistic (Xcode 6.4 was based on 3.6.0svn), and meanwhile we are much further, see
see https://gist.github.com/yamaya/2924292



---

archive/issue_comments_138572.json:
```json
{
    "body": "<a id='comment:64'></a>\nI am currently working with xcode 8.0 which is clang 3.8.0. `fplll-5.0.x` compiles but I haven't checked `singular` 4. No way to check `fpylll` without sage building first. I'll post some details on the current problems with sagelib tomorrow. That will be interesting :)\n\nHint stuff outside sagelib may need fixes.",
    "created_at": "2016-10-12T10:36:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138572",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>
I am currently working with xcode 8.0 which is clang 3.8.0. `fplll-5.0.x` compiles but I haven't checked `singular` 4. No way to check `fpylll` without sage building first. I'll post some details on the current problems with sagelib tomorrow. That will be interesting :)

Hint stuff outside sagelib may need fixes.



---

archive/issue_comments_138573.json:
```json
{
    "body": "<a id='comment:65'></a>\nSo the first failure in building `sagelib` occurs with `sage/finance/time_series.pyx`\n\n```\n[sagelib-7.4.rc0] [  1/386] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.o -fno-strict-aliasing\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c:317:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/arrayobject.h:4:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:18:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1777:\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:15:2: warning: \"Using deprecated NumPy API, disable it by \"          \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-W#warnings]\n[sagelib-7.4.rc0] #warning \"Using deprecated NumPy API, disable it by \" \\\n[sagelib-7.4.rc0]  ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c:15252:3: error: non-void function '__pyx_pf_4sage_7finance_11time_series_10TimeSeries_106numpy' should return a value [-Wreturn-type]\n[sagelib-7.4.rc0]   import_array();\n[sagelib-7.4.rc0]   ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1532:144: note: expanded from macro 'import_array'\n[sagelib-7.4.rc0] #define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, \"numpy.core.multiarray failed to import\"); return NUMPY_IMPORT_ARRAY_RETVAL; } }\n[sagelib-7.4.rc0]                                                                                                                                                ^\n[sagelib-7.4.rc0] 1 warning and 1 error generated.\n```\nThe problem is the import_array statement from `numpy`, more precisely this bit of code from `local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h`\n\n```\n#if PY_VERSION_HEX >= 0x03000000\n#define NUMPY_IMPORT_ARRAY_RETVAL NULL\n#else\n#define NUMPY_IMPORT_ARRAY_RETVAL\n#endif\n\n#define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, \"numpy.core.multiarray failed to import\"); return NUMPY_IMPORT_ARRAY_RETVAL; } }\n```\nAs you can see for `python` < 3 `NUMPY_IMPORT_ARRAY_RETVAL` is defined but empty, therefore the return statement in `import_array` is empty. This is completely and mainly rely on `gcc` to be permissive. `NULL` is not necessarily a good return value either, since it should be an error code. The whole thing assume or impose something on the part of the function calling `import_array` that is not true in `time_series` an I am not sure can be imposed in `cython` (don't know enough about cython).\n\nA quick and dirty solution is to edit `_multiarray.py` and make `NUMPY_IMPORT_ARRAY_RETVAL` `NULL` always. That get us to the next problem.",
    "created_at": "2016-10-13T01:17:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138573",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:65'></a>
So the first failure in building `sagelib` occurs with `sage/finance/time_series.pyx`

```
[sagelib-7.4.rc0] [  1/386] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.o -fno-strict-aliasing
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c:317:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/arrayobject.h:4:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:18:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1777:
[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:15:2: warning: "Using deprecated NumPy API, disable it by "          "#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-W#warnings]
[sagelib-7.4.rc0] #warning "Using deprecated NumPy API, disable it by " \
[sagelib-7.4.rc0]  ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/finance/time_series.c:15252:3: error: non-void function '__pyx_pf_4sage_7finance_11time_series_10TimeSeries_106numpy' should return a value [-Wreturn-type]
[sagelib-7.4.rc0]   import_array();
[sagelib-7.4.rc0]   ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1532:144: note: expanded from macro 'import_array'
[sagelib-7.4.rc0] #define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, "numpy.core.multiarray failed to import"); return NUMPY_IMPORT_ARRAY_RETVAL; } }
[sagelib-7.4.rc0]                                                                                                                                                ^
[sagelib-7.4.rc0] 1 warning and 1 error generated.
```
The problem is the import_array statement from `numpy`, more precisely this bit of code from `local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h`

```
#if PY_VERSION_HEX >= 0x03000000
#define NUMPY_IMPORT_ARRAY_RETVAL NULL
#else
#define NUMPY_IMPORT_ARRAY_RETVAL
#endif

#define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, "numpy.core.multiarray failed to import"); return NUMPY_IMPORT_ARRAY_RETVAL; } }
```
As you can see for `python` < 3 `NUMPY_IMPORT_ARRAY_RETVAL` is defined but empty, therefore the return statement in `import_array` is empty. This is completely and mainly rely on `gcc` to be permissive. `NULL` is not necessarily a good return value either, since it should be an error code. The whole thing assume or impose something on the part of the function calling `import_array` that is not true in `time_series` an I am not sure can be imposed in `cython` (don't know enough about cython).

A quick and dirty solution is to edit `_multiarray.py` and make `NUMPY_IMPORT_ARRAY_RETVAL` `NULL` always. That get us to the next problem.



---

archive/issue_comments_138574.json:
```json
{
    "body": "<a id='comment:66'></a>\nNext failure\n\n```\n[sagelib-7.4.rc0] [  1/373] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.o -fno-strict-aliasing\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1334:8: error: 'inline' can only appear on functions\n[sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_compute_out_neighborhood_cardinality)(struct __pyx_obj_4sage_6graphs_20graph_decompositions_12fast_digraph_FastDigraph *, int); /*proto*/\n[sagelib-7.4.rc0]        ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'\n[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n[sagelib-7.4.rc0]                           ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1335:8: error: 'inline' can only appear on functions\n[sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_popcount32)(int); /*proto*/\n[sagelib-7.4.rc0]        ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'\n[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n[sagelib-7.4.rc0]                           ^\n[sagelib-7.4.rc0] 2 errors generated.\n```\nI am not sure what to do with that one. I'll just note line 257 is the one enabled by `__GNUC__`\n\n```\n#ifndef CYTHON_INLINE\n  #if defined(__GNUC__)\n    #define CYTHON_INLINE __inline__\n  #elif defined(_MSC_VER)\n    #define CYTHON_INLINE __inline\n  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L\n    #define CYTHON_INLINE inline\n  #else\n    #define CYTHON_INLINE\n  #endif\n#endif\n```\nSo `clang` pretending to be `gcc` means that `CYTHON_INLINE` is defined. Of course `clang` support the GNU form, but it doesn't support a declaration to be inlined as it is in that code. This is clearly a `cython` code generation issue.",
    "created_at": "2016-10-13T01:26:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138574",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:66'></a>
Next failure

```
[sagelib-7.4.rc0] [  1/373] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.o -fno-strict-aliasing
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1334:8: error: 'inline' can only appear on functions
[sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_compute_out_neighborhood_cardinality)(struct __pyx_obj_4sage_6graphs_20graph_decompositions_12fast_digraph_FastDigraph *, int); /*proto*/
[sagelib-7.4.rc0]        ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'
[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
[sagelib-7.4.rc0]                           ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1335:8: error: 'inline' can only appear on functions
[sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_popcount32)(int); /*proto*/
[sagelib-7.4.rc0]        ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'
[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
[sagelib-7.4.rc0]                           ^
[sagelib-7.4.rc0] 2 errors generated.
```
I am not sure what to do with that one. I'll just note line 257 is the one enabled by `__GNUC__`

```
#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif
```
So `clang` pretending to be `gcc` means that `CYTHON_INLINE` is defined. Of course `clang` support the GNU form, but it doesn't support a declaration to be inlined as it is in that code. This is clearly a `cython` code generation issue.



---

archive/issue_comments_138575.json:
```json
{
    "body": "<a id='comment:67'></a>\nHand editing the generated cython code allows us to go a bit further until exactly the same error occurs in another file\n\n```\n[sagelib-7.4.rc0] [  1/363] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.o -fno-strict-aliasing\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:1785:8: error: 'inline' can only appear on functions\n[sagelib-7.4.rc0] static CYTHON_INLINE uint32_t *(*__pyx_f_4sage_6graphs_4base_19static_sparse_graph_has_edge)(__pyx_t_4sage_6graphs_4base_19static_sparse_graph_short_digraph_s *, int, int); /*proto*/\n[sagelib-7.4.rc0]        ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:258:27: note: expanded from macro 'CYTHON_INLINE'\n[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n[sagelib-7.4.rc0]                           ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:1786:8: error: 'inline' can only appear on functions\n[sagelib-7.4.rc0] static CYTHON_INLINE PyObject *(*__pyx_f_4sage_6graphs_4base_19static_sparse_graph_edge_label)(__pyx_t_4sage_6graphs_4base_19static_sparse_graph_short_digraph_s *, uint32_t *); /*proto*/\n[sagelib-7.4.rc0]        ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:258:27: note: expanded from macro 'CYTHON_INLINE'\n[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n[sagelib-7.4.rc0]                           ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:7758:31: warning: comparison of array '__pyx_v_self->g_rev' not equal to a null pointer is always true [-Wtautological-pointer-compare]\n[sagelib-7.4.rc0]   __pyx_t_1 = ((__pyx_v_self->g_rev != NULL) != 0);\n[sagelib-7.4.rc0]                 ~~~~~~~~~~~~~~^~~~~    ~~~~\n[sagelib-7.4.rc0] 1 warning and 2 errors generated.\n```\n\nThat's where I am at right now.",
    "created_at": "2016-10-13T01:32:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138575",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:67'></a>
Hand editing the generated cython code allows us to go a bit further until exactly the same error occurs in another file

```
[sagelib-7.4.rc0] [  1/363] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.o -fno-strict-aliasing
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:1785:8: error: 'inline' can only appear on functions
[sagelib-7.4.rc0] static CYTHON_INLINE uint32_t *(*__pyx_f_4sage_6graphs_4base_19static_sparse_graph_has_edge)(__pyx_t_4sage_6graphs_4base_19static_sparse_graph_short_digraph_s *, int, int); /*proto*/
[sagelib-7.4.rc0]        ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:258:27: note: expanded from macro 'CYTHON_INLINE'
[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
[sagelib-7.4.rc0]                           ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:1786:8: error: 'inline' can only appear on functions
[sagelib-7.4.rc0] static CYTHON_INLINE PyObject *(*__pyx_f_4sage_6graphs_4base_19static_sparse_graph_edge_label)(__pyx_t_4sage_6graphs_4base_19static_sparse_graph_short_digraph_s *, uint32_t *); /*proto*/
[sagelib-7.4.rc0]        ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:258:27: note: expanded from macro 'CYTHON_INLINE'
[sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
[sagelib-7.4.rc0]                           ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/base/static_sparse_backend.c:7758:31: warning: comparison of array '__pyx_v_self->g_rev' not equal to a null pointer is always true [-Wtautological-pointer-compare]
[sagelib-7.4.rc0]   __pyx_t_1 = ((__pyx_v_self->g_rev != NULL) != 0);
[sagelib-7.4.rc0]                 ~~~~~~~~~~~~~~^~~~~    ~~~~
[sagelib-7.4.rc0] 1 warning and 2 errors generated.
```

That's where I am at right now.



---

archive/issue_comments_138576.json:
```json
{
    "body": "<a id='comment:68'></a>\nAnd then `sage/graphs/graph_decompositions/cutwidth.pyx`, `sage/libs/mpmath/ext_main.pyx`, `sage/libs/mpmath/ext_libmp.pyx`. Next, my modification of `__multiarray_api.h` is bitting me. \n\n```\n[sagelib-7.4.rc0] [ 43/291] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.o -fno-strict-aliasing\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c:309:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/arrayobject.h:4:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:18:\n[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1777:\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:15:2: warning: \"Using deprecated NumPy API, disable it by \"          \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-W#warnings]\n[sagelib-7.4.rc0] #warning \"Using deprecated NumPy API, disable it by \" \\\n[sagelib-7.4.rc0]  ^\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c:28680:3: error: void function 'initmatrix_double_dense' should not return a value [-Wreturn-type]\n[sagelib-7.4.rc0]   import_array();\n[sagelib-7.4.rc0]   ^~~~~~~~~~~~~~\n[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1532:144: note: expanded from macro 'import_array'\n[sagelib-7.4.rc0] #define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, \"numpy.core.multiarray failed to import\"); return NUMPY_IMPORT_ARRAY_RETVAL; } }\n[sagelib-7.4.rc0]                                                                                                                                                ^      ~~~~~~~~~~~~~~~~~~~~~~~~~\n[sagelib-7.4.rc0] 1 warning and 1 error generated.\n[sagelib-7.4.rc0] error: command 'clang' failed with exit status 1\n```\nMay be I'll learn to do the correct thing for the first instance.",
    "created_at": "2016-10-13T02:00:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138576",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:68'></a>
And then `sage/graphs/graph_decompositions/cutwidth.pyx`, `sage/libs/mpmath/ext_main.pyx`, `sage/libs/mpmath/ext_libmp.pyx`. Next, my modification of `__multiarray_api.h` is bitting me. 

```
[sagelib-7.4.rc0] [ 43/291] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.o -fno-strict-aliasing
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c:309:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/arrayobject.h:4:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:18:
[sagelib-7.4.rc0] In file included from /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1777:
[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:15:2: warning: "Using deprecated NumPy API, disable it by "          "#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-W#warnings]
[sagelib-7.4.rc0] #warning "Using deprecated NumPy API, disable it by " \
[sagelib-7.4.rc0]  ^
[sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_double_dense.c:28680:3: error: void function 'initmatrix_double_dense' should not return a value [-Wreturn-type]
[sagelib-7.4.rc0]   import_array();
[sagelib-7.4.rc0]   ^~~~~~~~~~~~~~
[sagelib-7.4.rc0] /Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1532:144: note: expanded from macro 'import_array'
[sagelib-7.4.rc0] #define import_array() {if (_import_array() < 0) {PyErr_Print(); PyErr_SetString(PyExc_ImportError, "numpy.core.multiarray failed to import"); return NUMPY_IMPORT_ARRAY_RETVAL; } }
[sagelib-7.4.rc0]                                                                                                                                                ^      ~~~~~~~~~~~~~~~~~~~~~~~~~
[sagelib-7.4.rc0] 1 warning and 1 error generated.
[sagelib-7.4.rc0] error: command 'clang' failed with exit status 1
```
May be I'll learn to do the correct thing for the first instance.



---

archive/issue_comments_138577.json:
```json
{
    "body": "<a id='comment:69'></a>\n????????\n\n```\n[sagelib-7.4.rc0] [  4/249] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_integer_dense.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_integer_dense.o -U_LB_DEBUG -DDISABLE_COMMENTATOR -I/Users/fbissey/build/sage/local/include/linbox -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -I/Users/fbissey/build/sage/local//include -fPIC -I/Users/fbissey/build/sage/local/include -std=gnu++11 -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -mmmx -msse -msse2 -msse3 -fno-strict-aliasing\n[sagelib-7.4.rc0] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'\n```\nNow there's a bug somewhere: `-std=gnu++11 -std=c99`.",
    "created_at": "2016-10-13T02:10:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138577",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:69'></a>
????????

```
[sagelib-7.4.rc0] [  4/249] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_integer_dense.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/matrix/matrix_integer_dense.o -U_LB_DEBUG -DDISABLE_COMMENTATOR -I/Users/fbissey/build/sage/local/include/linbox -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -I/Users/fbissey/build/sage/local//include -fPIC -I/Users/fbissey/build/sage/local/include -std=gnu++11 -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -mmmx -msse -msse2 -msse3 -fno-strict-aliasing
[sagelib-7.4.rc0] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'
```
Now there's a bug somewhere: `-std=gnu++11 -std=c99`.



---

archive/issue_comments_138578.json:
```json
{
    "body": "<a id='comment:70'></a>\nNot sure where `linbox` is pulled from, but that made it `.cpp` instead of `.c`.  `linbox`'s .pc file brings the `-std=gnu++11`, `module_list.py` brings `-std=c99`. I can remove it from `module_list.py` but first I'd like to understand where linbox was pulled from.",
    "created_at": "2016-10-13T02:47:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138578",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:70'></a>
Not sure where `linbox` is pulled from, but that made it `.cpp` instead of `.c`.  `linbox`'s .pc file brings the `-std=gnu++11`, `module_list.py` brings `-std=c99`. I can remove it from `module_list.py` but first I'd like to understand where linbox was pulled from.



---

archive/issue_comments_138579.json:
```json
{
    "body": "<a id='comment:71'></a>\nReplying to [fbissey](#comment%3A66):\n> Next failure\n> \n> ```\n> [sagelib-7.4.rc0] [  1/373] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.o -fno-strict-aliasing\n> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1334:8: error: 'inline' can only appear on functions\n> [sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_compute_out_neighborhood_cardinality)(struct __pyx_obj_4sage_6graphs_20graph_decompositions_12fast_digraph_FastDigraph *, int); /*proto*/\n> [sagelib-7.4.rc0]        ^\n> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'\n> [sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n> [sagelib-7.4.rc0]                           ^\n> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1335:8: error: 'inline' can only appear on functions\n> [sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_popcount32)(int); /*proto*/\n> [sagelib-7.4.rc0]        ^\n> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'\n> [sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__\n> [sagelib-7.4.rc0]                           ^\n> [sagelib-7.4.rc0] 2 errors generated.\n> ```\n\n\nThat's a genuine problem with the Sage code. GCC only warns for this (which is actually surprising, since the code makes no sense). Ideally, Cython should already refuse this code instead of generating invalid C.\n\nThe fix is easy: remove `inline` from all **declarations** in `.pxd` files.",
    "created_at": "2016-10-13T06:22:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138579",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:71'></a>
Replying to [fbissey](#comment%3A66):
> Next failure
> 
> ```
> [sagelib-7.4.rc0] [  1/373] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p2/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.o -fno-strict-aliasing
> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1334:8: error: 'inline' can only appear on functions
> [sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_compute_out_neighborhood_cardinality)(struct __pyx_obj_4sage_6graphs_20graph_decompositions_12fast_digraph_FastDigraph *, int); /*proto*/
> [sagelib-7.4.rc0]        ^
> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'
> [sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
> [sagelib-7.4.rc0]                           ^
> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:1335:8: error: 'inline' can only appear on functions
> [sagelib-7.4.rc0] static CYTHON_INLINE int (*__pyx_f_4sage_6graphs_20graph_decompositions_12fast_digraph_popcount32)(int); /*proto*/
> [sagelib-7.4.rc0]        ^
> [sagelib-7.4.rc0] /Users/fbissey/build/sage/src/build/cythonized/sage/graphs/graph_decompositions/vertex_separation.c:257:27: note: expanded from macro 'CYTHON_INLINE'
> [sagelib-7.4.rc0]     #define CYTHON_INLINE __inline__
> [sagelib-7.4.rc0]                           ^
> [sagelib-7.4.rc0] 2 errors generated.
> ```


That's a genuine problem with the Sage code. GCC only warns for this (which is actually surprising, since the code makes no sense). Ideally, Cython should already refuse this code instead of generating invalid C.

The fix is easy: remove `inline` from all **declarations** in `.pxd` files.



---

archive/issue_comments_138580.json:
```json
{
    "body": "<a id='comment:72'></a>\nThanks for the pointer Jeroen, that makes two new tickets where I have an idea of what to do. The `matrix_integer_dense` is a real problem with `gcc` too\n\n```\n[206/450] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/lib64/python2.7/site-packages/cysignals -I/usr/include/openblas -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/matrix/matrix_integer_dense.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/matrix/matrix_integer_dense.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -DOPENBLAS_ARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -O1 -march=native -pipe -ggdb -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -fabi-version=6 -fopenmp -DFFLAS_COMPILED -DFFPACK_COMPILED -O1 -march=native -pipe -ggdb -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mfpmath=sse -fabi-version=6 -I/usr/include/linbox -I/usr/include/openblas -std=c99 -I/usr/include/m4ri -fno-strict-aliasing\n```\nAlso here it uses `g++` rather than `gcc`. If a `.cpp` file is generated we should just adjust the options.",
    "created_at": "2016-10-13T07:29:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138580",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:72'></a>
Thanks for the pointer Jeroen, that makes two new tickets where I have an idea of what to do. The `matrix_integer_dense` is a real problem with `gcc` too

```
[206/450] x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -fPIC -I/usr/lib64/python2.7/site-packages/cysignals -I/usr/include/openblas -I/usr/include -I/usr/include/python2.7 -I/usr/lib64/python2.7/site-packages/numpy/core/include -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7 -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage/ext -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized -I/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/ext -I/usr/include/python2.7 -c /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/matrix/matrix_integer_dense.cpp -o /scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/temp.linux-x86_64-2.7/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/matrix/matrix_integer_dense.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -DOPENBLAS_ARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -O1 -march=native -pipe -ggdb -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -fabi-version=6 -fopenmp -DFFLAS_COMPILED -DFFPACK_COMPILED -O1 -march=native -pipe -ggdb -std=gnu++11 -mmmx -mpopcnt -msse -msse2 -msse3 -msse4.1 -msse4.2 -mfpmath=sse -fabi-version=6 -I/usr/include/linbox -I/usr/include/openblas -std=c99 -I/usr/include/m4ri -fno-strict-aliasing
```
Also here it uses `g++` rather than `gcc`. If a `.cpp` file is generated we should just adjust the options.



---

archive/issue_comments_138581.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,8 +10,9 @@\n * pynac -- #21623\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Symmetrica -- #12439\n+* fix usage of `import_array` in `finance/time_series.pyx` #21695\n+* fix abuse of `inline` keyword in `pxd` files #21696\n * Singular 4 to be checked when it finally lands\n-* fplll-5 to be checked when it finally lands\n  \n ---\n \n``````\n",
    "created_at": "2016-10-13T09:44:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138581",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,8 +10,9 @@
 * pynac -- #21623
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Symmetrica -- #12439
+* fix usage of `import_array` in `finance/time_series.pyx` #21695
+* fix abuse of `inline` keyword in `pxd` files #21696
 * Singular 4 to be checked when it finally lands
-* fplll-5 to be checked when it finally lands
  
 ---
 
``````




---

archive/issue_comments_138582.json:
```json
{
    "body": "<a id='comment:74'></a>\nOK I figured out what is pulled from where now. Lots of declarations directly in `matrix_integer_dense.pyx` rather than the matching `.pxd` file. `sage/arith/multi_modular.pxd` is the only `pxd` file with a distutils declaration `-std=c99` and it is pulled in `matrix_integer_dense.pyx` by\n\n```\nfrom sage.arith.multi_modular cimport MultiModularBasis\n```\non line 88. `linbox` is pulled by\n\n```\n######### linbox interface ##########\nfrom sage.libs.linbox.linbox cimport Linbox_integer_dense\ncdef Linbox_integer_dense linbox = Linbox_integer_dense()\nUSE_LINBOX_POLY = True\n```\nline 122 to 125. \n\nIn the short term I will forego the distutils declaration in `multi_modular.pxd` and see what happens combined with some changes to `module_list.py`.",
    "created_at": "2016-10-14T00:39:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138582",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:74'></a>
OK I figured out what is pulled from where now. Lots of declarations directly in `matrix_integer_dense.pyx` rather than the matching `.pxd` file. `sage/arith/multi_modular.pxd` is the only `pxd` file with a distutils declaration `-std=c99` and it is pulled in `matrix_integer_dense.pyx` by

```
from sage.arith.multi_modular cimport MultiModularBasis
```
on line 88. `linbox` is pulled by

```
######### linbox interface ##########
from sage.libs.linbox.linbox cimport Linbox_integer_dense
cdef Linbox_integer_dense linbox = Linbox_integer_dense()
USE_LINBOX_POLY = True
```
line 122 to 125. 

In the short term I will forego the distutils declaration in `multi_modular.pxd` and see what happens combined with some changes to `module_list.py`.



---

archive/issue_comments_138583.json:
```json
{
    "body": "<a id='comment:75'></a>\nI will open a new ticket about language selection for various `pxd` and `pxi` files, I updated the cython inline tickets with new files as I found them. I am now hitting a problem with `pynac` for which I'll open a new and cc Ralph ASAP.\n\n```\n[sagelib-7.4.rc1] [1/9] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.o -std=c++11 -fno-strict-aliasing\n[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:336:\n[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/src/sage/symbolic/ginac_wrap.h:11:\n[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/local/include/pynac/ginac.h:38:\n[sagelib-7.4.rc1] /Users/fbissey/build/sage/local/include/pynac/integral.h:44:5: warning: 'GiNaC::integral::evalf' hides overloaded virtual function [-Woverloaded-virtual]\n[sagelib-7.4.rc1]         ex evalf(int level=0) const;\n[sagelib-7.4.rc1]            ^\n[sagelib-7.4.rc1] /Users/fbissey/build/sage/local/include/pynac/basic.h:176:13: note: hidden overloaded virtual function 'GiNaC::basic::evalf' declared here: different number of parameters (2 vs 1)\n[sagelib-7.4.rc1]         virtual ex evalf(int level = 0, PyObject* parent=nullptr) const;\n[sagelib-7.4.rc1]                    ^\n[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:27231:30: error: no member named 'operator!=' in 'std::__1::__list_const_iterator<GiNaC::ex, void *>'\n[sagelib-7.4.rc1]     __pyx_t_2 = (__pyx_v_itr.operator!=(__pyx_v_lstend) != 0);\n[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^\n[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:27446:30: error: no member named 'operator!=' in 'std::__1::__list_const_iterator<GiNaC::ex, void *>'\n[sagelib-7.4.rc1]     __pyx_t_3 = (__pyx_v_itr.operator!=(__pyx_v_found.end()) != 0);\n[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^\n[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:28649:30: error: no member named 'operator!=' in 'std::__1::__tree_const_iterator<GiNaC::ex, std::__1::__tree_node<GiNaC::ex, void *> *, long>'\n[sagelib-7.4.rc1]     __pyx_t_3 = (__pyx_v_itr.operator!=(__pyx_v_sym_set.end()) != 0);\n[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^\n[sagelib-7.4.rc1] 1 warning and 3 errors generated.\n```\nNotice that I am down to 9 cythonized file to compile :)",
    "created_at": "2016-10-14T01:44:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138583",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:75'></a>
I will open a new ticket about language selection for various `pxd` and `pxi` files, I updated the cython inline tickets with new files as I found them. I am now hitting a problem with `pynac` for which I'll open a new and cc Ralph ASAP.

```
[sagelib-7.4.rc1] [1/9] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.o -std=c++11 -fno-strict-aliasing
[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:336:
[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/src/sage/symbolic/ginac_wrap.h:11:
[sagelib-7.4.rc1] In file included from /Users/fbissey/build/sage/local/include/pynac/ginac.h:38:
[sagelib-7.4.rc1] /Users/fbissey/build/sage/local/include/pynac/integral.h:44:5: warning: 'GiNaC::integral::evalf' hides overloaded virtual function [-Woverloaded-virtual]
[sagelib-7.4.rc1]         ex evalf(int level=0) const;
[sagelib-7.4.rc1]            ^
[sagelib-7.4.rc1] /Users/fbissey/build/sage/local/include/pynac/basic.h:176:13: note: hidden overloaded virtual function 'GiNaC::basic::evalf' declared here: different number of parameters (2 vs 1)
[sagelib-7.4.rc1]         virtual ex evalf(int level = 0, PyObject* parent=nullptr) const;
[sagelib-7.4.rc1]                    ^
[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:27231:30: error: no member named 'operator!=' in 'std::__1::__list_const_iterator<GiNaC::ex, void *>'
[sagelib-7.4.rc1]     __pyx_t_2 = (__pyx_v_itr.operator!=(__pyx_v_lstend) != 0);
[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^
[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:27446:30: error: no member named 'operator!=' in 'std::__1::__list_const_iterator<GiNaC::ex, void *>'
[sagelib-7.4.rc1]     __pyx_t_3 = (__pyx_v_itr.operator!=(__pyx_v_found.end()) != 0);
[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^
[sagelib-7.4.rc1] /Users/fbissey/build/sage/src/build/cythonized/sage/symbolic/expression.cpp:28649:30: error: no member named 'operator!=' in 'std::__1::__tree_const_iterator<GiNaC::ex, std::__1::__tree_node<GiNaC::ex, void *> *, long>'
[sagelib-7.4.rc1]     __pyx_t_3 = (__pyx_v_itr.operator!=(__pyx_v_sym_set.end()) != 0);
[sagelib-7.4.rc1]                  ~~~~~~~~~~~ ^
[sagelib-7.4.rc1] 1 warning and 3 errors generated.
```
Notice that I am down to 9 cythonized file to compile :)



---

archive/issue_comments_138584.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,6 +12,7 @@\n * Symmetrica -- #12439\n * fix usage of `import_array` in `finance/time_series.pyx` #21695\n * fix abuse of `inline` keyword in `pxd` files #21696\n+* Problems compiling `expression.pyx` probably `pynac` upstream problem\n * Singular 4 to be checked when it finally lands\n  \n ---\n``````\n",
    "created_at": "2016-10-14T01:51:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138584",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,6 +12,7 @@
 * Symmetrica -- #12439
 * fix usage of `import_array` in `finance/time_series.pyx` #21695
 * fix abuse of `inline` keyword in `pxd` files #21696
+* Problems compiling `expression.pyx` probably `pynac` upstream problem
 * Singular 4 to be checked when it finally lands
  
 ---
``````




---

archive/issue_comments_138585.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,9 +10,10 @@\n * pynac -- #21623\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Symmetrica -- #12439\n-* fix usage of `import_array` in `finance/time_series.pyx` #21695\n+* fix `import_array` in `finance/time_series.pyx` now fixed by #20596\n * fix abuse of `inline` keyword in `pxd` files #21696\n-* Problems compiling `expression.pyx` probably `pynac` upstream problem\n+* Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n+* fix conflicting language options (`-std=c++11 -std=c99`)\n * Singular 4 to be checked when it finally lands\n  \n ---\n``````\n",
    "created_at": "2016-10-20T07:21:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138585",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,9 +10,10 @@
 * pynac -- #21623
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Symmetrica -- #12439
-* fix usage of `import_array` in `finance/time_series.pyx` #21695
+* fix `import_array` in `finance/time_series.pyx` now fixed by #20596
 * fix abuse of `inline` keyword in `pxd` files #21696
-* Problems compiling `expression.pyx` probably `pynac` upstream problem
+* Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
+* fix conflicting language options (`-std=c++11 -std=c99`)
 * Singular 4 to be checked when it finally lands
  
 ---
``````




---

archive/issue_comments_138586.json:
```json
{
    "body": "<a id='comment:78'></a>\nReplying to [fbissey](#comment%3A74):\n> OK I figured out what is pulled from where now. Lots of declarations directly in `matrix_integer_dense.pyx` rather than the matching `.pxd` file. `sage/arith/multi_modular.pxd` is the only `pxd` file with a distutils declaration `-std=c99`\n\n\nThis was a mistake introduced by #17766. The `-std=c99` declaration should have been put in the `.pyx` file, not the `.pxd` file.\n\nIf you make a ticket moving this declaration to `multi_modular.pyx`, you can set it to positive_review on my behalf.",
    "created_at": "2016-10-20T13:11:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138586",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:78'></a>
Replying to [fbissey](#comment%3A74):
> OK I figured out what is pulled from where now. Lots of declarations directly in `matrix_integer_dense.pyx` rather than the matching `.pxd` file. `sage/arith/multi_modular.pxd` is the only `pxd` file with a distutils declaration `-std=c99`


This was a mistake introduced by #17766. The `-std=c99` declaration should have been put in the `.pyx` file, not the `.pxd` file.

If you make a ticket moving this declaration to `multi_modular.pyx`, you can set it to positive_review on my behalf.



---

archive/issue_comments_138587.json:
```json
{
    "body": "<a id='comment:79'></a>\nSee also my question at ticket:17766#comment:7 :-)",
    "created_at": "2016-10-20T13:12:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138587",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:79'></a>
See also my question at ticket:17766#comment:7 :-)



---

archive/issue_comments_138588.json:
```json
{
    "body": "<a id='comment:80'></a>\nThe `-std=c99` declaration itself was added in #10281 (yes, I like software archaeology).",
    "created_at": "2016-10-20T13:16:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138588",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:80'></a>
The `-std=c99` declaration itself was added in #10281 (yes, I like software archaeology).



---

archive/issue_comments_138589.json:
```json
{
    "body": "<a id='comment:81'></a>\nThanks for pointers Jeroen. What about `# distutils: language = ...` I also change/added/removed a couple of those. They should also belong to `.pyx` I presume? That would make things more tidy than the mess I see right now.",
    "created_at": "2016-10-20T20:00:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138589",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:81'></a>
Thanks for pointers Jeroen. What about `# distutils: language = ...` I also change/added/removed a couple of those. They should also belong to `.pyx` I presume? That would make things more tidy than the mess I see right now.



---

archive/issue_comments_138590.json:
```json
{
    "body": "<a id='comment:82'></a>\nActually I didn't play as much with `language` than I remember. I changed only `matrix_modn_sparse.pxd` from c to c++. I also tried `expression.pxd` for #21701 but that didn't help - so I won't consider it at this stage. But I think there may a number of .pyx declared c language which become c++ (and .cpp) by inheritance of something in c++ like `matrix_integer_dense.pyx`.",
    "created_at": "2016-10-20T20:06:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138590",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:82'></a>
Actually I didn't play as much with `language` than I remember. I changed only `matrix_modn_sparse.pxd` from c to c++. I also tried `expression.pxd` for #21701 but that didn't help - so I won't consider it at this stage. But I think there may a number of .pyx declared c language which become c++ (and .cpp) by inheritance of something in c++ like `matrix_integer_dense.pyx`.



---

archive/issue_comments_138591.json:
```json
{
    "body": "<a id='comment:83'></a>\nReplying to [fbissey](#comment%3A81):\n> Thanks for pointers Jeroen. What about `# distutils: language = ...` I also change/added/removed a couple of those. They should also belong to `.pyx` I presume?\n\n\nNot in general. These things have to be considered on a case-by-case basis.\n\nThe rule is: the `.pxd` files should contain the `# distutils` directives which are needed for the included (`cdef extern from ...`) files to compile. In `src/sage/arith/multi_modular.pxd`, there are no included files (it is only Cython code), so there is no reason to add `-std=c99`. However, it could be that `-std=c99` or `language = c++` is needed for a particular header file which is used in a `.pxd` file. In that case, the `# distutils` directive must be in the `.pxd` file.",
    "created_at": "2016-10-20T20:11:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138591",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:83'></a>
Replying to [fbissey](#comment%3A81):
> Thanks for pointers Jeroen. What about `# distutils: language = ...` I also change/added/removed a couple of those. They should also belong to `.pyx` I presume?


Not in general. These things have to be considered on a case-by-case basis.

The rule is: the `.pxd` files should contain the `# distutils` directives which are needed for the included (`cdef extern from ...`) files to compile. In `src/sage/arith/multi_modular.pxd`, there are no included files (it is only Cython code), so there is no reason to add `-std=c99`. However, it could be that `-std=c99` or `language = c++` is needed for a particular header file which is used in a `.pxd` file. In that case, the `# distutils` directive must be in the `.pxd` file.



---

archive/issue_comments_138592.json:
```json
{
    "body": "<a id='comment:84'></a>\nReplying to [fbissey](#comment%3A82):\n> I changed only `matrix_modn_sparse.pxd` from c to c++.\n\n\nThat is certainly a mistake. There is no reason why it should be `c++`. I would remove the line `# distutils: language = c` completely, since I don't see the point of it.",
    "created_at": "2016-10-20T20:15:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138592",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:84'></a>
Replying to [fbissey](#comment%3A82):
> I changed only `matrix_modn_sparse.pxd` from c to c++.


That is certainly a mistake. There is no reason why it should be `c++`. I would remove the line `# distutils: language = c` completely, since I don't see the point of it.



---

archive/issue_comments_138593.json:
```json
{
    "body": "<a id='comment:85'></a>\nLooking at some `# distutils` directives, I see many mistakes...\n\nIt would indeed be good to clean this up.",
    "created_at": "2016-10-20T20:23:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138593",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:85'></a>
Looking at some `# distutils` directives, I see many mistakes...

It would indeed be good to clean this up.



---

archive/issue_comments_138594.json:
```json
{
    "body": "<a id='comment:86'></a>\nReplying to [jdemeyer](#comment%3A84):\n> Replying to [fbissey](#comment%3A82):\n> > I changed only `matrix_modn_sparse.pxd` from c to c++.\n\n> \n> That is certainly a mistake. There is no reason why it should be `c++`. I would remove the line `# distutils: language = c` completely, since I don't see the point of it.\n\n\nOK will try that. I guess a separate ticket for clean up may help slightly with other stuff.",
    "created_at": "2016-10-21T00:29:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138594",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:86'></a>
Replying to [jdemeyer](#comment%3A84):
> Replying to [fbissey](#comment%3A82):
> > I changed only `matrix_modn_sparse.pxd` from c to c++.

> 
> That is certainly a mistake. There is no reason why it should be `c++`. I would remove the line `# distutils: language = c` completely, since I don't see the point of it.


OK will try that. I guess a separate ticket for clean up may help slightly with other stuff.



---

archive/issue_comments_138595.json:
```json
{
    "body": "<a id='comment:87'></a>\nAn example where `language = c++` in a `.pxd` file makes sense is given by Singular: #17254 added `# distutils: language = c++` to `src/sage/libs/singular/decl.pxd`. I think this is correct.",
    "created_at": "2016-10-21T08:19:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138595",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:87'></a>
An example where `language = c++` in a `.pxd` file makes sense is given by Singular: #17254 added `# distutils: language = c++` to `src/sage/libs/singular/decl.pxd`. I think this is correct.



---

archive/issue_comments_138596.json:
```json
{
    "body": "<a id='comment:88'></a>\nReplying to [jdemeyer](#comment%3A85):\n> Looking at some `# distutils` directives, I see many mistakes...\n> \n> It would indeed be good to clean this up.\n\n\nI just created #21749 for this, assuming that you haven't done anything yet.",
    "created_at": "2016-10-23T18:49:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138596",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:88'></a>
Replying to [jdemeyer](#comment%3A85):
> Looking at some `# distutils` directives, I see many mistakes...
> 
> It would indeed be good to clean this up.


I just created #21749 for this, assuming that you haven't done anything yet.



---

archive/issue_comments_138597.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n * fix `import_array` in `finance/time_series.pyx` now fixed by #20596\n * fix abuse of `inline` keyword in `pxd` files #21696\n * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n-* fix conflicting language options (`-std=c++11 -std=c99`)\n+* fix conflicting language options (`-std=c++11 -std=c99`), #21749 should take care of at last some of that.\n * Singular 4 to be checked when it finally lands\n  \n ---\n``````\n",
    "created_at": "2016-10-23T19:45:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138597",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 * fix `import_array` in `finance/time_series.pyx` now fixed by #20596
 * fix abuse of `inline` keyword in `pxd` files #21696
 * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
-* fix conflicting language options (`-std=c++11 -std=c99`)
+* fix conflicting language options (`-std=c++11 -std=c99`), #21749 should take care of at last some of that.
 * Singular 4 to be checked when it finally lands
  
 ---
``````




---

archive/issue_comments_138598.json:
```json
{
    "body": "<a id='comment:90'></a>\nI've been playing with building Sage with clang 3.9 on Linux (gentoo), and it almost works. The only package that fails in a way I can't seem to be able to fix on the spot is `pyzmq` (see my comments at the end of https://github.com/zeromq/pyzmq/issues/468), and to build `sagelib` I only need\n\n```\ndiff --git a/build/pkgs/libgap/spkg-install b/build/pkgs/libgap/spkg-install\nindex dd6be37..3a167c9 100755\n--- a/build/pkgs/libgap/spkg-install\n+++ b/build/pkgs/libgap/spkg-install\n@@ -41,6 +41,8 @@ for patch in ../patches/*.patch; do\n     fi\n done\n \n+CFLAGS=\"$CFLAGS -fPIC\"\n+\n echo \"Configuring libGAP...\"\n ./configure --disable-static \\\n     CFLAGS=\"$CFLAGS\" CXXFLAGS=\"$CXXFLAGS\" CPPFLAGS=\"$CPPFLAGS\" \\\ndiff --git a/src/sage/libs/m4ri.pxd b/src/sage/libs/m4ri.pxd\nindex a1fe594..ea07121 100644\n--- a/src/sage/libs/m4ri.pxd\n+++ b/src/sage/libs/m4ri.pxd\n@@ -1,4 +1,3 @@\n-# distutils: extra_compile_args = -std=c99\n \n cdef extern from \"m4ri/m4ri.h\":\n     ctypedef int rci_t\n```\n\nAfter this, I can create a working sage instance by doing `./sage --pip install ipython`, which pulls `pyzmq-16.0.2`, and all gets installed nicely.\n(there is too much clever AI behind compiler recongnition in Sage's instance of `pyzmq` - perhaps we should upgrade?)\n\nRunning tests now (using `./sage -tp`)\n\nNote that `pynac` fix I proposed on #21701 is not needed here, so it's just an older `clang` on OSX, it seems.",
    "created_at": "2016-11-23T22:48:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138598",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:90'></a>
I've been playing with building Sage with clang 3.9 on Linux (gentoo), and it almost works. The only package that fails in a way I can't seem to be able to fix on the spot is `pyzmq` (see my comments at the end of https://github.com/zeromq/pyzmq/issues/468), and to build `sagelib` I only need

```
diff --git a/build/pkgs/libgap/spkg-install b/build/pkgs/libgap/spkg-install
index dd6be37..3a167c9 100755
--- a/build/pkgs/libgap/spkg-install
+++ b/build/pkgs/libgap/spkg-install
@@ -41,6 +41,8 @@ for patch in ../patches/*.patch; do
     fi
 done
 
+CFLAGS="$CFLAGS -fPIC"
+
 echo "Configuring libGAP..."
 ./configure --disable-static \
     CFLAGS="$CFLAGS" CXXFLAGS="$CXXFLAGS" CPPFLAGS="$CPPFLAGS" \
diff --git a/src/sage/libs/m4ri.pxd b/src/sage/libs/m4ri.pxd
index a1fe594..ea07121 100644
--- a/src/sage/libs/m4ri.pxd
+++ b/src/sage/libs/m4ri.pxd
@@ -1,4 +1,3 @@
-# distutils: extra_compile_args = -std=c99
 
 cdef extern from "m4ri/m4ri.h":
     ctypedef int rci_t
```

After this, I can create a working sage instance by doing `./sage --pip install ipython`, which pulls `pyzmq-16.0.2`, and all gets installed nicely.
(there is too much clever AI behind compiler recongnition in Sage's instance of `pyzmq` - perhaps we should upgrade?)

Running tests now (using `./sage -tp`)

Note that `pynac` fix I proposed on #21701 is not needed here, so it's just an older `clang` on OSX, it seems.



---

archive/issue_comments_138599.json:
```json
{
    "body": "<a id='comment:91'></a>\nNot necessarily. Did you build `clang` to use `clang`'s version of `libstdc++` or are you still using gcc's `libstdc++`. There is no issue so long as you are using gcc's `libstdc++`.",
    "created_at": "2016-11-23T22:55:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138599",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:91'></a>
Not necessarily. Did you build `clang` to use `clang`'s version of `libstdc++` or are you still using gcc's `libstdc++`. There is no issue so long as you are using gcc's `libstdc++`.



---

archive/issue_comments_138600.json:
```json
{
    "body": "<a id='comment:92'></a>\nAnd you need `clang-9999` to get the right dependencies to `default-libcxx` which is llvm's own `libstdc++`. So I'll assume you are not in the right position to compare with OS X.",
    "created_at": "2016-11-23T23:03:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138600",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:92'></a>
And you need `clang-9999` to get the right dependencies to `default-libcxx` which is llvm's own `libstdc++`. So I'll assume you are not in the right position to compare with OS X.



---

archive/issue_comments_138601.json:
```json
{
    "body": "<a id='comment:93'></a>\nReplying to [fbissey](#comment%3A91):\n> Not necessarily. Did you build `clang` to use `clang`'s version of `libstdc++` or are you still using gcc's `libstdc++`. There is no issue so long as you are using gcc's `libstdc++`.\n\n\nhmm, I did `emerge --ask clang` and it pulled in few other things too.",
    "created_at": "2016-11-23T23:08:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138601",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:93'></a>
Replying to [fbissey](#comment%3A91):
> Not necessarily. Did you build `clang` to use `clang`'s version of `libstdc++` or are you still using gcc's `libstdc++`. There is no issue so long as you are using gcc's `libstdc++`.


hmm, I did `emerge --ask clang` and it pulled in few other things too.



---

archive/issue_comments_138602.json:
```json
{
    "body": "<a id='comment:94'></a>\nReplying to [fbissey](#comment%3A92):\n> And you need `clang-9999` to get the right dependencies to `default-libcxx` which is llvm's own `libstdc++`. So I'll assume you are not in the right position to compare with OS X.\n\n\nYou are right, it still uses gcc's libs.\nIs there a clean gentoo way to build such a toolchain? All I get is\n\n```\n# emerge --ask clang-9999\n!!! 'clang-9999' is not a valid package atom.\n!!! Please check ebuild(5) for full details.\n```\n\nPS - OK, I see, it should have been `emerge --ask clang-9999`...",
    "created_at": "2016-11-23T23:18:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138602",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:94'></a>
Replying to [fbissey](#comment%3A92):
> And you need `clang-9999` to get the right dependencies to `default-libcxx` which is llvm's own `libstdc++`. So I'll assume you are not in the right position to compare with OS X.


You are right, it still uses gcc's libs.
Is there a clean gentoo way to build such a toolchain? All I get is

```
# emerge --ask clang-9999
!!! 'clang-9999' is not a valid package atom.
!!! Please check ebuild(5) for full details.
```

PS - OK, I see, it should have been `emerge --ask clang-9999`...



---

archive/issue_comments_138603.json:
```json
{
    "body": "<a id='comment:95'></a>\nThe `9999` denotes a hot version (from git master). There appears to be ebuilds for 3.9.0 (libcxx and libcxxabi) and you should be able to emerge those but you will have to pass some extra arguments to use it instead of gcc's version.\n\nEmerging a `9999` is always a bit tricky. Only do it if you are comfortable with emerge. and for what you did the correct syntax is\n\n```\nemerge =clang-9999\n```\nanything including a version number needs \"=\".",
    "created_at": "2016-11-23T23:49:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138603",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:95'></a>
The `9999` denotes a hot version (from git master). There appears to be ebuilds for 3.9.0 (libcxx and libcxxabi) and you should be able to emerge those but you will have to pass some extra arguments to use it instead of gcc's version.

Emerging a `9999` is always a bit tricky. Only do it if you are comfortable with emerge. and for what you did the correct syntax is

```
emerge =clang-9999
```
anything including a version number needs "=".



---

archive/issue_comments_138604.json:
```json
{
    "body": "<a id='comment:96'></a>\nReplying to [dimpase](#comment%3A90):\n> I've been playing with building Sage with clang 3.9 on Linux (gentoo), and it almost works. The only package that fails in a way I can't seem to be able to fix on the spot is `pyzmq` (see my comments at the end of https://github.com/zeromq/pyzmq/issues/468), and to build `sagelib` I only need\n> \n> ```\n> diff --git a/build/pkgs/libgap/spkg-install b/build/pkgs/libgap/spkg-install\n> index dd6be37..3a167c9 100755\n> --- a/build/pkgs/libgap/spkg-install\n> +++ b/build/pkgs/libgap/spkg-install\n> @@ -41,6 +41,8 @@ for patch in ../patches/*.patch; do\n>      fi\n>  done\n>  \n> +CFLAGS=\"$CFLAGS -fPIC\"\n> +\n>  echo \"Configuring libGAP...\"\n>  ./configure --disable-static \\\n>      CFLAGS=\"$CFLAGS\" CXXFLAGS=\"$CXXFLAGS\" CPPFLAGS=\"$CPPFLAGS\" \\\n> diff --git a/src/sage/libs/m4ri.pxd b/src/sage/libs/m4ri.pxd\n> index a1fe594..ea07121 100644\n> --- a/src/sage/libs/m4ri.pxd\n> +++ b/src/sage/libs/m4ri.pxd\n> @@ -1,4 +1,3 @@\n> -# distutils: extra_compile_args = -std=c99\n>  \n>  cdef extern from \"m4ri/m4ri.h\":\n>      ctypedef int rci_t\n> ```\n> \n> After this, I can create a working sage instance by doing `./sage --pip install ipython`, which pulls `pyzmq-16.0.2`, and all gets installed nicely.\n> (there is too much clever AI behind compiler recongnition in Sage's instance of `pyzmq` - perhaps we should upgrade?)\n> \n> Running tests now (using `./sage -tp`)\n> \n> Note that `pynac` fix I proposed on #21701 is not needed here, so it's just an older `clang` on OSX, it seems.\n\n\n\nHum, Jeroen and I have just added that (`m4ri.pxd`) and I think it adds a genuine conflict. We will have to examine this carefully.",
    "created_at": "2016-11-24T00:38:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138604",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:96'></a>
Replying to [dimpase](#comment%3A90):
> I've been playing with building Sage with clang 3.9 on Linux (gentoo), and it almost works. The only package that fails in a way I can't seem to be able to fix on the spot is `pyzmq` (see my comments at the end of https://github.com/zeromq/pyzmq/issues/468), and to build `sagelib` I only need
> 
> ```
> diff --git a/build/pkgs/libgap/spkg-install b/build/pkgs/libgap/spkg-install
> index dd6be37..3a167c9 100755
> --- a/build/pkgs/libgap/spkg-install
> +++ b/build/pkgs/libgap/spkg-install
> @@ -41,6 +41,8 @@ for patch in ../patches/*.patch; do
>      fi
>  done
>  
> +CFLAGS="$CFLAGS -fPIC"
> +
>  echo "Configuring libGAP..."
>  ./configure --disable-static \
>      CFLAGS="$CFLAGS" CXXFLAGS="$CXXFLAGS" CPPFLAGS="$CPPFLAGS" \
> diff --git a/src/sage/libs/m4ri.pxd b/src/sage/libs/m4ri.pxd
> index a1fe594..ea07121 100644
> --- a/src/sage/libs/m4ri.pxd
> +++ b/src/sage/libs/m4ri.pxd
> @@ -1,4 +1,3 @@
> -# distutils: extra_compile_args = -std=c99
>  
>  cdef extern from "m4ri/m4ri.h":
>      ctypedef int rci_t
> ```
> 
> After this, I can create a working sage instance by doing `./sage --pip install ipython`, which pulls `pyzmq-16.0.2`, and all gets installed nicely.
> (there is too much clever AI behind compiler recongnition in Sage's instance of `pyzmq` - perhaps we should upgrade?)
> 
> Running tests now (using `./sage -tp`)
> 
> Note that `pynac` fix I proposed on #21701 is not needed here, so it's just an older `clang` on OSX, it seems.



Hum, Jeroen and I have just added that (`m4ri.pxd`) and I think it adds a genuine conflict. We will have to examine this carefully.



---

archive/issue_comments_138605.json:
```json
{
    "body": "<a id='comment:97'></a>\nOK, was your problem \n\n```\n[sagelib-7.5.beta3] [ 1/59] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.o -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -I/Users/fbissey/build/sage/local/include -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -fno-strict-aliasing\n[sagelib-7.5.beta3] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'\n```\nDima?",
    "created_at": "2016-11-24T00:56:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138605",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:97'></a>
OK, was your problem 

```
[sagelib-7.5.beta3] [ 1/59] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.o -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -I/Users/fbissey/build/sage/local/include -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -fno-strict-aliasing
[sagelib-7.5.beta3] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'
```
Dima?



---

archive/issue_comments_138606.json:
```json
{
    "body": "<a id='comment:98'></a>\nIt may actually be a case of overlinking `m4ri` is called in more place than it should. sage-on-gentoo compiled with `--as-needed` only report the following users of `m4ri`\n\n```\nreadelf -d `find /usr/lib64/python2.7/site-packages/sage -name \\*.so` | grep -C 6 libm4ri-\n 0x0000000000000000 (NULL)               0x0\n\nFile: /usr/lib64/python2.7/site-packages/sage/modules/vector_mod2_dense.so\n\nDynamic section at offset 0x15cd0 contains 27 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x3e20\n 0x000000000000000d (FINI)               0x12734\n 0x0000000000000019 (INIT_ARRAY)         0x215cb8\n--\n\nDynamic section at offset 0x10b870 contains 32 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libbrial.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libbrial_groebner.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x21c18\n--\n\nFile: /usr/lib64/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so\n\nDynamic section at offset 0x38c60 contains 28 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libgd.so.3]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x6ea8\n 0x000000000000000d (FINI)               0x32dc0\n 0x0000000000000019 (INIT_ARRAY)         0x238c48\n--\n\nFile: /usr/lib64/python2.7/site-packages/sage/matrix/matrix_gf2e_dense.so\n\nDynamic section at offset 0x2ec50 contains 28 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libm4rie-0.0.20150908.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x6400\n 0x000000000000000d (FINI)               0x28150\n 0x0000000000000019 (INIT_ARRAY)         0x22ec38\n```\nOnly 4 in total. And `sage/rings/polynomial/polynomial_gf2x.so` is not one of them.\n\n```\nreadelf -d /usr/lib64/python2.7/site-packages/sage/rings/polynomial/polynomial_gf2x.so\n\nDynamic section at offset 0x38c10 contains 28 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libntl.so.31]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x7510\n```",
    "created_at": "2016-11-24T01:13:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138606",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:98'></a>
It may actually be a case of overlinking `m4ri` is called in more place than it should. sage-on-gentoo compiled with `--as-needed` only report the following users of `m4ri`

```
readelf -d `find /usr/lib64/python2.7/site-packages/sage -name \*.so` | grep -C 6 libm4ri-
 0x0000000000000000 (NULL)               0x0

File: /usr/lib64/python2.7/site-packages/sage/modules/vector_mod2_dense.so

Dynamic section at offset 0x15cd0 contains 27 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x3e20
 0x000000000000000d (FINI)               0x12734
 0x0000000000000019 (INIT_ARRAY)         0x215cb8
--

Dynamic section at offset 0x10b870 contains 32 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libbrial.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libbrial_groebner.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x21c18
--

File: /usr/lib64/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so

Dynamic section at offset 0x38c60 contains 28 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]
 0x0000000000000001 (NEEDED)             Shared library: [libgd.so.3]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x6ea8
 0x000000000000000d (FINI)               0x32dc0
 0x0000000000000019 (INIT_ARRAY)         0x238c48
--

File: /usr/lib64/python2.7/site-packages/sage/matrix/matrix_gf2e_dense.so

Dynamic section at offset 0x2ec50 contains 28 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libm4rie-0.0.20150908.so]
 0x0000000000000001 (NEEDED)             Shared library: [libm4ri-0.0.20140914.so]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x6400
 0x000000000000000d (FINI)               0x28150
 0x0000000000000019 (INIT_ARRAY)         0x22ec38
```
Only 4 in total. And `sage/rings/polynomial/polynomial_gf2x.so` is not one of them.

```
readelf -d /usr/lib64/python2.7/site-packages/sage/rings/polynomial/polynomial_gf2x.so

Dynamic section at offset 0x38c10 contains 28 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libntl.so.31]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x7510
```



---

archive/issue_comments_138607.json:
```json
{
    "body": "<a id='comment:99'></a>\nArghhh! `sage/rings/polynomial/polynomial_gf2x.pyx` uses 2 function from `m4ri` and both of them are macros, which is why `libm4ri` doesn't appear in the final link.",
    "created_at": "2016-11-24T01:34:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138607",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:99'></a>
Arghhh! `sage/rings/polynomial/polynomial_gf2x.pyx` uses 2 function from `m4ri` and both of them are macros, which is why `libm4ri` doesn't appear in the final link.



---

archive/issue_comments_138608.json:
```json
{
    "body": "<a id='comment:0'></a>\nIt seems that all the users of `m4ri` currently have an entry with appropriate flags in `module_list.py` so removing the line from `m4ri.pxd` works. But this has to be sorted in a better way.",
    "created_at": "2016-11-24T01:44:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138608",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
It seems that all the users of `m4ri` currently have an entry with appropriate flags in `module_list.py` so removing the line from `m4ri.pxd` works. But this has to be sorted in a better way.



---

archive/issue_comments_138609.json:
```json
{
    "body": "<a id='comment:1'></a>\nWe have compile! Documentation building in progress. It may take a little bit of time before I can run doctests but we are at a new stage.",
    "created_at": "2016-11-24T01:52:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138609",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
We have compile! Documentation building in progress. It may take a little bit of time before I can run doctests but we are at a new stage.



---

archive/issue_comments_138610.json:
```json
{
    "body": "<a id='comment:102'></a>\nReplying to [fbissey](#comment%3A97):\n> OK, was your problem \n> \n> ```\n> [sagelib-7.5.beta3] [ 1/59] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.o -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -I/Users/fbissey/build/sage/local/include -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -fno-strict-aliasing\n> [sagelib-7.5.beta3] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'\n> ```\n\nright, this one.",
    "created_at": "2016-11-24T08:46:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138610",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:102'></a>
Replying to [fbissey](#comment%3A97):
> OK, was your problem 
> 
> ```
> [sagelib-7.5.beta3] [ 1/59] clang -fno-strict-aliasing -I/Users/fbissey/build/sage/local/var/tmp/sage/build/python2-2.7.10.p3/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/cysignals -I/Users/fbissey/build/sage/local/include -I/Users/fbissey/build/sage/local/include/python2.7 -I/Users/fbissey/build/sage/local/lib/python2.7/site-packages/numpy/core/include -I/Users/fbissey/build/sage/src -I/Users/fbissey/build/sage/src/sage/ext -I/Users/fbissey/build/sage/src/build/cythonized -I/Users/fbissey/build/sage/src/build/cythonized/sage/ext -I/Users/fbissey/build/sage/local/include/python2.7 -c /Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.cpp -o build/temp.macosx-10.9-x86_64-2.7/Users/fbissey/build/sage/src/build/cythonized/sage/rings/polynomial/polynomial_gf2x.o -std=c99 -I/Users/fbissey/build/sage/local/include/m4ri -I/Users/fbissey/build/sage/local/include -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -fno-strict-aliasing
> [sagelib-7.5.beta3] error: invalid argument '-std=c99' not allowed with 'C++/ObjC++'
> ```

right, this one.



---

archive/issue_comments_138611.json:
```json
{
    "body": "<a id='comment:3'></a>\nSomething like https://github.com/cython/cython/pull/466 could help to better organize compiler flags, but upstream Cython doesn't seem to like it.",
    "created_at": "2016-11-24T09:44:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138611",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Something like https://github.com/cython/cython/pull/466 could help to better organize compiler flags, but upstream Cython doesn't seem to like it.



---

archive/issue_comments_138612.json:
```json
{
    "body": "<a id='comment:4'></a>\nWith a [tip](https://github.com/zeromq/pyzmq/issues/468#issuecomment-262770072) by Min, I am also able to complete the Linux/clang (4.0.0) build.\n\n(pyzmq still would need a fix---hopefully upstream...)",
    "created_at": "2016-11-24T13:06:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138612",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
With a [tip](https://github.com/zeromq/pyzmq/issues/468#issuecomment-262770072) by Min, I am also able to complete the Linux/clang (4.0.0) build.

(pyzmq still would need a fix---hopefully upstream...)



---

archive/issue_comments_138613.json:
```json
{
    "body": "<a id='comment:5'></a>\nthe results of make ptest are\n\n```\nsage -t src/sage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed\nsage -t src/sage/plot/graphics.py  # 1 doctest failed\nsage -t src/sage/plot/plot.py  # 1 doctest failed\nsage -t src/sage/plot/plot3d/shapes2.py  # 1 doctest failed\nsage -t src/sage/tests/cmdline.py  # 2 doctests failed\nsage -t src/sage/libs/gap/all_documented_functions.py  # Timed out\nsage -t src/sage/manifolds/differentiable/tensorfield.py  # Timed out\nsage -t src/sage/libs/gap/assigned_names.py  # Timed out\nsage -t src/sage/plot/plot3d/base.pyx  # 4 doctests failed\nsage -t src/sage/schemes/elliptic_curves/heegner.py  # 37 doctests failed\nsage -t src/sage/schemes/elliptic_curves/ell_rational_field.py  # 50 doctests failed\nsage -t src/sage/tests/book_stein_ent.py  # 3 doctests failed\nsage -t src/doc/en/prep/Calculus.rst  # 1 doctest failed\nsage -t src/sage/plot/plot3d/platonic.py  # 1 doctest failed\nsage -t src/sage/schemes/elliptic_curves/padics.py  # 28 doctests failed\nsage -t src/sage/schemes/elliptic_curves/sha_tate.py  # 26 doctests failed\nsage -t src/sage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed\nsage -t src/sage/schemes/elliptic_curves/BSD.py  # 21 doctests failed\nsage -t src/sage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed\nsage -t src/sage/schemes/elliptic_curves/height.py  # 2 doctests failed\nsage -t src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed\nsage -t src/sage/libs/eclib/interface.py  # 34 doctests failed\nsage -t src/sage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed\nsage -t src/sage/libs/eclib/mwrank.pyx  # 3 doctests failed\nsage -t src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t src/sage/misc/benchmark.py  # 3 doctests failed\nsage -t src/sage/tests/benchmark.py  # 1 doctest failed\nsage -t src/sage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed\nsage -t src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed\nsage -t src/sage/schemes/elliptic_curves/ell_egros.py  # 4 doctests failed\nsage -t src/sage/interfaces/mwrank.py  # 5 doctests failed\nsage -t src/sage/structure/coerce.pyx  # 1 doctest failed\nsage -t src/sage/rings/padics/CR_template.pxi  # 2 doctests failed\nsage -t src/sage/schemes/elliptic_curves/constructor.py  # 4 doctests failed\nsage -t src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 2376.2 seconds\n    cpu time: 6923.9 seconds\n    cumulative wall time: 17065.3 seconds\n```\nlooks like main issues are with number theory things like elliptic curves.",
    "created_at": "2016-11-24T13:58:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138613",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
the results of make ptest are

```
sage -t src/sage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed
sage -t src/sage/plot/graphics.py  # 1 doctest failed
sage -t src/sage/plot/plot.py  # 1 doctest failed
sage -t src/sage/plot/plot3d/shapes2.py  # 1 doctest failed
sage -t src/sage/tests/cmdline.py  # 2 doctests failed
sage -t src/sage/libs/gap/all_documented_functions.py  # Timed out
sage -t src/sage/manifolds/differentiable/tensorfield.py  # Timed out
sage -t src/sage/libs/gap/assigned_names.py  # Timed out
sage -t src/sage/plot/plot3d/base.pyx  # 4 doctests failed
sage -t src/sage/schemes/elliptic_curves/heegner.py  # 37 doctests failed
sage -t src/sage/schemes/elliptic_curves/ell_rational_field.py  # 50 doctests failed
sage -t src/sage/tests/book_stein_ent.py  # 3 doctests failed
sage -t src/doc/en/prep/Calculus.rst  # 1 doctest failed
sage -t src/sage/plot/plot3d/platonic.py  # 1 doctest failed
sage -t src/sage/schemes/elliptic_curves/padics.py  # 28 doctests failed
sage -t src/sage/schemes/elliptic_curves/sha_tate.py  # 26 doctests failed
sage -t src/sage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed
sage -t src/sage/schemes/elliptic_curves/BSD.py  # 21 doctests failed
sage -t src/sage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed
sage -t src/sage/schemes/elliptic_curves/height.py  # 2 doctests failed
sage -t src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed
sage -t src/sage/libs/eclib/interface.py  # 34 doctests failed
sage -t src/sage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed
sage -t src/sage/libs/eclib/mwrank.pyx  # 3 doctests failed
sage -t src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t src/sage/misc/benchmark.py  # 3 doctests failed
sage -t src/sage/tests/benchmark.py  # 1 doctest failed
sage -t src/sage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed
sage -t src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed
sage -t src/sage/schemes/elliptic_curves/ell_egros.py  # 4 doctests failed
sage -t src/sage/interfaces/mwrank.py  # 5 doctests failed
sage -t src/sage/structure/coerce.pyx  # 1 doctest failed
sage -t src/sage/rings/padics/CR_template.pxi  # 2 doctests failed
sage -t src/sage/schemes/elliptic_curves/constructor.py  # 4 doctests failed
sage -t src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 2376.2 seconds
    cpu time: 6923.9 seconds
    cumulative wall time: 17065.3 seconds
```
looks like main issues are with number theory things like elliptic curves.



---

archive/issue_comments_138614.json:
```json
{
    "body": "<a id='comment:6'></a>\nWell this is mine on OS X\n\n```\nsage -t --long src/sage/algebras/group_algebra.py  # 5 doctests failed\nsage -t --long src/sage/algebras/quaternion_algebra_element.py  # 4 doctests failed\nsage -t --long src/sage/algebras/quatalg/quaternion_algebra.py  # 8 doctests failed\nsage -t --long src/sage/algebras/quatalg/quaternion_algebra_element.pyx  # 38 doctests failed\nsage -t --long src/sage/arith/misc.py  # 20 doctests failed\nsage -t --long src/sage/calculus/calculus.py  # 19 doctests failed\nsage -t --long src/sage/categories/quotient_fields.py  # 2 doctests failed\nsage -t --long src/sage/categories/rings.py  # 8 doctests failed\nsage -t --long src/sage/crypto/lattice.py  # 1 doctest failed\nsage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\nsage -t --long src/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed\nsage -t --long src/sage/interfaces/singular.py  # 1 doctest failed\nsage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed\nsage -t --long src/sage/matrix/matrix2.pyx  # 3 doctests failed\nsage -t --long src/sage/matrix/matrix_integer_dense.pyx  # 13 doctests failed\nsage -t --long src/sage/matrix/matrix_rational_dense.pyx  # 1 doctest failed\nsage -t --long src/sage/misc/functional.py  # 1 doctest failed\nsage -t --long src/sage/modular/etaproducts.py  # 10 doctests failed\nsage -t --long src/sage/modules/free_module_integer.py  # 57 doctests failed\nsage -t --long src/sage/modules/vector_space_morphism.py  # 3 doctests failed\nsage -t --long src/sage/plot/graphics.py  # 1 doctest failed\nsage -t --long src/sage/plot/plot.py  # 1 doctest failed\nsage -t --long src/sage/plot/plot3d/base.pyx  # 4 doctests failed\nsage -t --long src/sage/plot/plot3d/platonic.py  # 1 doctest failed\nsage -t --long src/sage/plot/plot3d/shapes2.py  # 1 doctest failed\nsage -t --long src/sage/repl/preparse.py  # 1 doctest failed\nsage -t --long src/sage/rings/complex_number.pyx  # 4 doctests failed\nsage -t --long src/sage/rings/integer_ring.pyx  # 5 doctests failed\nsage -t --long src/sage/rings/misc.py  # 1 doctest failed\nsage -t --long src/sage/rings/real_mpfi.pyx  # 3 doctests failed\nsage -t --long src/sage/rings/real_mpfr.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/ring.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/tests.py  # 2 doctests failed\nsage -t --long src/sage/rings/finite_rings/residue_field.pyx  # 14 doctests failed\nsage -t --long src/sage/rings/number_field/galois_group.py  # 8 doctests failed\nsage -t --long src/sage/rings/number_field/number_field_base.pyx  # 15 doctests failed\nsage -t --long src/sage/rings/number_field/number_field_rel.py  # 10 doctests failed\nsage -t --long src/sage/rings/number_field/order.py  # 3 doctests failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\nsage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage -t --long src/sage/rings/polynomial/polynomial_element.pyx  # 7 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_modn_dense_ntl.pyx  # 6 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_number_field.pyx  # 19 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 15 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/heegner.py  # 33 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t --long src/sage/schemes/generic/algebraic_scheme.py  # 10 doctests failed\nsage -t --long src/sage/schemes/projective/projective_morphism.py  # 16 doctests failed\nsage -t --long src/sage/schemes/toric/divisor.py  # 2 doctests failed\nsage -t --long src/sage/schemes/toric/ideal.py  # 45 doctests failed\nsage -t --long src/sage/schemes/toric/points.py  # 1 doctest failed\nsage -t --long src/sage/schemes/toric/variety.py  # 4 doctests failed\nsage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed\nsage -t --long src/sage/structure/element.pyx  # 5 doctests failed\nsage -t --long src/sage/structure/formal_sum.py  # 1 doctest failed\nsage -t --long src/sage/tests/french_book/calculus_doctest.py  # 3 doctests failed\nsage -t --long src/sage/tests/french_book/domaines_doctest.py  # 3 doctests failed\nsage -t --long src/sage/tests/french_book/polynomes.py  # 1 doctest failed\nsage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed\nsage -t --long src/doc/en/prep/Quickstarts/Abstract-Algebra.rst  # 3 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 3 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/nf_introduction.rst  # 5 doctests failed\n```\nThere is one segfault related to `brial` to investigate. A lot of plotting fail a specific comparison and there is a strange problem with `fplll`\n\n```\n        from fpylll import LLL, IntegerMatrix\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/__init__.py\", line 6, in <module>\n        from .fplll.enumeration import Enumeration, EnumerationError\n    ImportError: dlopen(/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so, 2): Symbol not found: __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd\n      Referenced from: /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so\n      Expected in: flat namespace\n     in /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so\n```\nI am guessing the symbol is not in the \"flat namespace\".\nThat warning happens a lot in plots:\n\n```\nsage -t --long src/sage/plot/plot.py\n**********************************************************************\nFile \"src/sage/plot/plot.py\", line 1678, in sage.plot.plot.plot\nFailed example:\n    plot(2*x+1,(x,0,5),ticks=[[0,1,e,pi,sqrt(20)],2],tick_formatter=\"latex\")\nExpected:\n    Graphics object consisting of 1 graphics primitive\nGot:\n    doctest:warning\n      File \"/Users/fbissey/build/sage-clang/src/bin/sage-runtests\", line 89, in <module>\n        err = DC.run()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 1130, in run\n        self.run_doctests()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 854, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1700, in dispatch\n        self.parallel_dispatch()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1590, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1866, in start\n        super(DocTestWorker, self).start()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/process.py\", line 130, in start\n        self._popen = Popen(self)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/forking.py\", line 126, in __init__\n        code = process_obj._bootstrap()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n        self.run()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1839, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2132, in __call__\n        runner.run(test)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 636, in run\n        return self._run(test, compileflags, out)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.plot.plot[99]>\", line 1, in <module>\n        plot(Integer(2)*x+Integer(1),(x,Integer(0),Integer(5)),ticks=[[Integer(0),Integer(1),e,pi,sqrt(Integer(20))],Integer(2)],tick_formatter=\"latex\")\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 765, in displayhook\n        plain_text, rich_output = self._rich_output_formatter(obj, dict())\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 623, in _rich_output_formatter\n        rich_output = self._call_rich_repr(obj, rich_repr_kwds)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 583, in _call_rich_repr\n        return obj._rich_repr_(self)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 908, in _rich_repr_\n        self.save, kwds, file_ext, output_container)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 711, in graphics_from_save\n        save_function(filename, **kwds)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 473, in wrapper\n        return func(*args, **kwds)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 3206, in save\n        figure.tight_layout()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/figure.py\", line 1754, in tight_layout\n        rect=rect)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/tight_layout.py\", line 349, in get_tight_layout_figure\n        pad=pad, h_pad=h_pad, w_pad=w_pad)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/tight_layout.py\", line 126, in auto_adjust_subplotpars\n        tight_bbox_raw = union([ax.get_tightbbox(renderer) for ax in subplots])\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axes/_base.py\", line 3679, in get_tightbbox\n        bb_xaxis = self.xaxis.get_tightbbox(renderer)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py\", line 1073, in get_tightbbox\n        ticks_to_draw = self._update_ticks(renderer)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py\", line 1038, in _update_ticks\n        if not mtransforms.interval_contains(interval_expanded, loc):\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/transforms.py\", line 2780, in interval_contains\n        ((a < b) and (a <= val and b >= val))\n    :\n    RuntimeWarning: invalid value encountered in greater_equal\n    Graphics object consisting of 1 graphics primitive\n```",
    "created_at": "2016-11-24T18:12:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138614",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Well this is mine on OS X

```
sage -t --long src/sage/algebras/group_algebra.py  # 5 doctests failed
sage -t --long src/sage/algebras/quaternion_algebra_element.py  # 4 doctests failed
sage -t --long src/sage/algebras/quatalg/quaternion_algebra.py  # 8 doctests failed
sage -t --long src/sage/algebras/quatalg/quaternion_algebra_element.pyx  # 38 doctests failed
sage -t --long src/sage/arith/misc.py  # 20 doctests failed
sage -t --long src/sage/calculus/calculus.py  # 19 doctests failed
sage -t --long src/sage/categories/quotient_fields.py  # 2 doctests failed
sage -t --long src/sage/categories/rings.py  # 8 doctests failed
sage -t --long src/sage/crypto/lattice.py  # 1 doctest failed
sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
sage -t --long src/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed
sage -t --long src/sage/interfaces/singular.py  # 1 doctest failed
sage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed
sage -t --long src/sage/matrix/matrix2.pyx  # 3 doctests failed
sage -t --long src/sage/matrix/matrix_integer_dense.pyx  # 13 doctests failed
sage -t --long src/sage/matrix/matrix_rational_dense.pyx  # 1 doctest failed
sage -t --long src/sage/misc/functional.py  # 1 doctest failed
sage -t --long src/sage/modular/etaproducts.py  # 10 doctests failed
sage -t --long src/sage/modules/free_module_integer.py  # 57 doctests failed
sage -t --long src/sage/modules/vector_space_morphism.py  # 3 doctests failed
sage -t --long src/sage/plot/graphics.py  # 1 doctest failed
sage -t --long src/sage/plot/plot.py  # 1 doctest failed
sage -t --long src/sage/plot/plot3d/base.pyx  # 4 doctests failed
sage -t --long src/sage/plot/plot3d/platonic.py  # 1 doctest failed
sage -t --long src/sage/plot/plot3d/shapes2.py  # 1 doctest failed
sage -t --long src/sage/repl/preparse.py  # 1 doctest failed
sage -t --long src/sage/rings/complex_number.pyx  # 4 doctests failed
sage -t --long src/sage/rings/integer_ring.pyx  # 5 doctests failed
sage -t --long src/sage/rings/misc.py  # 1 doctest failed
sage -t --long src/sage/rings/real_mpfi.pyx  # 3 doctests failed
sage -t --long src/sage/rings/real_mpfr.pyx  # 1 doctest failed
sage -t --long src/sage/rings/ring.pyx  # 1 doctest failed
sage -t --long src/sage/rings/tests.py  # 2 doctests failed
sage -t --long src/sage/rings/finite_rings/residue_field.pyx  # 14 doctests failed
sage -t --long src/sage/rings/number_field/galois_group.py  # 8 doctests failed
sage -t --long src/sage/rings/number_field/number_field_base.pyx  # 15 doctests failed
sage -t --long src/sage/rings/number_field/number_field_rel.py  # 10 doctests failed
sage -t --long src/sage/rings/number_field/order.py  # 3 doctests failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
sage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage -t --long src/sage/rings/polynomial/polynomial_element.pyx  # 7 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_modn_dense_ntl.pyx  # 6 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_number_field.pyx  # 19 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 15 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/heegner.py  # 33 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t --long src/sage/schemes/generic/algebraic_scheme.py  # 10 doctests failed
sage -t --long src/sage/schemes/projective/projective_morphism.py  # 16 doctests failed
sage -t --long src/sage/schemes/toric/divisor.py  # 2 doctests failed
sage -t --long src/sage/schemes/toric/ideal.py  # 45 doctests failed
sage -t --long src/sage/schemes/toric/points.py  # 1 doctest failed
sage -t --long src/sage/schemes/toric/variety.py  # 4 doctests failed
sage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed
sage -t --long src/sage/structure/element.pyx  # 5 doctests failed
sage -t --long src/sage/structure/formal_sum.py  # 1 doctest failed
sage -t --long src/sage/tests/french_book/calculus_doctest.py  # 3 doctests failed
sage -t --long src/sage/tests/french_book/domaines_doctest.py  # 3 doctests failed
sage -t --long src/sage/tests/french_book/polynomes.py  # 1 doctest failed
sage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed
sage -t --long src/doc/en/prep/Quickstarts/Abstract-Algebra.rst  # 3 doctests failed
sage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 3 doctests failed
sage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/nf_introduction.rst  # 5 doctests failed
```
There is one segfault related to `brial` to investigate. A lot of plotting fail a specific comparison and there is a strange problem with `fplll`

```
        from fpylll import LLL, IntegerMatrix
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/__init__.py", line 6, in <module>
        from .fplll.enumeration import Enumeration, EnumerationError
    ImportError: dlopen(/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so, 2): Symbol not found: __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd
      Referenced from: /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so
      Expected in: flat namespace
     in /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so
```
I am guessing the symbol is not in the "flat namespace".
That warning happens a lot in plots:

```
sage -t --long src/sage/plot/plot.py
**********************************************************************
File "src/sage/plot/plot.py", line 1678, in sage.plot.plot.plot
Failed example:
    plot(2*x+1,(x,0,5),ticks=[[0,1,e,pi,sqrt(20)],2],tick_formatter="latex")
Expected:
    Graphics object consisting of 1 graphics primitive
Got:
    doctest:warning
      File "/Users/fbissey/build/sage-clang/src/bin/sage-runtests", line 89, in <module>
        err = DC.run()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1130, in run
        self.run_doctests()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/control.py", line 854, in run_doctests
        self.dispatcher.dispatch()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1700, in dispatch
        self.parallel_dispatch()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1590, in parallel_dispatch
        w.start()  # This might take some time
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1866, in start
        super(DocTestWorker, self).start()
      File "/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/Users/fbissey/build/sage-clang/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1839, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2132, in __call__
        runner.run(test)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 636, in run
        return self._run(test, compileflags, out)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.plot.plot[99]>", line 1, in <module>
        plot(Integer(2)*x+Integer(1),(x,Integer(0),Integer(5)),ticks=[[Integer(0),Integer(1),e,pi,sqrt(Integer(20))],Integer(2)],tick_formatter="latex")
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 765, in displayhook
        plain_text, rich_output = self._rich_output_formatter(obj, dict())
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 623, in _rich_output_formatter
        rich_output = self._call_rich_repr(obj, rich_repr_kwds)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 583, in _call_rich_repr
        return obj._rich_repr_(self)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 908, in _rich_repr_
        self.save, kwds, file_ext, output_container)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 711, in graphics_from_save
        save_function(filename, **kwds)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 473, in wrapper
        return func(*args, **kwds)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 3206, in save
        figure.tight_layout()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/figure.py", line 1754, in tight_layout
        rect=rect)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/tight_layout.py", line 349, in get_tight_layout_figure
        pad=pad, h_pad=h_pad, w_pad=w_pad)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/tight_layout.py", line 126, in auto_adjust_subplotpars
        tight_bbox_raw = union([ax.get_tightbbox(renderer) for ax in subplots])
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axes/_base.py", line 3679, in get_tightbbox
        bb_xaxis = self.xaxis.get_tightbbox(renderer)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py", line 1073, in get_tightbbox
        ticks_to_draw = self._update_ticks(renderer)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py", line 1038, in _update_ticks
        if not mtransforms.interval_contains(interval_expanded, loc):
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/transforms.py", line 2780, in interval_contains
        ((a < b) and (a <= val and b >= val))
    :
    RuntimeWarning: invalid value encountered in greater_equal
    Graphics object consisting of 1 graphics primitive
```



---

archive/issue_comments_138615.json:
```json
{
    "body": "<a id='comment:7'></a>\nAnd the segfaults\n* `sage/rings/polynomial/multi_polynomial_sequence.py `\n\n```\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 1089 ##\n0\nsage: B.<a,b,c,d> = BooleanPolynomialRing() ## line 1145 ##\nsage: F = Sequence([c + d + b + 1, a + c + d, a*b + c, b*c*d + c]) ## line 1146 ##\nsage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##\n------------------------------------------------------------------------\n0   signals.so                          0x000000010604db21 print_backtrace + 65\n1   signals.so                          0x000000010605115c sigdie + 60\n2   signals.so                          0x00000001060510cf cysigs_signal_handler + 351\n3   libsystem_platform.dylib            0x00007fffbdabcbba _sigtramp + 26\n4   ???                                 0x0000000105a5ee00 0x0 + 4389727744\n5   pbori.so                            0x000000019198d45f _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479\n6   pbori.so                            0x000000019198cf43 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275\n7   pbori.so                            0x000000019198cc50 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192\n8   libpython2.7.dylib                  0x000000010591714a PyEval_EvalFrameEx + 18394\n9   libpython2.7.dylib                  0x000000010591a3e2 fast_function + 338\n```\n* `sage/rings/polynomial/pbori.pyx` (says abort but segfault a lot before aborting)\n\n```\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 4670 ##\n0\nsage: B.<x0,x1,x2,x3> = BooleanPolynomialRing(4) ## line 4689 ##\nsage: I = B.ideal((x0 + x1 + x2 + x3, x0*x1 + x1*x2 + x0*x3 + x2*x3, x0*x1*x2 + x0*x1*x3 + x0*x2*x3 + x1*x2*x3, x0*x1*x2*x3 + 1)) ## line 4690 ##\nsage: gb = I.groebner_basis() ## line 4694 ##\nsage: f,g,h,i = I.gens() ## line 4695 ##\nsage: f.reduce(gb) ## line 4696 ##\nsage: p = f*g + x0*h + x2*i ## line 4698 ##\nsage: p.reduce(gb) ## line 4699 ##\nsage: p.reduce(I) ## line 4701 ##\nAssertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.\n------------------------------------------------------------------------\n0   signals.so                          0x0000000102c38b21 print_backtrace + 65\n1   signals.so                          0x0000000102c3c15c sigdie + 60\n2   signals.so                          0x0000000102c3c0ad cysigs_signal_handler + 317\n3   libsystem_platform.dylib            0x00007fffbdabcbba _sigtramp + 26\n4   ???                                 0x00007fb02d196af0 0x0 + 140394647612144\n5   libsystem_c.dylib                   0x00007fffbd943420 abort + 129\n6   libsystem_c.dylib                   0x00007fffbd90a893 basename_r + 0\n7   libbrial_groebner.0.dylib           0x000000018e7df737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551\n8   libbrial_groebner.0.dylib           0x000000018e7df4ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47\n9   libbrial_groebner.0.dylib           0x000000018e7df4bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29\n10  libbrial_groebner.0.dylib           0x000000018e79805c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44\n11  libbrial_groebner.0.dylib           0x000000018e7e79ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61\n12  libbrial_groebner.0.dylib           0x000000018e819ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39\n13  libbrial_groebner.0.dylib           0x000000018e81808a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186\n14  libbrial_groebner.0.dylib           0x000000018e817e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262\n15  pbori.so                            0x000000018e5410c1 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177\n16  pbori.so                            0x000000018e4cdc9a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154\n17  pbori.so                            0x000000018e529621 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_131reduceP7_objectS0_ + 2289\n18  libpython2.7.dylib                  0x000000010250614a PyEval_EvalFrameEx + 18394\n```",
    "created_at": "2016-11-24T18:18:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138615",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
And the segfaults
* `sage/rings/polynomial/multi_polynomial_sequence.py `

```
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 1089 ##
0
sage: B.<a,b,c,d> = BooleanPolynomialRing() ## line 1145 ##
sage: F = Sequence([c + d + b + 1, a + c + d, a*b + c, b*c*d + c]) ## line 1146 ##
sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##
------------------------------------------------------------------------
0   signals.so                          0x000000010604db21 print_backtrace + 65
1   signals.so                          0x000000010605115c sigdie + 60
2   signals.so                          0x00000001060510cf cysigs_signal_handler + 351
3   libsystem_platform.dylib            0x00007fffbdabcbba _sigtramp + 26
4   ???                                 0x0000000105a5ee00 0x0 + 4389727744
5   pbori.so                            0x000000019198d45f _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479
6   pbori.so                            0x000000019198cf43 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275
7   pbori.so                            0x000000019198cc50 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192
8   libpython2.7.dylib                  0x000000010591714a PyEval_EvalFrameEx + 18394
9   libpython2.7.dylib                  0x000000010591a3e2 fast_function + 338
```
* `sage/rings/polynomial/pbori.pyx` (says abort but segfault a lot before aborting)

```
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 4670 ##
0
sage: B.<x0,x1,x2,x3> = BooleanPolynomialRing(4) ## line 4689 ##
sage: I = B.ideal((x0 + x1 + x2 + x3, x0*x1 + x1*x2 + x0*x3 + x2*x3, x0*x1*x2 + x0*x1*x3 + x0*x2*x3 + x1*x2*x3, x0*x1*x2*x3 + 1)) ## line 4690 ##
sage: gb = I.groebner_basis() ## line 4694 ##
sage: f,g,h,i = I.gens() ## line 4695 ##
sage: f.reduce(gb) ## line 4696 ##
sage: p = f*g + x0*h + x2*i ## line 4698 ##
sage: p.reduce(gb) ## line 4699 ##
sage: p.reduce(I) ## line 4701 ##
Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.
------------------------------------------------------------------------
0   signals.so                          0x0000000102c38b21 print_backtrace + 65
1   signals.so                          0x0000000102c3c15c sigdie + 60
2   signals.so                          0x0000000102c3c0ad cysigs_signal_handler + 317
3   libsystem_platform.dylib            0x00007fffbdabcbba _sigtramp + 26
4   ???                                 0x00007fb02d196af0 0x0 + 140394647612144
5   libsystem_c.dylib                   0x00007fffbd943420 abort + 129
6   libsystem_c.dylib                   0x00007fffbd90a893 basename_r + 0
7   libbrial_groebner.0.dylib           0x000000018e7df737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551
8   libbrial_groebner.0.dylib           0x000000018e7df4ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47
9   libbrial_groebner.0.dylib           0x000000018e7df4bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29
10  libbrial_groebner.0.dylib           0x000000018e79805c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44
11  libbrial_groebner.0.dylib           0x000000018e7e79ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61
12  libbrial_groebner.0.dylib           0x000000018e819ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39
13  libbrial_groebner.0.dylib           0x000000018e81808a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186
14  libbrial_groebner.0.dylib           0x000000018e817e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262
15  pbori.so                            0x000000018e5410c1 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177
16  pbori.so                            0x000000018e4cdc9a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154
17  pbori.so                            0x000000018e529621 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_131reduceP7_objectS0_ + 2289
18  libpython2.7.dylib                  0x000000010250614a PyEval_EvalFrameEx + 18394
```



---

archive/issue_comments_138616.json:
```json
{
    "body": "<a id='comment:108'></a>\nReplying to [jdemeyer](#comment%3A103):\n> Something like https://github.com/cython/cython/pull/466 could help to better organize compiler flags, but upstream Cython doesn't seem to like it.\n\n\n\nYes it would help. I am a bit unwilling to ship a change of that kind if upstream is unwilling. They don't seem to be interested. In the meantime what should we do with that line in `pynac.pxd`? If we don't have that functionality in `cython` it will have to go for now.\n\nI also had found a way to get `-std=c99` included in `CFLAGS` provided by `m4ri.pc` upstream but after that experience, I am not so sure I want it added there anymore. That's asking for trouble when you mix languages. You'd literally need a break down in `CPPFLAGS`, `CFLAGS`, `CXXFLAGS` and so on, to avoid accidents.",
    "created_at": "2016-11-24T21:06:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138616",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:108'></a>
Replying to [jdemeyer](#comment%3A103):
> Something like https://github.com/cython/cython/pull/466 could help to better organize compiler flags, but upstream Cython doesn't seem to like it.



Yes it would help. I am a bit unwilling to ship a change of that kind if upstream is unwilling. They don't seem to be interested. In the meantime what should we do with that line in `pynac.pxd`? If we don't have that functionality in `cython` it will have to go for now.

I also had found a way to get `-std=c99` included in `CFLAGS` provided by `m4ri.pc` upstream but after that experience, I am not so sure I want it added there anymore. That's asking for trouble when you mix languages. You'd literally need a break down in `CPPFLAGS`, `CFLAGS`, `CXXFLAGS` and so on, to avoid accidents.



---

archive/issue_comments_138617.json:
```json
{
    "body": "<a id='comment:9'></a>\nI've installed libc++, and while rebuilding from scratch using it, hit a bug in linbox:\n(in `linbox/field/gf2.h`)\n\n```\n#if !defined(__PATHCC__) && !(defined(__APPLE__) && defined(__clang__))\n#define stdBitReference std::_Bit_reference\n#else\n#define stdBitReference std::vector<bool>::reference\n#endif\n```\nthat appears to assume that clang not on OSX much be using libstdc++.\n\nBy the way, I am still using low-level gcc ABI, e.g. this is a typical ldd output on a C++ library (notice `libgcc_s.so` there):\n\n```\n$ ldd local/lib/libgmpxx.so\n\tlinux-vdso.so.1 (0x00007ffc1a59f000)\n\tlibgmp.so.16 => /home/dima/Sage/sage-tree/local/lib/libgmp.so.16 (0x00007f5ef4323000)\n\tlibc++.so.1 => /usr/lib64/libc++.so.1 (0x00007f5ef403c000)\n\tlibcxxrt.so.1 => /usr/lib64/libcxxrt.so.1 (0x00007f5ef3e18000)\n\tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgcc_s.so.1 (0x00007f5ef3c01000)\n\tlibm.so.6 => /lib64/libm.so.6 (0x00007f5ef3904000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007f5ef356a000)\n\tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f5ef334e000)\n\tlibdl.so.2 => /lib64/libdl.so.2 (0x00007f5ef3149000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00005610d175f000)\n```",
    "created_at": "2016-11-26T10:28:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138617",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
I've installed libc++, and while rebuilding from scratch using it, hit a bug in linbox:
(in `linbox/field/gf2.h`)

```
#if !defined(__PATHCC__) && !(defined(__APPLE__) && defined(__clang__))
#define stdBitReference std::_Bit_reference
#else
#define stdBitReference std::vector<bool>::reference
#endif
```
that appears to assume that clang not on OSX much be using libstdc++.

By the way, I am still using low-level gcc ABI, e.g. this is a typical ldd output on a C++ library (notice `libgcc_s.so` there):

```
$ ldd local/lib/libgmpxx.so
	linux-vdso.so.1 (0x00007ffc1a59f000)
	libgmp.so.16 => /home/dima/Sage/sage-tree/local/lib/libgmp.so.16 (0x00007f5ef4323000)
	libc++.so.1 => /usr/lib64/libc++.so.1 (0x00007f5ef403c000)
	libcxxrt.so.1 => /usr/lib64/libcxxrt.so.1 (0x00007f5ef3e18000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgcc_s.so.1 (0x00007f5ef3c01000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f5ef3904000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f5ef356a000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f5ef334e000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00007f5ef3149000)
	/lib64/ld-linux-x86-64.so.2 (0x00005610d175f000)
```



---

archive/issue_comments_138618.json:
```json
{
    "body": "<a id='comment:0'></a>\nInteresting. I cannot comment on why clang doesn't provide its own `libgcc_s` or equivalent. Hum, output of `readelf -d local/lib/libgmpxx.so` and `ldd -r /usr/lib64/libc++.so.1` please!\n\nAs for `linbox` I think this is ridiculous. `libstdc++` and `libc++` are supposed to be feature complete to C++11. Surely you can use the same declaration with both. Issue to open with `linbox` in my opinion.",
    "created_at": "2016-11-26T10:41:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138618",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Interesting. I cannot comment on why clang doesn't provide its own `libgcc_s` or equivalent. Hum, output of `readelf -d local/lib/libgmpxx.so` and `ldd -r /usr/lib64/libc++.so.1` please!

As for `linbox` I think this is ridiculous. `libstdc++` and `libc++` are supposed to be feature complete to C++11. Surely you can use the same declaration with both. Issue to open with `linbox` in my opinion.



---

archive/issue_comments_138619.json:
```json
{
    "body": "<a id='comment:111'></a>\nReplying to [fbissey](#comment%3A110):\n> Interesting. I cannot comment on why clang doesn't provide its own `libgcc_s` or equivalent. Hum, output of `readelf -d local/lib/libgmpxx.so` and `ldd -r /usr/lib64/libc++.so.1` please!\n\n\nWhat is the replacement of `libgcc_s`? `compiler-rt` or `libcxxabi`?      \nIt is probably due to me using clang-3.9 rather than clang-9999 that it uses `libgcc_s`.\n\n> \n> As for `linbox` I think this is ridiculous. `libstdc++` and `libc++` are supposed to be feature complete to C++11. Surely you can use the same declaration with both. Issue to open with `linbox` in my opinion.\n\n\nOK, I've opened #21977.",
    "created_at": "2016-11-26T15:51:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138619",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:111'></a>
Replying to [fbissey](#comment%3A110):
> Interesting. I cannot comment on why clang doesn't provide its own `libgcc_s` or equivalent. Hum, output of `readelf -d local/lib/libgmpxx.so` and `ldd -r /usr/lib64/libc++.so.1` please!


What is the replacement of `libgcc_s`? `compiler-rt` or `libcxxabi`?      
It is probably due to me using clang-3.9 rather than clang-9999 that it uses `libgcc_s`.

> 
> As for `linbox` I think this is ridiculous. `libstdc++` and `libc++` are supposed to be feature complete to C++11. Surely you can use the same declaration with both. Issue to open with `linbox` in my opinion.


OK, I've opened #21977.



---

archive/issue_comments_138620.json:
```json
{
    "body": "output of readelf on libgmpxx",
    "created_at": "2016-11-26T15:52:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138620",
    "user": "https://github.com/dimpase"
}
```

output of readelf on libgmpxx



---

archive/attachments_016690.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "libc++.readelf",
    "asset_url": "tarball://root/attachments/ticket12426/84251043fff654a9e4d5b46367e77cd2.readelf",
    "created_at": "2016-11-26T15:53:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12426/84251043fff654a9e4d5b46367e77cd2.readelf",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_138621.json:
```json
{
    "body": "Attachment [libc++.readelf](https://github.com/sagemath/sage/files/ticket12426/84251043fff654a9e4d5b46367e77cd2.readelf) by @dimpase created at 2016-11-26 15:53:58\n\noutput of readelf on libc++",
    "created_at": "2016-11-26T15:53:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138621",
    "user": "https://github.com/dimpase"
}
```

Attachment [libc++.readelf](https://github.com/sagemath/sage/files/ticket12426/84251043fff654a9e4d5b46367e77cd2.readelf) by @dimpase created at 2016-11-26 15:53:58

output of readelf on libc++



---

archive/issue_comments_138622.json:
```json
{
    "body": "<a id='comment:2'></a>\nthe next problem is in building `sagelib`, and there things are totally misconfigured:\n`matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)\nI get an error saying, most probably, that it does not expect C++ here...\n \n\n```\n[sagelib-7.5.beta3] [  1/237] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/dima/Sage/sage-tree/local/lib/python2.7/site-packages/cysignals -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local/include/python2.7 -I/home/dima/Sage/sage-tree/local/lib/python2.7/site-packages/numpy/core/include -I/home/dima/Sage/sage-tree/src -I/home/dima/Sage/sage-tree/src/sage/ext -I/home/dima/Sage/sage-tree/src/build/cythonized -I/home/dima/Sage/sage-tree/src/build/cythonized/sage/ext -I/home/dima/Sage/sage-tree/local/include/python2.7 -c /home/dima/Sage/sage-tree/src/build/cythonized/sage/matrix/matrix_modn_dense_float.cpp -o build/temp.linux-x86_64-2.7/home/dima/Sage/sage-tree/src/build/cythonized/sage/matrix/matrix_modn_dense_float.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -fPIC -std=gnu++11 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include/linbox -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -fPIC -std=gnu++11 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -fno-strict-aliasing\n```\nI wonder why the clang build of sagelib works on OSX - is it because distutils understand what to do in this case?",
    "created_at": "2016-11-26T23:12:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138622",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
the next problem is in building `sagelib`, and there things are totally misconfigured:
`matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)
I get an error saying, most probably, that it does not expect C++ here...
 

```
[sagelib-7.5.beta3] [  1/237] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/dima/Sage/sage-tree/local/lib/python2.7/site-packages/cysignals -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local/include/python2.7 -I/home/dima/Sage/sage-tree/local/lib/python2.7/site-packages/numpy/core/include -I/home/dima/Sage/sage-tree/src -I/home/dima/Sage/sage-tree/src/sage/ext -I/home/dima/Sage/sage-tree/src/build/cythonized -I/home/dima/Sage/sage-tree/src/build/cythonized/sage/ext -I/home/dima/Sage/sage-tree/local/include/python2.7 -c /home/dima/Sage/sage-tree/src/build/cythonized/sage/matrix/matrix_modn_dense_float.cpp -o build/temp.linux-x86_64-2.7/home/dima/Sage/sage-tree/src/build/cythonized/sage/matrix/matrix_modn_dense_float.o -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -fPIC -std=gnu++11 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include/linbox -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -O2 -Wall -DNDEBUG -UFFLASFFPACK_DEBUG -D__FFLASFFPACK_HAVE_CBLAS -g -O2 -fPIC -std=gnu++11 -msse4.1 -mfma -mavx2 -DFFLAS_COMPILED -DFFPACK_COMPILED -fPIC -std=gnu++11 -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-tree/local//include -I/home/dima/Sage/sage-tree/local/include -fno-strict-aliasing
```
I wonder why the clang build of sagelib works on OSX - is it because distutils understand what to do in this case?



---

archive/issue_comments_138623.json:
```json
{
    "body": "<a id='comment:3'></a>\nI occasionally have seen `.cpp` files compiled with `clang` usually without trouble. And `matrix_modn_dense_float` is one such case. What is the error exactly?",
    "created_at": "2016-11-27T00:22:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138623",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
I occasionally have seen `.cpp` files compiled with `clang` usually without trouble. And `matrix_modn_dense_float` is one such case. What is the error exactly?



---

archive/issue_comments_138624.json:
```json
{
    "body": "<a id='comment:114'></a>\nReplying to [dimpase](#comment%3A112):\n> the next problem is in building `sagelib`, and there things are totally misconfigured:\n> `matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)\n\n\nThis is https://bugs.python.org/issue1222585 (an 11-year old bug!)",
    "created_at": "2016-11-27T07:29:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138624",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:114'></a>
Replying to [dimpase](#comment%3A112):
> the next problem is in building `sagelib`, and there things are totally misconfigured:
> `matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)


This is https://bugs.python.org/issue1222585 (an 11-year old bug!)



---

archive/issue_comments_138625.json:
```json
{
    "body": "<a id='comment:5'></a>\nI am familiar with it. You wouldn't believe how broken building python or python package is broken on AIX and that's one of the referred bugs for that. On AIX I have to hand hold the building of matplotlib, numpy and scipy, compiling manually the stuff that fails because of wrong compilers and sometimes wrong compiler flags. The way it is broken feels completely magical.",
    "created_at": "2016-11-27T07:36:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138625",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
I am familiar with it. You wouldn't believe how broken building python or python package is broken on AIX and that's one of the referred bugs for that. On AIX I have to hand hold the building of matplotlib, numpy and scipy, compiling manually the stuff that fails because of wrong compilers and sometimes wrong compiler flags. The way it is broken feels completely magical.



---

archive/issue_comments_138626.json:
```json
{
    "body": "<a id='comment:116'></a>\nReplying to [jdemeyer](#comment%3A114):\n> Replying to [dimpase](#comment%3A112):\n> > the next problem is in building `sagelib`, and there things are totally misconfigured:\n> > `matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)\n\n> \n> This is https://bugs.python.org/issue1222585 (an 11-year old bug!)\n\nthey say it is enhancement. Technically speaking, building C++ extensions is just not supported...\nWe should just switch to Julia :-)\n\nAnyhow, I suppose the problem I face is that clang has no idea about STL library implementation it should use (well, clang++ does have an appropriate flag (-stdlib=),\nclang probably just ignores such a flag). It's just an accident that it works with gcc.",
    "created_at": "2016-11-27T08:36:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138626",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:116'></a>
Replying to [jdemeyer](#comment%3A114):
> Replying to [dimpase](#comment%3A112):
> > the next problem is in building `sagelib`, and there things are totally misconfigured:
> > `matrix_modn_dense_float.cpp` is compiled with `clang`, not with `clang++` (and with option `-std=gnu++11` for some reason)

> 
> This is https://bugs.python.org/issue1222585 (an 11-year old bug!)

they say it is enhancement. Technically speaking, building C++ extensions is just not supported...
We should just switch to Julia :-)

Anyhow, I suppose the problem I face is that clang has no idea about STL library implementation it should use (well, clang++ does have an appropriate flag (-stdlib=),
clang probably just ignores such a flag). It's just an accident that it works with gcc.



---

archive/issue_comments_138627.json:
```json
{
    "body": "<a id='comment:7'></a>\nCan you just post the error, so we can see it?",
    "created_at": "2016-11-27T08:45:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138627",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Can you just post the error, so we can see it?



---

archive/issue_comments_138628.json:
```json
{
    "body": "<a id='comment:118'></a>\nReplying to [dimpase](#comment%3A116):\n> It's just an accident that it works with gcc.\n\n\nNot really because `gcc` looks at the extension of the file to be compiled and decides what to do depending on that. If you compile a `.cpp` file with `gcc`, I guess it behaves exactly the same as compiling that file with `g++`. Doesn't `clang` do the same?",
    "created_at": "2016-11-27T12:37:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138628",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:118'></a>
Replying to [dimpase](#comment%3A116):
> It's just an accident that it works with gcc.


Not really because `gcc` looks at the extension of the file to be compiled and decides what to do depending on that. If you compile a `.cpp` file with `gcc`, I guess it behaves exactly the same as compiling that file with `g++`. Doesn't `clang` do the same?



---

archive/issue_comments_138629.json:
```json
{
    "body": "<a id='comment:119'></a>\nReplying to [fbissey](#comment%3A117):\n> Can you just post the error, so we can see it?\n\n\n```\n  clang -fno-strict-aliasing -OPT:Olim\n it=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/hom\n e/dima/Sage/sage-tree/local/lib/python2.7/site-packages/cysignals \n -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-t\n ree/local/include/python2.7 -I/home/dima/Sage/sage-tree/local/lib/\n python2.7/site-packages/numpy/core/include -I/home/dima/Sage/sage-\n tree/src -I/home/dima/Sage/sage-tree/src/sage/ext -I/home/dima/Sag\n e/sage-tree/src/build/cythonized -I/home/dima/Sage/sage-tree/src/b\n uild/cythonized/sage/ext -I/home/dima/Sage/sage-tree/local/include\n /python2.7 -c /home/dima/Sage/sage-tree/src/build/cythonized/sage/\n matroids/lean_matrix.c -o build/temp.linux-x86_64-2.7/home/dima/Sa\n ge/sage-tree/src/build/cythonized/sage/matroids/lean_matrix.o -fno\n -strict-aliasing\n [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre\n e/src/build/cythonized/sage/matrix/matrix_modn_dense_float.cpp:564\n :\n [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre\n e/local/include/linbox/matrix/dense-matrix.h:79:\n [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre\n e/local/include/linbox/matrix/densematrix/blas-matrix.h:42:\n [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre\n e/local/include/linbox/vector/stream.h:872:\n [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre\n e/local/include/linbox/vector/stream-gf2.h:77:\n [sagelib-7.5.beta3] /home/dima/Sage/sage-tree/local/include/linbox\n /field/gf2.h:1008:10: fatal error: '__bit_reference' file not foun\n d\n [sagelib-7.5.beta3] #include <__bit_reference>\n```\n\n`__bit_reference` is a header file from `libc++`; which `clang++` finds as I invoke it as `clang++ -stdlib=libc++`. But `clang` has no idea about this parameter, and thus it cannot find it. It is probably not simply including the corresponding directory with -I parameter, as more things from STL are most probably have to be included by default.",
    "created_at": "2016-11-27T18:06:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138629",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:119'></a>
Replying to [fbissey](#comment%3A117):
> Can you just post the error, so we can see it?


```
  clang -fno-strict-aliasing -OPT:Olim
 it=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/hom
 e/dima/Sage/sage-tree/local/lib/python2.7/site-packages/cysignals 
 -I/home/dima/Sage/sage-tree/local/include -I/home/dima/Sage/sage-t
 ree/local/include/python2.7 -I/home/dima/Sage/sage-tree/local/lib/
 python2.7/site-packages/numpy/core/include -I/home/dima/Sage/sage-
 tree/src -I/home/dima/Sage/sage-tree/src/sage/ext -I/home/dima/Sag
 e/sage-tree/src/build/cythonized -I/home/dima/Sage/sage-tree/src/b
 uild/cythonized/sage/ext -I/home/dima/Sage/sage-tree/local/include
 /python2.7 -c /home/dima/Sage/sage-tree/src/build/cythonized/sage/
 matroids/lean_matrix.c -o build/temp.linux-x86_64-2.7/home/dima/Sa
 ge/sage-tree/src/build/cythonized/sage/matroids/lean_matrix.o -fno
 -strict-aliasing
 [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre
 e/src/build/cythonized/sage/matrix/matrix_modn_dense_float.cpp:564
 :
 [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre
 e/local/include/linbox/matrix/dense-matrix.h:79:
 [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre
 e/local/include/linbox/matrix/densematrix/blas-matrix.h:42:
 [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre
 e/local/include/linbox/vector/stream.h:872:
 [sagelib-7.5.beta3] In file included from /home/dima/Sage/sage-tre
 e/local/include/linbox/vector/stream-gf2.h:77:
 [sagelib-7.5.beta3] /home/dima/Sage/sage-tree/local/include/linbox
 /field/gf2.h:1008:10: fatal error: '__bit_reference' file not foun
 d
 [sagelib-7.5.beta3] #include <__bit_reference>
```

`__bit_reference` is a header file from `libc++`; which `clang++` finds as I invoke it as `clang++ -stdlib=libc++`. But `clang` has no idea about this parameter, and thus it cannot find it. It is probably not simply including the corresponding directory with -I parameter, as more things from STL are most probably have to be included by default.



---

archive/issue_comments_138630.json:
```json
{
    "body": "<a id='comment:120'></a>\nReplying to [jdemeyer](#comment%3A118):\n> Replying to [dimpase](#comment%3A116):\n> > It's just an accident that it works with gcc.\n\n> \n> Not really because `gcc` looks at the extension of the file to be compiled and decides what to do depending on that. If you compile a `.cpp` file with `gcc`, I guess it behaves exactly the same as compiling that file with `g++`. Doesn't `clang` do the same?\n\n\nI am not sure. By the way, the file in question, where the error pops up, (`local/include/linbox/fields/gf2.h`) is a C++ file, but is has extension `.h`, indicating plain C file, I think. (well, it is included from a `.cpp` file, so in that sense it is meant to be C++).\n\nBesides, `g++` has parameters that `gcc` does not have, such as `-nostdinc++` (needed if you want use an STL implementation different from `libstdc++`), and so I don't see how this could at all fly with `gcc` if these `g++`-only parmeters are to be invoked.",
    "created_at": "2016-11-27T18:12:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138630",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:120'></a>
Replying to [jdemeyer](#comment%3A118):
> Replying to [dimpase](#comment%3A116):
> > It's just an accident that it works with gcc.

> 
> Not really because `gcc` looks at the extension of the file to be compiled and decides what to do depending on that. If you compile a `.cpp` file with `gcc`, I guess it behaves exactly the same as compiling that file with `g++`. Doesn't `clang` do the same?


I am not sure. By the way, the file in question, where the error pops up, (`local/include/linbox/fields/gf2.h`) is a C++ file, but is has extension `.h`, indicating plain C file, I think. (well, it is included from a `.cpp` file, so in that sense it is meant to be C++).

Besides, `g++` has parameters that `gcc` does not have, such as `-nostdinc++` (needed if you want use an STL implementation different from `libstdc++`), and so I don't see how this could at all fly with `gcc` if these `g++`-only parmeters are to be invoked.



---

archive/issue_comments_138631.json:
```json
{
    "body": "<a id='comment:1'></a>\nWell, `gcc` and `clang` are not the real compilers, they are drivers. In the case of gcc the real compiler is `cc1` for example. So you can pass a c++ file to compile to gcc, and it may be recognised as c++ and passed to `cc1plus` but the flags that are usually set by `g++` won't be present, only the one set by `gcc`. In the case of gnu compilers it looks like gcc and g++ have the same include flags.\n\nSo for example, while it is possible to produce a `.o` with gcc from a C++ source (and same with clang if you are lucky) it is impossible to link a C++ program with gcc/clang instead of g++/clang++ (without extra manual flags that is) because only the C++ driver knows to add the right flags for the standard C++ library.\n\nI notice for example that `matrix_modn_dense_float.cpp` is compiled with clang on OS X but the .so file is linked with clang++.",
    "created_at": "2016-11-28T06:46:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138631",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Well, `gcc` and `clang` are not the real compilers, they are drivers. In the case of gcc the real compiler is `cc1` for example. So you can pass a c++ file to compile to gcc, and it may be recognised as c++ and passed to `cc1plus` but the flags that are usually set by `g++` won't be present, only the one set by `gcc`. In the case of gnu compilers it looks like gcc and g++ have the same include flags.

So for example, while it is possible to produce a `.o` with gcc from a C++ source (and same with clang if you are lucky) it is impossible to link a C++ program with gcc/clang instead of g++/clang++ (without extra manual flags that is) because only the C++ driver knows to add the right flags for the standard C++ library.

I notice for example that `matrix_modn_dense_float.cpp` is compiled with clang on OS X but the .so file is linked with clang++.



---

archive/issue_comments_138632.json:
```json
{
    "body": "<a id='comment:2'></a>\nOn OS X, all the `.cpp` files are compiled with `clang` and then linked with `clang++`. No exceptions. I cannot check the equivalent on linux until tomorrow but I suspect it is the same.",
    "created_at": "2016-11-28T06:51:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138632",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
On OS X, all the `.cpp` files are compiled with `clang` and then linked with `clang++`. No exceptions. I cannot check the equivalent on linux until tomorrow but I suspect it is the same.



---

archive/issue_comments_138633.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe version of python shipped in Gentoo actually includes  \u200bhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.",
    "created_at": "2016-12-05T22:33:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138633",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
The version of python shipped in Gentoo actually includes  ‚Äãhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.



---

archive/issue_comments_138634.json:
```json
{
    "body": "<a id='comment:124'></a>\nReplying to [fbissey](#comment%3A123):\n> The version of python shipped in Gentoo actually includes  \u200bhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.\n\n\nHow does one find out what gentoo is including here?",
    "created_at": "2016-12-06T21:00:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138634",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:124'></a>
Replying to [fbissey](#comment%3A123):
> The version of python shipped in Gentoo actually includes  ‚Äãhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.


How does one find out what gentoo is including here?



---

archive/issue_comments_138635.json:
```json
{
    "body": "<a id='comment:125'></a>\nReplying to [dimpase](#comment%3A124):\n> Replying to [fbissey](#comment%3A123):\n> > The version of python shipped in Gentoo actually includes  \u200bhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.\n\n> \n> How does one find out what gentoo is including here?\n\n\nI am assuming you want to brew your own :) \nIn your DISTFILES folder (by default /usr/portage/distfiles) there should be a `python-gentoo-patches-2.7.10-0.tar.xz` tarball (and a 2.7.12-0 one if you upgraded recently) there are a few other things but inside that tarball are all main - unconditional - patches.\n`patches/21_all_distutils_c++.patch` inside that tarball is what you are after if you want to test it. It should be identical to what's on the python tracker for python 2.7 since it's the same author....",
    "created_at": "2016-12-07T03:45:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138635",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:125'></a>
Replying to [dimpase](#comment%3A124):
> Replying to [fbissey](#comment%3A123):
> > The version of python shipped in Gentoo actually includes  ‚Äãhttps://bugs.python.org/issue1222585 (and yes that means in sage-on-gentoo g++ is used for compiling in the right places). I would be supportive to include that patch in sage's python for once.

> 
> How does one find out what gentoo is including here?


I am assuming you want to brew your own :) 
In your DISTFILES folder (by default /usr/portage/distfiles) there should be a `python-gentoo-patches-2.7.10-0.tar.xz` tarball (and a 2.7.12-0 one if you upgraded recently) there are a few other things but inside that tarball are all main - unconditional - patches.
`patches/21_all_distutils_c++.patch` inside that tarball is what you are after if you want to test it. It should be identical to what's on the python tracker for python 2.7 since it's the same author....



---

archive/issue_comments_138636.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,8 +13,8 @@\n * fix `import_array` in `finance/time_series.pyx` now fixed by #20596\n * fix abuse of `inline` keyword in `pxd` files #21696\n * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n-* fix conflicting language options (`-std=c++11 -std=c99`), #21749 should take care of at last some of that.\n-* Singular 4 to be checked when it finally lands\n+* fix conflicting language options (`-std=c99` used by C++ code): #22554\n+* Singular 4 to be checked\n  \n ---\n \n``````\n",
    "created_at": "2017-03-09T12:45:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138636",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,8 +13,8 @@
 * fix `import_array` in `finance/time_series.pyx` now fixed by #20596
 * fix abuse of `inline` keyword in `pxd` files #21696
 * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
-* fix conflicting language options (`-std=c++11 -std=c99`), #21749 should take care of at last some of that.
-* Singular 4 to be checked when it finally lands
+* fix conflicting language options (`-std=c99` used by C++ code): #22554
+* Singular 4 to be checked
  
 ---
 
``````




---

archive/issue_comments_138637.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,7 +15,8 @@\n * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n * fix conflicting language options (`-std=c99` used by C++ code): #22554\n * Singular 4 to be checked\n- \n+* build with clang: fplll symbol not found errors (#22643)\n+\n ---\n \n Spkgs ignoring CC/CXX environment variables:\n``````\n",
    "created_at": "2017-03-19T01:15:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138637",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,7 +15,8 @@
 * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
 * fix conflicting language options (`-std=c99` used by C++ code): #22554
 * Singular 4 to be checked
- 
+* build with clang: fplll symbol not found errors (#22643)
+
 ---
 
 Spkgs ignoring CC/CXX environment variables:
``````




---

archive/issue_events_101955.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2017-03-19T01:15:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101955"
}
```



---

archive/issue_events_101956.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2017-03-19T01:15:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101956"
}
```



---

archive/issue_comments_138638.json:
```json
{
    "body": "<a id='comment:8'></a>\nI really need another machine than my OS X laptop to work on this. Do we have some resources I could tap remotely?",
    "created_at": "2017-03-19T01:25:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138638",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
I really need another machine than my OS X laptop to work on this. Do we have some resources I could tap remotely?



---

archive/issue_comments_138639.json:
```json
{
    "body": "<a id='comment:129'></a>\nReplying to [fbissey](#comment%3A128):\n> I really need another machine than my OS X laptop to work on this. Do we have some resources I could tap remotely?\n\n\nNot sure if anyone has such resources in the open; indeed, it's illegal to run OSX on non-Apple hardware, although the net is full of instructions on how to e.g. hack VMWarePlayer to make it run OSX on non-Apple hardware.\n\nI'm thinking that perhaps resurrecting FreeBSD port, which as of version 10 has clang as the default toolchain, is the best bet for a platform on which port to clang can be completed without extra hassles.",
    "created_at": "2017-03-19T08:00:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138639",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:129'></a>
Replying to [fbissey](#comment%3A128):
> I really need another machine than my OS X laptop to work on this. Do we have some resources I could tap remotely?


Not sure if anyone has such resources in the open; indeed, it's illegal to run OSX on non-Apple hardware, although the net is full of instructions on how to e.g. hack VMWarePlayer to make it run OSX on non-Apple hardware.

I'm thinking that perhaps resurrecting FreeBSD port, which as of version 10 has clang as the default toolchain, is the best bet for a platform on which port to clang can be completed without extra hassles.



---

archive/issue_comments_138640.json:
```json
{
    "body": "<a id='comment:1'></a>\nOS X, sage 7.6.rc2\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\nsage -t --long src/sage/plot/plot.py  # Timed out after testing finished\nsage -t --long src/sage/schemes/projective/projective_morphism.py  # 16 doctests failed\nsage -t --long src/sage/plot/graphics.py  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/heegner.py  # 33 doctests failed\nsage -t --long src/sage/arith/misc.py  # 20 doctests failed\nsage -t --long src/sage/matrix/matrix2.pyx  # 3 doctests failed\nsage -t --long src/sage/rings/tests.py  # 2 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_element.pyx  # 7 doctests failed\nsage -t --long src/sage/libs/ppl.pyx  # Timed out after testing finished\nsage -t --long src/sage/misc/functional.py  # 1 doctest failed\nsage -t --long src/sage/structure/element.pyx  # 5 doctests failed\nsage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed\nsage -t --long src/sage/matrix/matrix_integer_dense.pyx  # 13 doctests failed\nsage -t --long src/sage/schemes/generic/algebraic_scheme.py  # 10 doctests failed\nsage -t --long src/sage/schemes/toric/divisor.py  # 2 doctests failed\nsage -t --long src/sage/schemes/toric/variety.py  # 4 doctests failed\nsage -t --long src/sage/algebras/quatalg/quaternion_algebra.py  # 8 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 3 doctests failed\nsage -t --long src/sage/calculus/calculus.py  # 19 doctests failed\nsage -t --long src/sage/tests/french_book/calculus_doctest.py  # 3 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed\nsage -t --long src/sage/rings/real_mpfi.pyx  # 3 doctests failed\nsage -t --long src/sage/rings/complex_number.pyx  # 4 doctests failed\nsage -t --long src/sage/schemes/toric/points.py  # 1 doctest failed\nsage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed\nsage -t --long src/sage/rings/real_mpfr.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/number_field/number_field_rel.py  # 10 doctests failed\nsage -t --long src/sage/rings/finite_rings/residue_field.pyx  # 14 doctests failed\nsage -t --long src/sage/rings/number_field/order.py  # 3 doctests failed\nsage -t --long src/sage/rings/number_field/galois_group.py  # 8 doctests failed\nsage -t --long src/sage/modular/etaproducts.py  # 10 doctests failed\nsage -t --long src/sage/tests/french_book/polynomes.py  # 1 doctest failed\nsage -t --long src/sage/tests/french_book/domaines_doctest.py  # 3 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/nf_introduction.rst  # 5 doctests failed\nsage -t --long src/sage/algebras/group_algebra.py  # 5 doctests failed\nsage -t --long src/sage/rings/ring.pyx  # 1 doctest failed\nsage -t --long src/doc/en/prep/Quickstarts/Abstract-Algebra.rst  # 3 doctests failed\nsage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed\nsage -t --long src/sage/modules/vector_space_morphism.py  # 3 doctests failed\nsage -t --long src/sage/modules/free_module_integer.py  # 57 doctests failed\nsage -t --long src/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed\nsage -t --long src/sage/algebras/quatalg/quaternion_algebra_element.pyx  # 38 doctests failed\nsage -t --long src/sage/rings/integer_ring.pyx  # 5 doctests failed\nsage -t --long src/sage/categories/rings.py  # 8 doctests failed\nsage -t --long src/sage/categories/quotient_fields.py  # 2 doctests failed\nsage -t --long src/sage/rings/polynomial/polynomial_modn_dense_ntl.pyx  # 6 doctests failed\nsage -t --long src/sage/matrix/matrix_rational_dense.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsage -t --long src/sage/schemes/toric/ideal.py  # 45 doctests failed\nsage -t --long src/sage/structure/formal_sum.py  # 1 doctest failed\nsage -t --long src/sage/repl/preparse.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_number_field.pyx  # 19 doctests failed\nsage -t --long src/sage/rings/number_field/number_field_base.pyx  # 15 doctests failed\nsage -t --long src/sage/crypto/lattice.py  # 1 doctest failed\nsage -t --long src/sage/rings/misc.py  # 1 doctest failed\nsage -t --long src/sage/algebras/quaternion_algebra_element.py  # 4 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2017-03-20T19:13:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138640",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
OS X, sage 7.6.rc2

```
----------------------------------------------------------------------
sage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
sage -t --long src/sage/plot/plot.py  # Timed out after testing finished
sage -t --long src/sage/schemes/projective/projective_morphism.py  # 16 doctests failed
sage -t --long src/sage/plot/graphics.py  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/heegner.py  # 33 doctests failed
sage -t --long src/sage/arith/misc.py  # 20 doctests failed
sage -t --long src/sage/matrix/matrix2.pyx  # 3 doctests failed
sage -t --long src/sage/rings/tests.py  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_element.pyx  # 7 doctests failed
sage -t --long src/sage/libs/ppl.pyx  # Timed out after testing finished
sage -t --long src/sage/misc/functional.py  # 1 doctest failed
sage -t --long src/sage/structure/element.pyx  # 5 doctests failed
sage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed
sage -t --long src/sage/matrix/matrix_integer_dense.pyx  # 13 doctests failed
sage -t --long src/sage/schemes/generic/algebraic_scheme.py  # 10 doctests failed
sage -t --long src/sage/schemes/toric/divisor.py  # 2 doctests failed
sage -t --long src/sage/schemes/toric/variety.py  # 4 doctests failed
sage -t --long src/sage/algebras/quatalg/quaternion_algebra.py  # 8 doctests failed
sage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 3 doctests failed
sage -t --long src/sage/calculus/calculus.py  # 19 doctests failed
sage -t --long src/sage/tests/french_book/calculus_doctest.py  # 3 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed
sage -t --long src/sage/rings/real_mpfi.pyx  # 3 doctests failed
sage -t --long src/sage/rings/complex_number.pyx  # 4 doctests failed
sage -t --long src/sage/schemes/toric/points.py  # 1 doctest failed
sage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed
sage -t --long src/sage/rings/real_mpfr.pyx  # 1 doctest failed
sage -t --long src/sage/rings/number_field/number_field_rel.py  # 10 doctests failed
sage -t --long src/sage/rings/finite_rings/residue_field.pyx  # 14 doctests failed
sage -t --long src/sage/rings/number_field/order.py  # 3 doctests failed
sage -t --long src/sage/rings/number_field/galois_group.py  # 8 doctests failed
sage -t --long src/sage/modular/etaproducts.py  # 10 doctests failed
sage -t --long src/sage/tests/french_book/polynomes.py  # 1 doctest failed
sage -t --long src/sage/tests/french_book/domaines_doctest.py  # 3 doctests failed
sage -t --long src/doc/en/thematic_tutorials/explicit_methods_in_number_theory/nf_introduction.rst  # 5 doctests failed
sage -t --long src/sage/algebras/group_algebra.py  # 5 doctests failed
sage -t --long src/sage/rings/ring.pyx  # 1 doctest failed
sage -t --long src/doc/en/prep/Quickstarts/Abstract-Algebra.rst  # 3 doctests failed
sage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed
sage -t --long src/sage/modules/vector_space_morphism.py  # 3 doctests failed
sage -t --long src/sage/modules/free_module_integer.py  # 57 doctests failed
sage -t --long src/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed
sage -t --long src/sage/algebras/quatalg/quaternion_algebra_element.pyx  # 38 doctests failed
sage -t --long src/sage/rings/integer_ring.pyx  # 5 doctests failed
sage -t --long src/sage/categories/rings.py  # 8 doctests failed
sage -t --long src/sage/categories/quotient_fields.py  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_modn_dense_ntl.pyx  # 6 doctests failed
sage -t --long src/sage/matrix/matrix_rational_dense.pyx  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
sage -t --long src/sage/schemes/toric/ideal.py  # 45 doctests failed
sage -t --long src/sage/structure/formal_sum.py  # 1 doctest failed
sage -t --long src/sage/repl/preparse.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_number_field.pyx  # 19 doctests failed
sage -t --long src/sage/rings/number_field/number_field_base.pyx  # 15 doctests failed
sage -t --long src/sage/crypto/lattice.py  # 1 doctest failed
sage -t --long src/sage/rings/misc.py  # 1 doctest failed
sage -t --long src/sage/algebras/quaternion_algebra_element.py  # 4 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_138641.json:
```json
{
    "body": "<a id='comment:2'></a>\nOK so diving down. There are two main errors that spams a lot of doctests. One is in polybori - go figure :( - and the other is in fplll. So for fplll we have \n\n```\n    ImportError: dlopen(/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so, 2): Symbol not found: __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd\n      Referenced from: /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so\n```\nSearching inside libfplll.dylib we get the following information\n\n```\nnm local/lib/libfplll.2.dylib | grep EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd\n000000000000cc50 t __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd\n```\nThe leading lowercase \"t\" means that the symbol is \"local\". Which is probably why `enumeration.so` cannot see it. That's clearly a subtle problem in the compilation of fplll.",
    "created_at": "2017-03-20T20:24:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138641",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
OK so diving down. There are two main errors that spams a lot of doctests. One is in polybori - go figure :( - and the other is in fplll. So for fplll we have 

```
    ImportError: dlopen(/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so, 2): Symbol not found: __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd
      Referenced from: /Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/fpylll/fplll/enumeration.so
```
Searching inside libfplll.dylib we get the following information

```
nm local/lib/libfplll.2.dylib | grep EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd
000000000000cc50 t __ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd
```
The leading lowercase "t" means that the symbol is "local". Which is probably why `enumeration.so` cannot see it. That's clearly a subtle problem in the compilation of fplll.



---

archive/issue_comments_138642.json:
```json
{
    "body": "<a id='comment:3'></a>\nA lot of these are related to elliptic curves, more precisely, to eclib interface with sage. This seems to be the 3rd group of errors.\n\nI'll see the author of fplll in few days here in Oxford, perhaps we can have a look.",
    "created_at": "2017-03-20T20:38:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138642",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
A lot of these are related to elliptic curves, more precisely, to eclib interface with sage. This seems to be the 3rd group of errors.

I'll see the author of fplll in few days here in Oxford, perhaps we can have a look.



---

archive/issue_comments_138643.json:
```json
{
    "body": "<a id='comment:5'></a>\n@ isuruf you wouldn't have something for the polybori issue would you?",
    "created_at": "2017-03-23T21:07:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138643",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
@ isuruf you wouldn't have something for the polybori issue would you?



---

archive/issue_comments_138644.json:
```json
{
    "body": "<a id='comment:6'></a>\nWith the patch from isuruf at #22643 we are way down in doctests failures\n\n```\nsage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\nsage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage -t --long src/sage/plot/plot.py  # 1 doctest failed\nsage -t --long src/sage/plot/graphics.py  # 1 doctest failed\nsage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed\nsage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\nsage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed\nsage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\n```",
    "created_at": "2017-03-24T00:47:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138644",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
With the patch from isuruf at #22643 we are way down in doctests failures

```
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
sage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage -t --long src/sage/plot/plot.py  # 1 doctest failed
sage -t --long src/sage/plot/graphics.py  # 1 doctest failed
sage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed
sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
sage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t --long src/sage/libs/pynac/pynac.pxd  # 1 doctest failed
sage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
```



---

archive/issue_comments_138645.json:
```json
{
    "body": "<a id='comment:137'></a>\nReplying to [fbissey](#comment%3A135):\n> @ isuruf you wouldn't have something for the polybori issue would you?\n\n\nnope. I have access to osx only through travis-ci. I'm waiting for https://github.com/cython/cython/pull/466 to be merged.",
    "created_at": "2017-03-24T06:09:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138645",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:137'></a>
Replying to [fbissey](#comment%3A135):
> @ isuruf you wouldn't have something for the polybori issue would you?


nope. I have access to osx only through travis-ci. I'm waiting for https://github.com/cython/cython/pull/466 to be merged.



---

archive/issue_comments_138646.json:
```json
{
    "body": "<a id='comment:138'></a>\nReplying to [isuruf](#comment%3A137):\n> Replying to [fbissey](#comment%3A135):\n> > @ isuruf you wouldn't have something for the polybori issue would you?\n\n> \n> nope. I have access to osx only through travis-ci. I'm waiting for https://github.com/cython/cython/pull/466 to be merged.\n\n\nOK, I had to ask. Now that `fplll` is sorted, things are clearer. We have \n\n* `polybori` segfaulting,\n* missing symbols in `pynac` - I will get in touch upstream,\n* issues with `matplotlib`, although it could be interaction with sage types.\n* similarly an issue in `numpy`.\n* a tolerance problem in `lseries_ell.py`, the doctest look at a zero value within 1e-17, but we are only 2e-16 of it.",
    "created_at": "2017-03-24T06:29:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138646",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:138'></a>
Replying to [isuruf](#comment%3A137):
> Replying to [fbissey](#comment%3A135):
> > @ isuruf you wouldn't have something for the polybori issue would you?

> 
> nope. I have access to osx only through travis-ci. I'm waiting for https://github.com/cython/cython/pull/466 to be merged.


OK, I had to ask. Now that `fplll` is sorted, things are clearer. We have 

* `polybori` segfaulting,
* missing symbols in `pynac` - I will get in touch upstream,
* issues with `matplotlib`, although it could be interaction with sage types.
* similarly an issue in `numpy`.
* a tolerance problem in `lseries_ell.py`, the doctest look at a zero value within 1e-17, but we are only 2e-16 of it.



---

archive/issue_comments_138647.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,6 +16,8 @@\n * fix conflicting language options (`-std=c99` used by C++ code): #22554\n * Singular 4 to be checked\n * build with clang: fplll symbol not found errors (#22643)\n+* `polybori` segfault when built with clang on OS X (#22677)\n+* missing symbols in libpynac.dylib (#22678)\n \n ---\n \n``````\n",
    "created_at": "2017-03-24T07:03:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138647",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,6 +16,8 @@
 * fix conflicting language options (`-std=c99` used by C++ code): #22554
 * Singular 4 to be checked
 * build with clang: fplll symbol not found errors (#22643)
+* `polybori` segfault when built with clang on OS X (#22677)
+* missing symbols in libpynac.dylib (#22678)
 
 ---
 
``````




---

archive/issue_comments_138648.json:
```json
{
    "body": "<a id='comment:0'></a>\nLet's revive the FreeBSD port. FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. Preliminary checks show that it's relatively little work. I've created #22679 for this.",
    "created_at": "2017-03-24T07:37:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138648",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
Let's revive the FreeBSD port. FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. Preliminary checks show that it's relatively little work. I've created #22679 for this.



---

archive/issue_comments_138649.json:
```json
{
    "body": "<a id='comment:1'></a>\nUsing `BRiAl` git master fix the the segfault, forgeting `pynac` which is in his own ticket, so we are down to\n\n```\nsage -t --long src/sage/plot/plot.py  # 1 doctest failed\nsage -t --long src/sage/plot/graphics.py  # 1 doctest failed\nsage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed\n```\n`matplotlib` issue:\n\n```\n...\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py\", line 1038, in _update_ticks\n        if not mtransforms.interval_contains(interval_expanded, loc):\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/transforms.py\", line 2780, in interval_contains\n        ((a < b) and (a <= val and b >= val))\n    :\n    RuntimeWarning: invalid value encountered in greater_equal\n```\nfor all of them.\n\n```\nsage -t --long --warn-long 62.6 src/sage/schemes/elliptic_curves/lseries_ell.py\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/lseries_ell.py\", line 377, in sage.schemes.elliptic_curves.lseries_ell.Lseries_ell.twist_values\nFailed example:\n    vals  # abs tol 1e-17\nExpected:\n    [(-11, 1.47824342), (-8, 8.9590946e-18), (-7, 1.85307619), (-4, 2.45138938)]\nGot:\n    [(-11, 1.47824342), (-8, -1.59574955e-16), (-7, 1.85307619), (-4, 2.45138938)]\nTolerance exceeded in 1 of 8:\n    8.9590946e-18 vs -1.59574955e-16, tolerance 2e-16 > 1e-17\n**********************************************************************\n```\nAnd\n\n```\nsage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\n```\n`numpy` issue\n\n```\n        numpy.float32('1.5') * x\n    :\n    RuntimeWarning: invalid value encountered in multiply\n```\nboth of them.",
    "created_at": "2017-03-24T08:30:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138649",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Using `BRiAl` git master fix the the segfault, forgeting `pynac` which is in his own ticket, so we are down to

```
sage -t --long src/sage/plot/plot.py  # 1 doctest failed
sage -t --long src/sage/plot/graphics.py  # 1 doctest failed
sage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed
```
`matplotlib` issue:

```
...
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/axis.py", line 1038, in _update_ticks
        if not mtransforms.interval_contains(interval_expanded, loc):
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/matplotlib/transforms.py", line 2780, in interval_contains
        ((a < b) and (a <= val and b >= val))
    :
    RuntimeWarning: invalid value encountered in greater_equal
```
for all of them.

```
sage -t --long --warn-long 62.6 src/sage/schemes/elliptic_curves/lseries_ell.py
**********************************************************************
File "src/sage/schemes/elliptic_curves/lseries_ell.py", line 377, in sage.schemes.elliptic_curves.lseries_ell.Lseries_ell.twist_values
Failed example:
    vals  # abs tol 1e-17
Expected:
    [(-11, 1.47824342), (-8, 8.9590946e-18), (-7, 1.85307619), (-4, 2.45138938)]
Got:
    [(-11, 1.47824342), (-8, -1.59574955e-16), (-7, 1.85307619), (-4, 2.45138938)]
Tolerance exceeded in 1 of 8:
    8.9590946e-18 vs -1.59574955e-16, tolerance 2e-16 > 1e-17
**********************************************************************
```
And

```
sage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
```
`numpy` issue

```
        numpy.float32('1.5') * x
    :
    RuntimeWarning: invalid value encountered in multiply
```
both of them.



---

archive/issue_comments_138650.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n * Singular 4 to be checked\n * build with clang: fplll symbol not found errors (#22643)\n * `polybori` segfault when built with clang on OS X (#22677)\n-* missing symbols in libpynac.dylib (#22678)\n+* Get sage to select the right compiler when built with clang (#22678)\n \n ---\n \n``````\n",
    "created_at": "2017-03-27T08:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138650",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
 * Singular 4 to be checked
 * build with clang: fplll symbol not found errors (#22643)
 * `polybori` segfault when built with clang on OS X (#22677)
-* missing symbols in libpynac.dylib (#22678)
+* Get sage to select the right compiler when built with clang (#22678)
 
 ---
 
``````




---

archive/issue_comments_138651.json:
```json
{
    "body": "<a id='comment:2'></a>\nTurns out the `pynac` issue is not a proper issue. `cython` was trying to run the test with g++ instead of clang++ and the mixing was not working unsurprisingly.",
    "created_at": "2017-03-27T08:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138651",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Turns out the `pynac` issue is not a proper issue. `cython` was trying to run the test with g++ instead of clang++ and the mixing was not working unsurprisingly.



---

archive/issue_comments_138652.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -25,4 +25,10 @@\n \n * Sage -- #12443 ?\n \n+---\n \n+Supporting clang not only on OSX:\n+\n+* porting to clang/FreeBSD -- #22679\n+\n+\n``````\n",
    "created_at": "2017-03-27T08:58:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138652",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -25,4 +25,10 @@
 
 * Sage -- #12443 ?
 
+---
 
+Supporting clang not only on OSX:
+
+* porting to clang/FreeBSD -- #22679
+
+
``````




---

archive/issue_comments_138653.json:
```json
{
    "body": "<a id='comment:4'></a>\nI now have a working environment where I can do the work on linux and hope it will match the problems on OS X. Have to figure how not build gcc though, as clang passes itself as gcc 4.2.1 which triggers toolchain building and my `sage-env` hack is OS X specific.\n\nInserting a `clang` identification logic isn't easy. It can be done. Interestingly `autoconf` people would probably say we are wrong to select versions, we should look for compiler features. Admittedly, that's more difficult than just banning gcc versions, even if it is the right thing.",
    "created_at": "2017-04-03T22:53:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138653",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
I now have a working environment where I can do the work on linux and hope it will match the problems on OS X. Have to figure how not build gcc though, as clang passes itself as gcc 4.2.1 which triggers toolchain building and my `sage-env` hack is OS X specific.

Inserting a `clang` identification logic isn't easy. It can be done. Interestingly `autoconf` people would probably say we are wrong to select versions, we should look for compiler features. Admittedly, that's more difficult than just banning gcc versions, even if it is the right thing.



---

archive/issue_comments_138654.json:
```json
{
    "body": "<a id='comment:145'></a>\nReplying to [fbissey](#comment%3A144):\n> I now have a working environment where I can do the work on linux and hope it will match the problems on OS X. \n\n\nFor clang++, do you use libc++, as OSX does, rather than libstdc++, as a non-bleeding-edge clang-on-Linux would use the latter...\n(having clang++/libc++ on Linux looked like a very experimental thing to me; without libc++ some C++-specific thing are rather different)\n\n\nHave to figure how not build gcc though, as clang passes itself as gcc 4.2.1 which triggers toolchain building and my `sage-env` hack is OS X specific.\n\nhow about `SAGE_INSTALL_GCC=no`? Is this not enough?\n\n\n> \n> Inserting a `clang` identification logic isn't easy. It can be done. Interestingly `autoconf` people would probably say we are wrong to select versions, we should look for compiler features. Admittedly, that's more difficult than just banning gcc versions, even if it is the right thing.\n",
    "created_at": "2017-04-03T23:17:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138654",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:145'></a>
Replying to [fbissey](#comment%3A144):
> I now have a working environment where I can do the work on linux and hope it will match the problems on OS X. 


For clang++, do you use libc++, as OSX does, rather than libstdc++, as a non-bleeding-edge clang-on-Linux would use the latter...
(having clang++/libc++ on Linux looked like a very experimental thing to me; without libc++ some C++-specific thing are rather different)


Have to figure how not build gcc though, as clang passes itself as gcc 4.2.1 which triggers toolchain building and my `sage-env` hack is OS X specific.

how about `SAGE_INSTALL_GCC=no`? Is this not enough?


> 
> Inserting a `clang` identification logic isn't easy. It can be done. Interestingly `autoconf` people would probably say we are wrong to select versions, we should look for compiler features. Admittedly, that's more difficult than just banning gcc versions, even if it is the right thing.




---

archive/issue_comments_138655.json:
```json
{
    "body": "<a id='comment:6'></a>\nI have to figure it out but gentoo stabilised clang-3.9 and you can set it up to use libcxx, which I did. Hope there is no extra flags involved.\n\nChecking on `SAGE_INSTALL_GCC=no`, didn't really think about that. It should work in that particular case. But I already started to put some logic in configure.ac to figure out we are using clang. On OS X where I didn't have a fortran compiler to start with, it would result in an error - of course because I don't have a fortran compiler I want to build gcc. Just not use gcc and g++.",
    "created_at": "2017-04-03T23:34:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138655",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
I have to figure it out but gentoo stabilised clang-3.9 and you can set it up to use libcxx, which I did. Hope there is no extra flags involved.

Checking on `SAGE_INSTALL_GCC=no`, didn't really think about that. It should work in that particular case. But I already started to put some logic in configure.ac to figure out we are using clang. On OS X where I didn't have a fortran compiler to start with, it would result in an error - of course because I don't have a fortran compiler I want to build gcc. Just not use gcc and g++.



---

archive/issue_comments_138656.json:
```json
{
    "body": "<a id='comment:7'></a>\nNow I have a full logic that automatically skips toolchain building if using clang. Forbidding older version of clang needs another macro (I already added one) but is doable.\n\n```\ndiff --git a/configure.ac b/configure.ac\nindex 52a9d2c..fa3d1d8 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -442,20 +442,30 @@ elif test x$GFC != xyes; then\n else\n     # Since need_to_install_gcc is \"no\", we know that\n     # at least C, C++ and Fortran compilers are available.\n-    # We also know that all compilers are GCC.\n-\n+    # We also know that all compilers are GCC-like.\n     # Find out the compiler versions:\n     AX_GCC_VERSION()\n     AX_GXX_VERSION()\n-\n-    # Add the .0 because Debian/Ubuntu gives version numbers like\n-    # 4.6 instead of 4.6.4 (Trac #18885)\n-    case \"$GXX_VERSION.0\" in\n-        [[0-3]].*|4.[[0-7]].*)\n-            # Install our own GCC if the system-provided one is older than gcc-4.8.\n-            SAGE_SHOULD_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is quite old]);;\n-    esac\n-\n+    \n+    #Figuring out if we are using clang instead of gcc.\n+    AC_LANG_PUSH(C) # we are still set on FORTRAN\n+    AX_COMPILER_VENDOR()\n+    AC_LANG_POP([C])\n+    IS_CLANG=no\n+    if test \"x$ax_cv_c_compiler_vendor\" = xclang\n+    then IS_CLANG=yes\n+    fi\n+    if test \"x$IS_CLANG\" = \"xno\"\n+    then\n+        # for gcc we know we want more recent versions\n+        # Add the .0 because Debian/Ubuntu gives version numbers like\n+        # 4.6 instead of 4.6.4 (Trac #18885)\n+        case \"$GXX_VERSION.0\" in\n+            [[0-3]].*|4.[[0-7]].*)\n+                # Install our own GCC if the system-provided one is older than gcc-4.8.\n+                SAGE_SHOULD_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is quite old]);;\n+        esac\n+    fi\n     # The following tests check that the version of the compilers\n     # are all the same.\n     if test \"$GCC_VERSION\" != \"$GXX_VERSION\"; then\n@@ -497,7 +507,10 @@ else\n \n     if test \"x$fortran_version_string\" = x\n     then\n-        SAGE_SHOULD_INSTALL_GCC([the Fortran compiler is not the same version as the C compiler])\n+        if test \"x$IS_CLANG\" = \"xno\"\n+        then\n+           SAGE_SHOULD_INSTALL_GCC([the Fortran compiler is not the same version as the C compiler])\n+        fi\n     fi\n fi\n```\nand using http://www.gnu.org/software/autoconf-archive/ax_compiler_vendor.html\n\nIt assumes that you are using the same vendor for CC and CXX. Mixing those would probably trigger an error in configure unless the gnu compiler you are trying to mix with clang is version 4.2.1 precisely.\n\nOn OS X where there is no fortran compiler by default, gcc would still be build and the `sage-env` hack necessary. But you should be able to bring an external gfortran and skip the building of the toolchain.",
    "created_at": "2017-04-03T23:56:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138656",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Now I have a full logic that automatically skips toolchain building if using clang. Forbidding older version of clang needs another macro (I already added one) but is doable.

```
diff --git a/configure.ac b/configure.ac
index 52a9d2c..fa3d1d8 100644
--- a/configure.ac
+++ b/configure.ac
@@ -442,20 +442,30 @@ elif test x$GFC != xyes; then
 else
     # Since need_to_install_gcc is "no", we know that
     # at least C, C++ and Fortran compilers are available.
-    # We also know that all compilers are GCC.
-
+    # We also know that all compilers are GCC-like.
     # Find out the compiler versions:
     AX_GCC_VERSION()
     AX_GXX_VERSION()
-
-    # Add the .0 because Debian/Ubuntu gives version numbers like
-    # 4.6 instead of 4.6.4 (Trac #18885)
-    case "$GXX_VERSION.0" in
-        [[0-3]].*|4.[[0-7]].*)
-            # Install our own GCC if the system-provided one is older than gcc-4.8.
-            SAGE_SHOULD_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is quite old]);;
-    esac
-
+    
+    #Figuring out if we are using clang instead of gcc.
+    AC_LANG_PUSH(C) # we are still set on FORTRAN
+    AX_COMPILER_VENDOR()
+    AC_LANG_POP([C])
+    IS_CLANG=no
+    if test "x$ax_cv_c_compiler_vendor" = xclang
+    then IS_CLANG=yes
+    fi
+    if test "x$IS_CLANG" = "xno"
+    then
+        # for gcc we know we want more recent versions
+        # Add the .0 because Debian/Ubuntu gives version numbers like
+        # 4.6 instead of 4.6.4 (Trac #18885)
+        case "$GXX_VERSION.0" in
+            [[0-3]].*|4.[[0-7]].*)
+                # Install our own GCC if the system-provided one is older than gcc-4.8.
+                SAGE_SHOULD_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is quite old]);;
+        esac
+    fi
     # The following tests check that the version of the compilers
     # are all the same.
     if test "$GCC_VERSION" != "$GXX_VERSION"; then
@@ -497,7 +507,10 @@ else
 
     if test "x$fortran_version_string" = x
     then
-        SAGE_SHOULD_INSTALL_GCC([the Fortran compiler is not the same version as the C compiler])
+        if test "x$IS_CLANG" = "xno"
+        then
+           SAGE_SHOULD_INSTALL_GCC([the Fortran compiler is not the same version as the C compiler])
+        fi
     fi
 fi
```
and using http://www.gnu.org/software/autoconf-archive/ax_compiler_vendor.html

It assumes that you are using the same vendor for CC and CXX. Mixing those would probably trigger an error in configure unless the gnu compiler you are trying to mix with clang is version 4.2.1 precisely.

On OS X where there is no fortran compiler by default, gcc would still be build and the `sage-env` hack necessary. But you should be able to bring an external gfortran and skip the building of the toolchain.



---

archive/issue_comments_138657.json:
```json
{
    "body": "<a id='comment:8'></a>\nYou can simplify `test \"x$IS_CLANG\" = \"xno\"` to `test \"$IS_CLANG\" = no` or even `test $IS_CLANG = no` if you know that `$IS_CLANG` is one word :-)\n\nI think it would be more logical to test `AX_COMPILER_VENDOR()` earlier, when you are actually testing the C++ compiler.\n\nFor Fortran, maybe just drop the version check altogether? If clang works with gfortran, then I would guess that gcc/g++ also work with different versions of gfortran.",
    "created_at": "2017-04-04T08:21:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138657",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
You can simplify `test "x$IS_CLANG" = "xno"` to `test "$IS_CLANG" = no` or even `test $IS_CLANG = no` if you know that `$IS_CLANG` is one word :-)

I think it would be more logical to test `AX_COMPILER_VENDOR()` earlier, when you are actually testing the C++ compiler.

For Fortran, maybe just drop the version check altogether? If clang works with gfortran, then I would guess that gcc/g++ also work with different versions of gfortran.



---

archive/issue_comments_138658.json:
```json
{
    "body": "<a id='comment:149'></a>\nReplying to [jdemeyer](#comment%3A148):\n> You can simplify `test \"x$IS_CLANG\" = \"xno\"` to `test \"$IS_CLANG\" = no` :-)\n> \n\n\nYes, it went through several iterations before I figured out that I was trying to check the vendor of the fortran compiler :( [which is unknown because the macro only knows how to do C and C++ compilers].\n\n> I think it would be more logical to test `AX_COMPILER_VENDOR()` earlier, when you are actually testing the C++ compiler.\n> \n\n\nYes it would make sense.\n\n> For Fortran, maybe just drop the version check altogether? If clang works with gfortran, then I would guess that gcc/g++ also work with different versions of gfortran.\n\n\nMost likely. I would imagine that if it doesn't it is actually broken.\n\nI am not doing a branch at this stage, I am just gathering material for other people to be able to do it themselves (and give me some feedback like you just did of course).",
    "created_at": "2017-04-04T08:30:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138658",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:149'></a>
Replying to [jdemeyer](#comment%3A148):
> You can simplify `test "x$IS_CLANG" = "xno"` to `test "$IS_CLANG" = no` :-)
> 


Yes, it went through several iterations before I figured out that I was trying to check the vendor of the fortran compiler :( [which is unknown because the macro only knows how to do C and C++ compilers].

> I think it would be more logical to test `AX_COMPILER_VENDOR()` earlier, when you are actually testing the C++ compiler.
> 


Yes it would make sense.

> For Fortran, maybe just drop the version check altogether? If clang works with gfortran, then I would guess that gcc/g++ also work with different versions of gfortran.


Most likely. I would imagine that if it doesn't it is actually broken.

I am not doing a branch at this stage, I am just gathering material for other people to be able to do it themselves (and give me some feedback like you just did of course).



---

archive/issue_comments_138659.json:
```json
{
    "body": "<a id='comment:0'></a>\nAnd now for something ridiculous. `libgap` fails to build with clang-3.9.1 on linux\n\n```\nlibtool: link: clang -shared   .libs/libgap_la-ariths.o .libs/libgap_la-c_random.o .libs/libgap_la-gmpints.o .libs/libgap_la-objccoll.o .libs/libgap_la-rational.o .libs/libgap_la-system.o .libs/libgap_la-blister.o .libs/libgap_la-c_type1.o .libs/libgap_la-gvars.o .libs/libgap_la-objcftl.o .libs/libgap_la-read.o .libs/libgap_la-tietze.o .libs/libgap_la-bool.o .libs/libgap_la-cyclotom.o .libs/libgap_la-integer.o .libs/libgap_la-objects.o .libs/libgap_la-records.o .libs/libgap_la-vars.o .libs/libgap_la-calls.o .libs/libgap_la-dt.o .libs/libgap_la-intfuncs.o .libs/libgap_la-objfgelm.o .libs/libgap_la-saveload.o .libs/libgap_la-vec8bit.o .libs/libgap_la-c_filt1.o .libs/libgap_la-dteval.o .libs/libgap_la-intrprtr.o .libs/libgap_la-objpcgel.o .libs/libgap_la-scanner.o .libs/libgap_la-vecffe.o .libs/libgap_la-c_meths1.o .libs/libgap_la-exprs.o .libs/libgap_la-iostream.o .libs/libgap_la-objscoll.o .libs/libgap_la-sctable.o .libs/libgap_la-vecgf2.o .libs/libgap_la-code.o .libs/libgap_la-finfield.o .libs/libgap_la-libgap.o .libs/libgap_la-opers.o .libs/libgap_la-set.o .libs/libgap_la-vector.o .libs/libgap_la-compiler.o .libs/libgap_la-funcs.o .libs/libgap_la-listfunc.o .libs/libgap_la-permutat.o .libs/libgap_la-stats.o .libs/libgap_la-weakptr.o .libs/libgap_la-compstat.o .libs/libgap_la-gap.o .libs/libgap_la-listoper.o .libs/libgap_la-plist.o .libs/libgap_la-streams.o .libs/libgap_la-c_oper1.o .libs/libgap_la-lists.o .libs/libgap_la-precord.o .libs/libgap_la-string.o .libs/libgap_la-costab.o .libs/libgap_la-gasman.o .libs/libgap_la-macfloat.o .libs/libgap_la-range.o .libs/libgap_la-sysfiles.o .libs/libgap_la-pperm.o .libs/libgap_la-trans.o .libs/libgap_la-profile.o    -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lgmp -lm  -Wl,--version-script=../src/libgap.map -Wl,-rpath -Wl,/home/fbissey/sandbox/git-fork/sage-clang/local/lib   -Wl,-soname -Wl,libgap.so.4 -o .libs/libgap.so.4.8.6\n/usr/bin/x86_64-pc-linux-gnu-ld: .libs/libgap_la-ariths.o: relocation R_X86_64_32S against `libGAP_ZEROOp' can not be used when making a shared object; recompile with -fPIC\n.libs/libgap_la-ariths.o: error adding symbols: Bad value\nclang-3.9: error: linker command failed with exit code 1 (use -v to see invocation)\n```\nAs it turns out this bit\n\n```\nCPPFLAGS=\"$CPPFLAGS\"' -DSYS_DEFAULT_PATHS=\\\"'\"$SAGE_LOCAL/gap/latest\"'\\\"'\n```\nabout `SYS_DEFAULT_PATHS` is breaking the detection of `-fPIC -DPIC` by autoconf, so everything is compiled without `-fPIC` and the linking of the shared object fails.\n\nAt this point I think \n1. if it is useful make it a configuration option\n2. I don't any of that in sage-on-gentoo. Is this really necessary? I guess I'll figure the answer to that shortly.",
    "created_at": "2017-04-04T23:47:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138659",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
And now for something ridiculous. `libgap` fails to build with clang-3.9.1 on linux

```
libtool: link: clang -shared   .libs/libgap_la-ariths.o .libs/libgap_la-c_random.o .libs/libgap_la-gmpints.o .libs/libgap_la-objccoll.o .libs/libgap_la-rational.o .libs/libgap_la-system.o .libs/libgap_la-blister.o .libs/libgap_la-c_type1.o .libs/libgap_la-gvars.o .libs/libgap_la-objcftl.o .libs/libgap_la-read.o .libs/libgap_la-tietze.o .libs/libgap_la-bool.o .libs/libgap_la-cyclotom.o .libs/libgap_la-integer.o .libs/libgap_la-objects.o .libs/libgap_la-records.o .libs/libgap_la-vars.o .libs/libgap_la-calls.o .libs/libgap_la-dt.o .libs/libgap_la-intfuncs.o .libs/libgap_la-objfgelm.o .libs/libgap_la-saveload.o .libs/libgap_la-vec8bit.o .libs/libgap_la-c_filt1.o .libs/libgap_la-dteval.o .libs/libgap_la-intrprtr.o .libs/libgap_la-objpcgel.o .libs/libgap_la-scanner.o .libs/libgap_la-vecffe.o .libs/libgap_la-c_meths1.o .libs/libgap_la-exprs.o .libs/libgap_la-iostream.o .libs/libgap_la-objscoll.o .libs/libgap_la-sctable.o .libs/libgap_la-vecgf2.o .libs/libgap_la-code.o .libs/libgap_la-finfield.o .libs/libgap_la-libgap.o .libs/libgap_la-opers.o .libs/libgap_la-set.o .libs/libgap_la-vector.o .libs/libgap_la-compiler.o .libs/libgap_la-funcs.o .libs/libgap_la-listfunc.o .libs/libgap_la-permutat.o .libs/libgap_la-stats.o .libs/libgap_la-weakptr.o .libs/libgap_la-compstat.o .libs/libgap_la-gap.o .libs/libgap_la-listoper.o .libs/libgap_la-plist.o .libs/libgap_la-streams.o .libs/libgap_la-c_oper1.o .libs/libgap_la-lists.o .libs/libgap_la-precord.o .libs/libgap_la-string.o .libs/libgap_la-costab.o .libs/libgap_la-gasman.o .libs/libgap_la-macfloat.o .libs/libgap_la-range.o .libs/libgap_la-sysfiles.o .libs/libgap_la-pperm.o .libs/libgap_la-trans.o .libs/libgap_la-profile.o    -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lgmp -lm  -Wl,--version-script=../src/libgap.map -Wl,-rpath -Wl,/home/fbissey/sandbox/git-fork/sage-clang/local/lib   -Wl,-soname -Wl,libgap.so.4 -o .libs/libgap.so.4.8.6
/usr/bin/x86_64-pc-linux-gnu-ld: .libs/libgap_la-ariths.o: relocation R_X86_64_32S against `libGAP_ZEROOp' can not be used when making a shared object; recompile with -fPIC
.libs/libgap_la-ariths.o: error adding symbols: Bad value
clang-3.9: error: linker command failed with exit code 1 (use -v to see invocation)
```
As it turns out this bit

```
CPPFLAGS="$CPPFLAGS"' -DSYS_DEFAULT_PATHS=\"'"$SAGE_LOCAL/gap/latest"'\"'
```
about `SYS_DEFAULT_PATHS` is breaking the detection of `-fPIC -DPIC` by autoconf, so everything is compiled without `-fPIC` and the linking of the shared object fails.

At this point I think 
1. if it is useful make it a configuration option
2. I don't any of that in sage-on-gentoo. Is this really necessary? I guess I'll figure the answer to that shortly.



---

archive/issue_comments_138660.json:
```json
{
    "body": "<a id='comment:1'></a>\nOh, I see only used for the testsuite. May be I can move that logic there then.",
    "created_at": "2017-04-04T23:48:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138660",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Oh, I see only used for the testsuite. May be I can move that logic there then.



---

archive/issue_comments_138661.json:
```json
{
    "body": "<a id='comment:2'></a>\nyes, I have seen the need for missing -fPIC with clang too, only I never knew why this was broken...",
    "created_at": "2017-04-05T00:06:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138661",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
yes, I have seen the need for missing -fPIC with clang too, only I never knew why this was broken...



---

archive/issue_comments_138662.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n * Gfan (0.5) -- #12440\n * Lcalc -- #12437\n * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n+* !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46\n * pynac -- #21623\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Symmetrica -- #12439\n``````\n",
    "created_at": "2017-04-05T00:11:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138662",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 * Gfan (0.5) -- #12440
 * Lcalc -- #12437
 * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
+* !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46
 * pynac -- #21623
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Symmetrica -- #12439
``````




---

archive/issue_comments_138663.json:
```json
{
    "body": "<a id='comment:3'></a>\nHum, yes. Adding the linbox annoyance #21977 to the list. At least that's easily patchable.",
    "created_at": "2017-04-05T00:11:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138663",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Hum, yes. Adding the linbox annoyance #21977 to the list. At least that's easily patchable.



---

archive/issue_comments_138664.json:
```json
{
    "body": "<a id='comment:4'></a>\nWell `pyzmq` fails to build.\n\n```\n    clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/fbissey/sandbox/git-fork/sage-clang/local/include -Izmq/utils -Izmq/backend/cython -Izmq/devices -c build/temp.linux-x86_64-2.7/scratch/vers.c -o build/temp.linux-x86_64-2.7/scratch/vers.o\n    clang build/temp.linux-x86_64-2.7/scratch/vers.o -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -R/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lzmq -lrt -o build/temp.linux-x86_64-2.7/scratch/vers\n    Error running version detection script:\n\n    build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory\n\n\n    error: Error running version detection script:\n\n    build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory\n```\n`clang` doesn't know to pass `-R` directly to the linker. For gcc distutils uses `-Wl,-R` but recons other compilers don't need to do that. From `python2.7/distutils/unixccompiler.py`\n\n```\n    def runtime_library_dir_option(self, dir):\n        # XXX Hackish, at the very least.  See Python bug #445902:\n        # http://sourceforge.net/tracker/index.php\n        #   ?func=detail&aid=445902&group_id=5470&atid=105470\n        # Linkers on different platforms need different options to\n        # specify that directories need to be added to the list of\n        # directories searched for dependencies when a dynamic library\n        # is sought.  GCC has to be told to pass the -R option through\n        # to the linker, whereas other compilers just know this.\n        # Other compilers may need something slightly different.  At\n        # this time, there's no way to determine this information from\n        # the configuration data stored in the Python installation, so\n        # we use this hack.\n        compiler = os.path.basename(sysconfig.get_config_var(\"CC\"))\n        if sys.platform[:6] == \"darwin\":\n            # MacOSX's linker doesn't understand the -R flag at all\n            return \"-L\" + dir\n        elif sys.platform[:7] == \"freebsd\":\n            return \"-Wl,-rpath=\" + dir\n        elif sys.platform[:5] == \"hp-ux\":\n            if self._is_gcc(compiler):\n                return [\"-Wl,+s\", \"-L\" + dir]\n            return [\"+s\", \"-L\" + dir]\n        elif sys.platform[:7] == \"irix646\" or sys.platform[:6] == \"osf1V5\":\n            return [\"-rpath\", dir]\n        elif self._is_gcc(compiler):\n            return \"-Wl,-R\" + dir\n        else:\n            return \"-R\" + dir\n```\n`_is_gcc` basically returns true if `gcc` or `g++` is part of the filename of the compiler. So `clang` on linux, gets the last option when it would need the same as `gcc`, or freeBSD. And I would also like people who wrote that code to read `ld` man page so they drop the way they use `-R`. It is very much a legacy behavior.",
    "created_at": "2017-04-05T02:42:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138664",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
Well `pyzmq` fails to build.

```
    clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/fbissey/sandbox/git-fork/sage-clang/local/include -Izmq/utils -Izmq/backend/cython -Izmq/devices -c build/temp.linux-x86_64-2.7/scratch/vers.c -o build/temp.linux-x86_64-2.7/scratch/vers.o
    clang build/temp.linux-x86_64-2.7/scratch/vers.o -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -R/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lzmq -lrt -o build/temp.linux-x86_64-2.7/scratch/vers
    Error running version detection script:

    build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory


    error: Error running version detection script:

    build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory
```
`clang` doesn't know to pass `-R` directly to the linker. For gcc distutils uses `-Wl,-R` but recons other compilers don't need to do that. From `python2.7/distutils/unixccompiler.py`

```
    def runtime_library_dir_option(self, dir):
        # XXX Hackish, at the very least.  See Python bug #445902:
        # http://sourceforge.net/tracker/index.php
        #   ?func=detail&aid=445902&group_id=5470&atid=105470
        # Linkers on different platforms need different options to
        # specify that directories need to be added to the list of
        # directories searched for dependencies when a dynamic library
        # is sought.  GCC has to be told to pass the -R option through
        # to the linker, whereas other compilers just know this.
        # Other compilers may need something slightly different.  At
        # this time, there's no way to determine this information from
        # the configuration data stored in the Python installation, so
        # we use this hack.
        compiler = os.path.basename(sysconfig.get_config_var("CC"))
        if sys.platform[:6] == "darwin":
            # MacOSX's linker doesn't understand the -R flag at all
            return "-L" + dir
        elif sys.platform[:7] == "freebsd":
            return "-Wl,-rpath=" + dir
        elif sys.platform[:5] == "hp-ux":
            if self._is_gcc(compiler):
                return ["-Wl,+s", "-L" + dir]
            return ["+s", "-L" + dir]
        elif sys.platform[:7] == "irix646" or sys.platform[:6] == "osf1V5":
            return ["-rpath", dir]
        elif self._is_gcc(compiler):
            return "-Wl,-R" + dir
        else:
            return "-R" + dir
```
`_is_gcc` basically returns true if `gcc` or `g++` is part of the filename of the compiler. So `clang` on linux, gets the last option when it would need the same as `gcc`, or freeBSD. And I would also like people who wrote that code to read `ld` man page so they drop the way they use `-R`. It is very much a legacy behavior.



---

archive/issue_comments_138665.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,6 +9,7 @@\n * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n * !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46\n * pynac -- #21623\n+* python3 -- #22756: on OS X, if we use gcc instead of clang, then the `_scproxy` module fails to build. (We already build `python2` with clang on OS X.)\n * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n * Symmetrica -- #12439\n * fix `import_array` in `finance/time_series.pyx` now fixed by #20596\n``````\n",
    "created_at": "2017-04-05T03:18:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138665",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,6 +9,7 @@
 * LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
 * !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46
 * pynac -- #21623
+* python3 -- #22756: on OS X, if we use gcc instead of clang, then the `_scproxy` module fails to build. (We already build `python2` with clang on OS X.)
 * ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
 * Symmetrica -- #12439
 * fix `import_array` in `finance/time_series.pyx` now fixed by #20596
``````




---

archive/issue_comments_138666.json:
```json
{
    "body": "<a id='comment:6'></a>\nStarted doctesting, definitely need the new eclib. I get all those backtraces right now.",
    "created_at": "2017-04-05T04:57:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138666",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Started doctesting, definitely need the new eclib. I get all those backtraces right now.



---

archive/issue_comments_138667.json:
```json
{
    "body": "<a id='comment:157'></a>\nReplying to [fbissey](#comment%3A156):\n> Started doctesting, definitely need the new eclib. I get all those backtraces right now.\n\n\nthere was a return missing in a function computing double, and clang does not forgive this Matlab-speak",
    "created_at": "2017-04-05T06:59:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138667",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:157'></a>
Replying to [fbissey](#comment%3A156):
> Started doctesting, definitely need the new eclib. I get all those backtraces right now.


there was a return missing in a function computing double, and clang does not forgive this Matlab-speak



---

archive/issue_comments_138668.json:
```json
{
    "body": "<a id='comment:158'></a>\nReplying to [fbissey](#comment%3A154):\n> Well `pyzmq` fails to build.\n> \n> ```\n>     clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/fbissey/sandbox/git-fork/sage-clang/local/include -Izmq/utils -Izmq/backend/cython -Izmq/devices -c build/temp.linux-x86_64-2.7/scratch/vers.c -o build/temp.linux-x86_64-2.7/scratch/vers.o\n>     clang build/temp.linux-x86_64-2.7/scratch/vers.o -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -R/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lzmq -lrt -o build/temp.linux-x86_64-2.7/scratch/vers\n>     Error running version detection script:\n> \n>     build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory\n> \n> \n>     error: Error running version detection script:\n> \n>     build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory\n> ```\n> `clang` doesn't know to pass `-R` directly to the linker. For gcc distutils uses `-Wl,-R` but recons other compilers don't need to do that. From `python2.7/distutils/unixccompiler.py`\n> \n> ```\n>     def runtime_library_dir_option(self, dir):\n>         # XXX Hackish, at the very least.  See Python bug #445902:\n>         # http://sourceforge.net/tracker/index.php\n>         #   ?func=detail&aid=445902&group_id=5470&atid=105470\n>         # Linkers on different platforms need different options to\n>         # specify that directories need to be added to the list of\n>         # directories searched for dependencies when a dynamic library\n>         # is sought.  GCC has to be told to pass the -R option through\n>         # to the linker, whereas other compilers just know this.\n>         # Other compilers may need something slightly different.  At\n>         # this time, there's no way to determine this information from\n>         # the configuration data stored in the Python installation, so\n>         # we use this hack.\n>         compiler = os.path.basename(sysconfig.get_config_var(\"CC\"))\n>         if sys.platform[:6] == \"darwin\":\n>             # MacOSX's linker doesn't understand the -R flag at all\n>             return \"-L\" + dir\n>         elif sys.platform[:7] == \"freebsd\":\n>             return \"-Wl,-rpath=\" + dir\n>         elif sys.platform[:5] == \"hp-ux\":\n>             if self._is_gcc(compiler):\n>                 return [\"-Wl,+s\", \"-L\" + dir]\n>             return [\"+s\", \"-L\" + dir]\n>         elif sys.platform[:7] == \"irix646\" or sys.platform[:6] == \"osf1V5\":\n>             return [\"-rpath\", dir]\n>         elif self._is_gcc(compiler):\n>             return \"-Wl,-R\" + dir\n>         else:\n>             return \"-R\" + dir\n> ```\n> `_is_gcc` basically returns true if `gcc` or `g++` is part of the filename of the compiler. So `clang` on linux, gets the last option when it would need the same as `gcc`, or freeBSD. And I would also like people who wrote that code to read `ld` man page so they drop the way they use `-R`. It is very much a legacy behavior.\n\n\nupstream issue: http://bugs.python.org/issue25229",
    "created_at": "2017-04-05T22:16:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138668",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:158'></a>
Replying to [fbissey](#comment%3A154):
> Well `pyzmq` fails to build.
> 
> ```
>     clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/fbissey/sandbox/git-fork/sage-clang/local/include -Izmq/utils -Izmq/backend/cython -Izmq/devices -c build/temp.linux-x86_64-2.7/scratch/vers.c -o build/temp.linux-x86_64-2.7/scratch/vers.o
>     clang build/temp.linux-x86_64-2.7/scratch/vers.o -L/home/fbissey/sandbox/git-fork/sage-clang/local/lib -R/home/fbissey/sandbox/git-fork/sage-clang/local/lib -lzmq -lrt -o build/temp.linux-x86_64-2.7/scratch/vers
>     Error running version detection script:
> 
>     build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory
> 
> 
>     error: Error running version detection script:
> 
>     build/temp.linux-x86_64-2.7/scratch/vers: error while loading shared libraries: libzmq.so.4: cannot open shared object file: No such file or directory
> ```
> `clang` doesn't know to pass `-R` directly to the linker. For gcc distutils uses `-Wl,-R` but recons other compilers don't need to do that. From `python2.7/distutils/unixccompiler.py`
> 
> ```
>     def runtime_library_dir_option(self, dir):
>         # XXX Hackish, at the very least.  See Python bug #445902:
>         # http://sourceforge.net/tracker/index.php
>         #   ?func=detail&aid=445902&group_id=5470&atid=105470
>         # Linkers on different platforms need different options to
>         # specify that directories need to be added to the list of
>         # directories searched for dependencies when a dynamic library
>         # is sought.  GCC has to be told to pass the -R option through
>         # to the linker, whereas other compilers just know this.
>         # Other compilers may need something slightly different.  At
>         # this time, there's no way to determine this information from
>         # the configuration data stored in the Python installation, so
>         # we use this hack.
>         compiler = os.path.basename(sysconfig.get_config_var("CC"))
>         if sys.platform[:6] == "darwin":
>             # MacOSX's linker doesn't understand the -R flag at all
>             return "-L" + dir
>         elif sys.platform[:7] == "freebsd":
>             return "-Wl,-rpath=" + dir
>         elif sys.platform[:5] == "hp-ux":
>             if self._is_gcc(compiler):
>                 return ["-Wl,+s", "-L" + dir]
>             return ["+s", "-L" + dir]
>         elif sys.platform[:7] == "irix646" or sys.platform[:6] == "osf1V5":
>             return ["-rpath", dir]
>         elif self._is_gcc(compiler):
>             return "-Wl,-R" + dir
>         else:
>             return "-R" + dir
> ```
> `_is_gcc` basically returns true if `gcc` or `g++` is part of the filename of the compiler. So `clang` on linux, gets the last option when it would need the same as `gcc`, or freeBSD. And I would also like people who wrote that code to read `ld` man page so they drop the way they use `-R`. It is very much a legacy behavior.


upstream issue: http://bugs.python.org/issue25229



---

archive/issue_comments_138669.json:
```json
{
    "body": "<a id='comment:159'></a>\nReplying to [fbissey](#comment%3A151):\n> Oh, I see only used for the testsuite. May be I can move that logic there then.\n\nI presume you mean CPPFLAGS from comment 150. \nDo you have a ticket for this?",
    "created_at": "2017-04-07T22:13:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138669",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:159'></a>
Replying to [fbissey](#comment%3A151):
> Oh, I see only used for the testsuite. May be I can move that logic there then.

I presume you mean CPPFLAGS from comment 150. 
Do you have a ticket for this?



---

archive/issue_comments_138670.json:
```json
{
    "body": "<a id='comment:0'></a>\nNot yet.  I haven't fixed the testsuite so far, but I guess that's not an obstacle to opening a new ticket.",
    "created_at": "2017-04-07T23:21:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138670",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Not yet.  I haven't fixed the testsuite so far, but I guess that's not an obstacle to opening a new ticket.



---

archive/issue_comments_138671.json:
```json
{
    "body": "<a id='comment:161'></a>\nReplying to [fbissey](#comment%3A160):\n> Not yet.  I haven't fixed the testsuite so far, but I guess that's not an obstacle to opening a new ticket.\n\n\nThis is now #22784",
    "created_at": "2017-04-08T20:12:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138671",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:161'></a>
Replying to [fbissey](#comment%3A160):
> Not yet.  I haven't fixed the testsuite so far, but I guess that's not an obstacle to opening a new ticket.


This is now #22784



---

archive/issue_comments_138672.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,4 +33,12 @@\n \n * porting to clang/FreeBSD -- #22679\n \n+---\n \n+Testing: merge the attached branch, run `autoreconf` and build with\n+\n+```\n+CC=CLANG CXX=clang++ make\n+```\n+\n+\n``````\n",
    "created_at": "2017-04-10T01:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138672",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,4 +33,12 @@
 
 * porting to clang/FreeBSD -- #22679
 
+---
 
+Testing: merge the attached branch, run `autoreconf` and build with
+
+```
+CC=CLANG CXX=clang++ make
+```
+
+
``````




---

archive/issue_comments_138673.json:
```json
{
    "body": "**Author:** Fran\u00e7ois Bissey",
    "created_at": "2017-04-10T01:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138673",
    "user": "https://github.com/kiwifb"
}
```

**Author:** Fran√ßois Bissey



---

archive/issue_comments_138674.json:
```json
{
    "body": "**Commit:** [376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f](https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f)",
    "created_at": "2017-04-10T01:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138674",
    "user": "https://github.com/kiwifb"
}
```

**Commit:** [376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f](https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f)



---

archive/issue_comments_138675.json:
```json
{
    "body": "<a id='comment:2'></a>\nI know I said I wouldn't provide a branch, but all in all we are closer to clang support out of the box than I thought we were last week.\n\nSo it is more important that things to start the build are available and open to criticism.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28bea10bb28a666d6f9547f358bb0675243f1496\">28bea10</a></td><td><code>Basic changes to get building of gcc to skip if using clang+gfortran from system and always use clang on OS X</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f\">376ed4f</a></td><td><code>Add missing macro</code></td></tr></table>\n",
    "created_at": "2017-04-10T01:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138675",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
I know I said I wouldn't provide a branch, but all in all we are closer to clang support out of the box than I thought we were last week.

So it is more important that things to start the build are available and open to criticism.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28bea10bb28a666d6f9547f358bb0675243f1496">28bea10</a></td><td><code>Basic changes to get building of gcc to skip if using clang+gfortran from system and always use clang on OS X</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f">376ed4f</a></td><td><code>Add missing macro</code></td></tr></table>




---

archive/issue_comments_138676.json:
```json
{
    "body": "**Branch:** [u/fbissey/clang-start](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-start)",
    "created_at": "2017-04-10T01:52:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138676",
    "user": "https://github.com/kiwifb"
}
```

**Branch:** [u/fbissey/clang-start](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-start)



---

archive/issue_comments_138677.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,10 +16,10 @@\n * fix abuse of `inline` keyword in `pxd` files #21696\n * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n * fix conflicting language options (`-std=c99` used by C++ code): #22554\n-* Singular 4 to be checked\n * build with clang: fplll symbol not found errors (#22643)\n * `polybori` segfault when built with clang on OS X (#22677)\n * Get sage to select the right compiler when built with clang (#22678)\n+* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.\n \n ---\n \n``````\n",
    "created_at": "2017-04-10T03:35:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138677",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,10 +16,10 @@
 * fix abuse of `inline` keyword in `pxd` files #21696
 * Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
 * fix conflicting language options (`-std=c99` used by C++ code): #22554
-* Singular 4 to be checked
 * build with clang: fplll symbol not found errors (#22643)
 * `polybori` segfault when built with clang on OS X (#22677)
 * Get sage to select the right compiler when built with clang (#22678)
+* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.
 
 ---
 
``````




---

archive/issue_comments_138678.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -38,7 +38,7 @@\n Testing: merge the attached branch, run `autoreconf` and build with\n \n ```\n-CC=CLANG CXX=clang++ make\n+CC=clang CXX=clang++ make\n ```\n \n \n``````\n",
    "created_at": "2017-04-10T03:36:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138678",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -38,7 +38,7 @@
 Testing: merge the attached branch, run `autoreconf` and build with
 
 ```
-CC=CLANG CXX=clang++ make
+CC=clang CXX=clang++ make
 ```
 
 
``````




---

archive/issue_comments_138679.json:
```json
{
    "body": "<a id='comment:5'></a>\ncan we have the following\n\n```\n+    if [ \"$UNAME\" = \"Darwin\" ]; then\n+        CXX=clang++\n```\n\nless Darwin-centric?\n(I'd like to have `\"Darwin\" || \"FreeBSD\"`)\n\nPerhaps CC should come from a configure parameter (that has a default)\n\nThen, how about making CPP configurable too? (I imagine that for clang on linux you don't want the default cpp, no?)",
    "created_at": "2017-04-11T09:33:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138679",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
can we have the following

```
+    if [ "$UNAME" = "Darwin" ]; then
+        CXX=clang++
```

less Darwin-centric?
(I'd like to have `"Darwin" || "FreeBSD"`)

Perhaps CC should come from a configure parameter (that has a default)

Then, how about making CPP configurable too? (I imagine that for clang on linux you don't want the default cpp, no?)



---

archive/issue_comments_138680.json:
```json
{
    "body": "<a id='comment:6'></a>\nI would have thought that you would bring your fortran compiler on freeBSD. That part is only really activated if you compile gcc, which is only necessary if you don't already have a gfortran install.\n\nAnything more complicated should indeed be the object of a configuration.\n\nFor `CPP`, on linux I have `clang-cpp` installed, yes there is room for stuff there, especially after the experience with the curl ticket.",
    "created_at": "2017-04-11T09:41:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138680",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
I would have thought that you would bring your fortran compiler on freeBSD. That part is only really activated if you compile gcc, which is only necessary if you don't already have a gfortran install.

Anything more complicated should indeed be the object of a configuration.

For `CPP`, on linux I have `clang-cpp` installed, yes there is room for stuff there, especially after the experience with the curl ticket.



---

archive/issue_comments_138681.json:
```json
{
    "body": "<a id='comment:7'></a>\n> where we will assume there were only installed to provide gfortran\n\n\nAre you sure that it's impossible to just install `gfortran` without `gcc` and `g++`?\n\nThat would be the best solution: don't install `gcc` and `g++` at all if `clang` is available. Then you would need less special cases in `sage-env`.",
    "created_at": "2017-04-11T09:44:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138681",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
> where we will assume there were only installed to provide gfortran


Are you sure that it's impossible to just install `gfortran` without `gcc` and `g++`?

That would be the best solution: don't install `gcc` and `g++` at all if `clang` is available. Then you would need less special cases in `sage-env`.



---

archive/issue_comments_138682.json:
```json
{
    "body": "<a id='comment:8'></a>\nI don't think it is possible to build gfortran without building gcc/g++, however gfortran is not bootstrapped it is built with the c or c++ compiler so something may be possible. Also there is the possibility of only installing the fortran bits - provided no other dependencies are needed. I'll look into it.",
    "created_at": "2017-04-11T09:55:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138682",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
I don't think it is possible to build gfortran without building gcc/g++, however gfortran is not bootstrapped it is built with the c or c++ compiler so something may be possible. Also there is the possibility of only installing the fortran bits - provided no other dependencies are needed. I'll look into it.



---

archive/issue_comments_138683.json:
```json
{
    "body": "<a id='comment:169'></a>\nReplying to [fbissey](#comment%3A166):\n> I would have thought that you would bring your fortran compiler on freeBSD. That part is only really activated if you compile gcc, which is only necessary if you don't already have a gfortran install.\n\n\nI am not sure if system's gfortran is a good idea on FreeBSD, especially as it needs that ugly `/lib/libgcc_s` replacement. Perhaps Sage's gfortran will not need it.\nI'd like to try, as replacing `/lib/libgcc_s` might be a red flag for many...\n\nBy the way, what is the correct way to set up global LDFLAGS for Sage building?\n(Adding them by hand is ugly...)",
    "created_at": "2017-04-11T10:19:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138683",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:169'></a>
Replying to [fbissey](#comment%3A166):
> I would have thought that you would bring your fortran compiler on freeBSD. That part is only really activated if you compile gcc, which is only necessary if you don't already have a gfortran install.


I am not sure if system's gfortran is a good idea on FreeBSD, especially as it needs that ugly `/lib/libgcc_s` replacement. Perhaps Sage's gfortran will not need it.
I'd like to try, as replacing `/lib/libgcc_s` might be a red flag for many...

By the way, what is the correct way to set up global LDFLAGS for Sage building?
(Adding them by hand is ugly...)



---

archive/issue_comments_138684.json:
```json
{
    "body": "<a id='comment:0'></a>\nOk first investigations in gfortran \n1. easiest: install the binary package from https://gcc.gnu.org/wiki/GFortranBinaries#MacOS\n2. I tried to follow http://fortranhelp.blogspot.co.nz/2010/09/building-gfortran-from-source-code-on.html but it sets itself to build the c compiler as well.\n\nYes libgcc_c is probably why I end up build the c compiler.",
    "created_at": "2017-04-11T10:26:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138684",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Ok first investigations in gfortran 
1. easiest: install the binary package from https://gcc.gnu.org/wiki/GFortranBinaries#MacOS
2. I tried to follow http://fortranhelp.blogspot.co.nz/2010/09/building-gfortran-from-source-code-on.html but it sets itself to build the c compiler as well.

Yes libgcc_c is probably why I end up build the c compiler.



---

archive/issue_comments_138685.json:
```json
{
    "body": "<a id='comment:1'></a>\nNumber 2 still installed gcc but not g++. It was also much, much faster.",
    "created_at": "2017-04-11T11:06:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138685",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Number 2 still installed gcc but not g++. It was also much, much faster.



---

archive/issue_comments_138686.json:
```json
{
    "body": "<a id='comment:172'></a>\nReplying to [fbissey](#comment%3A170):\n\n> \n> Yes libgcc_c is probably why I end up build the c compiler.\n\n\ndo you mean libgcc_s ?",
    "created_at": "2017-04-11T11:11:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138686",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:172'></a>
Replying to [fbissey](#comment%3A170):

> 
> Yes libgcc_c is probably why I end up build the c compiler.


do you mean libgcc_s ?



---

archive/issue_comments_138687.json:
```json
{
    "body": "<a id='comment:173'></a>\nReplying to [dimpase](#comment%3A172):\n> Replying to [fbissey](#comment%3A170):\n> \n> > \n> > Yes libgcc_c is probably why I end up build the c compiler.\n\n> \n> do you mean libgcc_s ?\n\n\nyes",
    "created_at": "2017-04-11T11:12:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138687",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:173'></a>
Replying to [dimpase](#comment%3A172):
> Replying to [fbissey](#comment%3A170):
> 
> > 
> > Yes libgcc_c is probably why I end up build the c compiler.

> 
> do you mean libgcc_s ?


yes



---

archive/issue_comments_138688.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK after a good night sleep and some thinking I think we can tweak the configuration script and the gcc package to trigger the building of gfortan only under certain condition. At install time we can just suppress the `gcc` and `cpp` executables.\n\nIt is also much faster. It takes several hours (~3) to bootstrap and build a full gcc/g++/gfortran on my poor laptop. It is now the the single most time consuming item, probably longer than the rest combined. It would be reduced to about half an hour which makes building on that machine much more bearable.",
    "created_at": "2017-04-11T21:50:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138688",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
OK after a good night sleep and some thinking I think we can tweak the configuration script and the gcc package to trigger the building of gfortan only under certain condition. At install time we can just suppress the `gcc` and `cpp` executables.

It is also much faster. It takes several hours (~3) to bootstrap and build a full gcc/g++/gfortran on my poor laptop. It is now the the single most time consuming item, probably longer than the rest combined. It would be reduced to about half an hour which makes building on that machine much more bearable.



---

archive/issue_comments_138689.json:
```json
{
    "body": "**Changing commit** from \"[376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f](https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f)\" to \"[74cb5f7ec3645f62d44649c1767ca3b00c633ec4](https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4)\".",
    "created_at": "2017-04-11T22:56:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138689",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f](https://github.com/sagemath/sagetrac-mirror/commit/376ed4fe1cfe33a2d0a6d0e256f064a5a26b2f0f)" to "[74cb5f7ec3645f62d44649c1767ca3b00c633ec4](https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4)".



---

archive/issue_comments_138690.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4\">74cb5f7</a></td><td><code>Only build gfortran if clang is CC and gfortran is not found.</code></td></tr></table>\n",
    "created_at": "2017-04-11T22:56:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4">74cb5f7</a></td><td><code>Only build gfortran if clang is CC and gfortran is not found.</code></td></tr></table>




---

archive/issue_comments_138691.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK this is a first draft. It is quite generic in that if CC is clang and gfortran is not found the gcc package does a minimal install of gfortran.\n\nIn the current setup there is no way to force a full gcc build if you wished too. In fact I removed some OS X specific bits for now until I have checked they are still necessary (I don't believe so but I need experimental proof). So right now the branch would fail to build a full gcc on OS X anyway.\n\nI have leveraged sage-env-config in a minimal way, I am open to alternative suggestion as I put something there that is only ever used by the gcc spkg, which makes it an irritant.\n\nAdding spkg-install.in for gcc could be an interesting option and make it more controllable by configure.",
    "created_at": "2017-04-11T23:04:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138691",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
OK this is a first draft. It is quite generic in that if CC is clang and gfortran is not found the gcc package does a minimal install of gfortran.

In the current setup there is no way to force a full gcc build if you wished too. In fact I removed some OS X specific bits for now until I have checked they are still necessary (I don't believe so but I need experimental proof). So right now the branch would fail to build a full gcc on OS X anyway.

I have leveraged sage-env-config in a minimal way, I am open to alternative suggestion as I put something there that is only ever used by the gcc spkg, which makes it an irritant.

Adding spkg-install.in for gcc could be an interesting option and make it more controllable by configure.



---

archive/issue_comments_138692.json:
```json
{
    "body": "<a id='comment:7'></a>\nArgh.... `mpir` gets initially build without C++ support when building the toolchain. And I have disabled the rebuilding if you just install gfortran. Back to the drawing board.",
    "created_at": "2017-04-12T00:07:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138692",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Argh.... `mpir` gets initially build without C++ support when building the toolchain. And I have disabled the rebuilding if you just install gfortran. Back to the drawing board.



---

archive/issue_comments_138693.json:
```json
{
    "body": "**Changing commit** from \"[74cb5f7ec3645f62d44649c1767ca3b00c633ec4](https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4)\" to \"[2ce0c32ff4fb9085d17d25d058bc539130c77e7e](https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e)\".",
    "created_at": "2017-04-12T01:02:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138693",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[74cb5f7ec3645f62d44649c1767ca3b00c633ec4](https://github.com/sagemath/sagetrac-mirror/commit/74cb5f7ec3645f62d44649c1767ca3b00c633ec4)" to "[2ce0c32ff4fb9085d17d25d058bc539130c77e7e](https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e)".



---

archive/issue_comments_138694.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e\">2ce0c32</a></td><td><code>Restore unconditional re-building of gmp/mpir/mpfr/mpc</code></td></tr></table>\n",
    "created_at": "2017-04-12T01:02:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e">2ce0c32</a></td><td><code>Restore unconditional re-building of gmp/mpir/mpfr/mpc</code></td></tr></table>




---

archive/issue_comments_138695.json:
```json
{
    "body": "<a id='comment:9'></a>\nGoing back one step. That little adventure made me think we need to leverage autoconf more at the spkg-install level but that could be done orthogonally to this ticket.",
    "created_at": "2017-04-12T01:04:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138695",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Going back one step. That little adventure made me think we need to leverage autoconf more at the spkg-install level but that could be done orthogonally to this ticket.



---

archive/issue_comments_138696.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411\">fca8460</a></td><td><code>Improve the comments in gcc</code></td></tr></table>\n",
    "created_at": "2017-04-12T01:38:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138696",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411">fca8460</a></td><td><code>Improve the comments in gcc</code></td></tr></table>




---

archive/issue_comments_138697.json:
```json
{
    "body": "**Changing commit** from \"[2ce0c32ff4fb9085d17d25d058bc539130c77e7e](https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e)\" to \"[fca84601cfe2c9dc0288950c671c53c64bcde411](https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411)\".",
    "created_at": "2017-04-12T01:38:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2ce0c32ff4fb9085d17d25d058bc539130c77e7e](https://github.com/sagemath/sagetrac-mirror/commit/2ce0c32ff4fb9085d17d25d058bc539130c77e7e)" to "[fca84601cfe2c9dc0288950c671c53c64bcde411](https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411)".



---

archive/issue_comments_138698.json:
```json
{
    "body": "<a id='comment:1'></a>\nOK this is fairly good. With this ticket and #22677 sage builds on OS X with clang out of the box and install just gfortran (and a few other bits of gcc along the way). And only the following doctests are failing\n\n```\nsage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed\nsage -t --long src/sage/plot/graphics.py  # 1 doctest failed\nsage -t --long src/sage/plot/plot.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed\n```\none instance of numerical noise (`lseries_ell.py`) and the rest is unexpected warning messages from `numpy`. Needs to be investigated but everything is functional.",
    "created_at": "2017-04-12T09:02:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138698",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
OK this is fairly good. With this ticket and #22677 sage builds on OS X with clang out of the box and install just gfortran (and a few other bits of gcc along the way). And only the following doctests are failing

```
sage -t --long src/doc/en/prep/Calculus.rst  # 1 doctest failed
sage -t --long src/sage/plot/graphics.py  # 1 doctest failed
sage -t --long src/sage/plot/plot.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t --long src/sage/structure/coerce.pyx  # 1 doctest failed
```
one instance of numerical noise (`lseries_ell.py`) and the rest is unexpected warning messages from `numpy`. Needs to be investigated but everything is functional.



---

archive/issue_comments_138699.json:
```json
{
    "body": "<a id='comment:2'></a>\non freebsd/clang numpy produces warnings like\n\n```\n        numpy.float32('1.5') * x\n    :\n    RuntimeWarning: invalid value encountered in multiply\n    1.50000000000000*x\n```\n\n(this one from `src/sage/plot/plot.py`) Do you get the same?\n\nThe biggest difference is that on freebsd I also get problems with `sympow`, it does not fully work on some curves...",
    "created_at": "2017-04-12T10:59:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138699",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
on freebsd/clang numpy produces warnings like

```
        numpy.float32('1.5') * x
    :
    RuntimeWarning: invalid value encountered in multiply
    1.50000000000000*x
```

(this one from `src/sage/plot/plot.py`) Do you get the same?

The biggest difference is that on freebsd I also get problems with `sympow`, it does not fully work on some curves...



---

archive/issue_comments_138700.json:
```json
{
    "body": "<a id='comment:3'></a>\nYes, same. `sage/structure/coerce.pyx` same, `sage/rings/polynomial/polynomial_real_mpfr_dense.pyx` same. The other ones are \n\n```\nRuntimeWarning: invalid value encountered in greater_equal\n```",
    "created_at": "2017-04-12T11:05:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138700",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Yes, same. `sage/structure/coerce.pyx` same, `sage/rings/polynomial/polynomial_real_mpfr_dense.pyx` same. The other ones are 

```
RuntimeWarning: invalid value encountered in greater_equal
```



---

archive/issue_comments_138701.json:
```json
{
    "body": "**Changing commit** from \"[fca84601cfe2c9dc0288950c671c53c64bcde411](https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411)\" to \"[d472cca9e04c100996009d74ec42173202e49168](https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168)\".",
    "created_at": "2017-04-12T21:18:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fca84601cfe2c9dc0288950c671c53c64bcde411](https://github.com/sagemath/sagetrac-mirror/commit/fca84601cfe2c9dc0288950c671c53c64bcde411)" to "[d472cca9e04c100996009d74ec42173202e49168](https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168)".



---

archive/issue_comments_138702.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168\">d472cca</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>\n",
    "created_at": "2017-04-12T21:18:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168">d472cca</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>




---

archive/issue_comments_138703.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429\">eab0de5</a></td><td><code>generate new configure tarball</code></td></tr></table>\n",
    "created_at": "2017-04-12T22:07:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429">eab0de5</a></td><td><code>generate new configure tarball</code></td></tr></table>




---

archive/issue_comments_138704.json:
```json
{
    "body": "**Changing commit** from \"[d472cca9e04c100996009d74ec42173202e49168](https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168)\" to \"[eab0de59d8093c77f2e13cd2d96b4ea09f571429](https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429)\".",
    "created_at": "2017-04-12T22:07:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d472cca9e04c100996009d74ec42173202e49168](https://github.com/sagemath/sagetrac-mirror/commit/d472cca9e04c100996009d74ec42173202e49168)" to "[eab0de59d8093c77f2e13cd2d96b4ea09f571429](https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429)".



---

archive/issue_comments_138705.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -35,10 +35,10 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz) and build with\n \n ```\n-CC=clang CXX=clang++ make\n+make\n ```\n \n \n``````\n",
    "created_at": "2017-04-12T22:11:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138705",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -35,10 +35,10 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz) and build with
 
 ```
-CC=clang CXX=clang++ make
+make
 ```
 
 
``````




---

archive/issue_comments_138706.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -40,5 +40,10 @@\n ```\n make\n ```\n+on OS X, or \n \n+```\n+CC=clang CXX=clang++ make\n+```\n+on OS where clang is not the default compiler [it should also work on OS X].\n \n``````\n",
    "created_at": "2017-04-13T01:18:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138706",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -40,5 +40,10 @@
 ```
 make
 ```
+on OS X, or 
 
+```
+CC=clang CXX=clang++ make
+```
+on OS where clang is not the default compiler [it should also work on OS X].
 
``````




---

archive/issue_comments_138707.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -19,6 +19,7 @@\n * build with clang: fplll symbol not found errors (#22643)\n * `polybori` segfault when built with clang on OS X (#22677)\n * Get sage to select the right compiler when built with clang (#22678)\n+* numerical noise in doctests when built with clang (#22798)\n * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.\n \n ---\n``````\n",
    "created_at": "2017-04-13T01:59:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138707",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -19,6 +19,7 @@
 * build with clang: fplll symbol not found errors (#22643)
 * `polybori` segfault when built with clang on OS X (#22677)
 * Get sage to select the right compiler when built with clang (#22678)
+* numerical noise in doctests when built with clang (#22798)
 * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.
 
 ---
``````




---

archive/issue_comments_138708.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,6 +20,7 @@\n * `polybori` segfault when built with clang on OS X (#22677)\n * Get sage to select the right compiler when built with clang (#22678)\n * numerical noise in doctests when built with clang (#22798)\n+* strange warnings from numpy and matplotlib when built with clang (#22799)\n * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.\n \n ---\n``````\n",
    "created_at": "2017-04-13T02:27:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138708",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,6 +20,7 @@
 * `polybori` segfault when built with clang on OS X (#22677)
 * Get sage to select the right compiler when built with clang (#22678)
 * numerical noise in doctests when built with clang (#22798)
+* strange warnings from numpy and matplotlib when built with clang (#22799)
 * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.
 
 ---
``````




---

archive/issue_comments_138709.json:
```json
{
    "body": "<a id='comment:0'></a>\nIt is exciting to see this progress, and it is exciting to have the `gcc` build take only 7 minutes on my Mac, since it only has to build fortran.",
    "created_at": "2017-04-13T20:49:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138709",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:0'></a>
It is exciting to see this progress, and it is exciting to have the `gcc` build take only 7 minutes on my Mac, since it only has to build fortran.



---

archive/issue_comments_138710.json:
```json
{
    "body": "<a id='comment:1'></a>\nDo we have any good benchmarks? I don't know of any reason why Sage built this way should differ in performance compared to Sage built with `gcc`, but we should probably test it.",
    "created_at": "2017-04-14T01:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138710",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
Do we have any good benchmarks? I don't know of any reason why Sage built this way should differ in performance compared to Sage built with `gcc`, but we should probably test it.



---

archive/issue_comments_138711.json:
```json
{
    "body": "<a id='comment:192'></a>\nReplying to [jhpalmieri](#comment%3A191):\n> Do we have any good benchmarks? I don't know of any reason why Sage built this way should differ in performance compared to Sage built with `gcc`, but we should probably test it.\n\n\nI don't know that we have. But moving to clang on OS X just makes sense. We had to include numerous work around for gcc itself, and some package are already compiled with clang on a case by case basis. This is because we will continue having problems with gcc until either\n* gcc adopt the same extensions as clang\n* apple decides it isn't a good thing to use clang extension in their libc headers and fixes it\n\nNeither is happening anytime soon as far as I am aware. It is increasingly difficult to build a big project on OS X with gcc/g++. The general mood is to just bite the bullet and move to clang.",
    "created_at": "2017-04-14T01:10:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138711",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:192'></a>
Replying to [jhpalmieri](#comment%3A191):
> Do we have any good benchmarks? I don't know of any reason why Sage built this way should differ in performance compared to Sage built with `gcc`, but we should probably test it.


I don't know that we have. But moving to clang on OS X just makes sense. We had to include numerous work around for gcc itself, and some package are already compiled with clang on a case by case basis. This is because we will continue having problems with gcc until either
* gcc adopt the same extensions as clang
* apple decides it isn't a good thing to use clang extension in their libc headers and fixes it

Neither is happening anytime soon as far as I am aware. It is increasingly difficult to build a big project on OS X with gcc/g++. The general mood is to just bite the bullet and move to clang.



---

archive/issue_comments_138712.json:
```json
{
    "body": "<a id='comment:3'></a>\nDon't misunderstand me, I am happy to see the change. We should make sure it doesn't lead to any regressions, though.",
    "created_at": "2017-04-14T01:42:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138712",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
Don't misunderstand me, I am happy to see the change. We should make sure it doesn't lead to any regressions, though.



---

archive/issue_comments_138713.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK, benchmarking has always been a thorny issue. I don't believe we have one apart from doctesting time.",
    "created_at": "2017-04-14T01:44:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138713",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
OK, benchmarking has always been a thorny issue. I don't believe we have one apart from doctesting time.



---

archive/issue_comments_138714.json:
```json
{
    "body": "<a id='comment:5'></a>\nI tried some ad hoc testing, and I don't see any speed difference between the two builds. I don't know if anyone wants to try anything systematic.",
    "created_at": "2017-04-14T17:24:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138714",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
I tried some ad hoc testing, and I don't see any speed difference between the two builds. I don't know if anyone wants to try anything systematic.



---

archive/issue_comments_138715.json:
```json
{
    "body": "<a id='comment:196'></a>\nReplying to [jhpalmieri](#comment%3A195):\n> I tried some ad hoc testing, and I don't see any speed difference between the two builds. I don't know if anyone wants to try anything systematic.\n\n\nInternet has benchmarking stuff for clang vs gcc, in particular as far as HPC things are concerned. Give or take, they are largely on par. \n(One nice thing about clang is that it compiles and links faster than gcc, this is something seemingly well-known).\n\nBy the way, what is the assembler used by clang on OSX? Is it built-in, or external?",
    "created_at": "2017-04-14T17:28:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138715",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:196'></a>
Replying to [jhpalmieri](#comment%3A195):
> I tried some ad hoc testing, and I don't see any speed difference between the two builds. I don't know if anyone wants to try anything systematic.


Internet has benchmarking stuff for clang vs gcc, in particular as far as HPC things are concerned. Give or take, they are largely on par. 
(One nice thing about clang is that it compiles and links faster than gcc, this is something seemingly well-known).

By the way, what is the assembler used by clang on OSX? Is it built-in, or external?



---

archive/issue_comments_138716.json:
```json
{
    "body": "<a id='comment:197'></a>\nReplying to [dimpase](#comment%3A196):\n> By the way, what is the assembler used by clang on OSX? Is it built-in, or external?\n\n\nI can check. How do I identify the assembler?",
    "created_at": "2017-04-18T18:59:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138716",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:197'></a>
Replying to [dimpase](#comment%3A196):
> By the way, what is the assembler used by clang on OSX? Is it built-in, or external?


I can check. How do I identify the assembler?



---

archive/issue_comments_138717.json:
```json
{
    "body": "<a id='comment:8'></a>\nI seem to recall that clang has a built-in assembler. But don't quote me on this...",
    "created_at": "2017-04-18T19:13:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138717",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
I seem to recall that clang has a built-in assembler. But don't quote me on this...



---

archive/issue_comments_138718.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe man page says:\n\n```\nClang also supports the use of an integrated assembler\n```\nand lists as options\n\n```\n-integrated-as, -no-integrated-as\n       Used to enable and disable, respectively,  the  use  of  the  integrated\n       assembler.  Whether  the integrated assembler is on by default is target\n       dependent.\n```",
    "created_at": "2017-04-18T19:24:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138718",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
The man page says:

```
Clang also supports the use of an integrated assembler
```
and lists as options

```
-integrated-as, -no-integrated-as
       Used to enable and disable, respectively,  the  use  of  the  integrated
       assembler.  Whether  the integrated assembler is on by default is target
       dependent.
```



---

archive/issue_comments_138719.json:
```json
{
    "body": "<a id='comment:200'></a>\nInteresting\n\n```\nMirage:~ fbissey$ clang -cc1 --help | grep assembler\n  -emit-llvm              Use the LLVM representation for assembler and object files\n  -fno-integrated-as      Disable the integrated assembler\n  -massembler-fatal-warnings\n                          Make assembler warnings fatal\n```\nSo an option to disabler internal assembler is lister but not one to enable it, which suggest that it is the default.",
    "created_at": "2017-04-18T19:34:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138719",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:200'></a>
Interesting

```
Mirage:~ fbissey$ clang -cc1 --help | grep assembler
  -emit-llvm              Use the LLVM representation for assembler and object files
  -fno-integrated-as      Disable the integrated assembler
  -massembler-fatal-warnings
                          Make assembler warnings fatal
```
So an option to disabler internal assembler is lister but not one to enable it, which suggest that it is the default.



---

archive/issue_comments_138720.json:
```json
{
    "body": "<a id='comment:1'></a>\nI'm building Sage with `SAGE_CHECK=yes` on OS X, and I am seeing some failures of test suites. For some packages (`ntl`, `gf2x`) I see failures when building with `gcc` or with `clang`, but with `zeromq`, I see a new failure just with `clang`:\n\n```\nInvalid argument (stream_engine.cpp:94)\n/bin/sh: line 1: 58001 Abort trap: 6           ${dir}$tst\nFAIL: test_shutdown_stress\n```",
    "created_at": "2017-04-19T22:13:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138720",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I'm building Sage with `SAGE_CHECK=yes` on OS X, and I am seeing some failures of test suites. For some packages (`ntl`, `gf2x`) I see failures when building with `gcc` or with `clang`, but with `zeromq`, I see a new failure just with `clang`:

```
Invalid argument (stream_engine.cpp:94)
/bin/sh: line 1: 58001 Abort trap: 6           ${dir}$tst
FAIL: test_shutdown_stress
```



---

archive/issue_comments_138721.json:
```json
{
    "body": "<a id='comment:2'></a>\nYes, I haven't done that extensively with my little laptop. I will investigate `zeromq` - I think it is due a version bump anyway, our `pyzmq` complains that `zeromq` is too old. Version bump could take care of the failure, or not.",
    "created_at": "2017-04-19T22:18:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138721",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Yes, I haven't done that extensively with my little laptop. I will investigate `zeromq` - I think it is due a version bump anyway, our `pyzmq` complains that `zeromq` is too old. Version bump could take care of the failure, or not.



---

archive/issue_comments_138722.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK, very easy solution to that.\n\n```\n[zeromq-4.0.5] Assertion failed: (rc == 0), function main, file test_abstract_ipc.cpp, line 31.\n[zeromq-4.0.5] /bin/sh: line 1:  8898 Abort trap: 6           ${dir}$tst\n[zeromq-4.0.5] XFAIL: test_abstract_ipc\n[zeromq-4.0.5] PASS: test_many_sockets\n[zeromq-4.0.5] PASS: test_shutdown_stress\n[zeromq-4.0.5] PASS: test_pair_ipc\n[zeromq-4.0.5] PASS: test_reqrep_ipc\n[zeromq-4.0.5] PASS: test_timeo\n[zeromq-4.0.5] PASS: test_fork\n[zeromq-4.0.5] =====================================================\n[zeromq-4.0.5] All 43 tests behaved as expected (1 expected failure)\n[zeromq-4.0.5] =====================================================\n[zeromq-4.0.5] Making check in tools\n[zeromq-4.0.5] make[3]: Nothing to be done for `check'.\n[zeromq-4.0.5] make[3]: Nothing to be done for `check-am'.\n[zeromq-4.0.5] \n[zeromq-4.0.5] real\t0m8.181s\n[zeromq-4.0.5] user\t0m0.985s\n[zeromq-4.0.5] sys\t0m1.320s\n[zeromq-4.0.5] Deleting temporary build directory\n[zeromq-4.0.5] /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/zeromq-4.0.5\n[zeromq-4.0.5] Finished installing zeromq-4.0.5.spkg\n```\nThe gentoo ebuild for zeromq notes that upstream doesn't support testing in parallel. Just doing\n\n```\ndiff --git a/build/pkgs/zeromq/spkg-check b/build/pkgs/zeromq/spkg-check\nindex 598280def1..3b36b91b55 100755\n--- a/build/pkgs/zeromq/spkg-check\n+++ b/build/pkgs/zeromq/spkg-check\n@@ -6,5 +6,5 @@ if [ \"$UNAME\" = \"Darwin\" ]; then\n fi\n \n cd src\n-$MAKE check\n+$MAKE -j1 check\n \n```\nmakes the test pass for me.",
    "created_at": "2017-04-19T23:10:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138722",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
OK, very easy solution to that.

```
[zeromq-4.0.5] Assertion failed: (rc == 0), function main, file test_abstract_ipc.cpp, line 31.
[zeromq-4.0.5] /bin/sh: line 1:  8898 Abort trap: 6           ${dir}$tst
[zeromq-4.0.5] XFAIL: test_abstract_ipc
[zeromq-4.0.5] PASS: test_many_sockets
[zeromq-4.0.5] PASS: test_shutdown_stress
[zeromq-4.0.5] PASS: test_pair_ipc
[zeromq-4.0.5] PASS: test_reqrep_ipc
[zeromq-4.0.5] PASS: test_timeo
[zeromq-4.0.5] PASS: test_fork
[zeromq-4.0.5] =====================================================
[zeromq-4.0.5] All 43 tests behaved as expected (1 expected failure)
[zeromq-4.0.5] =====================================================
[zeromq-4.0.5] Making check in tools
[zeromq-4.0.5] make[3]: Nothing to be done for `check'.
[zeromq-4.0.5] make[3]: Nothing to be done for `check-am'.
[zeromq-4.0.5] 
[zeromq-4.0.5] real	0m8.181s
[zeromq-4.0.5] user	0m0.985s
[zeromq-4.0.5] sys	0m1.320s
[zeromq-4.0.5] Deleting temporary build directory
[zeromq-4.0.5] /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/zeromq-4.0.5
[zeromq-4.0.5] Finished installing zeromq-4.0.5.spkg
```
The gentoo ebuild for zeromq notes that upstream doesn't support testing in parallel. Just doing

```
diff --git a/build/pkgs/zeromq/spkg-check b/build/pkgs/zeromq/spkg-check
index 598280def1..3b36b91b55 100755
--- a/build/pkgs/zeromq/spkg-check
+++ b/build/pkgs/zeromq/spkg-check
@@ -6,5 +6,5 @@ if [ "$UNAME" = "Darwin" ]; then
 fi
 
 cd src
-$MAKE check
+$MAKE -j1 check
 
```
makes the test pass for me.



---

archive/issue_comments_138723.json:
```json
{
    "body": "<a id='comment:4'></a>\nI have looked into ntl and gf2x. I am assuming that it is in fact the same, or related, failure in both case. I think we should report it to upstream gf2x.",
    "created_at": "2017-04-19T23:43:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138723",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
I have looked into ntl and gf2x. I am assuming that it is in fact the same, or related, failure in both case. I think we should report it to upstream gf2x.



---

archive/issue_comments_138724.json:
```json
{
    "body": "<a id='comment:5'></a>\nIs it the same as #18882?",
    "created_at": "2017-04-20T00:02:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138724",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Is it the same as #18882?



---

archive/issue_comments_138725.json:
```json
{
    "body": "<a id='comment:206'></a>\nReplying to [jhpalmieri](#comment%3A205):\n> Is it the same as #18882?\n\n\nYes.\n\n```\n[gf2x-1.1.p1] -n 100x100 \n[gf2x-1.1.p1] failed : '100 100 cca56aa6 76540123' != '100 100 2269c4fa 76540123'\n```",
    "created_at": "2017-04-20T00:04:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138725",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:206'></a>
Replying to [jhpalmieri](#comment%3A205):
> Is it the same as #18882?


Yes.

```
[gf2x-1.1.p1] -n 100x100 
[gf2x-1.1.p1] failed : '100 100 cca56aa6 76540123' != '100 100 2269c4fa 76540123'
```



---

archive/issue_comments_138726.json:
```json
{
    "body": "<a id='comment:7'></a>\n`ccache` also fails for me, both gcc and clang builds. I just opened #22836.",
    "created_at": "2017-04-20T00:22:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138726",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
`ccache` also fails for me, both gcc and clang builds. I just opened #22836.



---

archive/issue_comments_138727.json:
```json
{
    "body": "<a id='comment:8'></a>\nAnother `clang`-specific failure on OS X: `giac`. On one hand, `giac` builds in 35sec with `clang`, as compared to 6m with `gcc` (!), but I get one test suite failure with `clang`:\n\n```\n51c51\n< -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\n---\n> sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\nFAIL: chk_fhan16\n```",
    "created_at": "2017-04-20T02:38:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138727",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Another `clang`-specific failure on OS X: `giac`. On one hand, `giac` builds in 35sec with `clang`, as compared to 6m with `gcc` (!), but I get one test suite failure with `clang`:

```
51c51
< -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
---
> sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
FAIL: chk_fhan16
```



---

archive/issue_comments_138728.json:
```json
{
    "body": "<a id='comment:9'></a>\nCython fails its test suite, with both `clang` and `gcc`, reported at #22166.",
    "created_at": "2017-04-20T02:48:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138728",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Cython fails its test suite, with both `clang` and `gcc`, reported at #22166.



---

archive/issue_comments_138729.json:
```json
{
    "body": "<a id='comment:0'></a>\nNote that if a package fails its test suite with both `gcc` and `clang`, I am not at all saying that we need to deal with it before this ticket gets positively reviewed. I'm just reporting the current situation. When `clang` introduces new failures, we should investigate.",
    "created_at": "2017-04-20T02:52:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138729",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:0'></a>
Note that if a package fails its test suite with both `gcc` and `clang`, I am not at all saying that we need to deal with it before this ticket gets positively reviewed. I'm just reporting the current situation. When `clang` introduces new failures, we should investigate.



---

archive/issue_comments_138730.json:
```json
{
    "body": "<a id='comment:211'></a>\nReplying to [fbissey](#comment%3A203):\n> OK, very easy solution to that.\n\n>\n>   [ snip ]\n\n>\n> The gentoo ebuild for zeromq notes that upstream doesn't support testing in parallel. Just doing\n> \n> ```\n> diff --git a/build/pkgs/zeromq/spkg-check b/build/pkgs/zeromq/spkg-check\n> index 598280def1..3b36b91b55 100755\n> --- a/build/pkgs/zeromq/spkg-check\n> +++ b/build/pkgs/zeromq/spkg-check\n> @@ -6,5 +6,5 @@ if [ \"$UNAME\" = \"Darwin\" ]; then\n>  fi\n>  \n>  cd src\n> -$MAKE check\n> +$MAKE -j1 check\n>  \n> ```\n> makes the test pass for me.\n\n\nThe test passed for me without any changes on a different machine, so it is intermittent.  We should probably make this change anyway. See #22837. (I've made you the author and me the reviewer.)",
    "created_at": "2017-04-20T02:58:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138730",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:211'></a>
Replying to [fbissey](#comment%3A203):
> OK, very easy solution to that.

>
>   [ snip ]

>
> The gentoo ebuild for zeromq notes that upstream doesn't support testing in parallel. Just doing
> 
> ```
> diff --git a/build/pkgs/zeromq/spkg-check b/build/pkgs/zeromq/spkg-check
> index 598280def1..3b36b91b55 100755
> --- a/build/pkgs/zeromq/spkg-check
> +++ b/build/pkgs/zeromq/spkg-check
> @@ -6,5 +6,5 @@ if [ "$UNAME" = "Darwin" ]; then
>  fi
>  
>  cd src
> -$MAKE check
> +$MAKE -j1 check
>  
> ```
> makes the test pass for me.


The test passed for me without any changes on a different machine, so it is intermittent.  We should probably make this change anyway. See #22837. (I've made you the author and me the reviewer.)



---

archive/issue_comments_138731.json:
```json
{
    "body": "<a id='comment:212'></a>\nReplying to [jhpalmieri](#comment%3A208):\n> Another `clang`-specific failure on OS X: `giac`. On one hand, `giac` builds in 35sec with `clang`, as compared to 6m with `gcc` (!), but I get one test suite failure with `clang`:\n> \n> ```\n> 51c51\n> < -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\n> ---\n> > sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\n> FAIL: chk_fhan16\n> ```\n\n\nMost interesting because it originates with https://github.com/sagemath/sage/blob/master/build/pkgs/giac/patches/cSolveorder-check.patch I am sure. And that patch is needed with gcc for pari-2.8+ (i.e. with pari 2.7 it is not needed).",
    "created_at": "2017-04-20T03:09:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138731",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:212'></a>
Replying to [jhpalmieri](#comment%3A208):
> Another `clang`-specific failure on OS X: `giac`. On one hand, `giac` builds in 35sec with `clang`, as compared to 6m with `gcc` (!), but I get one test suite failure with `clang`:
> 
> ```
> 51c51
> < -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
> ---
> > sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
> FAIL: chk_fhan16
> ```


Most interesting because it originates with https://github.com/sagemath/sage/blob/master/build/pkgs/giac/patches/cSolveorder-check.patch I am sure. And that patch is needed with gcc for pari-2.8+ (i.e. with pari 2.7 it is not needed).



---

archive/issue_comments_138732.json:
```json
{
    "body": "<a id='comment:3'></a>\n`cysignals` also fails its test suite. This is not fixed by #22695: that is, both the current version and the version in #22695 pass tests with `gcc` and fail with `clang`. The failures:\n\n```\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 168, in tests.pyx\nFailed example:\n    test_sig_on()\nExpected:\n    KeyboardInterrupt()\nGot:\n    SystemError('unknown signal number 0',)\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 182, in tests.pyx\nFailed example:\n    test_sig_str()\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: Everything ok!\nGot:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py\", line 1315, in __run\n        compileflags, 1) in test.globs\n      File \"<doctest tests.pyx[12]>\", line 1, in <module>\n        test_sig_str()\n      File \"src/cysignals/tests.pyx\", line 189, in cysignals.tests.test_sig_str (build/src/cysignals/tests.c:2665)\n        sig_str(\"Everything ok!\")\n      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1699)\n        raise SignalError(s or \"Segmentation fault\")\n    SignalError: Everything ok!\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 203, in tests.pyx\nFailed example:\n    test_sig_on_cython()\nExpected:\n    KeyboardInterrupt()\nGot:\n    SystemError('unknown signal number 0',)\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 220, in tests.pyx\nFailed example:\n    test_sig_on_cython_except()\nExpected:\n    KeyboardInterrupt()\nGot:\n    SystemError('unknown signal number 0',)\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 238, in tests.pyx\nFailed example:\n    test_sig_on_cython_except_all()\nExpected:\n    KeyboardInterrupt()\nGot:\n    SystemError('unknown signal number 0',)\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 267, in tests.pyx\nFailed example:\n    test_sig_check_inside_sig_on()\nExpected:\n    KeyboardInterrupt()\nGot:\n    RuntimeError('Aborted',)\nTraceback (most recent call last):\n  File \"rundoctests.py\", line 20, in <module>\n    failures, _ = doctest.testfile(f, module_relative=False, optionflags=flags)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py\", line 2036, in testfile\n    runner.run(test)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py\", line 1454, in run\n    return self.__run(test, compileflags, out)\n  File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py\", line 1315, in __run\n    compileflags, 1) in test.globs\n  File \"src/cysignals/signals.pyx\", line 252, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2858)\n    sig_check()\n  File \"src/cysignals/signals.pyx\", line 97, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1307)\n    raise KeyboardInterrupt\nKeyboardInterrupt\nmake[3]: *** [check-doctest] Interrupt: 2\n```",
    "created_at": "2017-04-20T04:06:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138732",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
`cysignals` also fails its test suite. This is not fixed by #22695: that is, both the current version and the version in #22695 pass tests with `gcc` and fail with `clang`. The failures:

```
**********************************************************************
File "src/cysignals/tests.pyx", line 168, in tests.pyx
Failed example:
    test_sig_on()
Expected:
    KeyboardInterrupt()
Got:
    SystemError('unknown signal number 0',)
**********************************************************************
File "src/cysignals/tests.pyx", line 182, in tests.pyx
Failed example:
    test_sig_str()
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: Everything ok!
Got:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py", line 1315, in __run
        compileflags, 1) in test.globs
      File "<doctest tests.pyx[12]>", line 1, in <module>
        test_sig_str()
      File "src/cysignals/tests.pyx", line 189, in cysignals.tests.test_sig_str (build/src/cysignals/tests.c:2665)
        sig_str("Everything ok!")
      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1699)
        raise SignalError(s or "Segmentation fault")
    SignalError: Everything ok!
**********************************************************************
File "src/cysignals/tests.pyx", line 203, in tests.pyx
Failed example:
    test_sig_on_cython()
Expected:
    KeyboardInterrupt()
Got:
    SystemError('unknown signal number 0',)
**********************************************************************
File "src/cysignals/tests.pyx", line 220, in tests.pyx
Failed example:
    test_sig_on_cython_except()
Expected:
    KeyboardInterrupt()
Got:
    SystemError('unknown signal number 0',)
**********************************************************************
File "src/cysignals/tests.pyx", line 238, in tests.pyx
Failed example:
    test_sig_on_cython_except_all()
Expected:
    KeyboardInterrupt()
Got:
    SystemError('unknown signal number 0',)
**********************************************************************
File "src/cysignals/tests.pyx", line 267, in tests.pyx
Failed example:
    test_sig_check_inside_sig_on()
Expected:
    KeyboardInterrupt()
Got:
    RuntimeError('Aborted',)
Traceback (most recent call last):
  File "rundoctests.py", line 20, in <module>
    failures, _ = doctest.testfile(f, module_relative=False, optionflags=flags)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py", line 2036, in testfile
    runner.run(test)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py", line 1454, in run
    return self.__run(test, compileflags, out)
  File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta2/local/lib/python2.7/doctest.py", line 1315, in __run
    compileflags, 1) in test.globs
  File "src/cysignals/signals.pyx", line 252, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2858)
    sig_check()
  File "src/cysignals/signals.pyx", line 97, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1307)
    raise KeyboardInterrupt
KeyboardInterrupt
make[3]: *** [check-doctest] Interrupt: 2
```



---

archive/issue_comments_138733.json:
```json
{
    "body": "<a id='comment:4'></a>\n`eclib` fails its test suite with `clang` but not with `gcc`. Looks like just numerical noise, I hope:\n\n```\nTesting smattest...\nTesting comptest...\n5c5\n< AGM((3.125,4.25),(1,0)) = (2.07831617217326684,1.5633615899065958201)\n---\n> AGM((3.125,4.25),(1,0)) = (2.07831617217326684,1.56336158990659582)\n14c14\n< whose cube is    (2.9999999999999999998,3.9999999999999999999)\n---\n> whose cube is    (2.9999999999999999999,4)\n16c16\n< whose cube is    (2.9999999999999999997,3.9999999999999999999)\n---\n> whose cube is    (2.9999999999999999996,3.9999999999999999998)\nmake[4]: *** [check_procs] Error 1\nmake[3]: *** [check] Error 2\nmake[2]: *** [check-recursive] Error 1\nError: eclib's test suite failed to pass.\n```",
    "created_at": "2017-04-20T04:18:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138733",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
`eclib` fails its test suite with `clang` but not with `gcc`. Looks like just numerical noise, I hope:

```
Testing smattest...
Testing comptest...
5c5
< AGM((3.125,4.25),(1,0)) = (2.07831617217326684,1.5633615899065958201)
---
> AGM((3.125,4.25),(1,0)) = (2.07831617217326684,1.56336158990659582)
14c14
< whose cube is    (2.9999999999999999998,3.9999999999999999999)
---
> whose cube is    (2.9999999999999999999,4)
16c16
< whose cube is    (2.9999999999999999997,3.9999999999999999999)
---
> whose cube is    (2.9999999999999999996,3.9999999999999999998)
make[4]: *** [check_procs] Error 1
make[3]: *** [check] Error 2
make[2]: *** [check-recursive] Error 1
Error: eclib's test suite failed to pass.
```



---

archive/issue_comments_138734.json:
```json
{
    "body": "<a id='comment:5'></a>\nHum, cysignals stuff looks serious, looks like some mapping is wrong. For eclib it really looks like just numerical noise.",
    "created_at": "2017-04-20T04:39:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138734",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
Hum, cysignals stuff looks serious, looks like some mapping is wrong. For eclib it really looks like just numerical noise.



---

archive/issue_comments_138735.json:
```json
{
    "body": "<a id='comment:6'></a>\nI can reproduce the eclib failures on linux+clang.",
    "created_at": "2017-04-20T04:51:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138735",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
I can reproduce the eclib failures on linux+clang.



---

archive/issue_comments_138736.json:
```json
{
    "body": "<a id='comment:7'></a>\nThat's my complete list of failed test suites. Summarizing: `clang`-only failures for:\n- `eclib`: numerical noise, so hopefully minor\n- `giac`\n- `cysignals`\nFailures with both `clang` and `gcc`: \n- `ccache`: #22836\n- `gf2x` and `ntl` (related?)\n- `zeromq`: intermittent, perhaps addressed at #22837 although I haven't tested thoroughly to see if that completely fixes the problem\n- `cython`: #22166\n\nOh, and I forgot to mention: `python3` \u2013 does any python package ever pass its test suite with Sage?",
    "created_at": "2017-04-20T05:00:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138736",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
That's my complete list of failed test suites. Summarizing: `clang`-only failures for:
- `eclib`: numerical noise, so hopefully minor
- `giac`
- `cysignals`
Failures with both `clang` and `gcc`: 
- `ccache`: #22836
- `gf2x` and `ntl` (related?)
- `zeromq`: intermittent, perhaps addressed at #22837 although I haven't tested thoroughly to see if that completely fixes the problem
- `cython`: #22166

Oh, and I forgot to mention: `python3` ‚Äì does any python package ever pass its test suite with Sage?



---

archive/issue_comments_138737.json:
```json
{
    "body": "<a id='comment:218'></a>\nReplying to [jhpalmieri](#comment%3A217):\n> Oh, and I forgot to mention: `python3` \u2013 does any python package ever pass its test suite with Sage?\n\n\nI don't think we have in some time but Volker would have some ideas on that.",
    "created_at": "2017-04-20T05:03:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138737",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:218'></a>
Replying to [jhpalmieri](#comment%3A217):
> Oh, and I forgot to mention: `python3` ‚Äì does any python package ever pass its test suite with Sage?


I don't think we have in some time but Volker would have some ideas on that.



---

archive/issue_comments_138738.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -25,6 +25,16 @@\n \n ---\n \n+Packages failing their tests\n+* `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n+* `gf2x`/`ntl` #18882\n+* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n+* `zeromq` #22837?\n+* `ccache` #22836\n+* `cysignals`, strangely passes with python 3.4 but not 2.7\n+\n+---\n+\n Spkgs ignoring CC/CXX environment variables:\n \n * Sage -- #12443 ?\n``````\n",
    "created_at": "2017-04-22T05:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138738",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -25,6 +25,16 @@
 
 ---
 
+Packages failing their tests
+* `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
+* `gf2x`/`ntl` #18882
+* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
+* `zeromq` #22837?
+* `ccache` #22836
+* `cysignals`, strangely passes with python 3.4 but not 2.7
+
+---
+
 Spkgs ignoring CC/CXX environment variables:
 
 * Sage -- #12443 ?
``````




---

archive/issue_comments_138739.json:
```json
{
    "body": "<a id='comment:9'></a>\nI just finished a build of 8.0.beta2 with clang+linux, hacking my way through the pyzmq problem, and there is a truckload of doctest failures. However it is exclusively, as far as I can see through the mess, all done to a failure in `sage.matrix.matrix_integer_dense.so`. A nice isolated example is\n\n```\nsage -t --long src/sage/rings/qqbar.py\n**********************************************************************\nFile \"src/sage/rings/qqbar.py\", line 237, in sage.rings.qqbar\nFailed example:\n    r.imag().minpoly()  # long time (10s on sage.math, 2013)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 503, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 866, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.qqbar[72]>\", line 1, in <module>\n        r.imag().minpoly()  # long time (10s on sage.math, 2013)\n      File \"/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 3403, in minpoly\n        self._minimal_polynomial = self._descr.minpoly()\n      File \"/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 6426, in minpoly\n        self._minpoly = self._value.minpoly()\n      File \"sage/rings/number_field/number_field_element.pyx\", line 4291, in sage.rings.number_field.number_field_element.NumberFieldElement_absolute.minpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/rings/number_field/number_field_element.cpp:40412)\n        return self.charpoly(var, algorithm).radical() # square free part of charpoly\n      File \"sage/rings/number_field/number_field_element.pyx\", line 4258, in sage.rings.number_field.number_field_element.NumberFieldElement_absolute.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/rings/number_field/number_field_element.cpp:40187)\n        return R(self.matrix().charpoly())\n      File \"sage/matrix/matrix_rational_dense.pyx\", line 945, in sage.matrix.matrix_rational_dense.Matrix_rational_dense.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_rational_dense.c:11214)\n        f = A.charpoly(var, algorithm='linbox')\n      File \"sage/matrix/matrix_integer_dense.pyx\", line 1251, in sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:13209)\n        g = self._charpoly_linbox(var)\n      File \"sage/matrix/matrix_integer_dense.pyx\", line 1304, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._charpoly_linbox (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:14045)\n        return self._poly_linbox(var=var, typ='charpoly')\n      File \"sage/matrix/matrix_integer_dense.pyx\", line 1327, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._poly_linbox (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:14435)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1699)\n    SignalError: Segmentation fault\n**********************************************************************\n1 item had failures:\n```",
    "created_at": "2017-04-22T05:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138739",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
I just finished a build of 8.0.beta2 with clang+linux, hacking my way through the pyzmq problem, and there is a truckload of doctest failures. However it is exclusively, as far as I can see through the mess, all done to a failure in `sage.matrix.matrix_integer_dense.so`. A nice isolated example is

```
sage -t --long src/sage/rings/qqbar.py
**********************************************************************
File "src/sage/rings/qqbar.py", line 237, in sage.rings.qqbar
Failed example:
    r.imag().minpoly()  # long time (10s on sage.math, 2013)
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 503, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 866, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.qqbar[72]>", line 1, in <module>
        r.imag().minpoly()  # long time (10s on sage.math, 2013)
      File "/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 3403, in minpoly
        self._minimal_polynomial = self._descr.minpoly()
      File "/home/fbissey/sandbox/git-fork/sage-clang/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 6426, in minpoly
        self._minpoly = self._value.minpoly()
      File "sage/rings/number_field/number_field_element.pyx", line 4291, in sage.rings.number_field.number_field_element.NumberFieldElement_absolute.minpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/rings/number_field/number_field_element.cpp:40412)
        return self.charpoly(var, algorithm).radical() # square free part of charpoly
      File "sage/rings/number_field/number_field_element.pyx", line 4258, in sage.rings.number_field.number_field_element.NumberFieldElement_absolute.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/rings/number_field/number_field_element.cpp:40187)
        return R(self.matrix().charpoly())
      File "sage/matrix/matrix_rational_dense.pyx", line 945, in sage.matrix.matrix_rational_dense.Matrix_rational_dense.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_rational_dense.c:11214)
        f = A.charpoly(var, algorithm='linbox')
      File "sage/matrix/matrix_integer_dense.pyx", line 1251, in sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:13209)
        g = self._charpoly_linbox(var)
      File "sage/matrix/matrix_integer_dense.pyx", line 1304, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._charpoly_linbox (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:14045)
        return self._poly_linbox(var=var, typ='charpoly')
      File "sage/matrix/matrix_integer_dense.pyx", line 1327, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._poly_linbox (/home/fbissey/sandbox/git-fork/sage-clang/src/build/cythonized/sage/matrix/matrix_integer_dense.c:14435)
        sig_on()
      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1699)
    SignalError: Segmentation fault
**********************************************************************
1 item had failures:
```



---

archive/issue_comments_138740.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,7 +31,7 @@\n * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n * `zeromq` #22837?\n * `ccache` #22836\n-* `cysignals`, strangely passes with python 3.4 but not 2.7\n+* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56\n \n ---\n \n``````\n",
    "created_at": "2017-04-22T10:14:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138740",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,7 +31,7 @@
 * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
 * `zeromq` #22837?
 * `ccache` #22836
-* `cysignals`, strangely passes with python 3.4 but not 2.7
+* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56
 
 ---
 
``````




---

archive/issue_comments_138741.json:
```json
{
    "body": "<a id='comment:221'></a>\nReplying to [jhpalmieri](#comment%3A217):\n> That's my complete list of failed test suites. Summarizing: `clang`-only failures for:\n> - `cysignals`\n\n\nI just had some \"fun\" debugging this. Turns out it is a 9-year old(!) LLVM bug: https://bugs.llvm.org/show_bug.cgi?id=965\n\nThere is a work-around in #22691.",
    "created_at": "2017-04-23T13:18:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138741",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:221'></a>
Replying to [jhpalmieri](#comment%3A217):
> That's my complete list of failed test suites. Summarizing: `clang`-only failures for:
> - `cysignals`


I just had some "fun" debugging this. Turns out it is a 9-year old(!) LLVM bug: https://bugs.llvm.org/show_bug.cgi?id=965

There is a work-around in #22691.



---

archive/issue_comments_138742.json:
```json
{
    "body": "<a id='comment:222'></a>\nReplying to [jdemeyer](#comment%3A221):\n> Replying to [jhpalmieri](#comment%3A217):\n> > That's my complete list of failed test suites. Summarizing: `clang`-only failures for:\n> > - `cysignals`\n \n> \n> I just had some \"fun\" debugging this. Turns out it is a 9-year old(!) LLVM bug: https://bugs.llvm.org/show_bug.cgi?id=965\n> \n> There is a work-around in #22691.\n\n\nGreat! That works for me on OS X.",
    "created_at": "2017-04-23T15:43:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138742",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:222'></a>
Replying to [jdemeyer](#comment%3A221):
> Replying to [jhpalmieri](#comment%3A217):
> > That's my complete list of failed test suites. Summarizing: `clang`-only failures for:
> > - `cysignals`
 
> 
> I just had some "fun" debugging this. Turns out it is a 9-year old(!) LLVM bug: https://bugs.llvm.org/show_bug.cgi?id=965
> 
> There is a work-around in #22691.


Great! That works for me on OS X.



---

archive/issue_comments_138743.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec06d9797894c2c5dd520a6896937f23f618066b\">ec06d97</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94\">caa9ac9</a></td><td><code>bumping configure tarball</code></td></tr></table>\n",
    "created_at": "2017-04-23T21:46:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138743",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec06d9797894c2c5dd520a6896937f23f618066b">ec06d97</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94">caa9ac9</a></td><td><code>bumping configure tarball</code></td></tr></table>




---

archive/issue_comments_138744.json:
```json
{
    "body": "**Changing commit** from \"[eab0de59d8093c77f2e13cd2d96b4ea09f571429](https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429)\" to \"[caa9ac9bf760aba1451e25f8751569fe042f3d94](https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94)\".",
    "created_at": "2017-04-23T21:46:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138744",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[eab0de59d8093c77f2e13cd2d96b4ea09f571429](https://github.com/sagemath/sagetrac-mirror/commit/eab0de59d8093c77f2e13cd2d96b4ea09f571429)" to "[caa9ac9bf760aba1451e25f8751569fe042f3d94](https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94)".



---

archive/issue_events_101957.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-04-23T21:48:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101957"
}
```



---

archive/issue_events_101958.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-04-23T21:48:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101958"
}
```



---

archive/issue_comments_138745.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -47,7 +47,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-04-23T21:48:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138745",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -47,7 +47,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-217.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138746.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,7 +31,7 @@\n * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n * `zeromq` #22837?\n * `ccache` #22836\n-* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56\n+* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56 #22691\n \n ---\n \n``````\n",
    "created_at": "2017-04-23T21:53:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138746",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,7 +31,7 @@
 * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
 * `zeromq` #22837?
 * `ccache` #22836
-* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56
+* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56 #22691
 
 ---
 
``````




---

archive/issue_comments_138747.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -58,4 +58,4 @@\n CC=clang CXX=clang++ make\n ```\n on OS where clang is not the default compiler [it should also work on OS X].\n-\n+For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using).\n``````\n",
    "created_at": "2017-04-24T00:39:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138747",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -58,4 +58,4 @@
 CC=clang CXX=clang++ make
 ```
 on OS where clang is not the default compiler [it should also work on OS X].
-
+For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using).
``````




---

archive/issue_comments_138748.json:
```json
{
    "body": "<a id='comment:227'></a>\nReplying to [dimpase](#comment%3A182):\n> The biggest difference is that on freebsd I also get problems with `sympow`, it does not fully work on some curves...\n\n\nThis may be the same as what I get on OpenSuSE, invalid pointers in sympow leading to runtime errors and failing to compute the analytic rank. I opened #22862.",
    "created_at": "2017-04-24T06:58:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138748",
    "user": "https://github.com/rwst"
}
```

<a id='comment:227'></a>
Replying to [dimpase](#comment%3A182):
> The biggest difference is that on freebsd I also get problems with `sympow`, it does not fully work on some curves...


This may be the same as what I get on OpenSuSE, invalid pointers in sympow leading to runtime errors and failing to compute the analytic rank. I opened #22862.



---

archive/issue_comments_138749.json:
```json
{
    "body": "<a id='comment:8'></a>\nFollowing up on a comment from #22756: right now we build `python2`, `python3` (as of #22756), `curl`, `psutil`, and `R` using clang rather than gcc, because of troubles with gcc.\n\nWith this branch, if a user on OS X happens to have installed gcc (for example, version 5.4.0 in `/usr/local/bin`), then those packages will break if you use that version of `gcc` to compile them. So if here or on a followup ticket, we are hoping to simplify the logic in some of the `spkg-install` scripts, we have to be careful. We either need to keep the parts of the script that say\n\n```\nif [ \"$UNAME\" = \"Darwin\" ] && [ $MACOSX_VERSION -ge 16 ]; then\n    echo \"OS X 10.$[$MACOSX_VERSION-4] Building with clang.\"\n    CC=clang\nfi\n```\nor we need to force the user to compile everything with clang even if they have a good version of gcc installed.",
    "created_at": "2017-04-25T03:02:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138749",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Following up on a comment from #22756: right now we build `python2`, `python3` (as of #22756), `curl`, `psutil`, and `R` using clang rather than gcc, because of troubles with gcc.

With this branch, if a user on OS X happens to have installed gcc (for example, version 5.4.0 in `/usr/local/bin`), then those packages will break if you use that version of `gcc` to compile them. So if here or on a followup ticket, we are hoping to simplify the logic in some of the `spkg-install` scripts, we have to be careful. We either need to keep the parts of the script that say

```
if [ "$UNAME" = "Darwin" ] && [ $MACOSX_VERSION -ge 16 ]; then
    echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang."
    CC=clang
fi
```
or we need to force the user to compile everything with clang even if they have a good version of gcc installed.



---

archive/issue_comments_138750.json:
```json
{
    "body": "<a id='comment:9'></a>\nWell, I think I will want to force clang. At the moment we keep adding package exceptions to use clang - and I mean clang but not clang++. This is important, the libc is provided by the system for both gcc and clang, so apart from a few isolated exceptions you can mix c compilers.\n\nNow if we happen to want to make a clang++ exception for a package, and it is not stand alone - ie. it provides a library that will be consumed by sage or other packages, then we will have no choice but convert all the dependency chain to clang++. This is because clang++ and g++ each have their own runtimes and you cannot mix them up (#22798). Technically they should be ABI compatible (provided the proper incantation), the reality is that it is madness.",
    "created_at": "2017-04-27T22:41:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138750",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Well, I think I will want to force clang. At the moment we keep adding package exceptions to use clang - and I mean clang but not clang++. This is important, the libc is provided by the system for both gcc and clang, so apart from a few isolated exceptions you can mix c compilers.

Now if we happen to want to make a clang++ exception for a package, and it is not stand alone - ie. it provides a library that will be consumed by sage or other packages, then we will have no choice but convert all the dependency chain to clang++. This is because clang++ and g++ each have their own runtimes and you cannot mix them up (#22798). Technically they should be ABI compatible (provided the proper incantation), the reality is that it is madness.



---

archive/issue_comments_138751.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dec9342f5413303d72c68b424fc77a7b2a69acf\">2dec934</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32\">678988c</a></td><td><code>bump configure tarball</code></td></tr></table>\n",
    "created_at": "2017-04-29T02:18:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138751",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dec9342f5413303d72c68b424fc77a7b2a69acf">2dec934</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32">678988c</a></td><td><code>bump configure tarball</code></td></tr></table>




---

archive/issue_comments_138752.json:
```json
{
    "body": "**Changing commit** from \"[caa9ac9bf760aba1451e25f8751569fe042f3d94](https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94)\" to \"[678988c254e96125cd6945cf58a91be2519f3f32](https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32)\".",
    "created_at": "2017-04-29T02:18:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138752",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[caa9ac9bf760aba1451e25f8751569fe042f3d94](https://github.com/sagemath/sagetrac-mirror/commit/caa9ac9bf760aba1451e25f8751569fe042f3d94)" to "[678988c254e96125cd6945cf58a91be2519f3f32](https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32)".



---

archive/issue_comments_138753.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -47,7 +47,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-04-29T02:22:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138753",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -47,7 +47,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-218.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138754.json:
```json
{
    "body": "<a id='comment:2'></a>\nisn't it important to explicitly use `CC=clang` even on OSX? Note that `gcc` and `g++` in Xcode are meant to try to be gcc-compatible:\n\n```\n$ g++ -v\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.5.0\nThread model: posix\nInstalledDir: /Volumes/Sage/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\nnote `--with-gxx-include-dir`, absent in `cc` configuration.",
    "created_at": "2017-04-30T10:52:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138754",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
isn't it important to explicitly use `CC=clang` even on OSX? Note that `gcc` and `g++` in Xcode are meant to try to be gcc-compatible:

```
$ g++ -v
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.5.0
Thread model: posix
InstalledDir: /Volumes/Sage/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```
note `--with-gxx-include-dir`, absent in `cc` configuration.



---

archive/issue_comments_138755.json:
```json
{
    "body": "<a id='comment:3'></a>\nI don't think so. Yes the gcc/g++ compiler drivers gives a bit more info than cc or clang\n\n```\nMirage:~ fbissey$ gcc -v\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\nMirage:~ fbissey$ cc -v\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\nMirage:~ fbissey$ clang -v\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\nbut I don't think it is that important. Whether you set `CC=lang` or not, autotools still thinks `clang` is `gcc`. We have to use an extra non default macro to figure out it is not `gcc`. I don't think there is a difference in output whether I set it or not.",
    "created_at": "2017-04-30T11:00:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138755",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
I don't think so. Yes the gcc/g++ compiler drivers gives a bit more info than cc or clang

```
Mirage:~ fbissey$ gcc -v
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.5.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
Mirage:~ fbissey$ cc -v
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.5.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
Mirage:~ fbissey$ clang -v
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.5.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```
but I don't think it is that important. Whether you set `CC=lang` or not, autotools still thinks `clang` is `gcc`. We have to use an extra non default macro to figure out it is not `gcc`. I don't think there is a difference in output whether I set it or not.



---

archive/issue_comments_138756.json:
```json
{
    "body": "<a id='comment:4'></a>\nI did set CC and CXX, and on OSX get\n\n```\n[gcc-5.4.0] checking for x86_64-apple-darwin16.5.0-gcc... /Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc -B/Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/ -B/Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/bin/ -B/Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/lib/ -isystem /Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/include -isystem /Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/sys-include   \n[gcc-5.4.0] checking for suffix of object files... configure: error: in `/Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/x86_64-apple-darwin16.5.0/libgcc':\n[gcc-5.4.0] configure: error: cannot compute suffix of object files: cannot compile\n[gcc-5.4.0] See `config.log' for more details.\n[gcc-5.4.0] make[4]: *** [configure-target-libgcc] Error 1\n```",
    "created_at": "2017-04-30T13:30:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138756",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
I did set CC and CXX, and on OSX get

```
[gcc-5.4.0] checking for x86_64-apple-darwin16.5.0-gcc... /Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc -B/Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/ -B/Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/bin/ -B/Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/lib/ -isystem /Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/include -isystem /Volumes/Sage/sage/local/x86_64-apple-darwin16.5.0/sys-include   
[gcc-5.4.0] checking for suffix of object files... configure: error: in `/Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/x86_64-apple-darwin16.5.0/libgcc':
[gcc-5.4.0] configure: error: cannot compute suffix of object files: cannot compile
[gcc-5.4.0] See `config.log' for more details.
[gcc-5.4.0] make[4]: *** [configure-target-libgcc] Error 1
```



---

archive/issue_comments_138757.json:
```json
{
    "body": "OSX gcc spkg failure",
    "created_at": "2017-04-30T13:34:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138757",
    "user": "https://github.com/dimpase"
}
```

OSX gcc spkg failure



---

archive/attachments_016691.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "gcc-5.4.0.log.gz",
    "asset_url": "tarball://root/attachments/ticket12426/gcc-5.4.0.log.gz",
    "created_at": "2017-04-30T21:26:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12426/gcc-5.4.0.log.gz",
    "user": "https://github.com/kiwifb"
}
```



---

archive/issue_comments_138758.json:
```json
{
    "body": "<a id='comment:5'></a>\nAttachment [gcc-5.4.0.log.gz](https://github.com/sagemath/sage/files/ticket12426/gcc-5.4.0.log.gz) by @kiwifb created at 2017-04-30 21:26:53\n\nInteresting. I don't need the log, I have seen that error so many times in many different context. Basically the `gcc` you built in the previous stage is not \"working\", usually because it cannot find gmp/mpfr/mpc or find the right one because of `{DY,}LD_LIBRARY_PATH` settings or sometimes lack thereof. It should be manifest in the output of \n\n```\notool -L /Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc\n```",
    "created_at": "2017-04-30T21:26:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138758",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
Attachment [gcc-5.4.0.log.gz](https://github.com/sagemath/sage/files/ticket12426/gcc-5.4.0.log.gz) by @kiwifb created at 2017-04-30 21:26:53

Interesting. I don't need the log, I have seen that error so many times in many different context. Basically the `gcc` you built in the previous stage is not "working", usually because it cannot find gmp/mpfr/mpc or find the right one because of `{DY,}LD_LIBRARY_PATH` settings or sometimes lack thereof. It should be manifest in the output of 

```
otool -L /Volumes/Sage/sage/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc
```



---

archive/issue_comments_138759.json:
```json
{
    "body": "<a id='comment:6'></a>\nVery interesting... Setting `CC=clang CXX=clang++` works no problems. Setting `CC=cc CXX=c++` leads to the above error and problem in finding libz is the culprit this time.\n\n```\n/Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/cc1:\n\t/usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)\n\t/Users/fbissey/build/sage-build/local/lib/libmpc.3.dylib (compatibility version 4.0.0, current version 4.0.0)\n\t/Users/fbissey/build/sage-build/local/lib/libmpfr.4.dylib (compatibility version 6.0.0, current version 6.5.0)\n\t/Users/fbissey/build/sage-build/local/lib/libgmp.16.dylib (compatibility version 23.0.0, current version 23.2.0)\n\tlibz.so.1.2.8 (compatibility version 0.0.0, current version 0.0.0)\n\t/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 307.5.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.51.1)\n```\nand from the right `config.log`\n\n```\nconfigure:3464: /Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc -B/Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/ -B/Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/bin/ -B/Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/lib/ -isystem /Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/include -isystem /Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/sys-include    -o conftest -g -O2   conftest.c  >&5\ndyld: Library not loaded: libz.so.1.2.8\n  Referenced from: /Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/cc1\n  Reason: image not found\nxgcc: internal compiler error: Abort trap: 6 (program cc1)\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <http://gcc.gnu.org/bugs.html> for instructions.\n```\nOf course the very curious bit here is that `libz.so` has been built instead of `libz.dylib` and it doesn't have the proper `install_name` set which leads to the problem. So the real problem is that `zlib` is built funny when the compiler is set to `cc`. I expect it doesn't use autotools....",
    "created_at": "2017-04-30T22:24:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138759",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Very interesting... Setting `CC=clang CXX=clang++` works no problems. Setting `CC=cc CXX=c++` leads to the above error and problem in finding libz is the culprit this time.

```
/Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/cc1:
	/usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)
	/Users/fbissey/build/sage-build/local/lib/libmpc.3.dylib (compatibility version 4.0.0, current version 4.0.0)
	/Users/fbissey/build/sage-build/local/lib/libmpfr.4.dylib (compatibility version 6.0.0, current version 6.5.0)
	/Users/fbissey/build/sage-build/local/lib/libgmp.16.dylib (compatibility version 23.0.0, current version 23.2.0)
	libz.so.1.2.8 (compatibility version 0.0.0, current version 0.0.0)
	/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 307.5.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.51.1)
```
and from the right `config.log`

```
configure:3464: /Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/xgcc -B/Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/ -B/Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/bin/ -B/Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/lib/ -isystem /Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/include -isystem /Users/fbissey/build/sage-build/local/x86_64-apple-darwin16.5.0/sys-include    -o conftest -g -O2   conftest.c  >&5
dyld: Library not loaded: libz.so.1.2.8
  Referenced from: /Users/fbissey/build/sage-build/local/var/tmp/sage/build/gcc-5.4.0/gcc-build/./gcc/cc1
  Reason: image not found
xgcc: internal compiler error: Abort trap: 6 (program cc1)
Please submit a full bug report,
with preprocessed source if appropriate.
See <http://gcc.gnu.org/bugs.html> for instructions.
```
Of course the very curious bit here is that `libz.so` has been built instead of `libz.dylib` and it doesn't have the proper `install_name` set which leads to the problem. So the real problem is that `zlib` is built funny when the compiler is set to `cc`. I expect it doesn't use autotools....



---

archive/issue_comments_138760.json:
```json
{
    "body": "<a id='comment:7'></a>\n`zlib` has a hacked configure script and we get the following results\n\n```\nMirage:zlib-1.2.8 fbissey$ CC=cc ./configure\nChecking for shared library support...\nBuilding shared library libz.so.1.2.8 with cc.\nChecking for off64_t... No.\nChecking for fseeko... Yes.\nChecking for strerror... Yes.\nChecking for unistd.h... Yes.\nChecking for stdarg.h... Yes.\nChecking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().\nChecking for vsnprintf() in stdio.h... Yes.\nChecking for return value of vsnprintf()... Yes.\nMirage:zlib-1.2.8 fbissey$ CC=clang ./configure\nChecking for shared library support...\nBuilding shared library libz.1.2.8.dylib with clang.\nChecking for off64_t... No.\nChecking for fseeko... Yes.\nChecking for strerror... Yes.\nChecking for unistd.h... Yes.\nChecking for stdarg.h... Yes.\nChecking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().\nChecking for vsnprintf() in stdio.h... Yes.\nChecking for return value of vsnprintf()... Yes.\nChecking for attribute(visibility) support... Yes.\n```\nSo there is detection gap between compiler name and platform somewhere.",
    "created_at": "2017-04-30T22:30:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138760",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
`zlib` has a hacked configure script and we get the following results

```
Mirage:zlib-1.2.8 fbissey$ CC=cc ./configure
Checking for shared library support...
Building shared library libz.so.1.2.8 with cc.
Checking for off64_t... No.
Checking for fseeko... Yes.
Checking for strerror... Yes.
Checking for unistd.h... Yes.
Checking for stdarg.h... Yes.
Checking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().
Checking for vsnprintf() in stdio.h... Yes.
Checking for return value of vsnprintf()... Yes.
Mirage:zlib-1.2.8 fbissey$ CC=clang ./configure
Checking for shared library support...
Building shared library libz.1.2.8.dylib with clang.
Checking for off64_t... No.
Checking for fseeko... Yes.
Checking for strerror... Yes.
Checking for unistd.h... Yes.
Checking for stdarg.h... Yes.
Checking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().
Checking for vsnprintf() in stdio.h... Yes.
Checking for return value of vsnprintf()... Yes.
Checking for attribute(visibility) support... Yes.
```
So there is detection gap between compiler name and platform somewhere.



---

archive/issue_comments_138761.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes the configure script for zlib is broken in that particular case\n\n```\ncase \"$cc\" in\n  *gcc*) gcc=1 ;;\n  *clang*) gcc=1 ;;\nesac\ncase `$cc -v 2>&1` in\n  *gcc*) gcc=1 ;;\nesac\n```\nEarlier we have `gcc=0`, so in theory when `CC` is either gcc or clang the variable `gcc` is set to 1, and you are sent on a branch where darwin is identified and the right linking flags are set. However if you set `CC=cc` the first case statement doesn't do anything, and then the second doesn't either since\n\n```\nMirage:zlib-1.2.8 fbissey$ cc -v\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\ndoesn't mention gcc anywhere.",
    "created_at": "2017-04-30T22:42:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138761",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Yes the configure script for zlib is broken in that particular case

```
case "$cc" in
  *gcc*) gcc=1 ;;
  *clang*) gcc=1 ;;
esac
case `$cc -v 2>&1` in
  *gcc*) gcc=1 ;;
esac
```
Earlier we have `gcc=0`, so in theory when `CC` is either gcc or clang the variable `gcc` is set to 1, and you are sent on a branch where darwin is identified and the right linking flags are set. However if you set `CC=cc` the first case statement doesn't do anything, and then the second doesn't either since

```
Mirage:zlib-1.2.8 fbissey$ cc -v
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.5.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```
doesn't mention gcc anywhere.



---

archive/issue_comments_138762.json:
```json
{
    "body": "<a id='comment:9'></a>\nUpstream fixed the configuration problem (same way I did for experimental purpose), upgrading to 1.2.11 is recommended in another ticket if you think it is essential.",
    "created_at": "2017-04-30T23:25:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138762",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Upstream fixed the configuration problem (same way I did for experimental purpose), upgrading to 1.2.11 is recommended in another ticket if you think it is essential.



---

archive/issue_comments_138763.json:
```json
{
    "body": "<a id='comment:240'></a>\nReplying to [fbissey](#comment%3A239):\n> Upstream fixed the configuration problem (same way I did for experimental purpose), upgrading to 1.2.11 is recommended in another ticket if you think it is essential.\n\n\nthe update is on #22917 - let's get it done to avoid possible confusion.",
    "created_at": "2017-05-01T11:26:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138763",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:240'></a>
Replying to [fbissey](#comment%3A239):
> Upstream fixed the configuration problem (same way I did for experimental purpose), upgrading to 1.2.11 is recommended in another ticket if you think it is essential.


the update is on #22917 - let's get it done to avoid possible confusion.



---

archive/issue_comments_138764.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1\">12cf61e</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>\n",
    "created_at": "2017-05-04T23:24:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138764",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1">12cf61e</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>




---

archive/issue_comments_138765.json:
```json
{
    "body": "**Changing commit** from \"[678988c254e96125cd6945cf58a91be2519f3f32](https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32)\" to \"[12cf61eb6a6a42478cac33bee4cc03030213b0a1](https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1)\".",
    "created_at": "2017-05-04T23:24:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[678988c254e96125cd6945cf58a91be2519f3f32](https://github.com/sagemath/sagetrac-mirror/commit/678988c254e96125cd6945cf58a91be2519f3f32)" to "[12cf61eb6a6a42478cac33bee4cc03030213b0a1](https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1)".



---

archive/issue_comments_138766.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -47,7 +47,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-05-04T23:27:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138766",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -47,7 +47,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-219.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138767.json:
```json
{
    "body": "**Changing commit** from \"[12cf61eb6a6a42478cac33bee4cc03030213b0a1](https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1)\" to \"[38f93525fd35e29c143c7f1fe244d2cb293a1208](https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208)\".",
    "created_at": "2017-05-19T01:17:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[12cf61eb6a6a42478cac33bee4cc03030213b0a1](https://github.com/sagemath/sagetrac-mirror/commit/12cf61eb6a6a42478cac33bee4cc03030213b0a1)" to "[38f93525fd35e29c143c7f1fe244d2cb293a1208](https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208)".



---

archive/issue_comments_138768.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cec66dfb4dc69fba750ac66f15acd418f4f36fdf\">cec66df</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66973af992d75dbf6e1d1aa461cb739044a8e568\">66973af</a></td><td><code>Paul's workaround from #22799</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3d23f90a4803114ed244250d63adbee6f9b1142\">b3d23f9</a></td><td><code>Merge branch 'develop' into clangtrouble</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/811ba22bb8dc34b6c27e3ffa39adfd4a6bffc88d\">811ba22</a></td><td><code>Make the work around only compile with clang</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67fa2fa833b1c6b7fc7b6da1577358b2e1b6c128\">67fa2fa</a></td><td><code>bump version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c881b5d1fc6e707cfb6350e8fe955c8273e3ee91\">c881b5d</a></td><td><code>Merge branch 'clangtrouble' into clang-start</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208\">38f9352</a></td><td><code>increment configure tarball</code></td></tr></table>\n",
    "created_at": "2017-05-19T01:17:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cec66dfb4dc69fba750ac66f15acd418f4f36fdf">cec66df</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66973af992d75dbf6e1d1aa461cb739044a8e568">66973af</a></td><td><code>Paul's workaround from #22799</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3d23f90a4803114ed244250d63adbee6f9b1142">b3d23f9</a></td><td><code>Merge branch 'develop' into clangtrouble</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/811ba22bb8dc34b6c27e3ffa39adfd4a6bffc88d">811ba22</a></td><td><code>Make the work around only compile with clang</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67fa2fa833b1c6b7fc7b6da1577358b2e1b6c128">67fa2fa</a></td><td><code>bump version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c881b5d1fc6e707cfb6350e8fe955c8273e3ee91">c881b5d</a></td><td><code>Merge branch 'clangtrouble' into clang-start</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208">38f9352</a></td><td><code>increment configure tarball</code></td></tr></table>




---

archive/issue_comments_138769.json:
```json
{
    "body": "**Dependencies:** #22799",
    "created_at": "2017-05-19T01:19:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138769",
    "user": "https://github.com/kiwifb"
}
```

**Dependencies:** #22799



---

archive/issue_comments_138770.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -47,7 +47,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-05-19T01:20:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138770",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -47,7 +47,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-220.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138771.json:
```json
{
    "body": "<a id='comment:6'></a>\nA little word about future plans to finish this now that #22799 seems to have a solution.\n\n* It is now possible to build, and doctest sage itself on OS X with clang building only gfortran with this ticket.\n* Similarly on FreeBSD.\n* To build with clang on linux we need to patch python (both 2.7 and 3.x) for http://bugs.python.org/issue25229 for which I should make a ticket.\n* Further on linux which usually default to gcc we want something like #22646, otherwise you have to run sage like `CC=clang CXX=clang++ ./sage` if you want to avoid problems like the one described at #22678.\n* Some packages do not pass their test suite with clang. \n\nAfter much thinking, while I think the default on OS X should be to use clang, I don't think we should preclude building with gcc, especially if people bring their own gcc. So far the only problems we have seen are in C code. Not C++ and after reflexion I don't think it is going to change. So building with gcc/g++ with clang exception for key packages should work. But apart from those, I think the support for gcc on OS X should become minimal over time. \n\nYou could even imagine doing some compile with gcc/clang++/gfortran or clang/g++/gfortran so long as we fix python use of the C compiler to compile C++ code. https://bugs.python.org/issue1222585\n\nSo the plan forward: \n* Fix package testsuite as much as possible - sometimes it will be hard. `eclib`'s tests need to learn about tolerance for example.\n* Base future work on #22646\n* Make the building of gfortran only, more generic. That is, not relying on a variable telling you the compiler is clang. For that matter we can try to extend this to the case where the platform already has a gcc/g++ compiler but only lacks a fortran compiler. But in a general manner not exposing to the rest of the system that you are not using gcc by a variable like `IS_CLANG`.",
    "created_at": "2017-05-21T23:00:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138771",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
A little word about future plans to finish this now that #22799 seems to have a solution.

* It is now possible to build, and doctest sage itself on OS X with clang building only gfortran with this ticket.
* Similarly on FreeBSD.
* To build with clang on linux we need to patch python (both 2.7 and 3.x) for http://bugs.python.org/issue25229 for which I should make a ticket.
* Further on linux which usually default to gcc we want something like #22646, otherwise you have to run sage like `CC=clang CXX=clang++ ./sage` if you want to avoid problems like the one described at #22678.
* Some packages do not pass their test suite with clang. 

After much thinking, while I think the default on OS X should be to use clang, I don't think we should preclude building with gcc, especially if people bring their own gcc. So far the only problems we have seen are in C code. Not C++ and after reflexion I don't think it is going to change. So building with gcc/g++ with clang exception for key packages should work. But apart from those, I think the support for gcc on OS X should become minimal over time. 

You could even imagine doing some compile with gcc/clang++/gfortran or clang/g++/gfortran so long as we fix python use of the C compiler to compile C++ code. https://bugs.python.org/issue1222585

So the plan forward: 
* Fix package testsuite as much as possible - sometimes it will be hard. `eclib`'s tests need to learn about tolerance for example.
* Base future work on #22646
* Make the building of gfortran only, more generic. That is, not relying on a variable telling you the compiler is clang. For that matter we can try to extend this to the case where the platform already has a gcc/g++ compiler but only lacks a fortran compiler. But in a general manner not exposing to the rest of the system that you are not using gcc by a variable like `IS_CLANG`.



---

archive/issue_comments_138772.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,7 +21,7 @@\n * Get sage to select the right compiler when built with clang (#22678)\n * numerical noise in doctests when built with clang (#22798)\n * strange warnings from numpy and matplotlib when built with clang (#22799)\n-* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.\n+* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046\n \n ---\n \n``````\n",
    "created_at": "2017-05-22T01:10:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138772",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,7 +21,7 @@
 * Get sage to select the right compiler when built with clang (#22678)
 * numerical noise in doctests when built with clang (#22798)
 * strange warnings from numpy and matplotlib when built with clang (#22799)
-* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD.
+* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046
 
 ---
 
``````




---

archive/issue_comments_138773.json:
```json
{
    "body": "<a id='comment:248'></a>\nReplying to [fbissey](#comment%3A204):\n> I have looked into ntl and gf2x. I am assuming that it is in fact the same, or related, failure in both case. I think we should report it to upstream gf2x.\n\n\nConfirmed that ntl testsuite failure is due to gf2x. Once I solve the failure of gf2x by not running `make tune-toom` (ticket:18882#comment:5) the ntl testsuite complete successfully.",
    "created_at": "2017-05-22T04:42:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138773",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:248'></a>
Replying to [fbissey](#comment%3A204):
> I have looked into ntl and gf2x. I am assuming that it is in fact the same, or related, failure in both case. I think we should report it to upstream gf2x.


Confirmed that ntl testsuite failure is due to gf2x. Once I solve the failure of gf2x by not running `make tune-toom` (ticket:18882#comment:5) the ntl testsuite complete successfully.



---

archive/issue_comments_138774.json:
```json
{
    "body": "<a id='comment:9'></a>\nwould you go with having compilers are parameters to configure, or rather stay with env. variables? (IMHO autotools do not offer good support for choosing compilers...)",
    "created_at": "2017-05-24T22:07:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138774",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
would you go with having compilers are parameters to configure, or rather stay with env. variables? (IMHO autotools do not offer good support for choosing compilers...)



---

archive/issue_comments_138775.json:
```json
{
    "body": "<a id='comment:0'></a>\nWell autotools finds a compiler that works. You can over-ride that by parameters. Note that #22646 makes that choice of compiler stick to runtime unless sage builds its own.\n\nAutotools is system based on testing and finding capabilities of what you have rather than sticking to a brand. Which is what you should wish for. That being said if you don't set `CC`, `AC_PROG_C` will go through a default list (which you can override). On OS X, with the current branch it finds Apple's `gcc` which is really `clang` and everything is fine.\n\nAs far as I am concerned doing `CC=.. ./configure..` is not very different to doing something like `./configure --with-c-compiler=...`.\n\nBut we could be enforcing things more at the `AC_PROG_{C,CXX,FC}` point and even do it by OS. On linux only look for gcc and clang in that order, on OS X and freebsd look for clang and gcc in that order. That's bit harsh but can still be discarded in the event you set `CC` (I think).",
    "created_at": "2017-05-24T22:20:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138775",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Well autotools finds a compiler that works. You can over-ride that by parameters. Note that #22646 makes that choice of compiler stick to runtime unless sage builds its own.

Autotools is system based on testing and finding capabilities of what you have rather than sticking to a brand. Which is what you should wish for. That being said if you don't set `CC`, `AC_PROG_C` will go through a default list (which you can override). On OS X, with the current branch it finds Apple's `gcc` which is really `clang` and everything is fine.

As far as I am concerned doing `CC=.. ./configure..` is not very different to doing something like `./configure --with-c-compiler=...`.

But we could be enforcing things more at the `AC_PROG_{C,CXX,FC}` point and even do it by OS. On linux only look for gcc and clang in that order, on OS X and freebsd look for clang and gcc in that order. That's bit harsh but can still be discarded in the event you set `CC` (I think).



---

archive/issue_comments_138776.json:
```json
{
    "body": "<a id='comment:251'></a>\nReplying to [dimpase](#comment%3A249):\n> would you go with having compilers are parameters to configure, or rather stay with env. variables? (IMHO autotools do not offer good support for choosing compilers...)\n\n\nI'd strongly suggest to stick with using environment variables (note that it is best to pass them to configure as arguments (`./configure CC=...`), simply because that's the standard way to select a compiler with autotools packages. Best not to invent new sage-specific ways.",
    "created_at": "2017-05-24T23:14:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138776",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:251'></a>
Replying to [dimpase](#comment%3A249):
> would you go with having compilers are parameters to configure, or rather stay with env. variables? (IMHO autotools do not offer good support for choosing compilers...)


I'd strongly suggest to stick with using environment variables (note that it is best to pass them to configure as arguments (`./configure CC=...`), simply because that's the standard way to select a compiler with autotools packages. Best not to invent new sage-specific ways.



---

archive/issue_comments_138777.json:
```json
{
    "body": "<a id='comment:2'></a>\nWhatever happens, we need to be careful not to build certain packages on OS X using gcc: in my experience, with Sage's gcc or my own, some packages (like python and R) fail, but they succeed using clang. So whether we use autotools or configure options or something else, we might have to force clang for some packages if we don't force it in general.\n\nI guess we could let the user shoot themselves in the foot by explicitly setting `CC` etc., but the default settings should work whether or not there is a recent version of `gcc` in `/usr/local/bin`, for example.",
    "created_at": "2017-05-25T01:27:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138777",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
Whatever happens, we need to be careful not to build certain packages on OS X using gcc: in my experience, with Sage's gcc or my own, some packages (like python and R) fail, but they succeed using clang. So whether we use autotools or configure options or something else, we might have to force clang for some packages if we don't force it in general.

I guess we could let the user shoot themselves in the foot by explicitly setting `CC` etc., but the default settings should work whether or not there is a recent version of `gcc` in `/usr/local/bin`, for example.



---

archive/issue_comments_138778.json:
```json
{
    "body": "<a id='comment:253'></a>\nReplying to [jhpalmieri](#comment%3A252):\n> Whatever happens, we need to be careful not to build certain packages on OS X using gcc: in my experience, with Sage's gcc or my own, some packages (like python and R) fail, but they succeed using clang. So whether we use autotools or configure options or something else, we might have to force clang for some packages if we don't force it in general.\n> \n\n\nYes, I think we'll still make sure the packages that needs clang on OS X gets it enforced at the `spkg-install` level.\n\n> I guess we could let the user shoot themselves in the foot by explicitly setting `CC` etc., but the default settings should work whether or not there is a recent version of `gcc` in `/usr/local/bin`, for example.\n\n\nYes. By default it should take a well supported configuration for the platform. But users should be free to shoot themselves in the foot - best way to learn things, really.",
    "created_at": "2017-05-25T01:33:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138778",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:253'></a>
Replying to [jhpalmieri](#comment%3A252):
> Whatever happens, we need to be careful not to build certain packages on OS X using gcc: in my experience, with Sage's gcc or my own, some packages (like python and R) fail, but they succeed using clang. So whether we use autotools or configure options or something else, we might have to force clang for some packages if we don't force it in general.
> 


Yes, I think we'll still make sure the packages that needs clang on OS X gets it enforced at the `spkg-install` level.

> I guess we could let the user shoot themselves in the foot by explicitly setting `CC` etc., but the default settings should work whether or not there is a recent version of `gcc` in `/usr/local/bin`, for example.


Yes. By default it should take a well supported configuration for the platform. But users should be free to shoot themselves in the foot - best way to learn things, really.



---

archive/issue_comments_138779.json:
```json
{
    "body": "**Changing commit** from \"[38f93525fd35e29c143c7f1fe244d2cb293a1208](https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208)\" to \"[40d907acaf4ad226dad45464e648989674176b82](https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82)\".",
    "created_at": "2017-05-25T02:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[38f93525fd35e29c143c7f1fe244d2cb293a1208](https://github.com/sagemath/sagetrac-mirror/commit/38f93525fd35e29c143c7f1fe244d2cb293a1208)" to "[40d907acaf4ad226dad45464e648989674176b82](https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82)".



---

archive/issue_comments_138780.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4384af05fad2a4e2f37ca46b09cb381e0f2db9c\">e4384af</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82\">40d907a</a></td><td><code>bump configure tarball</code></td></tr></table>\n",
    "created_at": "2017-05-25T02:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138780",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4384af05fad2a4e2f37ca46b09cb381e0f2db9c">e4384af</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82">40d907a</a></td><td><code>bump configure tarball</code></td></tr></table>




---

archive/issue_comments_138781.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,22 +4,6 @@\n \n Packages failing to build (or causing other packages to fail to build) with Clang:\n \n-* Gfan (0.5) -- #12440\n-* Lcalc -- #12437\n-* LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)\n-* !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46\n-* pynac -- #21623\n-* python3 -- #22756: on OS X, if we use gcc instead of clang, then the `_scproxy` module fails to build. (We already build `python2` with clang on OS X.)\n-* ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)\n-* Symmetrica -- #12439\n-* fix `import_array` in `finance/time_series.pyx` now fixed by #20596\n-* fix abuse of `inline` keyword in `pxd` files #21696\n-* Problems compiling `expression.pyx` probably `pynac` upstream problem #21701\n-* fix conflicting language options (`-std=c99` used by C++ code): #22554\n-* build with clang: fplll symbol not found errors (#22643)\n-* `polybori` segfault when built with clang on OS X (#22677)\n-* Get sage to select the right compiler when built with clang (#22678)\n-* numerical noise in doctests when built with clang (#22798)\n * strange warnings from numpy and matplotlib when built with clang (#22799)\n * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046\n \n@@ -29,15 +13,7 @@\n * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n * `gf2x`/`ntl` #18882\n * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n-* `zeromq` #22837?\n * `ccache` #22836\n-* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56 #22691\n-\n----\n-\n-Spkgs ignoring CC/CXX environment variables:\n-\n-* Sage -- #12443 ?\n \n ---\n \n@@ -47,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz) and build with\n \n ```\n make\n@@ -58,4 +34,4 @@\n CC=clang CXX=clang++ make\n ```\n on OS where clang is not the default compiler [it should also work on OS X].\n-For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using).\n+For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.\n``````\n",
    "created_at": "2017-05-25T02:52:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138781",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,22 +4,6 @@
 
 Packages failing to build (or causing other packages to fail to build) with Clang:
 
-* Gfan (0.5) -- #12440
-* Lcalc -- #12437
-* LinBox -- C++ problem reported upstream at [https://github.com/linbox-team/linbox/issues/39](https://github.com/linbox-team/linbox/issues/39)
-* !Linbox assumes some compilers including clang++ use the gnu libstdc++ on OS other than OS X: #21977 upstream https://github.com/linbox-team/linbox/issues/46
-* pynac -- #21623
-* python3 -- #22756: on OS X, if we use gcc instead of clang, then the `_scproxy` module fails to build. (We already build `python2` with clang on OS X.)
-* ratpoints -- #12473 (uses nested functions and GCC builtins not supported by clang)
-* Symmetrica -- #12439
-* fix `import_array` in `finance/time_series.pyx` now fixed by #20596
-* fix abuse of `inline` keyword in `pxd` files #21696
-* Problems compiling `expression.pyx` probably `pynac` upstream problem #21701
-* fix conflicting language options (`-std=c99` used by C++ code): #22554
-* build with clang: fplll symbol not found errors (#22643)
-* `polybori` segfault when built with clang on OS X (#22677)
-* Get sage to select the right compiler when built with clang (#22678)
-* numerical noise in doctests when built with clang (#22798)
 * strange warnings from numpy and matplotlib when built with clang (#22799)
 * On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046
 
@@ -29,15 +13,7 @@
 * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
 * `gf2x`/`ntl` #18882
 * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
-* `zeromq` #22837?
 * `ccache` #22836
-* `cysignals`, strangely passes with python 3.4 but not 2.7, upstream issue https://github.com/sagemath/cysignals/issues/56 #22691
-
----
-
-Spkgs ignoring CC/CXX environment variables:
-
-* Sage -- #12443 ?
 
 ---
 
@@ -47,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-222.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz) and build with
 
 ```
 make
@@ -58,4 +34,4 @@
 CC=clang CXX=clang++ make
 ```
 on OS where clang is not the default compiler [it should also work on OS X].
-For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using).
+For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.
``````




---

archive/issue_comments_138782.json:
```json
{
    "body": "<a id='comment:6'></a>\nIs there anything I can do to help move this ticket along? What needs to be done now?",
    "created_at": "2017-06-19T20:39:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138782",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
Is there anything I can do to help move this ticket along? What needs to be done now?



---

archive/issue_comments_138783.json:
```json
{
    "body": "<a id='comment:7'></a>\nSorry, I am a bit bogged down in stuff and that has shifted to a lower priority than say, python3.  So getting #23046 reviewed would be interesting because you can then test clang on a linux machine. Another ticket in need of attention is #22646 which will need some rebasing for the configure tarball.\n#22646 is important because it help your compiler to \"stick\" if you use a compiler than is not in the `PATH` or not the expected default compiler. Because it touches some of the same files as this ticket, I would very much want it included first.\n\nThe next step is to rework the logic so we can trigger the build of `gfortran` without the building of `gcc` - as in the attached branch - but without using `IS_CLANG`. I would like it to be more generic if just `gfortran` is missing and that includes the case of `clang` on OS X by default. Bonus point if we can get out of rebuilding `mpir`, `mpfr` and `mpc` after `gcc` when you build just `gfortran`.",
    "created_at": "2017-06-19T21:18:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138783",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Sorry, I am a bit bogged down in stuff and that has shifted to a lower priority than say, python3.  So getting #23046 reviewed would be interesting because you can then test clang on a linux machine. Another ticket in need of attention is #22646 which will need some rebasing for the configure tarball.
#22646 is important because it help your compiler to "stick" if you use a compiler than is not in the `PATH` or not the expected default compiler. Because it touches some of the same files as this ticket, I would very much want it included first.

The next step is to rework the logic so we can trigger the build of `gfortran` without the building of `gcc` - as in the attached branch - but without using `IS_CLANG`. I would like it to be more generic if just `gfortran` is missing and that includes the case of `clang` on OS X by default. Bonus point if we can get out of rebuilding `mpir`, `mpfr` and `mpc` after `gcc` when you build just `gfortran`.



---

archive/issue_comments_138784.json:
```json
{
    "body": "**Changing commit** from \"[40d907acaf4ad226dad45464e648989674176b82](https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82)\" to \"[1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35](https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35)\".",
    "created_at": "2017-06-19T21:56:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[40d907acaf4ad226dad45464e648989674176b82](https://github.com/sagemath/sagetrac-mirror/commit/40d907acaf4ad226dad45464e648989674176b82)" to "[1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35](https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35)".



---

archive/issue_comments_138785.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35\">1b2d84c</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>\n",
    "created_at": "2017-06-19T21:56:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138785",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35">1b2d84c</a></td><td><code>Merge branch 'develop' into clang-start</code></td></tr></table>




---

archive/issue_comments_138786.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-06-19T21:57:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138786",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-223.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138787.json:
```json
{
    "body": "**Changing commit** from \"[1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35](https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35)\" to \"[fb0ff15ef6cdacbac30326d1f40d75b017d78200](https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200)\".",
    "created_at": "2017-06-19T22:05:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138787",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35](https://github.com/sagemath/sagetrac-mirror/commit/1b2d84cbf74bcb242e13bd7ce24d14a5b65eeb35)" to "[fb0ff15ef6cdacbac30326d1f40d75b017d78200](https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200)".



---

archive/issue_comments_138788.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200\">fb0ff15</a></td><td><code>new configure tarball</code></td></tr></table>\n",
    "created_at": "2017-06-19T22:05:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200">fb0ff15</a></td><td><code>new configure tarball</code></td></tr></table>




---

archive/issue_comments_138789.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think the solution to this will have to be a `gfortran` package as part of `all-toolchain` that can only be installed when `gcc` isn't.",
    "created_at": "2017-06-20T03:19:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138789",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
I think the solution to this will have to be a `gfortran` package as part of `all-toolchain` that can only be installed when `gcc` isn't.



---

archive/issue_comments_138790.json:
```json
{
    "body": "<a id='comment:2'></a>\nSay, what is the oldest OS X we support?",
    "created_at": "2017-06-20T22:20:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138790",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Say, what is the oldest OS X we support?



---

archive/issue_comments_138791.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/483106af4a85ea41461791619dab3f1cef9daa11\">483106a</a></td><td><code>First draft of moving compiler settings to sage-env-config</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d6e87c8b2174ae8e1ba20cd6771318950e2d099f\">d6e87c8</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6048dffacd4195fe368635efd75ad06b76ee701a\">6048dff</a></td><td><code>Forgot to commit the new configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7eff641ce014a297c9f422ccf0880ad5b02db05\">f7eff64</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/945e8243c7fccc612354b616904ac1e2ef51c8ae\">945e824</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32a0b00e746fd57a0830efc7176a6b8502c824fa\">32a0b00</a></td><td><code>one AC_SUBST per variable only :(</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11dc29ac731fcf912a739f9ba8ec7fd5c66b46e8\">11dc29a</a></td><td><code>configure/automake doesn't like variables only defined in conditionals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef9f1b37c462bb61c036262a23b3588292d8f392\">ef9f1b3</a></td><td><code>missing \"fi\" in sage-env-config.in</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa\">8d8b174</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found and you don't have to build the rest of gcc</code></td></tr></table>\n",
    "created_at": "2017-06-20T23:36:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138791",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/483106af4a85ea41461791619dab3f1cef9daa11">483106a</a></td><td><code>First draft of moving compiler settings to sage-env-config</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d6e87c8b2174ae8e1ba20cd6771318950e2d099f">d6e87c8</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6048dffacd4195fe368635efd75ad06b76ee701a">6048dff</a></td><td><code>Forgot to commit the new configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7eff641ce014a297c9f422ccf0880ad5b02db05">f7eff64</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/945e8243c7fccc612354b616904ac1e2ef51c8ae">945e824</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32a0b00e746fd57a0830efc7176a6b8502c824fa">32a0b00</a></td><td><code>one AC_SUBST per variable only :(</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11dc29ac731fcf912a739f9ba8ec7fd5c66b46e8">11dc29a</a></td><td><code>configure/automake doesn't like variables only defined in conditionals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef9f1b37c462bb61c036262a23b3588292d8f392">ef9f1b3</a></td><td><code>missing "fi" in sage-env-config.in</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa">8d8b174</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found and you don't have to build the rest of gcc</code></td></tr></table>




---

archive/issue_comments_138792.json:
```json
{
    "body": "**Changing dependencies** from \"#22799\" to \"#22799 #22646\".",
    "created_at": "2017-06-20T23:36:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138792",
    "user": "https://github.com/kiwifb"
}
```

**Changing dependencies** from "#22799" to "#22799 #22646".



---

archive/issue_comments_138793.json:
```json
{
    "body": "**Changing commit** from \"[fb0ff15ef6cdacbac30326d1f40d75b017d78200](https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200)\" to \"[8d8b174bc99d61e43937d7032ba604f2c75738aa](https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa)\".",
    "created_at": "2017-06-20T23:36:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138793",
    "user": "https://github.com/kiwifb"
}
```

**Changing commit** from "[fb0ff15ef6cdacbac30326d1f40d75b017d78200](https://github.com/sagemath/sagetrac-mirror/commit/fb0ff15ef6cdacbac30326d1f40d75b017d78200)" to "[8d8b174bc99d61e43937d7032ba604f2c75738aa](https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa)".



---

archive/issue_comments_138794.json:
```json
{
    "body": "**Changing branch** from \"[u/fbissey/clang-start](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-start)\" to \"[u/fbissey/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-progress)\".",
    "created_at": "2017-06-20T23:36:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138794",
    "user": "https://github.com/kiwifb"
}
```

**Changing branch** from "[u/fbissey/clang-start](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-start)" to "[u/fbissey/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-progress)".



---

archive/issue_comments_138795.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK, revamped branch. This new branch focuses on being able to build gfortran when not found and allow CC/CXX to be clang. It now fully depends on #22646.",
    "created_at": "2017-06-20T23:39:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138795",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
OK, revamped branch. This new branch focuses on being able to build gfortran when not found and allow CC/CXX to be clang. It now fully depends on #22646.



---

archive/issue_comments_138796.json:
```json
{
    "body": "<a id='comment:5'></a>\nAnd the current branch is not yet working on OS X. Figuring out why.....",
    "created_at": "2017-06-20T23:46:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138796",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
And the current branch is not yet working on OS X. Figuring out why.....



---

archive/issue_comments_138797.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5\">40faa0f</a></td><td><code>updating GFC check section for gfortran only potential install</code></td></tr></table>\n",
    "created_at": "2017-06-20T23:59:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5">40faa0f</a></td><td><code>updating GFC check section for gfortran only potential install</code></td></tr></table>




---

archive/issue_comments_138798.json:
```json
{
    "body": "**Changing commit** from \"[8d8b174bc99d61e43937d7032ba604f2c75738aa](https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa)\" to \"[40faa0f4c558522cfcd8e1288d8b1d89484741d5](https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5)\".",
    "created_at": "2017-06-20T23:59:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138798",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8d8b174bc99d61e43937d7032ba604f2c75738aa](https://github.com/sagemath/sagetrac-mirror/commit/8d8b174bc99d61e43937d7032ba604f2c75738aa)" to "[40faa0f4c558522cfcd8e1288d8b1d89484741d5](https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5)".



---

archive/issue_comments_138799.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8\">bd8c1af</a></td><td><code>new configure checksums</code></td></tr></table>\n",
    "created_at": "2017-06-21T00:01:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8">bd8c1af</a></td><td><code>new configure checksums</code></td></tr></table>




---

archive/issue_comments_138800.json:
```json
{
    "body": "**Changing commit** from \"[40faa0f4c558522cfcd8e1288d8b1d89484741d5](https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5)\" to \"[bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8](https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8)\".",
    "created_at": "2017-06-21T00:01:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[40faa0f4c558522cfcd8e1288d8b1d89484741d5](https://github.com/sagemath/sagetrac-mirror/commit/40faa0f4c558522cfcd8e1288d8b1d89484741d5)" to "[bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8](https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8)".



---

archive/issue_comments_138801.json:
```json
{
    "body": "**Changing commit** from \"[bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8](https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8)\" to \"[328718020e400963ee15392740c59735e4165139](https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139)\".",
    "created_at": "2017-06-21T00:07:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138801",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8](https://github.com/sagemath/sagetrac-mirror/commit/bd8c1afda6d9b02a90cf522a0530e1ce3c62adb8)" to "[328718020e400963ee15392740c59735e4165139](https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139)".



---

archive/issue_comments_138802.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139\">3287180</a></td><td><code>Do not install a C compiler or cpp with the gfortran spkg</code></td></tr></table>\n",
    "created_at": "2017-06-21T00:07:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139">3287180</a></td><td><code>Do not install a C compiler or cpp with the gfortran spkg</code></td></tr></table>




---

archive/issue_comments_138803.json:
```json
{
    "body": "**Changing commit** from \"[328718020e400963ee15392740c59735e4165139](https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139)\" to \"[77107d850166c7b872c872512aaf55e69bb53bbf](https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf)\".",
    "created_at": "2017-06-21T02:59:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[328718020e400963ee15392740c59735e4165139](https://github.com/sagemath/sagetrac-mirror/commit/328718020e400963ee15392740c59735e4165139)" to "[77107d850166c7b872c872512aaf55e69bb53bbf](https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf)".



---

archive/issue_comments_138804.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23c32a4c70eaf7e3cd3fdc4b4b544d4ea677ea28\">23c32a4</a></td><td><code>Small clean up and refining</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf\">77107d8</a></td><td><code>update config tarball checksum</code></td></tr></table>\n",
    "created_at": "2017-06-21T02:59:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23c32a4c70eaf7e3cd3fdc4b4b544d4ea677ea28">23c32a4</a></td><td><code>Small clean up and refining</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf">77107d8</a></td><td><code>update config tarball checksum</code></td></tr></table>




---

archive/issue_comments_138805.json:
```json
{
    "body": "<a id='comment:0'></a>\nOK, people interested should give this branch some trashing - both at the code comment level and testing level.",
    "created_at": "2017-06-21T03:01:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138805",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
OK, people interested should give this branch some trashing - both at the code comment level and testing level.



---

archive/issue_comments_138806.json:
```json
{
    "body": "<a id='comment:1'></a>\nWhen the gfortran package is built on OS X, I also end up with these in local/bin: gcc-ar, gcc-nm, gcc-ranlib, x86_64-apple-darwin16.6.0-gcc, etc. Is that a problem?",
    "created_at": "2017-06-21T15:30:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138806",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
When the gfortran package is built on OS X, I also end up with these in local/bin: gcc-ar, gcc-nm, gcc-ranlib, x86_64-apple-darwin16.6.0-gcc, etc. Is that a problem?



---

archive/issue_comments_138807.json:
```json
{
    "body": "<a id='comment:272'></a>\nReplying to [jhpalmieri](#comment%3A271):\n> When the gfortran package is built on OS X, I also end up with these in local/bin: gcc-ar, gcc-nm, gcc-ranlib, x86_64-apple-darwin16.6.0-gcc, etc. Is that a problem?\n\n\nIt shouldn't be. I left the stuff that had a prefix. I only removed the non-bootstraped gcc and cpp binaries that are installed. I believe the rest should be ok to be left alone. I should inspect the gfortran binary package produced upstream. We could be a bit cleaner for all I know.",
    "created_at": "2017-06-21T21:04:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138807",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:272'></a>
Replying to [jhpalmieri](#comment%3A271):
> When the gfortran package is built on OS X, I also end up with these in local/bin: gcc-ar, gcc-nm, gcc-ranlib, x86_64-apple-darwin16.6.0-gcc, etc. Is that a problem?


It shouldn't be. I left the stuff that had a prefix. I only removed the non-bootstraped gcc and cpp binaries that are installed. I believe the rest should be ok to be left alone. I should inspect the gfortran binary package produced upstream. We could be a bit cleaner for all I know.



---

archive/issue_comments_138808.json:
```json
{
    "body": "<a id='comment:3'></a>\nI should say a bit more I guess. You ended up with that stuff too with the old branch. While I only want gfortran the build system cannot build it without compiling gcc first - at least I haven't found a way to eliminate that step. I am not even sure that's currently desirable. So a gcc is produced to build gfortran and it is installed. \n\nIf you know a way to only install gfortran (even if it still builds a gcc), I am all ears. I will have a look in case it is easy to spot.",
    "created_at": "2017-06-21T21:19:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138808",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
I should say a bit more I guess. You ended up with that stuff too with the old branch. While I only want gfortran the build system cannot build it without compiling gcc first - at least I haven't found a way to eliminate that step. I am not even sure that's currently desirable. So a gcc is produced to build gfortran and it is installed. 

If you know a way to only install gfortran (even if it still builds a gcc), I am all ears. I will have a look in case it is easy to spot.



---

archive/issue_comments_138809.json:
```json
{
    "body": "**Changing commit** from \"[77107d850166c7b872c872512aaf55e69bb53bbf](https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf)\" to \"[a6db502d6762eda8cbbfd8e13f6582d8c8ad9501](https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501)\".",
    "created_at": "2017-06-21T22:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138809",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[77107d850166c7b872c872512aaf55e69bb53bbf](https://github.com/sagemath/sagetrac-mirror/commit/77107d850166c7b872c872512aaf55e69bb53bbf)" to "[a6db502d6762eda8cbbfd8e13f6582d8c8ad9501](https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501)".



---

archive/issue_comments_138810.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501\">a6db502</a></td><td><code>make some files in the gfortran pkg symlinks to the files in the gcc pkg so that that versions and dependencies are changed at the same time.</code></td></tr></table>\n",
    "created_at": "2017-06-21T22:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138810",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501">a6db502</a></td><td><code>make some files in the gfortran pkg symlinks to the files in the gcc pkg so that that versions and dependencies are changed at the same time.</code></td></tr></table>




---

archive/issue_comments_138811.json:
```json
{
    "body": "<a id='comment:5'></a>\nCouldn't find a way to install gfortran separately in gcc's makefiles. In the meantime I made some files in the gfortran folder link to the gcc folder. gcc version bumps are now in sync with changes to gfortran. One would still have to check spkg-install but it makes things easier.\n\nIn some ways the work here got a little bit of scope creep. Kind of of a mix of unintended consequences and some thoughts on trying to be generic.:\n\n* As tested by Vincent Delecroix, this ticket allows the version of gfortran to be decoupled from the version of gcc used. It is of course non sense to check the version of the C/C++ compiler matches the fortran one when they may not be from the same vendor. However it could have been kept for gcc specifically. Earlier versions of the branch did.\n* I switched from positively checking for clang to checking \"is this really gcc?\". clang of course pretends to be gcc but so does icc I think. The branch in its current state would allow one to use a compiler that pretends to be gcc to `AC_PROG_CC` but isn't. This really needs #23046 to work on linux, probably not just for clang.\n\nThe ticket keeps the requirement for gfortran but I think that could be relaxed in the future. The real hard requirement is for R. Some R packages don't properly autotool their fortran which means they rely on fortran mangling to be \"function_\". Any fortran compiler that default to that or can easily be made to do that will do.",
    "created_at": "2017-06-21T22:57:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138811",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
Couldn't find a way to install gfortran separately in gcc's makefiles. In the meantime I made some files in the gfortran folder link to the gcc folder. gcc version bumps are now in sync with changes to gfortran. One would still have to check spkg-install but it makes things easier.

In some ways the work here got a little bit of scope creep. Kind of of a mix of unintended consequences and some thoughts on trying to be generic.:

* As tested by Vincent Delecroix, this ticket allows the version of gfortran to be decoupled from the version of gcc used. It is of course non sense to check the version of the C/C++ compiler matches the fortran one when they may not be from the same vendor. However it could have been kept for gcc specifically. Earlier versions of the branch did.
* I switched from positively checking for clang to checking "is this really gcc?". clang of course pretends to be gcc but so does icc I think. The branch in its current state would allow one to use a compiler that pretends to be gcc to `AC_PROG_CC` but isn't. This really needs #23046 to work on linux, probably not just for clang.

The ticket keeps the requirement for gfortran but I think that could be relaxed in the future. The real hard requirement is for R. Some R packages don't properly autotool their fortran which means they rely on fortran mangling to be "function_". Any fortran compiler that default to that or can easily be made to do that will do.



---

archive/issue_events_101959.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-06-21T23:01:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101959"
}
```



---

archive/issue_comments_138812.json:
```json
{
    "body": "<a id='comment:7'></a>\nHere is a report about building on OS X:\n\n- if I have my own gfortran present (but no gcc), it builds and passes tests. It does not build gfortran.\n- if I have neither gfortran nor gcc, it builds and passes tests. It builds gfortran, of course.\n- if I have my own gcc (version 6.3.0), I got an error building libfplll:\n\n```\n\t/bin/sh ../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I..  -DFPLLL_DEFAULT_STRATEGY_PATH=\\\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies\\\" -DFPLLL_DEFAULT_STRATEGY=\\\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies/default.json\\\" -I./.. -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -I/include  -fPIC -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -L/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/lib -O3 -MT pruner.lo -MD -MP -MF $depbase.Tpo -c -o pruner.lo pruner.cpp &&\\\n\tmv -f $depbase.Tpo $depbase.Plo\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I.. -DFPLLL_DEFAULT_STRATEGY_PATH=\\\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies\\\" -DFPLLL_DEFAULT_STRATEGY=\\\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies/default.json\\\" -I./.. -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -I/include -fPIC -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -L/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/lib -O3 -MT pruner.lo -MD -MP -MF .deps/pruner.Tpo -c pruner.cpp  -fno-common -DPIC -o .libs/pruner.o\npruner.cpp: In function 'FT fplll::Pruner<FT>::single_enum_cost(const evec&, std::vector<double>*) [with FT = fplll::FP_NR<long double>]':\npruner.cpp:247:11: internal compiler error: Segmentation fault: 11\n inline FT Pruner<FT>::single_enum_cost(/*i*/ const evec &b, vector<double> *detailed_cost)\n           ^~~~~~~~~~\n\npruner.cpp:247:11: internal compiler error: Abort trap: 6\ng++: internal compiler error: Abort trap: 6 (program cc1plus)\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee <https://github.com/Homebrew/homebrew-core/issues> for instructions.\nmake[6]: *** [pruner.lo] Error 1\nmake[6]: *** Waiting for unfinished jobs....\n```\n Maybe my version of gcc is broken. Any other ideas of what could be wrong?",
    "created_at": "2017-06-21T23:59:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138812",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Here is a report about building on OS X:

- if I have my own gfortran present (but no gcc), it builds and passes tests. It does not build gfortran.
- if I have neither gfortran nor gcc, it builds and passes tests. It builds gfortran, of course.
- if I have my own gcc (version 6.3.0), I got an error building libfplll:

```
	/bin/sh ../libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I..  -DFPLLL_DEFAULT_STRATEGY_PATH=\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies\" -DFPLLL_DEFAULT_STRATEGY=\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies/default.json\" -I./.. -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -I/include  -fPIC -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -L/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/lib -O3 -MT pruner.lo -MD -MP -MF $depbase.Tpo -c -o pruner.lo pruner.cpp &&\
	mv -f $depbase.Tpo $depbase.Plo
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I.. -DFPLLL_DEFAULT_STRATEGY_PATH=\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies\" -DFPLLL_DEFAULT_STRATEGY=\"/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/share/fplll/strategies/default.json\" -I./.. -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -I/include -fPIC -I/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/include/ -L/Users/palmieri/Desktop/Sage_stuff/sage_builds/TESTING/sage-8.0.beta11/local/lib -O3 -MT pruner.lo -MD -MP -MF .deps/pruner.Tpo -c pruner.cpp  -fno-common -DPIC -o .libs/pruner.o
pruner.cpp: In function 'FT fplll::Pruner<FT>::single_enum_cost(const evec&, std::vector<double>*) [with FT = fplll::FP_NR<long double>]':
pruner.cpp:247:11: internal compiler error: Segmentation fault: 11
 inline FT Pruner<FT>::single_enum_cost(/*i*/ const evec &b, vector<double> *detailed_cost)
           ^~~~~~~~~~

pruner.cpp:247:11: internal compiler error: Abort trap: 6
g++: internal compiler error: Abort trap: 6 (program cc1plus)
Please submit a full bug report,
with preprocessed source if appropriate.
See <https://github.com/Homebrew/homebrew-core/issues> for instructions.
make[6]: *** [pruner.lo] Error 1
make[6]: *** Waiting for unfinished jobs....
```
 Maybe my version of gcc is broken. Any other ideas of what could be wrong?



---

archive/issue_comments_138813.json:
```json
{
    "body": "<a id='comment:8'></a>\nLooks suspiciously like some recent changes to fplll. Let me check...",
    "created_at": "2017-06-22T00:01:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138813",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Looks suspiciously like some recent changes to fplll. Let me check...



---

archive/issue_comments_138814.json:
```json
{
    "body": "<a id='comment:9'></a>\nOK not what I was thinking. ICE are bad, the question is whether it is something from homebrew or upstream gcc. Does homebrew happen to have fplll in one of their repos? It would be interesting to know if a homebrew version exhibits the same problem.\n\nAlternatively I/you could also try with gcc/gfortran from http://hpc.sourceforge.net/",
    "created_at": "2017-06-22T00:11:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138814",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
OK not what I was thinking. ICE are bad, the question is whether it is something from homebrew or upstream gcc. Does homebrew happen to have fplll in one of their repos? It would be interesting to know if a homebrew version exhibits the same problem.

Alternatively I/you could also try with gcc/gfortran from http://hpc.sourceforge.net/



---

archive/issue_comments_138815.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70\">777a393</a></td><td><code>updating configure tarball</code></td></tr></table>\n",
    "created_at": "2017-06-22T01:25:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138815",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70">777a393</a></td><td><code>updating configure tarball</code></td></tr></table>




---

archive/issue_comments_138816.json:
```json
{
    "body": "**Changing commit** from \"[a6db502d6762eda8cbbfd8e13f6582d8c8ad9501](https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501)\" to \"[777a393a2344773c293595d00b469b5bb4115b70](https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70)\".",
    "created_at": "2017-06-22T01:25:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138816",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a6db502d6762eda8cbbfd8e13f6582d8c8ad9501](https://github.com/sagemath/sagetrac-mirror/commit/a6db502d6762eda8cbbfd8e13f6582d8c8ad9501)" to "[777a393a2344773c293595d00b469b5bb4115b70](https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70)".



---

archive/issue_comments_138817.json:
```json
{
    "body": "<a id='comment:1'></a>\nI am trying gcc-7.1 from hpc.sourceforge.net. libfplll compiled with it. I am using gcc/g++/gfortran from that tarball. Checking with someone I know I am surprised you are on gcc-6.3.0 with homebrew. They have 7.1.0 now. Are you working on the polymake package (which apparently doesn't like gcc-7.1)?",
    "created_at": "2017-06-22T02:33:22Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138817",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
I am trying gcc-7.1 from hpc.sourceforge.net. libfplll compiled with it. I am using gcc/g++/gfortran from that tarball. Checking with someone I know I am surprised you are on gcc-6.3.0 with homebrew. They have 7.1.0 now. Are you working on the polymake package (which apparently doesn't like gcc-7.1)?



---

archive/issue_comments_138818.json:
```json
{
    "body": "<a id='comment:2'></a>\nI built and installed gcc 5.4.0 and got errors building libfplll and givaro:\n\n```\nld: symbol(s) not found for architecture x86_64\n```\nMaybe I'm building gcc wrong?\n\nI'm not using polymake, by the way. I haven't tried the version from hpc.sourceforge.net because if it breaks things, I don't know how hard it will be to uninstall.",
    "created_at": "2017-06-22T02:37:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138818",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
I built and installed gcc 5.4.0 and got errors building libfplll and givaro:

```
ld: symbol(s) not found for architecture x86_64
```
Maybe I'm building gcc wrong?

I'm not using polymake, by the way. I haven't tried the version from hpc.sourceforge.net because if it breaks things, I don't know how hard it will be to uninstall.



---

archive/issue_comments_138819.json:
```json
{
    "body": "<a id='comment:283'></a>\nReplying to [jhpalmieri](#comment%3A282):\n> I built and installed gcc 5.4.0 and got errors building libfplll and givaro:\n> \n> ```\n> ld: symbol(s) not found for architecture x86_64\n> ```\n> Maybe I'm building gcc wrong?\n> \n\n\nThat's a classic message. Usually something slightly wrong in the setup. A bigger chunk of the failure may jog my memory.\n\n> I'm not using polymake, by the way. I haven't tried the version from hpc.sourceforge.net because if it breaks things, I don't know how hard it will be to uninstall.\n\n\nIt will be a pain to uninstall. Well not too bad so long as you keep the original tarball to have the list of files installed. It also helps that I don't have much in `/usr/local` in the first place. But I hate things like that, that insists they need to be installed in `/usr/local`. Whenever I try homebrew, I specifically do not follow their recommendation about linking in `/usr/local` - an invitation to disaster if you have more than one prefixed environment around that you want to be able to switch to and from.",
    "created_at": "2017-06-22T02:48:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138819",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:283'></a>
Replying to [jhpalmieri](#comment%3A282):
> I built and installed gcc 5.4.0 and got errors building libfplll and givaro:
> 
> ```
> ld: symbol(s) not found for architecture x86_64
> ```
> Maybe I'm building gcc wrong?
> 


That's a classic message. Usually something slightly wrong in the setup. A bigger chunk of the failure may jog my memory.

> I'm not using polymake, by the way. I haven't tried the version from hpc.sourceforge.net because if it breaks things, I don't know how hard it will be to uninstall.


It will be a pain to uninstall. Well not too bad so long as you keep the original tarball to have the list of files installed. It also helps that I don't have much in `/usr/local` in the first place. But I hate things like that, that insists they need to be installed in `/usr/local`. Whenever I try homebrew, I specifically do not follow their recommendation about linking in `/usr/local` - an invitation to disaster if you have more than one prefixed environment around that you want to be able to switch to and from.



---

archive/issue_comments_138820.json:
```json
{
    "body": "<a id='comment:4'></a>\nHere's more of the error message from givaro:\n\n```\nUndefined symbols for architecture x86_64:\n  \"std::ctype<char>::_M_widen_init() const\", referenced from:\n      Givaro::Rationel::Rationel(float, Givaro::Rationel::reduceFlag) in libgmppp.a(gmp++_rat_cstor.o)\n      Givaro::Rationel::Rationel(double, Givaro::Rationel::reduceFlag) in libgmppp.a(gmp++_rat_cstor.o)\n      Givaro::GivMMInfo::print(std::basic_ostream<char, std::char_traits<char> >&) const in libgivmemory.a(givaromm.o)\n      Givaro::Rational::ratrecon(Givaro::Integer const&, Givaro::Integer const&, Givaro::Integer const&, bool) in libgivrational.a(givratreconstruct.o)\n      Givaro::GivaroMain::DisplayVersion(std::basic_ostream<char, std::char_traits<char> >&) in libgivsystem.a(givinit.o)\n      Givaro::Timer::print(std::basic_ostream<char, std::char_traits<char> >&) const in libgivsystem.a(givtimer.o)\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::swap(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&)\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n      Givaro::Indeter::operator=(Givaro::Indeter const&) in libgivpoly1.a(givindeter.o)\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)\", referenced from:\n      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.21] in libgmppp.a(gmp++_rat_io.o)\n      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.51] in libgmppp.a(gmp++_int_misc.o)\n      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char const*>(char const*, char const*, std::forward_iterator_tag) [clone .isra.19] in libgivrational.a(givratcstor.o)\n  \"std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >::_M_sync(char*, unsigned long, unsigned long)\", referenced from:\n      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)\n  \"std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_istringstream()\", referenced from:\n      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)\n  \"std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_ostringstream()\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n  \"std::__detail::_List_node_base::_M_hook(std::__detail::_List_node_base*)\", referenced from:\n      Givaro::logp(Givaro::Integer const&, Givaro::Integer const&) in libgmppp.a(gmp++_int_misc.o)\n  \"std::__detail::_List_node_base::_M_unhook()\", referenced from:\n      Givaro::logp(Givaro::Integer const&, Givaro::Integer const&) in libgmppp.a(gmp++_int_misc.o)\n  \"std::basic_istream<char, std::char_traits<char> >& std::operator>><char, std::char_traits<char>, std::allocator<char> >(std::basic_istream<char, std::char_traits<char> >&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&)\", referenced from:\n      Givaro::operator>>(std::basic_istream<char, std::char_traits<char> >&, Givaro::Indeter&) in libgivpoly1.a(givindeter.o)\n  \"VTT for std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >\", referenced from:\n      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)\n  \"VTT for std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n  \"vtable for std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)\n  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.\n  \"vtable for std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >\", referenced from:\n      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)\n  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.\n  \"vtable for std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >\", referenced from:\n      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)\n      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)\n  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.\nld: symbol(s) not found for architecture x86_64\ncollect2: error: ld returned 1 exit status\n```",
    "created_at": "2017-06-22T03:12:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138820",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Here's more of the error message from givaro:

```
Undefined symbols for architecture x86_64:
  "std::ctype<char>::_M_widen_init() const", referenced from:
      Givaro::Rationel::Rationel(float, Givaro::Rationel::reduceFlag) in libgmppp.a(gmp++_rat_cstor.o)
      Givaro::Rationel::Rationel(double, Givaro::Rationel::reduceFlag) in libgmppp.a(gmp++_rat_cstor.o)
      Givaro::GivMMInfo::print(std::basic_ostream<char, std::char_traits<char> >&) const in libgivmemory.a(givaromm.o)
      Givaro::Rational::ratrecon(Givaro::Integer const&, Givaro::Integer const&, Givaro::Integer const&, bool) in libgivrational.a(givratreconstruct.o)
      Givaro::GivaroMain::DisplayVersion(std::basic_ostream<char, std::char_traits<char> >&) in libgivsystem.a(givinit.o)
      Givaro::Timer::print(std::basic_ostream<char, std::char_traits<char> >&) const in libgivsystem.a(givtimer.o)
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::swap(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&)", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
      Givaro::Indeter::operator=(Givaro::Indeter const&) in libgivpoly1.a(givindeter.o)
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)", referenced from:
      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.21] in libgmppp.a(gmp++_rat_io.o)
      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.51] in libgmppp.a(gmp++_int_misc.o)
      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char const*>(char const*, char const*, std::forward_iterator_tag) [clone .isra.19] in libgivrational.a(givratcstor.o)
  "std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >::_M_sync(char*, unsigned long, unsigned long)", referenced from:
      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)
  "std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_istringstream()", referenced from:
      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)
  "std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_ostringstream()", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
  "std::__detail::_List_node_base::_M_hook(std::__detail::_List_node_base*)", referenced from:
      Givaro::logp(Givaro::Integer const&, Givaro::Integer const&) in libgmppp.a(gmp++_int_misc.o)
  "std::__detail::_List_node_base::_M_unhook()", referenced from:
      Givaro::logp(Givaro::Integer const&, Givaro::Integer const&) in libgmppp.a(gmp++_int_misc.o)
  "std::basic_istream<char, std::char_traits<char> >& std::operator>><char, std::char_traits<char>, std::allocator<char> >(std::basic_istream<char, std::char_traits<char> >&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&)", referenced from:
      Givaro::operator>>(std::basic_istream<char, std::char_traits<char> >&, Givaro::Indeter&) in libgivpoly1.a(givindeter.o)
  "VTT for std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >", referenced from:
      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)
  "VTT for std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
  "vtable for std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)
  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
  "vtable for std::__cxx11::basic_istringstream<char, std::char_traits<char>, std::allocator<char> >", referenced from:
      Givaro::Rational::Rational(char const*) in libgivrational.a(givratcstor.o)
  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
  "vtable for std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >", referenced from:
      Givaro::Rationel::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_rat_io.o)
      Givaro::Integer::operator std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >[abi:cxx11]() const in libgmppp.a(gmp++_int_misc.o)
  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
ld: symbol(s) not found for architecture x86_64
collect2: error: ld returned 1 exit status
```



---

archive/issue_comments_138821.json:
```json
{
    "body": "<a id='comment:5'></a>\nAnd from libpflll:\n\n```\nUndefined symbols for architecture x86_64:\n  \"std::ctype<char>::_M_widen_init() const\", referenced from:\n      fplll::shortest_vector_ex(fplll::ZZ_mat<__mpz_struct [1]>&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >&, fplll::SVPMethod, std::vector<double, std::allocator<double> > const&, int, fplll::EvaluatorMode, long long&, std::vector<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >, std::allocator<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > > >*, std::vector<double, std::allocator<double> >*, std::vector<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >, std::allocator<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > > >*, std::vector<double, std::allocator<double> >*, int) [clone .constprop.282] in fplll.o\n      fplll::closest_vector(fplll::ZZ_mat<__mpz_struct [1]>&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > const&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >&, int, int) in fplll.o\n      fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double) in enumerate.o\n      fplll::EnumerationDyn<fplll::FP_NR<long double> >::process_solution(double) in enumerate.o\n      fplll::EnumerationDyn<fplll::FP_NR<double> >::process_solution(double) in enumerate.o\n      fplll::FastEvaluator<fplll::FP_NR<__mpfr_struct [1]> >::eval_sol(std::vector<fplll::FP_NR<__mpfr_struct [1]>, std::allocator<fplll::FP_NR<__mpfr_struct [1]> > > const&, double const&, double&) in enumerate.o\n      fplll::FastEvaluator<fplll::FP_NR<dpe_struct [1]> >::eval_sol(std::vector<fplll::FP_NR<dpe_struct [1]>, std::allocator<fplll::FP_NR<dpe_struct [1]> > > const&, double const&, double&) in enumerate.o\n      ...\n  \"std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >::str() const\", referenced from:\n      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      ...\n  \"std::domain_error::domain_error(char const*)\", referenced from:\n      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator::operator==(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator const&) const in bkz_param.o\n  \"std::domain_error::domain_error(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.285] in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.286] in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.287] in bkz_param.o\n      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      void std::vector<unsigned long, std::allocator<unsigned long> >::_M_emplace_back_aux<nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&>(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&) in bkz_param.o\n      unsigned long nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::get_impl<unsigned long, 0>(unsigned long*) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o\n      ...\n  \"std::out_of_range::out_of_range(char const*)\", referenced from:\n      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator::operator*() const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o\n  \"std::runtime_error::runtime_error(char const*)\", referenced from:\n      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.727] in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::svp_preprocessing(int, int, fplll::BKZParam const&) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.728] in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.731] in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::svp_preprocessing(int, int, fplll::BKZParam const&) in bkz.o\n      ...\n  \"std::basic_ifstream<char, std::char_traits<char> >::basic_ifstream(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::_Ios_Openmode)\", referenced from:\n      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n  \"std::invalid_argument::invalid_argument(char const*)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o\n      fplll::Pruner<fplll::FP_NR<double> >::measure_metric(std::vector<double, std::allocator<double> > const&) in pruner.o\n      fplll::Pruner<fplll::FP_NR<double> >::measure_metric(std::array<fplll::FP_NR<double>, 1023ul> const&) in pruner.o\n      fplll::Pruner<fplll::FP_NR<double> >::repeated_enum_cost(std::array<fplll::FP_NR<double>, 1023ul> const&) in pruner.o\n      fplll::Pruner<fplll::FP_NR<double> >::greedy(std::array<fplll::FP_NR<double>, 1023ul>&) in pruner.o\n      fplll::FP_NR<double> fplll::svp_probability<fplll::FP_NR<double> >(fplll::Pruning const&) in pruner.o\n      fplll::FP_NR<double> fplll::svp_probability<fplll::FP_NR<double> >(std::vector<double, std::allocator<double> > const&) in pruner.o\n      ...\n  \"std::invalid_argument::invalid_argument(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_replace(unsigned long, unsigned long, char const*, unsigned long)\", referenced from:\n      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(char const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&&) in bkz_param.o\n      void std::vector<unsigned long, std::allocator<unsigned long> >::_M_emplace_back_aux<nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&>(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&) in bkz_param.o\n      unsigned long nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::get_impl<unsigned long, 0>(unsigned long*) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o\n      ...\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_replace_aux(unsigned long, unsigned long, unsigned long, char)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::reserve(unsigned long)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_erase(unsigned long, unsigned long)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long)\", referenced from:\n      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o\n      ...\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)\", referenced from:\n      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.189] in bkz_param.o\n      fplll::default_strategy_path[abi:cxx11]()  in bkz_param.o\n      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      fplll::default_strategy[abi:cxx11]()  in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.285] in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.287] in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o\n      ...\n  \"std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()\", referenced from:\n      fplll::default_strategy_path[abi:cxx11]()  in bkz_param.o\n      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o\n      fplll::default_strategy[abi:cxx11]()  in bkz_param.o\n  \"std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::basic_ostringstream(std::_Ios_Openmode)\", referenced from:\n      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      ...\n  \"std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_ostringstream()\", referenced from:\n      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o\n      ...\n  \"std::__detail::_List_node_base::_M_hook(std::__detail::_List_node_base*)\", referenced from:\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_2reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_2reduce(ListPoint<long>*) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce(ListPoint<long>*) in sieve_gauss.o\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_4reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_4reduce(ListPoint<long>*) in sieve_gauss.o\n  \"std::__detail::_List_node_base::_M_unhook()\", referenced from:\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_2reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce_2reduce(ListPoint<__mpz_struct [1]>*, std::_List_iterator<ListPoint<__mpz_struct [1]>*>&) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce_2reduce(ListPoint<long>*, std::_List_iterator<ListPoint<long>*>&) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_2reduce(ListPoint<long>*) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_4reduce_3reduce(ListPoint<long>*) in sieve_gauss.o\n      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce(ListPoint<long>*) in sieve_gauss.o\n      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o\n      ...\n  \"std::__throw_bad_function_call()\", referenced from:\n      fplll::ExternalEnumeration<fplll::FP_NR<__mpfr_struct [1]> >::enumerate(int, int, fplll::FP_NR<__mpfr_struct [1]>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o\n      fplll::ExternalEnumeration<fplll::FP_NR<double> >::enumerate(int, int, fplll::FP_NR<double>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o\n      fplll::ExternalEnumeration<fplll::FP_NR<long double> >::enumerate(int, int, fplll::FP_NR<long double>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o\n      fplll::ExternalEnumeration<fplll::FP_NR<dpe_struct [1]> >::enumerate(int, int, fplll::FP_NR<dpe_struct [1]>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o\n  \"std::basic_istream<char, std::char_traits<char> >& std::getline<char, std::char_traits<char>, std::allocator<char> >(std::basic_istream<char, std::char_traits<char> >&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, char)\", referenced from:\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o\n      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o\nld: symbol(s) not found for architecture x86_64\ncollect2: error: ld returned 1 exit status\n```",
    "created_at": "2017-06-22T03:20:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138821",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
And from libpflll:

```
Undefined symbols for architecture x86_64:
  "std::ctype<char>::_M_widen_init() const", referenced from:
      fplll::shortest_vector_ex(fplll::ZZ_mat<__mpz_struct [1]>&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >&, fplll::SVPMethod, std::vector<double, std::allocator<double> > const&, int, fplll::EvaluatorMode, long long&, std::vector<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >, std::allocator<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > > >*, std::vector<double, std::allocator<double> >*, std::vector<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >, std::allocator<std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > > >*, std::vector<double, std::allocator<double> >*, int) [clone .constprop.282] in fplll.o
      fplll::closest_vector(fplll::ZZ_mat<__mpz_struct [1]>&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > > const&, std::vector<fplll::Z_NR<__mpz_struct [1]>, std::allocator<fplll::Z_NR<__mpz_struct [1]> > >&, int, int) in fplll.o
      fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double) in enumerate.o
      fplll::EnumerationDyn<fplll::FP_NR<long double> >::process_solution(double) in enumerate.o
      fplll::EnumerationDyn<fplll::FP_NR<double> >::process_solution(double) in enumerate.o
      fplll::FastEvaluator<fplll::FP_NR<__mpfr_struct [1]> >::eval_sol(std::vector<fplll::FP_NR<__mpfr_struct [1]>, std::allocator<fplll::FP_NR<__mpfr_struct [1]> > > const&, double const&, double&) in enumerate.o
      fplll::FastEvaluator<fplll::FP_NR<dpe_struct [1]> >::eval_sol(std::vector<fplll::FP_NR<dpe_struct [1]>, std::allocator<fplll::FP_NR<dpe_struct [1]> > > const&, double const&, double&) in enumerate.o
      ...
  "std::__cxx11::basic_stringbuf<char, std::char_traits<char>, std::allocator<char> >::str() const", referenced from:
      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      ...
  "std::domain_error::domain_error(char const*)", referenced from:
      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator::operator==(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator const&) const in bkz_param.o
  "std::domain_error::domain_error(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.285] in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.286] in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.287] in bkz_param.o
      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      void std::vector<unsigned long, std::allocator<unsigned long> >::_M_emplace_back_aux<nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&>(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&) in bkz_param.o
      unsigned long nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::get_impl<unsigned long, 0>(unsigned long*) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o
      ...
  "std::out_of_range::out_of_range(char const*)", referenced from:
      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::const_iterator::operator*() const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o
  "std::runtime_error::runtime_error(char const*)", referenced from:
      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.727] in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::svp_preprocessing(int, int, fplll::BKZParam const&) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.728] in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::svp_reduction(int, int, fplll::BKZParam const&, bool) [clone .constprop.731] in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::svp_preprocessing(int, int, fplll::BKZParam const&) in bkz.o
      ...
  "std::basic_ifstream<char, std::char_traits<char> >::basic_ifstream(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::_Ios_Openmode)", referenced from:
      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
  "std::invalid_argument::invalid_argument(char const*)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o
      fplll::Pruner<fplll::FP_NR<double> >::measure_metric(std::vector<double, std::allocator<double> > const&) in pruner.o
      fplll::Pruner<fplll::FP_NR<double> >::measure_metric(std::array<fplll::FP_NR<double>, 1023ul> const&) in pruner.o
      fplll::Pruner<fplll::FP_NR<double> >::repeated_enum_cost(std::array<fplll::FP_NR<double>, 1023ul> const&) in pruner.o
      fplll::Pruner<fplll::FP_NR<double> >::greedy(std::array<fplll::FP_NR<double>, 1023ul>&) in pruner.o
      fplll::FP_NR<double> fplll::svp_probability<fplll::FP_NR<double> >(fplll::Pruning const&) in pruner.o
      fplll::FP_NR<double> fplll::svp_probability<fplll::FP_NR<double> >(std::vector<double, std::allocator<double> > const&) in pruner.o
      ...
  "std::invalid_argument::invalid_argument(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_replace(unsigned long, unsigned long, char const*, unsigned long)", referenced from:
      fplll::load_strategies_json(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(char const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&&) in bkz_param.o
      void std::vector<unsigned long, std::allocator<unsigned long> >::_M_emplace_back_aux<nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&>(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const&) in bkz_param.o
      unsigned long nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::get_impl<unsigned long, 0>(unsigned long*) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o
      ...
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_replace_aux(unsigned long, unsigned long, unsigned long, char)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::reserve(unsigned long)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_erase(unsigned long, unsigned long)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long)", referenced from:
      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::get_string() const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::expect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o
      ...
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)", referenced from:
      void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) [clone .isra.189] in bkz_param.o
      fplll::default_strategy_path[abi:cxx11]()  in bkz_param.o
      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      fplll::default_strategy[abi:cxx11]()  in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.285] in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator> const& nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::operator[]<char const>(char const*) const [clone .constprop.287] in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::unexpect(nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::token_type) const in bkz_param.o
      ...
  "std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()", referenced from:
      fplll::default_strategy_path[abi:cxx11]()  in bkz_param.o
      fplll::strategy_full_path(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) in bkz_param.o
      fplll::default_strategy[abi:cxx11]()  in bkz_param.o
  "std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::basic_ostringstream(std::_Ios_Openmode)", referenced from:
      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      ...
  "std::__cxx11::basic_ostringstream<char, std::char_traits<char>, std::allocator<char> >::~basic_ostringstream()", referenced from:
      fplll::BKZReduction<fplll::FP_NR<double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<double> >::bkz() in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::tour(int, int&, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::slide_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      fplll::BKZReduction<fplll::FP_NR<long double> >::sd_tour(int, fplll::BKZParam const&, int, int) in bkz.o
      ...
  "std::__detail::_List_node_base::_M_hook(std::__detail::_List_node_base*)", referenced from:
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_2reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_2reduce(ListPoint<long>*) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce(ListPoint<long>*) in sieve_gauss.o
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_4reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_4reduce(ListPoint<long>*) in sieve_gauss.o
  "std::__detail::_List_node_base::_M_unhook()", referenced from:
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_2reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce_2reduce(ListPoint<__mpz_struct [1]>*, std::_List_iterator<ListPoint<__mpz_struct [1]>*>&) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce_2reduce(ListPoint<long>*, std::_List_iterator<ListPoint<long>*>&) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_2reduce(ListPoint<long>*) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_4reduce_3reduce(ListPoint<long>*) in sieve_gauss.o
      GaussSieve<long, fplll::FP_NR<double> >::update_p_3reduce(ListPoint<long>*) in sieve_gauss.o
      GaussSieve<__mpz_struct [1], fplll::FP_NR<double> >::update_p_3reduce(ListPoint<__mpz_struct [1]>*) in sieve_gauss.o
      ...
  "std::__throw_bad_function_call()", referenced from:
      fplll::ExternalEnumeration<fplll::FP_NR<__mpfr_struct [1]> >::enumerate(int, int, fplll::FP_NR<__mpfr_struct [1]>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o
      fplll::ExternalEnumeration<fplll::FP_NR<double> >::enumerate(int, int, fplll::FP_NR<double>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o
      fplll::ExternalEnumeration<fplll::FP_NR<long double> >::enumerate(int, int, fplll::FP_NR<long double>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o
      fplll::ExternalEnumeration<fplll::FP_NR<dpe_struct [1]> >::enumerate(int, int, fplll::FP_NR<dpe_struct [1]>&, long, std::vector<double, std::allocator<double> > const&, bool) in enumerate_ext.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::parser::parse_internal(bool) in bkz_param.o
  "std::basic_istream<char, std::char_traits<char> >& std::getline<char, std::char_traits<char>, std::allocator<char> >(std::basic_istream<char, std::char_traits<char> >&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, char)", referenced from:
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::fill_line_buffer() in bkz_param.o
      nlohmann::basic_json<std::map, std::vector, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, long long, unsigned long long, double, std::allocator>::lexer::scan() in bkz_param.o
ld: symbol(s) not found for architecture x86_64
collect2: error: ld returned 1 exit status
```



---

archive/issue_comments_138822.json:
```json
{
    "body": "<a id='comment:6'></a>\nWhich version of OS X are you running?",
    "created_at": "2017-06-22T05:10:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138822",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Which version of OS X are you running?



---

archive/issue_comments_138823.json:
```json
{
    "body": "<a id='comment:7'></a>\nSuccessfully built with gcc-7.1 from hpc.sourceforge.net.",
    "created_at": "2017-06-22T07:26:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138823",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Successfully built with gcc-7.1 from hpc.sourceforge.net.



---

archive/issue_comments_138824.json:
```json
{
    "body": "<a id='comment:288'></a>\nReplying to [fbissey](#comment%3A286):\n> Which version of OS X are you running?\n\n\nSierra (10.12.5).\n\n> Successfully built with gcc-7.1 from hpc.sourceforge.net. \n\n\nMe too.",
    "created_at": "2017-06-22T14:45:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138824",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:288'></a>
Replying to [fbissey](#comment%3A286):
> Which version of OS X are you running?


Sierra (10.12.5).

> Successfully built with gcc-7.1 from hpc.sourceforge.net. 


Me too.



---

archive/issue_comments_138825.json:
```json
{
    "body": "**Changing commit** from \"[777a393a2344773c293595d00b469b5bb4115b70](https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70)\" to \"[fb86df818df776b120072e2658c3298e6165953b](https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b)\".",
    "created_at": "2017-06-22T22:10:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138825",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[777a393a2344773c293595d00b469b5bb4115b70](https://github.com/sagemath/sagetrac-mirror/commit/777a393a2344773c293595d00b469b5bb4115b70)" to "[fb86df818df776b120072e2658c3298e6165953b](https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b)".



---

archive/issue_comments_138826.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d76da7b65765181167e74923bee1856d21d3e4d3\">d76da7b</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a50d44f8da9bf9d1408e8cb945f07d227c884fb9\">a50d44f</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31ccf123763eba998616dcaea9789c65df7bfb97\">31ccf12</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b\">fb86df8</a></td><td><code>update configure tarball</code></td></tr></table>\n",
    "created_at": "2017-06-22T22:10:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d76da7b65765181167e74923bee1856d21d3e4d3">d76da7b</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a50d44f8da9bf9d1408e8cb945f07d227c884fb9">a50d44f</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31ccf123763eba998616dcaea9789c65df7bfb97">31ccf12</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b">fb86df8</a></td><td><code>update configure tarball</code></td></tr></table>




---

archive/issue_comments_138827.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-06-22T22:11:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138827",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-226.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) and build with
 
 ```
 make
``````




---

archive/issue_comments_138828.json:
```json
{
    "body": "<a id='comment:1'></a>\n@jhpalmieri your problem with 5.4.0 from homebrew is very strange. I don't any of the tricks in gcc's spkg-install deal with something like that. It is like it is trying to use the libstdc++ from the wrong arch to link. That's utterly bizarre.",
    "created_at": "2017-06-22T22:16:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138828",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
@jhpalmieri your problem with 5.4.0 from homebrew is very strange. I don't any of the tricks in gcc's spkg-install deal with something like that. It is like it is trying to use the libstdc++ from the wrong arch to link. That's utterly bizarre.



---

archive/issue_comments_138829.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt's not homebrew, I just got a gcc tarball and essentially did `./configure; make; make install`. Maybe some configure flags should be added.",
    "created_at": "2017-06-22T22:32:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138829",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
It's not homebrew, I just got a gcc tarball and essentially did `./configure; make; make install`. Maybe some configure flags should be added.



---

archive/issue_comments_138830.json:
```json
{
    "body": "<a id='comment:293'></a>\nReplying to [jhpalmieri](#comment%3A292):\n> It's not homebrew, I just got a gcc tarball and essentially did `./configure; make; make install`. Maybe some configure flags should be added.\n\n\nPossibly. That's one of these things that are hard to assess without being over your shoulder.",
    "created_at": "2017-06-22T23:12:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138830",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:293'></a>
Replying to [jhpalmieri](#comment%3A292):
> It's not homebrew, I just got a gcc tarball and essentially did `./configure; make; make install`. Maybe some configure flags should be added.


Possibly. That's one of these things that are hard to assess without being over your shoulder.



---

archive/issue_comments_138831.json:
```json
{
    "body": "**Changing commit** from \"[fb86df818df776b120072e2658c3298e6165953b](https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b)\" to \"[dfebfafc0b44e1134600008a7920c303c5a59de3](https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3)\".",
    "created_at": "2017-06-23T02:10:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138831",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fb86df818df776b120072e2658c3298e6165953b](https://github.com/sagemath/sagetrac-mirror/commit/fb86df818df776b120072e2658c3298e6165953b)" to "[dfebfafc0b44e1134600008a7920c303c5a59de3](https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3)".



---

archive/issue_comments_138832.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3\">dfebfaf</a></td><td><code>simplify spkg-install for gfortran a bit</code></td></tr></table>\n",
    "created_at": "2017-06-23T02:10:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138832",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3">dfebfaf</a></td><td><code>simplify spkg-install for gfortran a bit</code></td></tr></table>




---

archive/issue_comments_138833.json:
```json
{
    "body": "<a id='comment:5'></a>\nTesting with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...\n\n```\nchecking for C compiler vendor... clang\nchecking for clang... clang\n```\nand I'm not seeing the usual message about building a small mpir to build gcc.",
    "created_at": "2017-06-23T14:18:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138833",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
Testing with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...

```
checking for C compiler vendor... clang
checking for clang... clang
```
and I'm not seeing the usual message about building a small mpir to build gcc.



---

archive/issue_comments_138834.json:
```json
{
    "body": "<a id='comment:6'></a>\nBUT\n\n```\nFound local metadata for gfortran-5.4.0\nAttempting to download package gcc-5.4.0.tar.bz2 from mirrors\nhttp://files.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//files.sagemath.org/spkg/ups$\nhttp://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gfortran/gcc-5.4.0.$\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sa$\nhttp://mirror.yandex.ru/mirrors/sage.math.washington.edu/spkg/upstream/gfortran$\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\n```\nEtc.\n\nAnd this makes sense, because `http://files.sagemath.org/spkg/upstream/` doesn't have a `gfortran` directory.  So I had to download it \"by hand\" from files.sagemath.org.  Something along these lines would have to be fixed eventually.  But for testing purposes at the least you should point this out in your instructions.\n\nFor now, that seemed to do it.  Though\n\n```\n[gfortran-5.4.0] The following languages will be built: c,fortran\n```\nDoes it need to build c?",
    "created_at": "2017-06-23T14:35:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138834",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
BUT

```
Found local metadata for gfortran-5.4.0
Attempting to download package gcc-5.4.0.tar.bz2 from mirrors
http://files.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//files.sagemath.org/spkg/ups$
http://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gfortran/gcc-5.4.0.$
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sa$
http://mirror.yandex.ru/mirrors/sage.math.washington.edu/spkg/upstream/gfortran$
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
```
Etc.

And this makes sense, because `http://files.sagemath.org/spkg/upstream/` doesn't have a `gfortran` directory.  So I had to download it "by hand" from files.sagemath.org.  Something along these lines would have to be fixed eventually.  But for testing purposes at the least you should point this out in your instructions.

For now, that seemed to do it.  Though

```
[gfortran-5.4.0] The following languages will be built: c,fortran
```
Does it need to build c?



---

archive/issue_comments_138835.json:
```json
{
    "body": "<a id='comment:297'></a>\nReplying to [kcrisman](#comment%3A296):\n\n> For now, that seemed to do it.  Though\n> \n> ```\n> [gfortran-5.4.0] The following languages will be built: c,fortran\n> ```\n> Does it need to build c?\n\n\nIMHO it cannot at the moment build Fortran only, it has to be C as well.",
    "created_at": "2017-06-23T15:40:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138835",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:297'></a>
Replying to [kcrisman](#comment%3A296):

> For now, that seemed to do it.  Though
> 
> ```
> [gfortran-5.4.0] The following languages will be built: c,fortran
> ```
> Does it need to build c?


IMHO it cannot at the moment build Fortran only, it has to be C as well.



---

archive/issue_comments_138836.json:
```json
{
    "body": "<a id='comment:8'></a>\nBy the way, I reinstalled my own gcc-5.4.0, and now Sage builds and all tests pass. So it looks like the problems were on my end.",
    "created_at": "2017-06-23T15:47:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138836",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
By the way, I reinstalled my own gcc-5.4.0, and now Sage builds and all tests pass. So it looks like the problems were on my end.



---

archive/issue_comments_138837.json:
```json
{
    "body": "<a id='comment:9'></a>\nR was apparently successfully built in my case, so that is a very good sign.",
    "created_at": "2017-06-23T16:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138837",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
R was apparently successfully built in my case, so that is a very good sign.



---

archive/issue_comments_138838.json:
```json
{
    "body": "<a id='comment:300'></a>\n> Testing with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...\n\n\nSage successfully built, modulo needing to download those two files.  Currently building doc but that should be unrelated.  Shall I run doctests?",
    "created_at": "2017-06-23T17:51:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138838",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:300'></a>
> Testing with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...


Sage successfully built, modulo needing to download those two files.  Currently building doc but that should be unrelated.  Shall I run doctests?



---

archive/issue_comments_138839.json:
```json
{
    "body": "<a id='comment:301'></a>\nReplying to [kcrisman](#comment%3A300):\n> > Testing with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...\n\n> \n> Sage successfully built, modulo needing to download those two files.  Currently building doc but that should be unrelated.  Shall I run doctests?\n\n\nyes please! Thanks for the feedback.\n\nI had always assumed people would start from a tarball so yes I will add instructions shortly. If we go that route the gfortran folder in the upstream repo should link to the gcc one.\n\n@ jhpalmieri That an external gcc-5.4.0 works is great news.\n\nConsidering some feedback on #22646 I may have to introduce some versioning check. xcode 7 apparently works, I don't know if someone can try xcode 6. But xcode 7 is probably a good lower bound on OS X. Now apparently clang 3.7 on fedora 23 is quite broken so on linux I am thinking of putting the lower bound at 3.8. But install details may vary from distro to distro - incredibly I think clang is too modular for its own good.",
    "created_at": "2017-06-23T20:37:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138839",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:301'></a>
Replying to [kcrisman](#comment%3A300):
> > Testing with a from-scratch `git clone` on OS X 10.11.6, Xcode 7.3.1. So far, so good ...

> 
> Sage successfully built, modulo needing to download those two files.  Currently building doc but that should be unrelated.  Shall I run doctests?


yes please! Thanks for the feedback.

I had always assumed people would start from a tarball so yes I will add instructions shortly. If we go that route the gfortran folder in the upstream repo should link to the gcc one.

@ jhpalmieri That an external gcc-5.4.0 works is great news.

Considering some feedback on #22646 I may have to introduce some versioning check. xcode 7 apparently works, I don't know if someone can try xcode 6. But xcode 7 is probably a good lower bound on OS X. Now apparently clang 3.7 on fedora 23 is quite broken so on linux I am thinking of putting the lower bound at 3.8. But install details may vary from distro to distro - incredibly I think clang is too modular for its own good.



---

archive/issue_comments_138840.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -35,3 +35,5 @@\n ```\n on OS where clang is not the default compiler [it should also work on OS X].\n For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.\n+\n+If you start from a clone rather than a tarball, be sure to download the gcc tarball first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.\n``````\n",
    "created_at": "2017-06-23T20:39:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138840",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -35,3 +35,5 @@
 ```
 on OS where clang is not the default compiler [it should also work on OS X].
 For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.
+
+If you start from a clone rather than a tarball, be sure to download the gcc tarball first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.
``````




---

archive/issue_comments_138841.json:
```json
{
    "body": "<a id='comment:3'></a>\nCould we [enable freebsd](https://github.com/sagemath/sagetrac-mirror/commit/a32b0c7ced6e21930dad895a4e587dcc487d2c57) on this branch?\n\n(this link is to the corresponding trivial commit from #22679)\n\nIt looks as if it's the only thing needed on top of the branch here to build on freebsd\n(well, still with a bit of manual intervention).",
    "created_at": "2017-06-23T21:18:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138841",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
Could we [enable freebsd](https://github.com/sagemath/sagetrac-mirror/commit/a32b0c7ced6e21930dad895a4e587dcc487d2c57) on this branch?

(this link is to the corresponding trivial commit from #22679)

It looks as if it's the only thing needed on top of the branch here to build on freebsd
(well, still with a bit of manual intervention).



---

archive/issue_comments_138842.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n@@ -36,4 +36,4 @@\n on OS where clang is not the default compiler [it should also work on OS X].\n For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.\n \n-If you start from a clone rather than a tarball, be sure to download the gcc tarball first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.\n+If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.\n``````\n",
    "created_at": "2017-06-23T21:19:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138842",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) to the `upstream` folder and build with
 
 ```
 make
@@ -36,4 +36,4 @@
 on OS where clang is not the default compiler [it should also work on OS X].
 For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.
 
-If you start from a clone rather than a tarball, be sure to download the gcc tarball first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.
+If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.
``````




---

archive/issue_comments_138843.json:
```json
{
    "body": "<a id='comment:5'></a>\nNo errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.",
    "created_at": "2017-06-24T22:03:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138843",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
No errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.



---

archive/issue_comments_138844.json:
```json
{
    "body": "<a id='comment:306'></a>\nReplying to [kcrisman](#comment%3A305):\n> No errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.\n\n\nThat's unusual. Is the machine overloaded? Of course that could be down to one single critical element with a fault causing the timeouts.",
    "created_at": "2017-06-24T22:49:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138844",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:306'></a>
Replying to [kcrisman](#comment%3A305):
> No errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.


That's unusual. Is the machine overloaded? Of course that could be down to one single critical element with a fault causing the timeouts.



---

archive/issue_comments_138845.json:
```json
{
    "body": "<a id='comment:307'></a>\n> > No errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.\n\n> \n> That's unusual. Is the machine overloaded? Of course that could be down to one single critical element with a fault causing the timeouts.\n\n\nI think it just couldn't handle parallel testing of some files - everything that didn't pass was over 100s when done individual and was fine.  The only thing that didn't actually pass at some point was\n\n```\nsage -t src/sage/repl/configuration.py\n**********************************************************************\nFile \"src/sage/repl/configuration.py\", line 14, in sage.repl.configuration\nFailed example:\n    'In [1]: [False, True]' in output\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.repl.configuration\n    [18 tests, 1 failure, 31.96 s]\n```\nbut this passed three times in a row when done individually so perhaps some obscure race condition.  I say that this means we can use clang on my box, anyway.",
    "created_at": "2017-06-25T03:03:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138845",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:307'></a>
> > No errors but an awful lot of timeouts, though that said I haven't run doctests for ages on this computer.  I'll try again with `SAGE_TIMEOUT=1000` but I don't expect much.

> 
> That's unusual. Is the machine overloaded? Of course that could be down to one single critical element with a fault causing the timeouts.


I think it just couldn't handle parallel testing of some files - everything that didn't pass was over 100s when done individual and was fine.  The only thing that didn't actually pass at some point was

```
sage -t src/sage/repl/configuration.py
**********************************************************************
File "src/sage/repl/configuration.py", line 14, in sage.repl.configuration
Failed example:
    'In [1]: [False, True]' in output
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of   5 in sage.repl.configuration
    [18 tests, 1 failure, 31.96 s]
```
but this passed three times in a row when done individually so perhaps some obscure race condition.  I say that this means we can use clang on my box, anyway.



---

archive/issue_comments_138846.json:
```json
{
    "body": "<a id='comment:8'></a>\nthis works nicely on FreeBSD, with a small patch on top of this branch, see #22679. (few failing doctests, a bit more than on OSX).",
    "created_at": "2017-06-26T15:01:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138846",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
this works nicely on FreeBSD, with a small patch on top of this branch, see #22679. (few failing doctests, a bit more than on OSX).



---

archive/issue_comments_138847.json:
```json
{
    "body": "<a id='comment:9'></a>\nOn Gentoo Linux with clang (4.0.0), there are C++ problems, no matter what `-stdlib=` is.\n\n* `-stdlib=libstdc++`: in giac there are problems with `hash_map` and `unordered_map` - none work. Not sure it's gentoo or giac bug, or both... While the rest of the packages appear to build, this one does not look easy to tackle without the author. Another reason to stick to `libc++`, for the time being at least.\n\n* `-stdlib=libc++`: some C++ problems (do not look to hard to fix) in eclib. More to come (still compiling more packages, to see what else is iffy)",
    "created_at": "2017-06-27T07:25:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138847",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
On Gentoo Linux with clang (4.0.0), there are C++ problems, no matter what `-stdlib=` is.

* `-stdlib=libstdc++`: in giac there are problems with `hash_map` and `unordered_map` - none work. Not sure it's gentoo or giac bug, or both... While the rest of the packages appear to build, this one does not look easy to tackle without the author. Another reason to stick to `libc++`, for the time being at least.

* `-stdlib=libc++`: some C++ problems (do not look to hard to fix) in eclib. More to come (still compiling more packages, to see what else is iffy)



---

archive/issue_comments_138848.json:
```json
{
    "body": "<a id='comment:310'></a>\nReplying to [dimpase](#comment%3A309):\n> On Gentoo Linux with clang (4.0.0), there are C++ problems, no matter what `-stdlib=` is.\n> \n> * `-stdlib=libstdc++`: in giac there are problems with `hash_map` and `unordered_map` - none work. Not sure it's gentoo or giac bug, or both... While the rest of the packages appear to build, this one does not look easy to tackle without the author. Another reason to stick to `libc++`, for the time being at least.\n> \n> * `-stdlib=libc++`: some C++ problems (do not look to hard to fix) in eclib. More to come (still compiling more packages, to see what else is iffy)\n\n\nGentoo but I am still on clang-3.9.1.\n\nThere are indeed some issues with eclib. Apart from the tolerance issue one the test executable segfault for an unclear reason in a C++ header from clang's libstdc++. The issue doesn't appear to exist on OS X - where xcode is based on clang 3.8. eclib could gain to completely switch to c++11. It wouldn't fix all the issues but it would come out cleaner. The issues in eclib don't prevent sage test suite to fully pass.\n\ngiac, yes lots of warnings but apart from the funny test where the order of the solution flip between gcc and clang everything passes. I must say that I already have a bad taste in my mouth from hash_map/unordered_map in brial. I think hash_map should get the cold shoulder.\n\nNow for something a little bit different. The branch in its current form will let you try to compile sage with the intel compiler (C/C++ not fortran). So far I only needed two fixes aside from the one already needed for clang. sqlite (because icc fakes gcc too much and sqlite didn't think of it) and openblas (known issue fixed in master but that missed the 0.2.19 release).",
    "created_at": "2017-06-27T08:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138848",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:310'></a>
Replying to [dimpase](#comment%3A309):
> On Gentoo Linux with clang (4.0.0), there are C++ problems, no matter what `-stdlib=` is.
> 
> * `-stdlib=libstdc++`: in giac there are problems with `hash_map` and `unordered_map` - none work. Not sure it's gentoo or giac bug, or both... While the rest of the packages appear to build, this one does not look easy to tackle without the author. Another reason to stick to `libc++`, for the time being at least.
> 
> * `-stdlib=libc++`: some C++ problems (do not look to hard to fix) in eclib. More to come (still compiling more packages, to see what else is iffy)


Gentoo but I am still on clang-3.9.1.

There are indeed some issues with eclib. Apart from the tolerance issue one the test executable segfault for an unclear reason in a C++ header from clang's libstdc++. The issue doesn't appear to exist on OS X - where xcode is based on clang 3.8. eclib could gain to completely switch to c++11. It wouldn't fix all the issues but it would come out cleaner. The issues in eclib don't prevent sage test suite to fully pass.

giac, yes lots of warnings but apart from the funny test where the order of the solution flip between gcc and clang everything passes. I must say that I already have a bad taste in my mouth from hash_map/unordered_map in brial. I think hash_map should get the cold shoulder.

Now for something a little bit different. The branch in its current form will let you try to compile sage with the intel compiler (C/C++ not fortran). So far I only needed two fixes aside from the one already needed for clang. sqlite (because icc fakes gcc too much and sqlite didn't think of it) and openblas (known issue fixed in master but that missed the 0.2.19 release).



---

archive/issue_comments_138849.json:
```json
{
    "body": "<a id='comment:1'></a>\nOn Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS=\"-std=c++11\"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)\n\nWithout that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.\n \nHow does one submit patches for giac?",
    "created_at": "2017-06-28T22:30:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138849",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS="-std=c++11"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)

Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.
 
How does one submit patches for giac?



---

archive/issue_comments_138850.json:
```json
{
    "body": "<a id='comment:312'></a>\nReplying to [dimpase](#comment%3A311):\n> On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS=\"-std=c++11\"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)\n> \n> Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.\n>  \n\n\nOK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword \"register\").\n\n> How does one submit patches for giac?\n\n\nYou have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.",
    "created_at": "2017-06-28T22:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138850",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:312'></a>
Replying to [dimpase](#comment%3A311):
> On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS="-std=c++11"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)
> 
> Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.
>  


OK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword "register").

> How does one submit patches for giac?


You have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.



---

archive/issue_comments_138851.json:
```json
{
    "body": "<a id='comment:313'></a>\nReplying to [fbissey](#comment%3A312):\n> Replying to [dimpase](#comment%3A311):\n> > On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS=\"-std=c++11\"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)\n> > \n> > Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.\n> >  \n\nUnintentionally, I built with `-stdlib=libstdc++`; apparently in my configuration\nI need an explicit `-stdlib=libc++` in CXXFLAGS.\n\nAnyhow, ptestlong fails just one doctest, due to numerical noise:\n\n```\nFile \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\nFailed example:\n    L.hardy_z_function(0)\nExpected:\n    0.7939675904771...\nGot:\n    0.793967590477206 - 4.03312243040125e-17*I\n```\n\nI'd say this configuration is good to go. I'll test with `-stdlib=libc++`, too.\nI guess some GNUisms might pop up...\n\n> \n> OK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword \"register\").\n\n\nYes, this is a good idea.\n\n> \n> > How does one submit patches for giac?\n\n> \n> You have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.\n\n\nIt seems I need to jump through a French-only hoop to subscribe to that forum :-)",
    "created_at": "2017-06-29T06:54:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138851",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:313'></a>
Replying to [fbissey](#comment%3A312):
> Replying to [dimpase](#comment%3A311):
> > On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS="-std=c++11"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)
> > 
> > Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.
> >  

Unintentionally, I built with `-stdlib=libstdc++`; apparently in my configuration
I need an explicit `-stdlib=libc++` in CXXFLAGS.

Anyhow, ptestlong fails just one doctest, due to numerical noise:

```
File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
Failed example:
    L.hardy_z_function(0)
Expected:
    0.7939675904771...
Got:
    0.793967590477206 - 4.03312243040125e-17*I
```

I'd say this configuration is good to go. I'll test with `-stdlib=libc++`, too.
I guess some GNUisms might pop up...

> 
> OK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword "register").


Yes, this is a good idea.

> 
> > How does one submit patches for giac?

> 
> You have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.


It seems I need to jump through a French-only hoop to subscribe to that forum :-)



---

archive/issue_comments_138852.json:
```json
{
    "body": "<a id='comment:314'></a>\nReplying to [dimpase](#comment%3A313):\n> Replying to [fbissey](#comment%3A312):\n> > Replying to [dimpase](#comment%3A311):\n> > > On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS=\"-std=c++11\"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)\n> > > \n> > > Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.\n> > >  \n\n> Unintentionally, I built with `-stdlib=libstdc++`; apparently in my configuration\n> I need an explicit `-stdlib=libc++` in CXXFLAGS.\n> \n> Anyhow, ptestlong fails just one doctest, due to numerical noise:\n> \n> ```\n> File \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\n> Failed example:\n>     L.hardy_z_function(0)\n> Expected:\n>     0.7939675904771...\n> Got:\n>     0.793967590477206 - 4.03312243040125e-17*I\n> ```\n\n\nThat's funny.\n\n```\nfbissey@moonloop ~/sandbox/git-fork/sage-icc $ ./sage -t --long src/sage/libs/lcalc/lcalc_Lfunction.pyx \ntoo many failed tests, not using stored timings\nRunning doctests with ID 2017-06-29-20-00-14-17cf5c10.\nGit branch: clang-progress\nUsing --optional=mpir,python2,sage\nDoctesting 1 file.\nsage -t --long src/sage/libs/lcalc/lcalc_Lfunction.pyx\n**********************************************************************\nFile \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\nFailed example:\n    L.hardy_z_function(0)\nExpected:\n    0.7939675904771...\nGot:\n    0.793967590477208 - 4.03312243040124e-17*I\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\n    [103 tests, 1 failure, 1.10 s]\n```\nYes, this is my `icc` build. I think it deserves a separate numerical noise ticket.\n\n> \n> I'd say this configuration is good to go. I'll test with `-stdlib=libc++`, too.\n> I guess some GNUisms might pop up...\n> \n> > \n> > OK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword \"register\").\n\n> \n> Yes, this is a good idea.\n> \n\n\nI should surprise John with that PR soon.\n\n> > \n> > > How does one submit patches for giac?\n\n> > \n> > You have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.\n\n> \n> It seems I need to jump through a French-only hoop to subscribe to that forum :-)\n> \n\n\nWas it all French? I can't remember :)",
    "created_at": "2017-06-29T08:03:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138852",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:314'></a>
Replying to [dimpase](#comment%3A313):
> Replying to [fbissey](#comment%3A312):
> > Replying to [dimpase](#comment%3A311):
> > > On Gentoo Linux with clang 4.0.1 and libc++, things are much better than on 4.0.0, a successful, almost automatic, build: one needs `CXXFLAGS="-std=c++11"` for giac, ntl, and eclib, but no such flag for `lcalc`; also, giac needs a straightforward patch (several `static_cast<>()`)
> > > 
> > > Without that `CXXFLAGS` some old gcc headers get picked up, leading to lots of C++ errors.
> > >  

> Unintentionally, I built with `-stdlib=libstdc++`; apparently in my configuration
> I need an explicit `-stdlib=libc++` in CXXFLAGS.
> 
> Anyhow, ptestlong fails just one doctest, due to numerical noise:
> 
> ```
> File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
> Failed example:
>     L.hardy_z_function(0)
> Expected:
>     0.7939675904771...
> Got:
>     0.793967590477206 - 4.03312243040125e-17*I
> ```


That's funny.

```
fbissey@moonloop ~/sandbox/git-fork/sage-icc $ ./sage -t --long src/sage/libs/lcalc/lcalc_Lfunction.pyx 
too many failed tests, not using stored timings
Running doctests with ID 2017-06-29-20-00-14-17cf5c10.
Git branch: clang-progress
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --long src/sage/libs/lcalc/lcalc_Lfunction.pyx
**********************************************************************
File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 188, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
Failed example:
    L.hardy_z_function(0)
Expected:
    0.7939675904771...
Got:
    0.793967590477208 - 4.03312243040124e-17*I
**********************************************************************
1 item had failures:
   1 of  15 in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
    [103 tests, 1 failure, 1.10 s]
```
Yes, this is my `icc` build. I think it deserves a separate numerical noise ticket.

> 
> I'd say this configuration is good to go. I'll test with `-stdlib=libc++`, too.
> I guess some GNUisms might pop up...
> 
> > 
> > OK, makes sense. We probably want to switch most of these to std=c++11 anyway. I am writing a pull request for eclib to change its default and drop the stuff that c++11 doesn't like (keyword "register").

> 
> Yes, this is a good idea.
> 


I should surprise John with that PR soon.

> > 
> > > How does one submit patches for giac?

> > 
> > You have to raise an issue on their forum at http://xcas.e.ujf-grenoble.fr/XCAS , note that me and debian are already queuing for some other changes related to gui and the use of X libraries.

> 
> It seems I need to jump through a French-only hoop to subscribe to that forum :-)
> 


Was it all French? I can't remember :)



---

archive/issue_comments_138853.json:
```json
{
    "body": "<a id='comment:5'></a>\nwith clang 4.0.1 and -stdlib=libc++ -std=c++11 for eclib to build I need\n\n```\ndiff --git a/libsrc/eclib/interface.h b/libsrc/eclib/interface.h\nindex b8eff26..20c9c98 100644\n--- a/libsrc/eclib/interface.h\n+++ b/libsrc/eclib/interface.h\n@@ -159,10 +159,7 @@ inline int is_approx_zero(const RR& x)\n   // cout<<\"is_approx_zero() returns \"<<(x.mantissa()<power2_ZZ(-n))<<endl;\n   return abs(x.mantissa())<power2_ZZ(-n);\n }\n-} // namespace NTL\n #ifdef _LIBCPP_VERSION\n-namespace std {\n-inline namespace __1 {\n inline bool isinf(const RR& z) {\n   return false;\n }\n@@ -182,9 +179,8 @@ inline RR fmax(const RR& x, const RR& y)\n {\n   return x < y ? y : x;\n }\n-}\n-}\n #endif\n+}\n \n #include <complex>\n typedef complex<RR> CC;\n```\n\nwhich basically moves isinf, insnan, etc to the namespace NTL. Does this break clang on OSX?",
    "created_at": "2017-06-29T09:52:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138853",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
with clang 4.0.1 and -stdlib=libc++ -std=c++11 for eclib to build I need

```
diff --git a/libsrc/eclib/interface.h b/libsrc/eclib/interface.h
index b8eff26..20c9c98 100644
--- a/libsrc/eclib/interface.h
+++ b/libsrc/eclib/interface.h
@@ -159,10 +159,7 @@ inline int is_approx_zero(const RR& x)
   // cout<<"is_approx_zero() returns "<<(x.mantissa()<power2_ZZ(-n))<<endl;
   return abs(x.mantissa())<power2_ZZ(-n);
 }
-} // namespace NTL
 #ifdef _LIBCPP_VERSION
-namespace std {
-inline namespace __1 {
 inline bool isinf(const RR& z) {
   return false;
 }
@@ -182,9 +179,8 @@ inline RR fmax(const RR& x, const RR& y)
 {
   return x < y ? y : x;
 }
-}
-}
 #endif
+}
 
 #include <complex>
 typedef complex<RR> CC;
```

which basically moves isinf, insnan, etc to the namespace NTL. Does this break clang on OSX?



---

archive/issue_comments_138854.json:
```json
{
    "body": "<a id='comment:316'></a>\nReplying to [dimpase](#comment%3A315):\n> which basically moves isinf, insnan, etc to the namespace NTL. Does this break clang on OSX?\n\n\nI will try and see what it does here.",
    "created_at": "2017-06-29T09:57:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138854",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:316'></a>
Replying to [dimpase](#comment%3A315):
> which basically moves isinf, insnan, etc to the namespace NTL. Does this break clang on OSX?


I will try and see what it does here.



---

archive/issue_comments_138855.json:
```json
{
    "body": "<a id='comment:7'></a>\nMakes no difference whatsoever on OS X. But it reminded me that I had the same weird segfault on OS X as I have on linux with clang 3.9.1 (in the testsuite).",
    "created_at": "2017-06-29T10:53:43Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138855",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Makes no difference whatsoever on OS X. But it reminded me that I had the same weird segfault on OS X as I have on linux with clang 3.9.1 (in the testsuite).



---

archive/issue_comments_138856.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5434c70edc3be3dfa2c353adff92bf7909708c1b\">5434c70</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5657399ab53fcfe274dee50d0cf5d04bb83ae94\">f565739</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53f9c4de61b5af863af0bbec88a843a3289b3cba\">53f9c4d</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7\">7a9ab6b</a></td><td><code>checksum for this branch's configure tarball</code></td></tr></table>\n",
    "created_at": "2017-06-29T23:38:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138856",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5434c70edc3be3dfa2c353adff92bf7909708c1b">5434c70</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5657399ab53fcfe274dee50d0cf5d04bb83ae94">f565739</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53f9c4de61b5af863af0bbec88a843a3289b3cba">53f9c4d</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7">7a9ab6b</a></td><td><code>checksum for this branch's configure tarball</code></td></tr></table>




---

archive/issue_comments_138857.json:
```json
{
    "body": "**Changing commit** from \"[dfebfafc0b44e1134600008a7920c303c5a59de3](https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3)\" to \"[7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7](https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7)\".",
    "created_at": "2017-06-29T23:38:04Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dfebfafc0b44e1134600008a7920c303c5a59de3](https://github.com/sagemath/sagetrac-mirror/commit/dfebfafc0b44e1134600008a7920c303c5a59de3)" to "[7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7](https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7)".



---

archive/issue_comments_138858.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-06-29T23:39:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138858",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-227.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz) to the `upstream` folder and build with
 
 ```
 make
``````




---

archive/issue_comments_138859.json:
```json
{
    "body": "<a id='comment:0'></a>\nTried `clang-4.0.1` on linux still the same stuff happening during the testsuite. Will see what happens on OS X. \n\nThe patch for eclib will need its own ticket, with a matching PR upstream and needs testing with gcc.\n\nThe lcalc doctest should also get its own ticket.",
    "created_at": "2017-06-30T03:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138859",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Tried `clang-4.0.1` on linux still the same stuff happening during the testsuite. Will see what happens on OS X. 

The patch for eclib will need its own ticket, with a matching PR upstream and needs testing with gcc.

The lcalc doctest should also get its own ticket.



---

archive/issue_comments_138860.json:
```json
{
    "body": "<a id='comment:321'></a>\nReplying to [fbissey](#comment%3A320):\n> Tried `clang-4.0.1` on linux still the same stuff happening during the testsuite. Will see what happens on OS X. \n> \n> The patch for eclib will need its own ticket, with a matching PR upstream and needs testing with gcc.\n> \n> The lcalc doctest should also get its own ticket.\n\n\nOn Linux clang 4.0.1 with libc++ gives a weird linking error on gfan (another old C++ worry).\n\nIt took me a while to notice that `CXXFLAGS` is not used during compilation of C++.\n(and in my setup `-stdlib=libc++` is not the default, the default is `libstdc++`, so\nCXXFLAGS are really needed!)\nIt's an error in gfan's makefile that somehow went unnoticed. The following (a patch to Sage's patch :-)) fixes it:\n\n```\ndiff --git a/build/pkgs/gfan/patches/Makefile.patch b/build/pkgs/gfan/patches/Makefile.patch\nindex 648fa56902..2c4e1d2d3f 100644\n--- a/build/pkgs/gfan/patches/Makefile.patch\n+++ b/build/pkgs/gfan/patches/Makefile.patch\n@@ -60,7 +60,7 @@ index 0892969..c626eb9 100644\n        $(CXX) -c $<\n  .cpp.o:\n -      $(CXX) $(CFLAGS) -c $<\n-+      $(CXX) $(CFLAGS_LOCAL) $(CPPFLAGS) -c $<\n++      $(CXX) $(CXXFLAGS_LOCAL) $(CPPFLAGS) -c $<\n  .C.o:\n        $(CXX) -c $<\n  # wget http://ftp.sunet.se/pub/gnu/gmp/gmp-4.2.2.tar.gz\n```\n\nShould we have a separate ticket for this?",
    "created_at": "2017-06-30T06:38:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138860",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:321'></a>
Replying to [fbissey](#comment%3A320):
> Tried `clang-4.0.1` on linux still the same stuff happening during the testsuite. Will see what happens on OS X. 
> 
> The patch for eclib will need its own ticket, with a matching PR upstream and needs testing with gcc.
> 
> The lcalc doctest should also get its own ticket.


On Linux clang 4.0.1 with libc++ gives a weird linking error on gfan (another old C++ worry).

It took me a while to notice that `CXXFLAGS` is not used during compilation of C++.
(and in my setup `-stdlib=libc++` is not the default, the default is `libstdc++`, so
CXXFLAGS are really needed!)
It's an error in gfan's makefile that somehow went unnoticed. The following (a patch to Sage's patch :-)) fixes it:

```
diff --git a/build/pkgs/gfan/patches/Makefile.patch b/build/pkgs/gfan/patches/Makefile.patch
index 648fa56902..2c4e1d2d3f 100644
--- a/build/pkgs/gfan/patches/Makefile.patch
+++ b/build/pkgs/gfan/patches/Makefile.patch
@@ -60,7 +60,7 @@ index 0892969..c626eb9 100644
        $(CXX) -c $<
  .cpp.o:
 -      $(CXX) $(CFLAGS) -c $<
-+      $(CXX) $(CFLAGS_LOCAL) $(CPPFLAGS) -c $<
++      $(CXX) $(CXXFLAGS_LOCAL) $(CPPFLAGS) -c $<
  .C.o:
        $(CXX) -c $<
  # wget http://ftp.sunet.se/pub/gnu/gmp/gmp-4.2.2.tar.gz
```

Should we have a separate ticket for this?



---

archive/issue_comments_138861.json:
```json
{
    "body": "<a id='comment:322'></a>\nReplying to [dimpase](#comment%3A321):\n> \n> Should we have a separate ticket for this?\n\n\nYes.",
    "created_at": "2017-06-30T07:23:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138861",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:322'></a>
Replying to [dimpase](#comment%3A321):
> 
> Should we have a separate ticket for this?


Yes.



---

archive/issue_comments_138862.json:
```json
{
    "body": "<a id='comment:3'></a>\nBikeshed: I prefer `configure` messages to be short. 3 lines just to say that gfortran needs to be installed is too much:\n\n```\nAC_MSG_NOTICE([GFORTRAN will be built.])\nAC_MSG_NOTICE([Your Fortran compiler isn't GCC (GNU Fortran) or])\nAC_MSG_NOTICE([you don't have one.])\n```",
    "created_at": "2017-06-30T08:51:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138862",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Bikeshed: I prefer `configure` messages to be short. 3 lines just to say that gfortran needs to be installed is too much:

```
AC_MSG_NOTICE([GFORTRAN will be built.])
AC_MSG_NOTICE([Your Fortran compiler isn't GCC (GNU Fortran) or])
AC_MSG_NOTICE([you don't have one.])
```



---

archive/issue_comments_138863.json:
```json
{
    "body": "<a id='comment:4'></a>\nWould it be possible to treat `gfortran` as a completely normal package? That means, do not build it during `all-toolchain`, but just add it explicitly as dependency to the packages that need it. That would speed up compilation since `gfortran` could be built in parallel with other packages (the toolchain is built serially, so it should contain as few packages as possible).",
    "created_at": "2017-06-30T08:55:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138863",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Would it be possible to treat `gfortran` as a completely normal package? That means, do not build it during `all-toolchain`, but just add it explicitly as dependency to the packages that need it. That would speed up compilation since `gfortran` could be built in parallel with other packages (the toolchain is built serially, so it should contain as few packages as possible).



---

archive/issue_comments_138864.json:
```json
{
    "body": "<a id='comment:5'></a>\nPlease do create new tickets for further issues regarding specific packages. This ticket is nicely self-contained, dealing only with the basic Sage configure/build system.",
    "created_at": "2017-06-30T09:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138864",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Please do create new tickets for further issues regarding specific packages. This ticket is nicely self-contained, dealing only with the basic Sage configure/build system.



---

archive/issue_comments_138865.json:
```json
{
    "body": "<a id='comment:326'></a>\nReplying to [jdemeyer](#comment%3A324):\n> Would it be possible to treat `gfortran` as a completely normal package? That means, do not build it during `all-toolchain`, but just add it explicitly as dependency to the packages that need it. That would speed up compilation since `gfortran` could be built in parallel with other packages (the toolchain is built serially, so it should contain as few packages as possible).\n\n\nSure, why not - except that then all the packages that need it must get the corresponding dependency, on the package gfortran. (it's relatively few: numpy, scipy, R, anything esle?)",
    "created_at": "2017-06-30T09:05:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138865",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:326'></a>
Replying to [jdemeyer](#comment%3A324):
> Would it be possible to treat `gfortran` as a completely normal package? That means, do not build it during `all-toolchain`, but just add it explicitly as dependency to the packages that need it. That would speed up compilation since `gfortran` could be built in parallel with other packages (the toolchain is built serially, so it should contain as few packages as possible).


Sure, why not - except that then all the packages that need it must get the corresponding dependency, on the package gfortran. (it's relatively few: numpy, scipy, R, anything esle?)



---

archive/issue_comments_138866.json:
```json
{
    "body": "<a id='comment:327'></a>\nReplying to [jdemeyer](#comment%3A323):\n> Bikeshed: I prefer `configure` messages to be short. 3 lines just to say that gfortran needs to be installed is too much:\n> \n> ```\n> AC_MSG_NOTICE([GFORTRAN will be built.])\n> AC_MSG_NOTICE([Your Fortran compiler isn't GCC (GNU Fortran) or])\n> AC_MSG_NOTICE([you don't have one.])\n> ```\n\n\nFair enough. I'll try to be more terse. The previous message was annoying me as potentially misleading: \"Your fortran compiler is not GCC...\" it creates the perception you have a fortran compiler even when you have none.\n\nDima has a fair point about dependency on gfortran. But the only dependency needed is for blas since all the package needing fortran need it for lapack.",
    "created_at": "2017-06-30T09:09:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138866",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:327'></a>
Replying to [jdemeyer](#comment%3A323):
> Bikeshed: I prefer `configure` messages to be short. 3 lines just to say that gfortran needs to be installed is too much:
> 
> ```
> AC_MSG_NOTICE([GFORTRAN will be built.])
> AC_MSG_NOTICE([Your Fortran compiler isn't GCC (GNU Fortran) or])
> AC_MSG_NOTICE([you don't have one.])
> ```


Fair enough. I'll try to be more terse. The previous message was annoying me as potentially misleading: "Your fortran compiler is not GCC..." it creates the perception you have a fortran compiler even when you have none.

Dima has a fair point about dependency on gfortran. But the only dependency needed is for blas since all the package needing fortran need it for lapack.



---

archive/issue_comments_138867.json:
```json
{
    "body": "<a id='comment:8'></a>\n> Dima has a fair point about dependency on gfortran. But the only dependency needed is for blas since all the package needing fortran need it for lapack.\n\n\nOh, R doesn't need it directly?  Certainly some R packages do need fortran directly, though of course supporting every R package in existence might be tricky.",
    "created_at": "2017-06-30T12:07:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138867",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
> Dima has a fair point about dependency on gfortran. But the only dependency needed is for blas since all the package needing fortran need it for lapack.


Oh, R doesn't need it directly?  Certainly some R packages do need fortran directly, though of course supporting every R package in existence might be tricky.



---

archive/issue_comments_138868.json:
```json
{
    "body": "<a id='comment:9'></a>\nTo be safe, we could (and should) add `gfortran` explicitly as a dependency of R. I guess the main point of Fran\u00e7ois was that it's not a problem if we forget one package which needs Fortran because of BLAS.",
    "created_at": "2017-06-30T12:11:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138868",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
To be safe, we could (and should) add `gfortran` explicitly as a dependency of R. I guess the main point of Fran√ßois was that it's not a problem if we forget one package which needs Fortran because of BLAS.



---

archive/issue_comments_138869.json:
```json
{
    "body": "<a id='comment:0'></a>\nR depends on lapack, although you are right some packages depends on fortran directly. The same is true for scipy, it depends on lapack and uses some fortran code directly. I am fairly sure numpy only depends on lapack/blas. Some optional packages would need to be checked (coinor uses lapack). \n\nIf we include the external dependencies required by cvxopt 1.1.9 some of them may depend directly on fortran.",
    "created_at": "2017-06-30T12:13:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138869",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
R depends on lapack, although you are right some packages depends on fortran directly. The same is true for scipy, it depends on lapack and uses some fortran code directly. I am fairly sure numpy only depends on lapack/blas. Some optional packages would need to be checked (coinor uses lapack). 

If we include the external dependencies required by cvxopt 1.1.9 some of them may depend directly on fortran.



---

archive/issue_comments_138870.json:
```json
{
    "body": "<a id='comment:1'></a>\nA practical question about putting gfortran in dependencies. If you use a system gfortran, a `logs/pkg/gfortran-x.log` is not produced. Same as with gcc. How does the dependency system knows that gfortran has been installed? I am guessing I should look at yasm for an example.",
    "created_at": "2017-06-30T20:37:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138870",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
A practical question about putting gfortran in dependencies. If you use a system gfortran, a `logs/pkg/gfortran-x.log` is not produced. Same as with gcc. How does the dependency system knows that gfortran has been installed? I am guessing I should look at yasm for an example.



---

archive/issue_comments_138871.json:
```json
{
    "body": "<a id='comment:2'></a>\nSomehow it must work packages that need to depend on (g)fortran - add any packages that missing to the list:\n* openblas\n* atlas\n* R\n* scipy\n* numpy (linking with lapack means that numpy needs to at least know about your fortran compiler apparently)\n\nOn the top of my head none of the other packages in standard, optional or experimental needs fortran. But I am unfamiliar with some of those packages in optional and experimental.",
    "created_at": "2017-07-03T01:52:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138871",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Somehow it must work packages that need to depend on (g)fortran - add any packages that missing to the list:
* openblas
* atlas
* R
* scipy
* numpy (linking with lapack means that numpy needs to at least know about your fortran compiler apparently)

On the top of my head none of the other packages in standard, optional or experimental needs fortran. But I am unfamiliar with some of those packages in optional and experimental.



---

archive/issue_comments_138872.json:
```json
{
    "body": "**Changing commit** from \"[7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7](https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7)\" to \"[5326571ec55c1d533f51bb85c0237483785a3929](https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929)\".",
    "created_at": "2017-07-03T02:07:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7](https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7)" to "[5326571ec55c1d533f51bb85c0237483785a3929](https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929)".



---

archive/issue_comments_138873.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929\">5326571</a></td><td><code>make gfortran a regular dependency. Simplify message in configure.</code></td></tr></table>\n",
    "created_at": "2017-07-03T02:07:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929">5326571</a></td><td><code>make gfortran a regular dependency. Simplify message in configure.</code></td></tr></table>




---

archive/issue_events_101960.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-07-03T02:14:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101960"
}
```



---

archive/issue_events_101961.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-07-03T02:14:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101961"
}
```



---

archive/issue_comments_138874.json:
```json
{
    "body": "**Changing dependencies** from \"#22799 #22646\" to \"#22799 #22646 #23354\".",
    "created_at": "2017-07-03T02:17:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138874",
    "user": "https://github.com/kiwifb"
}
```

**Changing dependencies** from "#22799 #22646" to "#22799 #22646 #23354".



---

archive/issue_comments_138875.json:
```json
{
    "body": "<a id='comment:6'></a>\nSee [comment:325]",
    "created_at": "2017-07-03T08:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138875",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
See [comment:325]



---

archive/issue_comments_138876.json:
```json
{
    "body": "**Changing dependencies** from \"#22799 #22646 #23354\" to \"#22646\".",
    "created_at": "2017-07-03T08:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138876",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#22799 #22646 #23354" to "#22646".



---

archive/issue_comments_138877.json:
```json
{
    "body": "<a id='comment:337'></a>\nReplying to [fbissey](#comment%3A331):\n> A practical question about putting gfortran in dependencies. If you use a system gfortran, a `logs/pkg/gfortran-x.log` is not produced. Same as with gcc. How does the dependency system knows that gfortran has been installed? I am guessing I should look at yasm for an example.\n\n\nThe `configure` variable `need_to_install_gfortran` adjusts the generated `build/make/Makefile`. And indeed `yasm` is a good example.",
    "created_at": "2017-07-03T08:08:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138877",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:337'></a>
Replying to [fbissey](#comment%3A331):
> A practical question about putting gfortran in dependencies. If you use a system gfortran, a `logs/pkg/gfortran-x.log` is not produced. Same as with gcc. How does the dependency system knows that gfortran has been installed? I am guessing I should look at yasm for an example.


The `configure` variable `need_to_install_gfortran` adjusts the generated `build/make/Makefile`. And indeed `yasm` is a good example.



---

archive/issue_comments_138878.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4d6748d5ae0826d0f30af78e68e627121d616d4\">f4d6748</a></td><td><code>Change the setting of compilers in the order: environment, sage installed compilers, configured compilers.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb6f0272ef9b8d4754e9d89326730fedeb03fc56\">eb6f027</a></td><td><code>fix objective compiler detection. Don't try to negate using the macro. Bad syntax that no one seem to have noticed.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c41390b5340b250aed08628f1ee24b598a72319\">4c41390</a></td><td><code>Regenerate configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38273c6c529d844cceea62e57bbbb993e2000515\">38273c6</a></td><td><code>Remove bits specific to outdated xcode toolchain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab61da6c3615e09e1b3ad8aedbe64a8e019b1060\">ab61da6</a></td><td><code>update configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58208125c2616a6b2d027b8573db65c3844c9c82\">5820812</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b\">e89c07c</a></td><td><code>Merge branch 'compiler' into clang-progress and update configure tarball</code></td></tr></table>\n",
    "created_at": "2017-07-06T01:49:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138878",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4d6748d5ae0826d0f30af78e68e627121d616d4">f4d6748</a></td><td><code>Change the setting of compilers in the order: environment, sage installed compilers, configured compilers.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb6f0272ef9b8d4754e9d89326730fedeb03fc56">eb6f027</a></td><td><code>fix objective compiler detection. Don't try to negate using the macro. Bad syntax that no one seem to have noticed.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c41390b5340b250aed08628f1ee24b598a72319">4c41390</a></td><td><code>Regenerate configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38273c6c529d844cceea62e57bbbb993e2000515">38273c6</a></td><td><code>Remove bits specific to outdated xcode toolchain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab61da6c3615e09e1b3ad8aedbe64a8e019b1060">ab61da6</a></td><td><code>update configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58208125c2616a6b2d027b8573db65c3844c9c82">5820812</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b">e89c07c</a></td><td><code>Merge branch 'compiler' into clang-progress and update configure tarball</code></td></tr></table>




---

archive/issue_comments_138879.json:
```json
{
    "body": "**Changing commit** from \"[5326571ec55c1d533f51bb85c0237483785a3929](https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929)\" to \"[e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b](https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b)\".",
    "created_at": "2017-07-06T01:49:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138879",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5326571ec55c1d533f51bb85c0237483785a3929](https://github.com/sagemath/sagetrac-mirror/commit/5326571ec55c1d533f51bb85c0237483785a3929)" to "[e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b](https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b)".



---

archive/issue_comments_138880.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-07-06T01:50:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138880",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-228.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz) to the `upstream` folder and build with
 
 ```
 make
``````




---

archive/issue_comments_138881.json:
```json
{
    "body": "<a id='comment:0'></a>\nI noticed that the optional package boost does not build ob FreeBSD, and gets built with gcc on Linux/clang/libc++ even if CC and CXX are specified.\n\nIt seems we need to fix `spkg-install` there to use `--toolset $CC` option.\nAs well, passing `-std=...`  has to be done explicitly, it seems; does this mean that the toplevel Sage configure also needs something like `CXXLIB=` option.",
    "created_at": "2017-07-06T22:15:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138881",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
I noticed that the optional package boost does not build ob FreeBSD, and gets built with gcc on Linux/clang/libc++ even if CC and CXX are specified.

It seems we need to fix `spkg-install` there to use `--toolset $CC` option.
As well, passing `-std=...`  has to be done explicitly, it seems; does this mean that the toplevel Sage configure also needs something like `CXXLIB=` option.



---

archive/issue_comments_138882.json:
```json
{
    "body": "<a id='comment:1'></a>\nGood catch, I'll have a look later today. I don't like the idea of adding `CXXLIB` that's very specific. But we can sort out some details later. `boost` has a, shall we say, very peculiar build system, only used by `boost`. The boost dev would you to use it for your project involving `boost` but it doesn't seem to get much traction (thanks goodness).",
    "created_at": "2017-07-06T22:20:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138882",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Good catch, I'll have a look later today. I don't like the idea of adding `CXXLIB` that's very specific. But we can sort out some details later. `boost` has a, shall we say, very peculiar build system, only used by `boost`. The boost dev would you to use it for your project involving `boost` but it doesn't seem to get much traction (thanks goodness).



---

archive/issue_comments_138883.json:
```json
{
    "body": "<a id='comment:2'></a>\nHum... that will be interesting, it will need its own ticket of course. From `bootstrap.sh`\n\n```\n# Determine the toolset, if not already decided\nif test \"x$TOOLSET\" = x; then\n  guessed_toolset=`$my_dir/tools/build/src/engine/build.sh --guess-toolset`\n  case $guessed_toolset in\n    acc | darwin | gcc | como | mipspro | pathscale | pgi | qcc | vacpp )\n    TOOLSET=$guessed_toolset\n    ;;\n    \n    intel-* )\n    TOOLSET=intel\n    ;;\n    \n    mingw )\n    TOOLSET=gcc\n    ;;\n    \n    sun* )\n    TOOLSET=sun\n    ;;\n    \n    * )\n    # Not supported by Boost.Build\n    ;;\n  esac\nfi\n```\n`clang` is not a defined toolset, may be we'd end up with darwin (no), it should probably piggy back on gcc. May be we need an update to boost. We could possibly leave the toolset as gcc for now and use a `user-config.jam` file with our settings. \n\nIt must already do funny things on OS X since in the absence of toolset, `darwin` is used and probably default to clang (unless they are counting on gcc to be clang, it is not impossible considering the rest of the mess).\n\nThe build system is complex and dealing with it in a systematic way for other vendor (say intel) is difficult.",
    "created_at": "2017-07-06T22:56:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138883",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Hum... that will be interesting, it will need its own ticket of course. From `bootstrap.sh`

```
# Determine the toolset, if not already decided
if test "x$TOOLSET" = x; then
  guessed_toolset=`$my_dir/tools/build/src/engine/build.sh --guess-toolset`
  case $guessed_toolset in
    acc | darwin | gcc | como | mipspro | pathscale | pgi | qcc | vacpp )
    TOOLSET=$guessed_toolset
    ;;
    
    intel-* )
    TOOLSET=intel
    ;;
    
    mingw )
    TOOLSET=gcc
    ;;
    
    sun* )
    TOOLSET=sun
    ;;
    
    * )
    # Not supported by Boost.Build
    ;;
  esac
fi
```
`clang` is not a defined toolset, may be we'd end up with darwin (no), it should probably piggy back on gcc. May be we need an update to boost. We could possibly leave the toolset as gcc for now and use a `user-config.jam` file with our settings. 

It must already do funny things on OS X since in the absence of toolset, `darwin` is used and probably default to clang (unless they are counting on gcc to be clang, it is not impossible considering the rest of the mess).

The build system is complex and dealing with it in a systematic way for other vendor (say intel) is difficult.



---

archive/issue_comments_138884.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79d0963576906f01449ba9b4d3ad4e307b8523b6\">79d0963</a></td><td><code>Remove compiler selecting logic from sage-env-config and put it back in sage-env.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f\">d20a8e7</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-07-10T23:25:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138884",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79d0963576906f01449ba9b4d3ad4e307b8523b6">79d0963</a></td><td><code>Remove compiler selecting logic from sage-env-config and put it back in sage-env.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f">d20a8e7</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138885.json:
```json
{
    "body": "**Changing commit** from \"[e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b](https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b)\" to \"[d20a8e70112ae1a965f039bf6266a6f83427143f](https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f)\".",
    "created_at": "2017-07-10T23:25:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b](https://github.com/sagemath/sagetrac-mirror/commit/e89c07c6be61c8abd9c3653e3cc6cfde7535fe8b)" to "[d20a8e70112ae1a965f039bf6266a6f83427143f](https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f)".



---

archive/issue_comments_138886.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK I am wrong for clang support. It is only guessed for freebsd - and then according to what I quoted it falls in the unsupported category, but that doesn't stop anything. And provided I setup things right (which I hadn't before) it builds on linux with `toolset=clang`.\n\nSo on looking closer at the current situation (i.e. without this ticket), on OS X we probably currently build with clang (`cc` seem to be used) so it is probably on shaky ground with the rest of sage right now (c++ runtime incompatibilities).",
    "created_at": "2017-07-11T03:00:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138886",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
OK I am wrong for clang support. It is only guessed for freebsd - and then according to what I quoted it falls in the unsupported category, but that doesn't stop anything. And provided I setup things right (which I hadn't before) it builds on linux with `toolset=clang`.

So on looking closer at the current situation (i.e. without this ticket), on OS X we probably currently build with clang (`cc` seem to be used) so it is probably on shaky ground with the rest of sage right now (c++ runtime incompatibilities).



---

archive/issue_comments_138887.json:
```json
{
    "body": "**Changing commit** from \"[d20a8e70112ae1a965f039bf6266a6f83427143f](https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f)\" to \"[40bd88abf971c3bc2a8d1f78c75092156e581780](https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780)\".",
    "created_at": "2017-07-22T22:15:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d20a8e70112ae1a965f039bf6266a6f83427143f](https://github.com/sagemath/sagetrac-mirror/commit/d20a8e70112ae1a965f039bf6266a6f83427143f)" to "[40bd88abf971c3bc2a8d1f78c75092156e581780](https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780)".



---

archive/issue_comments_138888.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1015a1fc8fa01cfcbb8faaecd8348682ed72491c\">1015a1f</a></td><td><code>Merge branch 'master' into compiler and configure tarball bump</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780\">40bd88a</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-07-22T22:15:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1015a1fc8fa01cfcbb8faaecd8348682ed72491c">1015a1f</a></td><td><code>Merge branch 'master' into compiler and configure tarball bump</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780">40bd88a</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138889.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-07-23T22:09:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138889",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-229.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz) to the `upstream` folder and build with
 
 ```
 make
``````




---

archive/issue_comments_138890.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4fce28f6568eadb16c161ed9a5d02ba17a8229e\">c4fce28</a></td><td><code>fix missing \"$\" in sage-env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbee7b8529268fe8f8721d098a9f677030d456c2\">bbee7b8</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9\">eaf6473</a></td><td><code>Merge branch 'compiler' into clang-progress and regenerate configure tarball</code></td></tr></table>\n",
    "created_at": "2017-07-30T22:30:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4fce28f6568eadb16c161ed9a5d02ba17a8229e">c4fce28</a></td><td><code>fix missing "$" in sage-env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbee7b8529268fe8f8721d098a9f677030d456c2">bbee7b8</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9">eaf6473</a></td><td><code>Merge branch 'compiler' into clang-progress and regenerate configure tarball</code></td></tr></table>




---

archive/issue_comments_138891.json:
```json
{
    "body": "**Changing commit** from \"[40bd88abf971c3bc2a8d1f78c75092156e581780](https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780)\" to \"[eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9](https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9)\".",
    "created_at": "2017-07-30T22:30:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[40bd88abf971c3bc2a8d1f78c75092156e581780](https://github.com/sagemath/sagetrac-mirror/commit/40bd88abf971c3bc2a8d1f78c75092156e581780)" to "[eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9](https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9)".



---

archive/issue_comments_138892.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,16 +2,9 @@\n \n ---\n \n-Packages failing to build (or causing other packages to fail to build) with Clang:\n-\n-* strange warnings from numpy and matplotlib when built with clang (#22799)\n-* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046\n-\n----\n \n Packages failing their tests\n * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n-* `gf2x`/`ntl` #18882\n * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n * `ccache` #22836\n \n@@ -23,7 +16,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n@@ -34,6 +27,5 @@\n CC=clang CXX=clang++ make\n ```\n on OS where clang is not the default compiler [it should also work on OS X].\n-For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.\n \n-If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.\n+If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.\n``````\n",
    "created_at": "2017-07-30T22:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138892",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,16 +2,9 @@
 
 ---
 
-Packages failing to build (or causing other packages to fail to build) with Clang:
-
-* strange warnings from numpy and matplotlib when built with clang (#22799)
-* On linux with clang, python (all versions) uses the wrong option to get the compiler to pass runpath to the linker. Upstream issue #[25229](http://bugs.python.org/issue25229). This doesn't affect OS X and freeBSD. #23046
-
----
 
 Packages failing their tests
 * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
-* `gf2x`/`ntl` #18882
 * `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
 * `ccache` #22836
 
@@ -23,7 +16,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-231.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with
 
 ```
 make
@@ -34,6 +27,5 @@
 CC=clang CXX=clang++ make
 ```
 on OS where clang is not the default compiler [it should also work on OS X].
-For linux add http://bugs.python.org/file40568/distutils-compiler-name.patch to the patches folder of python2 (or python3 if using) #23046.
 
-If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an inexistent gfortran folder in the upstream repo.
+If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.
``````




---

archive/issue_comments_138893.json:
```json
{
    "body": "<a id='comment:8'></a>\nNote that as of sage 8.1.beta0 this ticket can be tested out of the box on linux.",
    "created_at": "2017-07-30T22:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138893",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Note that as of sage 8.1.beta0 this ticket can be tested out of the box on linux.



---

archive/issue_comments_138894.json:
```json
{
    "body": "<a id='comment:9'></a>\nthere is a mismatch with the value in checksums.ini\n\n```\n$ md5sum configure-232.tar.gz \n4aa680b6dfc4c372872a1a5ee4ec781b  configure-232.tar.gz\n```\nvs in checksums.ini\n\n```\nmd5=0ab186b7307444b0f2e7f47413eb5ba2\n```",
    "created_at": "2017-07-31T15:28:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138894",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
there is a mismatch with the value in checksums.ini

```
$ md5sum configure-232.tar.gz 
4aa680b6dfc4c372872a1a5ee4ec781b  configure-232.tar.gz
```
vs in checksums.ini

```
md5=0ab186b7307444b0f2e7f47413eb5ba2
```



---

archive/issue_comments_138895.json:
```json
{
    "body": "<a id='comment:0'></a>\nStrange I have the right checksum. I replaced the link in the description as if you cut and paste the address that was there you'll download a web page instead of the tarball. I am wondering if that's you problem.\nIt should be a direct link now.",
    "created_at": "2017-07-31T22:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138895",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
Strange I have the right checksum. I replaced the link in the description as if you cut and paste the address that was there you'll download a web page instead of the tarball. I am wondering if that's you problem.
It should be a direct link now.



---

archive/issue_comments_138896.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-07-31T22:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138896",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with
 
 ```
 make
``````




---

archive/issue_comments_138897.json:
```json
{
    "body": "<a id='comment:351'></a>\nReplying to [fbissey](#comment%3A350):\n> Strange I have the right checksum. I replaced the link in the description as if you cut and paste the address that was there you'll download a web page instead of the tarball. I am wondering if that's you problem.\n\n\nOh, indeed, it's some http weirdness that creates a file named `configure-232.tar.gz`\nbut it is actually not a gzipped tarfile...\n\nTrying the branch on Linux/clang now.",
    "created_at": "2017-08-01T07:35:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138897",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:351'></a>
Replying to [fbissey](#comment%3A350):
> Strange I have the right checksum. I replaced the link in the description as if you cut and paste the address that was there you'll download a web page instead of the tarball. I am wondering if that's you problem.


Oh, indeed, it's some http weirdness that creates a file named `configure-232.tar.gz`
but it is actually not a gzipped tarfile...

Trying the branch on Linux/clang now.



---

archive/issue_comments_138898.json:
```json
{
    "body": "<a id='comment:2'></a>\nOK, this builds and seems to work on Gentoo/clang/libc++, if I add `CXXFLAGS=\"-stdlib=libc++`.\nWithout the latter (i.e. with the default `libstdc++` instead) it does not work with giac and probably more.",
    "created_at": "2017-08-01T14:10:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138898",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
OK, this builds and seems to work on Gentoo/clang/libc++, if I add `CXXFLAGS="-stdlib=libc++`.
Without the latter (i.e. with the default `libstdc++` instead) it does not work with giac and probably more.



---

archive/issue_comments_138899.json:
```json
{
    "body": "<a id='comment:3'></a>\nOne has however fix the problem that `libgiac` pulls in `libstdc++.so` as well as `libc++.so`, and this leads to giac basically being non-functional. \nBut this is for  another ticket.",
    "created_at": "2017-08-01T14:41:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138899",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
One has however fix the problem that `libgiac` pulls in `libstdc++.so` as well as `libc++.so`, and this leads to giac basically being non-functional. 
But this is for  another ticket.



---

archive/issue_comments_138900.json:
```json
{
    "body": "<a id='comment:4'></a>\nBy the way, I've been trying this on OS X with each new Sage release, and it's worked well each time. (This is with my own gfortran installed, by the way.)",
    "created_at": "2017-08-01T14:55:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138900",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
By the way, I've been trying this on OS X with each new Sage release, and it's worked well each time. (This is with my own gfortran installed, by the way.)



---

archive/issue_comments_138901.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e485a75b7c89bb283b82db7a30583dbb3227270e\">e485a75</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6\">6f17c02</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-08-08T22:01:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138901",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e485a75b7c89bb283b82db7a30583dbb3227270e">e485a75</a></td><td><code>Merge branch 'develop' into compiler and bump configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6">6f17c02</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138902.json:
```json
{
    "body": "**Changing commit** from \"[eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9](https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9)\" to \"[6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6](https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6)\".",
    "created_at": "2017-08-08T22:01:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138902",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9](https://github.com/sagemath/sagetrac-mirror/commit/eaf6473d4bfbcb0dec5588dd8d3b8374b5c7b2d9)" to "[6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6](https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6)".



---

archive/attachments_016692.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "configure-233.tar.gz",
    "asset_url": "tarball://root/attachments/ticket12426/configure-233.tar.gz",
    "created_at": "2017-08-08T22:02:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12426/configure-233.tar.gz",
    "user": "https://github.com/kiwifb"
}
```



---

archive/issue_comments_138903.json:
```json
{
    "body": "Attachment [configure-233.tar.gz](https://github.com/sagemath/sage/files/ticket12426/configure-233.tar.gz) by @kiwifb created at 2017-08-08 22:02:11",
    "created_at": "2017-08-08T22:02:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138903",
    "user": "https://github.com/kiwifb"
}
```

Attachment [configure-233.tar.gz](https://github.com/sagemath/sage/files/ticket12426/configure-233.tar.gz) by @kiwifb created at 2017-08-08 22:02:11



---

archive/issue_comments_138904.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz) to the `upstream` folder and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-08-08T22:02:44Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138904",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-232.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz) to the `upstream` folder and build with
 
 ```
 make
``````




---

archive/issue_comments_138905.json:
```json
{
    "body": "**Changing commit** from \"[6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6](https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6)\" to \"[ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e](https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e)\".",
    "created_at": "2017-08-10T01:55:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6](https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6)" to "[ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e](https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e)".



---

archive/issue_comments_138906.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e\">ceb3bf5</a></td><td><code>conform to new packaging in place since 8.1.beta1</code></td></tr></table>\n",
    "created_at": "2017-08-10T01:55:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e">ceb3bf5</a></td><td><code>conform to new packaging in place since 8.1.beta1</code></td></tr></table>




---

archive/issue_comments_138907.json:
```json
{
    "body": "<a id='comment:8'></a>\nCould we have a rebase here?",
    "created_at": "2017-08-29T09:46:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138907",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Could we have a rebase here?



---

archive/issue_comments_138908.json:
```json
{
    "body": "<a id='comment:9'></a>\nHow urgent is it? The main reason for the need to rebase is that I keep providing a configure tarball which is updated every beta (I think). Otherwise the branch wouldn't need rebasing so often.",
    "created_at": "2017-08-29T09:49:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138908",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
How urgent is it? The main reason for the need to rebase is that I keep providing a configure tarball which is updated every beta (I think). Otherwise the branch wouldn't need rebasing so often.



---

archive/issue_comments_138909.json:
```json
{
    "body": "<a id='comment:0'></a>\nPerhaps it makes sense to require autoconf instead, for the purposes of this ticket going forward at least. We can put configure tarball back once it's ready to go.",
    "created_at": "2017-08-29T09:52:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138909",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
Perhaps it makes sense to require autoconf instead, for the purposes of this ticket going forward at least. We can put configure tarball back once it's ready to go.



---

archive/issue_comments_138910.json:
```json
{
    "body": "<a id='comment:1'></a>\nOK, it will have to be the same with #22646 on which it depends. I have stuff to put in #22646, I will proceed with the autoconf requirement from there. But I am afraid it will have to wait until I go back to work tomorrow morning in my time zone.",
    "created_at": "2017-08-29T09:55:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138910",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
OK, it will have to be the same with #22646 on which it depends. I have stuff to put in #22646, I will proceed with the autoconf requirement from there. But I am afraid it will have to wait until I go back to work tomorrow morning in my time zone.



---

archive/issue_comments_138911.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3772ae5dd531e548a67d5a514d615614477991d4\">3772ae5</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8c8904577f481f82c63e9354afdf7aecc743f87\">a8c8904</a></td><td><code>Add some documentation and update configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8\">07bfc5a</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-08-29T23:39:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138911",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3772ae5dd531e548a67d5a514d615614477991d4">3772ae5</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8c8904577f481f82c63e9354afdf7aecc743f87">a8c8904</a></td><td><code>Add some documentation and update configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8">07bfc5a</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138912.json:
```json
{
    "body": "**Changing commit** from \"[ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e](https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e)\" to \"[07bfc5a1ae18c40a01ebd8c1169443f866c452d8](https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8)\".",
    "created_at": "2017-08-29T23:39:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e](https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e)" to "[07bfc5a1ae18c40a01ebd8c1169443f866c452d8](https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8)".



---

archive/issue_comments_138913.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n ---\n \n-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz) to the `upstream` folder and build with\n+Testing: merge the attached branch, run `autoreconf` and build with\n \n ```\n make\n``````\n",
    "created_at": "2017-08-29T23:42:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138913",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 ---
 
-Testing: merge the attached branch, run `autoreconf` or download the configure tarball [https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/12426/configure-233.tar.gz) to the `upstream` folder and build with
+Testing: merge the attached branch, run `autoreconf` and build with
 
 ```
 make
``````




---

archive/issue_comments_138914.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK it will still need rebasing until #22646 is merged because I still the tarball there for now. We are closing in on the review for that one so it may be necessary. But this ticket doesn't provide a tarball now.",
    "created_at": "2017-08-29T23:42:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138914",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
OK it will still need rebasing until #22646 is merged because I still the tarball there for now. We are closing in on the review for that one so it may be necessary. But this ticket doesn't provide a tarball now.



---

archive/issue_comments_138915.json:
```json
{
    "body": "**Changing commit** from \"[07bfc5a1ae18c40a01ebd8c1169443f866c452d8](https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8)\" to \"[d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9](https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9)\".",
    "created_at": "2017-08-31T01:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138915",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[07bfc5a1ae18c40a01ebd8c1169443f866c452d8](https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8)" to "[d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9](https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9)".



---

archive/issue_comments_138916.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99eb31f851a4fcdf1e17bd1671b5218ae9acc0be\">99eb31f</a></td><td><code>Minor edits from John Palmieri's feedback</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9\">d8cb828</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-08-31T01:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99eb31f851a4fcdf1e17bd1671b5218ae9acc0be">99eb31f</a></td><td><code>Minor edits from John Palmieri's feedback</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9">d8cb828</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138917.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -29,3 +29,7 @@\n on OS where clang is not the default compiler [it should also work on OS X].\n \n If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.\n+\n+---\n+\n+Special instructions for the release manager: In the upstream mirror for spkg a link called `gfortran` and pointing to the `gcc` folder must be created.\n``````\n",
    "created_at": "2017-08-31T01:40:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138917",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -29,3 +29,7 @@
 on OS where clang is not the default compiler [it should also work on OS X].
 
 If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.
+
+---
+
+Special instructions for the release manager: In the upstream mirror for spkg a link called `gfortran` and pointing to the `gcc` folder must be created.
``````




---

archive/issue_comments_138918.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728\">0ec453b</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-09-05T21:44:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138918",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728">0ec453b</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138919.json:
```json
{
    "body": "**Changing commit** from \"[d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9](https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9)\" to \"[0ec453b8977f9e3032d1bc334cce9013212a5728](https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728)\".",
    "created_at": "2017-09-05T21:44:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138919",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9](https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9)" to "[0ec453b8977f9e3032d1bc334cce9013212a5728](https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728)".



---

archive/issue_comments_138920.json:
```json
{
    "body": "<a id='comment:7'></a>\nWhere is the gfortran tarball?",
    "created_at": "2017-09-07T10:10:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138920",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Where is the gfortran tarball?



---

archive/issue_comments_138921.json:
```json
{
    "body": "<a id='comment:368'></a>\nReplying to [dimpase](#comment%3A367):\n> Where is the gfortran tarball?\n\n No gfortran tarball, gcc's tarball is used.",
    "created_at": "2017-09-07T10:14:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138921",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:368'></a>
Replying to [dimpase](#comment%3A367):
> Where is the gfortran tarball?

 No gfortran tarball, gcc's tarball is used.



---

archive/issue_comments_138922.json:
```json
{
    "body": "<a id='comment:369'></a>\nReplying to [fbissey](#comment%3A368):\n> Replying to [dimpase](#comment%3A367):\n> > Where is the gfortran tarball?\n\n>  No gfortran tarball, gcc's tarball is used.\n\nthe spkg-install of gfortran package is too dumb to know this, and \nwithout gfortran or gcc, and CC set to clang this ends up in an error downloading a non-existent tarball...",
    "created_at": "2017-09-07T10:28:06Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138922",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:369'></a>
Replying to [fbissey](#comment%3A368):
> Replying to [dimpase](#comment%3A367):
> > Where is the gfortran tarball?

>  No gfortran tarball, gcc's tarball is used.

the spkg-install of gfortran package is too dumb to know this, and 
without gfortran or gcc, and CC set to clang this ends up in an error downloading a non-existent tarball...



---

archive/issue_comments_138923.json:
```json
{
    "body": "<a id='comment:0'></a>\nThis shouldn't happen, spkg-install doesn't know the name of the tarball, package-version.txt does. Can you show me the log?",
    "created_at": "2017-09-07T10:33:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138923",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
This shouldn't happen, spkg-install doesn't know the name of the tarball, package-version.txt does. Can you show me the log?



---

archive/issue_comments_138924.json:
```json
{
    "body": "<a id='comment:1'></a>\nit was already mentioned here; namely, there is no `gfortran/` directory on the servers:\n\n```\nFound local metadata for gfortran-5.4.0\nAttempting to download package gcc-5.4.0.tar.bz2 from mirrors\nDownloading the Sage mirror list\nSearching fastest mirror\n  149ms: http://files.sagemath.org/\n...\n    6ms: http://www.mirrorservice.org/sites/www.sagemath.org/\nFastest mirror: http://www.mirrorservice.org/sites/www.sagemath.org/\nhttp://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2'\n...\n```",
    "created_at": "2017-09-07T10:44:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138924",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
it was already mentioned here; namely, there is no `gfortran/` directory on the servers:

```
Found local metadata for gfortran-5.4.0
Attempting to download package gcc-5.4.0.tar.bz2 from mirrors
Downloading the Sage mirror list
Searching fastest mirror
  149ms: http://files.sagemath.org/
...
    6ms: http://www.mirrorservice.org/sites/www.sagemath.org/
Fastest mirror: http://www.mirrorservice.org/sites/www.sagemath.org/
http://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/gfortran/gcc-5.4.0.tar.bz2'
...
```



---

archive/issue_comments_138925.json:
```json
{
    "body": "<a id='comment:2'></a>\nYes it says in the description that you have to make sure the gcc tarball is already downloaded. The release manager needs to create a link gfortran -> gcc when merging the ticket. This is also in the description.",
    "created_at": "2017-09-07T10:46:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138925",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Yes it says in the description that you have to make sure the gcc tarball is already downloaded. The release manager needs to create a link gfortran -> gcc when merging the ticket. This is also in the description.



---

archive/issue_comments_138926.json:
```json
{
    "body": "<a id='comment:3'></a>\nOops, sorry, I was too quick regarding the tarball. Anyway, in this configuration on FreeBSD one is hit by the usual platform specific complex numbers support SNAFU.\n\n```\n[gfortran-5.4.0] libtool: compile:  /usr/home/dima/Sage/porting/sage/local/var/tmp/sage/build/gfortran-5.4.0/gcc-build/./gcc/xgcc -B/\nusr/home/dima/Sage/porting/sage/local/var/tmp/sage/build/gfortran-5.4.0/gcc-build/./gcc/ -B/usr/home/dima/Sage/porting/sage/local/x86\no -c ../../../src/libgfortran/runtime/memory.c  -fPIC -DPIC -o .libs/memory.o\n[gfortran-5.4.0] In file included from ../../../src/libgfortran/libgfortran.h:50:0,\n[gfortran-5.4.0]                  from ../../../src/libgfortran/fmain.c:4:\n[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:311:14: error: expected declaration specifiers or '...' before '(' token\n[gfortran-5.4.0]  extern float cargf (float complex);\n[gfortran-5.4.0]               ^\n[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:311:14: error: expected declaration specifiers or '...' before '(' token\n[gfortran-5.4.0]  extern float cargf (float complex);\n[gfortran-5.4.0]               ^\n[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:316:15: error: expected declaration specifiers or '...' before '(' token\n[gfortran-5.4.0]  extern double carg (double complex);\n[gfortran-5.4.0]                ^\n```\n\nIMHO we should abandon this particular FreeBSD configuration, it's too much trouble, as gfortran is readily available on the system.",
    "created_at": "2017-09-07T10:55:38Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138926",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
Oops, sorry, I was too quick regarding the tarball. Anyway, in this configuration on FreeBSD one is hit by the usual platform specific complex numbers support SNAFU.

```
[gfortran-5.4.0] libtool: compile:  /usr/home/dima/Sage/porting/sage/local/var/tmp/sage/build/gfortran-5.4.0/gcc-build/./gcc/xgcc -B/
usr/home/dima/Sage/porting/sage/local/var/tmp/sage/build/gfortran-5.4.0/gcc-build/./gcc/ -B/usr/home/dima/Sage/porting/sage/local/x86
o -c ../../../src/libgfortran/runtime/memory.c  -fPIC -DPIC -o .libs/memory.o
[gfortran-5.4.0] In file included from ../../../src/libgfortran/libgfortran.h:50:0,
[gfortran-5.4.0]                  from ../../../src/libgfortran/fmain.c:4:
[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:311:14: error: expected declaration specifiers or '...' before '(' token
[gfortran-5.4.0]  extern float cargf (float complex);
[gfortran-5.4.0]               ^
[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:311:14: error: expected declaration specifiers or '...' before '(' token
[gfortran-5.4.0]  extern float cargf (float complex);
[gfortran-5.4.0]               ^
[gfortran-5.4.0] ../../../src/libgfortran/c99_protos.h:316:15: error: expected declaration specifiers or '...' before '(' token
[gfortran-5.4.0]  extern double carg (double complex);
[gfortran-5.4.0]                ^
```

IMHO we should abandon this particular FreeBSD configuration, it's too much trouble, as gfortran is readily available on the system.



---

archive/issue_comments_138927.json:
```json
{
    "body": "<a id='comment:4'></a>\nWith the latest release of Xcode (version 9.0) on OS X, `eclib` now fails to build for me (using Sage 8.1.beta5 plus this branch). [See the log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20170330.log).",
    "created_at": "2017-09-19T23:58:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138927",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
With the latest release of Xcode (version 9.0) on OS X, `eclib` now fails to build for me (using Sage 8.1.beta5 plus this branch). [See the log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20170330.log).



---

archive/issue_comments_138928.json:
```json
{
    "body": "<a id='comment:5'></a>\nYou are ahead of me. I am surprised by the problem in `eclib`, it looks like the new apple clang is based on 3.9 which I have been initially working with on linux. And everything is fine with 4.0 both on linux and OS X. I am not sure if the problem is really in eclib or ntl.",
    "created_at": "2017-09-20T00:03:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138928",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
You are ahead of me. I am surprised by the problem in `eclib`, it looks like the new apple clang is based on 3.9 which I have been initially working with on linux. And everything is fine with 4.0 both on linux and OS X. I am not sure if the problem is really in eclib or ntl.



---

archive/issue_comments_138929.json:
```json
{
    "body": "<a id='comment:6'></a>\nCan you reproduce the problem? (You may not want to install Xcode 9.0, of course.)",
    "created_at": "2017-09-20T00:05:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138929",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
Can you reproduce the problem? (You may not want to install Xcode 9.0, of course.)



---

archive/issue_comments_138930.json:
```json
{
    "body": "<a id='comment:377'></a>\nReplying to [jhpalmieri](#comment%3A376):\n> (You may not want to install Xcode 9.0, of course.)\n\n\nToo late by a couple of hours `<sup>_</sup>`. I am a bit busy right now (and it is lunch time too) so it will have to wait.",
    "created_at": "2017-09-20T00:07:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138930",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:377'></a>
Replying to [jhpalmieri](#comment%3A376):
> (You may not want to install Xcode 9.0, of course.)


Too late by a couple of hours `<sup>_</sup>`. I am a bit busy right now (and it is lunch time too) so it will have to wait.



---

archive/issue_comments_138931.json:
```json
{
    "body": "<a id='comment:8'></a>\nTicket upstream at https://github.com/JohnCremona/eclib/issues/28",
    "created_at": "2017-09-20T03:01:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138931",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Ticket upstream at https://github.com/JohnCremona/eclib/issues/28



---

archive/issue_comments_138932.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83815b207a35f66893ec7e5641b51233406f2f6a\">83815b2</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e\">40d3214</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-09-21T23:19:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83815b207a35f66893ec7e5641b51233406f2f6a">83815b2</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e">40d3214</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138933.json:
```json
{
    "body": "**Changing commit** from \"[0ec453b8977f9e3032d1bc334cce9013212a5728](https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728)\" to \"[40d32145ccd872f5a8164cc8186f1327d2d00b9e](https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e)\".",
    "created_at": "2017-09-21T23:19:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138933",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0ec453b8977f9e3032d1bc334cce9013212a5728](https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728)" to "[40d32145ccd872f5a8164cc8186f1327d2d00b9e](https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e)".



---

archive/issue_comments_138934.json:
```json
{
    "body": "<a id='comment:0'></a>\nShouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?",
    "created_at": "2017-09-22T11:01:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138934",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:0'></a>
Shouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?



---

archive/issue_comments_138935.json:
```json
{
    "body": "<a id='comment:1'></a>\nVarious comments about `gfortran/spkg-install`:\n\n1. Replace\n\n```\nif [ -a \"$SAGE_LOCAL\"/bin/gcc ]; then\n    echo >&2 \"gcc appear to already be installed ... exiting\"\n    exit 1\nfi\n```\nby\n\n```\nif [ -x \"$SAGE_LOCAL\"/bin/gcc ]; then\n    echo >&2 \"Error: gcc is already installed\"\n    exit 1\nfi\n```\n\n2. First doing `cd src` and then immediately `cd ..` is silly: drop that.\n\n3. This isn't needed, the usual build dependency tracking will handle it:\n\n```\n# Force re-configuration: the next time that \"make\" is run, we don't\n# want GFORTRAN to be built again, see Trac #19324\ntouch \"$SAGE_ROOT/configure\"\n```",
    "created_at": "2017-09-22T11:08:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138935",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
Various comments about `gfortran/spkg-install`:

1. Replace

```
if [ -a "$SAGE_LOCAL"/bin/gcc ]; then
    echo >&2 "gcc appear to already be installed ... exiting"
    exit 1
fi
```
by

```
if [ -x "$SAGE_LOCAL"/bin/gcc ]; then
    echo >&2 "Error: gcc is already installed"
    exit 1
fi
```

2. First doing `cd src` and then immediately `cd ..` is silly: drop that.

3. This isn't needed, the usual build dependency tracking will handle it:

```
# Force re-configuration: the next time that "make" is run, we don't
# want GFORTRAN to be built again, see Trac #19324
touch "$SAGE_ROOT/configure"
```



---

archive/issue_events_101962.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-22T11:08:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101962"
}
```



---

archive/issue_events_101963.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-22T11:08:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101963"
}
```



---

archive/issue_comments_138936.json:
```json
{
    "body": "<a id='comment:2'></a>\nIn `configure.ac`, I would remove `AC_MSG_NOTICE([GFORTRAN wasn't found, so it will be built.])`: there is no need to mention every package that will be built.",
    "created_at": "2017-09-22T11:09:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138936",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
In `configure.ac`, I would remove `AC_MSG_NOTICE([GFORTRAN wasn't found, so it will be built.])`: there is no need to mention every package that will be built.



---

archive/issue_comments_138937.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks for the comments, I haven't had good ones in some time :) About (3), I picked that bit from gcc's spkg-install - in a lot of ways gfortran is \"gcc lite\" - does that mean that this could be dropped from gcc's spkg-install (in a different ticket)?",
    "created_at": "2017-09-22T11:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138937",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Thanks for the comments, I haven't had good ones in some time :) About (3), I picked that bit from gcc's spkg-install - in a lot of ways gfortran is "gcc lite" - does that mean that this could be dropped from gcc's spkg-install (in a different ticket)?



---

archive/issue_comments_138938.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe `Force re-configuration` part is related to this block in GCC:\n\n```\n# Force re-installation of gmp, mpir, mpfr and mpc with the GCC we just built.\ncd \"$SAGE_SPKG_INST\"\nrm -f gmp-* mpir-* mpfr-* mpc-*\n```\n\nSo it is needed for GCC but not for GFortran.",
    "created_at": "2017-09-22T11:49:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138938",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
The `Force re-configuration` part is related to this block in GCC:

```
# Force re-installation of gmp, mpir, mpfr and mpc with the GCC we just built.
cd "$SAGE_SPKG_INST"
rm -f gmp-* mpir-* mpfr-* mpc-*
```

So it is needed for GCC but not for GFortran.



---

archive/issue_comments_138939.json:
```json
{
    "body": "<a id='comment:5'></a>\nRelevant ticket that I just created: #23919. It disables GNU extensions while compiling the Sage library. This exposes in particular the known issue with lcalc (#23341).",
    "created_at": "2017-09-22T12:28:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138939",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Relevant ticket that I just created: #23919. It disables GNU extensions while compiling the Sage library. This exposes in particular the known issue with lcalc (#23341).



---

archive/issue_comments_138940.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n \n ---\n-\n \n Packages failing their tests\n * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n``````\n",
    "created_at": "2017-09-22T12:28:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138940",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
 Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
 
 ---
-
 
 Packages failing their tests
 * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
``````




---

archive/issue_comments_138941.json:
```json
{
    "body": "<a id='comment:6'></a>\nSpeaking of which, does this ticket depend on #23341? Does lcalc build with Clang currently?",
    "created_at": "2017-09-22T12:40:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138941",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Speaking of which, does this ticket depend on #23341? Does lcalc build with Clang currently?



---

archive/issue_comments_138942.json:
```json
{
    "body": "<a id='comment:387'></a>\nReplying to [jdemeyer](#comment%3A386):\n> Speaking of which, does this ticket depend on #23341? Does lcalc build with Clang currently?\n\n\nThere are many clangs around. I think the one that does not work with lcalc is clang 4.x.y, for some ranges of x and y. clang 5.0.0 does compile the current clang, and it did work with clang 3.u.v for some u and v, as well.\n\nAnd there is also an issue of the standard C++ library, libstdc++ (from GCC project) vs libc++ (from Clang project); they differ quite a bit. libstdc++ with clang seems to be a deadly mix...\n\nOh, and there also different runtime libs on Linux that may be used...",
    "created_at": "2017-09-22T13:12:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138942",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:387'></a>
Replying to [jdemeyer](#comment%3A386):
> Speaking of which, does this ticket depend on #23341? Does lcalc build with Clang currently?


There are many clangs around. I think the one that does not work with lcalc is clang 4.x.y, for some ranges of x and y. clang 5.0.0 does compile the current clang, and it did work with clang 3.u.v for some u and v, as well.

And there is also an issue of the standard C++ library, libstdc++ (from GCC project) vs libc++ (from Clang project); they differ quite a bit. libstdc++ with clang seems to be a deadly mix...

Oh, and there also different runtime libs on Linux that may be used...



---

archive/issue_comments_138943.json:
```json
{
    "body": "<a id='comment:8'></a>\nI and a few other people have been compiling successfully sage, including `lcalc`, with xcode 8 on OS X, clang-4.0 (not xcode) on OS X, clang 3.9 and 4.0 on linux (Gentoo). xcode 9 and some other platforms and clang installs have problems with `eclib` (fixed in github master but no new release before October John said).",
    "created_at": "2017-09-22T20:36:16Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138943",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
I and a few other people have been compiling successfully sage, including `lcalc`, with xcode 8 on OS X, clang-4.0 (not xcode) on OS X, clang 3.9 and 4.0 on linux (Gentoo). xcode 9 and some other platforms and clang installs have problems with `eclib` (fixed in github master but no new release before October John said).



---

archive/issue_comments_138944.json:
```json
{
    "body": "<a id='comment:9'></a>\nRegarding eclib, adding a file containing\n\n```diff\ndiff --git a/libsrc/eclib/interface.h b/libsrc/eclib/interface.h\nindex b8eff26..127b48e 100644\n--- a/libsrc/eclib/interface.h\n+++ b/libsrc/eclib/interface.h\n@@ -161,8 +161,7 @@ inline int is_approx_zero(const RR& x)\n }\n } // namespace NTL\n #ifdef _LIBCPP_VERSION\n-namespace std {\n-inline namespace __1 {\n+namespace NTL {\n inline bool isinf(const RR& z) {\n   return false;\n }\n@@ -183,7 +182,6 @@ inline RR fmax(const RR& x, const RR& y)\n   return x < y ? y : x;\n }\n }\n-}\n #endif\n \n #include <complex>\n ```\nto the patches directory allows it to build for me on OS X with Xcode 9.0.",
    "created_at": "2017-09-22T21:35:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138944",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Regarding eclib, adding a file containing

```diff
diff --git a/libsrc/eclib/interface.h b/libsrc/eclib/interface.h
index b8eff26..127b48e 100644
--- a/libsrc/eclib/interface.h
+++ b/libsrc/eclib/interface.h
@@ -161,8 +161,7 @@ inline int is_approx_zero(const RR& x)
 }
 } // namespace NTL
 #ifdef _LIBCPP_VERSION
-namespace std {
-inline namespace __1 {
+namespace NTL {
 inline bool isinf(const RR& z) {
   return false;
 }
@@ -183,7 +182,6 @@ inline RR fmax(const RR& x, const RR& y)
   return x < y ? y : x;
 }
 }
-}
 #endif
 
 #include <complex>
 ```
to the patches directory allows it to build for me on OS X with Xcode 9.0.



---

archive/issue_comments_138945.json:
```json
{
    "body": "<a id='comment:0'></a>\nI guess we can spin a ticket with that one fix to `eclib` but just until we have the new release. The new release will properly default to c++11 and contain a number of minor fixes for clang. Ok some of the bugs revealed by eclib's testsuite (mostly fixed) are not so minor but they are not breaking sage's testsuite.",
    "created_at": "2017-09-22T22:48:00Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138945",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
I guess we can spin a ticket with that one fix to `eclib` but just until we have the new release. The new release will properly default to c++11 and contain a number of minor fixes for clang. Ok some of the bugs revealed by eclib's testsuite (mostly fixed) are not so minor but they are not breaking sage's testsuite.



---

archive/issue_comments_138946.json:
```json
{
    "body": "<a id='comment:1'></a>\nFrom my point of view, it depends on how long it will be before a new release of eclib. It would be nice to be able to build Sage in the meantime.",
    "created_at": "2017-09-23T00:03:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138946",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
From my point of view, it depends on how long it will be before a new release of eclib. It would be nice to be able to build Sage in the meantime.



---

archive/issue_comments_138947.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe problem is only with some clang configurations, the most important one being xcode 9 for which we'll need a gcc bump as well. But yes let's put that in a new ticket until next month when we can have a release.",
    "created_at": "2017-09-23T04:18:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138947",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
The problem is only with some clang configurations, the most important one being xcode 9 for which we'll need a gcc bump as well. But yes let's put that in a new ticket until next month when we can have a release.



---

archive/issue_comments_138948.json:
```json
{
    "body": "<a id='comment:393'></a>\nReplying to [jdemeyer](#comment%3A380):\n> Shouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?\n\n\nTricky. Change in gcc version may or may not be accompanied by incompatible changes in fortran runtime. I should double-check on that since a change in libgfortran does mean that things need to be rebuilt. From https://gcc.gnu.org/wiki/GFortran/News it appears all the versions from 4.9.1 are fully ABI compatible (although `.mod` files have changed at gcc-5 but we don't have any of those I think) so far.\nIt is not excluded that some incompatibility will be introduced in some future release.",
    "created_at": "2017-09-23T04:35:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138948",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:393'></a>
Replying to [jdemeyer](#comment%3A380):
> Shouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?


Tricky. Change in gcc version may or may not be accompanied by incompatible changes in fortran runtime. I should double-check on that since a change in libgfortran does mean that things need to be rebuilt. From https://gcc.gnu.org/wiki/GFortran/News it appears all the versions from 4.9.1 are fully ABI compatible (although `.mod` files have changed at gcc-5 but we don't have any of those I think) so far.
It is not excluded that some incompatibility will be introduced in some future release.



---

archive/issue_comments_138949.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6902166c40c7895cca3f461c845f8f1e127c251f\">6902166</a></td><td><code>Simplify gfortran spkg-install a bit. Thanks to Jeroen Demeyer for the feedback on this.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2\">afca2b6</a></td><td><code>no need to be so verbose about gfortran.</code></td></tr></table>\n",
    "created_at": "2017-09-23T04:37:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138949",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6902166c40c7895cca3f461c845f8f1e127c251f">6902166</a></td><td><code>Simplify gfortran spkg-install a bit. Thanks to Jeroen Demeyer for the feedback on this.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2">afca2b6</a></td><td><code>no need to be so verbose about gfortran.</code></td></tr></table>




---

archive/issue_comments_138950.json:
```json
{
    "body": "**Changing commit** from \"[40d32145ccd872f5a8164cc8186f1327d2d00b9e](https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e)\" to \"[afca2b66e16e33da80a8c43fb0e8576ee08182a2](https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2)\".",
    "created_at": "2017-09-23T04:37:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138950",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[40d32145ccd872f5a8164cc8186f1327d2d00b9e](https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e)" to "[afca2b66e16e33da80a8c43fb0e8576ee08182a2](https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2)".



---

archive/issue_comments_138951.json:
```json
{
    "body": "**Changing dependencies** from \"#22646\" to \"#23922\".",
    "created_at": "2017-09-23T05:03:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138951",
    "user": "https://github.com/kiwifb"
}
```

**Changing dependencies** from "#22646" to "#23922".



---

archive/issue_comments_138952.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe\">235c09e</a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02\">48462ea</a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-09-23T05:03:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138952",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe">235c09e</a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02">48462ea</a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138953.json:
```json
{
    "body": "**Changing commit** from \"[afca2b66e16e33da80a8c43fb0e8576ee08182a2](https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2)\" to \"[48462ead230b0740fed7b78d2fa349c4cefe8c02](https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02)\".",
    "created_at": "2017-09-23T05:03:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[afca2b66e16e33da80a8c43fb0e8576ee08182a2](https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2)" to "[48462ead230b0740fed7b78d2fa349c4cefe8c02](https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02)".



---

archive/issue_comments_138954.json:
```json
{
    "body": "<a id='comment:7'></a>\ngfortran package does not respect `SAGE_INSTALL_GCC=no`, while it should?\nOr, perhaps, there should be `SAGE_INSTALL_GFORTRAN` variable overriding gfortran installation\n\n(I'm trying to build with Intel's ifort compiler, and the 1st obstacle is the need to disable gfortran building...)",
    "created_at": "2017-09-24T22:05:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138954",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
gfortran package does not respect `SAGE_INSTALL_GCC=no`, while it should?
Or, perhaps, there should be `SAGE_INSTALL_GFORTRAN` variable overriding gfortran installation

(I'm trying to build with Intel's ifort compiler, and the 1st obstacle is the need to disable gfortran building...)



---

archive/issue_comments_138955.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes the current setup doesn't allow for alternative fortran compiler at all. gfortran or nothing. So it is not just a matter of not installing, and yes it would need its own variable.\n\nWhat you really need to change is remove lines 477-479 of `configure.ac`. These lines are triggering gfortran build if `GFC` is not yes. `GFC` identifying gnu fortran. Look for `GFC`.",
    "created_at": "2017-09-24T22:12:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138955",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Yes the current setup doesn't allow for alternative fortran compiler at all. gfortran or nothing. So it is not just a matter of not installing, and yes it would need its own variable.

What you really need to change is remove lines 477-479 of `configure.ac`. These lines are triggering gfortran build if `GFC` is not yes. `GFC` identifying gnu fortran. Look for `GFC`.



---

archive/issue_comments_138956.json:
```json
{
    "body": "<a id='comment:399'></a>\nReplying to [fbissey](#comment%3A393):\n> Replying to [jdemeyer](#comment%3A380):\n> > Shouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?\n\n> \n> Tricky. Change in gcc version may or may not be accompanied by incompatible changes in fortran runtime.\n\n\nI see. It is not just about the compiler, but also about the runtime library `gfortran.so`.",
    "created_at": "2017-09-25T07:30:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138956",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:399'></a>
Replying to [fbissey](#comment%3A393):
> Replying to [jdemeyer](#comment%3A380):
> > Shouldn't `gfortran` be an order-only dependency (after the `|` instead of before)?

> 
> Tricky. Change in gcc version may or may not be accompanied by incompatible changes in fortran runtime.


I see. It is not just about the compiler, but also about the runtime library `gfortran.so`.



---

archive/issue_comments_138957.json:
```json
{
    "body": "<a id='comment:400'></a>\nReplying to [jdemeyer](#comment%3A399):\n> I see. It is not just about the compiler, but also about the runtime library `gfortran.so`.\n\n\nExactly.",
    "created_at": "2017-09-25T08:12:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138957",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:400'></a>
Replying to [jdemeyer](#comment%3A399):
> I see. It is not just about the compiler, but also about the runtime library `gfortran.so`.


Exactly.



---

archive/issue_comments_138958.json:
```json
{
    "body": "<a id='comment:401'></a>\nReplying to [fbissey](#comment%3A398):\n> Yes the current setup doesn't allow for alternative fortran compiler at all. gfortran or nothing. So it is not just a matter of not installing, and yes it would need its own variable.\n> \n> What you really need to change is remove lines 477-479 of `configure.ac`. These lines are triggering gfortran build if `GFC` is not yes. `GFC` identifying gnu fortran. Look for `GFC`.\n\n\nThanks. I have opened #23926 to track the work on using other Fortran compilers.",
    "created_at": "2017-09-25T08:43:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138958",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:401'></a>
Replying to [fbissey](#comment%3A398):
> Yes the current setup doesn't allow for alternative fortran compiler at all. gfortran or nothing. So it is not just a matter of not installing, and yes it would need its own variable.
> 
> What you really need to change is remove lines 477-479 of `configure.ac`. These lines are triggering gfortran build if `GFC` is not yes. `GFC` identifying gnu fortran. Look for `GFC`.


Thanks. I have opened #23926 to track the work on using other Fortran compilers.



---

archive/issue_comments_138959.json:
```json
{
    "body": "<a id='comment:2'></a>\nDoes this need #23898 on OSX with Xcode 9?\nI gather yes, as otherwise gfortran cannot be built.",
    "created_at": "2017-10-09T15:28:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138959",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
Does this need #23898 on OSX with Xcode 9?
I gather yes, as otherwise gfortran cannot be built.



---

archive/issue_comments_138960.json:
```json
{
    "body": "<a id='comment:403'></a>\nReplying to [dimpase](#comment%3A402):\n> Does this need #23898 on OSX with Xcode 9?\n> I gather yes, as otherwise gfortran cannot be built.\n\n\nYes, I guess it does need #23898, or at least the gfortran build fails without it. I haven't tried with it yet.",
    "created_at": "2017-10-09T16:32:52Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138960",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:403'></a>
Replying to [dimpase](#comment%3A402):
> Does this need #23898 on OSX with Xcode 9?
> I gather yes, as otherwise gfortran cannot be built.


Yes, I guess it does need #23898, or at least the gfortran build fails without it. I haven't tried with it yet.



---

archive/issue_comments_138961.json:
```json
{
    "body": "<a id='comment:4'></a>\nNow I've tried with and without #23898, and I can confirm that an upgraded GCC is necessary to build gfortran.",
    "created_at": "2017-10-09T19:50:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138961",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Now I've tried with and without #23898, and I can confirm that an upgraded GCC is necessary to build gfortran.



---

archive/issue_comments_138962.json:
```json
{
    "body": "**Changing dependencies** from \"#23922\" to \"#23922, #23898\".",
    "created_at": "2017-10-11T12:23:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138962",
    "user": "https://github.com/dimpase"
}
```

**Changing dependencies** from "#23922" to "#23922, #23898".



---

archive/issue_comments_138963.json:
```json
{
    "body": "<a id='comment:406'></a>\nReplying to [git](#comment%3A396):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe\">235c09e</a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02\">48462ea</a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr></table>\n\n\nwith progress made on #23922, the PR29 eclib patch must be removed.",
    "created_at": "2017-10-11T13:29:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138963",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:406'></a>
Replying to [git](#comment%3A396):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe">235c09e</a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02">48462ea</a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr></table>


with progress made on #23922, the PR29 eclib patch must be removed.



---

archive/issue_comments_138964.json:
```json
{
    "body": "<a id='comment:7'></a>\nCan we decouple fortran issues from this ticket, have it done in this reduced form, and open a new one to get gfortran package in shape? (E.g. for systems that have fortran, e.g. FreeBSD, or perhaps OSX with gfortran from some non-Sage source, fortran is not relevant).",
    "created_at": "2017-10-13T17:04:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138964",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Can we decouple fortran issues from this ticket, have it done in this reduced form, and open a new one to get gfortran package in shape? (E.g. for systems that have fortran, e.g. FreeBSD, or perhaps OSX with gfortran from some non-Sage source, fortran is not relevant).



---

archive/issue_comments_138965.json:
```json
{
    "body": "**Changing commit** from \"[48462ead230b0740fed7b78d2fa349c4cefe8c02](https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02)\" to \"[1c5c98541e843cb021552554825d1027c25a656b](https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b)\".",
    "created_at": "2017-10-21T09:37:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138965",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[48462ead230b0740fed7b78d2fa349c4cefe8c02](https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02)" to "[1c5c98541e843cb021552554825d1027c25a656b](https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b)".



---

archive/issue_comments_138966.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b\">1c5c985</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-10-21T09:37:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138966",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b">1c5c985</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138967.json:
```json
{
    "body": "<a id='comment:409'></a>\nReplying to [dimpase](#comment%3A407):\n> Can we decouple fortran issues from this ticket, have it done in this reduced form, and open a new one to get gfortran package in shape? (E.g. for systems that have fortran, e.g. FreeBSD, or perhaps OSX with gfortran from some non-Sage source, fortran is not relevant).\n\n\nI am not sure I am very eager about this but this can definitely be done. If you think it can be merged quickly, I can separate the gfortran bits. I guess that will help with your \"other fortran\" project.",
    "created_at": "2017-10-21T09:41:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138967",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:409'></a>
Replying to [dimpase](#comment%3A407):
> Can we decouple fortran issues from this ticket, have it done in this reduced form, and open a new one to get gfortran package in shape? (E.g. for systems that have fortran, e.g. FreeBSD, or perhaps OSX with gfortran from some non-Sage source, fortran is not relevant).


I am not sure I am very eager about this but this can definitely be done. If you think it can be merged quickly, I can separate the gfortran bits. I guess that will help with your "other fortran" project.



---

archive/issue_comments_138968.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110\">2f85d6c</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-10-29T22:58:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110">2f85d6c</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138969.json:
```json
{
    "body": "**Changing commit** from \"[1c5c98541e843cb021552554825d1027c25a656b](https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b)\" to \"[2f85d6cb5142fa16a21f6311c4c4bfccf9a08110](https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110)\".",
    "created_at": "2017-10-29T22:58:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1c5c98541e843cb021552554825d1027c25a656b](https://github.com/sagemath/sagetrac-mirror/commit/1c5c98541e843cb021552554825d1027c25a656b)" to "[2f85d6cb5142fa16a21f6311c4c4bfccf9a08110](https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110)".



---

archive/issue_comments_138970.json:
```json
{
    "body": "<a id='comment:1'></a>\nPutting this back in `needs review`. It is a bit late for sage 8.1 I think, but if I think everything is in place for it to be usable and merged at the beginning of 8.2.\n\nThe biggest obstacles are the failing testsuite of `eclib` and `giac`. I should check the new `giac-1.4.x` series, may be the flipping behavior has been fixed - the patch for pari over 2.7 is not needed in that version (admittedly I didn't check compiling against pari 2.7, they may just have changed what they are compiling against internally and fixed accordingly).",
    "created_at": "2017-11-06T21:23:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138970",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Putting this back in `needs review`. It is a bit late for sage 8.1 I think, but if I think everything is in place for it to be usable and merged at the beginning of 8.2.

The biggest obstacles are the failing testsuite of `eclib` and `giac`. I should check the new `giac-1.4.x` series, may be the flipping behavior has been fixed - the patch for pari over 2.7 is not needed in that version (admittedly I didn't check compiling against pari 2.7, they may just have changed what they are compiling against internally and fixed accordingly).



---

archive/issue_events_101964.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-11-06T21:23:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101964"
}
```



---

archive/issue_events_101965.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-11-06T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101965"
}
```



---

archive/issue_comments_138971.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944\">1119be3</a></td><td><code>Remove eclib patch. It conflict with the new merged version of eclib</code></td></tr></table>\n",
    "created_at": "2017-11-07T01:30:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138971",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944">1119be3</a></td><td><code>Remove eclib patch. It conflict with the new merged version of eclib</code></td></tr></table>




---

archive/issue_comments_138972.json:
```json
{
    "body": "**Changing commit** from \"[2f85d6cb5142fa16a21f6311c4c4bfccf9a08110](https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110)\" to \"[1119be3910558c210243d39743e5b55eb6a52944](https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944)\".",
    "created_at": "2017-11-07T01:30:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2f85d6cb5142fa16a21f6311c4c4bfccf9a08110](https://github.com/sagemath/sagetrac-mirror/commit/2f85d6cb5142fa16a21f6311c4c4bfccf9a08110)" to "[1119be3910558c210243d39743e5b55eb6a52944](https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944)".



---

archive/issue_comments_138973.json:
```json
{
    "body": "<a id='comment:3'></a>\nIMHO as long as this is not yet used to build Sage for distributing, we should not worry about doctests failing due to small numerical noise or similar issues (speaking about eclib and giac, that is).",
    "created_at": "2017-11-07T13:00:21Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138973",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
IMHO as long as this is not yet used to build Sage for distributing, we should not worry about doctests failing due to small numerical noise or similar issues (speaking about eclib and giac, that is).



---

archive/issue_comments_138974.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer, John Palmieri, Dima Pasechnik",
    "created_at": "2017-11-07T16:39:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138974",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Jeroen Demeyer, John Palmieri, Dima Pasechnik



---

archive/issue_events_101966.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-11-07T16:39:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101966"
}
```



---

archive/issue_events_101967.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-11-07T16:39:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101967"
}
```



---

archive/issue_comments_138975.json:
```json
{
    "body": "<a id='comment:4'></a>\nWorks for me, on FreeBSD and on OSX. I think it has been reviewed a lot already.",
    "created_at": "2017-11-07T16:39:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138975",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
Works for me, on FreeBSD and on OSX. I think it has been reviewed a lot already.



---

archive/issue_comments_138976.json:
```json
{
    "body": "<a id='comment:415'></a>\nReplying to [dimpase](#comment%3A413):\n> we should not worry about doctests failing due to small numerical noise or similar issues\n\n\nOf course we should. Doctests shouldn't fail.\n\nIn any case, I'd like to test this ticket more before merging it. So far, I have been mostly commenting on the diff without actually testing.",
    "created_at": "2017-11-07T17:01:25Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138976",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:415'></a>
Replying to [dimpase](#comment%3A413):
> we should not worry about doctests failing due to small numerical noise or similar issues


Of course we should. Doctests shouldn't fail.

In any case, I'd like to test this ticket more before merging it. So far, I have been mostly commenting on the diff without actually testing.



---

archive/issue_events_101968.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-11-07T17:01:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101968"
}
```



---

archive/issue_events_101969.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-11-07T17:01:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101969"
}
```



---

archive/issue_comments_138977.json:
```json
{
    "body": "<a id='comment:6'></a>\n> > we should not worry about doctests failing due to small numerical noise or similar issues\n\n> Of course we should. Doctests shouldn't fail.\nArguably I have little to say here, but in the past we have often had one ticket for \"builds\" and another for \"passes tests\" - Cygwin certainly comes to mind.  This is the 416th comment so I think if it builds, it builds.  Then open a new ticket for \"passes tests\".",
    "created_at": "2017-11-07T17:04:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138977",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
> > we should not worry about doctests failing due to small numerical noise or similar issues

> Of course we should. Doctests shouldn't fail.
Arguably I have little to say here, but in the past we have often had one ticket for "builds" and another for "passes tests" - Cygwin certainly comes to mind.  This is the 416th comment so I think if it builds, it builds.  Then open a new ticket for "passes tests".



---

archive/issue_comments_138978.json:
```json
{
    "body": "<a id='comment:417'></a>\nReplying to [kcrisman](#comment%3A416):\n> > > we should not worry about doctests failing due to small numerical noise or similar issues\n\n> > Of course we should. Doctests shouldn't fail.\n> Arguably I have little to say here, but in the past we have often had one ticket for \"builds\" and another for \"passes tests\" - Cygwin certainly comes to mind.  This is the 416th comment so I think if it builds, it builds.  Then open a new ticket for \"passes tests\".\n\n\nYes, that's the right thing to do here, I think. We will open up a follow-up ticket once we have full OSX results (and perhaps Linux results?) for this one.",
    "created_at": "2017-11-07T17:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138978",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:417'></a>
Replying to [kcrisman](#comment%3A416):
> > > we should not worry about doctests failing due to small numerical noise or similar issues

> > Of course we should. Doctests shouldn't fail.
> Arguably I have little to say here, but in the past we have often had one ticket for "builds" and another for "passes tests" - Cygwin certainly comes to mind.  This is the 416th comment so I think if it builds, it builds.  Then open a new ticket for "passes tests".


Yes, that's the right thing to do here, I think. We will open up a follow-up ticket once we have full OSX results (and perhaps Linux results?) for this one.



---

archive/issue_comments_138979.json:
```json
{
    "body": "<a id='comment:8'></a>\nJust to clarify, the issue is not failing doctests (at least for me, `make ptestlong` passes all tests), but Sage packages failing their test suites.",
    "created_at": "2017-11-07T18:19:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138979",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Just to clarify, the issue is not failing doctests (at least for me, `make ptestlong` passes all tests), but Sage packages failing their test suites.



---

archive/issue_comments_138980.json:
```json
{
    "body": "<a id='comment:9'></a>\nThat's exactly where we are: \n* sage doctests pass\n* two standard packages (that would be checked by `SAGE_CHECK=yes`) are failing their testsuite\n* optional packages test suite: unknown but for a few.\n\nOf the two standard packages failing their testsuite:\n* eclib: some results need careful checking, some may be fixed by having some tolerance in the tests.\n* giac: it looks like the problem would be solved by going to 1.4.9-x - I tried yesterday.",
    "created_at": "2017-11-07T19:15:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138980",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
That's exactly where we are: 
* sage doctests pass
* two standard packages (that would be checked by `SAGE_CHECK=yes`) are failing their testsuite
* optional packages test suite: unknown but for a few.

Of the two standard packages failing their testsuite:
* eclib: some results need careful checking, some may be fixed by having some tolerance in the tests.
* giac: it looks like the problem would be solved by going to 1.4.9-x - I tried yesterday.



---

archive/issue_comments_138981.json:
```json
{
    "body": "<a id='comment:0'></a>\nFor the giac upgrade, #24174 is ready for review.",
    "created_at": "2017-11-07T21:39:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138981",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>
For the giac upgrade, #24174 is ready for review.



---

archive/issue_comments_138982.json:
```json
{
    "body": "<a id='comment:1'></a>\nI tried the new giac package from #24174 plus the branch from this ticket, and it passes its test suite for me, too. (This is on two separate OS X machines, one with the current OS and Xcode, one with the previous version of each.)",
    "created_at": "2017-11-08T23:34:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138982",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I tried the new giac package from #24174 plus the branch from this ticket, and it passes its test suite for me, too. (This is on two separate OS X machines, one with the current OS and Xcode, one with the previous version of each.)



---

archive/issue_comments_138983.json:
```json
{
    "body": "<a id='comment:2'></a>\nOnly issue with `giac` may be the optional `giacpy_sage`, but I think it is already currently broken. Other than that and `eclib` it would be great if we could push this for 8.2.beta0.",
    "created_at": "2017-11-08T23:38:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138983",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Only issue with `giac` may be the optional `giacpy_sage`, but I think it is already currently broken. Other than that and `eclib` it would be great if we could push this for 8.2.beta0.



---

archive/issue_comments_138984.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe `eclib` (autocorrected to \"eclair\" which sounds good) issue still looks like numerical noise to me \u2013 [here is my log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20171002.log) \u2013 but other people should check. In any case, I am happy with this. I will let Jeroen test more.",
    "created_at": "2017-11-08T23:46:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138984",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
The `eclib` (autocorrected to "eclair" which sounds good) issue still looks like numerical noise to me ‚Äì [here is my log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20171002.log) ‚Äì but other people should check. In any case, I am happy with this. I will let Jeroen test more.



---

archive/issue_comments_138985.json:
```json
{
    "body": "<a id='comment:424'></a>\nReplying to [jhpalmieri](#comment%3A423):\n> The `eclib` (autocorrected to \"eclair\" which sounds good) issue still looks like numerical noise to me \u2013 [here is my log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20171002.log) \u2013 but other people should check. In any case, I am happy with this. I will let Jeroen test more.\n\n\nThat's because you stop after the first file to \"error\". If you add \"-k\" to the make command in `spkg_check` you'll find some other case that are not so obvious. Still the pure numerical noise could easily be fixed by some subtle C++ formatting and should be done.\nSee https://github.com/JohnCremona/eclib/issues/19#issuecomment-315219838 for a more complete list of errors (the `tmrank` one has been fixed) and I am worried about the stuff generated by `telog` where some of the signs are flipped.",
    "created_at": "2017-11-09T00:30:50Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138985",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:424'></a>
Replying to [jhpalmieri](#comment%3A423):
> The `eclib` (autocorrected to "eclair" which sounds good) issue still looks like numerical noise to me ‚Äì [here is my log file](https://sites.math.washington.edu/~palmieri/Sage/eclib-20171002.log) ‚Äì but other people should check. In any case, I am happy with this. I will let Jeroen test more.


That's because you stop after the first file to "error". If you add "-k" to the make command in `spkg_check` you'll find some other case that are not so obvious. Still the pure numerical noise could easily be fixed by some subtle C++ formatting and should be done.
See https://github.com/JohnCremona/eclib/issues/19#issuecomment-315219838 for a more complete list of errors (the `tmrank` one has been fixed) and I am worried about the stuff generated by `telog` where some of the signs are flipped.



---

archive/issue_comments_138986.json:
```json
{
    "body": "<a id='comment:5'></a>\nWith the patch\n\n```diff\ndiff --git a/build/pkgs/eclib/spkg-check b/build/pkgs/eclib/spkg-check\nindex b22b96310d..0ec9150368 100644\n--- a/build/pkgs/eclib/spkg-check\n+++ b/build/pkgs/eclib/spkg-check\n@@ -11,7 +11,8 @@ cd src\n \n echo\n echo \"Now running eclib's test suite...\"\n-$MAKE check\n+echo \"Running $MAKE -k check\"\n+$MAKE -k check\n if [ $? -ne 0 ]; then\n     echo >&2 \"Error: eclib's test suite failed to pass.\"\n     exit 1\n```\nI see numerical noise plus the following one. Is this the `telog` error you mentioned?\n\n```\n59,61c59,61\n< Periods: [w_1,w_2] = [(-0.51317082433770156405898300169308452073251780098017e-48,-0.63277902985143330237168013012161275230207585428624),(2.0131613909534741204308876218764326959565176646346,-0.31638951492571665118584006506080637615103792714312)]\n< tau       = (0.49999999999999999999999999999999999999999999999742,3.1814603455271474113187811974948516017119213527377) (abs(tau)=3.220510818202869536114214880382970192586945735383)\n< w_R = (4.0263227819069482408617752437528653919130353292697,0)\tw_IR = (2.0131613909534741204308876218764326959565176646351,0.31638951492571665118584006506080637615103792714312)\n---\n> Periods: [w_1,w_2] = [(0,0.6327790298514333023716801301216127523020758542864),(-2.0131613909534741204308876218764326959565176646351,-0.3163895149257166511858400650608063761510379271432)]\n> tau       = (-0.5,3.1814603455271474113187811974948516017119213527374) (abs(tau)=3.2205108182028695361142148803829701925869457353831)\n> w_R = (4.0263227819069482408617752437528653919130353292703,0)\tw_IR = (2.0131613909534741204308876218764326959565176646351,0.3163895149257166511858400650608063761510379271432)\n```",
    "created_at": "2017-11-09T04:31:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138986",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
With the patch

```diff
diff --git a/build/pkgs/eclib/spkg-check b/build/pkgs/eclib/spkg-check
index b22b96310d..0ec9150368 100644
--- a/build/pkgs/eclib/spkg-check
+++ b/build/pkgs/eclib/spkg-check
@@ -11,7 +11,8 @@ cd src
 
 echo
 echo "Now running eclib's test suite..."
-$MAKE check
+echo "Running $MAKE -k check"
+$MAKE -k check
 if [ $? -ne 0 ]; then
     echo >&2 "Error: eclib's test suite failed to pass."
     exit 1
```
I see numerical noise plus the following one. Is this the `telog` error you mentioned?

```
59,61c59,61
< Periods: [w_1,w_2] = [(-0.51317082433770156405898300169308452073251780098017e-48,-0.63277902985143330237168013012161275230207585428624),(2.0131613909534741204308876218764326959565176646346,-0.31638951492571665118584006506080637615103792714312)]
< tau       = (0.49999999999999999999999999999999999999999999999742,3.1814603455271474113187811974948516017119213527377) (abs(tau)=3.220510818202869536114214880382970192586945735383)
< w_R = (4.0263227819069482408617752437528653919130353292697,0)	w_IR = (2.0131613909534741204308876218764326959565176646351,0.31638951492571665118584006506080637615103792714312)
---
> Periods: [w_1,w_2] = [(0,0.6327790298514333023716801301216127523020758542864),(-2.0131613909534741204308876218764326959565176646351,-0.3163895149257166511858400650608063761510379271432)]
> tau       = (-0.5,3.1814603455271474113187811974948516017119213527374) (abs(tau)=3.2205108182028695361142148803829701925869457353831)
> w_R = (4.0263227819069482408617752437528653919130353292703,0)	w_IR = (2.0131613909534741204308876218764326959565176646351,0.3163895149257166511858400650608063761510379271432)
```



---

archive/issue_comments_138987.json:
```json
{
    "body": "<a id='comment:6'></a>\nYes. Some of it is still numerical noise plus sign flip-flopping.",
    "created_at": "2017-11-09T04:58:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138987",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Yes. Some of it is still numerical noise plus sign flip-flopping.



---

archive/issue_comments_138988.json:
```json
{
    "body": "<a id='comment:427'></a>\nReplying to [kcrisman](#comment%3A416):\n> Arguably I have little to say here, but in the past we have often had one ticket for \"builds\" and another for \"passes tests\" - Cygwin certainly comes to mind.\n\n\nThat was for supporting \"new\" systems for which there was previously no support. Here, we are talking about changing things for a system on which Sage already \"passes tests\". So going from \"passes tests\" to \"builds\" would be a regression.",
    "created_at": "2017-11-09T09:04:28Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138988",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:427'></a>
Replying to [kcrisman](#comment%3A416):
> Arguably I have little to say here, but in the past we have often had one ticket for "builds" and another for "passes tests" - Cygwin certainly comes to mind.


That was for supporting "new" systems for which there was previously no support. Here, we are talking about changing things for a system on which Sage already "passes tests". So going from "passes tests" to "builds" would be a regression.



---

archive/issue_comments_138989.json:
```json
{
    "body": "<a id='comment:428'></a>\nReplying to [jdemeyer](#comment%3A427):\n> Replying to [kcrisman](#comment%3A416):\n> > Arguably I have little to say here, but in the past we have often had one ticket for \"builds\" and another for \"passes tests\" - Cygwin certainly comes to mind.\n\n> \n> That was for supporting \"new\" systems for which there was previously no support. Here, we are talking about changing things for a system on which Sage already \"passes tests\". So going from \"passes tests\" to \"builds\" would be a regression.\n\n\nwell, arguably clang support is needed to resurrect the freebsd port, perhaps  for dragonbsd support as well. so this is new.\n\nas well, as long as clang is not the default way to build Sage on a system, one should not insist on passing all the tests on this system, right?",
    "created_at": "2017-11-09T09:24:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138989",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:428'></a>
Replying to [jdemeyer](#comment%3A427):
> Replying to [kcrisman](#comment%3A416):
> > Arguably I have little to say here, but in the past we have often had one ticket for "builds" and another for "passes tests" - Cygwin certainly comes to mind.

> 
> That was for supporting "new" systems for which there was previously no support. Here, we are talking about changing things for a system on which Sage already "passes tests". So going from "passes tests" to "builds" would be a regression.


well, arguably clang support is needed to resurrect the freebsd port, perhaps  for dragonbsd support as well. so this is new.

as well, as long as clang is not the default way to build Sage on a system, one should not insist on passing all the tests on this system, right?



---

archive/issue_comments_138990.json:
```json
{
    "body": "<a id='comment:9'></a>\n> as well, as long as clang is not the default way to build Sage on a system, one should not insist on passing all the tests on this system, right?\n\n\nExactly my thinking.  Of course if clang becomes default on OS X that is a very different thing.",
    "created_at": "2017-11-09T14:56:41Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138990",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
> as well, as long as clang is not the default way to build Sage on a system, one should not insist on passing all the tests on this system, right?


Exactly my thinking.  Of course if clang becomes default on OS X that is a very different thing.



---

archive/issue_comments_138991.json:
```json
{
    "body": "<a id='comment:430'></a>\nReplying to [kcrisman](#comment%3A429):\n> Of course if clang becomes default on OS X that is a very different thing.\n\n\nCorrect me if I'm wrong, but isn't that part of what this ticket does?",
    "created_at": "2017-11-09T19:28:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138991",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:430'></a>
Replying to [kcrisman](#comment%3A429):
> Of course if clang becomes default on OS X that is a very different thing.


Correct me if I'm wrong, but isn't that part of what this ticket does?



---

archive/issue_comments_138992.json:
```json
{
    "body": "<a id='comment:431'></a>\nReplying to [dimpase](#comment%3A428):\n> as long as clang is not the default way to build Sage on a system\n\n\nCorrect me again if I'm wrong, but this ticket *does* make Clang the default in the sense that GCC won't be installed if Clang is installed.",
    "created_at": "2017-11-09T19:50:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138992",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:431'></a>
Replying to [dimpase](#comment%3A428):
> as long as clang is not the default way to build Sage on a system


Correct me again if I'm wrong, but this ticket *does* make Clang the default in the sense that GCC won't be installed if Clang is installed.



---

archive/issue_comments_138993.json:
```json
{
    "body": "<a id='comment:2'></a>\nAnd if I'm wrong on any of the two points I just mentioned, it would be good if somebody could update the ticket description to explain precisely what this ticket does.",
    "created_at": "2017-11-09T19:53:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138993",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
And if I'm wrong on any of the two points I just mentioned, it would be good if somebody could update the ticket description to explain precisely what this ticket does.



---

archive/issue_events_101970.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-11-09T20:24:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "rename": {
        "from": "Make Sage build with clang (3.7+)",
        "to": "Make Sage build with clang (3.7+) and make it the default on OS X"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101970"
}
```



---

archive/issue_comments_138994.json:
```json
{
    "body": "<a id='comment:3'></a>\nYou are quite correct. In fact this is better/worse than that. Any compiler C/C++ compiler that is properly detected by `AC_PROG_CC` and `AC_PROG_CXX` and sets the autoconf variable `GCC` to yes, can and will be used. It could be limited to clang but I think it is better to open up a bit. Other compilers are not the default on \"normal\" systems.\n\nSo, in the absence of a working gcc/g++, if clang/clang++ is present and working, it will be used. In the case of OS X where `/usr/bin/gcc` is a wrapper to clang, it will be used. Unless someone overrides it.\n\nUnless the variables CC/CXX are set, gcc will be tested first. Because of the fact on OS X, xcode installs `usr/bin/gcc` that means changing the default on OS X that's absolutely correct. If you hadn't given any thoughts to it, Jeroen just put your nose in it. I should add that when I took over this ticket it was quite clear to me that it was the objective because gcc keep getting broken in funny ways, which means we do things that end up having unintended consequences. That and the fact that building gcc is probably the package that take the longest to build on OS X.\n\nI make no bones or apologies about the fact that this ticket makes clang the default on OS X.\n\nI am updating the description and title. Also I think the ticket is not \"meta\" anymore.\n\nThe status is doctests pass and all standard packages' testsuite pass except for two (one with an extra ticket). Is it good enough to change the default now? My impression is that the people using OS X are quite happy with the deal but it will trigger buildbot failures unless we do something about `eclib`'s testsuite.",
    "created_at": "2017-11-09T20:24:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138994",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
You are quite correct. In fact this is better/worse than that. Any compiler C/C++ compiler that is properly detected by `AC_PROG_CC` and `AC_PROG_CXX` and sets the autoconf variable `GCC` to yes, can and will be used. It could be limited to clang but I think it is better to open up a bit. Other compilers are not the default on "normal" systems.

So, in the absence of a working gcc/g++, if clang/clang++ is present and working, it will be used. In the case of OS X where `/usr/bin/gcc` is a wrapper to clang, it will be used. Unless someone overrides it.

Unless the variables CC/CXX are set, gcc will be tested first. Because of the fact on OS X, xcode installs `usr/bin/gcc` that means changing the default on OS X that's absolutely correct. If you hadn't given any thoughts to it, Jeroen just put your nose in it. I should add that when I took over this ticket it was quite clear to me that it was the objective because gcc keep getting broken in funny ways, which means we do things that end up having unintended consequences. That and the fact that building gcc is probably the package that take the longest to build on OS X.

I make no bones or apologies about the fact that this ticket makes clang the default on OS X.

I am updating the description and title. Also I think the ticket is not "meta" anymore.

The status is doctests pass and all standard packages' testsuite pass except for two (one with an extra ticket). Is it good enough to change the default now? My impression is that the people using OS X are quite happy with the deal but it will trigger buildbot failures unless we do something about `eclib`'s testsuite.



---

archive/issue_comments_138995.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n-Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.\n+Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.\n \n ---\n \n Packages failing their tests\n * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19\n-* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang\n+* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang fixed by #24174\n * `ccache` #22836\n \n ---\n``````\n",
    "created_at": "2017-11-09T20:24:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138995",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
-Apple stopped supporting GCC in favour of clang. This is a metaticket to track the status of building Sage with clang.
+Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.
 
 ---
 
 Packages failing their tests
 * `eclib`, reported upstream at https://github.com/JohnCremona/eclib/issues/19
-* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang
+* `giac` - patch to pass tests with gcc/pari-2.8+ causes failures with clang fixed by #24174
 * `ccache` #22836
 
 ---
``````




---

archive/issue_comments_138996.json:
```json
{
    "body": "**Changing commit** from \"[1119be3910558c210243d39743e5b55eb6a52944](https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944)\" to \"[59910fb3f4265da8ffe8ee34376b5f96da776e71](https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71)\".",
    "created_at": "2017-12-11T00:46:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138996",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1119be3910558c210243d39743e5b55eb6a52944](https://github.com/sagemath/sagetrac-mirror/commit/1119be3910558c210243d39743e5b55eb6a52944)" to "[59910fb3f4265da8ffe8ee34376b5f96da776e71](https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71)".



---

archive/issue_comments_138997.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71\">59910fb</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-12-11T00:46:36Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138997",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71">59910fb</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_138998.json:
```json
{
    "body": "<a id='comment:5'></a>\n`eclib` is a tough nut to crack because it appears the precision is not as good as the original design may have expected it to be. Error handling and propagation is a difficult business and the use of clang just uncovered it. In some of tests we have 45 digits of precision instead of the expected 50 for example. Not a big deal for most numerical applications but not good when your tests expect 50 digits to be correct. And increasing precision can cause the sign flip flop when quantities are close to (or actually should be) `0`.",
    "created_at": "2017-12-14T21:54:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138998",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
`eclib` is a tough nut to crack because it appears the precision is not as good as the original design may have expected it to be. Error handling and propagation is a difficult business and the use of clang just uncovered it. In some of tests we have 45 digits of precision instead of the expected 50 for example. Not a big deal for most numerical applications but not good when your tests expect 50 digits to be correct. And increasing precision can cause the sign flip flop when quantities are close to (or actually should be) `0`.



---

archive/issue_comments_138999.json:
```json
{
    "body": "<a id='comment:6'></a>\nCan we have an update to the current beta?",
    "created_at": "2017-12-29T08:35:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-138999",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Can we have an update to the current beta?



---

archive/issue_comments_139000.json:
```json
{
    "body": "**Changing commit** from \"[59910fb3f4265da8ffe8ee34376b5f96da776e71](https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71)\" to \"[632b7bc35289a12a419c691d4debd947b59f47b6](https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6)\".",
    "created_at": "2017-12-29T08:38:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139000",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[59910fb3f4265da8ffe8ee34376b5f96da776e71](https://github.com/sagemath/sagetrac-mirror/commit/59910fb3f4265da8ffe8ee34376b5f96da776e71)" to "[632b7bc35289a12a419c691d4debd947b59f47b6](https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6)".



---

archive/issue_comments_139001.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6\">632b7bc</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2017-12-29T08:38:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6">632b7bc</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_139002.json:
```json
{
    "body": "<a id='comment:438'></a>\nReplying to [dimpase](#comment%3A436):\n> Can we have an update to the current beta?\n\n\nI guess that's what you wanted.",
    "created_at": "2017-12-29T08:45:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139002",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:438'></a>
Replying to [dimpase](#comment%3A436):
> Can we have an update to the current beta?


I guess that's what you wanted.



---

archive/issue_comments_139003.json:
```json
{
    "body": "<a id='comment:9'></a>\nWe have access to a 24-core OSX server now. This should be useful for this ticket :-)",
    "created_at": "2017-12-29T09:26:48Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139003",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
We have access to a 24-core OSX server now. This should be useful for this ticket :-)



---

archive/issue_comments_139004.json:
```json
{
    "body": "<a id='comment:0'></a>\nwith SAGE_INSTALL_GCC=no, I get\n\n```\nconfigure: error: SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing\n```\nwithout it, gcc spkg gets installed, and then gfortran spkg install fails with \"gcc already installed\".",
    "created_at": "2017-12-29T14:50:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139004",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
with SAGE_INSTALL_GCC=no, I get

```
configure: error: SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing
```
without it, gcc spkg gets installed, and then gfortran spkg install fails with "gcc already installed".



---

archive/issue_comments_139005.json:
```json
{
    "body": "<a id='comment:1'></a>\nspecifically, in configure I get\n\n```\nac_ext=${ac_fc_srcext-f}\nac_compile='$FC -c $FCFLAGS $ac_fcflags_srcext conftest.$ac_ext >&5'\nac_link='$FC -o conftest$ac_exeext $FCFLAGS $LDFLAGS $ac_fcflags_srcext conftest.$ac_ext $LIBS >&5'\nac_compiler_gnu=$ac_cv_fc_compiler_gnu\n\nif test -z \"$FC\"; then\n\n    if test x$SAGE_INSTALL_GCC = xexists; then\n        true  # Do nothing if already installed\n    elif test x$SAGE_INSTALL_GCC = xno; then\n        as_fn_error $? \"SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing\" \"$LINENO\" 5\n    else\n        { $as_echo \"$as_me:${as_lineno-$LINENO}: Installing GCC because a Fortran compiler is missing\" >&5\n$as_echo \"$as_me: Installing GCC because a Fortran compiler is missing\" >&6;}\n        need_to_install_gcc=yes\n    fi\n\nelse\n   # see http://www.gnu.org/software/hello/manual/autoconf/Fortran-Compiler.html\n\n```\nbut I don't understand how `as_fn_error $? \"SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing\" \"$LINENO\" 5` \nis generated from configure.ac. I presume it comes from expansion of\n\n```\nAC_LANG(Fortran)\nif test -z \"$FC\"; then\n    need_to_install_gfortran=yes\nelse\n   # see http://www.gnu.org/software/hello/manual/autoconf/Fortran-Compiler.html\n```\nbut how?",
    "created_at": "2017-12-29T22:50:03Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139005",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
specifically, in configure I get

```
ac_ext=${ac_fc_srcext-f}
ac_compile='$FC -c $FCFLAGS $ac_fcflags_srcext conftest.$ac_ext >&5'
ac_link='$FC -o conftest$ac_exeext $FCFLAGS $LDFLAGS $ac_fcflags_srcext conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_fc_compiler_gnu

if test -z "$FC"; then

    if test x$SAGE_INSTALL_GCC = xexists; then
        true  # Do nothing if already installed
    elif test x$SAGE_INSTALL_GCC = xno; then
        as_fn_error $? "SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing" "$LINENO" 5
    else
        { $as_echo "$as_me:${as_lineno-$LINENO}: Installing GCC because a Fortran compiler is missing" >&5
$as_echo "$as_me: Installing GCC because a Fortran compiler is missing" >&6;}
        need_to_install_gcc=yes
    fi

else
   # see http://www.gnu.org/software/hello/manual/autoconf/Fortran-Compiler.html

```
but I don't understand how `as_fn_error $? "SAGE_INSTALL_GCC is set to 'no', but a Fortran compiler is missing" "$LINENO" 5` 
is generated from configure.ac. I presume it comes from expansion of

```
AC_LANG(Fortran)
if test -z "$FC"; then
    need_to_install_gfortran=yes
else
   # see http://www.gnu.org/software/hello/manual/autoconf/Fortran-Compiler.html
```
but how?



---

archive/issue_comments_139006.json:
```json
{
    "body": "<a id='comment:2'></a>\nMore frustrating is that even though replacing `as_fn_error ...` in the previous comment with `true` allows the build with clang to complete,\nby doing \n\n```\n$ SAGE_INSTALL_GCC=\"no\" ./configure CC=cc CXX=c++\n$ make \n```\n\n a subsequent, say, `./sage -f r` starts a full build of gcc. Arrrgh, that gcc virus. I see\n\n```\n...\nenv SAGE_BUILD_TOOLCHAIN=yes make toolchain\nsage-logger -p 'sage-spkg gcc-7.2.0' '/Users/dimpase/Sage/sagetrac-mirror/logs/pkgs/gcc-7.2.0.log'\n[gcc-7.2.0] Found local metadata for gcc-7.2.0\n[gcc-7.2.0] Using cached file /Users/dimpase/Sage/sagetrac-mirror/upstream/gcc-7.2.0.tar.xz\n...\n```\n\nI never heard of `SAGE_BUILD_TOOLCHAIN`...",
    "created_at": "2017-12-30T07:07:34Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139006",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
More frustrating is that even though replacing `as_fn_error ...` in the previous comment with `true` allows the build with clang to complete,
by doing 

```
$ SAGE_INSTALL_GCC="no" ./configure CC=cc CXX=c++
$ make 
```

 a subsequent, say, `./sage -f r` starts a full build of gcc. Arrrgh, that gcc virus. I see

```
...
env SAGE_BUILD_TOOLCHAIN=yes make toolchain
sage-logger -p 'sage-spkg gcc-7.2.0' '/Users/dimpase/Sage/sagetrac-mirror/logs/pkgs/gcc-7.2.0.log'
[gcc-7.2.0] Found local metadata for gcc-7.2.0
[gcc-7.2.0] Using cached file /Users/dimpase/Sage/sagetrac-mirror/upstream/gcc-7.2.0.tar.xz
...
```

I never heard of `SAGE_BUILD_TOOLCHAIN`...



---

archive/issue_comments_139007.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK, the latter problem is that the gcc build was still loaded via `configure.ac`'s\n\n```\nAS_ECHO_N(>&7 ['TOOLCHAIN = $(inst_gcc)'])\n```\nand this got through into the build system.\n\n---\n\nIt looks as if either the `TOOLCHAIN` business is obsolete and ought to be removed, or it needs to be updated\nto the case of the use of clang (i.e. it would be `'TOOLCHAIN = $(inst_gfortran)'`).\n(I don't know its purpose anyway, and it does not seem to be documented).",
    "created_at": "2017-12-30T07:17:46Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139007",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
OK, the latter problem is that the gcc build was still loaded via `configure.ac`'s

```
AS_ECHO_N(>&7 ['TOOLCHAIN = $(inst_gcc)'])
```
and this got through into the build system.

---

It looks as if either the `TOOLCHAIN` business is obsolete and ought to be removed, or it needs to be updated
to the case of the use of clang (i.e. it would be `'TOOLCHAIN = $(inst_gfortran)'`).
(I don't know its purpose anyway, and it does not seem to be documented).



---

archive/issue_comments_139008.json:
```json
{
    "body": "<a id='comment:4'></a>\nSorry to have gone dark on you. I will inspect all that with a fresh mind sometime tomorrow.",
    "created_at": "2018-01-02T03:44:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139008",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
Sorry to have gone dark on you. I will inspect all that with a fresh mind sometime tomorrow.



---

archive/issue_comments_139009.json:
```json
{
    "body": "**Changing commit** from \"[632b7bc35289a12a419c691d4debd947b59f47b6](https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6)\" to \"[8845edbb76a84f3323cf27a2600b687ed57cf57a](https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a)\".",
    "created_at": "2018-01-02T07:46:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[632b7bc35289a12a419c691d4debd947b59f47b6](https://github.com/sagemath/sagetrac-mirror/commit/632b7bc35289a12a419c691d4debd947b59f47b6)" to "[8845edbb76a84f3323cf27a2600b687ed57cf57a](https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a)".



---

archive/issue_comments_139010.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a\">8845edb</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>\n",
    "created_at": "2018-01-02T07:46:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a">8845edb</a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr></table>




---

archive/issue_comments_139011.json:
```json
{
    "body": "<a id='comment:6'></a>\nI checked the `TOOLCHAIN` business and I believe it is all correct. `TOOLCHAIN` can be set to `$(inst_gcc)` only when gcc needs to be built - if you use ccache, I think it is added there too. If it is still set when gcc doesn't need to be built there is definitely a bug somewhere in the configure script. Are you sure you have run `./bootstrap` before configuring?",
    "created_at": "2018-01-04T20:57:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139011",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
I checked the `TOOLCHAIN` business and I believe it is all correct. `TOOLCHAIN` can be set to `$(inst_gcc)` only when gcc needs to be built - if you use ccache, I think it is added there too. If it is still set when gcc doesn't need to be built there is definitely a bug somewhere in the configure script. Are you sure you have run `./bootstrap` before configuring?



---

archive/issue_comments_139012.json:
```json
{
    "body": "<a id='comment:7'></a>\nI did run `bootstrap -d`. Not sure if the downloaded configure tarball is the correct one. I tried to build autotools our of the tree, but it complains about old `m4`. And I cannot build `m4` - it builds, but crashes with `Illegal instruction: 4`. Arrgh...\n\nHow does one create the configure tarball for downloading?",
    "created_at": "2018-01-05T09:34:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139012",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
I did run `bootstrap -d`. Not sure if the downloaded configure tarball is the correct one. I tried to build autotools our of the tree, but it complains about old `m4`. And I cannot build `m4` - it builds, but crashes with `Illegal instruction: 4`. Arrgh...

How does one create the configure tarball for downloading?



---

archive/issue_comments_139013.json:
```json
{
    "body": "<a id='comment:448'></a>\nReplying to [dimpase](#comment%3A447):\n> I did run `bootstrap -d`. Not sure if the downloaded configure tarball is the correct one. I tried to build autotools our of the tree, but it complains about old `m4`. And I cannot build `m4` - it builds, but crashes with `Illegal instruction: 4`. Arrgh...\n> \n> How does one create the configure tarball for downloading?\n\n\nUsually `./bootstrap -s -i`. The `-i` increase the version number. Just `autoreconf -i` does the job. Not sure about the problem with the autotool spkg.",
    "created_at": "2018-01-05T09:57:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139013",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:448'></a>
Replying to [dimpase](#comment%3A447):
> I did run `bootstrap -d`. Not sure if the downloaded configure tarball is the correct one. I tried to build autotools our of the tree, but it complains about old `m4`. And I cannot build `m4` - it builds, but crashes with `Illegal instruction: 4`. Arrgh...
> 
> How does one create the configure tarball for downloading?


Usually `./bootstrap -s -i`. The `-i` increase the version number. Just `autoreconf -i` does the job. Not sure about the problem with the autotool spkg.



---

archive/issue_comments_139014.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe `git log` here is insane. Allow me to squash it...",
    "created_at": "2018-01-05T11:12:05Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139014",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
The `git log` here is insane. Allow me to squash it...



---

archive/issue_comments_139015.json:
```json
{
    "body": "**Changing branch** from \"[u/fbissey/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-progress)\" to \"[u/jdemeyer/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/clang-progress)\".",
    "created_at": "2018-01-05T11:14:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139015",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/fbissey/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/clang-progress)" to "[u/jdemeyer/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/clang-progress)".



---

archive/issue_comments_139016.json:
```json
{
    "body": "**Changing commit** from \"[8845edbb76a84f3323cf27a2600b687ed57cf57a](https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a)\" to \"[d3d8317f587c63a571e14ffd0acc05d3171ea435](https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435)\".",
    "created_at": "2018-01-05T11:16:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8845edbb76a84f3323cf27a2600b687ed57cf57a](https://github.com/sagemath/sagetrac-mirror/commit/8845edbb76a84f3323cf27a2600b687ed57cf57a)" to "[d3d8317f587c63a571e14ffd0acc05d3171ea435](https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435)".



---

archive/issue_comments_139017.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435\">d3d8317</a></td><td><code>New configure tarball</code></td></tr></table>\n",
    "created_at": "2018-01-05T11:16:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435">d3d8317</a></td><td><code>New configure tarball</code></td></tr></table>




---

archive/issue_comments_139018.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.\n+\n+**Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz\n \n ---\n \n``````\n",
    "created_at": "2018-01-05T11:17:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139018",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.
+
+**Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz
 
 ---
 
``````




---

archive/issue_comments_139019.json:
```json
{
    "body": "**Changing dependencies** from \"#23922, #23898\" to \"\".",
    "created_at": "2018-01-05T11:17:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139019",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#23922, #23898" to "".



---

archive/issue_comments_139020.json:
```json
{
    "body": "<a id='comment:454'></a>\nReplying to [dimpase](#comment%3A447):\n> How does one create the configure tarball for downloading?\n\n\nI just did that for you :-)",
    "created_at": "2018-01-05T11:19:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139020",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:454'></a>
Replying to [dimpase](#comment%3A447):
> How does one create the configure tarball for downloading?


I just did that for you :-)



---

archive/issue_comments_139021.json:
```json
{
    "body": "<a id='comment:5'></a>\nOK, so configure tarball was the culprit. Once I installed autotools out of the tree, \nwhile using the system-provided m4, I was able to run `./bootstrap`, and build with clang just fine.\n\nSage's autotools package is broken: it tries building its own `m4`, but it does not work:\n\n```\nbash-3.2$ ls -l local/bin/m4\n-rwxr-xr-x  1 dimpase  staff  293092 Jan  5 14:14 local/bin/m4\nbash-3.2$ ./local/bin/m4\nIllegal instruction: 4\n```\nand then unsurprisingly one gets\n\n```\n...\nsed -e 's,@''datadir''@,/Users/dimpase/Sage/sagetrac-mirror/local/autoconf-2.13.rc1/share/autoconf,g' -e 's,@''PERL''@,/usr/bin/perl,g' autoscan.pl > autoscan.tmp && chmod +x autoscan.tmp && mv autoscan.tmp autoscan\nError: Autoconf requires GNU m4 1.1 or later\nmake[3]: *** [autoconf.m4f] Error 1\nmake[2]: *** [/Users/dimpase/Sage/sagetrac-mirror/local/autoconf-2.13.rc1] Error 2\n```",
    "created_at": "2018-01-05T13:26:58Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139021",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
OK, so configure tarball was the culprit. Once I installed autotools out of the tree, 
while using the system-provided m4, I was able to run `./bootstrap`, and build with clang just fine.

Sage's autotools package is broken: it tries building its own `m4`, but it does not work:

```
bash-3.2$ ls -l local/bin/m4
-rwxr-xr-x  1 dimpase  staff  293092 Jan  5 14:14 local/bin/m4
bash-3.2$ ./local/bin/m4
Illegal instruction: 4
```
and then unsurprisingly one gets

```
...
sed -e 's,@''datadir''@,/Users/dimpase/Sage/sagetrac-mirror/local/autoconf-2.13.rc1/share/autoconf,g' -e 's,@''PERL''@,/usr/bin/perl,g' autoscan.pl > autoscan.tmp && chmod +x autoscan.tmp && mv autoscan.tmp autoscan
Error: Autoconf requires GNU m4 1.1 or later
make[3]: *** [autoconf.m4f] Error 1
make[2]: *** [/Users/dimpase/Sage/sagetrac-mirror/local/autoconf-2.13.rc1] Error 2
```



---

archive/issue_comments_139022.json:
```json
{
    "body": "**Dependencies:** #24476",
    "created_at": "2018-01-05T13:55:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139022",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #24476



---

archive/issue_comments_139023.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -28,9 +28,3 @@\n CC=clang CXX=clang++ make\n ```\n on OS where clang is not the default compiler [it should also work on OS X].\n-\n-If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.\n-\n----\n-\n-Special instructions for the release manager: In the upstream mirror for spkg a link called `gfortran` and pointing to the `gcc` folder must be created.\n``````\n",
    "created_at": "2018-01-05T13:55:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139023",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -28,9 +28,3 @@
 CC=clang CXX=clang++ make
 ```
 on OS where clang is not the default compiler [it should also work on OS X].
-
-If you start from a clone rather than a tarball, be sure to also download the gcc tarball to the `upstream` folder first before letting the bootstrap try to download from an nonexistent gfortran folder in the upstream repo.
-
----
-
-Special instructions for the release manager: In the upstream mirror for spkg a link called `gfortran` and pointing to the `gcc` folder must be created.
``````




---

archive/issue_comments_139024.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b8e8ddf7a67bd062fa67c89d2b140b4846549d4\">5b8e8dd</a></td><td><code>Support downloading of symlinked tarballs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ece103830d2024b35c22640439b9d97619820fc\">5ece103</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4\">e08f902</a></td><td><code>New configure tarball</code></td></tr></table>\n",
    "created_at": "2018-01-05T14:15:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139024",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b8e8ddf7a67bd062fa67c89d2b140b4846549d4">5b8e8dd</a></td><td><code>Support downloading of symlinked tarballs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ece103830d2024b35c22640439b9d97619820fc">5ece103</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4">e08f902</a></td><td><code>New configure tarball</code></td></tr></table>




---

archive/issue_comments_139025.json:
```json
{
    "body": "**Changing commit** from \"[d3d8317f587c63a571e14ffd0acc05d3171ea435](https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435)\" to \"[e08f90287e9edfe06a97626196c78bbcdbeaa0a4](https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4)\".",
    "created_at": "2018-01-05T14:15:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d3d8317f587c63a571e14ffd0acc05d3171ea435](https://github.com/sagemath/sagetrac-mirror/commit/d3d8317f587c63a571e14ffd0acc05d3171ea435)" to "[e08f90287e9edfe06a97626196c78bbcdbeaa0a4](https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4)".



---

archive/issue_comments_139026.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,18 @@\n Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.\n \n **Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz\n+\n+**Testing**: checkout the attached branch, download the configure tarball (see above) and tun\n+\n+```\n+make\n+```\n+on OS X, or \n+\n+```\n+CC=clang CXX=clang++ make\n+```\n+on any OS.\n \n ---\n \n@@ -14,17 +26,3 @@\n Supporting clang not only on OSX:\n \n * porting to clang/FreeBSD -- #22679\n-\n----\n-\n-Testing: merge the attached branch, run `autoreconf` and build with\n-\n-```\n-make\n-```\n-on OS X, or \n-\n-```\n-CC=clang CXX=clang++ make\n-```\n-on OS where clang is not the default compiler [it should also work on OS X].\n``````\n",
    "created_at": "2018-01-05T15:00:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139026",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,18 @@
 Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.
 
 **Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz
+
+**Testing**: checkout the attached branch, download the configure tarball (see above) and tun
+
+```
+make
+```
+on OS X, or 
+
+```
+CC=clang CXX=clang++ make
+```
+on any OS.
 
 ---
 
@@ -14,17 +26,3 @@
 Supporting clang not only on OSX:
 
 * porting to clang/FreeBSD -- #22679
-
----
-
-Testing: merge the attached branch, run `autoreconf` and build with
-
-```
-make
-```
-on OS X, or 
-
-```
-CC=clang CXX=clang++ make
-```
-on OS where clang is not the default compiler [it should also work on OS X].
``````




---

archive/issue_comments_139027.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n **Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz\n \n-**Testing**: checkout the attached branch, download the configure tarball (see above) and tun\n+**Testing**: checkout the attached branch, download the configure tarball (see above) and run\n \n ```\n make\n``````\n",
    "created_at": "2018-01-05T16:21:10Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139027",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 **Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz
 
-**Testing**: checkout the attached branch, download the configure tarball (see above) and tun
+**Testing**: checkout the attached branch, download the configure tarball (see above) and run
 
 ```
 make
``````




---

archive/issue_comments_139028.json:
```json
{
    "body": "**Changing commit** from \"[e08f90287e9edfe06a97626196c78bbcdbeaa0a4](https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4)\" to \"[b4d3067b5666bfa5f2208e8405d7cec4706e3738](https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738)\".",
    "created_at": "2018-01-05T18:08:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e08f90287e9edfe06a97626196c78bbcdbeaa0a4](https://github.com/sagemath/sagetrac-mirror/commit/e08f90287e9edfe06a97626196c78bbcdbeaa0a4)" to "[b4d3067b5666bfa5f2208e8405d7cec4706e3738](https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738)".



---

archive/issue_comments_139029.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738\">b4d3067</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>\n",
    "created_at": "2018-01-05T18:08:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738">b4d3067</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>




---

archive/issue_comments_139030.json:
```json
{
    "body": "<a id='comment:1'></a>\nOn `Darwin osx 16.7.0 Darwin Kernel Version 16.7.0: Mon Nov 13 21:56:25 PST 2017; root:xnu-3789.72.11~1/RELEASE_X86_64 x86_64`:\n\n```\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 6444.0 seconds\n    cpu time: 33345.3 seconds\n    cumulative wall time: 48795.6 seconds\n```\n\nSo I think that this ticket is good to go.",
    "created_at": "2018-01-05T19:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139030",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
On `Darwin osx 16.7.0 Darwin Kernel Version 16.7.0: Mon Nov 13 21:56:25 PST 2017; root:xnu-3789.72.11~1/RELEASE_X86_64 x86_64`:

```
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 6444.0 seconds
    cpu time: 33345.3 seconds
    cumulative wall time: 48795.6 seconds
```

So I think that this ticket is good to go.



---

archive/issue_comments_139031.json:
```json
{
    "body": "<a id='comment:2'></a>\nThanks Jeroen, a few interesting things in there I wouldn't have thought about. So you think it can go in spite of eclib's test suite breaking? Upstream has a fix getting ready for that but I understand changes will be needed sage side to match.",
    "created_at": "2018-01-05T19:11:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139031",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
Thanks Jeroen, a few interesting things in there I wouldn't have thought about. So you think it can go in spite of eclib's test suite breaking? Upstream has a fix getting ready for that but I understand changes will be needed sage side to match.



---

archive/issue_comments_139032.json:
```json
{
    "body": "<a id='comment:3'></a>\nI've checked that `FC=gfortran6`  can be provided on FreeBSD.\n\nOne more thing for a followup ticket: sort out the case of /bin/sh not being  bash (as on FreeBSD) and running with bash as the SHELL.Curently this leads to /bin/sh creeping up in configure, and a breakage.",
    "created_at": "2018-01-05T19:36:02Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139032",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
I've checked that `FC=gfortran6`  can be provided on FreeBSD.

One more thing for a followup ticket: sort out the case of /bin/sh not being  bash (as on FreeBSD) and running with bash as the SHELL.Curently this leads to /bin/sh creeping up in configure, and a breakage.



---

archive/issue_comments_139033.json:
```json
{
    "body": "<a id='comment:464'></a>\nReplying to [fbissey](#comment%3A462):\n> So you think it can go in spite of eclib's test suite breaking?\n\n\nThat is really more a question for the release manager. Anyway, it's far more important that the Sage doctests pass.",
    "created_at": "2018-01-06T07:31:23Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139033",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:464'></a>
Replying to [fbissey](#comment%3A462):
> So you think it can go in spite of eclib's test suite breaking?


That is really more a question for the release manager. Anyway, it's far more important that the Sage doctests pass.



---

archive/issue_comments_139034.json:
```json
{
    "body": "<a id='comment:465'></a>\nReplying to [dimpase](#comment%3A463):\n> One more thing for a followup ticket: sort out the case of /bin/sh not being  bash (as on FreeBSD)\n\n\nSee #23448.",
    "created_at": "2018-01-06T07:32:26Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139034",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:465'></a>
Replying to [dimpase](#comment%3A463):
> One more thing for a followup ticket: sort out the case of /bin/sh not being  bash (as on FreeBSD)


See #23448.



---

archive/issue_events_101971.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-07T23:52:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101971"
}
```



---

archive/issue_events_101972.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-07T23:52:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101972"
}
```



---

archive/issue_comments_139035.json:
```json
{
    "body": "<a id='comment:6'></a>\nI think it's ready. (I ran more tests on OSX).",
    "created_at": "2018-01-07T23:52:55Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139035",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
I think it's ready. (I ran more tests on OSX).



---

archive/issue_comments_139036.json:
```json
{
    "body": "<a id='comment:7'></a>\nI remind you that there is still the dependency #24476 to be reviewed.",
    "created_at": "2018-01-08T08:23:31Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139036",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I remind you that there is still the dependency #24476 to be reviewed.



---

archive/issue_events_101973.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-12T13:21:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101973"
}
```



---

archive/issue_events_101974.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-12T13:21:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101974"
}
```



---

archive/issue_events_101975.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:49:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101975"
}
```



---

archive/issue_events_101976.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:49:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101976"
}
```



---

archive/issue_comments_139037.json:
```json
{
    "body": "<a id='comment:9'></a>\nMerge conflict",
    "created_at": "2018-01-14T10:49:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139037",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>
Merge conflict



---

archive/issue_comments_139038.json:
```json
{
    "body": "**Changing commit** from \"[b4d3067b5666bfa5f2208e8405d7cec4706e3738](https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738)\" to \"[d327bf6e636f3da1827d18e67bf1f2d1e6829892](https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892)\".",
    "created_at": "2018-01-14T14:14:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139038",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b4d3067b5666bfa5f2208e8405d7cec4706e3738](https://github.com/sagemath/sagetrac-mirror/commit/b4d3067b5666bfa5f2208e8405d7cec4706e3738)" to "[d327bf6e636f3da1827d18e67bf1f2d1e6829892](https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892)".



---

archive/issue_comments_139039.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892\">d327bf6</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>\n",
    "created_at": "2018-01-14T14:14:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892">d327bf6</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>




---

archive/issue_events_101977.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-14T14:28:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101977"
}
```



---

archive/issue_events_101978.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-14T14:28:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101978"
}
```



---

archive/issue_comments_139040.json:
```json
{
    "body": "<a id='comment:1'></a>\nGuessing that the conflict comes from the `configure` tarball, I just removed that commit.",
    "created_at": "2018-01-14T14:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139040",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
Guessing that the conflict comes from the `configure` tarball, I just removed that commit.



---

archive/issue_comments_139041.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,18 +1,4 @@\n Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.\n-\n-**Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz\n-\n-**Testing**: checkout the attached branch, download the configure tarball (see above) and run\n-\n-```\n-make\n-```\n-on OS X, or \n-\n-```\n-CC=clang CXX=clang++ make\n-```\n-on any OS.\n \n ---\n \n``````\n",
    "created_at": "2018-01-14T14:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139041",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,18 +1,4 @@
 Apple stopped supporting GCC in favour of clang. This is to track the status of building Sage with clang with the aim of making it the default compiler used on OS X and other OS where it is the default compiler.
-
-**Configure tarball**: http://sage.ugent.be/www/jdemeyer/sage/configure-251.tar.gz
-
-**Testing**: checkout the attached branch, download the configure tarball (see above) and run
-
-```
-make
-```
-on OS X, or 
-
-```
-CC=clang CXX=clang++ make
-```
-on any OS.
 
 ---
 
``````




---

archive/issue_comments_139042.json:
```json
{
    "body": "<a id='comment:2'></a>\nmerge conflict",
    "created_at": "2018-01-18T00:02:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139042",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
merge conflict



---

archive/issue_events_101979.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-18T00:02:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101979"
}
```



---

archive/issue_events_101980.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-18T00:02:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101980"
}
```



---

archive/issue_comments_139043.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c93f7f150a8ed68d9116a62a5c59eaa76e7b1ec3\">c93f7f1</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09\">2c2ca7b</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>\n",
    "created_at": "2018-01-18T09:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139043",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c93f7f150a8ed68d9116a62a5c59eaa76e7b1ec3">c93f7f1</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09">2c2ca7b</a></td><td><code>Mark gfortran as not installed after installing gcc</code></td></tr></table>




---

archive/issue_comments_139044.json:
```json
{
    "body": "**Changing commit** from \"[d327bf6e636f3da1827d18e67bf1f2d1e6829892](https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892)\" to \"[2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09](https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09)\".",
    "created_at": "2018-01-18T09:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139044",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d327bf6e636f3da1827d18e67bf1f2d1e6829892](https://github.com/sagemath/sagetrac-mirror/commit/d327bf6e636f3da1827d18e67bf1f2d1e6829892)" to "[2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09](https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09)".



---

archive/issue_events_101981.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-18T09:38:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101981"
}
```



---

archive/issue_events_101982.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-18T09:38:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101982"
}
```



---

archive/issue_comments_139045.json:
```json
{
    "body": "<a id='comment:4'></a>\nRebased to 8.2.beta3",
    "created_at": "2018-01-18T09:38:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139045",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Rebased to 8.2.beta3



---

archive/issue_comments_139046.json:
```json
{
    "body": "<a id='comment:5'></a>\nTries to build gfortran on Debian 7 (despite being installed) but fails:\n\n```\n[gfortran-7.2.0] Found local metadata for gfortran-7.2.0\n[gfortran-7.2.0] Using cached file /home/buildbot/slave/sage_git/build/upstream/gcc-7.2.0.tar.xz\n[gfortran-7.2.0] gfortran-7.2.0\n[gfortran-7.2.0] ====================================================\n[gfortran-7.2.0] Setting up build directory for gfortran-7.2.0\n[gfortran-7.2.0] Finished extraction\n[gfortran-7.2.0] No patch files found in ../patches\n[gfortran-7.2.0] ****************************************************\n[gfortran-7.2.0] Host system:\n[gfortran-7.2.0] Linux sagebd07_64s02 4.9.0-0.bpo.5-amd64 #1 SMP Debian 4.9.65-3+deb9u2~bpo8+1 (2017-01-05) x86_64 GNU/Linux\n[gfortran-7.2.0] ****************************************************\n[gfortran-7.2.0] C compiler: gcc\n[gfortran-7.2.0] C compiler version:\n[gfortran-7.2.0] Using built-in specs.\n[gfortran-7.2.0] COLLECT_GCC=gcc\n[gfortran-7.2.0] COLLECT_LTO_WRAPPER=/home/buildbot/slave/sage_git/build/local/libexec/gcc/x86_64-pc-linux-gnu/7.2.0/lto-wrapper\n[gfortran-7.2.0] Target: x86_64-pc-linux-gnu\n[gfortran-7.2.0] Configured with: ../src/configure --prefix=/home/buildbot/slave/sage_git/build/local --with-local-prefix=/home/buildbot/slave/sage_git/build/local --with-gmp=/home/buildbot/slave/sage_git/build/local --with-mpfr=/home/buildbot/slave/sage_git/build/local --with-mpc=/home/buildbot/slave/sage_git/build/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm  \n[gfortran-7.2.0] Thread model: posix\n[gfortran-7.2.0] gcc version 7.2.0 (GCC) \n[gfortran-7.2.0] ****************************************************\n[gfortran-7.2.0] Error: gcc is already installed\n[gfortran-7.2.0] \n[gfortran-7.2.0] real\t0m0.003s\n[gfortran-7.2.0] user\t0m0.000s\n[gfortran-7.2.0] sys\t0m0.000s\n[gfortran-7.2.0] ************************************************************************\n[gfortran-7.2.0] Error installing package gfortran-7.2.0\n[gfortran-7.2.0] ************************************************************************\n```\nFor the record:\n\n```\nbuildbot@sagebd07_64s02:~/slave/sage_git/build$ gfortran --version\nGNU Fortran (Debian 4.7.2-5) 4.7.2\n```",
    "created_at": "2018-01-20T10:42:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139046",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
Tries to build gfortran on Debian 7 (despite being installed) but fails:

```
[gfortran-7.2.0] Found local metadata for gfortran-7.2.0
[gfortran-7.2.0] Using cached file /home/buildbot/slave/sage_git/build/upstream/gcc-7.2.0.tar.xz
[gfortran-7.2.0] gfortran-7.2.0
[gfortran-7.2.0] ====================================================
[gfortran-7.2.0] Setting up build directory for gfortran-7.2.0
[gfortran-7.2.0] Finished extraction
[gfortran-7.2.0] No patch files found in ../patches
[gfortran-7.2.0] ****************************************************
[gfortran-7.2.0] Host system:
[gfortran-7.2.0] Linux sagebd07_64s02 4.9.0-0.bpo.5-amd64 #1 SMP Debian 4.9.65-3+deb9u2~bpo8+1 (2017-01-05) x86_64 GNU/Linux
[gfortran-7.2.0] ****************************************************
[gfortran-7.2.0] C compiler: gcc
[gfortran-7.2.0] C compiler version:
[gfortran-7.2.0] Using built-in specs.
[gfortran-7.2.0] COLLECT_GCC=gcc
[gfortran-7.2.0] COLLECT_LTO_WRAPPER=/home/buildbot/slave/sage_git/build/local/libexec/gcc/x86_64-pc-linux-gnu/7.2.0/lto-wrapper
[gfortran-7.2.0] Target: x86_64-pc-linux-gnu
[gfortran-7.2.0] Configured with: ../src/configure --prefix=/home/buildbot/slave/sage_git/build/local --with-local-prefix=/home/buildbot/slave/sage_git/build/local --with-gmp=/home/buildbot/slave/sage_git/build/local --with-mpfr=/home/buildbot/slave/sage_git/build/local --with-mpc=/home/buildbot/slave/sage_git/build/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm  
[gfortran-7.2.0] Thread model: posix
[gfortran-7.2.0] gcc version 7.2.0 (GCC) 
[gfortran-7.2.0] ****************************************************
[gfortran-7.2.0] Error: gcc is already installed
[gfortran-7.2.0] 
[gfortran-7.2.0] real	0m0.003s
[gfortran-7.2.0] user	0m0.000s
[gfortran-7.2.0] sys	0m0.000s
[gfortran-7.2.0] ************************************************************************
[gfortran-7.2.0] Error installing package gfortran-7.2.0
[gfortran-7.2.0] ************************************************************************
```
For the record:

```
buildbot@sagebd07_64s02:~/slave/sage_git/build$ gfortran --version
GNU Fortran (Debian 4.7.2-5) 4.7.2
```



---

archive/issue_events_101983.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-20T10:42:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101983"
}
```



---

archive/issue_events_101984.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-20T10:42:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101984"
}
```



---

archive/issue_comments_139047.json:
```json
{
    "body": "<a id='comment:476'></a>\nReplying to [vbraun](#comment%3A475):\n\nIt's not 100% clear what the bot configuration really is. Does it install gcc from Sage, too? If not, what is `gcc` installed? Does it match `gfortran` installed, version-vise?\n\n(all this can be found in the output of the main ./configure script.)",
    "created_at": "2018-01-20T12:56:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139047",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:476'></a>
Replying to [vbraun](#comment%3A475):

It's not 100% clear what the bot configuration really is. Does it install gcc from Sage, too? If not, what is `gcc` installed? Does it match `gfortran` installed, version-vise?

(all this can be found in the output of the main ./configure script.)



---

archive/issue_comments_139048.json:
```json
{
    "body": "<a id='comment:7'></a>\nConsidering the output, I'd say it is an incremental build. sage's gcc is installed because the OS' one is too old (4.7.2). So there is something in the configure logic that did go wrong and I thought I had guarded and tested against it. At least spkg-install behaved as expected and stopped before causing further dommages.",
    "created_at": "2018-01-20T18:18:51Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139048",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Considering the output, I'd say it is an incremental build. sage's gcc is installed because the OS' one is too old (4.7.2). So there is something in the configure logic that did go wrong and I thought I had guarded and tested against it. At least spkg-install behaved as expected and stopped before causing further dommages.



---

archive/issue_comments_139049.json:
```json
{
    "body": "<a id='comment:478'></a>\nReplying to [fbissey](#comment%3A477):\n> Considering the output, I'd say it is an incremental build. sage's gcc is installed because the OS' one is too old (4.7.2). So there is something in the configure logic that did go wrong and I thought I had guarded and tested against it. At least spkg-install behaved as expected and stopped before causing further dommages.\n\n\nperhaps just change spkg-install to exit happily if gcc is already installed?\n\nOn the other hand it seems that one simply should not do incremental build where this ticket is tested.",
    "created_at": "2018-01-21T14:47:20Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139049",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:478'></a>
Replying to [fbissey](#comment%3A477):
> Considering the output, I'd say it is an incremental build. sage's gcc is installed because the OS' one is too old (4.7.2). So there is something in the configure logic that did go wrong and I thought I had guarded and tested against it. At least spkg-install behaved as expected and stopped before causing further dommages.


perhaps just change spkg-install to exit happily if gcc is already installed?

On the other hand it seems that one simply should not do incremental build where this ticket is tested.



---

archive/issue_comments_139050.json:
```json
{
    "body": "<a id='comment:479'></a>\nReplying to [fbissey](#comment%3A477):\n> So there is something in the configure logic that did go wrong\n\n\nI think this is again the typical issue that `configure` doesn't get updated on the buildbots. The bug is in the release manager workflow, not this ticket. I'll try to provide a workaround.",
    "created_at": "2018-01-21T15:49:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139050",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:479'></a>
Replying to [fbissey](#comment%3A477):
> So there is something in the configure logic that did go wrong


I think this is again the typical issue that `configure` doesn't get updated on the buildbots. The bug is in the release manager workflow, not this ticket. I'll try to provide a workaround.



---

archive/issue_comments_139051.json:
```json
{
    "body": "**Changing dependencies** from \"#24476\" to \"#24579\".",
    "created_at": "2018-01-21T16:03:18Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139051",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#24476" to "#24579".



---

archive/issue_events_101985.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:03:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101985"
}
```



---

archive/issue_events_101986.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:03:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101986"
}
```



---

archive/issue_comments_139052.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** This was a forced push. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79c3b7a524455c3f2e58a6a13d4853abc5d41d80\">79c3b7a</a></td><td><code>Preparations for adding a gfortran package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4\">ac7816d</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr></table>\n",
    "created_at": "2018-01-21T16:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139052",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** This was a forced push. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79c3b7a524455c3f2e58a6a13d4853abc5d41d80">79c3b7a</a></td><td><code>Preparations for adding a gfortran package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4">ac7816d</a></td><td><code>Add a new gfortran spkg and use it when gfortran is not found</code></td></tr></table>




---

archive/issue_comments_139053.json:
```json
{
    "body": "**Changing commit** from \"[2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09](https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09)\" to \"[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)\".",
    "created_at": "2018-01-21T16:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139053",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09](https://github.com/sagemath/sagetrac-mirror/commit/2c2ca7bfa18bdda3d5ae7653c5b67fa462814a09)" to "[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)".



---

archive/issue_events_101987.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2018-01-21T16:11:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101987"
}
```



---

archive/issue_events_101988.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2018-01-21T16:11:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101988"
}
```



---

archive/issue_events_101989.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:13:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101989"
}
```



---

archive/issue_events_101990.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:13:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101990"
}
```



---

archive/issue_events_101991.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:13:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101991"
}
```



---

archive/issue_events_101992.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-21T16:13:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101992"
}
```



---

archive/issue_comments_139054.json:
```json
{
    "body": "<a id='comment:3'></a>\nIs installed and matches version\n\n```\nbuildbot@sagebd07_64s02:~$ gcc --version\ngcc (Debian 4.7.2-5) 4.7.2\n[...]\nbuildbot@sagebd07_64s02:~$ gfortran --version\nGNU Fortran (Debian 4.7.2-5) 4.7.2\n```",
    "created_at": "2018-01-21T17:10:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139054",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
Is installed and matches version

```
buildbot@sagebd07_64s02:~$ gcc --version
gcc (Debian 4.7.2-5) 4.7.2
[...]
buildbot@sagebd07_64s02:~$ gfortran --version
GNU Fortran (Debian 4.7.2-5) 4.7.2
```



---

archive/issue_comments_139055.json:
```json
{
    "body": "<a id='comment:4'></a>\n* The error happend with both incremental and full build\n* Only happens on Debian 7, not other distros",
    "created_at": "2018-01-21T17:11:17Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139055",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
* The error happend with both incremental and full build
* Only happens on Debian 7, not other distros



---

archive/issue_comments_139056.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe bit that's supposed to prevent this from happening in configure is \n\n```\n# if GCC needs to be installed GFORTRAN shouldn't be installed\n# GCC will provide GFORTRAN in that case\nif test $need_to_install_gcc = yes ; then\n    need_to_install_gfortran=no\nfi\n```\nso this test must be failing with the shell used debian 7. It will to be converted into something more universally reliable.",
    "created_at": "2018-01-21T23:29:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139056",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
The bit that's supposed to prevent this from happening in configure is 

```
# if GCC needs to be installed GFORTRAN shouldn't be installed
# GCC will provide GFORTRAN in that case
if test $need_to_install_gcc = yes ; then
    need_to_install_gfortran=no
fi
```
so this test must be failing with the shell used debian 7. It will to be converted into something more universally reliable.



---

archive/issue_comments_139057.json:
```json
{
    "body": "<a id='comment:6'></a>\nCould it be that on that Debian 7 system /bin/sh  is not bash? This might explain this singularity.",
    "created_at": "2018-01-22T08:41:53Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139057",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Could it be that on that Debian 7 system /bin/sh  is not bash? This might explain this singularity.



---

archive/issue_comments_139058.json:
```json
{
    "body": "<a id='comment:7'></a>\nPlease read [comment:479] for a possible explanation and see #24579 for a possible fix...",
    "created_at": "2018-01-22T08:49:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139058",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Please read [comment:479] for a possible explanation and see #24579 for a possible fix...



---

archive/issue_comments_139059.json:
```json
{
    "body": "<a id='comment:8'></a>\nWhy is this in sage-pending?",
    "created_at": "2018-01-27T12:58:14Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139059",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Why is this in sage-pending?



---

archive/issue_events_101993.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-28T11:52:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101993"
}
```



---

archive/issue_events_101994.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-28T11:52:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101994"
}
```



---

archive/issue_events_101995.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-01T19:13:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101995"
}
```



---

archive/issue_events_101996.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-01T19:13:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12426#event-101996"
}
```



---

archive/issue_comments_139060.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/clang-progress)\" to \"[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)\".",
    "created_at": "2018-02-01T19:13:35Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139060",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/clang-progress](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/clang-progress)" to "[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)".



---

archive/issue_comments_139061.json:
```json
{
    "body": "<a id='comment:1'></a>\nThanks everyone!",
    "created_at": "2018-02-01T20:26:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139061",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Thanks everyone!



---

archive/issue_comments_139062.json:
```json
{
    "body": "**Changing commit** from \"[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)\" to \"\".",
    "created_at": "2018-02-01T20:26:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12426#issuecomment-139062",
    "user": "https://github.com/kiwifb"
}
```

**Changing commit** from "[ac7816d0be8d72884422d107e361889ca3400fd4](https://github.com/sagemath/sagetrac-mirror/commit/ac7816d0be8d72884422d107e361889ca3400fd4)" to "".
