# Issue 12020: bug in zero_matrix rewrite in matrix_space.py

archive/issues_011848.json:
```json
{
    "assignees": [],
    "body": "Observe this:\n\n```\nsage: D=DirichletGroup(20);\nsage: g=D[7].extend(400); #order 4 character\nsage: M=ModularSymbols(g,2,sign=1).cuspidal_subspace()\nsage: N=M.new_subspace()\nTypeError                                 Traceback (most recent call last)\n\n/mnt/usb1/scratch/wstein/ref/sage-4.8.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _coerce_non_number_field_element_in(self, x)\n   5399         except (TypeError, AttributeError), msg:\n   5400             pass\n-> 5401         raise TypeError, type(x)\n   5402 \n   5403     def _coerce_from_str(self, x):\nTypeError: <type 'NoneType'>\n```\n\nDebugging we see that the problem is that this code in matrix_space.py:\n\n```\n    479         if entries is None or entries == 0:\n    480             if self._copy_zero: # faster to copy than to create a new one.\n    481                 return self.zero_matrix().__copy__()\n    482             else:\n--> 483                 return self.__matrix_class(self, None, coerce=coerce, copy=copy)\n```\nThat None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   \n\nThis bug was introduced in #11589.\n\n**Apply** [and [attachment: 12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)(https://github.com/sagemath/sage/files/ticket12020/658e865cd5cb20ccd1f713b4a5d86419.gz)\n\nAssignee: **@jasongrout, @williamstein**\n\nCC:  @vbraun\n\nAuthor: **Martin Albrecht, Volker Braun, Jeroen Demeyer**\n\nReviewer: **William Stein, Jeroen Demeyer, Volker Braun,**\n\nMerged: **sage-4.8.alpha3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12020_\n\n",
    "closed_at": "2011-11-21T10:45:42Z",
    "created_at": "2011-11-13T19:28:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "bug in zero_matrix rewrite in matrix_space.py",
    "type": "issue",
    "updated_at": "2011-11-21T10:45:42Z",
    "url": "https://github.com/sagemath/sage/issues/12020",
    "user": "https://github.com/williamstein"
}
```
Observe this:

```
sage: D=DirichletGroup(20);
sage: g=D[7].extend(400); #order 4 character
sage: M=ModularSymbols(g,2,sign=1).cuspidal_subspace()
sage: N=M.new_subspace()
TypeError                                 Traceback (most recent call last)

/mnt/usb1/scratch/wstein/ref/sage-4.8.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _coerce_non_number_field_element_in(self, x)
   5399         except (TypeError, AttributeError), msg:
   5400             pass
-> 5401         raise TypeError, type(x)
   5402 
   5403     def _coerce_from_str(self, x):
TypeError: <type 'NoneType'>
```

Debugging we see that the problem is that this code in matrix_space.py:

```
    479         if entries is None or entries == 0:
    480             if self._copy_zero: # faster to copy than to create a new one.
    481                 return self.zero_matrix().__copy__()
    482             else:
--> 483                 return self.__matrix_class(self, None, coerce=coerce, copy=copy)
```
That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   

This bug was introduced in #11589.

**Apply** [and [attachment: 12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)(https://github.com/sagemath/sage/files/ticket12020/658e865cd5cb20ccd1f713b4a5d86419.gz)

Assignee: **@jasongrout, @williamstein**

CC:  @vbraun

Author: **Martin Albrecht, Volker Braun, Jeroen Demeyer**

Reviewer: **William Stein, Jeroen Demeyer, Volker Braun,**

Merged: **sage-4.8.alpha3**

_Issue created by migration from https://trac.sagemath.org/ticket/12020_





---

archive/issue_events_148699.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:28:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148699"
}
```



---

archive/issue_events_148700.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148700"
}
```



---

archive/issue_events_148701.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148701"
}
```



---

archive/issue_events_148702.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148702"
}
```



---

archive/issue_comments_130033.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nI figured this out.  This bug was introduced by #11589 (by Simon King and Martin Albrecht).   Basically the zero_matrix() method's code was \"mangled/changed\" (?) when being copied into the `__init__` method by replacing \"0\" by \"None\".  This breaks the code, since there is no reason that None be coercible into a ring R, and I don't think that has to be supported because, e.g., in Python `int(None)` is an error.   Also, this is a weird change since the zero_matrix method in the new code still uses 0. \n\nPatch coming up.",
    "created_at": "2011-11-13T19:45:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130033",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'>Comment 1:</a>
I figured this out.  This bug was introduced by #11589 (by Simon King and Martin Albrecht).   Basically the zero_matrix() method's code was "mangled/changed" (?) when being copied into the `__init__` method by replacing "0" by "None".  This breaks the code, since there is no reason that None be coercible into a ring R, and I don't think that has to be supported because, e.g., in Python `int(None)` is an error.   Also, this is a weird change since the zero_matrix method in the new code still uses 0. 

Patch coming up.



---

archive/issue_comments_130034.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nHere is a simple test to reveal the bug.  Small size matrices don't show the bug, probably because of some arbitrary caching parameter in #11589, which is probably why this bug slipped through our test framework (we *really* need a random larger testing framework!):\n\n```\nsage: A = MatrixSpace(CyclotomicField(4),60,30)(0)\nsage: A.augment(A)\nboom!\n```",
    "created_at": "2011-11-13T19:49:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130034",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'>Comment 2:</a>
Here is a simple test to reveal the bug.  Small size matrices don't show the bug, probably because of some arbitrary caching parameter in #11589, which is probably why this bug slipped through our test framework (we *really* need a random larger testing framework!):

```
sage: A = MatrixSpace(CyclotomicField(4),60,30)(0)
sage: A.augment(A)
boom!
```



---

archive/issue_events_148703.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:52:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "title_is": "bug in zero_matrix rewrite in matrix_space.py",
    "title_was": "major (BLOCKER!) bug probably in matrix_space.py",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148703"
}
```



---

archive/issue_comments_130035.json:
```json
{
    "body": "Attachment: **[trac_12020.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.patch.gz)**\n\nAttachment: **[trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)**\n\nSame patch with corrected doc formatting",
    "created_at": "2011-11-14T08:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130035",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[trac_12020.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.patch.gz)**

Attachment: **[trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)**

Same patch with corrected doc formatting



---

archive/issue_events_148704.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T08:46:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148704"
}
```



---

archive/issue_comments_130036.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,4 +27,6 @@\n ```\n That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   \n \n-This page suggests this is a recently introduced bug, since the above worked fine there:  http://ask.sagemath.org/question/147/insufficient-ram-for-computing-newforms\n+This bug was introduced in #11589.\n+\n+**Apply** [attachment: trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)\n``````\n",
    "created_at": "2011-11-14T08:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130036",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,4 +27,6 @@
 ```
 That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   
 
-This page suggests this is a recently introduced bug, since the above worked fine there:  http://ask.sagemath.org/question/147/insufficient-ram-for-computing-newforms
+This bug was introduced in #11589.
+
+**Apply** [attachment: trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)
``````




---

archive/issue_comments_130037.json:
```json
{
    "body": "Author: **William Stein**",
    "created_at": "2011-11-14T08:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130037",
    "user": "https://github.com/jdemeyer"
}
```

Author: **William Stein**



---

archive/issue_comments_130038.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nI have attached an alternative solution: instead of switching back to `0` instead of `None` make `Matrix_cyclo_dense` deal with `None` properly. The reason we switched to `None` was because this is faster since most (?, perhaps only some) matrix classes do nothing if `None` is passed, while they write 0 along the main diagonal if zero is passed. Of course, one could also fix those matrix classes and switch back to `0`.",
    "created_at": "2011-11-14T12:20:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130038",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'>Comment 5:</a>
I have attached an alternative solution: instead of switching back to `0` instead of `None` make `Matrix_cyclo_dense` deal with `None` properly. The reason we switched to `None` was because this is faster since most (?, perhaps only some) matrix classes do nothing if `None` is passed, while they write 0 along the main diagonal if zero is passed. Of course, one could also fix those matrix classes and switch back to `0`.



---

archive/issue_comments_130039.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@malb](#comment%3A5):\n> Of course, one could also fix those matrix classes and switch back to `0`.\n\nI slightly prefer that because it seems safer to me.",
    "created_at": "2011-11-14T14:00:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130039",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@malb](#comment%3A5):
> Of course, one could also fix those matrix classes and switch back to `0`.

I slightly prefer that because it seems safer to me.



---

archive/issue_comments_130040.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nI found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.",
    "created_at": "2011-11-14T15:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130040",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'>Comment 7:</a>
I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.



---

archive/issue_comments_130041.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [@vbraun](#comment%3A7):\n> I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.\n\nEspecially with such a nice ticket number...\n\nProposing to close this as \"duplicate\"",
    "created_at": "2011-11-14T15:49:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130041",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [@vbraun](#comment%3A7):
> I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.

Especially with such a nice ticket number...

Proposing to close this as "duplicate"



---

archive/issue_events_148705.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T15:49:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148705"
}
```



---

archive/issue_events_148706.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T15:49:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148706"
}
```



---

archive/issue_events_148707.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T15:49:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148707"
}
```



---

archive/issue_comments_130042.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nIf \"this\" is \"this ticket\" then I agree.",
    "created_at": "2011-11-14T15:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130042",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'>Comment 9:</a>
If "this" is "this ticket" then I agree.



---

archive/issue_comments_130043.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nThe fix for #12000 also works for this particular example.    I really hope that all other matrix types (now and in the future) respect this None convention, since they will all have the same problem if we go with the #12000 fix rather than the fix here.  We could add documentation in the file matrix/docs.py that reflects what should happen with None, and we should try to add a test that things work with several different types.",
    "created_at": "2011-11-14T16:18:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130043",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:10'>Comment 10:</a>
The fix for #12000 also works for this particular example.    I really hope that all other matrix types (now and in the future) respect this None convention, since they will all have the same problem if we go with the #12000 fix rather than the fix here.  We could add documentation in the file matrix/docs.py that reflects what should happen with None, and we should try to add a test that things work with several different types.



---

archive/issue_comments_130044.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.",
    "created_at": "2011-11-14T17:09:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130044",
    "user": "https://github.com/malb"
}
```

<a id='comment:11'>Comment 11:</a>
I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.



---

archive/issue_comments_130045.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@malb](#comment%3A11):\n> I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.\n\nCool.  Great work checking that.  I'm really happy with this now then.",
    "created_at": "2011-11-14T17:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130045",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@malb](#comment%3A11):
> I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.

Cool.  Great work checking that.  I'm really happy with this now then.



---

archive/issue_comments_130046.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI give malb's trac_12020_alt.patch a positive review.    Note that the patch at 12000 by Volker is isomorphic to malb's, except it also has sphinxification of the relevant docstrings (though the rest of the file is pre-sphinx) and a different doctest illustrating the same issue.",
    "created_at": "2011-11-14T17:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130046",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'>Comment 13:</a>
I give malb's trac_12020_alt.patch a positive review.    Note that the patch at 12000 by Volker is isomorphic to malb's, except it also has sphinxification of the relevant docstrings (though the rest of the file is pre-sphinx) and a different doctest illustrating the same issue.



---

archive/issue_events_148708.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T17:20:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148708"
}
```



---

archive/issue_events_148709.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T17:20:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148709"
}
```



---

archive/issue_events_148710.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:25:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148710"
}
```



---

archive/issue_events_148711.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:25:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148711"
}
```



---

archive/issue_comments_130047.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@williamstein](#comment%3A13):\n> I give malb's trac_12020_alt.patch a positive review.\n\nHe just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...",
    "created_at": "2011-11-14T17:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130047",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@williamstein](#comment%3A13):
> I give malb's trac_12020_alt.patch a positive review.

He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...



---

archive/issue_comments_130048.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@jdemeyer](#comment%3A14):\n> Replying to [@williamstein](#comment%3A13):\n> > I give malb's trac_12020_alt.patch a positive review.\n\n> \n> He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...\n\nWoops --  I agree with not giving this a positive review.  \n\nIt would be good to have a test that runs through a large number of base rings.",
    "created_at": "2011-11-14T17:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130048",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@jdemeyer](#comment%3A14):
> Replying to [@williamstein](#comment%3A13):
> > I give malb's trac_12020_alt.patch a positive review.

> 
> He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...

Woops --  I agree with not giving this a positive review.  

It would be good to have a test that runs through a large number of base rings.



---

archive/issue_comments_130049.json:
```json
{
    "body": "Attachment: **[trac_12020_alt.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020_alt.patch.gz)**",
    "created_at": "2011-11-14T18:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130049",
    "user": "https://github.com/malb"
}
```

Attachment: **[trac_12020_alt.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020_alt.patch.gz)**



---

archive/issue_comments_130050.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI added a comment to docs.py and added a return `if entries is None`. However, since e.g., `GF(7)(None) == 0`} it does not actually fix a bug, just exits slightly faster.",
    "created_at": "2011-11-14T18:43:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130050",
    "user": "https://github.com/malb"
}
```

<a id='comment:16'>Comment 16:</a>
I added a comment to docs.py and added a return `if entries is None`. However, since e.g., `GF(7)(None) == 0`} it does not actually fix a bug, just exits slightly faster.



---

archive/issue_events_148712.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-11-14T18:43:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148712"
}
```



---

archive/issue_events_148713.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-11-14T18:43:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148713"
}
```



---

archive/issue_events_148714.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T18:51:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148714"
}
```



---

archive/issue_events_148715.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T18:51:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148715"
}
```



---

archive/issue_comments_130051.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nThanks malb.  It looks great to me.     (And if you want to do something else for Sage-5.0, you could doctest \"matrix/benchmark.py: 0% (0 of 29)\" from #12024.)",
    "created_at": "2011-11-14T18:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130051",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:17'>Comment 17:</a>
Thanks malb.  It looks great to me.     (And if you want to do something else for Sage-5.0, you could doctest "matrix/benchmark.py: 0% (0 of 29)" from #12024.)



---

archive/issue_comments_130052.json:
```json
{
    "body": "Reviewer: **William Stein**",
    "created_at": "2011-11-14T21:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130052",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **William Stein**



---

archive/issue_comments_130053.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,4 +29,4 @@\n \n This bug was introduced in #11589.\n \n-**Apply** [attachment: trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)\n+**Apply** [and [attachment: 12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)(https://github.com/sagemath/sage/files/ticket12020/658e865cd5cb20ccd1f713b4a5d86419.gz)\n``````\n",
    "created_at": "2011-11-14T21:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130053",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,4 +29,4 @@
 
 This bug was introduced in #11589.
 
-**Apply** [attachment: trac_12020.2.patch.gz](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch.gz)
+**Apply** [and [attachment: 12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)(https://github.com/sagemath/sage/files/ticket12020/658e865cd5cb20ccd1f713b4a5d86419.gz)
``````




---

archive/issue_events_148716.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:03:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148716"
}
```



---

archive/issue_events_148717.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:03:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148717"
}
```



---

archive/issue_comments_130054.json:
```json
{
    "body": "Changed author from **William Stein** to **Martin Albrecht, Jeroen Demeyer**",
    "created_at": "2011-11-14T21:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130054",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **William Stein** to **Martin Albrecht, Jeroen Demeyer**



---

archive/issue_comments_130055.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReviewer patch adding extra doctests like William suggested, needs_review.",
    "created_at": "2011-11-14T21:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130055",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'>Comment 19:</a>
Reviewer patch adding extra doctests like William suggested, needs_review.



---

archive/issue_events_148718.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148718"
}
```



---

archive/issue_events_148719.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148719"
}
```



---

archive/issue_events_148720.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148720"
}
```



---

archive/issue_comments_130056.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nIt would be nice to define a list of 100 (say) various rings in a file in the tests directory.  Then the test could be\n\n```\nsage: from sage.tests.examples import commutative_rings0\nsage: for R in commutative_rings0: \n         do something\n```\n\nThen people could add new rings to that list, and tests all over may benefit.  \n\nAnd in addition to rings, we could assemble many other lists of examples of objects in that file.\n\nThis could be on another ticket.",
    "created_at": "2011-11-14T21:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130056",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:20'>Comment 20:</a>
It would be nice to define a list of 100 (say) various rings in a file in the tests directory.  Then the test could be

```
sage: from sage.tests.examples import commutative_rings0
sage: for R in commutative_rings0: 
         do something
```

Then people could add new rings to that list, and tests all over may benefit.  

And in addition to rings, we could assemble many other lists of examples of objects in that file.

This could be on another ticket.



---

archive/issue_comments_130057.json:
```json
{
    "body": "Attachment: **[12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)**",
    "created_at": "2011-11-15T09:06:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130057",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12020_review.patch.gz](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch.gz)**



---

archive/issue_comments_130058.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nI added Volker's patch from #12000 here.",
    "created_at": "2011-11-15T09:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130058",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'>Comment 21:</a>
I added Volker's patch from #12000 here.



---

archive/issue_comments_130059.json:
```json
{
    "body": "Changed author from **Martin Albrecht, Jeroen Demeyer** to **Martin Albrecht, Volker Braun, Jeroen Demeyer**",
    "created_at": "2011-11-15T09:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130059",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Martin Albrecht, Jeroen Demeyer** to **Martin Albrecht, Volker Braun, Jeroen Demeyer**



---

archive/issue_comments_130060.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n*ping* needs review",
    "created_at": "2011-11-19T12:00:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130060",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'>Comment 22:</a>
*ping* needs review



---

archive/issue_comments_130061.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nLooks good!",
    "created_at": "2011-11-19T12:35:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130061",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'>Comment 23:</a>
Looks good!



---

archive/issue_comments_130062.json:
```json
{
    "body": "Changed reviewer from **William Stein** to **William Stein, Jeroen Demeyer, Volker Braun,**",
    "created_at": "2011-11-19T12:35:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130062",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **William Stein** to **William Stein, Jeroen Demeyer, Volker Braun,**



---

archive/issue_events_148721.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-11-19T12:35:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148721"
}
```



---

archive/issue_events_148722.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-11-19T12:35:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148722"
}
```



---

archive/issue_events_148723.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-21T10:45:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148723"
}
```



---

archive/issue_events_148724.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-21T10:45:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-148724"
}
```



---

archive/issue_comments_130063.json:
```json
{
    "body": "Merged: **sage-4.8.alpha3**",
    "created_at": "2011-11-21T10:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130063",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.8.alpha3**
