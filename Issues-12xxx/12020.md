# Issue 12020: bug in zero_matrix rewrite in matrix_space.py

archive/issues_011848.json:
```json
{
    "body": "Observe this:\n\n```\nsage: D=DirichletGroup(20);\nsage: g=D[7].extend(400); #order 4 character\nsage: M=ModularSymbols(g,2,sign=1).cuspidal_subspace()\nsage: N=M.new_subspace()\nTypeError                                 Traceback (most recent call last)\n\n/mnt/usb1/scratch/wstein/ref/sage-4.8.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _coerce_non_number_field_element_in(self, x)\n   5399         except (TypeError, AttributeError), msg:\n   5400             pass\n-> 5401         raise TypeError, type(x)\n   5402 \n   5403     def _coerce_from_str(self, x):\nTypeError: <type 'NoneType'>\n```\n\nDebugging we see that the problem is that this code in matrix_space.py:\n\n```\n    479         if entries is None or entries == 0:\n    480             if self._copy_zero: # faster to copy than to create a new one.\n    481                 return self.zero_matrix().__copy__()\n    482             else:\n--> 483                 return self.__matrix_class(self, None, coerce=coerce, copy=copy)\n```\nThat None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   \n\nThis bug was introduced in #11589.\n\n**Apply** [and [attachment:12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/47c2ba997e604c7ddc85ba6d320bcda7.patch](https://github.com/sagemath/sage/files/ticket12020/f337463e12894ea99f775261d5fae381.patch))\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  @vbraun\n\n**Author:** Martin Albrecht, Volker Braun, Jeroen Demeyer\n\n**Reviewer:** William Stein, Jeroen Demeyer, Volker Braun,\n\n**Merged:** sage-4.8.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/12020\n\n",
    "closed_at": "2011-11-21T10:45:42Z",
    "created_at": "2011-11-13T19:28:23Z",
    "labels": [
        "component: linear algebra",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.8",
    "title": "bug in zero_matrix rewrite in matrix_space.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/12020",
    "user": "https://github.com/williamstein"
}
```
Observe this:

```
sage: D=DirichletGroup(20);
sage: g=D[7].extend(400); #order 4 character
sage: M=ModularSymbols(g,2,sign=1).cuspidal_subspace()
sage: N=M.new_subspace()
TypeError                                 Traceback (most recent call last)

/mnt/usb1/scratch/wstein/ref/sage-4.8.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _coerce_non_number_field_element_in(self, x)
   5399         except (TypeError, AttributeError), msg:
   5400             pass
-> 5401         raise TypeError, type(x)
   5402 
   5403     def _coerce_from_str(self, x):
TypeError: <type 'NoneType'>
```

Debugging we see that the problem is that this code in matrix_space.py:

```
    479         if entries is None or entries == 0:
    480             if self._copy_zero: # faster to copy than to create a new one.
    481                 return self.zero_matrix().__copy__()
    482             else:
--> 483                 return self.__matrix_class(self, None, coerce=coerce, copy=copy)
```
That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   

This bug was introduced in #11589.

**Apply** [and [attachment:12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/47c2ba997e604c7ddc85ba6d320bcda7.patch](https://github.com/sagemath/sage/files/ticket12020/f337463e12894ea99f775261d5fae381.patch))

**Assignee:** @jasongrout, @williamstein

**CC:**  @vbraun

**Author:** Martin Albrecht, Volker Braun, Jeroen Demeyer

**Reviewer:** William Stein, Jeroen Demeyer, Volker Braun,

**Merged:** sage-4.8.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/12020





---

archive/issue_comments_129984.json:
```json
{
    "body": "<a id='comment:1'></a>\nI figured this out.  This bug was introduced by #11589 (by Simon King and Martin Albrecht).   Basically the zero_matrix() method's code was \"mangled/changed\" (?) when being copied into the `__init__` method by replacing \"0\" by \"None\".  This breaks the code, since there is no reason that None be coercible into a ring R, and I don't think that has to be supported because, e.g., in Python `int(None)` is an error.   Also, this is a weird change since the zero_matrix method in the new code still uses 0. \n\nPatch coming up.",
    "created_at": "2011-11-13T19:45:24Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129984",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>
I figured this out.  This bug was introduced by #11589 (by Simon King and Martin Albrecht).   Basically the zero_matrix() method's code was "mangled/changed" (?) when being copied into the `__init__` method by replacing "0" by "None".  This breaks the code, since there is no reason that None be coercible into a ring R, and I don't think that has to be supported because, e.g., in Python `int(None)` is an error.   Also, this is a weird change since the zero_matrix method in the new code still uses 0. 

Patch coming up.



---

archive/issue_comments_129985.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere is a simple test to reveal the bug.  Small size matrices don't show the bug, probably because of some arbitrary caching parameter in #11589, which is probably why this bug slipped through our test framework (we *really* need a random larger testing framework!):\n\n```\nsage: A = MatrixSpace(CyclotomicField(4),60,30)(0)\nsage: A.augment(A)\nboom!\n```",
    "created_at": "2011-11-13T19:49:37Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129985",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>
Here is a simple test to reveal the bug.  Small size matrices don't show the bug, probably because of some arbitrary caching parameter in #11589, which is probably why this bug slipped through our test framework (we *really* need a random larger testing framework!):

```
sage: A = MatrixSpace(CyclotomicField(4),60,30)(0)
sage: A.augment(A)
boom!
```



---

archive/issue_events_097249.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-13T19:52:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "rename": {
        "from": "major (BLOCKER!) bug probably in matrix_space.py",
        "to": "bug in zero_matrix rewrite in matrix_space.py"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97249"
}
```



---

archive/attachments_016002.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12020.2.patch",
    "asset_url": "tarball://root/attachments/ticket12020/trac_12020.2.patch",
    "created_at": "2011-11-14T08:44:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_129986.json:
```json
{
    "body": "Attachment [trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch) by @jdemeyer created at 2011-11-14 08:44:08\n\nSame patch with corrected doc formatting",
    "created_at": "2011-11-14T08:44:08Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129986",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch) by @jdemeyer created at 2011-11-14 08:44:08

Same patch with corrected doc formatting



---

archive/issue_events_097250.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T08:46:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97250"
}
```



---

archive/issue_comments_129987.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -27,4 +27,6 @@\n ```\n That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   \n \n-This page suggests this is a recently introduced bug, since the above worked fine there:  http://ask.sagemath.org/question/147/insufficient-ram-for-computing-newforms\n+This bug was introduced in #11589.\n+\n+**Apply** [attachment:trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch)\n``````\n",
    "created_at": "2011-11-14T08:46:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129987",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -27,4 +27,6 @@
 ```
 That None in the last line is then coerced for some reason into a number field (Cyclotomic Field of order 4 and degree) which makes no sense now...   
 
-This page suggests this is a recently introduced bug, since the above worked fine there:  http://ask.sagemath.org/question/147/insufficient-ram-for-computing-newforms
+This bug was introduced in #11589.
+
+**Apply** [attachment:trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch)
``````




---

archive/issue_comments_129988.json:
```json
{
    "body": "**Author:** William Stein",
    "created_at": "2011-11-14T08:46:29Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129988",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** William Stein



---

archive/issue_comments_129989.json:
```json
{
    "body": "<a id='comment:5'></a>\nI have attached an alternative solution: instead of switching back to `0` instead of `None` make `Matrix_cyclo_dense` deal with `None` properly. The reason we switched to `None` was because this is faster since most (?, perhaps only some) matrix classes do nothing if `None` is passed, while they write 0 along the main diagonal if zero is passed. Of course, one could also fix those matrix classes and switch back to `0`.",
    "created_at": "2011-11-14T12:20:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129989",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'></a>
I have attached an alternative solution: instead of switching back to `0` instead of `None` make `Matrix_cyclo_dense` deal with `None` properly. The reason we switched to `None` was because this is faster since most (?, perhaps only some) matrix classes do nothing if `None` is passed, while they write 0 along the main diagonal if zero is passed. Of course, one could also fix those matrix classes and switch back to `0`.



---

archive/issue_comments_129990.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [malb](#comment%3A5):\n> Of course, one could also fix those matrix classes and switch back to `0`.\n\nI slightly prefer that because it seems safer to me.",
    "created_at": "2011-11-14T14:00:56Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129990",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Replying to [malb](#comment%3A5):
> Of course, one could also fix those matrix classes and switch back to `0`.

I slightly prefer that because it seems safer to me.



---

archive/issue_comments_129991.json:
```json
{
    "body": "<a id='comment:7'></a>\nI found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.",
    "created_at": "2011-11-14T15:08:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129991",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.



---

archive/issue_comments_129992.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [vbraun](#comment%3A7):\n> I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.\n\nEspecially with such a nice ticket number...\n\nProposing to close this as \"duplicate\"",
    "created_at": "2011-11-14T15:49:15Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129992",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [vbraun](#comment%3A7):
> I found and fixed this bug earlier in #12000. Of course nobody ever reviews my patches, sniff.

Especially with such a nice ticket number...

Proposing to close this as "duplicate"



---

archive/issue_events_097251.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T15:49:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97251"
}
```



---

archive/issue_events_097252.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T15:49:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97252"
}
```



---

archive/issue_comments_129993.json:
```json
{
    "body": "<a id='comment:9'></a>\nIf \"this\" is \"this ticket\" then I agree.",
    "created_at": "2011-11-14T15:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129993",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>
If "this" is "this ticket" then I agree.



---

archive/issue_comments_129994.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe fix for #12000 also works for this particular example.    I really hope that all other matrix types (now and in the future) respect this None convention, since they will all have the same problem if we go with the #12000 fix rather than the fix here.  We could add documentation in the file matrix/docs.py that reflects what should happen with None, and we should try to add a test that things work with several different types.",
    "created_at": "2011-11-14T16:18:07Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129994",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:10'></a>
The fix for #12000 also works for this particular example.    I really hope that all other matrix types (now and in the future) respect this None convention, since they will all have the same problem if we go with the #12000 fix rather than the fix here.  We could add documentation in the file matrix/docs.py that reflects what should happen with None, and we should try to add a test that things work with several different types.



---

archive/issue_comments_129995.json:
```json
{
    "body": "<a id='comment:11'></a>\nI checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.",
    "created_at": "2011-11-14T17:09:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129995",
    "user": "https://github.com/malb"
}
```

<a id='comment:11'></a>
I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.



---

archive/issue_comments_129996.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [malb](#comment%3A11):\n> I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.\n\n\nCool.  Great work checking that.  I'm really happy with this now then.",
    "created_at": "2011-11-14T17:17:47Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129996",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:12'></a>
Replying to [malb](#comment%3A11):
> I checked the `__init__` methods of all pyx files in sage/matrix/ and found one which doesn't treat `entries==None` properly: `matrix_modn_sparse.pyx`, so this one should get fixed. Note that all others explicitly support `entries==None` and many do nothing when it is passed, i.e., it's the explicit fast path.


Cool.  Great work checking that.  I'm really happy with this now then.



---

archive/issue_comments_129997.json:
```json
{
    "body": "<a id='comment:13'></a>\nI give malb's trac_12020_alt.patch a positive review.    Note that the patch at 12000 by Volker is isomorphic to malb's, except it also has sphinxification of the relevant docstrings (though the rest of the file is pre-sphinx) and a different doctest illustrating the same issue.",
    "created_at": "2011-11-14T17:20:59Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129997",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'></a>
I give malb's trac_12020_alt.patch a positive review.    Note that the patch at 12000 by Volker is isomorphic to malb's, except it also has sphinxification of the relevant docstrings (though the rest of the file is pre-sphinx) and a different doctest illustrating the same issue.



---

archive/issue_events_097253.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T17:20:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97253"
}
```



---

archive/issue_events_097254.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T17:20:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97254"
}
```



---

archive/issue_events_097255.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:25:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97255"
}
```



---

archive/issue_events_097256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:25:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97256"
}
```



---

archive/issue_comments_129998.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [was](#comment%3A13):\n> I give malb's trac_12020_alt.patch a positive review.\n\n\nHe just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...",
    "created_at": "2011-11-14T17:25:32Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129998",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [was](#comment%3A13):
> I give malb's trac_12020_alt.patch a positive review.


He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...



---

archive/issue_comments_129999.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [jdemeyer](#comment%3A14):\n> Replying to [was](#comment%3A13):\n> > I give malb's trac_12020_alt.patch a positive review.\n\n> \n> He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...\n\n\nWoops --  I agree with not giving this a positive review.  \n\nIt would be good to have a test that runs through a large number of base rings.",
    "created_at": "2011-11-14T17:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-129999",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:15'></a>
Replying to [jdemeyer](#comment%3A14):
> Replying to [was](#comment%3A13):
> > I give malb's trac_12020_alt.patch a positive review.

> 
> He just said that `matrix_modn_sparse.pyx` is also broken (and not yet fixed by the patch here)...


Woops --  I agree with not giving this a positive review.  

It would be good to have a test that runs through a large number of base rings.



---

archive/attachments_016003.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12020_alt.patch",
    "asset_url": "tarball://root/attachments/ticket12020/trac_12020_alt.patch",
    "created_at": "2011-11-14T18:41:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12020/trac_12020_alt.patch",
    "user": "https://github.com/malb"
}
```



---

archive/issue_comments_130000.json:
```json
{
    "body": "Attachment [trac_12020_alt.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020_alt.patch) by @malb created at 2011-11-14 18:41:30",
    "created_at": "2011-11-14T18:41:30Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130000",
    "user": "https://github.com/malb"
}
```

Attachment [trac_12020_alt.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020_alt.patch) by @malb created at 2011-11-14 18:41:30



---

archive/issue_comments_130001.json:
```json
{
    "body": "<a id='comment:16'></a>\nI added a comment to docs.py and added a return `if entries is None`. However, since e.g., `GF(7)(None) == 0`} it does not actually fix a bug, just exits slightly faster.",
    "created_at": "2011-11-14T18:43:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130001",
    "user": "https://github.com/malb"
}
```

<a id='comment:16'></a>
I added a comment to docs.py and added a return `if entries is None`. However, since e.g., `GF(7)(None) == 0`} it does not actually fix a bug, just exits slightly faster.



---

archive/issue_events_097257.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-11-14T18:43:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97257"
}
```



---

archive/issue_events_097258.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-11-14T18:43:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97258"
}
```



---

archive/issue_events_097259.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T18:51:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97259"
}
```



---

archive/issue_events_097260.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-11-14T18:51:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97260"
}
```



---

archive/issue_comments_130002.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks malb.  It looks great to me.     (And if you want to do something else for Sage-5.0, you could doctest \"matrix/benchmark.py: 0% (0 of 29)\" from #12024.)",
    "created_at": "2011-11-14T18:51:19Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130002",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:17'></a>
Thanks malb.  It looks great to me.     (And if you want to do something else for Sage-5.0, you could doctest "matrix/benchmark.py: 0% (0 of 29)" from #12024.)



---

archive/issue_comments_130003.json:
```json
{
    "body": "**Reviewer:** William Stein",
    "created_at": "2011-11-14T21:03:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130003",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** William Stein



---

archive/issue_comments_130004.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -29,4 +29,4 @@\n \n This bug was introduced in #11589.\n \n-**Apply** [attachment:trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch)\n+**Apply** [and [attachment:12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/47c2ba997e604c7ddc85ba6d320bcda7.patch](https://github.com/sagemath/sage/files/ticket12020/f337463e12894ea99f775261d5fae381.patch))\n``````\n",
    "created_at": "2011-11-14T21:03:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130004",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -29,4 +29,4 @@
 
 This bug was introduced in #11589.
 
-**Apply** [attachment:trac_12020.2.patch](https://github.com/sagemath/sage/files/ticket12020/trac_12020.2.patch)
+**Apply** [and [attachment:12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/47c2ba997e604c7ddc85ba6d320bcda7.patch](https://github.com/sagemath/sage/files/ticket12020/f337463e12894ea99f775261d5fae381.patch))
``````




---

archive/issue_events_097261.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:03:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97261"
}
```



---

archive/issue_events_097262.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:03:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97262"
}
```



---

archive/issue_comments_130005.json:
```json
{
    "body": "**Changing author** from \"William Stein\" to \"Martin Albrecht, Jeroen Demeyer\".",
    "created_at": "2011-11-14T21:03:39Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130005",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "William Stein" to "Martin Albrecht, Jeroen Demeyer".



---

archive/issue_comments_130006.json:
```json
{
    "body": "<a id='comment:19'></a>\nReviewer patch adding extra doctests like William suggested, needs_review.",
    "created_at": "2011-11-14T21:04:13Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130006",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Reviewer patch adding extra doctests like William suggested, needs_review.



---

archive/issue_events_097263.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97263"
}
```



---

archive/issue_events_097264.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97264"
}
```



---

archive/issue_events_097265.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:04:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97265"
}
```



---

archive/issue_comments_130007.json:
```json
{
    "body": "<a id='comment:20'></a>\nIt would be nice to define a list of 100 (say) various rings in a file in the tests directory.  Then the test could be\n\n```\nsage: from sage.tests.examples import commutative_rings0\nsage: for R in commutative_rings0: \n         do something\n```\n\nThen people could add new rings to that list, and tests all over may benefit.  \n\nAnd in addition to rings, we could assemble many other lists of examples of objects in that file.\n\nThis could be on another ticket.",
    "created_at": "2011-11-14T21:07:33Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130007",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:20'></a>
It would be nice to define a list of 100 (say) various rings in a file in the tests directory.  Then the test could be

```
sage: from sage.tests.examples import commutative_rings0
sage: for R in commutative_rings0: 
         do something
```

Then people could add new rings to that list, and tests all over may benefit.  

And in addition to rings, we could assemble many other lists of examples of objects in that file.

This could be on another ticket.



---

archive/attachments_016004.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12020_review.patch",
    "asset_url": "tarball://root/attachments/ticket12020/12020_review.patch",
    "created_at": "2011-11-15T09:06:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket12020/12020_review.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_130008.json:
```json
{
    "body": "Attachment [12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch) by @jdemeyer created at 2011-11-15 09:06:54",
    "created_at": "2011-11-15T09:06:54Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130008",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [12020_review.patch](https://github.com/sagemath/sage/files/ticket12020/12020_review.patch) by @jdemeyer created at 2011-11-15 09:06:54



---

archive/issue_comments_130009.json:
```json
{
    "body": "<a id='comment:21'></a>\nI added Volker's patch from #12000 here.",
    "created_at": "2011-11-15T09:08:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130009",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
I added Volker's patch from #12000 here.



---

archive/issue_comments_130010.json:
```json
{
    "body": "**Changing author** from \"Martin Albrecht, Jeroen Demeyer\" to \"Martin Albrecht, Volker Braun, Jeroen Demeyer\".",
    "created_at": "2011-11-15T09:08:12Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130010",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Martin Albrecht, Jeroen Demeyer" to "Martin Albrecht, Volker Braun, Jeroen Demeyer".



---

archive/issue_comments_130011.json:
```json
{
    "body": "<a id='comment:22'></a>\n*ping* needs review",
    "created_at": "2011-11-19T12:00:40Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130011",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
*ping* needs review



---

archive/issue_comments_130012.json:
```json
{
    "body": "<a id='comment:23'></a>\nLooks good!",
    "created_at": "2011-11-19T12:35:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130012",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
Looks good!



---

archive/issue_comments_130013.json:
```json
{
    "body": "**Changing reviewer** from \"William Stein\" to \"William Stein, Jeroen Demeyer, Volker Braun,\".",
    "created_at": "2011-11-19T12:35:01Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130013",
    "user": "https://github.com/vbraun"
}
```

**Changing reviewer** from "William Stein" to "William Stein, Jeroen Demeyer, Volker Braun,".



---

archive/issue_events_097266.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-11-19T12:35:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97266"
}
```



---

archive/issue_events_097267.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-11-19T12:35:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97267"
}
```



---

archive/issue_events_097268.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-21T10:45:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97268"
}
```



---

archive/issue_events_097269.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-21T10:45:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12020#event-97269"
}
```



---

archive/issue_comments_130014.json:
```json
{
    "body": "**Merged:** sage-4.8.alpha3",
    "created_at": "2011-11-21T10:45:42Z",
    "issue": "https://github.com/sagemath/sage/issues/12020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12020#issuecomment-130014",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.8.alpha3
