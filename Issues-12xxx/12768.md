# Issue 12768: Better plotting for isogeny graphs of elliptic curves, and handling of LMFDB labels

archive/issues_012596.json:
```json
{
    "body": "There are only 17 different possible isogeny graphs for elliptic curves over Q.  It would be nice if the isogeny graph was laid out in the same way each time, and if the labels corresponded to the Cremona labels of the curves in the isogeny class.\n\nThe second major topic handled by this ticket is to implement handling of LMFDB labels for elliptic curves as well as Cremona labels, and the conversions between these.  the third is a new class for isogeny classes of elliptic curves over Q.\n\nApply: [attachment:12768.patch], [attachment:12768-review.patch], [attachment:trac_12768-rebase-to-13109.patch]\n\nAssignee: @JohnCremona\n\nCC:  @JohnCremona @kedlaya @vbraun\n\nReviewer: John Cremona, Volker Braun\n\nAuthor: David Roe, John Palmieri\n\nMerged: sage-5.3.beta0\n\nDependencies: #12769, #13109\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12768\n\n",
    "closed_at": "2012-08-01T12:10:42Z",
    "created_at": "2012-03-28T11:42:39Z",
    "labels": [
        "component: elliptic curves",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "Better plotting for isogeny graphs of elliptic curves, and handling of LMFDB labels",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12768",
    "user": "https://github.com/roed314"
}
```
There are only 17 different possible isogeny graphs for elliptic curves over Q.  It would be nice if the isogeny graph was laid out in the same way each time, and if the labels corresponded to the Cremona labels of the curves in the isogeny class.

The second major topic handled by this ticket is to implement handling of LMFDB labels for elliptic curves as well as Cremona labels, and the conversions between these.  the third is a new class for isogeny classes of elliptic curves over Q.

Apply: [attachment:12768.patch], [attachment:12768-review.patch], [attachment:trac_12768-rebase-to-13109.patch]

Assignee: @JohnCremona

CC:  @JohnCremona @kedlaya @vbraun

Reviewer: John Cremona, Volker Braun

Author: David Roe, John Palmieri

Merged: sage-5.3.beta0

Dependencies: #12769, #13109

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12768





---

archive/issue_comments_149561.json:
```json
{
    "body": "<a id='comment:1'></a>I still need to finish doctesting this, but I wanted to post it now since I'm not going to be able to work on it tomorrow.  It adds the capability to make curves from LMFDB labels, to reorder isogeny classes, and makes the plot for the graph of an isogeny class deterministic.  I have a corresponding patch to the LMFDB code that fixes all the problems I've observed with ordering and plotting.",
    "created_at": "2012-04-02T05:24:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149561",
    "user": "https://github.com/roed314"
}
```

<a id='comment:1'></a>I still need to finish doctesting this, but I wanted to post it now since I'm not going to be able to work on it tomorrow.  It adds the capability to make curves from LMFDB labels, to reorder isogeny classes, and makes the plot for the graph of an isogeny class deterministic.  I have a corresponding patch to the LMFDB code that fixes all the problems I've observed with ordering and plotting.



---

archive/issue_comments_149562.json:
```json
{
    "body": "Ready for review",
    "created_at": "2012-04-05T22:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149562",
    "user": "https://github.com/roed314"
}
```

Ready for review



---

archive/issue_comments_149563.json:
```json
{
    "body": "<a id='comment:2'></a>Attachment [12768.patch](tarball://root/attachments/some-uuid/ticket12768/12768.patch) by @roed314 created at 2012-04-05 23:00:58\n\nThe tests in `sage/schemes/elliptic_curves` pass for me.  Let's see what patchbot says.",
    "created_at": "2012-04-05T23:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149563",
    "user": "https://github.com/roed314"
}
```

<a id='comment:2'></a>Attachment [12768.patch](tarball://root/attachments/some-uuid/ticket12768/12768.patch) by @roed314 created at 2012-04-05 23:00:58

The tests in `sage/schemes/elliptic_curves` pass for me.  Let's see what patchbot says.



---

archive/issue_comments_149564.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-04-05T23:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149564",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_149565.json:
```json
{
    "body": "<a id='comment:4'></a>Patchbot says \"angry red blob\", I'm afraid. Here's the problem:\n\n```\npatching file sage/databases/cremona.py\nHunk #5 FAILED at 792\n1 out of 6 hunks FAILED -- saving rejects to file sage/databases/cremona.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh 12768.patch\n```",
    "created_at": "2012-04-07T10:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149565",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:4'></a>Patchbot says "angry red blob", I'm afraid. Here's the problem:

```
patching file sage/databases/cremona.py
Hunk #5 FAILED at 792
1 out of 6 hunks FAILED -- saving rejects to file sage/databases/cremona.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh 12768.patch
```



---

archive/issue_comments_149566.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-07T10:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149566",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_149567.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-08T03:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149567",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_149568.json:
```json
{
    "body": "<a id='comment:6'></a>Oops.  Forgot a dependency.",
    "created_at": "2012-04-08T03:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149568",
    "user": "https://github.com/roed314"
}
```

<a id='comment:6'></a>Oops.  Forgot a dependency.



---

archive/issue_comments_149569.json:
```json
{
    "body": "<a id='comment:7'></a>Patch applies fine after the one from #12769.  Checking the code now.",
    "created_at": "2012-04-10T13:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149569",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>Patch applies fine after the one from #12769.  Checking the code now.



---

archive/issue_comments_149570.json:
```json
{
    "body": "<a id='comment:8'></a>Review:  This patch implements three different things:  (1) A new class for isogeny classes of elliptic curves (currently only for curves over Q); (2) implementation of the new (March 2012) LMFDB labels for elliptic curves over Q, with utilities for comverting to and from Cremona labels; (3) better layouts for isogeny graphs of elliptic curves over Q.\n\nI have been through the code in some detail and only found some minor things to fix, as in the reviewer's patch.  One of these was a typo causing doctest failure.  Nothing more than minor.  If David R is happy with these, I'll give the ticket a positive review.",
    "created_at": "2012-04-10T15:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149570",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>Review:  This patch implements three different things:  (1) A new class for isogeny classes of elliptic curves (currently only for curves over Q); (2) implementation of the new (March 2012) LMFDB labels for elliptic curves over Q, with utilities for comverting to and from Cremona labels; (3) better layouts for isogeny graphs of elliptic curves over Q.

I have been through the code in some detail and only found some minor things to fix, as in the reviewer's patch.  One of these was a typo causing doctest failure.  Nothing more than minor.  If David R is happy with these, I'll give the ticket a positive review.



---

archive/issue_comments_149571.json:
```json
{
    "body": "<a id='comment:9'></a>The changes all look fine to me, but the fourth hunk for `ell_rational_field` in the review patch fails to apply.  I'll try to fix it later tonight, but if you get to it first go for it.",
    "created_at": "2012-04-10T20:01:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149571",
    "user": "https://github.com/roed314"
}
```

<a id='comment:9'></a>The changes all look fine to me, but the fourth hunk for `ell_rational_field` in the review patch fails to apply.  I'll try to fix it later tonight, but if you get to it first go for it.



---

archive/issue_comments_149572.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-10T20:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149572",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_149573.json:
```json
{
    "body": "<a id='comment:11'></a>My patch was based on 5.0.beta13, if that helps.  By the way, the reason I changed ell_generic to ell_rational_field was so that when testing a valid elliptic curve defined over a different field for membership of the isogenyclass one just gets False instead of an error as before;  but I forgot to add some doctests to illustrate.",
    "created_at": "2012-04-10T21:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149573",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>My patch was based on 5.0.beta13, if that helps.  By the way, the reason I changed ell_generic to ell_rational_field was so that when testing a valid elliptic curve defined over a different field for membership of the isogenyclass one just gets False instead of an error as before;  but I forgot to add some doctests to illustrate.



---

archive/issue_comments_149574.json:
```json
{
    "body": "Apply after previous",
    "created_at": "2012-04-30T02:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149574",
    "user": "https://github.com/JohnCremona"
}
```

Apply after previous



---

archive/issue_comments_149575.json:
```json
{
    "body": "<a id='comment:12'></a>Attachment [12768-review.patch](tarball://root/attachments/some-uuid/ticket12768/12768-review.patch) by @JohnCremona created at 2012-04-30 02:10:08\n\nI have updated the review patch: it used to be that when asking for order='database' for a curve not in the database, this was caught but the error message output itself raised a confusing error (on trying to output %self). \u00a0Instead the error message now uses %self.E. \u00a0I added a doctest which illustrates this.\n\nI give David's original patch a positive review modulo my own reviewer's patch, so if David (or anyone) thinks my patch is OK, please give the whole ticket a positive review. \u00a0I tested this on 5.0.beta14.",
    "created_at": "2012-04-30T02:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149575",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>Attachment [12768-review.patch](tarball://root/attachments/some-uuid/ticket12768/12768-review.patch) by @JohnCremona created at 2012-04-30 02:10:08

I have updated the review patch: it used to be that when asking for order='database' for a curve not in the database, this was caught but the error message output itself raised a confusing error (on trying to output %self).  Instead the error message now uses %self.E.  I added a doctest which illustrates this.

I give David's original patch a positive review modulo my own reviewer's patch, so if David (or anyone) thinks my patch is OK, please give the whole ticket a positive review.  I tested this on 5.0.beta14.



---

archive/issue_comments_149576.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-30T02:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149576",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_149577.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-08T19:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149577",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149578.json:
```json
{
    "body": "<a id='comment:13'></a>John's changes look fine to me.",
    "created_at": "2012-06-08T19:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149578",
    "user": "https://github.com/roed314"
}
```

<a id='comment:13'></a>John's changes look fine to me.



---

archive/issue_events_034706.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:35:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34706"
}
```



---

archive/issue_comments_149579.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-06-30T18:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149579",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_149580.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-06-30T18:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149580",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_149581.json:
```json
{
    "body": "<a id='comment:16'></a>Attachment [trac_12768-rebase-to-13109.patch](tarball://root/attachments/some-uuid/ticket12768/trac_12768-rebase-to-13109.patch) by @jhpalmieri created at 2012-06-30 18:51:00\n\nOnly the rebase patch needs to be reviewed.",
    "created_at": "2012-06-30T18:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149581",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>Attachment [trac_12768-rebase-to-13109.patch](tarball://root/attachments/some-uuid/ticket12768/trac_12768-rebase-to-13109.patch) by @jhpalmieri created at 2012-06-30 18:51:00

Only the rebase patch needs to be reviewed.



---

archive/issue_comments_149582.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-30T20:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149582",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149583.json:
```json
{
    "body": "<a id='comment:17'></a>Looks good to me!",
    "created_at": "2012-06-30T20:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149583",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>Looks good to me!



---

archive/issue_comments_149584.json:
```json
{
    "body": "Attachment [trac_12768-rebase-to-13109.v2.patch](tarball://root/attachments/some-uuid/ticket12768/trac_12768-rebase-to-13109.v2.patch) by @jhpalmieri created at 2012-06-30 20:16:22",
    "created_at": "2012-06-30T20:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149584",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_12768-rebase-to-13109.v2.patch](tarball://root/attachments/some-uuid/ticket12768/trac_12768-rebase-to-13109.v2.patch) by @jhpalmieri created at 2012-06-30 20:16:22



---

archive/issue_comments_149585.json:
```json
{
    "body": "<a id='comment:18'></a>Should I add a doctest for the deprecation? The 'v2' patch does that, so if you want to use that instead, change the ticket description accordingly.",
    "created_at": "2012-06-30T20:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149585",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>Should I add a doctest for the deprecation? The 'v2' patch does that, so if you want to use that instead, change the ticket description accordingly.



---

archive/issue_events_034707.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34707"
}
```



---

archive/issue_events_034708.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34708"
}
```



---

archive/issue_comments_149586.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 jdemeyer]:\n\nWhy not 5.2?",
    "created_at": "2012-07-01T18:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149586",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'></a>Replying to [comment:19 jdemeyer]:

Why not 5.2?



---

archive/issue_comments_149587.json:
```json
{
    "body": "<a id='comment:21'></a>Because of the long chain of dependencies which might not all be merged in sage-5.2.  Maybe they will, but I can't guarantee.",
    "created_at": "2012-07-01T19:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149587",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Because of the long chain of dependencies which might not all be merged in sage-5.2.  Maybe they will, but I can't guarantee.



---

archive/issue_events_034709.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:24:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34709"
}
```



---

archive/issue_events_034710.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:24:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "milestone": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34710"
}
```



---

archive/issue_events_034711.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12768#event-34711"
}
```



---

archive/issue_comments_149588.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-01T12:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149588",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_149589.json:
```json
{
    "body": "<a id='comment:24'></a>I think it is time that the deparecation message introduced here is removed.",
    "created_at": "2013-10-28T09:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149589",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:24'></a>I think it is time that the deparecation message introduced here is removed.



---

archive/issue_comments_149590.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 cremona]:\n> I think it is time that the deprecation message introduced here is removed.\n\n\nSee #15694.",
    "created_at": "2014-01-18T17:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12768#issuecomment-149590",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:25'></a>Replying to [comment:24 cremona]:
> I think it is time that the deprecation message introduced here is removed.


See #15694.
