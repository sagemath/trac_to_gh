# Issue 12507: Mark random symbolic expression doctests with #random

archive/issues_012335.json:
```json
{
    "body": "Three doctests in `sage/symbolic/random_tests.py` change expected value whenever a new symbolic function is added to Sage. In particular,\n\n```\nsage: [f for (one,f,arity) in _mk_full_functions()]\n```\n\n```\nsage: random_expr(50, nvars=3, coeff_generator=CDF.random_element)\n```\n\n```\nsage: random_expr(5, verbose=True)\n```\n\nThis makes adding symbolic functions to the Sage library somewhat painful, especially if more than one such patch is contributed per Sage release.\n\nThe patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.\n\n**Apply**: [attachment:trac_12507_v2.patch].\n\n**Assignee:** @burcin\n\n**CC:**  @burcin\n\n**Keywords:** random, symbolic, doctest\n\n**Author:** Benjamin Jones\n\n**Reviewer:** Burcin Erocal\n\n**Merged:** sage-5.0.beta5\n\nIssue created by migration from https://trac.sagemath.org/ticket/12507\n\n",
    "closed_at": "2012-02-22T10:47:27Z",
    "created_at": "2012-02-14T05:35:13Z",
    "labels": [
        "component: symbolics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Mark random symbolic expression doctests with #random",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12507",
    "user": "https://github.com/benjaminfjones"
}
```
Three doctests in `sage/symbolic/random_tests.py` change expected value whenever a new symbolic function is added to Sage. In particular,

```
sage: [f for (one,f,arity) in _mk_full_functions()]
```

```
sage: random_expr(50, nvars=3, coeff_generator=CDF.random_element)
```

```
sage: random_expr(5, verbose=True)
```

This makes adding symbolic functions to the Sage library somewhat painful, especially if more than one such patch is contributed per Sage release.

The patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.

**Apply**: [attachment:trac_12507_v2.patch].

**Assignee:** @burcin

**CC:**  @burcin

**Keywords:** random, symbolic, doctest

**Author:** Benjamin Jones

**Reviewer:** Burcin Erocal

**Merged:** sage-5.0.beta5

Issue created by migration from https://trac.sagemath.org/ticket/12507





---

archive/issue_comments_172968.json:
```json
{
    "body": "mark random symbolic doctest with #random tag",
    "created_at": "2012-02-14T05:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172968",
    "user": "https://github.com/benjaminfjones"
}
```

mark random symbolic doctest with #random tag



---

archive/attachments_016816.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12507.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12507/trac_12507.patch",
    "created_at": "2012-02-14T05:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_172969.json:
```json
{
    "body": "<a id='comment:1'></a>\n",
    "created_at": "2012-02-14T05:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172969",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:1'></a>




---

archive/issue_comments_172970.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-02-14T10:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172970",
    "user": "https://github.com/burcin"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_172971.json:
```json
{
    "body": "**Reviewer:** Burcin Erocal",
    "created_at": "2012-02-14T10:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172971",
    "user": "https://github.com/burcin"
}
```

**Reviewer:** Burcin Erocal



---

archive/issue_comments_172972.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-02-14T10:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172972",
    "user": "https://github.com/burcin"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_172973.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,3 +16,4 @@\n \n The patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.\n   \n+Apply attachment:trac_12507.patch.\n``````\n",
    "created_at": "2012-02-14T10:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172973",
    "user": "https://github.com/burcin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,3 +16,4 @@
 
 The patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.
   
+Apply attachment:trac_12507.patch.
``````




---

archive/issue_comments_172974.json:
```json
{
    "body": "<a id='comment:4'></a>\nHmm.   While the second two are essentially 'random', I do have two questions.\n   * How is `# random` usually used in our doctests?  It seems like it's used when the answer is random, not when the answer is very non-random but changes with new functionality.\n   * The first test is actually kind of neat, because it shows what we all have.  Maybe it could be made non-random, but using a `...`  syntax?  I know that fairly recently we even then would have had to change things, but at least that would slow the rate of needing to change that test down a lot, and still preserve it as a test checking that we weren't importing something really weird by mistake.\nThat said, the sentiment behind this is fine.\n\n---\nDoes this depend on #9130?",
    "created_at": "2012-02-16T04:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172974",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Hmm.   While the second two are essentially 'random', I do have two questions.
   * How is `# random` usually used in our doctests?  It seems like it's used when the answer is random, not when the answer is very non-random but changes with new functionality.
   * The first test is actually kind of neat, because it shows what we all have.  Maybe it could be made non-random, but using a `...`  syntax?  I know that fairly recently we even then would have had to change things, but at least that would slow the rate of needing to change that test down a lot, and still preserve it as a test checking that we weren't importing something really weird by mistake.
That said, the sentiment behind this is fine.

---
Does this depend on #9130?



---

archive/issue_comments_172975.json:
```json
{
    "body": "Mark random symbolic doctest with #random tag; rebase to 5.0.beta4",
    "created_at": "2012-02-16T19:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172975",
    "user": "https://github.com/benjaminfjones"
}
```

Mark random symbolic doctest with #random tag; rebase to 5.0.beta4



---

archive/attachments_016817.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12507_v2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12507/trac_12507_v2.patch",
    "created_at": "2012-02-16T19:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_172976.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [kcrisman](#comment%3A4):\n> Hmm.   While the second two are essentially 'random', I do have two questions.\n>    * How is `# random` usually used in our doctests?  It seems like it's used when the answer is random, not when the answer is very non-random but changes with new functionality.\n>    * The first test is actually kind of neat, because it shows what we all have.  Maybe it could be made non-random, but using a `...`  syntax?  I know that fairly recently we even then would have had to change things, but at least that would slow the rate of needing to change that test down a lot, and still preserve it as a test checking that we weren't importing something really weird by mistake.\n> That said, the sentiment behind this is fine.\n\n\nIt's my understanding that a doctest with a #random tag is run and runtime errors are reported, but the output of the test is not checked against the result listed in the docstring. I agree, the output of those \"random\" tests is not random, the same random seed is set at the start of the tests. I can't find the use of `...` documented in the developer guide. In the guide the `hash` function is given as an example of a doctest that is marked #random because the output depends on the machine and the state of the python interpreter presumably. This doesn't mean the output of `hash` is random, just hard to determine at runtime.\n\n\n> ---\n> Does this depend on #9130?\n\n\nIt doesn't depend on #9130, but I just rebased the patch to 5.0.beta4 because #4489 was merged and that changed the random tests. The patch [attachment:trac_12507_v2.patch] applies cleanly to 5.0.beta4 now.",
    "created_at": "2012-02-16T19:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172976",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:5'></a>
Replying to [kcrisman](#comment%3A4):
> Hmm.   While the second two are essentially 'random', I do have two questions.
>    * How is `# random` usually used in our doctests?  It seems like it's used when the answer is random, not when the answer is very non-random but changes with new functionality.
>    * The first test is actually kind of neat, because it shows what we all have.  Maybe it could be made non-random, but using a `...`  syntax?  I know that fairly recently we even then would have had to change things, but at least that would slow the rate of needing to change that test down a lot, and still preserve it as a test checking that we weren't importing something really weird by mistake.
> That said, the sentiment behind this is fine.


It's my understanding that a doctest with a #random tag is run and runtime errors are reported, but the output of the test is not checked against the result listed in the docstring. I agree, the output of those "random" tests is not random, the same random seed is set at the start of the tests. I can't find the use of `...` documented in the developer guide. In the guide the `hash` function is given as an example of a doctest that is marked #random because the output depends on the machine and the state of the python interpreter presumably. This doesn't mean the output of `hash` is random, just hard to determine at runtime.


> ---
> Does this depend on #9130?


It doesn't depend on #9130, but I just rebased the patch to 5.0.beta4 because #4489 was merged and that changed the random tests. The patch [attachment:trac_12507_v2.patch] applies cleanly to 5.0.beta4 now.



---

archive/issue_comments_172977.json:
```json
{
    "body": "<a id='comment:6'></a>\nI meant #4498 in my last comment.",
    "created_at": "2012-02-16T19:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172977",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:6'></a>
I meant #4498 in my last comment.



---

archive/issue_comments_172978.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Be sure to update the \"apply\" part of the description when needed**",
    "created_at": "2012-02-17T23:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172978",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
**Be sure to update the "apply" part of the description when needed**



---

archive/issue_comments_172979.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,5 +15,5 @@\n This makes adding symbolic functions to the Sage library somewhat painful, especially if more than one such patch is contributed per Sage release.\n \n The patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.\n-  \n-Apply attachment:trac_12507.patch.\n+\n+**Apply**: [attachment:trac_12507_v2.patch].\n``````\n",
    "created_at": "2012-02-17T23:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172979",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,5 +15,5 @@
 This makes adding symbolic functions to the Sage library somewhat painful, especially if more than one such patch is contributed per Sage release.
 
 The patch provided marks the three particular random tests using `#random` so that the doctest framework ignores the output from such tests.
-  
-Apply attachment:trac_12507.patch.
+
+**Apply**: [attachment:trac_12507_v2.patch].
``````




---

archive/issue_events_039092.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-22T10:47:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12507#event-39092"
}
```



---

archive/issue_comments_172980.json:
```json
{
    "body": "**Merged:** sage-5.0.beta5",
    "created_at": "2012-02-22T10:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12507#issuecomment-172980",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.beta5
