# Issue 12967: bugs in comparisons between constants, wrapped pyobjects, infinity

archive/issues_012795.json:
```json
{
    "assignees": [],
    "body": "We have \n\n```\nsage: bool(pi<Infinity)\nFalse\nsage: bool(pi>Infinity)\nTrue\n```\nwhich is obviously wrong. It seems that the problem only occurs with `pi`, because the following give correct results\n\n```\nsage: bool(pi<2*pi)\nTrue\nsage: bool(2*pi<Infinity)\nTrue\nsage: bool(e<Infinity)  \nTrue\nsage: bool(e<pi)\nTrue\n```\n\nThis was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n\nSee the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n\nhttps://github.com/pynac/pynac/issues/69\n\n---\nPreviously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n\n\nAssignee: **@burcin**\n\nCC:  @kcrisman\n\nKeywords: **compare pi infinity bool**\n\nReviewer: **Karl-Dieter Crisman, Daniel Krenn**\n\nAuthor: **Travis Scrimshaw, Ralf Stephan**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12967_\n\n",
    "closed_at": "2015-12-20T18:36:23Z",
    "created_at": "2012-05-18T08:16:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "bugs in comparisons between constants, wrapped pyobjects, infinity",
    "type": "issue",
    "updated_at": "2015-12-20T18:36:23Z",
    "url": "https://github.com/sagemath/sage/issues/12967",
    "user": "https://github.com/dkrenn"
}
```
We have 

```
sage: bool(pi<Infinity)
False
sage: bool(pi>Infinity)
True
```
which is obviously wrong. It seems that the problem only occurs with `pi`, because the following give correct results

```
sage: bool(pi<2*pi)
True
sage: bool(2*pi<Infinity)
True
sage: bool(e<Infinity)  
True
sage: bool(e<pi)
True
```

This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.

See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 

https://github.com/pynac/pynac/issues/69

---
Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).


Assignee: **@burcin**

CC:  @kcrisman

Keywords: **compare pi infinity bool**

Reviewer: **Karl-Dieter Crisman, Daniel Krenn**

Author: **Travis Scrimshaw, Ralf Stephan**

_Issue created by migration from https://trac.sagemath.org/ticket/12967_





---

archive/issue_events_164316.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164316"
}
```



---

archive/issue_events_164317.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164317"
}
```



---

archive/issue_events_164318.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164318"
}
```



---

archive/issue_events_164319.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164319"
}
```



---

archive/issue_comments_149450.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nATM, this is caused by #11506:\n\n```\nsage: pi.pyobject()\npi\nsage: type(pi.pyobject())\n<class 'sage.symbolic.constants.Pi'>\nsage: pi.pyobject() < oo        \nFalse\nsage: pi.pyobject() > oo\nTrue\n```\n\nWith #12950,  comparison of infinities in Pynac changed. Now I get:\n\n```\nsage: bool(pi>Infinity)\nFalse\nsage: bool(pi<Infinity) \nFalse\n```\n\nwhich is better. I hope with the ordering patches in the Pynac queue this will improve.\n\nThe results of comparison with `e` is not relevant in this case. `e` is not a constant in Pynac, it is the `exp()` function. Once you form the relational expression `e < Infinity`, the comparison is handled differently.\n\nI suggest adding a patch with doctests reflecting the new behavior with #12950 and closing this ticket when #12950 is merged.",
    "created_at": "2012-05-18T09:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149450",
    "user": "https://github.com/burcin"
}
```

<a id='comment:1'>Comment 1:</a>
ATM, this is caused by #11506:

```
sage: pi.pyobject()
pi
sage: type(pi.pyobject())
<class 'sage.symbolic.constants.Pi'>
sage: pi.pyobject() < oo        
False
sage: pi.pyobject() > oo
True
```

With #12950,  comparison of infinities in Pynac changed. Now I get:

```
sage: bool(pi>Infinity)
False
sage: bool(pi<Infinity) 
False
```

which is better. I hope with the ordering patches in the Pynac queue this will improve.

The results of comparison with `e` is not relevant in this case. `e` is not a constant in Pynac, it is the `exp()` function. Once you form the relational expression `e < Infinity`, the comparison is handled differently.

I suggest adding a patch with doctests reflecting the new behavior with #12950 and closing this ticket when #12950 is merged.



---

archive/issue_comments_149451.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nHere's the quick patch with some doctests reflecting the new behavior.",
    "created_at": "2012-12-10T22:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149451",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'>Comment 3:</a>
Here's the quick patch with some doctests reflecting the new behavior.



---

archive/issue_comments_149452.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2012-12-10T22:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149452",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_events_164320.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:03:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164320"
}
```



---

archive/issue_events_164321.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-10T22:16:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164321"
}
```



---

archive/issue_events_164322.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-10T22:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164322"
}
```



---

archive/issue_comments_149453.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\n\n```\n\n----------------------------------------------------------------------\n| Sage Version 5.4.1, Release Date: 2012-11-15                       |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n----------------------------------------------------------------------\nsage: bool(pi < infinity)\nFalse\nsage: bool(oo < pi)\nFalse\n```\nThat is what should actually be tested, as Burcin points out.  Also, I feel like this is unintuitive enough of behavior (that pi is more or less incomparable with infinity and not like this)\n\n```\nsage: bool(2< oo)\nTrue\n```\nthat we should say something to that effect here, maybe even elsewhere in comparison doc where we have other examples saying that `>` gives `False` if we can't prove it's `True`.\n\nI'm also wondering whether this is really \"fixed\" and deserves that doctest status.",
    "created_at": "2012-12-10T22:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149453",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'>Comment 4:</a>

```

----------------------------------------------------------------------
| Sage Version 5.4.1, Release Date: 2012-11-15                       |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |
----------------------------------------------------------------------
sage: bool(pi < infinity)
False
sage: bool(oo < pi)
False
```
That is what should actually be tested, as Burcin points out.  Also, I feel like this is unintuitive enough of behavior (that pi is more or less incomparable with infinity and not like this)

```
sage: bool(2< oo)
True
```
that we should say something to that effect here, maybe even elsewhere in comparison doc where we have other examples saying that `>` gives `False` if we can't prove it's `True`.

I'm also wondering whether this is really "fixed" and deserves that doctest status.



---

archive/issue_comments_149454.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nHow about this? Can you think of any other places to put the warning about symbolic ring comparisons? Thanks.",
    "created_at": "2012-12-10T22:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149454",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>Comment 5:</a>
How about this? Can you think of any other places to put the warning about symbolic ring comparisons? Thanks.



---

archive/issue_events_164323.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:51:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164323"
}
```



---

archive/issue_events_164324.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:51:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164324"
}
```



---

archive/issue_comments_149455.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nThere is a typo I am fixing in a review patch.\n\nOtherwise I'll give the patch qua patch positive review - I don't think there is more you can do here, this seems fine and passes tests etc. - but wait on a comment from Burcin or someone else as to whether this should count as a fix before pressing the button.  I guess I'm just a little uncomfortable with that, though I understand the sentiment and could be easily persuaded by a third party.",
    "created_at": "2012-12-11T03:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149455",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'>Comment 6:</a>
There is a typo I am fixing in a review patch.

Otherwise I'll give the patch qua patch positive review - I don't think there is more you can do here, this seems fine and passes tests etc. - but wait on a comment from Burcin or someone else as to whether this should count as a fix before pressing the button.  I guess I'm just a little uncomfortable with that, though I understand the sentiment and could be easily persuaded by a third party.



---

archive/issue_comments_149456.json:
```json
{
    "body": "Apply only this patch",
    "created_at": "2012-12-11T03:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149456",
    "user": "https://github.com/kcrisman"
}
```

Apply only this patch



---

archive/issue_comments_149457.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149457",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_comments_149458.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,3 +20,5 @@\n ```\n \n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n+\n+**Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n``````\n",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149458",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,3 +20,5 @@
 ```
 
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
+
+**Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
``````




---

archive/issue_comments_149459.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nAttachment: **[trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz)**\n\nPatchbot, apply trac_12967-symbolic_ring-review.patch",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149459",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'>Comment 7:</a>
Attachment: **[trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz)**

Patchbot, apply trac_12967-symbolic_ring-review.patch



---

archive/issue_comments_149460.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nI'll let someone else set this to positive review, and I do understand your discomfort. Thank you for the review.",
    "created_at": "2012-12-11T04:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149460",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>Comment 8:</a>
I'll let someone else set this to positive review, and I do understand your discomfort. Thank you for the review.



---

archive/issue_comments_149461.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThis is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.",
    "created_at": "2012-12-11T07:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149461",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:9'>Comment 9:</a>
This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.



---

archive/issue_events_164325.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-18T19:39:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164325"
}
```



---

archive/issue_events_164326.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-18T19:39:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164326"
}
```



---

archive/issue_events_164327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164327"
}
```



---

archive/issue_events_164328.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164328"
}
```



---

archive/issue_events_164329.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164329"
}
```



---

archive/issue_events_164330.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164330"
}
```



---

archive/issue_events_164331.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164331"
}
```



---

archive/issue_events_164332.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164332"
}
```



---

archive/issue_comments_149462.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@ppurka](#comment%3A9):\n> This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.\n\nI agree.  This comparison is apparently done by Pynac.  Using Maxima gives the correct result:\n\n```\nsage: e = (SR(pi) < SR(Infinity)); e\npi < +Infinity\nsage: bool(e)\nFalse\nsage: maxima(e)\n%pi<inf\nsage: bool(maxima(e))\nTrue\n```\n(This is not fixed by #11506, by the way.)",
    "created_at": "2014-05-22T19:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149462",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@ppurka](#comment%3A9):
> This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.

I agree.  This comparison is apparently done by Pynac.  Using Maxima gives the correct result:

```
sage: e = (SR(pi) < SR(Infinity)); e
pi < +Infinity
sage: bool(e)
False
sage: maxima(e)
%pi<inf
sage: bool(maxima(e))
True
```
(This is not fixed by #11506, by the way.)



---

archive/issue_events_164333.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-22T19:25:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164333"
}
```



---

archive/issue_events_164334.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-22T19:25:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164334"
}
```



---

archive/issue_comments_149463.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nSee #16397 for more (but unrelated, I think) SR comparison issues.",
    "created_at": "2014-05-25T17:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149463",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'>Comment 15:</a>
See #16397 for more (but unrelated, I think) SR comparison issues.



---

archive/issue_comments_149464.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nAlso interesting:\n\n```\nsage: cmp(SR(oo), sqrt(2))\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-7-aaaac68122b2> in <module>()\n----> 1 cmp(SR(oo), sqrt(Integer(2)))\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.__cmp__ (sage/symbolic/expression.cpp:16780)()\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element._cmp (sage/structure/element.c:8490)()\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._cmp_c_impl (sage/symbolic/expression.cpp:16834)()\n\nRuntimeError: comparing typeid's\n```\nPrint order is broken for some combination of symbolic ex'es.",
    "created_at": "2014-05-25T21:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149464",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'>Comment 16:</a>
Also interesting:

```
sage: cmp(SR(oo), sqrt(2))
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-7-aaaac68122b2> in <module>()
----> 1 cmp(SR(oo), sqrt(Integer(2)))

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.__cmp__ (sage/symbolic/expression.cpp:16780)()

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element._cmp (sage/structure/element.c:8490)()

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._cmp_c_impl (sage/symbolic/expression.cpp:16834)()

RuntimeError: comparing typeid's
```
Print order is broken for some combination of symbolic ex'es.



---

archive/issue_events_164335.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164335"
}
```



---

archive/issue_events_164336.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164336"
}
```



---

archive/issue_comments_149465.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@burcin](#comment%3A1):\n> \n> ```\n> sage: bool(pi>Infinity)\n> False\n> sage: bool(pi<Infinity) \n> False\n> ```\n> \n> which is better. I hope with the ordering patches in the Pynac queue this will improve.\n\nStill not improved. What is meant exactly here? Does someone have a link to a ticket somewhere?",
    "created_at": "2015-02-22T08:36:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149465",
    "user": "https://github.com/rwst"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@burcin](#comment%3A1):
> 
> ```
> sage: bool(pi>Infinity)
> False
> sage: bool(pi<Infinity) 
> False
> ```
> 
> which is better. I hope with the ordering patches in the Pynac queue this will improve.

Still not improved. What is meant exactly here? Does someone have a link to a ticket somewhere?



---

archive/issue_comments_149466.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nif something is incomparable or the answer is not known \nthe way to go is an exception; see discussion at \nhttps://groups.google.com/forum/#!msg/sage-devel/vNxnHSeRBW4/0OpeL0yv9YUJ\n(or a multistate result, which cannot be converted or compared with a bool (`True/False`);\n\nEverything else is in my opinion a major design flaw and will lead to plethora of bugs !!!",
    "created_at": "2015-02-22T13:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149466",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<a id='comment:19'>Comment 19:</a>
if something is incomparable or the answer is not known 
the way to go is an exception; see discussion at 
https://groups.google.com/forum/#!msg/sage-devel/vNxnHSeRBW4/0OpeL0yv9YUJ
(or a multistate result, which cannot be converted or compared with a bool (`True/False`);

Everything else is in my opinion a major design flaw and will lead to plethora of bugs !!!



---

archive/issue_events_164337.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-22T13:42:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164337"
}
```



---

archive/issue_events_164338.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-22T13:42:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164338"
}
```



---

archive/issue_comments_149467.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,3 +22,5 @@\n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n \n **Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+\n+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n``````\n",
    "created_at": "2015-02-22T13:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149467",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,3 +22,5 @@
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
 
 **Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+
+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
``````




---

archive/issue_comments_149468.json:
```json
{
    "body": "Branch: **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)**",
    "created_at": "2015-02-23T08:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149468",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)**



---

archive/issue_events_164339.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "title_is": "bugs in comparisons between constants, wrapped pyobjects, infinity",
    "title_was": "comparison of pi and infinity wrong",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164339"
}
```



---

archive/issue_events_164340.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164340"
}
```



---

archive/issue_events_164341.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164341"
}
```



---

archive/issue_comments_149469.json:
```json
{
    "body": "Commit: **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)**",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149469",
    "user": "https://github.com/rwst"
}
```

Commit: **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)**



---

archive/issue_comments_149470.json:
```json
{
    "body": "Changed author from **Travis Scrimshaw** to **Travis Scrimshaw, Ralf Stephan**",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149470",
    "user": "https://github.com/rwst"
}
```

Changed author from **Travis Scrimshaw** to **Travis Scrimshaw, Ralf Stephan**



---

archive/issue_comments_149471.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nThis utilizes the `InfinityRing` for comparison. Doctest failures related to infinities show there is more to do.\n\nReplying to [jakobkroeker](#comment%3A19):\n> if something is incomparable or the answer is not known \n> the way to go is an exception\n\nYou will understand this all cannot be part of this ticket.\nEDIT: Actually the failing doctests support your opinion, and probably I better adapt the tests to the new behaviour.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a\">8ef555c</a></td><td><code>12967: comparisons between constants, wrapped pyobjects, infinity</code></td></tr></table>\n",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149471",
    "user": "https://github.com/rwst"
}
```

<a id='comment:22'>Comment 22:</a>
This utilizes the `InfinityRing` for comparison. Doctest failures related to infinities show there is more to do.

Replying to [jakobkroeker](#comment%3A19):
> if something is incomparable or the answer is not known 
> the way to go is an exception

You will understand this all cannot be part of this ticket.
EDIT: Actually the failing doctests support your opinion, and probably I better adapt the tests to the new behaviour.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a">8ef555c</a></td><td><code>12967: comparisons between constants, wrapped pyobjects, infinity</code></td></tr></table>




---

archive/issue_comments_149472.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3\">8861762</a></td><td><code>12967: put back some removed code; fixes doctests</code></td></tr></table>\n",
    "created_at": "2015-02-23T09:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149472",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3">8861762</a></td><td><code>12967: put back some removed code; fixes doctests</code></td></tr></table>




---

archive/issue_comments_149473.json:
```json
{
    "body": "Changed commit from **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)** to **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)**",
    "created_at": "2015-02-23T09:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149473",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)** to **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)**



---

archive/issue_comments_149474.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\n\n```\nsage -t --long src/sage/structure/parent.pyx\n**********************************************************************\nFile \"src/sage/structure/parent.pyx\", line 1224, in sage.structure.parent.Parent.__contains__\nFailed example:\n    pi in RIF # there is no element of RIF equal to pi\nExpected:\n    False\nGot:\n    True\n```",
    "created_at": "2015-02-24T07:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149474",
    "user": "https://github.com/rwst"
}
```

<a id='comment:24'>Comment 24:</a>

```
sage -t --long src/sage/structure/parent.pyx
**********************************************************************
File "src/sage/structure/parent.pyx", line 1224, in sage.structure.parent.Parent.__contains__
Failed example:
    pi in RIF # there is no element of RIF equal to pi
Expected:
    False
Got:
    True
```



---

archive/issue_events_164342.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-24T07:22:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164342"
}
```



---

archive/issue_events_164343.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-24T07:22:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164343"
}
```



---

archive/issue_comments_149475.json:
```json
{
    "body": "Changed commit from **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)** to **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)**",
    "created_at": "2015-02-25T07:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149475",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)** to **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)**



---

archive/issue_comments_149476.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d\">7ac556f</a></td><td><code>12967: interval comparison now raises TypeError</code></td></tr></table>\n",
    "created_at": "2015-02-25T07:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149476",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d">7ac556f</a></td><td><code>12967: interval comparison now raises TypeError</code></td></tr></table>




---

archive/issue_events_164344.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-25T07:21:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164344"
}
```



---

archive/issue_events_164345.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-25T07:21:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164345"
}
```



---

archive/issue_comments_149477.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947\">91cd2a6</a></td><td><code>12967: improve previous fix</code></td></tr></table>\n",
    "created_at": "2015-02-26T08:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149477",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947">91cd2a6</a></td><td><code>12967: improve previous fix</code></td></tr></table>




---

archive/issue_comments_149478.json:
```json
{
    "body": "Changed commit from **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)** to **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)**",
    "created_at": "2015-02-26T08:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149478",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)** to **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)**



---

archive/issue_events_164346.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T08:20:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164346"
}
```



---

archive/issue_events_164347.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T08:20:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164347"
}
```



---

archive/issue_comments_149479.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nIt was wrong to always raise an exception when an interval was compared. The reason why `pi in RIF` was `True` rather lies in `structure.parent.py:Parent.contains()` where the line\n\n```\nEQ = (x2 == x)\n```\ndidn't account for symbolics and should read\n\n```\nEQ = bool(x2 == x)\n```\nThis uncovers another bug in `Expression.nonzero()` which shows as\n\n```\nsage: bool(sqrt(2)==CC(sqrt(2)))\nFalse\n```\nbecause `sqrt(2) == 1.41421356237309` is `False`. Any ideas how to fit this in the current code?\n\nEDIT: See also https://groups.google.com/forum/?hl=en#!topic/sage-devel/QBAipylR6iM",
    "created_at": "2015-02-26T08:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149479",
    "user": "https://github.com/rwst"
}
```

<a id='comment:28'>Comment 28:</a>
It was wrong to always raise an exception when an interval was compared. The reason why `pi in RIF` was `True` rather lies in `structure.parent.py:Parent.contains()` where the line

```
EQ = (x2 == x)
```
didn't account for symbolics and should read

```
EQ = bool(x2 == x)
```
This uncovers another bug in `Expression.nonzero()` which shows as

```
sage: bool(sqrt(2)==CC(sqrt(2)))
False
```
because `sqrt(2) == 1.41421356237309` is `False`. Any ideas how to fit this in the current code?

EDIT: See also https://groups.google.com/forum/?hl=en#!topic/sage-devel/QBAipylR6iM



---

archive/issue_comments_149480.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10\">0adb1d3</a></td><td><code>12967: dedicated CC.__contains__</code></td></tr></table>\n",
    "created_at": "2015-02-26T17:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149480",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>Comment 29:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10">0adb1d3</a></td><td><code>12967: dedicated CC.__contains__</code></td></tr></table>




---

archive/issue_comments_149481.json:
```json
{
    "body": "Changed commit from **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)** to **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)**",
    "created_at": "2015-02-26T17:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149481",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)** to **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)**



---

archive/issue_events_164348.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T17:36:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164348"
}
```



---

archive/issue_events_164349.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T17:36:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164349"
}
```



---

archive/issue_comments_149482.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nResolved by a dedicated `CC.__contains__`.",
    "created_at": "2015-02-26T17:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149482",
    "user": "https://github.com/rwst"
}
```

<a id='comment:30'>Comment 30:</a>
Resolved by a dedicated `CC.__contains__`.



---

archive/issue_comments_149483.json:
```json
{
    "body": "Changed branch from **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)** to none",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149483",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)** to none



---

archive/issue_events_164350.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-04T16:14:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164350"
}
```



---

archive/issue_events_164351.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-04T16:14:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164351"
}
```



---

archive/issue_comments_149484.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nNo, I give up. Better fix pynac.",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149484",
    "user": "https://github.com/rwst"
}
```

<a id='comment:31'>Comment 31:</a>
No, I give up. Better fix pynac.



---

archive/issue_comments_149485.json:
```json
{
    "body": "Changed commit from **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)** to none",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149485",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)** to none



---

archive/issue_comments_149486.json:
```json
{
    "body": "Branch: **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)**",
    "created_at": "2015-03-19T09:06:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149486",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)**



---

archive/issue_comments_149487.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReboot. This branch has clean logic handling all relations that can be decided without Maxima. I have left in the call to Pynac's `relational_to_bool` although it could possibly replaced too. The branch depends on #17984.\n\nHowever, there is one doctest failure:\n\n```\nFile \"src/sage/structure/parent.pyx\", line 1224, in sage.structure.parent.Parent.__contains__\nFailed example:\n    pi in RIF # there is no element of RIF equal to pi\nExpected:\n    False\nGot:\n    True\n```\nIt is caused because `Parent.__contains__` assumes wrongly that all\nequations that are of type `Expression` must be true, and `pi == RIF(pi)` isn't.\nIn develop this is masked by code catching all kinds of exceptions that hides the fact that the conversion of the relation to Maxima throws an exception. The code takes this to mean that `pi == RIF(pi)` is `False`. In contrast this branch determines without invoking Maxima correctly that the relation is `False` but the fact no exception is thrown leads to `Parent.__contains__` returning `True`! Since it's clearly wrong here to throw an exception just to oblige `Parent.__contains__` that method in turn must be fixed.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39ab5b2a9f6057e08a7aced6f58daa2de3c4cbe6\">39ab5b2</a></td><td><code>17984: Dedicated RR.__contains__() and CC.__contains__()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a22a6e47dabea2b8b4c42ee7e21b0a8777a8dba4\">a22a6e4</a></td><td><code>17984: description in docstring; fixes and doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/544450ea18ed2778953141bab8feced61237556e\">544450e</a></td><td><code>17984: fix typo in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3\">c5845f6</a></td><td><code>12967: get relations with infinities right</code></td></tr></table>\n",
    "created_at": "2015-03-19T09:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149487",
    "user": "https://github.com/rwst"
}
```

<a id='comment:33'>Comment 33:</a>
Reboot. This branch has clean logic handling all relations that can be decided without Maxima. I have left in the call to Pynac's `relational_to_bool` although it could possibly replaced too. The branch depends on #17984.

However, there is one doctest failure:

```
File "src/sage/structure/parent.pyx", line 1224, in sage.structure.parent.Parent.__contains__
Failed example:
    pi in RIF # there is no element of RIF equal to pi
Expected:
    False
Got:
    True
```
It is caused because `Parent.__contains__` assumes wrongly that all
equations that are of type `Expression` must be true, and `pi == RIF(pi)` isn't.
In develop this is masked by code catching all kinds of exceptions that hides the fact that the conversion of the relation to Maxima throws an exception. The code takes this to mean that `pi == RIF(pi)` is `False`. In contrast this branch determines without invoking Maxima correctly that the relation is `False` but the fact no exception is thrown leads to `Parent.__contains__` returning `True`! Since it's clearly wrong here to throw an exception just to oblige `Parent.__contains__` that method in turn must be fixed.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39ab5b2a9f6057e08a7aced6f58daa2de3c4cbe6">39ab5b2</a></td><td><code>17984: Dedicated RR.__contains__() and CC.__contains__()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a22a6e47dabea2b8b4c42ee7e21b0a8777a8dba4">a22a6e4</a></td><td><code>17984: description in docstring; fixes and doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/544450ea18ed2778953141bab8feced61237556e">544450e</a></td><td><code>17984: fix typo in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3">c5845f6</a></td><td><code>12967: get relations with infinities right</code></td></tr></table>




---

archive/issue_comments_149488.json:
```json
{
    "body": "Commit: **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)**",
    "created_at": "2015-03-19T09:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149488",
    "user": "https://github.com/rwst"
}
```

Commit: **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)**



---

archive/issue_events_164352.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-19T09:08:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164352"
}
```



---

archive/issue_events_164353.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-19T09:08:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164353"
}
```



---

archive/issue_comments_149489.json:
```json
{
    "body": "Dependencies: **#17984**",
    "created_at": "2015-03-19T09:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149489",
    "user": "https://github.com/rwst"
}
```

Dependencies: **#17984**



---

archive/issue_events_164354.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-03-19T09:48:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164354"
}
```



---

archive/issue_events_164355.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-03-19T09:48:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164355"
}
```



---

archive/issue_comments_149490.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nI'm afraid this implementation of `__contains__()` will make `Mod(1, 2) in RR` return `True`, which is obviously wrong.  This is probably the reason why the nonsense input in the Chebyshev doctests is no longer detected.\n\nI am in general hesitant about the idea of needing a custom `__contains__()` method; the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.  How about fixing `__cmp__()` (or similar) when comparing symbolic expressions with numerical approximations so that (for example)  `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?",
    "created_at": "2015-03-19T09:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149490",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:35'>Comment 35:</a>
I'm afraid this implementation of `__contains__()` will make `Mod(1, 2) in RR` return `True`, which is obviously wrong.  This is probably the reason why the nonsense input in the Chebyshev doctests is no longer detected.

I am in general hesitant about the idea of needing a custom `__contains__()` method; the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.  How about fixing `__cmp__()` (or similar) when comparing symbolic expressions with numerical approximations so that (for example)  `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?



---

archive/issue_comments_149491.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nNa\u00efve question: what would be the problem with simply making `SR` coerce into `InfinityRing` instead of the reverse?",
    "created_at": "2015-03-19T13:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149491",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:36'>Comment 36:</a>
Nave question: what would be the problem with simply making `SR` coerce into `InfinityRing` instead of the reverse?



---

archive/issue_comments_149492.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [@pjbruin](#comment%3A35):\n> `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?\n\nThis sounds very dangerous to me.",
    "created_at": "2015-03-19T13:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149492",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [@pjbruin](#comment%3A35):
> `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?

This sounds very dangerous to me.



---

archive/issue_comments_149493.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nReplying to [@pjbruin](#comment%3A35):\n>...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\nIt would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.",
    "created_at": "2015-03-19T13:43:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149493",
    "user": "https://github.com/rwst"
}
```

<a id='comment:38'>Comment 38:</a>
Replying to [@pjbruin](#comment%3A35):
>...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.



---

archive/issue_comments_149494.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nReplying to [@rwst](#comment%3A38):\n> Replying to [@pjbruin](#comment%3A35):\n> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\n> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\nBut currently the precision is already taken care of in this way:\n\n```\nsage: pi.n(10) in RR\nTrue\nsage: pi.n(100) in RealField(50)\nTrue\n```\nIsn't this what you want to keep as the correct behaviour?",
    "created_at": "2015-03-19T13:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149494",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:39'>Comment 39:</a>
Replying to [@rwst](#comment%3A38):
> Replying to [@pjbruin](#comment%3A35):
> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

But currently the precision is already taken care of in this way:

```
sage: pi.n(10) in RR
True
sage: pi.n(100) in RealField(50)
True
```
Isn't this what you want to keep as the correct behaviour?



---

archive/issue_comments_149495.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nReplying to [@rwst](#comment%3A38):\n> the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\nI view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like \"the reals\", and it would be wrong to view them as such!",
    "created_at": "2015-03-19T13:51:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149495",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:40'>Comment 40:</a>
Replying to [@rwst](#comment%3A38):
> the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like "the reals", and it would be wrong to view them as such!



---

archive/issue_comments_149496.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nReplying to [@mezzarobba](#comment%3A37):\n> Replying to [@pjbruin](#comment%3A35):\n> > `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?\n\n> \n> This sounds very dangerous to me.\n\nIn fact, `bool(pi == pi.n())` already returns `True`, which I think is reasonable.  In any case it is consistent with how elements of real fields of different precisions are compared.\n\nThe question is whether we also want to use this for `x in RR`.  I currently cannot think of a natural way of implementing this.  Just checking whether `x` can be converted in to `RR` is not enough (as the example with `Mod(1, 2)` in [comment:35](#comment%3A35) shows); one would at least expect that `x` can be converted into `RR` *and* that the result is \"sufficiently equal\" to the original `x`.",
    "created_at": "2015-03-19T13:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149496",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:41'>Comment 41:</a>
Replying to [@mezzarobba](#comment%3A37):
> Replying to [@pjbruin](#comment%3A35):
> > `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?

> 
> This sounds very dangerous to me.

In fact, `bool(pi == pi.n())` already returns `True`, which I think is reasonable.  In any case it is consistent with how elements of real fields of different precisions are compared.

The question is whether we also want to use this for `x in RR`.  I currently cannot think of a natural way of implementing this.  Just checking whether `x` can be converted in to `RR` is not enough (as the example with `Mod(1, 2)` in [comment:35](#comment%3A35) shows); one would at least expect that `x` can be converted into `RR` *and* that the result is "sufficiently equal" to the original `x`.



---

archive/issue_comments_149497.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nReplying to [@mezzarobba](#comment%3A40):\n> I view that as a misunderstanding\n\nWrong perspective. Rather a bad design decision.",
    "created_at": "2015-03-19T13:54:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149497",
    "user": "https://github.com/rwst"
}
```

<a id='comment:42'>Comment 42:</a>
Replying to [@mezzarobba](#comment%3A40):
> I view that as a misunderstanding

Wrong perspective. Rather a bad design decision.



---

archive/issue_comments_149498.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nReplying to [@mezzarobba](#comment%3A40):\n> Replying to [@rwst](#comment%3A38):\n> > the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\n> \n> I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like \"the reals\", and it would be wrong to view them as such!\n\nFrom that perspective, `pi in RR` should return `False`.  I personally wouldn't be opposed to this, but since there is some subtlety involved, I would expect many users won't like this.",
    "created_at": "2015-03-19T13:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149498",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:43'>Comment 43:</a>
Replying to [@mezzarobba](#comment%3A40):
> Replying to [@rwst](#comment%3A38):
> > the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

> 
> I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like "the reals", and it would be wrong to view them as such!

From that perspective, `pi in RR` should return `False`.  I personally wouldn't be opposed to this, but since there is some subtlety involved, I would expect many users won't like this.



---

archive/issue_comments_149499.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nMaybe we should discourage users from using `x in RR`.  There is the following alternative:\n\n```\nsage: pi.is_real()\nTrue\n```",
    "created_at": "2015-03-19T13:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149499",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:44'>Comment 44:</a>
Maybe we should discourage users from using `x in RR`.  There is the following alternative:

```
sage: pi.is_real()
True
```



---

archive/issue_comments_149500.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nReplying to [@pjbruin](#comment%3A41):\n>I currently cannot think of a natural way of implementing this. \n\nWhy generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.",
    "created_at": "2015-03-19T13:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149500",
    "user": "https://github.com/rwst"
}
```

<a id='comment:45'>Comment 45:</a>
Replying to [@pjbruin](#comment%3A41):
>I currently cannot think of a natural way of implementing this. 

Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.



---

archive/issue_comments_149501.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nReplying to [@pjbruin](#comment%3A44):\n> Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> \n> ```\n> sage: pi.is_real()\n> True\n> ```\n\nI'm fine with that too. `RR.__contains__()` is then used for the error.",
    "created_at": "2015-03-19T14:03:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149501",
    "user": "https://github.com/rwst"
}
```

<a id='comment:46'>Comment 46:</a>
Replying to [@pjbruin](#comment%3A44):
> Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> 
> ```
> sage: pi.is_real()
> True
> ```

I'm fine with that too. `RR.__contains__()` is then used for the error.



---

archive/issue_comments_149502.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nReplying to [@pjbruin](#comment%3A44):\n> Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> \n> ```\n> sage: pi.is_real()\n> True\n> ```\n\nI don't think this is a good idea. This breaks consistency across the different fields. Sage is quite inconsistent already from a user point of view, we shouldn't introduce more such inconsistencies.",
    "created_at": "2015-03-19T14:05:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149502",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:47'>Comment 47:</a>
Replying to [@pjbruin](#comment%3A44):
> Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> 
> ```
> sage: pi.is_real()
> True
> ```

I don't think this is a good idea. This breaks consistency across the different fields. Sage is quite inconsistent already from a user point of view, we shouldn't introduce more such inconsistencies.



---

archive/issue_comments_149503.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nReplying to [@rwst](#comment%3A45):\n> Replying to [@pjbruin](#comment%3A41):\n> >I currently cannot think of a natural way of implementing this. \n\n> Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.\n\nI meant I cannot think of a better way than `bool(RR(x) == x)`.  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...  At most we could use the `is_real()` method, but looking a bit more into this, I think it does not work very well either:\n\n```\nsage: e.is_real()\nFalse\n```",
    "created_at": "2015-03-19T14:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149503",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:48'>Comment 48:</a>
Replying to [@rwst](#comment%3A45):
> Replying to [@pjbruin](#comment%3A41):
> >I currently cannot think of a natural way of implementing this. 

> Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.

I meant I cannot think of a better way than `bool(RR(x) == x)`.  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...  At most we could use the `is_real()` method, but looking a bit more into this, I think it does not work very well either:

```
sage: e.is_real()
False
```



---

archive/issue_comments_149504.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nReplying to [@ppurka](#comment%3A47):\n> Replying to [@pjbruin](#comment%3A44):\n> > Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> > \n> > ```\n> > sage: pi.is_real()\n> > True\n> > ```\n\n> \n> I don't think this is a good idea. This breaks consistency across the different fields.\n\nOnly if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.",
    "created_at": "2015-03-19T14:12:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149504",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:49'>Comment 49:</a>
Replying to [@ppurka](#comment%3A47):
> Replying to [@pjbruin](#comment%3A44):
> > Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> > 
> > ```
> > sage: pi.is_real()
> > True
> > ```

> 
> I don't think this is a good idea. This breaks consistency across the different fields.

Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.



---

archive/issue_comments_149505.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nReplying to [@pjbruin](#comment%3A49):\n> Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.\n\nExactly. If we want consistency across Sage, then the semantics of `x in RR` *cannot* be \"`x` is a real number\"; it must be \"`x` is an element of the parent `RR`\" or something similar.",
    "created_at": "2015-03-19T14:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149505",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:50'>Comment 50:</a>
Replying to [@pjbruin](#comment%3A49):
> Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.

Exactly. If we want consistency across Sage, then the semantics of `x in RR` *cannot* be "`x` is a real number"; it must be "`x` is an element of the parent `RR`" or something similar.



---

archive/issue_comments_149506.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nReplying to [@pjbruin](#comment%3A48):\n> ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...\n\nBug fixing is always ad hoc. You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.",
    "created_at": "2015-03-19T14:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149506",
    "user": "https://github.com/rwst"
}
```

<a id='comment:51'>Comment 51:</a>
Replying to [@pjbruin](#comment%3A48):
> ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...

Bug fixing is always ad hoc. You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.



---

archive/issue_comments_149507.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nReplying to [@rwst](#comment%3A38):\n> Replying to [@pjbruin](#comment%3A35):\n> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\n> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision`.\n\nI don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?",
    "created_at": "2015-03-19T14:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149507",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'>Comment 52:</a>
Replying to [@rwst](#comment%3A38):
> Replying to [@pjbruin](#comment%3A35):
> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision`.

I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?



---

archive/issue_comments_149508.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nReplying to [@rwst](#comment%3A51):\n> Replying to [@pjbruin](#comment%3A48):\n> > ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...\n\n> Bug fixing is always ad hoc.\n\nNot at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.\n> You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.\n\nI disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.\n\nThe more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?",
    "created_at": "2015-03-19T14:53:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149508",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:53'>Comment 53:</a>
Replying to [@rwst](#comment%3A51):
> Replying to [@pjbruin](#comment%3A48):
> > ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...

> Bug fixing is always ad hoc.

Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.
> You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.

I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.

The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?



---

archive/issue_comments_149509.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nReplying to [@jdemeyer](#comment%3A52):\n> I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?\n\nThere seemed to be a precision problem:\nhttps://groups.google.com/d/topic/sage-devel/QBAipylR6iM/discussion",
    "created_at": "2015-03-19T15:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149509",
    "user": "https://github.com/rwst"
}
```

<a id='comment:54'>Comment 54:</a>
Replying to [@jdemeyer](#comment%3A52):
> I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?

There seemed to be a precision problem:
https://groups.google.com/d/topic/sage-devel/QBAipylR6iM/discussion



---

archive/issue_comments_149510.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nReplying to [@pjbruin](#comment%3A53):\n> Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.\n\nI strongly agree with that. Making specific examples work with no regard for global consistency usually means introducing bugs, not fixing them.\n\n> > You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.\n\n> I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.\n\nI tend to agree. Note however that the current definition is more along the lines of `parent(x) == P or P(x) == x`, which may not be the same (think of intervals or objects that may not compare as equal to copies of themselves).\n\n> The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?\n\nAs I repeat on every possible occasion, comparisons in sage are broken in more ways than I can count. One of the fundamental reasons IMHO is that there should be at least two kinds of comparisons (in addition to `is`), call them *strict* comparisons and *semantic* comparisons. Under *strict* equality, for instance, elements of different parents would always compare as unequal, and elements of a parent with no normal form would typically compare as equal only if they have the same syntactic representation. *Semantic* equality however could attempt coercing the elements in a common parent much like `==` currently does. (I believe that `==` should refer to the *strict* equality since, among other things, that would avoid many of the problems with hashing. But I know that many people disagree.)\n\nClearly we are talking about *semantic* equality here, but I believe making the previous distinction (at least conceptually) helps separating the issues. Now about your examples: with the current model with a single equality predicate, my answer is **NOOO!!! ** in both cases. With a separate *strict* equality, it is less clear-cut, but intuitively I would still expect both results to be `False`.",
    "created_at": "2015-03-19T15:45:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149510",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:55'>Comment 55:</a>
Replying to [@pjbruin](#comment%3A53):
> Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.

I strongly agree with that. Making specific examples work with no regard for global consistency usually means introducing bugs, not fixing them.

> > You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.

> I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.

I tend to agree. Note however that the current definition is more along the lines of `parent(x) == P or P(x) == x`, which may not be the same (think of intervals or objects that may not compare as equal to copies of themselves).

> The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?

As I repeat on every possible occasion, comparisons in sage are broken in more ways than I can count. One of the fundamental reasons IMHO is that there should be at least two kinds of comparisons (in addition to `is`), call them *strict* comparisons and *semantic* comparisons. Under *strict* equality, for instance, elements of different parents would always compare as unequal, and elements of a parent with no normal form would typically compare as equal only if they have the same syntactic representation. *Semantic* equality however could attempt coercing the elements in a common parent much like `==` currently does. (I believe that `==` should refer to the *strict* equality since, among other things, that would avoid many of the problems with hashing. But I know that many people disagree.)

Clearly we are talking about *semantic* equality here, but I believe making the previous distinction (at least conceptually) helps separating the issues. Now about your examples: with the current model with a single equality predicate, my answer is **NOOO!!! ** in both cases. With a separate *strict* equality, it is less clear-cut, but intuitively I would still expect both results to be `False`.



---

archive/issue_comments_149511.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nGiven that it would be more consistent (but less user-friendly) to not mix **R** with `RR`, and `item.is_real()` is buggy, the fix of that is critical (#16436, #17117 are aspects). The `Parent.__contains__` method would have to be adapted and a warning added. Maybe this even leads to a more consistent `Parent.__contains__`. The fix of the behaviour of `bool(item==P(item))` is then less urgent (because it's rarely used otherwise). As to this ticket where failing comparisons with `oo` are described, the code does fix these but leaves at least the `pi in RIF` doctest failing (explanation in [comment:33](#comment%3A33)), and possibly more if I remove the `RR/CC.__contains__`. This could benefit from a more consistent `Parent.__contains__` so let's go on.",
    "created_at": "2015-03-19T16:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149511",
    "user": "https://github.com/rwst"
}
```

<a id='comment:56'>Comment 56:</a>
Given that it would be more consistent (but less user-friendly) to not mix **R** with `RR`, and `item.is_real()` is buggy, the fix of that is critical (#16436, #17117 are aspects). The `Parent.__contains__` method would have to be adapted and a warning added. Maybe this even leads to a more consistent `Parent.__contains__`. The fix of the behaviour of `bool(item==P(item))` is then less urgent (because it's rarely used otherwise). As to this ticket where failing comparisons with `oo` are described, the code does fix these but leaves at least the `pi in RIF` doctest failing (explanation in [comment:33](#comment%3A33)), and possibly more if I remove the `RR/CC.__contains__`. This could benefit from a more consistent `Parent.__contains__` so let's go on.



---

archive/issue_comments_149512.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nThe symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.",
    "created_at": "2015-04-01T16:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149512",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:57'>Comment 57:</a>
The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.



---

archive/issue_comments_149513.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nSo we need another ticket for\n\n```\nsage: bool(sqrt(2)<oo)\nFalse\n```",
    "created_at": "2015-04-01T16:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149513",
    "user": "https://github.com/rwst"
}
```

<a id='comment:58'>Comment 58:</a>
So we need another ticket for

```
sage: bool(sqrt(2)<oo)
False
```



---

archive/issue_comments_149514.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nAs I have now a better overview, at least some cases could and should be fixed in Pynac. This is https://github.com/pynac/pynac/issues/69",
    "created_at": "2015-06-10T15:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149514",
    "user": "https://github.com/rwst"
}
```

<a id='comment:59'>Comment 59:</a>
As I have now a better overview, at least some cases could and should be fixed in Pynac. This is https://github.com/pynac/pynac/issues/69



---

archive/issue_comments_149515.json:
```json
{
    "body": "Upstream: **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2015-06-10T15:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149515",
    "user": "https://github.com/rwst"
}
```

Upstream: **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_149516.json:
```json
{
    "body": "<a id='comment:60'>Comment 60:</a>\nReplying to [@vbraun](#comment%3A57):\n> The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.\n\nHow would `NaN` be coerced? Or a future `Aleph2`?",
    "created_at": "2015-06-18T13:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149516",
    "user": "https://github.com/rwst"
}
```

<a id='comment:60'>Comment 60:</a>
Replying to [@vbraun](#comment%3A57):
> The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.

How would `NaN` be coerced? Or a future `Aleph2`?



---

archive/issue_comments_149517.json:
```json
{
    "body": "Changed branch from **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)** to none",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149517",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)** to none



---

archive/issue_events_164356.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-06-19T16:08:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164356"
}
```



---

archive/issue_events_164357.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-06-19T16:08:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164357"
}
```



---

archive/issue_comments_149518.json:
```json
{
    "body": "Changed dependencies from **#17984** to **pynac-0.3.9.2**",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149518",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#17984** to **pynac-0.3.9.2**



---

archive/issue_comments_149519.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nPynac git master has a fix that does this:\n\n```\nsage: bool(SR(oo) > 5)\nTrue\nsage: bool(5 < SR(oo))\nTrue\nsage: bool(SR(2)<Infinity)\nTrue\nsage: bool(pi<Infinity)\nTrue\nsage: bool(pi>Infinity)\nFalse\nsage: bool(2*pi<Infinity)\nTrue\nsage: bool(SR(pi) < SR(Infinity))\nTrue\nsage: bool(sqrt(2)<oo)\nTrue\nsage: bool(log(2)<oo)\nTrue\nsage: bool(e<oo)\nTrue\nsage: bool(e+pi<oo)\nTrue\nsage: bool(e^pi<oo)\nTrue\nsage: bool(SR(2)<-oo)\nFalse\nsage: bool(SR(2)>-oo)\nTrue\nsage: bool(exp(2)>-oo)\nTrue\nsage: bool(SR(oo) > sqrt(2))\nTrue\nsage: bool(sqrt(2) < SR(oo))\nTrue\nsage: bool(SR(-oo) < sqrt(2))\nTrue\nsage: bool(sqrt(2) > SR(-oo))\nTrue\n```\nIt uses info flags and evalf where applicable. Some function info flags were introduced earlier in Pynac.",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149519",
    "user": "https://github.com/rwst"
}
```

<a id='comment:61'>Comment 61:</a>
Pynac git master has a fix that does this:

```
sage: bool(SR(oo) > 5)
True
sage: bool(5 < SR(oo))
True
sage: bool(SR(2)<Infinity)
True
sage: bool(pi<Infinity)
True
sage: bool(pi>Infinity)
False
sage: bool(2*pi<Infinity)
True
sage: bool(SR(pi) < SR(Infinity))
True
sage: bool(sqrt(2)<oo)
True
sage: bool(log(2)<oo)
True
sage: bool(e<oo)
True
sage: bool(e+pi<oo)
True
sage: bool(e^pi<oo)
True
sage: bool(SR(2)<-oo)
False
sage: bool(SR(2)>-oo)
True
sage: bool(exp(2)>-oo)
True
sage: bool(SR(oo) > sqrt(2))
True
sage: bool(sqrt(2) < SR(oo))
True
sage: bool(SR(-oo) < sqrt(2))
True
sage: bool(sqrt(2) > SR(-oo))
True
```
It uses info flags and evalf where applicable. Some function info flags were introduced earlier in Pynac.



---

archive/issue_comments_149520.json:
```json
{
    "body": "Changed commit from **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)** to none",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149520",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)** to none



---

archive/issue_comments_149521.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,6 +21,10 @@\n \n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n \n-**Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n \n-See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n+https://github.com/pynac/pynac/issues/69\n+\n+---\n+Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+\n``````\n",
    "created_at": "2015-06-19T16:11:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149521",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,6 +21,10 @@
 
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
 
-**Apply** [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
 
-See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
+https://github.com/pynac/pynac/issues/69
+
+---
+Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+
``````




---

archive/issue_comments_149522.json:
```json
{
    "body": "Changed dependencies from **pynac-0.3.9.2** to none",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149522",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **pynac-0.3.9.2** to none



---

archive/issue_events_164358.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-07-16T06:54:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164358"
}
```



---

archive/issue_events_164359.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-07-16T06:54:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164359"
}
```



---

archive/issue_comments_149523.json:
```json
{
    "body": "<a id='comment:63'>Comment 63:</a>\nThe above is doctested in #17321 so what remains here that is not #16397?",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149523",
    "user": "https://github.com/rwst"
}
```

<a id='comment:63'>Comment 63:</a>
The above is doctested in #17321 so what remains here that is not #16397?



---

archive/issue_comments_149524.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to none",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149524",
    "user": "https://github.com/rwst"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to none



---

archive/issue_events_164360.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164360"
}
```



---

archive/issue_events_164361.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164361"
}
```



---

archive/issue_events_164362.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164362"
}
```



---

archive/issue_events_164363.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164363"
}
```



---

archive/issue_events_164364.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164364"
}
```



---

archive/issue_events_164365.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2015-12-20T13:34:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164365"
}
```



---

archive/issue_events_164366.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2015-12-20T13:34:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164366"
}
```



---

archive/issue_comments_149525.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Daniel Krenn**",
    "created_at": "2015-12-20T13:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-149525",
    "user": "https://github.com/dkrenn"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Daniel Krenn**



---

archive/issue_events_164367.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164367"
}
```



---

archive/issue_events_164368.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164368"
}
```



---

archive/issue_events_164369.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-164369"
}
```
