# Issue 12967: bugs in comparisons between constants, wrapped pyobjects, infinity

archive/issues_012795.json:
```json
{
    "assignees": [
        "https://github.com/burcin"
    ],
    "body": "We have \n\n```\nsage: bool(pi<Infinity)\nFalse\nsage: bool(pi>Infinity)\nTrue\n```\nwhich is obviously wrong. It seems that the problem only occurs with `pi`, because the following give correct results\n\n```\nsage: bool(pi<2*pi)\nTrue\nsage: bool(2*pi<Infinity)\nTrue\nsage: bool(e<Infinity)  \nTrue\nsage: bool(e<pi)\nTrue\n```\n\nThis was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n\nSee the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n\nhttps://github.com/pynac/pynac/issues/69\n\n---\nPreviously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n\n\nCC:  @kcrisman\n\nKeywords: **compare pi infinity bool**\n\nReviewer: **Karl-Dieter Crisman, Daniel Krenn**\n\nAuthor: **Travis Scrimshaw, Ralf Stephan**\n\nComponent: **symbolics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12967_\n\n",
    "closed_at": "2015-12-20T18:36:23Z",
    "created_at": "2012-05-18T08:16:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "bugs in comparisons between constants, wrapped pyobjects, infinity",
    "type": "issue",
    "updated_at": "2015-12-20T18:36:23Z",
    "url": "https://github.com/sagemath/sage/issues/12967",
    "user": "https://github.com/dkrenn"
}
```
We have 

```
sage: bool(pi<Infinity)
False
sage: bool(pi>Infinity)
True
```
which is obviously wrong. It seems that the problem only occurs with `pi`, because the following give correct results

```
sage: bool(pi<2*pi)
True
sage: bool(2*pi<Infinity)
True
sage: bool(e<Infinity)  
True
sage: bool(e<pi)
True
```

This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.

See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 

https://github.com/pynac/pynac/issues/69

---
Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).


CC:  @kcrisman

Keywords: **compare pi infinity bool**

Reviewer: **Karl-Dieter Crisman, Daniel Krenn**

Author: **Travis Scrimshaw, Ralf Stephan**

Component: **symbolics**

_Issue created by migration from https://trac.sagemath.org/ticket/12967_





---

archive/issue_events_179457.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179457"
}
```



---

archive/issue_events_179458.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179458"
}
```



---

archive/issue_events_179459.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179459"
}
```



---

archive/issue_events_179460.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179460"
}
```



---

archive/issue_events_179461.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-05-18T08:16:35Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "subject": "https://github.com/dkrenn",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179461"
}
```



---

archive/issue_comments_147154.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nATM, this is caused by #11506:\n\n```\nsage: pi.pyobject()\npi\nsage: type(pi.pyobject())\n<class 'sage.symbolic.constants.Pi'>\nsage: pi.pyobject() < oo        \nFalse\nsage: pi.pyobject() > oo\nTrue\n```\n\nWith #12950,  comparison of infinities in Pynac changed. Now I get:\n\n```\nsage: bool(pi>Infinity)\nFalse\nsage: bool(pi<Infinity) \nFalse\n```\n\nwhich is better. I hope with the ordering patches in the Pynac queue this will improve.\n\nThe results of comparison with `e` is not relevant in this case. `e` is not a constant in Pynac, it is the `exp()` function. Once you form the relational expression `e < Infinity`, the comparison is handled differently.\n\nI suggest adding a patch with doctests reflecting the new behavior with #12950 and closing this ticket when #12950 is merged.",
    "created_at": "2012-05-18T09:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147154",
    "user": "https://github.com/burcin"
}
```

<div id="comment:1" align="right">comment:1</div>

ATM, this is caused by #11506:

```
sage: pi.pyobject()
pi
sage: type(pi.pyobject())
<class 'sage.symbolic.constants.Pi'>
sage: pi.pyobject() < oo        
False
sage: pi.pyobject() > oo
True
```

With #12950,  comparison of infinities in Pynac changed. Now I get:

```
sage: bool(pi>Infinity)
False
sage: bool(pi<Infinity) 
False
```

which is better. I hope with the ordering patches in the Pynac queue this will improve.

The results of comparison with `e` is not relevant in this case. `e` is not a constant in Pynac, it is the `exp()` function. Once you form the relational expression `e < Infinity`, the comparison is handled differently.

I suggest adding a patch with doctests reflecting the new behavior with #12950 and closing this ticket when #12950 is merged.



---

archive/issue_comments_147155.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHere's the quick patch with some doctests reflecting the new behavior.",
    "created_at": "2012-12-10T22:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147155",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

Here's the quick patch with some doctests reflecting the new behavior.



---

archive/issue_comments_147156.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2012-12-10T22:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147156",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_events_179462.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:03:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179462"
}
```



---

archive/issue_events_179463.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-10T22:16:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179463"
}
```



---

archive/issue_events_179464.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-10T22:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179464"
}
```



---

archive/issue_comments_147157.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n\n```\n\n----------------------------------------------------------------------\n| Sage Version 5.4.1, Release Date: 2012-11-15                       |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n----------------------------------------------------------------------\nsage: bool(pi < infinity)\nFalse\nsage: bool(oo < pi)\nFalse\n```\nThat is what should actually be tested, as Burcin points out.  Also, I feel like this is unintuitive enough of behavior (that pi is more or less incomparable with infinity and not like this)\n\n```\nsage: bool(2< oo)\nTrue\n```\nthat we should say something to that effect here, maybe even elsewhere in comparison doc where we have other examples saying that `>` gives `False` if we can't prove it's `True`.\n\nI'm also wondering whether this is really \"fixed\" and deserves that doctest status.",
    "created_at": "2012-12-10T22:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147157",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>


```

----------------------------------------------------------------------
| Sage Version 5.4.1, Release Date: 2012-11-15                       |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |
----------------------------------------------------------------------
sage: bool(pi < infinity)
False
sage: bool(oo < pi)
False
```
That is what should actually be tested, as Burcin points out.  Also, I feel like this is unintuitive enough of behavior (that pi is more or less incomparable with infinity and not like this)

```
sage: bool(2< oo)
True
```
that we should say something to that effect here, maybe even elsewhere in comparison doc where we have other examples saying that `>` gives `False` if we can't prove it's `True`.

I'm also wondering whether this is really "fixed" and deserves that doctest status.



---

archive/issue_comments_147158.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHow about this? Can you think of any other places to put the warning about symbolic ring comparisons? Thanks.",
    "created_at": "2012-12-10T22:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147158",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

How about this? Can you think of any other places to put the warning about symbolic ring comparisons? Thanks.



---

archive/issue_events_179465.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:51:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179465"
}
```



---

archive/issue_events_179466.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-10T22:51:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179466"
}
```



---

archive/issue_comments_147159.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThere is a typo I am fixing in a review patch.\n\nOtherwise I'll give the patch qua patch positive review - I don't think there is more you can do here, this seems fine and passes tests etc. - but wait on a comment from Burcin or someone else as to whether this should count as a fix before pressing the button.  I guess I'm just a little uncomfortable with that, though I understand the sentiment and could be easily persuaded by a third party.",
    "created_at": "2012-12-11T03:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147159",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

There is a typo I am fixing in a review patch.

Otherwise I'll give the patch qua patch positive review - I don't think there is more you can do here, this seems fine and passes tests etc. - but wait on a comment from Burcin or someone else as to whether this should count as a fix before pressing the button.  I guess I'm just a little uncomfortable with that, though I understand the sentiment and could be easily persuaded by a third party.



---

archive/issue_comments_147160.json:
```json
{
    "body": "Apply only this patch",
    "created_at": "2012-12-11T03:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147160",
    "user": "https://github.com/kcrisman"
}
```

Apply only this patch



---

archive/issue_comments_147161.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147161",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_comments_147162.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,3 +20,5 @@\n ```\n \n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n+\n+**Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n``````\n",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147162",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,3 +20,5 @@
 ```
 
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
+
+**Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
``````




---

archive/issue_comments_147163.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz)**\n\nPatchbot, apply trac_12967-symbolic_ring-review.patch",
    "created_at": "2012-12-11T03:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147163",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_12967-symbolic_ring-review.patch.gz](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz)**

Patchbot, apply trac_12967-symbolic_ring-review.patch



---

archive/issue_comments_147164.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI'll let someone else set this to positive review, and I do understand your discomfort. Thank you for the review.",
    "created_at": "2012-12-11T04:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147164",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

I'll let someone else set this to positive review, and I do understand your discomfort. Thank you for the review.



---

archive/issue_comments_147165.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThis is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.",
    "created_at": "2012-12-11T07:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147165",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:9" align="right">comment:9</div>

This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.



---

archive/issue_events_179467.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-18T19:39:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179467"
}
```



---

archive/issue_events_179468.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-18T19:39:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179468"
}
```



---

archive/issue_events_179469.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179469"
}
```



---

archive/issue_events_179470.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179470"
}
```



---

archive/issue_events_179471.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179471"
}
```



---

archive/issue_events_179472.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179472"
}
```



---

archive/issue_events_179473.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179473"
}
```



---

archive/issue_events_179474.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179474"
}
```



---

archive/issue_comments_147166.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@ppurka](#comment:9):\n> This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.\n\nI agree.  This comparison is apparently done by Pynac.  Using Maxima gives the correct result:\n\n```\nsage: e = (SR(pi) < SR(Infinity)); e\npi < +Infinity\nsage: bool(e)\nFalse\nsage: maxima(e)\n%pi<inf\nsage: bool(maxima(e))\nTrue\n```\n(This is not fixed by #11506, by the way.)",
    "created_at": "2014-05-22T19:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147166",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@ppurka](#comment:9):
> This is absurd. Why should `bool(pi < oo)` return `False`? If we have symbolic *constants*, then we should be able to coerce them to some ring, possibly RR, and do the comparison.

I agree.  This comparison is apparently done by Pynac.  Using Maxima gives the correct result:

```
sage: e = (SR(pi) < SR(Infinity)); e
pi < +Infinity
sage: bool(e)
False
sage: maxima(e)
%pi<inf
sage: bool(maxima(e))
True
```
(This is not fixed by #11506, by the way.)



---

archive/issue_events_179475.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-22T19:25:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179475"
}
```



---

archive/issue_events_179476.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-22T19:25:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179476"
}
```



---

archive/issue_comments_147167.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nSee #16397 for more (but unrelated, I think) SR comparison issues.",
    "created_at": "2014-05-25T17:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147167",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

See #16397 for more (but unrelated, I think) SR comparison issues.



---

archive/issue_comments_147168.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAlso interesting:\n\n```\nsage: cmp(SR(oo), sqrt(2))\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-7-aaaac68122b2> in <module>()\n----> 1 cmp(SR(oo), sqrt(Integer(2)))\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.__cmp__ (sage/symbolic/expression.cpp:16780)()\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element._cmp (sage/structure/element.c:8490)()\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._cmp_c_impl (sage/symbolic/expression.cpp:16834)()\n\nRuntimeError: comparing typeid's\n```\nPrint order is broken for some combination of symbolic ex'es.",
    "created_at": "2014-05-25T21:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147168",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Also interesting:

```
sage: cmp(SR(oo), sqrt(2))
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-7-aaaac68122b2> in <module>()
----> 1 cmp(SR(oo), sqrt(Integer(2)))

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.__cmp__ (sage/symbolic/expression.cpp:16780)()

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element._cmp (sage/structure/element.c:8490)()

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._cmp_c_impl (sage/symbolic/expression.cpp:16834)()

RuntimeError: comparing typeid's
```
Print order is broken for some combination of symbolic ex'es.



---

archive/issue_events_179477.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179477"
}
```



---

archive/issue_events_179478.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179478"
}
```



---

archive/issue_comments_147169.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@burcin](#comment:1):\n> \n> ```\n> sage: bool(pi>Infinity)\n> False\n> sage: bool(pi<Infinity) \n> False\n> ```\n> \n> which is better. I hope with the ordering patches in the Pynac queue this will improve.\n\nStill not improved. What is meant exactly here? Does someone have a link to a ticket somewhere?",
    "created_at": "2015-02-22T08:36:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147169",
    "user": "https://github.com/rwst"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@burcin](#comment:1):
> 
> ```
> sage: bool(pi>Infinity)
> False
> sage: bool(pi<Infinity) 
> False
> ```
> 
> which is better. I hope with the ordering patches in the Pynac queue this will improve.

Still not improved. What is meant exactly here? Does someone have a link to a ticket somewhere?



---

archive/issue_comments_147170.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nif something is incomparable or the answer is not known \nthe way to go is an exception; see discussion at \nhttps://groups.google.com/forum/#!msg/sage-devel/vNxnHSeRBW4/0OpeL0yv9YUJ\n(or a multistate result, which cannot be converted or compared with a bool (`True/False`);\n\nEverything else is in my opinion a major design flaw and will lead to plethora of bugs !!!",
    "created_at": "2015-02-22T13:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147170",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<div id="comment:19" align="right">comment:19</div>

if something is incomparable or the answer is not known 
the way to go is an exception; see discussion at 
https://groups.google.com/forum/#!msg/sage-devel/vNxnHSeRBW4/0OpeL0yv9YUJ
(or a multistate result, which cannot be converted or compared with a bool (`True/False`);

Everything else is in my opinion a major design flaw and will lead to plethora of bugs !!!



---

archive/issue_events_179479.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-22T13:42:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179479"
}
```



---

archive/issue_events_179480.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-22T13:42:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179480"
}
```



---

archive/issue_comments_147171.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,3 +22,5 @@\n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n \n **Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+\n+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n``````\n",
    "created_at": "2015-02-22T13:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147171",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,3 +22,5 @@
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
 
 **Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+
+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
``````




---

archive/issue_comments_147172.json:
```json
{
    "body": "Branch: **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)**",
    "created_at": "2015-02-23T08:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147172",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)**



---

archive/issue_events_179481.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "title_is": "bugs in comparisons between constants, wrapped pyobjects, infinity",
    "title_was": "comparison of pi and infinity wrong",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179481"
}
```



---

archive/issue_events_179482.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179482"
}
```



---

archive/issue_events_179483.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-23T08:39:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179483"
}
```



---

archive/issue_comments_147173.json:
```json
{
    "body": "Commit: **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)**",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147173",
    "user": "https://github.com/rwst"
}
```

Commit: **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)**



---

archive/issue_comments_147174.json:
```json
{
    "body": "Changed author from **Travis Scrimshaw** to **Travis Scrimshaw, Ralf Stephan**",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147174",
    "user": "https://github.com/rwst"
}
```

Changed author from **Travis Scrimshaw** to **Travis Scrimshaw, Ralf Stephan**



---

archive/issue_comments_147175.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis utilizes the `InfinityRing` for comparison. Doctest failures related to infinities show there is more to do.\n\nReplying to [@sagetrac-jakobkroeker](#comment:19):\n> if something is incomparable or the answer is not known \n> the way to go is an exception\n\nYou will understand this all cannot be part of this ticket.\nEDIT: Actually the failing doctests support your opinion, and probably I better adapt the tests to the new behaviour.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a\">8ef555c</a></td><td><code>12967: comparisons between constants, wrapped pyobjects, infinity</code></td></tr></table>\n",
    "created_at": "2015-02-23T08:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147175",
    "user": "https://github.com/rwst"
}
```

<div id="comment:22" align="right">comment:22</div>

This utilizes the `InfinityRing` for comparison. Doctest failures related to infinities show there is more to do.

Replying to [@sagetrac-jakobkroeker](#comment:19):
> if something is incomparable or the answer is not known 
> the way to go is an exception

You will understand this all cannot be part of this ticket.
EDIT: Actually the failing doctests support your opinion, and probably I better adapt the tests to the new behaviour.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a">8ef555c</a></td><td><code>12967: comparisons between constants, wrapped pyobjects, infinity</code></td></tr></table>




---

archive/issue_comments_147176.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3\">8861762</a></td><td><code>12967: put back some removed code; fixes doctests</code></td></tr></table>\n",
    "created_at": "2015-02-23T09:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147176",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3">8861762</a></td><td><code>12967: put back some removed code; fixes doctests</code></td></tr></table>




---

archive/issue_comments_147177.json:
```json
{
    "body": "Changed commit from **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)** to **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)**",
    "created_at": "2015-02-23T09:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147177",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8ef555c](https://github.com/sagemath/sagetrac-mirror/commit/8ef555ca391d5b9ba9c056e29ba311d27c23fe9a)** to **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)**



---

archive/issue_comments_147178.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n\n```\nsage -t --long src/sage/structure/parent.pyx\n**********************************************************************\nFile \"src/sage/structure/parent.pyx\", line 1224, in sage.structure.parent.Parent.__contains__\nFailed example:\n    pi in RIF # there is no element of RIF equal to pi\nExpected:\n    False\nGot:\n    True\n```",
    "created_at": "2015-02-24T07:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147178",
    "user": "https://github.com/rwst"
}
```

<div id="comment:24" align="right">comment:24</div>


```
sage -t --long src/sage/structure/parent.pyx
**********************************************************************
File "src/sage/structure/parent.pyx", line 1224, in sage.structure.parent.Parent.__contains__
Failed example:
    pi in RIF # there is no element of RIF equal to pi
Expected:
    False
Got:
    True
```



---

archive/issue_events_179484.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-24T07:22:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179484"
}
```



---

archive/issue_events_179485.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-24T07:22:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179485"
}
```



---

archive/issue_comments_147179.json:
```json
{
    "body": "Changed commit from **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)** to **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)**",
    "created_at": "2015-02-25T07:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147179",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8861762](https://github.com/sagemath/sagetrac-mirror/commit/886176234c0982a6d895cc488657c80aaa387bf3)** to **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)**



---

archive/issue_comments_147180.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d\">7ac556f</a></td><td><code>12967: interval comparison now raises TypeError</code></td></tr></table>\n",
    "created_at": "2015-02-25T07:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147180",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d">7ac556f</a></td><td><code>12967: interval comparison now raises TypeError</code></td></tr></table>




---

archive/issue_events_179486.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-25T07:21:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179486"
}
```



---

archive/issue_events_179487.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-25T07:21:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179487"
}
```



---

archive/issue_comments_147181.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947\">91cd2a6</a></td><td><code>12967: improve previous fix</code></td></tr></table>\n",
    "created_at": "2015-02-26T08:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147181",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947">91cd2a6</a></td><td><code>12967: improve previous fix</code></td></tr></table>




---

archive/issue_comments_147182.json:
```json
{
    "body": "Changed commit from **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)** to **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)**",
    "created_at": "2015-02-26T08:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147182",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7ac556f](https://github.com/sagemath/sagetrac-mirror/commit/7ac556fd4a6dfb3c74aa690f1006f0c4ffba870d)** to **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)**



---

archive/issue_events_179488.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T08:20:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179488"
}
```



---

archive/issue_events_179489.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T08:20:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179489"
}
```



---

archive/issue_comments_147183.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nIt was wrong to always raise an exception when an interval was compared. The reason why `pi in RIF` was `True` rather lies in `structure.parent.py:Parent.contains()` where the line\n\n```\nEQ = (x2 == x)\n```\ndidn't account for symbolics and should read\n\n```\nEQ = bool(x2 == x)\n```\nThis uncovers another bug in `Expression.nonzero()` which shows as\n\n```\nsage: bool(sqrt(2)==CC(sqrt(2)))\nFalse\n```\nbecause `sqrt(2) == 1.41421356237309` is `False`. Any ideas how to fit this in the current code?\n\nEDIT: See also https://groups.google.com/forum/?hl=en#!topic/sage-devel/QBAipylR6iM",
    "created_at": "2015-02-26T08:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147183",
    "user": "https://github.com/rwst"
}
```

<div id="comment:28" align="right">comment:28</div>

It was wrong to always raise an exception when an interval was compared. The reason why `pi in RIF` was `True` rather lies in `structure.parent.py:Parent.contains()` where the line

```
EQ = (x2 == x)
```
didn't account for symbolics and should read

```
EQ = bool(x2 == x)
```
This uncovers another bug in `Expression.nonzero()` which shows as

```
sage: bool(sqrt(2)==CC(sqrt(2)))
False
```
because `sqrt(2) == 1.41421356237309` is `False`. Any ideas how to fit this in the current code?

EDIT: See also https://groups.google.com/forum/?hl=en#!topic/sage-devel/QBAipylR6iM



---

archive/issue_comments_147184.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10\">0adb1d3</a></td><td><code>12967: dedicated CC.__contains__</code></td></tr></table>\n",
    "created_at": "2015-02-26T17:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147184",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10">0adb1d3</a></td><td><code>12967: dedicated CC.__contains__</code></td></tr></table>




---

archive/issue_comments_147185.json:
```json
{
    "body": "Changed commit from **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)** to **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)**",
    "created_at": "2015-02-26T17:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147185",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[91cd2a6](https://github.com/sagemath/sagetrac-mirror/commit/91cd2a666102e9442c84642e5dcd4e7dba193947)** to **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)**



---

archive/issue_events_179490.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T17:36:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179490"
}
```



---

archive/issue_events_179491.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-26T17:36:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179491"
}
```



---

archive/issue_comments_147186.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nResolved by a dedicated `CC.__contains__`.",
    "created_at": "2015-02-26T17:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147186",
    "user": "https://github.com/rwst"
}
```

<div id="comment:30" align="right">comment:30</div>

Resolved by a dedicated `CC.__contains__`.



---

archive/issue_comments_147187.json:
```json
{
    "body": "Changed branch from **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)** to none",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147187",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/comparison_of_pi_and_infinity_wrong](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/comparison_of_pi_and_infinity_wrong)** to none



---

archive/issue_events_179492.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-04T16:14:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179492"
}
```



---

archive/issue_events_179493.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-04T16:14:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179493"
}
```



---

archive/issue_comments_147188.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nNo, I give up. Better fix pynac.",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147188",
    "user": "https://github.com/rwst"
}
```

<div id="comment:31" align="right">comment:31</div>

No, I give up. Better fix pynac.



---

archive/issue_comments_147189.json:
```json
{
    "body": "Changed commit from **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)** to none",
    "created_at": "2015-03-04T16:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147189",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[0adb1d3](https://github.com/sagemath/sagetrac-mirror/commit/0adb1d3d7e9e5b3b9e0bc6d7c202869b174adc10)** to none



---

archive/issue_comments_147190.json:
```json
{
    "body": "Branch: **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)**",
    "created_at": "2015-03-19T09:06:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147190",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)**



---

archive/issue_comments_147191.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReboot. This branch has clean logic handling all relations that can be decided without Maxima. I have left in the call to Pynac's `relational_to_bool` although it could possibly replaced too. The branch depends on #17984.\n\nHowever, there is one doctest failure:\n\n```\nFile \"src/sage/structure/parent.pyx\", line 1224, in sage.structure.parent.Parent.__contains__\nFailed example:\n    pi in RIF # there is no element of RIF equal to pi\nExpected:\n    False\nGot:\n    True\n```\nIt is caused because `Parent.__contains__` assumes wrongly that all\nequations that are of type `Expression` must be true, and `pi == RIF(pi)` isn't.\nIn develop this is masked by code catching all kinds of exceptions that hides the fact that the conversion of the relation to Maxima throws an exception. The code takes this to mean that `pi == RIF(pi)` is `False`. In contrast this branch determines without invoking Maxima correctly that the relation is `False` but the fact no exception is thrown leads to `Parent.__contains__` returning `True`! Since it's clearly wrong here to throw an exception just to oblige `Parent.__contains__` that method in turn must be fixed.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39ab5b2a9f6057e08a7aced6f58daa2de3c4cbe6\">39ab5b2</a></td><td><code>17984: Dedicated RR.__contains__() and CC.__contains__()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a22a6e47dabea2b8b4c42ee7e21b0a8777a8dba4\">a22a6e4</a></td><td><code>17984: description in docstring; fixes and doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/544450ea18ed2778953141bab8feced61237556e\">544450e</a></td><td><code>17984: fix typo in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3\">c5845f6</a></td><td><code>12967: get relations with infinities right</code></td></tr></table>\n",
    "created_at": "2015-03-19T09:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147191",
    "user": "https://github.com/rwst"
}
```

<div id="comment:33" align="right">comment:33</div>

Reboot. This branch has clean logic handling all relations that can be decided without Maxima. I have left in the call to Pynac's `relational_to_bool` although it could possibly replaced too. The branch depends on #17984.

However, there is one doctest failure:

```
File "src/sage/structure/parent.pyx", line 1224, in sage.structure.parent.Parent.__contains__
Failed example:
    pi in RIF # there is no element of RIF equal to pi
Expected:
    False
Got:
    True
```
It is caused because `Parent.__contains__` assumes wrongly that all
equations that are of type `Expression` must be true, and `pi == RIF(pi)` isn't.
In develop this is masked by code catching all kinds of exceptions that hides the fact that the conversion of the relation to Maxima throws an exception. The code takes this to mean that `pi == RIF(pi)` is `False`. In contrast this branch determines without invoking Maxima correctly that the relation is `False` but the fact no exception is thrown leads to `Parent.__contains__` returning `True`! Since it's clearly wrong here to throw an exception just to oblige `Parent.__contains__` that method in turn must be fixed.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39ab5b2a9f6057e08a7aced6f58daa2de3c4cbe6">39ab5b2</a></td><td><code>17984: Dedicated RR.__contains__() and CC.__contains__()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a22a6e47dabea2b8b4c42ee7e21b0a8777a8dba4">a22a6e4</a></td><td><code>17984: description in docstring; fixes and doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/544450ea18ed2778953141bab8feced61237556e">544450e</a></td><td><code>17984: fix typo in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3">c5845f6</a></td><td><code>12967: get relations with infinities right</code></td></tr></table>




---

archive/issue_comments_147192.json:
```json
{
    "body": "Commit: **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)**",
    "created_at": "2015-03-19T09:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147192",
    "user": "https://github.com/rwst"
}
```

Commit: **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)**



---

archive/issue_events_179494.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-19T09:08:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179494"
}
```



---

archive/issue_events_179495.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-19T09:08:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179495"
}
```



---

archive/issue_comments_147193.json:
```json
{
    "body": "Dependencies: **#17984**",
    "created_at": "2015-03-19T09:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147193",
    "user": "https://github.com/rwst"
}
```

Dependencies: **#17984**



---

archive/issue_events_179496.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-03-19T09:48:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179496"
}
```



---

archive/issue_events_179497.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-03-19T09:48:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179497"
}
```



---

archive/issue_comments_147194.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI'm afraid this implementation of `__contains__()` will make `Mod(1, 2) in RR` return `True`, which is obviously wrong.  This is probably the reason why the nonsense input in the Chebyshev doctests is no longer detected.\n\nI am in general hesitant about the idea of needing a custom `__contains__()` method; the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.  How about fixing `__cmp__()` (or similar) when comparing symbolic expressions with numerical approximations so that (for example)  `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?",
    "created_at": "2015-03-19T09:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147194",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:35" align="right">comment:35</div>

I'm afraid this implementation of `__contains__()` will make `Mod(1, 2) in RR` return `True`, which is obviously wrong.  This is probably the reason why the nonsense input in the Chebyshev doctests is no longer detected.

I am in general hesitant about the idea of needing a custom `__contains__()` method; the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.  How about fixing `__cmp__()` (or similar) when comparing symbolic expressions with numerical approximations so that (for example)  `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?



---

archive/issue_comments_147195.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nNa\u00efve question: what would be the problem with simply making `SR` coerce into `InfinityRing` instead of the reverse?",
    "created_at": "2015-03-19T13:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147195",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:36" align="right">comment:36</div>

Nave question: what would be the problem with simply making `SR` coerce into `InfinityRing` instead of the reverse?



---

archive/issue_comments_147196.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@pjbruin](#comment:35):\n> `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?\n\nThis sounds very dangerous to me.",
    "created_at": "2015-03-19T13:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147196",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@pjbruin](#comment:35):
> `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?

This sounds very dangerous to me.



---

archive/issue_comments_147197.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@pjbruin](#comment:35):\n>...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\nIt would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.",
    "created_at": "2015-03-19T13:43:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147197",
    "user": "https://github.com/rwst"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@pjbruin](#comment:35):
>...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.



---

archive/issue_comments_147198.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@rwst](#comment:38):\n> Replying to [@pjbruin](#comment:35):\n> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\n> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\nBut currently the precision is already taken care of in this way:\n\n```\nsage: pi.n(10) in RR\nTrue\nsage: pi.n(100) in RealField(50)\nTrue\n```\nIsn't this what you want to keep as the correct behaviour?",
    "created_at": "2015-03-19T13:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147198",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@rwst](#comment:38):
> Replying to [@pjbruin](#comment:35):
> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision` but the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

But currently the precision is already taken care of in this way:

```
sage: pi.n(10) in RR
True
sage: pi.n(100) in RealField(50)
True
```
Isn't this what you want to keep as the correct behaviour?



---

archive/issue_comments_147199.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@rwst](#comment:38):\n> the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\nI view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like \"the reals\", and it would be wrong to view them as such!",
    "created_at": "2015-03-19T13:51:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147199",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@rwst](#comment:38):
> the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like "the reals", and it would be wrong to view them as such!



---

archive/issue_comments_147200.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@mezzarobba](#comment:37):\n> Replying to [@pjbruin](#comment:35):\n> > `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?\n\n> \n> This sounds very dangerous to me.\n\nIn fact, `bool(pi == pi.n())` already returns `True`, which I think is reasonable.  In any case it is consistent with how elements of real fields of different precisions are compared.\n\nThe question is whether we also want to use this for `x in RR`.  I currently cannot think of a natural way of implementing this.  Just checking whether `x` can be converted in to `RR` is not enough (as the example with `Mod(1, 2)` in [comment:35](#comment:35) shows); one would at least expect that `x` can be converted into `RR` *and* that the result is \"sufficiently equal\" to the original `x`.",
    "created_at": "2015-03-19T13:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147200",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@mezzarobba](#comment:37):
> Replying to [@pjbruin](#comment:35):
> > `bool(pi == 3.14[...])` returns `True` if the approximation is correct to the given precision?

> 
> This sounds very dangerous to me.

In fact, `bool(pi == pi.n())` already returns `True`, which I think is reasonable.  In any case it is consistent with how elements of real fields of different precisions are compared.

The question is whether we also want to use this for `x in RR`.  I currently cannot think of a natural way of implementing this.  Just checking whether `x` can be converted in to `RR` is not enough (as the example with `Mod(1, 2)` in [comment:35](#comment:35) shows); one would at least expect that `x` can be converted into `RR` *and* that the result is "sufficiently equal" to the original `x`.



---

archive/issue_comments_147201.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@mezzarobba](#comment:40):\n> I view that as a misunderstanding\n\nWrong perspective. Rather a bad design decision.",
    "created_at": "2015-03-19T13:54:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147201",
    "user": "https://github.com/rwst"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@mezzarobba](#comment:40):
> I view that as a misunderstanding

Wrong perspective. Rather a bad design decision.



---

archive/issue_comments_147202.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@mezzarobba](#comment:40):\n> Replying to [@rwst](#comment:38):\n> > the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.\n\n> \n> I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like \"the reals\", and it would be wrong to view them as such!\n\nFrom that perspective, `pi in RR` should return `False`.  I personally wouldn't be opposed to this, but since there is some subtlety involved, I would expect many users won't like this.",
    "created_at": "2015-03-19T13:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147202",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@mezzarobba](#comment:40):
> Replying to [@rwst](#comment:38):
> > the overwhelming majority want it to mean `x element of real/complex field regardless of precision`. And that's also the use cases within Sage that I have seen, and so I reflected it in the method description.

> 
> I view that as a misunderstanding due to the unfortunate use of the name `RR` in sage for what actually is the set of 53-bit floating-point numbers (with some exponent bounds). In almost all other respects, the elements of `RR` do not behave like "the reals", and it would be wrong to view them as such!

From that perspective, `pi in RR` should return `False`.  I personally wouldn't be opposed to this, but since there is some subtlety involved, I would expect many users won't like this.



---

archive/issue_comments_147203.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nMaybe we should discourage users from using `x in RR`.  There is the following alternative:\n\n```\nsage: pi.is_real()\nTrue\n```",
    "created_at": "2015-03-19T13:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147203",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:44" align="right">comment:44</div>

Maybe we should discourage users from using `x in RR`.  There is the following alternative:

```
sage: pi.is_real()
True
```



---

archive/issue_comments_147204.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@pjbruin](#comment:41):\n>I currently cannot think of a natural way of implementing this. \n\nWhy generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.",
    "created_at": "2015-03-19T13:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147204",
    "user": "https://github.com/rwst"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@pjbruin](#comment:41):
>I currently cannot think of a natural way of implementing this. 

Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.



---

archive/issue_comments_147205.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@pjbruin](#comment:44):\n> Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> \n> ```\n> sage: pi.is_real()\n> True\n> ```\n\nI'm fine with that too. `RR.__contains__()` is then used for the error.",
    "created_at": "2015-03-19T14:03:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147205",
    "user": "https://github.com/rwst"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@pjbruin](#comment:44):
> Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> 
> ```
> sage: pi.is_real()
> True
> ```

I'm fine with that too. `RR.__contains__()` is then used for the error.



---

archive/issue_comments_147206.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@pjbruin](#comment:44):\n> Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> \n> ```\n> sage: pi.is_real()\n> True\n> ```\n\nI don't think this is a good idea. This breaks consistency across the different fields. Sage is quite inconsistent already from a user point of view, we shouldn't introduce more such inconsistencies.",
    "created_at": "2015-03-19T14:05:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147206",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@pjbruin](#comment:44):
> Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> 
> ```
> sage: pi.is_real()
> True
> ```

I don't think this is a good idea. This breaks consistency across the different fields. Sage is quite inconsistent already from a user point of view, we shouldn't introduce more such inconsistencies.



---

archive/issue_comments_147207.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@rwst](#comment:45):\n> Replying to [@pjbruin](#comment:41):\n> >I currently cannot think of a natural way of implementing this. \n\n> Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.\n\nI meant I cannot think of a better way than `bool(RR(x) == x)`.  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...  At most we could use the `is_real()` method, but looking a bit more into this, I think it does not work very well either:\n\n```\nsage: e.is_real()\nFalse\n```",
    "created_at": "2015-03-19T14:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147207",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@rwst](#comment:45):
> Replying to [@pjbruin](#comment:41):
> >I currently cannot think of a natural way of implementing this. 

> Why generalize? The method could check if `item` has a method `is_in_RR()` which implementation in a new set is the responsibility of its author.

I meant I cannot think of a better way than `bool(RR(x) == x)`.  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...  At most we could use the `is_real()` method, but looking a bit more into this, I think it does not work very well either:

```
sage: e.is_real()
False
```



---

archive/issue_comments_147208.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@ppurka](#comment:47):\n> Replying to [@pjbruin](#comment:44):\n> > Maybe we should discourage users from using `x in RR`.  There is the following alternative:\n> > \n> > ```\n> > sage: pi.is_real()\n> > True\n> > ```\n\n> \n> I don't think this is a good idea. This breaks consistency across the different fields.\n\nOnly if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.",
    "created_at": "2015-03-19T14:12:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147208",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@ppurka](#comment:47):
> Replying to [@pjbruin](#comment:44):
> > Maybe we should discourage users from using `x in RR`.  There is the following alternative:
> > 
> > ```
> > sage: pi.is_real()
> > True
> > ```

> 
> I don't think this is a good idea. This breaks consistency across the different fields.

Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.



---

archive/issue_comments_147209.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@pjbruin](#comment:49):\n> Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.\n\nExactly. If we want consistency across Sage, then the semantics of `x in RR` *cannot* be \"`x` is a real number\"; it must be \"`x` is an element of the parent `RR`\" or something similar.",
    "created_at": "2015-03-19T14:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147209",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@pjbruin](#comment:49):
> Only if you identify `RR` with the mathematical field **R** of real numbers.  If we are serious about presenting `RR` as a certain set of numbers that is quite different from the mathematical field **R** (for example, `Infinity in RR` already returns `True`), then we can just let `pi in RR` return `False`, emphatically warn users about this, and say that different methods are needed to decide if an expression represents a mathematical real number.

Exactly. If we want consistency across Sage, then the semantics of `x in RR` *cannot* be "`x` is a real number"; it must be "`x` is an element of the parent `RR`" or something similar.



---

archive/issue_comments_147210.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@pjbruin](#comment:48):\n> ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...\n\nBug fixing is always ad hoc. You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.",
    "created_at": "2015-03-19T14:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147210",
    "user": "https://github.com/rwst"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@pjbruin](#comment:48):
> ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...

Bug fixing is always ad hoc. You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.



---

archive/issue_comments_147211.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@rwst](#comment:38):\n> Replying to [@pjbruin](#comment:35):\n> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.\n\n> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision`.\n\nI don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?",
    "created_at": "2015-03-19T14:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147211",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@rwst](#comment:38):
> Replying to [@pjbruin](#comment:35):
> >...the strategy to implement `x in P` as `bool(P(x) == x)` basically seems a good one to me.

> It would be if users wanted `x in RR/CC` to mean `x element of real/complex field of exactly this precision`.

I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?



---

archive/issue_comments_147212.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@rwst](#comment:51):\n> Replying to [@pjbruin](#comment:48):\n> > ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...\n\n> Bug fixing is always ad hoc.\n\nNot at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.\n> You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.\n\nI disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.\n\nThe more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?",
    "created_at": "2015-03-19T14:53:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147212",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@rwst](#comment:51):
> Replying to [@pjbruin](#comment:48):
> > ...  What you propose sounds rather ad hoc; if we need a special method for `RR`, then we would also need special cases for other inexact rings like `CC`, *p*-adic rings and power series rings...

> Bug fixing is always ad hoc.

Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.
> You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.

I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.

The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?



---

archive/issue_comments_147213.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@jdemeyer](#comment:52):\n> I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?\n\nThere seemed to be a precision problem:\nhttps://groups.google.com/d/topic/sage-devel/QBAipylR6iM/discussion",
    "created_at": "2015-03-19T15:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147213",
    "user": "https://github.com/rwst"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@jdemeyer](#comment:52):
> I don't get why you say this. Doesn't `bool(P(x) == x)` work regardless of precision?

There seemed to be a precision problem:
https://groups.google.com/d/topic/sage-devel/QBAipylR6iM/discussion



---

archive/issue_comments_147214.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@pjbruin](#comment:53):\n> Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.\n\nI strongly agree with that. Making specific examples work with no regard for global consistency usually means introducing bugs, not fixing them.\n\n> > You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.\n\n> I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.\n\nI tend to agree. Note however that the current definition is more along the lines of `parent(x) == P or P(x) == x`, which may not be the same (think of intervals or objects that may not compare as equal to copies of themselves).\n\n> The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?\n\nAs I repeat on every possible occasion, comparisons in sage are broken in more ways than I can count. One of the fundamental reasons IMHO is that there should be at least two kinds of comparisons (in addition to `is`), call them *strict* comparisons and *semantic* comparisons. Under *strict* equality, for instance, elements of different parents would always compare as unequal, and elements of a parent with no normal form would typically compare as equal only if they have the same syntactic representation. *Semantic* equality however could attempt coercing the elements in a common parent much like `==` currently does. (I believe that `==` should refer to the *strict* equality since, among other things, that would avoid many of the problems with hashing. But I know that many people disagree.)\n\nClearly we are talking about *semantic* equality here, but I believe making the previous distinction (at least conceptually) helps separating the issues. Now about your examples: with the current model with a single equality predicate, my answer is **NOOO!!! ** in both cases. With a separate *strict* equality, it is less clear-cut, but intuitively I would still expect both results to be `False`.",
    "created_at": "2015-03-19T15:45:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147214",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@pjbruin](#comment:53):
> Not at all; I often find that a good first step towards fundamentally fixing a bug is trying to *remove* hacks that someone else put in to make a specific example work.

I strongly agree with that. Making specific examples work with no regard for global consistency usually means introducing bugs, not fixing them.

> > You can only make it easier (but by a huge amount) with good design and a well thought out model. Since no good model presents itself and delegating the task to the item is good design this would be an ansatz.

> I disagree that no good model presents itself; defining `x in P` as `bool(P(x) == x)` seems like a good programming model to me, since it is simple and predictable.

I tend to agree. Note however that the current definition is more along the lines of `parent(x) == P or P(x) == x`, which may not be the same (think of intervals or objects that may not compare as equal to copies of themselves).

> The more I think about it, the more the fundamental problem does not seem to be membership testing, but *comparison* between real numbers defined in different approximations of the real numbers.  Do we want `RR(sqrt(2))` to be equal to `SR(sqrt(2))` or not?  And what about `RR(1/3)` and `QQ(1/3)`?

As I repeat on every possible occasion, comparisons in sage are broken in more ways than I can count. One of the fundamental reasons IMHO is that there should be at least two kinds of comparisons (in addition to `is`), call them *strict* comparisons and *semantic* comparisons. Under *strict* equality, for instance, elements of different parents would always compare as unequal, and elements of a parent with no normal form would typically compare as equal only if they have the same syntactic representation. *Semantic* equality however could attempt coercing the elements in a common parent much like `==` currently does. (I believe that `==` should refer to the *strict* equality since, among other things, that would avoid many of the problems with hashing. But I know that many people disagree.)

Clearly we are talking about *semantic* equality here, but I believe making the previous distinction (at least conceptually) helps separating the issues. Now about your examples: with the current model with a single equality predicate, my answer is **NOOO!!! ** in both cases. With a separate *strict* equality, it is less clear-cut, but intuitively I would still expect both results to be `False`.



---

archive/issue_comments_147215.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nGiven that it would be more consistent (but less user-friendly) to not mix **R** with `RR`, and `item.is_real()` is buggy, the fix of that is critical (#16436, #17117 are aspects). The `Parent.__contains__` method would have to be adapted and a warning added. Maybe this even leads to a more consistent `Parent.__contains__`. The fix of the behaviour of `bool(item==P(item))` is then less urgent (because it's rarely used otherwise). As to this ticket where failing comparisons with `oo` are described, the code does fix these but leaves at least the `pi in RIF` doctest failing (explanation in [comment:33](#comment:33)), and possibly more if I remove the `RR/CC.__contains__`. This could benefit from a more consistent `Parent.__contains__` so let's go on.",
    "created_at": "2015-03-19T16:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147215",
    "user": "https://github.com/rwst"
}
```

<div id="comment:56" align="right">comment:56</div>

Given that it would be more consistent (but less user-friendly) to not mix **R** with `RR`, and `item.is_real()` is buggy, the fix of that is critical (#16436, #17117 are aspects). The `Parent.__contains__` method would have to be adapted and a warning added. Maybe this even leads to a more consistent `Parent.__contains__`. The fix of the behaviour of `bool(item==P(item))` is then less urgent (because it's rarely used otherwise). As to this ticket where failing comparisons with `oo` are described, the code does fix these but leaves at least the `pi in RIF` doctest failing (explanation in [comment:33](#comment:33)), and possibly more if I remove the `RR/CC.__contains__`. This could benefit from a more consistent `Parent.__contains__` so let's go on.



---

archive/issue_comments_147216.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nThe symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.",
    "created_at": "2015-04-01T16:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147216",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:57" align="right">comment:57</div>

The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.



---

archive/issue_comments_147217.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nSo we need another ticket for\n\n```\nsage: bool(sqrt(2)<oo)\nFalse\n```",
    "created_at": "2015-04-01T16:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147217",
    "user": "https://github.com/rwst"
}
```

<div id="comment:58" align="right">comment:58</div>

So we need another ticket for

```
sage: bool(sqrt(2)<oo)
False
```



---

archive/issue_comments_147218.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAs I have now a better overview, at least some cases could and should be fixed in Pynac. This is https://github.com/pynac/pynac/issues/69",
    "created_at": "2015-06-10T15:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147218",
    "user": "https://github.com/rwst"
}
```

<div id="comment:59" align="right">comment:59</div>

As I have now a better overview, at least some cases could and should be fixed in Pynac. This is https://github.com/pynac/pynac/issues/69



---

archive/issue_comments_147219.json:
```json
{
    "body": "Upstream: **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2015-06-10T15:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147219",
    "user": "https://github.com/rwst"
}
```

Upstream: **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_147220.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@vbraun](#comment:57):\n> The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.\n\nHow would `NaN` be coerced? Or a future `Aleph2`?",
    "created_at": "2015-06-18T13:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147220",
    "user": "https://github.com/rwst"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@vbraun](#comment:57):
> The symbolic constants, like `pi.pyobject()`, should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the `pi.pyobject() < oo == False` issue.

How would `NaN` be coerced? Or a future `Aleph2`?



---

archive/issue_comments_147221.json:
```json
{
    "body": "Changed branch from **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)** to none",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147221",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/12967-2](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/12967-2)** to none



---

archive/issue_events_179498.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-06-19T16:08:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179498"
}
```



---

archive/issue_events_179499.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-06-19T16:08:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179499"
}
```



---

archive/issue_comments_147222.json:
```json
{
    "body": "Changed dependencies from **#17984** to **pynac-0.3.9.2**",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147222",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#17984** to **pynac-0.3.9.2**



---

archive/issue_comments_147223.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nPynac git master has a fix that does this:\n\n```\nsage: bool(SR(oo) > 5)\nTrue\nsage: bool(5 < SR(oo))\nTrue\nsage: bool(SR(2)<Infinity)\nTrue\nsage: bool(pi<Infinity)\nTrue\nsage: bool(pi>Infinity)\nFalse\nsage: bool(2*pi<Infinity)\nTrue\nsage: bool(SR(pi) < SR(Infinity))\nTrue\nsage: bool(sqrt(2)<oo)\nTrue\nsage: bool(log(2)<oo)\nTrue\nsage: bool(e<oo)\nTrue\nsage: bool(e+pi<oo)\nTrue\nsage: bool(e^pi<oo)\nTrue\nsage: bool(SR(2)<-oo)\nFalse\nsage: bool(SR(2)>-oo)\nTrue\nsage: bool(exp(2)>-oo)\nTrue\nsage: bool(SR(oo) > sqrt(2))\nTrue\nsage: bool(sqrt(2) < SR(oo))\nTrue\nsage: bool(SR(-oo) < sqrt(2))\nTrue\nsage: bool(sqrt(2) > SR(-oo))\nTrue\n```\nIt uses info flags and evalf where applicable. Some function info flags were introduced earlier in Pynac.",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147223",
    "user": "https://github.com/rwst"
}
```

<div id="comment:61" align="right">comment:61</div>

Pynac git master has a fix that does this:

```
sage: bool(SR(oo) > 5)
True
sage: bool(5 < SR(oo))
True
sage: bool(SR(2)<Infinity)
True
sage: bool(pi<Infinity)
True
sage: bool(pi>Infinity)
False
sage: bool(2*pi<Infinity)
True
sage: bool(SR(pi) < SR(Infinity))
True
sage: bool(sqrt(2)<oo)
True
sage: bool(log(2)<oo)
True
sage: bool(e<oo)
True
sage: bool(e+pi<oo)
True
sage: bool(e^pi<oo)
True
sage: bool(SR(2)<-oo)
False
sage: bool(SR(2)>-oo)
True
sage: bool(exp(2)>-oo)
True
sage: bool(SR(oo) > sqrt(2))
True
sage: bool(sqrt(2) < SR(oo))
True
sage: bool(SR(-oo) < sqrt(2))
True
sage: bool(sqrt(2) > SR(-oo))
True
```
It uses info flags and evalf where applicable. Some function info flags were introduced earlier in Pynac.



---

archive/issue_comments_147224.json:
```json
{
    "body": "Changed commit from **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)** to none",
    "created_at": "2015-06-19T16:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147224",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[c5845f6](https://github.com/sagemath/sagetrac-mirror/commit/c5845f6b18d582807dafaaf60ad6a5c8017173f3)** to none



---

archive/issue_comments_147225.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,6 +21,10 @@\n \n This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.\n \n-**Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n \n-See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ \n+https://github.com/pynac/pynac/issues/69\n+\n+---\n+Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).\n+\n``````\n",
    "created_at": "2015-06-19T16:11:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147225",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,6 +21,10 @@
 
 This was reported on [sage-support](https://groups.google.com/d/topic/sage-support/2GlgJKOfK3g/discussion) by Robert Samal.
 
-**Apply** [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
 
-See the discussion at https://groups.google.com/forum/?hl=en#!topic/sage-devel/Oip2hzvjFZQ 
+https://github.com/pynac/pynac/issues/69
+
+---
+Previously proposed patch: [attachment: trac_12967-symbolic_ring-review.patch](https://github.com/sagemath/sage/files/ticket12967/trac_12967-symbolic_ring-review.patch.gz).
+
``````




---

archive/issue_comments_147226.json:
```json
{
    "body": "Changed dependencies from **pynac-0.3.9.2** to none",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147226",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **pynac-0.3.9.2** to none



---

archive/issue_events_179500.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-07-16T06:54:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179500"
}
```



---

archive/issue_events_179501.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-07-16T06:54:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179501"
}
```



---

archive/issue_comments_147227.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThe above is doctested in #17321 so what remains here that is not #16397?",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147227",
    "user": "https://github.com/rwst"
}
```

<div id="comment:63" align="right">comment:63</div>

The above is doctested in #17321 so what remains here that is not #16397?



---

archive/issue_comments_147228.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to none",
    "created_at": "2015-07-16T06:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147228",
    "user": "https://github.com/rwst"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to none



---

archive/issue_events_179502.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179502"
}
```



---

archive/issue_events_179503.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179503"
}
```



---

archive/issue_events_179504.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179504"
}
```



---

archive/issue_events_179505.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179505"
}
```



---

archive/issue_events_179506.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-12-20T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179506"
}
```



---

archive/issue_events_179507.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2015-12-20T13:34:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179507"
}
```



---

archive/issue_events_179508.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2015-12-20T13:34:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179508"
}
```



---

archive/issue_comments_147229.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Daniel Krenn**",
    "created_at": "2015-12-20T13:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12967#issuecomment-147229",
    "user": "https://github.com/dkrenn"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Daniel Krenn**



---

archive/issue_events_179509.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179509"
}
```



---

archive/issue_events_179510.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179510"
}
```



---

archive/issue_events_179511.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-20T18:36:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12967",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12967#event-179511"
}
```
