# Issue 12051: LLL algorithm for matrices over QQ

archive/issues_011879.json:
```json
{
    "body": "Matrices over `QQ` do not have a method `LLL(...)` like matrices over `ZZ`. Here is a simple implementation:\n\n1. get rid of the denominator\n2. call the `LLL` method of integer matrices\n3. set the denominator back.\n\nNote: in previous version it was suggested that such an approach might be useful for matrices over `RR`. But it is not completely clear how to do that efficiently.\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  fschulze\n\n**Keywords:** LLL, rationals, QQ\n\n**Branch/Commit:** [9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)\n\n**Reviewer:** John Cremona\n\n**Author:** Johan Bosman\n\nIssue created by migration from https://trac.sagemath.org/ticket/12051\n\n",
    "closed_at": "2015-04-14T19:44:23Z",
    "created_at": "2011-11-17T18:14:21Z",
    "labels": [
        "component: linear algebra",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "LLL algorithm for matrices over QQ",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12051",
    "user": "https://github.com/dkrenn"
}
```
Matrices over `QQ` do not have a method `LLL(...)` like matrices over `ZZ`. Here is a simple implementation:

1. get rid of the denominator
2. call the `LLL` method of integer matrices
3. set the denominator back.

Note: in previous version it was suggested that such an approach might be useful for matrices over `RR`. But it is not completely clear how to do that efficiently.

**Assignee:** @jasongrout, @williamstein

**CC:**  fschulze

**Keywords:** LLL, rationals, QQ

**Branch/Commit:** [9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)

**Reviewer:** John Cremona

**Author:** Johan Bosman

Issue created by migration from https://trac.sagemath.org/ticket/12051





---

archive/issue_comments_161247.json:
```json
{
    "body": "<a id='comment:1'></a>\nYou mean for matrices over `QQ` and `RR` whose entries happen to be integers?",
    "created_at": "2011-11-17T20:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161247",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:1'></a>
You mean for matrices over `QQ` and `RR` whose entries happen to be integers?



---

archive/issue_comments_161248.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [mhansen](#comment%3A1):\n\n> You mean for matrices over `QQ` and `RR` whose entries happen to be integers?\n\n\nNo. A strategy could be the following: For matrices over `QQ` you can multiply by the least common multiple of all denominators to get a matrix over `ZZ`, then apply LLL, and then scale back. For matrices over the reals (which are of finite precision), do also some scaling to get an integer-matrix.",
    "created_at": "2011-11-17T21:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161248",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:2'></a>
Replying to [mhansen](#comment%3A1):

> You mean for matrices over `QQ` and `RR` whose entries happen to be integers?


No. A strategy could be the following: For matrices over `QQ` you can multiply by the least common multiple of all denominators to get a matrix over `ZZ`, then apply LLL, and then scale back. For matrices over the reals (which are of finite precision), do also some scaling to get an integer-matrix.



---

archive/issue_comments_161249.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt would definitely be good to have this!  For QQ, the proposed strategy obviously works.  For RR, it probably needs some thought what sort of scaling to do here.  For instance, if the matrix has very large as well as very small entries.",
    "created_at": "2011-12-11T11:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161249",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:3'></a>
It would definitely be good to have this!  For QQ, the proposed strategy obviously works.  For RR, it probably needs some thought what sort of scaling to do here.  For instance, if the matrix has very large as well as very small entries.



---

archive/issue_comments_161250.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe asked Andy Novocin about the case of matrices over `RR`. If one wants to use LLL for rational number reconstruction and has lots of decimal digits he proposed the algorithm in [http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf](http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf)",
    "created_at": "2011-12-21T10:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161250",
    "user": "https://trac.sagemath.org/admin/accounts/users/fschulze"
}
```

<a id='comment:4'></a>
We asked Andy Novocin about the case of matrices over `RR`. If one wants to use LLL for rational number reconstruction and has lots of decimal digits he proposed the algorithm in [http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf](http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf)



---

archive/attachments_016044.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "12051_LLL_QQ.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12051/12051_LLL_QQ.patch",
    "created_at": "2011-12-22T20:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```



---

archive/issue_comments_161251.json:
```json
{
    "body": "<a id='comment:5'></a>\nFor RR there is no perfect way to do this; the inexact nature of floating point arithmetic can make things extremely unpleasant.\n\nAndy suggested the following.   Scale and round the input matrix so that the largest entry has about 300 (or so?) bits.  Then augment it with the identity matrix and perform LLL on the augmented matrix.  The augmented part then contains the basis transformation that has to be performed.  Perform this transformation on the input matrix and repeat the procedure until things do not improve anymore (e.g. when the largest entry doesn't decrease anymore).\n\nThis sounds good as a general idea, but may fail big time in specific cases, for instance if the input L is an orthogonal sum L1 + L2 with L1 generated by very small vectors and L2 consisting of very large vectors.",
    "created_at": "2011-12-22T20:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161251",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:5'></a>
For RR there is no perfect way to do this; the inexact nature of floating point arithmetic can make things extremely unpleasant.

Andy suggested the following.   Scale and round the input matrix so that the largest entry has about 300 (or so?) bits.  Then augment it with the identity matrix and perform LLL on the augmented matrix.  The augmented part then contains the basis transformation that has to be performed.  Perform this transformation on the input matrix and repeat the procedure until things do not improve anymore (e.g. when the largest entry doesn't decrease anymore).

This sounds good as a general idea, but may fail big time in specific cases, for instance if the input L is an orthogonal sum L1 + L2 with L1 generated by very small vectors and L2 consisting of very large vectors.



---

archive/issue_comments_161252.json:
```json
{
    "body": "**Dependencies:** #11068",
    "created_at": "2011-12-23T21:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161252",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

**Dependencies:** #11068



---

archive/issue_comments_161253.json:
```json
{
    "body": "<a id='comment:7'></a>\nOops, wrong ticket.",
    "created_at": "2011-12-23T21:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161253",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:7'></a>
Oops, wrong ticket.



---

archive/issue_comments_161254.json:
```json
{
    "body": "**Changing dependencies** from \"#11068\" to \"\".",
    "created_at": "2011-12-23T21:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161254",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

**Changing dependencies** from "#11068" to "".



---

archive/issue_events_037258.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37258"
}
```



---

archive/issue_events_037259.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37259"
}
```



---

archive/issue_events_037260.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37260"
}
```



---

archive/issue_events_037261.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37261"
}
```



---

archive/issue_events_037262.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37262"
}
```



---

archive/issue_events_037263.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37263"
}
```



---

archive/issue_events_037264.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37264"
}
```



---

archive/issue_comments_161255.json:
```json
{
    "body": "<a id='comment:12'></a>\ntransform the patch into a git branch (and remove trailing whitespaces)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/644c7b11d7c50550b027eae092fa9ab75bec1b25\">644c7b1</a></td><td><code>Trac 12051: LLL for matrices over QQ.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b\">9bc18b5</a></td><td><code>Trac 12051: remove trailing whitespaces</code></td></tr></table>\n",
    "created_at": "2015-03-21T17:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161255",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
transform the patch into a git branch (and remove trailing whitespaces)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/644c7b11d7c50550b027eae092fa9ab75bec1b25">644c7b1</a></td><td><code>Trac 12051: LLL for matrices over QQ.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b">9bc18b5</a></td><td><code>Trac 12051: remove trailing whitespaces</code></td></tr></table>




---

archive/issue_comments_161256.json:
```json
{
    "body": "**Commit:** [9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)",
    "created_at": "2015-03-21T17:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161256",
    "user": "https://github.com/videlec"
}
```

**Commit:** [9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)



---

archive/issue_comments_161257.json:
```json
{
    "body": "**Branch:** [public/12051](https://github.com/sagemath/sagetrac-mirror/tree/public/12051)",
    "created_at": "2015-03-21T17:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161257",
    "user": "https://github.com/videlec"
}
```

**Branch:** [public/12051](https://github.com/sagemath/sagetrac-mirror/tree/public/12051)



---

archive/issue_comments_161258.json:
```json
{
    "body": "**Author:** Johan Bosman",
    "created_at": "2015-03-22T10:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161258",
    "user": "https://github.com/videlec"
}
```

**Author:** Johan Bosman



---

archive/issue_comments_161259.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n-Matrices over `QQ` or `RR` do not have an method `LLL(...)` like matrices over `ZZ`. \n+Matrices over `QQ` do not have a method `LLL(...)` like matrices over `ZZ`. Here is a simple implementation:\n+\n+1. get rid of the denominator\n+2. call the `LLL` method of integer matrices\n+3. set the denominator back.\n+\n+Note: in previous version it was suggested that such an approach might be useful for matrices over `RR`. But it is not completely clear how to do that efficiently.\n``````\n",
    "created_at": "2015-03-22T10:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161259",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,7 @@
-Matrices over `QQ` or `RR` do not have an method `LLL(...)` like matrices over `ZZ`. 
+Matrices over `QQ` do not have a method `LLL(...)` like matrices over `ZZ`. Here is a simple implementation:
+
+1. get rid of the denominator
+2. call the `LLL` method of integer matrices
+3. set the denominator back.
+
+Note: in previous version it was suggested that such an approach might be useful for matrices over `RR`. But it is not completely clear how to do that efficiently.
``````




---

archive/issue_comments_161260.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2015-03-22T10:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161260",
    "user": "https://github.com/videlec"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_161261.json:
```json
{
    "body": "**Changing keywords** from \"LLL, rationals, reals, QQ, RR\" to \"LLL, rationals, QQ\".",
    "created_at": "2015-03-22T10:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161261",
    "user": "https://github.com/videlec"
}
```

**Changing keywords** from "LLL, rationals, reals, QQ, RR" to "LLL, rationals, QQ".



---

archive/issue_events_037265.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "rename": {
        "from": "LLL algorithm not available for matrices over QQ or RR",
        "to": "LLL algorithm for matrices over QQ"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37265"
}
```



---

archive/issue_comments_161262.json:
```json
{
    "body": "<a id='comment:14'></a>\nUnder review.",
    "created_at": "2015-03-22T17:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161262",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:14'></a>
Under review.



---

archive/issue_comments_161263.json:
```json
{
    "body": "**Reviewer:** John Cremona",
    "created_at": "2015-03-22T19:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161263",
    "user": "https://github.com/JohnCremona"
}
```

**Reviewer:** John Cremona



---

archive/issue_comments_161264.json:
```json
{
    "body": "<a id='comment:15'></a>\nLooks good to me, I tried lots of random tests and they work fine.",
    "created_at": "2015-03-22T19:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161264",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
Looks good to me, I tried lots of random tests and they work fine.



---

archive/issue_comments_161265.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2015-03-22T19:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161265",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_161266.json:
```json
{
    "body": "<a id='comment:16'></a>\nI use this patch for a long time. I had no problem. I am wondering if a similar patch \nworks for BKZ.",
    "created_at": "2015-03-24T14:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161266",
    "user": "https://trac.sagemath.org/admin/accounts/users/drazioti"
}
```

<a id='comment:16'></a>
I use this patch for a long time. I had no problem. I am wondering if a similar patch 
works for BKZ.



---

archive/issue_events_037266.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-14T19:44:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12051#event-37266"
}
```



---

archive/issue_comments_161267.json:
```json
{
    "body": "**Changing branch** from \"[public/12051](https://github.com/sagemath/sagetrac-mirror/tree/public/12051)\" to \"[9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)\".",
    "created_at": "2015-04-14T19:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12051",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12051#issuecomment-161267",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/12051](https://github.com/sagemath/sagetrac-mirror/tree/public/12051)" to "[9bc18b50d58d5fb4128d925c08d69fff524c420b](https://github.com/sagemath/sagetrac-mirror/commit/9bc18b50d58d5fb4128d925c08d69fff524c420b)".
