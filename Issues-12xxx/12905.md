# Issue 12905: Memory leaks with Cliquer

archive/issues_012733.json:
```json
{
    "body": "Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.\nThe other one comes from Cliquer and is solved with this patch. Here's what it does :\n\n* Solves memory leaks reported by Geoff\n* Incidentally updates Cliquer to version 1.21\n* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. \n\nAs a result, no one should be scared anymore of running the following lines :\n\n```\nfor i in range(2000):\n    print get_memory_usage()\n    _ = graphs.RandomGNP(30,.2).cliques_maximum()\n```\n\n```\nfor i in range(2000):\n    print get_memory_usage()\n    _ = graphs.RandomGNP(30,.2).clique_number()\n```\n\n```\nfor i in range(2000):\n    print get_memory_usage()\n    _ = graphs.RandomGNP(30,.2).clique_maximum()\n```\nApply:\n* [attachment:trac_12905.patch]\n\nInstall the new version of Cliquer:\n* http://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg\n\nAssignee: jason, ncohen, rlm\n\nReviewer: David Coudert\n\nAuthor: Nathann Cohen\n\nMerged: sage-5.5.beta1\n\nDependencies: #13188\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12905\n\n",
    "closed_at": "2012-11-01T12:01:24Z",
    "created_at": "2012-05-04T08:51:18Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.5",
    "title": "Memory leaks with Cliquer",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12905",
    "user": "https://github.com/nathanncohen"
}
```
Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.
The other one comes from Cliquer and is solved with this patch. Here's what it does :

* Solves memory leaks reported by Geoff
* Incidentally updates Cliquer to version 1.21
* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. 

As a result, no one should be scared anymore of running the following lines :

```
for i in range(2000):
    print get_memory_usage()
    _ = graphs.RandomGNP(30,.2).cliques_maximum()
```

```
for i in range(2000):
    print get_memory_usage()
    _ = graphs.RandomGNP(30,.2).clique_number()
```

```
for i in range(2000):
    print get_memory_usage()
    _ = graphs.RandomGNP(30,.2).clique_maximum()
```
Apply:
* [attachment:trac_12905.patch]

Install the new version of Cliquer:
* http://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg

Assignee: jason, ncohen, rlm

Reviewer: David Coudert

Author: Nathann Cohen

Merged: sage-5.5.beta1

Dependencies: #13188

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12905





---

archive/issue_comments_162003.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.\n+The other one comes from Cliquer and is solved with this patch. Here's what it does :\n+\n+* Solves memory leaks reported by Geoff\n+* Incidentally updates Cliquer to version 1.21\n+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. \n+\n+As a result, no one should be scared anymore of running the following lines :\n+\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).cliques_maximum()\n+\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_number()\n+\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_maximum()\n+\n+Apply:\n+* [attachment:trac_12905.patch]\n+\n+Install the new version of Cliquer:\n+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p11.spkg\n \n \n Comment: 1\n``````\n",
    "created_at": "2012-05-04T09:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162003",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.
+The other one comes from Cliquer and is solved with this patch. Here's what it does :
+
+* Solves memory leaks reported by Geoff
+* Incidentally updates Cliquer to version 1.21
+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. 
+
+As a result, no one should be scared anymore of running the following lines :
+
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).cliques_maximum()
+
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_number()
+
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_maximum()
+
+Apply:
+* [attachment:trac_12905.patch]
+
+Install the new version of Cliquer:
+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p11.spkg
 
 
 Comment: 1
``````




---

archive/issue_comments_162004.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-04T09:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162004",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_162005.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,34 @@\n+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.\n+The other one comes from Cliquer and is solved with this patch. Here's what it does :\n+\n+* Solves memory leaks reported by Geoff\n+* Incidentally updates Cliquer to version 1.21\n+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. \n+\n+As a result, no one should be scared anymore of running the following lines :\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).cliques_maximum()\n+```\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_number()\n+```\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_maximum()\n+```\n+Apply:\n+* [attachment:trac_12905.patch]\n+\n+Install the new version of Cliquer:\n+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p11.spkg\n \n \n Comment: 1\n``````\n",
    "created_at": "2012-05-04T09:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162005",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,34 @@
+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.
+The other one comes from Cliquer and is solved with this patch. Here's what it does :
+
+* Solves memory leaks reported by Geoff
+* Incidentally updates Cliquer to version 1.21
+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. 
+
+As a result, no one should be scared anymore of running the following lines :
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).cliques_maximum()
+```
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_number()
+```
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_maximum()
+```
+Apply:
+* [attachment:trac_12905.patch]
+
+Install the new version of Cliquer:
+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p11.spkg
 
 
 Comment: 1
``````




---

archive/issue_comments_162006.json:
```json
{
    "body": "<a id='comment:3'></a>Please fill in your real name as Author.",
    "created_at": "2012-07-27T20:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162006",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>Please fill in your real name as Author.



---

archive/issue_comments_162007.json:
```json
{
    "body": "<a id='comment:4'></a>I don't know how to install the new package. Using the ``\u00ecnstall_package``` method, I get either a re-install of cliquer-1.2.p11, or it answers there is no package name with cliquer-1.21.p11. I tried copying the package to the standard and the optimal package directories without success.",
    "created_at": "2012-08-04T09:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162007",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>I don't know how to install the new package. Using the ``ìnstall_package``` method, I get either a re-install of cliquer-1.2.p11, or it answers there is no package name with cliquer-1.21.p11. I tried copying the package to the standard and the optimal package directories without success.



---

archive/issue_comments_162008.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-04T10:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162008",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_162009.json:
```json
{
    "body": "<a id='comment:5'></a>OK, the method for installing the package is\n\n`sage -i <package.spkg>`\n\nor when the package is already installed (as for cliquer):\n\n`sage -f <package.spkg>`\n\n\nThe patch is working perfectly and the memory usage remains constant. Excellent! I give positive review.",
    "created_at": "2012-08-04T10:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162009",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>OK, the method for installing the package is

`sage -i <package.spkg>`

or when the package is already installed (as for cliquer):

`sage -f <package.spkg>`


The patch is working perfectly and the memory usage remains constant. Excellent! I give positive review.



---

archive/issue_comments_162010.json:
```json
{
    "body": "<a id='comment:6'></a>The spkg should be rebased on cliquer-1.2.p11.spkg (which is in sage-5.1 or later).\n\nAlso: normally, the version number of your spkg should be cliquer-1.21.p0.spkg (not p11).",
    "created_at": "2012-08-04T14:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162010",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>The spkg should be rebased on cliquer-1.2.p11.spkg (which is in sage-5.1 or later).

Also: normally, the version number of your spkg should be cliquer-1.21.p0.spkg (not p11).



---

archive/issue_comments_162011.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-08-04T14:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162011",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_162012.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,34 @@\n+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.\n+The other one comes from Cliquer and is solved with this patch. Here's what it does :\n \n+* Solves memory leaks reported by Geoff\n+* Incidentally updates Cliquer to version 1.21\n+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. \n+\n+As a result, no one should be scared anymore of running the following lines :\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).cliques_maximum()\n+```\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_number()\n+```\n+\n+```\n+for i in range(2000):\n+    print get_memory_usage()\n+    _ = graphs.RandomGNP(30,.2).clique_maximum()\n+```\n+Apply:\n+* [attachment:trac_12905.patch]\n+\n+Install the new version of Cliquer:\n+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg\n \n Comment: 1\n \n``````\n",
    "created_at": "2012-10-14T13:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162012",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,34 @@
+Geoff reported on http://ask.sagemath.org/question/1170/memory-blowup-with-milp memory leaks in Sage. Turns out there were two to solve, and one of them was fixed in #12903.
+The other one comes from Cliquer and is solved with this patch. Here's what it does :
 
+* Solves memory leaks reported by Geoff
+* Incidentally updates Cliquer to version 1.21
+* Incidentally removes Sage's code that was formerly directly inserted in the original Cliquer files. This code is now inserted during the SPKG installation from patches located in the SPKG's patches/ folder. 
+
+As a result, no one should be scared anymore of running the following lines :
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).cliques_maximum()
+```
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_number()
+```
+
+```
+for i in range(2000):
+    print get_memory_usage()
+    _ = graphs.RandomGNP(30,.2).clique_maximum()
+```
+Apply:
+* [attachment:trac_12905.patch]
+
+Install the new version of Cliquer:
+* http://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg
 
 Comment: 1
 
``````




---

archive/issue_comments_162013.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-10-14T13:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162013",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_162014.json:
```json
{
    "body": "<a id='comment:7'></a>New spkg : \nhttp://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg\n\nShould be fine now `:-)`\n\nGod, I had almost forgotten this trac ticket `^^;`\n\nNathann",
    "created_at": "2012-10-14T13:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162014",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>New spkg : 
http://www.steinertriples.fr/ncohen/cliquer-1.21.p0.spkg

Should be fine now `:-)`

God, I had almost forgotten this trac ticket `^^;`

Nathann



---

archive/issue_comments_162015.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-10-14T13:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162015",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_162016.json:
```json
{
    "body": "<a id='comment:8'></a>The patch is still working perfectly.\n\nI haven't changes the milestone but it should certainly be 5.5",
    "created_at": "2012-10-14T13:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162016",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>The patch is still working perfectly.

I haven't changes the milestone but it should certainly be 5.5



---

archive/issue_comments_162017.json:
```json
{
    "body": "<a id='comment:9'></a>WouhouuuuuuUUU !! Thanks `:-)`\n\nNathann",
    "created_at": "2012-10-14T14:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162017",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>WouhouuuuuuUUU !! Thanks `:-)`

Nathann



---

archive/issue_events_035256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-14T18:44:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12905#event-35256"
}
```



---

archive/issue_comments_162018.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-10-23T07:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162018",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_162019.json:
```json
{
    "body": "<a id='comment:11'></a>This should be rebased to #13188.",
    "created_at": "2012-10-23T07:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162019",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>This should be rebased to #13188.



---

archive/issue_comments_162020.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-10-23T07:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162020",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_162021.json:
```json
{
    "body": "<a id='comment:12'></a>Done !",
    "created_at": "2012-10-23T07:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162021",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>Done !



---

archive/issue_comments_162022.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-11-01T12:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162022",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_035257.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12905#event-35257"
}
```



---

archive/issue_comments_162023.json:
```json
{
    "body": "<a id='comment:13'></a>Attachment [trac_12905.patch](tarball://root/attachments/some-uuid/ticket12905/trac_12905.patch) by @jdemeyer created at 2012-11-01 12:01:24",
    "created_at": "2012-11-01T12:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12905#issuecomment-162023",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Attachment [trac_12905.patch](tarball://root/attachments/some-uuid/ticket12905/trac_12905.patch) by @jdemeyer created at 2012-11-01 12:01:24
