# Issue 12418: adding Delsarte bound for codes

archive/issues_012246.json:
```json
{
    "body": "Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.\n\nTo work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.\n\nApply\n\n* [attachment:12418_delsart_bounds.patch]\n* [attachment:12418_update.patch]\n\n**Assignee:** @wdjoyner\n\n**CC:**  jpang @kini @wdjoyner @nathanncohen @ppurka @ptrrsn\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Punarbasu Purkayastha\n\n**Author:** Dmitrii Pasechnik\n\n**Merged:** sage-5.12.beta1\n\n**Dependencies:** #12533, #13650\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12418\n\n",
    "closed_at": "2013-08-16T21:10:45Z",
    "created_at": "2012-02-03T08:08:17Z",
    "labels": [
        "component: coding theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "adding Delsarte bound for codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12418",
    "user": "https://github.com/dimpase"
}
```
Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.

To work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.

Apply

* [attachment:12418_delsart_bounds.patch]
* [attachment:12418_update.patch]

**Assignee:** @wdjoyner

**CC:**  jpang @kini @wdjoyner @nathanncohen @ppurka @ptrrsn

**Reviewer:** Frédéric Chapoton, Punarbasu Purkayastha

**Author:** Dmitrii Pasechnik

**Merged:** sage-5.12.beta1

**Dependencies:** #12533, #13650

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/12418





---

archive/issue_comments_182091.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -63,4 +63,6 @@\n weight enumerator of our code), then the output is the corr. dimension, i.e. \n `floor(log(bound, q_base))`.\n \n+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available.  We are planning to add an [PPL](http://www.sagemath.org/doc/reference/sage/libs/ppl.html) backend (PPL is a polyhedral library with a Cython interface and arbitrary precision rational arithmetic, already a standard package in Sage). Once a ticked on this is opened, we'll cite it here. \n \n+\n``````\n",
    "created_at": "2012-02-06T12:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182091",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -63,4 +63,6 @@
 weight enumerator of our code), then the output is the corr. dimension, i.e. 
 `floor(log(bound, q_base))`.
 
+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available.  We are planning to add an [PPL](http://www.sagemath.org/doc/reference/sage/libs/ppl.html) backend (PPL is a polyhedral library with a Cython interface and arbitrary precision rational arithmetic, already a standard package in Sage). Once a ticked on this is opened, we'll cite it here. 
 
+
``````




---

archive/issue_comments_182092.json:
```json
{
    "body": "<a id='comment:5'></a>\n(GLPK can solve non-integer rational LP. It is not exposed, but may not be too hard either)",
    "created_at": "2012-02-06T12:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182092",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
(GLPK can solve non-integer rational LP. It is not exposed, but may not be too hard either)



---

archive/issue_comments_182093.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe function named `delsarte_bound` should be renamed to something like `delsarte_bound_hamming_space`. This is so that in future other functions like `delsarte_bound_johnson_space`, `delsarte_bound_permutation_space`, etc can be added easily, without having inconsistencies in naming.",
    "created_at": "2012-02-07T14:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182093",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:7'></a>
The function named `delsarte_bound` should be renamed to something like `delsarte_bound_hamming_space`. This is so that in future other functions like `delsarte_bound_johnson_space`, `delsarte_bound_permutation_space`, etc can be added easily, without having inconsistencies in naming.



---

archive/issue_comments_182094.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -63,6 +63,6 @@\n weight enumerator of our code), then the output is the corr. dimension, i.e. \n `floor(log(bound, q_base))`.\n \n-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available.  We are planning to add an [PPL](http://www.sagemath.org/doc/reference/sage/libs/ppl.html) backend (PPL is a polyhedral library with a Cython interface and arbitrary precision rational arithmetic, already a standard package in Sage). Once a ticked on this is opened, we'll cite it here. \n+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which should be made a dependence for this ticket.\n \n \n``````\n",
    "created_at": "2012-06-05T15:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182094",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -63,6 +63,6 @@
 weight enumerator of our code), then the output is the corr. dimension, i.e. 
 `floor(log(bound, q_base))`.
 
-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available.  We are planning to add an [PPL](http://www.sagemath.org/doc/reference/sage/libs/ppl.html) backend (PPL is a polyhedral library with a Cython interface and arbitrary precision rational arithmetic, already a standard package in Sage). Once a ticked on this is opened, we'll cite it here. 
+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which should be made a dependence for this ticket.
 
 
``````




---

archive/issue_comments_182095.json:
```json
{
    "body": "**Dependencies:** #12533",
    "created_at": "2012-06-08T14:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182095",
    "user": "https://github.com/dimpase"
}
```

**Dependencies:** #12533



---

archive/issue_comments_182096.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,68 +1,7 @@\n Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.\n-Here is a quick and dirty code that does it; so the problem would be to integrate this properly.\n \n-```\n-def Kra(n,q,l,i): # K^{n,q}_l(i), i.e Krawtchouk polynomial\n-   return sum([((-1)**j)*((q-1)**(l-j))*binomial(i,j)*binomial(n-i,l-j) \n-                              for j in range(l+1)])\n+See the attached prototype implementation for details.\n \n-def roundres(x): # this is a quick and unsafe way to round the result...\n-   import math\n-   tol = 0.0001\n-   if math.ceil(x)-x < tol:\n-      return int(math.ceil(x))\n-   if x-math.floor(x) < tol:\n-      return int(math.floor(x))\n-   return x\n-\n-# @cached_function\n-def delsarte_bound(n, q, d, d_star=1, q_base=0, return_log=True,\\\n-                    isinteger=False, return_data=False):\n-   p = MixedIntegerLinearProgram(maximization=True)\n-   A = p.new_variable(integer=isinteger) # A>=0 is assumed\n-   p.set_objective(sum([A[r] for r in range(n+1)])) \n-   p.add_constraint(A[0]==1)\n-   for i in range(1,d):\n-      p.add_constraint(A[i]==0)\n-   for j in range(1,n+1): \n-      rhs = sum([Kra(n,q,j,r)*A[r] for r in range(n+1)])\n-      if j >= d_star: \n-        p.add_constraint(0*A[0] <= rhs) \n-      else: # rhs is proportional to j-th weight of the dual code\n-        p.add_constraint(0*A[0] == rhs) \n-   try:\n-      bd=p.solve()\n-   except sage.numerical.mip.MIPSolverException, exc:\n-      print \"Solver exception: \", exc, exc.args\n-      if return_data:\n-         return A,p,False\n-      return False\n-   if q_base > 0: # rounding the bound down to the nearest power of q_base,\n-                  # for q=q_base^m\n-#      qb = factor(q).radical()\n-#      if len(qb) == 1:\n-#         base = qb.expand()\n-#         bd = base^int(log(bd, base=base))\n-         if return_log: \n-#            bd = int(log(roundres(bd), base=q_base)) # unsafe: \n-                                                      # loss of precision\n-            bd = roundres(log(bd, base=q_base))\n-         else:\n-#            bd = q_base^int(log(roundres(bd), base=q_base))\n-            bd = q_base^roundres(log(bd, base=q_base))\n-   if return_data:\n-      return A,p,bd\n-   return bd\n-```\n-\n-d_star is the minimal distance  of the dual code (if it exists at all) \n-If q_base is 0, just compute the upper bound.\n-If q_base is >0, it is assumed to be a prime power, and the code assumed\n-to be additive over this field (i.e. the dual code exists,and its weight enumerator is\n-obtained by applying `MacWilliams transform` --- the matrix A of the LP times the\n-weight enumerator of our code), then the output is the corr. dimension, i.e. \n-`floor(log(bound, q_base))`.\n-\n-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which should be made a dependence for this ticket.\n+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which is a dependence for this ticket.\n \n \n``````\n",
    "created_at": "2012-06-08T14:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182096",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,68 +1,7 @@
 Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.
-Here is a quick and dirty code that does it; so the problem would be to integrate this properly.
 
-```
-def Kra(n,q,l,i): # K^{n,q}_l(i), i.e Krawtchouk polynomial
-   return sum([((-1)**j)*((q-1)**(l-j))*binomial(i,j)*binomial(n-i,l-j) 
-                              for j in range(l+1)])
+See the attached prototype implementation for details.
 
-def roundres(x): # this is a quick and unsafe way to round the result...
-   import math
-   tol = 0.0001
-   if math.ceil(x)-x < tol:
-      return int(math.ceil(x))
-   if x-math.floor(x) < tol:
-      return int(math.floor(x))
-   return x
-
-# @cached_function
-def delsarte_bound(n, q, d, d_star=1, q_base=0, return_log=True,\
-                    isinteger=False, return_data=False):
-   p = MixedIntegerLinearProgram(maximization=True)
-   A = p.new_variable(integer=isinteger) # A>=0 is assumed
-   p.set_objective(sum([A[r] for r in range(n+1)])) 
-   p.add_constraint(A[0]==1)
-   for i in range(1,d):
-      p.add_constraint(A[i]==0)
-   for j in range(1,n+1): 
-      rhs = sum([Kra(n,q,j,r)*A[r] for r in range(n+1)])
-      if j >= d_star: 
-        p.add_constraint(0*A[0] <= rhs) 
-      else: # rhs is proportional to j-th weight of the dual code
-        p.add_constraint(0*A[0] == rhs) 
-   try:
-      bd=p.solve()
-   except sage.numerical.mip.MIPSolverException, exc:
-      print "Solver exception: ", exc, exc.args
-      if return_data:
-         return A,p,False
-      return False
-   if q_base > 0: # rounding the bound down to the nearest power of q_base,
-                  # for q=q_base^m
-#      qb = factor(q).radical()
-#      if len(qb) == 1:
-#         base = qb.expand()
-#         bd = base^int(log(bd, base=base))
-         if return_log: 
-#            bd = int(log(roundres(bd), base=q_base)) # unsafe: 
-                                                      # loss of precision
-            bd = roundres(log(bd, base=q_base))
-         else:
-#            bd = q_base^int(log(roundres(bd), base=q_base))
-            bd = q_base^roundres(log(bd, base=q_base))
-   if return_data:
-      return A,p,bd
-   return bd
-```
-
-d_star is the minimal distance  of the dual code (if it exists at all) 
-If q_base is 0, just compute the upper bound.
-If q_base is >0, it is assumed to be a prime power, and the code assumed
-to be additive over this field (i.e. the dual code exists,and its weight enumerator is
-obtained by applying `MacWilliams transform` --- the matrix A of the LP times the
-weight enumerator of our code), then the output is the corr. dimension, i.e. 
-`floor(log(bound, q_base))`.
-
-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which should be made a dependence for this ticket.
+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which is a dependence for this ticket.
 
 
``````




---

archive/issue_comments_182097.json:
```json
{
    "body": "a prototype implementation",
    "created_at": "2012-06-08T14:47:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182097",
    "user": "https://github.com/dimpase"
}
```

a prototype implementation



---

archive/issue_comments_182098.json:
```json
{
    "body": "<a id='comment:11'></a>\nAttachment [delsarte_bound.py](tarball://root/attachments/some-uuid/ticket12418/delsarte_bound.py) by @dimpase created at 2012-10-28 16:39:58",
    "created_at": "2012-10-28T16:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182098",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
Attachment [delsarte_bound.py](tarball://root/attachments/some-uuid/ticket12418/delsarte_bound.py) by @dimpase created at 2012-10-28 16:39:58



---

archive/issue_comments_182099.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-10-28T16:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182099",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_182100.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n See the attached prototype implementation for details.\n \n-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which is a dependence for this ticket.\n+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.\n \n-\n+Apply [this patch](http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12418/12418_delsart_bounds.patch)\n``````\n",
    "created_at": "2012-10-28T16:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182100",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 See the attached prototype implementation for details.
 
-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is (almost - i.e. the corresponding ticket is still not 100% ready, as reviewers think) taken care of by #12533, which is a dependence for this ticket.
+One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.
 
-
+Apply [this patch](http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12418/12418_delsart_bounds.patch)
``````




---

archive/issue_comments_182101.json:
```json
{
    "body": "<a id='comment:12'></a>\nI think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. I have something like this in mind:\n\n```\ndef Krawtchouk2(n,q,l,i):\n    # Use the expression in equation (55) of MacWilliams & Sloane, pg 151\n    # We write jth term = some_factor * (j-1)th term\n    kraw = jth_term = (q-1)**l * binomial(n, l) # j=0\n    for j in range(1,l+1):\n        jth_term *= -q*(l-j+1)*(i-j+1)/((q-1)*j*(n-j+1))\n        kraw += jth_term\n    return kraw\n\nn,q,l,i = 10,8,7,5\ntimeit('Krawtchouk2(n,q,l,i)')\ntimeit('Krawtchouk (n,q,l,i)')\nprint Krawtchouk2(n,q,l,i) == Krawtchouk(n,q,l,i)\n\n625 loops, best of 3: 53.3 \u00b5s per loop\n625 loops, best of 3: 205 \u00b5s per loop\nTrue\n```\n\nI noticed that sage handles nonintegral components in the binomial, so the expression for the `Krawtchouk` already works with nonintegral `n` and `x`.\n\n```\nn,q,l,i = 10.6,8,7,5.4\n#timeit('Krawtchouk3(n,q,l,i)')\ntimeit('Krawtchouk2(n,q,l,i)')\ntimeit('Krawtchouk (n,q,l,i)')\nprint Krawtchouk2(n,q,l,i) == Krawtchouk(n,q,l,i)\nprint Krawtchouk2(n,q,l,i), Krawtchouk(n,q,l,i)\n\n625 loops, best of 3: 382 \u00b5s per loop\n125 loops, best of 3: 4.74 ms per loop\nFalse\n93582.0160001147 93582.0159999999\n```",
    "created_at": "2012-11-07T10:26:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182101",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:12'></a>
I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. I have something like this in mind:

```
def Krawtchouk2(n,q,l,i):
    # Use the expression in equation (55) of MacWilliams & Sloane, pg 151
    # We write jth term = some_factor * (j-1)th term
    kraw = jth_term = (q-1)**l * binomial(n, l) # j=0
    for j in range(1,l+1):
        jth_term *= -q*(l-j+1)*(i-j+1)/((q-1)*j*(n-j+1))
        kraw += jth_term
    return kraw

n,q,l,i = 10,8,7,5
timeit('Krawtchouk2(n,q,l,i)')
timeit('Krawtchouk (n,q,l,i)')
print Krawtchouk2(n,q,l,i) == Krawtchouk(n,q,l,i)

625 loops, best of 3: 53.3 µs per loop
625 loops, best of 3: 205 µs per loop
True
```

I noticed that sage handles nonintegral components in the binomial, so the expression for the `Krawtchouk` already works with nonintegral `n` and `x`.

```
n,q,l,i = 10.6,8,7,5.4
#timeit('Krawtchouk3(n,q,l,i)')
timeit('Krawtchouk2(n,q,l,i)')
timeit('Krawtchouk (n,q,l,i)')
print Krawtchouk2(n,q,l,i) == Krawtchouk(n,q,l,i)
print Krawtchouk2(n,q,l,i), Krawtchouk(n,q,l,i)

625 loops, best of 3: 382 µs per loop
125 loops, best of 3: 4.74 ms per loop
False
93582.0160001147 93582.0159999999
```



---

archive/issue_comments_182102.json:
```json
{
    "body": "<a id='comment:13'></a>\nCan you mention when it guarantees a weight spectrum? Would doing an `ILP` make it a proper weight spectrum?\n\n```\n   - ``return_data`` -- if ``True``, return a weights vector, which actually need not \n     be a proper weight enumerator, or even have integer entries, and the LP. \n```\n\nAlso, I think the term `weight enumerator` refers to the `weight enumerator polynomial`. Perhaps using `weight distribution` or `distance distribution` is more appropriate here.",
    "created_at": "2012-11-07T10:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182102",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:13'></a>
Can you mention when it guarantees a weight spectrum? Would doing an `ILP` make it a proper weight spectrum?

```
   - ``return_data`` -- if ``True``, return a weights vector, which actually need not 
     be a proper weight enumerator, or even have integer entries, and the LP. 
```

Also, I think the term `weight enumerator` refers to the `weight enumerator polynomial`. Perhaps using `weight distribution` or `distance distribution` is more appropriate here.



---

archive/issue_comments_182103.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [ppurka](#comment%3A12):\n> I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. \n\n\nIt's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest. \n\nBy the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden \nset of distances, rather than just [1..d] ? It's a trivial add-on.\nI did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).\n\nAny other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)",
    "created_at": "2012-11-07T14:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182103",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
Replying to [ppurka](#comment%3A12):
> I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. 


It's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest. 

By the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden 
set of distances, rather than just [1..d] ? It's a trivial add-on.
I did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).

Any other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)



---

archive/issue_comments_182104.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.\n \n-Apply [this patch](http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12418/12418_delsart_bounds.patch)\n+Apply [attachment:12418_delsart_bounds.patch]\n``````\n",
    "created_at": "2012-11-07T14:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182104",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.
 
-Apply [this patch](http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12418/12418_delsart_bounds.patch)
+Apply [attachment:12418_delsart_bounds.patch]
``````




---

archive/issue_events_039131.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-07T14:57:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12418#event-39131"
}
```



---

archive/issue_comments_182105.json:
```json
{
    "body": "**Changing dependencies** from \"#12533\" to \"#12533, #13650\".",
    "created_at": "2012-11-07T14:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182105",
    "user": "https://github.com/dimpase"
}
```

**Changing dependencies** from "#12533" to "#12533, #13650".



---

archive/issue_comments_182106.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [dimpase](#comment%3A14):\n> Replying to [ppurka](#comment%3A12):\n> > I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. \n\n> \n> It's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest.\n\n\nThe point is that someone might try to use these polynomials more generally in a separate context. They are not defined anywhere else in Sage, so anyone who tries to use them will use this one.\n \n> By the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden \n> set of distances, rather than just [1..d] ? It's a trivial add-on.\n> I did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).\n\n\nWow! You have the Johnson scheme too?! Sure, add them all in!! Do you use the polynomials used by Aaltonen?\n\n> Any other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)\n\n\nLP for permutation codes would be interesting. There are not too many good results known there. IIRC, it uses Charlier polynomials.\n\nEDIT: FWIW, it is Charlier polynomials.",
    "created_at": "2012-11-07T14:59:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182106",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:16'></a>
Replying to [dimpase](#comment%3A14):
> Replying to [ppurka](#comment%3A12):
> > I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. 

> 
> It's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest.


The point is that someone might try to use these polynomials more generally in a separate context. They are not defined anywhere else in Sage, so anyone who tries to use them will use this one.
 
> By the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden 
> set of distances, rather than just [1..d] ? It's a trivial add-on.
> I did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).


Wow! You have the Johnson scheme too?! Sure, add them all in!! Do you use the polynomials used by Aaltonen?

> Any other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)


LP for permutation codes would be interesting. There are not too many good results known there. IIRC, it uses Charlier polynomials.

EDIT: FWIW, it is Charlier polynomials.



---

archive/issue_comments_182107.json:
```json
{
    "body": "<a id='comment:17'></a>\nOh, I forgot to add. Forbidden distances will be nice as well. I think only some special cases achieve the closed form solutions. In general, still not much is known. It looks like you only need to drop distances `d_1,...,d_m` instead of `1,...,d`, right?\n\nHow about introducing an extra keyword called `forbidden_distances` or `exclude_distances`, which defaults to `1,...,d`?",
    "created_at": "2012-11-07T15:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182107",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:17'></a>
Oh, I forgot to add. Forbidden distances will be nice as well. I think only some special cases achieve the closed form solutions. In general, still not much is known. It looks like you only need to drop distances `d_1,...,d_m` instead of `1,...,d`, right?

How about introducing an extra keyword called `forbidden_distances` or `exclude_distances`, which defaults to `1,...,d`?



---

archive/issue_comments_182108.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [ppurka](#comment%3A16):\n> Replying to [dimpase](#comment%3A14):\n> > Replying to [ppurka](#comment%3A12):\n> > > I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. \n\n> > \n> > It's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest.\n\n> \n> The point is that someone might try to use these polynomials more generally in a separate context. They are not defined anywhere else in Sage, so anyone who tries to use them will use this one.\n\n\nActually, I have most discrete orthogonal polynomials arising in the classical P- and Q- polynomial schemes \n[implemented](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default), although it's neither polished nor optimized.\n\n[\n>  \n\n> > By the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden \n> > set of distances, rather than just [1..d] ? It's a trivial add-on.\n> > I did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).\n\n> \n> Wow! You have the Johnson scheme too?! Sure, add them all in!! Do you use the polynomials used by Aaltonen?\n\n\nI [use](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default) the descriptions in the book \"Algebraic Combinatorics I\" by E.Bannai and T.Ito.  \nSomething known as [Eberlein polynomials](http://mathworld.wolfram.com/EberleinPolynomial.html).\n\n> \n> > Any other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)\n\n> \n> LP for permutation codes would be interesting. There are not too many good results known there. IIRC, it uses Chebychev polynomials(?).\n\n\nyes, this should be perfectly doable.",
    "created_at": "2012-11-07T15:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182108",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
Replying to [ppurka](#comment%3A16):
> Replying to [dimpase](#comment%3A14):
> > Replying to [ppurka](#comment%3A12):
> > > I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. 

> > 
> > It's probably even faster to compute by using recurrence relations, but I don't think it's important here: LP solving timing clearly dominates the rest.

> 
> The point is that someone might try to use these polynomials more generally in a separate context. They are not defined anywhere else in Sage, so anyone who tries to use them will use this one.


Actually, I have most discrete orthogonal polynomials arising in the classical P- and Q- polynomial schemes 
[implemented](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default), although it's neither polished nor optimized.

[
>  

> > By the way, would it be interesting to include an option to compute bounds on codes with a prescribed forbidden 
> > set of distances, rather than just [1..d] ? It's a trivial add-on.
> > I did this in a prototype code for Johnson schemes, [here](http://mathoverflow.net/questions/111603/intersecting-4-sets/111647#111647).

> 
> Wow! You have the Johnson scheme too?! Sure, add them all in!! Do you use the polynomials used by Aaltonen?


I [use](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default) the descriptions in the book "Algebraic Combinatorics I" by E.Bannai and T.Ito.  
Something known as [Eberlein polynomials](http://mathworld.wolfram.com/EberleinPolynomial.html).

> 
> > Any other interesting schemes to include? (Johnson scheme takes care of constant weight binary codes, as you know.)

> 
> LP for permutation codes would be interesting. There are not too many good results known there. IIRC, it uses Chebychev polynomials(?).


yes, this should be perfectly doable.



---

archive/issue_comments_182109.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [dimpase](#comment%3A18):\n> I [use](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default) the descriptions in the book \"Algebraic Combinatorics I\" by E.Bannai and T.Ito.  \n> Something known as [Eberlein polynomials](http://mathworld.wolfram.com/EberleinPolynomial.html).\n\n\nThat's for the binary case. For the q-ary case it is a product of Krawtchouk and Hahn, if I recall properly. Let me fish out the paper; I will send it to you.",
    "created_at": "2012-11-07T15:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182109",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:19'></a>
Replying to [dimpase](#comment%3A18):
> I [use](https://bitbucket.org/dimpase/qcode/src/9e3b79dc71992aa2a8ea170dbd13f9f373772411/aw.sage?at=default) the descriptions in the book "Algebraic Combinatorics I" by E.Bannai and T.Ito.  
> Something known as [Eberlein polynomials](http://mathworld.wolfram.com/EberleinPolynomial.html).


That's for the binary case. For the q-ary case it is a product of Krawtchouk and Hahn, if I recall properly. Let me fish out the paper; I will send it to you.



---

archive/issue_comments_182110.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [ppurka](#comment%3A12):\n> I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. I have something like this in mind:\n\n\nThis can be further optimized by using Horner's rule. I'll do this, and leave the rest (other schemes) for another ticket, OK?",
    "created_at": "2013-01-07T06:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182110",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Replying to [ppurka](#comment%3A12):
> I think the `Krawtchouk` polynomial could be computed explicitly by not making repeated calls to `binomial`. This should speed it up. I have something like this in mind:


This can be further optimized by using Horner's rule. I'll do this, and leave the rest (other schemes) for another ticket, OK?



---

archive/issue_comments_182111.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [dimpase](#comment%3A20):\n> This can be further optimized by using Horner's rule. I'll do this, and leave the rest (other schemes) for another ticket, OK?\n\n\nYes, yes. One space/polynomial at a time. Just Hamming space in this ticket is OK.",
    "created_at": "2013-01-07T07:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182111",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:21'></a>
Replying to [dimpase](#comment%3A20):
> This can be further optimized by using Horner's rule. I'll do this, and leave the rest (other schemes) for another ticket, OK?


Yes, yes. One space/polynomial at a time. Just Hamming space in this ticket is OK.



---

archive/issue_comments_182112.json:
```json
{
    "body": "Attachment [update.diff](tarball://root/attachments/some-uuid/ticket12418/update.diff) by @dimpase created at 2013-01-08 03:32:53\n\nupdate of the patch - for reviewing only",
    "created_at": "2013-01-08T03:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182112",
    "user": "https://github.com/dimpase"
}
```

Attachment [update.diff](tarball://root/attachments/some-uuid/ticket12418/update.diff) by @dimpase created at 2013-01-08 03:32:53

update of the patch - for reviewing only



---

archive/issue_comments_182113.json:
```json
{
    "body": "<a id='comment:22'></a>\nPlease review. I added a Kravchouck speedup, and cleaned up docstrings as requested.",
    "created_at": "2013-01-08T03:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182113",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>
Please review. I added a Kravchouck speedup, and cleaned up docstrings as requested.



---

archive/issue_comments_182114.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,5 @@\n Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.\n \n-See the attached prototype implementation for details.\n-\n-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.\n+To work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.\n \n Apply [attachment:12418_delsart_bounds.patch]\n``````\n",
    "created_at": "2013-01-08T03:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182114",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,5 @@
 Delsarte bound for codes, aka Linear Programming bound, is easy to implement in Sage.
 
-See the attached prototype implementation for details.
-
-One obstacle for this to work well in big dimensions is a lack of arbitrary precision LP solver backend available in Sage. This is  taken care of by #12533, which is a dependence for this ticket.
+To work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.
 
 Apply [attachment:12418_delsart_bounds.patch]
``````




---

archive/issue_comments_182115.json:
```json
{
    "body": "<a id='comment:23'></a>\nimproved docstrings for `return_data`",
    "created_at": "2013-01-08T05:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182115",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
improved docstrings for `return_data`



---

archive/issue_comments_182116.json:
```json
{
    "body": "<a id='comment:24'></a>\nThanks for the update. I have some general comments. Will look into this patch in more detail too.\n1. There are lot of trailing whitespaces. The patchbot will complain. :)\n2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?\n\n```python\n   kk = 0\n   while q_base**kk < q:\n      kk += 1\n```\n3. There is another bit further down:\n\n```python\n      m = -1\n      while q_base**(m+1) < bd:\n        m += 1\n      if q_base**(m+1) == bd:\n        m += 1\n```\n4. Also, I don't think this deprecation is necessary any more. The ticket you cited is over 2 years old.\n\n```diff\n-def dimension_upper_bound(n,d,q):\n+@rename_keyword(deprecation=6094, method=\"algorithm\")\n+def dimension_upper_bound(n,d,q,algorithm=None):\n```\n\n**Edit:** Sorry. It seems `ZZ` doesn't work but `int(log(..))` does work.",
    "created_at": "2013-01-08T09:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182116",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:24'></a>
Thanks for the update. I have some general comments. Will look into this patch in more detail too.
1. There are lot of trailing whitespaces. The patchbot will complain. :)
2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?

```python
   kk = 0
   while q_base**kk < q:
      kk += 1
```
3. There is another bit further down:

```python
      m = -1
      while q_base**(m+1) < bd:
        m += 1
      if q_base**(m+1) == bd:
        m += 1
```
4. Also, I don't think this deprecation is necessary any more. The ticket you cited is over 2 years old.

```diff
-def dimension_upper_bound(n,d,q):
+@rename_keyword(deprecation=6094, method="algorithm")
+def dimension_upper_bound(n,d,q,algorithm=None):
```

**Edit:** Sorry. It seems `ZZ` doesn't work but `int(log(..))` does work.



---

archive/issue_comments_182117.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [ppurka](#comment%3A24):\n> Thanks for the update. I have some general comments. Will look into this patch in more detail too.\n> 1. There are lot of trailing whitespaces. The patchbot will complain. :)\n  \nI've just uploaded an update with all the trailing spaces removed.\n\n> 2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?\n> \n> ```python\n>    kk = 0\n>    while q_base**kk < q:\n>       kk += 1\n> ```\n> 3. There is another bit further down:\n> \n> ```python\n>       m = -1\n>       while q_base**(m+1) < bd:\n>         m += 1\n>       if q_base**(m+1) == bd:\n>         m += 1\n> ```\n\n\nthis came from an older piece of plain Python. Then I struggled with log() quite a bit, and finally gave up on it and rolled my own. \n\n\n> 4. Also, I don't think this deprecation is necessary any more. The ticket you cited is over 2 years old.\n> \n> ```diff\n> -def dimension_upper_bound(n,d,q):\n> +@rename_keyword(deprecation=6094, method=\"algorithm\")\n> +def dimension_upper_bound(n,d,q,algorithm=None):\n> ```\n\n\nI blindly copied from `sage/coding/code_bounds.py`\nShould the whole file be cleaned out of these?\nBy the way, plural `methods` slipped through this decorator...\n\n\n> \n> **Edit:** Sorry. It seems `ZZ` doesn't work but `int(log(..))` does work.\n",
    "created_at": "2013-01-08T13:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182117",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>
Replying to [ppurka](#comment%3A24):
> Thanks for the update. I have some general comments. Will look into this patch in more detail too.
> 1. There are lot of trailing whitespaces. The patchbot will complain. :)
  
I've just uploaded an update with all the trailing spaces removed.

> 2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?
> 
> ```python
>    kk = 0
>    while q_base**kk < q:
>       kk += 1
> ```
> 3. There is another bit further down:
> 
> ```python
>       m = -1
>       while q_base**(m+1) < bd:
>         m += 1
>       if q_base**(m+1) == bd:
>         m += 1
> ```


this came from an older piece of plain Python. Then I struggled with log() quite a bit, and finally gave up on it and rolled my own. 


> 4. Also, I don't think this deprecation is necessary any more. The ticket you cited is over 2 years old.
> 
> ```diff
> -def dimension_upper_bound(n,d,q):
> +@rename_keyword(deprecation=6094, method="algorithm")
> +def dimension_upper_bound(n,d,q,algorithm=None):
> ```


I blindly copied from `sage/coding/code_bounds.py`
Should the whole file be cleaned out of these?
By the way, plural `methods` slipped through this decorator...


> 
> **Edit:** Sorry. It seems `ZZ` doesn't work but `int(log(..))` does work.




---

archive/issue_comments_182118.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [ppurka](#comment%3A24):\n> Thanks for the update. I have some general comments. Will look into this patch in more detail too.\n\n\n> 2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?\n\n\nyes, it is basically what it does; this is also needed to do a Gomory-style cut which might be available due to the corresponding rounding.",
    "created_at": "2013-01-10T12:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182118",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>
Replying to [ppurka](#comment%3A24):
> Thanks for the update. I have some general comments. Will look into this patch in more detail too.


> 2. What is the point of this portion of the code? Can't it be replaced by `kk = ZZ(log(q, q_base))`?


yes, it is basically what it does; this is also needed to do a Gomory-style cut which might be available due to the corresponding rounding.



---

archive/issue_comments_182119.json:
```json
{
    "body": "<a id='comment:27'></a>\nOk. I am finally getting some time to look into this again. Here are some comments.\n1. `Krawtchouk` is missing a doctest.\n2. There is no need of `\\` in `def delsarte_bound_...`\n3. There are still many trailing whitespaces. If you use vim then you can try this command `:%s/[ ]\\+$//`\n4. <code>   - ``q`` -- the length of the alphabet</code> -- this should be \"the *size* of the alphabet\"\n    Also I think the the options `q` and `d` can be swapped to be in the order in which they appear\n    in the function definition.\n5. <code>- ``solver`` -- the LP/ILP solved </code> --- this should be *solver*.\n   What other solvers are present? They should be listed as options in this\n   variable.\n6. `The bound on the size of the F_2-codes` --- this should be *<code>`F_2`</code>*\n7.  <code> - ``return_data`` </code> --- As it is currently written in the description, it is unclear what this is returning. It looks like the first component is an MIP variable (and not a vector), and the second component is the MILP itself. At a first glance in your doctests, it looks like we need to understand how the MILP works in order to get the values of the weight distribution. Should we just return the weight distribution itself?  A weight distribution vector can be returned by doing `p.get_values(a).values()`.\n8. The backend should automatically handle \"isinteger=True\" at least so that it is functional. Currently I get a very generic Exception (why is this only \"Exception\"?). Maybe it is automatically handled in a later version of sage? I will have to check against 5.6.beta1 and higher:\n\n```\nException: This backend does not handle integer variables ! Read the doc !\n```\n9. Why do we need the second function? We already discussed this off-ticket - I will wait for your generic function.\n10. `(**this option is currenly disabled, cf. trac #13667**). ` --- it should be *<code>:trac:`13667`</code>* since it will be in the documentation.\n21. `    Parameter \"algorithm\" has the same meaning as in codesize_upper_bound() ` --- This should be *<code>:func:`codesize_upper_bound`</code>*.\n32. `      print \"Wrong q_base=\", q_base, \" for q=\", q, kk` --- This can be formatted python3 style as\n\n```\n      print \"Wrong q_base={} for q={} {}\".format(q_base, q, kk)\n```\n13. According to the patchbot this needs rebasing against some higher version of 5.6. I have only beta0 here; I will check it against rc1 after I have compiled that.\n24. EDIT: I forgot.. the deprecation notice should go. It has been two years. If code_bounds needs to be cleaned then I can do that.\n\nEDIT: Update backticks in 6., 10., 11.",
    "created_at": "2013-01-24T11:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182119",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:27'></a>
Ok. I am finally getting some time to look into this again. Here are some comments.
1. `Krawtchouk` is missing a doctest.
2. There is no need of `\` in `def delsarte_bound_...`
3. There are still many trailing whitespaces. If you use vim then you can try this command `:%s/[ ]\+$//`
4. <code>   - ``q`` -- the length of the alphabet</code> -- this should be "the *size* of the alphabet"
    Also I think the the options `q` and `d` can be swapped to be in the order in which they appear
    in the function definition.
5. <code>- ``solver`` -- the LP/ILP solved </code> --- this should be *solver*.
   What other solvers are present? They should be listed as options in this
   variable.
6. `The bound on the size of the F_2-codes` --- this should be *<code>`F_2`</code>*
7.  <code> - ``return_data`` </code> --- As it is currently written in the description, it is unclear what this is returning. It looks like the first component is an MIP variable (and not a vector), and the second component is the MILP itself. At a first glance in your doctests, it looks like we need to understand how the MILP works in order to get the values of the weight distribution. Should we just return the weight distribution itself?  A weight distribution vector can be returned by doing `p.get_values(a).values()`.
8. The backend should automatically handle "isinteger=True" at least so that it is functional. Currently I get a very generic Exception (why is this only "Exception"?). Maybe it is automatically handled in a later version of sage? I will have to check against 5.6.beta1 and higher:

```
Exception: This backend does not handle integer variables ! Read the doc !
```
9. Why do we need the second function? We already discussed this off-ticket - I will wait for your generic function.
10. `(**this option is currenly disabled, cf. trac #13667**). ` --- it should be *<code>:trac:`13667`</code>* since it will be in the documentation.
21. `    Parameter "algorithm" has the same meaning as in codesize_upper_bound() ` --- This should be *<code>:func:`codesize_upper_bound`</code>*.
32. `      print "Wrong q_base=", q_base, " for q=", q, kk` --- This can be formatted python3 style as

```
      print "Wrong q_base={} for q={} {}".format(q_base, q, kk)
```
13. According to the patchbot this needs rebasing against some higher version of 5.6. I have only beta0 here; I will check it against rc1 after I have compiled that.
24. EDIT: I forgot.. the deprecation notice should go. It has been two years. If code_bounds needs to be cleaned then I can do that.

EDIT: Update backticks in 6., 10., 11.



---

archive/issue_comments_182120.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-02-20T16:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182120",
    "user": "https://github.com/KPanComputes"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_182121.json:
```json
{
    "body": "<a id='comment:28'></a>\nThis patch needs to address referee's comments. I am changing this to `needs_work` in the meanwhile.",
    "created_at": "2013-02-20T16:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182121",
    "user": "https://github.com/KPanComputes"
}
```

<a id='comment:28'></a>
This patch needs to address referee's comments. I am changing this to `needs_work` in the meanwhile.



---

archive/issue_comments_182122.json:
```json
{
    "body": "Attachment [12418_delsart_bounds.2.patch](tarball://root/attachments/some-uuid/ticket12418/12418_delsart_bounds.2.patch) by @dimpase created at 2013-06-15 13:46:39\n\nrebased for Sage 5.10 and fixed some outstanding issues",
    "created_at": "2013-06-15T13:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182122",
    "user": "https://github.com/dimpase"
}
```

Attachment [12418_delsart_bounds.2.patch](tarball://root/attachments/some-uuid/ticket12418/12418_delsart_bounds.2.patch) by @dimpase created at 2013-06-15 13:46:39

rebased for Sage 5.10 and fixed some outstanding issues



---

archive/issue_comments_182123.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [ppurka](#comment%3A27):\n\nrebased to Sage 5.10 and fixed the following:\n> 1. `Krawtchouk` is missing a doctest.\n> 2. There is no need of `\\` in `def delsarte_bound_...`\n> 3. There are still many trailing whitespaces. If you use vim then you can try this command `:%s/[ ]\\+$//`\n> 4. <code>   - ``q`` -- the length of the alphabet</code> -- this should be \"the *size* of the alphabet\"\n>     Also I think the the options `q` and `d` can be swapped to be in the order in which they appear\n>     in the function definition.\n  \nI swapped the docstrings instead.\n\n> 5. <code>- ``solver`` -- the LP/ILP solved </code> --- this should be *solver*.\n>    What other solvers are present? They should be listed as options in this\n>    variable.\n> 6. `The bound on the size of the F_2-codes` --- this should be *<code>`F_2`</code>*\n  \n(and other `F_`)\n\n> 8. The backend should automatically handle \"isinteger=True\" at least so that it is functional. Currently I get a very generic Exception (why is this only \"Exception\"?). Maybe it is automatically handled in a later version of sage? I will have to check against 5.6.beta1 and higher:\n\n\nThe PPL backend does not handle ILP. One might want to improve the way it reports this error, but not on this ticket.\n\n\n\n> ```\n> Exception: This backend does not handle integer variables ! Read the doc !\n> ```\n\n\n> 11. `    Parameter \"algorithm\" has the same meaning as in codesize_upper_bound() ` --- This should be *<code>:func:`codesize_upper_bound`</code>*.\n> 23. According to the patchbot this needs rebasing against some higher version of 5.6. I have only beta0 here; I will check it against rc1 after I have compiled that.\n  \nRebased.",
    "created_at": "2013-06-15T13:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182123",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
Replying to [ppurka](#comment%3A27):

rebased to Sage 5.10 and fixed the following:
> 1. `Krawtchouk` is missing a doctest.
> 2. There is no need of `\` in `def delsarte_bound_...`
> 3. There are still many trailing whitespaces. If you use vim then you can try this command `:%s/[ ]\+$//`
> 4. <code>   - ``q`` -- the length of the alphabet</code> -- this should be "the *size* of the alphabet"
>     Also I think the the options `q` and `d` can be swapped to be in the order in which they appear
>     in the function definition.
  
I swapped the docstrings instead.

> 5. <code>- ``solver`` -- the LP/ILP solved </code> --- this should be *solver*.
>    What other solvers are present? They should be listed as options in this
>    variable.
> 6. `The bound on the size of the F_2-codes` --- this should be *<code>`F_2`</code>*
  
(and other `F_`)

> 8. The backend should automatically handle "isinteger=True" at least so that it is functional. Currently I get a very generic Exception (why is this only "Exception"?). Maybe it is automatically handled in a later version of sage? I will have to check against 5.6.beta1 and higher:


The PPL backend does not handle ILP. One might want to improve the way it reports this error, but not on this ticket.



> ```
> Exception: This backend does not handle integer variables ! Read the doc !
> ```


> 11. `    Parameter "algorithm" has the same meaning as in codesize_upper_bound() ` --- This should be *<code>:func:`codesize_upper_bound`</code>*.
> 23. According to the patchbot this needs rebasing against some higher version of 5.6. I have only beta0 here; I will check it against rc1 after I have compiled that.
  
Rebased.



---

archive/issue_comments_182124.json:
```json
{
    "body": "**Work_Issues:** code refactoring",
    "created_at": "2013-06-22T07:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182124",
    "user": "https://github.com/dimpase"
}
```

**Work_Issues:** code refactoring



---

archive/issue_comments_182125.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [dimpase](#comment%3A30):\n> Work issues set to code refactoring\n\n\nOh good. I was wondering if you didn't want to do that in this patch.",
    "created_at": "2013-06-22T08:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182125",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:31'></a>
Replying to [dimpase](#comment%3A30):
> Work issues set to code refactoring


Oh good. I was wondering if you didn't want to do that in this patch.



---

archive/issue_comments_182126.json:
```json
{
    "body": "rebased for Sage 5.10 and fixed some outstanding issues",
    "created_at": "2013-07-01T14:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182126",
    "user": "https://github.com/dimpase"
}
```

rebased for Sage 5.10 and fixed some outstanding issues



---

archive/issue_comments_182127.json:
```json
{
    "body": "Attachment [12418_refactored.diff](tarball://root/attachments/some-uuid/ticket12418/12418_refactored.diff) by @dimpase created at 2013-07-01 14:31:57\n\ncode refactoring - for review only",
    "created_at": "2013-07-01T14:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182127",
    "user": "https://github.com/dimpase"
}
```

Attachment [12418_refactored.diff](tarball://root/attachments/some-uuid/ticket12418/12418_refactored.diff) by @dimpase created at 2013-07-01 14:31:57

code refactoring - for review only



---

archive/issue_comments_182128.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-07-01T14:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182128",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_182129.json:
```json
{
    "body": "**Changing work_issues** from \"code refactoring\" to \"\".",
    "created_at": "2013-07-01T14:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182129",
    "user": "https://github.com/dimpase"
}
```

**Changing work_issues** from "code refactoring" to "".



---

archive/issue_comments_182130.json:
```json
{
    "body": "<a id='comment:33'></a>\ninstructions for the bot:\n\napply 12418_delsart_bounds.patch",
    "created_at": "2013-07-05T15:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182130",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'></a>
instructions for the bot:

apply 12418_delsart_bounds.patch



---

archive/issue_comments_182131.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-07-05T18:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182131",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_182132.json:
```json
{
    "body": "<a id='comment:34'></a>\n* doctest covering is not 100%\n\n* you can use the wikipedia role for example <code>:wikipedia:`Togo`</code>\n\n* it would be better to lazy_import the new functions, maybe ?",
    "created_at": "2013-07-05T18:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182132",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'></a>
* doctest covering is not 100%

* you can use the wikipedia role for example <code>:wikipedia:`Togo`</code>

* it would be better to lazy_import the new functions, maybe ?



---

archive/issue_comments_182133.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [chapoton](#comment%3A34):\n> * doctest covering is not 100%\n\n\nhmm, what function do you mean? there is an internal function which is not exported; I don't think it needs a doctest, does it?\n\n> \n> * you can use the wikipedia role for example <code>:wikipedia:`Togo`</code>\n\n\nwhere?\n\n> \n> * it would be better to lazy_import the new functions, maybe ?\n\n\nI have no idea. Is there a stated policy on this?\nHaving said this, perhaps it's better to re-lazy_import the whole `sage/coding`, something for another ticket?",
    "created_at": "2013-07-05T19:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182133",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>
Replying to [chapoton](#comment%3A34):
> * doctest covering is not 100%


hmm, what function do you mean? there is an internal function which is not exported; I don't think it needs a doctest, does it?

> 
> * you can use the wikipedia role for example <code>:wikipedia:`Togo`</code>


where?

> 
> * it would be better to lazy_import the new functions, maybe ?


I have no idea. Is there a stated policy on this?
Having said this, perhaps it's better to re-lazy_import the whole `sage/coding`, something for another ticket?



---

archive/issue_comments_182134.json:
```json
{
    "body": "<a id='comment:36'></a>\n* well, the bot complains about the missing doctest, so I guess that the internal function needs one indeed\n\n* instead of <code>`en.wikipedia.org/wiki/Kravchuk_polynomials <http://en.wikipedia.org/wiki/Kravchuk_polynomials>`_</code>\n\nyou can write <code>:wikipedia:`Kravchuk_polynomials`</code>\n\n* the bot is not happy either on adding something new in the global namespace. It is better for the startup time of sage to try and make the bot happy on this point, imho.",
    "created_at": "2013-07-05T19:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182134",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'></a>
* well, the bot complains about the missing doctest, so I guess that the internal function needs one indeed

* instead of <code>`en.wikipedia.org/wiki/Kravchuk_polynomials <http://en.wikipedia.org/wiki/Kravchuk_polynomials>`_</code>

you can write <code>:wikipedia:`Kravchuk_polynomials`</code>

* the bot is not happy either on adding something new in the global namespace. It is better for the startup time of sage to try and make the bot happy on this point, imho.



---

archive/issue_comments_182135.json:
```json
{
    "body": "Attachment [12418_update.patch](tarball://root/attachments/some-uuid/ticket12418/12418_update.patch) by @dimpase created at 2013-07-06 22:00:18\n\nupdate to fix the remaining issues",
    "created_at": "2013-07-06T22:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182135",
    "user": "https://github.com/dimpase"
}
```

Attachment [12418_update.patch](tarball://root/attachments/some-uuid/ticket12418/12418_update.patch) by @dimpase created at 2013-07-06 22:00:18

update to fix the remaining issues



---

archive/issue_comments_182136.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-07-06T22:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182136",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_182137.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,7 @@\n \n To work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.\n \n-Apply [attachment:12418_delsart_bounds.patch]\n+Apply\n+\n+* [attachment:12418_delsart_bounds.patch]\n+* [attachment:12418_update.patch]\n``````\n",
    "created_at": "2013-07-06T22:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182137",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,7 @@
 
 To work well in big dimensions, one needs an arbitrary precision LP solver. We use an LP backend to PPL, which is available in Sage since #12533.
 
-Apply [attachment:12418_delsart_bounds.patch]
+Apply
+
+* [attachment:12418_delsart_bounds.patch]
+* [attachment:12418_update.patch]
``````




---

archive/issue_comments_182138.json:
```json
{
    "body": "<a id='comment:38'></a>\nThe patch looks OK to me now. Though I would have really liked the Q-matrix to be passed to the linear program (for instance to the delsarte LP building function), this can be done in a future patch when LP for other spaces are introduced.",
    "created_at": "2013-07-18T07:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182138",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:38'></a>
The patch looks OK to me now. Though I would have really liked the Q-matrix to be passed to the linear program (for instance to the delsarte LP building function), this can be done in a future patch when LP for other spaces are introduced.



---

archive/issue_comments_182139.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-07-18T07:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182139",
    "user": "https://github.com/ppurka"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_182140.json:
```json
{
    "body": "**Author:** Dmitrii Pasechnik",
    "created_at": "2013-07-18T07:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182140",
    "user": "https://github.com/ppurka"
}
```

**Author:** Dmitrii Pasechnik



---

archive/issue_comments_182141.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Punarbasu Purkayastha",
    "created_at": "2013-07-18T07:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182141",
    "user": "https://github.com/ppurka"
}
```

**Reviewer:** Frédéric Chapoton, Punarbasu Purkayastha



---

archive/issue_events_039132.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:42:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12418#event-39132"
}
```



---

archive/issue_events_039133.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:42:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12418#event-39133"
}
```



---

archive/issue_comments_182142.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-08-16T21:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182142",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed



---

archive/issue_comments_182143.json:
```json
{
    "body": "**Merged:** sage-5.12.beta1",
    "created_at": "2013-08-16T21:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12418#issuecomment-182143",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.12.beta1



---

archive/issue_events_039134.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:10:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12418",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12418#event-39134"
}
```
