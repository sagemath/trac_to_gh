# Issue 12880: Inconsistent domain, codomain and parent in EllipticCurveIsogeny

archive/issues_012708.json:
```json
{
    "body": "In the following example, the domain and codomain of phi do not match those of its parent::\n\n```\nsage: E = EllipticCurve(j=GF(7)(0))\nsage: phi = EllipticCurveIsogeny(E, [E(0), E((0,1)), E((0,-1))])\nsage: phi.parent()\nSet of Morphisms from Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 to Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 in Category of hom sets in Category of Schemes\nsage: phi.parent().domain()\nAbelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7\nsage: phi.domain()\nElliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7\nsage: phi.parent().codomain()\nAbelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7\nsage: phi.codomain()\nElliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7\n```\n\n\nAssignee: @JohnCremona\n\nCC:  sage-combinat @pjbruin @defeo sbesnier\n\nKeywords: isogeny\n\nBranch/Commit: 02bc4122b7a49400e327f3a0259890eb0cce6705\n\nReviewer: Peter Bruin\n\nAuthor: S\u00e9bastien Besnier\n\nDependencies: #11474\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12880\n\n",
    "closed_at": "2014-07-17T13:57:30Z",
    "created_at": "2012-04-25T14:10:45Z",
    "labels": [
        "component: elliptic curves",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Inconsistent domain, codomain and parent in EllipticCurveIsogeny",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12880",
    "user": "https://github.com/nthiery"
}
```
In the following example, the domain and codomain of phi do not match those of its parent::

```
sage: E = EllipticCurve(j=GF(7)(0))
sage: phi = EllipticCurveIsogeny(E, [E(0), E((0,1)), E((0,-1))])
sage: phi.parent()
Set of Morphisms from Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 to Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 in Category of hom sets in Category of Schemes
sage: phi.parent().domain()
Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7
sage: phi.domain()
Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7
sage: phi.parent().codomain()
Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7
sage: phi.codomain()
Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7
```


Assignee: @JohnCremona

CC:  sage-combinat @pjbruin @defeo sbesnier

Keywords: isogeny

Branch/Commit: 02bc4122b7a49400e327f3a0259890eb0cce6705

Reviewer: Peter Bruin

Author: Sébastien Besnier

Dependencies: #11474

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12880





---

archive/issue_comments_151831.json:
```json
{
    "body": "Changing component from number theory to elliptic curves.",
    "created_at": "2013-07-25T17:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151831",
    "user": "https://github.com/loefflerd"
}
```

Changing component from number theory to elliptic curves.



---

archive/issue_comments_151832.json:
```json
{
    "body": "Changing assignee from @williamstein to @JohnCremona.",
    "created_at": "2013-07-25T17:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151832",
    "user": "https://github.com/loefflerd"
}
```

Changing assignee from @williamstein to @JohnCremona.



---

archive/issue_events_035145.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35145"
}
```



---

archive/issue_events_035146.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35146"
}
```



---

archive/issue_events_035147.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35147"
}
```



---

archive/issue_comments_151833.json:
```json
{
    "body": "<a id='comment:5'></a>I have used elliptic curve isogenies a huge amount and this has never bothered me, presumably because it never occurred to me to ask for the parent of an isogeny.  If anyone wants to change this without breaking anything they are welcome, but I don't care very much.",
    "created_at": "2014-04-07T20:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151833",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>I have used elliptic curve isogenies a huge amount and this has never bothered me, presumably because it never occurred to me to ask for the parent of an isogeny.  If anyone wants to change this without breaking anything they are welcome, but I don't care very much.



---

archive/issue_comments_151834.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-04-08T00:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151834",
    "user": "https://github.com/pjbruin"
}
```

Changing priority from major to minor.



---

archive/issue_comments_151835.json:
```json
{
    "body": "<a id='comment:6'></a>It should be very easy to fix in principle:\n\n```diff\ndiff --git a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py b/src/sage/schemes/e\nindex 5cdbbdf..a729d3a 100644\n--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n@@ -1322,12 +1322,9 @@ class EllipticCurveIsogeny(Morphism):\n         self._codomain = self.__E2\n \n         # sets up the parent\n-        parent = homset.Hom(self.__E1(0).parent(), self.__E2(0).parent())\n+        parent = homset.Hom(self.__E1, self.__E2)\n         Morphism.__init__(self, parent)\n \n-        return\n-\n-\n     # initializes the base field\n     def __init_algebraic_structs(self, E):\n         r\"\"\"\n```\nThe only problem is that this breaks testing for equality of isogenies, due to #11474.  Suppose `E -> E1` is an isogeny and `E2` is an elliptic curve that is equal but not *identical* to `E1`.  Then `Hom(E, E1)` and `Hom(E, E2)` will also be equal but not identical; since the coercion model assumes uniqueness of parents, it will never regard corresponding elements of `Hom(E, E1)` and `Hom(E, E2)` as equal.\n\nFor some reason the Hom sets between the groups of points, on the other hand, *are* identical, which explains why equality testing currently is not broken.",
    "created_at": "2014-04-08T00:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151835",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:6'></a>It should be very easy to fix in principle:

```diff
diff --git a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py b/src/sage/schemes/e
index 5cdbbdf..a729d3a 100644
--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
@@ -1322,12 +1322,9 @@ class EllipticCurveIsogeny(Morphism):
         self._codomain = self.__E2
 
         # sets up the parent
-        parent = homset.Hom(self.__E1(0).parent(), self.__E2(0).parent())
+        parent = homset.Hom(self.__E1, self.__E2)
         Morphism.__init__(self, parent)
 
-        return
-
-
     # initializes the base field
     def __init_algebraic_structs(self, E):
         r"""
```
The only problem is that this breaks testing for equality of isogenies, due to #11474.  Suppose `E -> E1` is an isogeny and `E2` is an elliptic curve that is equal but not *identical* to `E1`.  Then `Hom(E, E1)` and `Hom(E, E2)` will also be equal but not identical; since the coercion model assumes uniqueness of parents, it will never regard corresponding elements of `Hom(E, E1)` and `Hom(E, E2)` as equal.

For some reason the Hom sets between the groups of points, on the other hand, *are* identical, which explains why equality testing currently is not broken.



---

archive/issue_comments_151836.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2014-04-25T09:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151836",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_151837.json:
```json
{
    "body": "<a id='comment:10'></a>I've also make some modifications in order to make the composition working (essentially, remove the overload of `_composition_').",
    "created_at": "2014-04-25T09:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151837",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:10'></a>I've also make some modifications in order to make the composition working (essentially, remove the overload of `_composition_').



---

archive/issue_comments_151838.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-25T10:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151838",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_151839.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-25T14:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151839",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_151840.json:
```json
{
    "body": "<a id='comment:12'></a>Wow. It's so cool to be finally able to compose isogenies!\n\nThere's various doctests failing in `ell_curve_isogeny.py`. Most of them are because of #11474, so they should be ok once that one's fixed. However there's one weird failure, not sure if it depends on #11474 too:\n\n```\nFile \"src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\", line 945, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny._call_\nFailed example:\n    phi(E(15,20), output_base_ring=GF(23^2,'alpha'))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/home/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 839, in execute\n        exec compiled in globs\n      File \"<doctest sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny._call_[6]>\", line 1, in <module>\n        phi(E(Integer(15),Integer(20)), output_base_ring=GF(Integer(23)**Integer(2),'alpha'))\n      File \"map.pyx\", line 764, in sage.categories.map.Map.__call__ (sage/categories/map.c:5434)\n      File \"map.pyx\", line 797, in sage.categories.map.Map._call_with_args (sage/categories/map.c:5698)\n    NotImplementedError: _call_with_args not overridden to accept arguments for <class 'sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny'>\n```",
    "created_at": "2014-04-25T14:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151840",
    "user": "https://github.com/defeo"
}
```

<a id='comment:12'></a>Wow. It's so cool to be finally able to compose isogenies!

There's various doctests failing in `ell_curve_isogeny.py`. Most of them are because of #11474, so they should be ok once that one's fixed. However there's one weird failure, not sure if it depends on #11474 too:

```
File "src/sage/schemes/elliptic_curves/ell_curve_isogeny.py", line 945, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny._call_
Failed example:
    phi(E(15,20), output_base_ring=GF(23^2,'alpha'))
Exception raised:
    Traceback (most recent call last):
      File "/home/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/home/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny._call_[6]>", line 1, in <module>
        phi(E(Integer(15),Integer(20)), output_base_ring=GF(Integer(23)**Integer(2),'alpha'))
      File "map.pyx", line 764, in sage.categories.map.Map.__call__ (sage/categories/map.c:5434)
      File "map.pyx", line 797, in sage.categories.map.Map._call_with_args (sage/categories/map.c:5698)
    NotImplementedError: _call_with_args not overridden to accept arguments for <class 'sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny'>
```



---

archive/issue_comments_151841.json:
```json
{
    "body": "<a id='comment:13'></a>Oh I think I'm responsible for that. I've brutally renamed \"!__call!__\" to \"_call_\". I try to look at this.",
    "created_at": "2014-04-25T15:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151841",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:13'></a>Oh I think I'm responsible for that. I've brutally renamed "!__call!__" to "_call_". I try to look at this.



---

archive/issue_comments_151842.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-04-25T17:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151842",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_151843.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-25T17:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151843",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_151844.json:
```json
{
    "body": "<a id='comment:16'></a>I've moved the \"weird failure\" reported at the comment 12 in #16238. Currently, the only failures on doctests depend on #11474.\n\nIt's one of the first time I use git and I had to change the history of the branch because of bad manipulations. I hope it won't bother anybody... Promise I won't do that again!",
    "created_at": "2014-04-25T17:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151844",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:16'></a>I've moved the "weird failure" reported at the comment 12 in #16238. Currently, the only failures on doctests depend on #11474.

It's one of the first time I use git and I had to change the history of the branch because of bad manipulations. I hope it won't bother anybody... Promise I won't do that again!



---

archive/issue_comments_151845.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:10 sbesnier]:\n> I've also make some modifications in order to make the composition working (essentially, remove the overload of `_composition_').\n\nThis looks good to me overall.  The main thing I am wondering about is if it wouldn't make sense to keep the current version of `_composition_` (raise a `NotImplementedError`) until we have real composition of isogenies.  What I mean is that with your change, we just get a \"formal\" composition of two isogenies.  Although this may be good enough for some applications, what we really want is to compute the actual polynomials defining the composed isogeny.  From that perspective I wouldn't say that removing the method \"makes composition work\".\n\nThe question is whether it is worth having a \"formal\" composition in the (hopefully short!) time interval until we have \"flesh-and-blood\" composition of isogenies.  In other words, wouldn't it be reasonable to just make the following doctest change instead of removing the `_composition_()` method?\n\n```diff\ndiff --git a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py b/src/sage/schemes/elliptic_\ncurves/ell_curve_isogeny.py\nindex 101b81e..8b18590 100644\n--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n@@ -3342,21 +3301,12 @@ class EllipticCurveIsogeny(Morphism):\n             ...\n             NotImplementedError\n\n-        The following should test that :meth:`_composition_` is called\n-        upon a product. However phi is currently improperly\n-        constructed (see :trac:`12880`), which triggers an assertion\n-        failure before the actual call ::\n+        The following tests that :meth:`_composition_` is called upon\n+        a product (see :trac:`12880`)::\n\n             sage: phi*phi\n             Traceback (most recent call last):\n             ...\n-            TypeError: Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 is not in Category of hom sets in Category of Schemes\n-\n-        Here would be the desired output::\n-\n-            sage: phi*phi            # not tested\n-            Traceback (most recent call last):\n-            ...\n             NotImplementedError\n         \"\"\"\n         raise NotImplementedError\n```\n\nAnother small request: would it be possible to keep the doctests of `domain()` and `codomain()` and move them to another place, instead of deleting them together with the methods?",
    "created_at": "2014-04-25T23:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151845",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'></a>Replying to [comment:10 sbesnier]:
> I've also make some modifications in order to make the composition working (essentially, remove the overload of `_composition_').

This looks good to me overall.  The main thing I am wondering about is if it wouldn't make sense to keep the current version of `_composition_` (raise a `NotImplementedError`) until we have real composition of isogenies.  What I mean is that with your change, we just get a "formal" composition of two isogenies.  Although this may be good enough for some applications, what we really want is to compute the actual polynomials defining the composed isogeny.  From that perspective I wouldn't say that removing the method "makes composition work".

The question is whether it is worth having a "formal" composition in the (hopefully short!) time interval until we have "flesh-and-blood" composition of isogenies.  In other words, wouldn't it be reasonable to just make the following doctest change instead of removing the `_composition_()` method?

```diff
diff --git a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py b/src/sage/schemes/elliptic_
curves/ell_curve_isogeny.py
index 101b81e..8b18590 100644
--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
@@ -3342,21 +3301,12 @@ class EllipticCurveIsogeny(Morphism):
             ...
             NotImplementedError

-        The following should test that :meth:`_composition_` is called
-        upon a product. However phi is currently improperly
-        constructed (see :trac:`12880`), which triggers an assertion
-        failure before the actual call ::
+        The following tests that :meth:`_composition_` is called upon
+        a product (see :trac:`12880`)::

             sage: phi*phi
             Traceback (most recent call last):
             ...
-            TypeError: Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 is not in Category of hom sets in Category of Schemes
-
-        Here would be the desired output::
-
-            sage: phi*phi            # not tested
-            Traceback (most recent call last):
-            ...
             NotImplementedError
         """
         raise NotImplementedError
```

Another small request: would it be possible to keep the doctests of `domain()` and `codomain()` and move them to another place, instead of deleting them together with the methods?



---

archive/issue_comments_151846.json:
```json
{
    "body": "<a id='comment:18'></a>Alternatively, instead of the `NotImplementedError`, we could temporarily \"implement\" `_composition_()` as\n\n```\nreturn super(EllipticCurveIsogeny, self)._composition_(self, right, homset)`\n```\nThis just calls the method of the superclass and hence is practically the same as deleting the method, but it makes it clearer where the \"real\" `_composition_()` will have to be implemented.",
    "created_at": "2014-04-25T23:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151846",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:18'></a>Alternatively, instead of the `NotImplementedError`, we could temporarily "implement" `_composition_()` as

```
return super(EllipticCurveIsogeny, self)._composition_(self, right, homset)`
```
This just calls the method of the superclass and hence is practically the same as deleting the method, but it makes it clearer where the "real" `_composition_()` will have to be implemented.



---

archive/issue_comments_151847.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-25T23:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151847",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_151848.json:
```json
{
    "body": "<a id='comment:19'></a>One last thing: whatever the fate of `_composition_()`, can we at least keep the doctests for that method too?",
    "created_at": "2014-04-25T23:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151848",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:19'></a>One last thing: whatever the fate of `_composition_()`, can we at least keep the doctests for that method too?



---

archive/issue_comments_151849.json:
```json
{
    "body": "<a id='comment:20'></a>By the way, there is a \"wishlist\" ticket at #7368 that also includes composition of isogenies.  I think we should open a separate ticket for composition, since we are obviously not going to do all of #7368 at the same time.",
    "created_at": "2014-04-25T23:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151849",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:20'></a>By the way, there is a "wishlist" ticket at #7368 that also includes composition of isogenies.  I think we should open a separate ticket for composition, since we are obviously not going to do all of #7368 at the same time.



---

archive/issue_comments_151850.json:
```json
{
    "body": "<a id='comment:21'></a>> This looks good to me overall.  The main thing I am wondering about is if it wouldn't make sense to keep the current version of `_composition_` (raise a `NotImplementedError`) until we have real composition of isogenies.  What I mean is that with your change, we just get a \"formal\" composition of two isogenies.  Although this may be good enough for some applications, what we really want is to compute the actual polynomials defining the composed isogeny.  From that perspective I wouldn't say that removing the method \"makes composition work\".\n\n\nI'd rather say the opposite. There are applications where formal composition is the desired result.\n\nFormal composition is essentially free, while \"flesh-and-blood\" composition may be expensive (exponential in the length of the chain). There are cryptosystems that exploit this fact, Sage should make it easy to implement them in a few lines of code.\n\nI'm more in favour of using formal composition by default, and having a method (`.normalize()`, maybe?) to compute the \"flesh-and-blood\" version. Subsidiary question\u202f: what should equality do in this case?\n\n> I think we should open a separate ticket for composition, since we are obviously not going to do all of #7368 at the same time. \n\n\nAgreed. It would be a better place to continue this discussion.",
    "created_at": "2014-04-26T00:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151850",
    "user": "https://github.com/defeo"
}
```

<a id='comment:21'></a>> This looks good to me overall.  The main thing I am wondering about is if it wouldn't make sense to keep the current version of `_composition_` (raise a `NotImplementedError`) until we have real composition of isogenies.  What I mean is that with your change, we just get a "formal" composition of two isogenies.  Although this may be good enough for some applications, what we really want is to compute the actual polynomials defining the composed isogeny.  From that perspective I wouldn't say that removing the method "makes composition work".


I'd rather say the opposite. There are applications where formal composition is the desired result.

Formal composition is essentially free, while "flesh-and-blood" composition may be expensive (exponential in the length of the chain). There are cryptosystems that exploit this fact, Sage should make it easy to implement them in a few lines of code.

I'm more in favour of using formal composition by default, and having a method (`.normalize()`, maybe?) to compute the "flesh-and-blood" version. Subsidiary question : what should equality do in this case?

> I think we should open a separate ticket for composition, since we are obviously not going to do all of #7368 at the same time. 


Agreed. It would be a better place to continue this discussion.



---

archive/issue_comments_151851.json:
```json
{
    "body": "<a id='comment:22'></a>I've corrected the things pointed by Peter (essentially, doctests).I've made a \"push\" but it doesnt seem to appear here...\n\nEdit: hum... I think I have to update the \"commit\" attribute of the ticket, but it always fails. The new commit is : 73d99af403e760801ae2576dfbb6f7629d629f30, it's visible from sage.git : http://git.sagemath.org/sage.git/commit/?id=73d99af403e760801ae2576dfbb6f7629d629f30\n\nWhat am I doing wrong?",
    "created_at": "2014-04-26T20:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151851",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:22'></a>I've corrected the things pointed by Peter (essentially, doctests).I've made a "push" but it doesnt seem to appear here...

Edit: hum... I think I have to update the "commit" attribute of the ticket, but it always fails. The new commit is : 73d99af403e760801ae2576dfbb6f7629d629f30, it's visible from sage.git : http://git.sagemath.org/sage.git/commit/?id=73d99af403e760801ae2576dfbb6f7629d629f30

What am I doing wrong?



---

archive/issue_comments_151852.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-26T20:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151852",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_151853.json:
```json
{
    "body": "<a id='comment:24'></a>New commits:",
    "created_at": "2014-04-26T21:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151853",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:24'></a>New commits:



---

archive/issue_comments_151854.json:
```json
{
    "body": "<a id='comment:25'></a>New commits:",
    "created_at": "2014-04-26T22:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151854",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:25'></a>New commits:



---

archive/issue_comments_151855.json:
```json
{
    "body": "<a id='comment:26'></a>> Edit: hum... I think I have to update the \"commit\" attribute of the ticket, but it always fails. The new commit is : 73d99af403e760801ae2576dfbb6f7629d629f30, it's visible from sage.git : http://git.sagemath.org/sage.git/commit/?id=73d99af403e760801ae2576dfbb6f7629d629f30\n\n\nThe 'commit' field is not meant to be edited manually. Changing it has no effect.\n\nThere are two similarly named branches on trac: `u/sbesnier/ticket/12880` and `u/sbesnier/ticket12880`. Maybe you wanted the second one (change the 'branch' field in this case).",
    "created_at": "2014-04-26T22:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151855",
    "user": "https://github.com/defeo"
}
```

<a id='comment:26'></a>> Edit: hum... I think I have to update the "commit" attribute of the ticket, but it always fails. The new commit is : 73d99af403e760801ae2576dfbb6f7629d629f30, it's visible from sage.git : http://git.sagemath.org/sage.git/commit/?id=73d99af403e760801ae2576dfbb6f7629d629f30


The 'commit' field is not meant to be edited manually. Changing it has no effect.

There are two similarly named branches on trac: `u/sbesnier/ticket/12880` and `u/sbesnier/ticket12880`. Maybe you wanted the second one (change the 'branch' field in this case).



---

archive/issue_comments_151856.json:
```json
{
    "body": "<a id='comment:27'></a>New commits:",
    "created_at": "2014-04-26T22:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151856",
    "user": "https://trac.sagemath.org/admin/accounts/users/sbesnier"
}
```

<a id='comment:27'></a>New commits:



---

archive/issue_comments_151857.json:
```json
{
    "body": "<a id='comment:28'></a>A few small stylistic comments about docstrings:\n- To refer to Trac tickets, use the syntax `:trac:`12880`` (in the HTML documentation, this is expanded to \"Trac ticket 12880\" and becomes a link).\n- Usually `TESTS:` or `TESTS::` is kept on a line by itself and, if relevant, there is a separate line of explanation referring to the specific issue, i.e. one of the following:\n\n```\nTESTS::\n\n    sage: 2 + 2\n    4\n\n----\n\nTESTS:\n\nCheck that `2 + 2 = 4` (see :trac:`12880`)::\n\n    sage: 2 + 2\n    4\n```\n- In English, unlike in French, there is no space before the punctuation marks : ; ? !",
    "created_at": "2014-04-28T11:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151857",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:28'></a>A few small stylistic comments about docstrings:
- To refer to Trac tickets, use the syntax `:trac:`12880`` (in the HTML documentation, this is expanded to "Trac ticket 12880" and becomes a link).
- Usually `TESTS:` or `TESTS::` is kept on a line by itself and, if relevant, there is a separate line of explanation referring to the specific issue, i.e. one of the following:

```
TESTS::

    sage: 2 + 2
    4

----

TESTS:

Check that `2 + 2 = 4` (see :trac:`12880`)::

    sage: 2 + 2
    4
```
- In English, unlike in French, there is no space before the punctuation marks : ; ? !



---

archive/issue_comments_151858.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-28T11:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_035148.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35148"
}
```



---

archive/issue_events_035149.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35149"
}
```



---

archive/issue_comments_151859.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-16T21:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151859",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_151860.json:
```json
{
    "body": "<a id='comment:31'></a>I'm happy with this and it passes all tests (when the dependencies are merged, of course).  The reviewer patch just fixes a trivial merge conflict and whitespace.",
    "created_at": "2014-07-16T21:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151860",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:31'></a>I'm happy with this and it passes all tests (when the dependencies are merged, of course).  The reviewer patch just fixes a trivial merge conflict and whitespace.



---

archive/issue_comments_151861.json:
```json
{
    "body": "Changing keywords from \"\" to \"isogeny\".",
    "created_at": "2014-07-16T21:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151861",
    "user": "https://github.com/pjbruin"
}
```

Changing keywords from "" to "isogeny".



---

archive/issue_comments_151862.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-17T13:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12880#issuecomment-151862",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_035150.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-17T13:57:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12880",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12880#event-35150"
}
```
