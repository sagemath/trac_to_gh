# Issue 12922: Implicit derivative

archive/issues_012750.json:
```json
{
    "assignees": [
        "https://github.com/burcin"
    ],
    "body": "Added implicit_derivative function. It allows to compute the n'th derivative of the implicit function defined by a symbolic expression.\n\nCC:  @kcrisman @sagetrac-sjg10 @burcin\n\nKeywords: **implicit derivative**\n\nBranch/Commit: **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**\n\nReviewer: **Kannappan Sampath, Ralf Stephan**\n\nAuthor: **Miguel Marco**\n\nComponent: **calculus**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12922_\n\n",
    "closed_at": "2015-02-17T19:28:19Z",
    "created_at": "2012-05-08T11:35:00Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20calculus",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implicit derivative",
    "type": "issue",
    "updated_at": "2015-02-17T19:28:19Z",
    "url": "https://github.com/sagemath/sage/issues/12922",
    "user": "https://github.com/miguelmarco"
}
```
Added implicit_derivative function. It allows to compute the n'th derivative of the implicit function defined by a symbolic expression.

CC:  @kcrisman @sagetrac-sjg10 @burcin

Keywords: **implicit derivative**

Branch/Commit: **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**

Reviewer: **Kannappan Sampath, Ralf Stephan**

Author: **Miguel Marco**

Component: **calculus**

_Issue created by migration from https://trac.sagemath.org/ticket/12922_





---

archive/issue_events_178703.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-08T11:35:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178703"
}
```



---

archive/issue_events_178704.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-08T11:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178704"
}
```



---

archive/issue_events_178705.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-08T11:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178705"
}
```



---

archive/issue_events_178706.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-08T11:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178706"
}
```



---

archive/issue_events_178707.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-05-08T11:35:00Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "subject": "https://github.com/miguelmarco",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178707"
}
```



---

archive/issue_comments_146325.json:
```json
{
    "body": "Attachment: **[16191.patch.gz](https://github.com/sagemath/sage/files/ticket12922/16191.patch.gz)**",
    "created_at": "2012-05-08T11:40:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146325",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[16191.patch.gz](https://github.com/sagemath/sage/files/ticket12922/16191.patch.gz)**



---

archive/issue_events_178708.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2012-05-08T11:41:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178708"
}
```



---

archive/issue_comments_146326.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReviewed, seems good. Added a check for having no y term in the expression. Was previously an uncaught `DivideByZero`, while code now gives a more informative error.\nWas my first review, would appreciate to know whether I'm actually being any help!",
    "created_at": "2012-07-11T11:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146326",
    "user": "https://github.com/sagetrac-sjg10"
}
```

<div id="comment:3" align="right">comment:3</div>

Reviewed, seems good. Added a check for having no y term in the expression. Was previously an uncaught `DivideByZero`, while code now gives a more informative error.
Was my first review, would appreciate to know whether I'm actually being any help!



---

archive/issue_comments_146327.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYes, both helpful!  A few comments.\n* The reviewer patch should be a separate patch on top of the original patch, so that the original author is kept.\n* In any case, the patch should have a meaningful commit message.\n* I'm a little apprehensive about the many specific variables and functions defined here.  Won't that cause some kind of conflict with (say) an already-defined `yy`?  We shouldn't depend on people not needing those variables.  Or is everything only in local scope because of the use of `SR.symbol`?\n\nI'm also wondering - is it possible to have an implicit derivative method for symbolic expressions?  Just curious.",
    "created_at": "2012-07-11T13:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146327",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

Yes, both helpful!  A few comments.
* The reviewer patch should be a separate patch on top of the original patch, so that the original author is kept.
* In any case, the patch should have a meaningful commit message.
* I'm a little apprehensive about the many specific variables and functions defined here.  Won't that cause some kind of conflict with (say) an already-defined `yy`?  We shouldn't depend on people not needing those variables.  Or is everything only in local scope because of the use of `SR.symbol`?

I'm also wondering - is it possible to have an implicit derivative method for symbolic expressions?  Just curious.



---

archive/issue_comments_146328.json:
```json
{
    "body": "adds error handler",
    "created_at": "2012-07-11T16:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146328",
    "user": "https://github.com/sagetrac-sjg10"
}
```

adds error handler



---

archive/issue_comments_146329.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[16191_review.patch.gz](https://github.com/sagemath/sage/files/ticket12922/16191_review.patch.gz)**\n\nAll the variables defined in the function are local. They do not get mixed with the global variables with the same name. You can even call the function with xx and yy as parameters, and they will  not be mixed with the local xx and yy.\n\n```\nsage: var('x,y')\n(x, y)\nsage: implicit_derivative(y,x,y*x/cos(x+y))\n-(x*y*sin(x + y)/cos(x + y)^2 + y/cos(x + y))/(x*y*sin(x + y)/cos(x + y)^2 + x/cos(x + y))\nsage: var('xx,yy')\n(xx, yy)\nsage: implicit_derivative(yy,xx,yy*xx/cos(xx+yy))\n-(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + yy/cos(xx + yy))/(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + xx/cos(xx + yy))\n```\n\nAbout writing this as a method for symbolic expressions... that was my first idea; but i prefeared this aproach, due to the fact that you are actually not  diferentiating the symbolic expression, but a function defined implicitely by the symbolic expression. So it seemed more natural to me this kind of syntax.",
    "created_at": "2012-07-12T09:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146329",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[16191_review.patch.gz](https://github.com/sagemath/sage/files/ticket12922/16191_review.patch.gz)**

All the variables defined in the function are local. They do not get mixed with the global variables with the same name. You can even call the function with xx and yy as parameters, and they will  not be mixed with the local xx and yy.

```
sage: var('x,y')
(x, y)
sage: implicit_derivative(y,x,y*x/cos(x+y))
-(x*y*sin(x + y)/cos(x + y)^2 + y/cos(x + y))/(x*y*sin(x + y)/cos(x + y)^2 + x/cos(x + y))
sage: var('xx,yy')
(xx, yy)
sage: implicit_derivative(yy,xx,yy*xx/cos(xx+yy))
-(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + yy/cos(xx + yy))/(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + xx/cos(xx + yy))
```

About writing this as a method for symbolic expressions... that was my first idea; but i prefeared this aproach, due to the fact that you are actually not  diferentiating the symbolic expression, but a function defined implicitely by the symbolic expression. So it seemed more natural to me this kind of syntax.



---

archive/issue_comments_146330.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nCalling `var` or `SR.symbol('somename')` even locally does add to the `pynac_symbol_registry`, yet calling `SR.symbol()` with no argument will create a temporary variable that will not be added to this registry. Possibly adding to the registry may cause problems if it is being referenced directly for some reason. Maybe worth just using `x = SR.symbol()` etc?\n\n\n```\nsage: from sage.symbolic.ring import pynac_symbol_registry\nsage: pynac_symbol_registry                               \n{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\nsage: def f(): temp = SR.symbol()                         \n....: \nsage: f()\nsage: pynac_symbol_registry\n{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\nsage: def f(): temp = SR.symbol('temp')\n....: \nsage: f()\nsage: pynac_symbol_registry\n{'temp': temp, 'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\n```",
    "created_at": "2012-07-13T10:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146330",
    "user": "https://github.com/sagetrac-sjg10"
}
```

<div id="comment:6" align="right">comment:6</div>

Calling `var` or `SR.symbol('somename')` even locally does add to the `pynac_symbol_registry`, yet calling `SR.symbol()` with no argument will create a temporary variable that will not be added to this registry. Possibly adding to the registry may cause problems if it is being referenced directly for some reason. Maybe worth just using `x = SR.symbol()` etc?


```
sage: from sage.symbolic.ring import pynac_symbol_registry
sage: pynac_symbol_registry                               
{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
sage: def f(): temp = SR.symbol()                         
....: 
sage: f()
sage: pynac_symbol_registry
{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
sage: def f(): temp = SR.symbol('temp')
....: 
sage: f()
sage: pynac_symbol_registry
{'temp': temp, 'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
```



---

archive/issue_comments_146331.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI have tried to use SR.symbol() instead of SR.symbol('x'), but then the result is a mess.\n\nI can't think of a way to make this work without the said side effect.",
    "created_at": "2012-07-13T10:52:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146331",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:7" align="right">comment:7</div>

I have tried to use SR.symbol() instead of SR.symbol('x'), but then the result is a mess.

I can't think of a way to make this work without the said side effect.



---

archive/issue_comments_146332.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI solved the pynac symbol registry pollution by saving a copy of it at the beginning of the function, and restoring it at the end. I am not sure if this is the best choice, but it is the only solution i found, and seems to work fine.",
    "created_at": "2013-06-07T17:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146332",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:8" align="right">comment:8</div>

I solved the pynac symbol registry pollution by saving a copy of it at the beginning of the function, and restoring it at the end. I am not sure if this is the best choice, but it is the only solution i found, and seems to work fine.



---

archive/issue_events_178709.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-06-07T20:53:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178709"
}
```



---

archive/issue_events_178710.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-06-07T20:53:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178710"
}
```



---

archive/issue_comments_146333.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nMessing with the symbol registry this way is really not a good idea. That is just supposed to be internal data.\n\nWhat if there is an exception in that code and the registry is not restored?\n\nWhat exactly is the problem with using temporary variables? Looking briefly at the patch, it looks like we also need temporary functions.",
    "created_at": "2013-06-07T20:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146333",
    "user": "https://github.com/burcin"
}
```

<div id="comment:9" align="right">comment:9</div>

Messing with the symbol registry this way is really not a good idea. That is just supposed to be internal data.

What if there is an exception in that code and the registry is not restored?

What exactly is the problem with using temporary variables? Looking briefly at the patch, it looks like we also need temporary functions.



---

archive/issue_comments_146334.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThe problem with using temporary variables without giving them a name string is this:\n\n```\n\nsage: from sage.symbolic.function_factory import SymbolicFunction\nsage: var('x,y')                                                                                                                                    \n(x, y)\nsage: def implicit_derivative(Y,X,F,n=1):                                                                                                           \n....:         x=SR.symbol()                                                                                                                         \n....:         yy=SR.symbol()                                                                                                                        \n....:         y=SymbolicFunction('y',1)(x)                                                                                                          \n....:         f=SymbolicFunction('f',2)(x,yy)                                                                                                       \n....:         Fx=f.diff(x)                                                                                                                          \n....:         Fy=f.diff(yy)                                                                                                                         \n....:         G=-(Fx/Fy)                                                                                                                            \n....:         G=G.subs_expr({yy:y})                                                                                                                 \n....:         di={y.diff(x):-F.diff(X)/F.diff(Y)}                                                                                                   \n....:         R=G                                                                                                                                   \n....:         S=G.diff(x,n-1)                                                                                                                       \n....:         for i in range(n+1):                                                                                                                  \n....:                 di[y.diff(x,i+1)(x=x)]=R                                                                                                      \n....:                 S=S.subs_expr(di)                                                                                                             \n....:                 R=G.diff(x,i)                                                                                                                 \n....:                 for j in range(n+1-i):                                                                                                        \n....:                         di[f.diff(x,i,yy,j)(x=x,yy=y)]=F.diff(X,i,Y,j)                                                                        \n....:                         S=S.subs_expr(di)                                                                                                     \n....:                 return S                                                                                                                      \n....:                                                                                                                                               \nsage: implicit_derivative(y,x,x^2+y^2-1)                                                                                                            \n-D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))\n```\n\nI don't know why, this problem is not present if we put the strings in the definitions of the variables.",
    "created_at": "2013-06-07T21:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146334",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:10" align="right">comment:10</div>

The problem with using temporary variables without giving them a name string is this:

```

sage: from sage.symbolic.function_factory import SymbolicFunction
sage: var('x,y')                                                                                                                                    
(x, y)
sage: def implicit_derivative(Y,X,F,n=1):                                                                                                           
....:         x=SR.symbol()                                                                                                                         
....:         yy=SR.symbol()                                                                                                                        
....:         y=SymbolicFunction('y',1)(x)                                                                                                          
....:         f=SymbolicFunction('f',2)(x,yy)                                                                                                       
....:         Fx=f.diff(x)                                                                                                                          
....:         Fy=f.diff(yy)                                                                                                                         
....:         G=-(Fx/Fy)                                                                                                                            
....:         G=G.subs_expr({yy:y})                                                                                                                 
....:         di={y.diff(x):-F.diff(X)/F.diff(Y)}                                                                                                   
....:         R=G                                                                                                                                   
....:         S=G.diff(x,n-1)                                                                                                                       
....:         for i in range(n+1):                                                                                                                  
....:                 di[y.diff(x,i+1)(x=x)]=R                                                                                                      
....:                 S=S.subs_expr(di)                                                                                                             
....:                 R=G.diff(x,i)                                                                                                                 
....:                 for j in range(n+1-i):                                                                                                        
....:                         di[f.diff(x,i,yy,j)(x=x,yy=y)]=F.diff(X,i,Y,j)                                                                        
....:                         S=S.subs_expr(di)                                                                                                     
....:                 return S                                                                                                                      
....:                                                                                                                                               
sage: implicit_derivative(y,x,x^2+y^2-1)                                                                                                            
-D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))
```

I don't know why, this problem is not present if we put the strings in the definitions of the variables.



---

archive/issue_comments_146335.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@miguelmarco](#comment:10):\n> \n> ```             \n> sage: implicit_derivative(y,x,x^2+y^2-1)                                                                                  \n> -D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))\n> ```\n\nIt looks like the substitution doesn't work at some point.\n\nLooking at the code...\n\nThe calls `y.diff(x,i+1)(x=x)` and `f.diff(x,i,yy,j)(x=x,yy=y)` rely on the name of the variable. You should use a dictionary argument to `.subs()`.\n\nBTW, the `subs_expr()` method will go away at some point. Why not just use `.subs()` everywhere?",
    "created_at": "2013-06-08T09:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146335",
    "user": "https://github.com/burcin"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@miguelmarco](#comment:10):
> 
> ```             
> sage: implicit_derivative(y,x,x^2+y^2-1)                                                                                  
> -D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))
> ```

It looks like the substitution doesn't work at some point.

Looking at the code...

The calls `y.diff(x,i+1)(x=x)` and `f.diff(x,i,yy,j)(x=x,yy=y)` rely on the name of the variable. You should use a dictionary argument to `.subs()`.

BTW, the `subs_expr()` method will go away at some point. Why not just use `.subs()` everywhere?



---

archive/issue_comments_146336.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nBefore this gets switched to positive review, we should check how it behaves if there already is a symbolic function defined with a custom method for evaluation named `y` or `f`.\n\nWhy is this not a method of symbolic expressions? Isn't it inconsistent to have the functional notation supported but not a class method?",
    "created_at": "2013-06-08T09:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146336",
    "user": "https://github.com/burcin"
}
```

<div id="comment:12" align="right">comment:12</div>

Before this gets switched to positive review, we should check how it behaves if there already is a symbolic function defined with a custom method for evaluation named `y` or `f`.

Why is this not a method of symbolic expressions? Isn't it inconsistent to have the functional notation supported but not a class method?



---

archive/issue_comments_146337.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThanks for the comments. I will try to work on it.\n\nAs i said, the reason why it is not a method is that it is not clear to me what class should it be in. \n\nIs this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.\n\nOf X? This is just the variable with which we differentiate on.\n\nOf Y? Riguorilously that should be the function that we are differentiating. But doesn't sound natural at all to add a method like this for symbollic variables.\n\nOr maybe we could define a new class ImplicitelyDefinedSymbolicFunction for this case, bat that sounds way overkill.",
    "created_at": "2013-06-08T10:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146337",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:13" align="right">comment:13</div>

Thanks for the comments. I will try to work on it.

As i said, the reason why it is not a method is that it is not clear to me what class should it be in. 

Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.

Of X? This is just the variable with which we differentiate on.

Of Y? Riguorilously that should be the function that we are differentiating. But doesn't sound natural at all to add a method like this for symbollic variables.

Or maybe we could define a new class ImplicitelyDefinedSymbolicFunction for this case, bat that sounds way overkill.



---

archive/issue_comments_146338.json:
```json
{
    "body": "Attachment: **[12922.patch.gz](https://github.com/sagemath/sage/files/ticket12922/12922.patch.gz)**\n\nNewer version, solves the pynac registry pollution without manipulating it",
    "created_at": "2013-06-08T16:03:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146338",
    "user": "https://github.com/miguelmarco"
}
```

Attachment: **[12922.patch.gz](https://github.com/sagemath/sage/files/ticket12922/12922.patch.gz)**

Newer version, solves the pynac registry pollution without manipulating it



---

archive/issue_comments_146339.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOk, your suggestions seemed to work fine. I have uploaded a newer version. Please check it.",
    "created_at": "2013-06-08T16:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146339",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:14" align="right">comment:14</div>

Ok, your suggestions seemed to work fine. I have uploaded a newer version. Please check it.



---

archive/issue_events_178711.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2013-06-10T11:23:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178711"
}
```



---

archive/issue_events_178712.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2013-06-10T11:23:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178712"
}
```



---

archive/issue_events_178713.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178713"
}
```



---

archive/issue_events_178714.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178714"
}
```



---

archive/issue_events_178715.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178715"
}
```



---

archive/issue_events_178716.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178716"
}
```



---

archive/issue_events_178717.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178717"
}
```



---

archive/issue_events_178718.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178718"
}
```



---

archive/issue_events_178719.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178719"
}
```



---

archive/issue_events_178720.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178720"
}
```



---

archive/issue_comments_146340.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nbump",
    "created_at": "2014-08-22T14:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146340",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:20" align="right">comment:20</div>

bump



---

archive/issue_comments_146341.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHi mmarco: \n\nThanks for writing up a patch regarding something very fundamental to calculus. Sage has since v6.0 moved to Git for its revision control. As a consequence, we work with \"branches\" instead of \"patches\" and so on. Could you kindly make the patch here into a branch? \n\nI think this might be a bit painful depending on several factors. So, please feel free to ask for any help!",
    "created_at": "2014-08-23T12:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146341",
    "user": "https://github.com/KPanComputes"
}
```

<div id="comment:21" align="right">comment:21</div>

Hi mmarco: 

Thanks for writing up a patch regarding something very fundamental to calculus. Sage has since v6.0 moved to Git for its revision control. As a consequence, we work with "branches" instead of "patches" and so on. Could you kindly make the patch here into a branch? 

I think this might be a bit painful depending on several factors. So, please feel free to ask for any help!



---

archive/issue_events_178721.json:
```json
{
    "actor": "https://github.com/KPanComputes",
    "created_at": "2014-08-23T12:10:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178721"
}
```



---

archive/issue_events_178722.json:
```json
{
    "actor": "https://github.com/KPanComputes",
    "created_at": "2014-08-23T12:10:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178722"
}
```



---

archive/issue_comments_146342.json:
```json
{
    "body": "Branch: **[u/mmarco/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/12922)**",
    "created_at": "2014-08-23T14:39:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146342",
    "user": "https://github.com/miguelmarco"
}
```

Branch: **[u/mmarco/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/12922)**



---

archive/issue_comments_146343.json:
```json
{
    "body": "Commit: **[`39aaf0c`](https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247)**",
    "created_at": "2014-08-24T15:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146343",
    "user": "https://github.com/KPanComputes"
}
```

Commit: **[`39aaf0c`](https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247)**



---

archive/issue_comments_146344.json:
```json
{
    "body": "Reviewer: **Kannappan Sampath**",
    "created_at": "2014-08-24T15:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146344",
    "user": "https://github.com/KPanComputes"
}
```

Reviewer: **Kannappan Sampath**



---

archive/issue_events_178723.json:
```json
{
    "actor": "https://github.com/KPanComputes",
    "created_at": "2014-08-24T15:54:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178723"
}
```



---

archive/issue_events_178724.json:
```json
{
    "actor": "https://github.com/KPanComputes",
    "created_at": "2014-08-24T15:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178724"
}
```



---

archive/issue_comments_146345.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247\"><code>39aaf0c</code></a></td><td><code>Added implicit_derivative</code></td></tr></table>\n",
    "created_at": "2014-08-24T15:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146345",
    "user": "https://github.com/KPanComputes"
}
```

<div id="comment:24"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247"><code>39aaf0c</code></a></td><td><code>Added implicit_derivative</code></td></tr></table>




---

archive/issue_comments_146346.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nFor starters, I have the following comments: \n\n1. The one-line docstring for the function is \"incorrect\": it computes something, yes, but it also returns it. So, please change that to \"Return <whatever>\". \n2. The value error could return the expression `F` explicitly instead of saying the generic F. While you are it, please use the `.format` to format the string for the output instead.\n\nHonestly, I have not looked at the math. I will get back about the math and the programming part in a bit.",
    "created_at": "2014-08-24T16:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146346",
    "user": "https://github.com/KPanComputes"
}
```

<div id="comment:25" align="right">comment:25</div>

For starters, I have the following comments: 

1. The one-line docstring for the function is "incorrect": it computes something, yes, but it also returns it. So, please change that to "Return <whatever>". 
2. The value error could return the expression `F` explicitly instead of saying the generic F. While you are it, please use the `.format` to format the string for the output instead.

Honestly, I have not looked at the math. I will get back about the math and the programming part in a bit.



---

archive/issue_comments_146347.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd\"><code>3f3f949</code></a></td><td><code>Reviewer's suggestions changed, plus some changes for PEP8 compliance.</code></td></tr></table>\n",
    "created_at": "2014-08-24T16:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146347",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd"><code>3f3f949</code></a></td><td><code>Reviewer's suggestions changed, plus some changes for PEP8 compliance.</code></td></tr></table>




---

archive/issue_comments_146348.json:
```json
{
    "body": "Changed commit from **[`39aaf0c`](https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247)** to **[`3f3f949`](https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd)**",
    "created_at": "2014-08-24T16:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146348",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`39aaf0c`](https://github.com/sagemath/sagetrac-mirror/commit/39aaf0c4b33a7a5ec0066e64e25cf5e54d197247)** to **[`3f3f949`](https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd)**



---

archive/issue_comments_146349.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@miguelmarco](#comment:13):\n> As i said, the reason why it is not a method is that it is not clear to me what class should it be in. \n> \n> Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.\n\nI think Burcin wants this method part of the symbolic expression or function class. If it's not tied to a specific expression then make it a `@classmethod` (equivalent to a static method in C), and then create the globally accessible name for it.",
    "created_at": "2014-09-01T09:17:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146349",
    "user": "https://github.com/rwst"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@miguelmarco](#comment:13):
> As i said, the reason why it is not a method is that it is not clear to me what class should it be in. 
> 
> Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.

I think Burcin wants this method part of the symbolic expression or function class. If it's not tied to a specific expression then make it a `@classmethod` (equivalent to a static method in C), and then create the globally accessible name for it.



---

archive/issue_comments_146350.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c\"><code>5fe0ffe</code></a></td><td><code>Moved to a method in the expression class</code></td></tr></table>\n",
    "created_at": "2014-09-02T17:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146350",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c"><code>5fe0ffe</code></a></td><td><code>Moved to a method in the expression class</code></td></tr></table>




---

archive/issue_comments_146351.json:
```json
{
    "body": "Changed commit from **[`3f3f949`](https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd)** to **[`5fe0ffe`](https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c)**",
    "created_at": "2014-09-02T17:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146351",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3f3f949`](https://github.com/sagemath/sagetrac-mirror/commit/3f3f949cff46cc4e2f5b93bcf41de4c3f81f13cd)** to **[`5fe0ffe`](https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c)**



---

archive/issue_comments_146352.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nMoved it to a method in the expression class.",
    "created_at": "2014-09-02T17:32:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146352",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:29" align="right">comment:29</div>

Moved it to a method in the expression class.



---

archive/issue_comments_146353.json:
```json
{
    "body": "Changed branch from **[u/mmarco/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/12922)** to **[u/rws/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/12922)**",
    "created_at": "2015-02-02T14:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146353",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/mmarco/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/12922)** to **[u/rws/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/12922)**



---

archive/issue_events_178725.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T14:23:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178725"
}
```



---

archive/issue_events_178726.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T14:23:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178726"
}
```



---

archive/issue_comments_146354.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nJust some minor fixes. It looks good. I did no `make ptestlong` as it's just a new method.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e0061057ae3516d292cb24f91338a5ab53d8f02\"><code>7e00610</code></a></td><td><code>Merge branch 'develop' into t/12922/ticket/12922</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834\"><code>9549976</code></a></td><td><code>12922 reviewer's patch: optimize imports and doc cosmetics</code></td></tr></table>\n",
    "created_at": "2015-02-02T14:23:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146354",
    "user": "https://github.com/rwst"
}
```

<div id="comment:31" align="right">comment:31</div>

Just some minor fixes. It looks good. I did no `make ptestlong` as it's just a new method.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e0061057ae3516d292cb24f91338a5ab53d8f02"><code>7e00610</code></a></td><td><code>Merge branch 'develop' into t/12922/ticket/12922</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834"><code>9549976</code></a></td><td><code>12922 reviewer's patch: optimize imports and doc cosmetics</code></td></tr></table>




---

archive/issue_events_178727.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T14:23:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178727"
}
```



---

archive/issue_events_178728.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-02T14:23:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178728"
}
```



---

archive/issue_comments_146355.json:
```json
{
    "body": "Changed reviewer from **Kannappan Sampath** to **Kannappan Sampath, Ralf Stephan**",
    "created_at": "2015-02-02T14:23:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146355",
    "user": "https://github.com/rwst"
}
```

Changed reviewer from **Kannappan Sampath** to **Kannappan Sampath, Ralf Stephan**



---

archive/issue_comments_146356.json:
```json
{
    "body": "Changed commit from **[`5fe0ffe`](https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c)** to **[`9549976`](https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834)**",
    "created_at": "2015-02-02T14:23:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146356",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[`5fe0ffe`](https://github.com/sagemath/sagetrac-mirror/commit/5fe0ffeca2be3ec698b7eccfeb51ce80fa94a62c)** to **[`9549976`](https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834)**



---

archive/issue_comments_146357.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThanks for the review.",
    "created_at": "2015-02-02T14:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146357",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:32" align="right">comment:32</div>

Thanks for the review.



---

archive/issue_comments_146358.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\n\n```\n**********************************************************************\nFile \"src/sage/misc/sageinspect.py\", line 1815, in sage.misc.sageinspect.sage_getsourcelines\nFailed example:\n    sage_getsourcelines(x)[0][-1]    # last line\nExpected:\n    '        return self / x\\n'\nGot:\n    '        return S\\n'\n**********************************************************************\n```",
    "created_at": "2015-02-07T15:17:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146358",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:33" align="right">comment:33</div>


```
**********************************************************************
File "src/sage/misc/sageinspect.py", line 1815, in sage.misc.sageinspect.sage_getsourcelines
Failed example:
    sage_getsourcelines(x)[0][-1]    # last line
Expected:
    '        return self / x\n'
Got:
    '        return S\n'
**********************************************************************
```



---

archive/issue_events_178729.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-02-07T15:17:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178729"
}
```



---

archive/issue_events_178730.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-02-07T15:17:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178730"
}
```



---

archive/issue_comments_146359.json:
```json
{
    "body": "Changed commit from **[`9549976`](https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834)** to **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**",
    "created_at": "2015-02-08T07:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146359",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9549976`](https://github.com/sagemath/sagetrac-mirror/commit/954997662dc64a089c3ce6c90d423a78f3117834)** to **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**



---

archive/issue_comments_146360.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940\"><code>0a76da7</code></a></td><td><code>12922: fix doctest</code></td></tr></table>\n",
    "created_at": "2015-02-08T07:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146360",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940"><code>0a76da7</code></a></td><td><code>12922: fix doctest</code></td></tr></table>




---

archive/issue_comments_146361.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nInteresting. That doctest depends on the last line in `class Expression` to remain unchanged.",
    "created_at": "2015-02-08T07:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146361",
    "user": "https://github.com/rwst"
}
```

<div id="comment:35" align="right">comment:35</div>

Interesting. That doctest depends on the last line in `class Expression` to remain unchanged.



---

archive/issue_events_178731.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-08T07:17:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178731"
}
```



---

archive/issue_events_178732.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-08T07:17:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178732"
}
```



---

archive/issue_events_178733.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-17T19:28:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178733"
}
```



---

archive/issue_events_178734.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ac06b0d98919d03c146e305fe2781078ee97d33d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-02-17T19:28:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12922#event-178734"
}
```



---

archive/issue_comments_146362.json:
```json
{
    "body": "Changed branch from **[u/rws/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/12922)** to **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**",
    "created_at": "2015-02-17T19:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12922#issuecomment-146362",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/rws/ticket/12922](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/12922)** to **[`0a76da7`](https://github.com/sagemath/sagetrac-mirror/commit/0a76da78806d27c25e8a5864c26b3106611ab940)**
