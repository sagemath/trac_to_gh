# Issue 12170: Genus computation (using singular) and _singular_ object for function field

archive/issues_011998.json:
```json
{
    "assignees": [
        "https://github.com/aghitza"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nFollowing my the discussion on sage-devel this adds genus() function to the `FunctionField` class, to compute the genus of the function field using singular.\n\nIt is not as fast as magma but it is at least a first step.\n\nApply [attachment: trac_12170-gen_comp_singular_obj.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)\n\nDepends on #9054\n\nCC:  @koffie @mminzlaff @saraedum\n\nComponent: **algebraic geometry**\n\nKeywords: **function field, genus, singular**\n\nAuthor: **Syed Ahmad Lavasani**\n\nReviewer: **Dmitrii Pasechnik**\n\nMerged: **sage-5.13.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12170_\n\n",
    "closed_at": "2013-10-19T09:20:27Z",
    "created_at": "2011-12-17T02:22:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Genus computation (using singular) and _singular_ object for function field",
    "type": "issue",
    "updated_at": "2013-10-19T09:20:27Z",
    "url": "https://github.com/sagemath/sage/issues/12170",
    "user": "https://github.com/sagetrac-sydahmad"
}
```
<div id="comment:0"></div>

Following my the discussion on sage-devel this adds genus() function to the `FunctionField` class, to compute the genus of the function field using singular.

It is not as fast as magma but it is at least a first step.

Apply [attachment: trac_12170-gen_comp_singular_obj.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)

Depends on #9054

CC:  @koffie @mminzlaff @saraedum

Component: **algebraic geometry**

Keywords: **function field, genus, singular**

Author: **Syed Ahmad Lavasani**

Reviewer: **Dmitrii Pasechnik**

Merged: **sage-5.13.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/12170_





---

archive/issue_events_163566.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T02:22:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163566"
}
```



---

archive/issue_events_163567.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T02:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163567"
}
```



---

archive/issue_events_163568.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T02:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163568"
}
```



---

archive/issue_events_163569.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T02:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163569"
}
```



---

archive/issue_events_163570.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2011-12-17T02:22:47Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "subject": "https://github.com/sagetrac-sydahmad",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163570"
}
```



---

archive/issue_events_163571.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T03:23:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163571"
}
```



---

archive/issue_comments_130437.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nif we have:\n\nkx.<x> = FunctionField(QQ)\nkxY.<Y> = PolynomialRing(QQ)\n\nkxY._singular_ should be k(x)[Y] (which is what this code generates) however, singular only computes the genus of an ideal of k[x][Y] ring. So, I have to generate a tmpR = k[x][Y] each time I need to compute the genus. Maybe it's worth it to add __singular_deg2_ private object to store this ring as well. \n\nAlso, it makes sense to store the genus in __genus. But I'm not sure how should I check it's validity. Can the defining polynomial of the function field change after its creation. If not then we can set __genus = -1 and if it's non-negative then it's valid.",
    "created_at": "2011-12-17T03:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130437",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:1" align="right">comment:1</div>

if we have:

kx.<x> = FunctionField(QQ)
kxY.<Y> = PolynomialRing(QQ)

kxY._singular_ should be k(x)[Y] (which is what this code generates) however, singular only computes the genus of an ideal of k[x][Y] ring. So, I have to generate a tmpR = k[x][Y] each time I need to compute the genus. Maybe it's worth it to add __singular_deg2_ private object to store this ring as well. 

Also, it makes sense to store the genus in __genus. But I'm not sure how should I check it's validity. Can the defining polynomial of the function field change after its creation. If not then we can set __genus = -1 and if it's non-negative then it's valid.



---

archive/issue_events_163572.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T03:24:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163572"
}
```



---

archive/issue_events_163573.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T03:24:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163573"
}
```



---

archive/issue_events_163574.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T03:24:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163574"
}
```



---

archive/issue_events_163575.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-17T03:24:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163575"
}
```



---

archive/issue_comments_130438.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@sagetrac-sydahmad](#comment%3A1):\n> if we have:\n> \n> kx.<x> = FunctionField(QQ)\n> kxY.<Y> = PolynomialRing(QQ)\n> \n> kxY._singular_ should be k(x)[Y] (which is what this code generates) however, singular only computes the genus of an ideal of k[x][Y] ring. So, I have to generate a tmpR = k[x][Y] each time I need to compute the genus. Maybe it's worth it to add __singular_deg2_ private object to store this ring as well. \n>\n>\n\nWell if we are going to cache the genus computation then this won't be needed.\n\nReplying to [@sagetrac-sydahmad](#comment%3A1):\n> Also, it makes sense to store the genus in __genus. But I'm not sure how should I check it's validity. Can the defining polynomial of the function field change after its creation. If not then we can set __genus = -1 and if it's non-negative then it's valid.\n\nYou should look at the documentation of cached_method on how to do this. It would be indeed some function ideal for caching since it's answer takes a while to compute while it takes only a small integer to store it. \n\nNote that you can change the defining polynomial (because you have to go trough a lot of trouble to make python objects immutable). But you are safe to assume that the defining polynomial doesn't change. In fact the current code already assumes that as shown below.\n\n```\nsage: K.<x>=FunctionField(QQ)\nsage: R.<y>=K[]\nsage: L=K.extension(y^3+y*x+x)\nsage: L\nFunction field in y defined by y^3 + x*y + x\nsage: L.__init__(y^3+x,'y')\nsage: L\nFunction field in y defined by y^3 + x\nsage: K.extension(y^3+y*x+x)\nFunction field in y defined by y^3 + x\n```",
    "created_at": "2011-12-17T09:49:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130438",
    "user": "https://github.com/koffie"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@sagetrac-sydahmad](#comment%3A1):
> if we have:
> 
> kx.<x> = FunctionField(QQ)
> kxY.<Y> = PolynomialRing(QQ)
> 
> kxY._singular_ should be k(x)[Y] (which is what this code generates) however, singular only computes the genus of an ideal of k[x][Y] ring. So, I have to generate a tmpR = k[x][Y] each time I need to compute the genus. Maybe it's worth it to add __singular_deg2_ private object to store this ring as well. 
>
>

Well if we are going to cache the genus computation then this won't be needed.

Replying to [@sagetrac-sydahmad](#comment%3A1):
> Also, it makes sense to store the genus in __genus. But I'm not sure how should I check it's validity. Can the defining polynomial of the function field change after its creation. If not then we can set __genus = -1 and if it's non-negative then it's valid.

You should look at the documentation of cached_method on how to do this. It would be indeed some function ideal for caching since it's answer takes a while to compute while it takes only a small integer to store it. 

Note that you can change the defining polynomial (because you have to go trough a lot of trouble to make python objects immutable). But you are safe to assume that the defining polynomial doesn't change. In fact the current code already assumes that as shown below.

```
sage: K.<x>=FunctionField(QQ)
sage: R.<y>=K[]
sage: L=K.extension(y^3+y*x+x)
sage: L
Function field in y defined by y^3 + x*y + x
sage: L.__init__(y^3+x,'y')
sage: L
Function field in y defined by y^3 + x
sage: K.extension(y^3+y*x+x)
Function field in y defined by y^3 + x
```



---

archive/issue_comments_130439.json:
```json
{
    "body": "Changed dependencies from **9054** to **#9054**",
    "created_at": "2011-12-17T19:46:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130439",
    "user": "https://github.com/saraedum"
}
```

Changed dependencies from **9054** to **#9054**



---

archive/issue_comments_130440.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'm surprised myself but singular does not complain about fractions:\n\n```\nsage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)')\n-x^3-2*x*y+y^5\nsage: singular.eval('1/x')\n0\n```\n\nThe 1/x was just thrown out because in singular it evaluates to 0. Anyway I think you're maybe doing too many direct calls to singular. Why not go to the polynomial ring QQ[x,y] create the ideal there get its singular object and determine the genus in singular? Or maybe I misunderstand what the genus function in singular does.\n\nAlso, is_RationalFunctionField() should imho be a member method is_rational() of FunctionField that is overwritten in RationalFunctionField and FunctionField_polymod.",
    "created_at": "2011-12-17T20:56:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130440",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:7" align="right">comment:7</div>

I'm surprised myself but singular does not complain about fractions:

```
sage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)')
-x^3-2*x*y+y^5
sage: singular.eval('1/x')
0
```

The 1/x was just thrown out because in singular it evaluates to 0. Anyway I think you're maybe doing too many direct calls to singular. Why not go to the polynomial ring QQ[x,y] create the ideal there get its singular object and determine the genus in singular? Or maybe I misunderstand what the genus function in singular does.

Also, is_RationalFunctionField() should imho be a member method is_rational() of FunctionField that is overwritten in RationalFunctionField and FunctionField_polymod.



---

archive/issue_events_163576.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-12-17T20:56:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163576"
}
```



---

archive/issue_events_163577.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-12-17T20:56:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163577"
}
```



---

archive/issue_comments_130441.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThinking about this, is_RationalFunctionField()/is_rational() is probably not the right name. Take QQ(x) and the extension given by y^2=x then that gives you a rational function field but probably that's not what you want there. In this case what you actually want is probably one implementation in RationalFunctionField (returning 0) and one in FunctionField_polymod (calling singular).",
    "created_at": "2011-12-17T22:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130441",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:8" align="right">comment:8</div>

Thinking about this, is_RationalFunctionField()/is_rational() is probably not the right name. Take QQ(x) and the extension given by y^2=x then that gives you a rational function field but probably that's not what you want there. In this case what you actually want is probably one implementation in RationalFunctionField (returning 0) and one in FunctionField_polymod (calling singular).



---

archive/issue_comments_130442.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nJust a quick observation.  The docstring for is_RationalFunctionField claims that it checks if the input is \"of rational function field *type*\".  However, that is not what it does.  It checks if it is either of rational function field type, or if it isn't, it also checks if the input is in the category of Function Fields and is equal to its base.  I think the docstring should be changed.  Also, be sure to include an example that illustrates something that is not of RationalFunctionField type but is in the category FunctionFields().\n\n```\n        960\tdef is_RationalFunctionField(x): \n \t961\t    \"\"\" \n \t962\t    Return True if ``x`` is of rational function field type. \n...\n \t971\t    \"\"\" \n \t972\t    if isinstance(x, RationalFunctionField): return True \n \t973\t    if (x in FunctionFields()): \n \t974\t        return x == x.base_field() \n \t975\t    else: \n```",
    "created_at": "2011-12-20T03:39:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130442",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:9" align="right">comment:9</div>

Just a quick observation.  The docstring for is_RationalFunctionField claims that it checks if the input is "of rational function field *type*".  However, that is not what it does.  It checks if it is either of rational function field type, or if it isn't, it also checks if the input is in the category of Function Fields and is equal to its base.  I think the docstring should be changed.  Also, be sure to include an example that illustrates something that is not of RationalFunctionField type but is in the category FunctionFields().

```
        960	def is_RationalFunctionField(x): 
 	961	    """ 
 	962	    Return True if ``x`` is of rational function field type. 
...
 	971	    """ 
 	972	    if isinstance(x, RationalFunctionField): return True 
 	973	    if (x in FunctionFields()): 
 	974	        return x == x.base_field() 
 	975	    else: 
```



---

archive/issue_comments_130443.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@saraedum](#comment%3A7):\n\n> I'm surprised myself but singular does not complain about fractions: ` sage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)') -x<sup>3-2*x*y+y</sup>5 sage: singular.eval('1/x') 0 ` The 1/x was just thrown out because in singular it evaluates to 0.\n\nSo, basically, I need to clear the denominator before handing the job to Singular, correct? If yes is there a method to do so, or I just compute the GCD of the denom of all coeffs?\n\nThanx.",
    "created_at": "2011-12-20T07:41:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130443",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@saraedum](#comment%3A7):

> I'm surprised myself but singular does not complain about fractions: ` sage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)') -x<sup>3-2*x*y+y</sup>5 sage: singular.eval('1/x') 0 ` The 1/x was just thrown out because in singular it evaluates to 0.

So, basically, I need to clear the denominator before handing the job to Singular, correct? If yes is there a method to do so, or I just compute the GCD of the denom of all coeffs?

Thanx.



---

archive/issue_comments_130444.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@saraedum](#comment%3A8):\n\n> Thinking about this, is_RationalFunctionField()/is_rational() is probably not the right name. Take QQ(x) and the extension given by y^2 = x then that gives you a rational function field but probably that's not what you want there. In this case what you actually want is probably one implementation in RationalFunctionField (returning 0) and one in FunctionField_polymod (calling singular).^\n\nThis is why the function is called \"is_RationalFunctionField()\". This is because it does not check if (mathematically) the function field is rational, but it checks, if it is (programatically) of RationalFunctionField type. I need that because (AFAIUnderstood the manual) when I ask Singular to create a ring of k(t)[y] form, singular expects that k be a prime field (you only get to give the characteristic). so I can not accept k(x)[y]/(y^2 - x) for my purpose:\n\n```\nsage: singular.eval('ring r = (7^2,a,b),(x,y,z),dp;')\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/syd/Programmes/sage-4.7.2/devel/sage-sydevel/<ipython console> in <module>()\n\n/home/syd/Programmes/sage-4.7.2/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kw\\\nds)\n    572\n    573         if s.find(\"error\") != -1 or s.find(\"Segment fault\") != -1:\n--> 574             raise RuntimeError, 'Singular error:\\n%s'%s\n    575\n    576         if get_verbose() > 0:\n\nRuntimeError: Singular error:\n   ? too many parameters\n   ? cannot make ring\n   ? error occurred in or before STDIN line 41: `ring r = (7^2,a,b),(x,y,z),dp;`\n   ? expected ring-expression. type 'help ring;'\n\n```\n\n\nSo, I'm OK with making it a method of FunctionField class but I think we should keep the name. We can have an additional method of \"is_rational()\" if you like (which will involve computing the genus).",
    "created_at": "2011-12-20T08:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130444",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@saraedum](#comment%3A8):

> Thinking about this, is_RationalFunctionField()/is_rational() is probably not the right name. Take QQ(x) and the extension given by y^2 = x then that gives you a rational function field but probably that's not what you want there. In this case what you actually want is probably one implementation in RationalFunctionField (returning 0) and one in FunctionField_polymod (calling singular).^

This is why the function is called "is_RationalFunctionField()". This is because it does not check if (mathematically) the function field is rational, but it checks, if it is (programatically) of RationalFunctionField type. I need that because (AFAIUnderstood the manual) when I ask Singular to create a ring of k(t)[y] form, singular expects that k be a prime field (you only get to give the characteristic). so I can not accept k(x)[y]/(y^2 - x) for my purpose:

```
sage: singular.eval('ring r = (7^2,a,b),(x,y,z),dp;')
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/syd/Programmes/sage-4.7.2/devel/sage-sydevel/<ipython console> in <module>()

/home/syd/Programmes/sage-4.7.2/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kw\
ds)
    572
    573         if s.find("error") != -1 or s.find("Segment fault") != -1:
--> 574             raise RuntimeError, 'Singular error:\n%s'%s
    575
    576         if get_verbose() > 0:

RuntimeError: Singular error:
   ? too many parameters
   ? cannot make ring
   ? error occurred in or before STDIN line 41: `ring r = (7^2,a,b),(x,y,z),dp;`
   ? expected ring-expression. type 'help ring;'

```


So, I'm OK with making it a method of FunctionField class but I think we should keep the name. We can have an additional method of "is_rational()" if you like (which will involve computing the genus).



---

archive/issue_comments_130445.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@williamstein](#comment%3A9):\n> Just a quick observation.  The docstring for is_RationalFunctionField claims that it checks if the input is \"of rational function field *type*\".  However, that is not what it does.\n\nWhat I needed was the type check, but because I wanted to follow is_FunctionField line by line and that there's no category of RationalFunctionFields I thought that this is the closest approximation.\n\n```\n  \t973\t    if (x in FunctionFields()): \n  \t974\t        return x == x.base_field() \n  \t975\t    else: \n```\nSaying that, I do not think that I can come up with such an example because I do not know how the members of FunctionFields category which are not of FunctionField type looks like, I even do not know if they have base_field() method or not (David Roe told me last week that categorical parenthood does not implies OOP parenthood), and if not, the code will generate an error. So, I think we should get rid of these three lines instead.",
    "created_at": "2011-12-20T08:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130445",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@williamstein](#comment%3A9):
> Just a quick observation.  The docstring for is_RationalFunctionField claims that it checks if the input is "of rational function field *type*".  However, that is not what it does.

What I needed was the type check, but because I wanted to follow is_FunctionField line by line and that there's no category of RationalFunctionFields I thought that this is the closest approximation.

```
  	973	    if (x in FunctionFields()): 
  	974	        return x == x.base_field() 
  	975	    else: 
```
Saying that, I do not think that I can come up with such an example because I do not know how the members of FunctionFields category which are not of FunctionField type looks like, I even do not know if they have base_field() method or not (David Roe told me last week that categorical parenthood does not implies OOP parenthood), and if not, the code will generate an error. So, I think we should get rid of these three lines instead.



---

archive/issue_comments_130446.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@sagetrac-sydahmad](#comment%3A10):\n> Replying to [@saraedum](#comment%3A7):\n> \n> > I'm surprised myself but singular does not complain about fractions: ` sage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)') -x<sup>3-2*x*y+y</sup>5 sage: singular.eval('1/x') 0 ` The 1/x was just thrown out because in singular it evaluates to 0.\n> \n> \n> So, basically, I need to clear the denominator before handing the job to Singular, correct? If yes is there a method to do so, or I just compute the GCD of the denom of all coeffs?\n> \n> Thanx.\n\nThere's a method `_make_monic_integral()` that seems to do just that.",
    "created_at": "2011-12-21T14:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130446",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@sagetrac-sydahmad](#comment%3A10):
> Replying to [@saraedum](#comment%3A7):
> 
> > I'm surprised myself but singular does not complain about fractions: ` sage: singular.ideal('y^5 - (x^3 + 2*x*y + 1/x)') -x<sup>3-2*x*y+y</sup>5 sage: singular.eval('1/x') 0 ` The 1/x was just thrown out because in singular it evaluates to 0.
> 
> 
> So, basically, I need to clear the denominator before handing the job to Singular, correct? If yes is there a method to do so, or I just compute the GCD of the denom of all coeffs?
> 
> Thanx.

There's a method `_make_monic_integral()` that seems to do just that.



---

archive/issue_events_163578.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-22T09:13:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163578"
}
```



---

archive/issue_events_163579.json:
```json
{
    "actor": "https://github.com/sagetrac-sydahmad",
    "created_at": "2011-12-22T09:13:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163579"
}
```



---

archive/issue_comments_130447.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI addressed cache_method, reducing calls and using integral polynomial. I also got rid of the line in is_RationalFunctionField which was making the documentation invalid. About the name and place of definition of is_RationalFunctionField, I think the name is appropriate because it shows that we are asking about the type of the object and not the rationality of the function field. For the same reason, because it's asking about the type of the object and not one of its attribute, doesn't it make sense to remain outside, like is_FunctionField (though we don't have a cat (yet!)).\n\nAnyways, if there's a unanimous decision about its name and its place of definition, I'll apply it. But if it is defined in the FunctionField class it will be only:\n\n```\ndef is_RationalFunctionField(self):\n\u00a0   return False;\n```\nand in the RationalFunctionField\u00a0class:\n\n```\ndef is_RationalFunctionField(self):\n    return True;\n```\nWe can also, get rid of it, but I think it improves the readability of the code.\n\nAnd sorry about two patches. I initiated my queue after the first submission and now hg doesn't let me rollback.",
    "created_at": "2011-12-22T09:13:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130447",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:15" align="right">comment:15</div>

I addressed cache_method, reducing calls and using integral polynomial. I also got rid of the line in is_RationalFunctionField which was making the documentation invalid. About the name and place of definition of is_RationalFunctionField, I think the name is appropriate because it shows that we are asking about the type of the object and not the rationality of the function field. For the same reason, because it's asking about the type of the object and not one of its attribute, doesn't it make sense to remain outside, like is_FunctionField (though we don't have a cat (yet!)).

Anyways, if there's a unanimous decision about its name and its place of definition, I'll apply it. But if it is defined in the FunctionField class it will be only:

```
def is_RationalFunctionField(self):
    return False;
```
and in the RationalFunctionField class:

```
def is_RationalFunctionField(self):
    return True;
```
We can also, get rid of it, but I think it improves the readability of the code.

And sorry about two patches. I initiated my queue after the first submission and now hg doesn't let me rollback.



---

archive/issue_comments_130448.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI have finally qfolded the two patches in one but I don't know how to delete the two first files. Maybe I don't have permission to do so. If anybody can delete *\"*[trac_12170.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170.patch.gz)*\" and\u00a0\"*[trac_12170_1.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170_1.patch.gz)\" from this ticket please do so.",
    "created_at": "2011-12-29T02:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130448",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

<div id="comment:17" align="right">comment:17</div>

I have finally qfolded the two patches in one but I don't know how to delete the two first files. Maybe I don't have permission to do so. If anybody can delete *"*[trac_12170.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170.patch.gz)*" and "*[trac_12170_1.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170_1.patch.gz)" from this ticket please do so.



---

archive/issue_comments_130449.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@sagetrac-sydahmad](#comment%3A17):\n> I have finally qfolded the two patches in one but I don't know how to delete the two first files. Maybe I don't have permission to do so. If anybody can delete *\"*[trac_12170.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170.patch.gz)*\" and\u00a0\"*[trac_12170_1.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170_1.patch.gz)\" from this ticket please do so.\n\nYou can just mention in the ticket's Description which patch to apply.",
    "created_at": "2012-01-26T05:43:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130449",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@sagetrac-sydahmad](#comment%3A17):
> I have finally qfolded the two patches in one but I don't know how to delete the two first files. Maybe I don't have permission to do so. If anybody can delete *"*[trac_12170.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170.patch.gz)*" and "*[trac_12170_1.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170_1.patch.gz)" from this ticket please do so.

You can just mention in the ticket's Description which patch to apply.



---

archive/issue_comments_130450.json:
```json
{
    "body": "Attachment: **[trac_12170-gen_comp_singular_obj.patch.gz](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)**\n\nadds genus computation; adds function fieds and rational func field over non prime finite fields to _singular_init and can_convert_to_singular in the singular interface with reduce no of calls to Singular; non integral polynomial bug fixed.",
    "created_at": "2012-02-20T16:44:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130450",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

Attachment: **[trac_12170-gen_comp_singular_obj.patch.gz](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)**

adds genus computation; adds function fieds and rational func field over non prime finite fields to _singular_init and can_convert_to_singular in the singular interface with reduce no of calls to Singular; non integral polynomial bug fixed.



---

archive/issue_comments_130451.json:
```json
{
    "body": "Replying to [@sagetrac-sydahmad](https://github.com/sagemath/sage/issues/12170#comment:0):\n> Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.\n> \n> It is not as fast as magma but it is at least a first step.",
    "created_at": "2012-02-20T16:46:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130451",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

Replying to [@sagetrac-sydahmad](https://github.com/sagemath/sage/issues/12170#comment:0):
> Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.
> 
> It is not as fast as magma but it is at least a first step.



---

archive/issue_comments_130452.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.\n \n It is not as fast as magma but it is at least a first step.\n+\n+You should only apply \"trac_12170-gen_comp_singular_obj.patch\"\n``````\n",
    "created_at": "2012-02-20T16:46:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130452",
    "user": "https://github.com/sagetrac-sydahmad"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.
 
 It is not as fast as magma but it is at least a first step.
+
+You should only apply "trac_12170-gen_comp_singular_obj.patch"
``````




---

archive/issue_comments_130453.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nApply trac_12170-gen_comp_singular_obj.patch\n\n(for patchbot)",
    "created_at": "2012-03-13T13:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130453",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:20" align="right">comment:20</div>

Apply trac_12170-gen_comp_singular_obj.patch

(for patchbot)



---

archive/issue_events_163580.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163580"
}
```



---

archive/issue_events_163581.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163581"
}
```



---

archive/issue_events_163582.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-10-15T19:33:47Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "title_is": "Genus computation (using singular) and _singular_ object for function field",
    "title_was": "Genus computation (using singular) and _singular_ object for function filed",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163582"
}
```



---

archive/issue_events_163583.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-10-15T20:03:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163583"
}
```



---

archive/issue_events_163584.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-10-15T20:03:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163584"
}
```



---

archive/issue_comments_130454.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.\n+Following my the discussion on sage-devel this adds genus() function to the `FunctionField` class, to compute the genus of the function field using singular.\n \n It is not as fast as magma but it is at least a first step.\n \n-You should only apply \"trac_12170-gen_comp_singular_obj.patch\"\n+Apply [attachment: trac_12170-gen_comp_singular_obj.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)\n``````\n",
    "created_at": "2013-10-15T20:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130454",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-Following my the discussion on sage-devel this adds genus() function to the FunctionField class, to compute the genus of the function field using singular.
+Following my the discussion on sage-devel this adds genus() function to the `FunctionField` class, to compute the genus of the function field using singular.
 
 It is not as fast as magma but it is at least a first step.
 
-You should only apply "trac_12170-gen_comp_singular_obj.patch"
+Apply [attachment: trac_12170-gen_comp_singular_obj.patch](https://github.com/sagemath/sage/files/ticket12170/trac_12170-gen_comp_singular_obj.patch.gz)
``````




---

archive/issue_comments_130455.json:
```json
{
    "body": "Reviewer: **Dmitrii Pasechnik**",
    "created_at": "2013-10-17T13:26:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130455",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Dmitrii Pasechnik**



---

archive/issue_comments_130456.json:
```json
{
    "body": "Merged: **sage-5.13.beta1**",
    "created_at": "2013-10-19T09:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12170#issuecomment-130456",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta1**



---

archive/issue_events_163585.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-19T09:20:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163585"
}
```



---

archive/issue_events_163586.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-19T09:20:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12170",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12170#event-163586"
}
```
