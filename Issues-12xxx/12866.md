# Issue 12866: Bug in Sage's monodromy pairing on elements of Brandt modules

archive/issues_012694.json:
```json
{
    "body": "\nIn Magma:\n\n```\nBr:=BrandtModule(2,7);\ng:=Br.1-Br.2;\nInnerProduct(g,g);\n6\n```\nIn Sage:\n\n```\nBr = BrandtModule(2,7)\ng1,g2 = Br.basis()\ng = g1-g2\nprint g1,g2\nprint g.monodromy_pairing(g)\n(1, 0) (0, 1)\n2\n```\n\nAssignee: @craigcitro\n\nKeywords: Brandt module, monodromy pairing\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Aly Deines, Gonzalo Tornar\u00eda\n\nBranch: 448cd9de8e322e7f00c86f0d6e51ffeefd83bdaa\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12866\n\n",
    "closed_at": "2016-08-07T20:01:49Z",
    "created_at": "2012-04-21T21:08:48Z",
    "labels": [
        "component: modular forms",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Bug in Sage's monodromy pairing on elements of Brandt modules",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12866",
    "user": "https://github.com/adeines"
}
```

In Magma:

```
Br:=BrandtModule(2,7);
g:=Br.1-Br.2;
InnerProduct(g,g);
6
```
In Sage:

```
Br = BrandtModule(2,7)
g1,g2 = Br.basis()
g = g1-g2
print g1,g2
print g.monodromy_pairing(g)
(1, 0) (0, 1)
2
```

Assignee: @craigcitro

Keywords: Brandt module, monodromy pairing

Reviewer: Frédéric Chapoton

Author: Aly Deines, Gonzalo Tornaría

Branch: 448cd9de8e322e7f00c86f0d6e51ffeefd83bdaa

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12866





---

archive/issue_events_035069.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35069"
}
```



---

archive/issue_events_035070.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35070"
}
```



---

archive/issue_events_035071.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35071"
}
```



---

archive/issue_events_035072.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35072"
}
```



---

archive/issue_events_035073.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35073"
}
```



---

archive/issue_events_035074.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35074"
}
```



---

archive/issue_events_035075.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35075"
}
```



---

archive/issue_comments_151430.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-26T02:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151430",
    "user": "https://github.com/tornaria"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_151431.json:
```json
{
    "body": "<a id='comment:6'></a>I rebased Aly's patch to sage-6.4.beta1. I added a series of commits to fix a typo in her patch, add some explanation of the computation that is being done, and then an asymptotic improvement so that the monodromy pairing can be computed in O(n) rather than O(n<sup>2</sup>) ideal computations.\n\n---\nNew commits:",
    "created_at": "2014-08-26T02:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151431",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:6'></a>I rebased Aly's patch to sage-6.4.beta1. I added a series of commits to fix a typo in her patch, add some explanation of the computation that is being done, and then an asymptotic improvement so that the monodromy pairing can be computed in O(n) rather than O(n<sup>2</sup>) ideal computations.

---
New commits:



---

archive/issue_comments_151432.json:
```json
{
    "body": "<a id='comment:9'></a>I have made a branch with other changes to the file:\n\n- many doc enhancements, and problems corrected\n- use of cached_method instead of custom cache\n- other small code changes.\n\n---\nNew commits:",
    "created_at": "2016-03-14T16:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151432",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>I have made a branch with other changes to the file:

- many doc enhancements, and problems corrected
- use of cached_method instead of custom cache
- other small code changes.

---
New commits:



---

archive/issue_events_035076.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-14T18:16:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35076"
}
```



---

archive/issue_events_035077.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-14T18:16:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35077"
}
```



---

archive/issue_events_035078.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-25T16:12:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35078"
}
```



---

archive/issue_events_035079.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-25T16:12:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35079"
}
```



---

archive/issue_comments_151433.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-30T06:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_035080.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-07-30T06:27:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35080"
}
```



---

archive/issue_events_035081.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-07-30T06:27:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35081"
}
```



---

archive/issue_comments_151434.json:
```json
{
    "body": "<a id='comment:15'></a>I have checked the code of the authors.\nMy own changes are purely cosmetic, and I have double-checked them.\nThe bot has given a green light.\n\nTherefore I am going to set this to positive review.",
    "created_at": "2016-08-04T16:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151434",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>I have checked the code of the authors.
My own changes are purely cosmetic, and I have double-checked them.
The bot has given a green light.

Therefore I am going to set this to positive review.



---

archive/issue_comments_151435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-04T16:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151435",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_035082.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-07T20:01:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12866#event-35082"
}
```



---

archive/issue_comments_151436.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-07T20:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12866#issuecomment-151436",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
