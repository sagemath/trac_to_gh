# Issue 12823: Allow constants for objective function & deletion of rows in MixedIntegerLinearProgram

archive/issues_012651.json:
```json
{
    "body": "Currently, MixedIntegerLinearProgram does not allow deleting rows. We would like to enable this for all backends that allow it.\n\nAlso, this is a bug.\n\n```\nsage: lp = MixedIntegerLinearProgram()\nsage: x, y = lp[0], lp[1]\nsage: lp.add_constraint(2*x + 3*y <= 6)\nsage: lp.add_constraint(3*x + 2*y <= 6)\nsage: lp.set_objective(x + y + 7)\nsage: lp.set_integer(x); lp.set_integer(y)\nsage: lp.solve()\n2.0\n```\nThe correct value ought to be **9**, not **2**. The problem is this line in the `set_objective()` method of `mip.pyx`:\n\n```\n        f.pop(-1,0)\n```\n\nJohn Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.\n\n**Apply**:\n* [attachment:trac_12823_rolls_all_into_one.patch]\n\nAssignee: @nathanncohen\n\nCC:  @nathanncohen\n\nKeywords: solver objective\n\nReviewer: David Coudert, Nathann Cohen\n\nAuthor: John Perry, Nathann Cohen\n\nMerged: sage-5.1.beta1\n\nDependencies: #12220, #12736, #12833\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12823\n\n",
    "closed_at": "2012-05-23T21:32:53Z",
    "created_at": "2012-04-09T23:15:45Z",
    "labels": [
        "component: linear programming",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "Allow constants for objective function & deletion of rows in MixedIntegerLinearProgram",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12823",
    "user": "https://github.com/johnperry-math"
}
```
Currently, MixedIntegerLinearProgram does not allow deleting rows. We would like to enable this for all backends that allow it.

Also, this is a bug.

```
sage: lp = MixedIntegerLinearProgram()
sage: x, y = lp[0], lp[1]
sage: lp.add_constraint(2*x + 3*y <= 6)
sage: lp.add_constraint(3*x + 2*y <= 6)
sage: lp.set_objective(x + y + 7)
sage: lp.set_integer(x); lp.set_integer(y)
sage: lp.solve()
2.0
```
The correct value ought to be **9**, not **2**. The problem is this line in the `set_objective()` method of `mip.pyx`:

```
        f.pop(-1,0)
```

John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.

**Apply**:
* [attachment:trac_12823_rolls_all_into_one.patch]

Assignee: @nathanncohen

CC:  @nathanncohen

Keywords: solver objective

Reviewer: David Coudert, Nathann Cohen

Author: John Perry, Nathann Cohen

Merged: sage-5.1.beta1

Dependencies: #12220, #12736, #12833

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12823





---

archive/issue_comments_186612.json:
```json
{
    "body": "<a id='comment:1'></a>I've uploaded a patch for Coin & GLPK. Do we want to take care of deleting constraints in this patch, too? I haven't done that yet; if so, I'll modify the ticket correspondingly.",
    "created_at": "2012-04-09T23:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186612",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:1'></a>I've uploaded a patch for Coin & GLPK. Do we want to take care of deleting constraints in this patch, too? I haven't done that yet; if so, I'll modify the ticket correspondingly.



---

archive/issue_comments_186613.json:
```json
{
    "body": "<a id='comment:2'></a>I knew I'd forgotten something in the ticket properties: its type. Sorry. :-(",
    "created_at": "2012-04-09T23:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186613",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:2'></a>I knew I'd forgotten something in the ticket properties: its type. Sorry. :-(



---

archive/issue_comments_186614.json:
```json
{
    "body": "Changing author from \"\" to \"john_perry, ncohen\"",
    "created_at": "2012-04-09T23:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186614",
    "user": "https://github.com/johnperry-math"
}
```

Changing author from "" to "john_perry, ncohen"



---

archive/issue_comments_186615.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2012-04-09T23:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186615",
    "user": "https://github.com/johnperry-math"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_186616.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2012-04-11T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186616",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_186617.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-This is a bug.\n+Currently, MixedIntegerLinearProgram does not allow deleting rows. We would like to enable this for all backends that allow it.\n+\n+Also, this is a bug.\n \n ```\n sage: lp = MixedIntegerLinearProgram()\n@@ -15,4 +17,5 @@\n ```\n         f.pop(-1,0)\n ```\n+\n John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.\n``````\n",
    "created_at": "2012-04-11T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186617",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-This is a bug.
+Currently, MixedIntegerLinearProgram does not allow deleting rows. We would like to enable this for all backends that allow it.
+
+Also, this is a bug.
 
 ```
 sage: lp = MixedIntegerLinearProgram()
@@ -15,4 +17,5 @@
 ```
         f.pop(-1,0)
 ```
+
 John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.
``````




---

archive/issue_comments_186618.json:
```json
{
    "body": "<a id='comment:3'></a>I'm about to upload a new patch that takes into account our offline discussion **and** enables deletion of rows. The doctests and some warning blocks are only in the backends, though; should those be moved to `mip.pyx`? I'm not real clear on that.",
    "created_at": "2012-04-11T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186618",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:3'></a>I'm about to upload a new patch that takes into account our offline discussion **and** enables deletion of rows. The doctests and some warning blocks are only in the backends, though; should those be moved to `mip.pyx`? I'm not real clear on that.



---

archive/issue_comments_186619.json:
```json
{
    "body": "<a id='comment:4'></a>I also corrected the output of `show()`.",
    "created_at": "2012-04-11T20:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186619",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:4'></a>I also corrected the output of `show()`.



---

archive/issue_comments_186620.json:
```json
{
    "body": "<a id='comment:5'></a>Hellooooooooooo John !!\n\nWell, there is no need to test functions 10 times in the same way, so the best is to write real hard tests in the backends, and some tests just meant as examples for the users in the documentation of numerical/mip.pyx. The point is that GLPK is the only solver whose documentation appears in Sage's online reference manual, so we can not easily write important documentation in the backends of CBC, Cplex and Gurobi for the user has almost no way to see it. \n\nNathann",
    "created_at": "2012-04-11T20:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186620",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>Hellooooooooooo John !!

Well, there is no need to test functions 10 times in the same way, so the best is to write real hard tests in the backends, and some tests just meant as examples for the users in the documentation of numerical/mip.pyx. The point is that GLPK is the only solver whose documentation appears in Sage's online reference manual, so we can not easily write important documentation in the backends of CBC, Cplex and Gurobi for the user has almost no way to see it. 

Nathann



---

archive/issue_comments_186621.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [ncohen](#comment%3A5):\n> Well, there is no need to test functions 10 times in the same way, so the best is to write real hard tests in the backends, and some tests just meant as examples for the users in the documentation of numerical/mip.pyx.\n\n\nOkay. I added a relatively simplex doctest for `mip.pyx` that illustrates removing constraints in a way that works for both GLPK and Coin. Its warning clause should hopefully alert the reader to look up the details for the solver they are using. While I was at it, I also fixed more output problems in `show()`.\n\nI guess it's time for you to referee this one, and to submit a patch for the other solvers. `:-)`",
    "created_at": "2012-04-11T23:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186621",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:6'></a>Replying to [ncohen](#comment%3A5):
> Well, there is no need to test functions 10 times in the same way, so the best is to write real hard tests in the backends, and some tests just meant as examples for the users in the documentation of numerical/mip.pyx.


Okay. I added a relatively simplex doctest for `mip.pyx` that illustrates removing constraints in a way that works for both GLPK and Coin. Its warning clause should hopefully alert the reader to look up the details for the solver they are using. While I was at it, I also fixed more output problems in `show()`.

I guess it's time for you to referee this one, and to submit a patch for the other solvers. `:-)`



---

archive/issue_comments_186622.json:
```json
{
    "body": "Attachment [trac_12823_const_for_obj_funs.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_const_for_obj_funs.patch) by @johnperry-math created at 2012-04-11 23:59:42",
    "created_at": "2012-04-11T23:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186622",
    "user": "https://github.com/johnperry-math"
}
```

Attachment [trac_12823_const_for_obj_funs.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_const_for_obj_funs.patch) by @johnperry-math created at 2012-04-11 23:59:42



---

archive/issue_comments_186623.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,3 +19,6 @@\n ```\n \n John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.\n+\n+**Apply**:\n+* [attachment:trac_12823_const_for_obj_funs.patch]\n``````\n",
    "created_at": "2012-04-12T00:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186623",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,3 +19,6 @@
 ```
 
 John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.
+
+**Apply**:
+* [attachment:trac_12823_const_for_obj_funs.patch]
``````




---

archive/issue_comments_186624.json:
```json
{
    "body": "<a id='comment:8'></a>Hellooooooooo !!!\n\nSimple. Your meant Simple. Not Simplex `:-D`\nI'm making the same kind of mistake something with crazy words from graph theory or Sage... Crazy `:-D`\n\nWell... This patch took me... quite some time ! It all began with #12833, which this patch depends upon. Some problems with Gurobi's interface. Which I noticed because my gurobi license was not valid anymore. Once I got this license again (and reinstalled Gurobi), I had a problem when installing cbc with ``sage -i cbc``, for the first package Sage installed was the old one. Harald Schilly fixed that.\nAnd... Ok, now this patch !\nIt does not do much actually, just adds the required methods in cplex and Gurobi.\n\nSome important things I should mention. Please tell me what you think of them :\n* I renamed self.obj_value to self.obj_constant_term, as I would have expected self.obj_value to store the optimal value reached by the objective function.\n* Sage should *never* crash, whatever happens in the code. So as usual ((&*`@`#)*&`@`%&* indexes in GLPK) I added a +1 to the indices in GLPK, so that the constraints are numbered from 0 regardless of the solver. I also added tests in GLPK and Coin to ensure no crash happens. CPLEX and Gurobi never crash because of that, as they have a smarter management of exceptions (error codes). \n* I also changed some doctests for which solutions were not unique. Actually I just removed the lines printing the value of variables, which were not fundamental, and let the others stay as they really tested the new methods.\n* I believe I also added some #optional flags in Coin's file, though everything is mixed up in my head after editing 4 files in a row `:-D`\n\nAnyway, everything is tested, and.... \n\n```\n~/sage/numerical/backends$ sage -t -optional coin_backend.pyx glpk_backend.pyx gurobi_backend.pyx cplex_backend.pyx \nsage -t -optional \"devel/sage-2/sage/numerical/backends/coin_backend.pyx\"\n\t [1.3 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/cplex_backend.pyx\"\n\t [1.3 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/glpk_backend.pyx\"\n\t [1.3 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/gurobi_backend.pyx\"\n\t [1.4 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 5.3 seconds\n~/sage/numerical/backends$ \n```\n\n(And I rarely have all solvers installed at the same time)\n\nSoo... Well, if you agree with my patch (I can send you my cplex/gurobi license if necessary), .... `:-)`\n\nThank you very much for your work on that one ! It's good to see this class move a bit `:-)`\n\nNathann",
    "created_at": "2012-04-12T13:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186624",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>Hellooooooooo !!!

Simple. Your meant Simple. Not Simplex `:-D`
I'm making the same kind of mistake something with crazy words from graph theory or Sage... Crazy `:-D`

Well... This patch took me... quite some time ! It all began with #12833, which this patch depends upon. Some problems with Gurobi's interface. Which I noticed because my gurobi license was not valid anymore. Once I got this license again (and reinstalled Gurobi), I had a problem when installing cbc with ``sage -i cbc``, for the first package Sage installed was the old one. Harald Schilly fixed that.
And... Ok, now this patch !
It does not do much actually, just adds the required methods in cplex and Gurobi.

Some important things I should mention. Please tell me what you think of them :
* I renamed self.obj_value to self.obj_constant_term, as I would have expected self.obj_value to store the optimal value reached by the objective function.
* Sage should *never* crash, whatever happens in the code. So as usual ((&*`@`#)*&`@`%&* indexes in GLPK) I added a +1 to the indices in GLPK, so that the constraints are numbered from 0 regardless of the solver. I also added tests in GLPK and Coin to ensure no crash happens. CPLEX and Gurobi never crash because of that, as they have a smarter management of exceptions (error codes). 
* I also changed some doctests for which solutions were not unique. Actually I just removed the lines printing the value of variables, which were not fundamental, and let the others stay as they really tested the new methods.
* I believe I also added some #optional flags in Coin's file, though everything is mixed up in my head after editing 4 files in a row `:-D`

Anyway, everything is tested, and.... 

```
~/sage/numerical/backends$ sage -t -optional coin_backend.pyx glpk_backend.pyx gurobi_backend.pyx cplex_backend.pyx 
sage -t -optional "devel/sage-2/sage/numerical/backends/coin_backend.pyx"
	 [1.3 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/cplex_backend.pyx"
	 [1.3 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/glpk_backend.pyx"
	 [1.3 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/gurobi_backend.pyx"
	 [1.4 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 5.3 seconds
~/sage/numerical/backends$ 
```

(And I rarely have all solvers installed at the same time)

Soo... Well, if you agree with my patch (I can send you my cplex/gurobi license if necessary), .... `:-)`

Thank you very much for your work on that one ! It's good to see this class move a bit `:-)`

Nathann



---

archive/issue_comments_186625.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,3 +22,4 @@\n \n **Apply**:\n * [attachment:trac_12823_const_for_obj_funs.patch]\n+* [attachment:trac_12823-cplex_gurobi.patch]\n``````\n",
    "created_at": "2012-04-12T13:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186625",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,3 +22,4 @@
 
 **Apply**:
 * [attachment:trac_12823_const_for_obj_funs.patch]
+* [attachment:trac_12823-cplex_gurobi.patch]
``````




---

archive/issue_comments_186626.json:
```json
{
    "body": "Changing dependencies from \"\" to \"12833\"",
    "created_at": "2012-04-12T13:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186626",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "" to "12833"



---

archive/issue_comments_186627.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-04-12T13:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186627",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_186628.json:
```json
{
    "body": "<a id='comment:9'></a>I'm okay with offsetting the constraint according to the solver. However, line 401 of coin_backend should have\n\n```\nif i < 0 or i >= self.si.getNumRows():\n```\ninstead of\n\n```\nif i < 0 or i > self.si.getNumRows():\n```\nshouldn't it?",
    "created_at": "2012-04-12T14:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186628",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:9'></a>I'm okay with offsetting the constraint according to the solver. However, line 401 of coin_backend should have

```
if i < 0 or i >= self.si.getNumRows():
```
instead of

```
if i < 0 or i > self.si.getNumRows():
```
shouldn't it?



---

archive/issue_comments_186629.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-12T14:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186629",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_186630.json:
```json
{
    "body": "<a id='comment:10'></a>Ahahaah. Totally right. Updated `:-)`\n\nI had also totally forgotten to do the same for GLPK `O_o`\nThat's what you get when you code through copy/paste in several patches `:-P`\n\nNathann",
    "created_at": "2012-04-12T14:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186630",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>Ahahaah. Totally right. Updated `:-)`

I had also totally forgotten to do the same for GLPK `O_o`
That's what you get when you code through copy/paste in several patches `:-P`

Nathann



---

archive/issue_comments_186631.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-12T14:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186631",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_186632.json:
```json
{
    "body": "<a id='comment:11'></a>Why do you enumerate the constraints in coin_backend, maybe others? Why not simply loop i from 0 to len(constraints)?\n\nMore: I don't understand this:\n\n```\nfor i,c in enumerate(constraints): \n  if i < 0 or i >= nrows: \n    sage_free(rows) \n    raise ValueError(\"The constraint's index i must satisfy 0 <= i < number_of_constraints\") \n\n  rows[i] = constraints[i] \n```\nSeems to me the test should be\n\n```\n  if c < 0 or c >= nrows:\n```\nshouldn't it? and then you could have\n\n```\n  rows[i] = c     # same as constraints[i]\n```",
    "created_at": "2012-04-12T14:28:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186632",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:11'></a>Why do you enumerate the constraints in coin_backend, maybe others? Why not simply loop i from 0 to len(constraints)?

More: I don't understand this:

```
for i,c in enumerate(constraints): 
  if i < 0 or i >= nrows: 
    sage_free(rows) 
    raise ValueError("The constraint's index i must satisfy 0 <= i < number_of_constraints") 

  rows[i] = constraints[i] 
```
Seems to me the test should be

```
  if c < 0 or c >= nrows:
```
shouldn't it? and then you could have

```
  rows[i] = c     # same as constraints[i]
```



---

archive/issue_comments_186633.json:
```json
{
    "body": "<a id='comment:12'></a>> Why do you enumerate the constraints in coin_backend, maybe others? Why not simply loop i from 0 to len(constraints)?\n\n\nOh. Because I have been told that \"enumerate\" had been \"optimised\", and that as \"for i in range(n)\" it was translated into \"good C code\". Actually, here is what it gives :\n\n```\n  __pyx_t_4 = 0;\n  __pyx_t_1 = ((PyObject *)__pyx_v_coeff); __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;\n  for (;;) {\n    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;\n    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++;\n    __Pyx_XDECREF(__pyx_v_v);\n    __pyx_v_v = __pyx_t_2;\n    __pyx_t_2 = 0;\n    __pyx_v_i = __pyx_t_4;\n    __pyx_t_4 = (__pyx_t_4 + 1);\n```\n\nSo it is more or less the same... In particular, when you have a \"for i in range(len(something))\" I guess the \"len(something)\" is evaluated many times.\n\n```\n  __pyx_t_4 = PyObject_Length(__pyx_v_constraints); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {\n    __pyx_v_i = __pyx_t_5;\n```\n\nOh. No, it is not. Ok well.. It looks like it is indeed better as an range(len(thing)) `:-D`\nAnd anyway it makes more sense this way... Of course there is no way to ensure that \"len(thing)\" does not change between the loops, but the meaning of \"range(len(thing))\" is clear, even if \"thing\" changed later on in the loop.\n\nUpdated !\n\n> Seems to me the test should be\n> \n> ```\n>   if c < 0 or c >= nrows:\n> ```\n> shouldn't it?\n\n\nYeah totally.... Stupid me.\n\nNathann",
    "created_at": "2012-04-12T14:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186633",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>> Why do you enumerate the constraints in coin_backend, maybe others? Why not simply loop i from 0 to len(constraints)?


Oh. Because I have been told that "enumerate" had been "optimised", and that as "for i in range(n)" it was translated into "good C code". Actually, here is what it gives :

```
  __pyx_t_4 = 0;
  __pyx_t_1 = ((PyObject *)__pyx_v_coeff); __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++;
    __Pyx_XDECREF(__pyx_v_v);
    __pyx_v_v = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = (__pyx_t_4 + 1);
```

So it is more or less the same... In particular, when you have a "for i in range(len(something))" I guess the "len(something)" is evaluated many times.

```
  __pyx_t_4 = PyObject_Length(__pyx_v_constraints); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
```

Oh. No, it is not. Ok well.. It looks like it is indeed better as an range(len(thing)) `:-D`
And anyway it makes more sense this way... Of course there is no way to ensure that "len(thing)" does not change between the loops, but the meaning of "range(len(thing))" is clear, even if "thing" changed later on in the loop.

Updated !

> Seems to me the test should be
> 
> ```
>   if c < 0 or c >= nrows:
> ```
> shouldn't it?


Yeah totally.... Stupid me.

Nathann



---

archive/issue_comments_186634.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-12T16:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186634",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_186635.json:
```json
{
    "body": "Changing work_issues from \"\" to \"failing doctests\"",
    "created_at": "2012-04-12T16:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186635",
    "user": "https://github.com/loefflerd"
}
```

Changing work_issues from "" to "failing doctests"



---

archive/issue_comments_186636.json:
```json
{
    "body": "<a id='comment:13'></a>Patchbot's not happy:\n\n```\n**********************************************************************\nFile \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1101:\n    sage: p.number_of_constraints()\nExpected:\n    3\nGot:\n    2\n**********************************************************************\nFile \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1131:\n    sage: p.remove_constraint([0, 1])\nException raised:\n    Traceback (most recent call last):\n      File \"/storage/masiao/sage-5.0.beta13-patchbot/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/storage/masiao/sage-5.0.beta13-patchbot/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/storage/masiao/sage-5.0.beta13-patchbot/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_17[8]>\", line 1, in <module>\n        p.remove_constraint([Integer(0), Integer(1)])###line 1131:\n    sage: p.remove_constraint([0, 1])\n      File \"mip.pyx\", line 1070, in sage.numerical.mip.MixedIntegerLinearProgram.remove_constraint (sage/numerical/mip.c:6538)\n        def remove_constraint(self, int i):\n    TypeError: an integer is required\n**********************************************************************\nFile \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1132:\n    sage: p.show()\nExpected:\n    Maximization:\n    <BLANKLINE>\n    Constraints:\n      x_0 <= 4.0\n    ...\nGot:\n    Maximization:\n    <BLANKLINE>\n    Constraints:\n      x_0 + x_1 <= 10.0\n      x_0 - x_1 <= 0.0\n      x_0 <= 4.0\n    Variables:\n      x_0 is a continuous variable (min=0.0, max=+oo)\n      x_1 is a continuous variable (min=0.0, max=+oo)\n**********************************************************************\n2 items had failures:\n   1 of  12 in __main__.example_16\n   2 of  12 in __main__.example_17\n***Test Failed*** 3 failures.\nFor whitespace errors, see the file /home/masiao/.sage/tmp/fermat-6426/mip_26729.py\n\t [2.5 s]\n```",
    "created_at": "2012-04-12T16:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186636",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:13'></a>Patchbot's not happy:

```
**********************************************************************
File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1101:
    sage: p.number_of_constraints()
Expected:
    3
Got:
    2
**********************************************************************
File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1131:
    sage: p.remove_constraint([0, 1])
Exception raised:
    Traceback (most recent call last):
      File "/storage/masiao/sage-5.0.beta13-patchbot/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/storage/masiao/sage-5.0.beta13-patchbot/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/storage/masiao/sage-5.0.beta13-patchbot/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_17[8]>", line 1, in <module>
        p.remove_constraint([Integer(0), Integer(1)])###line 1131:
    sage: p.remove_constraint([0, 1])
      File "mip.pyx", line 1070, in sage.numerical.mip.MixedIntegerLinearProgram.remove_constraint (sage/numerical/mip.c:6538)
        def remove_constraint(self, int i):
    TypeError: an integer is required
**********************************************************************
File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1132:
    sage: p.show()
Expected:
    Maximization:
    <BLANKLINE>
    Constraints:
      x_0 <= 4.0
    ...
Got:
    Maximization:
    <BLANKLINE>
    Constraints:
      x_0 + x_1 <= 10.0
      x_0 - x_1 <= 0.0
      x_0 <= 4.0
    Variables:
      x_0 is a continuous variable (min=0.0, max=+oo)
      x_1 is a continuous variable (min=0.0, max=+oo)
**********************************************************************
2 items had failures:
   1 of  12 in __main__.example_16
   2 of  12 in __main__.example_17
***Test Failed*** 3 failures.
For whitespace errors, see the file /home/masiao/.sage/tmp/fermat-6426/mip_26729.py
	 [2.5 s]
```



---

archive/issue_comments_186637.json:
```json
{
    "body": "<a id='comment:14'></a>Apparently Nathann ran a doctest on everything **except** `mip.pyx`... LOL\n\nReplying to [davidloeffler](#comment%3A13):\n> Patchbot's not happy:\n> \n> ```\n> **********************************************************************\n> File \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1101:\n>     sage: p.number_of_constraints()\n> Expected:\n>     3\n> Got:\n>     2\n> ```\n\n\nYes, `3` in the doctest should change to `2`.\n\n> {{{\n> **********************************************************************\n> File \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1131:\n>     sage: p.remove_constraint([0, 1])\n> Exception raised:\n> \n> ...\n> \n> File \"/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx\", line 1132:\n>     sage: p.show()\n> Expected:\n>     Maximization:\n>     <BLANKLINE>\n>     Constraints:\n>       x_0 <= 4.0\n>     ...\n> Got:\n>     Maximization:\n>     <BLANKLINE>\n>     Constraints:\n>       x_0 + x_1 <= 10.0\n>       x_0 - x_1 <= 0.0\n>       x_0 <= 4.0\n>     Variables:\n>       x_0 is a continuous variable (min=0.0, max=+oo)\n>       x_1 is a continuous variable (min=0.0, max=+oo)\n> }}}\n\n\nThese are both because line 1127, which used to have\n\n```\nsage: p.remove_constraints([2])\n```\nwas changed to\n\n```\nsage: p.remove_constraint([0,1])\n```\nNote the missing **s**. Fixing that should fix these tests. I'll leave it to Nathann, since these come from his patch.",
    "created_at": "2012-04-12T16:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186637",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:14'></a>Apparently Nathann ran a doctest on everything **except** `mip.pyx`... LOL

Replying to [davidloeffler](#comment%3A13):
> Patchbot's not happy:
> 
> ```
> **********************************************************************
> File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1101:
>     sage: p.number_of_constraints()
> Expected:
>     3
> Got:
>     2
> ```


Yes, `3` in the doctest should change to `2`.

> {{{
> **********************************************************************
> File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1131:
>     sage: p.remove_constraint([0, 1])
> Exception raised:
> 
> ...
> 
> File "/storage/masiao/sage-5.0.beta13-patchbot/devel/sage-12823/sage/numerical/mip.pyx", line 1132:
>     sage: p.show()
> Expected:
>     Maximization:
>     <BLANKLINE>
>     Constraints:
>       x_0 <= 4.0
>     ...
> Got:
>     Maximization:
>     <BLANKLINE>
>     Constraints:
>       x_0 + x_1 <= 10.0
>       x_0 - x_1 <= 0.0
>       x_0 <= 4.0
>     Variables:
>       x_0 is a continuous variable (min=0.0, max=+oo)
>       x_1 is a continuous variable (min=0.0, max=+oo)
> }}}


These are both because line 1127, which used to have

```
sage: p.remove_constraints([2])
```
was changed to

```
sage: p.remove_constraint([0,1])
```
Note the missing **s**. Fixing that should fix these tests. I'll leave it to Nathann, since these come from his patch.



---

archive/issue_comments_186638.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-12T18:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186638",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_186639.json:
```json
{
    "body": "<a id='comment:15'></a>> Apparently Nathann ran a doctest on everything **except** `mip.pyx`... LOL\n\n\nAhahaha right `:-)`\n\nI always assume that the backends' specific files are harder to test, and that the graph/ files are the one that should be test to ensure all returned results are correct `:-)`\n\nPatch updated !\n\nNathann",
    "created_at": "2012-04-12T18:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186639",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>> Apparently Nathann ran a doctest on everything **except** `mip.pyx`... LOL


Ahahaha right `:-)`

I always assume that the backends' specific files are harder to test, and that the graph/ files are the one that should be test to ensure all returned results are correct `:-)`

Patch updated !

Nathann



---

archive/issue_comments_186640.json:
```json
{
    "body": "<a id='comment:16'></a>I've examined the code for the patch. Only one question: in the Gurobi backend, for `remove_constraints`, why do you loop and call `remove_constraint` on each index? The signature for `GRBdelconstrs()` seems to allow sending an index, just like GLPK and Coin. I'm not looking at the documentation for it, though, so maybe that's okay.\n\nIt's pretty clear that CPLEX is different, so I understand the loop there.\n\nAnyway, I'd like to test the patch ASAP, and give it a positive review, but -- I don't have either CPLEX or Gurobi installed. I understand those aren't free like Coin and GLPK. How should I test the doctests? Must I download them, or can I take you at your word that you've doctested them and the doctests check out?",
    "created_at": "2012-04-13T02:35:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186640",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:16'></a>I've examined the code for the patch. Only one question: in the Gurobi backend, for `remove_constraints`, why do you loop and call `remove_constraint` on each index? The signature for `GRBdelconstrs()` seems to allow sending an index, just like GLPK and Coin. I'm not looking at the documentation for it, though, so maybe that's okay.

It's pretty clear that CPLEX is different, so I understand the loop there.

Anyway, I'd like to test the patch ASAP, and give it a positive review, but -- I don't have either CPLEX or Gurobi installed. I understand those aren't free like Coin and GLPK. How should I test the doctests? Must I download them, or can I take you at your word that you've doctested them and the doctests check out?



---

archive/issue_comments_186641.json:
```json
{
    "body": "<a id='comment:17'></a>Helloooooooo !!!\n\nTo be honest I wondered whether we should really have two functions to remove constraints. It sounds nice to have such a high-level function to remove many constraints at once in mip.pyx, this one calling the remove_constraint methods in the backends, but to have a remove_constraintS in each backend we once more have to duplicate a LOT of code (like add_linear_constraintS, add_variableS) that may as well be implemented once and for all in generic_backend.\n\nThen again it is because we are working on pretty different LP. What do you think ?\n\nNathann",
    "created_at": "2012-04-13T08:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186641",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>Helloooooooo !!!

To be honest I wondered whether we should really have two functions to remove constraints. It sounds nice to have such a high-level function to remove many constraints at once in mip.pyx, this one calling the remove_constraint methods in the backends, but to have a remove_constraintS in each backend we once more have to duplicate a LOT of code (like add_linear_constraintS, add_variableS) that may as well be implemented once and for all in generic_backend.

Then again it is because we are working on pretty different LP. What do you think ?

Nathann



---

archive/issue_comments_186642.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [ncohen](#comment%3A17):\n> To be honest I wondered whether we should really have two functions to remove constraints.\n\n\nThat's true. I guess we should just have the one function, `remove_constraints()`, that accepts an iterable. Sort of like we have `get_values()` rather than `get_value()`. and so forth.\n\nIf you're okay with that, I'll revise my ticket.",
    "created_at": "2012-04-13T13:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186642",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:18'></a>Replying to [ncohen](#comment%3A17):
> To be honest I wondered whether we should really have two functions to remove constraints.


That's true. I guess we should just have the one function, `remove_constraints()`, that accepts an iterable. Sort of like we have `get_values()` rather than `get_value()`. and so forth.

If you're okay with that, I'll revise my ticket.



---

archive/issue_comments_186643.json:
```json
{
    "body": "<a id='comment:19'></a>Yooooooo John !\n\nWell, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd. But what about what I just said earlier : remove the S functions from the backends, and write generic ones directly in generic_backend ? The code would be sparser, the features still there !?\n\nAnd this get_values thing is more or less a mistake, because for me \"all\" variables are indexed dictionaries `:-)`\n\nNathann",
    "created_at": "2012-04-13T13:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186643",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>Yooooooo John !

Well, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd. But what about what I just said earlier : remove the S functions from the backends, and write generic ones directly in generic_backend ? The code would be sparser, the features still there !?

And this get_values thing is more or less a mistake, because for me "all" variables are indexed dictionaries `:-)`

Nathann



---

archive/issue_comments_186644.json:
```json
{
    "body": "<a id='comment:20'></a>Alternatively we can also have remove_constraint functions that can also take iterators as argument.. It's true that we are dealing with Python here, we can write very weird code `:-D`\n\nBut that would perhaps be better for the mip.pyx interface... If we want the Cython interface to stay somehow efficient.\n\nNathann",
    "created_at": "2012-04-13T13:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186644",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>Alternatively we can also have remove_constraint functions that can also take iterators as argument.. It's true that we are dealing with Python here, we can write very weird code `:-D`

But that would perhaps be better for the mip.pyx interface... If we want the Cython interface to stay somehow efficient.

Nathann



---

archive/issue_comments_186645.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [ncohen](#comment%3A19):\n> Well, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd.\n\n\nAmusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.\n\n> But what about what I just said earlier : remove the S functions from the backends, and write generic ones directly in generic_backend ? The code would be sparser, the features still there !?\n\n\nI'm not quite following what you're saying. Can you be more specific?\n\n> And this get_values thing is more or less a mistake, because for me \"all\" variables are indexed dictionaries `:-)`\n\n\nI don't understand why that makes it a mistake.",
    "created_at": "2012-04-13T13:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186645",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:21'></a>Replying to [ncohen](#comment%3A19):
> Well, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd.


Amusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.

> But what about what I just said earlier : remove the S functions from the backends, and write generic ones directly in generic_backend ? The code would be sparser, the features still there !?


I'm not quite following what you're saying. Can you be more specific?

> And this get_values thing is more or less a mistake, because for me "all" variables are indexed dictionaries `:-)`


I don't understand why that makes it a mistake.



---

archive/issue_comments_186646.json:
```json
{
    "body": "<a id='comment:22'></a>> > Well, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd.\n\n> \n> Amusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.\n\n\nAhahahah. What about remove_constraint(1) when you just have one constraint to remove ? `:-D`\n\n> I'm not quite following what you're saying. Can you be more specific?\n\n\nOf course ! What I do not like with the current implementation is that many functions (plus their documentation) are very long and essentially do the work done by the previous function several times. Like add-variable(s), add_linear_constraint(s), and now remove_constraint(s).\nIt would be easy to have both at the same time at no cost. We could define for each backend the function without the s, exactly as it is, and define in generic_backend the function with a S, which would just repeatedly call the previous function. This way, all the backends would inherit this abstract function, so it would be available in the backends, but we would be able to remove all the duplicated code from the specific backends.\n\nDoes that sound like a bad idea to you ?\n\n> I don't understand why that makes it a mistake.\n\n\nBecause it was done like a mistake. It was done without properly thinking about how it would be used by other people. Even if it is not so bad after all, it was still done out of careless work `:-)`\n\nNathann",
    "created_at": "2012-04-13T14:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186646",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>> > Well, I would prefer much more to have only remove_constraint than remove_constraintS. Otherwise we will be calling remove_constraints([1]) which looks a bit odd.

> 
> Amusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.


Ahahahah. What about remove_constraint(1) when you just have one constraint to remove ? `:-D`

> I'm not quite following what you're saying. Can you be more specific?


Of course ! What I do not like with the current implementation is that many functions (plus their documentation) are very long and essentially do the work done by the previous function several times. Like add-variable(s), add_linear_constraint(s), and now remove_constraint(s).
It would be easy to have both at the same time at no cost. We could define for each backend the function without the s, exactly as it is, and define in generic_backend the function with a S, which would just repeatedly call the previous function. This way, all the backends would inherit this abstract function, so it would be available in the backends, but we would be able to remove all the duplicated code from the specific backends.

Does that sound like a bad idea to you ?

> I don't understand why that makes it a mistake.


Because it was done like a mistake. It was done without properly thinking about how it would be used by other people. Even if it is not so bad after all, it was still done out of careless work `:-)`

Nathann



---

archive/issue_comments_186647.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [ncohen](#comment%3A22):\n> > Amusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.\n\n> \n> Ahahahah. What about remove_constraint(1) when you just have one constraint to remove ? `:-D`\n\n\nThat looks perfectly fine. Did you mean `remove_constraints(1)`? That does look odd, but not very much so.\n\n> What I do not like with the current implementation is that many functions (plus their documentation) are very long and essentially do the work done by the previous function several times. Like add-variable(s), add_linear_constraint(s), and now remove_constraint(s).\n\n\nOkay.\n\n> It would be easy to have both at the same time at no cost. We could define for each backend the function without the s, exactly as it is, and define in generic_backend the function with a S, which would just repeatedly call the previous function.\n\n\nWell, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.\n\n> This way, all the backends would inherit this abstract function, so it would be available in the backends, but we would be able to remove all the duplicated code from the specific backends.\n> \n> Does that sound like a bad idea to you ?\n\n\nNo, that sounds like what ought to be done.\n\nLet me make sure I understand what you're saying: when code that we have duplicated in `mip.pyx` can be moved to `generic_backend.pyx`, we should do that. Prime candidates for this are `add_variable(s)`, `add_linear_constraint(s)`, and `remove_constraint(s)`. We would not actually remove the functions (yet) though we would deprecate them.\n\nIf I understand you correctly, here's my counter-proposal: let's finish this ticket first, then open another that does that, targeted for sage 5.x where x>0. Otherwise, this gets a little complicated\n\n> > I don't understand why that makes it a mistake.\n\n> \n> Because it was done like a mistake. It was done without properly thinking about how it would be used by other people. Even if it is not so bad after all, it was still done out of careless work `:-)`\n\n\nAll you've said is that it's a mistake, only using different words! I still don't understand why it's wrong.",
    "created_at": "2012-04-13T14:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186647",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:23'></a>Replying to [ncohen](#comment%3A22):
> > Amusingly enough, I think `remove_constraint([1,2,3])` looks far more odd than `remove_constraints([1])`.

> 
> Ahahahah. What about remove_constraint(1) when you just have one constraint to remove ? `:-D`


That looks perfectly fine. Did you mean `remove_constraints(1)`? That does look odd, but not very much so.

> What I do not like with the current implementation is that many functions (plus their documentation) are very long and essentially do the work done by the previous function several times. Like add-variable(s), add_linear_constraint(s), and now remove_constraint(s).


Okay.

> It would be easy to have both at the same time at no cost. We could define for each backend the function without the s, exactly as it is, and define in generic_backend the function with a S, which would just repeatedly call the previous function.


Well, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.

> This way, all the backends would inherit this abstract function, so it would be available in the backends, but we would be able to remove all the duplicated code from the specific backends.
> 
> Does that sound like a bad idea to you ?


No, that sounds like what ought to be done.

Let me make sure I understand what you're saying: when code that we have duplicated in `mip.pyx` can be moved to `generic_backend.pyx`, we should do that. Prime candidates for this are `add_variable(s)`, `add_linear_constraint(s)`, and `remove_constraint(s)`. We would not actually remove the functions (yet) though we would deprecate them.

If I understand you correctly, here's my counter-proposal: let's finish this ticket first, then open another that does that, targeted for sage 5.x where x>0. Otherwise, this gets a little complicated

> > I don't understand why that makes it a mistake.

> 
> Because it was done like a mistake. It was done without properly thinking about how it would be used by other people. Even if it is not so bad after all, it was still done out of careless work `:-)`


All you've said is that it's a mistake, only using different words! I still don't understand why it's wrong.



---

archive/issue_comments_186648.json:
```json
{
    "body": "<a id='comment:24'></a>Hellooooooo !!!\n\n> That looks perfectly fine. Did you mean `remove_constraints(1)`? That does look odd, but not very much so.\n\n\nYep, that's what I meant. That is precisely how get_values currently works `^^;`\n\n> Well, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.\n\n\nHmmm, but we can not do that without writing backend-specific code....\n\n> No, that sounds like what ought to be done.\n> \n> Let me make sure I understand what you're saying: when code that we have duplicated in `mip.pyx` can be moved to `generic_backend.pyx`, we should do that. Prime candidates for this are `add_variable(s)`, `add_linear_constraint(s)`, and `remove_constraint(s)`. We would not actually remove the functions (yet) though we would deprecate them.\n\n\nArggg !! NOononono, I meant duplicated code in the backend files ! That is where we have 2 functions doing the same stuff, rewritten in 4 different files ! `:-P`\n\n> If I understand you correctly, here's my counter-proposal: let's finish this ticket first, then open another that does that, targeted for sage 5.x where x>0. Otherwise, this gets a little complicated\n\n\nThat is agreed. So do we merge this one ? Oh, the Gurobi/CPLEX thing, that's right..\n\nWell, that is up to you. I tested them maaaaaaaaany times, but I can also ask David Coudert to check that tests pass, as he has them installed (well, CPLEX for sure and I do not know about Gurobi). But you really should try CPLEX once, it is soooooooooo much faster for integer problems ! `:-)`\n\nNathann",
    "created_at": "2012-04-13T14:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186648",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>Hellooooooo !!!

> That looks perfectly fine. Did you mean `remove_constraints(1)`? That does look odd, but not very much so.


Yep, that's what I meant. That is precisely how get_values currently works `^^;`

> Well, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.


Hmmm, but we can not do that without writing backend-specific code....

> No, that sounds like what ought to be done.
> 
> Let me make sure I understand what you're saying: when code that we have duplicated in `mip.pyx` can be moved to `generic_backend.pyx`, we should do that. Prime candidates for this are `add_variable(s)`, `add_linear_constraint(s)`, and `remove_constraint(s)`. We would not actually remove the functions (yet) though we would deprecate them.


Arggg !! NOononono, I meant duplicated code in the backend files ! That is where we have 2 functions doing the same stuff, rewritten in 4 different files ! `:-P`

> If I understand you correctly, here's my counter-proposal: let's finish this ticket first, then open another that does that, targeted for sage 5.x where x>0. Otherwise, this gets a little complicated


That is agreed. So do we merge this one ? Oh, the Gurobi/CPLEX thing, that's right..

Well, that is up to you. I tested them maaaaaaaaany times, but I can also ask David Coudert to check that tests pass, as he has them installed (well, CPLEX for sure and I do not know about Gurobi). But you really should try CPLEX once, it is soooooooooo much faster for integer problems ! `:-)`

Nathann



---

archive/issue_comments_186649.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [ncohen](#comment%3A24):\n> > Well, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.\n\n> \n> Hmmm, but we can not do that without writing backend-specific code....\n> \n> ...Arggg !! NOononono, I meant duplicated code in the backend files ! That is where we have 2 functions doing the same stuff, rewritten in 4 different files ! `:-P`\n\n\nOkay, I understand now, and I think it makes better sense, too. `;-)` Duplicated code is one thing, like with the Gurobi, CPLEX, and Coin files. I don't think that's a problem, nor is it incompatible with using the one call in glpk, as I suggest. But I do think we should allow a backend to redefine `remove_constraint()` to take advantage of its own efficiency. In particular, glpk should be able to remove several constraints w/one function call, because it makes it possible. That doesn't duplicate code.\n\nIf you're okay with that, I think this is something that I could take care of today in generic_backend, glpk_backend, and coin_backed; then you could take care of the others.\n\nIf you're not okay with that, then, yeah, it would be best to work this out in a different ticket.\n\n> I tested them maaaaaaaaany times, but I can also ask David Coudert to check that tests pass, as he has them installed (well, CPLEX for sure and I do not know about Gurobi).\n\n\nThat's probably a better idea; the refereeing process would look cleaner to me. We've been working on this stuff and there's a temptation to be hasty. I can read through the lines of your code & it can look good, but still miss things I can't test.\n\n> But you really should try CPLEX once, it is soooooooooo much faster for integer problems ! `:-)`\n\n\nMaybe. :-) I don't want to have to download all these things over & over with each new release of Sage, which occurs far more frequently than I'd like. Though we seem to have been stuck at 4.8 for a surprisingly long time...!",
    "created_at": "2012-04-13T15:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186649",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:25'></a>Replying to [ncohen](#comment%3A24):
> > Well, in cases where the backend provides a way to add or remove multiple rows at once (`glpk` for instance), we ought to do that instead, rather than remove one at a time.

> 
> Hmmm, but we can not do that without writing backend-specific code....
> 
> ...Arggg !! NOononono, I meant duplicated code in the backend files ! That is where we have 2 functions doing the same stuff, rewritten in 4 different files ! `:-P`


Okay, I understand now, and I think it makes better sense, too. `;-)` Duplicated code is one thing, like with the Gurobi, CPLEX, and Coin files. I don't think that's a problem, nor is it incompatible with using the one call in glpk, as I suggest. But I do think we should allow a backend to redefine `remove_constraint()` to take advantage of its own efficiency. In particular, glpk should be able to remove several constraints w/one function call, because it makes it possible. That doesn't duplicate code.

If you're okay with that, I think this is something that I could take care of today in generic_backend, glpk_backend, and coin_backed; then you could take care of the others.

If you're not okay with that, then, yeah, it would be best to work this out in a different ticket.

> I tested them maaaaaaaaany times, but I can also ask David Coudert to check that tests pass, as he has them installed (well, CPLEX for sure and I do not know about Gurobi).


That's probably a better idea; the refereeing process would look cleaner to me. We've been working on this stuff and there's a temptation to be hasty. I can read through the lines of your code & it can look good, but still miss things I can't test.

> But you really should try CPLEX once, it is soooooooooo much faster for integer problems ! `:-)`


Maybe. :-) I don't want to have to download all these things over & over with each new release of Sage, which occurs far more frequently than I'd like. Though we seem to have been stuck at 4.8 for a surprisingly long time...!



---

archive/issue_comments_186650.json:
```json
{
    "body": "<a id='comment:26'></a>> Okay, I understand now, and I think it makes better sense, too. `;-)` Duplicated code is one thing, like with the Gurobi, CPLEX, and Coin files. I don't think that's a problem, nor is it incompatible with using the one call in glpk, as I suggest. But I do think we should allow a backend to redefine `remove_constraint()` to take advantage of its own efficiency. In particular, glpk should be able to remove several constraints w/one function call, because it makes it possible. That doesn't duplicate code.\n\n\nWell, that is the only code I talk about then. \nOk, all in all, perhaps we should keep the code as it is. I really have no use for these *s methods, and to me they just take most of the file for nothing, but of course you are working on a different kind of problems.\n\n> If you're okay with that, I think this is something that I could take care of today in generic_backend, glpk_backend, and coin_backed; then you could take care of the others.\n\n\nThis time it is me who does not understand what you mean. What would you like to do in these files ?\nMy proposition was to remove the s functions and replace them by a generic function that would call the *[!s] functions many times, and you think that it is best to have them exposed. I think you are right, mainly because my main argument is \"they are useless\", and that if anybody think they are useful they immediately become so `:-)`\n\n> If you're not okay with that, then, yeah, it would be best to work this out in a different ticket.\n\n\nWell, this ticket is written and does the work we wanted it to do when you opened it. So I'd vote for getting it reviewed, then merged if that is ok with you `:-)`\n\n> That's probably a better idea; the refereeing process would look cleaner to me. We've been working on this stuff and there's a temptation to be hasty. I can read through the lines of your code & it can look good, but still miss things I can't test.\n\n\nNo prob ! I sent him an email a couple of minutes ago, I hope he will have some time to deal with that `:-)`\n\n> Maybe. :-) I don't want to have to download all these things over & over with each new release of Sage, which occurs far more frequently than I'd like. Though we seem to have been stuck at 4.8 for a surprisingly long time...!\n\n\nI am told Sage-5.0 should be out soon. And I would like veryyyyyyyy much to see #11880 inside of it. This ticket is a nice addition too. Well, I personally got used to compiling Sage every week, but it quickly gets tricky when a user comes and says \"This code does not work in 4.8, what should I do ?\". Most of the time I have no idea what the code was like at this time `:-)`\n\nNathann",
    "created_at": "2012-04-13T15:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186650",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>> Okay, I understand now, and I think it makes better sense, too. `;-)` Duplicated code is one thing, like with the Gurobi, CPLEX, and Coin files. I don't think that's a problem, nor is it incompatible with using the one call in glpk, as I suggest. But I do think we should allow a backend to redefine `remove_constraint()` to take advantage of its own efficiency. In particular, glpk should be able to remove several constraints w/one function call, because it makes it possible. That doesn't duplicate code.


Well, that is the only code I talk about then. 
Ok, all in all, perhaps we should keep the code as it is. I really have no use for these *s methods, and to me they just take most of the file for nothing, but of course you are working on a different kind of problems.

> If you're okay with that, I think this is something that I could take care of today in generic_backend, glpk_backend, and coin_backed; then you could take care of the others.


This time it is me who does not understand what you mean. What would you like to do in these files ?
My proposition was to remove the s functions and replace them by a generic function that would call the *[!s] functions many times, and you think that it is best to have them exposed. I think you are right, mainly because my main argument is "they are useless", and that if anybody think they are useful they immediately become so `:-)`

> If you're not okay with that, then, yeah, it would be best to work this out in a different ticket.


Well, this ticket is written and does the work we wanted it to do when you opened it. So I'd vote for getting it reviewed, then merged if that is ok with you `:-)`

> That's probably a better idea; the refereeing process would look cleaner to me. We've been working on this stuff and there's a temptation to be hasty. I can read through the lines of your code & it can look good, but still miss things I can't test.


No prob ! I sent him an email a couple of minutes ago, I hope he will have some time to deal with that `:-)`

> Maybe. :-) I don't want to have to download all these things over & over with each new release of Sage, which occurs far more frequently than I'd like. Though we seem to have been stuck at 4.8 for a surprisingly long time...!


I am told Sage-5.0 should be out soon. And I would like veryyyyyyyy much to see #11880 inside of it. This ticket is a nice addition too. Well, I personally got used to compiling Sage every week, but it quickly gets tricky when a user comes and says "This code does not work in 4.8, what should I do ?". Most of the time I have no idea what the code was like at this time `:-)`

Nathann



---

archive/issue_comments_186651.json:
```json
{
    "body": "<a id='comment:27'></a>Nathann,\n\nI think there is a better implementation of removing constraints than the one we have right now, one that will avoid code duplication, as you say. Let me think about it this afternoon, and I will upload an alternate patch. This will give us something concrete to discuss.\n\nOtherwise, I think we'll just keep confusing each other.",
    "created_at": "2012-04-13T17:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186651",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:27'></a>Nathann,

I think there is a better implementation of removing constraints than the one we have right now, one that will avoid code duplication, as you say. Let me think about it this afternoon, and I will upload an alternate patch. This will give us something concrete to discuss.

Otherwise, I think we'll just keep confusing each other.



---

archive/issue_comments_186652.json:
```json
{
    "body": "<a id='comment:28'></a>> I think there is a better implementation of removing constraints than the one we have right now, one that will avoid code duplication, as you say. Let me think about it this afternoon, and I will upload an alternate patch. \n\n\n(at 19h40) This..... afternoon ? `:-D`\n\n> This will give us something concrete to discuss.\n\n\nAgreed ! `:-)`\n\n> Otherwise, I think we'll just keep confusing each other.\n\n\nWell, it is slow but even if it takes many exchanges we end up getting the idea through `:-)`\n\nNathann",
    "created_at": "2012-04-13T17:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186652",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:28'></a>> I think there is a better implementation of removing constraints than the one we have right now, one that will avoid code duplication, as you say. Let me think about it this afternoon, and I will upload an alternate patch. 


(at 19h40) This..... afternoon ? `:-D`

> This will give us something concrete to discuss.


Agreed ! `:-)`

> Otherwise, I think we'll just keep confusing each other.


Well, it is slow but even if it takes many exchanges we end up getting the idea through `:-)`

Nathann



---

archive/issue_comments_186653.json:
```json
{
    "body": "Attachment [trac_12823_alternate_removal.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_alternate_removal.patch) by @johnperry-math created at 2012-04-13 18:59:01",
    "created_at": "2012-04-13T18:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186653",
    "user": "https://github.com/johnperry-math"
}
```

Attachment [trac_12823_alternate_removal.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_alternate_removal.patch) by @johnperry-math created at 2012-04-13 18:59:01



---

archive/issue_comments_186654.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,3 +23,5 @@\n **Apply**:\n * [attachment:trac_12823_const_for_obj_funs.patch]\n * [attachment:trac_12823-cplex_gurobi.patch]\n+**or**\n+* [attachment:trac_12823_alternate_removal.patch]\n``````\n",
    "created_at": "2012-04-13T19:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186654",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,3 +23,5 @@
 **Apply**:
 * [attachment:trac_12823_const_for_obj_funs.patch]
 * [attachment:trac_12823-cplex_gurobi.patch]
+**or**
+* [attachment:trac_12823_alternate_removal.patch]
``````




---

archive/issue_comments_186655.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2012-04-13T19:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186655",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_186656.json:
```json
{
    "body": "<a id='comment:29'></a>I've attached another patch that\n* removes `remove_constraints()` from `mip.pyx`,\n* incorporates a generic `remove_constraints()` into `generic_backend.pyx`, more or less along the lines of what you were doing with CPLEX and gurobi, but\n* retains the definitions of `remove_constraints()` used previously in `coin_backend.pyx` and `glpk_backend.pyx`, taking advantage of their respective optimizations.\nThe CPLEX & Gurobi patch can be changed so that **only** `remove_constraint()` need be defined. If you prefer, we could rename that to `remove_single_constraint()`. This eliminates some code duplication, though not much. I think the tradeoff is worth the trouble, myself.\n\nOh -- notice that I still have the old WARN:: and so on in there. I'll change it to the way you had it, if you're okay with this approach. I have a meeting now, but I wanted to get this out so you could look at it & consider it.\n\nOr, we can stick with the older patches.",
    "created_at": "2012-04-13T19:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186656",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:29'></a>I've attached another patch that
* removes `remove_constraints()` from `mip.pyx`,
* incorporates a generic `remove_constraints()` into `generic_backend.pyx`, more or less along the lines of what you were doing with CPLEX and gurobi, but
* retains the definitions of `remove_constraints()` used previously in `coin_backend.pyx` and `glpk_backend.pyx`, taking advantage of their respective optimizations.
The CPLEX & Gurobi patch can be changed so that **only** `remove_constraint()` need be defined. If you prefer, we could rename that to `remove_single_constraint()`. This eliminates some code duplication, though not much. I think the tradeoff is worth the trouble, myself.

Oh -- notice that I still have the old WARN:: and so on in there. I'll change it to the way you had it, if you're okay with this approach. I have a meeting now, but I wanted to get this out so you could look at it & consider it.

Or, we can stick with the older patches.



---

archive/issue_comments_186657.json:
```json
{
    "body": "<a id='comment:30'></a>Helloooooooo John !!\n\nThank you for this other patch ! I will update mine in a few seconds so that the remove_constraintS method disappear from Gurobi and CPLEX, but I would like very much to have a remove_constraint (no s) in mip.pyx. The most natural operation is to remove only one constraint, some of the persons who told me they needed such a feature actually edited LP manually and wanted to \"do some tests\", in which case the operation they would use the most is to remove only one constraint. \n\nNathann",
    "created_at": "2012-04-13T20:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186657",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:30'></a>Helloooooooo John !!

Thank you for this other patch ! I will update mine in a few seconds so that the remove_constraintS method disappear from Gurobi and CPLEX, but I would like very much to have a remove_constraint (no s) in mip.pyx. The most natural operation is to remove only one constraint, some of the persons who told me they needed such a feature actually edited LP manually and wanted to "do some tests", in which case the operation they would use the most is to remove only one constraint. 

Nathann



---

archive/issue_comments_186658.json:
```json
{
    "body": "Attachment [trac_12823-cplex_gurobi.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823-cplex_gurobi.patch) by @nathanncohen created at 2012-04-13 20:11:10",
    "created_at": "2012-04-13T20:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186658",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_12823-cplex_gurobi.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823-cplex_gurobi.patch) by @nathanncohen created at 2012-04-13 20:11:10



---

archive/issue_comments_186659.json:
```json
{
    "body": "<a id='comment:31'></a>Patch updated, without remove_constraintS methods `:-)`\n\nNathann",
    "created_at": "2012-04-13T20:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186659",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:31'></a>Patch updated, without remove_constraintS methods `:-)`

Nathann



---

archive/issue_comments_186660.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [ncohen](#comment%3A30):\n> ...but I would like very much to have a remove_constraint (no s) in mip.pyx.\n\n\nOkay. I can add it, but it will have to wait until tomorrow, or maybe Monday (depending on how busy I am). If you want it sooner, you can add it to your ticket.",
    "created_at": "2012-04-13T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186660",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:32'></a>Replying to [ncohen](#comment%3A30):
> ...but I would like very much to have a remove_constraint (no s) in mip.pyx.


Okay. I can add it, but it will have to wait until tomorrow, or maybe Monday (depending on how busy I am). If you want it sooner, you can add it to your ticket.



---

archive/issue_comments_186661.json:
```json
{
    "body": "<a id='comment:33'></a>Hello,\n\nNathann asks me to pass some tests. So I tried the patchs with sage-5.0-beta13\n\nFirst, I don't understand the install messages.\n\n```\ncompote:~/path-to-sage/devel/sage-myclone> hg qimport ~/Recherche/sage-patchs/trac_12823_const_for_obj_funs.patch \nadding trac_12823_const_for_obj_funs.patch to series file\ncompote:~/path-to-sage/devel/sage-myclone> hg qpush\napplying trac_12823_const_for_obj_funs.patch\nnow at: trac_12823_const_for_obj_funs.patch\ncompote:~/path-to-sage/devel/sage-myclone> hg qimport ~/Recherche/sage-patchs/trac_12823-cplex_gurobi.patch \nadding trac_12823-cplex_gurobi.patch to series file\ncompote:~/Soft/sage-5.0.beta13/devel/sage-myclone> hg qpush                                                        \napplying trac_12823-cplex_gurobi.patch\npatching file sage/numerical/backends/gurobi_backend.pyx\nHunk #2 succeeded at 410 with fuzz 2 (offset -13 lines).\nHunk #3 succeeded at 418 with fuzz 1 (offset -13 lines).\nHunk #4 succeeded at 431 with fuzz 2 (offset -13 lines).\nHunk #7 succeeded at 785 with fuzz 1 (offset -12 lines).\nnow at: trac_12823-cplex_gurobi.patch\n```\n\nI don't have coin or gurobi, so I tried only glpk and cplex\n\n```\n~/path-to-sage/devel/sage-myclone>../../sage -t optional sage/numerical/backends/cplex_backend.pyx\nsage -t -optional \"devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx\"\n         [1.2 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 1.2 seconds\n~/path-to-sage/devel/sage-myclone>../../sage -t optional sage/numerical/backends/glpk_backend.pyx\nsage -t -optional \"devel/sage-myclone/sage/numerical/backends/glpk_backend.pyx\"\n         [1.1 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 1.1 seconds\n```\n\n\nThen I tried the alternate patch but it fails to apply\n\n```\ncompote:~/path-to-sage/devel/sage-myclone> hg qapplied\ncompote:~/path-to-sage/devel/sage-myclone> hg qimport ~/path-to-patchs/trac_12823_alternate_removal.patch \nadding trac_12823_alternate_removal.patch to series file\ncompote:~/path-to-sage/devel/sage-myclone> hg qpush\napplying trac_12823_alternate_removal.patch\npatching file sage/numerical/backends/generic_backend.pyx\nHunk #1 FAILED at 251\n1 out of 1 hunks FAILED -- saving rejects to file sage/numerical/backends/generic_backend.pyx.rej\npatching file sage/numerical/mip.pyx\nHunk #1 FAILED at 1037\n1 out of 5 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_12823_alternate_removal.patch\ncompote:~/path-to-sage/devel/sage-myclone> hg qapplied\ntrac_12823_alternate_removal.patch\n```\n\ngeneric_backend.pyx.rej is\n\n```\n--- generic_backend.pyx\n+++ generic_backend.pyx\n@@ -252,7 +252,15 @@\n \n       - ``constraints`` -- an iterable containing the indices of the rows to remove.\n       \"\"\"\n-      raise NotImplementedError()\n+      if type(constraints) == int: self.remove_constraint(constraints)\n+\n+      cdef int c\n+      cdef int last = self.nrows() + 1\n+\n+      for c in sorted(constraints, reverse=True):\n+          if c != last:\n+              self.remove_constraint(c)\n+              last = c\n \n     cpdef add_linear_constraint(self, coefficients, lower_bound, upper_bound, name=None):\n         \"\"\"\n```\n\nand mip.pyx.rej is\n\n```\n--- mip.pyx\n+++ mip.pyx\n@@ -1038,45 +1038,6 @@\n                 self.add_constraint(functions[0] - functions[1], max=0, name=name)\n                 self.add_constraint(functions[1] - functions[2], max=0, name=name)\n \n-    def remove_constraint(self, int i):\n-        r\"\"\"\n-        Removes a constraint from self.\n-\n-        INPUT:\n-\n-        - ``i`` -- Index of the constraint to remove.\n-\n-        EXAMPLE::\n-\n-            sage: p = MixedIntegerLinearProgram()\n-            sage: x, y = p[0], p[1]\n-            sage: p.add_constraint(x + y, max = 10)\n-            sage: p.add_constraint(x - y, max = 0)\n-            sage: p.add_constraint(x - y, max = 0)\n-            sage: p.add_constraint(x, max = 4)\n-            sage: p.remove_constraint(2)\n-            sage: p.show()\n-            Maximization:\n-            <BLANKLINE>\n-            Constraints:\n-              x_0 + x_1 <= 10.0\n-              x_0 - x_1 <= 0.0\n-              x_0 <= 4.0\n-            ...\n-            sage: p.number_of_constraints()\n-            3\n-\n-        WARN::\n-\n-            Whether the first constraint is numbered 0 or 1 depends on the backend.\n-            For GLPK, the first constraint has index 1; for Coin, it has index 0.\n-            This is why the example above adds the same constraint twice,\n-            and tries to remove on of its copies. Whether it removes the first\n-            or the second depends on the backend.\n-            Since supplying an invalid number WILL CAUSE A CRASH, please be careful!\n-        \"\"\"\n-        self._backend.remove_constraint(i)\n-\n     def remove_constraints(self, constraints):\n         \"\"\"\n         Remove several constraints.\n```\n\n\n\nHope it helps.",
    "created_at": "2012-04-14T23:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186661",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:33'></a>Hello,

Nathann asks me to pass some tests. So I tried the patchs with sage-5.0-beta13

First, I don't understand the install messages.

```
compote:~/path-to-sage/devel/sage-myclone> hg qimport ~/Recherche/sage-patchs/trac_12823_const_for_obj_funs.patch 
adding trac_12823_const_for_obj_funs.patch to series file
compote:~/path-to-sage/devel/sage-myclone> hg qpush
applying trac_12823_const_for_obj_funs.patch
now at: trac_12823_const_for_obj_funs.patch
compote:~/path-to-sage/devel/sage-myclone> hg qimport ~/Recherche/sage-patchs/trac_12823-cplex_gurobi.patch 
adding trac_12823-cplex_gurobi.patch to series file
compote:~/Soft/sage-5.0.beta13/devel/sage-myclone> hg qpush                                                        
applying trac_12823-cplex_gurobi.patch
patching file sage/numerical/backends/gurobi_backend.pyx
Hunk #2 succeeded at 410 with fuzz 2 (offset -13 lines).
Hunk #3 succeeded at 418 with fuzz 1 (offset -13 lines).
Hunk #4 succeeded at 431 with fuzz 2 (offset -13 lines).
Hunk #7 succeeded at 785 with fuzz 1 (offset -12 lines).
now at: trac_12823-cplex_gurobi.patch
```

I don't have coin or gurobi, so I tried only glpk and cplex

```
~/path-to-sage/devel/sage-myclone>../../sage -t optional sage/numerical/backends/cplex_backend.pyx
sage -t -optional "devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx"
         [1.2 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 1.2 seconds
~/path-to-sage/devel/sage-myclone>../../sage -t optional sage/numerical/backends/glpk_backend.pyx
sage -t -optional "devel/sage-myclone/sage/numerical/backends/glpk_backend.pyx"
         [1.1 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 1.1 seconds
```


Then I tried the alternate patch but it fails to apply

```
compote:~/path-to-sage/devel/sage-myclone> hg qapplied
compote:~/path-to-sage/devel/sage-myclone> hg qimport ~/path-to-patchs/trac_12823_alternate_removal.patch 
adding trac_12823_alternate_removal.patch to series file
compote:~/path-to-sage/devel/sage-myclone> hg qpush
applying trac_12823_alternate_removal.patch
patching file sage/numerical/backends/generic_backend.pyx
Hunk #1 FAILED at 251
1 out of 1 hunks FAILED -- saving rejects to file sage/numerical/backends/generic_backend.pyx.rej
patching file sage/numerical/mip.pyx
Hunk #1 FAILED at 1037
1 out of 5 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_12823_alternate_removal.patch
compote:~/path-to-sage/devel/sage-myclone> hg qapplied
trac_12823_alternate_removal.patch
```

generic_backend.pyx.rej is

```
--- generic_backend.pyx
+++ generic_backend.pyx
@@ -252,7 +252,15 @@
 
       - ``constraints`` -- an iterable containing the indices of the rows to remove.
       """
-      raise NotImplementedError()
+      if type(constraints) == int: self.remove_constraint(constraints)
+
+      cdef int c
+      cdef int last = self.nrows() + 1
+
+      for c in sorted(constraints, reverse=True):
+          if c != last:
+              self.remove_constraint(c)
+              last = c
 
     cpdef add_linear_constraint(self, coefficients, lower_bound, upper_bound, name=None):
         """
```

and mip.pyx.rej is

```
--- mip.pyx
+++ mip.pyx
@@ -1038,45 +1038,6 @@
                 self.add_constraint(functions[0] - functions[1], max=0, name=name)
                 self.add_constraint(functions[1] - functions[2], max=0, name=name)
 
-    def remove_constraint(self, int i):
-        r"""
-        Removes a constraint from self.
-
-        INPUT:
-
-        - ``i`` -- Index of the constraint to remove.
-
-        EXAMPLE::
-
-            sage: p = MixedIntegerLinearProgram()
-            sage: x, y = p[0], p[1]
-            sage: p.add_constraint(x + y, max = 10)
-            sage: p.add_constraint(x - y, max = 0)
-            sage: p.add_constraint(x - y, max = 0)
-            sage: p.add_constraint(x, max = 4)
-            sage: p.remove_constraint(2)
-            sage: p.show()
-            Maximization:
-            <BLANKLINE>
-            Constraints:
-              x_0 + x_1 <= 10.0
-              x_0 - x_1 <= 0.0
-              x_0 <= 4.0
-            ...
-            sage: p.number_of_constraints()
-            3
-
-        WARN::
-
-            Whether the first constraint is numbered 0 or 1 depends on the backend.
-            For GLPK, the first constraint has index 1; for Coin, it has index 0.
-            This is why the example above adds the same constraint twice,
-            and tries to remove on of its copies. Whether it removes the first
-            or the second depends on the backend.
-            Since supplying an invalid number WILL CAUSE A CRASH, please be careful!
-        """
-        self._backend.remove_constraint(i)
-
     def remove_constraints(self, constraints):
         """
         Remove several constraints.
```



Hope it helps.



---

archive/issue_comments_186662.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [dcoudert](#comment%3A33):\n> Nathann asks me to pass some tests. So I tried the patchs with sage-5.0-beta13\n> \n> First, I don't understand the install messages.\n\n\nThe first one is okay. The fuzz is due to the fact that I used a different edition of sage to create the patch.\n\nThe output of the second patch is problematic. FWIW, I can't install the patch on beta8, so apparently there's some dependency that needs to be listed.\n\nI'm going to try and figure out the dependency, then get back to you. Hopefully I won't have to redo the patch.",
    "created_at": "2012-04-15T02:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186662",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:34'></a>Replying to [dcoudert](#comment%3A33):
> Nathann asks me to pass some tests. So I tried the patchs with sage-5.0-beta13
> 
> First, I don't understand the install messages.


The first one is okay. The fuzz is due to the fact that I used a different edition of sage to create the patch.

The output of the second patch is problematic. FWIW, I can't install the patch on beta8, so apparently there's some dependency that needs to be listed.

I'm going to try and figure out the dependency, then get back to you. Hopefully I won't have to redo the patch.



---

archive/issue_comments_186663.json:
```json
{
    "body": "<a id='comment:35'></a>Looks like I goofed when creating the patch. Please apply [attachment:trac_12823_const_for_obj_funs.patch] first, then [attachment:trac_12823_alternate_removal.patch], and finally [attachment:trac_12823-cplex_gurobi.patch]. I have modified the ticket description to reflect this.\n\nI'm actually getting doctest errors on this, so I may upload new patches. But, if you don't get problems after this, that would suggest things are okay. I'm using an older beta, so I'm probably still missing something.",
    "created_at": "2012-04-15T02:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186663",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:35'></a>Looks like I goofed when creating the patch. Please apply [attachment:trac_12823_const_for_obj_funs.patch] first, then [attachment:trac_12823_alternate_removal.patch], and finally [attachment:trac_12823-cplex_gurobi.patch]. I have modified the ticket description to reflect this.

I'm actually getting doctest errors on this, so I may upload new patches. But, if you don't get problems after this, that would suggest things are okay. I'm using an older beta, so I'm probably still missing something.



---

archive/issue_comments_186664.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,6 +22,5 @@\n \n **Apply**:\n * [attachment:trac_12823_const_for_obj_funs.patch]\n+* [attachment:trac_12823_alternate_removal.patch]\n * [attachment:trac_12823-cplex_gurobi.patch]\n-**or**\n-* [attachment:trac_12823_alternate_removal.patch]\n``````\n",
    "created_at": "2012-04-15T02:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186664",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,6 +22,5 @@
 
 **Apply**:
 * [attachment:trac_12823_const_for_obj_funs.patch]
+* [attachment:trac_12823_alternate_removal.patch]
 * [attachment:trac_12823-cplex_gurobi.patch]
-**or**
-* [attachment:trac_12823_alternate_removal.patch]
``````




---

archive/issue_comments_186665.json:
```json
{
    "body": "Changing dependencies from \"12833\" to \"#12220, #12833\"",
    "created_at": "2012-04-15T02:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186665",
    "user": "https://github.com/johnperry-math"
}
```

Changing dependencies from "12833" to "#12220, #12833"



---

archive/issue_comments_186666.json:
```json
{
    "body": "<a id='comment:36'></a>No, I can't get [attachment:trac_12823-cplex_gurobi.patch] to work, either. Alright, time to rework this.",
    "created_at": "2012-04-15T02:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186666",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:36'></a>No, I can't get [attachment:trac_12823-cplex_gurobi.patch] to work, either. Alright, time to rework this.



---

archive/issue_comments_186667.json:
```json
{
    "body": "<a id='comment:37'></a>The new patch should incorporate all the changes. It passes doctests on 5.0.beta8. It **might** depend on #12220; I'm not sure. The problems I encountered before were due to my having messed up my queue; I had popped too much, and [attachment:trac_12823_alternate_removal.patch] included material from #12736. Please review...",
    "created_at": "2012-04-15T04:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186667",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:37'></a>The new patch should incorporate all the changes. It passes doctests on 5.0.beta8. It **might** depend on #12220; I'm not sure. The problems I encountered before were due to my having messed up my queue; I had popped too much, and [attachment:trac_12823_alternate_removal.patch] included material from #12736. Please review...



---

archive/issue_comments_186668.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,6 +21,4 @@\n John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.\n \n **Apply**:\n-* [attachment:trac_12823_const_for_obj_funs.patch]\n-* [attachment:trac_12823_alternate_removal.patch]\n-* [attachment:trac_12823-cplex_gurobi.patch]\n+* [attachment:trac_12823_rolls_all_into_one.patch]\n``````\n",
    "created_at": "2012-04-15T04:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186668",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,6 +21,4 @@
 John Perry will create a patch for GLPK and CBC; Nathann Cohen will create a patch for Gurobi and CPLEX.
 
 **Apply**:
-* [attachment:trac_12823_const_for_obj_funs.patch]
-* [attachment:trac_12823_alternate_removal.patch]
-* [attachment:trac_12823-cplex_gurobi.patch]
+* [attachment:trac_12823_rolls_all_into_one.patch]
``````




---

archive/issue_comments_186669.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-04-15T04:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186669",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_186670.json:
```json
{
    "body": "<a id='comment:38'></a>It looks as if #12736 is a dependency now, due to some changes in function signatures. Sorry for not noticing that previously. I'm about to update another patch that accounts for some problems this has introduced.",
    "created_at": "2012-04-15T05:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186670",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:38'></a>It looks as if #12736 is a dependency now, due to some changes in function signatures. Sorry for not noticing that previously. I'm about to update another patch that accounts for some problems this has introduced.



---

archive/issue_comments_186671.json:
```json
{
    "body": "Changing dependencies from \"#12220, #12833\" to \"#12220, #12736, #12833\"",
    "created_at": "2012-04-15T05:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186671",
    "user": "https://github.com/johnperry-math"
}
```

Changing dependencies from "#12220, #12833" to "#12220, #12736, #12833"



---

archive/issue_comments_186672.json:
```json
{
    "body": "<a id='comment:39'></a>On **sage-5.0.beta8**, I have the following patches applied **first**: trac_12220-all_tests_pass.patch, trac_12220-mad+doc.patch, trac_12220-nocache.patch, trac_12736_more_solver_options_for_glpk.patch (and in that order!). Then I apply [attachment:trac_12823_rolls_all_into_one.patch].\n\nThis now works for me on three different versions of sage. I have confirmed that it works with GLPK and Coin (using `sage -t -optional sage/numerical/backends/coin_backend.pyx`), so we need testing of CPLEX and Gurobi. Since Nathann added #12833 as a dependency due to some changes in Gurobi, I presume that this may also be required to test that.",
    "created_at": "2012-04-15T05:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186672",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:39'></a>On **sage-5.0.beta8**, I have the following patches applied **first**: trac_12220-all_tests_pass.patch, trac_12220-mad+doc.patch, trac_12220-nocache.patch, trac_12736_more_solver_options_for_glpk.patch (and in that order!). Then I apply [attachment:trac_12823_rolls_all_into_one.patch].

This now works for me on three different versions of sage. I have confirmed that it works with GLPK and Coin (using `sage -t -optional sage/numerical/backends/coin_backend.pyx`), so we need testing of CPLEX and Gurobi. Since Nathann added #12833 as a dependency due to some changes in Gurobi, I presume that this may also be required to test that.



---

archive/issue_comments_186673.json:
```json
{
    "body": "<a id='comment:40'></a>Hello,\n\nI don't need patch #12220 since it is included in beta13.\n\nI first tried to install patch #12736 and then this patch and it fails.\nThen I realized that you have installed only half of patch #12736. File trac_12736.patch is missing.\n\nWhen I install trac_12736_more_solver_options_for_glpk.patch and then this patch, install is OK.\n\n\nCan you udpate ths patch installing first patch #12220 (3 files) and patch #12736 (2 files).\n\nD.",
    "created_at": "2012-04-15T10:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186673",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:40'></a>Hello,

I don't need patch #12220 since it is included in beta13.

I first tried to install patch #12736 and then this patch and it fails.
Then I realized that you have installed only half of patch #12736. File trac_12736.patch is missing.

When I install trac_12736_more_solver_options_for_glpk.patch and then this patch, install is OK.


Can you udpate ths patch installing first patch #12220 (3 files) and patch #12736 (2 files).

D.



---

archive/issue_comments_186674.json:
```json
{
    "body": "<a id='comment:41'></a>Replying to [dcoudert](#comment%3A40):\n> I don't need patch #12220 since it is included in beta13.\n\n\nGreat.\n\n> I first tried to install patch #12736 and then this patch and it fails.\n> Then I realized that you have installed only half of patch #12736. File trac_12736.patch is missing.\n\n\nIf that oversight wasn't embarrassing enough, I looked at it and found that it was a mere change in documentation that caused the problem.\n\n> Can you udpate ths patch installing first patch #12220 (3 files) and patch #12736 (2 files).\n\n\nDone. Hopefully it will finally work. Third time's the charm, and all...",
    "created_at": "2012-04-15T14:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186674",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:41'></a>Replying to [dcoudert](#comment%3A40):
> I don't need patch #12220 since it is included in beta13.


Great.

> I first tried to install patch #12736 and then this patch and it fails.
> Then I realized that you have installed only half of patch #12736. File trac_12736.patch is missing.


If that oversight wasn't embarrassing enough, I looked at it and found that it was a mere change in documentation that caused the problem.

> Can you udpate ths patch installing first patch #12220 (3 files) and patch #12736 (2 files).


Done. Hopefully it will finally work. Third time's the charm, and all...



---

archive/issue_comments_186675.json:
```json
{
    "body": "<a id='comment:42'></a>I have it working on beta8 and beta9, two different systems, with GLPK and Coin 2.7.5.",
    "created_at": "2012-04-15T15:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186675",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:42'></a>I have it working on beta8 and beta9, two different systems, with GLPK and Coin 2.7.5.



---

archive/issue_comments_186676.json:
```json
{
    "body": "<a id='comment:43'></a>Ok, I'm now able to install successfully the patch !\n\nTests are OK with GLPK but not with CPLEX. \n\n```\nsage -t -optional \"devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx\"\nIBM ILOG License Manager: \"IBM ILOG Optimization Suite for Academic Initiative\" is accessing CPLEX 12 with option(s): \"e m b q \".\n**********************************************************************\nFile \"/path-to-sage/devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx\", line 435:\n    sage: p.solve()                                    # optional - CPLEX\nException raised:\n    Traceback (most recent call last):\n      File \"/path-to-sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/path-to-sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/path-to-sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_9[10]>\", line 1, in <module>\n        p.solve()                                    # optional - CPLEX###line 435:\n    sage: p.solve()                                    # optional - CPLEX\n      File \"mip.pyx\", line 1431, in sage.numerical.mip.MixedIntegerLinearProgram.solve (sage/numerical/mip.c:7747)\n      File \"cplex_backend.pyx\", line 854, in sage.numerical.backends.cplex_backend.CPLEXBackend.solve (sage/numerical/backends/cplex_backend.c:7823)\n    MIPSolverException: 'CPLEX: The problem is unbounded'\n**********************************************************************\nFile \"/path-to-sage/devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx\", line 437:\n    sage: p.get_values([x,y])                          # optional - CPLEX\nExpected:\n    [0.0, 3.0]\nGot:\n    [2.0, 0.0]\n**********************************************************************\n1 items had failures:\n   2 of  13 in __main__.example_9\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /home/dcoudert/.sage//tmp/cplex_backend_17001.py\n         [1.2 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -optional \"devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx\"\nTotal time for all tests: 1.2 seconds\n```\n\n\nI have observed that ``p.remove_constraint(0)`` removes all constraints for the test example, hence the unbounded problem error.\n\n```\nsage: p = MixedIntegerLinearProgram(solver='CPLEX')\nIBM ILOG License Manager: \"IBM ILOG Optimization Suite for Academic Initiative\" is accessing CPLEX 12 with option(s): \"e m b q \".\nsage: x, y = p[0], p[1]\nsage: p.add_constraint(2*x + 3*y, max = 6)\nsage: p.add_constraint(3*x + 2*y, max = 6)\nsage: p.set_objective(x + y + 7)\nsage: p.set_integer(x); p.set_integer(y)\nsage: p.show()\nMaximization:\n  x_0 + x_1 + 7.0\n\nConstraints:\n  2.0 x_0 + 3.0 x_1 <= 6.0\n  3.0 x_0 + 2.0 x_1 <= 6.0\nVariables:\n  x_0 is an integer variable (min=0.0, max=+oo)\n  x_1 is an integer variable (min=0.0, max=+oo)\nsage: p.solve()\n9.0\nsage: p.get_values([x,y])\n[2.0, 0.0]\nsage: p.remove_constraint(0)\nsage: p.show()\nMaximization:\n  x_0 + x_1 + 7.0\n\nConstraints:\nVariables:\n  x_0 is an integer variable (min=0.0, max=+oo)\n  x_1 is an integer variable (min=0.0, max=+oo)\n```",
    "created_at": "2012-04-15T16:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186676",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:43'></a>Ok, I'm now able to install successfully the patch !

Tests are OK with GLPK but not with CPLEX. 

```
sage -t -optional "devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx"
IBM ILOG License Manager: "IBM ILOG Optimization Suite for Academic Initiative" is accessing CPLEX 12 with option(s): "e m b q ".
**********************************************************************
File "/path-to-sage/devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx", line 435:
    sage: p.solve()                                    # optional - CPLEX
Exception raised:
    Traceback (most recent call last):
      File "/path-to-sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/path-to-sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/path-to-sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_9[10]>", line 1, in <module>
        p.solve()                                    # optional - CPLEX###line 435:
    sage: p.solve()                                    # optional - CPLEX
      File "mip.pyx", line 1431, in sage.numerical.mip.MixedIntegerLinearProgram.solve (sage/numerical/mip.c:7747)
      File "cplex_backend.pyx", line 854, in sage.numerical.backends.cplex_backend.CPLEXBackend.solve (sage/numerical/backends/cplex_backend.c:7823)
    MIPSolverException: 'CPLEX: The problem is unbounded'
**********************************************************************
File "/path-to-sage/devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx", line 437:
    sage: p.get_values([x,y])                          # optional - CPLEX
Expected:
    [0.0, 3.0]
Got:
    [2.0, 0.0]
**********************************************************************
1 items had failures:
   2 of  13 in __main__.example_9
***Test Failed*** 2 failures.
For whitespace errors, see the file /home/dcoudert/.sage//tmp/cplex_backend_17001.py
         [1.2 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -optional "devel/sage-myclone/sage/numerical/backends/cplex_backend.pyx"
Total time for all tests: 1.2 seconds
```


I have observed that ``p.remove_constraint(0)`` removes all constraints for the test example, hence the unbounded problem error.

```
sage: p = MixedIntegerLinearProgram(solver='CPLEX')
IBM ILOG License Manager: "IBM ILOG Optimization Suite for Academic Initiative" is accessing CPLEX 12 with option(s): "e m b q ".
sage: x, y = p[0], p[1]
sage: p.add_constraint(2*x + 3*y, max = 6)
sage: p.add_constraint(3*x + 2*y, max = 6)
sage: p.set_objective(x + y + 7)
sage: p.set_integer(x); p.set_integer(y)
sage: p.show()
Maximization:
  x_0 + x_1 + 7.0

Constraints:
  2.0 x_0 + 3.0 x_1 <= 6.0
  3.0 x_0 + 2.0 x_1 <= 6.0
Variables:
  x_0 is an integer variable (min=0.0, max=+oo)
  x_1 is an integer variable (min=0.0, max=+oo)
sage: p.solve()
9.0
sage: p.get_values([x,y])
[2.0, 0.0]
sage: p.remove_constraint(0)
sage: p.show()
Maximization:
  x_0 + x_1 + 7.0

Constraints:
Variables:
  x_0 is an integer variable (min=0.0, max=+oo)
  x_1 is an integer variable (min=0.0, max=+oo)
```



---

archive/issue_comments_186677.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [dcoudert](#comment%3A43):\n> Ok, I'm now able to install successfully the patch !\n\n\nFinally! :-)\n\n> Tests are OK with GLPK but not with CPLEX.\n\n\nI mis-copied a line from Nathann's patch. I've fixed that in the new patch; can you try the new one?\n\nthx a lot\njohn",
    "created_at": "2012-04-15T17:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186677",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:44'></a>Replying to [dcoudert](#comment%3A43):
> Ok, I'm now able to install successfully the patch !


Finally! :-)

> Tests are OK with GLPK but not with CPLEX.


I mis-copied a line from Nathann's patch. I've fixed that in the new patch; can you try the new one?

thx a lot
john



---

archive/issue_comments_186678.json:
```json
{
    "body": "<a id='comment:45'></a>That's much better ! now tests are ok for glpk_backend.pyx and cplex_backend.pyx.\nI can't test coin or gurobi.\n\nHowever, the following test fails:\n\n```\ncompote:/path-to-sage/devel/sage-myclone> ../../sage -t -optional sage/numerical/mip.pyx\nsage -t -optional \"devel/sage-myclone/sage/numerical/mip.pyx\"\nIBM ILOG License Manager: \"IBM ILOG Optimization Suite for Academic Initiative\" is accessing CPLEX 12 with option(s): \"e m b q \".\n**********************************************************************\nFile \"/path-to-sage/devel/sage-myclone/sage/numerical/mip.pyx\", line 1578:\n    sage: p.solver_parameter(\"CPX_PARAM_TILIM\", 60) # optional - CPLEX\nException raised:\n    Traceback (most recent call last):\n      File \"/path-to-sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/path-to-sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/path-to-sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_29[4]>\", line 1, in <module>\n        p.solver_parameter(\"CPX_PARAM_TILIM\", Integer(60)) # optional - CPLEX###line 1578:\n    sage: p.solver_parameter(\"CPX_PARAM_TILIM\", 60) # optional - CPLEX\n      File \"mip.pyx\", line 1599, in sage.numerical.mip.MixedIntegerLinearProgram.solver_parameter (sage/numerical/mip.c:8173)\n      File \"glpk_backend.pyx\", line 1525, in sage.numerical.backends.glpk_backend.GLPKBackend.solver_parameter (sage/numerical/backends/glpk_backend.cpp:9375)\n    KeyError: 'CPX_PARAM_TILIM'\n**********************************************************************\n1 items had failures:\n   1 of   9 in __main__.example_29\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /home/dcoudert/.sage//tmp/mip_25176.py\n         [1.5 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -optional \"devel/sage-myclone/sage/numerical/mip.pyx\"\nTotal time for all tests: 1.5 seconds\n```\nSorry about that.",
    "created_at": "2012-04-15T19:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186678",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:45'></a>That's much better ! now tests are ok for glpk_backend.pyx and cplex_backend.pyx.
I can't test coin or gurobi.

However, the following test fails:

```
compote:/path-to-sage/devel/sage-myclone> ../../sage -t -optional sage/numerical/mip.pyx
sage -t -optional "devel/sage-myclone/sage/numerical/mip.pyx"
IBM ILOG License Manager: "IBM ILOG Optimization Suite for Academic Initiative" is accessing CPLEX 12 with option(s): "e m b q ".
**********************************************************************
File "/path-to-sage/devel/sage-myclone/sage/numerical/mip.pyx", line 1578:
    sage: p.solver_parameter("CPX_PARAM_TILIM", 60) # optional - CPLEX
Exception raised:
    Traceback (most recent call last):
      File "/path-to-sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/path-to-sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/path-to-sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_29[4]>", line 1, in <module>
        p.solver_parameter("CPX_PARAM_TILIM", Integer(60)) # optional - CPLEX###line 1578:
    sage: p.solver_parameter("CPX_PARAM_TILIM", 60) # optional - CPLEX
      File "mip.pyx", line 1599, in sage.numerical.mip.MixedIntegerLinearProgram.solver_parameter (sage/numerical/mip.c:8173)
      File "glpk_backend.pyx", line 1525, in sage.numerical.backends.glpk_backend.GLPKBackend.solver_parameter (sage/numerical/backends/glpk_backend.cpp:9375)
    KeyError: 'CPX_PARAM_TILIM'
**********************************************************************
1 items had failures:
   1 of   9 in __main__.example_29
***Test Failed*** 1 failures.
For whitespace errors, see the file /home/dcoudert/.sage//tmp/mip_25176.py
         [1.5 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -optional "devel/sage-myclone/sage/numerical/mip.pyx"
Total time for all tests: 1.5 seconds
```
Sorry about that.



---

archive/issue_comments_186679.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [dcoudert](#comment%3A45):\n> That's much better ! now tests are ok for glpk_backend.pyx and cplex_backend.pyx.\n\n\nGetting there!\n\n> I can't test coin or gurobi.\n\n\nI've tested Coin. We need Nathann to test gurobi (and maybe he can test coin, too.)\n\n> However, the following test fails:\n\n\nThe error makes sense. and, it's easily fixed, I think. Let me know if the newest patch fixes it.\n\n> Sorry about that.\n\n\nQuite the contrary: **thank you very much! ** I just hope we finish this today!",
    "created_at": "2012-04-15T20:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186679",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:46'></a>Replying to [dcoudert](#comment%3A45):
> That's much better ! now tests are ok for glpk_backend.pyx and cplex_backend.pyx.


Getting there!

> I can't test coin or gurobi.


I've tested Coin. We need Nathann to test gurobi (and maybe he can test coin, too.)

> However, the following test fails:


The error makes sense. and, it's easily fixed, I think. Let me know if the newest patch fixes it.

> Sorry about that.


Quite the contrary: **thank you very much! ** I just hope we finish this today!



---

archive/issue_comments_186680.json:
```json
{
    "body": "<a id='comment:47'></a>The tests are now OK.\n\nI have also pass a tests on the entire sage/numerical directory, and only 3 tests are failing: coin_backend.pyx, gurobi_backend.pyx, and generic_backend.pyx.\n\nalmost done.",
    "created_at": "2012-04-15T20:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186680",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:47'></a>The tests are now OK.

I have also pass a tests on the entire sage/numerical directory, and only 3 tests are failing: coin_backend.pyx, gurobi_backend.pyx, and generic_backend.pyx.

almost done.



---

archive/issue_comments_186681.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Coudert\"",
    "created_at": "2012-04-15T20:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186681",
    "user": "https://github.com/dcoudert"
}
```

Changing reviewer from "" to "David Coudert"



---

archive/issue_comments_186682.json:
```json
{
    "body": "<a id='comment:49'></a>Replying to [dcoudert](#comment%3A47):\n> I have also pass a tests on the entire sage/numerical directory, and only 3 tests are failing: coin_backend.pyx, gurobi_backend.pyx, and generic_backend.pyx.\n> \n> almost done.\n\n\nWhen you run these tests, are you running as `sage -t -optional` or as `sage -t`? These failures would make sense if you were running them as `sage -t -optional`. You should get **no** errors if you leave out `-optional`.",
    "created_at": "2012-04-15T20:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186682",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:49'></a>Replying to [dcoudert](#comment%3A47):
> I have also pass a tests on the entire sage/numerical directory, and only 3 tests are failing: coin_backend.pyx, gurobi_backend.pyx, and generic_backend.pyx.
> 
> almost done.


When you run these tests, are you running as `sage -t -optional` or as `sage -t`? These failures would make sense if you were running them as `sage -t -optional`. You should get **no** errors if you leave out `-optional`.



---

archive/issue_comments_186683.json:
```json
{
    "body": "<a id='comment:50'></a>You are right:\n* I have no error when running sage -t sage/numerical/\n* I have errors with the -optimal flag.",
    "created_at": "2012-04-15T21:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186683",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:50'></a>You are right:
* I have no error when running sage -t sage/numerical/
* I have errors with the -optimal flag.



---

archive/issue_comments_186684.json:
```json
{
    "body": "<a id='comment:51'></a>You mean `-optional`, not `-optimal` :-)\n\nOkay: now we just need Nathann to give it a positive review for Gurobi, and we're done!",
    "created_at": "2012-04-15T22:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186684",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:51'></a>You mean `-optional`, not `-optimal` :-)

Okay: now we just need Nathann to give it a positive review for Gurobi, and we're done!



---

archive/issue_comments_186685.json:
```json
{
    "body": "<a id='comment:52'></a>yes, -optional ;)",
    "created_at": "2012-04-15T22:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186685",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:52'></a>yes, -optional ;)



---

archive/issue_comments_186686.json:
```json
{
    "body": "<a id='comment:53'></a>Hellooooooo !!\n\nSorry for the delay, I am in Austria these days and mostly backpacking, so it is pretty hard to find some time with both my computer and WiFI access `:-)`\n\nThe point is that when I apply you folded patch (but I guess I should try to find out what it contains) I mostly get rejections. I applied before the two patch the current ticket says it depends on : #12736, #12833.\n\n```\n~/sage$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12833/trac_12833.patch\nhg qpush\nadding trac_12833.patch to series file\n~/sage$ hg qpush\napplying trac_12833.patch\nnow at: trac_12833.patch\n~/sage$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12823/trac_12823_rolls_all_into_one.patch\nhg qpush\nadding trac_12823_rolls_all_into_one.patch to series file\n~/sage$ hg qpush\napplying trac_12823_rolls_all_into_one.patch\npatching file sage/numerical/backends/gurobi_backend.pyx\nHunk #1 FAILED at 0\nHunk #2 FAILED at 23\nHunk #4 FAILED at 82\nHunk #5 FAILED at 101\nHunk #6 FAILED at 112\nHunk #7 FAILED at 125\nHunk #8 FAILED at 136\nHunk #9 FAILED at 190\nHunk #10 FAILED at 233\nHunk #11 FAILED at 244\nHunk #12 FAILED at 397\nHunk #13 FAILED at 405\nHunk #14 succeeded at 431 with fuzz 1 (offset 13 lines).\nHunk #15 FAILED at 427\nHunk #18 FAILED at 512\nHunk #19 FAILED at 537\nHunk #20 FAILED at 560\nHunk #21 FAILED at 601\nHunk #22 FAILED at 618\nHunk #23 FAILED at 730\nHunk #24 FAILED at 767\nHunk #25 FAILED at 1011\nHunk #26 FAILED at 1047\nHunk #27 FAILED at 1066\nHunk #28 FAILED at 1086\n24 out of 28 hunks FAILED -- saving rejects to file sage/numerical/backends/gurobi_backend.pyx.rej\npatching file sage/numerical/mip.pyx\nHunk #8 FAILED at 455\nHunk #9 FAILED at 525\nHunk #12 FAILED at 591\nHunk #30 FAILED at 1571\n4 out of 42 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_12823_rolls_all_into_one.patch\n~/sage$ hg qapplied\ntrac_12736_more_solver_options_for_glpk.patch\ntrac_12736.patch\ntrac_12833.patch\ntrac_12823_rolls_all_into_one.patch\n```",
    "created_at": "2012-04-16T21:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186686",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:53'></a>Hellooooooo !!

Sorry for the delay, I am in Austria these days and mostly backpacking, so it is pretty hard to find some time with both my computer and WiFI access `:-)`

The point is that when I apply you folded patch (but I guess I should try to find out what it contains) I mostly get rejections. I applied before the two patch the current ticket says it depends on : #12736, #12833.

```
~/sage$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12833/trac_12833.patch
hg qpush
adding trac_12833.patch to series file
~/sage$ hg qpush
applying trac_12833.patch
now at: trac_12833.patch
~/sage$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/12823/trac_12823_rolls_all_into_one.patch
hg qpush
adding trac_12823_rolls_all_into_one.patch to series file
~/sage$ hg qpush
applying trac_12823_rolls_all_into_one.patch
patching file sage/numerical/backends/gurobi_backend.pyx
Hunk #1 FAILED at 0
Hunk #2 FAILED at 23
Hunk #4 FAILED at 82
Hunk #5 FAILED at 101
Hunk #6 FAILED at 112
Hunk #7 FAILED at 125
Hunk #8 FAILED at 136
Hunk #9 FAILED at 190
Hunk #10 FAILED at 233
Hunk #11 FAILED at 244
Hunk #12 FAILED at 397
Hunk #13 FAILED at 405
Hunk #14 succeeded at 431 with fuzz 1 (offset 13 lines).
Hunk #15 FAILED at 427
Hunk #18 FAILED at 512
Hunk #19 FAILED at 537
Hunk #20 FAILED at 560
Hunk #21 FAILED at 601
Hunk #22 FAILED at 618
Hunk #23 FAILED at 730
Hunk #24 FAILED at 767
Hunk #25 FAILED at 1011
Hunk #26 FAILED at 1047
Hunk #27 FAILED at 1066
Hunk #28 FAILED at 1086
24 out of 28 hunks FAILED -- saving rejects to file sage/numerical/backends/gurobi_backend.pyx.rej
patching file sage/numerical/mip.pyx
Hunk #8 FAILED at 455
Hunk #9 FAILED at 525
Hunk #12 FAILED at 591
Hunk #30 FAILED at 1571
4 out of 42 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_12823_rolls_all_into_one.patch
~/sage$ hg qapplied
trac_12736_more_solver_options_for_glpk.patch
trac_12736.patch
trac_12833.patch
trac_12823_rolls_all_into_one.patch
```



---

archive/issue_comments_186687.json:
```json
{
    "body": "<a id='comment:54'></a>Nathann\n\nReplying to [ncohen](#comment%3A53):\n> Sorry for the delay, I am in Austria these days and mostly backpacking, so it is pretty hard to find some time with both my computer and WiFI access `:-)`\n\n\nHope you're having fun :-)\n\n> The point is that when I apply you folded patch (but I guess I should try to find out what it contains) I mostly get rejections. I applied before the two patch the current ticket says it depends on : #12736, #12833.\n\n\nI'm not surprised. I forgot to test it w/#12833 first.\n\nI can't get #12833 to apply at all on 5.0.beta9, so I'll have to try this at home, later tonight or tomorrow. Bummer. Stay tuned...",
    "created_at": "2012-04-16T22:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186687",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:54'></a>Nathann

Replying to [ncohen](#comment%3A53):
> Sorry for the delay, I am in Austria these days and mostly backpacking, so it is pretty hard to find some time with both my computer and WiFI access `:-)`


Hope you're having fun :-)

> The point is that when I apply you folded patch (but I guess I should try to find out what it contains) I mostly get rejections. I applied before the two patch the current ticket says it depends on : #12736, #12833.


I'm not surprised. I forgot to test it w/#12833 first.

I can't get #12833 to apply at all on 5.0.beta9, so I'll have to try this at home, later tonight or tomorrow. Bummer. Stay tuned...



---

archive/issue_comments_186688.json:
```json
{
    "body": "<a id='comment:55'></a>Okay. I downloaded & build beta 13 on a second computer (the first is a nearly 15 year-old, 32-bit machine, bogged down in testing some other tickets), applied the requisite patches for **all** dependencies listed, and after a lot of tinkering, got it to work.\n\nI then went back & figured out why beta 8 didn't like #12833 --- some sort of whitespace error --- and tested it there, since I have coin installed there. That works, too.\n\nSo Coin & GLPK work on my machines. Someone please test gurobi & cplex again!\n\nAn aside: most of the problems seem to have been caused by whitespace!!! Apparently #12833 fixes some whitespace problems in gurobi and mip that I had also tried to fix in the latest patch for this one. I hadn't tried to fix them before; hence the unpleasant surprise.\n\nI hope this one works...",
    "created_at": "2012-04-17T05:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186688",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:55'></a>Okay. I downloaded & build beta 13 on a second computer (the first is a nearly 15 year-old, 32-bit machine, bogged down in testing some other tickets), applied the requisite patches for **all** dependencies listed, and after a lot of tinkering, got it to work.

I then went back & figured out why beta 8 didn't like #12833 --- some sort of whitespace error --- and tested it there, since I have coin installed there. That works, too.

So Coin & GLPK work on my machines. Someone please test gurobi & cplex again!

An aside: most of the problems seem to have been caused by whitespace!!! Apparently #12833 fixes some whitespace problems in gurobi and mip that I had also tried to fix in the latest patch for this one. I hadn't tried to fix them before; hence the unpleasant surprise.

I hope this one works...



---

archive/issue_comments_186689.json:
```json
{
    "body": "Changing reviewer from \"David Coudert\" to \"David Coudert, Nathann Cohen\"",
    "created_at": "2012-04-17T05:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186689",
    "user": "https://github.com/johnperry-math"
}
```

Changing reviewer from "David Coudert" to "David Coudert, Nathann Cohen"



---

archive/issue_comments_186690.json:
```json
{
    "body": "<a id='comment:56'></a>Hellooooooooooooo !!!\n\nWell, this one seems well oiled `:-)`\n\n```\n~/sage/numerical/backends$ sage -t -optional coin_backend.pyx glpk_backend.pyx gurobi_backend.pyx cplex_backend.pyx \nsage -t -optional \"devel/sage-2/sage/numerical/backends/coin_backend.pyx\"\n\t [1.2 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/cplex_backend.pyx\"\n\t [1.2 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/glpk_backend.pyx\"\n\t [1.2 s]\nsage -t -optional \"devel/sage-2/sage/numerical/backends/gurobi_backend.pyx\"\n\t [1.4 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 5.0 seconds\n```\n\nAnd all tests pass in mip.pyx, graph, dgraph, generic_graph. Sooooo... I guess the patch is now positively reviewed `:-)`\n\nNathann",
    "created_at": "2012-04-17T06:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186690",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:56'></a>Hellooooooooooooo !!!

Well, this one seems well oiled `:-)`

```
~/sage/numerical/backends$ sage -t -optional coin_backend.pyx glpk_backend.pyx gurobi_backend.pyx cplex_backend.pyx 
sage -t -optional "devel/sage-2/sage/numerical/backends/coin_backend.pyx"
	 [1.2 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/cplex_backend.pyx"
	 [1.2 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/glpk_backend.pyx"
	 [1.2 s]
sage -t -optional "devel/sage-2/sage/numerical/backends/gurobi_backend.pyx"
	 [1.4 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 5.0 seconds
```

And all tests pass in mip.pyx, graph, dgraph, generic_graph. Sooooo... I guess the patch is now positively reviewed `:-)`

Nathann



---

archive/issue_comments_186691.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-04-17T06:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186691",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_186692.json:
```json
{
    "body": "<a id='comment:57'></a>Yessss! :-) It only took... uhm, how many tries? X-D",
    "created_at": "2012-04-17T06:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186692",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:57'></a>Yessss! :-) It only took... uhm, how many tries? X-D



---

archive/issue_comments_186693.json:
```json
{
    "body": "<a id='comment:58'></a>Ahahah..   Well, it is still funnier like that compared with times when it takes several months before a ticket gets reviewed `:-)`\n\nNathann",
    "created_at": "2012-04-17T07:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186693",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:58'></a>Ahahah..   Well, it is still funnier like that compared with times when it takes several months before a ticket gets reviewed `:-)`

Nathann



---

archive/issue_comments_186694.json:
```json
{
    "body": "<a id='comment:59'></a>(This being said, the ticket still depends on #12833 `^^;`)",
    "created_at": "2012-04-17T07:33:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186694",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:59'></a>(This being said, the ticket still depends on #12833 `^^;`)



---

archive/issue_comments_186695.json:
```json
{
    "body": "<a id='comment:60'></a>Hello,\n\nI don't need patch #12833 to apply this patch and all tests are OK (sage -t sage/numerical, and sage -t -optional sage/numerical/backends/glpk_backend.pyx and same for cplex).\nSo we could remove the dependency.\n\nD.",
    "created_at": "2012-04-17T07:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186695",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:60'></a>Hello,

I don't need patch #12833 to apply this patch and all tests are OK (sage -t sage/numerical, and sage -t -optional sage/numerical/backends/glpk_backend.pyx and same for cplex).
So we could remove the dependency.

D.



---

archive/issue_events_034906.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-17T22:23:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12823#event-34906"
}
```



---

archive/issue_comments_186696.json:
```json
{
    "body": "Changing work_issues from \"failing doctests\" to \"\"",
    "created_at": "2012-04-17T22:23:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186696",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "failing doctests" to ""



---

archive/issue_comments_186697.json:
```json
{
    "body": "Changing author from \"john_perry, ncohen\" to \"John Perry, Nathann Cohen\"",
    "created_at": "2012-05-07T19:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186697",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "john_perry, ncohen" to "John Perry, Nathann Cohen"



---

archive/issue_comments_186698.json:
```json
{
    "body": "<a id='comment:63'></a>The patch needs a proper commit message.",
    "created_at": "2012-05-07T19:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186698",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:63'></a>The patch needs a proper commit message.



---

archive/issue_comments_186699.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-07T19:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186699",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_186700.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-05-09T07:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186700",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_186701.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-09T09:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186701",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_186702.json:
```json
{
    "body": "<a id='comment:65'></a>This needs to be rebased to sage-5.0.rc0:\n\n```\napplying /padic/scratch/jdemeyer/merger/patches/trac_12823_rolls_all_into_one.patch\npatching file sage/numerical/mip.pyx\nHunk #16 FAILED at 809\nHunk #17 FAILED at 852\nHunk #19 FAILED at 969\n3 out of 35 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej\nabort: patch failed to apply\n```",
    "created_at": "2012-05-09T09:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186702",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>This needs to be rebased to sage-5.0.rc0:

```
applying /padic/scratch/jdemeyer/merger/patches/trac_12823_rolls_all_into_one.patch
patching file sage/numerical/mip.pyx
Hunk #16 FAILED at 809
Hunk #17 FAILED at 852
Hunk #19 FAILED at 969
3 out of 35 hunks FAILED -- saving rejects to file sage/numerical/mip.pyx.rej
abort: patch failed to apply
```



---

archive/issue_comments_186703.json:
```json
{
    "body": "Attachment [trac_12823_rolls_all_into_one.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_rolls_all_into_one.patch) by @nathanncohen created at 2012-05-09 10:28:05",
    "created_at": "2012-05-09T10:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186703",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_12823_rolls_all_into_one.patch](tarball://root/attachments/some-uuid/ticket12823/trac_12823_rolls_all_into_one.patch) by @nathanncohen created at 2012-05-09 10:28:05



---

archive/issue_comments_186704.json:
```json
{
    "body": "<a id='comment:66'></a>Patch updated ! `;-)`\n\nNathann",
    "created_at": "2012-05-09T10:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186704",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:66'></a>Patch updated ! `;-)`

Nathann



---

archive/issue_comments_186705.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-05-09T10:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186705",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_186706.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-23T21:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186706",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_034907.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:32:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12823#event-34907"
}
```



---

archive/issue_comments_186707.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.1.beta1\"",
    "created_at": "2012-05-23T21:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12823",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12823#issuecomment-186707",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.1.beta1"
