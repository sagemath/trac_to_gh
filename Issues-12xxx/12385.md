# Issue 12385: Questionable semantics of DiGraph().all_simple_paths

archive/issues_012213.json:
```json
{
    "assignees": [
        "https://github.com/kini"
    ],
    "body": "See [this sage-support thread](https://groups.google.com/d/topic/sage-support/zVmqCIv82zI/discussion).\n\nThe docstring of `DiGraph().all_simple_paths` starts with this paragraph:\n\n```\n       Returns a list of all the simple paths of self starting with one of\n       the given vertices. A path is simple if no vertex occurs twice in\n       it except possibly the starting and ending one. The paths are\n       enumerated in increasing length order.\n```\n\nIn short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.\n\nAnother possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a \"simple cycle\" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.\n\nIncidentally, a definition that matches what is given in the first paragraph above is this: a \"simple path\" in a directed graph is a sequence of arcs such that the head of each arc is the tail of the next arc in the sequence, and no two arcs share the same head or the same tail.\n\n---\n\nApply to `$SAGE_ROOT/devel/sage`:\n1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)\n2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)\n3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)\n4. [attachment: trac_12385-all-simple-paths.3.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)\n\nCC:  @nathanncohen @sagetrac-abmasse\n\nKeywords: **digraphs graphs all_simple_paths**\n\nComponent: **graph theory**\n\nAuthor: **Keshav Kini**\n\nReviewer: **Nathann Cohen**\n\nMerged: **sage-5.0.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12385_\n\n",
    "closed_at": "2012-02-14T14:22:49Z",
    "created_at": "2012-01-30T04:10:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Questionable semantics of DiGraph().all_simple_paths",
    "type": "issue",
    "updated_at": "2012-02-14T14:22:49Z",
    "url": "https://github.com/sagemath/sage/issues/12385",
    "user": "https://github.com/kini"
}
```
See [this sage-support thread](https://groups.google.com/d/topic/sage-support/zVmqCIv82zI/discussion).

The docstring of `DiGraph().all_simple_paths` starts with this paragraph:

```
       Returns a list of all the simple paths of self starting with one of
       the given vertices. A path is simple if no vertex occurs twice in
       it except possibly the starting and ending one. The paths are
       enumerated in increasing length order.
```

In short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.

Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a "simple cycle" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.

Incidentally, a definition that matches what is given in the first paragraph above is this: a "simple path" in a directed graph is a sequence of arcs such that the head of each arc is the tail of the next arc in the sequence, and no two arcs share the same head or the same tail.

---

Apply to `$SAGE_ROOT/devel/sage`:
1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)
2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)
3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)
4. [attachment: trac_12385-all-simple-paths.3.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)

CC:  @nathanncohen @sagetrac-abmasse

Keywords: **digraphs graphs all_simple_paths**

Component: **graph theory**

Author: **Keshav Kini**

Reviewer: **Nathann Cohen**

Merged: **sage-5.0.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/12385_





---

archive/issue_events_167359.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167359"
}
```



---

archive/issue_events_167360.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167360"
}
```



---

archive/issue_events_167361.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167361"
}
```



---

archive/issue_events_167362.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167362"
}
```



---

archive/issue_events_167363.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167363"
}
```



---

archive/issue_events_167364.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:10:13Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "subject": "https://github.com/kini",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167364"
}
```



---

archive/issue_comments_135316.json:
```json
{
    "body": "Author: **Keshav Kini**",
    "created_at": "2012-01-30T04:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135316",
    "user": "https://github.com/kini"
}
```

Author: **Keshav Kini**



---

archive/issue_comments_135317.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHere's a patch which implements the first suggestion in the ticket description. The original ticket seems to be #8273 so I'm CCing the author and reviewer of that ticket.\n\nDoing a `make ptestlong` on this patch now, though the file in question passes and `search_src()` tells me this function is not used by any other code, so I don't expect any doctest problems.",
    "created_at": "2012-01-30T04:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135317",
    "user": "https://github.com/kini"
}
```

<div id="comment:1" align="right">comment:1</div>

Here's a patch which implements the first suggestion in the ticket description. The original ticket seems to be #8273 so I'm CCing the author and reviewer of that ticket.

Doing a `make ptestlong` on this patch now, though the file in question passes and `search_src()` tells me this function is not used by any other code, so I don't expect any doctest problems.



---

archive/issue_comments_135318.json:
```json
{
    "body": "apply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-30T04:15:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135318",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_135319.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n See [this sage-support thread](https://groups.google.com/d/topic/sage-support/zVmqCIv82zI/discussion).\n \n-The docstring of `Graph().all_simple_paths` starts with this paragraph:\n+The docstring of `DiGraph().all_simple_paths` starts with this paragraph:\n \n ```\n        Returns a list of all the simple paths of self starting with one of\n@@ -9,6 +9,6 @@\n        enumerated in increasing length order.\n ```\n \n-In short, the `Graph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.\n+In short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.\n \n Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a \"simple cycle\" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.\n``````\n",
    "created_at": "2012-01-30T04:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135319",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 See [this sage-support thread](https://groups.google.com/d/topic/sage-support/zVmqCIv82zI/discussion).
 
-The docstring of `Graph().all_simple_paths` starts with this paragraph:
+The docstring of `DiGraph().all_simple_paths` starts with this paragraph:
 
 ```
        Returns a list of all the simple paths of self starting with one of
@@ -9,6 +9,6 @@
        enumerated in increasing length order.
 ```
 
-In short, the `Graph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.
+In short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.
 
 Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a "simple cycle" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.
``````




---

archive/issue_events_167365.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T04:24:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "title_is": "Questionable semantics of DiGraph().all_simple_paths",
    "title_was": "Questionable semantics of Graph().all_simple_paths",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167365"
}
```



---

archive/issue_comments_135320.json:
```json
{
    "body": "Changed keywords from **graphs all_simple_paths** to **digraphs graphs all_simple_paths**",
    "created_at": "2012-01-30T04:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135320",
    "user": "https://github.com/kini"
}
```

Changed keywords from **graphs all_simple_paths** to **digraphs graphs all_simple_paths**



---

archive/issue_comments_135321.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[trac_12385-all-simple-paths.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)**\n\nWhoops, sorry, this is a digraph method, not a graph method. I mistitled the ticket.",
    "created_at": "2012-01-30T04:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135321",
    "user": "https://github.com/kini"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[trac_12385-all-simple-paths.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)**

Whoops, sorry, this is a digraph method, not a graph method. I mistitled the ticket.



---

archive/issue_events_167366.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-30T05:07:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167366"
}
```



---

archive/issue_comments_135322.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n`make ptestlong` passes. Comments?",
    "created_at": "2012-01-30T05:07:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135322",
    "user": "https://github.com/kini"
}
```

<div id="comment:3" align="right">comment:3</div>

`make ptestlong` passes. Comments?



---

archive/issue_comments_135323.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nFirst that what you are doing is totally right, then that I will try to review the ticket today `:-)`\n\nNathann",
    "created_at": "2012-01-30T10:31:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135323",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

First that what you are doing is totally right, then that I will try to review the ticket today `:-)`

Nathann



---

archive/issue_comments_135324.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHellooooo !!!\n\nHmmm... I was a bit worried at your path.count(path[-1]) `^^;`\n\nWhat do you think of the alternative version I attach ? In this one I check whether the path is a cycle *before* adding it to the queue. This way a \"neighbor in path\" is sufficient.\n\nI also do not understand why you removed the \"if trivial\" from before the loop to put it inside. It would be a waste to \"test\" trivial at each loop, and also to test len(path) > 1 when we know it will always be true after some step, wouldn't it ?\n\nTell me what you think `:-)`\n\nNathann",
    "created_at": "2012-01-30T12:14:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135324",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:5" align="right">comment:5</div>

Hellooooo !!!

Hmmm... I was a bit worried at your path.count(path[-1]) `^^;`

What do you think of the alternative version I attach ? In this one I check whether the path is a cycle *before* adding it to the queue. This way a "neighbor in path" is sufficient.

I also do not understand why you removed the "if trivial" from before the loop to put it inside. It would be a waste to "test" trivial at each loop, and also to test len(path) > 1 when we know it will always be true after some step, wouldn't it ?

Tell me what you think `:-)`

Nathann



---

archive/issue_comments_135325.json:
```json
{
    "body": "Attachment: **[trac_12385_review.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)**",
    "created_at": "2012-01-30T12:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135325",
    "user": "https://github.com/nathanncohen"
}
```

Attachment: **[trac_12385_review.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)**



---

archive/issue_comments_135326.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHi, Keshav and Nathann,\n\nThank you, Keshav, for finding that bug, I'm sorry we missed it the first time.\n\nSince Nathann has already started the review, I'll let him finish it (I don't even have the last Sage version installed on my computer).\n\nBy the way, the title \"Questionable semantics of DiGraph().all_simple_paths\" could be replaced by \"Wrong semantics of DiGraph().all_simple_paths\" :-)\n\nAlexandre",
    "created_at": "2012-01-30T13:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135326",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<div id="comment:6" align="right">comment:6</div>

Hi, Keshav and Nathann,

Thank you, Keshav, for finding that bug, I'm sorry we missed it the first time.

Since Nathann has already started the review, I'll let him finish it (I don't even have the last Sage version installed on my computer).

By the way, the title "Questionable semantics of DiGraph().all_simple_paths" could be replaced by "Wrong semantics of DiGraph().all_simple_paths" :-)

Alexandre



---

archive/issue_comments_135327.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@nathanncohen](#comment:5):\n> Hmmm... I was a bit worried at your path.count(path[-1]) `^^;`\n\nCan you explain? I think the same expression was used in the old code.\n\n> What do you think of the alternative version I attach ? In this one I check whether the path is a cycle *before* adding it to the queue. This way a \"neighbor in path\" is sufficient.\n\nNice! It's definitely better. I don't know why I avoided touching that last loop. Of course that is the better place to do this logic.\n\n> I also do not understand why you removed the \"if trivial\" from before the loop to put it inside. It would be a waste to \"test\" trivial at each loop, and also to test len(path) > 1 when we know it will always be true after some step, wouldn't it ?\n\nWell, part of it was a mistake - I meant to put the check for `trivial` after the check for `len(path)`. Because of the lazy evaluation of boolean operators in Python (`a and b` skips checking `b` if `a` is false, etc.), this would still make `trivial` be evaluated only once, and would reduce the number of `yield` statements in the code, making it \"easier to read\", theoretically. Also I made it so that `len(path)` would only be checked for each path with a desired endpoint, not every single path.\n\nBut you're right, it's possible to make this better by moving the condition check in the `while` loop to somewhere in the middle of the body rather than at the top. Patch attached! (Or will be after I post this comment.) I made some other changes too, such as inverting the loop and if/else in your code to check `simple` on every good incomplete path rather than every candidate extension. It would be best if `simple` and `trivial` could be declared as constant so that Python could optimize away all these checks. Or maybe it already knows this, since we don't assign any values to those variables... how smart is Python, anyway? I think I am getting stuck in the premature optimization trap... :P",
    "created_at": "2012-01-31T05:03:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135327",
    "user": "https://github.com/kini"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@nathanncohen](#comment:5):
> Hmmm... I was a bit worried at your path.count(path[-1]) `^^;`

Can you explain? I think the same expression was used in the old code.

> What do you think of the alternative version I attach ? In this one I check whether the path is a cycle *before* adding it to the queue. This way a "neighbor in path" is sufficient.

Nice! It's definitely better. I don't know why I avoided touching that last loop. Of course that is the better place to do this logic.

> I also do not understand why you removed the "if trivial" from before the loop to put it inside. It would be a waste to "test" trivial at each loop, and also to test len(path) > 1 when we know it will always be true after some step, wouldn't it ?

Well, part of it was a mistake - I meant to put the check for `trivial` after the check for `len(path)`. Because of the lazy evaluation of boolean operators in Python (`a and b` skips checking `b` if `a` is false, etc.), this would still make `trivial` be evaluated only once, and would reduce the number of `yield` statements in the code, making it "easier to read", theoretically. Also I made it so that `len(path)` would only be checked for each path with a desired endpoint, not every single path.

But you're right, it's possible to make this better by moving the condition check in the `while` loop to somewhere in the middle of the body rather than at the top. Patch attached! (Or will be after I post this comment.) I made some other changes too, such as inverting the loop and if/else in your code to check `simple` on every good incomplete path rather than every candidate extension. It would be best if `simple` and `trivial` could be declared as constant so that Python could optimize away all these checks. Or maybe it already knows this, since we don't assign any values to those variables... how smart is Python, anyway? I think I am getting stuck in the premature optimization trap... :P



---

archive/issue_comments_135328.json:
```json
{
    "body": "Attachment: **[trac_12385-all-simple-paths.2.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)**\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-31T05:04:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135328",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_12385-all-simple-paths.2.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)**

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_135329.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,10 @@\n In short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.\n \n Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a \"simple cycle\" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.\n+\n+---\n+\n+Apply to `$SAGE_ROOT/devel/sage`:\n+1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)\n+2. [attachment: trac_12385_review.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)\n+3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)\n``````\n",
    "created_at": "2012-01-31T05:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135329",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,10 @@
 In short, the `DiGraph().all_simple_paths` function deems paths of the form `[a, b, c, b]` to be simple. This is not true according to the generally accepted definition of a simple path. I suspect the intent of the author was to allow paths of the form `[b, c, b]` (i.e. paths which are actually cycles), which seems reasonable.
 
 Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a "simple cycle" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.
+
+---
+
+Apply to `$SAGE_ROOT/devel/sage`:
+1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)
+2. [attachment: trac_12385_review.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)
+3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)
``````




---

archive/issue_comments_135330.json:
```json
{
    "body": "Attachment: **[trac_12385_review.2.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)**\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-31T05:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135330",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_12385_review.2.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)**

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_135331.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,5 +17,5 @@\n \n Apply to `$SAGE_ROOT/devel/sage`:\n 1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)\n-2. [attachment: trac_12385_review.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)\n+2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)\n 3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)\n``````\n",
    "created_at": "2012-01-31T05:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135331",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,5 +17,5 @@
 
 Apply to `$SAGE_ROOT/devel/sage`:
 1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)
-2. [attachment: trac_12385_review.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.patch.gz)
+2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)
 3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)
``````




---

archive/issue_comments_135332.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYour commit message was weird so I fixed it :)",
    "created_at": "2012-01-31T05:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135332",
    "user": "https://github.com/kini"
}
```

<div id="comment:9" align="right">comment:9</div>

Your commit message was weird so I fixed it :)



---

archive/issue_comments_135333.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nBTW, thanks Alexandre for writing the code in the first place :)",
    "created_at": "2012-01-31T06:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135333",
    "user": "https://github.com/kini"
}
```

<div id="comment:10" align="right">comment:10</div>

BTW, thanks Alexandre for writing the code in the first place :)



---

archive/issue_comments_135334.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,6 +13,8 @@\n \n Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a \"simple cycle\" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.\n \n+Incidentally, a definition that matches what is given in the first paragraph above is this: a \"simple path\" in a directed graph is a sequence of arcs such that the head of each arc is the tail of the next arc in the sequence, and no two arcs share the same head or the same tail.\n+\n ---\n \n Apply to `$SAGE_ROOT/devel/sage`:\n``````\n",
    "created_at": "2012-01-31T06:12:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135334",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,6 +13,8 @@
 
 Another possibility would be to use the definition found on Wikipedia, namely that a simple path must not have *any* repeated vertices, and that a "simple cycle" is a path whose first vertex is its last vertex but has no other vertex repetitions. In this case the function should exclude both paths of the form `[a, b, c, b]` and paths of the form `[b, c, b]`. But I don't see that this is very useful. The function allows you to specify sets of starting and ending points for the paths you want returned, and if you specify non-disjoint sets, you are likely asking for cycles to be included.
 
+Incidentally, a definition that matches what is given in the first paragraph above is this: a "simple path" in a directed graph is a sequence of arcs such that the head of each arc is the tail of the next arc in the sequence, and no two arcs share the same head or the same tail.
+
 ---
 
 Apply to `$SAGE_ROOT/devel/sage`:
``````




---

archive/issue_comments_135335.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere's a documentation patch which changes the stated definition of simple paths as well (to the one I added to the description). I also took the opportunity to enforce PEP 8 in the functions I touched, with the exception of doctest input lines (because of #10458 which I really need to get back to one of these days...). Patch below!",
    "created_at": "2012-01-31T12:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135335",
    "user": "https://github.com/kini"
}
```

<div id="comment:12" align="right">comment:12</div>

Here's a documentation patch which changes the stated definition of simple paths as well (to the one I added to the description). I also took the opportunity to enforce PEP 8 in the functions I touched, with the exception of doctest input lines (because of #10458 which I really need to get back to one of these days...). Patch below!



---

archive/issue_comments_135336.json:
```json
{
    "body": "Attachment: **[trac_12385-all-simple-paths.3.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)**\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-31T13:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135336",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_12385-all-simple-paths.3.patch.gz](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)**

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_135337.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,4 @@\n 1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)\n 2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)\n 3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)\n+4. [attachment: trac_12385-all-simple-paths.3.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)\n``````\n",
    "created_at": "2012-01-31T13:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135337",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,4 @@
 1. [attachment: trac_12385-all-simple-paths.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.patch.gz)
 2. [attachment: trac_12385_review.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385_review.2.patch.gz)
 3. [attachment: trac_12385-all-simple-paths.2.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.2.patch.gz)
+4. [attachment: trac_12385-all-simple-paths.3.patch](https://github.com/sagemath/sage/files/ticket12385/trac_12385-all-simple-paths.3.patch.gz)
``````




---

archive/issue_comments_135338.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWeird loop, but it works `:-)`\n\nIf you are are also ok with it, you can set the ticket to \"positive_review\" !\n\nNathann",
    "created_at": "2012-01-31T18:02:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135338",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:14" align="right">comment:14</div>

Weird loop, but it works `:-)`

If you are are also ok with it, you can set the ticket to "positive_review" !

Nathann



---

archive/issue_comments_135339.json:
```json
{
    "body": "Reviewer: **Nathann Cohen**",
    "created_at": "2012-01-31T18:44:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135339",
    "user": "https://github.com/kini"
}
```

Reviewer: **Nathann Cohen**



---

archive/issue_comments_135340.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI wrote it, so I guess I'm OK with it :) Thanks!",
    "created_at": "2012-01-31T18:44:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135340",
    "user": "https://github.com/kini"
}
```

<div id="comment:15" align="right">comment:15</div>

I wrote it, so I guess I'm OK with it :) Thanks!



---

archive/issue_events_167367.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-31T18:44:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167367"
}
```



---

archive/issue_events_167368.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-01-31T18:44:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167368"
}
```



---

archive/issue_comments_135341.json:
```json
{
    "body": "Merged: **sage-5.0.beta4**",
    "created_at": "2012-02-14T14:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12385#issuecomment-135341",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.0.beta4**



---

archive/issue_events_167369.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-14T14:22:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167369"
}
```



---

archive/issue_events_167370.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-14T14:22:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12385",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12385#event-167370"
}
```
