# Issue 12587: simplicial complexes lack hash function

archive/issues_012415.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "Simplicial complexes are lacking a proper hash function. See the example below.\n\n```\nsage: S = SimplicialComplex([[]]); S\nSimplicial complex with vertex set () and facets {()}\nsage: hash(S)\n-3899221226149827755\nsage: S.__hash__??\nSource:\n    def __hash__(self):\n        return hash(self.__repr__())\n```\n\n---\n\nApply:\n\n- [attachment: trac_12587-simplicial_complex_hash-ts.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)\n- [attachment: trac_12587-simplicial_complex_hash_review-cs.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)\n- [attachment: trac_12587-ref-jhp.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)\n\nDepends on #13226\nDepends on #13244\nDepends on #13590\n\nCC:  @sagetrac-sage-combinat\n\nComponent: **combinatorics**\n\nAuthor: **Travis Scrimshaw**\n\nReviewer: **Christian Stump, John Palmieri**\n\nMerged: **sage-5.6.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12587_\n\n",
    "closed_at": "2012-12-21T09:31:20Z",
    "created_at": "2012-02-26T12:21:04Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "simplicial complexes lack hash function",
    "type": "issue",
    "updated_at": "2013-01-02T14:53:10Z",
    "url": "https://github.com/sagemath/sage/issues/12587",
    "user": "https://github.com/sagetrac-vpilaud"
}
```
Simplicial complexes are lacking a proper hash function. See the example below.

```
sage: S = SimplicialComplex([[]]); S
Simplicial complex with vertex set () and facets {()}
sage: hash(S)
-3899221226149827755
sage: S.__hash__??
Source:
    def __hash__(self):
        return hash(self.__repr__())
```

---

Apply:

- [attachment: trac_12587-simplicial_complex_hash-ts.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)
- [attachment: trac_12587-simplicial_complex_hash_review-cs.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)
- [attachment: trac_12587-ref-jhp.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)

Depends on #13226
Depends on #13244
Depends on #13590

CC:  @sagetrac-sage-combinat

Component: **combinatorics**

Author: **Travis Scrimshaw**

Reviewer: **Christian Stump, John Palmieri**

Merged: **sage-5.6.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/12587_





---

archive/issue_events_171033.json:
```json
{
    "actor": "https://github.com/sagetrac-vpilaud",
    "created_at": "2012-02-26T12:21:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171033"
}
```



---

archive/issue_events_171034.json:
```json
{
    "actor": "https://github.com/sagetrac-vpilaud",
    "created_at": "2012-02-26T12:21:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171034"
}
```



---

archive/issue_events_171035.json:
```json
{
    "actor": "https://github.com/sagetrac-vpilaud",
    "created_at": "2012-02-26T12:21:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171035"
}
```



---

archive/issue_events_171036.json:
```json
{
    "actor": "https://github.com/sagetrac-vpilaud",
    "created_at": "2012-02-26T12:21:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171036"
}
```



---

archive/issue_events_171037.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2012-02-26T12:21:04Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "subject": "https://github.com/sagetrac-vpilaud",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171037"
}
```



---

archive/issue_events_171038.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-08-17T04:13:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171038"
}
```



---

archive/issue_events_171039.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-08-17T04:13:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171039"
}
```



---

archive/issue_comments_139719.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSince SimplicialComplex is mutable, the hash function must depend on something immutable. Because of this, I would like for it to be handled like Graph and throw a TypeError. However there are many dependencies on SimplicialComplex being hashable, so my thought behind setting this to wontfix is that repr is the only immutable part of the class.",
    "created_at": "2012-08-17T04:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139719",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:1" align="right">comment:1</div>

Since SimplicialComplex is mutable, the hash function must depend on something immutable. Because of this, I would like for it to be handled like Graph and throw a TypeError. However there are many dependencies on SimplicialComplex being hashable, so my thought behind setting this to wontfix is that repr is the only immutable part of the class.



---

archive/issue_comments_139720.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nWhy not instead modify the `SimplicialComplex` class so that it is immutable?",
    "created_at": "2012-08-17T05:43:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139720",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

Why not instead modify the `SimplicialComplex` class so that it is immutable?



---

archive/issue_events_171040.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-17T09:44:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171040"
}
```



---

archive/issue_events_171041.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-17T09:44:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171041"
}
```



---

archive/issue_events_171042.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-17T09:44:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171042"
}
```



---

archive/issue_events_171043.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-17T09:44:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171043"
}
```



---

archive/issue_comments_139721.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nBeing mutable and hashable is definetly a bug. See [1].\n\nI don't understand what you mean with repr is the only immutable part, because it may change when the object changes.\n\n[1] http://docs.python.org/glossary.html#term-hashable",
    "created_at": "2012-08-17T09:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139721",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:3" align="right">comment:3</div>

Being mutable and hashable is definetly a bug. See [1].

I don't understand what you mean with repr is the only immutable part, because it may change when the object changes.

[1] http://docs.python.org/glossary.html#term-hashable



---

archive/issue_events_171044.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-17T09:44:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171044"
}
```



---

archive/issue_comments_139722.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@sagetrac-sluther](#comment%3A3):\n> Being mutable and hashable is definetly a bug. See [1].\n> \n> I don't understand what you mean with repr is the only immutable part, because it may change when the object changes.\n> \n> [1] http://docs.python.org/glossary.html#term-hashable\n\nYou're correct. I forgot that repr outputs the facets.\n\nHowever I'm not in favor of making SimplicialComplex an immutable object outright since it contains mutators and there are inductive constructions which would require you to build copies. For example, suppose you had an algorithm which built a simplicial complex facet by facet, at each step you would need to clone the SimplicialComplex object in the mutator. Thus extra memory handling and multiple transient objects.\n\nPerhaps we should do something closer to ClonableArray and have an attribute _is_mutable which we set to True when `__hash__()` is called and in any mutators, we do something of the following:\n\n```\nif _is_mutable:\n    raise TypeError, \"This simplicial complex is no longer mutable\"\n```\nThus making it immutable as soon as it becomes hashed?\n\nAlso we'd have\n\n```\n__hash__(self):\n    _is_mutable = True\n    return hash(self.facets())\n```\n\nYour thoughts?",
    "created_at": "2012-08-17T16:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139722",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@sagetrac-sluther](#comment%3A3):
> Being mutable and hashable is definetly a bug. See [1].
> 
> I don't understand what you mean with repr is the only immutable part, because it may change when the object changes.
> 
> [1] http://docs.python.org/glossary.html#term-hashable

You're correct. I forgot that repr outputs the facets.

However I'm not in favor of making SimplicialComplex an immutable object outright since it contains mutators and there are inductive constructions which would require you to build copies. For example, suppose you had an algorithm which built a simplicial complex facet by facet, at each step you would need to clone the SimplicialComplex object in the mutator. Thus extra memory handling and multiple transient objects.

Perhaps we should do something closer to ClonableArray and have an attribute _is_mutable which we set to True when `__hash__()` is called and in any mutators, we do something of the following:

```
if _is_mutable:
    raise TypeError, "This simplicial complex is no longer mutable"
```
Thus making it immutable as soon as it becomes hashed?

Also we'd have

```
__hash__(self):
    _is_mutable = True
    return hash(self.facets())
```

Your thoughts?



---

archive/issue_comments_139723.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@tscrim](#comment%3A4):\n> Perhaps we should do something closer to ClonableArray and have an attribute _is_mutable which we set to True when `__hash__()` is called and in any mutators, we do something of the following:\n> \n> ```\n> if _is_mutable:\n>     raise TypeError, \"This simplicial complex is no longer mutable\"\n> ```\n> Thus making it immutable as soon as it becomes hashed?\n> \n> Also we'd have\n> \n> ```\n> __hash__(self):\n>     _is_mutable = True\n>     return hash(self.facets())\n> ```\n> \n> Your thoughts?\n\nI don't like this idea because it violoates the principle of least suprise. For example the question if an object can be modified depends upon the question if it has been added into a set or not. \nBetter add an explicit method that sets this attribute.",
    "created_at": "2012-08-17T17:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139723",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@tscrim](#comment%3A4):
> Perhaps we should do something closer to ClonableArray and have an attribute _is_mutable which we set to True when `__hash__()` is called and in any mutators, we do something of the following:
> 
> ```
> if _is_mutable:
>     raise TypeError, "This simplicial complex is no longer mutable"
> ```
> Thus making it immutable as soon as it becomes hashed?
> 
> Also we'd have
> 
> ```
> __hash__(self):
>     _is_mutable = True
>     return hash(self.facets())
> ```
> 
> Your thoughts?

I don't like this idea because it violoates the principle of least suprise. For example the question if an object can be modified depends upon the question if it has been added into a set or not. 
Better add an explicit method that sets this attribute.



---

archive/issue_comments_139724.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@sagetrac-sluther](#comment%3A5):\n> I don't like this idea because it violoates the principle of least suprise. For example the question if an object can be modified depends upon the question if it has been added into a set or not. \n> Better add an explicit method that sets this attribute.\n\nGood point. Then how about this?\n\n```\ndef set_immutable(self):\n    self._is_mutable = False\n\ndef __hash__(self):\n    if not _is_mutable:\n        raise TypeError, \"This simplicial complex must be set to immutable by calling set_immutable()\"\n    return hash(self.facets())\n```",
    "created_at": "2012-08-17T19:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139724",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@sagetrac-sluther](#comment%3A5):
> I don't like this idea because it violoates the principle of least suprise. For example the question if an object can be modified depends upon the question if it has been added into a set or not. 
> Better add an explicit method that sets this attribute.

Good point. Then how about this?

```
def set_immutable(self):
    self._is_mutable = False

def __hash__(self):
    if not _is_mutable:
        raise TypeError, "This simplicial complex must be set to immutable by calling set_immutable()"
    return hash(self.facets())
```



---

archive/issue_comments_139725.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@tscrim](#comment%3A6):\n> Good point. Then how about this?\n> \n> ```\n> def set_immutable(self):\n>     self._is_mutable = False\n> \n> def __hash__(self):\n>     if not _is_mutable:\n>         raise TypeError, \"This simplicial complex must be set to immutable by calling set_immutable()\"\n>     return hash(self.facets())\n> ```\n\nFine, just be careful with not reversing the meaning of _is_mutable like in `__hash__`.",
    "created_at": "2012-08-17T20:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139725",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@tscrim](#comment%3A6):
> Good point. Then how about this?
> 
> ```
> def set_immutable(self):
>     self._is_mutable = False
> 
> def __hash__(self):
>     if not _is_mutable:
>         raise TypeError, "This simplicial complex must be set to immutable by calling set_immutable()"
>     return hash(self.facets())
> ```

Fine, just be careful with not reversing the meaning of _is_mutable like in `__hash__`.



---

archive/issue_comments_139726.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI have no opinion on what the best error types and messages are for this, but it is probably good if they are consistent. Since this is completely analogous to matrices, you should probably follow that example or change it to conform to yours (if you have good arguments to change it):\n\n```\nsage: M=matrix([[1,2],[3,4]])\nsage: M.__hash__()\nTypeError: mutable matrices are unhashable\nsage: M[0,0]=5\nsage: M.set_immutable()\nsage: M.__hash__()\nsage: M[0,0]=5\nValueError: matrix is immutable; please change a copy instead (i.e., use copy(M) to change a copy of M).\n```\nOn the other hand:\n\n```\nsage: t=(1,2,3)\nsage: t[0]=4\nTypeError: 'tuple' object does not support item assignment\n```\nbut then again a `ValueError` indicates something that something is wrong with the value, not with the type (`tuple` is never mutable, but `matrix` can be).",
    "created_at": "2012-08-18T06:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139726",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:8" align="right">comment:8</div>

I have no opinion on what the best error types and messages are for this, but it is probably good if they are consistent. Since this is completely analogous to matrices, you should probably follow that example or change it to conform to yours (if you have good arguments to change it):

```
sage: M=matrix([[1,2],[3,4]])
sage: M.__hash__()
TypeError: mutable matrices are unhashable
sage: M[0,0]=5
sage: M.set_immutable()
sage: M.__hash__()
sage: M[0,0]=5
ValueError: matrix is immutable; please change a copy instead (i.e., use copy(M) to change a copy of M).
```
On the other hand:

```
sage: t=(1,2,3)
sage: t[0]=4
TypeError: 'tuple' object does not support item assignment
```
but then again a `ValueError` indicates something that something is wrong with the value, not with the type (`tuple` is never mutable, but `matrix` can be).



---

archive/issue_comments_139727.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI feel like it should raise a `TypeError` since making it immutable is, in essence, a class property. Additionally Graph raises a `TypeError` anytime `__hash__()` is called.\n\nAlso more of a random thought: what if we delete the mutators when we make it immutable?\n\n```\ndef is_mutable(self):\n    del self.add_face\n    del self.remove_face\n```",
    "created_at": "2012-08-18T15:40:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139727",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

I feel like it should raise a `TypeError` since making it immutable is, in essence, a class property. Additionally Graph raises a `TypeError` anytime `__hash__()` is called.

Also more of a random thought: what if we delete the mutators when we make it immutable?

```
def is_mutable(self):
    del self.add_face
    del self.remove_face
```



---

archive/issue_comments_139728.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n`remove_face` is not a mutator.",
    "created_at": "2012-08-18T15:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139728",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:10" align="right">comment:10</div>

`remove_face` is not a mutator.



---

archive/issue_comments_139729.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@tscrim](#comment%3A9):\n> I feel like it should raise a `TypeError` since making it immutable is, in essence, a class property. Additionally Graph raises a `TypeError` anytime `__hash__()` is called.\n\nSage isn't consistent (yet?) in this regard:\n\n```\nsage: L=Sequence([1,2,3])\nsage: hash(L)\nValueError: mutable sequences are unhashable\nsage: L.append(4)\nsage: L.set_immutable()\nsage: hash(L)\n...\nsage: L.append(4)\nValueError: object is immutable; please change a copy instead.\n```\nOn the one hand, it's convenient if \"hash(...)\" always gives the same kind of\nerror on an unhashable object (easier to catch). This is what `Matrix` does.\n\nOne the other, if a class instance can change from being unhashable to being\nhashable it's obviously not a property of the class, but of this individual\nobject (its \"value\"). This is what `Sequence` does.\n\nDon't go deleting methods! That's just a hack. Cython classes can't even do it.\nIf you want to go that way, you should make it a separate category\n`FrozenSimplicialComplex`, ala `set` and `frozenset` in python itself, but the\napproach you currently propose is more in line with other sage classes.",
    "created_at": "2012-08-18T17:06:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139729",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@tscrim](#comment%3A9):
> I feel like it should raise a `TypeError` since making it immutable is, in essence, a class property. Additionally Graph raises a `TypeError` anytime `__hash__()` is called.

Sage isn't consistent (yet?) in this regard:

```
sage: L=Sequence([1,2,3])
sage: hash(L)
ValueError: mutable sequences are unhashable
sage: L.append(4)
sage: L.set_immutable()
sage: hash(L)
...
sage: L.append(4)
ValueError: object is immutable; please change a copy instead.
```
On the one hand, it's convenient if "hash(...)" always gives the same kind of
error on an unhashable object (easier to catch). This is what `Matrix` does.

One the other, if a class instance can change from being unhashable to being
hashable it's obviously not a property of the class, but of this individual
object (its "value"). This is what `Sequence` does.

Don't go deleting methods! That's just a hack. Cython classes can't even do it.
If you want to go that way, you should make it a separate category
`FrozenSimplicialComplex`, ala `set` and `frozenset` in python itself, but the
approach you currently propose is more in line with other sage classes.



---

archive/issue_comments_139730.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jhpalmieri](#comment%3A10):\n> `remove_face` is not a mutator.\n\nTo be consistant, I changed it into a mutator. Let me know if there are any objections.\n\nReplying to [@nbruin](#comment%3A11):\n> On the one hand, it's convenient if \"hash(...)\" always gives the same kind of\n> error on an unhashable object (easier to catch). This is what `Matrix` does.\n> \n> One the other, if a class instance can change from being unhashable to being\n> hashable it's obviously not a property of the class, but of this individual\n> object (its \"value\"). This is what `Sequence` does.\n\nI've changed everything to raise a ValueError. I'm wondering if we should create a new exception class for mutable objects such as MutableError. Probabily needs a discussion and for sure another ticket.\n\n> Don't go deleting methods! That's just a hack. Cython classes can't even do it.\n> If you want to go that way, you should make it a separate category\n> `FrozenSimplicialComplex`, ala `set` and `frozenset` in python itself, but the\n> approach you currently propose is more in line with other sage classes.\n\nThat's a good point about the cython class. I'm going to keep with the current methodology.",
    "created_at": "2012-08-18T23:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139730",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jhpalmieri](#comment%3A10):
> `remove_face` is not a mutator.

To be consistant, I changed it into a mutator. Let me know if there are any objections.

Replying to [@nbruin](#comment%3A11):
> On the one hand, it's convenient if "hash(...)" always gives the same kind of
> error on an unhashable object (easier to catch). This is what `Matrix` does.
> 
> One the other, if a class instance can change from being unhashable to being
> hashable it's obviously not a property of the class, but of this individual
> object (its "value"). This is what `Sequence` does.

I've changed everything to raise a ValueError. I'm wondering if we should create a new exception class for mutable objects such as MutableError. Probabily needs a discussion and for sure another ticket.

> Don't go deleting methods! That's just a hack. Cython classes can't even do it.
> If you want to go that way, you should make it a separate category
> `FrozenSimplicialComplex`, ala `set` and `frozenset` in python itself, but the
> approach you currently propose is more in line with other sage classes.

That's a good point about the cython class. I'm going to keep with the current methodology.



---

archive/issue_comments_139731.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'd be appreciative if anyone is willing to review this.\n\nAlso, I found another patch by vp (which I presume is vpiluad) in the sage-combinat queue which makes very small tweaks to `__hash__()` and `__cmp__()` of `Simplex`. So vpiluad, would it be okay if I just delete your patch?",
    "created_at": "2012-08-19T19:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139731",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

I'd be appreciative if anyone is willing to review this.

Also, I found another patch by vp (which I presume is vpiluad) in the sage-combinat queue which makes very small tweaks to `__hash__()` and `__cmp__()` of `Simplex`. So vpiluad, would it be okay if I just delete your patch?



---

archive/issue_events_171045.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-08-19T19:26:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171045"
}
```



---

archive/issue_events_171046.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-08-19T19:26:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171046"
}
```



---

archive/issue_comments_139732.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2012-08-19T19:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139732",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_comments_139733.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tscrim](#comment%3A12):\n> Replying to [@jhpalmieri](#comment%3A10):\n> > `remove_face` is not a mutator.\n\n> \n> To be consistant, I changed it into a mutator. Let me know if there are any objections.\n\nWhy not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?",
    "created_at": "2012-08-19T19:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139733",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tscrim](#comment%3A12):
> Replying to [@jhpalmieri](#comment%3A10):
> > `remove_face` is not a mutator.

> 
> To be consistant, I changed it into a mutator. Let me know if there are any objections.

Why not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?



---

archive/issue_comments_139734.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jhpalmieri](#comment%3A15):\n> Replying to [@tscrim](#comment%3A12):\n> > Replying to [@jhpalmieri](#comment%3A10):\n> > > `remove_face` is not a mutator.\n\n> > \n> > To be consistant, I changed it into a mutator. Let me know if there are any objections.\n\n> \n> Why not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?\n\nDoing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).",
    "created_at": "2012-08-19T19:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139734",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jhpalmieri](#comment%3A15):
> Replying to [@tscrim](#comment%3A12):
> > Replying to [@jhpalmieri](#comment%3A10):
> > > `remove_face` is not a mutator.

> > 
> > To be consistant, I changed it into a mutator. Let me know if there are any objections.

> 
> Why not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?

Doing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).



---

archive/issue_comments_139735.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment%3A16):\n> Replying to [@jhpalmieri](#comment%3A15):\n> > Replying to [@tscrim](#comment%3A12):\n> > > Replying to [@jhpalmieri](#comment%3A10):\n> > > > `remove_face` is not a mutator.\n\n> > > \n> > > To be consistant, I changed it into a mutator. Let me know if there are any objections.\n\n> > \n> > Why not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?\n\n> \n> Doing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).\n\nFor what it's worth, I just searched through simplicial_complex.py, and I don't see `add_face()` used anywhere except for some doctests.\n\nI think consistency with other classes is secondary. I think the central question is: is there a good reason for simplicial complexes to be mutable?",
    "created_at": "2012-09-05T20:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139735",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment%3A16):
> Replying to [@jhpalmieri](#comment%3A15):
> > Replying to [@tscrim](#comment%3A12):
> > > Replying to [@jhpalmieri](#comment%3A10):
> > > > `remove_face` is not a mutator.

> > > 
> > > To be consistant, I changed it into a mutator. Let me know if there are any objections.

> > 
> > Why not change `add_face` so it's not a mutator. Wouldn't that simplify the hashing issue?

> 
> Doing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).

For what it's worth, I just searched through simplicial_complex.py, and I don't see `add_face()` used anywhere except for some doctests.

I think consistency with other classes is secondary. I think the central question is: is there a good reason for simplicial complexes to be mutable?



---

archive/issue_comments_139736.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jhpalmieri](#comment%3A17):\n> Replying to [@tscrim](#comment%3A16):\n> >\n> > Doing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).\n\n> \n> For what it's worth, I just searched through simplicial_complex.py, and I don't see `add_face()` used anywhere except for some doctests.\n> \n> I think consistency with other classes is secondary. I think the central question is: is there a good reason for simplicial complexes to be mutable?\n\nA priori, no. You're right, I could not find any code either (I looked through both the homology and combinat directories) which used `add_face()` other than for the doc-tests. I feel like there are many constructions which iteratively build-up simplicial complexes or break them down piece by piece (such as k-decomposeability) and creating copies would create transient objects and inflate the memory usage. This is why I feel that we should have SimplicialComplex be mutable.",
    "created_at": "2012-09-14T05:49:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139736",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jhpalmieri](#comment%3A17):
> Replying to [@tscrim](#comment%3A16):
> >
> > Doing that would fix it. However some of the methods in SimplicialComplex use `add_face()` (as I recall `_enlarge_subcomplex()` is the main culprit), so it'd cut down on the number of transient objects. Also I feel like this is becomes consistent with `Graph` (and by my understanding `Sequence` and `Matrix`).

> 
> For what it's worth, I just searched through simplicial_complex.py, and I don't see `add_face()` used anywhere except for some doctests.
> 
> I think consistency with other classes is secondary. I think the central question is: is there a good reason for simplicial complexes to be mutable?

A priori, no. You're right, I could not find any code either (I looked through both the homology and combinat directories) which used `add_face()` other than for the doc-tests. I feel like there are many constructions which iteratively build-up simplicial complexes or break them down piece by piece (such as k-decomposeability) and creating copies would create transient objects and inflate the memory usage. This is why I feel that we should have SimplicialComplex be mutable.



---

archive/issue_comments_139737.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@tscrim](#comment%3A13):\n> Also, I found another patch by vp (which I presume is vpiluad) in the sage-combinat queue which makes very small tweaks to `__hash__()` and `__cmp__()` of `Simplex`. So vpiluad, would it be okay if I just delete your patch?\n\nMy collaborator vpilaud actually opened this ticket (as his very first ticket). You can delete his small patch in the combinat queue concerning the hash of simplicial complexes.\n\nWe were/are working on a patch on implementing \"subword complexes\" (which are simplicial complexes) as defined by Knutson and Miller in [1]. In this context, we needed fast hashing of simplicies and of simplicial complexes for constructing them. We now use a different algorithm, but if there will eventually be an immutable version of simplicial complexes with fast hashing, we might go back to another, faster algorithm.\n\nAnyway, I appreciate your work on this!\n\nChristian\n\n[1] A. Knutson and E. Miller, Subword complexes in Coxeter groups, Adv. Math. 184(1), 2004.",
    "created_at": "2012-10-28T08:29:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139737",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@tscrim](#comment%3A13):
> Also, I found another patch by vp (which I presume is vpiluad) in the sage-combinat queue which makes very small tweaks to `__hash__()` and `__cmp__()` of `Simplex`. So vpiluad, would it be okay if I just delete your patch?

My collaborator vpilaud actually opened this ticket (as his very first ticket). You can delete his small patch in the combinat queue concerning the hash of simplicial complexes.

We were/are working on a patch on implementing "subword complexes" (which are simplicial complexes) as defined by Knutson and Miller in [1]. In this context, we needed fast hashing of simplicies and of simplicial complexes for constructing them. We now use a different algorithm, but if there will eventually be an immutable version of simplicial complexes with fast hashing, we might go back to another, faster algorithm.

Anyway, I appreciate your work on this!

Christian

[1] A. Knutson and E. Miller, Subword complexes in Coxeter groups, Adv. Math. 184(1), 2004.



---

archive/issue_comments_139738.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSince you propose to make the hash only dependent on the facets:\n\n```\nsage: S = SimplicialComplex([1,2,3],[[1,2]])\nsage: S\nSimplicial complex with vertex set (1, 2, 3) and facets {(1, 2)}\n```\n(`[1,2,3]` is actually not the vertex set, but the *ground set*, while the vertex set is `[1,2]`.) The proposed implementation only takes the facets into account for hashing, thus we get the same hash for\n\n```\nsage: S = SimplicialComplex([1,2],[[1,2]])\nsage: S\nSimplicial complex with vertex set (1, 2) and facets {(1, 2)}\n```\n\nIs this the desired behaviour - or should the ground set be used as well for hashing?\n\n(I don't have a strong opinion on this question, but I thought I bring it up anyway. If you don't want to take care of the vertex set vs. ground set issue in this ticket here, I will open another and ask for other peoples opinion there.)",
    "created_at": "2012-10-28T08:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139738",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:20" align="right">comment:20</div>

Since you propose to make the hash only dependent on the facets:

```
sage: S = SimplicialComplex([1,2,3],[[1,2]])
sage: S
Simplicial complex with vertex set (1, 2, 3) and facets {(1, 2)}
```
(`[1,2,3]` is actually not the vertex set, but the *ground set*, while the vertex set is `[1,2]`.) The proposed implementation only takes the facets into account for hashing, thus we get the same hash for

```
sage: S = SimplicialComplex([1,2],[[1,2]])
sage: S
Simplicial complex with vertex set (1, 2) and facets {(1, 2)}
```

Is this the desired behaviour - or should the ground set be used as well for hashing?

(I don't have a strong opinion on this question, but I thought I bring it up anyway. If you don't want to take care of the vertex set vs. ground set issue in this ticket here, I will open another and ask for other peoples opinion there.)



---

archive/issue_comments_139739.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@stumpc5](#comment%3A20):\n> Since you propose to make the hash only dependent on the facets:\n> \n> ```\n> sage: S = SimplicialComplex([1,2,3],[[1,2]])\n> sage: S\n> Simplicial complex with vertex set (1, 2, 3) and facets {(1, 2)}\n> ```\n> (`[1,2,3]` is actually not the vertex set, but the *ground set*, while the vertex set is `[1,2]`.) The proposed implementation only takes the facets into account for hashing, thus we get the same hash for\n> \n> ```\n> sage: S = SimplicialComplex([1,2],[[1,2]])\n> sage: S\n> Simplicial complex with vertex set (1, 2) and facets {(1, 2)}\n> ```\n> \n> Is this the desired behaviour - or should the ground set be used as well for hashing?\n> \n> (I don't have a strong opinion on this question, but I thought I bring it up anyway. If you don't want to take care of the vertex set vs. ground set issue in this ticket here, I will open another and ask for other peoples opinion there.)\n\nThere are a few possibilities:\n\n1. This is a bug, in that `(3,)` should also be listed as a facet.\n2. We handle this more like a matroid (I believe this is what you're suggesting) and add methods like `ground_set()`.\n3. Split the difference and make an optional argument.\n4. We just do a stopgap here and make the hash depend upon the vertex/ground set and push this to another ticket.\n\nMy thought is we handle this as a bug, but I'm happy to implement whichever is decided upon. I have no strong opinions either.\n\nBest,\n\nTravis",
    "created_at": "2012-10-28T17:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139739",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@stumpc5](#comment%3A20):
> Since you propose to make the hash only dependent on the facets:
> 
> ```
> sage: S = SimplicialComplex([1,2,3],[[1,2]])
> sage: S
> Simplicial complex with vertex set (1, 2, 3) and facets {(1, 2)}
> ```
> (`[1,2,3]` is actually not the vertex set, but the *ground set*, while the vertex set is `[1,2]`.) The proposed implementation only takes the facets into account for hashing, thus we get the same hash for
> 
> ```
> sage: S = SimplicialComplex([1,2],[[1,2]])
> sage: S
> Simplicial complex with vertex set (1, 2) and facets {(1, 2)}
> ```
> 
> Is this the desired behaviour - or should the ground set be used as well for hashing?
> 
> (I don't have a strong opinion on this question, but I thought I bring it up anyway. If you don't want to take care of the vertex set vs. ground set issue in this ticket here, I will open another and ask for other peoples opinion there.)

There are a few possibilities:

1. This is a bug, in that `(3,)` should also be listed as a facet.
2. We handle this more like a matroid (I believe this is what you're suggesting) and add methods like `ground_set()`.
3. Split the difference and make an optional argument.
4. We just do a stopgap here and make the hash depend upon the vertex/ground set and push this to another ticket.

My thought is we handle this as a bug, but I'm happy to implement whichever is decided upon. I have no strong opinions either.

Best,

Travis



---

archive/issue_comments_139740.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n> Is this the desired behaviour?\n\nWell, it's certainly the documented behavior (I mean the documented behavior of simplicial complexes). Note that you can also do\n\n```\nS = SimplicialComplex([[1,2]])\n```\nto get a complex with a single facet. So the vertex list is already an optional argument, in some sense.\n\nI think that the hash should only depend on the facets; the unused vertices shouldn't have any effect. That makes the most mathematical sense to me.",
    "created_at": "2012-10-29T02:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139740",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

> Is this the desired behaviour?

Well, it's certainly the documented behavior (I mean the documented behavior of simplicial complexes). Note that you can also do

```
S = SimplicialComplex([[1,2]])
```
to get a complex with a single facet. So the vertex list is already an optional argument, in some sense.

I think that the hash should only depend on the facets; the unused vertices shouldn't have any effect. That makes the most mathematical sense to me.



---

archive/issue_comments_139741.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jhpalmieri](#comment%3A22):\n> I think that the hash should only depend on the facets; the unused vertices shouldn't have any effect. That makes the most mathematical sense to me.\n\nI agree.\n\nBut I still think that mathematically, a vertex is a 0-dimensional face, and thus must be contained in some facet, see [1] or basically any book on simplicial complexes. In the example above, `3` is therefore not a vertex. (In particular, \"unused vertices\" do not exist.) But this is then another issue, and we can discuss it on another ticket, as Travis suggested as well.\n\n[1] http://en.wikipedia.org/wiki/Abstract_simplicial_complex : \"The vertex set of \u0394 is defined as V(\u0394) = \u222a\u0394, the union of all faces of \u0394\"",
    "created_at": "2012-10-29T08:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139741",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jhpalmieri](#comment%3A22):
> I think that the hash should only depend on the facets; the unused vertices shouldn't have any effect. That makes the most mathematical sense to me.

I agree.

But I still think that mathematically, a vertex is a 0-dimensional face, and thus must be contained in some facet, see [1] or basically any book on simplicial complexes. In the example above, `3` is therefore not a vertex. (In particular, "unused vertices" do not exist.) But this is then another issue, and we can discuss it on another ticket, as Travis suggested as well.

[1] http://en.wikipedia.org/wiki/Abstract_simplicial_complex : "The vertex set of Δ is defined as V(Δ) = ∪Δ, the union of all faces of Δ"



---

archive/issue_comments_139742.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI think it would be absolutely fine to change the *documentation* of `SimplicialComplex` to encourage the use of\n\n```\nsage: SimplicialComplex( list of facets )\n```\ninstead of\n\n```\nsage: SimplicialComplex( vertex set, list of facets )\n```\nWe could also go further and change the *behavior* of `SimplicialComplex` so it ignores `vertex_set` even if it is present, thus essentially deprecating its use. We could formally deprecate its use, in fact.",
    "created_at": "2012-10-29T17:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139742",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

I think it would be absolutely fine to change the *documentation* of `SimplicialComplex` to encourage the use of

```
sage: SimplicialComplex( list of facets )
```
instead of

```
sage: SimplicialComplex( vertex set, list of facets )
```
We could also go further and change the *behavior* of `SimplicialComplex` so it ignores `vertex_set` even if it is present, thus essentially deprecating its use. We could formally deprecate its use, in fact.



---

archive/issue_comments_139743.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@jhpalmieri](#comment%3A24):\n> I think it would be absolutely fine to change the *documentation* of `SimplicialComplex` to encourage the use of\n> \n> ```\n> sage: SimplicialComplex( list of facets )\n> ```\n> instead of\n> \n> ```\n> sage: SimplicialComplex( vertex set, list of facets )\n> ```\n> We could also go further and change the *behavior* of `SimplicialComplex` so it ignores `vertex_set` even if it is present, thus essentially deprecating its use. We could formally deprecate its use, in fact.\n\nI'd be happy with deprecating `vertex_set`. I could go through and make those changes on this ticket.",
    "created_at": "2012-10-29T21:49:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139743",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@jhpalmieri](#comment%3A24):
> I think it would be absolutely fine to change the *documentation* of `SimplicialComplex` to encourage the use of
> 
> ```
> sage: SimplicialComplex( list of facets )
> ```
> instead of
> 
> ```
> sage: SimplicialComplex( vertex set, list of facets )
> ```
> We could also go further and change the *behavior* of `SimplicialComplex` so it ignores `vertex_set` even if it is present, thus essentially deprecating its use. We could formally deprecate its use, in fact.

I'd be happy with deprecating `vertex_set`. I could go through and make those changes on this ticket.



---

archive/issue_comments_139744.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nDeprecated `vertex_set` and made all of the appropriate changes. This is now based on (the to be merged) #13244.",
    "created_at": "2012-11-13T02:33:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139744",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">comment:26</div>

Deprecated `vertex_set` and made all of the appropriate changes. This is now based on (the to be merged) #13244.



---

archive/issue_comments_139745.json:
```json
{
    "body": "Dependencies: **#13244**",
    "created_at": "2012-11-13T02:33:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139745",
    "user": "https://github.com/tscrim"
}
```

Dependencies: **#13244**



---

archive/issue_events_171047.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-13T02:33:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171047"
}
```



---

archive/issue_events_171048.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-13T02:33:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171048"
}
```



---

archive/issue_comments_139746.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nMinor tweaks. Ready for review.",
    "created_at": "2012-11-13T05:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139746",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

Minor tweaks. Ready for review.



---

archive/issue_comments_139747.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nRebased over #13590.",
    "created_at": "2012-11-13T21:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139747",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:28" align="right">comment:28</div>

Rebased over #13590.



---

archive/issue_comments_139748.json:
```json
{
    "body": "Changed dependencies from **#13244** to **#13244 #13590**",
    "created_at": "2012-11-13T21:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139748",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#13244** to **#13244 #13590**



---

archive/issue_comments_139749.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nHi Travis,\n\nI started to review the patch. Everything looks quite well, but you seem to have missed handling the parameters properly, see below:\n\n```\nsage: S = SimplicialComplex(maximal_faces=[[1,4], [2,4]])\n...\nTypeError: 'NoneType' object is not iterable\n```\n\nand with this\n\n```\nsage: S = SimplicialComplex(vertex_set=[1,2,4],maximal_faces=[[1,4], [2,4]])    \nsage: S\nSimplicial complex with vertex set (1, 2, 4) and facets {(2, 4), (1, 4)}\n```\nThe deprecation could maybe as well quickly be mentioned in the init of SimplicialComplex, since `vertex_set` is still there as an optional argument.",
    "created_at": "2012-11-19T10:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139749",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:29" align="right">comment:29</div>

Hi Travis,

I started to review the patch. Everything looks quite well, but you seem to have missed handling the parameters properly, see below:

```
sage: S = SimplicialComplex(maximal_faces=[[1,4], [2,4]])
...
TypeError: 'NoneType' object is not iterable
```

and with this

```
sage: S = SimplicialComplex(vertex_set=[1,2,4],maximal_faces=[[1,4], [2,4]])    
sage: S
Simplicial complex with vertex set (1, 2, 4) and facets {(2, 4), (1, 4)}
```
The deprecation could maybe as well quickly be mentioned in the init of SimplicialComplex, since `vertex_set` is still there as an optional argument.



---

archive/issue_comments_139750.json:
```json
{
    "body": "Reviewer: **Christian Stump**",
    "created_at": "2012-11-19T10:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139750",
    "user": "https://github.com/stumpc5"
}
```

Reviewer: **Christian Stump**



---

archive/issue_events_171049.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2012-11-19T10:35:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171049"
}
```



---

archive/issue_events_171050.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2012-11-19T10:35:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171050"
}
```



---

archive/issue_events_171051.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-19T18:03:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171051"
}
```



---

archive/issue_events_171052.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-19T18:03:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171052"
}
```



---

archive/issue_comments_139751.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nThanks for reviewing this. Here's the updated patch fixing the above and with the added documentation in `__init__()`.",
    "created_at": "2012-11-19T18:03:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139751",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:30" align="right">comment:30</div>

Thanks for reviewing this. Here's the updated patch fixing the above and with the added documentation in `__init__()`.



---

archive/issue_comments_139752.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nWhat about\n\n```\nsage: S = SimplicialComplex(vertex_set=[1,2,3,4],maximal_faces=[[1,4], [2,4]])\n/home/stumpc5/progs/sage-5.5.beta1/local/bin/sage-ipython:1: DeprecationWarning: vertex_set is deprecated.\nSee http://trac.sagemath.org/12587 for details.\n  #!/usr/bin/env python\nsage: S\nSimplicial complex with vertex set (1, 2, 3, 4) and facets {(2, 4), (1, 4)}\n```\n\nsorry to be picky here: I thought we agreed that the input `vertex_set` is ignored, didn't we ? Mathematically, the above is simply wrong (see [comment:22](#comment%3A22)), so I would prefer if we could get rid of\n\n```\nSimplicial complex with vertex set (1, 2, 3, 4) and facets {(2, 4), (1, 4)}\n```\n\nOr do you think that deprecation enough?",
    "created_at": "2012-11-19T18:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139752",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:31" align="right">comment:31</div>

What about

```
sage: S = SimplicialComplex(vertex_set=[1,2,3,4],maximal_faces=[[1,4], [2,4]])
/home/stumpc5/progs/sage-5.5.beta1/local/bin/sage-ipython:1: DeprecationWarning: vertex_set is deprecated.
See http://trac.sagemath.org/12587 for details.
  #!/usr/bin/env python
sage: S
Simplicial complex with vertex set (1, 2, 3, 4) and facets {(2, 4), (1, 4)}
```

sorry to be picky here: I thought we agreed that the input `vertex_set` is ignored, didn't we ? Mathematically, the above is simply wrong (see [comment:22](#comment%3A22)), so I would prefer if we could get rid of

```
Simplicial complex with vertex set (1, 2, 3, 4) and facets {(2, 4), (1, 4)}
```

Or do you think that deprecation enough?



---

archive/issue_comments_139753.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI left it there in case someone was relying on that behavior as I thought the agreement was to just deprecate the functionality. However I have no problem completely ignoring it and can make the appropriate changes. Alternatively I can make a more robust warning in the init or class description about it being wrong. Which would you prefer?",
    "created_at": "2012-11-19T18:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139753",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:32" align="right">comment:32</div>

I left it there in case someone was relying on that behavior as I thought the agreement was to just deprecate the functionality. However I have no problem completely ignoring it and can make the appropriate changes. Alternatively I can make a more robust warning in the init or class description about it being wrong. Which would you prefer?



---

archive/issue_comments_139754.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@tscrim](#comment%3A32):\n> I left it there in case someone was relying on that behavior as I thought the agreement was to just deprecate the functionality. However I have no problem completely ignoring it and can make the appropriate changes. Alternatively I can make a more robust warning in the init or class description about it being wrong. Which would you prefer?\n\nI'd prefer that if the user puts in something mathematically wrong, then he should be getting an error. But you're writing the patch, so you decide. I will finish my review as soon as I have your decision...",
    "created_at": "2012-11-20T12:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139754",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@tscrim](#comment%3A32):
> I left it there in case someone was relying on that behavior as I thought the agreement was to just deprecate the functionality. However I have no problem completely ignoring it and can make the appropriate changes. Alternatively I can make a more robust warning in the init or class description about it being wrong. Which would you prefer?

I'd prefer that if the user puts in something mathematically wrong, then he should be getting an error. But you're writing the patch, so you decide. I will finish my review as soon as I have your decision...



---

archive/issue_comments_139755.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI've uploaded the new patch which ignores the `vertex_set` option. Thanks for the review.",
    "created_at": "2012-11-20T16:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139755",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:34" align="right">comment:34</div>

I've uploaded the new patch which ignores the `vertex_set` option. Thanks for the review.



---

archive/issue_comments_139756.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nRebased off of #13226.",
    "created_at": "2012-11-21T00:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139756",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:35" align="right">comment:35</div>

Rebased off of #13226.



---

archive/issue_comments_139757.json:
```json
{
    "body": "Changed dependencies from **#13244 #13590** to **#13244 #13590 #13226**",
    "created_at": "2012-11-21T00:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139757",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#13244 #13590** to **#13244 #13590 #13226**



---

archive/issue_comments_139758.json:
```json
{
    "body": "Changed dependencies from **#13244 #13590 #13226** to none",
    "created_at": "2012-11-21T13:25:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139758",
    "user": "https://github.com/stumpc5"
}
```

Changed dependencies from **#13244 #13590 #13226** to none



---

archive/issue_comments_139759.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAttachment: **[trac_12587-simplicial_complex_hash-ts.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)**",
    "created_at": "2012-11-21T13:25:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139759",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:36" align="right">comment:36</div>

Attachment: **[trac_12587-simplicial_complex_hash-ts.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)**



---

archive/issue_comments_139760.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nAttachment: **[trac_12587-simplicial_complex_hash_review-cs.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)**",
    "created_at": "2012-11-21T14:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139760",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:37" align="right">comment:37</div>

Attachment: **[trac_12587-simplicial_complex_hash_review-cs.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)**



---

archive/issue_events_171053.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2012-11-21T14:52:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171053"
}
```



---

archive/issue_events_171054.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2012-11-21T14:52:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171054"
}
```



---

archive/issue_comments_139761.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@stumpc5](#comment%3A37):\n\nEverything looks good to me now -- I fixed a typo and a missing remove of the vertex_set, plus two doc strings.\n\nSo: I give it a positive review!",
    "created_at": "2012-11-21T14:54:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139761",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@stumpc5](#comment%3A37):

Everything looks good to me now -- I fixed a typo and a missing remove of the vertex_set, plus two doc strings.

So: I give it a positive review!



---

archive/issue_comments_139762.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThank you for the review.",
    "created_at": "2012-11-21T16:04:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139762",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Thank you for the review.



---

archive/issue_events_171055.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-21T22:47:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171055"
}
```



---

archive/issue_events_171056.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-21T22:47:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171056"
}
```



---

archive/issue_comments_139763.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThis looks very good. I have a few more changes, though: we should make sure that the various deprecations are documented in the reference manual (which does not include methods like `__init__`). Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them. Finally, I added doctests to the `__init__` method to test the new deprecations. I think my patch needs review.",
    "created_at": "2012-11-21T22:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139763",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">comment:40</div>

This looks very good. I have a few more changes, though: we should make sure that the various deprecations are documented in the reference manual (which does not include methods like `__init__`). Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them. Finally, I added doctests to the `__init__` method to test the new deprecations. I think my patch needs review.



---

archive/issue_comments_139764.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,11 @@\n     def __hash__(self):\n         return hash(self.__repr__())\n ```\n+\n+---\n+\n+Apply:\n+\n+- [attachment: trac_12587-simplicial_complex_hash-ts.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)\n+- [attachment: trac_12587-simplicial_complex_hash_review-cs.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)\n+- [attachment: trac_12587-ref-jhp.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)\n``````\n",
    "created_at": "2012-11-21T22:50:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139764",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,11 @@
     def __hash__(self):
         return hash(self.__repr__())
 ```
+
+---
+
+Apply:
+
+- [attachment: trac_12587-simplicial_complex_hash-ts.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash-ts.patch.gz)
+- [attachment: trac_12587-simplicial_complex_hash_review-cs.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-simplicial_complex_hash_review-cs.patch.gz)
+- [attachment: trac_12587-ref-jhp.patch](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)
``````




---

archive/issue_events_171057.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-21T22:50:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171057"
}
```



---

archive/issue_events_171058.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-21T22:50:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171058"
}
```



---

archive/issue_comments_139765.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI also got the duplicate reference once (a long while ago), but never on any subsequent docbuild. I've looked over you review patch and looks good to me. Thank you for your diligence.",
    "created_at": "2012-11-22T06:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139765",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:42" align="right">comment:42</div>

I also got the duplicate reference once (a long while ago), but never on any subsequent docbuild. I've looked over you review patch and looks good to me. Thank you for your diligence.



---

archive/issue_events_171059.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-22T06:34:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171059"
}
```



---

archive/issue_events_171060.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-11-22T06:34:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171060"
}
```



---

archive/issue_comments_139766.json:
```json
{
    "body": "Changed reviewer from **Christian Stump** to **Christian Stump, John Palmieri**",
    "created_at": "2012-11-22T06:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139766",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Christian Stump** to **Christian Stump, John Palmieri**



---

archive/issue_comments_139767.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@jhpalmieri](#comment%3A40):\n> Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them.\n\nI also had this problem only the first time I built the documentation.\n\nNow, the reference is missing in the documentation of Simplex.product, which I don't think is the solution either. When I was doing the review, I spent some time to figure out how to solve this issue but didn't manage to do so.\n\nDo you happen to know how to either reference a citation in a different file, or to have the same citation in different files without getting a warning?\n\nBest, Christian",
    "created_at": "2012-11-22T07:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139767",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@jhpalmieri](#comment%3A40):
> Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them.

I also had this problem only the first time I built the documentation.

Now, the reference is missing in the documentation of Simplex.product, which I don't think is the solution either. When I was doing the review, I spent some time to figure out how to solve this issue but didn't manage to do so.

Do you happen to know how to either reference a citation in a different file, or to have the same citation in different files without getting a warning?

Best, Christian



---

archive/issue_comments_139768.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@stumpc5](#comment%3A43):\n> Replying to [@jhpalmieri](#comment%3A40):\n> > Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them.\n\n> \n> I also had this problem only the first time I built the documentation.\n\nI would guess that if you delete the documentation output, or if you somehow force Sage to rebuild the documentation of delta_complex.py, you'll see the warning again.\n\n> Now, the reference is missing in the documentation of Simplex.product, which I don't think is the solution either. When I was doing the review, I spent some time to figure out how to solve this issue but didn't manage to do so.\n\nI still see the reference, and if I click on the citation, I get taken to the reference in the other file. Also, most people reading the docstring will know what \"Hatcher\" means \u2013 it's not an obscure reference \u2013 so won't even need to look it up.\n\n> Do you happen to know how to either reference a citation in a different file\n\nIt works for me. Try rebuilding all of the documentation (`rm -rf SAGE_ROOT/devel/sage/doc/output/` and then `sage --docbuild reference html`).",
    "created_at": "2012-11-22T15:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139768",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@stumpc5](#comment%3A43):
> Replying to [@jhpalmieri](#comment%3A40):
> > Also, when I built the documentation, I got a warning about a duplicated reference for `[Hat]`, so I removed one of them.

> 
> I also had this problem only the first time I built the documentation.

I would guess that if you delete the documentation output, or if you somehow force Sage to rebuild the documentation of delta_complex.py, you'll see the warning again.

> Now, the reference is missing in the documentation of Simplex.product, which I don't think is the solution either. When I was doing the review, I spent some time to figure out how to solve this issue but didn't manage to do so.

I still see the reference, and if I click on the citation, I get taken to the reference in the other file. Also, most people reading the docstring will know what "Hatcher" means – it's not an obscure reference – so won't even need to look it up.

> Do you happen to know how to either reference a citation in a different file

It works for me. Try rebuilding all of the documentation (`rm -rf SAGE_ROOT/devel/sage/doc/output/` and then `sage --docbuild reference html`).



---

archive/issue_comments_139769.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@jhpalmieri](#comment%3A44):\n> Replying to [@stumpc5](#comment%3A43):\n> > Replying to [@jhpalmieri](#comment%3A40):\n\n> I still see the reference, and if I click on the citation, I get taken to the reference in the other file. Also, most people reading the docstring will know what \"Hatcher\" means \u2013 it's not an obscure reference \u2013 so won't even need to look it up.\n\nSaying this: might it be even worth adding the reference of the freely available pdf version of the book?\n\n> It works for me. Try rebuilding all of the documentation (`rm -rf SAGE_ROOT/devel/sage/doc/output/` and then `sage --docbuild reference html`).\n\nThis indeed solved the issue on my machine as well, thanks!\n\nIf any one of you wanna go ahead: I am happy with giving it a positive review again!",
    "created_at": "2012-11-22T16:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139769",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@jhpalmieri](#comment%3A44):
> Replying to [@stumpc5](#comment%3A43):
> > Replying to [@jhpalmieri](#comment%3A40):

> I still see the reference, and if I click on the citation, I get taken to the reference in the other file. Also, most people reading the docstring will know what "Hatcher" means – it's not an obscure reference – so won't even need to look it up.

Saying this: might it be even worth adding the reference of the freely available pdf version of the book?

> It works for me. Try rebuilding all of the documentation (`rm -rf SAGE_ROOT/devel/sage/doc/output/` and then `sage --docbuild reference html`).

This indeed solved the issue on my machine as well, thanks!

If any one of you wanna go ahead: I am happy with giving it a positive review again!



---

archive/issue_comments_139770.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nHere's what happened (in writing this patch):\n- I wrote the reference into `simplicial_complex.py`,\n- compiled doc and got the warning,\n- remove the reference and rebuilt the doc from that (i.e. just that file),\n- it did not link, so put the reference back in and no warning showed up,\n- rebuilt the entire documentation without any #12587 patches applied\n- added the review patches, then all references/linking worked.\n\nRebuilding the entire documentation is the only way to get it to work since references are global and global changes are (currently) only removed/edited when the entire documentation is rebuilt. (This is unbelievably annoying to me when working between patches that add/modify .rst files.) Or something like that...",
    "created_at": "2012-11-22T16:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139770",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:46" align="right">comment:46</div>

Here's what happened (in writing this patch):
- I wrote the reference into `simplicial_complex.py`,
- compiled doc and got the warning,
- remove the reference and rebuilt the doc from that (i.e. just that file),
- it did not link, so put the reference back in and no warning showed up,
- rebuilt the entire documentation without any #12587 patches applied
- added the review patches, then all references/linking worked.

Rebuilding the entire documentation is the only way to get it to work since references are global and global changes are (currently) only removed/edited when the entire documentation is rebuilt. (This is unbelievably annoying to me when working between patches that add/modify .rst files.) Or something like that...



---

archive/issue_events_171061.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-27T03:11:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171061"
}
```



---

archive/issue_events_171062.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-27T03:11:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171062"
}
```



---

archive/issue_comments_139771.json:
```json
{
    "body": "Attachment: **[trac_12587-ref-jhp.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)**",
    "created_at": "2012-11-28T04:27:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139771",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_12587-ref-jhp.patch.gz](https://github.com/sagemath/sage/files/ticket12587/trac_12587-ref-jhp.patch.gz)**



---

archive/issue_comments_139772.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI updated my referee patch to deal with one more instance of `SimplicialComplex` begin called with a vertex set (in `interfaces/chomp.py`). There is probably one more that needs fixing (in `sandpiles/sandpile.py`), but I haven't installed the optional package 4ti2 to check it. I *have* installed CHomP, so I can verify the one I added to the patch.",
    "created_at": "2012-11-28T04:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139772",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:48" align="right">comment:48</div>

I updated my referee patch to deal with one more instance of `SimplicialComplex` begin called with a vertex set (in `interfaces/chomp.py`). There is probably one more that needs fixing (in `sandpiles/sandpile.py`), but I haven't installed the optional package 4ti2 to check it. I *have* installed CHomP, so I can verify the one I added to the patch.



---

archive/issue_comments_139773.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\n(See also #13769, which fixes optional doctests for `interfaces/chomp.py` when CHomP is installed.)",
    "created_at": "2012-11-28T04:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139773",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:49" align="right">comment:49</div>

(See also #13769, which fixes optional doctests for `interfaces/chomp.py` when CHomP is installed.)



---

archive/issue_comments_139774.json:
```json
{
    "body": "Dependencies: **#13226, #13244, #13590**",
    "created_at": "2012-12-11T21:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139774",
    "user": "https://github.com/jhpalmieri"
}
```

Dependencies: **#13226, #13244, #13590**



---

archive/issue_comments_139775.json:
```json
{
    "body": "Merged: **sage-5.6.beta1**",
    "created_at": "2012-12-21T09:31:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12587#issuecomment-139775",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta1**



---

archive/issue_events_171063.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:31:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171063"
}
```



---

archive/issue_events_171064.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:31:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12587",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12587#event-171064"
}
```
