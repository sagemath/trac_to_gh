# Issue 12840: update M4RI to newest upstream release

archive/issues_012668.json:
```json
{
    "assignees": [],
    "body": "As the title says.\n\n**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg\n\n**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz), [attachment: trac_12840-rebased-on-13109.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)\n\n**Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)\n\nDepends on #12841\nDepends on #13109\n\nReviewer: **Simon King, Volker Braun**\n\nAuthor: **Martin Albrecht, John Palmieri**\n\nMerged: **sage-5.3.beta0**\n\nComponent: **packages: standard**\n\nDependencies: **to be merged with #12841, #13109**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12840_\n\n",
    "closed_at": "2012-08-01T12:10:47Z",
    "created_at": "2012-04-13T19:33:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update M4RI to newest upstream release",
    "type": "issue",
    "updated_at": "2012-08-01T12:10:47Z",
    "url": "https://github.com/sagemath/sage/issues/12840",
    "user": "https://github.com/malb"
}
```
As the title says.

**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg

**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz), [attachment: trac_12840-rebased-on-13109.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)

**Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)

Depends on #12841
Depends on #13109

Reviewer: **Simon King, Volker Braun**

Author: **Martin Albrecht, John Palmieri**

Merged: **sage-5.3.beta0**

Component: **packages: standard**

Dependencies: **to be merged with #12841, #13109**

_Issue created by migration from https://trac.sagemath.org/ticket/12840_





---

archive/issue_events_177188.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:33:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177188"
}
```



---

archive/issue_events_177189.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:33:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177189"
}
```



---

archive/issue_events_177190.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:33:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177190"
}
```



---

archive/issue_events_177191.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:33:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177191"
}
```



---

archive/issue_comments_144640.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n As the title says.\n+\n+**Install:\u00a0**!http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n``````\n",
    "created_at": "2012-04-13T19:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144640",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 As the title says.
+
+**Install: **!http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
``````




---

archive/issue_comments_144641.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n As the title says.\n \n-**Install:\u00a0**!http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n+**Install:\u00a0**http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n``````\n",
    "created_at": "2012-04-13T19:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144641",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 As the title says.
 
-**Install: **!http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
``````




---

archive/issue_comments_144642.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n As the title says.\n \n-**Install:\u00a0**http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n+\n+**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n``````\n",
    "created_at": "2012-04-13T19:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144642",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 As the title says.
 
-**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
+
+**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
``````




---

archive/issue_comments_144643.json:
```json
{
    "body": "Dependencies: **#12841**",
    "created_at": "2012-04-13T20:27:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144643",
    "user": "https://github.com/malb"
}
```

Dependencies: **#12841**



---

archive/issue_events_177192.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T23:10:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177192"
}
```



---

archive/issue_comments_144644.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_12840_m4ri_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)**\n\nUpdated the patch because I forgot to raise a `ZeroDivisionError` in `__invert__`. Fixed now.",
    "created_at": "2012-04-14T10:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144644",
    "user": "https://github.com/malb"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_12840_m4ri_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)**

Updated the patch because I forgot to raise a `ZeroDivisionError` in `__invert__`. Fixed now.



---

archive/issue_comments_144645.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAfter applying the patch and the spkg and rebuilding the polybori spkg, sage -br failed with\n\n```\ngcc -pthread -shared -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib build/temp.linux-x86_64-2.7/sage/matrix/matrix_integer_dense.o -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib -lcsage -liml -lpari -lm -lgmp -lcblas -latlas -lstdc++ -lntl -lpython2.7 -o build/lib.linux-x86_64-2.7/sage/matrix/matrix_integer_dense.so\nerror: command 'gcc' failed with exit status 1\nError installing modified sage library code.\n```\nNo error message, I am afraid.",
    "created_at": "2012-05-03T14:21:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144645",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

After applying the patch and the spkg and rebuilding the polybori spkg, sage -br failed with

```
gcc -pthread -shared -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib build/temp.linux-x86_64-2.7/sage/matrix/matrix_integer_dense.o -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib -L/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib -lcsage -liml -lpari -lm -lgmp -lcblas -latlas -lstdc++ -lntl -lpython2.7 -o build/lib.linux-x86_64-2.7/sage/matrix/matrix_integer_dense.so
error: command 'gcc' failed with exit status 1
Error installing modified sage library code.
```
No error message, I am afraid.



---

archive/issue_comments_144646.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nPS: That was with sage-5.0.beta13 plus a lot of patches, but none of them changing matrices.",
    "created_at": "2012-05-03T14:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144646",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:9" align="right">comment:9</div>

PS: That was with sage-5.0.beta13 plus a lot of patches, but none of them changing matrices.



---

archive/issue_comments_144647.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAnd repeating sage -br, I finally got a proper error:\n\n```\nIn file included from /mnt/local/king/SAGE/stable/sage-5.0.beta13/local/include/m4rie/m4rie.h:56,\n                 from sage/matrix/matrix_mod2e_dense.cpp:240:\n/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/include/m4rie/permutation.h:30:30: error: m4ri/permutation.h: Datei oder Verzeichnis nicht gefunden\nerror: command 'gcc' failed with exit status 1\nError installing modified sage library code.\n```",
    "created_at": "2012-05-03T14:23:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144647",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

And repeating sage -br, I finally got a proper error:

```
In file included from /mnt/local/king/SAGE/stable/sage-5.0.beta13/local/include/m4rie/m4rie.h:56,
                 from sage/matrix/matrix_mod2e_dense.cpp:240:
/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/include/m4rie/permutation.h:30:30: error: m4ri/permutation.h: Datei oder Verzeichnis nicht gefunden
error: command 'gcc' failed with exit status 1
Error installing modified sage library code.
```



---

archive/issue_comments_144648.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nPS: permutation.h seems not to be present in the sources.",
    "created_at": "2012-05-03T14:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144648",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

PS: permutation.h seems not to be present in the sources.



---

archive/issue_comments_144649.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nPS: The same error occurs when trying to rebuild libm4rie spkg: M4RIE expects permutation.h",
    "created_at": "2012-05-03T14:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144649",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

PS: The same error occurs when trying to rebuild libm4rie spkg: M4RIE expects permutation.h



---

archive/issue_comments_144650.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYes, #12841 is a dependency of this ticket.",
    "created_at": "2012-05-03T14:54:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144650",
    "user": "https://github.com/malb"
}
```

<div id="comment:13" align="right">comment:13</div>

Yes, #12841 is a dependency of this ticket.



---

archive/issue_comments_144651.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOuch. I missed #12841. Sorry.",
    "created_at": "2012-05-03T15:50:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144651",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

Ouch. I missed #12841. Sorry.



---

archive/issue_comments_144652.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAm I right that both spkgs have to be installed, but #12840 goes before #12841?",
    "created_at": "2012-05-03T15:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144652",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

Am I right that both spkgs have to be installed, but #12840 goes before #12841?



---

archive/issue_comments_144653.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nYippie! Applying the patches from #12840 and #12841, installing the new m4ri spkg from here, then installing the new m4rie spkg from #12841 (why is it on a different ticket? Can one live without the other?), re-installing polybori and finally sage -br, Sage starts!",
    "created_at": "2012-05-03T16:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144653",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Yippie! Applying the patches from #12840 and #12841, installing the new m4ri spkg from here, then installing the new m4rie spkg from #12841 (why is it on a different ticket? Can one live without the other?), re-installing polybori and finally sage -br, Sage starts!



---

archive/issue_comments_144654.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@simon-king-jena](#comment:16):\n> Yippie! Applying the patches from #12840 and #12841, installing the new m4ri spkg from here, then installing the new m4rie spkg from #12841 (why is it on a different ticket? Can one live without the other?), \n\nNo, you're right, they are co-dependent.",
    "created_at": "2012-05-03T16:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144654",
    "user": "https://github.com/malb"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@simon-king-jena](#comment:16):
> Yippie! Applying the patches from #12840 and #12841, installing the new m4ri spkg from here, then installing the new m4rie spkg from #12841 (why is it on a different ticket? Can one live without the other?), 

No, you're right, they are co-dependent.



---

archive/issue_comments_144655.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFirst of all: make ptestlong works with the two new spkgs (even though I have a few other patches applied...).\n\nHere is a small timing.\n\nVanilla Sage-5.0.rc0:\n\n```\nsage: K = GF(2)\nsage: %time A = random_matrix(K,20000,20000)\nCPU times: user 0.29 s, sys: 0.02 s, total: 0.31 s\nWall time: 0.31 s\nsage: %time B = random_matrix(K,20000,20000)\nCPU times: user 0.23 s, sys: 0.03 s, total: 0.26 s\nWall time: 0.27 s\nsage: %time (A*B).rank()\nCPU times: user 11.70 s, sys: 0.05 s, total: 11.75 s\nWall time: 11.81 s\n19937\n```\n\nSage-5.0.beta13 with the new spkgs (and some other patches that shouldn't affect the timing for matrix multiplication):\n\n```\nsage: K = GF(2)\nsage: %time A = random_matrix(K,20000,20000)\nCPU times: user 0.30 s, sys: 0.03 s, total: 0.33 s\nWall time: 0.33 s\nsage: %time B = random_matrix(K,20000,20000)\nCPU times: user 0.32 s, sys: 0.01 s, total: 0.33 s\nWall time: 0.33 s\nsage: %time (A*B).rank()\nCPU times: user 11.70 s, sys: 0.10 s, total: 11.80 s\nWall time: 11.83 s\n19937\n```\nWell, at least there is no slow-down...\n\nDo you claim that the new version of M4RI is faster? You do claim a speed-up for M4RIE, on #12841.",
    "created_at": "2012-05-03T19:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144655",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

First of all: make ptestlong works with the two new spkgs (even though I have a few other patches applied...).

Here is a small timing.

Vanilla Sage-5.0.rc0:

```
sage: K = GF(2)
sage: %time A = random_matrix(K,20000,20000)
CPU times: user 0.29 s, sys: 0.02 s, total: 0.31 s
Wall time: 0.31 s
sage: %time B = random_matrix(K,20000,20000)
CPU times: user 0.23 s, sys: 0.03 s, total: 0.26 s
Wall time: 0.27 s
sage: %time (A*B).rank()
CPU times: user 11.70 s, sys: 0.05 s, total: 11.75 s
Wall time: 11.81 s
19937
```

Sage-5.0.beta13 with the new spkgs (and some other patches that shouldn't affect the timing for matrix multiplication):

```
sage: K = GF(2)
sage: %time A = random_matrix(K,20000,20000)
CPU times: user 0.30 s, sys: 0.03 s, total: 0.33 s
Wall time: 0.33 s
sage: %time B = random_matrix(K,20000,20000)
CPU times: user 0.32 s, sys: 0.01 s, total: 0.33 s
Wall time: 0.33 s
sage: %time (A*B).rank()
CPU times: user 11.70 s, sys: 0.10 s, total: 11.80 s
Wall time: 11.83 s
19937
```
Well, at least there is no slow-down...

Do you claim that the new version of M4RI is faster? You do claim a speed-up for M4RIE, on #12841.



---

archive/issue_comments_144656.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@simon-king-jena](#comment:18):\n> Do you claim that the new version of M4RI is faster? You do claim a speed-up for M4RIE, on #12841.\n\nNo, M4RI shouldn't have changed (at least the stuff, only bugfixes & refactoring. \n\nThat said, there's a new function for inverting upper triangular matrices which is much faster than the generic method, but it's not exposed yet. I need to implement the same for lower triangular matrices, then we can speed up inversions in general.\n\nFurthermore, M4RI ships its own PNG reader/writer now which is much faster than what we have in Sage and uses much less memory. Again, it's not used yet. This patch just gets the new version in.",
    "created_at": "2012-05-03T20:44:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144656",
    "user": "https://github.com/malb"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@simon-king-jena](#comment:18):
> Do you claim that the new version of M4RI is faster? You do claim a speed-up for M4RIE, on #12841.

No, M4RI shouldn't have changed (at least the stuff, only bugfixes & refactoring. 

That said, there's a new function for inverting upper triangular matrices which is much faster than the generic method, but it's not exposed yet. I need to implement the same for lower triangular matrices, then we can speed up inversions in general.

Furthermore, M4RI ships its own PNG reader/writer now which is much faster than what we have in Sage and uses much less memory. Again, it's not used yet. This patch just gets the new version in.



---

archive/issue_comments_144657.json:
```json
{
    "body": "Reviewer: **Simon King**",
    "created_at": "2012-05-04T11:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144657",
    "user": "https://github.com/simon-king-jena"
}
```

Reviewer: **Simon King**



---

archive/issue_events_177193.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-05-04T11:21:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177193"
}
```



---

archive/issue_events_177194.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-05-04T11:21:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177194"
}
```



---

archive/issue_comments_144658.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSince make ptestlong passes and the hg repository in the package is fine and SPKG.txt is up to date, I think I can give a positive review. However, I only tested on one platform. So, if the release manager believes that this is not enough, then please speak up!",
    "created_at": "2012-05-04T11:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144658",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:20" align="right">comment:20</div>

Since make ptestlong passes and the hg repository in the package is fine and SPKG.txt is up to date, I think I can give a positive review. However, I only tested on one platform. So, if the release manager believes that this is not enough, then please speak up!



---

archive/issue_comments_144659.json:
```json
{
    "body": "Changed dependencies from **#12841** to **to be merged wth #12841**",
    "created_at": "2012-05-07T06:44:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144659",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#12841** to **to be merged wth #12841**



---

archive/issue_comments_144660.json:
```json
{
    "body": "Changed dependencies from **to be merged wth #12841** to **to be merged with #12841**",
    "created_at": "2012-05-07T06:45:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144660",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **to be merged wth #12841** to **to be merged with #12841**



---

archive/issue_comments_144661.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThis fails to install on the Skynet machine \"eno\" (Fedora 16 x86_64):\n\n```\n/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -g -fPIC -Wall -pedantic -O2 -release 0.0.20111203 -no\n-undefined  -o libm4ri.la -rpath /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/local/lib brilliantrussian.lo misc.lo mzd.l\no graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io\n.lo -lm -lpng\nlibtool: link: gcc -shared  -fPIC -DPIC  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .\nlibs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dum\np.o .libs/io.o   -lm -lpng  -mmmx -msse -msse2 -msse3 -O2   -Wl,-soname -Wl,libm4ri-0.0.20111203.so -o .libs/libm4ri-0.0.20111203.so\n/usr/bin/ld: cannot find -lpng\ncollect2: ld returned 1 exit status\nmake[1]: *** [libm4ri.la] Error 1\nmake[1]: Leaving directory `/home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/spkg/build/libm4ri-20120415/src'\nmake: *** [all] Error 2\nError building libm4ri\n```\n\n```\n$ ls -l local/lib/libpng*\n36k -rw-r--r-- 1 buildbot sage 828k May  8 06:16 local/lib/libpng12.a\n4.1k -rwxr-xr-x 1 buildbot sage 1.1k May  8 06:16 local/lib/libpng12.la*\n   0 lrwxrwxrwx 1 buildbot sage   18 May  8 06:16 local/lib/libpng12.so -> libpng12.so.0.35.0*\n   0 lrwxrwxrwx 1 buildbot sage   18 May  8 06:16 local/lib/libpng12.so.0 -> libpng12.so.0.35.0*\n467k -rwxr-xr-x 1 buildbot sage 460k May  8 06:16 local/lib/libpng12.so.0.35.0*\n\n$ ls -l /lib*/libpng* /usr/lib*/libpng*\nls: cannot access /lib*/libpng*: No such file or directory\n   0 lrwxrwxrwx 1 root root   16 May  2 11:53 /usr/lib64/libpng.so.3 -> libpng.so.3.49.0*\n173k -rwxr-xr-x 1 root root 172k Apr  7 14:33 /usr/lib64/libpng.so.3.49.0*\n   0 lrwxrwxrwx 1 root root   18 May  2 11:53 /usr/lib64/libpng12.so.0 -> libpng12.so.0.49.0*\n164k -rwxr-xr-x 1 root root 162k Apr  7 14:33 /usr/lib64/libpng12.so.0.49.0*\n```\n\nNote that there is no file `/usr/lib64/libpng.so`, so obviously there cannot be proper PNG support on this machine.  I consider this to be an upstream (not Sage) error.\n\n```\n$ grep -i png spkg/logs/libm4ri-20120415.log\nchecking whether to build with PNG support... yes\nchecking for PNG... no\nchecking for PNG... yes\n/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -g -fPIC -Wall -pedantic -O2 -release 0.0.20111203 -no-undefined  -o libm4ri.la -rpath /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/local/lib brilliantrussian.lo misc.lo mzd.lo graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io.lo -lm -lpng\nlibtool: link: gcc -shared  -fPIC -DPIC  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .libs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dump.o .libs/io.o   -lm -lpng  -mmmx -msse -msse2 -msse3 -O2   -Wl,-soname -Wl,libm4ri-0.0.20111203.so -o .libs/libm4ri-0.0.20111203.so\n/usr/bin/ld: cannot find -lpng\n```",
    "created_at": "2012-05-08T12:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144661",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

This fails to install on the Skynet machine "eno" (Fedora 16 x86_64):

```
/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -g -fPIC -Wall -pedantic -O2 -release 0.0.20111203 -no
-undefined  -o libm4ri.la -rpath /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/local/lib brilliantrussian.lo misc.lo mzd.l
o graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io
.lo -lm -lpng
libtool: link: gcc -shared  -fPIC -DPIC  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .
libs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dum
p.o .libs/io.o   -lm -lpng  -mmmx -msse -msse2 -msse3 -O2   -Wl,-soname -Wl,libm4ri-0.0.20111203.so -o .libs/libm4ri-0.0.20111203.so
/usr/bin/ld: cannot find -lpng
collect2: ld returned 1 exit status
make[1]: *** [libm4ri.la] Error 1
make[1]: Leaving directory `/home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/spkg/build/libm4ri-20120415/src'
make: *** [all] Error 2
Error building libm4ri
```

```
$ ls -l local/lib/libpng*
36k -rw-r--r-- 1 buildbot sage 828k May  8 06:16 local/lib/libpng12.a
4.1k -rwxr-xr-x 1 buildbot sage 1.1k May  8 06:16 local/lib/libpng12.la*
   0 lrwxrwxrwx 1 buildbot sage   18 May  8 06:16 local/lib/libpng12.so -> libpng12.so.0.35.0*
   0 lrwxrwxrwx 1 buildbot sage   18 May  8 06:16 local/lib/libpng12.so.0 -> libpng12.so.0.35.0*
467k -rwxr-xr-x 1 buildbot sage 460k May  8 06:16 local/lib/libpng12.so.0.35.0*

$ ls -l /lib*/libpng* /usr/lib*/libpng*
ls: cannot access /lib*/libpng*: No such file or directory
   0 lrwxrwxrwx 1 root root   16 May  2 11:53 /usr/lib64/libpng.so.3 -> libpng.so.3.49.0*
173k -rwxr-xr-x 1 root root 172k Apr  7 14:33 /usr/lib64/libpng.so.3.49.0*
   0 lrwxrwxrwx 1 root root   18 May  2 11:53 /usr/lib64/libpng12.so.0 -> libpng12.so.0.49.0*
164k -rwxr-xr-x 1 root root 162k Apr  7 14:33 /usr/lib64/libpng12.so.0.49.0*
```

Note that there is no file `/usr/lib64/libpng.so`, so obviously there cannot be proper PNG support on this machine.  I consider this to be an upstream (not Sage) error.

```
$ grep -i png spkg/logs/libm4ri-20120415.log
checking whether to build with PNG support... yes
checking for PNG... no
checking for PNG... yes
/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -g -fPIC -Wall -pedantic -O2 -release 0.0.20111203 -no-undefined  -o libm4ri.la -rpath /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.1.beta1/local/lib brilliantrussian.lo misc.lo mzd.lo graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io.lo -lm -lpng
libtool: link: gcc -shared  -fPIC -DPIC  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .libs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dump.o .libs/io.o   -lm -lpng  -mmmx -msse -msse2 -msse3 -O2   -Wl,-soname -Wl,libm4ri-0.0.20111203.so -o .libs/libm4ri-0.0.20111203.so
/usr/bin/ld: cannot find -lpng
```



---

archive/issue_events_177195.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-08T12:02:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177195"
}
```



---

archive/issue_events_177196.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-08T12:02:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177196"
}
```



---

archive/issue_comments_144662.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nWhy are you using `PKG_CHECK_MODULES()` to check for PNG support in `configure.ac`?  Why not `AC_CHECK_LIB()` or `AC_SEARCH_LIBS()`?",
    "created_at": "2012-05-08T12:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144662",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Why are you using `PKG_CHECK_MODULES()` to check for PNG support in `configure.ac`?  Why not `AC_CHECK_LIB()` or `AC_SEARCH_LIBS()`?



---

archive/issue_comments_144663.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nExactly the same problem with `-lpng` happens on Skynet \"cleo\" (RHEL 5.3 ia64)",
    "created_at": "2012-05-08T13:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144663",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Exactly the same problem with `-lpng` happens on Skynet "cleo" (RHEL 5.3 ia64)



---

archive/issue_comments_144664.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jdemeyer](#comment:24):\n> Why are you using `PKG_CHECK_MODULES()` to check for PNG support in `configure.ac`?  Why not `AC_CHECK_LIB()` or `AC_SEARCH_LIBS()`?\n\nWe are doing both. We try `pkg-config` first and if that fails we fall back to `AC_CHECK_LIB`. In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.",
    "created_at": "2012-05-08T20:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144664",
    "user": "https://github.com/malb"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jdemeyer](#comment:24):
> Why are you using `PKG_CHECK_MODULES()` to check for PNG support in `configure.ac`?  Why not `AC_CHECK_LIB()` or `AC_SEARCH_LIBS()`?

We are doing both. We try `pkg-config` first and if that fails we fall back to `AC_CHECK_LIB`. In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.



---

archive/issue_comments_144665.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nNote that stand-alone M4RI builds fine on eno.\n\n```\nchecking pkg-config is at least version 0.9.0... yes\nchecking for PNG... no\nchecking for PNG... no\nchecking for PNG... no\nchecking for PNG... no\nchecking for png_create_write_struct in -lpng... no\n```\n\nSo I don't know why it fails when built inside Sage. In any case, Sage **ships** libpng so we should adapt `deps` to make M4RI dependent on libpng. I'll provide a patch to that effect.",
    "created_at": "2012-05-08T20:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144665",
    "user": "https://github.com/malb"
}
```

<div id="comment:27" align="right">comment:27</div>

Note that stand-alone M4RI builds fine on eno.

```
checking pkg-config is at least version 0.9.0... yes
checking for PNG... no
checking for PNG... no
checking for PNG... no
checking for PNG... no
checking for png_create_write_struct in -lpng... no
```

So I don't know why it fails when built inside Sage. In any case, Sage **ships** libpng so we should adapt `deps` to make M4RI dependent on libpng. I'll provide a patch to that effect.



---

archive/issue_comments_144666.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nAttachment: **[trac_12840_m4ri_png.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)**\n\nReplying to [@malb](#comment:26):\n> In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.\n\nActually, it's not quite like that.  `PKG_CHECK_MODULES()` found `libpng12`  but you still try to link with `-lpng` instead of `-lpng12` (the first failure comes from the `libpng14` check).  `AC_CHECK_LIB()` isn't called (but it would fail).",
    "created_at": "2012-05-08T20:34:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144666",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Attachment: **[trac_12840_m4ri_png.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)**

Replying to [@malb](#comment:26):
> In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.

Actually, it's not quite like that.  `PKG_CHECK_MODULES()` found `libpng12`  but you still try to link with `-lpng` instead of `-lpng12` (the first failure comes from the `libpng14` check).  `AC_CHECK_LIB()` isn't called (but it would fail).



---

archive/issue_events_177197.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-08T20:34:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177197"
}
```



---

archive/issue_events_177198.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-08T20:34:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177198"
}
```



---

archive/issue_comments_144667.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n **Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n \n **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n+\n+**Apply:** [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)\n``````\n",
    "created_at": "2012-05-08T20:34:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144667",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 **Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
 
 **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
+
+**Apply:** [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)
``````




---

archive/issue_comments_144668.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI recommend against using `PKG_CHECK_MODULES()` and would use only `AC_SEARCH_LIBS()`.",
    "created_at": "2012-05-08T20:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144668",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

I recommend against using `PKG_CHECK_MODULES()` and would use only `AC_SEARCH_LIBS()`.



---

archive/issue_comments_144669.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe patch you attached is probably good, but that's just part of the problem.",
    "created_at": "2012-05-08T20:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144669",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

The patch you attached is probably good, but that's just part of the problem.



---

archive/issue_events_177199.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-08T20:36:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177199"
}
```



---

archive/issue_events_177200.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-08T20:36:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177200"
}
```



---

archive/issue_comments_144670.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment:31):\n> The patch you attached is probably good, but that's just part of the problem.\n\nCan you elaborate on that? I don't understand.",
    "created_at": "2012-05-08T20:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144670",
    "user": "https://github.com/malb"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment:31):
> The patch you attached is probably good, but that's just part of the problem.

Can you elaborate on that? I don't understand.



---

archive/issue_comments_144671.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@malb](#comment:32):\n> Can you elaborate on that? I don't understand.\n\nWell, I tried to explain in [https://github.com/sagemath/sage/issues/12840#comment:28](https://github.com/sagemath/sage/issues/12840#comment:28).  The fact that\n\n```\nPKG_CHECK_MODULES([PNG], [libpng12])\n```\nsucceeds, does not imply that the library file `libpng.so` exists.  I don't see what you're trying to accomplish with those `PKG_CHECK_MODULES()` checks.",
    "created_at": "2012-05-09T06:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144671",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@malb](#comment:32):
> Can you elaborate on that? I don't understand.

Well, I tried to explain in [https://github.com/sagemath/sage/issues/12840#comment:28](https://github.com/sagemath/sage/issues/12840#comment:28).  The fact that

```
PKG_CHECK_MODULES([PNG], [libpng12])
```
succeeds, does not imply that the library file `libpng.so` exists.  I don't see what you're trying to accomplish with those `PKG_CHECK_MODULES()` checks.



---

archive/issue_comments_144672.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI can try to write a patch if you like.",
    "created_at": "2012-05-09T06:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144672",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

I can try to write a patch if you like.



---

archive/issue_comments_144673.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@jdemeyer](#comment:33):\n> Replying to [@malb](#comment:32):\n> > Can you elaborate on that? I don't understand.\n\n> \n> ```\n> PKG_CHECK_MODULES([PNG], [libpng12])\n> ```\n> succeeds, does not imply that the library file `libpng.so` exists.  \n\nAh, right. It would need `-lpng12`. Yep, that's a bug. I'll fix that next week-ish.\n\n> I don't see what you're trying to accomplish with those `PKG_CHECK_MODULES()` checks.\n\nI am trying to use pkg-config for what it's intended. Making linking easier.",
    "created_at": "2012-05-10T08:47:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144673",
    "user": "https://github.com/malb"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@jdemeyer](#comment:33):
> Replying to [@malb](#comment:32):
> > Can you elaborate on that? I don't understand.

> 
> ```
> PKG_CHECK_MODULES([PNG], [libpng12])
> ```
> succeeds, does not imply that the library file `libpng.so` exists.  

Ah, right. It would need `-lpng12`. Yep, that's a bug. I'll fix that next week-ish.

> I don't see what you're trying to accomplish with those `PKG_CHECK_MODULES()` checks.

I am trying to use pkg-config for what it's intended. Making linking easier.



---

archive/issue_comments_144674.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nMaybe you're using it for *what* it's intended, but not *how* it's intended.",
    "created_at": "2012-05-10T09:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144674",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Maybe you're using it for *what* it's intended, but not *how* it's intended.



---

archive/issue_comments_144675.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jdemeyer](#comment:28):\n> Replying to [@malb](#comment:26):\n> > In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.\n\n> Actually, it's not quite like that.  `PKG_CHECK_MODULES()` found `libpng12`  but you still try to link with `-lpng` instead of `-lpng12` (the first failure comes from the `libpng14` check).  `AC_CHECK_LIB()` isn't called (but it would fail).\n\nFor some reason I missed this comment earlier, sorry. That makes sense & is an upstream bug which I intend to fix.",
    "created_at": "2012-05-10T11:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144675",
    "user": "https://github.com/malb"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jdemeyer](#comment:28):
> Replying to [@malb](#comment:26):
> > In your log above, `PKG_CHECK_MODULES()` fails to find libpng and `AC_CHECK_LIB()` finds it.

> Actually, it's not quite like that.  `PKG_CHECK_MODULES()` found `libpng12`  but you still try to link with `-lpng` instead of `-lpng12` (the first failure comes from the `libpng14` check).  `AC_CHECK_LIB()` isn't called (but it would fail).

For some reason I missed this comment earlier, sorry. That makes sense & is an upstream bug which I intend to fix.



---

archive/issue_comments_144676.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@jdemeyer](#comment:36):\n> Maybe you're using it for *what* it's intended, but not *how* it's intended.\n\nThis is a remarkably unhelpful comment.",
    "created_at": "2012-05-10T11:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144676",
    "user": "https://github.com/malb"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@jdemeyer](#comment:36):
> Maybe you're using it for *what* it's intended, but not *how* it's intended.

This is a remarkably unhelpful comment.



---

archive/issue_comments_144677.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@malb](#comment:38):\n> This is a remarkably unhelpful comment.\n\nI know, but I have never done anything with pkgconfig, so I can't help more.",
    "created_at": "2012-05-10T11:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144677",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@malb](#comment:38):
> This is a remarkably unhelpful comment.

I know, but I have never done anything with pkgconfig, so I can't help more.



---

archive/issue_comments_144678.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI've updated the SPKG with a new upstream release which should fix the png issue.\n\nhttp://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg",
    "created_at": "2012-05-22T15:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144678",
    "user": "https://github.com/malb"
}
```

<div id="comment:40" align="right">comment:40</div>

I've updated the SPKG with a new upstream release which should fix the png issue.

http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg



---

archive/issue_comments_144679.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n As the title says.\n \n-**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg\n+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg\n \n **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n \n``````\n",
    "created_at": "2012-05-22T15:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144679",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 As the title says.
 
-**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120415.spkg
+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg
 
 **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
 
``````




---

archive/issue_events_177201.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-22T15:36:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177201"
}
```



---

archive/issue_events_177202.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-22T15:36:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177202"
}
```



---

archive/issue_comments_144680.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nCould someone please review this. I am looking into updating LinBox and updating M4RIE is a requirement for that (long story involving Givaro).",
    "created_at": "2012-06-06T20:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144680",
    "user": "https://github.com/malb"
}
```

<div id="comment:42" align="right">comment:42</div>

Could someone please review this. I am looking into updating LinBox and updating M4RIE is a requirement for that (long story involving Givaro).



---

archive/issue_comments_144681.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@malb](#comment:42):\n> Could someone please review this. I am looking into updating LinBox and updating M4RIE is a requirement for that (long story involving Givaro).\n\nI could test the code on one or two linuxes. But I couldn't test whether the png problems on eno (as observed by Jeroen) are fixed. Jeroen, could you finish the review?",
    "created_at": "2012-06-07T09:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144681",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@malb](#comment:42):
> Could someone please review this. I am looking into updating LinBox and updating M4RIE is a requirement for that (long story involving Givaro).

I could test the code on one or two linuxes. But I couldn't test whether the png problems on eno (as observed by Jeroen) are fixed. Jeroen, could you finish the review?



---

archive/issue_comments_144682.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n \n-**Apply:** [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)\n+**Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)\n``````\n",
    "created_at": "2012-06-07T12:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144682",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
 
-**Apply:** [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)
+**Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)
``````




---

archive/issue_comments_144683.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n As the title says.\n \n-**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg\n+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg\n \n **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n \n``````\n",
    "created_at": "2012-06-07T16:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144683",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 As the title says.
 
-**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120522.spkg
+**Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg
 
 **Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
 
``````




---

archive/issue_comments_144684.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThe **previous** version installed fine on eno within Sage.  It seems the `libpng` check is totally gone now.",
    "created_at": "2012-06-07T16:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144684",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

The **previous** version installed fine on eno within Sage.  It seems the `libpng` check is totally gone now.



---

archive/issue_comments_144685.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@jdemeyer](#comment:46):\n> The **previous** version installed fine on eno within Sage. \n\n\n>It seems the `libpng` check is totally gone now.\n\nThat's strange, it doesn't check?\n\nI had to update SPKG because I didn't add \"-I$SAGE_LOCAL/include\" before but we need it now because of the PNG dependency. The newest SPKG installs fine on geom.math which doesn't have a system libpng-dev.",
    "created_at": "2012-06-07T16:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144685",
    "user": "https://github.com/malb"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@jdemeyer](#comment:46):
> The **previous** version installed fine on eno within Sage. 


>It seems the `libpng` check is totally gone now.

That's strange, it doesn't check?

I had to update SPKG because I didn't add "-I$SAGE_LOCAL/include" before but we need it now because of the PNG dependency. The newest SPKG installs fine on geom.math which doesn't have a system libpng-dev.



---

archive/issue_comments_144686.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI've tried this on Fedora 17 (which doesn't have libpng12 either, its up to libpng15 now) and configure works as intended:\n\n```\nchecking whether to build with PNG support... yes\nchecking for pkg-config... /usr/bin/pkg-config\nchecking pkg-config is at least version 0.9.0... yes\nchecking for PNG... yes\n```\nJeroen, you might have overlooked this part in the log since it comes after the lengthy \"checking for cache sizes...\".\n\nI'm building on eno right now and if it works I'll set this ticket to positive review.",
    "created_at": "2012-06-17T13:08:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144686",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

I've tried this on Fedora 17 (which doesn't have libpng12 either, its up to libpng15 now) and configure works as intended:

```
checking whether to build with PNG support... yes
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for PNG... yes
```
Jeroen, you might have overlooked this part in the log since it comes after the lengthy "checking for cache sizes...".

I'm building on eno right now and if it works I'll set this ticket to positive review.



---

archive/issue_comments_144687.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nSo Fedora has libpng.so then? I am asking because I am not checking for png15 explicitly.\n\n```\nif test \"x${want_png}\" = \"xyes\" ; then\n   PKG_CHECK_MODULES([PNG], [libpng],\n      [have_libpng=\"yes\"; LIBPNG_LIBADD=`pkg-config --libs libpng`],\n      [have_libpng=\"no\"])\n   if ! test \"x${have_libpng}\" = \"xyes\" ; then\n      AC_CHECK_LIB([png],\n         [png_create_write_struct],\n         [have_libpng=\"yes\"; LIBPNG_LIBADD=\"-lpng\"],\n         [AC_CHECK_LIB([png14],\n            [png_create_write_struct],\n            [have_libpng=\"yes\"; LIBPNG_LIBADD=\"-lpng14\"],\n            [AC_CHECK_LIB([png12],\n               [png_create_write_struct],\n               [have_libpng=\"yes\"; LIBPNG_LIBADD=\"-lpng12\"],\n               [AC_CHECK_LIB([png10],\n                  [png_create_write_struct],\n                  [have_libpng=\"yes\"; LIBPNG_LIBADD=\"-lpng10\"],\n                  [have_libpng=\"no\"])\n               ])\n            ])\n        ])\n   fi\n   if test \"x${have_libpng}\" = \"xno\" ; then\n      AC_MSG_WARN([Can not find a usuable PNG library. Make sure that CPPFLAGS and LDFLAGS are correctly set.])\n   fi\nfi\n\n```",
    "created_at": "2012-06-17T13:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144687",
    "user": "https://github.com/malb"
}
```

<div id="comment:49" align="right">comment:49</div>

So Fedora has libpng.so then? I am asking because I am not checking for png15 explicitly.

```
if test "x${want_png}" = "xyes" ; then
   PKG_CHECK_MODULES([PNG], [libpng],
      [have_libpng="yes"; LIBPNG_LIBADD=`pkg-config --libs libpng`],
      [have_libpng="no"])
   if ! test "x${have_libpng}" = "xyes" ; then
      AC_CHECK_LIB([png],
         [png_create_write_struct],
         [have_libpng="yes"; LIBPNG_LIBADD="-lpng"],
         [AC_CHECK_LIB([png14],
            [png_create_write_struct],
            [have_libpng="yes"; LIBPNG_LIBADD="-lpng14"],
            [AC_CHECK_LIB([png12],
               [png_create_write_struct],
               [have_libpng="yes"; LIBPNG_LIBADD="-lpng12"],
               [AC_CHECK_LIB([png10],
                  [png_create_write_struct],
                  [have_libpng="yes"; LIBPNG_LIBADD="-lpng10"],
                  [have_libpng="no"])
               ])
            ])
        ])
   fi
   if test "x${have_libpng}" = "xno" ; then
      AC_MSG_WARN([Can not find a usuable PNG library. Make sure that CPPFLAGS and LDFLAGS are correctly set.])
   fi
fi

```



---

archive/issue_comments_144688.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@malb](#comment:49):\n\n> So Fedora has libpng.so then? I am asking because I am not checking for png15 explicitly.\u00a0\n\nArgh, I am stupid. It would find libpng12 as included in Sage. Sorry bout the noise.",
    "created_at": "2012-06-17T13:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144688",
    "user": "https://github.com/malb"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@malb](#comment:49):

> So Fedora has libpng.so then? I am asking because I am not checking for png15 explicitly. 

Argh, I am stupid. It would find libpng12 as included in Sage. Sorry bout the noise.



---

archive/issue_comments_144689.json:
```json
{
    "body": "Changed reviewer from **Simon King** to **Simon King, Volker Braun**",
    "created_at": "2012-06-18T10:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144689",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Simon King** to **Simon King, Volker Braun**



---

archive/issue_comments_144690.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nYes the `PKG_CHECK_MODULES` test wins in Sage, which is the way it should be. pkg-config is the way to go imho. Though if libpng were to use standard libtool versioning we would live in a better world, too ;-)\n\nIn any case, built and tested fine on eno. Positive review.",
    "created_at": "2012-06-18T10:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144690",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:51" align="right">comment:51</div>

Yes the `PKG_CHECK_MODULES` test wins in Sage, which is the way it should be. pkg-config is the way to go imho. Though if libpng were to use standard libtool versioning we would live in a better world, too ;-)

In any case, built and tested fine on eno. Positive review.



---

archive/issue_events_177203.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:58:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177203"
}
```



---

archive/issue_events_177204.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:58:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177204"
}
```



---

archive/issue_events_177205.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177205"
}
```



---

archive/issue_events_177206.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177206"
}
```



---

archive/issue_comments_144691.json:
```json
{
    "body": "Attachment: **[trac_12840-rebased-on-13109.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)**",
    "created_at": "2012-06-30T17:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144691",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_12840-rebased-on-13109.patch.gz](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)**



---

archive/issue_comments_144692.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThe deprecations here should use the format from #13109.",
    "created_at": "2012-06-30T17:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144692",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:53" align="right">comment:53</div>

The deprecations here should use the format from #13109.



---

archive/issue_events_177207.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-06-30T17:58:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177207"
}
```



---

archive/issue_events_177208.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-06-30T17:58:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177208"
}
```



---

archive/issue_comments_144693.json:
```json
{
    "body": "Changed dependencies from **to be merged with #12841** to **to be merged with #12841, #13109**",
    "created_at": "2012-06-30T17:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144693",
    "user": "https://github.com/jhpalmieri"
}
```

Changed dependencies from **to be merged with #12841** to **to be merged with #12841, #13109**



---

archive/issue_comments_144694.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n **Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg\n \n-**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)\n+**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz), [attachment: trac_12840-rebased-on-13109.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)\n \n **Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)\n``````\n",
    "created_at": "2012-06-30T17:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144694",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 **Install: **http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20120613.spkg
 
-**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz)
+**Apply:** [attachment: trac_12840_m4ri_new_version.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_new_version.patch.gz), [attachment: trac_12840-rebased-on-13109.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840-rebased-on-13109.patch.gz)
 
 **Apply** to `SAGE_ROOT`: [attachment: trac_12840_m4ri_png.patch](https://github.com/sagemath/sage/files/ticket12840/trac_12840_m4ri_png.patch.gz)
``````




---

archive/issue_events_177209.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-06-30T17:58:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177209"
}
```



---

archive/issue_events_177210.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-06-30T17:58:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177210"
}
```



---

archive/issue_comments_144695.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThe deprecations are not doctested.",
    "created_at": "2012-06-30T19:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144695",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:55" align="right">comment:55</div>

The deprecations are not doctested.



---

archive/issue_events_177211.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T19:49:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177211"
}
```



---

archive/issue_events_177212.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T19:49:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177212"
}
```



---

archive/issue_comments_144696.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nHmm deprecations (and any other warnings) don't work in cdef methods. I guess we can't doctest them, for now.",
    "created_at": "2012-06-30T19:49:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144696",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:56" align="right">comment:56</div>

Hmm deprecations (and any other warnings) don't work in cdef methods. I guess we can't doctest them, for now.



---

archive/issue_comments_144697.json:
```json
{
    "body": "Changed author from **Martin Albrecht** to **Martin Albrecht, John Palmieri**",
    "created_at": "2012-06-30T19:49:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144697",
    "user": "https://github.com/vbraun"
}
```

Changed author from **Martin Albrecht** to **Martin Albrecht, John Palmieri**



---

archive/issue_events_177213.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177213"
}
```



---

archive/issue_events_177214.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177214"
}
```



---

archive/issue_events_177215.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177215"
}
```



---

archive/issue_events_177216.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177216"
}
```



---

archive/issue_events_177217.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177217"
}
```



---

archive/issue_events_177218.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177218"
}
```



---

archive/issue_comments_144698.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThis needs to be rebased to sage-5.2.rc1.",
    "created_at": "2012-07-27T20:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144698",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

This needs to be rebased to sage-5.2.rc1.



---

archive/issue_comments_144699.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nCan you clarify the rebasing issues? I have no problems applying the patches from here and from #12841 on top of sage-5.2.rc1.",
    "created_at": "2012-07-27T21:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144699",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:60" align="right">comment:60</div>

Can you clarify the rebasing issues? I have no problems applying the patches from here and from #12841 on top of sage-5.2.rc1.



---

archive/issue_comments_144700.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI'm with John here, I've been carrying the mari/e/givaro/linbox patches in my queue for a while now and there was no breakage in sage-5.2.rc1 as far as I can tell.",
    "created_at": "2012-07-28T03:45:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144700",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:61" align="right">comment:61</div>

I'm with John here, I've been carrying the mari/e/givaro/linbox patches in my queue for a while now and there was no breakage in sage-5.2.rc1 as far as I can tell.



---

archive/issue_events_177219.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-28T09:30:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177219"
}
```



---

archive/issue_events_177220.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-28T09:30:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177220"
}
```



---

archive/issue_comments_144701.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nMy mistake, I only applied the second Sage library patch and that didn't work.",
    "created_at": "2012-07-28T09:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144701",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

My mistake, I only applied the second Sage library patch and that didn't work.



---

archive/issue_events_177221.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177221"
}
```



---

archive/issue_events_177222.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12840#event-177222"
}
```



---

archive/issue_comments_144702.json:
```json
{
    "body": "Merged: **sage-5.3.beta0**",
    "created_at": "2012-08-01T12:10:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12840#issuecomment-144702",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.3.beta0**
