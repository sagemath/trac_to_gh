# Issue 12361: Fix normalization in cohomology ring of orbifold toric varieties

archive/issues_012189.json:
```json
{
    "body": "For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the `volume_class()` and the constructor of cohomology cycles from cones to make everything work.\n\nIt turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.\n\nApply [attachment:trac_12361_fix_toric_cohomology_ring.patch], [attachment:trac_12361_index_in_saturation_fix.patch]\n\nAssignee: @aghitza\n\nCC:  @novoselt davideklund\n\nReviewer: David Eklund, Andrey Novoseltsev\n\nAuthor: Volker Braun\n\nMerged: sage-5.1.beta0\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12361\n\n",
    "closed_at": "2012-05-06T12:14:21Z",
    "created_at": "2012-01-26T03:51:15Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "Fix normalization in cohomology ring of orbifold toric varieties",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12361",
    "user": "https://github.com/vbraun"
}
```
For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the `volume_class()` and the constructor of cohomology cycles from cones to make everything work.

It turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.

Apply [attachment:trac_12361_fix_toric_cohomology_ring.patch], [attachment:trac_12361_index_in_saturation_fix.patch]

Assignee: @aghitza

CC:  @novoselt davideklund

Reviewer: David Eklund, Andrey Novoseltsev

Author: Volker Braun

Merged: sage-5.1.beta0

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12361





---

archive/issue_comments_150349.json:
```json
{
    "body": "Attachment [trac_12361_index_in_saturation_fix.patch](tarball://root/attachments/some-uuid/ticket12361/trac_12361_index_in_saturation_fix.patch) by @vbraun created at 2012-01-26 03:59:41\n\nInitial patch",
    "created_at": "2012-01-26T03:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150349",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_12361_index_in_saturation_fix.patch](tarball://root/attachments/some-uuid/ticket12361/trac_12361_index_in_saturation_fix.patch) by @vbraun created at 2012-01-26 03:59:41

Initial patch



---

archive/issue_comments_150350.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the \\`volume_class()\\` and the constructor of cohomology cycles from cones to make everything work.\n+\n+It turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.\n+\n+Apply  trac_12361_fix_toric_cohomology_ring.patch, trac_12361_index_in_saturation_fix.patch\n \n Author: Volker Braun\n \n```\n",
    "created_at": "2012-01-26T04:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150350",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
 For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the \`volume_class()\` and the constructor of cohomology cycles from cones to make everything work.
+
+It turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.
+
+Apply  trac_12361_fix_toric_cohomology_ring.patch, trac_12361_index_in_saturation_fix.patch
 
 Author: Volker Braun
 
```




---

archive/issue_comments_150351.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-01-26T04:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150351",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_150352.json:
```json
{
    "body": "<a id='comment:2'></a>The patchbot complains about added whitespace! Looking at the actual code...",
    "created_at": "2012-03-23T15:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150352",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>The patchbot complains about added whitespace! Looking at the actual code...



---

archive/issue_comments_150353.json:
```json
{
    "body": "<a id='comment:3'></a>That's a really great expansion of the documentation!\n\nI think I caught some typos:\n* In `toric_variety` line 213 should be \"many quantities of interest\" without \"s\" on the end.\n* On line 1977 \"It gets tricky none of the maximal cones is smooth.\" does not sound right, some words or punctuation sighs are missing.",
    "created_at": "2012-03-23T16:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150353",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>That's a really great expansion of the documentation!

I think I caught some typos:
* In `toric_variety` line 213 should be "many quantities of interest" without "s" on the end.
* On line 1977 "It gets tricky none of the maximal cones is smooth." does not sound right, some words or punctuation sighs are missing.



---

archive/issue_comments_150354.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-23T21:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150354",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_150355.json:
```json
{
    "body": "<a id='comment:4'></a>OK, other than the above looks good!",
    "created_at": "2012-03-23T21:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150355",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:4'></a>OK, other than the above looks good!



---

archive/issue_comments_150356.json:
```json
{
    "body": "<a id='comment:5'></a>Hi. I looked at this and I agree that it looks good.\n\nOne thing:\n\nOn line 215 of toric_variety.py it says \"For toric varieties with at most orbifold singularities, the rational cohomology ring `H(X,\\QQ)` and the rational Chow ring `H(X,\\QQ)` are isomorphic.\"\n\nIt's a bit confusing that they are both denoted by H(X,\\QQ). Maybe A(X,\\QQ) could be used for the Chow ring. Or `H^*(X,\\QQ)` for cohomology and `H_*(X,\\QQ)` for the Chow ring (if intersection homology and the Chow ring were already identified somehow).",
    "created_at": "2012-03-28T20:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150356",
    "user": "https://trac.sagemath.org/admin/accounts/users/davideklund"
}
```

<a id='comment:5'></a>Hi. I looked at this and I agree that it looks good.

One thing:

On line 215 of toric_variety.py it says "For toric varieties with at most orbifold singularities, the rational cohomology ring `H(X,\QQ)` and the rational Chow ring `H(X,\QQ)` are isomorphic."

It's a bit confusing that they are both denoted by H(X,\QQ). Maybe A(X,\QQ) could be used for the Chow ring. Or `H^*(X,\QQ)` for cohomology and `H_*(X,\QQ)` for the Chow ring (if intersection homology and the Chow ring were already identified somehow).



---

archive/issue_comments_150357.json:
```json
{
    "body": "<a id='comment:7'></a>Oh yes good catch I meant to write `A(X,\\QQ)` of course.",
    "created_at": "2012-03-28T20:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150357",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>Oh yes good catch I meant to write `A(X,\QQ)` of course.



---

archive/issue_comments_150358.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-29T19:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150358",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_150359.json:
```json
{
    "body": "<a id='comment:8'></a>Fixed!",
    "created_at": "2012-03-29T19:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150359",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>Fixed!



---

archive/issue_comments_150360.json:
```json
{
    "body": "<a id='comment:9'></a>Comments 2&3 are still applicable and the patchbot complains ;-)",
    "created_at": "2012-03-29T21:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150360",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:9'></a>Comments 2&3 are still applicable and the patchbot complains ;-)



---

archive/issue_comments_150361.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-29T21:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150361",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_150362.json:
```json
{
    "body": "Attachment [trac_12361_fix_toric_cohomology_ring.patch](tarball://root/attachments/some-uuid/ticket12361/trac_12361_fix_toric_cohomology_ring.patch) by @vbraun created at 2012-03-30 10:15:23\n\nUpdated patch",
    "created_at": "2012-03-30T10:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150362",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_12361_fix_toric_cohomology_ring.patch](tarball://root/attachments/some-uuid/ticket12361/trac_12361_fix_toric_cohomology_ring.patch) by @vbraun created at 2012-03-30 10:15:23

Updated patch



---

archive/issue_comments_150363.json:
```json
{
    "body": "<a id='comment:10'></a>I've improved the docstrings.\n\nAs for the whitespace, I think this is a non-issue. There was some discussion on sage-devel and the consensus seems to be that its not worth the effort. Its a button press away (either with emacs or with the mercurial checkfiles plugin) to strip all trailing whitespace, but that would just break every patch we currently have. Mercurial tells me that there are 170 places in toric_varieties.py with superfluous spaces, so a few more or less doesn't matter. I'd rather not spend an hour fixing all patches that I currently have just to make the whitespace plugin happy.",
    "created_at": "2012-03-30T10:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150363",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>I've improved the docstrings.

As for the whitespace, I think this is a non-issue. There was some discussion on sage-devel and the consensus seems to be that its not worth the effort. Its a button press away (either with emacs or with the mercurial checkfiles plugin) to strip all trailing whitespace, but that would just break every patch we currently have. Mercurial tells me that there are 170 places in toric_varieties.py with superfluous spaces, so a few more or less doesn't matter. I'd rather not spend an hour fixing all patches that I currently have just to make the whitespace plugin happy.



---

archive/issue_comments_150364.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-30T10:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150364",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_150365.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-30T15:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150365",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_150366.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the \\`volume_class()\\` and the constructor of cohomology cycles from cones to make everything work.\n \n+It turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.\n+\n+Apply [attachment:trac_12361_fix_toric_cohomology_ring.patch], [attachment:trac_12361_index_in_saturation_fix.patch]\n \n Author: Volker Braun\n \n```\n",
    "created_at": "2012-04-19T09:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150366",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+For simplicial toric varieties, the rational cohomology ring and the ratironal Chow group are isomorphic. So if all normalizations are correct, then one should be able to do intersection computations in the cohomology ring. This patch fixes the \`volume_class()\` and the constructor of cohomology cycles from cones to make everything work.
 
+It turns out that index_in_saturation does not work for trivial zero-size matrices, this is also fixed.
+
+Apply [attachment:trac_12361_fix_toric_cohomology_ring.patch], [attachment:trac_12361_index_in_saturation_fix.patch]
 
 Author: Volker Braun
 
```




---

archive/issue_events_033123.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-19T09:44:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12361#event-33123"
}
```



---

archive/issue_events_033124.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-06T12:14:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12361#event-33124"
}
```



---

archive/issue_comments_150367.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-06T12:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12361",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12361#issuecomment-150367",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
