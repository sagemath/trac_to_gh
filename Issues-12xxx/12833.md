# Issue 12833: Crashes and doctests problems with Gurobi

archive/issues_012661.json:
```json
{
    "body": "HEllooooooooo !!!\n\nGurobi actually crashed Sage when MixedIntegerLinearProgram(solver=\"Gurobi\") is run with no license installed (or an invalid one). This if fixed by a if var == NULL before free(var).\n\nI also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver=\"GUROBI\" instead of solver=\"Gurobi\". \n\nThere was also a *scary* error in digraph.py : an inequality was actually REVERSED (a <= n had become a >= n) and it is really a wonder that the code did not break before `O_o`. Well, Gurobi did break on that, but the others were doing just fine.\n\nBefore :\n\n```\nsage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      \nsage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  \n7                                                                                                                                                                                                                                                                            \nsage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = \"GUROBI\")\n6\n```\n\nAfter :\n\n```\nsage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      \nsage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  \n7                                                                                                                                                                                                                                                                            \nsage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = \"Gurobi\")\n7\n```\n\nHopefully, the problem came from an optional algorithm, optional because slower than the other one.\n\nAfter this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver. All doctests do not pass in mip.pyx but that is only matters of default names for constraints, and stupid ways to store inequalities inside of Gurobi. For instance :\n\n```\nsage: p = MixedIntegerLinearProgram(solver = \"Gurobi\")        # optional - Gurobi                                                                                                                                                                                    \nsage: p.add_constraint(p[0] - p[2], min = 1, max = 4)         # optional - Gurobi                                                                                                                                                                                    \nsage: p.add_constraint(p[0] - 2*p[1], min = 1)                # optional - Gurobi                                                                                                                                                                                    \nsage: p.show()\nMaximization:\n \nConstraints:\n  R0: 4.0 <= x_0 -x_1 +RgR0 <= 4.0\n  R1: 1.0 <= x_0 -2.0 x_3 \nVariables:\n  x_0 is a continuous variable (min=0.0, max=+oo)\n  x_1 is a continuous variable (min=0.0, max=+oo)\n  RgR0 is a continuous variable (min=0.0, max=3.0)\n  x_3 is a continuous variable (min=0.0, max=+oo)\n```\n\nYou always pay for the bad code you write `-_-`\n\nNathann\n\n**Apply:**\n\n* [attachment:trac_12833.patch]\n* [attachment:trac_12833-docstrings.patch] \n* [attachment:trac_12833_acronyms_are_evil.patch]\n\n**Assignee:** @nathanncohen\n\n**CC:**  @nathanncohen @dcoudert\n\n**Reviewer:** John Perry\n\n**Author:** Nathann Cohen\n\n**Merged:** sage-5.0.rc0\n\nIssue created by migration from https://trac.sagemath.org/ticket/12833\n\n",
    "closed_at": "2012-04-30T09:51:17Z",
    "created_at": "2012-04-12T10:33:23Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Crashes and doctests problems with Gurobi",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12833",
    "user": "https://github.com/nathanncohen"
}
```
HEllooooooooo !!!

Gurobi actually crashed Sage when MixedIntegerLinearProgram(solver="Gurobi") is run with no license installed (or an invalid one). This if fixed by a if var == NULL before free(var).

I also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver="GUROBI" instead of solver="Gurobi". 

There was also a *scary* error in digraph.py : an inequality was actually REVERSED (a <= n had become a >= n) and it is really a wonder that the code did not break before `O_o`. Well, Gurobi did break on that, but the others were doing just fine.

Before :

```
sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      
sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  
7                                                                                                                                                                                                                                                                            
sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = "GUROBI")
6
```

After :

```
sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      
sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  
7                                                                                                                                                                                                                                                                            
sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = "Gurobi")
7
```

Hopefully, the problem came from an optional algorithm, optional because slower than the other one.

After this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver. All doctests do not pass in mip.pyx but that is only matters of default names for constraints, and stupid ways to store inequalities inside of Gurobi. For instance :

```
sage: p = MixedIntegerLinearProgram(solver = "Gurobi")        # optional - Gurobi                                                                                                                                                                                    
sage: p.add_constraint(p[0] - p[2], min = 1, max = 4)         # optional - Gurobi                                                                                                                                                                                    
sage: p.add_constraint(p[0] - 2*p[1], min = 1)                # optional - Gurobi                                                                                                                                                                                    
sage: p.show()
Maximization:
 
Constraints:
  R0: 4.0 <= x_0 -x_1 +RgR0 <= 4.0
  R1: 1.0 <= x_0 -2.0 x_3 
Variables:
  x_0 is a continuous variable (min=0.0, max=+oo)
  x_1 is a continuous variable (min=0.0, max=+oo)
  RgR0 is a continuous variable (min=0.0, max=3.0)
  x_3 is a continuous variable (min=0.0, max=+oo)
```

You always pay for the bad code you write `-_-`

Nathann

**Apply:**

* [attachment:trac_12833.patch]
* [attachment:trac_12833-docstrings.patch] 
* [attachment:trac_12833_acronyms_are_evil.patch]

**Assignee:** @nathanncohen

**CC:**  @nathanncohen @dcoudert

**Reviewer:** John Perry

**Author:** Nathann Cohen

**Merged:** sage-5.0.rc0

Issue created by migration from https://trac.sagemath.org/ticket/12833





---

archive/issue_comments_148317.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,10 +2,51 @@\n \n Gurobi actually crashed Sage when MixedIntegerLinearProgram(solver=\"Gurobi\") is run with no license installed (or an invalid one). This if fixed by a if var == NULL before free(var).\n \n-I also noticed that the doctests were actually *all wrong* because of a solver=\"GUROBI\" instead of solver=\"Gurobi\". \n+I also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver=\"GUROBI\" instead of solver=\"Gurobi\". \n \n-There was also a broken doctest in digraph.py. \n+There was also a *scary* error in digraph.py : an inequality was actually REVERSED (a <= n had become a >= n) and it is really a wonder that the code did not break before `O_o`. Well, Gurobi did break on that, but the others were doing just fine.\n \n-After this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver.\n+Before :\n+\n+```\n+sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      \n+sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  \n+7                                                                                                                                                                                                                                                                            \n+sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = \"GUROBI\")\n+7\n+```\n+\n+After :\n+\n+```\n+sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      \n+sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  \n+7                                                                                                                                                                                                                                                                            \n+sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = \"Gurobi\")\n+7\n+```\n+\n+Hopefully, the problem came from an optional algorithm, optional because slower than the other one.\n+\n+After this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver. All doctests do not pass in mip.pyx but that is only matters of default names for constraints, and stupid ways to store inequalities inside of Gurobi. For instance :\n+\n+```\n+sage: p = MixedIntegerLinearProgram(solver = \"Gurobi\")        # optional - Gurobi                                                                                                                                                                                    \n+sage: p.add_constraint(p[0] - p[2], min = 1, max = 4)         # optional - Gurobi                                                                                                                                                                                    \n+sage: p.add_constraint(p[0] - 2*p[1], min = 1)                # optional - Gurobi                                                                                                                                                                                    \n+sage: p.show()\n+Maximization:\n+ \n+Constraints:\n+  R0: 4.0 <= x_0 -x_1 +RgR0 <= 4.0\n+  R1: 1.0 <= x_0 -2.0 x_3 \n+Variables:\n+  x_0 is a continuous variable (min=0.0, max=+oo)\n+  x_1 is a continuous variable (min=0.0, max=+oo)\n+  RgR0 is a continuous variable (min=0.0, max=3.0)\n+  x_3 is a continuous variable (min=0.0, max=+oo)\n+```\n+\n+You always pay for the bad code you write `-_-`\n \n Nathann\n``````\n",
    "created_at": "2012-04-12T11:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148317",
    "user": "https://github.com/nathanncohen"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,10 +2,51 @@
 
 Gurobi actually crashed Sage when MixedIntegerLinearProgram(solver="Gurobi") is run with no license installed (or an invalid one). This if fixed by a if var == NULL before free(var).
 
-I also noticed that the doctests were actually *all wrong* because of a solver="GUROBI" instead of solver="Gurobi". 
+I also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver="GUROBI" instead of solver="Gurobi". 
 
-There was also a broken doctest in digraph.py. 
+There was also a *scary* error in digraph.py : an inequality was actually REVERSED (a <= n had become a >= n) and it is really a wonder that the code did not break before `O_o`. Well, Gurobi did break on that, but the others were doing just fine.
 
-After this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver.
+Before :
+
+```
+sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      
+sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  
+7                                                                                                                                                                                                                                                                            
+sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = "GUROBI")
+7
+```
+
+After :
+
+```
+sage: g = DiGraph('IESK@XgAbCgH??KG??')                                                                                                                                                                                                                                      
+sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  
+7                                                                                                                                                                                                                                                                            
+sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = "Gurobi")
+7
+```
+
+Hopefully, the problem came from an optional algorithm, optional because slower than the other one.
+
+After this patch everything is uniform, and all tests pass in the graph/ files with gubori as the default solver. All doctests do not pass in mip.pyx but that is only matters of default names for constraints, and stupid ways to store inequalities inside of Gurobi. For instance :
+
+```
+sage: p = MixedIntegerLinearProgram(solver = "Gurobi")        # optional - Gurobi                                                                                                                                                                                    
+sage: p.add_constraint(p[0] - p[2], min = 1, max = 4)         # optional - Gurobi                                                                                                                                                                                    
+sage: p.add_constraint(p[0] - 2*p[1], min = 1)                # optional - Gurobi                                                                                                                                                                                    
+sage: p.show()
+Maximization:
+ 
+Constraints:
+  R0: 4.0 <= x_0 -x_1 +RgR0 <= 4.0
+  R1: 1.0 <= x_0 -2.0 x_3 
+Variables:
+  x_0 is a continuous variable (min=0.0, max=+oo)
+  x_1 is a continuous variable (min=0.0, max=+oo)
+  RgR0 is a continuous variable (min=0.0, max=3.0)
+  x_3 is a continuous variable (min=0.0, max=+oo)
+```
+
+You always pay for the bad code you write `-_-`
 
 Nathann
``````




---

archive/issue_events_109407.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-04-12T11:42:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109407"
}
```



---

archive/attachments_017293.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12833.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12833/trac_12833.patch",
    "created_at": "2012-04-12T13:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nathanncohen"
}
```



---

archive/issue_comments_148318.json:
```json
{
    "body": "<a id='comment:2'></a>\n",
    "created_at": "2012-04-12T13:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148318",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>




---

archive/issue_comments_148319.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  \n 7                                                                                                                                                                                                                                                                            \n sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = \"GUROBI\")\n-7\n+6\n ```\n \n After :\n``````\n",
    "created_at": "2012-04-12T13:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148319",
    "user": "https://github.com/nathanncohen"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 sage: g.feedback_edge_set(value_only = True, constraint_generation = False)                                                                                                                                                                                                  
 7                                                                                                                                                                                                                                                                            
 sage: g.feedback_edge_set(value_only = True, constraint_generation = False, solver = "GUROBI")
-7
+6
 ```
 
 After :
``````




---

archive/issue_comments_148320.json:
```json
{
    "body": "<a id='comment:3'></a>\nYou're gonna hate me.\n\n1. The docs for `MixedIntegerLinearProgram` state,\n\n>   * \"solver\" -- 3 solvers should be available through this class:\n\n\n  Only 3? `;-)`\n\n  2. The docs for `MixedIntegerLinearProgram` advise the user to get the Gurobi solver using `solver=\"GUROBI\"`. The ticket description, on the other hand, states\n> I also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver=\"GUROBI\" instead of solver=\"Gurobi\".\n\n\n  So here's what I tried:\n\n```\nsage: p = MixedIntegerLinearProgram(solver='GUROBI')\n  ---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: 'solver' should be set to 'GLPK', 'Coin', 'CPLEX', 'Gurobi' or None (in which case the default one is used).\n```\n  The documentation should change.\n\n3. The tests for `mip.pyx` fail with Gurobi installed, **with or without this patch.** I've attached a file that summarizes the output, but here are some representative samples:\n\n```\nFile \"/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx\", line 564:\n    sage: p.show()\nExpected:\n    Maximization:\n      x_0 +x_1\n    Constraints:\n      -3.0 x_0 +2.0 x_1 <= 2.0\n    Variables:\n      x_0 is a continuous variable (min=0.0, max=+oo)\n      x_1 is a continuous variable (min=0.0, max=+oo)\nGot:\n    Maximization:\n      x_0 +x_1\n    Constraints:\n      R0: -3.0 x_0 +2.0 x_1 <= 2.0\n    Variables:\n      x_0 is a continuous variable (min=0.0, max=+oo)\n      x_1 is a continuous variable (min=0.0, max=+oo)\n```\n\n  (Notice the `R0:`.)\n\n  ```\n  File \"/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx\", line 837:\n      sage: p.solve()\n  Expected:\n      0.0\n  Got:\n      -0.0\n  ...\n  File \"/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx\", line 500:\n      sage: sorted(map(reorder_constraint,p.constraints()))\n  Expected:\n      [(1.0, ([0, 1], [1.0, -1.0]), 4.0), (1.0, ([0, 2], [1.0, -2.0]), None)]\n  Got:\n      [(1.0, ([0, 3], [1.0, -2.0]), None), (4.0, ([0, 1, 2], [1.0, -1.0, 1.0]), 4.0)]\n```\n\n  If I remove the links to Gurobi files, the same tests pass. If I put the links to Gurobi back in, the tests fail again.\n\n  I guess this is because Gurobi becomes the default solver once it is installed: the `default_mip_solver()` method has this code:\n\n  ```\n            for s in [\"CPLEX\", \"GUROBI\", \"Coin\", \"GLPK\"]:\n                try:\n                    default_mip_solver(s)\n                    return s\n                except ValueError:\n                    pass\n```\n\n  I don't have CPLEX installed, so MIP goes with GUROBI. (And it is supposed to be GUROBI or Gurobi? LOL) This may reflect some bugs (I'll let you decide that) but perhaps the best way to fix this is for MIP to ask for GLPK as the default backend in its doctests. After all, this isn't an MIP bug; at worst, it's a bug in our Gurobi backend.",
    "created_at": "2012-04-18T22:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148320",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:3'></a>
You're gonna hate me.

1. The docs for `MixedIntegerLinearProgram` state,

>   * "solver" -- 3 solvers should be available through this class:


  Only 3? `;-)`

  2. The docs for `MixedIntegerLinearProgram` advise the user to get the Gurobi solver using `solver="GUROBI"`. The ticket description, on the other hand, states
> I also noticed that the doctests of gurobi_backend were actually *all wrong* because of a solver="GUROBI" instead of solver="Gurobi".


  So here's what I tried:

```
sage: p = MixedIntegerLinearProgram(solver='GUROBI')
  ---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: 'solver' should be set to 'GLPK', 'Coin', 'CPLEX', 'Gurobi' or None (in which case the default one is used).
```
  The documentation should change.

3. The tests for `mip.pyx` fail with Gurobi installed, **with or without this patch.** I've attached a file that summarizes the output, but here are some representative samples:

```
File "/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx", line 564:
    sage: p.show()
Expected:
    Maximization:
      x_0 +x_1
    Constraints:
      -3.0 x_0 +2.0 x_1 <= 2.0
    Variables:
      x_0 is a continuous variable (min=0.0, max=+oo)
      x_1 is a continuous variable (min=0.0, max=+oo)
Got:
    Maximization:
      x_0 +x_1
    Constraints:
      R0: -3.0 x_0 +2.0 x_1 <= 2.0
    Variables:
      x_0 is a continuous variable (min=0.0, max=+oo)
      x_1 is a continuous variable (min=0.0, max=+oo)
```

  (Notice the `R0:`.)

  ```
  File "/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx", line 837:
      sage: p.solve()
  Expected:
      0.0
  Got:
      -0.0
  ...
  File "/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/mip.pyx", line 500:
      sage: sorted(map(reorder_constraint,p.constraints()))
  Expected:
      [(1.0, ([0, 1], [1.0, -1.0]), 4.0), (1.0, ([0, 2], [1.0, -2.0]), None)]
  Got:
      [(1.0, ([0, 3], [1.0, -2.0]), None), (4.0, ([0, 1, 2], [1.0, -1.0, 1.0]), 4.0)]
```

  If I remove the links to Gurobi files, the same tests pass. If I put the links to Gurobi back in, the tests fail again.

  I guess this is because Gurobi becomes the default solver once it is installed: the `default_mip_solver()` method has this code:

  ```
            for s in ["CPLEX", "GUROBI", "Coin", "GLPK"]:
                try:
                    default_mip_solver(s)
                    return s
                except ValueError:
                    pass
```

  I don't have CPLEX installed, so MIP goes with GUROBI. (And it is supposed to be GUROBI or Gurobi? LOL) This may reflect some bugs (I'll let you decide that) but perhaps the best way to fix this is for MIP to ask for GLPK as the default backend in its doctests. After all, this isn't an MIP bug; at worst, it's a bug in our Gurobi backend.



---

archive/issue_events_109408.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-18T22:21:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109408"
}
```



---

archive/issue_events_109409.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-18T22:21:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109409"
}
```



---

archive/issue_comments_148321.json:
```json
{
    "body": "**Reviewer:** John Perry",
    "created_at": "2012-04-18T22:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148321",
    "user": "https://github.com/johnperry-math"
}
```

**Reviewer:** John Perry



---

archive/issue_comments_148322.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe can get rid of this \"GUROBI\" *vs* \"Gurobi\" stuff using e.g. the ``capitalize()`` function to simplify tests.\n\n```\nsage: x = 'GUROBI'\nsage: y = 'GuRoBi'\nsage: x == y\nFalse\nsage: x.capitalize() == y.capitalize()\nTrue\nsage: x.capitalize()\n'Gurobi'\n```\nWe could use it inside default_mip_solver and MixedIntegerLinearProgram, and it could be good practice in many other functions taking as input the name of an algorithm.",
    "created_at": "2012-04-18T22:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148322",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>
We can get rid of this "GUROBI" *vs* "Gurobi" stuff using e.g. the ``capitalize()`` function to simplify tests.

```
sage: x = 'GUROBI'
sage: y = 'GuRoBi'
sage: x == y
False
sage: x.capitalize() == y.capitalize()
True
sage: x.capitalize()
'Gurobi'
```
We could use it inside default_mip_solver and MixedIntegerLinearProgram, and it could be good practice in many other functions taking as input the name of an algorithm.



---

archive/issue_comments_148323.json:
```json
{
    "body": "<a id='comment:5'></a>\nHelloooooooo !!!\n\n> You're gonna hate me.\n\n\nAhahah. Well, fixing those is not exactly as rewarding as writing real code, but anyway you are right, they need ot be fixed `:-D`\n\n>   Only 3? `;-)`\n\n\nFixed\n\n>   The documentation should change.\n\n\nDone. If only for consistency. Your call to ``capitalize`` is a good idea, so now any way to write GuRobI would work.\n\n>   3. The tests for `mip.pyx` fail with Gurobi installed, **with or without this patch.** \n\n\nRight. Well, the point is that if we can actually ask Sage to use GLPK as its default solver, I have no way to ensure it will not be the default solver for ALL TESTS (i.e. including the graph/ files), and it would be very bad to not notice quickly if some optional solver returns wrong answers... Hence I only added \"solver='GLPK'\" to all doctests that failed because of fancy solvers, and the other doctests run with the \"default solver\" as usual\n\n>     sage: p.solve()\n\n> Expected:\n>     0.0\n\n> Got:\n>     -0.0\n\n\nYeah... Well, I replaced that by ``_ = p.solve()``.\n\nNathann",
    "created_at": "2012-04-20T13:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148323",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
Helloooooooo !!!

> You're gonna hate me.


Ahahah. Well, fixing those is not exactly as rewarding as writing real code, but anyway you are right, they need ot be fixed `:-D`

>   Only 3? `;-)`


Fixed

>   The documentation should change.


Done. If only for consistency. Your call to ``capitalize`` is a good idea, so now any way to write GuRobI would work.

>   3. The tests for `mip.pyx` fail with Gurobi installed, **with or without this patch.** 


Right. Well, the point is that if we can actually ask Sage to use GLPK as its default solver, I have no way to ensure it will not be the default solver for ALL TESTS (i.e. including the graph/ files), and it would be very bad to not notice quickly if some optional solver returns wrong answers... Hence I only added "solver='GLPK'" to all doctests that failed because of fancy solvers, and the other doctests run with the "default solver" as usual

>     sage: p.solve()

> Expected:
>     0.0

> Got:
>     -0.0


Yeah... Well, I replaced that by ``_ = p.solve()``.

Nathann



---

archive/issue_events_109410.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-04-20T13:07:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109410"
}
```



---

archive/issue_events_109411.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-04-20T13:07:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109411"
}
```



---

archive/attachments_017294.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12833-docstrings.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12833/trac_12833-docstrings.patch",
    "created_at": "2012-04-20T13:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nathanncohen"
}
```



---

archive/issue_comments_148324.json:
```json
{
    "body": "",
    "created_at": "2012-04-20T13:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148324",
    "user": "https://github.com/nathanncohen"
}
```





---

archive/issue_events_109412.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "component: linear programming",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109412"
}
```



---

archive/issue_events_109413.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "component: misc",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109413"
}
```



---

archive/issue_events_109414.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109414"
}
```



---

archive/issue_events_109415.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109415"
}
```



---

archive/issue_comments_148325.json:
```json
{
    "body": "<a id='comment:6'></a>\nOh, you're **really** gonna hate me now. `:-)`\n\nThere's one miserable regression in `generic_backend.pyx`:\n\n```\nFile \"/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/backends/generic_backend.pyx\", line 841:\n    sage: default_mip_solver()\nExpected:\n    'GLPK'\nGot:\n    'Glpk'\n```\nYou can either fix your patch, or give a positive review to the patch I'm about to uploade. (All of one line! I'm an awesome code-producing machine!)",
    "created_at": "2012-04-20T13:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148325",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:6'></a>
Oh, you're **really** gonna hate me now. `:-)`

There's one miserable regression in `generic_backend.pyx`:

```
File "/atlas/sage-5.0.beta9/devel/sage-main/sage/numerical/backends/generic_backend.pyx", line 841:
    sage: default_mip_solver()
Expected:
    'GLPK'
Got:
    'Glpk'
```
You can either fix your patch, or give a positive review to the patch I'm about to uploade. (All of one line! I'm an awesome code-producing machine!)



---

archive/issue_comments_148326.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -50,3 +50,9 @@\n You always pay for the bad code you write `-_-`\n \n Nathann\n+\n+**Apply:**\n+\n+* [attachment:trac_12833.patch]\n+* [attachment:trac_12833-docstrings.patch] \n+* [attachment:trac_12833_acronyms_are_evil.patch]\n``````\n",
    "created_at": "2012-04-20T13:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148326",
    "user": "https://github.com/johnperry-math"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -50,3 +50,9 @@
 You always pay for the bad code you write `-_-`
 
 Nathann
+
+**Apply:**
+
+* [attachment:trac_12833.patch]
+* [attachment:trac_12833-docstrings.patch] 
+* [attachment:trac_12833_acronyms_are_evil.patch]
``````




---

archive/issue_events_109416.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109416"
}
```



---

archive/issue_events_109417.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T13:56:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109417"
}
```



---

archive/attachments_017295.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_12833_acronyms_are_evil.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket12833/trac_12833_acronyms_are_evil.patch",
    "created_at": "2012-04-20T13:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/johnperry-math"
}
```



---

archive/issue_comments_148327.json:
```json
{
    "body": "",
    "created_at": "2012-04-20T13:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148327",
    "user": "https://github.com/johnperry-math"
}
```





---

archive/issue_comments_148328.json:
```json
{
    "body": "<a id='comment:8'></a>\n> There's one miserable regression in `generic_backend.pyx`:\n\n\n*Sigh*. There is *one* file I did not test, because of course it does not pass the tests with the -optional flag (NonExistent solver is not installed on my machine), and of course it breaks... `:-D`\n\nThank you for your patch ! What would you think of replacing all the \"optional - nonexistentsolver\" by \"not tested - replace by optional\" everywhere in the file ? This way we could run \"sage -t -optional numerical/\" `:-)`\n\nIf you like it I will write the patch, yours is of course good to go. Thank you for noticing that !!!\n\nNathann",
    "created_at": "2012-04-20T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148328",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
> There's one miserable regression in `generic_backend.pyx`:


*Sigh*. There is *one* file I did not test, because of course it does not pass the tests with the -optional flag (NonExistent solver is not installed on my machine), and of course it breaks... `:-D`

Thank you for your patch ! What would you think of replacing all the "optional - nonexistentsolver" by "not tested - replace by optional" everywhere in the file ? This way we could run "sage -t -optional numerical/" `:-)`

If you like it I will write the patch, yours is of course good to go. Thank you for noticing that !!!

Nathann



---

archive/issue_comments_148329.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [ncohen](#comment%3A8):\n> What would you think of replacing all the \"optional - nonexistentsolver\" by \"not tested - replace by optional\" everywhere in the file ? This way we could run \"sage -t -optional numerical/\" `:-)`\n\n\nPersonally, I'm sort of leery of that. I test this region by\n\n```\n$ sage -t sage/numerical\n```\nand if I want to test something optional, I get very specific, e.g.\n\n```\n$ sage -t -optional sage/numerical/backends/coin_backend.pyx\n```\nI personally think that's much better practice. That's how I usually turn up these bugs, too. `:-)` But I don't really know which is preferable.",
    "created_at": "2012-04-20T14:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148329",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:9'></a>
Replying to [ncohen](#comment%3A8):
> What would you think of replacing all the "optional - nonexistentsolver" by "not tested - replace by optional" everywhere in the file ? This way we could run "sage -t -optional numerical/" `:-)`


Personally, I'm sort of leery of that. I test this region by

```
$ sage -t sage/numerical
```
and if I want to test something optional, I get very specific, e.g.

```
$ sage -t -optional sage/numerical/backends/coin_backend.pyx
```
I personally think that's much better practice. That's how I usually turn up these bugs, too. `:-)` But I don't really know which is preferable.



---

archive/issue_comments_148330.json:
```json
{
    "body": "<a id='comment:10'></a>\n> I personally think that's much better practice. \n\n\nOk, then that's settled for me ! Common agreement is sometimes much better than fancy reasonings. Let us keep the code as it is now `:-)`\n\nNathann",
    "created_at": "2012-04-20T14:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148330",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>
> I personally think that's much better practice. 


Ok, then that's settled for me ! Common agreement is sometimes much better than fancy reasonings. Let us keep the code as it is now `:-)`

Nathann



---

archive/issue_comments_148331.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [ncohen](#comment%3A10):\n> Ok, then that's settled for me ! Common agreement is sometimes much better than fancy reasonings. Let us keep the code as it is now `:-)`\n\n\nAlright. Do you give it a positive review, then, or do I? You can fold my patch into yours if you like, and I'll give it the positive review.",
    "created_at": "2012-04-20T14:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148331",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:11'></a>
Replying to [ncohen](#comment%3A10):
> Ok, then that's settled for me ! Common agreement is sometimes much better than fancy reasonings. Let us keep the code as it is now `:-)`


Alright. Do you give it a positive review, then, or do I? You can fold my patch into yours if you like, and I'll give it the positive review.



---

archive/issue_comments_148332.json:
```json
{
    "body": "<a id='comment:12'></a>\nWell, as we both seem to agree on that `:-)`\n\nNathann",
    "created_at": "2012-04-20T14:53:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148332",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>
Well, as we both seem to agree on that `:-)`

Nathann



---

archive/issue_comments_148333.json:
```json
{
    "body": "<a id='comment:13'></a>\nHello,\n\nI haven't tried the patch yet, but I saw some remaining GLPK in trac_12833-docstrings.patch.\nSince the tests are no longer case sensitive thanks to capitalize(), this is not an issue.\n\nHowever, it could be nice to add in the documentation that cplex, CPLEX, Cplex, CPlex,... are all valid names for Cplex. Could be done in another patch ;-)",
    "created_at": "2012-04-20T15:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148333",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:13'></a>
Hello,

I haven't tried the patch yet, but I saw some remaining GLPK in trac_12833-docstrings.patch.
Since the tests are no longer case sensitive thanks to capitalize(), this is not an issue.

However, it could be nice to add in the documentation that cplex, CPLEX, Cplex, CPlex,... are all valid names for Cplex. Could be done in another patch ;-)



---

archive/issue_events_109418.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T20:20:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109418"
}
```



---

archive/issue_events_109419.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2012-04-20T20:20:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109419"
}
```



---

archive/issue_comments_148334.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [dcoudert](#comment%3A13):\n> I haven't tried the patch yet, but I saw some remaining GLPK in trac_12833-docstrings.patch.\n\n\nThat doesn't bother me much, since it doesn't cause docstring problems. I'd like to think that someone who looked at the documentation & noticed that would spend a couple of moments discovering that it doesn't matter. :-)\n\nBased on that, I'm giving this a positive review; I waited only because I didn't quite understand whether Nathann was going to combine the patches. But if you really want that, set it to \"needs work\".",
    "created_at": "2012-04-20T20:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148334",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:14'></a>
Replying to [dcoudert](#comment%3A13):
> I haven't tried the patch yet, but I saw some remaining GLPK in trac_12833-docstrings.patch.


That doesn't bother me much, since it doesn't cause docstring problems. I'd like to think that someone who looked at the documentation & noticed that would spend a couple of moments discovering that it doesn't matter. :-)

Based on that, I'm giving this a positive review; I waited only because I didn't quite understand whether Nathann was going to combine the patches. But if you really want that, set it to "needs work".



---

archive/issue_comments_148335.json:
```json
{
    "body": "<a id='comment:15'></a>\n> Based on that, I'm giving this a positive review;\n\n\n+1 ! Thank you again `:-)`\n\nNathann",
    "created_at": "2012-04-21T07:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148335",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>
> Based on that, I'm giving this a positive review;


+1 ! Thank you again `:-)`

Nathann



---

archive/issue_comments_148336.json:
```json
{
    "body": "**Merged:** sage-5.0.rc0",
    "created_at": "2012-04-30T09:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12833#issuecomment-148336",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.0.rc0



---

archive/issue_events_109420.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-30T09:51:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109420"
}
```



---

archive/issue_events_109421.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-30T09:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12833",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12833#event-109421"
}
```
