# Issue 12415: Update doctesting framework

archive/issues_012243.json:
```json
{
    "assignees": [
        "https://github.com/jdemeyer"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nThere are several improvements that would be good to make, including but not limited to:\n\n1. Forking rather than starting up a new Sage each time.\n2. Customizable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). \n3. Eliminate need to write temporary files for every doctested file.\n4. Constant headaches caused by the difference in doctesting library vs. non-library files. \n5. The ability to drop into a debugger if a doctest raises an exception.\n\nRobert's code is at\n\nhttp://code.google.com/p/sagemath-timer/\n\n**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz), [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)\n\n**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n\n**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n\nFor follow-up or other doctest-related tickets see #11337.\n\nDepends on #13147\nDepends on #13146\nDepends on #13145\nDepends on #12723\nDepends on #12392\nDepends on #12393\nDepends on #12395\nDepends on #12396\nDepends on #12397\nDepends on #12381\nDepends on #12382\nDepends on #12383\nDepends on #12384\nDepends on #11871\nDepends on #13195\nDepends on #13121\nDepends on #13748\nDepends on #13899\nDepends on #12719\nDepends on #5155\nDepends on #14070\nDepends on #14079\nDepends on #14150\nDepends on #14158\nDepends on #14182\nDepends on #14184\nDepends on #14054\nDepends on #14063\nDepends on #13605\nDepends on #14111\nDepends on #14254\nDepends on #14242\nDepends on #14253\n\nCC:  @kini @ohanar @jhpalmieri\n\nComponent: **doctest framework**\n\nAuthor: **David Roe, Robert Bradshaw, Jeroen Demeyer**\n\nReviewer: **Jeroen Demeyer, David Roe**\n\nMerged: **sage-5.9.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12415_\n\n",
    "closed_at": "2013-03-14T22:55:55Z",
    "created_at": "2012-02-02T18:41:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update doctesting framework",
    "type": "issue",
    "updated_at": "2013-06-15T07:38:52Z",
    "url": "https://github.com/sagemath/sage/issues/12415",
    "user": "https://github.com/robertwb"
}
```
<div id="comment:0"></div>

There are several improvements that would be good to make, including but not limited to:

1. Forking rather than starting up a new Sage each time.
2. Customizable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). 
3. Eliminate need to write temporary files for every doctested file.
4. Constant headaches caused by the difference in doctesting library vs. non-library files. 
5. The ability to drop into a debugger if a doctest raises an exception.

Robert's code is at

http://code.google.com/p/sagemath-timer/

**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz), [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)

**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo

**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo

For follow-up or other doctest-related tickets see #11337.

Depends on #13147
Depends on #13146
Depends on #13145
Depends on #12723
Depends on #12392
Depends on #12393
Depends on #12395
Depends on #12396
Depends on #12397
Depends on #12381
Depends on #12382
Depends on #12383
Depends on #12384
Depends on #11871
Depends on #13195
Depends on #13121
Depends on #13748
Depends on #13899
Depends on #12719
Depends on #5155
Depends on #14070
Depends on #14079
Depends on #14150
Depends on #14158
Depends on #14182
Depends on #14184
Depends on #14054
Depends on #14063
Depends on #13605
Depends on #14111
Depends on #14254
Depends on #14242
Depends on #14253

CC:  @kini @ohanar @jhpalmieri

Component: **doctest framework**

Author: **David Roe, Robert Bradshaw, Jeroen Demeyer**

Reviewer: **Jeroen Demeyer, David Roe**

Merged: **sage-5.9.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/12415_





---

archive/issue_events_167826.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2012-02-02T18:41:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167826"
}
```



---

archive/issue_events_167827.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2012-02-02T18:41:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167827"
}
```



---

archive/issue_events_167828.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2012-02-02T18:41:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167828"
}
```



---

archive/issue_events_167829.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2012-02-02T18:41:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167829"
}
```



---

archive/issue_events_167830.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2012-02-02T18:41:26Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "subject": "https://github.com/robertwb",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167830"
}
```



---

archive/issue_comments_135784.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n There are several improvements that would be good to make, including but not limited to:\n \n 1. Forking rather than starting up a new Sage each time.\n-2. Customizeable comparison rather than mutating doctests into new doctests. \n-3. Avoiding the use of writing out temporary files.\n+2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). \n+3. Eliminate need to write temporary files for every doctested file.\n 4. Provide mechanisms for recording and comparing timings. \n 5. Constant headaches caused by the difference in doctesting library vs. non-library files. \n \n``````\n",
    "created_at": "2012-02-02T18:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135784",
    "user": "https://github.com/robertwb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 There are several improvements that would be good to make, including but not limited to:
 
 1. Forking rather than starting up a new Sage each time.
-2. Customizeable comparison rather than mutating doctests into new doctests. 
-3. Avoiding the use of writing out temporary files.
+2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). 
+3. Eliminate need to write temporary files for every doctested file.
 4. Provide mechanisms for recording and comparing timings. 
 5. Constant headaches caused by the difference in doctesting library vs. non-library files. 
 
``````




---

archive/issue_comments_135785.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,18 @@\n There are several improvements that would be good to make, including but not limited to:\n \n 1. Forking rather than starting up a new Sage each time.\n+\n 2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). \n+\n 3. Eliminate need to write temporary files for every doctested file.\n+\n 4. Provide mechanisms for recording and comparing timings. \n+\n 5. Constant headaches caused by the difference in doctesting library vs. non-library files. \n \n+\n+Code at \n+\n http://code.google.com/p/sagemath-timer/\n+\n+does most of the above, should be added to the sage library.\n``````\n",
    "created_at": "2012-02-02T18:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135785",
    "user": "https://github.com/robertwb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,18 @@
 There are several improvements that would be good to make, including but not limited to:
 
 1. Forking rather than starting up a new Sage each time.
+
 2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). 
+
 3. Eliminate need to write temporary files for every doctested file.
+
 4. Provide mechanisms for recording and comparing timings. 
+
 5. Constant headaches caused by the difference in doctesting library vs. non-library files. 
 
+
+Code at 
+
 http://code.google.com/p/sagemath-timer/
+
+does most of the above, should be added to the sage library.
``````




---

archive/issue_comments_135786.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,6 +10,7 @@\n \n 5. Constant headaches caused by the difference in doctesting library vs. non-library files. \n \n+6. The ability to drop into a debugger if a doctest raises an exception.\n \n Code at \n \n``````\n",
    "created_at": "2012-02-02T20:08:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135786",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,6 +10,7 @@
 
 5. Constant headaches caused by the difference in doctesting library vs. non-library files. 
 
+6. The ability to drop into a debugger if a doctest raises an exception.
 
 Code at 
 
``````




---

archive/issue_comments_135787.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI'm working on this.  E-mail me if you want to collaborate.",
    "created_at": "2012-02-02T20:08:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135787",
    "user": "https://github.com/roed314"
}
```

<div id="comment:3" align="right">comment:3</div>

I'm working on this.  E-mail me if you want to collaborate.



---

archive/issue_comments_135788.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,6 +12,8 @@\n \n 6. The ability to drop into a debugger if a doctest raises an exception.\n \n+7. The ability to run different doctests in the same file in parallel.\n+\n Code at \n \n http://code.google.com/p/sagemath-timer/\n``````\n",
    "created_at": "2012-02-03T09:25:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135788",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,6 +12,8 @@
 
 6. The ability to drop into a debugger if a doctest raises an exception.
 
+7. The ability to run different doctests in the same file in parallel.
+
 Code at 
 
 http://code.google.com/p/sagemath-timer/
``````




---

archive/issue_comments_135789.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,21 +1,13 @@\n There are several improvements that would be good to make, including but not limited to:\n \n 1. Forking rather than starting up a new Sage each time.\n+2. Customizable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). \n+3. Eliminate need to write temporary files for every doctested file.\n+4. Constant headaches caused by the difference in doctesting library vs. non-library files. \n+5. The ability to drop into a debugger if a doctest raises an exception.\n \n-2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). \n-\n-3. Eliminate need to write temporary files for every doctested file.\n-\n-4. Provide mechanisms for recording and comparing timings. \n-\n-5. Constant headaches caused by the difference in doctesting library vs. non-library files. \n-\n-6. The ability to drop into a debugger if a doctest raises an exception.\n-\n-7. The ability to run different doctests in the same file in parallel.\n-\n-Code at \n+Robert's code is at\n \n http://code.google.com/p/sagemath-timer/\n \n-does most of the above, should be added to the sage library.\n+and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n``````\n",
    "created_at": "2012-03-21T20:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135789",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,21 +1,13 @@
 There are several improvements that would be good to make, including but not limited to:
 
 1. Forking rather than starting up a new Sage each time.
+2. Customizable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). 
+3. Eliminate need to write temporary files for every doctested file.
+4. Constant headaches caused by the difference in doctesting library vs. non-library files. 
+5. The ability to drop into a debugger if a doctest raises an exception.
 
-2. Customizeable comparison rather than mutating doctests into new doctests (e.g. followup to #10952). 
-
-3. Eliminate need to write temporary files for every doctested file.
-
-4. Provide mechanisms for recording and comparing timings. 
-
-5. Constant headaches caused by the difference in doctesting library vs. non-library files. 
-
-6. The ability to drop into a debugger if a doctest raises an exception.
-
-7. The ability to run different doctests in the same file in parallel.
-
-Code at 
+Robert's code is at
 
 http://code.google.com/p/sagemath-timer/
 
-does most of the above, should be added to the sage library.
+and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
``````




---

archive/issue_comments_135790.json:
```json
{
    "body": "Dependencies: **#12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**",
    "created_at": "2012-03-21T20:46:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135790",
    "user": "https://github.com/roed314"
}
```

Dependencies: **#12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**



---

archive/issue_comments_135791.json:
```json
{
    "body": "Changed dependencies from **#12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**",
    "created_at": "2012-03-22T00:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135791",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**



---

archive/issue_comments_135792.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n12415_2.patch seems to contain a lot of tempfile changes, could you split out the doctest changes into a separate patch (or are these affecting doctests?)",
    "created_at": "2012-05-29T04:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135792",
    "user": "https://github.com/robertwb"
}
```

<div id="comment:9" align="right">comment:9</div>

12415_2.patch seems to contain a lot of tempfile changes, could you split out the doctest changes into a separate patch (or are these affecting doctests?)



---

archive/issue_comments_135793.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\napparently even I forget my trac username is not what it should be",
    "created_at": "2012-06-06T23:17:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135793",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:11" align="right">comment:11</div>

apparently even I forget my trac username is not what it should be



---

archive/issue_comments_135794.json:
```json
{
    "body": "Changed dependencies from **#12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**",
    "created_at": "2012-06-21T05:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135794",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**



---

archive/issue_comments_135795.json:
```json
{
    "body": "Changed dependencies from **#13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**",
    "created_at": "2012-06-21T05:30:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135795",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**



---

archive/issue_comments_135796.json:
```json
{
    "body": "Changed dependencies from **#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**",
    "created_at": "2012-06-21T05:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135796",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384**



---

archive/issue_comments_135797.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've moved the patches dealing with temporary files to #13147.",
    "created_at": "2012-06-21T05:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135797",
    "user": "https://github.com/roed314"
}
```

<div id="comment:15" align="right">comment:15</div>

I've moved the patches dealing with temporary files to #13147.



---

archive/issue_comments_135798.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,3 +11,5 @@\n http://code.google.com/p/sagemath-timer/\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n+\n+Apply [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n``````\n",
    "created_at": "2012-06-21T18:48:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135798",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,3 +11,5 @@
 http://code.google.com/p/sagemath-timer/
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
+
+Apply [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
``````




---

archive/issue_comments_135799.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,4 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-Apply [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n+**Apply** [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n``````\n",
    "created_at": "2012-06-21T18:49:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135799",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,4 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-Apply [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
+**Apply** [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
``````




---

archive/issue_comments_135800.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReady for review!\n\nThere are still a few known issues:\n\n* valgrinding under sage -t doesn't work.  I haven't used valgrind much and don't know how to resolve this.\n* The fix at #13147 probably needs work: I'm getting a failure in `sage.rings.polynomial.multi_polynomial_libsingular` to do with garbage collection.  I'm working on it.\n* I'm in the process of updating the developer guide.\n\nBut I wanted to get some other people involved in reviewing.",
    "created_at": "2012-06-23T15:16:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135800",
    "user": "https://github.com/roed314"
}
```

<div id="comment:19" align="right">comment:19</div>

Ready for review!

There are still a few known issues:

* valgrinding under sage -t doesn't work.  I haven't used valgrind much and don't know how to resolve this.
* The fix at #13147 probably needs work: I'm getting a failure in `sage.rings.polynomial.multi_polynomial_libsingular` to do with garbage collection.  I'm working on it.
* I'm in the process of updating the developer guide.

But I wanted to get some other people involved in reviewing.



---

archive/issue_events_167831.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-23T15:16:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167831"
}
```



---

archive/issue_comments_135801.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis may be a silly question, but how do I use the new framework? Don't we need changes to the scripts repo, too?  (If I just run `sage -t FILES`, I don't see the various messages, like `Doctesting ...`, that should be printed by `run_doctests` are not printed, so `sage -t` is not yet using the new framework.)\n\nOne of the patches also didn't apply cleanly to 5.1.beta5:\n\n```\nhg qimport -P ~/Downloads/12415_stderr.patch \nadding 12415_stderr.patch to series file\napplying 12415_stderr.patch\npatching file sage/lfunctions/lcalc.py\nHunk #1 FAILED at 226\n1 out of 2 hunks FAILED -- saving rejects to file sage/lfunctions/lcalc.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh 12415_stderr.patch\n```",
    "created_at": "2012-06-24T20:45:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135801",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

This may be a silly question, but how do I use the new framework? Don't we need changes to the scripts repo, too?  (If I just run `sage -t FILES`, I don't see the various messages, like `Doctesting ...`, that should be printed by `run_doctests` are not printed, so `sage -t` is not yet using the new framework.)

One of the patches also didn't apply cleanly to 5.1.beta5:

```
hg qimport -P ~/Downloads/12415_stderr.patch 
adding 12415_stderr.patch to series file
applying 12415_stderr.patch
patching file sage/lfunctions/lcalc.py
Hunk #1 FAILED at 226
1 out of 2 hunks FAILED -- saving rejects to file sage/lfunctions/lcalc.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh 12415_stderr.patch
```



---

archive/issue_comments_135802.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nDid you apply the new dependencies (#13145, #13146, #13147)?  There are some more patches to other repositories: I'll update the ticket description.",
    "created_at": "2012-06-24T21:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135802",
    "user": "https://github.com/roed314"
}
```

<div id="comment:21" align="right">comment:21</div>

Did you apply the new dependencies (#13145, #13146, #13147)?  There are some more patches to other repositories: I'll update the ticket description.



---

archive/issue_comments_135803.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,10 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch,](https://github.com/sagemath/sage/files/ticket12415/c7a4af89fe800f7cdb7c2cc42809d45b.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n+\n+**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n+\n+**Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)\n+\n+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to `$SAGE_ROOT/spkg/bin/sage` (there's no repo here so you need to use patch)\n``````\n",
    "created_at": "2012-06-24T21:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135803",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,10 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr.patch,](https://github.com/sagemath/sage/files/ticket12415/3df95252d095e0ff2177ca171ef9634d.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch,](https://github.com/sagemath/sage/files/ticket12415/c7a4af89fe800f7cdb7c2cc42809d45b.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
+
+**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
+
+**Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)
+
+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to `$SAGE_ROOT/spkg/bin/sage` (there's no repo here so you need to use patch)
``````




---

archive/issue_comments_135804.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThe description is updated: let me know if you have any more problems.  I think you need to apply 12415_stderr_vs_51b5.patch instead of 12415_stderr.patch.",
    "created_at": "2012-06-24T21:53:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135804",
    "user": "https://github.com/roed314"
}
```

<div id="comment:23" align="right">comment:23</div>

The description is updated: let me know if you have any more problems.  I think you need to apply 12415_stderr_vs_51b5.patch instead of 12415_stderr.patch.



---

archive/issue_comments_135805.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nRegarding [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz), the file in question should be part of the root repo.",
    "created_at": "2012-06-24T23:25:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135805",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

Regarding [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz), the file in question should be part of the root repo.



---

archive/issue_comments_135806.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nOne regression: with the old set-up, running `sage -tp FILES` (with no argument for `tp`) would choose the number of threads automatically. With the new set-up, this command gives an error, because `FILES` is not an integer. Therefore I think that, for example, `make ptestlong` will fail. (The file sage-runtests says that the default value for nthreads is 1, but I don't think optparse is dealing with the missing argument properly here. Also, passing the argument 0 causes doctests to never happen: maybe it's using 0 threads instead of `minimum(8, cpu_count())`.",
    "created_at": "2012-06-25T02:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135806",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

One regression: with the old set-up, running `sage -tp FILES` (with no argument for `tp`) would choose the number of threads automatically. With the new set-up, this command gives an error, because `FILES` is not an integer. Therefore I think that, for example, `make ptestlong` will fail. (The file sage-runtests says that the default value for nthreads is 1, but I don't think optparse is dealing with the missing argument properly here. Also, passing the argument 0 causes doctests to never happen: maybe it's using 0 threads instead of `minimum(8, cpu_count())`.



---

archive/issue_comments_135807.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI would suggest the following two changes: for the scripts repo:\n\n```diff\ndiff --git a/sage-runtests b/sage-runtests\n--- a/sage-runtests\n+++ b/sage-runtests\n@@ -5,7 +5,7 @@ import optparse, os, sys\n if __name__ == \"__main__\":\n     parser = optparse.OptionParser()\n \n-    parser.add_option(\"-p\", \"--nthreads\", type=int, default=1, metavar=\"N\", help=\"tests in parallel using N threads with 0 interpreted as minimum(8, cpu_count())\")\n+    parser.add_option(\"-p\", \"--nthreads\", type=\"string\", default=1, metavar=\"N\", help=\"tests in parallel using N threads with 0 interpreted as minimum(8, cpu_count())\")\n     parser.add_option(\"--serial\", action=\"store_true\", default=False, help=\"run tests in a single process in series\")\n     parser.add_option(\"--timeout\", type=int, default=-1, help=\"timeout (in seconds) for doctesting one file\")\n     parser.add_option(\"-a\", \"--all\", action=\"store_true\", default=False, help=\"test all files in the Sage library\")\n@@ -49,7 +49,20 @@ if __name__ == \"__main__\":\n     parser.add_option(\"--stats_path\", \"--stats-path\", default=os.path.join(os.path.expanduser(\"~/.sage/timings2.json\")), \\\n                           help=\"path to a json dictionary for the latest run storing a timing for each file\")\n \n+    options, args = parser.parse_args()\n+    try:\n+        options.nthreads = int(options.nthreads)\n+    except ValueError:\n+        args.insert(0, options.nthreads.strip())\n+        options.nthreads = 0\n+\n+    if options.nthreads == 0:\n+        try:\n+            options.nthreads = int(os.environ['SAGE_NUM_THREADS_PARALLEL'])\n+        except KeyError:\n+            options.nthreads = 1\n+\n     from sage.doctest.control import DocTestController\n-    DC = DocTestController(*parser.parse_args())\n+    DC = DocTestController(options, args)\n     err = DC.run()\n     sys.exit(err)\n```\nand for the Sage library:\n\n```diff\ndiff --git a/sage/doctest/control.py b/sage/doctest/control.py\n--- a/sage/doctest/control.py\n+++ b/sage/doctest/control.py\n@@ -433,8 +433,9 @@ class DocTestController(SageObject):\n             else:\n                 nother += 1\n         if nfiles + ndbsources + nother:\n-            self.log(\"Doctesting %s.\"%(\", \".join(([\"%s file%s\"%(nfiles, \"s\" if nfiles > 1 else \"\")] if nfiles else []) +\n-                                                 ([\"%s other sources\"%nother] if nother else []))))\n+            self.log(\"Doctesting %s\"%(\", \".join(([\"%s file%s\"%(nfiles, \"s\" if nfiles > 1 else \"\")] if nfiles else []) +\n+                                                 ([\"%s other sources\"%nother] if nother else [])))\n+                + \" using %s threads.\"%self.options.nthreads if self.options.nthreads > 1 else \".\")\n             self.reporter = DocTestReporter(self)\n             self.dispatcher = DocTestDispatcher(self)\n             try:\n```\n\nOr something like that. I guess you should also print the number of threads when you print \"Doctesting entire Sage library.\", etc.",
    "created_at": "2012-06-25T02:41:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135807",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

I would suggest the following two changes: for the scripts repo:

```diff
diff --git a/sage-runtests b/sage-runtests
--- a/sage-runtests
+++ b/sage-runtests
@@ -5,7 +5,7 @@ import optparse, os, sys
 if __name__ == "__main__":
     parser = optparse.OptionParser()
 
-    parser.add_option("-p", "--nthreads", type=int, default=1, metavar="N", help="tests in parallel using N threads with 0 interpreted as minimum(8, cpu_count())")
+    parser.add_option("-p", "--nthreads", type="string", default=1, metavar="N", help="tests in parallel using N threads with 0 interpreted as minimum(8, cpu_count())")
     parser.add_option("--serial", action="store_true", default=False, help="run tests in a single process in series")
     parser.add_option("--timeout", type=int, default=-1, help="timeout (in seconds) for doctesting one file")
     parser.add_option("-a", "--all", action="store_true", default=False, help="test all files in the Sage library")
@@ -49,7 +49,20 @@ if __name__ == "__main__":
     parser.add_option("--stats_path", "--stats-path", default=os.path.join(os.path.expanduser("~/.sage/timings2.json")), \
                           help="path to a json dictionary for the latest run storing a timing for each file")
 
+    options, args = parser.parse_args()
+    try:
+        options.nthreads = int(options.nthreads)
+    except ValueError:
+        args.insert(0, options.nthreads.strip())
+        options.nthreads = 0
+
+    if options.nthreads == 0:
+        try:
+            options.nthreads = int(os.environ['SAGE_NUM_THREADS_PARALLEL'])
+        except KeyError:
+            options.nthreads = 1
+
     from sage.doctest.control import DocTestController
-    DC = DocTestController(*parser.parse_args())
+    DC = DocTestController(options, args)
     err = DC.run()
     sys.exit(err)
```
and for the Sage library:

```diff
diff --git a/sage/doctest/control.py b/sage/doctest/control.py
--- a/sage/doctest/control.py
+++ b/sage/doctest/control.py
@@ -433,8 +433,9 @@ class DocTestController(SageObject):
             else:
                 nother += 1
         if nfiles + ndbsources + nother:
-            self.log("Doctesting %s."%(", ".join((["%s file%s"%(nfiles, "s" if nfiles > 1 else "")] if nfiles else []) +
-                                                 (["%s other sources"%nother] if nother else []))))
+            self.log("Doctesting %s"%(", ".join((["%s file%s"%(nfiles, "s" if nfiles > 1 else "")] if nfiles else []) +
+                                                 (["%s other sources"%nother] if nother else [])))
+                + " using %s threads."%self.options.nthreads if self.options.nthreads > 1 else ".")
             self.reporter = DocTestReporter(self)
             self.dispatcher = DocTestDispatcher(self)
             try:
```

Or something like that. I guess you should also print the number of threads when you print "Doctesting entire Sage library.", etc.



---

archive/issue_comments_135808.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI've updated the option parsing to allow -p to take no options (though I used a callback so that the -p doesn't have to be last).  I changed 12415_spkg_bin_sage.patch to be an actual patch against the root repository.  I also made a small change to the debug functionality (printing the doctest that failed before dropping into the debugger).\n\nSince I'm modifying four repositories, I'll just update the patches rather than creating lots of referee patches (unless the referee objects!).",
    "created_at": "2012-06-25T05:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135808",
    "user": "https://github.com/roed314"
}
```

<div id="comment:27" align="right">comment:27</div>

I've updated the option parsing to allow -p to take no options (though I used a callback so that the -p doesn't have to be last).  I changed 12415_spkg_bin_sage.patch to be an actual patch against the root repository.  I also made a small change to the debug functionality (printing the doctest that failed before dropping into the debugger).

Since I'm modifying four repositories, I'll just update the patches rather than creating lots of referee patches (unless the referee objects!).



---

archive/issue_comments_135809.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,4 +18,4 @@\n \n **Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)\n \n-**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to `$SAGE_ROOT/spkg/bin/sage` (there's no repo here so you need to use patch)\n+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n``````\n",
    "created_at": "2012-06-25T05:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135809",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,4 +18,4 @@
 
 **Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)
 
-**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to `$SAGE_ROOT/spkg/bin/sage` (there's no repo here so you need to use patch)
+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
``````




---

archive/issue_comments_135810.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n`sage/parallel/decorate.py`: Use\n\n```\nUnhandled SIG...\n```\n\n(on systems, this would give a SIGBUS: Bus Error instead)",
    "created_at": "2012-06-25T06:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135810",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

`sage/parallel/decorate.py`: Use

```
Unhandled SIG...
```

(on systems, this would give a SIGBUS: Bus Error instead)



---

archive/issue_comments_135811.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nPlease explain why you're adding `nodoctest` to some of the files in `doc/`?",
    "created_at": "2012-06-25T06:48:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135811",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Please explain why you're adding `nodoctest` to some of the files in `doc/`?



---

archive/issue_comments_135812.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nAre *all* the options in `sage-runtests` actually implemented? (it seems some of them are meant for #12720, these should not be added here)",
    "created_at": "2012-06-25T06:58:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135812",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Are *all* the options in `sage-runtests` actually implemented? (it seems some of them are meant for #12720, these should not be added here)



---

archive/issue_comments_135813.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI guess you're no longer using the scripts `sage-test`, `sage-ptest`, `sage-doctest`, `sage-maketest`, perhaps `sage-test-new` and `sage-test-import`.  Remove these.",
    "created_at": "2012-06-25T06:59:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135813",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

I guess you're no longer using the scripts `sage-test`, `sage-ptest`, `sage-doctest`, `sage-maketest`, perhaps `sage-test-new` and `sage-test-import`.  Remove these.



---

archive/issue_comments_135814.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nWhy does the doctesting framework need to be imported from `sage.all`?",
    "created_at": "2012-06-25T07:08:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135814",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Why does the doctesting framework need to be imported from `sage.all`?



---

archive/issue_comments_135815.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jdemeyer](#comment%3A33):\n> Why does the doctesting framework need to be imported from `sage.all`?\n\nI don't think it needs to be, but it makes it easy to test (and debug) doctests from within Sage:\n\n```\nsage: run_doctests(sage.rings.integer)\n...\n```",
    "created_at": "2012-06-25T07:23:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135815",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jdemeyer](#comment%3A33):
> Why does the doctesting framework need to be imported from `sage.all`?

I don't think it needs to be, but it makes it easy to test (and debug) doctests from within Sage:

```
sage: run_doctests(sage.rings.integer)
...
```



---

archive/issue_comments_135816.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nYou have two instances of\n\n```\nexcept:\n```\nin the new code.\n\nThe one for `os.kill()` should just catch `OSError`, for the other one replace\n\n```\nexcept KeyboardInterrupt:\n    pass\nexcept:\n```\nby\n\n```\nexcept Exception:\n```",
    "created_at": "2012-06-25T09:42:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135816",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

You have two instances of

```
except:
```
in the new code.

The one for `os.kill()` should just catch `OSError`, for the other one replace

```
except KeyboardInterrupt:
    pass
except:
```
by

```
except Exception:
```



---

archive/issue_comments_135817.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplace\n\n```\nimport multiprocessing \noptions.nthreads = os.getenv('SAGE_NUM_THREADS_PARALLEL',min(8, multiprocessing.cpu_count()))\n```\nby\n\n```\noptions.nthreads = int(os.getenv('SAGE_NUM_THREADS_PARALLEL', 1))\n```\n(don't reinvent the `sage-num-threads.py` wheel)",
    "created_at": "2012-06-25T09:46:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135817",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replace

```
import multiprocessing 
options.nthreads = os.getenv('SAGE_NUM_THREADS_PARALLEL',min(8, multiprocessing.cpu_count()))
```
by

```
options.nthreads = int(os.getenv('SAGE_NUM_THREADS_PARALLEL', 1))
```
(don't reinvent the `sage-num-threads.py` wheel)



---

archive/issue_events_167832.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T09:55:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167832"
}
```



---

archive/issue_events_167833.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T09:55:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167833"
}
```



---

archive/issue_comments_135818.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2012-06-25T10:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135818",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_135819.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nPlanning to make a reviewer patch, so hang on...",
    "created_at": "2012-06-25T10:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135819",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Planning to make a reviewer patch, so hang on...



---

archive/issue_comments_135820.json:
```json
{
    "body": "Author: **David Roe, Robert Bradshaw**",
    "created_at": "2012-06-25T10:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135820",
    "user": "https://github.com/jdemeyer"
}
```

Author: **David Roe, Robert Bradshaw**



---

archive/issue_comments_135821.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThis actually fails on the very first thing I tried (after applying all patches and doing `sage -b`):\n\n```\njdemeyer@sage:/release/sage-5.1.beta5-doctest$ ./sage -t devel/sage/sage/rings/padics/\nargv ['/release/sage-5.1.beta5-doctest/local/bin/sage-runtests', 'devel/sage/sage/rings/padics/']\nTraceback (most recent call last):\n  File \"/release/sage-5.1.beta5-doctest/local/bin/sage-runtests\", line 68, in <module>\n    DC = DocTestController(*parser.parse_args())\n  File \"/release/sage-5.1.beta5-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 116, in __init__\n    if options.nthreads == 0:\nAttributeError: Values instance has no attribute 'nthreads'\n```\n\nAm I doing something wrong?",
    "created_at": "2012-06-25T11:51:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135821",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

This actually fails on the very first thing I tried (after applying all patches and doing `sage -b`):

```
jdemeyer@sage:/release/sage-5.1.beta5-doctest$ ./sage -t devel/sage/sage/rings/padics/
argv ['/release/sage-5.1.beta5-doctest/local/bin/sage-runtests', 'devel/sage/sage/rings/padics/']
Traceback (most recent call last):
  File "/release/sage-5.1.beta5-doctest/local/bin/sage-runtests", line 68, in <module>
    DC = DocTestController(*parser.parse_args())
  File "/release/sage-5.1.beta5-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py", line 116, in __init__
    if options.nthreads == 0:
AttributeError: Values instance has no attribute 'nthreads'
```

Am I doing something wrong?



---

archive/issue_comments_135822.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nBuilding from scratch and doing `make ptest` gives:\n\n```\nargv ['/release/merger/sage-5.1.beta5-12415/local/bin/sage-runtests', '-p', '--sagenb', 'devel/sage/doc/common', 'devel/sage/doc/de', 'devel/sage/doc/en', 'devel/sage/doc/fr', 'devel/sage/doc/ru', 'devel/sage/doc/tr', 'devel/sage/sage']\nnext_arg: --sagenb\nRunning doctests with ID 2012-06-25-12-57-22-d71deecd.\nDoctesting the Sage notebook.\nDoctesting 2067 files using 6 threads\nUsage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)\n\nsage-runtests: error: no such option: -p\n**********************************************************************\nFile \"programming\", line 620, in programming\nFailed example:\n    for i in range(5):\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        compileflags, 1)\n      File \"<doctest programming[0]>\", line 1\n        for i in range(5):\n                         ^\n    SyntaxError: unexpected EOF while parsing\n**********************************************************************\n1 items had failures:\n   1 of 113 in programming\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"programming\", line 578, in programming\nFailed example:\n    for i in range(5):\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        compileflags, 1)\n      File \"<doctest programming[0]>\", line 1\n        for i in range(5):\n                         ^\n    SyntaxError: unexpected EOF while parsing\n**********************************************************************\n1 items had failures:\n   1 of 113 in programming\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"sage.misc.sh\", line 20, in sage.misc.sh.Sh.eval\nFailed example:\n    sh.eval('''echo \"Hello there\"\\nif [ $? -eq 0 ]; then\\necho \"good\"\\nfi''')\nExpected:\n    /...\n    ''\nGot:\n    Hello there\n    good\n    /release/merger/sage-5.1.beta5-12415\n    ''\n**********************************************************************\nFile \"interfaces\", line 331, in interfaces\nFailed example:\n    maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\ \n      '[plot_format, openmath]') # not tested\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        compileflags, 1)\n      File \"<doctest interfaces[0]>\", line 2\n        maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n                                                                         \n                                                 ^\n    SyntaxError: unexpected character after line continuation character\n**********************************************************************\n1 items had failures:\n   1 of  57 in interfaces\n***Test Failed*** 1 failures.\n**********************************************************************\n1 items had failures:\n   1 of   1 in sage.misc.sh.Sh.eval\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"sage.doctest.control\", line 246, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    DC = DocTestController(DD, [])\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 573, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 835, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.add_files[2]>\", line 1, in <module>\n        DC = DocTestController(DD, [])\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 127, in __init__\n        self.logfile = open(options.logfile, 'a')\n    IOError: [Errno 2] No such file or directory: '/release/merger/sage-5.1.beta5-12415/home/.sage//tmp/test.log'\n**********************************************************************\nFile \"sage.doctest.control\", line 247, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    DC.add_files()\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 573, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 835, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.add_files[3]>\", line 1, in <module>\n        DC.add_files()\n    NameError: name 'DC' is not defined\n**********************************************************************\nFile \"sage.doctest.control\", line 249, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    (os.path.join(os.environ['SAGE_ROOT'], 'devel', 'sage', 'sage'), True) in DC.files\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 573, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 835, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.add_files[4]>\", line 1, in <module>\n        (os.path.join(os.environ['SAGE_ROOT'], 'devel', 'sage', 'sage'), True) in DC.files\n    NameError: name 'DC' is not defined\n**********************************************************************\nFile \"sage.doctest.control\", line 418, in sage.doctest.control.DocTestController.run_doctests\nFailed example:\n    DC.run_doctests()\nExpected:\n    Doctesting 1 file.\n    sage -t .../sage/rings/homset.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\nGot:\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/homset.py\n        [15 tests, 0.3 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 0.8 seconds\n        cpu time: 0.1 seconds\n        cumulative wall time: 0.3 seconds\n**********************************************************************\nFile \"interfaces\", line 318, in interfaces\nFailed example:\n    maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\ \n      '[plot_format, openmath]') # not tested\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        compileflags, 1)\n      File \"<doctest interfaces[0]>\", line 2\n        maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n                                                                         \n                                                 ^\n    SyntaxError: unexpected character after line continuation character\n**********************************************************************\n1 items had failures:\n   1 of  57 in interfaces\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"sage.doctest.control\", line 479, in sage.doctest.control.DocTestController.cleanup\nFailed example:\n    DC.run()\nExpected:\n    Running doctests with ID ...\n    Doctesting 1 file.\n    sage -t .../rings/infinity.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\n    0\nGot:\n    Running doctests with ID 2012-06-25-12-57-35-cf5e164b.\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py\n        [220 tests, 12.8 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 13.8 seconds\n        cpu time: 1.0 seconds\n        cumulative wall time: 12.8 seconds\n    0\n**********************************************************************\nFile \"sage.doctest.control\", line 619, in sage.doctest.control.DocTestController.run\nFailed example:\n    DC.run()\nExpected:\n    Running doctests with ID ...\n    Doctesting 1 file.\n    sage -t .../sage/sets/non_negative_integers.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\n    0\nGot:\n    Running doctests with ID 2012-06-25-12-57-49-f475b4d8.\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/sets/non_negative_integers.py\n        [41 tests, 0.5 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 1.4 seconds\n        cpu time: 0.1 seconds\n        cumulative wall time: 0.5 seconds\n    0\n**********************************************************************\nFile \"sage.doctest.control\", line 660, in sage.doctest.control.run_doctests\nFailed example:\n    run_doctests(sage.rings.infinity)\nExpected:\n    Doctesting .../sage/rings/infinity.py\n    Running doctests with ID ...\n    Doctesting 1 file.\n    sage -t .../sage/rings/infinity.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\nGot:\n    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py\n    Running doctests with ID 2012-06-25-12-57-50-38f106c7.\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py\n        [220 tests, 20.3 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 22.3 seconds\n        cpu time: 1.0 seconds\n        cumulative wall time: 20.3 seconds\n**********************************************************************\n5 items had failures:\n   3 of  13 in sage.doctest.control.DocTestController.add_files\n   1 of  10 in sage.doctest.control.DocTestController.cleanup\n   1 of   6 in sage.doctest.control.DocTestController.run\n   1 of   7 in sage.doctest.control.DocTestController.run_doctests\n   1 of   1 in sage.doctest.control.run_doctests\n***Test Failed*** 7 failures.\n**********************************************************************\nFile \"sage.parallel.decorate\", line 559, in sage.parallel.decorate.fork\nFailed example:\n    g()\nExpected:\n    <BLANKLINE>\n    ------------------------------------------------------------------------\n    Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n    This probably occurred because a *compiled* component of Sage has a bug\n    in it and is not properly wrapped with sig_on(), sig_off(). You might\n    want to run Sage under gdb with 'sage -gdb' to debug this.\n    Sage will now terminate.\n    ------------------------------------------------------------------------\n    'NO DATA'\nGot:\n    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(print_backtrace+0x2b)[0x2b39ebbaf66e]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(sigdie+0x14)[0x2b39ebbaf69b]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(sage_signal_handler+0x20b)[0x2b39ebbaf189]\n    /lib/libpthread.so.0[0x2b39e86417d0]\n    /lib/libc.so.6(strlen+0x30)[0x2b39e8f532f0]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyString_FromString+0x1b)[0x2b39e82e486b]\n    /release/merger/sage-5.1.beta5-12415/home/.sage//temp/sage.math.washington.edu/28931//spyx//_release_merger_sage_5_1_beta5_12415_home__sage_temp_sage_math_washington_edu_28931_tmp_0_spyx/_release_merger_sage_5_1_beta5_12415_home__sage_temp_sage_math_washington_edu_28931_tmp_0_spyx_0.so[0x2aaaaaab0abd]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5a63)[0x2b39e833b2a3]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x37bf)[0x2b39e8338fff]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82b6b09]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c952d]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c9acb]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x2b39e833d432]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x714e)[0x2b39e833c98e]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f563a]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x37bf)[0x2b39e8338fff]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f523c]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f523c]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x2b39e833d432]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0xc1)[0x2b39e83611b1]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0x1f9)[0x2b39e8361489]\n    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(Py_Main+0xb15)[0x2b39e8373e65]\n    /lib/libc.so.6(__libc_start_main+0xf4)[0x2b39e8ef61f4]\n    python[0x400679]\n    <BLANKLINE>\n    ------------------------------------------------------------------------\n    Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n    This probably occurred because a *compiled* component of Sage has a bug\n    in it and is not properly wrapped with sig_on(), sig_off(). You might\n    want to run Sage under gdb with 'sage -gdb' to debug this.\n    Sage will now terminate.\n    ------------------------------------------------------------------------\n    'NO DATA'\n**********************************************************************\n1 items had failures:\n   1 of  17 in sage.parallel.decorate.fork\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"sage.tests.startup\", line 6, in sage.tests.startup\nFailed example:\n    if os.uname()[1] == 'sage.math.washington.edu':\n        print float(os.popen(\"sage -startuptime>/dev/null; sage -startuptime|grep sage.all\").readlines()[0].split()[1]) < 2.0\n    else: print True   # nothing when not on sage.math\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"sage.rings.polynomial.multi_polynomial_libsingular\", line 420, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__copy__\nFailed example:\n    len(ring_refcount_dict) == n   \nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"sage.rings.polynomial.plural\", line 2738, in sage.rings.polynomial.plural.new_NRing\nFailed example:\n    z*x\nExpected:\n    x*z\nGot:\n    Exception KeyError: (The ring pointer 0x2b3a04886e90,) in 'sage.libs.singular.ring.singular_ring_delete' ignored\n    x*z\n**********************************************************************\nFile \"sage.rings.polynomial.plural\", line 2856, in sage.rings.polynomial.plural.SCA\nFailed example:\n    E = SCA(QQ, ['x', 'y', 'z'], [0, 1], order = 'degrevlex')\nExpected nothing\nGot:\n    Exception KeyError: (The ring pointer 0x2b3a048af1a0,) in 'sage.libs.singular.ring.singular_ring_delete' ignored\n**********************************************************************\nFile \"sage.matrix.benchmark\", line 11, in sage.matrix.benchmark\nFailed example:\n    b.report([b.det_ZZ], 'Test', systems=['sage'])\nExpected:\n    ======================================================================\n              Test\n    ======================================================================\n    ...\n    ======================================================================\nGot:\n    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n    ======================================================================\n              Test\n    ======================================================================\n    <BLANKLINE>\n    <BLANKLINE>\n    ----------------------------------------------------------------------\n    Dense integer determinant over ZZ.\n        Given an n x n matrix A over ZZ with random entries\n        between min and max, inclusive, compute det(A).\n    <BLANKLINE>\n   **********************************************************************\n2 items had failures:\n   1 of   8 in sage.rings.polynomial.plural.SCA\n   1 of  17 in sage.rings.polynomial.plural.new_NRing\n***Test Failed*** 2 failures.\n     INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: ``200``)\n        - ``min`` - minimal value for entries of matrix (default: ``1``)\n        - ``max`` - maximal value for entries of matrix (default: ``100``)\n        - ``system`` - either 'sage' or 'magma' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.det_ZZ(200)\n            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma\n               sage\n              1.560\n    ======================================================================\n**********************************************************************\n1 items had failures:\n   1 of  16 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__copy__\n***Test Failed*** 1 failures.\n**********************************************************************\n1 items had failures:\n   1 of   2 in sage.tests.startup\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"sage.matrix.benchmark\", line 38, in sage.matrix.benchmark.report\nFailed example:\n    b.report([b.det_ZZ], 'Test', systems=['sage'])\nExpected:\n    ======================================================================\n              Test\n    ======================================================================\n    ...\n    ======================================================================\nGot:\n    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n    ======================================================================\n              Test\n    ======================================================================\n    <BLANKLINE>\n    <BLANKLINE>\n    ----------------------------------------------------------------------\n    Dense integer determinant over ZZ.\n        Given an n x n matrix A over ZZ with random entries\n        between min and max, inclusive, compute det(A).\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: ``200``)\n        - ``min`` - minimal value for entries of matrix (default: ``1``)\n        - ``max`` - maximal value for entries of matrix (default: ``100``)\n        - ``system`` - either 'sage' or 'magma' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.det_ZZ(200)\n            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma\n               sage\n              1.330\n    ======================================================================\n**********************************************************************\nFile \"sage.doctest.forker\", line 925, in sage.doctest.forker.SageDocTestRunner.report_unexpected_exception\nFailed example:\n    \"ArithmeticError\" in tb\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"sage.doctest.forker\", line 1185, in sage.doctest.forker.DocTestWorker.__init__\nFailed example:\n    run_doctests(sage.rings.big_oh) # indirect doctest\nExpected:\n    Doctesting .../sage/rings/big_oh.py\n    Running doctests with ID ...\n    Doctesting 1 file.\n    sage -t .../sage/rings/big_oh.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\nGot:\n    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/big_oh.py\n    Running doctests with ID 2012-06-25-12-59-29-e5a039b5.\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/big_oh.py\n        [17 tests, 1.4 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 1.9 seconds\n        cpu time: 0.4 seconds\n        cumulative wall time: 1.4 seconds\n**********************************************************************\nFile \"sage.doctest.forker\", line 1211, in sage.doctest.forker.DocTestWorker.run\nFailed example:\n    run_doctests(sage.symbolic.units) # indirect doctest\nExpected:\n    Doctesting .../sage/symbolic/units.py\n    Running doctests with ID ...\n    Doctesting 1 file.\n    sage -t .../sage/symbolic/units.py\n        [... tests, ... s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: ... seconds\n        cpu time: ... seconds\n        cumulative wall time: ... seconds\nGot:\n    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/symbolic/units.py\n    Running doctests with ID 2012-06-25-12-59-31-e804e534.\n    .\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/symbolic/units.py\n        [82 tests, 0.4 s]\n    ------------------------------------------------------------------------\n    All tests passed!\n    ------------------------------------------------------------------------\n    Total time for all tests: 0.7 seconds\n        cpu time: 0.2 seconds\n        cumulative wall time: 0.4 seconds\n**********************************************************************\n3 items had failures:\n   1 of   1 in sage.doctest.forker.DocTestWorker.__init__\n   1 of   1 in sage.doctest.forker.DocTestWorker.run\n   1 of  18 in sage.doctest.forker.SageDocTestRunner.report_unexpected_exception\n***Test Failed*** 3 failures.\n**********************************************************************\nFile \"sage.tests.cmdline\", line 270, in sage.tests.cmdline.test_executable\nFailed example:\n    ret\nExpected:\n    0\nGot:\n    1\n**********************************************************************\nFile \"sage.tests.cmdline\", line 272, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(\"All tests passed!\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"sage.tests.cmdline\", line 275, in sage.tests.cmdline.test_executable\nFailed example:\n    ret\nExpected:\n    0\nGot:\n    1\n**********************************************************************\nFile \"sage.tests.cmdline\", line 277, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(\"All tests passed!\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"sage.tests.cmdline\", line 291, in sage.tests.cmdline.test_executable\nFailed example:\n    ret\nExpected:\n    128\nGot:\n    1\n**********************************************************************\nFile \"sage.tests.cmdline\", line 293, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(\"1 items had failures:\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   6 of 183 in sage.tests.cmdline.test_executable\n***Test Failed*** 6 failures.\n**********************************************************************\nFile \"sage.matrix.benchmark\", line 566, in sage.matrix.benchmark.report_GF\nFailed example:\n    b.report_GF(systems=['sage'])\nExpected:\n    ======================================================================\n    Dense benchmarks over GF with prime 16411\n    ======================================================================\n    ...\n    ======================================================================\nGot:\n    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n    ======================================================================\n              Dense benchmarks over GF with prime 16411\n    ======================================================================\n    <BLANKLINE>\n    <BLANKLINE>\n    ----------------------------------------------------------------------\n    Rank over GF(p):\n        Given a n x (n+10) matrix over GF(p) with random entries, compute the rank.\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 300)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.rank_GF(1000)\n            sage: tm = b.rank_GF(1000, system='magma')  # optional - magma\n               sage\n              0.160\n    ----------------------------------------------------------------------\n    Rank over GF(p): Given a (n + 10) x n matrix over GF(p) with\n        random entries, compute the rank.\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 300)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.rank2_GF(500)\n            sage: tm = b.rank2_GF(500, system='magma')  # optional - magma\n               sage\n              0.170\n    ----------------------------------------------------------------------\n    Given a n+1 x n  matrix over GF(p) with random\n        entries, compute the nullspace.\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 300)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.nullspace_GF(300)\n            sage: tm = b.nullspace_GF(300, system='magma')  # optional - magma\n               sage\n              0.820\n    ----------------------------------------------------------------------\n    Given a n x n matrix over GF with random entries, compute the\n        charpoly.\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 100)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.charpoly_GF(100)\n            sage: tm = b.charpoly_GF(100, system='magma')  # optional - magma\n               sage\n              0.060\n    ----------------------------------------------------------------------\n    Given an n x n matrix A over GF(p) with random entries, compute\n        A * (A+1).\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 100)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n        - ``times`` - number of experiments (default: ``3``)\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.matrix_multiply_GF(100, p=19)\n            sage: tm = b.matrix_multiply_GF(100, p=19, system='magma')  # optional - magma\n               sage\n              0.003\n    ----------------------------------------------------------------------\n    Dense determinant over GF(p).\n        Given an n x n matrix A over GF with random entries compute\n        det(A).\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: 300)\n        - ``p`` - prime number (default: ``16411``)\n        - ``system`` - either 'magma' or 'sage' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.det_GF(1000)\n            sage: tm = b.det_GF(1000, system='magma')  # optional - magma\n               sage\n              0.090\n    ======================================================================\n**********************************************************************\n3 items had failures:\n   1 of   2 in sage.matrix.benchmark\n   1 of   2 in sage.matrix.benchmark.report\n   1 of   2 in sage.matrix.benchmark.report_GF\n***Test Failed*** 3 failures.\n\n------------------------------------------------------------------------\nDoctests interrupted: 0/2067 files tested\n------------------------------------------------------------------------\nTotal time for all tests: 181.4 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\nTraceback (most recent call last):\n  File \"/release/merger/sage-5.1.beta5-12415/local/bin/sage-runtests\", line 69, in <module>\n    err = DC.run()\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 645, in run\n    self.run_doctests()\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 446, in run_doctests\n    self.dispatcher.dispatch()\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1130, in dispatch\n    self._parallel_dispatch()\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1072, in _parallel_dispatch\n    w.start()\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python/multiprocessing/process.py\", line 130, in start\n    self._popen = Popen(self)\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python/multiprocessing/forking.py\", line 120, in __init__\n    self.pid = os.fork()\nOSError: [Errno 12] Cannot allocate memory\n```",
    "created_at": "2012-06-25T14:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135822",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">comment:41</div>

Building from scratch and doing `make ptest` gives:

```
argv ['/release/merger/sage-5.1.beta5-12415/local/bin/sage-runtests', '-p', '--sagenb', 'devel/sage/doc/common', 'devel/sage/doc/de', 'devel/sage/doc/en', 'devel/sage/doc/fr', 'devel/sage/doc/ru', 'devel/sage/doc/tr', 'devel/sage/sage']
next_arg: --sagenb
Running doctests with ID 2012-06-25-12-57-22-d71deecd.
Doctesting the Sage notebook.
Doctesting 2067 files using 6 threads
Usage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)

sage-runtests: error: no such option: -p
**********************************************************************
File "programming", line 620, in programming
Failed example:
    for i in range(5):
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        compileflags, 1)
      File "<doctest programming[0]>", line 1
        for i in range(5):
                         ^
    SyntaxError: unexpected EOF while parsing
**********************************************************************
1 items had failures:
   1 of 113 in programming
***Test Failed*** 1 failures.
**********************************************************************
File "programming", line 578, in programming
Failed example:
    for i in range(5):
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        compileflags, 1)
      File "<doctest programming[0]>", line 1
        for i in range(5):
                         ^
    SyntaxError: unexpected EOF while parsing
**********************************************************************
1 items had failures:
   1 of 113 in programming
***Test Failed*** 1 failures.
**********************************************************************
File "sage.misc.sh", line 20, in sage.misc.sh.Sh.eval
Failed example:
    sh.eval('''echo "Hello there"\nif [ $? -eq 0 ]; then\necho "good"\nfi''')
Expected:
    /...
    ''
Got:
    Hello there
    good
    /release/merger/sage-5.1.beta5-12415
    ''
**********************************************************************
File "interfaces", line 331, in interfaces
Failed example:
    maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\ 
      '[plot_format, openmath]') # not tested
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        compileflags, 1)
      File "<doctest interfaces[0]>", line 2
        maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\
                                                                         
                                                 ^
    SyntaxError: unexpected character after line continuation character
**********************************************************************
1 items had failures:
   1 of  57 in interfaces
***Test Failed*** 1 failures.
**********************************************************************
1 items had failures:
   1 of   1 in sage.misc.sh.Sh.eval
***Test Failed*** 1 failures.
**********************************************************************
File "sage.doctest.control", line 246, in sage.doctest.control.DocTestController.add_files
Failed example:
    DC = DocTestController(DD, [])
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 573, in _run
        self.execute(example, compiled, test.globs)
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 835, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.add_files[2]>", line 1, in <module>
        DC = DocTestController(DD, [])
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py", line 127, in __init__
        self.logfile = open(options.logfile, 'a')
    IOError: [Errno 2] No such file or directory: '/release/merger/sage-5.1.beta5-12415/home/.sage//tmp/test.log'
**********************************************************************
File "sage.doctest.control", line 247, in sage.doctest.control.DocTestController.add_files
Failed example:
    DC.add_files()
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 573, in _run
        self.execute(example, compiled, test.globs)
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 835, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.add_files[3]>", line 1, in <module>
        DC.add_files()
    NameError: name 'DC' is not defined
**********************************************************************
File "sage.doctest.control", line 249, in sage.doctest.control.DocTestController.add_files
Failed example:
    (os.path.join(os.environ['SAGE_ROOT'], 'devel', 'sage', 'sage'), True) in DC.files
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 573, in _run
        self.execute(example, compiled, test.globs)
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 835, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.add_files[4]>", line 1, in <module>
        (os.path.join(os.environ['SAGE_ROOT'], 'devel', 'sage', 'sage'), True) in DC.files
    NameError: name 'DC' is not defined
**********************************************************************
File "sage.doctest.control", line 418, in sage.doctest.control.DocTestController.run_doctests
Failed example:
    DC.run_doctests()
Expected:
    Doctesting 1 file.
    sage -t .../sage/rings/homset.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
Got:
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/homset.py
        [15 tests, 0.3 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 0.8 seconds
        cpu time: 0.1 seconds
        cumulative wall time: 0.3 seconds
**********************************************************************
File "interfaces", line 318, in interfaces
Failed example:
    maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\ 
      '[plot_format, openmath]') # not tested
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        compileflags, 1)
      File "<doctest interfaces[0]>", line 2
        maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\
                                                                         
                                                 ^
    SyntaxError: unexpected character after line continuation character
**********************************************************************
1 items had failures:
   1 of  57 in interfaces
***Test Failed*** 1 failures.
**********************************************************************
File "sage.doctest.control", line 479, in sage.doctest.control.DocTestController.cleanup
Failed example:
    DC.run()
Expected:
    Running doctests with ID ...
    Doctesting 1 file.
    sage -t .../rings/infinity.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
    0
Got:
    Running doctests with ID 2012-06-25-12-57-35-cf5e164b.
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py
        [220 tests, 12.8 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 13.8 seconds
        cpu time: 1.0 seconds
        cumulative wall time: 12.8 seconds
    0
**********************************************************************
File "sage.doctest.control", line 619, in sage.doctest.control.DocTestController.run
Failed example:
    DC.run()
Expected:
    Running doctests with ID ...
    Doctesting 1 file.
    sage -t .../sage/sets/non_negative_integers.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
    0
Got:
    Running doctests with ID 2012-06-25-12-57-49-f475b4d8.
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/sets/non_negative_integers.py
        [41 tests, 0.5 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 1.4 seconds
        cpu time: 0.1 seconds
        cumulative wall time: 0.5 seconds
    0
**********************************************************************
File "sage.doctest.control", line 660, in sage.doctest.control.run_doctests
Failed example:
    run_doctests(sage.rings.infinity)
Expected:
    Doctesting .../sage/rings/infinity.py
    Running doctests with ID ...
    Doctesting 1 file.
    sage -t .../sage/rings/infinity.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
Got:
    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py
    Running doctests with ID 2012-06-25-12-57-50-38f106c7.
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/infinity.py
        [220 tests, 20.3 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 22.3 seconds
        cpu time: 1.0 seconds
        cumulative wall time: 20.3 seconds
**********************************************************************
5 items had failures:
   3 of  13 in sage.doctest.control.DocTestController.add_files
   1 of  10 in sage.doctest.control.DocTestController.cleanup
   1 of   6 in sage.doctest.control.DocTestController.run
   1 of   7 in sage.doctest.control.DocTestController.run_doctests
   1 of   1 in sage.doctest.control.run_doctests
***Test Failed*** 7 failures.
**********************************************************************
File "sage.parallel.decorate", line 559, in sage.parallel.decorate.fork
Failed example:
    g()
Expected:
    <BLANKLINE>
    ------------------------------------------------------------------------
    Unhandled SIGSEGV: A segmentation fault occurred in Sage.
    This probably occurred because a *compiled* component of Sage has a bug
    in it and is not properly wrapped with sig_on(), sig_off(). You might
    want to run Sage under gdb with 'sage -gdb' to debug this.
    Sage will now terminate.
    ------------------------------------------------------------------------
    'NO DATA'
Got:
    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(print_backtrace+0x2b)[0x2b39ebbaf66e]
    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(sigdie+0x14)[0x2b39ebbaf69b]
    /release/merger/sage-5.1.beta5-12415/local/lib/libcsage.so(sage_signal_handler+0x20b)[0x2b39ebbaf189]
    /lib/libpthread.so.0[0x2b39e86417d0]
    /lib/libc.so.6(strlen+0x30)[0x2b39e8f532f0]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyString_FromString+0x1b)[0x2b39e82e486b]
    /release/merger/sage-5.1.beta5-12415/home/.sage//temp/sage.math.washington.edu/28931//spyx//_release_merger_sage_5_1_beta5_12415_home__sage_temp_sage_math_washington_edu_28931_tmp_0_spyx/_release_merger_sage_5_1_beta5_12415_home__sage_temp_sage_math_washington_edu_28931_tmp_0_spyx_0.so[0x2aaaaaab0abd]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5a63)[0x2b39e833b2a3]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x37bf)[0x2b39e8338fff]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82b6b09]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c952d]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c9acb]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x2b39e833d432]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x714e)[0x2b39e833c98e]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5ae4)[0x2b39e833b324]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f563a]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x37bf)[0x2b39e8338fff]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f523c]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82c1979]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82a487f]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f523c]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0[0x2b39e82f0568]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyObject_Call+0x68)[0x2b39e82942c8]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1299)[0x2b39e8336ad9]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x69c5)[0x2b39e833c205]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x852)[0x2b39e833d312]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x2b39e833d432]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0xc1)[0x2b39e83611b1]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0x1f9)[0x2b39e8361489]
    /release/merger/sage-5.1.beta5-12415/local/lib/libpython2.7.so.1.0(Py_Main+0xb15)[0x2b39e8373e65]
    /lib/libc.so.6(__libc_start_main+0xf4)[0x2b39e8ef61f4]
    python[0x400679]
    <BLANKLINE>
    ------------------------------------------------------------------------
    Unhandled SIGSEGV: A segmentation fault occurred in Sage.
    This probably occurred because a *compiled* component of Sage has a bug
    in it and is not properly wrapped with sig_on(), sig_off(). You might
    want to run Sage under gdb with 'sage -gdb' to debug this.
    Sage will now terminate.
    ------------------------------------------------------------------------
    'NO DATA'
**********************************************************************
1 items had failures:
   1 of  17 in sage.parallel.decorate.fork
***Test Failed*** 1 failures.
**********************************************************************
File "sage.tests.startup", line 6, in sage.tests.startup
Failed example:
    if os.uname()[1] == 'sage.math.washington.edu':
        print float(os.popen("sage -startuptime>/dev/null; sage -startuptime|grep sage.all").readlines()[0].split()[1]) < 2.0
    else: print True   # nothing when not on sage.math
Expected:
    True
Got:
    False
**********************************************************************
File "sage.rings.polynomial.multi_polynomial_libsingular", line 420, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__copy__
Failed example:
    len(ring_refcount_dict) == n   
Expected:
    True
Got:
    False
**********************************************************************
File "sage.rings.polynomial.plural", line 2738, in sage.rings.polynomial.plural.new_NRing
Failed example:
    z*x
Expected:
    x*z
Got:
    Exception KeyError: (The ring pointer 0x2b3a04886e90,) in 'sage.libs.singular.ring.singular_ring_delete' ignored
    x*z
**********************************************************************
File "sage.rings.polynomial.plural", line 2856, in sage.rings.polynomial.plural.SCA
Failed example:
    E = SCA(QQ, ['x', 'y', 'z'], [0, 1], order = 'degrevlex')
Expected nothing
Got:
    Exception KeyError: (The ring pointer 0x2b3a048af1a0,) in 'sage.libs.singular.ring.singular_ring_delete' ignored
**********************************************************************
File "sage.matrix.benchmark", line 11, in sage.matrix.benchmark
Failed example:
    b.report([b.det_ZZ], 'Test', systems=['sage'])
Expected:
    ======================================================================
              Test
    ======================================================================
    ...
    ======================================================================
Got:
    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
    ======================================================================
              Test
    ======================================================================
    <BLANKLINE>
    <BLANKLINE>
    ----------------------------------------------------------------------
    Dense integer determinant over ZZ.
        Given an n x n matrix A over ZZ with random entries
        between min and max, inclusive, compute det(A).
    <BLANKLINE>
   **********************************************************************
2 items had failures:
   1 of   8 in sage.rings.polynomial.plural.SCA
   1 of  17 in sage.rings.polynomial.plural.new_NRing
***Test Failed*** 2 failures.
     INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: ``200``)
        - ``min`` - minimal value for entries of matrix (default: ``1``)
        - ``max`` - maximal value for entries of matrix (default: ``100``)
        - ``system`` - either 'sage' or 'magma' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.det_ZZ(200)
            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma
               sage
              1.560
    ======================================================================
**********************************************************************
1 items had failures:
   1 of  16 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__copy__
***Test Failed*** 1 failures.
**********************************************************************
1 items had failures:
   1 of   2 in sage.tests.startup
***Test Failed*** 1 failures.
**********************************************************************
File "sage.matrix.benchmark", line 38, in sage.matrix.benchmark.report
Failed example:
    b.report([b.det_ZZ], 'Test', systems=['sage'])
Expected:
    ======================================================================
              Test
    ======================================================================
    ...
    ======================================================================
Got:
    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
    ======================================================================
              Test
    ======================================================================
    <BLANKLINE>
    <BLANKLINE>
    ----------------------------------------------------------------------
    Dense integer determinant over ZZ.
        Given an n x n matrix A over ZZ with random entries
        between min and max, inclusive, compute det(A).
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: ``200``)
        - ``min`` - minimal value for entries of matrix (default: ``1``)
        - ``max`` - maximal value for entries of matrix (default: ``100``)
        - ``system`` - either 'sage' or 'magma' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.det_ZZ(200)
            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma
               sage
              1.330
    ======================================================================
**********************************************************************
File "sage.doctest.forker", line 925, in sage.doctest.forker.SageDocTestRunner.report_unexpected_exception
Failed example:
    "ArithmeticError" in tb
Expected:
    True
Got:
    False
**********************************************************************
File "sage.doctest.forker", line 1185, in sage.doctest.forker.DocTestWorker.__init__
Failed example:
    run_doctests(sage.rings.big_oh) # indirect doctest
Expected:
    Doctesting .../sage/rings/big_oh.py
    Running doctests with ID ...
    Doctesting 1 file.
    sage -t .../sage/rings/big_oh.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
Got:
    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/big_oh.py
    Running doctests with ID 2012-06-25-12-59-29-e5a039b5.
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/rings/big_oh.py
        [17 tests, 1.4 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 1.9 seconds
        cpu time: 0.4 seconds
        cumulative wall time: 1.4 seconds
**********************************************************************
File "sage.doctest.forker", line 1211, in sage.doctest.forker.DocTestWorker.run
Failed example:
    run_doctests(sage.symbolic.units) # indirect doctest
Expected:
    Doctesting .../sage/symbolic/units.py
    Running doctests with ID ...
    Doctesting 1 file.
    sage -t .../sage/symbolic/units.py
        [... tests, ... s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: ... seconds
        cpu time: ... seconds
        cumulative wall time: ... seconds
Got:
    Doctesting /release/merger/sage-5.1.beta5-12415/devel/sage/sage/symbolic/units.py
    Running doctests with ID 2012-06-25-12-59-31-e804e534.
    .
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/symbolic/units.py
        [82 tests, 0.4 s]
    ------------------------------------------------------------------------
    All tests passed!
    ------------------------------------------------------------------------
    Total time for all tests: 0.7 seconds
        cpu time: 0.2 seconds
        cumulative wall time: 0.4 seconds
**********************************************************************
3 items had failures:
   1 of   1 in sage.doctest.forker.DocTestWorker.__init__
   1 of   1 in sage.doctest.forker.DocTestWorker.run
   1 of  18 in sage.doctest.forker.SageDocTestRunner.report_unexpected_exception
***Test Failed*** 3 failures.
**********************************************************************
File "sage.tests.cmdline", line 270, in sage.tests.cmdline.test_executable
Failed example:
    ret
Expected:
    0
Got:
    1
**********************************************************************
File "sage.tests.cmdline", line 272, in sage.tests.cmdline.test_executable
Failed example:
    out.find("All tests passed!") >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "sage.tests.cmdline", line 275, in sage.tests.cmdline.test_executable
Failed example:
    ret
Expected:
    0
Got:
    1
**********************************************************************
File "sage.tests.cmdline", line 277, in sage.tests.cmdline.test_executable
Failed example:
    out.find("All tests passed!") >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "sage.tests.cmdline", line 291, in sage.tests.cmdline.test_executable
Failed example:
    ret
Expected:
    128
Got:
    1
**********************************************************************
File "sage.tests.cmdline", line 293, in sage.tests.cmdline.test_executable
Failed example:
    out.find("1 items had failures:") >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   6 of 183 in sage.tests.cmdline.test_executable
***Test Failed*** 6 failures.
**********************************************************************
File "sage.matrix.benchmark", line 566, in sage.matrix.benchmark.report_GF
Failed example:
    b.report_GF(systems=['sage'])
Expected:
    ======================================================================
    Dense benchmarks over GF with prime 16411
    ======================================================================
    ...
    ======================================================================
Got:
    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
    ======================================================================
              Dense benchmarks over GF with prime 16411
    ======================================================================
    <BLANKLINE>
    <BLANKLINE>
    ----------------------------------------------------------------------
    Rank over GF(p):
        Given a n x (n+10) matrix over GF(p) with random entries, compute the rank.
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 300)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.rank_GF(1000)
            sage: tm = b.rank_GF(1000, system='magma')  # optional - magma
               sage
              0.160
    ----------------------------------------------------------------------
    Rank over GF(p): Given a (n + 10) x n matrix over GF(p) with
        random entries, compute the rank.
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 300)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.rank2_GF(500)
            sage: tm = b.rank2_GF(500, system='magma')  # optional - magma
               sage
              0.170
    ----------------------------------------------------------------------
    Given a n+1 x n  matrix over GF(p) with random
        entries, compute the nullspace.
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 300)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.nullspace_GF(300)
            sage: tm = b.nullspace_GF(300, system='magma')  # optional - magma
               sage
              0.820
    ----------------------------------------------------------------------
    Given a n x n matrix over GF with random entries, compute the
        charpoly.
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 100)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.charpoly_GF(100)
            sage: tm = b.charpoly_GF(100, system='magma')  # optional - magma
               sage
              0.060
    ----------------------------------------------------------------------
    Given an n x n matrix A over GF(p) with random entries, compute
        A * (A+1).
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 100)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
        - ``times`` - number of experiments (default: ``3``)
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.matrix_multiply_GF(100, p=19)
            sage: tm = b.matrix_multiply_GF(100, p=19, system='magma')  # optional - magma
               sage
              0.003
    ----------------------------------------------------------------------
    Dense determinant over GF(p).
        Given an n x n matrix A over GF with random entries compute
        det(A).
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: 300)
        - ``p`` - prime number (default: ``16411``)
        - ``system`` - either 'magma' or 'sage' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.det_GF(1000)
            sage: tm = b.det_GF(1000, system='magma')  # optional - magma
               sage
              0.090
    ======================================================================
**********************************************************************
3 items had failures:
   1 of   2 in sage.matrix.benchmark
   1 of   2 in sage.matrix.benchmark.report
   1 of   2 in sage.matrix.benchmark.report_GF
***Test Failed*** 3 failures.

------------------------------------------------------------------------
Doctests interrupted: 0/2067 files tested
------------------------------------------------------------------------
Total time for all tests: 181.4 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
Traceback (most recent call last):
  File "/release/merger/sage-5.1.beta5-12415/local/bin/sage-runtests", line 69, in <module>
    err = DC.run()
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py", line 645, in run
    self.run_doctests()
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py", line 446, in run_doctests
    self.dispatcher.dispatch()
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1130, in dispatch
    self._parallel_dispatch()
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1072, in _parallel_dispatch
    w.start()
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python/multiprocessing/process.py", line 130, in start
    self._popen = Popen(self)
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python/multiprocessing/forking.py", line 120, in __init__
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
```



---

archive/issue_comments_135823.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@jdemeyer](#comment%3A38):\n> Planning to make a reviewer patch\n\n...after you guys fix the more serious errors.",
    "created_at": "2012-06-25T16:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135823",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@jdemeyer](#comment%3A38):
> Planning to make a reviewer patch

...after you guys fix the more serious errors.



---

archive/issue_comments_135824.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nSome of these are due to a bug in the change I just made to -p.  I'm working on fixing those.\n\nSome look like you didn't apply the patch to the sagenb repo.  Did you forget, or is something else going on?\n\nSome are due to the fact that in your tests, os.system calls are happening before the python process gets far enough, so results that were printed to the screen in the wrong order.  I'm guessing this may relate to the fact that you're running on /release, since my tests on sage.math didn't show the same behavior.\n\nI'm in the process of fixing stuff.",
    "created_at": "2012-06-25T17:35:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135824",
    "user": "https://github.com/roed314"
}
```

<div id="comment:43" align="right">comment:43</div>

Some of these are due to a bug in the change I just made to -p.  I'm working on fixing those.

Some look like you didn't apply the patch to the sagenb repo.  Did you forget, or is something else going on?

Some are due to the fact that in your tests, os.system calls are happening before the python process gets far enough, so results that were printed to the screen in the wrong order.  I'm guessing this may relate to the fact that you're running on /release, since my tests on sage.math didn't show the same behavior.

I'm in the process of fixing stuff.



---

archive/issue_comments_135825.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThere's some code in the current doctesting code to output xml results, which I'm not currently duplicating.  Is this used somewhere?",
    "created_at": "2012-06-25T17:48:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135825",
    "user": "https://github.com/roed314"
}
```

<div id="comment:44" align="right">comment:44</div>

There's some code in the current doctesting code to output xml results, which I'm not currently duplicating.  Is this used somewhere?



---

archive/issue_comments_135826.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nCurrently sage -t --new is broken.  I'm trying to figure out why.",
    "created_at": "2012-06-25T18:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135826",
    "user": "https://github.com/roed314"
}
```

<div id="comment:45" align="right">comment:45</div>

Currently sage -t --new is broken.  I'm trying to figure out why.



---

archive/issue_comments_135827.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nAlright, I'm going to start running tests.  There are still some remaining issues, but the patches are in a state where someone else might want to look at them.  :-)\n\nRemaining problems:\n\n* #13145 needs work, generating some doctest failures related to deallocating multivariate polynomials\n* hg_sage seems to be broken, causing the --new option to fail\n* valgrinding `sage -t` doesn't work; I'm not sure whether it did before\n* The new code doesn't support xml output\n\nI'll see if I find more when running `sage -t --all`.",
    "created_at": "2012-06-25T18:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135827",
    "user": "https://github.com/roed314"
}
```

<div id="comment:46" align="right">comment:46</div>

Alright, I'm going to start running tests.  There are still some remaining issues, but the patches are in a state where someone else might want to look at them.  :-)

Remaining problems:

* #13145 needs work, generating some doctest failures related to deallocating multivariate polynomials
* hg_sage seems to be broken, causing the --new option to fail
* valgrinding `sage -t` doesn't work; I'm not sure whether it did before
* The new code doesn't support xml output

I'll see if I find more when running `sage -t --all`.



---

archive/issue_comments_135828.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@roed314](#comment%3A43):\n> Some are due to the fact that in your tests, os.system calls are happening before the python process gets far enough, so results that were printed to the screen in the wrong order.\n\nUse `sys.stdout.flush()` (and/or the same for `stderr`) before `os.system()` to overcome this.  The difference is probably that my output was sent to a pipe, as opposed to directly to the terminal. In the latter case, flushing is automatic.\n\nTrue, I might not have applied all patches correctly.",
    "created_at": "2012-06-25T18:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135828",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@roed314](#comment%3A43):
> Some are due to the fact that in your tests, os.system calls are happening before the python process gets far enough, so results that were printed to the screen in the wrong order.

Use `sys.stdout.flush()` (and/or the same for `stderr`) before `os.system()` to overcome this.  The difference is probably that my output was sent to a pipe, as opposed to directly to the terminal. In the latter case, flushing is automatic.

True, I might not have applied all patches correctly.



---

archive/issue_comments_135829.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nIt doesn't make sense to patch the old notebook. Please work with the flask notebook instead (i.e. make this ticket depend on #11080 and preferably #13121).",
    "created_at": "2012-06-25T18:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135829",
    "user": "https://github.com/kini"
}
```

<div id="comment:48" align="right">comment:48</div>

It doesn't make sense to patch the old notebook. Please work with the flask notebook instead (i.e. make this ticket depend on #11080 and preferably #13121).



---

archive/issue_comments_135830.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@kini](#comment%3A48):\n> It doesn't make sense to patch the old notebook. Please work with the flask notebook instead (i.e. make this ticket depend on #11080 and preferably #13121).\n\nI agree that it doesn't make much sense to patch the old notebook, but if this can get a positive review quickly I'd rather not wait on #11080 and #13121.  The changes to the old notebook are pretty minor.",
    "created_at": "2012-06-25T19:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135830",
    "user": "https://github.com/roed314"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@kini](#comment%3A48):
> It doesn't make sense to patch the old notebook. Please work with the flask notebook instead (i.e. make this ticket depend on #11080 and preferably #13121).

I agree that it doesn't make much sense to patch the old notebook, but if this can get a positive review quickly I'd rather not wait on #11080 and #13121.  The changes to the old notebook are pretty minor.



---

archive/issue_comments_135831.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nDesign question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?",
    "created_at": "2012-06-25T19:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135831",
    "user": "https://github.com/roed314"
}
```

<div id="comment:50" align="right">comment:50</div>

Design question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?



---

archive/issue_comments_135832.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nThe only tests I have failing on sage.math are `sage.tests.startup` and `sage.rings.polynomial.multi_polynomial_libsingular` (due to #13145).",
    "created_at": "2012-06-25T19:42:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135832",
    "user": "https://github.com/roed314"
}
```

<div id="comment:51" align="right">comment:51</div>

The only tests I have failing on sage.math are `sage.tests.startup` and `sage.rings.polynomial.multi_polynomial_libsingular` (due to #13145).



---

archive/issue_events_167834.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-25T19:42:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167834"
}
```



---

archive/issue_events_167835.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-25T19:42:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167835"
}
```



---

archive/issue_comments_135833.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@roed314](#comment%3A50):\n> Design question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?\n\nIt might not be truly a problem, but I prefer the current model where the tests for one file are grouped.",
    "created_at": "2012-06-25T19:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135833",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@roed314](#comment%3A50):
> Design question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?

It might not be truly a problem, but I prefer the current model where the tests for one file are grouped.



---

archive/issue_comments_135834.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@roed314](#comment%3A50):\n> Design question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?\n\nEven better might be an option to show only the *first* failure in each file.",
    "created_at": "2012-06-25T20:00:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135834",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@roed314](#comment%3A50):
> Design question: when running tests in parallel, failed examples are printed as they arise, meaning that examples from different files are intermingled.  Is this a problem that needs to be fixed?

Even better might be an option to show only the *first* failure in each file.



---

archive/issue_comments_135835.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI've updated the code to group results for each file, and added an option (`sage -t --initial`) so that only the first failure is reported.",
    "created_at": "2012-06-25T22:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135835",
    "user": "https://github.com/roed314"
}
```

<div id="comment:54" align="right">comment:54</div>

I've updated the code to group results for each file, and added an option (`sage -t --initial`) so that only the first failure is reported.



---

archive/issue_comments_135836.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThe following is cut from a `make ptestlong` run:\n\n```\nsage -t devel/sage/sage/symbolic/expression.pyx\n    [1960 tests, 38.2 s]\nsage -t devel/sage/sage/pl**********************************************************************\nFile \"sage.schemes.elliptic_curves.ell_rational_field\", line 1468, in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_ration\nal_field.simon_two_descent\nFailed example:\n    E.simon_two_descent()  # long time (9s on sage.math, 2011)\nExpected:\n    (5, 5, [(5 : 8 : 1), (4 : 9 : 1), (3 : 11 : 1), (-1 : 20 : 1), (-6 : -25 : 1)])\nGot:\n    Saturation index bound = 265\n    WARNING: saturation at primes p > 97 will not be done;\n    points may be unsaturated at primes between 97 and index bound\n    Failed to saturate MW basis at primes [ ]\n    Saturation index bound = 265\n    WARNING: saturation at primes p > 199 will not be done;\n    points may be unsaturated at primes between 199 and index bound\n    Failed to saturate MW basis at primes [ ]\n    (5, 5, [(5 : 8 : 1), (4 : 9 : 1), (3 : 11 : 1), (-1 : 20 : 1), (-6 : -25 : 1)])\n**********************************************************************\n1 items had failures:\n   1 of  38 in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.simon_two_descent\n***Test Failed*** 1 failures.\not/plot3d/implicit_plot3d.py\n    [57 tests, 26.9 s]\nsage -t devel/sage/sage/modular/modsym/ambient.py\n    [397 tests, 26.4 s]\n```\n\nThere are 3 issues:\n\n1. The doctest failure itself.\n\n2. The fact that `sage -t foo` is written instead of `sage -t --long foo`.\n\n3. Output flushing: note the\n\n```\nsage -t devel/sage/sage/pl\n```\nand then later\n\n```\not/plot3d/implicit_plot3d.py\n    [57 tests, 26.9 s]\n```\n\nBy all means please keep working on this, it already looks very cool!",
    "created_at": "2012-06-26T09:29:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135836",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

The following is cut from a `make ptestlong` run:

```
sage -t devel/sage/sage/symbolic/expression.pyx
    [1960 tests, 38.2 s]
sage -t devel/sage/sage/pl**********************************************************************
File "sage.schemes.elliptic_curves.ell_rational_field", line 1468, in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_ration
al_field.simon_two_descent
Failed example:
    E.simon_two_descent()  # long time (9s on sage.math, 2011)
Expected:
    (5, 5, [(5 : 8 : 1), (4 : 9 : 1), (3 : 11 : 1), (-1 : 20 : 1), (-6 : -25 : 1)])
Got:
    Saturation index bound = 265
    WARNING: saturation at primes p > 97 will not be done;
    points may be unsaturated at primes between 97 and index bound
    Failed to saturate MW basis at primes [ ]
    Saturation index bound = 265
    WARNING: saturation at primes p > 199 will not be done;
    points may be unsaturated at primes between 199 and index bound
    Failed to saturate MW basis at primes [ ]
    (5, 5, [(5 : 8 : 1), (4 : 9 : 1), (3 : 11 : 1), (-1 : 20 : 1), (-6 : -25 : 1)])
**********************************************************************
1 items had failures:
   1 of  38 in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.simon_two_descent
***Test Failed*** 1 failures.
ot/plot3d/implicit_plot3d.py
    [57 tests, 26.9 s]
sage -t devel/sage/sage/modular/modsym/ambient.py
    [397 tests, 26.4 s]
```

There are 3 issues:

1. The doctest failure itself.

2. The fact that `sage -t foo` is written instead of `sage -t --long foo`.

3. Output flushing: note the

```
sage -t devel/sage/sage/pl
```
and then later

```
ot/plot3d/implicit_plot3d.py
    [57 tests, 26.9 s]
```

By all means please keep working on this, it already looks very cool!



---

archive/issue_comments_135837.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nSome more doctest failures from `make ptest`:\n\n```\nsage -t devel/sage/doc/common/__init__.py\n    [0 tests, 0.0 s]\nsage -t devel/sage/doc/common/build_optiUsage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)\n\nsage-runtests: error: no such option: -p\nons.py\n    [0 tests, 0.0 s]\nsage -t devel/sage/doc/common/builder.py\n    Bad exit: 2\nTests run before process failed:\n\nsage -t devel/sage/doc/common/conf.py\n    [0 tests, 0.0 s]\n```\n\n```\nsage -t devel/sage/doc/de/tutorial/interactive_shell.rst\n    Error: TAB character found at line 656\n    [8 tests, 0.2 s]\nsage -t devel/sage/doc/en/tutorial/interactive_shell.rst\n    [8 tests, 0.2 s]\nsage -t devel/sage/doc/en/bordeaux_2008/birds_other.rst\n    [26 tests, 5.2**********************************************************************\nFile \"interfaces\", line 331, in interfaces\nFailed example:\n    maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n      '[plot_format, openmath]') # not tested\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 590, in _run\n        compileflags, 1)\n      File \"<doctest interfaces[0]>\", line 2\n        maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n\n                                                 ^\n    SyntaxError: unexpected character after line continuation character\n**********************************************************************\n1 items had failures:\n   1 of  57 in interfaces\n***Test Failed*** 1 failures.\n**********************************************************************\nFile \"interfaces\", line 318, in interfaces\nFailed example:\n    maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n      '[plot_format, openmath]') # not tested\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 590, in _run\n        compileflags, 1)\n      File \"<doctest interfaces[0]>\", line 2\n        maxima.plot3d(\"[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\\\n      y*sin(x/2)]\", \"[x, -4, 4]\", \"[y, -4, 4]\",\\\n\n                                                 ^\n    SyntaxError: unexpected character after line continuation character\n**********************************************************************\n1 items had failures:\n   1 of  57 in interfaces\n***Test Failed*** 1 failures.\n s]\nsage -t devel/sage/doc/fr/tutorial/interactive_shell.rst\n    [8 tests, 0.2 s]\n```\n(why is the filename simply \"interfaces\")\n\n```\nsage -t devel/sage/doc/en/reference/probability.rst\n    [0 tests, 0.0 s]\nsage -t de**********************************************************************\nFile \"programming\", line 620, in programming\nFailed example:\n    for i in range(5):\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 590, in _run\n        compileflags, 1)\n      File \"<doctest programming[0]>\", line 1\n        for i in range(5):\n                         ^\n    SyntaxError: unexpected EOF while parsing\n**********************************************************************\n1 items had failures:\n   1 of 113 in programming\n***Test Failed*** 1 failures.\n```\n\n```\nsage -t devel/sage/doc/en/reference/rings_standard.rst\n    [0 tests, 0.0 s]\nsage -t devel/sage/doc/en/reference/combinat/root_syste**********************************************************************\nFile \"programming\", line 578, in programming\nFailed example:\n    for i in range(5):\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 590, in _run\n        compileflags, 1)\n      File \"<doctest programming[0]>\", line 1\n        for i in range(5):\n                         ^\n    SyntaxError: unexpected EOF while parsing\n**********************************************************************\n1 items had failures:\n   1 of 113 in programming\n***Test Failed*** 1 failures.\nms.rst\n    [0 tests, 0.0 s]\n```\n\n```\nsage -t devel/sage/sage/databases/odlyzko.py\n    [0 tests, 0.0 s]\nsag**********************************************************************\nFile \"sage.doctest.reporting\", line 93, in sage.doctest.reporting.DocTestReporter.report\nFailed example:\n    DTR.report(FDS, True, 0, None, \"Output so far...\")\nExpected:\n    sage -t .../devel/sage/sage/doctest/reporting.py\n        Timed out!\n    Output so far...\nGot:\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py\n        Timed out!\n    Tests run before process froze:\n    Output so far...\n**********************************************************************\nFile \"sage.doctest.reporting\", line 102, in sage.doctest.reporting.DocTestReporter.report\nFailed example:\n    DTR.report(FDS, False, 3, None, \"Output before bad exit\")\nExpected:\n    sage -t .../devel/sage/sage/doctest/reporting.py\n        Bad exit: 3\n    Output before bad exit\nGot:\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py\n        Bad exit: 3\n    Tests run before process failed:\n    Output before bad exit\n**********************************************************************\nFile \"sage.doctest.reporting\", line 215, in sage.doctest.reporting.DocTestReporter.finalize\nFailed example:\n    DTR.report(FDS, True, 0, None, \"Output so far...\")\nExpected:\n    sage -t .../devel/sage/sage/doctest/reporting.py\n        Timed out!\n    Output so far...\nGot:\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py\n        Timed out!\n    Tests run before process froze:\n    Output so far...\n**********************************************************************\nFile \"sage.doctest.reporting\", line 219, in sage.doctest.reporting.DocTestReporter.finalize\nFailed example:\n    DTR.report(FDS, False, 3, None, \"Output before bad exit\")\nExpected:\n    sage -t .../devel/sage/sage/doctest/reporting.py\n        Bad exit: 3\n    Output before bad exit\nGot:\n    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py\n        Bad exit: 3\n    Tests run before process failed:\n    Output before bad exit\n**********************************************************************\n2 items had failures:\n   2 of  26 in sage.doctest.reporting.DocTestReporter.finalize\n   2 of  23 in sage.doctest.reporting.DocTestReporter.report\n***Test Failed*** 4 failures.\ne -t devel/sage/sage/databases/sloane.py\n    [1 tests, 0.1 s]\n```\n\n```\nsage -t devel/sage/sage/ext/cdefs.pxi\n    [0 tests, 0.0 s]\nsage -t devel/sage/sage/docte**********************************************************************\nFile \"sage.doctest.control\", line 252, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    DC = DocTestController(DD, [])\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 591, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 873, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.add_files[2]>\", line 1, in <module>\n        DC = DocTestController(DD, [])\n      File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 132, in __init__\n        print \"Unable to open logfile at %s\\nProceeding without logging.\"%(self.logfile)\n    AttributeError: 'DocTestController' object has no attribute 'logfile'\n**********************************************************************\n```\n\n```\nsage -t devel/sage/sage/misc/profiler.py\n    [0 tests, 0.0 s]\nsage -t devel/sage/**********************************************************************\nFile \"sage.matrix.benchmark\", line 11, in sage.matrix.benchmark\nFailed example:\n    print \"starting\"; b.report([b.det_ZZ], 'Test', systems=['sage'])\nExpected:\n    starting...\n    ======================================================================\n              Test\n    ======================================================================\n    ...\n    ======================================================================\nGot:\n    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n    starting\n    ======================================================================\n              Test\n    ======================================================================\n    <BLANKLINE>\n    <BLANKLINE>\n    ----------------------------------------------------------------------\n    Dense integer determinant over ZZ.\n        Given an n x n matrix A over ZZ with random entries\n        between min and max, inclusive, compute det(A).\n    <BLANKLINE>\n        INPUT:\n    <BLANKLINE>\n        - ``n`` - matrix dimension (default: ``200``)\n        - ``min`` - minimal value for entries of matrix (default: ``1``)\n        - ``max`` - maximal value for entries of matrix (default: ``100``)\n        - ``system`` - either 'sage' or 'magma' (default: 'sage')\n    <BLANKLINE>\n        EXAMPLES::\n    <BLANKLINE>\n            sage: import sage.matrix.benchmark as b\n            sage: ts = b.det_ZZ(200)\n            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma\n               sage\n              1.370\n    ======================================================================\n**********************************************************************\n```",
    "created_at": "2012-06-26T09:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135837",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Some more doctest failures from `make ptest`:

```
sage -t devel/sage/doc/common/__init__.py
    [0 tests, 0.0 s]
sage -t devel/sage/doc/common/build_optiUsage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)

sage-runtests: error: no such option: -p
ons.py
    [0 tests, 0.0 s]
sage -t devel/sage/doc/common/builder.py
    Bad exit: 2
Tests run before process failed:

sage -t devel/sage/doc/common/conf.py
    [0 tests, 0.0 s]
```

```
sage -t devel/sage/doc/de/tutorial/interactive_shell.rst
    Error: TAB character found at line 656
    [8 tests, 0.2 s]
sage -t devel/sage/doc/en/tutorial/interactive_shell.rst
    [8 tests, 0.2 s]
sage -t devel/sage/doc/en/bordeaux_2008/birds_other.rst
    [26 tests, 5.2**********************************************************************
File "interfaces", line 331, in interfaces
Failed example:
    maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\
      '[plot_format, openmath]') # not tested
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 590, in _run
        compileflags, 1)
      File "<doctest interfaces[0]>", line 2
        maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\

                                                 ^
    SyntaxError: unexpected character after line continuation character
**********************************************************************
1 items had failures:
   1 of  57 in interfaces
***Test Failed*** 1 failures.
**********************************************************************
File "interfaces", line 318, in interfaces
Failed example:
    maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\
      '[plot_format, openmath]') # not tested
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 590, in _run
        compileflags, 1)
      File "<doctest interfaces[0]>", line 2
        maxima.plot3d("[cos(x)*(3 + y*cos(x/2)), sin(x)*(3 + y*cos(x/2)),\
      y*sin(x/2)]", "[x, -4, 4]", "[y, -4, 4]",\

                                                 ^
    SyntaxError: unexpected character after line continuation character
**********************************************************************
1 items had failures:
   1 of  57 in interfaces
***Test Failed*** 1 failures.
 s]
sage -t devel/sage/doc/fr/tutorial/interactive_shell.rst
    [8 tests, 0.2 s]
```
(why is the filename simply "interfaces")

```
sage -t devel/sage/doc/en/reference/probability.rst
    [0 tests, 0.0 s]
sage -t de**********************************************************************
File "programming", line 620, in programming
Failed example:
    for i in range(5):
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 590, in _run
        compileflags, 1)
      File "<doctest programming[0]>", line 1
        for i in range(5):
                         ^
    SyntaxError: unexpected EOF while parsing
**********************************************************************
1 items had failures:
   1 of 113 in programming
***Test Failed*** 1 failures.
```

```
sage -t devel/sage/doc/en/reference/rings_standard.rst
    [0 tests, 0.0 s]
sage -t devel/sage/doc/en/reference/combinat/root_syste**********************************************************************
File "programming", line 578, in programming
Failed example:
    for i in range(5):
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 590, in _run
        compileflags, 1)
      File "<doctest programming[0]>", line 1
        for i in range(5):
                         ^
    SyntaxError: unexpected EOF while parsing
**********************************************************************
1 items had failures:
   1 of 113 in programming
***Test Failed*** 1 failures.
ms.rst
    [0 tests, 0.0 s]
```

```
sage -t devel/sage/sage/databases/odlyzko.py
    [0 tests, 0.0 s]
sag**********************************************************************
File "sage.doctest.reporting", line 93, in sage.doctest.reporting.DocTestReporter.report
Failed example:
    DTR.report(FDS, True, 0, None, "Output so far...")
Expected:
    sage -t .../devel/sage/sage/doctest/reporting.py
        Timed out!
    Output so far...
Got:
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py
        Timed out!
    Tests run before process froze:
    Output so far...
**********************************************************************
File "sage.doctest.reporting", line 102, in sage.doctest.reporting.DocTestReporter.report
Failed example:
    DTR.report(FDS, False, 3, None, "Output before bad exit")
Expected:
    sage -t .../devel/sage/sage/doctest/reporting.py
        Bad exit: 3
    Output before bad exit
Got:
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py
        Bad exit: 3
    Tests run before process failed:
    Output before bad exit
**********************************************************************
File "sage.doctest.reporting", line 215, in sage.doctest.reporting.DocTestReporter.finalize
Failed example:
    DTR.report(FDS, True, 0, None, "Output so far...")
Expected:
    sage -t .../devel/sage/sage/doctest/reporting.py
        Timed out!
    Output so far...
Got:
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py
        Timed out!
    Tests run before process froze:
    Output so far...
**********************************************************************
File "sage.doctest.reporting", line 219, in sage.doctest.reporting.DocTestReporter.finalize
Failed example:
    DTR.report(FDS, False, 3, None, "Output before bad exit")
Expected:
    sage -t .../devel/sage/sage/doctest/reporting.py
        Bad exit: 3
    Output before bad exit
Got:
    sage -t /release/merger/sage-5.1.beta5-12415/devel/sage/sage/doctest/reporting.py
        Bad exit: 3
    Tests run before process failed:
    Output before bad exit
**********************************************************************
2 items had failures:
   2 of  26 in sage.doctest.reporting.DocTestReporter.finalize
   2 of  23 in sage.doctest.reporting.DocTestReporter.report
***Test Failed*** 4 failures.
e -t devel/sage/sage/databases/sloane.py
    [1 tests, 0.1 s]
```

```
sage -t devel/sage/sage/ext/cdefs.pxi
    [0 tests, 0.0 s]
sage -t devel/sage/sage/docte**********************************************************************
File "sage.doctest.control", line 252, in sage.doctest.control.DocTestController.add_files
Failed example:
    DC = DocTestController(DD, [])
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 591, in _run
        self.execute(example, compiled, test.globs)
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 873, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.add_files[2]>", line 1, in <module>
        DC = DocTestController(DD, [])
      File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/control.py", line 132, in __init__
        print "Unable to open logfile at %s\nProceeding without logging."%(self.logfile)
    AttributeError: 'DocTestController' object has no attribute 'logfile'
**********************************************************************
```

```
sage -t devel/sage/sage/misc/profiler.py
    [0 tests, 0.0 s]
sage -t devel/sage/**********************************************************************
File "sage.matrix.benchmark", line 11, in sage.matrix.benchmark
Failed example:
    print "starting"; b.report([b.det_ZZ], 'Test', systems=['sage'])
Expected:
    starting...
    ======================================================================
              Test
    ======================================================================
    ...
    ======================================================================
Got:
    Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
    starting
    ======================================================================
              Test
    ======================================================================
    <BLANKLINE>
    <BLANKLINE>
    ----------------------------------------------------------------------
    Dense integer determinant over ZZ.
        Given an n x n matrix A over ZZ with random entries
        between min and max, inclusive, compute det(A).
    <BLANKLINE>
        INPUT:
    <BLANKLINE>
        - ``n`` - matrix dimension (default: ``200``)
        - ``min`` - minimal value for entries of matrix (default: ``1``)
        - ``max`` - maximal value for entries of matrix (default: ``100``)
        - ``system`` - either 'sage' or 'magma' (default: 'sage')
    <BLANKLINE>
        EXAMPLES::
    <BLANKLINE>
            sage: import sage.matrix.benchmark as b
            sage: ts = b.det_ZZ(200)
            sage: tm = b.det_ZZ(200, system='magma')  # optional - magma
               sage
              1.370
    ======================================================================
**********************************************************************
```



---

archive/issue_comments_135838.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nAnother annoyance, compare in the output:\n\n```\nsage -t devel/sage/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py\n```\n\n```\nsage -t /release/merger/sage-5.1.beta5-12415/devel/sagenb-main/sagenb/interfaces/expect.py\n```\nWhy a relative path in the first case but a full path in the second case?  Also with `-a`, only absolute paths are shown.  I would prefer all paths to be relative to the current directory.",
    "created_at": "2012-06-26T09:53:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135838",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:57" align="right">comment:57</div>

Another annoyance, compare in the output:

```
sage -t devel/sage/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py
```

```
sage -t /release/merger/sage-5.1.beta5-12415/devel/sagenb-main/sagenb/interfaces/expect.py
```
Why a relative path in the first case but a full path in the second case?  Also with `-a`, only absolute paths are shown.  I would prefer all paths to be relative to the current directory.



---

archive/issue_comments_135839.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\n\n```\njdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -tp 1000000000 devel/sage/sage/rings/padics/\nRunning doctests with ID 2012-06-26-11-58-02-3accd40f.\nDoctesting 32 files using 1000000000 threads\n```\n\nThe previous doctester would reduce the number of threads to be at most the number of files to test.",
    "created_at": "2012-06-26T09:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135839",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>


```
jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -tp 1000000000 devel/sage/sage/rings/padics/
Running doctests with ID 2012-06-26-11-58-02-3accd40f.
Doctesting 32 files using 1000000000 threads
```

The previous doctester would reduce the number of threads to be at most the number of files to test.



---

archive/issue_comments_135840.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nA very useful feature from the previous doctester which is missing here is that `--verbose` actually shows the output as the test is running.  So when it gets stuck somewhere, you actually see that it gets stuck.  Currently, the whole test result is simply dumped at the end.\n\nAlso: previously, line numbers were shown with `--verbose` (albeit in a very bad way).\n\nOne more feature-request: with `--verbose`, show the time taken *for each single test*, i.e. I would like\n\n```\nTrying (line 242):\n    EllipticCurve('900d1').integral_points()\nExpecting:\n    [(-11 : 27 : 1), (-4 : 34 : 1), (4 : 18 : 1), (16 : 54 : 1)]\nok [0.10s]\nTrying (line 243):\n    E=EllipticCurve([-879984,319138704])\nExpecting nothing\nok [1.92s]\nTrying (line 255):\n    P1=E.point((540,1188)); P2=E.point((576,1836))\nExpecting nothing\nok [4.59s]\n```\n\nIt's totally okay for me to disallow `--verbose` in parallel tests.",
    "created_at": "2012-06-26T10:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135840",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

A very useful feature from the previous doctester which is missing here is that `--verbose` actually shows the output as the test is running.  So when it gets stuck somewhere, you actually see that it gets stuck.  Currently, the whole test result is simply dumped at the end.

Also: previously, line numbers were shown with `--verbose` (albeit in a very bad way).

One more feature-request: with `--verbose`, show the time taken *for each single test*, i.e. I would like

```
Trying (line 242):
    EllipticCurve('900d1').integral_points()
Expecting:
    [(-11 : 27 : 1), (-4 : 34 : 1), (4 : 18 : 1), (16 : 54 : 1)]
ok [0.10s]
Trying (line 243):
    E=EllipticCurve([-879984,319138704])
Expecting nothing
ok [1.92s]
Trying (line 255):
    P1=E.point((540,1188)); P2=E.point((576,1836))
Expecting nothing
ok [4.59s]
```

It's totally okay for me to disallow `--verbose` in parallel tests.



---

archive/issue_comments_135841.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nWhat does the `--serial` option do and how is it different from `-p 1`?",
    "created_at": "2012-06-26T10:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135841",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

What does the `--serial` option do and how is it different from `-p 1`?



---

archive/issue_comments_135842.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI would expect `sage -t -f` not to need any filename arguments (similarly to `-a`), just run all the failed tests.\n\nHowever:\n\n```\njdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t -f\nUsage: sage -t [options] filenames\n```",
    "created_at": "2012-06-26T10:18:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135842",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">comment:61</div>

I would expect `sage -t -f` not to need any filename arguments (similarly to `-a`), just run all the failed tests.

However:

```
jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t -f
Usage: sage -t [options] filenames
```



---

archive/issue_comments_135843.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nPerhaps add a `-T` option as a synonym for `--timeout`?",
    "created_at": "2012-06-26T11:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135843",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

Perhaps add a `-T` option as a synonym for `--timeout`?



---

archive/issue_comments_135844.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI'm collecting some \"special cases\" for doctests in [http://boxen.math.washington.edu/home/jdemeyer/doctest/](http://boxen.math.washington.edu/home/jdemeyer/doctest/) (maybe these should eventually become \"meta-doctests\").\n\nThe doctesting framework seems to hang on\n\n```\njdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py\nRunning doctests with ID 2012-06-26-14-12-55-fbefc7c4.\nDoctesting 1 file.\n```\n\nWhile the following gives an error inside the doctesting framework (this also used to fail before):\n\n```\njdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/keyboardinterrupt.py\nRunning doctests with ID 2012-06-26-14-12-38-b70e54c4.\nDoctesting 1 file.\nsage -t /home/jdemeyer/doctest/keyboardinterrupt.py\nTraceback (most recent call last):\n  File \"/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/reporting.py\", line 146, in report\n    ntests, runner = results\nTypeError: 'NoneType' object is not iterable\n\n------------------------------------------------------------------------\nDoctests interrupted: 0/1 files tested\n------------------------------------------------------------------------\nTotal time for all tests: 1.0 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```\n\nThe following should report an error but doesn't:\n\n```\njdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py\nRunning doctests with ID 2012-06-26-14-14-08-06a01dbf.\nDoctesting 1 file.\nsage -t /home/jdemeyer/doctest/sig_on.py\n    [1 tests, 1.1 s]\n------------------------------------------------------------------------\nAll tests passed!\n------------------------------------------------------------------------\nTotal time for all tests: 2.1 seconds\n    cpu time: 0.1 seconds\n    cumulative wall time: 1.1 seconds\n```",
    "created_at": "2012-06-26T12:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135844",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">comment:63</div>

I'm collecting some "special cases" for doctests in [http://boxen.math.washington.edu/home/jdemeyer/doctest/](http://boxen.math.washington.edu/home/jdemeyer/doctest/) (maybe these should eventually become "meta-doctests").

The doctesting framework seems to hang on

```
jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py
Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.
Doctesting 1 file.
```

While the following gives an error inside the doctesting framework (this also used to fail before):

```
jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/keyboardinterrupt.py
Running doctests with ID 2012-06-26-14-12-38-b70e54c4.
Doctesting 1 file.
sage -t /home/jdemeyer/doctest/keyboardinterrupt.py
Traceback (most recent call last):
  File "/release/merger/sage-5.1.beta5-12415/local/lib/python2.7/site-packages/sage/doctest/reporting.py", line 146, in report
    ntests, runner = results
TypeError: 'NoneType' object is not iterable

------------------------------------------------------------------------
Doctests interrupted: 0/1 files tested
------------------------------------------------------------------------
Total time for all tests: 1.0 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```

The following should report an error but doesn't:

```
jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py
Running doctests with ID 2012-06-26-14-14-08-06a01dbf.
Doctesting 1 file.
sage -t /home/jdemeyer/doctest/sig_on.py
    [1 tests, 1.1 s]
------------------------------------------------------------------------
All tests passed!
------------------------------------------------------------------------
Total time for all tests: 2.1 seconds
    cpu time: 0.1 seconds
    cumulative wall time: 1.1 seconds
```



---

archive/issue_comments_135845.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nI'm working on fixing these.  Thanks for the feedback!",
    "created_at": "2012-06-26T16:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135845",
    "user": "https://github.com/roed314"
}
```

<div id="comment:64" align="right">comment:64</div>

I'm working on fixing these.  Thanks for the feedback!



---

archive/issue_comments_135846.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@jdemeyer](#comment%3A60):\n> What does the `--serial` option do and how is it different from `-p 1`?\n\nThe `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.",
    "created_at": "2012-06-26T21:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135846",
    "user": "https://github.com/roed314"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@jdemeyer](#comment%3A60):
> What does the `--serial` option do and how is it different from `-p 1`?

The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.



---

archive/issue_comments_135847.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@jdemeyer](#comment%3A62):\n> Perhaps add a `-T` option as a synonym for `--timeout`?\n\nDone.  Are there other options that should have a short form?  Maybe `-L` for `--long`?  I'd like to avoid too much mixing of upper and lower case....",
    "created_at": "2012-06-26T21:05:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135847",
    "user": "https://github.com/roed314"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@jdemeyer](#comment%3A62):
> Perhaps add a `-T` option as a synonym for `--timeout`?

Done.  Are there other options that should have a short form?  Maybe `-L` for `--long`?  I'd like to avoid too much mixing of upper and lower case....



---

archive/issue_comments_135848.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThere doesn't seem to be an objection to diverting `stderr`, so I'm going to not worry about keeping changes resulting from that decision separate (I don't want to update that patch since it requires rebuilding a lot of files).",
    "created_at": "2012-06-26T21:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135848",
    "user": "https://github.com/roed314"
}
```

<div id="comment:67" align="right">comment:67</div>

There doesn't seem to be an objection to diverting `stderr`, so I'm going to not worry about keeping changes resulting from that decision separate (I don't want to update that patch since it requires rebuilding a lot of files).



---

archive/issue_comments_135849.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@jdemeyer](#comment%3A63):\n> The following should report an error but doesn't:\n> \n> ```\n> jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py\n> Running doctests with ID 2012-06-26-14-14-08-06a01dbf.\n> Doctesting 1 file.\n> sage -t /home/jdemeyer/doctest/sig_on.py\n>     [1 tests, 1.1 s]\n> ------------------------------------------------------------------------\n> All tests passed!\n> ------------------------------------------------------------------------\n> Total time for all tests: 2.1 seconds\n>     cpu time: 0.1 seconds\n>     cumulative wall time: 1.1 seconds\n> ```\n\nIf I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?",
    "created_at": "2012-06-26T21:53:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135849",
    "user": "https://github.com/roed314"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@jdemeyer](#comment%3A63):
> The following should report an error but doesn't:
> 
> ```
> jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py
> Running doctests with ID 2012-06-26-14-14-08-06a01dbf.
> Doctesting 1 file.
> sage -t /home/jdemeyer/doctest/sig_on.py
>     [1 tests, 1.1 s]
> ------------------------------------------------------------------------
> All tests passed!
> ------------------------------------------------------------------------
> Total time for all tests: 2.1 seconds
>     cpu time: 0.1 seconds
>     cumulative wall time: 1.1 seconds
> ```

If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?



---

archive/issue_comments_135850.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@roed314](#comment%3A68):\n> Replying to [@jdemeyer](#comment%3A63):\n> > The following should report an error but doesn't:\n> > \n> > ```\n> > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py\n> > Running doctests with ID 2012-06-26-14-14-08-06a01dbf.\n> > Doctesting 1 file.\n> > sage -t /home/jdemeyer/doctest/sig_on.py\n> >     [1 tests, 1.1 s]\n> > ------------------------------------------------------------------------\n> > All tests passed!\n> > ------------------------------------------------------------------------\n> > Total time for all tests: 2.1 seconds\n> >     cpu time: 0.1 seconds\n> >     cumulative wall time: 1.1 seconds\n> > ```\n> \n> \n> If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?\n\nI can even run sage commands afterward, like `factor(2^199-1)`.  But if I hit Ctl-C, I get a segfault (and it screws up my terminal).",
    "created_at": "2012-06-26T22:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135850",
    "user": "https://github.com/roed314"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@roed314](#comment%3A68):
> Replying to [@jdemeyer](#comment%3A63):
> > The following should report an error but doesn't:
> > 
> > ```
> > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sig_on.py
> > Running doctests with ID 2012-06-26-14-14-08-06a01dbf.
> > Doctesting 1 file.
> > sage -t /home/jdemeyer/doctest/sig_on.py
> >     [1 tests, 1.1 s]
> > ------------------------------------------------------------------------
> > All tests passed!
> > ------------------------------------------------------------------------
> > Total time for all tests: 2.1 seconds
> >     cpu time: 0.1 seconds
> >     cumulative wall time: 1.1 seconds
> > ```
> 
> 
> If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?

I can even run sage commands afterward, like `factor(2^199-1)`.  But if I hit Ctl-C, I get a segfault (and it screws up my terminal).



---

archive/issue_comments_135851.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nNew version posted.  `sage -t --long -a` passes all tests except the one related to #13145.\n\n`/home/jdemeyer/doctest/keyboardinterrupt.py` passes if you remove the trailing colon.  I've updated the framework to recover a bit more gracefully if a doctest raises an unexpected KeyboardInterrupt, but it behaves a bit strangely since it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).  I think the new behavior is actually fairly reasonable: try it on your file without removing the colon.",
    "created_at": "2012-06-26T23:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135851",
    "user": "https://github.com/roed314"
}
```

<div id="comment:70" align="right">comment:70</div>

New version posted.  `sage -t --long -a` passes all tests except the one related to #13145.

`/home/jdemeyer/doctest/keyboardinterrupt.py` passes if you remove the trailing colon.  I've updated the framework to recover a bit more gracefully if a doctest raises an unexpected KeyboardInterrupt, but it behaves a bit strangely since it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).  I think the new behavior is actually fairly reasonable: try it on your file without removing the colon.



---

archive/issue_comments_135852.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@jdemeyer](#comment%3A63):\n> The doctesting framework seems to hang on\n> \n> ```\n> jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py\n> Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.\n> Doctesting 1 file.\n> ```\n\nIs this behavior acceptable?  Eventually the test will time out (you can try running `sage -t -T 5 /home/jdemeyer/doctest/sigdie.py`) and the ending summary will be printed with a time out.",
    "created_at": "2012-06-26T23:54:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135852",
    "user": "https://github.com/roed314"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@jdemeyer](#comment%3A63):
> The doctesting framework seems to hang on
> 
> ```
> jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py
> Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.
> Doctesting 1 file.
> ```

Is this behavior acceptable?  Eventually the test will time out (you can try running `sage -t -T 5 /home/jdemeyer/doctest/sigdie.py`) and the ending summary will be printed with a time out.



---

archive/issue_comments_135853.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@roed314](#comment%3A70):\n> it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).\n\nA \"real\" interrupt would interrupt also the master process, a fake doctest-interrupt only the child process.  That's an easy way to distinguish.",
    "created_at": "2012-06-27T07:36:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135853",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@roed314](#comment%3A70):
> it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).

A "real" interrupt would interrupt also the master process, a fake doctest-interrupt only the child process.  That's an easy way to distinguish.



---

archive/issue_comments_135854.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nReplying to [@roed314](#comment%3A71):\n> Replying to [@jdemeyer](#comment%3A63):\n> > The doctesting framework seems to hang on\n> > \n> > ```\n> > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py\n> > Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.\n> > Doctesting 1 file.\n> > ```\n> \n> \n> Is this behavior acceptable?\n\nNot really.  One should get a message that Sage crashed (compare with the old doctesting framework).",
    "created_at": "2012-06-27T07:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135854",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:73" align="right">comment:73</div>

Replying to [@roed314](#comment%3A71):
> Replying to [@jdemeyer](#comment%3A63):
> > The doctesting framework seems to hang on
> > 
> > ```
> > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py
> > Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.
> > Doctesting 1 file.
> > ```
> 
> 
> Is this behavior acceptable?

Not really.  One should get a message that Sage crashed (compare with the old doctesting framework).



---

archive/issue_comments_135855.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@roed314](#comment%3A68):\n> If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?\n\nLet me elaborate: #10030 added a check to the doctesting code which checks\n\n```\nsage: sig_on_count()\n0\n```\nafter each doctest (i.e. it appends this to every doctest), to ensure there are no unbalanced `sig_on()`s.  Could you add this also to your doctesting framework?",
    "created_at": "2012-06-27T07:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135855",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@roed314](#comment%3A68):
> If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?

Let me elaborate: #10030 added a check to the doctesting code which checks

```
sage: sig_on_count()
0
```
after each doctest (i.e. it appends this to every doctest), to ensure there are no unbalanced `sig_on()`s.  Could you add this also to your doctesting framework?



---

archive/issue_comments_135856.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@jdemeyer](#comment%3A72):\n> Replying to [@roed314](#comment%3A70):\n> > it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).\n> \n> \n> A \"real\" interrupt would interrupt also the master process, a fake doctest-interrupt only the child process.  That's an easy way to distinguish.\n\nSure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.  The parent process can continue the doctests though....",
    "created_at": "2012-06-27T08:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135856",
    "user": "https://github.com/roed314"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@jdemeyer](#comment%3A72):
> Replying to [@roed314](#comment%3A70):
> > it's difficult to distinguish between an actual interrupt (in which case the testing should terminate) and one raised by a doctest (in which case tests of other files could continue).
> 
> 
> A "real" interrupt would interrupt also the master process, a fake doctest-interrupt only the child process.  That's an easy way to distinguish.

Sure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.  The parent process can continue the doctests though....



---

archive/issue_comments_135857.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nReplying to [@jdemeyer](#comment%3A73):\n> Replying to [@roed314](#comment%3A71):\n> > Replying to [@jdemeyer](#comment%3A63):\n> > > The doctesting framework seems to hang on\n> > > \n> > > ```\n> > > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py\n> > > Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.\n> > > Doctesting 1 file.\n> > > ```\n> > \n> > \n> > Is this behavior acceptable?\n> \n> Not really.  One should get a message that Sage crashed (compare with the old doctesting framework).\n\nOkay, I will look into it.  I assume that the underlying process has terminated and I should be able to get at the exit code somehow.",
    "created_at": "2012-06-27T08:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135857",
    "user": "https://github.com/roed314"
}
```

<div id="comment:76" align="right">comment:76</div>

Replying to [@jdemeyer](#comment%3A73):
> Replying to [@roed314](#comment%3A71):
> > Replying to [@jdemeyer](#comment%3A63):
> > > The doctesting framework seems to hang on
> > > 
> > > ```
> > > jdemeyer@sage:/release/merger/sage-5.1.beta5-12415$ ./sage -t /home/jdemeyer/doctest/sigdie.py
> > > Running doctests with ID 2012-06-26-14-12-55-fbefc7c4.
> > > Doctesting 1 file.
> > > ```
> > 
> > 
> > Is this behavior acceptable?
> 
> Not really.  One should get a message that Sage crashed (compare with the old doctesting framework).

Okay, I will look into it.  I assume that the underlying process has terminated and I should be able to get at the exit code somehow.



---

archive/issue_comments_135858.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nReplying to [@jdemeyer](#comment%3A74):\n> Replying to [@roed314](#comment%3A68):\n> > If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?\n> \n> Let me elaborate: #10030 added a check to the doctesting code which checks\n> \n> ```\n> sage: sig_on_count()\n> 0\n> ```\n> after each doctest (i.e. it appends this to every doctest), to ensure there are no unbalanced `sig_on()`s.  Could you add this also to your doctesting framework?\n\nThis shouldn't be too hard.",
    "created_at": "2012-06-27T08:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135858",
    "user": "https://github.com/roed314"
}
```

<div id="comment:77" align="right">comment:77</div>

Replying to [@jdemeyer](#comment%3A74):
> Replying to [@roed314](#comment%3A68):
> > If I do `cython('sig_on()')` at the command line nothing happens.  Is it supposed to crash Sage?
> 
> Let me elaborate: #10030 added a check to the doctesting code which checks
> 
> ```
> sage: sig_on_count()
> 0
> ```
> after each doctest (i.e. it appends this to every doctest), to ensure there are no unbalanced `sig_on()`s.  Could you add this also to your doctesting framework?

This shouldn't be too hard.



---

archive/issue_comments_135859.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nReplying to [@roed314](#comment%3A46):\n> Alright, I'm going to start running tests.  There are still some remaining issues, but the patches are in a state where someone else might want to look at them.  :-)\n> \n> Remaining problems:\n> \n> * #13145 needs work, generating some doctest failures related to deallocating multivariate polynomials\n> * hg_sage seems to be broken, causing the --new option to fail\n> * valgrinding `sage -t` doesn't work; I'm not sure whether it did before\n> * The new code doesn't support xml output\n> \n> I'll see if I find more when running `sage -t --all`.\n\n\nI'm going to sleep; let me know which of these need to be fixed in order for this ticket to get a positive review.  I will also keep working on the tests in `/home/jdemeyer/doctest/`.  And of course if you find more problems or have other feature requests, keep those coming too!",
    "created_at": "2012-06-27T08:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135859",
    "user": "https://github.com/roed314"
}
```

<div id="comment:78" align="right">comment:78</div>

Replying to [@roed314](#comment%3A46):
> Alright, I'm going to start running tests.  There are still some remaining issues, but the patches are in a state where someone else might want to look at them.  :-)
> 
> Remaining problems:
> 
> * #13145 needs work, generating some doctest failures related to deallocating multivariate polynomials
> * hg_sage seems to be broken, causing the --new option to fail
> * valgrinding `sage -t` doesn't work; I'm not sure whether it did before
> * The new code doesn't support xml output
> 
> I'll see if I find more when running `sage -t --all`.


I'm going to sleep; let me know which of these need to be fixed in order for this ticket to get a positive review.  I will also keep working on the tests in `/home/jdemeyer/doctest/`.  And of course if you find more problems or have other feature requests, keep those coming too!



---

archive/issue_comments_135860.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nReplying to [@roed314](#comment%3A75):\n> Sure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.\n\nOkay, I see what you mean.  I would propose not to special-case `KeyboardInterrupt` at all in the child process.  When the parent process gets a `KeyboardInterrupt`, kill all child processes (without showing their output) and exit.\n\n(note: since the old doctesting framework didn't do this either, I don't consider this a prerequisite for positive review, but a nice feature to have.)",
    "created_at": "2012-06-27T17:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135860",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:79" align="right">comment:79</div>

Replying to [@roed314](#comment%3A75):
> Sure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.

Okay, I see what you mean.  I would propose not to special-case `KeyboardInterrupt` at all in the child process.  When the parent process gets a `KeyboardInterrupt`, kill all child processes (without showing their output) and exit.

(note: since the old doctesting framework didn't do this either, I don't consider this a prerequisite for positive review, but a nice feature to have.)



---

archive/issue_comments_135861.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nReplying to [@roed314](#comment%3A65):\n> Replying to [@jdemeyer](#comment%3A60):\n> > What does the `--serial` option do and how is it different from `-p 1`?\n> \n> \n> The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.\n\nI suppose you mean \"process\", not thread?  Still, I don't see the point of `--serial`.",
    "created_at": "2012-06-27T17:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135861",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:80" align="right">comment:80</div>

Replying to [@roed314](#comment%3A65):
> Replying to [@jdemeyer](#comment%3A60):
> > What does the `--serial` option do and how is it different from `-p 1`?
> 
> 
> The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.

I suppose you mean "process", not thread?  Still, I don't see the point of `--serial`.



---

archive/issue_comments_135862.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@jdemeyer](#comment%3A80):\n> Replying to [@roed314](#comment%3A65):\n> > Replying to [@jdemeyer](#comment%3A60):\n> > > What does the `--serial` option do and how is it different from `-p 1`?\n> > \n> > \n> > The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.\n> \n> I suppose you mean \"process\", not thread?  Still, I don't see the point of `--serial`.\n\nThe main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)\n\nI'm fine making it less prominent (having it not show up in the help display for `sage -t` for example, and not using it for `--verbose` mode).  But I think it should stick around since it currently exists, and it makes some kinds of bugs much easier to track down.",
    "created_at": "2012-06-27T21:32:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135862",
    "user": "https://github.com/roed314"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@jdemeyer](#comment%3A80):
> Replying to [@roed314](#comment%3A65):
> > Replying to [@jdemeyer](#comment%3A60):
> > > What does the `--serial` option do and how is it different from `-p 1`?
> > 
> > 
> > The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.
> 
> I suppose you mean "process", not thread?  Still, I don't see the point of `--serial`.

The main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)

I'm fine making it less prominent (having it not show up in the help display for `sage -t` for example, and not using it for `--verbose` mode).  But I think it should stick around since it currently exists, and it makes some kinds of bugs much easier to track down.



---

archive/issue_comments_135863.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@roed314](#comment%3A81):\n> Replying to [@jdemeyer](#comment%3A80):\n> > Replying to [@roed314](#comment%3A65):\n> > > Replying to [@jdemeyer](#comment%3A60):\n> > > > What does the `--serial` option do and how is it different from `-p 1`?\n> > > \n> > > \n> > > The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.\n> > \n> > I suppose you mean \"process\", not thread?  Still, I don't see the point of `--serial`.\n> \n> \n> The main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)\n> \n> I'm fine making it less prominent (having it not show up in the help display for `sage -t` for example, and not using it for `--verbose` mode).  But I think it should stick around since it currently exists, and it makes some kinds of bugs much easier to track down.\n\nI'm also using it for `--gdb` since it makes the tracebacks simpler, though I'm not sure that's necessary.\n\nDo you ever use `sage -t` with valgrind?  I'm not sure exactly what's wrong with `sage -t --valgrind <FILENAME>`.",
    "created_at": "2012-06-27T21:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135863",
    "user": "https://github.com/roed314"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@roed314](#comment%3A81):
> Replying to [@jdemeyer](#comment%3A80):
> > Replying to [@roed314](#comment%3A65):
> > > Replying to [@jdemeyer](#comment%3A60):
> > > > What does the `--serial` option do and how is it different from `-p 1`?
> > > 
> > > 
> > > The `-p 1` has one worker: there's another thread which collates and prints answers.  `-p 1` is the default.
> > 
> > I suppose you mean "process", not thread?  Still, I don't see the point of `--serial`.
> 
> 
> The main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)
> 
> I'm fine making it less prominent (having it not show up in the help display for `sage -t` for example, and not using it for `--verbose` mode).  But I think it should stick around since it currently exists, and it makes some kinds of bugs much easier to track down.

I'm also using it for `--gdb` since it makes the tracebacks simpler, though I'm not sure that's necessary.

Do you ever use `sage -t` with valgrind?  I'm not sure exactly what's wrong with `sage -t --valgrind <FILENAME>`.



---

archive/issue_comments_135864.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nReplying to [@jdemeyer](#comment%3A79):\n> Replying to [@roed314](#comment%3A75):\n> > Sure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.\n> \n> Okay, I see what you mean.  I would propose not to special-case `KeyboardInterrupt` at all in the child process.  When the parent process gets a `KeyboardInterrupt`, kill all child processes (without showing their output) and exit.\n> \n> (note: since the old doctesting framework didn't do this either, I don't consider this a prerequisite for positive review, but a nice feature to have.)\n\nI just tried changing the interrupt handling so that `KeyboardInterrupt` is handled in the parent process and it doesn't work as well: there's extraneous printing happening when the doctest framework thinks it's just printing an unexpected exception, and I don't see a good way to get rid of it.\n\nI think the current handling of KeyboardInterrupts is fine.",
    "created_at": "2012-06-28T04:37:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135864",
    "user": "https://github.com/roed314"
}
```

<div id="comment:83" align="right">comment:83</div>

Replying to [@jdemeyer](#comment%3A79):
> Replying to [@roed314](#comment%3A75):
> > Sure, and for reporting what happened to the user this is fine.  But from the child process' perspective, an unexpected `KeyboardInterrupt` has been raised and it should stop testing that file.
> 
> Okay, I see what you mean.  I would propose not to special-case `KeyboardInterrupt` at all in the child process.  When the parent process gets a `KeyboardInterrupt`, kill all child processes (without showing their output) and exit.
> 
> (note: since the old doctesting framework didn't do this either, I don't consider this a prerequisite for positive review, but a nice feature to have.)

I just tried changing the interrupt handling so that `KeyboardInterrupt` is handled in the parent process and it doesn't work as well: there's extraneous printing happening when the doctest framework thinks it's just printing an unexpected exception, and I don't see a good way to get rid of it.

I think the current handling of KeyboardInterrupts is fine.



---

archive/issue_comments_135865.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nI'm going to be offline until Tuesday.  More feedback while I'm gone would be great.  :-)",
    "created_at": "2012-06-28T21:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135865",
    "user": "https://github.com/roed314"
}
```

<div id="comment:84" align="right">comment:84</div>

I'm going to be offline until Tuesday.  More feedback while I'm gone would be great.  :-)



---

archive/issue_comments_135866.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nAs far as I understand it, this new framework should allow for the same commands (e.g., `sage -tp 6 --long devel/sage/sage/matrix/`). In addition, though, there are new command-line options to `sage-runtest`, which should available through `sage -t ...`, right? Which of these new options should be documented in the help messages `usage` and/or `usage_advanced` at the top of `spkg/bin/sage`? Which should be documented in the developer's guide?",
    "created_at": "2012-06-29T20:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135866",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:85" align="right">comment:85</div>

As far as I understand it, this new framework should allow for the same commands (e.g., `sage -tp 6 --long devel/sage/sage/matrix/`). In addition, though, there are new command-line options to `sage-runtest`, which should available through `sage -t ...`, right? Which of these new options should be documented in the help messages `usage` and/or `usage_advanced` at the top of `spkg/bin/sage`? Which should be documented in the developer's guide?



---

archive/issue_comments_135867.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nI'm back, and I've been working on a patch to the developer's guide.  I'll post something soon, and more comments on which options will be shown in usage.",
    "created_at": "2012-07-03T03:02:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135867",
    "user": "https://github.com/roed314"
}
```

<div id="comment:86" align="right">comment:86</div>

I'm back, and I've been working on a patch to the developer's guide.  I'll post something soon, and more comments on which options will be shown in usage.



---

archive/issue_comments_135868.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nI'm going to build and test Sage again with these patches.  Stay tuned...",
    "created_at": "2012-07-07T21:54:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135868",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:87" align="right">comment:87</div>

I'm going to build and test Sage again with these patches.  Stay tuned...



---

archive/issue_comments_135869.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch,](https://github.com/sagemath/sage/files/ticket12415/c7a4af89fe800f7cdb7c2cc42809d45b.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2012-07-07T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135869",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch,](https://github.com/sagemath/sage/files/ticket12415/c7a4af89fe800f7cdb7c2cc42809d45b.gz) [attachment: 12415_doctest_fixes.patch,](https://github.com/sagemath/sage/files/ticket12415/5e0b23d995017a7b6b3d2800c98454e1.gz) [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135870.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871**",
    "created_at": "2012-07-07T22:01:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135870",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871**



---

archive/issue_events_167836.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-07T22:01:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167836"
}
```



---

archive/issue_events_167837.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-07T22:01:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167837"
}
```



---

archive/issue_comments_135871.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nNeeds to be rebased to #11871.",
    "created_at": "2012-07-07T22:01:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135871",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:89" align="right">comment:89</div>

Needs to be rebased to #11871.



---

archive/issue_comments_135872.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@jdemeyer](#comment%3A89):\n> Needs to be rebased to #11871.\n\nDone.  I will make sure the suggestions in comment 56 are addressed.",
    "created_at": "2012-07-08T02:04:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135872",
    "user": "https://github.com/roed314"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@jdemeyer](#comment%3A89):
> Needs to be rebased to #11871.

Done.  I will make sure the suggestions in comment 56 are addressed.



---

archive/issue_comments_135873.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nThe change to 12415_script.patch fixes a problem with interrupting doctests on sage.math.",
    "created_at": "2012-07-08T09:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135873",
    "user": "https://github.com/roed314"
}
```

<div id="comment:91" align="right">comment:91</div>

The change to 12415_script.patch fixes a problem with interrupting doctests on sage.math.



---

archive/issue_comments_135874.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nWhen doing `make ptest` and `make ptestlong`, all doctests are run but there is no summary at the end.  The processes end with exit code 132 (which usually means an Illegal Instruction but probably not here).\n\nThe following are the last lines output by `make ptest` and `make ptestlong`:\n\n```\nsage -t devel/sage/doc/en/thematic_tutorials/lie/weyl_groups.rst\n    [44 tests, 4.6 s]\nsage -t devel/sage/doc/fr/tutorial/tour_plotting.rst\n    [35 tests, 9.2 s]\nsage -t devel/sage/doc/de/tutorial/tour_plotting.rst\n    [51 tests, 10.7 s]\nsage -t devel/sage/doc/en/tutorial/tour_plotting.rst\n    [51 tests, 10.9 s]\nsage -t devel/sage/doc/ru/tutorial/tour_plotting.rst\n    [46 tests, 10.9 s]\n```\nand\n\n```\nsage -t --long devel/sage/sage/combinat/crystals/__init__.py\n    [0 tests, 0.0 s]\nsage -t --long devel/sage/sage/gsl/callback.pyx\n    [0 tests, 0.0 s]\nsage -t --long devel/sage/sage/ext/python_module.pxi\n    [0 tests, 0.0 s]\nsage -t --long devel/sage/sage/groups/perm_gps/all.py\n    [0 tests, 0.0 s]\nsage -t --long devel/sage/doc/en/bordeaux_2008/modular_forms_and_hecke_operators.rst\n    [0 tests, 0.0 s]\n```",
    "created_at": "2012-07-09T06:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135874",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:92" align="right">comment:92</div>

When doing `make ptest` and `make ptestlong`, all doctests are run but there is no summary at the end.  The processes end with exit code 132 (which usually means an Illegal Instruction but probably not here).

The following are the last lines output by `make ptest` and `make ptestlong`:

```
sage -t devel/sage/doc/en/thematic_tutorials/lie/weyl_groups.rst
    [44 tests, 4.6 s]
sage -t devel/sage/doc/fr/tutorial/tour_plotting.rst
    [35 tests, 9.2 s]
sage -t devel/sage/doc/de/tutorial/tour_plotting.rst
    [51 tests, 10.7 s]
sage -t devel/sage/doc/en/tutorial/tour_plotting.rst
    [51 tests, 10.9 s]
sage -t devel/sage/doc/ru/tutorial/tour_plotting.rst
    [46 tests, 10.9 s]
```
and

```
sage -t --long devel/sage/sage/combinat/crystals/__init__.py
    [0 tests, 0.0 s]
sage -t --long devel/sage/sage/gsl/callback.pyx
    [0 tests, 0.0 s]
sage -t --long devel/sage/sage/ext/python_module.pxi
    [0 tests, 0.0 s]
sage -t --long devel/sage/sage/groups/perm_gps/all.py
    [0 tests, 0.0 s]
sage -t --long devel/sage/doc/en/bordeaux_2008/modular_forms_and_hecke_operators.rst
    [0 tests, 0.0 s]
```



---

archive/issue_comments_135875.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nThen I get the following `make ptestlong` failures:\n\n```\nRunning doctests with ID 2012-07-08-23-57-28-0d45df42.\nDoctesting the Sage notebook.\nSorting sources by runtime so that slower doctests are run first....\nDoctesting 2067 files using 6 threads.\nUsage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)\n\nsage-runtests: error: no such option: -p\nsage -t --long devel/sage/doc/common/builder.py\n    Bad exit: 2\n********************************************************************************\nTests run before process failed:\n\n********************************************************************************\nsage -t --long devel/sage/sage/tests/interrupt.pyx\n    [80 tests, 15.0 s]\n```\n\n```\nsage -t --long devel/sage/sage/matrix/matrix2.pyx\n    [1980 tests, 24.9 s]\n**********************************************************************\nFile \"devel/sage/sage/tests/cmdline.py\", line 272, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(\"All tests passed!\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"devel/sage/sage/tests/cmdline.py\", line 277, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(\"All tests passed!\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   2 of 185 in sage.tests.cmdline.test_executable\n***Test Failed*** 2 failures.\nsage -t --long devel/sage/sage/tests/cmdline.py\n    [184 tests, 23.0 s]\n```\n\n```\n**********************************************************************\nFile \"devel/sage/sage/doctest/control.py\", line 263, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    DC = DocTestController(DD, [])\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 590, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 881, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.add_files[2]>\", line 1, in <module>\n        DC = DocTestController(DD, [])\n      File \"/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 142, in __init__\n        print \"Unable to open logfile at %s\\nProceeding without logging.\"%(self.logfile)\n    AttributeError: 'DocTestController' object has no attribute 'logfile'\n**********************************************************************\n```\n+ errors related to #13145.",
    "created_at": "2012-07-09T06:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135875",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:93" align="right">comment:93</div>

Then I get the following `make ptestlong` failures:

```
Running doctests with ID 2012-07-08-23-57-28-0d45df42.
Doctesting the Sage notebook.
Sorting sources by runtime so that slower doctests are run first....
Doctesting 2067 files using 6 threads.
Usage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)

sage-runtests: error: no such option: -p
sage -t --long devel/sage/doc/common/builder.py
    Bad exit: 2
********************************************************************************
Tests run before process failed:

********************************************************************************
sage -t --long devel/sage/sage/tests/interrupt.pyx
    [80 tests, 15.0 s]
```

```
sage -t --long devel/sage/sage/matrix/matrix2.pyx
    [1980 tests, 24.9 s]
**********************************************************************
File "devel/sage/sage/tests/cmdline.py", line 272, in sage.tests.cmdline.test_executable
Failed example:
    out.find("All tests passed!") >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "devel/sage/sage/tests/cmdline.py", line 277, in sage.tests.cmdline.test_executable
Failed example:
    out.find("All tests passed!") >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   2 of 185 in sage.tests.cmdline.test_executable
***Test Failed*** 2 failures.
sage -t --long devel/sage/sage/tests/cmdline.py
    [184 tests, 23.0 s]
```

```
**********************************************************************
File "devel/sage/sage/doctest/control.py", line 263, in sage.doctest.control.DocTestController.add_files
Failed example:
    DC = DocTestController(DD, [])
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 590, in _run
        self.execute(example, compiled, test.globs)
      File "/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 881, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.add_files[2]>", line 1, in <module>
        DC = DocTestController(DD, [])
      File "/release/merger/sage-5.1.rc0-12415/local/lib/python2.7/site-packages/sage/doctest/control.py", line 142, in __init__
        print "Unable to open logfile at %s\nProceeding without logging."%(self.logfile)
    AttributeError: 'DocTestController' object has no attribute 'logfile'
**********************************************************************
```
+ errors related to #13145.



---

archive/issue_events_167838.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T08:03:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167838"
}
```



---

archive/issue_events_167839.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T08:03:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167839"
}
```



---

archive/issue_comments_135876.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nI thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`: after the change I ran `sage -tp --sagenb --long devel/sage/doc/common devel/sage/doc/[a-z][a-z] devel/sage/sage` 10 times with no failures (where before there had been 5 failures in `interrupt.pyx`).  But I just got another one.  Maybe it has to do with the load on sage.math?  There are more processes running now than when I ran the test earlier.\n\nJeroen, would you be willing to take a look at it since you wrote the tests in that file?\n\nAll the other tests pass for me, with the exception of startup.py.",
    "created_at": "2012-07-12T08:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135876",
    "user": "https://github.com/roed314"
}
```

<div id="comment:94" align="right">comment:94</div>

I thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`: after the change I ran `sage -tp --sagenb --long devel/sage/doc/common devel/sage/doc/[a-z][a-z] devel/sage/sage` 10 times with no failures (where before there had been 5 failures in `interrupt.pyx`).  But I just got another one.  Maybe it has to do with the load on sage.math?  There are more processes running now than when I ran the test earlier.

Jeroen, would you be willing to take a look at it since you wrote the tests in that file?

All the other tests pass for me, with the exception of startup.py.



---

archive/issue_comments_135877.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195**",
    "created_at": "2012-07-12T08:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135877",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195**



---

archive/issue_comments_135878.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nRebased the scripts patch to sage-5.1.",
    "created_at": "2012-07-12T08:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135878",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:96" align="right">comment:96</div>

Rebased the scripts patch to sage-5.1.



---

archive/issue_comments_135879.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nThe sagenb patch doesn't apply to the new notebook (#11080).",
    "created_at": "2012-07-12T08:25:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135879",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:97" align="right">comment:97</div>

The sagenb patch doesn't apply to the new notebook (#11080).



---

archive/issue_comments_135880.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@roed314](#comment%3A94):\n> I thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`\n\nThe tests *should* be designed in such a way that they work regardless of the delay.",
    "created_at": "2012-07-12T08:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135880",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@roed314](#comment%3A94):
> I thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`

The tests *should* be designed in such a way that they work regardless of the delay.



---

archive/issue_comments_135881.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nReplying to [@jdemeyer](#comment%3A98):\n> Replying to [@roed314](#comment%3A94):\n> > I thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`\n> \n> The tests *should* be designed in such a way that they work regardless of the delay.\n\nAgreed, but I'm at a loss for what's causing the problem, and it's difficult to debug since it's sporadic and a segfault.",
    "created_at": "2012-07-12T08:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135881",
    "user": "https://github.com/roed314"
}
```

<div id="comment:99" align="right">comment:99</div>

Replying to [@jdemeyer](#comment%3A98):
> Replying to [@roed314](#comment%3A94):
> > I thought I'd solved the sporadic problem in sage.tests.interrupt by increasing the delays in `test_sig_block_outside_sig_on`
> 
> The tests *should* be designed in such a way that they work regardless of the delay.

Agreed, but I'm at a loss for what's causing the problem, and it's difficult to debug since it's sporadic and a segfault.



---

archive/issue_comments_135882.json:
```json
{
    "body": "<div id=\"comment:100\" align=\"right\">comment:100</div>\n\nI have added some changes to `local/bin/.hgignore` to the scripts patch.  I discovered there was a problem when I put the file `sage-runtests` in `local/bin` without adding it using `hg`.  Surprisingly, `hg status` didn't show `sage-runtests`.",
    "created_at": "2012-07-12T13:15:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135882",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:100" align="right">comment:100</div>

I have added some changes to `local/bin/.hgignore` to the scripts patch.  I discovered there was a problem when I put the file `sage-runtests` in `local/bin` without adding it using `hg`.  Surprisingly, `hg status` didn't show `sage-runtests`.



---

archive/issue_comments_135883.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,6 +16,6 @@\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n-**Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)\n+**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors)\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n``````\n",
    "created_at": "2012-07-13T06:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135883",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,6 +16,6 @@
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
-**Apply** [attachment: 12415_sagenb_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes.patch.gz) to the sagenb repo (fixes doctest errors)
+**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors)
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
``````




---

archive/issue_comments_135884.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nI updated the sagenb patch",
    "created_at": "2012-07-13T06:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135884",
    "user": "https://github.com/roed314"
}
```

<div id="comment:101" align="right">comment:101</div>

I updated the sagenb patch



---

archive/issue_comments_135885.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,6 +16,6 @@\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n-**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors)\n+**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors) or wait for #13121\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n``````\n",
    "created_at": "2012-07-13T06:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135885",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,6 +16,6 @@
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
-**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors)
+**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors) or wait for #13121
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
``````




---

archive/issue_comments_135886.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nI imported the patch: https://github.com/sagemath/sagenb/pull/84\n\nI'll cut a sagenb 0.10.2 release with this fix in it (and put it on #13121). Jeroen, are you aware of any other tickets with bugfix-type patches to sagenb which I could merge at the same time?",
    "created_at": "2012-07-13T06:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135886",
    "user": "https://github.com/kini"
}
```

<div id="comment:102" align="right">comment:102</div>

I imported the patch: https://github.com/sagemath/sagenb/pull/84

I'll cut a sagenb 0.10.2 release with this fix in it (and put it on #13121). Jeroen, are you aware of any other tickets with bugfix-type patches to sagenb which I could merge at the same time?



---

archive/issue_comments_135887.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nActually, since this doctest fix actually breaks doctests with the current doctesting framework, should I leave this patch for sagenb 0.11 or something? How close would you say this ticket is to positive review? I notice it's set to milestone 5.3, whereas I'm hoping that #13121 can get into 5.2, so maybe that is the way to go.",
    "created_at": "2012-07-13T07:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135887",
    "user": "https://github.com/kini"
}
```

<div id="comment:103" align="right">comment:103</div>

Actually, since this doctest fix actually breaks doctests with the current doctesting framework, should I leave this patch for sagenb 0.11 or something? How close would you say this ticket is to positive review? I notice it's set to milestone 5.3, whereas I'm hoping that #13121 can get into 5.2, so maybe that is the way to go.



---

archive/issue_comments_135888.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@kini](#comment%3A103):\n> Actually, since this doctest fix actually breaks doctests with the current doctesting framework, should I leave this patch for sagenb 0.11 or something?\n\nYes please.\n\n> How close would you say this ticket is to positive review?\n\nI think it's mostly finished, but since this is a big change, I'm certainly not merging it in sage-5.2. Also, there is a good chance that various small issues will come up here.\n\n> I notice it's set to milestone 5.3, whereas I'm hoping that #13121 can get into 5.2, so maybe that is the way to go.\n\nYes.",
    "created_at": "2012-07-13T07:48:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135888",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@kini](#comment%3A103):
> Actually, since this doctest fix actually breaks doctests with the current doctesting framework, should I leave this patch for sagenb 0.11 or something?

Yes please.

> How close would you say this ticket is to positive review?

I think it's mostly finished, but since this is a big change, I'm certainly not merging it in sage-5.2. Also, there is a good chance that various small issues will come up here.

> I notice it's set to milestone 5.3, whereas I'm hoping that #13121 can get into 5.2, so maybe that is the way to go.

Yes.



---

archive/issue_events_167840.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-13T08:15:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167840"
}
```



---

archive/issue_events_167841.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-13T08:15:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167841"
}
```



---

archive/issue_comments_135889.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nJust one failure remaining related to this ticket:\n\n```\n**********************************************************************\nFile \"devel/sage/sage/doctest/control.py\", line 258, in sage.doctest.control.DocTestController.add_files\nFailed example:\n    DC = DocTestController(DD, [])\nExpected nothing\nGot:\n    Unable to open logfile at /release/merger/sage-5.1-12415/home/.sage//tmp/test.log\n    Proceeding without logging.\nsage -t devel/sage/sage/ext/gmp.pxi\n    [0 tests, 0.0 s]\n**********************************************************************\n1 items had failures:\n   1 of  15 in sage.doctest.control.DocTestController.add_files\n***Test Failed*** 1 failures.\nsage -t devel/sage/sage/doctest/control.py\n    [115 tests, 3.6 s]\n```\n\nBut also the formatting of the above failure looks strange:\n\n1) Why does\n\n```\nsage -t devel/sage/sage/ext/gmp.pxi\n    [0 tests, 0.0 s]\n```\nappear in the middle of the failure?\n\n2) Could you format the output as\n\n```\nsage -t devel/sage/sage/doctest/control.py\n**********************************************************************\n[...failure...]\n**********************************************************************\n1 items had failures:\n   1 of  15 in sage.doctest.control.DocTestController.add_files\n***Test Failed*** 1 failures.\n    [115 tests, 3.6 s]\n```\n\nI would even shorten the last two lines to\n\n```\n    [115 tests, 1 failed, 3.6 s]\n```\n\nAnd I would add a function like\n\n```\ndef count_noun(number, noun):\n    if number == 1:\n        return \"1 %s\"%noun\n    else:\n        return \"%d %ss\"%(number,noun)\n```\nSo you can do\n\n```\nprint count_noun(n, 'item'), \"had failures\"\n```",
    "created_at": "2012-07-13T08:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135889",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:105" align="right">comment:105</div>

Just one failure remaining related to this ticket:

```
**********************************************************************
File "devel/sage/sage/doctest/control.py", line 258, in sage.doctest.control.DocTestController.add_files
Failed example:
    DC = DocTestController(DD, [])
Expected nothing
Got:
    Unable to open logfile at /release/merger/sage-5.1-12415/home/.sage//tmp/test.log
    Proceeding without logging.
sage -t devel/sage/sage/ext/gmp.pxi
    [0 tests, 0.0 s]
**********************************************************************
1 items had failures:
   1 of  15 in sage.doctest.control.DocTestController.add_files
***Test Failed*** 1 failures.
sage -t devel/sage/sage/doctest/control.py
    [115 tests, 3.6 s]
```

But also the formatting of the above failure looks strange:

1) Why does

```
sage -t devel/sage/sage/ext/gmp.pxi
    [0 tests, 0.0 s]
```
appear in the middle of the failure?

2) Could you format the output as

```
sage -t devel/sage/sage/doctest/control.py
**********************************************************************
[...failure...]
**********************************************************************
1 items had failures:
   1 of  15 in sage.doctest.control.DocTestController.add_files
***Test Failed*** 1 failures.
    [115 tests, 3.6 s]
```

I would even shorten the last two lines to

```
    [115 tests, 1 failed, 3.6 s]
```

And I would add a function like

```
def count_noun(number, noun):
    if number == 1:
        return "1 %s"%noun
    else:
        return "%d %ss"%(number,noun)
```
So you can do

```
print count_noun(n, 'item'), "had failures"
```



---

archive/issue_comments_135890.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nThe `KeyboardInterrupt` example [http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py](http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py) still doesn't work correctly:\n\n```\nRunning doctests with ID 2012-07-13-10-53-02-ed232e22.\nDoctesting 1 file.\nsage -t /home/jdemeyer/doctest/keyboardinterrupt.py\n    Unexpected KeyboardInterrupt raised in file\n********************************************************************************\nTests run before interrupt:\nsage: raise KeyboardInterrupt ## line 2 ##\n\n********************************************************************************\n------------------------------------------------------------------------\nsage -t /home/jdemeyer/doctest/keyboardinterrupt.py # Unhandled KeyboardInterrupt\n------------------------------------------------------------------------\nTotal time for all tests: 1.1 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```\nThe expected result is that the test passes.  I don't mind if you don't fix this (currently, it's also broken), but I thought you should know...",
    "created_at": "2012-07-13T08:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135890",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:106" align="right">comment:106</div>

The `KeyboardInterrupt` example [http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py](http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py) still doesn't work correctly:

```
Running doctests with ID 2012-07-13-10-53-02-ed232e22.
Doctesting 1 file.
sage -t /home/jdemeyer/doctest/keyboardinterrupt.py
    Unexpected KeyboardInterrupt raised in file
********************************************************************************
Tests run before interrupt:
sage: raise KeyboardInterrupt ## line 2 ##

********************************************************************************
------------------------------------------------------------------------
sage -t /home/jdemeyer/doctest/keyboardinterrupt.py # Unhandled KeyboardInterrupt
------------------------------------------------------------------------
Total time for all tests: 1.1 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```
The expected result is that the test passes.  I don't mind if you don't fix this (currently, it's also broken), but I thought you should know...



---

archive/issue_comments_135891.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nConcerning the logfile error: I think you are making the mistaken assumption that `$SAGE_TESTDIR` is an existing directory. But I also find it  strange that a *doctest* writes to a logfile inside `SAGE_TESTDIR`, I don't really like that.",
    "created_at": "2012-07-13T09:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135891",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:107" align="right">comment:107</div>

Concerning the logfile error: I think you are making the mistaken assumption that `$SAGE_TESTDIR` is an existing directory. But I also find it  strange that a *doctest* writes to a logfile inside `SAGE_TESTDIR`, I don't really like that.



---

archive/issue_comments_135892.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nWhen testing `sage/tests/interrupt.pyx` verbosely, I regularly get errors of the form\n\n```\n[...]\nTrying (line 637):    test_try_finally_signal()\nExpecting:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: Aborted\nok [0.23s]\nTrying (line 100631):    sig_on_count()\nExpecting:\n    0\nok [0.00s]\nsage -t --long devel/sage/sage/tests/interrupt.pyx\nTraceback (most recent call last):\n  File \"/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1634, in __call__\n  File \"/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 725, in run\n  File \"/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 556, in _run\nAttributeError: Example instance has no attribute 'options'\n\n------------------------------------------------------------------------\nsage -t --long devel/sage/sage/tests/interrupt.pyx # AttributeError in loading\n------------------------------------------------------------------------\nTotal time for all tests: 12.7 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```\n\nThis looks like a bug in the doctesting framework (unless somehow the interrupt tests corrupt the doctest process?)",
    "created_at": "2012-07-13T14:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135892",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:108" align="right">comment:108</div>

When testing `sage/tests/interrupt.pyx` verbosely, I regularly get errors of the form

```
[...]
Trying (line 637):    test_try_finally_signal()
Expecting:
    Traceback (most recent call last):
    ...
    RuntimeError: Aborted
ok [0.23s]
Trying (line 100631):    sig_on_count()
Expecting:
    0
ok [0.00s]
sage -t --long devel/sage/sage/tests/interrupt.pyx
Traceback (most recent call last):
  File "/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1634, in __call__
  File "/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 725, in run
  File "/release/merger/sage-5.1-12415/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 556, in _run
AttributeError: Example instance has no attribute 'options'

------------------------------------------------------------------------
sage -t --long devel/sage/sage/tests/interrupt.pyx # AttributeError in loading
------------------------------------------------------------------------
Total time for all tests: 12.7 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```

This looks like a bug in the doctesting framework (unless somehow the interrupt tests corrupt the doctest process?)



---

archive/issue_comments_135893.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">comment:109</div>\n\nReplying to [@jdemeyer](#comment%3A106):\n> The `KeyboardInterrupt` example [http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py](http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py) still doesn't work correctly:\n> \n> ```\n> Running doctests with ID 2012-07-13-10-53-02-ed232e22.\n> Doctesting 1 file.\n> sage -t /home/jdemeyer/doctest/keyboardinterrupt.py\n>     Unexpected KeyboardInterrupt raised in file\n> ********************************************************************************\n> Tests run before interrupt:\n> sage: raise KeyboardInterrupt ## line 2 ##\n> \n> ********************************************************************************\n> ------------------------------------------------------------------------\n> sage -t /home/jdemeyer/doctest/keyboardinterrupt.py # Unhandled KeyboardInterrupt\n> ------------------------------------------------------------------------\n> Total time for all tests: 1.1 seconds\n>     cpu time: 0.0 seconds\n>     cumulative wall time: 0.0 seconds\n> ```\n> The expected result is that the test passes.  I don't mind if you don't fix this (currently, it's also broken), but I thought you should know...\n\nThat's because your expected output has an extra colon.  If you delete the trailing colon it passes tests.\n\nWith the extra colon it's an unexpected `KeyboardInterrupt`.",
    "created_at": "2012-07-13T19:14:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135893",
    "user": "https://github.com/roed314"
}
```

<div id="comment:109" align="right">comment:109</div>

Replying to [@jdemeyer](#comment%3A106):
> The `KeyboardInterrupt` example [http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py](http://boxen.math.washington.edu/home/jdemeyer/doctest/keyboardinterrupt.py) still doesn't work correctly:
> 
> ```
> Running doctests with ID 2012-07-13-10-53-02-ed232e22.
> Doctesting 1 file.
> sage -t /home/jdemeyer/doctest/keyboardinterrupt.py
>     Unexpected KeyboardInterrupt raised in file
> ********************************************************************************
> Tests run before interrupt:
> sage: raise KeyboardInterrupt ## line 2 ##
> 
> ********************************************************************************
> ------------------------------------------------------------------------
> sage -t /home/jdemeyer/doctest/keyboardinterrupt.py # Unhandled KeyboardInterrupt
> ------------------------------------------------------------------------
> Total time for all tests: 1.1 seconds
>     cpu time: 0.0 seconds
>     cumulative wall time: 0.0 seconds
> ```
> The expected result is that the test passes.  I don't mind if you don't fix this (currently, it's also broken), but I thought you should know...

That's because your expected output has an extra colon.  If you delete the trailing colon it passes tests.

With the extra colon it's an unexpected `KeyboardInterrupt`.



---

archive/issue_comments_135894.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nReplying to [@jdemeyer](#comment%3A105):\n> Just one failure remaining related to this ticket:\n> \n> ```\n> **********************************************************************\n> File \"devel/sage/sage/doctest/control.py\", line 258, in sage.doctest.control.DocTestController.add_files\n> Failed example:\n>     DC = DocTestController(DD, [])\n> Expected nothing\n> Got:\n>     Unable to open logfile at /release/merger/sage-5.1-12415/home/.sage//tmp/test.log\n>     Proceeding without logging.\n> sage -t devel/sage/sage/ext/gmp.pxi\n>     [0 tests, 0.0 s]\n> **********************************************************************\n> 1 items had failures:\n>    1 of  15 in sage.doctest.control.DocTestController.add_files\n> ***Test Failed*** 1 failures.\n> sage -t devel/sage/sage/doctest/control.py\n>     [115 tests, 3.6 s]\n> ```\n> \n> But also the formatting of the above failure looks strange:\n> \n> 1) Why does\n> \n> ```\n> sage -t devel/sage/sage/ext/gmp.pxi\n>     [0 tests, 0.0 s]\n> ```\n> appear in the middle of the failure?\n> \n> 2) Could you format the output as\n> \n> ```\n> sage -t devel/sage/sage/doctest/control.py\n> **********************************************************************\n> [...failure...]\n> **********************************************************************\n> 1 items had failures:\n>    1 of  15 in sage.doctest.control.DocTestController.add_files\n> ***Test Failed*** 1 failures.\n>     [115 tests, 3.6 s]\n> ```\n> \n> I would even shorten the last two lines to\n> \n> ```\n>     [115 tests, 1 failed, 3.6 s]\n> ```\n> \n> And I would add a function like\n> \n> ```\n> def count_noun(number, noun):\n>     if number == 1:\n>         return \"1 %s\"%noun\n>     else:\n>         return \"%d %ss\"%(number,noun)\n> ```\n> So you can do\n> \n> ```\n> print count_noun(n, 'item'), \"had failures\"\n> ```\n\n\nCool.  I will work on these.\n\nI'm going to be mostly (or entirely) out of communication for the next few days.  Hopefully I'll have some changes available on Monday.",
    "created_at": "2012-07-13T19:18:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135894",
    "user": "https://github.com/roed314"
}
```

<div id="comment:110" align="right">comment:110</div>

Replying to [@jdemeyer](#comment%3A105):
> Just one failure remaining related to this ticket:
> 
> ```
> **********************************************************************
> File "devel/sage/sage/doctest/control.py", line 258, in sage.doctest.control.DocTestController.add_files
> Failed example:
>     DC = DocTestController(DD, [])
> Expected nothing
> Got:
>     Unable to open logfile at /release/merger/sage-5.1-12415/home/.sage//tmp/test.log
>     Proceeding without logging.
> sage -t devel/sage/sage/ext/gmp.pxi
>     [0 tests, 0.0 s]
> **********************************************************************
> 1 items had failures:
>    1 of  15 in sage.doctest.control.DocTestController.add_files
> ***Test Failed*** 1 failures.
> sage -t devel/sage/sage/doctest/control.py
>     [115 tests, 3.6 s]
> ```
> 
> But also the formatting of the above failure looks strange:
> 
> 1) Why does
> 
> ```
> sage -t devel/sage/sage/ext/gmp.pxi
>     [0 tests, 0.0 s]
> ```
> appear in the middle of the failure?
> 
> 2) Could you format the output as
> 
> ```
> sage -t devel/sage/sage/doctest/control.py
> **********************************************************************
> [...failure...]
> **********************************************************************
> 1 items had failures:
>    1 of  15 in sage.doctest.control.DocTestController.add_files
> ***Test Failed*** 1 failures.
>     [115 tests, 3.6 s]
> ```
> 
> I would even shorten the last two lines to
> 
> ```
>     [115 tests, 1 failed, 3.6 s]
> ```
> 
> And I would add a function like
> 
> ```
> def count_noun(number, noun):
>     if number == 1:
>         return "1 %s"%noun
>     else:
>         return "%d %ss"%(number,noun)
> ```
> So you can do
> 
> ```
> print count_noun(n, 'item'), "had failures"
> ```


Cool.  I will work on these.

I'm going to be mostly (or entirely) out of communication for the next few days.  Hopefully I'll have some changes available on Monday.



---

archive/issue_comments_135895.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nFrom a discussion on [sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/-8d0a3AJYoQ/discussion): would it be possible to optionally print extra information after doctesting: how many optional doctests were skipped, and perhaps how they were labeled? (\"skipped 5 doctests marked \"optional -- bug\")",
    "created_at": "2012-07-19T22:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135895",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:111" align="right">comment:111</div>

From a discussion on [sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/-8d0a3AJYoQ/discussion): would it be possible to optionally print extra information after doctesting: how many optional doctests were skipped, and perhaps how they were labeled? ("skipped 5 doctests marked "optional -- bug")



---

archive/issue_comments_135896.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@jhpalmieri](#comment%3A111):\n> From a discussion on [sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/-8d0a3AJYoQ/discussion): would it be possible to optionally print extra information after doctesting: how many optional doctests were skipped, and perhaps how they were labeled? (\"skipped 5 doctests marked \"optional -- bug\")\n\nYeah, that shouldn't be a problem.  But I'd like to put a feature freeze on this ticket and open a new ticket for it: I'm already regretting adding the new debugging feature since I'm struggling with debugging its interaction with `KeyboardInterrupts`.\n\nI just opened #13278 for this.",
    "created_at": "2012-07-19T23:07:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135896",
    "user": "https://github.com/roed314"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@jhpalmieri](#comment%3A111):
> From a discussion on [sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/-8d0a3AJYoQ/discussion): would it be possible to optionally print extra information after doctesting: how many optional doctests were skipped, and perhaps how they were labeled? ("skipped 5 doctests marked "optional -- bug")

Yeah, that shouldn't be a problem.  But I'd like to put a feature freeze on this ticket and open a new ticket for it: I'm already regretting adding the new debugging feature since I'm struggling with debugging its interaction with `KeyboardInterrupts`.

I just opened #13278 for this.



---

archive/issue_comments_135897.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nPing - should this still be needs_work?",
    "created_at": "2012-08-31T08:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135897",
    "user": "https://github.com/kini"
}
```

<div id="comment:113" align="right">comment:113</div>

Ping - should this still be needs_work?



---

archive/issue_comments_135898.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nThere's still the `interrupt.pyx` failures which need to be investigated (probably by me since I know most about interrupts).",
    "created_at": "2012-08-31T09:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135898",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:114" align="right">comment:114</div>

There's still the `interrupt.pyx` failures which need to be investigated (probably by me since I know most about interrupts).



---

archive/issue_comments_135899.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nIf you could look at those it would be great.  My computer is currently being repaired, but I can try to take another shot at this next week.",
    "created_at": "2012-09-01T03:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135899",
    "user": "https://github.com/roed314"
}
```

<div id="comment:115" align="right">comment:115</div>

If you could look at those it would be great.  My computer is currently being repaired, but I can try to take another shot at this next week.



---

archive/issue_comments_135900.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">comment:116</div>\n\nAlright, I've rebased this against 5.4.rc1 and made the suggested changes in #13147.  There's still an intermittent failure in sage.tests.interrupt and I'm at a loss for what's causing it.  Help would be appreciated.",
    "created_at": "2012-10-17T05:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135900",
    "user": "https://github.com/roed314"
}
```

<div id="comment:116" align="right">comment:116</div>

Alright, I've rebased this against 5.4.rc1 and made the suggested changes in #13147.  There's still an intermittent failure in sage.tests.interrupt and I'm at a loss for what's causing it.  Help would be appreciated.



---

archive/issue_comments_135901.json:
```json
{
    "body": "<div id=\"comment:117\" align=\"right\">comment:117</div>\n\nI've put the output before segfault from a case where interrupt.pyx failed at http://pastebin.com/Yvs8Ev68 (expiring in 1 month).",
    "created_at": "2012-10-17T05:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135901",
    "user": "https://github.com/roed314"
}
```

<div id="comment:117" align="right">comment:117</div>

I've put the output before segfault from a case where interrupt.pyx failed at http://pastebin.com/Yvs8Ev68 (expiring in 1 month).



---

archive/issue_comments_135902.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">comment:118</div>\n\nI've moved the debug functionality that triggers on an incorrect result to #13610 since I was struggling to get the interrupt handling working correctly (IPython embedded shells intercept `KeyboardInterrupts`).  With this change the only work issue I'm aware of on this ticket is the intermittent failure in interrupt.pyx.  Testing just interrupt.pyx doesn't trigger this failure (or at least does so rarely); run `sage -t sage/tests/parigp.py sage/tests/interrupt.pyx` for example.",
    "created_at": "2012-10-17T05:44:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135902",
    "user": "https://github.com/roed314"
}
```

<div id="comment:118" align="right">comment:118</div>

I've moved the debug functionality that triggers on an incorrect result to #13610 since I was struggling to get the interrupt handling working correctly (IPython embedded shells intercept `KeyboardInterrupts`).  With this change the only work issue I'm aware of on this ticket is the intermittent failure in interrupt.pyx.  Testing just interrupt.pyx doesn't trigger this failure (or at least does so rarely); run `sage -t sage/tests/parigp.py sage/tests/interrupt.pyx` for example.



---

archive/issue_comments_135903.json:
```json
{
    "body": "Work Issues: **intermittent interrupt.pyx failure**",
    "created_at": "2012-10-17T05:44:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135903",
    "user": "https://github.com/roed314"
}
```

Work Issues: **intermittent interrupt.pyx failure**



---

archive/issue_comments_135904.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nOk, I found another issue which I'm not going to fix tonight.  The code that parses a file and generates the tests has a bug somewhere that means some files with tests are not getting tested.  I need to track down the bug and add some doctests to make sure this kind of thing doesn't happen again.",
    "created_at": "2012-10-17T08:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135904",
    "user": "https://github.com/roed314"
}
```

<div id="comment:119" align="right">comment:119</div>

Ok, I found another issue which I'm not going to fix tonight.  The code that parses a file and generates the tests has a bug somewhere that means some files with tests are not getting tested.  I need to track down the bug and add some doctests to make sure this kind of thing doesn't happen again.



---

archive/issue_comments_135905.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,10 +12,9 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n-**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors) or wait for #13121\n+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n``````\n",
    "created_at": "2012-10-24T03:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135905",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,10 +12,9 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
-**Apply** [attachment: 12415_sagenb_fixes_vs_11080.patch](https://github.com/sagemath/sage/files/ticket12415/12415_sagenb_fixes_vs_11080.patch.gz) to the sagenb repo (fixes doctest errors) or wait for #13121
+**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-**Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
``````




---

archive/issue_comments_135906.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121**",
    "created_at": "2012-10-24T03:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135906",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121**



---

archive/issue_comments_135907.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nAlright, I fixed a bunch of bugs in the parsing of files.  I added two new patches since the old ones were getting big.  Sorry for the huge size of this ticket: some of the changes in [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz) can be split off into new tickets, but many of them need to be made along with the switch to the new testing code.",
    "created_at": "2012-10-24T03:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135907",
    "user": "https://github.com/roed314"
}
```

<div id="comment:120" align="right">comment:120</div>

Alright, I fixed a bunch of bugs in the parsing of files.  I added two new patches since the old ones were getting big.  Sorry for the huge size of this ticket: some of the changes in [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz) can be split off into new tickets, but many of them need to be made along with the switch to the new testing code.



---

archive/issue_comments_135908.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nHere's my current status on the `interrupt.pyx` problem.\n\n* It occurs only if `interrupt.pyx` is not the first file being tested (so `sage -t rings/big_oh.py tests/interrupt.pyx` will show it for example)\n* The segfault is actually caused by the test at line 694 of `interrupt.pyx`: `sage: test_sig_block()`\n \nI tried looking into the signal handling code but got lost.  Any ideas?",
    "created_at": "2012-10-24T04:48:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135908",
    "user": "https://github.com/roed314"
}
```

<div id="comment:121" align="right">comment:121</div>

Here's my current status on the `interrupt.pyx` problem.

* It occurs only if `interrupt.pyx` is not the first file being tested (so `sage -t rings/big_oh.py tests/interrupt.pyx` will show it for example)
* The segfault is actually caused by the test at line 694 of `interrupt.pyx`: `sage: test_sig_block()`
 
I tried looking into the signal handling code but got lost.  Any ideas?



---

archive/issue_comments_135909.json:
```json
{
    "body": "Changed work issues from **intermittent interrupt.pyx failure** to **interrupt.pyx failure**",
    "created_at": "2012-10-24T07:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135909",
    "user": "https://github.com/roed314"
}
```

Changed work issues from **intermittent interrupt.pyx failure** to **interrupt.pyx failure**



---

archive/issue_comments_135910.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nI can have a look at the interrupt code, but not now...",
    "created_at": "2012-10-24T07:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135910",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:123" align="right">comment:123</div>

I can have a look at the interrupt code, but not now...



---

archive/issue_comments_135911.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\nFair enough.  Do you have any idea when you might have a chance?  Or any suggestions for debugging it myself?",
    "created_at": "2012-10-24T07:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135911",
    "user": "https://github.com/roed314"
}
```

<div id="comment:124" align="right">comment:124</div>

Fair enough.  Do you have any idea when you might have a chance?  Or any suggestions for debugging it myself?



---

archive/issue_comments_135912.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes-rebased.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes-rebased.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2012-11-13T19:10:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135912",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes-rebased.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes-rebased.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135913.json:
```json
{
    "body": "<div id=\"comment:126\" align=\"right\">comment:126</div>\n\nI have no idea what's going on, but to follow up on David's comment: on an OS X 10.8 machine, if I run `sage -t rings/big_oh.py tests/interrupt.pyx`, I get an error at line 744. If I make *either* of the following two changes, the error goes away:\n\n```diff\ndiff --git a/sage/tests/interrupt.pyx b/sage/tests/interrupt.pyx\n--- a/sage/tests/interrupt.pyx\n+++ b/sage/tests/interrupt.pyx\n@@ -691,8 +691,6 @@ def test_sig_block(long delay = DEFAULT_\n     TESTS::\n \n         sage: from sage.tests.interrupt import *\n-        sage: test_sig_block()\n-        42\n     \"\"\"\n     cdef volatile_int v = 0\n \n```\nor\n\n```diff\ndiff --git a/sage/tests/interrupt.pyx b/sage/tests/interrupt.pyx\n--- a/sage/tests/interrupt.pyx\n+++ b/sage/tests/interrupt.pyx\n@@ -741,9 +741,6 @@ def test_signal_during_malloc(long delay\n \n     TESTS::\n \n-        sage: from sage.tests.interrupt import *\n-        sage: for i in range(4):  # Several times to reduce chances of false positive\n-        ...       test_signal_during_malloc()\n     \"\"\"\n     signal_after_delay(SIGINT, delay)\n     try:\n```\nFor the second one, I still get the error if I keep line 744,\n\n```\nsage: from sage.tests.interrupt import *\n```\nbut remove the actual doctest. Does this have any significance for anyone?",
    "created_at": "2012-11-13T19:32:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135913",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:126" align="right">comment:126</div>

I have no idea what's going on, but to follow up on David's comment: on an OS X 10.8 machine, if I run `sage -t rings/big_oh.py tests/interrupt.pyx`, I get an error at line 744. If I make *either* of the following two changes, the error goes away:

```diff
diff --git a/sage/tests/interrupt.pyx b/sage/tests/interrupt.pyx
--- a/sage/tests/interrupt.pyx
+++ b/sage/tests/interrupt.pyx
@@ -691,8 +691,6 @@ def test_sig_block(long delay = DEFAULT_
     TESTS::
 
         sage: from sage.tests.interrupt import *
-        sage: test_sig_block()
-        42
     """
     cdef volatile_int v = 0
 
```
or

```diff
diff --git a/sage/tests/interrupt.pyx b/sage/tests/interrupt.pyx
--- a/sage/tests/interrupt.pyx
+++ b/sage/tests/interrupt.pyx
@@ -741,9 +741,6 @@ def test_signal_during_malloc(long delay
 
     TESTS::
 
-        sage: from sage.tests.interrupt import *
-        sage: for i in range(4):  # Several times to reduce chances of false positive
-        ...       test_signal_during_malloc()
     """
     signal_after_delay(SIGINT, delay)
     try:
```
For the second one, I still get the error if I keep line 744,

```
sage: from sage.tests.interrupt import *
```
but remove the actual doctest. Does this have any significance for anyone?



---

archive/issue_comments_135914.json:
```json
{
    "body": "<div id=\"comment:127\" align=\"right\">comment:127</div>\n\nThe problem seems to be caused by \n\n```\nsage: test_sig_block()\n42\n```\n\nbut it only shows up if enough time is taken up by later tests.  So you can delete\n\n```\nsage: from sage.tests.interrupt import *\nsage: for i in range(4):  # Several times to reduce chances of false positive\n...       test_signal_during_malloc()\n```\nand add something else, and you still get the error.",
    "created_at": "2012-11-24T06:26:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135914",
    "user": "https://github.com/roed314"
}
```

<div id="comment:127" align="right">comment:127</div>

The problem seems to be caused by 

```
sage: test_sig_block()
42
```

but it only shows up if enough time is taken up by later tests.  So you can delete

```
sage: from sage.tests.interrupt import *
sage: for i in range(4):  # Several times to reduce chances of false positive
...       test_signal_during_malloc()
```
and add something else, and you still get the error.



---

archive/issue_comments_135915.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">comment:128</div>\n\nBy commenting out most of the tests in that file, I can get the following error message:\n\n```\nFatal Python error: GC object already tracked\n```\nI still get a SIGABRT, but now the bad exit code is -6 rather than -11.",
    "created_at": "2012-11-24T06:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135915",
    "user": "https://github.com/roed314"
}
```

<div id="comment:128" align="right">comment:128</div>

By commenting out most of the tests in that file, I can get the following error message:

```
Fatal Python error: GC object already tracked
```
I still get a SIGABRT, but now the bad exit code is -6 rather than -11.



---

archive/issue_comments_135916.json:
```json
{
    "body": "<div id=\"comment:129\" align=\"right\">comment:129</div>\n\nAlright.  I have a minimal example that doesn't rely on the doctesting framework.  Of course, I still don't know how to resolve the issue, but at least it should be easier to work on.  See #13748.",
    "created_at": "2012-11-24T13:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135916",
    "user": "https://github.com/roed314"
}
```

<div id="comment:129" align="right">comment:129</div>

Alright.  I have a minimal example that doesn't rely on the doctesting framework.  Of course, I still don't know how to resolve the issue, but at least it should be easier to work on.  See #13748.



---

archive/issue_comments_135917.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748**",
    "created_at": "2012-11-24T13:40:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135917",
    "user": "https://github.com/roed314"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748**



---

archive/issue_comments_135918.json:
```json
{
    "body": "<div id=\"comment:131\" align=\"right\">comment:131</div>\n\nIf the issue isn't related to the new doctesting framework, but is a pre-existing condition revealed by it, then it shouldn't be a dependency, but a separate issue. If that was the only issue with this ticket, then this ticket could be merged, right?",
    "created_at": "2012-11-24T16:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135918",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:131" align="right">comment:131</div>

If the issue isn't related to the new doctesting framework, but is a pre-existing condition revealed by it, then it shouldn't be a dependency, but a separate issue. If that was the only issue with this ticket, then this ticket could be merged, right?



---

archive/issue_comments_135919.json:
```json
{
    "body": "<div id=\"comment:132\" align=\"right\">comment:132</div>\n\nReplying to [@jhpalmieri](#comment%3A131):\n> If the issue isn't related to the new doctesting framework, but is a pre-existing condition revealed by it, then it shouldn't be a dependency, but a separate issue. If that was the only issue with this ticket, then this ticket could be merged, right?\n\nI have no problem with that interpretation.  But in some sense it is related to the new doctesting framework since we weren't using Python's multiprocessing module before.\n\nSo, does anyone want to give this ticket a positive review?",
    "created_at": "2012-11-24T23:14:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135919",
    "user": "https://github.com/roed314"
}
```

<div id="comment:132" align="right">comment:132</div>

Replying to [@jhpalmieri](#comment%3A131):
> If the issue isn't related to the new doctesting framework, but is a pre-existing condition revealed by it, then it shouldn't be a dependency, but a separate issue. If that was the only issue with this ticket, then this ticket could be merged, right?

I have no problem with that interpretation.  But in some sense it is related to the new doctesting framework since we weren't using Python's multiprocessing module before.

So, does anyone want to give this ticket a positive review?



---

archive/issue_comments_135920.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes-rebased.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes-rebased.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-01-03T18:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135920",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes-rebased.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes-rebased.patch.gz), [attachment: 12415_more_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_more_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135921.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">comment:134</div>\n\nRebased and merged the two doctest patches.",
    "created_at": "2013-01-03T18:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135921",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:134" align="right">comment:134</div>

Rebased and merged the two doctest patches.



---

archive/issue_comments_135922.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-01-03T19:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135922",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_framework_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework_fixes.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135923.json:
```json
{
    "body": "<div id=\"comment:136\" align=\"right\">comment:136</div>\n\nMerged the two framework patches, removed the change to `sage/tests/interrupt.pyx`",
    "created_at": "2013-01-03T19:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135923",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:136" align="right">comment:136</div>

Merged the two framework patches, removed the change to `sage/tests/interrupt.pyx`



---

archive/issue_comments_135924.json:
```json
{
    "body": "<div id=\"comment:137\" align=\"right\">comment:137</div>\n\nI still don't like the `DocTestWorker.annihilate()` method which parses `ps` output to figure out which processes to kill.",
    "created_at": "2013-01-03T19:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135924",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:137" align="right">comment:137</div>

I still don't like the `DocTestWorker.annihilate()` method which parses `ps` output to figure out which processes to kill.



---

archive/issue_comments_135925.json:
```json
{
    "body": "<div id=\"comment:138\" align=\"right\">comment:138</div>\n\nRobert wrote that code.  :-)  I think the issue is that some doctests may spawn new processes that can survive their death.  Do you have an alternate approach to suggest?\n\nI'm very happy that you found the problem in #13748; I will try to take a look at this while I'm at the Joint meetings next week.  In general I have very little time this month....",
    "created_at": "2013-01-04T07:02:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135925",
    "user": "https://github.com/roed314"
}
```

<div id="comment:138" align="right">comment:138</div>

Robert wrote that code.  :-)  I think the issue is that some doctests may spawn new processes that can survive their death.  Do you have an alternate approach to suggest?

I'm very happy that you found the problem in #13748; I will try to take a look at this while I'm at the Joint meetings next week.  In general I have very little time this month....



---

archive/issue_comments_135926.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748, #13899**",
    "created_at": "2013-01-04T07:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135926",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748, #13899**



---

archive/issue_comments_135927.json:
```json
{
    "body": "Changed work issues from **interrupt.pyx failure** to none",
    "created_at": "2013-01-04T07:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135927",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **interrupt.pyx failure** to none



---

archive/issue_comments_135928.json:
```json
{
    "body": "<div id=\"comment:140\" align=\"right\">comment:140</div>\n\nThere are various new doctest errors, all of them look easy to fix. But also two errors in the doctest framework itself:\n\n```\nsage -t --long devel/sage/sage/doctest/sources.py\n**********************************************************************\nFile \"devel/sage/sage/doctest/sources.py\", line 177, in sage.doctest.sources.DocTestSource._process_doc\nFailed example:\n    doctests == manual_doctests\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"devel/sage/sage/doctest/sources.py\", line 655, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk(sage_loc), os.walk(doc_loc)): # long time\n        path = os.path.relpath(path)\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.sage', '.spyx', '.rst', '.tex'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, True, True, True, False)\n                FDS._test_enough_doctests(verbose=False)\nExpected:\n    There are 3 unexpected tests being run in .../sage/doctest/parsing.py\n    There are 1 tests in .../sage/ext/c_lib.pyx that are not being run\n    There are 2 tests in .../sage/server/notebook/worksheet.py that are not being run\n    There are 5 tests in .../doc/en/tutorial/interfaces.rst that are not being run\nGot:\n    There are 2 tests in devel/sage/sage/server/notebook/worksheet.py that are not being run\n    There are 2 unexpected tests being run in devel/sage/sage/misc/cython.py\n    There are 1 tests in devel/sage/sage/ext/c_lib.pyx that are not being run\n    There are 3 unexpected tests being run in devel/sage/sage/doctest/parsing.py\n    There are 5 tests in devel/sage/doc/en/tutorial/interfaces.rst that are not being run\n    There are 1130 tests in devel/sage/doc/output/latex/en/reference/reference.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/en/tutorial/SageTutorial.tex that are not being run\n    There are 4 tests in devel/sage/doc/output/latex/en/thematic_tutorials/thematic_tutorials.tex that are not being run\n    There are 6 tests in devel/sage/doc/output/latex/en/prep/prep_tutorials.tex that are not being run\n    There are 2 tests in devel/sage/doc/output/latex/en/numerical_sage/numerical_sage.tex that are not being run\n    There are 15 tests in devel/sage/doc/output/latex/en/developer/developer.tex that are not being run\n    There are 16 tests in devel/sage/doc/output/latex/en/constructions/constructions.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/ru/tutorial/SageTutorial_ru.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/fr/tutorial/tutorial-fr.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/de/tutorial/SageTutorial-de.tex that are not being run\n**********************************************************************\n```\n\nAlso, the directory `devel/sagenb/sagenb/data` should probably not be tested, as there are failures because of TAB characters in the MathJax rst documentation.",
    "created_at": "2013-01-04T07:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135928",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:140" align="right">comment:140</div>

There are various new doctest errors, all of them look easy to fix. But also two errors in the doctest framework itself:

```
sage -t --long devel/sage/sage/doctest/sources.py
**********************************************************************
File "devel/sage/sage/doctest/sources.py", line 177, in sage.doctest.sources.DocTestSource._process_doc
Failed example:
    doctests == manual_doctests
Expected:
    True
Got:
    False
**********************************************************************
File "devel/sage/sage/doctest/sources.py", line 655, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk(sage_loc), os.walk(doc_loc)): # long time
        path = os.path.relpath(path)
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.sage', '.spyx', '.rst', '.tex'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, True, True, True, False)
                FDS._test_enough_doctests(verbose=False)
Expected:
    There are 3 unexpected tests being run in .../sage/doctest/parsing.py
    There are 1 tests in .../sage/ext/c_lib.pyx that are not being run
    There are 2 tests in .../sage/server/notebook/worksheet.py that are not being run
    There are 5 tests in .../doc/en/tutorial/interfaces.rst that are not being run
Got:
    There are 2 tests in devel/sage/sage/server/notebook/worksheet.py that are not being run
    There are 2 unexpected tests being run in devel/sage/sage/misc/cython.py
    There are 1 tests in devel/sage/sage/ext/c_lib.pyx that are not being run
    There are 3 unexpected tests being run in devel/sage/sage/doctest/parsing.py
    There are 5 tests in devel/sage/doc/en/tutorial/interfaces.rst that are not being run
    There are 1130 tests in devel/sage/doc/output/latex/en/reference/reference.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/en/tutorial/SageTutorial.tex that are not being run
    There are 4 tests in devel/sage/doc/output/latex/en/thematic_tutorials/thematic_tutorials.tex that are not being run
    There are 6 tests in devel/sage/doc/output/latex/en/prep/prep_tutorials.tex that are not being run
    There are 2 tests in devel/sage/doc/output/latex/en/numerical_sage/numerical_sage.tex that are not being run
    There are 15 tests in devel/sage/doc/output/latex/en/developer/developer.tex that are not being run
    There are 16 tests in devel/sage/doc/output/latex/en/constructions/constructions.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/ru/tutorial/SageTutorial_ru.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/fr/tutorial/tutorial-fr.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/de/tutorial/SageTutorial-de.tex that are not being run
**********************************************************************
```

Also, the directory `devel/sagenb/sagenb/data` should probably not be tested, as there are failures because of TAB characters in the MathJax rst documentation.



---

archive/issue_comments_135929.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748, #13899** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899**",
    "created_at": "2013-01-04T07:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135929",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121,#13748, #13899** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899**



---

archive/issue_comments_135930.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">comment:142</div>\n\nDo you guys consider it a feature or a bug that\n\n```\n\"\"\"\nsage: 1e16     # relative tol 1e-10\n10^16\n\"\"\"\n```\ndoesn't work? See #12815.",
    "created_at": "2013-01-04T07:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135930",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:142" align="right">comment:142</div>

Do you guys consider it a feature or a bug that

```
"""
sage: 1e16     # relative tol 1e-10
10^16
"""
```
doesn't work? See #12815.



---

archive/issue_comments_135931.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nWhat I'm missing in this patchbomb is a high-level overview of how everything works. To me, it looks like a large lump of code (which seems to work pretty well) which is hard to understand.",
    "created_at": "2013-01-04T09:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135931",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:143" align="right">comment:143</div>

What I'm missing in this patchbomb is a high-level overview of how everything works. To me, it looks like a large lump of code (which seems to work pretty well) which is hard to understand.



---

archive/issue_comments_135932.json:
```json
{
    "body": "<div id=\"comment:144\" align=\"right\">comment:144</div>\n\nTypo:\n\n```\nComparison ist just comparison of the underlying lists.\n```",
    "created_at": "2013-01-04T09:50:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135932",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:144" align="right">comment:144</div>

Typo:

```
Comparison ist just comparison of the underlying lists.
```



---

archive/issue_comments_135933.json:
```json
{
    "body": "<div id=\"comment:145\" align=\"right\">comment:145</div>\n\nReplying to [@roed314](#comment%3A138):\n> Robert wrote that code.  :-)  I think the issue is that some doctests may spawn new processes that can survive their death.  Do you have an alternate approach to suggest?\n\nThere is some commented-out code mentioning process groups, it would be a good idea to make that work.\n\nBut I'm also a bit lost on how the fork()ing actually works and how many Sage sessions are involved.",
    "created_at": "2013-01-04T09:56:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135933",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:145" align="right">comment:145</div>

Replying to [@roed314](#comment%3A138):
> Robert wrote that code.  :-)  I think the issue is that some doctests may spawn new processes that can survive their death.  Do you have an alternate approach to suggest?

There is some commented-out code mentioning process groups, it would be a good idea to make that work.

But I'm also a bit lost on how the fork()ing actually works and how many Sage sessions are involved.



---

archive/issue_comments_135934.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">comment:146</div>\n\nReplying to [@jdemeyer](#comment%3A143):\n> What I'm missing in this patchbomb is a high-level overview of how everything works. To me, it looks like a large lump of code (which seems to work pretty well) which is hard to understand.\n\nI will add somw top level documentation next week.",
    "created_at": "2013-01-04T20:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135934",
    "user": "https://github.com/roed314"
}
```

<div id="comment:146" align="right">comment:146</div>

Replying to [@jdemeyer](#comment%3A143):
> What I'm missing in this patchbomb is a high-level overview of how everything works. To me, it looks like a large lump of code (which seems to work pretty well) which is hard to understand.

I will add somw top level documentation next week.



---

archive/issue_comments_135935.json:
```json
{
    "body": "<div id=\"comment:147\" align=\"right\">comment:147</div>\n\n#13908 might also help with proper killing.",
    "created_at": "2013-01-04T20:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135935",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:147" align="right">comment:147</div>

#13908 might also help with proper killing.



---

archive/issue_comments_135936.json:
```json
{
    "body": "<div id=\"comment:148\" align=\"right\">comment:148</div>\n\nReplying to [@jdemeyer](#comment%3A142):\n> Do you guys consider it a feature or a bug that\n> \n> ```\n> \"\"\"\n> sage: 1e16     # relative tol 1e-10\n> 10^16\n> \"\"\"\n> ```\n> doesn't work? See #12815.\n\nFeature. See new comment on that ticket.",
    "created_at": "2013-01-05T05:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135936",
    "user": "https://github.com/robertwb"
}
```

<div id="comment:148" align="right">comment:148</div>

Replying to [@jdemeyer](#comment%3A142):
> Do you guys consider it a feature or a bug that
> 
> ```
> """
> sage: 1e16     # relative tol 1e-10
> 10^16
> """
> ```
> doesn't work? See #12815.

Feature. See new comment on that ticket.



---

archive/issue_comments_135937.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">comment:149</div>\n\nLooks like I have to depend on this for the numpy-1.7 upgrade at #11334, so I am tagging along :)",
    "created_at": "2013-01-14T21:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135937",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:149" align="right">comment:149</div>

Looks like I have to depend on this for the numpy-1.7 upgrade at #11334, so I am tagging along :)



---

archive/issue_comments_135938.json:
```json
{
    "body": "<div id=\"comment:150\" align=\"right\">comment:150</div>\n\nIt is interesting. With each new version of numpy we seem to have new instances of \n\n```\nWarning: divide by zero encountered in divide\n```\nappearing in doctests. This suggest that numpy sometimes mixes stderr and stdout or that they are very intent to tell you about these warnings. All the instances of this warning that are fixed in [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz) also appears with the upgrade to numpy 1.7.0 - plus some more.",
    "created_at": "2013-01-15T09:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135938",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:150" align="right">comment:150</div>

It is interesting. With each new version of numpy we seem to have new instances of 

```
Warning: divide by zero encountered in divide
```
appearing in doctests. This suggest that numpy sometimes mixes stderr and stdout or that they are very intent to tell you about these warnings. All the instances of this warning that are fixed in [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz) also appears with the upgrade to numpy 1.7.0 - plus some more.



---

archive/issue_comments_135939.json:
```json
{
    "body": "<div id=\"comment:151\" align=\"right\">comment:151</div>\n\nCombined [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz) and [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz) and rebased.\n\n[attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) needs to be rebased but `displayhook.py` changed substantially in #12719, so I don't know what to do.",
    "created_at": "2013-01-29T13:22:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135939",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:151" align="right">comment:151</div>

Combined [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz) and [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz) and rebased.

[attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) needs to be rebased but `displayhook.py` changed substantially in #12719, so I don't know what to do.



---

archive/issue_comments_135940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-01-29T13:22:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135940",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_stderr_vs_51b5.patch](https://github.com/sagemath/sage/files/ticket12415/12415_stderr_vs_51b5.patch.gz), [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135941.json:
```json
{
    "body": "Attachment: **[12415_spkg_bin_sage.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz)**\n\nApply to root repository",
    "created_at": "2013-01-29T13:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135941",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_spkg_bin_sage.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz)**

Apply to root repository



---

archive/issue_comments_135942.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155**",
    "created_at": "2013-01-29T13:32:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135942",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155**



---

archive/issue_comments_135943.json:
```json
{
    "body": "Patch to script repo; now removes old files",
    "created_at": "2013-01-29T13:33:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135943",
    "user": "https://github.com/jdemeyer"
}
```

Patch to script repo; now removes old files



---

archive/issue_comments_135944.json:
```json
{
    "body": "<div id=\"comment:153\" align=\"right\">comment:153</div>\n\nAttachment: **[12415_script.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz)**\n\nIs this because of the displayhook?\n\n```\nFile \"devel/sage/sage/combinat/cluster_algebra_quiver/quiver.py\", line 996, in sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver.mutation_sequence\nFailed example:\n    [T.b_matrix() for T in seq]\nExpected:\n    [\n    [ 0  1  0  0]  [ 0 -1  0  0]  [ 0  1 -1  0]\n    [-1  0 -1  0]  [ 1  0 -1  0]  [-1  0  1  0]\n    [ 0  1  0  1]  [ 0  1  0  1]  [ 1 -1  0  1]\n    [ 0  0 -1  0], [ 0  0 -1  0], [ 0  0 -1  0]\n    ]\nGot:\n    [[ 0  1  0  0]\n    [-1  0 -1  0]\n    [ 0  1  0  1]\n    [ 0  0 -1  0], [ 0 -1  0  0]\n    [ 1  0 -1  0]\n    [ 0  1  0  1]\n    [ 0  0 -1  0], [ 0  1 -1  0]\n    [-1  0  1  0]\n    [ 1 -1  0  1]\n    [ 0  0 -1  0]]\n```",
    "created_at": "2013-01-29T14:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135944",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:153" align="right">comment:153</div>

Attachment: **[12415_script.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz)**

Is this because of the displayhook?

```
File "devel/sage/sage/combinat/cluster_algebra_quiver/quiver.py", line 996, in sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver.mutation_sequence
Failed example:
    [T.b_matrix() for T in seq]
Expected:
    [
    [ 0  1  0  0]  [ 0 -1  0  0]  [ 0  1 -1  0]
    [-1  0 -1  0]  [ 1  0 -1  0]  [-1  0  1  0]
    [ 0  1  0  1]  [ 0  1  0  1]  [ 1 -1  0  1]
    [ 0  0 -1  0], [ 0  0 -1  0], [ 0  0 -1  0]
    ]
Got:
    [[ 0  1  0  0]
    [-1  0 -1  0]
    [ 0  1  0  1]
    [ 0  0 -1  0], [ 0 -1  0  0]
    [ 1  0 -1  0]
    [ 0  1  0  1]
    [ 0  0 -1  0], [ 0  1 -1  0]
    [-1  0  1  0]
    [ 1 -1  0  1]
    [ 0  0 -1  0]]
```



---

archive/issue_comments_135945.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">comment:154</div>\n\nReplying to [@jdemeyer](#comment%3A153):\n> Is this because of the displayhook?\n> \n> ```\n> File \"devel/sage/sage/combinat/cluster_algebra_quiver/quiver.py\", line 996, in sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver.mutation_sequence\n> Failed example:\n>     [T.b_matrix() for T in seq]\n> Expected:\n>     [\n>     [ 0  1  0  0]  [ 0 -1  0  0]  [ 0  1 -1  0]\n>     [-1  0 -1  0]  [ 1  0 -1  0]  [-1  0  1  0]\n>     [ 0  1  0  1]  [ 0  1  0  1]  [ 1 -1  0  1]\n>     [ 0  0 -1  0], [ 0  0 -1  0], [ 0  0 -1  0]\n>     ]\n> Got:\n>     [[ 0  1  0  0]\n>     [-1  0 -1  0]\n>     [ 0  1  0  1]\n>     [ 0  0 -1  0], [ 0 -1  0  0]\n>     [ 1  0 -1  0]\n>     [ 0  1  0  1]\n>     [ 0  0 -1  0], [ 0  1 -1  0]\n>     [-1  0  1  0]\n>     [ 1 -1  0  1]\n>     [ 0  0 -1  0]]\n> ```\n\nYeah, that's the kind of error that would occur because of displayhook.  I'll take a look.",
    "created_at": "2013-01-29T15:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135945",
    "user": "https://github.com/roed314"
}
```

<div id="comment:154" align="right">comment:154</div>

Replying to [@jdemeyer](#comment%3A153):
> Is this because of the displayhook?
> 
> ```
> File "devel/sage/sage/combinat/cluster_algebra_quiver/quiver.py", line 996, in sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver.mutation_sequence
> Failed example:
>     [T.b_matrix() for T in seq]
> Expected:
>     [
>     [ 0  1  0  0]  [ 0 -1  0  0]  [ 0  1 -1  0]
>     [-1  0 -1  0]  [ 1  0 -1  0]  [-1  0  1  0]
>     [ 0  1  0  1]  [ 0  1  0  1]  [ 1 -1  0  1]
>     [ 0  0 -1  0], [ 0  0 -1  0], [ 0  0 -1  0]
>     ]
> Got:
>     [[ 0  1  0  0]
>     [-1  0 -1  0]
>     [ 0  1  0  1]
>     [ 0  0 -1  0], [ 0 -1  0  0]
>     [ 1  0 -1  0]
>     [ 0  1  0  1]
>     [ 0  0 -1  0], [ 0  1 -1  0]
>     [-1  0  1  0]
>     [ 1 -1  0  1]
>     [ 0  0 -1  0]]
> ```

Yeah, that's the kind of error that would occur because of displayhook.  I'll take a look.



---

archive/issue_comments_135946.json:
```json
{
    "body": "<div id=\"comment:155\" align=\"right\">comment:155</div>\n\nAll other files (except [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)) have been rebased to sage-5.7.beta1.",
    "created_at": "2013-01-29T15:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135946",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:155" align="right">comment:155</div>

All other files (except [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)) have been rebased to sage-5.7.beta1.



---

archive/issue_comments_135947.json:
```json
{
    "body": "<div id=\"comment:156\" align=\"right\">comment:156</div>\n\nGreat.  I'm building a copy of sage-5.7.beta1 now and will try to rebase [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) to it later today.",
    "created_at": "2013-01-29T16:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135947",
    "user": "https://github.com/roed314"
}
```

<div id="comment:156" align="right">comment:156</div>

Great.  I'm building a copy of sage-5.7.beta1 now and will try to rebase [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) to it later today.



---

archive/issue_comments_135948.json:
```json
{
    "body": "<div id=\"comment:157\" align=\"right\">comment:157</div>\n\nReplying to [@roed314](#comment%3A156):\n> Great.  I'm building a copy of sage-5.7.beta1 now and will try to rebase [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) to it later today.\n\nThat would be great!\n\nI would really like to finish this ticket.  I feel that we're almost there, the main thing I would like to change is the handling of subprocesses (including but not limited to killing).",
    "created_at": "2013-01-30T16:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135948",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:157" align="right">comment:157</div>

Replying to [@roed314](#comment%3A156):
> Great.  I'm building a copy of sage-5.7.beta1 now and will try to rebase [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz) to it later today.

That would be great!

I would really like to finish this ticket.  I feel that we're almost there, the main thing I would like to change is the handling of subprocesses (including but not limited to killing).



---

archive/issue_comments_135949.json:
```json
{
    "body": "The new doctesting code",
    "created_at": "2013-01-31T05:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135949",
    "user": "https://github.com/roed314"
}
```

The new doctesting code



---

archive/issue_comments_135950.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">comment:158</div>\n\nAttachment: **[12415_framework.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)**\n\nI think I've fixed the display hook problem.  I just ran make ptestlong and found some errors; I'm looking into them and will report back.\n\nI'm working on some general documentation, but some help on the `annihilate` method would be useful, since I know nothing about process control groups.",
    "created_at": "2013-01-31T05:42:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135950",
    "user": "https://github.com/roed314"
}
```

<div id="comment:158" align="right">comment:158</div>

Attachment: **[12415_framework.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz)**

I think I've fixed the display hook problem.  I just ran make ptestlong and found some errors; I'm looking into them and will report back.

I'm working on some general documentation, but some help on the `annihilate` method would be useful, since I know nothing about process control groups.



---

archive/issue_comments_135951.json:
```json
{
    "body": "<div id=\"comment:159\" align=\"right\">comment:159</div>\n\nThere are still doctest failures in the doctest framework, see comment [comment:140].",
    "created_at": "2013-02-06T12:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135951",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:159" align="right">comment:159</div>

There are still doctest failures in the doctest framework, see comment [comment:140].



---

archive/issue_comments_135952.json:
```json
{
    "body": "<div id=\"comment:160\" align=\"right\">comment:160</div>\n\nMore doctest framework doctest failures:\n\n```\nsage -t --long devel/sage/sage/doctest/control.py\n**********************************************************************\nFile \"devel/sage/sage/doctest/control.py\", line 566, in sage.doctest.control.DocTestController.cleanup\nFailed example:\n    DC.run()\nException raised:\n    Traceback (most recent call last):\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 595, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 980, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.control.DocTestController.cleanup[8]>\", line 1, in <module>\n        DC.run()\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 725, in run\n        self.test_safe_directory()\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 270, in test_safe_directory\n        .format(os.getcwd()))\n    RuntimeError: refusing to run doctests from the current directory '/home/jdemeyer/.sage/temp/sage.math.washington.edu/10273/dir_2B_1k4/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from\n**********************************************************************\n```\n\nThen there is a bunch of\n\n```\n/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparis\non failed to convert both arguments to Unicode - interpreting them as being unequal\n  if code[q-1] == u'\\\\':\n```\nin between the tests, for example:\n\n```\nsage -t --long devel/sage/sage/combinat/species/empty_species.py\n    [38 tests, 0.1 s]\nsage -t --long devel/sage/sage/combinat/sf/kfpoly.py\n    [60 tests, 0.1 s]\nsage -t --long devel/sage/sage/combinat/words/shuffle_product.py\n    [63 tests, 0.1 s]\n/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparis\non failed to convert both arguments to Unicode - interpreting them as being unequal\n  if code[q-1] == u'\\\\':\nsage -t --long devel/sage/sage/categories/algebra_modules.py\n    [9 tests, 0.1 s]\nsage -t --long devel/sage/sage/numerical/backends/ppl_backend.pyx\n    [167 tests, 0.1 s]\nsage -t --long devel/sagenb-main/sagenb/misc/misc.py\n    [36 tests, 0.0 s]\n```",
    "created_at": "2013-02-06T12:31:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135952",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:160" align="right">comment:160</div>

More doctest framework doctest failures:

```
sage -t --long devel/sage/sage/doctest/control.py
**********************************************************************
File "devel/sage/sage/doctest/control.py", line 566, in sage.doctest.control.DocTestController.cleanup
Failed example:
    DC.run()
Exception raised:
    Traceback (most recent call last):
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 595, in _run
        self.execute(example, compiled, test.globs)
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 980, in execute
        exec compiled in globs
      File "<doctest sage.doctest.control.DocTestController.cleanup[8]>", line 1, in <module>
        DC.run()
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py", line 725, in run
        self.test_safe_directory()
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/control.py", line 270, in test_safe_directory
        .format(os.getcwd()))
    RuntimeError: refusing to run doctests from the current directory '/home/jdemeyer/.sage/temp/sage.math.washington.edu/10273/dir_2B_1k4/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from
**********************************************************************
```

Then there is a bunch of

```
/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparis
on failed to convert both arguments to Unicode - interpreting them as being unequal
  if code[q-1] == u'\\':
```
in between the tests, for example:

```
sage -t --long devel/sage/sage/combinat/species/empty_species.py
    [38 tests, 0.1 s]
sage -t --long devel/sage/sage/combinat/sf/kfpoly.py
    [60 tests, 0.1 s]
sage -t --long devel/sage/sage/combinat/words/shuffle_product.py
    [63 tests, 0.1 s]
/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparis
on failed to convert both arguments to Unicode - interpreting them as being unequal
  if code[q-1] == u'\\':
sage -t --long devel/sage/sage/categories/algebra_modules.py
    [9 tests, 0.1 s]
sage -t --long devel/sage/sage/numerical/backends/ppl_backend.pyx
    [167 tests, 0.1 s]
sage -t --long devel/sagenb-main/sagenb/misc/misc.py
    [36 tests, 0.0 s]
```



---

archive/issue_comments_135953.json:
```json
{
    "body": "<div id=\"comment:161\" align=\"right\">comment:161</div>\n\nQuick question: how many `DocTestWorker` instances are created?  Just one?  Or N if we set `MAKE=make -jN`?",
    "created_at": "2013-02-06T13:37:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135953",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:161" align="right">comment:161</div>

Quick question: how many `DocTestWorker` instances are created?  Just one?  Or N if we set `MAKE=make -jN`?



---

archive/issue_comments_135954.json:
```json
{
    "body": "<div id=\"comment:162\" align=\"right\">comment:162</div>\n\nThere is a lot of\n\n```\nif output_semaphore is not None:\n    output_semaphore.acquire()\n```\nin the code which could be simplified assuming that `output_semaphore` is never `None`. Could we ensure that?\n\nIn fact, the whole block\n\n```\ntry:\n    if output_semaphore is not None:\n        output_semaphore.acquire()\n    do_something()\nfinally:\n    if output_semaphore is not None:\n        output_semaphore.release()\n```\ncould be simplified to\n\n```\nwith output_semaphore:\n    do_something()\n```",
    "created_at": "2013-02-06T14:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135954",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:162" align="right">comment:162</div>

There is a lot of

```
if output_semaphore is not None:
    output_semaphore.acquire()
```
in the code which could be simplified assuming that `output_semaphore` is never `None`. Could we ensure that?

In fact, the whole block

```
try:
    if output_semaphore is not None:
        output_semaphore.acquire()
    do_something()
finally:
    if output_semaphore is not None:
        output_semaphore.release()
```
could be simplified to

```
with output_semaphore:
    do_something()
```



---

archive/issue_comments_135955.json:
```json
{
    "body": "<div id=\"comment:163\" align=\"right\">comment:163</div>\n\nReplying to [@roed314](#comment%3A81):\n> The main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)\n\nI vote to completely remove the `--serial` option since for me the only effect is that it makes the code more complicated. Consider for example:\n\n```\n        except KeyboardInterrupt:\n            if result_pipe is None:\n                # We're in serial mode\n                raise\n            # Otherwise, we've been started by a worker: we'll return the result in the finally block\n            result = 0, DictAsObject(dict(err='ctlC')), \"\"\n[...]\n        finally:\n            if result_pipe is None:\n                return result\n            else:\n                result_pipe.put(result, False)\n```\n\nIf I want to fix `KeyboardInterrupt`s in doctests, I now have to think about *two* code paths instead of one.",
    "created_at": "2013-02-06T14:18:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135955",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:163" align="right">comment:163</div>

Replying to [@roed314](#comment%3A81):
> The main point of `--serial` is that it allows you to debug problems in the doctesting framework without worrying about multiprocessing.  :-)

I vote to completely remove the `--serial` option since for me the only effect is that it makes the code more complicated. Consider for example:

```
        except KeyboardInterrupt:
            if result_pipe is None:
                # We're in serial mode
                raise
            # Otherwise, we've been started by a worker: we'll return the result in the finally block
            result = 0, DictAsObject(dict(err='ctlC')), ""
[...]
        finally:
            if result_pipe is None:
                return result
            else:
                result_pipe.put(result, False)
```

If I want to fix `KeyboardInterrupt`s in doctests, I now have to think about *two* code paths instead of one.



---

archive/issue_comments_135956.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-02-06T15:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135956",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_135957.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070**",
    "created_at": "2013-02-06T15:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135957",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070**



---

archive/issue_comments_135958.json:
```json
{
    "body": "<div id=\"comment:166\" align=\"right\">comment:166</div>\n\nAny clue where this failure comes from?\n\n```\nsage -t --long devel/sagenb-main/sagenb/notebook/worksheet.py\n**********************************************************************\nFile \"devel/sagenb-main/sagenb/notebook/worksheet.py\", line 197, in sagenb.notebook.worksheet.Worksheet.?\nFailed example:\n    sagenb.notebook.misc.notebook = nb\nException raised:\n    Traceback (most recent call last):\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 595, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 980, in execute\n        exec compiled in globs\n      File \"<doctest sagenb.notebook.worksheet.Worksheet.?[2]>\", line 1, in <module>\n        sagenb.notebook.misc.notebook = nb\n    AttributeError: 'module' object has no attribute 'misc'\n**********************************************************************\n```",
    "created_at": "2013-02-06T17:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135958",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:166" align="right">comment:166</div>

Any clue where this failure comes from?

```
sage -t --long devel/sagenb-main/sagenb/notebook/worksheet.py
**********************************************************************
File "devel/sagenb-main/sagenb/notebook/worksheet.py", line 197, in sagenb.notebook.worksheet.Worksheet.?
Failed example:
    sagenb.notebook.misc.notebook = nb
Exception raised:
    Traceback (most recent call last):
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 595, in _run
        self.execute(example, compiled, test.globs)
      File "/release/sage-5.7.beta3-doctest/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 980, in execute
        exec compiled in globs
      File "<doctest sagenb.notebook.worksheet.Worksheet.?[2]>", line 1, in <module>
        sagenb.notebook.misc.notebook = nb
    AttributeError: 'module' object has no attribute 'misc'
**********************************************************************
```



---

archive/issue_comments_135959.json:
```json
{
    "body": "<div id=\"comment:167\" align=\"right\">comment:167</div>\n\nAnswering my own question, it seems that N `DocTestWorkers` are started with `make -j N`.\n\nBut I don't understand the design choice of having **two levels** of multiprocessing: one from the master process to the `DocTestWorker` and one from the `DocTestWorker` to the `DocTestTask`.\n\nI surely need to think more about this, but I propose a redesign with only one level of multiprocessing, completely bypassing the `DocTestWorker` class. This would give the benefits of \"serial\" processing while still allowing parallel doctests.",
    "created_at": "2013-02-06T19:33:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135959",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:167" align="right">comment:167</div>

Answering my own question, it seems that N `DocTestWorkers` are started with `make -j N`.

But I don't understand the design choice of having **two levels** of multiprocessing: one from the master process to the `DocTestWorker` and one from the `DocTestWorker` to the `DocTestTask`.

I surely need to think more about this, but I propose a redesign with only one level of multiprocessing, completely bypassing the `DocTestWorker` class. This would give the benefits of "serial" processing while still allowing parallel doctests.



---

archive/issue_comments_135960.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079**",
    "created_at": "2013-02-07T13:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135960",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079**



---

archive/issue_comments_135961.json:
```json
{
    "body": "<div id=\"comment:169\" align=\"right\">comment:169</div>\n\nI would love to cooperate on this ticket, but I'm having a really hard time to understand everything.  As I said before, this absolutely needs some high-level documentation explaining the various classes involved and their inter-relations (in particular, the classes in `forker.py`).",
    "created_at": "2013-02-10T10:26:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135961",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:169" align="right">comment:169</div>

I would love to cooperate on this ticket, but I'm having a really hard time to understand everything.  As I said before, this absolutely needs some high-level documentation explaining the various classes involved and their inter-relations (in particular, the classes in `forker.py`).



---

archive/issue_comments_135962.json:
```json
{
    "body": "<div id=\"comment:170\" align=\"right\">comment:170</div>\n\nReplying to [@jdemeyer](#comment%3A169):\n> I would love to cooperate on this ticket, but I'm having a really hard time to understand everything.  As I said before, this absolutely needs some high-level documentation explaining the various classes involved and their inter-relations (in particular, the classes in `forker.py`).\n\nHi Jeroen,\nSorry for the slow response time: I've had a visitor here in Calgary who's leaving this evening.  I've started writing up overall documentation, and will work on it tonight.\n\nIn answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.  I certainly wouldn't call myself an expert on writing multi-process code.\n\nI'll write more this evening, and also review #14079 and #14080.",
    "created_at": "2013-02-10T18:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135962",
    "user": "https://github.com/roed314"
}
```

<div id="comment:170" align="right">comment:170</div>

Replying to [@jdemeyer](#comment%3A169):
> I would love to cooperate on this ticket, but I'm having a really hard time to understand everything.  As I said before, this absolutely needs some high-level documentation explaining the various classes involved and their inter-relations (in particular, the classes in `forker.py`).

Hi Jeroen,
Sorry for the slow response time: I've had a visitor here in Calgary who's leaving this evening.  I've started writing up overall documentation, and will work on it tonight.

In answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.  I certainly wouldn't call myself an expert on writing multi-process code.

I'll write more this evening, and also review #14079 and #14080.



---

archive/issue_comments_135963.json:
```json
{
    "body": "<div id=\"comment:171\" align=\"right\">comment:171</div>\n\nReplying to [@roed314](#comment%3A170):\n> In answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.\n\nWe obviously need one level of multiprocessing to allow segmentation faults. But my idea would be to skip the first level of multiprocessing and move the code which is currently in `DocTestWorker` to the top-level process. I think that would simplify the code substantially.",
    "created_at": "2013-02-10T22:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135963",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:171" align="right">comment:171</div>

Replying to [@roed314](#comment%3A170):
> In answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.

We obviously need one level of multiprocessing to allow segmentation faults. But my idea would be to skip the first level of multiprocessing and move the code which is currently in `DocTestWorker` to the top-level process. I think that would simplify the code substantially.



---

archive/issue_comments_135964.json:
```json
{
    "body": "<div id=\"comment:172\" align=\"right\">comment:172</div>\n\nReplying to [@jdemeyer](#comment%3A171):\n> Replying to [@roed314](#comment%3A170):\n> > In answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.\n> \n> We obviously need one level of multiprocessing to allow segmentation faults. But my idea would be to skip the first level of multiprocessing and move the code which is currently in `DocTestWorker` to the top-level process. I think that would simplify the code substantially.\n\nHow would you run multiple files in parallel then?",
    "created_at": "2013-02-11T05:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135964",
    "user": "https://github.com/roed314"
}
```

<div id="comment:172" align="right">comment:172</div>

Replying to [@jdemeyer](#comment%3A171):
> Replying to [@roed314](#comment%3A170):
> > In answer to your question about two layers of multiprocessing, the reason is to insulate the controlling process from segfaults and serious failures in the files being tested.  If we come up with a design that satisfies that goal and also allows testing with multiple processes through `sage -t -p N` I'm happy to change things.
> 
> We obviously need one level of multiprocessing to allow segmentation faults. But my idea would be to skip the first level of multiprocessing and move the code which is currently in `DocTestWorker` to the top-level process. I think that would simplify the code substantially.

How would you run multiple files in parallel then?



---

archive/issue_comments_135965.json:
```json
{
    "body": "<div id=\"comment:173\" align=\"right\">comment:173</div>\n\nReplying to [@roed314](#comment%3A172):\n> How would you run multiple files in parallel then?\n\nLike I said. Have one master process doing the jobs of the current master process + the current `DocTestWorker`. That master process would start child processes for every file to be doctested, check for timeouts and crashes of the child processes.\n\nAnd use #14079 to manage everything without busy-waiting.",
    "created_at": "2013-02-11T07:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135965",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:173" align="right">comment:173</div>

Replying to [@roed314](#comment%3A172):
> How would you run multiple files in parallel then?

Like I said. Have one master process doing the jobs of the current master process + the current `DocTestWorker`. That master process would start child processes for every file to be doctested, check for timeouts and crashes of the child processes.

And use #14079 to manage everything without busy-waiting.



---

archive/issue_comments_135966.json:
```json
{
    "body": "<div id=\"comment:174\" align=\"right\">comment:174</div>\n\nOkay.  I have no objections to removing the `-serial` option and changing the process management as you suggest.  It sounds like you have a good idea of how to rewrite it; how can I be useful?  I can certainly review #14080 and #14079 and add overall documentation.  What else would be useful?",
    "created_at": "2013-02-11T08:50:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135966",
    "user": "https://github.com/roed314"
}
```

<div id="comment:174" align="right">comment:174</div>

Okay.  I have no objections to removing the `-serial` option and changing the process management as you suggest.  It sounds like you have a good idea of how to rewrite it; how can I be useful?  I can certainly review #14080 and #14079 and add overall documentation.  What else would be useful?



---

archive/issue_comments_135967.json:
```json
{
    "body": "<div id=\"comment:175\" align=\"right\">comment:175</div>\n\nReplying to [@roed314](#comment%3A174):\n> how can I be useful?\n\nThere are still some doctest failures left. I fixed a few in my reviewer patch (and #14070) but there are some I couldn't immediately fix. There is also the issue with TAB characters in `devel/sagenb/sagenb/data`, ideally that directory would be skipped from doctesting.\n\nBut try not to change `forker.py` too much, as I'm thinking of substantial changes there.",
    "created_at": "2013-02-11T09:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135967",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:175" align="right">comment:175</div>

Replying to [@roed314](#comment%3A174):
> how can I be useful?

There are still some doctest failures left. I fixed a few in my reviewer patch (and #14070) but there are some I couldn't immediately fix. There is also the issue with TAB characters in `devel/sagenb/sagenb/data`, ideally that directory would be skipped from doctesting.

But try not to change `forker.py` too much, as I'm thinking of substantial changes there.



---

archive/issue_comments_135968.json:
```json
{
    "body": "<div id=\"comment:176\" align=\"right\">comment:176</div>\n\nReplying to [@jdemeyer](#comment%3A175):\n> Replying to [@roed314](#comment%3A174):\n> > how can I be useful?\n> \n> There are still some doctest failures left. I fixed a few in my reviewer patch (and #14070) but there are some I couldn't immediately fix. There is also the issue with TAB characters in `devel/sagenb/sagenb/data`, ideally that directory would be skipped from doctesting.\n> \n> But try not to change `forker.py` too much, as I'm thinking of substantial changes there.\n\nSounds good.  I'll work on fixing doctest failures.",
    "created_at": "2013-02-11T09:35:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135968",
    "user": "https://github.com/roed314"
}
```

<div id="comment:176" align="right">comment:176</div>

Replying to [@jdemeyer](#comment%3A175):
> Replying to [@roed314](#comment%3A174):
> > how can I be useful?
> 
> There are still some doctest failures left. I fixed a few in my reviewer patch (and #14070) but there are some I couldn't immediately fix. There is also the issue with TAB characters in `devel/sagenb/sagenb/data`, ideally that directory would be skipped from doctesting.
> 
> But try not to change `forker.py` too much, as I'm thinking of substantial changes there.

Sounds good.  I'll work on fixing doctest failures.



---

archive/issue_comments_135969.json:
```json
{
    "body": "<div id=\"comment:177\" align=\"right\">comment:177</div>\n\nI also don't like this:\n\n```\n        except IOError:\n            # File doesn't exist\n            result = 0, DictAsObject(dict(err='file')), \"\"\n```\n\nYou assume that *any* `IOError` comes from the fact that the doctested file doesn't exist. But it could also be a problem instead with the temporary file used for output (no space on `/tmp` for example). Then the error message \"File not found\" would be very confusing. I think we need to explicitly check the existence of the doctested file and not handle `IOError` specially.",
    "created_at": "2013-02-11T13:22:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135969",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:177" align="right">comment:177</div>

I also don't like this:

```
        except IOError:
            # File doesn't exist
            result = 0, DictAsObject(dict(err='file')), ""
```

You assume that *any* `IOError` comes from the fact that the doctested file doesn't exist. But it could also be a problem instead with the temporary file used for output (no space on `/tmp` for example). Then the error message "File not found" would be very confusing. I think we need to explicitly check the existence of the doctested file and not handle `IOError` specially.



---

archive/issue_comments_135970.json:
```json
{
    "body": "<div id=\"comment:178\" align=\"right\">comment:178</div>\n\nIn \"normal\" mode (non-verbose, non-debug, non-serial), does the `DocTestTask` or `DocTestRunner` ever print something to the real (unspoofed) stdout/stderr?",
    "created_at": "2013-02-11T13:56:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135970",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:178" align="right">comment:178</div>

In "normal" mode (non-verbose, non-debug, non-serial), does the `DocTestTask` or `DocTestRunner` ever print something to the real (unspoofed) stdout/stderr?



---

archive/issue_comments_135971.json:
```json
{
    "body": "<div id=\"comment:179\" align=\"right\">comment:179</div>\n\nReplying to [@jdemeyer](#comment%3A178):\n> In \"normal\" mode (non-verbose, non-debug, non-serial), does the `DocTestTask` or `DocTestRunner` ever print something to the real (unspoofed) stdout/stderr?\n\nI don't think so.",
    "created_at": "2013-02-11T14:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135971",
    "user": "https://github.com/roed314"
}
```

<div id="comment:179" align="right">comment:179</div>

Replying to [@jdemeyer](#comment%3A178):
> In "normal" mode (non-verbose, non-debug, non-serial), does the `DocTestTask` or `DocTestRunner` ever print something to the real (unspoofed) stdout/stderr?

I don't think so.



---

archive/issue_comments_135972.json:
```json
{
    "body": "<div id=\"comment:180\" align=\"right\">comment:180</div>\n\nReplying to [@jdemeyer](#comment%3A177):\n> I also don't like this:\n> \n> ```\n>         except IOError:\n>             # File doesn't exist\n>             result = 0, DictAsObject(dict(err='file')), \"\"\n> ```\n> \n> You assume that *any* `IOError` comes from the fact that the doctested file doesn't exist. But it could also be a problem instead with the temporary file used for output (no space on `/tmp` for example). Then the error message \"File not found\" would be very confusing. I think we need to explicitly check the existence of the doctested file and not handle `IOError` specially.\n\nFair enough.",
    "created_at": "2013-02-11T14:13:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135972",
    "user": "https://github.com/roed314"
}
```

<div id="comment:180" align="right">comment:180</div>

Replying to [@jdemeyer](#comment%3A177):
> I also don't like this:
> 
> ```
>         except IOError:
>             # File doesn't exist
>             result = 0, DictAsObject(dict(err='file')), ""
> ```
> 
> You assume that *any* `IOError` comes from the fact that the doctested file doesn't exist. But it could also be a problem instead with the temporary file used for output (no space on `/tmp` for example). Then the error message "File not found" would be very confusing. I think we need to explicitly check the existence of the doctested file and not handle `IOError` specially.

Fair enough.



---

archive/issue_comments_135973.json:
```json
{
    "body": "<div id=\"comment:181\" align=\"right\">comment:181</div>\n\nI think the word \"output\" is badly overused (there is the standard output, the file `output=os.tmpfile()`, the string `output` referring to the *contents* of the `output` file and `delayed_output`).\n\nI propose to rename:\n- `delayed_output` to `messages`\n- `output` (the file) to `outtmpfile` (or `tmpoutfile`?)\n\nAnd am I right that `delayed_output` is empty in normal mode when there are no doctest failures?",
    "created_at": "2013-02-11T14:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135973",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:181" align="right">comment:181</div>

I think the word "output" is badly overused (there is the standard output, the file `output=os.tmpfile()`, the string `output` referring to the *contents* of the `output` file and `delayed_output`).

I propose to rename:
- `delayed_output` to `messages`
- `output` (the file) to `outtmpfile` (or `tmpoutfile`?)

And am I right that `delayed_output` is empty in normal mode when there are no doctest failures?



---

archive/issue_comments_135974.json:
```json
{
    "body": "<div id=\"comment:182\" align=\"right\">comment:182</div>\n\nReplying to [@jdemeyer](#comment%3A181):\n> Can I replace \"`delayed_output`\" by \"`messages`\" because I think the word \"output\" is overused (there is the standard output, the file `outfile=os.tmpfile()` and `delayed_output`).\n> \n> And am I right that `delayed_output` is empty in normal mode when there are no doctest failures?\n\nSure, either \"`messages`\" or \"`delayed_messages`\" is fine.  It should be empty in normal mode with no failures.",
    "created_at": "2013-02-11T14:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135974",
    "user": "https://github.com/roed314"
}
```

<div id="comment:182" align="right">comment:182</div>

Replying to [@jdemeyer](#comment%3A181):
> Can I replace "`delayed_output`" by "`messages`" because I think the word "output" is overused (there is the standard output, the file `outfile=os.tmpfile()` and `delayed_output`).
> 
> And am I right that `delayed_output` is empty in normal mode when there are no doctest failures?

Sure, either "`messages`" or "`delayed_messages`" is fine.  It should be empty in normal mode with no failures.



---

archive/issue_comments_135975.json:
```json
{
    "body": "<div id=\"comment:183\" align=\"right\">comment:183</div>\n\nEdited [comment:181] because I noticed there is `output` the file and `output` the contents of the file.",
    "created_at": "2013-02-11T14:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135975",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:183" align="right">comment:183</div>

Edited [comment:181] because I noticed there is `output` the file and `output` the contents of the file.



---

archive/issue_events_167842.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2013-02-11T14:22:44Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167842"
}
```



---

archive/issue_events_167843.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-11T14:22:44Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167843"
}
```



---

archive/issue_comments_135976.json:
```json
{
    "body": "<div id=\"comment:184\" align=\"right\">comment:184</div>\n\nReplying to [@jdemeyer](#comment%3A181):\n> I think the word \"output\" is badly overused (there is the standard output, the file `output=os.tmpfile()`, the string `output` referring to the *contents* of the `output` file and `delayed_output`).\n> \n> I propose to rename:\n> - `delayed_output` to `messages`\n> - `output` (the file) to `outtmpfile` (or `tmpoutfile`?)\n\nI like `outtmpfile`.",
    "created_at": "2013-02-11T14:30:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135976",
    "user": "https://github.com/roed314"
}
```

<div id="comment:184" align="right">comment:184</div>

Replying to [@jdemeyer](#comment%3A181):
> I think the word "output" is badly overused (there is the standard output, the file `output=os.tmpfile()`, the string `output` referring to the *contents* of the `output` file and `delayed_output`).
> 
> I propose to rename:
> - `delayed_output` to `messages`
> - `output` (the file) to `outtmpfile` (or `tmpoutfile`?)

I like `outtmpfile`.



---

archive/issue_comments_135977.json:
```json
{
    "body": "<div id=\"comment:185\" align=\"right\">comment:185</div>\n\nFirst version of my updated doctesting framework.",
    "created_at": "2013-02-11T23:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135977",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:185" align="right">comment:185</div>

First version of my updated doctesting framework.



---

archive/issue_comments_135978.json:
```json
{
    "body": "<div id=\"comment:186\" align=\"right\">comment:186</div>\n\nReplying to [@jdemeyer](#comment%3A185):\n> First version of my updated doctesting framework.\n\nSome comments: \n* For compatibility with Python's `doctest` module, `summarize` should take `verbose` as the first argument and `msgfile` as an optional second argument.\n* It's `sage.ext.pselecter` rather than `sage.ext.pselect, unless you changed #14079.\n* Currently I get a timeout whenever I run tests on a file.\n* Why did you disable the code that sets `following` in `_parallel_dispatch`?\n\nOverall, I think the changes are good ones.",
    "created_at": "2013-02-12T11:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135978",
    "user": "https://github.com/roed314"
}
```

<div id="comment:186" align="right">comment:186</div>

Replying to [@jdemeyer](#comment%3A185):
> First version of my updated doctesting framework.

Some comments: 
* For compatibility with Python's `doctest` module, `summarize` should take `verbose` as the first argument and `msgfile` as an optional second argument.
* It's `sage.ext.pselecter` rather than `sage.ext.pselect, unless you changed #14079.
* Currently I get a timeout whenever I run tests on a file.
* Why did you disable the code that sets `following` in `_parallel_dispatch`?

Overall, I think the changes are good ones.



---

archive/issue_comments_135979.json:
```json
{
    "body": "<div id=\"comment:187\" align=\"right\">comment:187</div>\n\nReplying to [@roed314](#comment%3A186):\n> * For compatibility with Python's `doctest` module, `summarize` should take `verbose` as the first argument and `msgfile` as an optional second argument.\n\nFair enough. I never considered this compatibility, so it is quite possible that I introduced more incompatibilities.\n\n> * It's `sage.ext.pselecter` rather than `sage.ext.pselect, unless you changed #14079.\n\nYes, I did change #14079 but didn't realise that I hadn't uploaded the new patch. Anyway, I am looking into the problem on OS X.\n\n> * Currently I get a timeout whenever I run tests on a file.\n\nCould be the same OS-dependent problem as the one you reported in #14079.\n\n> * Why did you disable the code that sets `following` in `_parallel_dispatch`?\n\nSimply because it is work in progress, new tests are needed. My `DocTestWorker` has a substantially different function from the old `DocTestWorker`, so I cannot recycle the tests.",
    "created_at": "2013-02-12T13:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135979",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:187" align="right">comment:187</div>

Replying to [@roed314](#comment%3A186):
> * For compatibility with Python's `doctest` module, `summarize` should take `verbose` as the first argument and `msgfile` as an optional second argument.

Fair enough. I never considered this compatibility, so it is quite possible that I introduced more incompatibilities.

> * It's `sage.ext.pselecter` rather than `sage.ext.pselect, unless you changed #14079.

Yes, I did change #14079 but didn't realise that I hadn't uploaded the new patch. Anyway, I am looking into the problem on OS X.

> * Currently I get a timeout whenever I run tests on a file.

Could be the same OS-dependent problem as the one you reported in #14079.

> * Why did you disable the code that sets `following` in `_parallel_dispatch`?

Simply because it is work in progress, new tests are needed. My `DocTestWorker` has a substantially different function from the old `DocTestWorker`, so I cannot recycle the tests.



---

archive/issue_comments_135980.json:
```json
{
    "body": "<div id=\"comment:188\" align=\"right\">comment:188</div>\n\nUpdated patch (I haven't looked at the OS X specific issue).",
    "created_at": "2013-02-12T17:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135980",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:188" align="right">comment:188</div>

Updated patch (I haven't looked at the OS X specific issue).



---

archive/issue_comments_135981.json:
```json
{
    "body": "<div id=\"comment:189\" align=\"right\">comment:189</div>\n\nI noticed a change in behaviour and I'm wondering whether it is intentional.\n\nOld doctesting framework outputs like:\n\n```\nsage -t file.py\n<messages>\n         [4.1 s]\n```\n\nNew doctesting framework outputs like:\n\n```\n<messages>\nsage -t file.py\n    [1 test, 1 failure, 1.7 s]\n```\n\nI dislike the last way of outputting, especially in `--verbose` mode, because there is no mention of what file is being tested. You see:\n\n```\nRunning doctests with ID 2013-02-13-12-55-39-de348564.\nDoctesting 1 file.\nTrying (line 2):    cython('sig_on()')\nExpecting nothing\nok [1.61 s]\n...\n```\n\"line 2\" of which file?...",
    "created_at": "2013-02-13T11:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135981",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:189" align="right">comment:189</div>

I noticed a change in behaviour and I'm wondering whether it is intentional.

Old doctesting framework outputs like:

```
sage -t file.py
<messages>
         [4.1 s]
```

New doctesting framework outputs like:

```
<messages>
sage -t file.py
    [1 test, 1 failure, 1.7 s]
```

I dislike the last way of outputting, especially in `--verbose` mode, because there is no mention of what file is being tested. You see:

```
Running doctests with ID 2013-02-13-12-55-39-de348564.
Doctesting 1 file.
Trying (line 2):    cython('sig_on()')
Expecting nothing
ok [1.61 s]
...
```
"line 2" of which file?...



---

archive/issue_comments_135982.json:
```json
{
    "body": "<div id=\"comment:190\" align=\"right\">comment:190</div>\n\nReplying to [@jdemeyer](#comment%3A189):\n> I noticed a change in behaviour and I'm wondering whether it is intentional.\n> \n> Old doctesting framework outputs like:\n> \n> ```\n> sage -t file.py\n> <messages>\n>          [4.1 s]\n> ```\n> \n> New doctesting framework outputs like:\n> \n> ```\n> <messages>\n> sage -t file.py\n>     [1 test, 1 failure, 1.7 s]\n> ```\n>\n>\n> I dislike the last way of outputting, especially in `--verbose` mode, because there is no mention of what file is being tested. You see:\n>\n> ```\n> Running doctests with ID 2013-02-13-12-55-39-de348564.\n> Doctesting 1 file.\n> Trying (line 2):    cython('sig_on()')\n> Expecting nothing\n> ok [1.61 s]\n> ...\n> ```\n> \"line 2\" of which file?...\n\nAdding the number of tests and number of failures was intentional (to which I assume you don't object).  The change in order is an artifact of the code that delayed printing.  When there are lots of processes running parallel, you can't output \n\n```\nsage -t file.py\n```\n\nbefore starting testing, since the messages will get mixed up.  I agree that the line describing which file is being tested should come at the beginning.",
    "created_at": "2013-02-13T12:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135982",
    "user": "https://github.com/roed314"
}
```

<div id="comment:190" align="right">comment:190</div>

Replying to [@jdemeyer](#comment%3A189):
> I noticed a change in behaviour and I'm wondering whether it is intentional.
> 
> Old doctesting framework outputs like:
> 
> ```
> sage -t file.py
> <messages>
>          [4.1 s]
> ```
> 
> New doctesting framework outputs like:
> 
> ```
> <messages>
> sage -t file.py
>     [1 test, 1 failure, 1.7 s]
> ```
>
>
> I dislike the last way of outputting, especially in `--verbose` mode, because there is no mention of what file is being tested. You see:
>
> ```
> Running doctests with ID 2013-02-13-12-55-39-de348564.
> Doctesting 1 file.
> Trying (line 2):    cython('sig_on()')
> Expecting nothing
> ok [1.61 s]
> ...
> ```
> "line 2" of which file?...

Adding the number of tests and number of failures was intentional (to which I assume you don't object).  The change in order is an artifact of the code that delayed printing.  When there are lots of processes running parallel, you can't output 

```
sage -t file.py
```

before starting testing, since the messages will get mixed up.  I agree that the line describing which file is being tested should come at the beginning.



---

archive/issue_comments_135983.json:
```json
{
    "body": "<div id=\"comment:191\" align=\"right\">comment:191</div>\n\nReplying to [@roed314](#comment%3A190):\n> I agree that the line describing which file is being tested should come at the beginning.\n\nOK, so you agree with\n\n```\nsage -t file.py\n<messages>\n    [1 test, 1 failure, 1.7 s]\n```\n\nI would move the part of `report()` which prints the \"sage -t ...\" header to a new function `report_start()` (for example) and then correct the logic in `forker.py` to call that function at the appropriate time. Does that sound good?",
    "created_at": "2013-02-13T12:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135983",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:191" align="right">comment:191</div>

Replying to [@roed314](#comment%3A190):
> I agree that the line describing which file is being tested should come at the beginning.

OK, so you agree with

```
sage -t file.py
<messages>
    [1 test, 1 failure, 1.7 s]
```

I would move the part of `report()` which prints the "sage -t ..." header to a new function `report_start()` (for example) and then correct the logic in `forker.py` to call that function at the appropriate time. Does that sound good?



---

archive/issue_comments_135984.json:
```json
{
    "body": "<div id=\"comment:192\" align=\"right\">comment:192</div>\n\nReplying to [@jdemeyer](#comment%3A191):\n> Replying to [@roed314](#comment%3A190):\n> > I agree that the line describing which file is being tested should come at the beginning.\n> \n> OK, so you agree with\n> \n> ```\n> sage -t file.py\n> <messages>\n>     [1 test, 1 failure, 1.7 s]\n> ```\n> \n> I would move the part of `report()` which prints the \"sage -t ...\" header to a new function `report_start()` (for example) and then correct the logic in `forker.py` to call that function at the appropriate time. Does that sound good?\n\nSounds good.  Presumably it will get printed to the `msgfile` before all of the other messages and then actually printed to the screen in whatever way is appropriate.",
    "created_at": "2013-02-13T13:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135984",
    "user": "https://github.com/roed314"
}
```

<div id="comment:192" align="right">comment:192</div>

Replying to [@jdemeyer](#comment%3A191):
> Replying to [@roed314](#comment%3A190):
> > I agree that the line describing which file is being tested should come at the beginning.
> 
> OK, so you agree with
> 
> ```
> sage -t file.py
> <messages>
>     [1 test, 1 failure, 1.7 s]
> ```
> 
> I would move the part of `report()` which prints the "sage -t ..." header to a new function `report_start()` (for example) and then correct the logic in `forker.py` to call that function at the appropriate time. Does that sound good?

Sounds good.  Presumably it will get printed to the `msgfile` before all of the other messages and then actually printed to the screen in whatever way is appropriate.



---

archive/issue_comments_135985.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \n and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-02-15T19:59:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135985",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 
 and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
 
``````




---

archive/issue_events_167844.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-15T19:59:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167844"
}
```



---

archive/issue_events_167845.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-15T19:59:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167845"
}
```



---

archive/issue_comments_135986.json:
```json
{
    "body": "<div id=\"comment:193\" align=\"right\">comment:193</div>\n\nCould you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).",
    "created_at": "2013-02-15T19:59:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135986",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:193" align="right">comment:193</div>

Could you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).



---

archive/issue_comments_135987.json:
```json
{
    "body": "<div id=\"comment:194\" align=\"right\">comment:194</div>\n\nReplying to [@jdemeyer](#comment%3A193):\n> Could you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).\n\nI'm running tests on OS X 10.6.8 with sage 5.7.beta1.\n\n* Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.\n* I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`): it prints out a bunch of help text from IPython, ending with\n\n```\n[SageTerminalApp] Bad config encountered during initialization:\n[SageTerminalApp] Unrecognized flag: '--all'\n```\nI'm not really sure what's happening here: perhaps it's related to the IPython upgrade?\n* The same thing happens in `sage.misc.sage_extension` at line 22.\n* There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.\n* There are problems running some tests in `sage.doctest.control` that may go away with your new code.  If not I have fixes for them.\n\nHow is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?",
    "created_at": "2013-02-16T06:00:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135987",
    "user": "https://github.com/roed314"
}
```

<div id="comment:194" align="right">comment:194</div>

Replying to [@jdemeyer](#comment%3A193):
> Could you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).

I'm running tests on OS X 10.6.8 with sage 5.7.beta1.

* Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.
* I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`): it prints out a bunch of help text from IPython, ending with

```
[SageTerminalApp] Bad config encountered during initialization:
[SageTerminalApp] Unrecognized flag: '--all'
```
I'm not really sure what's happening here: perhaps it's related to the IPython upgrade?
* The same thing happens in `sage.misc.sage_extension` at line 22.
* There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.
* There are problems running some tests in `sage.doctest.control` that may go away with your new code.  If not I have fixes for them.

How is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?



---

archive/issue_comments_135988.json:
```json
{
    "body": "<div id=\"comment:195\" align=\"right\">comment:195</div>\n\nReplying to [@roed314](#comment%3A194):\n> Replying to [@jdemeyer](#comment%3A193):\n> > Could you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).\n> \n> \n> I'm running tests on OS X 10.6.8 with sage 5.7.beta1.\n> \n> * Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.\n\nThe difference is between plain ASCII characters and some fancy Unicode characters for the display. Not sure what to do with this.\n\n> * I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`):\n\nDid you apply #14070?\n\n> * There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.\n\nGood, then please fix it.\n\n> How is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?\n\nI think it works well for normal testing. I still have to think about `--debug` and things like `--gdb`.  It seems it will be necessary to have a serial mode for example for `--gdb`, so  I have to put that back in.  I would also like to force `--serial` when `--debug` is used, mainly to simplify the code.\n\nBut first I'm going to look at #14079 on OS X.",
    "created_at": "2013-02-16T10:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135988",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:195" align="right">comment:195</div>

Replying to [@roed314](#comment%3A194):
> Replying to [@jdemeyer](#comment%3A193):
> > Could you please review [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)? It contains all my reviewer changes for doctests in the Sage library (i.e. all changes not for the doctest framework).
> 
> 
> I'm running tests on OS X 10.6.8 with sage 5.7.beta1.
> 
> * Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.

The difference is between plain ASCII characters and some fancy Unicode characters for the display. Not sure what to do with this.

> * I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`):

Did you apply #14070?

> * There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.

Good, then please fix it.

> How is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?

I think it works well for normal testing. I still have to think about `--debug` and things like `--gdb`.  It seems it will be necessary to have a serial mode for example for `--gdb`, so  I have to put that back in.  I would also like to force `--serial` when `--debug` is used, mainly to simplify the code.

But first I'm going to look at #14079 on OS X.



---

archive/issue_comments_135989.json:
```json
{
    "body": "<div id=\"comment:196\" align=\"right\">comment:196</div>\n\n> > * Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.\n> \n> The difference is between plain ASCII characters and some fancy Unicode characters for the display. Not sure what to do with this.\n\nI fixed it by temporarily turning off unicode in pretting printing.  I updated the patch with this change.\n\n> > * I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`):\n> \n> Did you apply #14070?\n\nNope: applying #14070 fixed the problem.\n\n> > * There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.\n> \n> Good, then please fix it.\n\nOkay, the easy fix I remembered is to add a line to sagenb.notebook.worksheet:\n\n```\n         EXAMPLES: We test the constructor via an indirect doctest::\n \n             sage: nb = sagenb.notebook.notebook.Notebook(tmp_dir()+'.sagenb')\n+            sage: import sagenb.notebook.misc\n             sage: sagenb.notebook.misc.notebook = nb\n             sage: W = nb.create_new_worksheet('Test with unicode \u011b\u0161\u010d\u0159\u017e\u00fd\u00e1\u00ed\u00e9\u010f\u010e', 'admin')\n             sage: W\n\n```\n\nI haven't made any changes to `sagenb` for a long time.  I assume this would require a new spkg?\n\n> > How is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?\n> \n> I think it works well for normal testing. I still have to think about `--debug` and things like `--gdb`.  It seems it will be necessary to have a serial mode for example for `--gdb`, so  I have to put that back in.  I would also like to force `--serial` when `--debug` is used, mainly to simplify the code.\n\nMakes sense.\n\n> But first I'm going to look at #14079 on OS X.\n\nGood luck.",
    "created_at": "2013-02-16T12:49:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135989",
    "user": "https://github.com/roed314"
}
```

<div id="comment:196" align="right">comment:196</div>

> > * Your changes to `sage.calculus.test_sympy` break doctests on my machine: they were correct before the change.  Presumably these results are system dependent and should be changed somehow.
> 
> The difference is between plain ASCII characters and some fancy Unicode characters for the display. Not sure what to do with this.

I fixed it by temporarily turning off unicode in pretting printing.  I updated the patch with this change.

> > * I get a bad exit in sage.misc.interpreter at line 132 (in `get_test_shell()`):
> 
> Did you apply #14070?

Nope: applying #14070 fixed the problem.

> > * There's still an error in `sagenb.notebook.worksheet` line 196: `sagenb.notebook` has no attribute `misc`.  I've seen this before and it should be easy to fix.
> 
> Good, then please fix it.

Okay, the easy fix I remembered is to add a line to sagenb.notebook.worksheet:

```
         EXAMPLES: We test the constructor via an indirect doctest::
 
             sage: nb = sagenb.notebook.notebook.Notebook(tmp_dir()+'.sagenb')
+            sage: import sagenb.notebook.misc
             sage: sagenb.notebook.misc.notebook = nb
             sage: W = nb.create_new_worksheet('Test with unicode ěščřžýáíéďĎ', 'admin')
             sage: W

```

I haven't made any changes to `sagenb` for a long time.  I assume this would require a new spkg?

> > How is [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) coming along?
> 
> I think it works well for normal testing. I still have to think about `--debug` and things like `--gdb`.  It seems it will be necessary to have a serial mode for example for `--gdb`, so  I have to put that back in.  I would also like to force `--serial` when `--debug` is used, mainly to simplify the code.

Makes sense.

> But first I'm going to look at #14079 on OS X.

Good luck.



---

archive/issue_comments_135990.json:
```json
{
    "body": "<div id=\"comment:197\" align=\"right\">comment:197</div>\n\nReplying to [@roed314](#comment%3A196):\n> I haven't made any changes to `sagenb` for a long time.  I assume this would require a new spkg?\n\nNo, sagenb is now officially a separate project. I have sent a patch to \"upstream\" sagenb.",
    "created_at": "2013-02-16T16:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135990",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:197" align="right">comment:197</div>

Replying to [@roed314](#comment%3A196):
> I haven't made any changes to `sagenb` for a long time.  I assume this would require a new spkg?

No, sagenb is now officially a separate project. I have sent a patch to "upstream" sagenb.



---

archive/issue_comments_135991.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,7 @@\n \n **Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n \n-**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo\n+**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n``````\n",
    "created_at": "2013-02-18T15:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135991",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,7 @@
 
 **Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
 
-**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) to the scripts repo
+**Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
``````




---

archive/issue_comments_135992.json:
```json
{
    "body": "<div id=\"comment:198\" align=\"right\">comment:198</div>\n\nNew major update of my code. Now adds support for `--debug`.\n\nI removed `SagePdb` since the motivation of the output-redirection in the Python doctesting framework seems to be doctesting `Pdb` itself, not running a debugger inside the doctesting framework. For the new doctesting framework, we just need to stop spoofing before entering the debugger and start spoofing after the debugger is finished and that's all.",
    "created_at": "2013-02-18T15:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135992",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:198" align="right">comment:198</div>

New major update of my code. Now adds support for `--debug`.

I removed `SagePdb` since the motivation of the output-redirection in the Python doctesting framework seems to be doctesting `Pdb` itself, not running a debugger inside the doctesting framework. For the new doctesting framework, we just need to stop spoofing before entering the debugger and start spoofing after the debugger is finished and that's all.



---

archive/issue_comments_135993.json:
```json
{
    "body": "Changed author from **David Roe, Robert Bradshaw** to **David Roe, Robert Bradshaw, Jeroen Demeyer**",
    "created_at": "2013-02-18T20:47:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135993",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **David Roe, Robert Bradshaw** to **David Roe, Robert Bradshaw, Jeroen Demeyer**



---

archive/issue_comments_135994.json:
```json
{
    "body": "<div id=\"comment:199\" align=\"right\">comment:199</div>\n\nI fixed a few doctests errors, now the only remaining failure is\n\n```\nsage -t --long devel/sage/sage/doctest/sources.py\n**********************************************************************\nFile \"devel/sage/sage/doctest/sources.py\", line 653, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk(sage_loc), os.walk(doc_loc)): # long time\n        path = os.path.relpath(path)\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.sage', '.spyx', '.rst', '.tex'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, True, True, True, False)\n                FDS._test_enough_doctests(verbose=False)\nExpected:\n    There are 3 unexpected tests being run in .../sage/doctest/parsing.py\n    There are 1 tests in .../sage/ext/c_lib.pyx that are not being run\n    There are 2 tests in .../sage/server/notebook/worksheet.py that are not being run\n    There are 5 tests in .../doc/en/tutorial/interfaces.rst that are not being run\nGot:\n    doctest:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n    There are 2 tests in devel/sage/sage/server/notebook/worksheet.py that are not being run\n    There are 2 unexpected tests being run in devel/sage/sage/misc/cython.py\n    There are 9 tests in devel/sage/sage/graphs/graph_plot.py that are not being run\n    There are 1 tests in devel/sage/sage/ext/c_lib.pyx that are not being run\n    There are 3 unexpected tests being run in devel/sage/sage/doctest/parsing.py\n    There are 5 tests in devel/sage/doc/en/tutorial/interfaces.rst that are not being run\n    There are 1152 tests in devel/sage/doc/output/latex/en/reference/reference.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/en/tutorial/SageTutorial.tex that are not being run\n    There are 4 tests in devel/sage/doc/output/latex/en/thematic_tutorials/thematic_tutorials.tex that are not being run\n    There are 6 tests in devel/sage/doc/output/latex/en/prep/prep_tutorials.tex that are not being run\n    There are 2 tests in devel/sage/doc/output/latex/en/numerical_sage/numerical_sage.tex that are not being run\n    There are 15 tests in devel/sage/doc/output/latex/en/developer/developer.tex that are not being run\n    There are 16 tests in devel/sage/doc/output/latex/en/constructions/constructions.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/ru/tutorial/SageTutorial_ru.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/fr/tutorial/tutorial-fr.tex that are not being run\n    There are 51 tests in devel/sage/doc/output/latex/de/tutorial/SageTutorial-de.tex that are not being run\n**********************************************************************\n```\n\nAnd there are still messages about TABs in `sagenb/data`.",
    "created_at": "2013-02-18T20:47:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135994",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:199" align="right">comment:199</div>

I fixed a few doctests errors, now the only remaining failure is

```
sage -t --long devel/sage/sage/doctest/sources.py
**********************************************************************
File "devel/sage/sage/doctest/sources.py", line 653, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk(sage_loc), os.walk(doc_loc)): # long time
        path = os.path.relpath(path)
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.sage', '.spyx', '.rst', '.tex'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, True, True, True, False)
                FDS._test_enough_doctests(verbose=False)
Expected:
    There are 3 unexpected tests being run in .../sage/doctest/parsing.py
    There are 1 tests in .../sage/ext/c_lib.pyx that are not being run
    There are 2 tests in .../sage/server/notebook/worksheet.py that are not being run
    There are 5 tests in .../doc/en/tutorial/interfaces.rst that are not being run
Got:
    doctest:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
    There are 2 tests in devel/sage/sage/server/notebook/worksheet.py that are not being run
    There are 2 unexpected tests being run in devel/sage/sage/misc/cython.py
    There are 9 tests in devel/sage/sage/graphs/graph_plot.py that are not being run
    There are 1 tests in devel/sage/sage/ext/c_lib.pyx that are not being run
    There are 3 unexpected tests being run in devel/sage/sage/doctest/parsing.py
    There are 5 tests in devel/sage/doc/en/tutorial/interfaces.rst that are not being run
    There are 1152 tests in devel/sage/doc/output/latex/en/reference/reference.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/en/tutorial/SageTutorial.tex that are not being run
    There are 4 tests in devel/sage/doc/output/latex/en/thematic_tutorials/thematic_tutorials.tex that are not being run
    There are 6 tests in devel/sage/doc/output/latex/en/prep/prep_tutorials.tex that are not being run
    There are 2 tests in devel/sage/doc/output/latex/en/numerical_sage/numerical_sage.tex that are not being run
    There are 15 tests in devel/sage/doc/output/latex/en/developer/developer.tex that are not being run
    There are 16 tests in devel/sage/doc/output/latex/en/constructions/constructions.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/ru/tutorial/SageTutorial_ru.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/fr/tutorial/tutorial-fr.tex that are not being run
    There are 51 tests in devel/sage/doc/output/latex/de/tutorial/SageTutorial-de.tex that are not being run
**********************************************************************
```

And there are still messages about TABs in `sagenb/data`.



---

archive/issue_comments_135995.json:
```json
{
    "body": "<div id=\"comment:200\" align=\"right\">comment:200</div>\n\nI have been thinking about the encoding warnings (and encodings in doctests in general). I think there are two options:\n1. either we ignore the Cython warnings and continue working with pure strings,\n2. or we make the doctester completely Unicode-aware.\n\nI don't really see any middle ground. I'm inclined to go for the first option initially, but eventually migrating to the second option *in a different ticket*.\n\nBut I'm open to opinions on this.",
    "created_at": "2013-02-19T19:46:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135995",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:200" align="right">comment:200</div>

I have been thinking about the encoding warnings (and encodings in doctests in general). I think there are two options:
1. either we ignore the Cython warnings and continue working with pure strings,
2. or we make the doctester completely Unicode-aware.

I don't really see any middle ground. I'm inclined to go for the first option initially, but eventually migrating to the second option *in a different ticket*.

But I'm open to opinions on this.



---

archive/issue_comments_135996.json:
```json
{
    "body": "<div id=\"comment:201\" align=\"right\">comment:201</div>\n\nReplying to [@jdemeyer](#comment%3A200):\n> I have been thinking about the encoding warnings (and encodings in doctests in general). I think there are two options:\n> 1. either we ignore the Cython warnings and continue working with pure strings,\n> 2. or we make the doctester completely Unicode-aware.\n> \n> I don't really see any middle ground. I'm inclined to go for the first option initially, but eventually migrating to the second option *in a different ticket*.\n> \n> But I'm open to opinions on this.\n\nSounds like a good plan to me.  I prefer to avoid unicode when I can.",
    "created_at": "2013-02-19T19:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135996",
    "user": "https://github.com/roed314"
}
```

<div id="comment:201" align="right">comment:201</div>

Replying to [@jdemeyer](#comment%3A200):
> I have been thinking about the encoding warnings (and encodings in doctests in general). I think there are two options:
> 1. either we ignore the Cython warnings and continue working with pure strings,
> 2. or we make the doctester completely Unicode-aware.
> 
> I don't really see any middle ground. I'm inclined to go for the first option initially, but eventually migrating to the second option *in a different ticket*.
> 
> But I'm open to opinions on this.

Sounds like a good plan to me.  I prefer to avoid unicode when I can.



---

archive/issue_comments_135997.json:
```json
{
    "body": "<div id=\"comment:202\" align=\"right\">comment:202</div>\n\nWith these patches + the patched sagenb (https://github.com/sagemath/sagenb/pull/84), I get just one sporadic failure:\n\n```\nsage -t --long devel/sage/sage/homology/simplicial_complex.py\n**********************************************************************\nFile \"devel/sage/sage/homology/simplicial_complex.py\", line 2188, in sage.homology.simplicial_complex.SimplicialComplex.is_cohen_macaulay\nFailed example:\n    S.is_cohen_macaulay(ncpus=3)\nExpected:\n    False\nGot:\n    Exception OSError: (10, 'No child processes') in <generator object __call__ at 0x646f1e0> ignored\n    False\n**********************************************************************\n```\n\nI have not investigated, but I assume it must be some strange interaction between the `DocTestWorker` processes and the `cohen_macaulay` subprocesses.\n\nSince `bsd.math` has been down for a while (now it is back up), I haven't been able to look into the OS X issues.\n\nI guess the only remaining issue is `--gdb` (and `--valgrind`...) support.",
    "created_at": "2013-02-20T08:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135997",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:202" align="right">comment:202</div>

With these patches + the patched sagenb (https://github.com/sagemath/sagenb/pull/84), I get just one sporadic failure:

```
sage -t --long devel/sage/sage/homology/simplicial_complex.py
**********************************************************************
File "devel/sage/sage/homology/simplicial_complex.py", line 2188, in sage.homology.simplicial_complex.SimplicialComplex.is_cohen_macaulay
Failed example:
    S.is_cohen_macaulay(ncpus=3)
Expected:
    False
Got:
    Exception OSError: (10, 'No child processes') in <generator object __call__ at 0x646f1e0> ignored
    False
**********************************************************************
```

I have not investigated, but I assume it must be some strange interaction between the `DocTestWorker` processes and the `cohen_macaulay` subprocesses.

Since `bsd.math` has been down for a while (now it is back up), I haven't been able to look into the OS X issues.

I guess the only remaining issue is `--gdb` (and `--valgrind`...) support.



---

archive/issue_comments_135998.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150**",
    "created_at": "2013-02-20T12:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135998",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150**



---

archive/issue_comments_135999.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, David Roe**",
    "created_at": "2013-02-20T12:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-135999",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, David Roe**



---

archive/issue_comments_136000.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,11 +10,10 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)\n-\n **Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n+Follow-up tickets: #12720, #12722, #14152, #14153.\n``````\n",
    "created_at": "2013-02-20T22:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136000",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,11 +10,10 @@
 
 http://code.google.com/p/sagemath-timer/
 
-and does most of the above (plus more which has been moved to followup tickets #12720 and #12722)
-
 **Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
+Follow-up tickets: #12720, #12722, #14152, #14153.
``````




---

archive/issue_comments_136001.json:
```json
{
    "body": "<div id=\"comment:206\" align=\"right\">comment:206</div>\n\nSo is this ready for review by me?",
    "created_at": "2013-02-20T22:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136001",
    "user": "https://github.com/roed314"
}
```

<div id="comment:206" align="right">comment:206</div>

So is this ready for review by me?



---

archive/issue_comments_136002.json:
```json
{
    "body": "<div id=\"comment:207\" align=\"right\">comment:207</div>\n\nParallel testing still doesn't work on OS X.  1-process testing (`-p 1`) works.",
    "created_at": "2013-02-23T00:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136002",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:207" align="right">comment:207</div>

Parallel testing still doesn't work on OS X.  1-process testing (`-p 1`) works.



---

archive/issue_comments_136003.json:
```json
{
    "body": "<div id=\"comment:208\" align=\"right\">comment:208</div>\n\nDo you know why parallel testing doesn't work?",
    "created_at": "2013-02-24T11:22:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136003",
    "user": "https://github.com/roed314"
}
```

<div id="comment:208" align="right">comment:208</div>

Do you know why parallel testing doesn't work?



---

archive/issue_comments_136004.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158**",
    "created_at": "2013-02-25T11:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136004",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158**



---

archive/issue_comments_136005.json:
```json
{
    "body": "<div id=\"comment:210\" align=\"right\">comment:210</div>\n\nWhat's the point of running optional tests without optional \"sage\" tests? Because that would badly fail with code like\n\n```\nsage: a = some_object()\nsage: a.some_standard_method()\nsage: a.use_mypackage()  # optional: mypackage\n```\n(only the last line would be executed)\n\nAre all doctests supposed to be written like\n\n```\nsage: a = some_object()\nsage: a.some_standard_method()\n\nsage: a = some_object()  # optional: mypackage\nsage: a.use_mypackage()  # optional: mypackage\n```",
    "created_at": "2013-02-25T16:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136005",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:210" align="right">comment:210</div>

What's the point of running optional tests without optional "sage" tests? Because that would badly fail with code like

```
sage: a = some_object()
sage: a.some_standard_method()
sage: a.use_mypackage()  # optional: mypackage
```
(only the last line would be executed)

Are all doctests supposed to be written like

```
sage: a = some_object()
sage: a.some_standard_method()

sage: a = some_object()  # optional: mypackage
sage: a.use_mypackage()  # optional: mypackage
```



---

archive/issue_comments_136006.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-02-25T19:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136006",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_136007.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182**",
    "created_at": "2013-02-25T21:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136007",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182**



---

archive/issue_comments_136008.json:
```json
{
    "body": "<div id=\"comment:213\" align=\"right\">comment:213</div>\n\nReplying to [@jdemeyer](#comment%3A210):\n> What's the point of running optional tests without optional \"sage\" tests? Because that would badly fail with code like\n> \n> ```\n> sage: a = some_object()\n> sage: a.some_standard_method()\n> sage: a.use_mypackage()  # optional: mypackage\n> ```\n> (only the last line would be executed)\n> \n> Are all doctests supposed to be written like\n> \n> ```\n> sage: a = some_object()\n> sage: a.some_standard_method()\n> \n> sage: a = some_object()  # optional: mypackage\n> sage: a.use_mypackage()  # optional: mypackage\n> ```\n\nI agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only files with optional gap tests be run.",
    "created_at": "2013-02-25T21:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136008",
    "user": "https://github.com/roed314"
}
```

<div id="comment:213" align="right">comment:213</div>

Replying to [@jdemeyer](#comment%3A210):
> What's the point of running optional tests without optional "sage" tests? Because that would badly fail with code like
> 
> ```
> sage: a = some_object()
> sage: a.some_standard_method()
> sage: a.use_mypackage()  # optional: mypackage
> ```
> (only the last line would be executed)
> 
> Are all doctests supposed to be written like
> 
> ```
> sage: a = some_object()
> sage: a.some_standard_method()
> 
> sage: a = some_object()  # optional: mypackage
> sage: a.use_mypackage()  # optional: mypackage
> ```

I agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only files with optional gap tests be run.



---

archive/issue_comments_136009.json:
```json
{
    "body": "<div id=\"comment:214\" align=\"right\">comment:214</div>\n\nReplying to [@roed314](#comment%3A213):\n> I agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only **files with** optional gap tests be run.\n\nSo this is basically an option waiting for a better future implementation?",
    "created_at": "2013-02-25T22:06:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136009",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:214" align="right">comment:214</div>

Replying to [@roed314](#comment%3A213):
> I agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only **files with** optional gap tests be run.

So this is basically an option waiting for a better future implementation?



---

archive/issue_comments_136010.json:
```json
{
    "body": "<div id=\"comment:215\" align=\"right\">comment:215</div>\n\nReplying to [@jdemeyer](#comment%3A214):\n> Replying to [@roed314](#comment%3A213):\n> > I agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only **files with** optional gap tests be run.\n> \n> So this is basically an option waiting for a better future implementation?\n\nYeah, that's how I see it.  I don't really run optional tests very often, but it seems like it could be useful to quickly run the tests that directly depend on gap when you update an spkg or something.  But I'm not really attached to the particulars of the interface, so feel free to change it.",
    "created_at": "2013-02-25T23:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136010",
    "user": "https://github.com/roed314"
}
```

<div id="comment:215" align="right">comment:215</div>

Replying to [@jdemeyer](#comment%3A214):
> Replying to [@roed314](#comment%3A213):
> > I agree that the current implementation is kinda dumb.  But I could see wanting to run `sage -t --all --optional gap` and have only **files with** optional gap tests be run.
> 
> So this is basically an option waiting for a better future implementation?

Yeah, that's how I see it.  I don't really run optional tests very often, but it seems like it could be useful to quickly run the tests that directly depend on gap when you update an spkg or something.  But I'm not really attached to the particulars of the interface, so feel free to change it.



---

archive/issue_comments_136011.json:
```json
{
    "body": "<div id=\"comment:216\" align=\"right\">comment:216</div>\n\nA question about this new framework: at #13928, it was pointed out that if you (for whatever reason) put the Sage directory into a directory whose path contains \"/.\" (like \"/home/user/.Sage-stuff/sage-5.8.beta0/\"), then it will refuse to doctest any files in the Sage library. Will that still be true with this new setup? Basically, I'm wondering if this ticket supersedes #13928.",
    "created_at": "2013-02-26T03:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136011",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:216" align="right">comment:216</div>

A question about this new framework: at #13928, it was pointed out that if you (for whatever reason) put the Sage directory into a directory whose path contains "/." (like "/home/user/.Sage-stuff/sage-5.8.beta0/"), then it will refuse to doctest any files in the Sage library. Will that still be true with this new setup? Basically, I'm wondering if this ticket supersedes #13928.



---

archive/issue_comments_136012.json:
```json
{
    "body": "<div id=\"comment:217\" align=\"right\">comment:217</div>\n\nReplying to [@jhpalmieri](#comment%3A216):\n> A question about this new framework: at #13928, it was pointed out that if you (for whatever reason) put the Sage directory into a directory whose path contains \"/.\" (like \"/home/user/.Sage-stuff/sage-5.8.beta0/\")\n\nHiding Sage from the boss?\n\n> then it will refuse to doctest any files in the Sage library. Will that still be true with this new setup?\n\nNo, see `sage/doctest/control.py`, line 456.",
    "created_at": "2013-02-26T06:49:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136012",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:217" align="right">comment:217</div>

Replying to [@jhpalmieri](#comment%3A216):
> A question about this new framework: at #13928, it was pointed out that if you (for whatever reason) put the Sage directory into a directory whose path contains "/." (like "/home/user/.Sage-stuff/sage-5.8.beta0/")

Hiding Sage from the boss?

> then it will refuse to doctest any files in the Sage library. Will that still be true with this new setup?

No, see `sage/doctest/control.py`, line 456.



---

archive/issue_comments_136013.json:
```json
{
    "body": "<div id=\"comment:218\" align=\"right\">comment:218</div>\n\nNathann has a reason for putting his entire Sage installation in a hidden directory. I can understand why we would skip testing files in directories within the Sage library that start with \".\" (like \".hg\"), but why not just have that limitation and let the user put their Sage directory anywhere?",
    "created_at": "2013-02-26T15:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136013",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:218" align="right">comment:218</div>

Nathann has a reason for putting his entire Sage installation in a hidden directory. I can understand why we would skip testing files in directories within the Sage library that start with "." (like ".hg"), but why not just have that limitation and let the user put their Sage directory anywhere?



---

archive/issue_comments_136014.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184**",
    "created_at": "2013-02-26T16:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136014",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184**



---

archive/issue_comments_136015.json:
```json
{
    "body": "<div id=\"comment:220\" align=\"right\">comment:220</div>\n\nReplying to [@jhpalmieri](#comment%3A218):\n> Nathann has a reason for putting his entire Sage installation in a hidden directory. I can understand why we would skip testing files in directories within the Sage library that start with \".\" (like \".hg\"), but why not just have that limitation\n\nI believe that's precisely what we're doing, unless I am mistaken.",
    "created_at": "2013-02-26T16:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136015",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:220" align="right">comment:220</div>

Replying to [@jhpalmieri](#comment%3A218):
> Nathann has a reason for putting his entire Sage installation in a hidden directory. I can understand why we would skip testing files in directories within the Sage library that start with "." (like ".hg"), but why not just have that limitation

I believe that's precisely what we're doing, unless I am mistaken.



---

archive/issue_comments_136016.json:
```json
{
    "body": "<div id=\"comment:221\" align=\"right\">comment:221</div>\n\nSorry John, I misread your original question.",
    "created_at": "2013-02-26T16:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136016",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:221" align="right">comment:221</div>

Sorry John, I misread your original question.



---

archive/issue_comments_136017.json:
```json
{
    "body": "<div id=\"comment:222\" align=\"right\">comment:222</div>\n\nOkay, good, then I suggest that we close #13928 as a duplicate of this one, or at least close #13928 when this one is merged.",
    "created_at": "2013-02-26T16:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136017",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:222" align="right">comment:222</div>

Okay, good, then I suggest that we close #13928 as a duplicate of this one, or at least close #13928 when this one is merged.



---

archive/issue_comments_136018.json:
```json
{
    "body": "<div id=\"comment:223\" align=\"right\">comment:223</div>\n\n> I can understand why we would skip testing files in directories within the Sage library that start with \".\" (like \".hg\"), but why not just have that limitation\n> \n> I believe that's precisely what we're doing, unless I am mistaken.\n\nSorry, but I don't get it `O_o`\n\nAfter this patch is applied, will all files be skipped if SAGE_ROOT contains a `/.` somewhere, even if it is not a `/.hg` ?\n\nNathann",
    "created_at": "2013-02-26T16:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136018",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:223" align="right">comment:223</div>

> I can understand why we would skip testing files in directories within the Sage library that start with "." (like ".hg"), but why not just have that limitation
> 
> I believe that's precisely what we're doing, unless I am mistaken.

Sorry, but I don't get it `O_o`

After this patch is applied, will all files be skipped if SAGE_ROOT contains a `/.` somewhere, even if it is not a `/.hg` ?

Nathann



---

archive/issue_comments_136019.json:
```json
{
    "body": "<div id=\"comment:224\" align=\"right\">comment:224</div>\n\n> Okay, good, then I suggest that we close #13928 as a duplicate of this one, or at least close #13928 when this one is merged.\n\nGloops. That answers my question too `:-)`\n\nThen I will set #13928 to \"positive review/duplicate\", as I can safely have faith in our release manager and this patch `:-)`\n\nNathann",
    "created_at": "2013-02-26T17:00:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136019",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:224" align="right">comment:224</div>

> Okay, good, then I suggest that we close #13928 as a duplicate of this one, or at least close #13928 when this one is merged.

Gloops. That answers my question too `:-)`

Then I will set #13928 to "positive review/duplicate", as I can safely have faith in our release manager and this patch `:-)`

Nathann



---

archive/issue_comments_136020.json:
```json
{
    "body": "<div id=\"comment:225\" align=\"right\">comment:225</div>\n\nWhat goes wrong with parallel testing on OS X? I've installed the patches on an OS X 10.8.2 box, and running `./sage -tp devel/sage/sage/homology devel/sage/sage/parallel/` works fine, correctly detecting two cores, and completing testing faster than `./sage -t ...`. Using `./sage -tp 3 ...` runs even slightly faster.",
    "created_at": "2013-02-26T17:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136020",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:225" align="right">comment:225</div>

What goes wrong with parallel testing on OS X? I've installed the patches on an OS X 10.8.2 box, and running `./sage -tp devel/sage/sage/homology devel/sage/sage/parallel/` works fine, correctly detecting two cores, and completing testing faster than `./sage -t ...`. Using `./sage -tp 3 ...` runs even slightly faster.



---

archive/issue_comments_136021.json:
```json
{
    "body": "<div id=\"comment:226\" align=\"right\">comment:226</div>\n\nReplying to [@jhpalmieri](#comment%3A225):\n> What goes wrong with parallel testing on OS X? I've installed the patches on an OS X 10.8.2 box, and running `./sage -tp devel/sage/sage/homology devel/sage/sage/parallel/` works fine, correctly detecting two cores, and completing testing faster than `./sage -t ...`. Using `./sage -tp 3 ...` runs even slightly faster.\n\nJeroen said at #14079 that the parallel testing problem on OS X should be fixed now.",
    "created_at": "2013-02-26T19:38:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136021",
    "user": "https://github.com/roed314"
}
```

<div id="comment:226" align="right">comment:226</div>

Replying to [@jhpalmieri](#comment%3A225):
> What goes wrong with parallel testing on OS X? I've installed the patches on an OS X 10.8.2 box, and running `./sage -tp devel/sage/sage/homology devel/sage/sage/parallel/` works fine, correctly detecting two cores, and completing testing faster than `./sage -t ...`. Using `./sage -tp 3 ...` runs even slightly faster.

Jeroen said at #14079 that the parallel testing problem on OS X should be fixed now.



---

archive/issue_comments_136022.json:
```json
{
    "body": "<div id=\"comment:227\" align=\"right\">comment:227</div>\n\nSo far, OS X has not been my priority. I think it has to do with the way terminals are handled (try `./sage -t ... </dev/null 2>&1 | cat` for example, completely bypassing terminal I/O)",
    "created_at": "2013-02-26T21:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136022",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:227" align="right">comment:227</div>

So far, OS X has not been my priority. I think it has to do with the way terminals are handled (try `./sage -t ... </dev/null 2>&1 | cat` for example, completely bypassing terminal I/O)



---

archive/issue_comments_136023.json:
```json
{
    "body": "<div id=\"comment:228\" align=\"right\">comment:228</div>\n\nConcerning terminals, I also noted (on Linux) that piping output to `less` (`./sage -t ... | less`) doesn't quite work properly.",
    "created_at": "2013-02-26T21:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136023",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:228" align="right">comment:228</div>

Concerning terminals, I also noted (on Linux) that piping output to `less` (`./sage -t ... | less`) doesn't quite work properly.



---

archive/issue_comments_136024.json:
```json
{
    "body": "<div id=\"comment:229\" align=\"right\">comment:229</div>\n\nWithout applying any of the patches here, if a user modifies their configuration, say via #14188, some doctests may fail. I assume the same will be true after applying the patches here. My question: should `make ptest` (etc.) run with the `--nodotsage` setting, while `sage -t ...` uses the user's configuration? Or should both use `--nodotsage`, or neither use it?",
    "created_at": "2013-02-27T16:29:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136024",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:229" align="right">comment:229</div>

Without applying any of the patches here, if a user modifies their configuration, say via #14188, some doctests may fail. I assume the same will be true after applying the patches here. My question: should `make ptest` (etc.) run with the `--nodotsage` setting, while `sage -t ...` uses the user's configuration? Or should both use `--nodotsage`, or neither use it?



---

archive/issue_events_167846.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-27T19:19:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167846"
}
```



---

archive/issue_events_167847.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-27T19:19:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167847"
}
```



---

archive/issue_comments_136025.json:
```json
{
    "body": "<div id=\"comment:231\" align=\"right\">comment:231</div>\n\nReplying to [@jhpalmieri](#comment%3A229):\n> Without applying any of the patches here, if a user modifies their configuration, say via #14188, some doctests may fail. I assume the same will be true after applying the patches here. My question: should `make ptest` (etc.) run with the `--nodotsage` setting, while `sage -t ...` uses the user's configuration? Or should both use `--nodotsage`, or neither use it?\n\nI would say that both should use it: I don't see why the user might need their custom configuration when doctesting.",
    "created_at": "2013-02-27T21:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136025",
    "user": "https://github.com/roed314"
}
```

<div id="comment:231" align="right">comment:231</div>

Replying to [@jhpalmieri](#comment%3A229):
> Without applying any of the patches here, if a user modifies their configuration, say via #14188, some doctests may fail. I assume the same will be true after applying the patches here. My question: should `make ptest` (etc.) run with the `--nodotsage` setting, while `sage -t ...` uses the user's configuration? Or should both use `--nodotsage`, or neither use it?

I would say that both should use it: I don't see why the user might need their custom configuration when doctesting.



---

archive/issue_comments_136026.json:
```json
{
    "body": "<div id=\"comment:232\" align=\"right\">comment:232</div>\n\nI have a request/suggestion: move `DOCTEST_MODE` out of plot.py and into a file in the doctest directory. Right now, importing from plot.py can be lead to circular imports, etc. Also, it never belonged in plot.py in the first place. Can we do that on this ticket, or should it be on a followup?",
    "created_at": "2013-02-28T06:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136026",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:232" align="right">comment:232</div>

I have a request/suggestion: move `DOCTEST_MODE` out of plot.py and into a file in the doctest directory. Right now, importing from plot.py can be lead to circular imports, etc. Also, it never belonged in plot.py in the first place. Can we do that on this ticket, or should it be on a followup?



---

archive/issue_comments_136027.json:
```json
{
    "body": "<div id=\"comment:233\" align=\"right\">comment:233</div>\n\nReplying to [@roed314](#comment%3A82):\n> Do you ever use `sage -t` with valgrind?  I'm not sure exactly what's wrong with `sage -t --valgrind <FILENAME>`.\n\nIt used to work and I used it at some point to deal with the nice random failures caused by the introduction of weak caches of #715.\nNote the optional spkg we currently propose is really old (and surely dysfunctional on most systems), but there's an update rotting at #13060.\nI wouldn't mind making valgrind working again a follow-up ticket as I'm not actively using it right now.",
    "created_at": "2013-02-28T09:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136027",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:233" align="right">comment:233</div>

Replying to [@roed314](#comment%3A82):
> Do you ever use `sage -t` with valgrind?  I'm not sure exactly what's wrong with `sage -t --valgrind <FILENAME>`.

It used to work and I used it at some point to deal with the nice random failures caused by the introduction of weak caches of #715.
Note the optional spkg we currently propose is really old (and surely dysfunctional on most systems), but there's an update rotting at #13060.
I wouldn't mind making valgrind working again a follow-up ticket as I'm not actively using it right now.



---

archive/issue_comments_136028.json:
```json
{
    "body": "<div id=\"comment:234\" align=\"right\">comment:234</div>\n\nConcerning `DOT_SAGE`: it's not as easy as you think. The problem is that the doctesting framework needs `DOT_SAGE` in a few places, for example to store the timing information. So running\n\n```\nsage --nodotsage -t ...\n```\nis not an option.\n\nPerhaps changing `$IPYTHONDIR` is sufficient? That could be done within the doctesting framework.",
    "created_at": "2013-02-28T09:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136028",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:234" align="right">comment:234</div>

Concerning `DOT_SAGE`: it's not as easy as you think. The problem is that the doctesting framework needs `DOT_SAGE` in a few places, for example to store the timing information. So running

```
sage --nodotsage -t ...
```
is not an option.

Perhaps changing `$IPYTHONDIR` is sufficient? That could be done within the doctesting framework.



---

archive/issue_comments_136029.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up tickets: #12720, #12722, #14152, #14153.\n+Follow-up tickets: #12720, #12722, #14152, #14153, #14203.\n``````\n",
    "created_at": "2013-02-28T09:41:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136029",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up tickets: #12720, #12722, #14152, #14153.
+Follow-up tickets: #12720, #12722, #14152, #14153, #14203.
``````




---

archive/issue_comments_136030.json:
```json
{
    "body": "<div id=\"comment:236\" align=\"right\">comment:236</div>\n\nReplying to [@jhpalmieri](#comment%3A232):\n> I have a request/suggestion: move `DOCTEST_MODE` out of plot.py and into a file in the doctest directory. Right now, importing from plot.py can be lead to circular imports, etc. Also, it never belonged in plot.py in the first place. Can we do that on this ticket, or should it be on a followup?\n\nThis ticket is already big enough, so I created the follow-up #14203.",
    "created_at": "2013-02-28T09:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136030",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:236" align="right">comment:236</div>

Replying to [@jhpalmieri](#comment%3A232):
> I have a request/suggestion: move `DOCTEST_MODE` out of plot.py and into a file in the doctest directory. Right now, importing from plot.py can be lead to circular imports, etc. Also, it never belonged in plot.py in the first place. Can we do that on this ticket, or should it be on a followup?

This ticket is already big enough, so I created the follow-up #14203.



---

archive/issue_comments_136031.json:
```json
{
    "body": "Attachment: **[12415_doctest_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)**",
    "created_at": "2013-02-28T13:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136031",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_doctest_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz)**



---

archive/issue_comments_136032.json:
```json
{
    "body": "<div id=\"comment:237\" align=\"right\">comment:237</div>\n\nAttachment: **[12415_script_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz)**",
    "created_at": "2013-02-28T16:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136032",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:237" align="right">comment:237</div>

Attachment: **[12415_script_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz)**



---

archive/issue_comments_136033.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up tickets: #12720, #12722, #14152, #14153, #14203.\n+Follow-up or other doctest-related tickets: #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.\n``````\n",
    "created_at": "2013-02-28T16:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136033",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up tickets: #12720, #12722, #14152, #14153, #14203.
+Follow-up or other doctest-related tickets: #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.
``````




---

archive/issue_comments_136034.json:
```json
{
    "body": "<div id=\"comment:238\" align=\"right\">comment:238</div>\n\nAll tests pass for me.  I'm reading through [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz).",
    "created_at": "2013-02-28T19:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136034",
    "user": "https://github.com/roed314"
}
```

<div id="comment:238" align="right">comment:238</div>

All tests pass for me.  I'm reading through [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz).



---

archive/issue_comments_136035.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054**",
    "created_at": "2013-02-28T19:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136035",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054**



---

archive/issue_comments_136036.json:
```json
{
    "body": "<div id=\"comment:240\" align=\"right\">comment:240</div>\n\nFixed a conflict (nothing serious) with #14054.",
    "created_at": "2013-02-28T19:56:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136036",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:240" align="right">comment:240</div>

Fixed a conflict (nothing serious) with #14054.



---

archive/issue_comments_136037.json:
```json
{
    "body": "<div id=\"comment:241\" align=\"right\">comment:241</div>\n\nStill working through [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), but note that four functions in sage.doctest.forker don't have tests.",
    "created_at": "2013-02-28T20:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136037",
    "user": "https://github.com/roed314"
}
```

<div id="comment:241" align="right">comment:241</div>

Still working through [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), but note that four functions in sage.doctest.forker don't have tests.



---

archive/issue_comments_136038.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-03-01T01:04:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136038",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_136039.json:
```json
{
    "body": "<div id=\"comment:242\" align=\"right\">comment:242</div>\n\nHere's a review patch which adds doctests for the four functions that were missing them and makes a few other minor changes.  Other than this, I'm happy with Jeroen's changes.",
    "created_at": "2013-03-01T01:04:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136039",
    "user": "https://github.com/roed314"
}
```

<div id="comment:242" align="right">comment:242</div>

Here's a review patch which adds doctests for the four functions that were missing them and makes a few other minor changes.  Other than this, I'm happy with Jeroen's changes.



---

archive/issue_comments_136040.json:
```json
{
    "body": "<div id=\"comment:243\" align=\"right\">comment:243</div>\n\nIn [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), line 693 of control.py, \"sage.supp\" got changed to \"sage.sup\". Was this intentional?",
    "created_at": "2013-03-01T04:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136040",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:243" align="right">comment:243</div>

In [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), line 693 of control.py, "sage.supp" got changed to "sage.sup". Was this intentional?



---

archive/issue_comments_136041.json:
```json
{
    "body": "<div id=\"comment:244\" align=\"right\">comment:244</div>\n\nWhen I run `make ptestlong`, things look fine on the screen, but I see some funny characters in ptestlong.log (this is on OS X 10.8.2):\n\n```\nDoctesting 2283 files using 2 threads.\n^[\ufffd[?1034hsage -t --long devel/sage/sage/misc/interpreter.py\n    [107 tests, 12.0 s]\n```\nSo far, this is the only instance of this in the file. Could it be some sort of terminal color escape sequence? I see it on one machine but not another, so maybe it was just a cosmic ray...",
    "created_at": "2013-03-01T05:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136041",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:244" align="right">comment:244</div>

When I run `make ptestlong`, things look fine on the screen, but I see some funny characters in ptestlong.log (this is on OS X 10.8.2):

```
Doctesting 2283 files using 2 threads.
^[�[?1034hsage -t --long devel/sage/sage/misc/interpreter.py
    [107 tests, 12.0 s]
```
So far, this is the only instance of this in the file. Could it be some sort of terminal color escape sequence? I see it on one machine but not another, so maybe it was just a cosmic ray...



---

archive/issue_comments_136042.json:
```json
{
    "body": "<div id=\"comment:245\" align=\"right\">comment:245</div>\n\nReplying to [@jhpalmieri](#comment%3A243):\n> In [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), line 693 of control.py, \"sage.supp\" got changed to \"sage.sup\". Was this intentional?\n\nNope: thanks for catching that.",
    "created_at": "2013-03-01T05:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136042",
    "user": "https://github.com/roed314"
}
```

<div id="comment:245" align="right">comment:245</div>

Replying to [@jhpalmieri](#comment%3A243):
> In [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), line 693 of control.py, "sage.supp" got changed to "sage.sup". Was this intentional?

Nope: thanks for catching that.



---

archive/issue_comments_136043.json:
```json
{
    "body": "<div id=\"comment:246\" align=\"right\">comment:246</div>\n\nReplying to [@jhpalmieri](#comment%3A244):\n> When I run `make ptestlong`, things look fine on the screen, but I see some funny characters in ptestlong.log (this is on OS X 10.8.2):\n> \n> ```\n> Doctesting 2283 files using 2 threads.\n> ^[[?1034hsage -t --long devel/sage/sage/misc/interpreter.py\n>     [107 tests, 12.0 s]\n> ```\n> So far, this is the only instance of this in the file. Could it be some sort of terminal color escape sequence?\n\nYes. It most likely comes from the `import readline` I added in `init_sage()` (this happens once, so it's normal you see it only once in `ptestlong.log`). I have been fighting quite a bit with terminal I/O in this new doctester, and this is yet another manifestion of terminal issues :-(",
    "created_at": "2013-03-01T08:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136043",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:246" align="right">comment:246</div>

Replying to [@jhpalmieri](#comment%3A244):
> When I run `make ptestlong`, things look fine on the screen, but I see some funny characters in ptestlong.log (this is on OS X 10.8.2):
> 
> ```
> Doctesting 2283 files using 2 threads.
> ^[[?1034hsage -t --long devel/sage/sage/misc/interpreter.py
>     [107 tests, 12.0 s]
> ```
> So far, this is the only instance of this in the file. Could it be some sort of terminal color escape sequence?

Yes. It most likely comes from the `import readline` I added in `init_sage()` (this happens once, so it's normal you see it only once in `ptestlong.log`). I have been fighting quite a bit with terminal I/O in this new doctester, and this is yet another manifestion of terminal issues :-(



---

archive/issue_comments_136044.json:
```json
{
    "body": "<div id=\"comment:247\" align=\"right\">comment:247</div>\n\nCould you do me a favour since I don't have access to an OS X 10.8 system:\n\nRemove that `import readline` statement and run\n\n```\n./sage -btp N --long devel/sage/sage/doctest devel/sage/sage/tests\n```\nin the following ways:\n1. Normal doctest run in the terminal, let it finish\n2. Interrupt (CTRL-C) the tests somewhere in the middle of the run\n3. Pipe the output through `less`: `./sage -tp 2 ... | less`\nAnd all this both with `-p 1` and with `-p N` for some `N > 1`.",
    "created_at": "2013-03-01T08:12:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136044",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:247" align="right">comment:247</div>

Could you do me a favour since I don't have access to an OS X 10.8 system:

Remove that `import readline` statement and run

```
./sage -btp N --long devel/sage/sage/doctest devel/sage/sage/tests
```
in the following ways:
1. Normal doctest run in the terminal, let it finish
2. Interrupt (CTRL-C) the tests somewhere in the middle of the run
3. Pipe the output through `less`: `./sage -tp 2 ... | less`
And all this both with `-p 1` and with `-p N` for some `N > 1`.



---

archive/issue_comments_136045.json:
```json
{
    "body": "<div id=\"comment:248\" align=\"right\">comment:248</div>\n\nDavid, I noticed that `doc/en/developer/doctesting.rst` in [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) is full of TAB characters. Could you please replace those by 8 spaces?\n\nI agree with [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz).\n\nDid you also look at [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) and [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)?",
    "created_at": "2013-03-01T08:25:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136045",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:248" align="right">comment:248</div>

David, I noticed that `doc/en/developer/doctesting.rst` in [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) is full of TAB characters. Could you please replace those by 8 spaces?

I agree with [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz).

Did you also look at [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) and [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)?



---

archive/issue_comments_136046.json:
```json
{
    "body": "<div id=\"comment:249\" align=\"right\">comment:249</div>\n\nSorry, too fast. This is dangerous:\n\n```\nsage: W.start() \nsage: W.join() \nsage: while W.rmessages is not None: \n....:   W.read_messages() \nsage: len(W.messages) > 0 \nTrue \n```\nYou should read the messages *while* the worker is running, because otherwise the pipe buffer might get full, leading to a block. So put `W.join()` at the end instead of at the beginning. Apart from that, it's a useful and good test.",
    "created_at": "2013-03-01T08:28:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136046",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:249" align="right">comment:249</div>

Sorry, too fast. This is dangerous:

```
sage: W.start() 
sage: W.join() 
sage: while W.rmessages is not None: 
....:   W.read_messages() 
sage: len(W.messages) > 0 
True 
```
You should read the messages *while* the worker is running, because otherwise the pipe buffer might get full, leading to a block. So put `W.join()` at the end instead of at the beginning. Apart from that, it's a useful and good test.



---

archive/issue_comments_136047.json:
```json
{
    "body": "<div id=\"comment:250\" align=\"right\">comment:250</div>\n\nReplying to [@jdemeyer](#comment%3A248):\n> David, I noticed that `doc/en/developer/doctesting.rst` in [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) is full of TAB characters. Could you please replace those by 8 spaces?\n\nThat's ironic.  I replaced them, though I left the ones you're deleting in [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) so that it applies cleanly.\n\n> Did you also look at [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) and [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)?\n\n[attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) both look fine.\n\nFor [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), you never run some of the files in the test directory (`sig_on.rst` and `sleep_and_raise.rst`).  Otherwise they look good.",
    "created_at": "2013-03-01T10:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136047",
    "user": "https://github.com/roed314"
}
```

<div id="comment:250" align="right">comment:250</div>

Replying to [@jdemeyer](#comment%3A248):
> David, I noticed that `doc/en/developer/doctesting.rst` in [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) is full of TAB characters. Could you please replace those by 8 spaces?

That's ironic.  I replaced them, though I left the ones you're deleting in [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz) so that it applies cleanly.

> Did you also look at [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) and [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)?

[attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) both look fine.

For [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), you never run some of the files in the test directory (`sig_on.rst` and `sleep_and_raise.rst`).  Otherwise they look good.



---

archive/issue_comments_136048.json:
```json
{
    "body": "<div id=\"comment:251\" align=\"right\">comment:251</div>\n\nAttachment: **[12415_review_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)**\n\nReplying to [@jdemeyer](#comment%3A249):\n> Sorry, too fast. This is dangerous:\n> \n> ```\n> sage: W.start() \n> sage: W.join() \n> sage: while W.rmessages is not None: \n> ....:   W.read_messages() \n> sage: len(W.messages) > 0 \n> True \n> ```\n> You should read the messages *while* the worker is running, because otherwise the pipe buffer might get full, leading to a block. So put `W.join()` at the end instead of at the beginning. Apart from that, it's a useful and good test.\n\nDone.  I also updated the tests for `kill` and `save_result_output` to be more robust.",
    "created_at": "2013-03-01T10:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136048",
    "user": "https://github.com/roed314"
}
```

<div id="comment:251" align="right">comment:251</div>

Attachment: **[12415_review_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)**

Replying to [@jdemeyer](#comment%3A249):
> Sorry, too fast. This is dangerous:
> 
> ```
> sage: W.start() 
> sage: W.join() 
> sage: while W.rmessages is not None: 
> ....:   W.read_messages() 
> sage: len(W.messages) > 0 
> True 
> ```
> You should read the messages *while* the worker is running, because otherwise the pipe buffer might get full, leading to a block. So put `W.join()` at the end instead of at the beginning. Apart from that, it's a useful and good test.

Done.  I also updated the tests for `kill` and `save_result_output` to be more robust.



---

archive/issue_comments_136049.json:
```json
{
    "body": "<div id=\"comment:252\" align=\"right\">comment:252</div>\n\nReplying to [@jdemeyer](#comment%3A247):\n> Could you do me a favour since I don't have access to an OS X 10.8 system:\n\nIs this useful for me to run on OS X 10.6.8?\n \n> Remove that `import readline` statement and run\n> \n> ```\n> ./sage -btp N --long devel/sage/sage/doctest devel/sage/sage/tests\n> ```\n> in the following ways:\n> 1. Normal doctest run in the terminal, let it finish\n> 2. Interrupt (CTRL-C) the tests somewhere in the middle of the run\n> 3. Pipe the output through `less`: `./sage -tp 2 ... | less`\n> And all this both with `-p 1` and with `-p N` for some `N > 1`.",
    "created_at": "2013-03-01T10:13:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136049",
    "user": "https://github.com/roed314"
}
```

<div id="comment:252" align="right">comment:252</div>

Replying to [@jdemeyer](#comment%3A247):
> Could you do me a favour since I don't have access to an OS X 10.8 system:

Is this useful for me to run on OS X 10.6.8?
 
> Remove that `import readline` statement and run
> 
> ```
> ./sage -btp N --long devel/sage/sage/doctest devel/sage/sage/tests
> ```
> in the following ways:
> 1. Normal doctest run in the terminal, let it finish
> 2. Interrupt (CTRL-C) the tests somewhere in the middle of the run
> 3. Pipe the output through `less`: `./sage -tp 2 ... | less`
> And all this both with `-p 1` and with `-p N` for some `N > 1`.



---

archive/issue_comments_136050.json:
```json
{
    "body": "<div id=\"comment:253\" align=\"right\">comment:253</div>\n\nReplying to [@roed314](#comment%3A250):\n> For [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), you never run some of the files in the test directory (`sig_on.rst` and `sleep_and_raise.rst`).\n\nWell, I found `sleep_and_raise.rst` useful for manual testing, so I left it.\n\nAnd `sig_on.rst` will be tested in the follow-up #14152 (which will be an easy ticket).",
    "created_at": "2013-03-01T11:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136050",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:253" align="right">comment:253</div>

Replying to [@roed314](#comment%3A250):
> For [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), you never run some of the files in the test directory (`sig_on.rst` and `sleep_and_raise.rst`).

Well, I found `sleep_and_raise.rst` useful for manual testing, so I left it.

And `sig_on.rst` will be tested in the follow-up #14152 (which will be an easy ticket).



---

archive/issue_comments_136051.json:
```json
{
    "body": "<div id=\"comment:254\" align=\"right\">comment:254</div>\n\nOn OS X 10.8.2.\n\nRunning with `sage -btp 1 ...`:\n\n```\nsage -t --long devel/sage/sage/tests/french_book/polynomes.py\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n  if code[q-1] == u'\\\\':\n    [107 tests, 2.6 s]\n```\nRunning with `sage -btp 2 ...` \u2014 note the random (?) placement of the unicode warning:\n\n```\nsage -t --long devel/sage/sage/tests/book_stein_modform.py\n    [239 tests, 3.3 s]\n/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n  if code[q-1] == u'\\\\':\nsage -t --long devel/sage/sage/tests/french_book/polynomes.py\n    [107 tests, 2.3 s]\n```\n\nWithout the `import readline` statement, I got one nonrepeatable failure with `sage -btp 2 ...` (probably has nothing to do with readline, but have you seen this before?):\n\n```\nsage -t --long devel/sage/sage/doctest/forker.py\n**********************************************************************\nFile \"devel/sage/sage/doctest/forker.py\", line 1693, in sage.doctest.forker.DocTestWorker.read_messages\nFailed example:\n    while W.rmessages is not None:\n        W.read_messages()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 436, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 792, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.forker.DocTestWorker.read_messages[9]>\", line 2, in <module>\n        W.read_messages()\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1703, in read_messages\n        s = os.read(self.rmessages, 4096)\n    OSError: [Errno 4] Interrupted system call\n**********************************************************************\n1 item had failures:\n   1 of  13 in sage.doctest.forker.DocTestWorker.read_messages\n    [384 tests, 1 failure, 17.3 s]\n```\nWith or without the `import readline` statement, I see this when piping through `less`, with `-btp 1` or `-btp 2`:\n\n```\nInstalling c_lib\nESC[?1034hscons: `install' is up to date.\n```\n\nExcept for the nonrepeatable failure, I see no difference with or without `import readline`.",
    "created_at": "2013-03-01T17:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136051",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:254" align="right">comment:254</div>

On OS X 10.8.2.

Running with `sage -btp 1 ...`:

```
sage -t --long devel/sage/sage/tests/french_book/polynomes.py
/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
  if code[q-1] == u'\\':
    [107 tests, 2.6 s]
```
Running with `sage -btp 2 ...` — note the random (?) placement of the unicode warning:

```
sage -t --long devel/sage/sage/tests/book_stein_modform.py
    [239 tests, 3.3 s]
/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py:229: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
  if code[q-1] == u'\\':
sage -t --long devel/sage/sage/tests/french_book/polynomes.py
    [107 tests, 2.3 s]
```

Without the `import readline` statement, I got one nonrepeatable failure with `sage -btp 2 ...` (probably has nothing to do with readline, but have you seen this before?):

```
sage -t --long devel/sage/sage/doctest/forker.py
**********************************************************************
File "devel/sage/sage/doctest/forker.py", line 1693, in sage.doctest.forker.DocTestWorker.read_messages
Failed example:
    while W.rmessages is not None:
        W.read_messages()
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 436, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 792, in execute
        exec compiled in globs
      File "<doctest sage.doctest.forker.DocTestWorker.read_messages[9]>", line 2, in <module>
        W.read_messages()
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1703, in read_messages
        s = os.read(self.rmessages, 4096)
    OSError: [Errno 4] Interrupted system call
**********************************************************************
1 item had failures:
   1 of  13 in sage.doctest.forker.DocTestWorker.read_messages
    [384 tests, 1 failure, 17.3 s]
```
With or without the `import readline` statement, I see this when piping through `less`, with `-btp 1` or `-btp 2`:

```
Installing c_lib
ESC[?1034hscons: `install' is up to date.
```

Except for the nonrepeatable failure, I see no difference with or without `import readline`.



---

archive/issue_comments_136052.json:
```json
{
    "body": "<div id=\"comment:255\" align=\"right\">comment:255</div>\n\nReplying to [@jhpalmieri](#comment%3A254):\n> \n> ```\n> sage -t --long devel/sage/sage/doctest/forker.py\n> **********************************************************************\n> File \"devel/sage/sage/doctest/forker.py\", line 1693, in sage.doctest.forker.DocTestWorker.read_messages\n> Failed example:\n>     while W.rmessages is not None:\n>         W.read_messages()\n> Exception raised:\n>     Traceback (most recent call last):\n>       File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 436, in _run\n>         self.execute(example, compiled, test.globs)\n>       File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 792, in execute\n>         exec compiled in globs\n>       File \"<doctest sage.doctest.forker.DocTestWorker.read_messages[9]>\", line 2, in <module>\n>         W.read_messages()\n>       File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1703, in read_messages\n>         s = os.read(self.rmessages, 4096)\n>     OSError: [Errno 4] Interrupted system call\n> **********************************************************************\n> 1 item had failures:\n>    1 of  13 in sage.doctest.forker.DocTestWorker.read_messages\n>     [384 tests, 1 failure, 17.3 s]\n> ```\n\nThat actually looks serious, I'll have a look.\n\n> ```\n> Installing c_lib\n> ESC[?1034hscons: `install' is up to date.\n> ```\n\nThat's before the doctester starts, so it's not our problem.\n\n> Except for the nonrepeatable failure, I see no difference with or without `import readline`.\n\nIs the `[[?1034h` control code gone when you remove `import readline`?",
    "created_at": "2013-03-01T19:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136052",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:255" align="right">comment:255</div>

Replying to [@jhpalmieri](#comment%3A254):
> 
> ```
> sage -t --long devel/sage/sage/doctest/forker.py
> **********************************************************************
> File "devel/sage/sage/doctest/forker.py", line 1693, in sage.doctest.forker.DocTestWorker.read_messages
> Failed example:
>     while W.rmessages is not None:
>         W.read_messages()
> Exception raised:
>     Traceback (most recent call last):
>       File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 436, in _run
>         self.execute(example, compiled, test.globs)
>       File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 792, in execute
>         exec compiled in globs
>       File "<doctest sage.doctest.forker.DocTestWorker.read_messages[9]>", line 2, in <module>
>         W.read_messages()
>       File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.8.beta2/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1703, in read_messages
>         s = os.read(self.rmessages, 4096)
>     OSError: [Errno 4] Interrupted system call
> **********************************************************************
> 1 item had failures:
>    1 of  13 in sage.doctest.forker.DocTestWorker.read_messages
>     [384 tests, 1 failure, 17.3 s]
> ```

That actually looks serious, I'll have a look.

> ```
> Installing c_lib
> ESC[?1034hscons: `install' is up to date.
> ```

That's before the doctester starts, so it's not our problem.

> Except for the nonrepeatable failure, I see no difference with or without `import readline`.

Is the `[[?1034h` control code gone when you remove `import readline`?



---

archive/issue_comments_136053.json:
```json
{
    "body": "<div id=\"comment:256\" align=\"right\">comment:256</div>\n\n> Is the [[?1034h control code gone when you remove import readline?\n\nNo, it's there either way.",
    "created_at": "2013-03-01T19:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136053",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:256" align="right">comment:256</div>

> Is the [[?1034h control code gone when you remove import readline?

No, it's there either way.



---

archive/issue_comments_136054.json:
```json
{
    "body": "<div id=\"comment:257\" align=\"right\">comment:257</div>\n\nAnother random failure:\n\n```\nsage -t devel/sage/sage/doctest/forker.py\n**********************************************************************\nFile \"devel/sage/sage/doctest/forker.py\", line 1729, in sage.doctest.forker.DocTestWorker.save_result_output\nFailed example:\n    sorted(W.result[1].keys())\nExpected:\n    ['cputime', 'err', 'failures', 'walltime']\nGot:\n    ['err']\n**********************************************************************\n1 item had failures:\n   1 of  14 in sage.doctest.forker.DocTestWorker.save_result_output\n    [384 tests, 1 failure, 17.4 s]\n```",
    "created_at": "2013-03-01T19:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136054",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:257" align="right">comment:257</div>

Another random failure:

```
sage -t devel/sage/sage/doctest/forker.py
**********************************************************************
File "devel/sage/sage/doctest/forker.py", line 1729, in sage.doctest.forker.DocTestWorker.save_result_output
Failed example:
    sorted(W.result[1].keys())
Expected:
    ['cputime', 'err', 'failures', 'walltime']
Got:
    ['err']
**********************************************************************
1 item had failures:
   1 of  14 in sage.doctest.forker.DocTestWorker.save_result_output
    [384 tests, 1 failure, 17.4 s]
```



---

archive/issue_comments_136055.json:
```json
{
    "body": "<div id=\"comment:258\" align=\"right\">comment:258</div>\n\nReplying to [@jhpalmieri](#comment%3A256):\n> > Is the [[?1034h control code gone when you remove import readline?\n> \n> \n> No, it's there either way.\n\nIn serial and in parallel?",
    "created_at": "2013-03-01T19:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136055",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:258" align="right">comment:258</div>

Replying to [@jhpalmieri](#comment%3A256):
> > Is the [[?1034h control code gone when you remove import readline?
> 
> 
> No, it's there either way.

In serial and in parallel?



---

archive/issue_events_167848.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-01T19:24:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167848"
}
```



---

archive/issue_events_167849.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-01T19:24:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167849"
}
```



---

archive/issue_comments_136056.json:
```json
{
    "body": "Attachment: **[12415_doc.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)**\n\nUpdates documention",
    "created_at": "2013-03-01T21:54:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136056",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_doc.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz)**

Updates documention



---

archive/issue_comments_136057.json:
```json
{
    "body": "Attachment: **[12415_test.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)**",
    "created_at": "2013-03-01T21:56:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136057",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_test.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz)**



---

archive/issue_comments_136058.json:
```json
{
    "body": "Attachment: **[12415_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)**",
    "created_at": "2013-03-01T21:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136058",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_review.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz)**



---

archive/issue_comments_136059.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-03-01T22:00:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136059",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doctest_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_review.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_events_167850.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-01T22:00:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167850"
}
```



---

archive/issue_events_167851.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-01T22:00:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167851"
}
```



---

archive/issue_comments_136060.json:
```json
{
    "body": "<div id=\"comment:260\" align=\"right\">comment:260</div>\n\n* Merged two doctest patches\n\n* Merged the patches to the documentation into [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) and changed version numbers to sage-5.9.\n\n* [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz): removed unused `sig_on.rst`.",
    "created_at": "2013-03-01T22:00:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136060",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:260" align="right">comment:260</div>

* Merged two doctest patches

* Merged the patches to the documentation into [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz) and changed version numbers to sage-5.9.

* [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz): removed unused `sig_on.rst`.



---

archive/issue_comments_136061.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-03-01T22:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136061",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_136062.json:
```json
{
    "body": "<div id=\"comment:262\" align=\"right\">comment:262</div>\n\nJohn: I think both your failures are due to not resetting the `SIGCHLD` signal handler, that should be fixed now.",
    "created_at": "2013-03-01T22:48:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136062",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:262" align="right">comment:262</div>

John: I think both your failures are due to not resetting the `SIGCHLD` signal handler, that should be fixed now.



---

archive/issue_comments_136063.json:
```json
{
    "body": "<div id=\"comment:263\" align=\"right\">comment:263</div>\n\nReplying to [@jdemeyer](#comment%3A262):\n> John: I think both your failures are due to not resetting the `SIGCHLD` signal handler, that should be fixed now.\n\nI still get the following failures:\n\n```\nsage -t sage/doctest/forker.py\n**********************************************************************\nFile \"sage/doctest/forker.py\", line 1777, in sage.doctest.forker.DocTestWorker.kill\nFailed example:\n    W.kill()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 432, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 788, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.forker.DocTestWorker.kill[14]>\", line 1, in <module>\n        W.kill()\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1791, in kill\n        os.killpg(self.pid, signal.SIGHUP)\n    OSError: [Errno 3] No such process\n**********************************************************************\nFile \"sage/doctest/forker.py\", line 1781, in sage.doctest.forker.DocTestWorker.kill\nFailed example:\n    W.kill()         # Worker dies now\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 432, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 788, in execute\n        exec compiled in globs\n      File \"<doctest sage.doctest.forker.DocTestWorker.kill[17]>\", line 1, in <module>\n        W.kill()         # Worker dies now\n      File \"/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1793, in kill\n        os.killpg(self.pid, signal.SIGKILL)\n    OSError: [Errno 1] Operation not permitted\n**********************************************************************\n\n```",
    "created_at": "2013-03-01T23:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136063",
    "user": "https://github.com/roed314"
}
```

<div id="comment:263" align="right">comment:263</div>

Replying to [@jdemeyer](#comment%3A262):
> John: I think both your failures are due to not resetting the `SIGCHLD` signal handler, that should be fixed now.

I still get the following failures:

```
sage -t sage/doctest/forker.py
**********************************************************************
File "sage/doctest/forker.py", line 1777, in sage.doctest.forker.DocTestWorker.kill
Failed example:
    W.kill()
Exception raised:
    Traceback (most recent call last):
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 432, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 788, in execute
        exec compiled in globs
      File "<doctest sage.doctest.forker.DocTestWorker.kill[14]>", line 1, in <module>
        W.kill()
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1791, in kill
        os.killpg(self.pid, signal.SIGHUP)
    OSError: [Errno 3] No such process
**********************************************************************
File "sage/doctest/forker.py", line 1781, in sage.doctest.forker.DocTestWorker.kill
Failed example:
    W.kill()         # Worker dies now
Exception raised:
    Traceback (most recent call last):
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 432, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 788, in execute
        exec compiled in globs
      File "<doctest sage.doctest.forker.DocTestWorker.kill[17]>", line 1, in <module>
        W.kill()         # Worker dies now
      File "/Users/roed/sage/sage-5.8.beta0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1793, in kill
        os.killpg(self.pid, signal.SIGKILL)
    OSError: [Errno 1] Operation not permitted
**********************************************************************

```



---

archive/issue_comments_136064.json:
```json
{
    "body": "<div id=\"comment:264\" align=\"right\">comment:264</div>\n\nGot it! It's trying to kill the *process group*, but we're not sure at this point that the worker already changed its process group.",
    "created_at": "2013-03-02T08:38:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136064",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:264" align="right">comment:264</div>

Got it! It's trying to kill the *process group*, but we're not sure at this point that the worker already changed its process group.



---

archive/issue_events_167852.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-02T09:22:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167852"
}
```



---

archive/issue_events_167853.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-02T09:22:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167853"
}
```



---

archive/issue_comments_136065.json:
```json
{
    "body": "<div id=\"comment:266\" align=\"right\">comment:266</div>\n\nDavid: thanks for your added doctests. They really did expose some bugs.",
    "created_at": "2013-03-02T09:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136065",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:266" align="right">comment:266</div>

David: thanks for your added doctests. They really did expose some bugs.



---

archive/issue_comments_136066.json:
```json
{
    "body": "Attachment: **[12415_review3.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)**",
    "created_at": "2013-03-02T10:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136066",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_review3.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)**



---

archive/issue_comments_136067.json:
```json
{
    "body": "<div id=\"comment:267\" align=\"right\">comment:267</div>\n\nExcellent!  I suspect there's more trouble somewhere, but I would suggest dealing with it in follow-up tickets.\n\nThe changes all look fine to me, but I haven't run full doctests (and am probably not going to be able to today since I'm traveling).  I'm happy giving this positive review subject to all doctests passing.",
    "created_at": "2013-03-02T20:12:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136067",
    "user": "https://github.com/roed314"
}
```

<div id="comment:267" align="right">comment:267</div>

Excellent!  I suspect there's more trouble somewhere, but I would suggest dealing with it in follow-up tickets.

The changes all look fine to me, but I haven't run full doctests (and am probably not going to be able to today since I'm traveling).  I'm happy giving this positive review subject to all doctests passing.



---

archive/issue_comments_136068.json:
```json
{
    "body": "Attachment: **[12415_doctest_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz)**\n\nDoctest changes that are needed to account for differences in the new framework",
    "created_at": "2013-03-03T13:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136068",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_doctest_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz)**

Doctest changes that are needed to account for differences in the new framework



---

archive/issue_events_167854.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T13:16:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167854"
}
```



---

archive/issue_events_167855.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T13:16:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167855"
}
```



---

archive/issue_comments_136069.json:
```json
{
    "body": "<div id=\"comment:268\" align=\"right\">comment:268</div>\n\nRebased again.\n\nI take David's comment as meaning \"positive review\".",
    "created_at": "2013-03-03T13:16:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136069",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:268" align="right">comment:268</div>

Rebased again.

I take David's comment as meaning "positive review".



---

archive/issue_comments_136070.json:
```json
{
    "body": "<div id=\"comment:269\" align=\"right\">comment:269</div>\n\nAttachment: **[12415_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)**",
    "created_at": "2013-03-03T15:57:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136070",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:269" align="right">comment:269</div>

Attachment: **[12415_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)**



---

archive/issue_events_167856.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T15:57:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167856"
}
```



---

archive/issue_events_167857.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T15:57:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167857"
}
```



---

archive/issue_comments_136071.json:
```json
{
    "body": "<div id=\"comment:270\" align=\"right\">comment:270</div>\n\n[attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz) needs review.",
    "created_at": "2013-03-03T15:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136071",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:270" align="right">comment:270</div>

[attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz) needs review.



---

archive/issue_events_167858.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T15:58:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167858"
}
```



---

archive/issue_events_167859.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-03T15:58:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167859"
}
```



---

archive/issue_comments_136072.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-03-03T15:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136072",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_events_167860.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-03T20:23:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167860"
}
```



---

archive/issue_events_167861.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-03T20:23:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167861"
}
```



---

archive/issue_comments_136073.json:
```json
{
    "body": "<div id=\"comment:271\" align=\"right\">comment:271</div>\n\nReplying to [@jdemeyer](#comment%3A270):\n> [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz) needs review.\n\nIt looks fine to me, though I don't see why it's relevant to doctesting.",
    "created_at": "2013-03-03T20:23:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136073",
    "user": "https://github.com/roed314"
}
```

<div id="comment:271" align="right">comment:271</div>

Replying to [@jdemeyer](#comment%3A270):
> [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz) needs review.

It looks fine to me, though I don't see why it's relevant to doctesting.



---

archive/issue_comments_136074.json:
```json
{
    "body": "<div id=\"comment:272\" align=\"right\">comment:272</div>\n\nReplying to [@roed314](#comment%3A271):\n> I don't see why it's relevant to doctesting.\n\nMy patch adds `.rst` files (mainly because I wanted to use something else than `.py` files for a change).",
    "created_at": "2013-03-03T22:28:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136074",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:272" align="right">comment:272</div>

Replying to [@roed314](#comment%3A271):
> I don't see why it's relevant to doctesting.

My patch adds `.rst` files (mainly because I wanted to use something else than `.py` files for a change).



---

archive/issue_comments_136075.json:
```json
{
    "body": "<div id=\"comment:273\" align=\"right\">comment:273</div>\n\nFurther testing revealed some more subtle problems. I will simply extend the file [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz) until this ticket is ready to be merged.",
    "created_at": "2013-03-05T11:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136075",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:273" align="right">comment:273</div>

Further testing revealed some more subtle problems. I will simply extend the file [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz) until this ticket is ready to be merged.



---

archive/issue_comments_136076.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n http://code.google.com/p/sagemath-timer/\n \n-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)\n+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz), [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)\n \n **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo\n \n``````\n",
    "created_at": "2013-03-05T11:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136076",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 http://code.google.com/p/sagemath-timer/
 
-**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz)
+**Apply** [attachment: 12415_framework.patch](https://github.com/sagemath/sage/files/ticket12415/12415_framework.patch.gz), [attachment: 12415_doctest_fixes.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doctest_fixes.patch.gz), [attachment: 12415_doc.patch](https://github.com/sagemath/sage/files/ticket12415/12415_doc.patch.gz), [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz), [attachment: 12415_test.patch](https://github.com/sagemath/sage/files/ticket12415/12415_test.patch.gz), [attachment: 12415_review_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review_review.patch.gz), [attachment: 12415_review3.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review3.patch.gz), [attachment: 12415_manifest.patch](https://github.com/sagemath/sage/files/ticket12415/12415_manifest.patch.gz), [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)
 
 **Apply** [attachment: 12415_script.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script.patch.gz) and [attachment: 12415_script_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_script_review.patch.gz) to the scripts repo
 
``````




---

archive/issue_comments_136077.json:
```json
{
    "body": "<div id=\"comment:274\" align=\"right\">comment:274</div>\n\nReplying to [@jdemeyer](#comment%3A273):\n> Further testing revealed some more subtle problems. I will simply extend the file [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz) until this ticket is ready to be merged.\n\nOkay.  Let me know when you want me to review it.",
    "created_at": "2013-03-05T20:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136077",
    "user": "https://github.com/roed314"
}
```

<div id="comment:274" align="right">comment:274</div>

Replying to [@jdemeyer](#comment%3A273):
> Further testing revealed some more subtle problems. I will simply extend the file [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz) until this ticket is ready to be merged.

Okay.  Let me know when you want me to review it.



---

archive/issue_comments_136078.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605**",
    "created_at": "2013-03-06T07:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136078",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054** to **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605**



---

archive/issue_comments_136079.json:
```json
{
    "body": "<div id=\"comment:276\" align=\"right\">comment:276</div>\n\nWhile you were developing this, did you consider using Python's [DocTestFinder](http://docs.python.org/2/library/doctest.html#doctest.DocTestFinder) to extract docstrings from Python files? The current code here doesn't use `object.__doc__`, perhaps the Python doctest module does. I ask because #13605 added several classes with a dynamic `__doc__`.",
    "created_at": "2013-03-06T07:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136079",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:276" align="right">comment:276</div>

While you were developing this, did you consider using Python's [DocTestFinder](http://docs.python.org/2/library/doctest.html#doctest.DocTestFinder) to extract docstrings from Python files? The current code here doesn't use `object.__doc__`, perhaps the Python doctest module does. I ask because #13605 added several classes with a dynamic `__doc__`.



---

archive/issue_comments_136080.json:
```json
{
    "body": "Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111**",
    "created_at": "2013-03-06T10:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136080",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147,#13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111**



---

archive/issue_comments_136081.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.\n+Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.\n``````\n",
    "created_at": "2013-03-07T09:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136081",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.
+Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.
``````




---

archive/issue_comments_136082.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, 13897**",
    "created_at": "2013-03-07T23:01:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136082",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, 13897**



---

archive/issue_comments_136083.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, 13897** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111**",
    "created_at": "2013-03-07T23:12:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136083",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, 13897** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111**



---

archive/issue_comments_136084.json:
```json
{
    "body": "<div id=\"comment:281\" align=\"right\">comment:281</div>\n\nReplying to [@jdemeyer](#comment%3A276):\n> While you were developing this, did you consider using Python's [DocTestFinder](http://docs.python.org/2/library/doctest.html#doctest.DocTestFinder) to extract docstrings from Python files? The current code here doesn't use `object.__doc__`, perhaps the Python doctest module does. I ask because #13605 added several classes with a dynamic `__doc__`.\n\nI didn't, and it sounds like a good idea.  We can override it to deal with Cython classes if necessary.\n\nDo you think we should make this change on this ticket or a followup?  I won't be able to work on it much until next week (I'm still in Hawaii after Sage Days 46).",
    "created_at": "2013-03-08T07:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136084",
    "user": "https://github.com/roed314"
}
```

<div id="comment:281" align="right">comment:281</div>

Replying to [@jdemeyer](#comment%3A276):
> While you were developing this, did you consider using Python's [DocTestFinder](http://docs.python.org/2/library/doctest.html#doctest.DocTestFinder) to extract docstrings from Python files? The current code here doesn't use `object.__doc__`, perhaps the Python doctest module does. I ask because #13605 added several classes with a dynamic `__doc__`.

I didn't, and it sounds like a good idea.  We can override it to deal with Cython classes if necessary.

Do you think we should make this change on this ticket or a followup?  I won't be able to work on it much until next week (I'm still in Hawaii after Sage Days 46).



---

archive/issue_comments_136085.json:
```json
{
    "body": "<div id=\"comment:282\" align=\"right\">comment:282</div>\n\nReplying to [@roed314](#comment%3A281):\n> Do you think we should make this change on this ticket or a followup?\n\nNot on this ticket, it's already too big.",
    "created_at": "2013-03-10T22:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136085",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:282" align="right">comment:282</div>

Replying to [@roed314](#comment%3A281):
> Do you think we should make this change on this ticket or a followup?

Not on this ticket, it's already too big.



---

archive/issue_comments_136086.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254**",
    "created_at": "2013-03-11T09:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136086",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254**



---

archive/issue_comments_136087.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242**",
    "created_at": "2013-03-11T09:17:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136087",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242**



---

archive/issue_comments_136088.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253**",
    "created_at": "2013-03-11T09:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136088",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253**



---

archive/issue_comments_136089.json:
```json
{
    "body": "Attachment: **[12415_rebase_58.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)**",
    "created_at": "2013-03-13T09:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136089",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[12415_rebase_58.patch.gz](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz)**



---

archive/issue_comments_136090.json:
```json
{
    "body": "<div id=\"comment:286\" align=\"right\">comment:286</div>\n\nAll well on the buildbots. So please do the final review of [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz).",
    "created_at": "2013-03-14T08:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136090",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:286" align="right">comment:286</div>

All well on the buildbots. So please do the final review of [attachment: 12415_rebase_58.patch](https://github.com/sagemath/sage/files/ticket12415/12415_rebase_58.patch.gz).



---

archive/issue_events_167862.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T15:41:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167862"
}
```



---

archive/issue_events_167863.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T15:41:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167863"
}
```



---

archive/issue_events_167864.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T15:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167864"
}
```



---

archive/issue_events_167865.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T15:41:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167865"
}
```



---

archive/issue_comments_136091.json:
```json
{
    "body": "<div id=\"comment:289\" align=\"right\">comment:289</div>\n\nThe only thing I'm concerned about is\n\n```\nThere are 18 tests in sage/combinat/partition.py that are not being run\nThere are 12 tests in sage/combinat/tableau.py that are not being run\n```\n\nDo you know why that changed?",
    "created_at": "2013-03-14T17:19:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136091",
    "user": "https://github.com/roed314"
}
```

<div id="comment:289" align="right">comment:289</div>

The only thing I'm concerned about is

```
There are 18 tests in sage/combinat/partition.py that are not being run
There are 12 tests in sage/combinat/tableau.py that are not being run
```

Do you know why that changed?



---

archive/issue_comments_136092.json:
```json
{
    "body": "<div id=\"comment:290\" align=\"right\">comment:290</div>\n\nReplying to [@roed314](#comment%3A289):\n> Do you know why that changed?\n\nSee [comment:276]",
    "created_at": "2013-03-14T18:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136092",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:290" align="right">comment:290</div>

Replying to [@roed314](#comment%3A289):
> Do you know why that changed?

See [comment:276]



---

archive/issue_events_167866.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-14T20:09:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167866"
}
```



---

archive/issue_events_167867.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-14T20:09:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167867"
}
```



---

archive/issue_comments_136093.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.\n+Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281, #14272, #14273.\n``````\n",
    "created_at": "2013-03-14T20:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136093",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281.
+Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281, #14272, #14273.
``````




---

archive/issue_comments_136094.json:
```json
{
    "body": "<div id=\"comment:291\" align=\"right\">comment:291</div>\n\nReplying to [@jdemeyer](#comment%3A290):\n> Replying to [@roed314](#comment%3A289):\n> > Do you know why that changed?\n> \n> See [comment:276]\n\nAlright.  I've created #14272 to fix these doctests (which are currently not tested).  Otherwise I'm happy.",
    "created_at": "2013-03-14T20:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136094",
    "user": "https://github.com/roed314"
}
```

<div id="comment:291" align="right">comment:291</div>

Replying to [@jdemeyer](#comment%3A290):
> Replying to [@roed314](#comment%3A289):
> > Do you know why that changed?
> 
> See [comment:276]

Alright.  I've created #14272 to fix these doctests (which are currently not tested).  Otherwise I'm happy.



---

archive/issue_comments_136095.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281, #14272, #14273.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13278, #13610, #13063, #14152, #14153, #14203, #14272, #14273.\n``````\n",
    "created_at": "2013-03-14T21:43:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136095",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12720, #12722, #13610, #13063, #14152, #14153, #14203, #12281, #14272, #14273.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13278, #13610, #13063, #14152, #14153, #14203, #14272, #14273.
``````




---

archive/issue_comments_136096.json:
```json
{
    "body": "Merged: **sage-5.9.beta0**",
    "created_at": "2013-03-14T22:55:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136096",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.9.beta0**



---

archive/issue_events_167868.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T22:55:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167868"
}
```



---

archive/issue_events_167869.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-14T22:55:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167869"
}
```



---

archive/issue_comments_136097.json:
```json
{
    "body": "<div id=\"comment:294\" align=\"right\">comment:294</div>\n\nReplying to [@jdemeyer](#comment%3A293):\n\nYay!",
    "created_at": "2013-03-14T22:57:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136097",
    "user": "https://github.com/roed314"
}
```

<div id="comment:294" align="right">comment:294</div>

Replying to [@jdemeyer](#comment%3A293):

Yay!



---

archive/issue_comments_136098.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13278, #13610, #13063, #14152, #14153, #14203, #14272, #14273.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273.\n``````\n",
    "created_at": "2013-03-14T22:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136098",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13278, #13610, #13063, #14152, #14153, #14203, #14272, #14273.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273.
``````




---

archive/issue_comments_136099.json:
```json
{
    "body": "<div id=\"comment:296\" align=\"right\">comment:296</div>\n\nI'm working on #12281 and noticed that `sage -t --debug` doesn't work for me on OS X 10.6.8 (it starts the tests but then just hangs).  Strangely, the tests in `sage.doctest.forker.SageDocTestRunner.report_unexpected_exception` seem to succeed.  I haven't tried running tests in debug mode since Jeroen changed it in [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz); can anyone else duplicate this problem on another platform?",
    "created_at": "2013-03-14T23:24:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136099",
    "user": "https://github.com/roed314"
}
```

<div id="comment:296" align="right">comment:296</div>

I'm working on #12281 and noticed that `sage -t --debug` doesn't work for me on OS X 10.6.8 (it starts the tests but then just hangs).  Strangely, the tests in `sage.doctest.forker.SageDocTestRunner.report_unexpected_exception` seem to succeed.  I haven't tried running tests in debug mode since Jeroen changed it in [attachment: 12415_review.patch](https://github.com/sagemath/sage/files/ticket12415/12415_review.patch.gz); can anyone else duplicate this problem on another platform?



---

archive/issue_comments_136100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276.\n``````\n",
    "created_at": "2013-03-15T05:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136100",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276.
``````




---

archive/issue_comments_136101.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290.\n``````\n",
    "created_at": "2013-03-17T07:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136101",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290.
``````




---

archive/issue_comments_136102.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292.\n``````\n",
    "created_at": "2013-03-17T15:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136102",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292.
``````




---

archive/issue_comments_136103.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253, #14307**",
    "created_at": "2013-03-19T09:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136103",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253, #14307**



---

archive/issue_comments_136104.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307.\n``````\n",
    "created_at": "2013-03-19T10:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136104",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307.
``````




---

archive/issue_comments_136105.json:
```json
{
    "body": "Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253, #14307** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253**",
    "created_at": "2013-03-19T10:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136105",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253, #14307** to **#13147, #13146, #13145, #12723, #12392, #12393, #12395, #12396, #12397, #12381, #12382, #12383, #12384, #11871, #13195, #13121, #13748, #13899, #12719, #5155, #14070, #14079, #14150, #14158, #14182, #14184, #14054, #14063, #13605, #14111, #14254, #14242, #14253**



---

archive/issue_comments_136106.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327.\n``````\n",
    "created_at": "2013-03-21T09:30:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136106",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327.
``````




---

archive/issue_comments_136107.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328.\n``````\n",
    "created_at": "2013-03-21T14:12:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136107",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328.
``````




---

archive/issue_comments_136108.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359.\n``````\n",
    "created_at": "2013-03-26T19:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136108",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359.
``````




---

archive/issue_comments_136109.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369.\n``````\n",
    "created_at": "2013-03-27T17:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136109",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369.
``````




---

archive/issue_comments_136110.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14376.\n``````\n",
    "created_at": "2013-03-28T21:46:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136110",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14376.
``````




---

archive/issue_comments_136111.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14376.\n+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.\n``````\n",
    "created_at": "2013-03-28T22:09:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136111",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14376.
+Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.
``````




---

archive/issue_comments_136112.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.\n+Follow-up or other doctest-related tickets: #2235, #6357, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.\n``````\n",
    "created_at": "2013-03-28T22:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136112",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.
+Follow-up or other doctest-related tickets: #2235, #6357, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.
``````




---

archive/issue_comments_136113.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo\n \n-Follow-up or other doctest-related tickets: #2235, #6357, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.\n+For follow-up or other doctest-related tickets see #11337.\n``````\n",
    "created_at": "2013-03-28T22:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136113",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply** [attachment: 12415_spkg_bin_sage.patch](https://github.com/sagemath/sage/files/ticket12415/12415_spkg_bin_sage.patch.gz) to the root repo
 
-Follow-up or other doctest-related tickets: #2235, #6357, #12281, #12720, #12722, #13062, #13063, #13278, #13610, #14152, #14153, #14203, #14272, #14273, #14276, #14289, #14290, #14292, #14307, #14327, #14328, #14359, #14369, #14374, #14376.
+For follow-up or other doctest-related tickets see #11337.
``````




---

archive/issue_events_167870.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-28T22:50:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167870"
}
```



---

archive/issue_events_167871.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-28T22:50:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
    "label_color": "0000b0",
    "label_name": "c: doctest framework",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12415#event-167871"
}
```



---

archive/issue_comments_136114.json:
```json
{
    "body": "<div id=\"comment:311\" align=\"right\">comment:311</div>\n\nThis patch breaks the fixdoctests script. The problem is that the strings which sage-fixdoctests searches for in order to identify the line numbers have changed with the new output implemented in the current patch. \n\nI have just uploaded the patch #10589 which makes ```sage -fixdoctests``` work properly with the new doctest output (as stated on the ticket for #10589, the main point of this patch is to fix some different problems with fixdoctests). This patch also adds a test to sage/tests/cmdline.py for the fixdoctests script so that the doctest framework now has a chance of identifying patches which break it in future.",
    "created_at": "2013-05-02T03:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136114",
    "user": "https://github.com/AndrewAtLarge"
}
```

<div id="comment:311" align="right">comment:311</div>

This patch breaks the fixdoctests script. The problem is that the strings which sage-fixdoctests searches for in order to identify the line numbers have changed with the new output implemented in the current patch. 

I have just uploaded the patch #10589 which makes ```sage -fixdoctests``` work properly with the new doctest output (as stated on the ticket for #10589, the main point of this patch is to fix some different problems with fixdoctests). This patch also adds a test to sage/tests/cmdline.py for the fixdoctests script so that the doctest framework now has a chance of identifying patches which break it in future.



---

archive/issue_comments_136115.json:
```json
{
    "body": "<div id=\"comment:312\" align=\"right\">comment:312</div>\n\nNeither here nor on #14184 is there any public discussion of having removed `--only-optional`/`--only_optional`.  The [developer conventions](http://www.sagemath.org/doc/developer/conventions.html#further-conventions-for-automated-testing-of-examples) have a nice unified way of testing examples, but it was very useful to just skip the \"regular\" tests.  Did I miss a different place where this was disabled (and why? presumably technical)?",
    "created_at": "2013-06-14T15:13:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136115",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:312" align="right">comment:312</div>

Neither here nor on #14184 is there any public discussion of having removed `--only-optional`/`--only_optional`.  The [developer conventions](http://www.sagemath.org/doc/developer/conventions.html#further-conventions-for-automated-testing-of-examples) have a nice unified way of testing examples, but it was very useful to just skip the "regular" tests.  Did I miss a different place where this was disabled (and why? presumably technical)?



---

archive/issue_comments_136116.json:
```json
{
    "body": "<div id=\"comment:313\" align=\"right\">comment:313</div>\n\n`--only-optional` was replaced by `--optional`. The old documentation was very unclear about what `--optional` and `--only-optional` did, so we basically just implemented what we could understand.",
    "created_at": "2013-06-15T07:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12415#issuecomment-136116",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:313" align="right">comment:313</div>

`--only-optional` was replaced by `--optional`. The old documentation was very unclear about what `--optional` and `--only-optional` did, so we basically just implemented what we could understand.
