# Issue 12841: update M4RIE to newest upstream release

archive/issues_012669.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nM4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n\n**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg\n\n**Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)\n\nDepends on #12840\n\nComponent: **packages: standard**\n\nAuthor: **Martin Albrecht**\n\nReviewer: **Simon King, Jeroen Demeyer, Volker Braun**\n\nMerged: **sage-5.3.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12841_\n\n",
    "closed_at": "2012-08-01T12:10:53Z",
    "created_at": "2012-04-13T19:41:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update M4RIE to newest upstream release",
    "type": "issue",
    "updated_at": "2012-08-01T12:10:53Z",
    "url": "https://github.com/sagemath/sage/issues/12841",
    "user": "https://github.com/malb"
}
```
<div id="comment:0"></div>

M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.

**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg

**Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)

Depends on #12840

Component: **packages: standard**

Author: **Martin Albrecht**

Reviewer: **Simon King, Jeroen Demeyer, Volker Braun**

Merged: **sage-5.3.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/12841_





---

archive/issue_events_175467.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175467"
}
```



---

archive/issue_events_175468.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175468"
}
```



---

archive/issue_events_175469.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175469"
}
```



---

archive/issue_events_175470.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175470"
}
```



---

archive/issue_comments_144652.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n as the title says.\n+\n+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n+\n+**Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)\n``````\n",
    "created_at": "2012-04-13T19:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144652",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 as the title says.
+
+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
+
+**Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)
``````




---

archive/issue_comments_144653.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_12841_m4rie_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)**",
    "created_at": "2012-04-13T19:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144653",
    "user": "https://github.com/malb"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_12841_m4rie_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)**



---

archive/issue_comments_144654.json:
```json
{
    "body": "Dependencies: **#12840**",
    "created_at": "2012-04-13T20:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144654",
    "user": "https://github.com/malb"
}
```

Dependencies: **#12840**



---

archive/issue_comments_144655.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-as the title says.\n+M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n \n **Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n \n``````\n",
    "created_at": "2012-04-13T20:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144655",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-as the title says.
+M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.
 
 **Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
 
``````




---

archive/issue_events_175471.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T23:10:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175471"
}
```



---

archive/issue_comments_144656.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNote that the SPKG is based on #12821",
    "created_at": "2012-04-13T23:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144656",
    "user": "https://github.com/malb"
}
```

<div id="comment:5" align="right">comment:5</div>

Note that the SPKG is based on #12821



---

archive/issue_comments_144657.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI get an error with SAGE_CHECK on\n\n\n```\nFAIL: test_ple\n===================\n5 of 5 tests failed\n===================\nmake[4]: *** [check-TESTS] Error 1\nmake[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\nmake[3]: *** [check-am] Error 2\nmake[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\nmake[2]: *** [check-recursive] Error 1\nmake[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n```\n\nThis is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. \ngcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) \n\nI got this with the previous package as well. \n\nadam",
    "created_at": "2012-04-14T04:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144657",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:6" align="right">comment:6</div>

I get an error with SAGE_CHECK on


```
FAIL: test_ple
===================
5 of 5 tests failed
===================
make[4]: *** [check-TESTS] Error 1
make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
make[3]: *** [check-am] Error 2
make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
make[2]: *** [check-recursive] Error 1
make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
```

This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. 
gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) 

I got this with the previous package as well. 

adam



---

archive/issue_comments_144658.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@maxthemouse](#comment%3A6):\n> I get an error with SAGE_CHECK on\n> \n> \n> ```\n> FAIL: test_ple\n> ===================\n> 5 of 5 tests failed\n> ===================\n> make[4]: *** [check-TESTS] Error 1\n> make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> make[3]: *** [check-am] Error 2\n> make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> make[2]: *** [check-recursive] Error 1\n> make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> ```\n> \n> This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. \n> gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) \n> \n> I got this with the previous package as well. \n> \n> adam\n\nHi, unfortunately, that error message doesn't say much more than that there were errors. \n\n* The log should contain more detailed information, can you post this?\n* Also, by previous package you mean version 20111004?",
    "created_at": "2012-04-14T10:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144658",
    "user": "https://github.com/malb"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@maxthemouse](#comment%3A6):
> I get an error with SAGE_CHECK on
> 
> 
> ```
> FAIL: test_ple
> ===================
> 5 of 5 tests failed
> ===================
> make[4]: *** [check-TESTS] Error 1
> make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> make[3]: *** [check-am] Error 2
> make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> make[2]: *** [check-recursive] Error 1
> make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> ```
> 
> This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. 
> gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) 
> 
> I got this with the previous package as well. 
> 
> adam

Hi, unfortunately, that error message doesn't say much more than that there were errors. 

* The log should contain more detailed information, can you post this?
* Also, by previous package you mean version 20111004?



---

archive/issue_comments_144659.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nDo I just use the spkg above or do I need to apply the patch as well?\n\nI have tried with libm4rie-20111004.p2.spkg and libm4rie-20111004.p3.spkg and got the same error. The log doesn't have any details at all. The error occurs during the make  check-TESTS portion of the build. It just lists off a pile of tests and ends each section with things like  FAIL: test_trsm. The odd part is that there are no fail messages anywhere else.\n\nThe home directories are not yet present on sage.math.washinton.edu but once they are I will upload the log file.",
    "created_at": "2012-04-14T17:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144659",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:8" align="right">comment:8</div>

Do I just use the spkg above or do I need to apply the patch as well?

I have tried with libm4rie-20111004.p2.spkg and libm4rie-20111004.p3.spkg and got the same error. The log doesn't have any details at all. The error occurs during the make  check-TESTS portion of the build. It just lists off a pile of tests and ends each section with things like  FAIL: test_trsm. The odd part is that there are no fail messages anywhere else.

The home directories are not yet present on sage.math.washinton.edu but once they are I will upload the log file.



---

archive/issue_comments_144660.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI fixed the issue in https://bitbucket.org/malb/m4rie/changeset/81d352a8aade and replaced the SPKG with a version with this fix applied.",
    "created_at": "2012-04-14T20:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144660",
    "user": "https://github.com/malb"
}
```

<div id="comment:9" align="right">comment:9</div>

I fixed the issue in https://bitbucket.org/malb/m4rie/changeset/81d352a8aade and replaced the SPKG with a version with this fix applied.



---

archive/issue_comments_144661.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI tried again and got the same result. The log is at [http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log](http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log). I see anything useful in the log however.",
    "created_at": "2012-04-14T21:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144661",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:10" align="right">comment:10</div>

I tried again and got the same result. The log is at [http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log](http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log). I see anything useful in the log however.



---

archive/issue_comments_144662.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\ncorrection: I Don't see anything in the log that is useful. A.",
    "created_at": "2012-04-14T21:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144662",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:11" align="right">comment:11</div>

correction: I Don't see anything in the log that is useful. A.



---

archive/issue_comments_144663.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nArgh, that's because I uploaded the wrong file again. I fixed it and replaced the file.",
    "created_at": "2012-04-14T21:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144663",
    "user": "https://github.com/malb"
}
```

<div id="comment:12" align="right">comment:12</div>

Argh, that's because I uploaded the wrong file again. I fixed it and replaced the file.



---

archive/issue_comments_144664.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIt looks like it worked. At least it built. I now have a ppl problem but that might have already been reported.",
    "created_at": "2012-04-14T23:29:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144664",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:13" align="right">comment:13</div>

It looks like it worked. At least it built. I now have a ppl problem but that might have already been reported.



---

archive/issue_events_175472.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-15T13:48:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175472"
}
```



---

archive/issue_events_175473.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-15T13:48:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175473"
}
```



---

archive/issue_comments_144665.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.\n\n```\nMaking install in .\nmake[1]: Entering directory `/usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src'\n(CDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/sh /usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src/missing --run autoheader)\nrm -f src/stamp-h1\ntouch src/config.h.in\n```",
    "created_at": "2012-04-15T13:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144665",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.

```
Making install in .
make[1]: Entering directory `/usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src'
(CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh /usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src/missing --run autoheader)
rm -f src/stamp-h1
touch src/config.h.in
```



---

archive/issue_comments_144666.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThis is exactly the same problem which I already fixed once in #12501.",
    "created_at": "2012-04-15T13:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144666",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

This is exactly the same problem which I already fixed once in #12501.



---

archive/issue_comments_144667.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jdemeyer](#comment%3A14):\n> The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.\n\nUpstream does that: https://bitbucket.org/malb/m4ri-scripts/src/tip/release.py#cl-35 but I added a touch configure afterwards. I also touched configure in the SPKG linked above.",
    "created_at": "2012-04-15T14:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144667",
    "user": "https://github.com/malb"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jdemeyer](#comment%3A14):
> The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.

Upstream does that: https://bitbucket.org/malb/m4ri-scripts/src/tip/release.py#cl-35 but I added a touch configure afterwards. I also touched configure in the SPKG linked above.



---

archive/issue_comments_144668.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAre you sure you updated the spkg correctly?  I still get exactly the same problem as I reported before.",
    "created_at": "2012-04-17T22:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144668",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Are you sure you updated the spkg correctly?  I still get exactly the same problem as I reported before.



---

archive/issue_comments_144669.json:
```json
{
    "body": "Work Issues: **autoheader**",
    "created_at": "2012-04-17T22:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144669",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **autoheader**



---

archive/issue_comments_144670.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOn which box does this happen, I get on sage.math:\n\n```\n./sage-5.0.beta13-m4rie/sage -f ~/spkgs/libm4rie-20120415.spkg \nCalling sage-spkg on '/home/malb/spkgs/libm4rie-20120415.spkg'\nlibm4rie-20120415\n====================================================\nExtracting package /home/malb/spkgs/libm4rie-20120415.spkg\n-rw-r--r-- 1 malb malb 401369 2012-04-15 07:03 /home/malb/spkgs/libm4rie-20120415.spkg\nFinished extraction\n****************************************************\nHost system:\nLinux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/scratch/malb/sage-5.0.beta13-m4rie/local/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.6.3/lto-wrapper\nTarget: x86_64-unknown-linux-gnu\nConfigured with: ../src/configure --prefix=/scratch/malb/sage-5.0.beta13/local --with-local-prefix=/scratch/malb/sage-5.0.beta13/local --with-gmp=/scratch/malb/sage-5.0.beta13/local --with-mpfr=/scratch/malb/sage-5.0.beta13/local --with-mpc=/scratch/malb/sage-5.0.beta13/local --with-system-zlib --disable-multilib  \nThread model: posix\ngcc version 4.6.3 (GCC) \n****************************************************\nchecking build system type... x86_64-unknown-linux-gnu\n```",
    "created_at": "2012-04-18T10:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144670",
    "user": "https://github.com/malb"
}
```

<div id="comment:18" align="right">comment:18</div>

On which box does this happen, I get on sage.math:

```
./sage-5.0.beta13-m4rie/sage -f ~/spkgs/libm4rie-20120415.spkg 
Calling sage-spkg on '/home/malb/spkgs/libm4rie-20120415.spkg'
libm4rie-20120415
====================================================
Extracting package /home/malb/spkgs/libm4rie-20120415.spkg
-rw-r--r-- 1 malb malb 401369 2012-04-15 07:03 /home/malb/spkgs/libm4rie-20120415.spkg
Finished extraction
****************************************************
Host system:
Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/scratch/malb/sage-5.0.beta13-m4rie/local/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.6.3/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: ../src/configure --prefix=/scratch/malb/sage-5.0.beta13/local --with-local-prefix=/scratch/malb/sage-5.0.beta13/local --with-gmp=/scratch/malb/sage-5.0.beta13/local --with-mpfr=/scratch/malb/sage-5.0.beta13/local --with-mpc=/scratch/malb/sage-5.0.beta13/local --with-system-zlib --disable-multilib  
Thread model: posix
gcc version 4.6.3 (GCC) 
****************************************************
checking build system type... x86_64-unknown-linux-gnu
```



---

archive/issue_comments_144671.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThis was on boxen.math.  Anyway, the relevant file which should be touched is `config.h.in` (not `configure`)",
    "created_at": "2012-04-18T11:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144671",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

This was on boxen.math.  Anyway, the relevant file which should be touched is `config.h.in` (not `configure`)



---

archive/issue_comments_144672.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI've updated the SPKG accordingly and my release script (for future releases)",
    "created_at": "2012-04-18T11:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144672",
    "user": "https://github.com/malb"
}
```

<div id="comment:20" align="right">comment:20</div>

I've updated the SPKG accordingly and my release script (for future releases)



---

archive/issue_comments_144673.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@malb](#comment%3A20):\n> I've updated the SPKG accordingly and my release script (for future releases)\n\nDoes that mean the ticket needs review? Or still needs work?",
    "created_at": "2012-05-03T15:53:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144673",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@malb](#comment%3A20):
> I've updated the SPKG accordingly and my release script (for future releases)

Does that mean the ticket needs review? Or still needs work?



---

archive/issue_comments_144674.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThanks, it needs review",
    "created_at": "2012-05-03T16:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144674",
    "user": "https://github.com/malb"
}
```

<div id="comment:22" align="right">comment:22</div>

Thanks, it needs review



---

archive/issue_events_175474.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-03T16:13:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175474"
}
```



---

archive/issue_events_175475.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-03T16:13:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175475"
}
```



---

archive/issue_comments_144675.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThe ticket description mentions bug fixes. What are they?",
    "created_at": "2012-05-03T16:48:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144675",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:23" align="right">comment:23</div>

The ticket description mentions bug fixes. What are they?



---

archive/issue_comments_144676.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe bugfixes mainly concern the testsuite: https://bitbucket.org/malb/m4rie/changesets\n\n* !81d352a8aade reserve enough pointers for finite fields in testsuite\n* !8245cd046d86 removed a bit of dead code scan-build reported\n* !b81b9649e2d1 use unsigned ints for degrees everywhere\n* !ad8e309640e3 make sure the canary does not set bits which are expected to be zero (e.g. in lockup tables)\n* !f6f4b011dbe3 fixed a memleak\n* !dfacf106f205 bitmasks should be unsigned\n* !a3087ea586d7 fixed memleak in test_smallops\n* !02f7dfe20ff5 replaced nonstandard __STRING(x) with #x\n* !9d23a80fa589 remove -lntl, it's not needed\n* !f104847ecea0 using less temporary memory for Karatsuba for GF(2^4)\n* !bd90f880f4a8 saving memory in karatsuba multiplication\n* !548023a54d9e use rpath for test_* to make sure the right version of the library is used\n* !559610e11d7e unified strassen cutoff",
    "created_at": "2012-05-03T17:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144676",
    "user": "https://github.com/malb"
}
```

<div id="comment:24" align="right">comment:24</div>

The bugfixes mainly concern the testsuite: https://bitbucket.org/malb/m4rie/changesets

* !81d352a8aade reserve enough pointers for finite fields in testsuite
* !8245cd046d86 removed a bit of dead code scan-build reported
* !b81b9649e2d1 use unsigned ints for degrees everywhere
* !ad8e309640e3 make sure the canary does not set bits which are expected to be zero (e.g. in lockup tables)
* !f6f4b011dbe3 fixed a memleak
* !dfacf106f205 bitmasks should be unsigned
* !a3087ea586d7 fixed memleak in test_smallops
* !02f7dfe20ff5 replaced nonstandard __STRING(x) with #x
* !9d23a80fa589 remove -lntl, it's not needed
* !f104847ecea0 using less temporary memory for Karatsuba for GF(2^4)
* !bd90f880f4a8 saving memory in karatsuba multiplication
* !548023a54d9e use rpath for test_* to make sure the right version of the library is used
* !559610e11d7e unified strassen cutoff



---

archive/issue_comments_144677.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@malb](#comment%3A24):\n> The bugfixes mainly concern the testsuite:\n\nI didn't install the package with SAGE_CHECK=yes, but I guess I should... Anyway, the Sage test suite (make ptestlong) works.\n\nI tried to verify your claim that it became faster for exponents between 4 and 8. I tested 6. First, in vanilla sage-5.0.rc0:\n\n```\nsage: K.<z> = GF(2^6)\nsage: %time A = random_matrix(K,10000,10000)\nCPU times: user 1.63 s, sys: 0.06 s, total: 1.70 s\nWall time: 1.70 s\nsage: %time B = random_matrix(K,10000,10000)\nCPU times: user 1.53 s, sys: 0.04 s, total: 1.58 s\nWall time: 1.58 s\nsage: %time (A*B).rank()\nCPU times: user 85.03 s, sys: 0.12 s, total: 85.15 s\nWall time: 85.40 s\n10000\n```\nWith the new spkgs in sage-5.0.beta13:\n\n```\nsage: K.<z> = GF(2^6)\nsage: %time A = random_matrix(K,10000,10000)\nCPU times: user 1.77 s, sys: 0.07 s, total: 1.84 s\nWall time: 1.85 s\nsage: %time B = random_matrix(K,10000,10000)\nCPU times: user 1.76 s, sys: 0.03 s, total: 1.79 s\nWall time: 1.80 s\nsage: %time (A*B).rank()\nCPU times: user 37.38 s, sys: 0.23 s, total: 37.61 s\nWall time: 37.74 s\n10000\n```\n\nNow, that *is* faster for the \"real\" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?",
    "created_at": "2012-05-03T19:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144677",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@malb](#comment%3A24):
> The bugfixes mainly concern the testsuite:

I didn't install the package with SAGE_CHECK=yes, but I guess I should... Anyway, the Sage test suite (make ptestlong) works.

I tried to verify your claim that it became faster for exponents between 4 and 8. I tested 6. First, in vanilla sage-5.0.rc0:

```
sage: K.<z> = GF(2^6)
sage: %time A = random_matrix(K,10000,10000)
CPU times: user 1.63 s, sys: 0.06 s, total: 1.70 s
Wall time: 1.70 s
sage: %time B = random_matrix(K,10000,10000)
CPU times: user 1.53 s, sys: 0.04 s, total: 1.58 s
Wall time: 1.58 s
sage: %time (A*B).rank()
CPU times: user 85.03 s, sys: 0.12 s, total: 85.15 s
Wall time: 85.40 s
10000
```
With the new spkgs in sage-5.0.beta13:

```
sage: K.<z> = GF(2^6)
sage: %time A = random_matrix(K,10000,10000)
CPU times: user 1.77 s, sys: 0.07 s, total: 1.84 s
Wall time: 1.85 s
sage: %time B = random_matrix(K,10000,10000)
CPU times: user 1.76 s, sys: 0.03 s, total: 1.79 s
Wall time: 1.80 s
sage: %time (A*B).rank()
CPU times: user 37.38 s, sys: 0.23 s, total: 37.61 s
Wall time: 37.74 s
10000
```

Now, that *is* faster for the "real" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?



---

archive/issue_comments_144678.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@simon-king-jena](#comment%3A25):\n> Replying to [@malb](#comment%3A24):\n> > The bugfixes mainly concern the testsuite:\n> \n> \n> I didn't install the package with SAGE_CHECK=yes, but I guess I should... \n\nI did, and the self-tests pass.",
    "created_at": "2012-05-03T19:42:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144678",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@simon-king-jena](#comment%3A25):
> Replying to [@malb](#comment%3A24):
> > The bugfixes mainly concern the testsuite:
> 
> 
> I didn't install the package with SAGE_CHECK=yes, but I guess I should... 

I did, and the self-tests pass.



---

archive/issue_comments_144679.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@simon-king-jena](#comment%3A25):\n> Now, that *is* faster for the \"real\" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?\n\nI don't recall that anything changed in random matrix creation, so I'd assume it's down to margin of error.",
    "created_at": "2012-05-03T20:39:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144679",
    "user": "https://github.com/malb"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@simon-king-jena](#comment%3A25):
> Now, that *is* faster for the "real" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?

I don't recall that anything changed in random matrix creation, so I'd assume it's down to margin of error.



---

archive/issue_comments_144680.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI get\n\n```\nking@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg status\nM spkg-install\nking@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg diff\ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -26,7 +26,7 @@\n CPPFLAGS=\"$INCLUDES\"\n \n if [ \"x$SAGE_DEBUG\" = \"xyes\" ]; then\n-   CFLAGS=\"-O0 $CFLAGS\"\n+   CFLAGS=\"$CFLAGS -O0\"\n    ENABLE_DEBUG=\"--enable-debug\"\n else\n    CFLAGS=\"-O2 $CFLAGS\"\n```\n\nSo, please update the package by checking in the changes!\n\nApart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?",
    "created_at": "2012-05-04T11:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144680",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:28" align="right">comment:28</div>

I get

```
king@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg status
M spkg-install
king@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -26,7 +26,7 @@
 CPPFLAGS="$INCLUDES"
 
 if [ "x$SAGE_DEBUG" = "xyes" ]; then
-   CFLAGS="-O0 $CFLAGS"
+   CFLAGS="$CFLAGS -O0"
    ENABLE_DEBUG="--enable-debug"
 else
    CFLAGS="-O2 $CFLAGS"
```

So, please update the package by checking in the changes!

Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?



---

archive/issue_comments_144681.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nWhoops, yeah, I left those uncommitted because there was a bit of discussion whether we should have this or not, i.e., should SAGE_DEBUG overwrite the optimisation level you specify in in CFLAGS. I'm inclined that it shouldn't so I will revert this change.",
    "created_at": "2012-05-04T16:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144681",
    "user": "https://github.com/malb"
}
```

<div id="comment:29" align="right">comment:29</div>

Whoops, yeah, I left those uncommitted because there was a bit of discussion whether we should have this or not, i.e., should SAGE_DEBUG overwrite the optimisation level you specify in in CFLAGS. I'm inclined that it shouldn't so I will revert this change.



---

archive/issue_comments_144682.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHi, I updated the SPKG accordingly.",
    "created_at": "2012-05-05T15:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144682",
    "user": "https://github.com/malb"
}
```

<div id="comment:30" align="right">comment:30</div>

Hi, I updated the SPKG accordingly.



---

archive/issue_comments_144683.json:
```json
{
    "body": "Changed work issues from **autoheader** to none",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144683",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **autoheader** to none



---

archive/issue_comments_144684.json:
```json
{
    "body": "Reviewer: **Simon King, Jeroen Demeyer**",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144684",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Simon King, Jeroen Demeyer**



---

archive/issue_comments_144685.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@simon-king-jena](#comment%3A28):\n> Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?\n\nYes, it does.\n\nI also agree with leaving the `-O0` as it is.",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144685",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@simon-king-jena](#comment%3A28):
> Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?

Yes, it does.

I also agree with leaving the `-O0` as it is.



---

archive/issue_comments_144686.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n \n-**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg\n \n **Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)\n``````\n",
    "created_at": "2012-06-07T16:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144686",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.
 
-**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg
 
 **Apply:** [attachment: trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)
``````




---

archive/issue_comments_144687.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI looked at it with #12840 and looks good to me. Lets get this boat off the ground ;-)",
    "created_at": "2012-06-18T10:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144687",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

I looked at it with #12840 and looks good to me. Lets get this boat off the ground ;-)



---

archive/issue_events_175476.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:59:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175476"
}
```



---

archive/issue_events_175477.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175477"
}
```



---

archive/issue_comments_144688.json:
```json
{
    "body": "Changed reviewer from **Simon King, Jeroen Demeyer** to **Simon King, Jeroen Demeyer, Volker Braun**",
    "created_at": "2012-06-18T10:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144688",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Simon King, Jeroen Demeyer** to **Simon King, Jeroen Demeyer, Volker Braun**



---

archive/issue_events_175478.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175478"
}
```



---

archive/issue_events_175479.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175479"
}
```



---

archive/issue_events_175480.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-21T14:23:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175480"
}
```



---

archive/issue_events_175481.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-21T14:23:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175481"
}
```



---

archive/issue_comments_144689.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI tried to compile this on mark (sparc solaris) and it dies at \n\n```\ng++ -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include   -I/include -I/include   -MT test_trsm-test_trsm.o -MD -MP -MF .deps/test_trsm-test_trsm.Tpo -c -o test_trsm-test_trsm.o `test -f 'tests/test_trsm.cc' || echo './'`tests/test_trsm.cc\nmv -f .deps/test_trsm-test_trsm.Tpo .deps/test_trsm-test_trsm.Po\n/bin/bash ./libtool --tag=CXX   --mode=link g++    -I/include   -I/include -I/include   -Wl,-rpath,.libs/ -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -o test_trsm test_trsm-test_trsm.o -L/lib -lm4ri -lm4rie -lgivaro -lgmpxx -lgmp -lm -lstdc++ \nlibtool: link: g++ -I/include -I/include -I/include -Wl,-rpath -Wl,.libs/ -o .libs/test_trsm test_trsm-test_trsm.o  -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -L/lib /home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src/.libs/libm4rie.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libm4ri.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libpng12.so -lz /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgivaro.so -L/home/vbraun/opt/mark/sage-5.1.beta3/local//lib /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmpxx.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmp.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libstdc++.so -lm -Wl,-R -Wl,/home/vbraun/opt/mark/sage-5.1.beta3/local/lib\nld: fatal: option -dn and -P are incompatible\nld: fatal: Flags processing errors\ncollect2: ld returned 1 exit status\nmake[2]: *** [test_trsm] Error 1\nmake[2]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake[1]: *** [check-am] Error 2\nmake[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake: *** [check-recursive] Error 1\n```\nOnly more sophisticated linkers understand `-rpath`, its better to use `-R`. Though you shouldn't have to manually set rpaths in `libm4rie-20120613/src/bench/Makefile.am` at all, the whole autotools/libtools machinery should do that for you.",
    "created_at": "2012-06-21T14:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144689",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">comment:35</div>

I tried to compile this on mark (sparc solaris) and it dies at 

```
g++ -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include   -I/include -I/include   -MT test_trsm-test_trsm.o -MD -MP -MF .deps/test_trsm-test_trsm.Tpo -c -o test_trsm-test_trsm.o `test -f 'tests/test_trsm.cc' || echo './'`tests/test_trsm.cc
mv -f .deps/test_trsm-test_trsm.Tpo .deps/test_trsm-test_trsm.Po
/bin/bash ./libtool --tag=CXX   --mode=link g++    -I/include   -I/include -I/include   -Wl,-rpath,.libs/ -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -o test_trsm test_trsm-test_trsm.o -L/lib -lm4ri -lm4rie -lgivaro -lgmpxx -lgmp -lm -lstdc++ 
libtool: link: g++ -I/include -I/include -I/include -Wl,-rpath -Wl,.libs/ -o .libs/test_trsm test_trsm-test_trsm.o  -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -L/lib /home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src/.libs/libm4rie.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libm4ri.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libpng12.so -lz /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgivaro.so -L/home/vbraun/opt/mark/sage-5.1.beta3/local//lib /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmpxx.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmp.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libstdc++.so -lm -Wl,-R -Wl,/home/vbraun/opt/mark/sage-5.1.beta3/local/lib
ld: fatal: option -dn and -P are incompatible
ld: fatal: Flags processing errors
collect2: ld returned 1 exit status
make[2]: *** [test_trsm] Error 1
make[2]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make[1]: *** [check-am] Error 2
make[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make: *** [check-recursive] Error 1
```
Only more sophisticated linkers understand `-rpath`, its better to use `-R`. Though you shouldn't have to manually set rpaths in `libm4rie-20120613/src/bench/Makefile.am` at all, the whole autotools/libtools machinery should do that for you.



---

archive/issue_comments_144690.json:
```json
{
    "body": "Work Issues: **solaris**",
    "created_at": "2012-06-21T14:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144690",
    "user": "https://github.com/vbraun"
}
```

Work Issues: **solaris**



---

archive/issue_events_175482.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-06-21T15:33:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175482"
}
```



---

archive/issue_events_175483.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-06-21T15:33:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175483"
}
```



---

archive/issue_comments_144691.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nOkay, I dropped it from Makefile.am and replaced the SPKG at the same address.\n\n(It is still used in my benchmarking code of M4RIE but that isn't built by Sage.)",
    "created_at": "2012-06-21T15:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144691",
    "user": "https://github.com/malb"
}
```

<div id="comment:36" align="right">comment:36</div>

Okay, I dropped it from Makefile.am and replaced the SPKG at the same address.

(It is still used in my benchmarking code of M4RIE but that isn't built by Sage.)



---

archive/issue_comments_144692.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nStill dying on mark/skynet, though now at a different place:\n\n```\n/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c -o gf2e.lo `test -f 'src/gf2e.c' || echo './'`src/gf2e.c\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c  -fPIC -DPIC -o .libs/gf2e.o\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c -o gf2e.o >/dev/null 2>&1\nmv -f .deps/gf2e.Tpo .deps/gf2e.Plo\n/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c -o mzed.lo `test -f 'src/mzed.c' || echo './'`src/mzed.c\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c src/mzed.c  -fPIC -DPIC -o .libs/mzed.o\nIn file included from src/mzed.c:23:0:\nsrc/mzed.h:50:24: fatal error: m4rie/gf2e.h: No such file or directory\ncompilation terminated.\nmake[1]: *** [mzed.lo] Error 1\nmake[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake: *** [all-recursive] Error 1\nError building libm4rie\n```",
    "created_at": "2012-06-21T15:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144692",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:37" align="right">comment:37</div>

Still dying on mark/skynet, though now at a different place:

```
/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c -o gf2e.lo `test -f 'src/gf2e.c' || echo './'`src/gf2e.c
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c  -fPIC -DPIC -o .libs/gf2e.o
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c -o gf2e.o >/dev/null 2>&1
mv -f .deps/gf2e.Tpo .deps/gf2e.Plo
/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c -o mzed.lo `test -f 'src/mzed.c' || echo './'`src/mzed.c
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c src/mzed.c  -fPIC -DPIC -o .libs/mzed.o
In file included from src/mzed.c:23:0:
src/mzed.h:50:24: fatal error: m4rie/gf2e.h: No such file or directory
compilation terminated.
make[1]: *** [mzed.lo] Error 1
make[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make: *** [all-recursive] Error 1
Error building libm4rie
```



---

archive/issue_comments_144693.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nUpdated spkg builds on mark/skynet. Now doctesting...",
    "created_at": "2012-06-21T18:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144693",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">comment:38</div>

Updated spkg builds on mark/skynet. Now doctesting...



---

archive/issue_comments_144694.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI keep getting bus errors (aka segfaults) on mark/skynet with pickling of `matrix_modn_dense_double` matrices. The `_pickle` method uses `mod_int` and not `celement`, I'm totally confused about that. Note that on mark/skynet:\n\n```\nsage: cython('def f():\\n    return (sizeof(double), sizeof(unsigned long))\\n')\nsage: f()\n(8, 4)\n```\nThis might not be the fault of your patch, but its hard to un-apply the spkgs.",
    "created_at": "2012-06-21T19:23:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144694",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">comment:39</div>

I keep getting bus errors (aka segfaults) on mark/skynet with pickling of `matrix_modn_dense_double` matrices. The `_pickle` method uses `mod_int` and not `celement`, I'm totally confused about that. Note that on mark/skynet:

```
sage: cython('def f():\n    return (sizeof(double), sizeof(unsigned long))\n')
sage: f()
(8, 4)
```
This might not be the fault of your patch, but its hard to un-apply the spkgs.



---

archive/issue_comments_144695.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThe release buildbot shows these bus errors, too:\n\nhttp://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/181/steps/shell_7/logs/stdio",
    "created_at": "2012-06-21T19:28:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144695",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:40" align="right">comment:40</div>

The release buildbot shows these bus errors, too:

http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/181/steps/shell_7/logs/stdio



---

archive/issue_comments_144696.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThis is with only M4RI/M4RIE applied, not the LinBox update, right?\n\nThe elements in `Matrix_modn_double` should fit into a `mod_int` since they are < 2<sup>23</sup>. Hence, we simply used the same pickling format as the old `Matrix_modn_dense`.",
    "created_at": "2012-06-21T19:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144696",
    "user": "https://github.com/malb"
}
```

<div id="comment:41" align="right">comment:41</div>

This is with only M4RI/M4RIE applied, not the LinBox update, right?

The elements in `Matrix_modn_double` should fit into a `mod_int` since they are < 2<sup>23</sup>. Hence, we simply used the same pickling format as the old `Matrix_modn_dense`.



---

archive/issue_comments_144697.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nYes, just with M4RI/M4RIE. The buildbot failure I linked to is even without the M4RI/M4RIE update.",
    "created_at": "2012-06-21T19:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144697",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:42" align="right">comment:42</div>

Yes, just with M4RI/M4RIE. The buildbot failure I linked to is even without the M4RI/M4RIE update.



---

archive/issue_comments_144698.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nFrom http://docs.oracle.com/cd/E19957-01/806-3568/ncg_math.html about the double bit format:\n\nIn the SPARC architecture, the higher address 32-bit word contains the least significant 32 bits of the fraction, while in the x86 architecture the lower address 32-bit word contains the least significant 32 bits of the fraction.",
    "created_at": "2012-06-21T19:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144698",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:43" align="right">comment:43</div>

From http://docs.oracle.com/cd/E19957-01/806-3568/ncg_math.html about the double bit format:

In the SPARC architecture, the higher address 32-bit word contains the least significant 32 bits of the fraction, while in the x86 architecture the lower address 32-bit word contains the least significant 32 bits of the fraction.



---

archive/issue_comments_144699.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nBut we're doing a cast, shouldn't that take care of it?",
    "created_at": "2012-06-21T20:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144699",
    "user": "https://github.com/malb"
}
```

<div id="comment:44" align="right">comment:44</div>

But we're doing a cast, shouldn't that take care of it?



---

archive/issue_comments_144700.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@malb](#comment%3A44):\n> But we're doing a cast, shouldn't that take care of it?\n\nWhat lines of code are you talking about?  The problem might be alignment, i.e. doubles should be aligned on a multiple of 8 bytes.",
    "created_at": "2012-06-21T20:06:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144700",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@malb](#comment%3A44):
> But we're doing a cast, shouldn't that take care of it?

What lines of code are you talking about?  The problem might be alignment, i.e. doubles should be aligned on a multiple of 8 bytes.



---

archive/issue_comments_144701.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI mean this:\n\nhttp://hg.sagemath.org/sage-main/file/01e0779db321/sage/matrix/matrix_modn_dense_template.pxi#l650\n\nBut perhaps we should wait until we've run this through a gdb before we speculate which lines fail? :)",
    "created_at": "2012-06-21T20:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144701",
    "user": "https://github.com/malb"
}
```

<div id="comment:46" align="right">comment:46</div>

I mean this:

http://hg.sagemath.org/sage-main/file/01e0779db321/sage/matrix/matrix_modn_dense_template.pxi#l650

But perhaps we should wait until we've run this through a gdb before we speculate which lines fail? :)



---

archive/issue_comments_144702.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nWhat are the `mod_int` and `celement` types and where do `double`s come in?",
    "created_at": "2012-06-21T20:19:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144702",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:48" align="right">comment:48</div>

What are the `mod_int` and `celement` types and where do `double`s come in?



---

archive/issue_comments_144703.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\ngdb isn't installed on mark. the only debugger is mdb and I have no idea how to use it.\nBut the bus error is at the i=j=0 assignment (using print) in _pickle.\n\nI thought \nmod_int = long int and celement = double (in matrix_modn_dense_double)\n\nThe cast to mod_int is working correctly, though.",
    "created_at": "2012-06-21T20:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144703",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:49" align="right">comment:49</div>

gdb isn't installed on mark. the only debugger is mdb and I have no idea how to use it.
But the bus error is at the i=j=0 assignment (using print) in _pickle.

I thought 
mod_int = long int and celement = double (in matrix_modn_dense_double)

The cast to mod_int is working correctly, though.



---

archive/issue_comments_144704.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nFor the record, matrix_modn_dense_template.pxi with some extra prints:\n\n```\n        else:\n            print 'word_size != sizeof(char)', word_size, <int><char*>s\n            um = <mod_int*><char *>s\n            for i in range(self._nrows):\n                row_self = self._matrix[i]\n                row_um = &um[i*self._ncols]\n                for j in range(self._ncols):\n                    print i, j, row_self[j], <mod_int>row_self[j], self._ncols, self._nrows, <int>row_um\n                    row_um[j] = <mod_int>row_self[j]\n                    print \"crash\"\n```\nyields\n\n```\nsage: random_matrix(ZZ.quo(123456), 10,10)._pickle()\nword_size != sizeof(char) 8 68071796\n0 0 60348.0 60348 10 10 68071796\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/vbraun/opt/mark/sage-5.1.beta3/devel/sage-main/<ipython console> in <module>()\n\n/home/vbraun/opt/mark/sage-5.1.beta3/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_double.so in sage.matrix.matrix_modn_dense_double.Matrix_modn_dense_template._pickle (sage/matrix/matrix_modn_dense_double.cpp:6537)()\n\nRuntimeError: Bus error\n```",
    "created_at": "2012-06-21T20:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144704",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">comment:50</div>

For the record, matrix_modn_dense_template.pxi with some extra prints:

```
        else:
            print 'word_size != sizeof(char)', word_size, <int><char*>s
            um = <mod_int*><char *>s
            for i in range(self._nrows):
                row_self = self._matrix[i]
                row_um = &um[i*self._ncols]
                for j in range(self._ncols):
                    print i, j, row_self[j], <mod_int>row_self[j], self._ncols, self._nrows, <int>row_um
                    row_um[j] = <mod_int>row_self[j]
                    print "crash"
```
yields

```
sage: random_matrix(ZZ.quo(123456), 10,10)._pickle()
word_size != sizeof(char) 8 68071796
0 0 60348.0 60348 10 10 68071796
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/vbraun/opt/mark/sage-5.1.beta3/devel/sage-main/<ipython console> in <module>()

/home/vbraun/opt/mark/sage-5.1.beta3/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_double.so in sage.matrix.matrix_modn_dense_double.Matrix_modn_dense_template._pickle (sage/matrix/matrix_modn_dense_double.cpp:6537)()

RuntimeError: Bus error
```



---

archive/issue_comments_144705.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nJeroen was right, its an alignment thing. The output of `PyString_FromStringAndSize` is 4 but not 8-byte aligned. By faking it\n\n```\n            um = <mod_int*>((<char *>s)+4)\n```\nI avoided the crash.",
    "created_at": "2012-06-21T20:47:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144705",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:51" align="right">comment:51</div>

Jeroen was right, its an alignment thing. The output of `PyString_FromStringAndSize` is 4 but not 8-byte aligned. By faking it

```
            um = <mod_int*>((<char *>s)+4)
```
I avoided the crash.



---

archive/issue_comments_144706.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nBut it seems it's not double alignment? By the time it hits unaligned memory it's already a `mod_int == long`.",
    "created_at": "2012-06-21T21:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144706",
    "user": "https://github.com/malb"
}
```

<div id="comment:52" align="right">comment:52</div>

But it seems it's not double alignment? By the time it hits unaligned memory it's already a `mod_int == long`.



---

archive/issue_comments_144707.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nBut note that `wordsize` == `sizeof(mod_int)` == 8 according to Volker's `print` statement.",
    "created_at": "2012-06-22T06:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144707",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

But note that `wordsize` == `sizeof(mod_int)` == 8 according to Volker's `print` statement.



---

archive/issue_comments_144708.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nThe problem is that `sage/ext/multi_modular.h` defines\n\n```\n#define mod_int uint_fast64_t\n```\n\nSo, `mod_int` is actually `uint_fast64_t`.",
    "created_at": "2012-06-22T07:05:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144708",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">comment:54</div>

The problem is that `sage/ext/multi_modular.h` defines

```
#define mod_int uint_fast64_t
```

So, `mod_int` is actually `uint_fast64_t`.



---

archive/issue_comments_144709.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThe file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?",
    "created_at": "2012-06-22T07:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144709",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?



---

archive/issue_comments_144710.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nNote that the conflicting types might not even a problem, as Cython doesn't really care much about types.  The definition\n\n```\nctypedef unsigned long mod_int\n```\nmostly just makes Cython aware that `mod_int` is some (integer?) type, the actual type doesn't really matter as far as I know.",
    "created_at": "2012-06-22T07:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144710",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Note that the conflicting types might not even a problem, as Cython doesn't really care much about types.  The definition

```
ctypedef unsigned long mod_int
```
mostly just makes Cython aware that `mod_int` is some (integer?) type, the actual type doesn't really matter as far as I know.



---

archive/issue_comments_144711.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@jdemeyer](#comment%3A55):\n> The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?\n\nFWIW: I made a similar experience on Solaris with my MeatAxe wrapper (and, if I remember correctly, the same problem has shown up a while ago when trying to use Singular options in !libSingular). Namely, MeatAxe uses a function mulmat (or matmul? Doesn't matter...), but apparently a function of the same name is defined in some other spkg as well. And apparently the Solaris linker was confusing the two mulmats, even though they belong to totally different packages! In particular, MeatAxe does not link against the other package.\n\nThe simple solution was to rename MeatAxe's mulmat into _mulmat.\nSo, renaming mod_int into something else would be worth a try.",
    "created_at": "2012-06-22T07:22:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144711",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@jdemeyer](#comment%3A55):
> The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?

FWIW: I made a similar experience on Solaris with my MeatAxe wrapper (and, if I remember correctly, the same problem has shown up a while ago when trying to use Singular options in !libSingular). Namely, MeatAxe uses a function mulmat (or matmul? Doesn't matter...), but apparently a function of the same name is defined in some other spkg as well. And apparently the Solaris linker was confusing the two mulmats, even though they belong to totally different packages! In particular, MeatAxe does not link against the other package.

The simple solution was to rename MeatAxe's mulmat into _mulmat.
So, renaming mod_int into something else would be worth a try.



---

archive/issue_comments_144712.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nPerhaps 64-bit integers need to be 8-byte aligned as well? Also, I guess \n\n  ```\n  ctypedef unsigned long mod_int\n  ```\n\nshould be replaced by the correct typedef, to make it less confusing. In any case, I opened a new ticket at #13151 since this is not M4RIE releated.",
    "created_at": "2012-06-22T09:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144712",
    "user": "https://github.com/malb"
}
```

<div id="comment:58" align="right">comment:58</div>

Perhaps 64-bit integers need to be 8-byte aligned as well? Also, I guess 

  ```
  ctypedef unsigned long mod_int
  ```

should be replaced by the correct typedef, to make it less confusing. In any case, I opened a new ticket at #13151 since this is not M4RIE releated.



---

archive/issue_comments_144713.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThe cast is defined at compile-time, not at link-time. To summarize, the problem really is that malloc on Solaris only returns 32-bit aligned memory. \n\nSimon: There is only a single flat namespace on Linux and Solaris, so if any shared library imports conflicting symbols then its just luck to get the right one.",
    "created_at": "2012-06-22T10:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144713",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:59" align="right">comment:59</div>

The cast is defined at compile-time, not at link-time. To summarize, the problem really is that malloc on Solaris only returns 32-bit aligned memory. 

Simon: There is only a single flat namespace on Linux and Solaris, so if any shared library imports conflicting symbols then its just luck to get the right one.



---

archive/issue_comments_144714.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nOther doctests pass, so lets give this a go.",
    "created_at": "2012-06-22T11:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144714",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:60" align="right">comment:60</div>

Other doctests pass, so lets give this a go.



---

archive/issue_events_175484.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-22T11:42:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175484"
}
```



---

archive/issue_events_175485.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-22T11:42:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175485"
}
```



---

archive/issue_comments_144715.json:
```json
{
    "body": "Changed work issues from **solaris** to none",
    "created_at": "2012-07-01T18:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144715",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **solaris** to none



---

archive/issue_events_175486.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175486"
}
```



---

archive/issue_events_175487.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175487"
}
```



---

archive/issue_events_175488.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175488"
}
```



---

archive/issue_events_175489.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175489"
}
```



---

archive/issue_events_175490.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175490"
}
```



---

archive/issue_events_175491.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175491"
}
```



---

archive/issue_events_175492.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-31T06:39:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175492"
}
```



---

archive/issue_events_175493.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-31T06:39:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175493"
}
```



---

archive/issue_comments_144716.json:
```json
{
    "body": "Merged: **sage-5.3.beta0**",
    "created_at": "2012-08-01T12:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-144716",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.3.beta0**



---

archive/issue_events_175494.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175494"
}
```



---

archive/issue_events_175495.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-175495"
}
```
