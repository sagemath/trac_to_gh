# Issue 12841: update M4RIE to newest upstream release

archive/issues_012669.json:
```json
{
    "assignees": [],
    "body": "M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n\n**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg\n\n**Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)\n\nDepends on #12840\n\n**Reviewer:** Simon King, Jeroen Demeyer, Volker Braun\n\n**Author:** Martin Albrecht\n\n**Merged:** sage-5.3.beta0\n\nIssue created by migration from https://trac.sagemath.org/ticket/12841\n\n",
    "closed_at": "2012-08-01T12:10:53Z",
    "created_at": "2012-04-13T19:41:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update M4RIE to newest upstream release",
    "type": "issue",
    "updated_at": "2012-08-01T12:10:53Z",
    "url": "https://github.com/sagemath/sage/issues/12841",
    "user": "https://github.com/malb"
}
```
M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.

**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg

**Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)

Depends on #12840

**Reviewer:** Simon King, Jeroen Demeyer, Volker Braun

**Author:** Martin Albrecht

**Merged:** sage-5.3.beta0

Issue created by migration from https://trac.sagemath.org/ticket/12841





---

archive/issue_events_149855.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149855"
}
```



---

archive/issue_events_149856.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "08517b",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149856"
}
```



---

archive/issue_events_149857.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T19:41:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149857"
}
```



---

archive/issue_comments_146955.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n as the title says.\n+\n+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n+\n+**Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)\n``````\n",
    "created_at": "2012-04-13T19:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146955",
    "user": "https://github.com/malb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 as the title says.
+
+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
+
+**Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)
``````




---

archive/issue_comments_146956.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\n**Attachment:** [trac_12841_m4rie_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)",
    "created_at": "2012-04-13T19:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146956",
    "user": "https://github.com/malb"
}
```

<a id='comment:1'>**Comment 1:**</a>
**Attachment:** [trac_12841_m4rie_new_version.patch.gz](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch.gz)



---

archive/issue_comments_146957.json:
```json
{
    "body": "**Dependencies:** #12840",
    "created_at": "2012-04-13T20:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146957",
    "user": "https://github.com/malb"
}
```

**Dependencies:** #12840



---

archive/issue_comments_146958.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-as the title says.\n+M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n \n **Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n \n``````\n",
    "created_at": "2012-04-13T20:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146958",
    "user": "https://github.com/malb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-as the title says.
+M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.
 
 **Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
 
``````




---

archive/issue_events_149858.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-04-13T23:10:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149858"
}
```



---

archive/issue_comments_146959.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nNote that the SPKG is based on #12821",
    "created_at": "2012-04-13T23:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146959",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'>**Comment 5:**</a>
Note that the SPKG is based on #12821



---

archive/issue_comments_146960.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nI get an error with SAGE_CHECK on\n\n\n```\nFAIL: test_ple\n===================\n5 of 5 tests failed\n===================\nmake[4]: *** [check-TESTS] Error 1\nmake[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\nmake[3]: *** [check-am] Error 2\nmake[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\nmake[2]: *** [check-recursive] Error 1\nmake[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n```\n\nThis is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. \ngcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) \n\nI got this with the previous package as well. \n\nadam",
    "created_at": "2012-04-14T04:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146960",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:6'>**Comment 6:**</a>
I get an error with SAGE_CHECK on


```
FAIL: test_ple
===================
5 of 5 tests failed
===================
make[4]: *** [check-TESTS] Error 1
make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
make[3]: *** [check-am] Error 2
make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
make[2]: *** [check-recursive] Error 1
make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
```

This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. 
gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) 

I got this with the previous package as well. 

adam



---

archive/issue_comments_146961.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nReplying to [@maxthemouse](#comment%3A6):\n> I get an error with SAGE_CHECK on\n> \n> \n> ```\n> FAIL: test_ple\n> ===================\n> 5 of 5 tests failed\n> ===================\n> make[4]: *** [check-TESTS] Error 1\n> make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> make[3]: *** [check-am] Error 2\n> make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> make[2]: *** [check-recursive] Error 1\n> make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'\n> ```\n> \n> This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. \n> gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) \n> \n> I got this with the previous package as well. \n> \n> adam\n\nHi, unfortunately, that error message doesn't say much more than that there were errors. \n\n* The log should contain more detailed information, can you post this?\n* Also, by previous package you mean version 20111004?",
    "created_at": "2012-04-14T10:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146961",
    "user": "https://github.com/malb"
}
```

<a id='comment:7'>**Comment 7:**</a>
Replying to [@maxthemouse](#comment%3A6):
> I get an error with SAGE_CHECK on
> 
> 
> ```
> FAIL: test_ple
> ===================
> 5 of 5 tests failed
> ===================
> make[4]: *** [check-TESTS] Error 1
> make[4]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> make[3]: *** [check-am] Error 2
> make[3]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> make[2]: *** [check-recursive] Error 1
> make[2]: Leaving directory `/home/math/sage/spkg/build/libm4rie-20120415/src'
> ```
> 
> This is on Ubuntu 12.04 (32 bit) on vmware in Windows 7. 
> gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu4) 
> 
> I got this with the previous package as well. 
> 
> adam

Hi, unfortunately, that error message doesn't say much more than that there were errors. 

* The log should contain more detailed information, can you post this?
* Also, by previous package you mean version 20111004?



---

archive/issue_comments_146962.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nDo I just use the spkg above or do I need to apply the patch as well?\n\nI have tried with libm4rie-20111004.p2.spkg and libm4rie-20111004.p3.spkg and got the same error. The log doesn't have any details at all. The error occurs during the make  check-TESTS portion of the build. It just lists off a pile of tests and ends each section with things like  FAIL: test_trsm. The odd part is that there are no fail messages anywhere else.\n\nThe home directories are not yet present on sage.math.washinton.edu but once they are I will upload the log file.",
    "created_at": "2012-04-14T17:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146962",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:8'>**Comment 8:**</a>
Do I just use the spkg above or do I need to apply the patch as well?

I have tried with libm4rie-20111004.p2.spkg and libm4rie-20111004.p3.spkg and got the same error. The log doesn't have any details at all. The error occurs during the make  check-TESTS portion of the build. It just lists off a pile of tests and ends each section with things like  FAIL: test_trsm. The odd part is that there are no fail messages anywhere else.

The home directories are not yet present on sage.math.washinton.edu but once they are I will upload the log file.



---

archive/issue_comments_146963.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nI fixed the issue in https://bitbucket.org/malb/m4rie/changeset/81d352a8aade and replaced the SPKG with a version with this fix applied.",
    "created_at": "2012-04-14T20:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146963",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'>**Comment 9:**</a>
I fixed the issue in https://bitbucket.org/malb/m4rie/changeset/81d352a8aade and replaced the SPKG with a version with this fix applied.



---

archive/issue_comments_146964.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nI tried again and got the same result. The log is at [http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log](http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log). I see anything useful in the log however.",
    "created_at": "2012-04-14T21:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146964",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:10'>**Comment 10:**</a>
I tried again and got the same result. The log is at [http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log](http://sage.math.washington.edu/home/awebb/libm4rie-20120415.log). I see anything useful in the log however.



---

archive/issue_comments_146965.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\ncorrection: I Don't see anything in the log that is useful. A.",
    "created_at": "2012-04-14T21:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146965",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:11'>**Comment 11:**</a>
correction: I Don't see anything in the log that is useful. A.



---

archive/issue_comments_146966.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nArgh, that's because I uploaded the wrong file again. I fixed it and replaced the file.",
    "created_at": "2012-04-14T21:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146966",
    "user": "https://github.com/malb"
}
```

<a id='comment:12'>**Comment 12:**</a>
Argh, that's because I uploaded the wrong file again. I fixed it and replaced the file.



---

archive/issue_comments_146967.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nIt looks like it worked. At least it built. I now have a ppl problem but that might have already been reported.",
    "created_at": "2012-04-14T23:29:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146967",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:13'>**Comment 13:**</a>
It looks like it worked. At least it built. I now have a ppl problem but that might have already been reported.



---

archive/issue_events_149859.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-15T13:48:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149859"
}
```



---

archive/issue_events_149860.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-15T13:48:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149860"
}
```



---

archive/issue_comments_146968.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nThe new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.\n\n```\nMaking install in .\nmake[1]: Entering directory `/usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src'\n(CDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/sh /usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src/missing --run autoheader)\nrm -f src/stamp-h1\ntouch src/config.h.in\n```",
    "created_at": "2012-04-15T13:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146968",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>**Comment 14:**</a>
The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.

```
Making install in .
make[1]: Entering directory `/usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src'
(CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh /usr/local/src/sage-5.0.beta13/spkg/build/libm4rie-20120415/src/missing --run autoheader)
rm -f src/stamp-h1
touch src/config.h.in
```



---

archive/issue_comments_146969.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nThis is exactly the same problem which I already fixed once in #12501.",
    "created_at": "2012-04-15T13:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146969",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'>**Comment 15:**</a>
This is exactly the same problem which I already fixed once in #12501.



---

archive/issue_comments_146970.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nReplying to [@jdemeyer](#comment%3A14):\n> The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.\n\nUpstream does that: https://bitbucket.org/malb/m4ri-scripts/src/tip/release.py#cl-35 but I added a touch configure afterwards. I also touched configure in the SPKG linked above.",
    "created_at": "2012-04-15T14:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146970",
    "user": "https://github.com/malb"
}
```

<a id='comment:16'>**Comment 16:**</a>
Replying to [@jdemeyer](#comment%3A14):
> The new spkg wants to run `autoheader`.  This probably means that upstream should run `autoreconf` before shipping their sources.

Upstream does that: https://bitbucket.org/malb/m4ri-scripts/src/tip/release.py#cl-35 but I added a touch configure afterwards. I also touched configure in the SPKG linked above.



---

archive/issue_comments_146971.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nAre you sure you updated the spkg correctly?  I still get exactly the same problem as I reported before.",
    "created_at": "2012-04-17T22:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146971",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'>**Comment 17:**</a>
Are you sure you updated the spkg correctly?  I still get exactly the same problem as I reported before.



---

archive/issue_comments_146972.json:
```json
{
    "body": "**Work Issues:** autoheader",
    "created_at": "2012-04-17T22:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146972",
    "user": "https://github.com/jdemeyer"
}
```

**Work Issues:** autoheader



---

archive/issue_comments_146973.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nOn which box does this happen, I get on sage.math:\n\n```\n./sage-5.0.beta13-m4rie/sage -f ~/spkgs/libm4rie-20120415.spkg \nCalling sage-spkg on '/home/malb/spkgs/libm4rie-20120415.spkg'\nlibm4rie-20120415\n====================================================\nExtracting package /home/malb/spkgs/libm4rie-20120415.spkg\n-rw-r--r-- 1 malb malb 401369 2012-04-15 07:03 /home/malb/spkgs/libm4rie-20120415.spkg\nFinished extraction\n****************************************************\nHost system:\nLinux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/scratch/malb/sage-5.0.beta13-m4rie/local/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.6.3/lto-wrapper\nTarget: x86_64-unknown-linux-gnu\nConfigured with: ../src/configure --prefix=/scratch/malb/sage-5.0.beta13/local --with-local-prefix=/scratch/malb/sage-5.0.beta13/local --with-gmp=/scratch/malb/sage-5.0.beta13/local --with-mpfr=/scratch/malb/sage-5.0.beta13/local --with-mpc=/scratch/malb/sage-5.0.beta13/local --with-system-zlib --disable-multilib  \nThread model: posix\ngcc version 4.6.3 (GCC) \n****************************************************\nchecking build system type... x86_64-unknown-linux-gnu\n```",
    "created_at": "2012-04-18T10:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146973",
    "user": "https://github.com/malb"
}
```

<a id='comment:18'>**Comment 18:**</a>
On which box does this happen, I get on sage.math:

```
./sage-5.0.beta13-m4rie/sage -f ~/spkgs/libm4rie-20120415.spkg 
Calling sage-spkg on '/home/malb/spkgs/libm4rie-20120415.spkg'
libm4rie-20120415
====================================================
Extracting package /home/malb/spkgs/libm4rie-20120415.spkg
-rw-r--r-- 1 malb malb 401369 2012-04-15 07:03 /home/malb/spkgs/libm4rie-20120415.spkg
Finished extraction
****************************************************
Host system:
Linux sage.math.washington.edu 2.6.24-28-server #1 SMP Fri Feb 11 18:08:32 UTC 2011 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/scratch/malb/sage-5.0.beta13-m4rie/local/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.6.3/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: ../src/configure --prefix=/scratch/malb/sage-5.0.beta13/local --with-local-prefix=/scratch/malb/sage-5.0.beta13/local --with-gmp=/scratch/malb/sage-5.0.beta13/local --with-mpfr=/scratch/malb/sage-5.0.beta13/local --with-mpc=/scratch/malb/sage-5.0.beta13/local --with-system-zlib --disable-multilib  
Thread model: posix
gcc version 4.6.3 (GCC) 
****************************************************
checking build system type... x86_64-unknown-linux-gnu
```



---

archive/issue_comments_146974.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nThis was on boxen.math.  Anyway, the relevant file which should be touched is `config.h.in` (not `configure`)",
    "created_at": "2012-04-18T11:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146974",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'>**Comment 19:**</a>
This was on boxen.math.  Anyway, the relevant file which should be touched is `config.h.in` (not `configure`)



---

archive/issue_comments_146975.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nI've updated the SPKG accordingly and my release script (for future releases)",
    "created_at": "2012-04-18T11:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146975",
    "user": "https://github.com/malb"
}
```

<a id='comment:20'>**Comment 20:**</a>
I've updated the SPKG accordingly and my release script (for future releases)



---

archive/issue_comments_146976.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nReplying to [@malb](#comment%3A20):\n> I've updated the SPKG accordingly and my release script (for future releases)\n\nDoes that mean the ticket needs review? Or still needs work?",
    "created_at": "2012-05-03T15:53:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146976",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:21'>**Comment 21:**</a>
Replying to [@malb](#comment%3A20):
> I've updated the SPKG accordingly and my release script (for future releases)

Does that mean the ticket needs review? Or still needs work?



---

archive/issue_comments_146977.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nThanks, it needs review",
    "created_at": "2012-05-03T16:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146977",
    "user": "https://github.com/malb"
}
```

<a id='comment:22'>**Comment 22:**</a>
Thanks, it needs review



---

archive/issue_events_149861.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-03T16:13:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149861"
}
```



---

archive/issue_events_149862.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-05-03T16:13:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149862"
}
```



---

archive/issue_comments_146978.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nThe ticket description mentions bug fixes. What are they?",
    "created_at": "2012-05-03T16:48:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146978",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:23'>**Comment 23:**</a>
The ticket description mentions bug fixes. What are they?



---

archive/issue_comments_146979.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nThe bugfixes mainly concern the testsuite: https://bitbucket.org/malb/m4rie/changesets\n\n* !81d352a8aade reserve enough pointers for finite fields in testsuite\n* !8245cd046d86 removed a bit of dead code scan-build reported\n* !b81b9649e2d1 use unsigned ints for degrees everywhere\n* !ad8e309640e3 make sure the canary does not set bits which are expected to be zero (e.g. in lockup tables)\n* !f6f4b011dbe3 fixed a memleak\n* !dfacf106f205 bitmasks should be unsigned\n* !a3087ea586d7 fixed memleak in test_smallops\n* !02f7dfe20ff5 replaced nonstandard __STRING(x) with #x\n* !9d23a80fa589 remove -lntl, it's not needed\n* !f104847ecea0 using less temporary memory for Karatsuba for GF(2^4)\n* !bd90f880f4a8 saving memory in karatsuba multiplication\n* !548023a54d9e use rpath for test_* to make sure the right version of the library is used\n* !559610e11d7e unified strassen cutoff",
    "created_at": "2012-05-03T17:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146979",
    "user": "https://github.com/malb"
}
```

<a id='comment:24'>**Comment 24:**</a>
The bugfixes mainly concern the testsuite: https://bitbucket.org/malb/m4rie/changesets

* !81d352a8aade reserve enough pointers for finite fields in testsuite
* !8245cd046d86 removed a bit of dead code scan-build reported
* !b81b9649e2d1 use unsigned ints for degrees everywhere
* !ad8e309640e3 make sure the canary does not set bits which are expected to be zero (e.g. in lockup tables)
* !f6f4b011dbe3 fixed a memleak
* !dfacf106f205 bitmasks should be unsigned
* !a3087ea586d7 fixed memleak in test_smallops
* !02f7dfe20ff5 replaced nonstandard __STRING(x) with #x
* !9d23a80fa589 remove -lntl, it's not needed
* !f104847ecea0 using less temporary memory for Karatsuba for GF(2^4)
* !bd90f880f4a8 saving memory in karatsuba multiplication
* !548023a54d9e use rpath for test_* to make sure the right version of the library is used
* !559610e11d7e unified strassen cutoff



---

archive/issue_comments_146980.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nReplying to [@malb](#comment%3A24):\n> The bugfixes mainly concern the testsuite:\n\nI didn't install the package with SAGE_CHECK=yes, but I guess I should... Anyway, the Sage test suite (make ptestlong) works.\n\nI tried to verify your claim that it became faster for exponents between 4 and 8. I tested 6. First, in vanilla sage-5.0.rc0:\n\n```\nsage: K.<z> = GF(2^6)\nsage: %time A = random_matrix(K,10000,10000)\nCPU times: user 1.63 s, sys: 0.06 s, total: 1.70 s\nWall time: 1.70 s\nsage: %time B = random_matrix(K,10000,10000)\nCPU times: user 1.53 s, sys: 0.04 s, total: 1.58 s\nWall time: 1.58 s\nsage: %time (A*B).rank()\nCPU times: user 85.03 s, sys: 0.12 s, total: 85.15 s\nWall time: 85.40 s\n10000\n```\nWith the new spkgs in sage-5.0.beta13:\n\n```\nsage: K.<z> = GF(2^6)\nsage: %time A = random_matrix(K,10000,10000)\nCPU times: user 1.77 s, sys: 0.07 s, total: 1.84 s\nWall time: 1.85 s\nsage: %time B = random_matrix(K,10000,10000)\nCPU times: user 1.76 s, sys: 0.03 s, total: 1.79 s\nWall time: 1.80 s\nsage: %time (A*B).rank()\nCPU times: user 37.38 s, sys: 0.23 s, total: 37.61 s\nWall time: 37.74 s\n10000\n```\n\nNow, that *is* faster for the \"real\" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?",
    "created_at": "2012-05-03T19:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146980",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:25'>**Comment 25:**</a>
Replying to [@malb](#comment%3A24):
> The bugfixes mainly concern the testsuite:

I didn't install the package with SAGE_CHECK=yes, but I guess I should... Anyway, the Sage test suite (make ptestlong) works.

I tried to verify your claim that it became faster for exponents between 4 and 8. I tested 6. First, in vanilla sage-5.0.rc0:

```
sage: K.<z> = GF(2^6)
sage: %time A = random_matrix(K,10000,10000)
CPU times: user 1.63 s, sys: 0.06 s, total: 1.70 s
Wall time: 1.70 s
sage: %time B = random_matrix(K,10000,10000)
CPU times: user 1.53 s, sys: 0.04 s, total: 1.58 s
Wall time: 1.58 s
sage: %time (A*B).rank()
CPU times: user 85.03 s, sys: 0.12 s, total: 85.15 s
Wall time: 85.40 s
10000
```
With the new spkgs in sage-5.0.beta13:

```
sage: K.<z> = GF(2^6)
sage: %time A = random_matrix(K,10000,10000)
CPU times: user 1.77 s, sys: 0.07 s, total: 1.84 s
Wall time: 1.85 s
sage: %time B = random_matrix(K,10000,10000)
CPU times: user 1.76 s, sys: 0.03 s, total: 1.79 s
Wall time: 1.80 s
sage: %time (A*B).rank()
CPU times: user 37.38 s, sys: 0.23 s, total: 37.61 s
Wall time: 37.74 s
10000
```

Now, that *is* faster for the "real" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?



---

archive/issue_comments_146981.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nReplying to [@simon-king-jena](#comment%3A25):\n> Replying to [@malb](#comment%3A24):\n> > The bugfixes mainly concern the testsuite:\n\n> \n> I didn't install the package with SAGE_CHECK=yes, but I guess I should... \n\nI did, and the self-tests pass.",
    "created_at": "2012-05-03T19:42:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146981",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:26'>**Comment 26:**</a>
Replying to [@simon-king-jena](#comment%3A25):
> Replying to [@malb](#comment%3A24):
> > The bugfixes mainly concern the testsuite:

> 
> I didn't install the package with SAGE_CHECK=yes, but I guess I should... 

I did, and the self-tests pass.



---

archive/issue_comments_146982.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nReplying to [@simon-king-jena](#comment%3A25):\n> Now, that *is* faster for the \"real\" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?\n\nI don't recall that anything changed in random matrix creation, so I'd assume it's down to margin of error.",
    "created_at": "2012-05-03T20:39:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146982",
    "user": "https://github.com/malb"
}
```

<a id='comment:27'>**Comment 27:**</a>
Replying to [@simon-king-jena](#comment%3A25):
> Now, that *is* faster for the "real" computation, but roughly 10% slower for random matrix creation. Is that a random result within the margin of error?

I don't recall that anything changed in random matrix creation, so I'd assume it's down to margin of error.



---

archive/issue_comments_146983.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nI get\n\n```\nking@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg status\nM spkg-install\nking@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg diff\ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -26,7 +26,7 @@\n CPPFLAGS=\"$INCLUDES\"\n \n if [ \"x$SAGE_DEBUG\" = \"xyes\" ]; then\n-   CFLAGS=\"-O0 $CFLAGS\"\n+   CFLAGS=\"$CFLAGS -O0\"\n    ENABLE_DEBUG=\"--enable-debug\"\n else\n    CFLAGS=\"-O2 $CFLAGS\"\n```\n\nSo, please update the package by checking in the changes!\n\nApart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?",
    "created_at": "2012-05-04T11:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146983",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:28'>**Comment 28:**</a>
I get

```
king@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg status
M spkg-install
king@mpc622:/mnt/local/king/SAGE/stable/sage-5.0.beta13/spkg/optional/libm4rie-20120415$ hg diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -26,7 +26,7 @@
 CPPFLAGS="$INCLUDES"
 
 if [ "x$SAGE_DEBUG" = "xyes" ]; then
-   CFLAGS="-O0 $CFLAGS"
+   CFLAGS="$CFLAGS -O0"
    ENABLE_DEBUG="--enable-debug"
 else
    CFLAGS="-O2 $CFLAGS"
```

So, please update the package by checking in the changes!

Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?



---

archive/issue_comments_146984.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nWhoops, yeah, I left those uncommitted because there was a bit of discussion whether we should have this or not, i.e., should SAGE_DEBUG overwrite the optimisation level you specify in in CFLAGS. I'm inclined that it shouldn't so I will revert this change.",
    "created_at": "2012-05-04T16:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146984",
    "user": "https://github.com/malb"
}
```

<a id='comment:29'>**Comment 29:**</a>
Whoops, yeah, I left those uncommitted because there was a bit of discussion whether we should have this or not, i.e., should SAGE_DEBUG overwrite the optimisation level you specify in in CFLAGS. I'm inclined that it shouldn't so I will revert this change.



---

archive/issue_comments_146985.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nHi, I updated the SPKG accordingly.",
    "created_at": "2012-05-05T15:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146985",
    "user": "https://github.com/malb"
}
```

<a id='comment:30'>**Comment 30:**</a>
Hi, I updated the SPKG accordingly.



---

archive/issue_comments_146986.json:
```json
{
    "body": "**Changing work issues** from \"autoheader\" to \"\".",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146986",
    "user": "https://github.com/jdemeyer"
}
```

**Changing work issues** from "autoheader" to "".



---

archive/issue_comments_146987.json:
```json
{
    "body": "**Reviewer:** Simon King, Jeroen Demeyer",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146987",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Simon King, Jeroen Demeyer



---

archive/issue_comments_146988.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nReplying to [@simon-king-jena](#comment%3A28):\n> Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?\n\nYes, it does.\n\nI also agree with leaving the `-O0` as it is.",
    "created_at": "2012-05-07T06:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146988",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'>**Comment 31:**</a>
Replying to [@simon-king-jena](#comment%3A28):
> Apart from that, self tests and make ptestlong pass, and we see some speed-up. I only tested on one platform, though. Jeroen, can you confirm that the problem you mentioned is fixed?

Yes, it does.

I also agree with leaving the `-O0` as it is.



---

archive/issue_comments_146989.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.\n \n-**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg\n+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg\n \n **Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)\n``````\n",
    "created_at": "2012-06-07T16:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146989",
    "user": "https://github.com/malb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 M4RIE-20120415's main improvement over the version we currently have in Sage is that it is much much faster for degrees 4 <= e <= 8 and bugfixes.
 
-**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120415.spkg
+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4rie-20120613.spkg
 
 **Apply:** [attachment:trac_12841_m4rie_new_version.patch](https://github.com/sagemath/sage/files/ticket12841/trac_12841_m4rie_new_version.patch)
``````




---

archive/issue_comments_146990.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nI looked at it with #12840 and looks good to me. Lets get this boat off the ground ;-)",
    "created_at": "2012-06-18T10:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146990",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'>**Comment 33:**</a>
I looked at it with #12840 and looks good to me. Lets get this boat off the ground ;-)



---

archive/issue_events_149863.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:59:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149863"
}
```



---

archive/issue_events_149864.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-18T10:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149864"
}
```



---

archive/issue_comments_146991.json:
```json
{
    "body": "**Changing reviewer** from \"Simon King, Jeroen Demeyer\" to \"Simon King, Jeroen Demeyer, Volker Braun\".",
    "created_at": "2012-06-18T10:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146991",
    "user": "https://github.com/vbraun"
}
```

**Changing reviewer** from "Simon King, Jeroen Demeyer" to "Simon King, Jeroen Demeyer, Volker Braun".



---

archive/issue_events_149865.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149865"
}
```



---

archive/issue_events_149866.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:32:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149866"
}
```



---

archive/issue_events_149867.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-21T14:23:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149867"
}
```



---

archive/issue_events_149868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-21T14:23:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149868"
}
```



---

archive/issue_comments_146992.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nI tried to compile this on mark (sparc solaris) and it dies at \n\n```\ng++ -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include   -I/include -I/include   -MT test_trsm-test_trsm.o -MD -MP -MF .deps/test_trsm-test_trsm.Tpo -c -o test_trsm-test_trsm.o `test -f 'tests/test_trsm.cc' || echo './'`tests/test_trsm.cc\nmv -f .deps/test_trsm-test_trsm.Tpo .deps/test_trsm-test_trsm.Po\n/bin/bash ./libtool --tag=CXX   --mode=link g++    -I/include   -I/include -I/include   -Wl,-rpath,.libs/ -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -o test_trsm test_trsm-test_trsm.o -L/lib -lm4ri -lm4rie -lgivaro -lgmpxx -lgmp -lm -lstdc++ \nlibtool: link: g++ -I/include -I/include -I/include -Wl,-rpath -Wl,.libs/ -o .libs/test_trsm test_trsm-test_trsm.o  -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -L/lib /home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src/.libs/libm4rie.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libm4ri.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libpng12.so -lz /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgivaro.so -L/home/vbraun/opt/mark/sage-5.1.beta3/local//lib /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmpxx.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmp.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libstdc++.so -lm -Wl,-R -Wl,/home/vbraun/opt/mark/sage-5.1.beta3/local/lib\nld: fatal: option -dn and -P are incompatible\nld: fatal: Flags processing errors\ncollect2: ld returned 1 exit status\nmake[2]: *** [test_trsm] Error 1\nmake[2]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake[1]: *** [check-am] Error 2\nmake[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake: *** [check-recursive] Error 1\n```\nOnly more sophisticated linkers understand `-rpath`, its better to use `-R`. Though you shouldn't have to manually set rpaths in `libm4rie-20120613/src/bench/Makefile.am` at all, the whole autotools/libtools machinery should do that for you.",
    "created_at": "2012-06-21T14:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146992",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:35'>**Comment 35:**</a>
I tried to compile this on mark (sparc solaris) and it dies at 

```
g++ -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include   -I/include -I/include   -MT test_trsm-test_trsm.o -MD -MP -MF .deps/test_trsm-test_trsm.Tpo -c -o test_trsm-test_trsm.o `test -f 'tests/test_trsm.cc' || echo './'`tests/test_trsm.cc
mv -f .deps/test_trsm-test_trsm.Tpo .deps/test_trsm-test_trsm.Po
/bin/bash ./libtool --tag=CXX   --mode=link g++    -I/include   -I/include -I/include   -Wl,-rpath,.libs/ -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -o test_trsm test_trsm-test_trsm.o -L/lib -lm4ri -lm4rie -lgivaro -lgmpxx -lgmp -lm -lstdc++ 
libtool: link: g++ -I/include -I/include -I/include -Wl,-rpath -Wl,.libs/ -o .libs/test_trsm test_trsm-test_trsm.o  -L/home/vbraun/opt/mark/sage-5.1.beta3/local/lib -L/lib /home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src/.libs/libm4rie.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libm4ri.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libpng12.so -lz /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgivaro.so -L/home/vbraun/opt/mark/sage-5.1.beta3/local//lib /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmpxx.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libgmp.so /home/vbraun/opt/mark/sage-5.1.beta3/local/lib/libstdc++.so -lm -Wl,-R -Wl,/home/vbraun/opt/mark/sage-5.1.beta3/local/lib
ld: fatal: option -dn and -P are incompatible
ld: fatal: Flags processing errors
collect2: ld returned 1 exit status
make[2]: *** [test_trsm] Error 1
make[2]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make[1]: *** [check-am] Error 2
make[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make: *** [check-recursive] Error 1
```
Only more sophisticated linkers understand `-rpath`, its better to use `-R`. Though you shouldn't have to manually set rpaths in `libm4rie-20120613/src/bench/Makefile.am` at all, the whole autotools/libtools machinery should do that for you.



---

archive/issue_comments_146993.json:
```json
{
    "body": "**Work Issues:** solaris",
    "created_at": "2012-06-21T14:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146993",
    "user": "https://github.com/vbraun"
}
```

**Work Issues:** solaris



---

archive/issue_events_149869.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-06-21T15:33:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149869"
}
```



---

archive/issue_events_149870.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-06-21T15:33:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149870"
}
```



---

archive/issue_comments_146994.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nOkay, I dropped it from Makefile.am and replaced the SPKG at the same address.\n\n(It is still used in my benchmarking code of M4RIE but that isn't built by Sage.)",
    "created_at": "2012-06-21T15:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146994",
    "user": "https://github.com/malb"
}
```

<a id='comment:36'>**Comment 36:**</a>
Okay, I dropped it from Makefile.am and replaced the SPKG at the same address.

(It is still used in my benchmarking code of M4RIE but that isn't built by Sage.)



---

archive/issue_comments_146995.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nStill dying on mark/skynet, though now at a different place:\n\n```\n/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c -o gf2e.lo `test -f 'src/gf2e.c' || echo './'`src/gf2e.c\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c  -fPIC -DPIC -o .libs/gf2e.o\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c -o gf2e.o >/dev/null 2>&1\nmv -f .deps/gf2e.Tpo .deps/gf2e.Plo\n/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c -o mzed.lo `test -f 'src/mzed.c' || echo './'`src/mzed.c\nlibtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c src/mzed.c  -fPIC -DPIC -o .libs/mzed.o\nIn file included from src/mzed.c:23:0:\nsrc/mzed.h:50:24: fatal error: m4rie/gf2e.h: No such file or directory\ncompilation terminated.\nmake[1]: *** [mzed.lo] Error 1\nmake[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'\nmake: *** [all-recursive] Error 1\nError building libm4rie\n```",
    "created_at": "2012-06-21T15:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146995",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:37'>**Comment 37:**</a>
Still dying on mark/skynet, though now at a different place:

```
/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c -o gf2e.lo `test -f 'src/gf2e.c' || echo './'`src/gf2e.c
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c  -fPIC -DPIC -o .libs/gf2e.o
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT gf2e.lo -MD -MP -MF .deps/gf2e.Tpo -c src/gf2e.c -o gf2e.o >/dev/null 2>&1
mv -f .deps/gf2e.Tpo .deps/gf2e.Plo
/bin/bash ./libtool  --tag=CC   --mode=compile gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src   -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include    -I/include  -O2 -fPIC -Wall -pedantic -g  -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c -o mzed.lo `test -f 'src/mzed.c' || echo './'`src/mzed.c
libtool: compile:  gcc -std=gnu99 -DHAVE_CONFIG_H -I. -I./src -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -I/include -O2 -fPIC -Wall -pedantic -g -I/home/vbraun/opt/mark/sage-5.1.beta3/local/include -MT mzed.lo -MD -MP -MF .deps/mzed.Tpo -c src/mzed.c  -fPIC -DPIC -o .libs/mzed.o
In file included from src/mzed.c:23:0:
src/mzed.h:50:24: fatal error: m4rie/gf2e.h: No such file or directory
compilation terminated.
make[1]: *** [mzed.lo] Error 1
make[1]: Leaving directory `/home/vbraun/opt/mark/sage-5.1.beta3/spkg/build/libm4rie-20120613/src'
make: *** [all-recursive] Error 1
Error building libm4rie
```



---

archive/issue_comments_146996.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nUpdated spkg builds on mark/skynet. Now doctesting...",
    "created_at": "2012-06-21T18:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146996",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:38'>**Comment 38:**</a>
Updated spkg builds on mark/skynet. Now doctesting...



---

archive/issue_comments_146997.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\nI keep getting bus errors (aka segfaults) on mark/skynet with pickling of `matrix_modn_dense_double` matrices. The `_pickle` method uses `mod_int` and not `celement`, I'm totally confused about that. Note that on mark/skynet:\n\n```\nsage: cython('def f():\\n    return (sizeof(double), sizeof(unsigned long))\\n')\nsage: f()\n(8, 4)\n```\nThis might not be the fault of your patch, but its hard to un-apply the spkgs.",
    "created_at": "2012-06-21T19:23:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146997",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'>**Comment 39:**</a>
I keep getting bus errors (aka segfaults) on mark/skynet with pickling of `matrix_modn_dense_double` matrices. The `_pickle` method uses `mod_int` and not `celement`, I'm totally confused about that. Note that on mark/skynet:

```
sage: cython('def f():\n    return (sizeof(double), sizeof(unsigned long))\n')
sage: f()
(8, 4)
```
This might not be the fault of your patch, but its hard to un-apply the spkgs.



---

archive/issue_comments_146998.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\nThe release buildbot shows these bus errors, too:\n\nhttp://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/181/steps/shell_7/logs/stdio",
    "created_at": "2012-06-21T19:28:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146998",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:40'>**Comment 40:**</a>
The release buildbot shows these bus errors, too:

http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/181/steps/shell_7/logs/stdio



---

archive/issue_comments_146999.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nThis is with only M4RI/M4RIE applied, not the LinBox update, right?\n\nThe elements in `Matrix_modn_double` should fit into a `mod_int` since they are < 2<sup>23</sup>. Hence, we simply used the same pickling format as the old `Matrix_modn_dense`.",
    "created_at": "2012-06-21T19:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-146999",
    "user": "https://github.com/malb"
}
```

<a id='comment:41'>**Comment 41:**</a>
This is with only M4RI/M4RIE applied, not the LinBox update, right?

The elements in `Matrix_modn_double` should fit into a `mod_int` since they are < 2<sup>23</sup>. Hence, we simply used the same pickling format as the old `Matrix_modn_dense`.



---

archive/issue_comments_147000.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nYes, just with M4RI/M4RIE. The buildbot failure I linked to is even without the M4RI/M4RIE update.",
    "created_at": "2012-06-21T19:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147000",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'>**Comment 42:**</a>
Yes, just with M4RI/M4RIE. The buildbot failure I linked to is even without the M4RI/M4RIE update.



---

archive/issue_comments_147001.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nFrom http://docs.oracle.com/cd/E19957-01/806-3568/ncg_math.html about the double bit format:\n\nIn the SPARC architecture, the higher address 32-bit word contains the least significant 32 bits of the fraction, while in the x86 architecture the lower address 32-bit word contains the least significant 32 bits of the fraction.",
    "created_at": "2012-06-21T19:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147001",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:43'>**Comment 43:**</a>
From http://docs.oracle.com/cd/E19957-01/806-3568/ncg_math.html about the double bit format:

In the SPARC architecture, the higher address 32-bit word contains the least significant 32 bits of the fraction, while in the x86 architecture the lower address 32-bit word contains the least significant 32 bits of the fraction.



---

archive/issue_comments_147002.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nBut we're doing a cast, shouldn't that take care of it?",
    "created_at": "2012-06-21T20:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147002",
    "user": "https://github.com/malb"
}
```

<a id='comment:44'>**Comment 44:**</a>
But we're doing a cast, shouldn't that take care of it?



---

archive/issue_comments_147003.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nReplying to [@malb](#comment%3A44):\n> But we're doing a cast, shouldn't that take care of it?\n\nWhat lines of code are you talking about?  The problem might be alignment, i.e. doubles should be aligned on a multiple of 8 bytes.",
    "created_at": "2012-06-21T20:06:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147003",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'>**Comment 45:**</a>
Replying to [@malb](#comment%3A44):
> But we're doing a cast, shouldn't that take care of it?

What lines of code are you talking about?  The problem might be alignment, i.e. doubles should be aligned on a multiple of 8 bytes.



---

archive/issue_comments_147004.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\nI mean this:\n\nhttp://hg.sagemath.org/sage-main/file/01e0779db321/sage/matrix/matrix_modn_dense_template.pxi#l650\n\nBut perhaps we should wait until we've run this through a gdb before we speculate which lines fail? :)",
    "created_at": "2012-06-21T20:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147004",
    "user": "https://github.com/malb"
}
```

<a id='comment:46'>**Comment 46:**</a>
I mean this:

http://hg.sagemath.org/sage-main/file/01e0779db321/sage/matrix/matrix_modn_dense_template.pxi#l650

But perhaps we should wait until we've run this through a gdb before we speculate which lines fail? :)



---

archive/issue_comments_147005.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\nWhat are the `mod_int` and `celement` types and where do `double`s come in?",
    "created_at": "2012-06-21T20:19:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147005",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'>**Comment 48:**</a>
What are the `mod_int` and `celement` types and where do `double`s come in?



---

archive/issue_comments_147006.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\ngdb isn't installed on mark. the only debugger is mdb and I have no idea how to use it.\nBut the bus error is at the i=j=0 assignment (using print) in _pickle.\n\nI thought \nmod_int = long int and celement = double (in matrix_modn_dense_double)\n\nThe cast to mod_int is working correctly, though.",
    "created_at": "2012-06-21T20:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147006",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:49'>**Comment 49:**</a>
gdb isn't installed on mark. the only debugger is mdb and I have no idea how to use it.
But the bus error is at the i=j=0 assignment (using print) in _pickle.

I thought 
mod_int = long int and celement = double (in matrix_modn_dense_double)

The cast to mod_int is working correctly, though.



---

archive/issue_comments_147007.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nFor the record, matrix_modn_dense_template.pxi with some extra prints:\n\n```\n        else:\n            print 'word_size != sizeof(char)', word_size, <int><char*>s\n            um = <mod_int*><char *>s\n            for i in range(self._nrows):\n                row_self = self._matrix[i]\n                row_um = &um[i*self._ncols]\n                for j in range(self._ncols):\n                    print i, j, row_self[j], <mod_int>row_self[j], self._ncols, self._nrows, <int>row_um\n                    row_um[j] = <mod_int>row_self[j]\n                    print \"crash\"\n```\nyields\n\n```\nsage: random_matrix(ZZ.quo(123456), 10,10)._pickle()\nword_size != sizeof(char) 8 68071796\n0 0 60348.0 60348 10 10 68071796\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/vbraun/opt/mark/sage-5.1.beta3/devel/sage-main/<ipython console> in <module>()\n\n/home/vbraun/opt/mark/sage-5.1.beta3/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_double.so in sage.matrix.matrix_modn_dense_double.Matrix_modn_dense_template._pickle (sage/matrix/matrix_modn_dense_double.cpp:6537)()\n\nRuntimeError: Bus error\n```",
    "created_at": "2012-06-21T20:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147007",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:50'>**Comment 50:**</a>
For the record, matrix_modn_dense_template.pxi with some extra prints:

```
        else:
            print 'word_size != sizeof(char)', word_size, <int><char*>s
            um = <mod_int*><char *>s
            for i in range(self._nrows):
                row_self = self._matrix[i]
                row_um = &um[i*self._ncols]
                for j in range(self._ncols):
                    print i, j, row_self[j], <mod_int>row_self[j], self._ncols, self._nrows, <int>row_um
                    row_um[j] = <mod_int>row_self[j]
                    print "crash"
```
yields

```
sage: random_matrix(ZZ.quo(123456), 10,10)._pickle()
word_size != sizeof(char) 8 68071796
0 0 60348.0 60348 10 10 68071796
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/vbraun/opt/mark/sage-5.1.beta3/devel/sage-main/<ipython console> in <module>()

/home/vbraun/opt/mark/sage-5.1.beta3/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_double.so in sage.matrix.matrix_modn_dense_double.Matrix_modn_dense_template._pickle (sage/matrix/matrix_modn_dense_double.cpp:6537)()

RuntimeError: Bus error
```



---

archive/issue_comments_147008.json:
```json
{
    "body": "<a id='comment:51'>**Comment 51:**</a>\nJeroen was right, its an alignment thing. The output of `PyString_FromStringAndSize` is 4 but not 8-byte aligned. By faking it\n\n```\n            um = <mod_int*>((<char *>s)+4)\n```\nI avoided the crash.",
    "created_at": "2012-06-21T20:47:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147008",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:51'>**Comment 51:**</a>
Jeroen was right, its an alignment thing. The output of `PyString_FromStringAndSize` is 4 but not 8-byte aligned. By faking it

```
            um = <mod_int*>((<char *>s)+4)
```
I avoided the crash.



---

archive/issue_comments_147009.json:
```json
{
    "body": "<a id='comment:52'>**Comment 52:**</a>\nBut it seems it's not double alignment? By the time it hits unaligned memory it's already a `mod_int == long`.",
    "created_at": "2012-06-21T21:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147009",
    "user": "https://github.com/malb"
}
```

<a id='comment:52'>**Comment 52:**</a>
But it seems it's not double alignment? By the time it hits unaligned memory it's already a `mod_int == long`.



---

archive/issue_comments_147010.json:
```json
{
    "body": "<a id='comment:53'>**Comment 53:**</a>\nBut note that `wordsize` == `sizeof(mod_int)` == 8 according to Volker's `print` statement.",
    "created_at": "2012-06-22T06:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147010",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'>**Comment 53:**</a>
But note that `wordsize` == `sizeof(mod_int)` == 8 according to Volker's `print` statement.



---

archive/issue_comments_147011.json:
```json
{
    "body": "<a id='comment:54'>**Comment 54:**</a>\nThe problem is that `sage/ext/multi_modular.h` defines\n\n```\n#define mod_int uint_fast64_t\n```\n\nSo, `mod_int` is actually `uint_fast64_t`.",
    "created_at": "2012-06-22T07:05:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147011",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:54'>**Comment 54:**</a>
The problem is that `sage/ext/multi_modular.h` defines

```
#define mod_int uint_fast64_t
```

So, `mod_int` is actually `uint_fast64_t`.



---

archive/issue_comments_147012.json:
```json
{
    "body": "<a id='comment:55'>**Comment 55:**</a>\nThe file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?",
    "created_at": "2012-06-22T07:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147012",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'>**Comment 55:**</a>
The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?



---

archive/issue_comments_147013.json:
```json
{
    "body": "<a id='comment:56'>**Comment 56:**</a>\nNote that the conflicting types might not even a problem, as Cython doesn't really care much about types.  The definition\n\n```\nctypedef unsigned long mod_int\n```\nmostly just makes Cython aware that `mod_int` is some (integer?) type, the actual type doesn't really matter as far as I know.",
    "created_at": "2012-06-22T07:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147013",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'>**Comment 56:**</a>
Note that the conflicting types might not even a problem, as Cython doesn't really care much about types.  The definition

```
ctypedef unsigned long mod_int
```
mostly just makes Cython aware that `mod_int` is some (integer?) type, the actual type doesn't really matter as far as I know.



---

archive/issue_comments_147014.json:
```json
{
    "body": "<a id='comment:57'>**Comment 57:**</a>\nReplying to [@jdemeyer](#comment%3A55):\n> The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?\n\nFWIW: I made a similar experience on Solaris with my MeatAxe wrapper (and, if I remember correctly, the same problem has shown up a while ago when trying to use Singular options in !libSingular). Namely, MeatAxe uses a function mulmat (or matmul? Doesn't matter...), but apparently a function of the same name is defined in some other spkg as well. And apparently the Solaris linker was confusing the two mulmats, even though they belong to totally different packages! In particular, MeatAxe does not link against the other package.\n\nThe simple solution was to rename MeatAxe's mulmat into _mulmat.\nSo, renaming mod_int into something else would be worth a try.",
    "created_at": "2012-06-22T07:22:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147014",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:57'>**Comment 57:**</a>
Replying to [@jdemeyer](#comment%3A55):
> The file `sage/ext/multi_modular.h` seems to be used by LinBox.  But `matrix_modn_double_*` has a conflicting definition of `mod_int`.  It is supposed to be the same or did you both use the same name for a type accidentally?

FWIW: I made a similar experience on Solaris with my MeatAxe wrapper (and, if I remember correctly, the same problem has shown up a while ago when trying to use Singular options in !libSingular). Namely, MeatAxe uses a function mulmat (or matmul? Doesn't matter...), but apparently a function of the same name is defined in some other spkg as well. And apparently the Solaris linker was confusing the two mulmats, even though they belong to totally different packages! In particular, MeatAxe does not link against the other package.

The simple solution was to rename MeatAxe's mulmat into _mulmat.
So, renaming mod_int into something else would be worth a try.



---

archive/issue_comments_147015.json:
```json
{
    "body": "<a id='comment:58'>**Comment 58:**</a>\nPerhaps 64-bit integers need to be 8-byte aligned as well? Also, I guess \n\n  ```\n  ctypedef unsigned long mod_int\n  ```\n\nshould be replaced by the correct typedef, to make it less confusing. In any case, I opened a new ticket at #13151 since this is not M4RIE releated.",
    "created_at": "2012-06-22T09:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147015",
    "user": "https://github.com/malb"
}
```

<a id='comment:58'>**Comment 58:**</a>
Perhaps 64-bit integers need to be 8-byte aligned as well? Also, I guess 

  ```
  ctypedef unsigned long mod_int
  ```

should be replaced by the correct typedef, to make it less confusing. In any case, I opened a new ticket at #13151 since this is not M4RIE releated.



---

archive/issue_comments_147016.json:
```json
{
    "body": "<a id='comment:59'>**Comment 59:**</a>\nThe cast is defined at compile-time, not at link-time. To summarize, the problem really is that malloc on Solaris only returns 32-bit aligned memory. \n\nSimon: There is only a single flat namespace on Linux and Solaris, so if any shared library imports conflicting symbols then its just luck to get the right one.",
    "created_at": "2012-06-22T10:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147016",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:59'>**Comment 59:**</a>
The cast is defined at compile-time, not at link-time. To summarize, the problem really is that malloc on Solaris only returns 32-bit aligned memory. 

Simon: There is only a single flat namespace on Linux and Solaris, so if any shared library imports conflicting symbols then its just luck to get the right one.



---

archive/issue_comments_147017.json:
```json
{
    "body": "<a id='comment:60'>**Comment 60:**</a>\nOther doctests pass, so lets give this a go.",
    "created_at": "2012-06-22T11:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147017",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:60'>**Comment 60:**</a>
Other doctests pass, so lets give this a go.



---

archive/issue_events_149871.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-22T11:42:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149871"
}
```



---

archive/issue_events_149872.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-22T11:42:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149872"
}
```



---

archive/issue_comments_147018.json:
```json
{
    "body": "**Changing work issues** from \"solaris\" to \"\".",
    "created_at": "2012-07-01T18:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147018",
    "user": "https://github.com/jdemeyer"
}
```

**Changing work issues** from "solaris" to "".



---

archive/issue_events_149873.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149873"
}
```



---

archive/issue_events_149874.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149874"
}
```



---

archive/issue_events_149875.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149875"
}
```



---

archive/issue_events_149876.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:25:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149876"
}
```



---

archive/issue_events_149877.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149877"
}
```



---

archive/issue_events_149878.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:36:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149878"
}
```



---

archive/issue_events_149879.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-31T06:39:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149879"
}
```



---

archive/issue_events_149880.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-31T06:39:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149880"
}
```



---

archive/issue_comments_147019.json:
```json
{
    "body": "**Merged:** sage-5.3.beta0",
    "created_at": "2012-08-01T12:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12841#issuecomment-147019",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.3.beta0



---

archive/issue_events_149881.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149881"
}
```



---

archive/issue_events_149882.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:10:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12841",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12841#event-149882"
}
```
