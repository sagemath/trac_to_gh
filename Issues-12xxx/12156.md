# Issue 12156: Pretty print LatexExpr directly

archive/issues_011984.json:
```json
{
    "body": "An object of type `LatexExpr` should be pretty-printed as-is, that is\n\n```\nsage: pretty_print(LatexExpr('x^2 + 1'))\n```\nshould really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n\nAlso, import `LatexExpr` globally.\n\n**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],\n[attachment:12156_fix_latex.patch], [attachment:12156_jhp.patch]\n\nAssignee: @jasongrout\n\nCC:  tdemedts@java.ugent.be @jhpalmieri\n\nKeywords: sd35\n\nResolution: fixed\n\nDependencies: #12197\n\nAuthor: Jeroen Demeyer, Punarbasu Purkayastha\n\nReviewer: Andrey Novoseltsev, Punarbasu Purkayastha, John Palmieri\n\nMerged: sage-4.8.alpha6\n\nIssue created by migration from https://trac.sagemath.org/ticket/12156\n\n",
    "closed_at": "2011-12-24T01:04:53Z",
    "created_at": "2011-12-15T09:42:30Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Pretty print LatexExpr directly",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12156",
    "user": "https://github.com/jdemeyer"
}
```
An object of type `LatexExpr` should be pretty-printed as-is, that is

```
sage: pretty_print(LatexExpr('x^2 + 1'))
```
should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.

Also, import `LatexExpr` globally.

**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],
[attachment:12156_fix_latex.patch], [attachment:12156_jhp.patch]

Assignee: @jasongrout

CC:  tdemedts@java.ugent.be @jhpalmieri

Keywords: sd35

Resolution: fixed

Dependencies: #12197

Author: Jeroen Demeyer, Punarbasu Purkayastha

Reviewer: Andrey Novoseltsev, Punarbasu Purkayastha, John Palmieri

Merged: sage-4.8.alpha6

Issue created by migration from https://trac.sagemath.org/ticket/12156





---

archive/issue_comments_169480.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,9 @@\n ```\n sage: pretty_print(LatexExpr('x^2 + 1'))\n ```\n-should really typeset \"x^2 + 1\" instead of displaying the string \"x^2 + 1\".\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-15T09:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169480",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,9 @@
 ```
 sage: pretty_print(LatexExpr('x^2 + 1'))
 ```
-should really typeset "x^2 + 1" instead of displaying the string "x^2 + 1".
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
 
 Comment: 1
 
``````




---

archive/issue_comments_169481.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2011-12-15T09:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169481",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_169482.json:
```json
{
    "body": "Attachment [12156_latex_pretty_print.patch](tarball://root/attachments/some-uuid/ticket12156/12156_latex_pretty_print.patch) by @jdemeyer created at 2011-12-15 10:12:56",
    "created_at": "2011-12-15T10:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169482",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [12156_latex_pretty_print.patch](tarball://root/attachments/some-uuid/ticket12156/12156_latex_pretty_print.patch) by @jdemeyer created at 2011-12-15 10:12:56



---

archive/issue_comments_169483.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-12-15T10:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169483",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_169484.json:
```json
{
    "body": "<a id='comment:5'></a>Attachment [12156_reviewer.patch](tarball://root/attachments/some-uuid/ticket12156/12156_reviewer.patch) by @novoselt created at 2011-12-15 18:51:53\n\nI got a bit confused by the description of the class, so I propose the attached change. The main patch has positive review from me.",
    "created_at": "2011-12-15T18:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169484",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>Attachment [12156_reviewer.patch](tarball://root/attachments/some-uuid/ticket12156/12156_reviewer.patch) by @novoselt created at 2011-12-15 18:51:53

I got a bit confused by the description of the class, so I propose the attached change. The main patch has positive review from me.



---

archive/issue_comments_169485.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Andrey Novoseltsev\"",
    "created_at": "2011-12-15T18:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169485",
    "user": "https://github.com/novoselt"
}
```

Changing reviewer from "" to "Andrey Novoseltsev"



---

archive/issue_comments_169486.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+An object of type `LatexExpr` should be pretty-printed as-is, that is\n \n+```\n+sage: pretty_print(LatexExpr('x^2 + 1'))\n+```\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n+\n+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_extra_doc.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-16T09:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169486",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+An object of type `LatexExpr` should be pretty-printed as-is, that is
 
+```
+sage: pretty_print(LatexExpr('x^2 + 1'))
+```
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
+
+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_extra_doc.patch]
 
 Comment: 1
 
``````




---

archive/issue_comments_169487.json:
```json
{
    "body": "<a id='comment:7'></a>I removed \"Strings are wrapped into verbatim environment for typeset output, while LaTeX expressions are left as-is\" because I think that's confusing.  I added some more documentation changes and examples.  Needs review.",
    "created_at": "2011-12-16T09:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169487",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>I removed "Strings are wrapped into verbatim environment for typeset output, while LaTeX expressions are left as-is" because I think that's confusing.  I added some more documentation changes and examples.  Needs review.



---

archive/issue_comments_169488.json:
```json
{
    "body": "<a id='comment:8'></a>There is just one point. It is not possible to combine normal strings with latex strings or LatexExpr with itself. Something like this fails to produce the right output: `LatexExpr(r'\\Delta') + LatexExpr(r'\\frac{x}2')`. This gives the wrong output even though the addition goes through as strings. Proposed patch is attached, though I leave it up to you to decide whether to include it.\n\nOther than this minor point, the patches provided earlier work as advertised. So, positive review from my side.",
    "created_at": "2011-12-16T14:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169488",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:8'></a>There is just one point. It is not possible to combine normal strings with latex strings or LatexExpr with itself. Something like this fails to produce the right output: `LatexExpr(r'\Delta') + LatexExpr(r'\frac{x}2')`. This gives the wrong output even though the addition goes through as strings. Proposed patch is attached, though I leave it up to you to decide whether to include it.

Other than this minor point, the patches provided earlier work as advertised. So, positive review from my side.



---

archive/issue_comments_169489.json:
```json
{
    "body": "<a id='comment:9'></a>If we do add the last patch (which is a bit beyond the title of this ticket), then I think that we MUST add a space between concatenated expressions: if you join \"x\" and \"y\" into \"xy\" it may be exactly what you need, but \"\\alpha\" and \"x\" get joined into \"\\alphax\" which is not a valid code any more (as I have \"discovered\" at #9478). Plus spaces (or even new lines) help reading the code and adjusting it if necessary.\n\nI also was actually surprised that `\"\\frac{x}2\"` works, I would put it as `\"\\frac{x}{2}\"`, although it is just a personal preference, I guess ;-)",
    "created_at": "2011-12-16T20:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169489",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:9'></a>If we do add the last patch (which is a bit beyond the title of this ticket), then I think that we MUST add a space between concatenated expressions: if you join "x" and "y" into "xy" it may be exactly what you need, but "\alpha" and "x" get joined into "\alphax" which is not a valid code any more (as I have "discovered" at #9478). Plus spaces (or even new lines) help reading the code and adjusting it if necessary.

I also was actually surprised that `"\frac{x}2"` works, I would put it as `"\frac{x}{2}"`, although it is just a personal preference, I guess ;-)



---

archive/issue_comments_169490.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 novoselt]:\n> If we do add the last patch (which is a bit beyond the title of this ticket), then I think that we MUST add a space between concatenated expressions: if you join \"x\" and \"y\" into \"xy\" it may be exactly what you need, but \"\\alpha\" and \"x\" get joined into \"\\alphax\" which is not a valid code any more (as I have \"discovered\" at #9478). Plus spaces (or even new lines) help reading the code and adjusting it if necessary.\n\nThe problem is that maybe sometimes you *don't* want a space.  How about adding a \"{}\" instead which acts like a seperator but otherwise doesn't do much.",
    "created_at": "2011-12-16T20:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169490",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:9 novoselt]:
> If we do add the last patch (which is a bit beyond the title of this ticket), then I think that we MUST add a space between concatenated expressions: if you join "x" and "y" into "xy" it may be exactly what you need, but "\alpha" and "x" get joined into "\alphax" which is not a valid code any more (as I have "discovered" at #9478). Plus spaces (or even new lines) help reading the code and adjusting it if necessary.

The problem is that maybe sometimes you *don't* want a space.  How about adding a "{}" instead which acts like a seperator but otherwise doesn't do much.



---

archive/issue_comments_169491.json:
```json
{
    "body": "<a id='comment:11'></a>This breaks the pdf manual:\n\n```\nRunaway argument?\n\\PYG {g+gp}{sage: }\\PYG {n}{LatexExpr}\\PYG {p}{(}\\PYG {l+s}{r\"}\\PYG {\\ETC.\n! Forbidden control sequence found while scanning use of \\FancyVerbGetLine.\n<inserted text>\n                \\par\nl.126604 ...r}\\PYG{p}{(}\\PYG{l+s}{r\"}\\PYG{l+s}{^^L\n                                                  rac\\PYGZob{}x\\PYGZca{}2 + ...\n\n?\n! Emergency stop.\n<inserted text>\n                \\par\nl.126604 ...r}\\PYG{p}{(}\\PYG{l+s}{r\"}\\PYG{l+s}{^^L\n                                                  rac\\PYGZob{}x\\PYGZca{}2 + ...\n\n!  ==> Fatal error occurred, no output PDF file produced!\nTranscript written on reference.log.\n```",
    "created_at": "2011-12-16T20:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169491",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>This breaks the pdf manual:

```
Runaway argument?
\PYG {g+gp}{sage: }\PYG {n}{LatexExpr}\PYG {p}{(}\PYG {l+s}{r"}\PYG {\ETC.
! Forbidden control sequence found while scanning use of \FancyVerbGetLine.
<inserted text>
                \par
l.126604 ...r}\PYG{p}{(}\PYG{l+s}{r"}\PYG{l+s}{^^L
                                                  rac\PYGZob{}x\PYGZca{}2 + ...

?
! Emergency stop.
<inserted text>
                \par
l.126604 ...r}\PYG{p}{(}\PYG{l+s}{r"}\PYG{l+s}{^^L
                                                  rac\PYGZob{}x\PYGZca{}2 + ...

!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on reference.log.
```



---

archive/issue_comments_169492.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 jdemeyer]:\n> The problem is that maybe sometimes you *don't* want a space.  How about adding a \"{}\" instead which acts like a seperator but otherwise doesn't do much.\n\n\nIn what situations does the space matter in math mode? It seems to me that if both were valid expressions before, then they can be separated by a space without any harm... As I understand `{}` will do the same, but it will make the code much uglier, `x{}y` is not as cool as `x y`. And I think that readability of the LaTeX output is a valid concern since I quite regularly take some Sage generated code and then do some manual tweaking. For example - take a long polynomial and then typeset it in an align-environment in a paper. In editors that auto-wrap lines on spaces it is also preferable to have just a space separator.\n\nIf there are situations when space does not work, which I think are quite rare since I cannot think of any, one always has an option of converting things to strings, doing anything there and then assembling them back. On a related note, it would be nice to have automatic vertical assembling of such expressions as well, but it is definitely beyond this ticket.",
    "created_at": "2011-12-16T21:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169492",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:12'></a>Replying to [comment:10 jdemeyer]:
> The problem is that maybe sometimes you *don't* want a space.  How about adding a "{}" instead which acts like a seperator but otherwise doesn't do much.


In what situations does the space matter in math mode? It seems to me that if both were valid expressions before, then they can be separated by a space without any harm... As I understand `{}` will do the same, but it will make the code much uglier, `x{}y` is not as cool as `x y`. And I think that readability of the LaTeX output is a valid concern since I quite regularly take some Sage generated code and then do some manual tweaking. For example - take a long polynomial and then typeset it in an align-environment in a paper. In editors that auto-wrap lines on spaces it is also preferable to have just a space separator.

If there are situations when space does not work, which I think are quite rare since I cannot think of any, one always has an option of converting things to strings, doing anything there and then assembling them back. On a related note, it would be nice to have automatic vertical assembling of such expressions as well, but it is definitely beyond this ticket.



---

archive/issue_comments_169493.json:
```json
{
    "body": "<a id='comment:13'></a>Which patch does break the PDF manual? The last one or all of them?",
    "created_at": "2011-12-16T21:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169493",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:13'></a>Which patch does break the PDF manual? The last one or all of them?



---

archive/issue_comments_169494.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-16T21:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169494",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_169495.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 novoselt]:\n> Which patch does break the PDF manual? The last one or all of them?\n\n\nProblem solved by using `r\"\"\"` instead of `\"\"\"`.\n\nConcerning adding: you are right, I did not consider that we are using math mode all the time.  But you should use `_add_` (single underscores).  I don't know why, but Sage does it this way.",
    "created_at": "2011-12-16T21:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169495",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 novoselt]:
> Which patch does break the PDF manual? The last one or all of them?


Problem solved by using `r"""` instead of `"""`.

Concerning adding: you are right, I did not consider that we are using math mode all the time.  But you should use `_add_` (single underscores).  I don't know why, but Sage does it this way.



---

archive/issue_comments_169496.json:
```json
{
    "body": "Changing work_issues from \"\" to \"_add_()\"",
    "created_at": "2011-12-16T21:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169496",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "" to "_add_()"



---

archive/issue_comments_169497.json:
```json
{
    "body": "<a id='comment:15'></a>I think `_add_` is used so that coercion can work properly. But it requires inheriting from `SageObject` or maybe even `Element`, so that generic `__add__` can do its part of the job. So I doubt it will work for `LatexExpr` which inherits from `str` and nothing else.",
    "created_at": "2011-12-16T21:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169497",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:15'></a>I think `_add_` is used so that coercion can work properly. But it requires inheriting from `SageObject` or maybe even `Element`, so that generic `__add__` can do its part of the job. So I doubt it will work for `LatexExpr` which inherits from `str` and nothing else.



---

archive/issue_comments_169498.json:
```json
{
    "body": "<a id='comment:16'></a>Actually space seems to work just fine to separate elements. Since we are in math mode, JSMath will collapse the extra spaces automatically.\n\nAs mentioned by novoselt, `_add_` does not work. I tried it out just now. Updated the patch.",
    "created_at": "2011-12-17T02:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169498",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:16'></a>Actually space seems to work just fine to separate elements. Since we are in math mode, JSMath will collapse the extra spaces automatically.

As mentioned by novoselt, `_add_` does not work. I tried it out just now. Updated the patch.



---

archive/issue_comments_169499.json:
```json
{
    "body": "Add to LatexExpr (added space in between the two)",
    "created_at": "2011-12-19T13:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169499",
    "user": "https://github.com/jdemeyer"
}
```

Add to LatexExpr (added space in between the two)



---

archive/issue_comments_169500.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+An object of type `LatexExpr` should be pretty-printed as-is, that is\n \n+```\n+sage: pretty_print(LatexExpr('x^2 + 1'))\n+```\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n+\n+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment: 12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-19T13:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169500",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+An object of type `LatexExpr` should be pretty-printed as-is, that is
 
+```
+sage: pretty_print(LatexExpr('x^2 + 1'))
+```
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
+
+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment: 12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch]
 
 Comment: 1
 
``````




---

archive/issue_comments_169501.json:
```json
{
    "body": "Changing work_issues from \"_add_()\" to \"\"",
    "created_at": "2011-12-19T13:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169501",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "_add_()" to ""



---

archive/issue_comments_169502.json:
```json
{
    "body": "<a id='comment:17'></a>Attachment [12156_add_LatexExpr.patch](tarball://root/attachments/some-uuid/ticket12156/12156_add_LatexExpr.patch) by @jdemeyer created at 2011-12-19 13:32:58",
    "created_at": "2011-12-19T13:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169502",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>Attachment [12156_add_LatexExpr.patch](tarball://root/attachments/some-uuid/ticket12156/12156_add_LatexExpr.patch) by @jdemeyer created at 2011-12-19 13:32:58



---

archive/issue_comments_169503.json:
```json
{
    "body": "<a id='comment:18'></a>Attachment [12156_extra_doc.patch](tarball://root/attachments/some-uuid/ticket12156/12156_extra_doc.patch) by @jdemeyer created at 2011-12-19 13:45:14\n\nPositive review to everything except my extra_doc patch.",
    "created_at": "2011-12-19T13:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169503",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Attachment [12156_extra_doc.patch](tarball://root/attachments/some-uuid/ticket12156/12156_extra_doc.patch) by @jdemeyer created at 2011-12-19 13:45:14

Positive review to everything except my extra_doc patch.



---

archive/issue_comments_169504.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-19T13:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169504",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_169505.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+An object of type `LatexExpr` should be pretty-printed as-is, that is\n \n+```\n+sage: pretty_print(LatexExpr('x^2 + 1'))\n+```\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n+\n+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-19T13:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169505",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+An object of type `LatexExpr` should be pretty-printed as-is, that is
 
+```
+sage: pretty_print(LatexExpr('x^2 + 1'))
+```
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
+
+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch]
 
 Comment: 1
 
``````




---

archive/issue_comments_169506.json:
```json
{
    "body": "Changing reviewer from \"Andrey Novoseltsev\" to \"Andrey Novoseltsev, Punarbasu Purkayastha\"",
    "created_at": "2011-12-19T15:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169506",
    "user": "https://github.com/novoselt"
}
```

Changing reviewer from "Andrey Novoseltsev" to "Andrey Novoseltsev, Punarbasu Purkayastha"



---

archive/issue_comments_169507.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-19T15:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169507",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_169508.json:
```json
{
    "body": "<a id='comment:20'></a>Positive review to the last patch as well! Why do we have the reviewer field before the author one?..",
    "created_at": "2011-12-19T15:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169508",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:20'></a>Positive review to the last patch as well! Why do we have the reviewer field before the author one?..



---

archive/issue_comments_169509.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Punarbasu Purkayastha\"",
    "created_at": "2011-12-19T15:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169509",
    "user": "https://github.com/novoselt"
}
```

Changing author from "Jeroen Demeyer" to "Jeroen Demeyer, Punarbasu Purkayastha"



---

archive/issue_comments_169510.json:
```json
{
    "body": "<a id='comment:21'></a>Unfortunately there are some doctest errors in various unrelated files. I am working on a patch.",
    "created_at": "2011-12-20T09:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169510",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Unfortunately there are some doctest errors in various unrelated files. I am working on a patch.



---

archive/issue_comments_169511.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-12-20T09:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169511",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_169512.json:
```json
{
    "body": "Changing work_issues from \"\" to \"sd35\"",
    "created_at": "2011-12-20T09:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169512",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "" to "sd35"



---

archive/issue_comments_169513.json:
```json
{
    "body": "Changing work_issues from \"sd35\" to \"\"",
    "created_at": "2011-12-20T09:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169513",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "sd35" to ""



---

archive/issue_comments_169514.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd35\".",
    "created_at": "2011-12-20T09:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169514",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "sd35".



---

archive/issue_comments_169515.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#12197\"",
    "created_at": "2011-12-20T11:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169515",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#12197"



---

archive/issue_comments_169516.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-20T11:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169516",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_169517.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+An object of type `LatexExpr` should be pretty-printed as-is, that is\n \n+```\n+sage: pretty_print(LatexExpr('x^2 + 1'))\n+```\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n+\n+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],\n+[attachment:12156_fix_latex.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-20T11:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169517",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+An object of type `LatexExpr` should be pretty-printed as-is, that is
 
+```
+sage: pretty_print(LatexExpr('x^2 + 1'))
+```
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
+
+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],
+[attachment:12156_fix_latex.patch]
 
 Comment: 1
 
``````




---

archive/issue_comments_169518.json:
```json
{
    "body": "Attachment [12156_fix_latex.patch](tarball://root/attachments/some-uuid/ticket12156/12156_fix_latex.patch) by @jdemeyer created at 2011-12-20 14:51:57",
    "created_at": "2011-12-20T14:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169518",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [12156_fix_latex.patch](tarball://root/attachments/some-uuid/ticket12156/12156_fix_latex.patch) by @jdemeyer created at 2011-12-20 14:51:57



---

archive/issue_comments_169519.json:
```json
{
    "body": "<a id='comment:26'></a>New patch also allows str + LatexExpr additions, which needed a few changes in various places inside Sage.  I left one more substantial change for differential forms at #12197.\n\nNeeds review.",
    "created_at": "2011-12-20T15:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169519",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>New patch also allows str + LatexExpr additions, which needed a few changes in various places inside Sage.  I left one more substantial change for differential forms at #12197.

Needs review.



---

archive/issue_comments_169520.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+An object of type `LatexExpr` should be pretty-printed as-is, that is\n \n+```\n+sage: pretty_print(LatexExpr('x^2 + 1'))\n+```\n+should really typeset `\"x^2 + 1\"` instead of displaying the string `\"x^2 + 1\"`.\n+\n+Also, import `LatexExpr` globally.\n+\n+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],\n+[attachment:12156_fix_latex.patch], [attachment:12156_jhp.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2011-12-21T01:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169520",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+An object of type `LatexExpr` should be pretty-printed as-is, that is
 
+```
+sage: pretty_print(LatexExpr('x^2 + 1'))
+```
+should really typeset `"x^2 + 1"` instead of displaying the string `"x^2 + 1"`.
+
+Also, import `LatexExpr` globally.
+
+**Apply** [attachment:12156_latex_pretty_print.patch], [attachment:12156_reviewer.patch], [attachment:12156_add_LatexExpr.patch], [attachment:12156_extra_doc.patch],
+[attachment:12156_fix_latex.patch], [attachment:12156_jhp.patch]
 
 Comment: 1
 
``````




---

archive/issue_comments_169521.json:
```json
{
    "body": "Changing reviewer from \"Andrey Novoseltsev, Punarbasu Purkayastha\" to \"Andrey Novoseltsev, Punarbasu Purkayastha, John Palmieri\"",
    "created_at": "2011-12-21T01:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169521",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "Andrey Novoseltsev, Punarbasu Purkayastha" to "Andrey Novoseltsev, Punarbasu Purkayastha, John Palmieri"



---

archive/issue_comments_169522.json:
```json
{
    "body": "<a id='comment:27'></a>I think I'll join the patch party: I'm attaching a patch which rewords a few docstrings. Otherwise, everything looks good to me.  With the patch at #12197 and all of the patches here, all tests pass.\n\nI'm willing to give everything but my patch a positive review.",
    "created_at": "2011-12-21T01:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169522",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>I think I'll join the patch party: I'm attaching a patch which rewords a few docstrings. Otherwise, everything looks good to me.  With the patch at #12197 and all of the patches here, all tests pass.

I'm willing to give everything but my patch a positive review.



---

archive/issue_comments_169523.json:
```json
{
    "body": "<a id='comment:28'></a>Attachment [12156_jhp.patch](tarball://root/attachments/some-uuid/ticket12156/12156_jhp.patch) by @jdemeyer created at 2011-12-21 12:15:20\n\nReviewer patch looks fine.",
    "created_at": "2011-12-21T12:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169523",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Attachment [12156_jhp.patch](tarball://root/attachments/some-uuid/ticket12156/12156_jhp.patch) by @jdemeyer created at 2011-12-21 12:15:20

Reviewer patch looks fine.



---

archive/issue_comments_169524.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-21T12:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169524",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_169525.json:
```json
{
    "body": "<a id='comment:29'></a>I guess you are patching some 4.8alpha version of sage. I was patching 4.7.2, so I had to modify the patch [attachment:12156_fix_latex.patch] for `sage/modular/dirichlet.py` to read as:\n\n```diff\ndiff --git a/sage/modular/dirichlet.py b/sage/modular/dirichlet.py\n--- a/sage/modular/dirichlet.py\n+++ b/sage/modular/dirichlet.py\n@@ -511,7 +511,7 @@\n         for i in range(len(self.values_on_gens())):\n             if i != 0:\n                 mapst += ', '\n-            mapst += latex(self.parent().unit_gens()[i]) + ' \\mapsto ' + latex(self.values_on_gens()[i])\n+            mapst += self.parent().unit_gens()[i]._latex_() + ' \\mapsto ' + self.values_on_gens()[i]._latex_()\n         return r'Dirichlet character modulo %s of conductor %s mapping $%s$'%(self.modulus(), self.conductor(), mapst)\n                  \n         def base_ring(self):\n```\n\nThis, along with #12197 makes it pass the doctests. So, positive review from me too.",
    "created_at": "2011-12-21T13:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169525",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:29'></a>I guess you are patching some 4.8alpha version of sage. I was patching 4.7.2, so I had to modify the patch [attachment:12156_fix_latex.patch] for `sage/modular/dirichlet.py` to read as:

```diff
diff --git a/sage/modular/dirichlet.py b/sage/modular/dirichlet.py
--- a/sage/modular/dirichlet.py
+++ b/sage/modular/dirichlet.py
@@ -511,7 +511,7 @@
         for i in range(len(self.values_on_gens())):
             if i != 0:
                 mapst += ', '
-            mapst += latex(self.parent().unit_gens()[i]) + ' \mapsto ' + latex(self.values_on_gens()[i])
+            mapst += self.parent().unit_gens()[i]._latex_() + ' \mapsto ' + self.values_on_gens()[i]._latex_()
         return r'Dirichlet character modulo %s of conductor %s mapping $%s$'%(self.modulus(), self.conductor(), mapst)
                  
         def base_ring(self):
```

This, along with #12197 makes it pass the doctests. So, positive review from me too.



---

archive/issue_comments_169526.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.8.alpha6\"",
    "created_at": "2011-12-24T01:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169526",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.8.alpha6"



---

archive/issue_comments_169527.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-12-24T01:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12156#issuecomment-169527",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_032314.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-24T01:04:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12156",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12156#event-32314"
}
```
