# Issue 12865: vector matrix multiply causes segfault

archive/issues_012693.json:
```json
{
    "body": "I ran across this while working on overconvergent modular symbols:\n\n```\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\nUnhandled SIGSEGV\nsage: vector(1/1) * matrix(Zmod(11),[[1]])\nUnhandled SIGSEGV\n```\n\n\n\nAssignee: jason, was\n\nCC:  @malb @burcin\n\nKeywords: linbox, segfault\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/12865\n\n",
    "closed_at": "2015-03-03T08:55:59Z",
    "created_at": "2012-04-21T19:39:04Z",
    "labels": [
        "component: linear algebra",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "vector matrix multiply causes segfault",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12865",
    "user": "https://github.com/roed314"
}
```
I ran across this while working on overconvergent modular symbols:

```
sage: vector(1/1) * matrix(Zmod(2),[[1]])
Unhandled SIGSEGV
sage: vector(1/1) * matrix(Zmod(11),[[1]])
Unhandled SIGSEGV
```



Assignee: jason, was

CC:  @malb @burcin

Keywords: linbox, segfault

Upstream: Fixed upstream, in a later stable release.

Reviewer: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/12865





---

archive/issue_comments_161044.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -3,7 +3,11 @@\n ```\n sage: vector(1/1) * matrix(Zmod(2),[[1]])\n Unhandled SIGSEGV\n+sage: vector(1/1) * matrix(Zmod(11),[[1]])\n+Unhandled SIGSEGV\n ```\n+\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2012-04-21T20:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161044",
    "user": "https://github.com/roed314"
}
```

Description changed:
```diff
--- 
+++ 
@@ -3,7 +3,11 @@
 ```
 sage: vector(1/1) * matrix(Zmod(2),[[1]])
 Unhandled SIGSEGV
+sage: vector(1/1) * matrix(Zmod(11),[[1]])
+Unhandled SIGSEGV
 ```
+
+
 
 Comment: 1
 
```




---

archive/issue_comments_161045.json:
```json
{
    "body": "<a id='comment:2'></a>Backtrace looks interesting:\n\n```\n#0  __strncpy_ssse3 () at ../sysdeps/x86_64/multiarch/strcpy.S:94\n#1  0x00007fffd98d3179 in LinboxError (this=0x4aa8100, function=0x7fffd994efe0 \"Modular\", line=102, \n    check=0x7fffd994ce93 \"modulus must be > 1\")\n    at /data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/include/linbox/util/error.h:41\n#2  LinBox::PreconditionFailed::PreconditionFailed (this=0x4aa8100, function=0x7fffd994efe0 \"Modular\", line=102, \n    check=0x7fffd994ce93 \"modulus must be > 1\")\n    at /data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/include/linbox/util/debug.h:52\n...\n```\n(This is on Linux x86_64.)",
    "created_at": "2012-04-21T21:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161045",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>Backtrace looks interesting:

```
#0  __strncpy_ssse3 () at ../sysdeps/x86_64/multiarch/strcpy.S:94
#1  0x00007fffd98d3179 in LinboxError (this=0x4aa8100, function=0x7fffd994efe0 "Modular", line=102, 
    check=0x7fffd994ce93 "modulus must be > 1")
    at /data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/include/linbox/util/error.h:41
#2  LinBox::PreconditionFailed::PreconditionFailed (this=0x4aa8100, function=0x7fffd994efe0 "Modular", line=102, 
    check=0x7fffd994ce93 "modulus must be > 1")
    at /data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/include/linbox/util/debug.h:52
...
```
(This is on Linux x86_64.)



---

archive/issue_comments_161046.json:
```json
{
    "body": "<a id='comment:3'></a>(Identical for both examples.)",
    "created_at": "2012-04-21T21:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161046",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>(Identical for both examples.)



---

archive/issue_comments_161047.json:
```json
{
    "body": "<a id='comment:4'></a>Obviously, this can never have worked, as the `LinboxError` constructor was (implicitly) called with no arguments (hence `msg` defaulting to `0` rather than `\"\"`):\n\n```c++\n// util/error.h\n\n...\nclass LinboxError {\n\tconst static size_t max_error_string = 256;\npublic:\n\tLinboxError (const char* msg = 0) {\n\t\tstd::strncpy(strg, msg, max_error_string);\n\t\tstrg[max_error_string-1] = 0;\n\t};\n...\n```\n\n```c++\n// util/debug.h\n\n...\n\tclass PreconditionFailed : public LinboxError\n\t{\n\t\tstatic std::ostream *_errorStream;\n\n\t    public:\n\t\tPreconditionFailed (const char *function, int line, const char *check) {\n\t\t\tif (_errorStream == (std::ostream *) 0)\n\t\t\t\t_errorStream = &std::cerr;\n\n\t\t\t(*_errorStream) << std::endl << std::endl;\n\t\t\t(*_errorStream) << \"ERROR (\" << function << \":\" << line << \"): \";\n\t\t\t(*_errorStream) << \"Precondition not met:\" << check << std::endl;\n\t\t}\n...\n```\n\n\n\n\nFrom LinBox 1.1.7:\n\n```c++\n...\nclass LinboxError {\n        static const size_t max_error_string = 256;\npublic:\n        LinboxError (const char* msg = '\\0') {\n                std::strncpy(strg, msg, max_error_string);\n                strg[max_error_string-1] = 0;\n        };\n...\n```",
    "created_at": "2012-04-21T23:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161047",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>Obviously, this can never have worked, as the `LinboxError` constructor was (implicitly) called with no arguments (hence `msg` defaulting to `0` rather than `""`):

```c++
// util/error.h

...
class LinboxError {
	const static size_t max_error_string = 256;
public:
	LinboxError (const char* msg = 0) {
		std::strncpy(strg, msg, max_error_string);
		strg[max_error_string-1] = 0;
	};
...
```

```c++
// util/debug.h

...
	class PreconditionFailed : public LinboxError
	{
		static std::ostream *_errorStream;

	    public:
		PreconditionFailed (const char *function, int line, const char *check) {
			if (_errorStream == (std::ostream *) 0)
				_errorStream = &std::cerr;

			(*_errorStream) << std::endl << std::endl;
			(*_errorStream) << "ERROR (" << function << ":" << line << "): ";
			(*_errorStream) << "Precondition not met:" << check << std::endl;
		}
...
```




From LinBox 1.1.7:

```c++
...
class LinboxError {
        static const size_t max_error_string = 256;
public:
        LinboxError (const char* msg = '\0') {
                std::strncpy(strg, msg, max_error_string);
                strg[max_error_string-1] = 0;
        };
...
```



---

archive/issue_comments_161048.json:
```json
{
    "body": "<a id='comment:5'></a>... although the \"fix\" in 1.1.7 is also plain wrong, as it should be `const char *msg = \"\"`, not `= '\\0'`, since the latter again yields a `NULL` pointer, which then causes `strncpy()` to segfault.",
    "created_at": "2012-04-21T23:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161048",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>... although the "fix" in 1.1.7 is also plain wrong, as it should be `const char *msg = ""`, not `= '\0'`, since the latter again yields a `NULL` pointer, which then causes `strncpy()` to segfault.



---

archive/issue_comments_161049.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 leif]:\n> ... although the \"fix\" in 1.1.7 is also plain wrong, as it should be `const char *msg = \"\"`, not `= '\\0'`, since the latter again yields a `NULL` pointer, which then causes `strncpy()` to segfault.\n\n\nBut they've \"fixed\" it in another way... XD\n\n```\n...\n        class PreconditionFailed //: public LinboxError BB: otherwise,  error.h:39 segfaults\n        {\n...\n```\n\nOMG.",
    "created_at": "2012-04-21T23:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161049",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>Replying to [comment:5 leif]:
> ... although the "fix" in 1.1.7 is also plain wrong, as it should be `const char *msg = ""`, not `= '\0'`, since the latter again yields a `NULL` pointer, which then causes `strncpy()` to segfault.


But they've "fixed" it in another way... XD

```
...
        class PreconditionFailed //: public LinboxError BB: otherwise,  error.h:39 segfaults
        {
...
```

OMG.



---

archive/issue_comments_161050.json:
```json
{
    "body": "<a id='comment:7'></a>FWIW, the latest development release, LinBox 1.2.2, still has this !**!** in it.\n\nI'll probably add a proper fix to my LinBox 1.1.6 spkg at #12762.",
    "created_at": "2012-04-21T23:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161050",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>FWIW, the latest development release, LinBox 1.2.2, still has this !**!** in it.

I'll probably add a proper fix to my LinBox 1.1.6 spkg at #12762.



---

archive/issue_comments_161051.json:
```json
{
    "body": "<a id='comment:8'></a>With my fix, I now get a \"proper\" error:\n\n```\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\n\n\nERROR (Modular:102): Precondition not met:modulus must be > 1\nterminate called after throwing an instance of 'LinBox::PreconditionFailed'\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(print_backtrace+0x31)[0x7fb1d13113a3]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(sigdie+0x14)[0x7fb1d13113d5]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(sage_signal_handler+0x1d5)[0x7fb1d1310fc7]\n/lib/libpthread.so.0(+0xf8f0)[0x7fb1d62e68f0]\n/lib/libc.so.6(gsignal+0x35)[0x7fb1d58fda75]\n/lib/libc.so.6(abort+0x180)[0x7fb1d59015c0]\n/usr/lib/libstdc++.so.6(_ZN9__gnu_cxx27__verbose_terminate_handlerEv+0x125)[0x7fb1d0dc0285]\n/usr/lib/libstdc++.so.6(+0x5d1a6)[0x7fb1d0dbe1a6]\n/usr/lib/libstdc++.so.6(+0x5d1d3)[0x7fb1d0dbe1d3]\n/usr/lib/libstdc++.so.6(+0x5d47e)[0x7fb1d0dbe47e]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(_ZN6LinBox7ModularIfEC1El+0xc8)[0x7fb1b85194a8]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(+0x2cf4a)[0x7fb1b8507f4a]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(+0x2fb3b)[0x7fb1b850ab3b]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/action.so(+0x382b)[0x7fb1a510982b]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/structure/coerce.so(+0xf632)[0x7fb1cd5f3632]\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/structure/element.so(+0x1e66c)[0x7fb1cd83766c]\n...\n/lib/libc.so.6(__libc_start_main+0xfd)[0x7fb1d58e8c4d]\npython[0x4006d1]\n\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off(). You might\nwant to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate.\n------------------------------------------------------------------------\n/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/spkg/bin/sage: line 308: 13087 Aborted                 sage-ipython \"$@\" -i\n```\n\nCertainly the Sage library has to get fixed as well.",
    "created_at": "2012-04-21T23:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161051",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>With my fix, I now get a "proper" error:

```
sage: vector(1/1) * matrix(Zmod(2),[[1]])


ERROR (Modular:102): Precondition not met:modulus must be > 1
terminate called after throwing an instance of 'LinBox::PreconditionFailed'
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(print_backtrace+0x31)[0x7fb1d13113a3]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(sigdie+0x14)[0x7fb1d13113d5]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/libcsage.so(sage_signal_handler+0x1d5)[0x7fb1d1310fc7]
/lib/libpthread.so.0(+0xf8f0)[0x7fb1d62e68f0]
/lib/libc.so.6(gsignal+0x35)[0x7fb1d58fda75]
/lib/libc.so.6(abort+0x180)[0x7fb1d59015c0]
/usr/lib/libstdc++.so.6(_ZN9__gnu_cxx27__verbose_terminate_handlerEv+0x125)[0x7fb1d0dc0285]
/usr/lib/libstdc++.so.6(+0x5d1a6)[0x7fb1d0dbe1a6]
/usr/lib/libstdc++.so.6(+0x5d1d3)[0x7fb1d0dbe1d3]
/usr/lib/libstdc++.so.6(+0x5d47e)[0x7fb1d0dbe47e]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(_ZN6LinBox7ModularIfEC1El+0xc8)[0x7fb1b85194a8]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(+0x2cf4a)[0x7fb1b8507f4a]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/matrix_modn_dense_float.so(+0x2fb3b)[0x7fb1b850ab3b]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/matrix/action.so(+0x382b)[0x7fb1a510982b]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/structure/coerce.so(+0xf632)[0x7fb1cd5f3632]
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/local/lib/python2.7/site-packages/sage/structure/element.so(+0x1e66c)[0x7fb1cd83766c]
...
/lib/libc.so.6(__libc_start_main+0xfd)[0x7fb1d58e8c4d]
python[0x4006d1]

------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off(). You might
want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate.
------------------------------------------------------------------------
/data/leif/Sage/sage-5.0.beta10-gcc-4.7.0/spkg/bin/sage: line 308: 13087 Aborted                 sage-ipython "$@" -i
```

Certainly the Sage library has to get fixed as well.



---

archive/issue_comments_161052.json:
```json
{
    "body": "<a id='comment:9'></a>Since you both worked on #4260 (merged into Sage 4.8.alpha3), you probably know how to fix this...\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\n(0)\nsage: vector(1/1) * matrix(Zmod(11),[[1]])\n(0)\n```\n| Sage Version 4.7.2, Release Date: 2011-10-29                       |\n| Type notebook() for the GUI, and license() for information.        |\nWith my limited knowledge, I'd rather expect `(1)` in both cases.",
    "created_at": "2012-04-22T01:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161052",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>Since you both worked on #4260 (merged into Sage 4.8.alpha3), you probably know how to fix this...

```
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: vector(1/1) * matrix(Zmod(2),[[1]])
(0)
sage: vector(1/1) * matrix(Zmod(11),[[1]])
(0)
```
| Sage Version 4.7.2, Release Date: 2011-10-29                       |
| Type notebook() for the GUI, and license() for information.        |
With my limited knowledge, I'd rather expect `(1)` in both cases.



---

archive/issue_comments_161053.json:
```json
{
    "body": "<a id='comment:10'></a>I think it should raise a TypeError, since there's no pushout between the rational field and Zmod(11):\n\n```\nsage: from sage.categories.pushout import pushout\nsage: pushout(QQ,Zmod(11))\nRing of integers modulo 1\nsage: QQ(1) * Zmod(11)(1)\n...\nTypeError: unsupported operand parent(s) for '*': 'Rational Field' and 'Ring of integers modulo 11'\n```",
    "created_at": "2012-04-22T01:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161053",
    "user": "https://github.com/roed314"
}
```

<a id='comment:10'></a>I think it should raise a TypeError, since there's no pushout between the rational field and Zmod(11):

```
sage: from sage.categories.pushout import pushout
sage: pushout(QQ,Zmod(11))
Ring of integers modulo 1
sage: QQ(1) * Zmod(11)(1)
...
TypeError: unsupported operand parent(s) for '*': 'Rational Field' and 'Ring of integers modulo 11'
```



---

archive/issue_comments_161054.json:
```json
{
    "body": "<a id='comment:11'></a>So there are actually *three* things to fix:\n\n* The `LinboxError` constructor (and/or the `Linbox::PreconditionFailed` constructor).\n\n* The modulus has to be checked before calling LinBox, and modulus 1 has to be trivially(?) treated differently, as all of\n\n```\nsage: v=vector([Zmod(1)(1)]); m=matrix(Zmod(1),[[1]])\nsage: v*m\nsage: m*v\nsage: m*m\n```\n   currently fail (while they worked in Sage 4.7.2).\n\n* According to you, the coercion is wrong and should not happen at all. \n\n  (I never really understood the rationale of Sage's coercion model, as from the perspective of programming languages or type theory, any coercion -- as an implicit, automatic type conversion or cast -- should be a type **pro**motion.  And I have no idea how it comes to the ring of integers modulo 1.)\n\nI can fix the first issue (e.g. at #12762); the others, especially the last one, have to get fixed by someone else.",
    "created_at": "2012-04-22T04:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161054",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>So there are actually *three* things to fix:

* The `LinboxError` constructor (and/or the `Linbox::PreconditionFailed` constructor).

* The modulus has to be checked before calling LinBox, and modulus 1 has to be trivially(?) treated differently, as all of

```
sage: v=vector([Zmod(1)(1)]); m=matrix(Zmod(1),[[1]])
sage: v*m
sage: m*v
sage: m*m
```
   currently fail (while they worked in Sage 4.7.2).

* According to you, the coercion is wrong and should not happen at all. 

  (I never really understood the rationale of Sage's coercion model, as from the perspective of programming languages or type theory, any coercion -- as an implicit, automatic type conversion or cast -- should be a type **pro**motion.  And I have no idea how it comes to the ring of integers modulo 1.)

I can fix the first issue (e.g. at #12762); the others, especially the last one, have to get fixed by someone else.



---

archive/issue_comments_161055.json:
```json
{
    "body": "<a id='comment:12'></a>This is apparently fixed by #12883:\n\n```\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\n(0)\nsage: vector(1/1) * matrix(Zmod(11),[[1]])\n(0)\nsage: sage: v=vector([Zmod(1)(1)]); m=matrix(Zmod(1),[[1]])\nsage: sage: v*m\n(0)\nsage: sage: m*v\n(0)\nsage: sage: m*m\n[0]\n```",
    "created_at": "2012-07-03T11:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161055",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>This is apparently fixed by #12883:

```
sage: vector(1/1) * matrix(Zmod(2),[[1]])
(0)
sage: vector(1/1) * matrix(Zmod(11),[[1]])
(0)
sage: sage: v=vector([Zmod(1)(1)]); m=matrix(Zmod(1),[[1]])
sage: sage: v*m
(0)
sage: sage: m*v
(0)
sage: sage: m*m
[0]
```



---

archive/issue_comments_161056.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 vbraun]:\n> This is apparently fixed by #12883\n\n\nShould we then add according doctests [here]?\n\n\nDon't know whether what David mentioned is also properly addressed.",
    "created_at": "2012-07-03T13:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161056",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>Replying to [comment:12 vbraun]:
> This is apparently fixed by #12883


Should we then add according doctests [here]?


Don't know whether what David mentioned is also properly addressed.



---

archive/issue_comments_161057.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2012-07-03T13:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161057",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_info.



---

archive/issue_events_035059.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:34:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35059"
}
```



---

archive/issue_events_035060.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35060"
}
```



---

archive/issue_events_035061.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35061"
}
```



---

archive/issue_events_035062.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35062"
}
```



---

archive/issue_events_035063.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35063"
}
```



---

archive/issue_events_035064.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35064"
}
```



---

archive/issue_events_035065.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35065"
}
```



---

archive/issue_comments_161058.json:
```json
{
    "body": "<a id='comment:19'></a>\n```\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-802e5729e726> in <module>()\n----> 1 vector(Integer(1)/Integer(1)) * matrix(Zmod(Integer(2)),[[Integer(1)]])\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Vector.__mul__ (build/cythonized/sage/structure/element.c:20577)()\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:8764)()\n\nTypeError: unsupported operand parent(s) for '*': 'Vector space of dimension 1 over Rational Field' and 'Full MatrixSpace of 1 by 1 dense matrices over Ring of integers modulo 2'\nsage: vector(1/1) * matrix(Zmod(11),[[1]])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-9ab2f0f0d5e1> in <module>()\n----> 1 vector(Integer(1)/Integer(1)) * matrix(Zmod(Integer(11)),[[Integer(1)]])\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Vector.__mul__ (build/cythonized/sage/structure/element.c:20577)()\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:8764)()\n\nTypeError: unsupported operand parent(s) for '*': 'Vector space of dimension 1 over Rational Field' and 'Full MatrixSpace of 1 by 1 dense matrices over Ring of integers modulo 11'\n```\n\nSo, obsolete?",
    "created_at": "2014-11-12T08:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161058",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:19'></a>
```
sage: vector(1/1) * matrix(Zmod(2),[[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-802e5729e726> in <module>()
----> 1 vector(Integer(1)/Integer(1)) * matrix(Zmod(Integer(2)),[[Integer(1)]])

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Vector.__mul__ (build/cythonized/sage/structure/element.c:20577)()

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:8764)()

TypeError: unsupported operand parent(s) for '*': 'Vector space of dimension 1 over Rational Field' and 'Full MatrixSpace of 1 by 1 dense matrices over Ring of integers modulo 2'
sage: vector(1/1) * matrix(Zmod(11),[[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-9ab2f0f0d5e1> in <module>()
----> 1 vector(Integer(1)/Integer(1)) * matrix(Zmod(Integer(11)),[[Integer(1)]])

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Vector.__mul__ (build/cythonized/sage/structure/element.c:20577)()

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:8764)()

TypeError: unsupported operand parent(s) for '*': 'Vector space of dimension 1 over Rational Field' and 'Full MatrixSpace of 1 by 1 dense matrices over Ring of integers modulo 11'
```

So, obsolete?



---

archive/issue_comments_161059.json:
```json
{
    "body": "<a id='comment:20'></a>Not obsolete... On sage-6.6.beta1 I got it possible again\n\n```\nsage: vector(1/1) * matrix(Zmod(2),[[1]])\n(1)\n```\nSomething has changed in the coercion model and I opened #17859 for that (see also [This is the Trac macro *comment:11* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:11-macro) which already pointed out the issue).\n\nI propose to move this ticket to fixed since it is ok with Linbox.",
    "created_at": "2015-02-26T09:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161059",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Not obsolete... On sage-6.6.beta1 I got it possible again

```
sage: vector(1/1) * matrix(Zmod(2),[[1]])
(1)
```
Something has changed in the coercion model and I opened #17859 for that (see also [This is the Trac macro *comment:11* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:11-macro) which already pointed out the issue).

I propose to move this ticket to fixed since it is ok with Linbox.



---

archive/issue_events_035066.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-02-26T09:54:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35066"
}
```



---

archive/issue_events_035067.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-02-26T09:54:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35067"
}
```



---

archive/issue_comments_161060.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2015-02-26T09:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161060",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_161061.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-02T13:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161061",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_161062.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-03T08:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12865#issuecomment-161062",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_035068.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-03T08:55:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12865",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12865#event-35068"
}
```
