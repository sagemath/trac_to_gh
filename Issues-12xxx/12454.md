# Issue 12454: A draw_rauzy_fractal method for WordMorphism

archive/issues_012282.json:
```json
{
    "assignees": [],
    "body": "**New:**\n- 2012-07-05: added basis projection plotting\n- Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.\n- Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.\n- Error message in the case where the eigenvalue is of degree one.\n- New patch for version 5.0.1 (but doesn't apply with the bot for some reason).\n- A few other things.\n\nFrom the docstring:\n\nReturns a plot of the Rauzy fractal associated with a substitution.\nThe substitution does not have to be irreducible.\nThe definition used can be found found for example in [1].\nThe usual definition of a Rauzy fractal requires that\nits dominant eigenvalue is a Pisot number. The present method\ndoesn't require this, allowing to plot some interesting pictures\nin the non-Pisot case (see the examples below).\n\nPlots with less than 100,000 points take a few seconds,\nand several millions of points can be plotted in reasonable time.\n\nAssignee: **sage-combinat**\n\nCC:  @seblabbe tmonteil @videlec @staroste\n\nKeywords: **rauzy fractal, substitution, word morphism, lounge**\n\nReviewer: **Vincent Delecroix, S\u00e9bastien Labb\u00e9**\n\nAuthor: **Timo Jolivet**\n\nMerged: **sage-5.3.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/12454_\n\n",
    "closed_at": "2012-08-12T18:58:05Z",
    "created_at": "2012-02-06T21:43:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "A draw_rauzy_fractal method for WordMorphism",
    "type": "issue",
    "updated_at": "2018-04-18T15:28:02Z",
    "url": "https://github.com/sagemath/sage/issues/12454",
    "user": "https://github.com/sagetrac-tjolivet"
}
```
**New:**
- 2012-07-05: added basis projection plotting
- Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.
- Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.
- Error message in the case where the eigenvalue is of degree one.
- New patch for version 5.0.1 (but doesn't apply with the bot for some reason).
- A few other things.

From the docstring:

Returns a plot of the Rauzy fractal associated with a substitution.
The substitution does not have to be irreducible.
The definition used can be found found for example in [1].
The usual definition of a Rauzy fractal requires that
its dominant eigenvalue is a Pisot number. The present method
doesn't require this, allowing to plot some interesting pictures
in the non-Pisot case (see the examples below).

Plots with less than 100,000 points take a few seconds,
and several millions of points can be plotted in reasonable time.

Assignee: **sage-combinat**

CC:  @seblabbe tmonteil @videlec @staroste

Keywords: **rauzy fractal, substitution, word morphism, lounge**

Reviewer: **Vincent Delecroix, Sébastien Labbé**

Author: **Timo Jolivet**

Merged: **sage-5.3.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/12454_





---

archive/issue_events_150476.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-02-06T21:43:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150476"
}
```



---

archive/issue_events_150477.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-02-06T21:43:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150477"
}
```



---

archive/issue_events_150478.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-02-06T21:43:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150478"
}
```



---

archive/issue_events_150479.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-02-06T21:43:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150479"
}
```



---

archive/issue_comments_139705.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Returns a plot of the Rauzy fractal associated with a substitution that admits a real eigenvalue of degree 3.  The substitution does not have to be irreducible, and there are no restrictions on its alphabet.\n \n-plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.\n+Simple plots (50,000 points) take about 2 seconds, plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.\n \n The definition used can be found found for example in [1].  The usual definition of a Rauzy fractal requires that its dominant eigenvalue is a Pisot number. The present code doesn't require this, allowing to plot some interesting pictures in the non-Pisot case (see the examples below).\n \n``````\n",
    "created_at": "2012-02-06T21:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139705",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Returns a plot of the Rauzy fractal associated with a substitution that admits a real eigenvalue of degree 3.  The substitution does not have to be irreducible, and there are no restrictions on its alphabet.
 
-plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.
+Simple plots (50,000 points) take about 2 seconds, plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.
 
 The definition used can be found found for example in [1].  The usual definition of a Rauzy fractal requires that its dominant eigenvalue is a Pisot number. The present code doesn't require this, allowing to plot some interesting pictures in the non-Pisot case (see the examples below).
 
``````




---

archive/issue_events_150480.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-02-07T07:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150480"
}
```



---

archive/issue_comments_139706.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nI've added a new version of the patch, with a new option ``opacity`` and an enhanced version of option ``color`` (see docstring).",
    "created_at": "2012-02-08T08:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139706",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:3'>Comment 3:</a>
I've added a new version of the patch, with a new option ``opacity`` and an enhanced version of option ``color`` (see docstring).



---

archive/issue_comments_139707.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI'd be glad if anyone can explain me why the patchbot says \"TestsFailed\". sage -t and docbuild run fine on my machine.",
    "created_at": "2012-02-08T08:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139707",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:4'>Comment 4:</a>
I'd be glad if anyone can explain me why the patchbot says "TestsFailed". sage -t and docbuild run fine on my machine.



---

archive/issue_comments_139708.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nMaybe because of trailing whitespaces ?\n\nThe log says :\n\n```\nValueError: Trailing whitespace inserted on 16 non-empty lines.\n```",
    "created_at": "2012-02-08T15:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139708",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'>Comment 5:</a>
Maybe because of trailing whitespaces ?

The log says :

```
ValueError: Trailing whitespace inserted on 16 non-empty lines.
```



---

archive/issue_comments_139709.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nThanks, there were indeed some ugly trailing whitespaces.\n\nI removed them but the tests still fail and I can't decipher the log. It seems that the problems come from some code other than this patch. What's the problem then?",
    "created_at": "2012-02-08T16:53:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139709",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:6'>Comment 6:</a>
Thanks, there were indeed some ugly trailing whitespaces.

I removed them but the tests still fail and I can't decipher the log. It seems that the problems come from some code other than this patch. What's the problem then?



---

archive/issue_events_150481.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-02-10T13:42:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150481"
}
```



---

archive/issue_events_150482.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-02-10T13:42:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150482"
}
```



---

archive/issue_comments_139710.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nHelloooooooo !!!\n\nThe tests do not pass, and the reason why you do not see it is that to actually test your patch you need both -optional and -long flags.\n\n```\n~/.Sage/devel/sage-2/sage/combinat/words$ sage -b 2 && sage -t -long -optional morphism.py \n[...]\nsage -t -long -optional \"devel/sage-2/sage/combinat/words/morphism.py\"\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-2/sage/combinat/words/morphism.py\", line 2027:\n    sage: s.plot_rauzy_fractal(color={1:'black', 2:'black', 3:'black'})    # optional long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_42[18]>\", line 1, in <module>\n        s.plot_rauzy_fractal(color={Integer(1):'black', Integer(2):'black', Integer(3):'black'})    # optional long time###line 2027:\n    sage: s.plot_rauzy_fractal(color={1:'black', 2:'black', 3:'black'})    # optional long time\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/words/morphism.py\", line 2139, in plot_rauzy_fractal\n        G += points(D[a], color=col_dict[a], alpha=opacity[a], size=point_size)\n    KeyError: 1\n~/.Sage/devel/sage-2/sage/combinat/words$\n```\n\nActually, only a -long flag should be needed here (by removing the keyword 'optional' from the commented lines), shouldn'it ?\n\nNathann",
    "created_at": "2012-02-10T13:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139710",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'>Comment 7:</a>
Helloooooooo !!!

The tests do not pass, and the reason why you do not see it is that to actually test your patch you need both -optional and -long flags.

```
~/.Sage/devel/sage-2/sage/combinat/words$ sage -b 2 && sage -t -long -optional morphism.py 
[...]
sage -t -long -optional "devel/sage-2/sage/combinat/words/morphism.py"
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-2/sage/combinat/words/morphism.py", line 2027:
    sage: s.plot_rauzy_fractal(color={1:'black', 2:'black', 3:'black'})    # optional long time
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_42[18]>", line 1, in <module>
        s.plot_rauzy_fractal(color={Integer(1):'black', Integer(2):'black', Integer(3):'black'})    # optional long time###line 2027:
    sage: s.plot_rauzy_fractal(color={1:'black', 2:'black', 3:'black'})    # optional long time
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/words/morphism.py", line 2139, in plot_rauzy_fractal
        G += points(D[a], color=col_dict[a], alpha=opacity[a], size=point_size)
    KeyError: 1
~/.Sage/devel/sage-2/sage/combinat/words$
```

Actually, only a -long flag should be needed here (by removing the keyword 'optional' from the commented lines), shouldn'it ?

Nathann



---

archive/issue_comments_139711.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@nathanncohen](#comment%3A7):\n> Helloooooooo !!!\n> \n> The tests do not pass, and the reason why you do not see it is that to actually test your patch you need both -optional and -long flags.\n\nThanks! I fixed the doc mistake, let's hope it works now.",
    "created_at": "2012-02-12T11:16:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139711",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@nathanncohen](#comment%3A7):
> Helloooooooo !!!
> 
> The tests do not pass, and the reason why you do not see it is that to actually test your patch you need both -optional and -long flags.

Thanks! I fixed the doc mistake, let's hope it works now.



---

archive/issue_comments_139712.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nHello,\n\nNice, all tests pass. The documentation is clear and the examples very interesting.\n\n1) For the construction of colors, there is a built in functions \"rainbow\" in sage.plot.colors (you can call it with 'rgbtuple' option).\n\n2) You should never use an error catch (try ... except ...) which catches all errors. The way you did, it would be impossible to send a stop signal to the process using C-c. You have to write something like\n\ntry:\n  blabla\nexcept TypeError,ValueError:\n  pass\n\nwhere the tuple of errors you use is the one which may be raised by the code in blabla. Errors may be produced from other part of the code and you should not intercept them!\n\n2') The loop you use for finding a fixed point (actually a periodic point) is very dirty!! You should be able to compute the smallest k for which sigma**k(0) starts with 0...  For example you can build the substitution tau which sends alpha to the first letter (or last if reversal) of sigma(alpha). And then, you can search for a cycle of tau which gives you periodic points. The best way would be to add a method in WordMorphism which does it for you... (perhaps an other ticket).\n\nNext to come. If you like I can implement 2') in another ticket ?\n\nVincent",
    "created_at": "2012-02-12T13:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139712",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'>Comment 10:</a>
Hello,

Nice, all tests pass. The documentation is clear and the examples very interesting.

1) For the construction of colors, there is a built in functions "rainbow" in sage.plot.colors (you can call it with 'rgbtuple' option).

2) You should never use an error catch (try ... except ...) which catches all errors. The way you did, it would be impossible to send a stop signal to the process using C-c. You have to write something like

try:
  blabla
except TypeError,ValueError:
  pass

where the tuple of errors you use is the one which may be raised by the code in blabla. Errors may be produced from other part of the code and you should not intercept them!

2') The loop you use for finding a fixed point (actually a periodic point) is very dirty!! You should be able to compute the smallest k for which sigma**k(0) starts with 0...  For example you can build the substitution tau which sends alpha to the first letter (or last if reversal) of sigma(alpha). And then, you can search for a cycle of tau which gives you periodic points. The best way would be to add a method in WordMorphism which does it for you... (perhaps an other ticket).

Next to come. If you like I can implement 2') in another ticket ?

Vincent



---

archive/issue_comments_139713.json:
```json
{
    "body": "Reviewer: **vdelecroix**",
    "created_at": "2012-02-12T13:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139713",
    "user": "https://github.com/videlec"
}
```

Reviewer: **vdelecroix**



---

archive/issue_comments_139714.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nHi Vincent, thanks for you review.\n\nReplying to [@videlec](#comment%3A10):\n> 1) For the construction of colors, there is a built in functions \"rainbow\" in sage.plot.colors (you can call it with 'rgbtuple' option).\n\nYes, I'm aware of the rainbow function, but colormaps offers many color schemes and it works fine, so I used it.\n\n> 2) and 2')\n\nYes, indeed this is not very clean and I should have done otherwise... Yes you can implement 2') if you want! (Maybe we could add an option in the .fixed_point that forces to return a fixed point of the substitution (or a power), because it's annoying to have to trick with substitution which don't have a \"true\" fixed point.)\n\nCheers,\nTimo",
    "created_at": "2012-02-12T18:09:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139714",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:11'>Comment 11:</a>
Hi Vincent, thanks for you review.

Replying to [@videlec](#comment%3A10):
> 1) For the construction of colors, there is a built in functions "rainbow" in sage.plot.colors (you can call it with 'rgbtuple' option).

Yes, I'm aware of the rainbow function, but colormaps offers many color schemes and it works fine, so I used it.

> 2) and 2')

Yes, indeed this is not very clean and I should have done otherwise... Yes you can implement 2') if you want! (Maybe we could add an option in the .fixed_point that forces to return a fixed point of the substitution (or a power), because it's annoying to have to trick with substitution which don't have a "true" fixed point.)

Cheers,
Timo



---

archive/issue_comments_139715.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\n> Replying to [@videlec](#comment%3A10):\n> > 1) For the construction of colors, there is a built in functions \"rainbow\" in sage.plot.colors (you can call it with 'rgbtuple' option).\n\n> \n> Yes, I'm aware of the rainbow function, but colormaps offers many color schemes and it works fine, so I used it.\n\nI see. Your way is definitely better.\n\n> > 2) and 2')\n\nIt is now #12512. Could you replace your loop with either\n\n```\nu = iter(self.periodic_point(letter))\n```\nwhere letter is a parameter, or\n\n```\nu = iter(self.periodic_points()[0][0])\n```\n\n3) Why did you choose 1000 for the precision of the complex field ? It seems a little bit big for your purpose. Won't you make it a parameter (with a reasonable default value) ?\n\n4) Why do you assume that the root is cubic ? On one hand, if they are ordered as |l_1| > |l_2| > 1 > |l_3| then you will get a strange Rauzy fractal, won't you ? On the other hand, I have examples for which the absolute values of eigenvalues are ordered as |l_1| > |l_2| > 1 > |l_3| > |l_4|. Then you can obtain a Rauzy fractal after a projection parallel to v_1 and v_2 on the plane generated by v_3 and v_4 (where v_i is an eigenvector associated to l_i). In other words, I'm a little bit confused with your restrictions.\n\nOtherwise, everything is very nice. You should now write a tutorial with both methods for drawing Rauzy fractals with nice pictures and put it in the documentation ;-)",
    "created_at": "2012-02-15T12:02:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139715",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'>Comment 12:</a>
> Replying to [@videlec](#comment%3A10):
> > 1) For the construction of colors, there is a built in functions "rainbow" in sage.plot.colors (you can call it with 'rgbtuple' option).

> 
> Yes, I'm aware of the rainbow function, but colormaps offers many color schemes and it works fine, so I used it.

I see. Your way is definitely better.

> > 2) and 2')

It is now #12512. Could you replace your loop with either

```
u = iter(self.periodic_point(letter))
```
where letter is a parameter, or

```
u = iter(self.periodic_points()[0][0])
```

3) Why did you choose 1000 for the precision of the complex field ? It seems a little bit big for your purpose. Won't you make it a parameter (with a reasonable default value) ?

4) Why do you assume that the root is cubic ? On one hand, if they are ordered as |l_1| > |l_2| > 1 > |l_3| then you will get a strange Rauzy fractal, won't you ? On the other hand, I have examples for which the absolute values of eigenvalues are ordered as |l_1| > |l_2| > 1 > |l_3| > |l_4|. Then you can obtain a Rauzy fractal after a projection parallel to v_1 and v_2 on the plane generated by v_3 and v_4 (where v_i is an eigenvector associated to l_i). In other words, I'm a little bit confused with your restrictions.

Otherwise, everything is very nice. You should now write a tutorial with both methods for drawing Rauzy fractals with nice pictures and put it in the documentation ;-)



---

archive/issue_comments_139716.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,19 @@\n+**New:** 1D and 3D plots are supported, more options, more clean.\n+**TODO:** allow to plot translated copies and to choose the fixed point.\n+\n From the docstring:\n \n-Returns a plot of the Rauzy fractal associated with a substitution that admits a real eigenvalue of degree 3.  The substitution does not have to be irreducible, and there are no restrictions on its alphabet.\n+Returns a plot of the Rauzy fractal associated with a substitution.\n+The substitution does not have to be irreducible,\n+The definition used can be found found for example in [1].\n+The usual definition of a Rauzy fractal requires that\n+its dominant eigenvalue is a Pisot number. The present code\n+doesn't require this, allowing to plot some interesting pictures\n+in the non-Pisot case (see the examples below).\n \n-Simple plots (50,000 points) take about 2 seconds, plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.\n+Plots with less than 500,000 points usually take less than 30 seconds,\n+and several millions of points can be plotted in reasonable time.\n \n-The definition used can be found found for example in [1].  The usual definition of a Rauzy fractal requires that its dominant eigenvalue is a Pisot number. The present code doesn't require this, allowing to plot some interesting pictures in the non-Pisot case (see the examples below).\n-\n-Other ways to draw Rauzy fractals (but less general) can be found in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection`` or in ``sage.combinat.e_one_star``.  (The former however allows to plot some 3D Rauzy fractals associated with some quadratic Pisot numbers.)\n+Other ways to draw Rauzy fractals (but less general) can be found\n+in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection``\n+or in ``sage.combinat.e_one_star``.\n``````\n",
    "created_at": "2012-05-21T23:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139716",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,19 @@
+**New:** 1D and 3D plots are supported, more options, more clean.
+**TODO:** allow to plot translated copies and to choose the fixed point.
+
 From the docstring:
 
-Returns a plot of the Rauzy fractal associated with a substitution that admits a real eigenvalue of degree 3.  The substitution does not have to be irreducible, and there are no restrictions on its alphabet.
+Returns a plot of the Rauzy fractal associated with a substitution.
+The substitution does not have to be irreducible,
+The definition used can be found found for example in [1].
+The usual definition of a Rauzy fractal requires that
+its dominant eigenvalue is a Pisot number. The present code
+doesn't require this, allowing to plot some interesting pictures
+in the non-Pisot case (see the examples below).
 
-Simple plots (50,000 points) take about 2 seconds, plots with less than 500,000 points usually take less than 30 seconds, and several millions of points can be plotted in reasonable time.
+Plots with less than 500,000 points usually take less than 30 seconds,
+and several millions of points can be plotted in reasonable time.
 
-The definition used can be found found for example in [1].  The usual definition of a Rauzy fractal requires that its dominant eigenvalue is a Pisot number. The present code doesn't require this, allowing to plot some interesting pictures in the non-Pisot case (see the examples below).
-
-Other ways to draw Rauzy fractals (but less general) can be found in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection`` or in ``sage.combinat.e_one_star``.  (The former however allows to plot some 3D Rauzy fractals associated with some quadratic Pisot numbers.)
+Other ways to draw Rauzy fractals (but less general) can be found
+in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection``
+or in ``sage.combinat.e_one_star``.
``````




---

archive/issue_events_150483.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-06-04T13:41:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150483"
}
```



---

archive/issue_events_150484.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-06-04T13:41:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150484"
}
```



---

archive/issue_comments_139717.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,19 +1,17 @@\n-**New:** 1D and 3D plots are supported, more options, more clean.\n-**TODO:** allow to plot translated copies and to choose the fixed point.\n+**New:**\n+- Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.\n+- Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.\n+- A few other things.\n \n From the docstring:\n \n Returns a plot of the Rauzy fractal associated with a substitution.\n-The substitution does not have to be irreducible,\n+The substitution does not have to be irreducible.\n The definition used can be found found for example in [1].\n The usual definition of a Rauzy fractal requires that\n-its dominant eigenvalue is a Pisot number. The present code\n+its dominant eigenvalue is a Pisot number. The present method\n doesn't require this, allowing to plot some interesting pictures\n in the non-Pisot case (see the examples below).\n \n-Plots with less than 500,000 points usually take less than 30 seconds,\n+Plots with less than 100,000 points take a few seonds,\n and several millions of points can be plotted in reasonable time.\n-\n-Other ways to draw Rauzy fractals (but less general) can be found\n-in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection``\n-or in ``sage.combinat.e_one_star``.\n``````\n",
    "created_at": "2012-06-04T13:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139717",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,19 +1,17 @@
-**New:** 1D and 3D plots are supported, more options, more clean.
-**TODO:** allow to plot translated copies and to choose the fixed point.
+**New:**
+- Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.
+- Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.
+- A few other things.
 
 From the docstring:
 
 Returns a plot of the Rauzy fractal associated with a substitution.
-The substitution does not have to be irreducible,
+The substitution does not have to be irreducible.
 The definition used can be found found for example in [1].
 The usual definition of a Rauzy fractal requires that
-its dominant eigenvalue is a Pisot number. The present code
+its dominant eigenvalue is a Pisot number. The present method
 doesn't require this, allowing to plot some interesting pictures
 in the non-Pisot case (see the examples below).
 
-Plots with less than 500,000 points usually take less than 30 seconds,
+Plots with less than 100,000 points take a few seonds,
 and several millions of points can be plotted in reasonable time.
-
-Other ways to draw Rauzy fractals (but less general) can be found
-in ``sage.combinat.words.paths.FiniteWordPath_3d.plot_projection``
-or in ``sage.combinat.e_one_star``.
``````




---

archive/issue_comments_139718.json:
```json
{
    "body": "Changed keywords from **rauzy fractal, substitution, word morphism** to **rauzy fractal, substitution, word morphism, lounge**",
    "created_at": "2012-06-04T21:08:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139718",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed keywords from **rauzy fractal, substitution, word morphism** to **rauzy fractal, substitution, word morphism, lounge**



---

archive/issue_comments_139719.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n **New:**\n - Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.\n - Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.\n+- Error message in the case where the eigenvalue is of degree one.\n+- New patch for version 5.0.1 (but doesn't apply with the bot for some reason).\n - A few other things.\n \n From the docstring:\n@@ -13,5 +15,5 @@\n doesn't require this, allowing to plot some interesting pictures\n in the non-Pisot case (see the examples below).\n \n-Plots with less than 100,000 points take a few seonds,\n+Plots with less than 100,000 points take a few seconds,\n and several millions of points can be plotted in reasonable time.\n``````\n",
    "created_at": "2012-06-18T15:07:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139719",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
 **New:**
 - Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.
 - Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.
+- Error message in the case where the eigenvalue is of degree one.
+- New patch for version 5.0.1 (but doesn't apply with the bot for some reason).
 - A few other things.
 
 From the docstring:
@@ -13,5 +15,5 @@
 doesn't require this, allowing to plot some interesting pictures
 in the non-Pisot case (see the examples below).
 
-Plots with less than 100,000 points take a few seonds,
+Plots with less than 100,000 points take a few seconds,
 and several millions of points can be plotted in reasonable time.
``````




---

archive/issue_comments_139720.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n **New:**\n+- 2012-07-05: added basis projection plotting\n - Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.\n - Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.\n - Error message in the case where the eigenvalue is of degree one.\n``````\n",
    "created_at": "2012-07-05T11:51:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139720",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
 **New:**
+- 2012-07-05: added basis projection plotting
 - Now there are two distinct methods ``rauzy_fractal_plot`` and ``rauzy_fractal_points``.
 - Translated copies of the fractal and its pieces can be plotted, allowing all kinds of tiling plots.
 - Error message in the case where the eigenvalue is of degree one.
``````




---

archive/issue_events_150485.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2012-07-10T08:12:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150485"
}
```



---

archive/issue_events_150486.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2012-07-10T08:12:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150486"
}
```



---

archive/issue_comments_139721.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nWorks with sage-5.1.rc1. Documentation builds.\n\nNice patch! Could you add some pictures to the gallery http://wiki.sagemath.org/pics when the patch will be in the stable release ?",
    "created_at": "2012-07-10T08:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139721",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'>Comment 18:</a>
Works with sage-5.1.rc1. Documentation builds.

Nice patch! Could you add some pictures to the gallery http://wiki.sagemath.org/pics when the patch will be in the stable release ?



---

archive/issue_comments_139722.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@videlec](#comment%3A18):\n> Nice patch! Could you add some pictures to the gallery http://wiki.sagemath.org/pics when the patch will be in the stable release ?\n\nYeps! Thanks.",
    "created_at": "2012-07-10T08:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139722",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@videlec](#comment%3A18):
> Nice patch! Could you add some pictures to the gallery http://wiki.sagemath.org/pics when the patch will be in the stable release ?

Yeps! Thanks.



---

archive/issue_events_150487.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-10T13:17:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150487"
}
```



---

archive/issue_events_150488.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-10T13:17:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150488"
}
```



---

archive/issue_comments_139723.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nPlease write your real names in the Author/Reviewer fields.",
    "created_at": "2012-07-11T09:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139723",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'>Comment 21:</a>
Please write your real names in the Author/Reviewer fields.



---

archive/issue_comments_139724.json:
```json
{
    "body": "Changed reviewer from **vdelecroix** to **Vincent Delecroix**",
    "created_at": "2012-07-11T09:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139724",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Changed reviewer from **vdelecroix** to **Vincent Delecroix**



---

archive/issue_comments_139725.json:
```json
{
    "body": "Changed author from **tjolivet** to **Timo Jolivet**",
    "created_at": "2012-07-11T09:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139725",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Changed author from **tjolivet** to **Timo Jolivet**



---

archive/issue_events_150489.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:34:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150489"
}
```



---

archive/issue_events_150490.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:34:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150490"
}
```



---

archive/issue_comments_139726.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nThis should be rebased to sage-5.2.rc1.",
    "created_at": "2012-07-27T20:34:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139726",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'>Comment 23:</a>
This should be rebased to sage-5.2.rc1.



---

archive/issue_comments_139727.json:
```json
{
    "body": "Attachment: **[trac-12454-rauzyfractal-tj.patch.gz](https://github.com/sagemath/sage/files/ticket12454/trac-12454-rauzyfractal-tj.patch.gz)**\n\nrebased to sage-5.2.rc1",
    "created_at": "2012-07-29T17:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139727",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

Attachment: **[trac-12454-rauzyfractal-tj.patch.gz](https://github.com/sagemath/sage/files/ticket12454/trac-12454-rauzyfractal-tj.patch.gz)**

rebased to sage-5.2.rc1



---

archive/issue_comments_139728.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nA test fails but it doesn't seem to come from this patch.\n\nIt would be great if this could make it into sage-5.2.",
    "created_at": "2012-07-30T08:32:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139728",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:24'>Comment 24:</a>
A test fails but it doesn't seem to come from this patch.

It would be great if this could make it into sage-5.2.



---

archive/issue_events_150491.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-07-30T08:32:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150491"
}
```



---

archive/issue_events_150492.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-07-30T08:32:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150492"
}
```



---

archive/issue_comments_139729.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nI am ready to give positive review provided the three following things are satisfied :\n\n- doctest timing do not take too much longer than before\n- documentation issue are fixed (done in my first review patch)\n- method `rauzy_fractal_points` is split into two (done in my second review patch)\n\n... and of course if Timo and others agree with my patches.\n\nIndeed,\n\n1. Testing the file `morphism.py` now takes way more time than before. I think `sage -t sage_library_file.py` should run in 10s and `sage -t -long -optional sage_library_file.py` in no more than 40 seconds (these are my standards, I don't know if there exist any in the Sage Developper Guide). Instead of drawing 10000 points, you can draw 100 points for the doctests. If you want to keep those doctests interesting for the user, you may add `#not tested takes > 3 seconds`. Or, you can add a remark at the beginning of the examples saying the value `n=100` below is low for doctests purposes, larger values of n can be given by the user. \n\nBEFORE:\n\n```\n $ sage-5.2.rc0 -t morphism.py \nsage -t  \"devel/sage-main/sage/combinat/words/morphism.py\"  \n\t [4.4 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 4.4 seconds\n $ sage-5.2.rc0 -t -long -optional morphism.py \nsage -t -long -optional \"devel/sage-main/sage/combinat/words/morphism.py\"\n\t [6.6 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 6.6 seconds\n```\n\nAFTER:\n\n```\n $ sage-5.2.rc0 -t morphism.py \nsage -t  \"devel/sage-main/sage/combinat/words/morphism.py\"  \n\t [30.4 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 30.4 seconds\n\n$ sage-5.2.rc0 -t -long -optional morphism.py \nsage -t -long -optional \"devel/sage-main/sage/combinat/words/morphism.py\"\n\t [255.9 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 256.0 seconds\n```\n\n2. I uploaded two patches which applies on top of Timo's one. The first fixes some documentation issues. \n\n3. The second patch splits the method `rauzy_fractal_points` into two. As I already explained verbaly to Timo, I dislike the idea of having output types (dict vs 2-tuple of dict) depending on the input. Instead I propose to split the method into two and doing it made me realize that the second output only depends on two of the inputs. So, now the user can obtain this output without generating points and by providing only the necessary two inputs.",
    "created_at": "2012-07-30T21:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139729",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:25'>Comment 25:</a>
I am ready to give positive review provided the three following things are satisfied :

- doctest timing do not take too much longer than before
- documentation issue are fixed (done in my first review patch)
- method `rauzy_fractal_points` is split into two (done in my second review patch)

... and of course if Timo and others agree with my patches.

Indeed,

1. Testing the file `morphism.py` now takes way more time than before. I think `sage -t sage_library_file.py` should run in 10s and `sage -t -long -optional sage_library_file.py` in no more than 40 seconds (these are my standards, I don't know if there exist any in the Sage Developper Guide). Instead of drawing 10000 points, you can draw 100 points for the doctests. If you want to keep those doctests interesting for the user, you may add `#not tested takes > 3 seconds`. Or, you can add a remark at the beginning of the examples saying the value `n=100` below is low for doctests purposes, larger values of n can be given by the user. 

BEFORE:

```
 $ sage-5.2.rc0 -t morphism.py 
sage -t  "devel/sage-main/sage/combinat/words/morphism.py"  
	 [4.4 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 4.4 seconds
 $ sage-5.2.rc0 -t -long -optional morphism.py 
sage -t -long -optional "devel/sage-main/sage/combinat/words/morphism.py"
	 [6.6 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 6.6 seconds
```

AFTER:

```
 $ sage-5.2.rc0 -t morphism.py 
sage -t  "devel/sage-main/sage/combinat/words/morphism.py"  
	 [30.4 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 30.4 seconds

$ sage-5.2.rc0 -t -long -optional morphism.py 
sage -t -long -optional "devel/sage-main/sage/combinat/words/morphism.py"
	 [255.9 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 256.0 seconds
```

2. I uploaded two patches which applies on top of Timo's one. The first fixes some documentation issues. 

3. The second patch splits the method `rauzy_fractal_points` into two. As I already explained verbaly to Timo, I dislike the idea of having output types (dict vs 2-tuple of dict) depending on the input. Instead I propose to split the method into two and doing it made me realize that the second output only depends on two of the inputs. So, now the user can obtain this output without generating points and by providing only the necessary two inputs.



---

archive/issue_comments_139730.json:
```json
{
    "body": "Attachment: **[12454_review-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review-sl.patch.gz)**",
    "created_at": "2012-07-30T22:03:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139730",
    "user": "https://github.com/seblabbe"
}
```

Attachment: **[12454_review-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review-sl.patch.gz)**



---

archive/issue_events_150493.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2012-07-30T22:07:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150493"
}
```



---

archive/issue_events_150494.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2012-07-30T22:07:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150494"
}
```



---

archive/issue_comments_139731.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nAttachment: **[12454_review_split-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review_split-sl.patch.gz)**\n\n4. Also, if you could add a sentence explaining how the projection is obtained from the eigenvalue inside the doc of the method `rauzy_fractal_projection`, it would be great!",
    "created_at": "2012-07-30T22:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139731",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:26'>Comment 26:</a>
Attachment: **[12454_review_split-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review_split-sl.patch.gz)**

4. Also, if you could add a sentence explaining how the projection is obtained from the eigenvalue inside the doc of the method `rauzy_fractal_projection`, it would be great!



---

archive/issue_comments_139732.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, S\u00e9bastien Labb\u00e9**",
    "created_at": "2012-07-30T22:07:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139732",
    "user": "https://github.com/seblabbe"
}
```

Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Sébastien Labbé**



---

archive/issue_comments_139733.json:
```json
{
    "body": "apply after the three above patches",
    "created_at": "2012-07-31T18:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139733",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

apply after the three above patches



---

archive/issue_comments_139734.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nAttachment: **[12454_tj-2.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_tj-2.patch.gz)**\n\nHi,\n\nThanks for the corrections which I find useful and clarifying.\n\nI strongly improved the testing time and pointed (another time) the details of the construction to a reference in the doc.\n\nTimo",
    "created_at": "2012-07-31T18:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139734",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:28'>Comment 28:</a>
Attachment: **[12454_tj-2.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_tj-2.patch.gz)**

Hi,

Thanks for the corrections which I find useful and clarifying.

I strongly improved the testing time and pointed (another time) the details of the construction to a reference in the doc.

Timo



---

archive/issue_comments_139735.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nI just added some more improvements. Also added few tested doctest.\n\nI give positive review to Timo's patches which answered my concerns. If he agrees with my patch, Timo can change the status of this ticket to positive review.\n\nS\u00e9bastien",
    "created_at": "2012-07-31T18:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139735",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:29'>Comment 29:</a>
I just added some more improvements. Also added few tested doctest.

I give positive review to Timo's patches which answered my concerns. If he agrees with my patch, Timo can change the status of this ticket to positive review.

Sébastien



---

archive/issue_events_150495.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-07-31T18:43:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150495"
}
```



---

archive/issue_events_150496.json:
```json
{
    "actor": "https://github.com/sagetrac-tjolivet",
    "created_at": "2012-07-31T18:43:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150496"
}
```



---

archive/issue_comments_139736.json:
```json
{
    "body": "Attachment: **[12454_review_third-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review_third-sl.patch.gz)**\n\nApplies over all the preceding patches",
    "created_at": "2012-07-31T22:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139736",
    "user": "https://github.com/seblabbe"
}
```

Attachment: **[12454_review_third-sl.patch.gz](https://github.com/sagemath/sage/files/ticket12454/12454_review_third-sl.patch.gz)**

Applies over all the preceding patches



---

archive/issue_events_150497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-12T18:58:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150497"
}
```



---

archive/issue_events_150498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-12T18:58:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/12454#event-150498"
}
```



---

archive/issue_comments_139737.json:
```json
{
    "body": "Merged: **sage-5.3.beta1**",
    "created_at": "2012-08-12T18:58:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139737",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.3.beta1**



---

archive/issue_comments_139738.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nWhat's the rationale for code like\n\n```\ncm.__dict__[\"gist_gray\"]\n```\ninstead of more simply\n\n```\ncm.gist_gray\n```",
    "created_at": "2018-04-18T11:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139738",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'>Comment 32:</a>
What's the rationale for code like

```
cm.__dict__["gist_gray"]
```
instead of more simply

```
cm.gist_gray
```



---

archive/issue_comments_139739.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@jdemeyer](#comment%3A32):\n> What's the rationale for code like\n\nI don't think there is any, it's just inadvertent bad style.",
    "created_at": "2018-04-18T15:28:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/12454",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/12454#issuecomment-139739",
    "user": "https://github.com/sagetrac-tjolivet"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@jdemeyer](#comment%3A32):
> What's the rationale for code like

I don't think there is any, it's just inadvertent bad style.
