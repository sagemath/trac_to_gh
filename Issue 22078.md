# Issue 22078: make install fails on Cygwin for giac-1.2.2.103

Issue created by migration from https://trac.sagemath.org/ticket/22315

Original creator: embray

Original creation time: 2017-02-06 14:39:17

CC:  frederichan parisse

The build succeeds, but `make install` fails at:


```
[giac-1.2.2.103] mv //home/embray/src/sagemath/sage-cygwin/local/bin/aide.exe /home/embray/src/sagemath/sage-cygwin/local/bin/cas_help
[giac-1.2.2.103] mv: cannot stat '//home/embray/src/sagemath/sage-cygwin/local/bin/aide.exe': No such file or directory
```


It seems the main problem is it doesn't like the double `//` at the beginning of the path.  It probably should also end the filename with `.exe` though technically it doesn't matter so much.

I wonder why it installs this file under one name, and then renames it in the first place...


---

Comment by embray created at 2017-02-06 15:20:28

Changing status from new to needs_review.


---

Comment by embray created at 2017-02-06 15:20:28

This patch fixes it.

I added pre- and post-autotools version of the patch.  Don't recall exactly what the convention is for this.
----
New commits:


---

Comment by embray created at 2017-02-06 15:24:21

Anyone know how best to report upstream issues in Giac?


---

Comment by tscrim created at 2017-02-06 16:18:14

I'm cc-ing Frederic Han as a starting point.


---

Comment by frederichan created at 2017-02-06 21:50:11

Sorry I have no experience with cygwin, (I only use mingw from fedora cross tool chain) but parisse uses cygwin for xcas so I am CC him. You can also report about giac on 
xcas-english forum:

http://xcas.e.ujf-grenoble.fr/XCAS/


---

Comment by embray created at 2017-02-07 10:01:55

To be clear, nothing here is very particular to cygwin.  The Makefile.am is generating incorrect paths on any platform (starting with `//`).  On most unices the superfluous slash will be ignored, but on Cygwin paths starting with `//` may be interpreted as a path on Windows network drive so it breaks.  Regardless, while the symptom is particular to Cygwin, the cause and the fix are not.


---

Comment by parisse created at 2017-02-08 10:08:41

I will make the following changes in Makefile.am and src/Makefile.am starting from version 1.2.3-27:\\
replace $(DESTDIR)/$(prefix) by $(DESTDIR)$(prefix)


---

Comment by embray created at 2017-02-09 13:06:28

Replying to [comment:6 parisse]:
> I will make the following changes in Makefile.am and src/Makefile.am starting from version 1.2.3-27:\\
> replace $(DESTDIR)/$(prefix) by $(DESTDIR)$(prefix)

Yes, that sounds right--that's all this patch is doing too.


---

Comment by tscrim created at 2017-02-09 15:02:48

Good for upstream, then good for Sage.


---

Comment by tscrim created at 2017-02-09 15:02:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-11 10:22:30

Resolution: fixed
