# Issue 11975: Binary NTL Finite field elements can't coerce to GF(2)

Issue created by migration from Trac.

Original creator: jsrn

Original creation time: 2011-12-12 11:44:56

Assignee: AlexGhitza

Keywords: finite field, algebra

For Finite fields when an element also exists in a subfield it should support coercion. This is not always possible for binary ntl fields and its prime subfield GF(2).


```
sage: Fbig.<a> = GF(2^18)
one = a^(2^18-1)
GF(2)(one)
<BOOM>
TypeError: unable to coerce <type
'sage.rings.finite_rings.element_ntl_gf2e.FiniteField_ntl_gf2eElement'> to an integer
```


It seems to work for other finite field characteristics.


---

Attachment

Add the _integer_ function to binary ntl elements to fix the issue


---

Comment by jsrn created at 2011-12-12 12:10:21

Changing status from new to needs_review.


---

Comment by jsrn created at 2011-12-12 12:10:21

I have added a patch which fixes the issue by defining an _integer_ command to the binary ntl field elements. I really don't know much about what I'm doing so it would be nice to have someone more confident in the patched code OK this...


---

Comment by saraedum created at 2011-12-21 00:54:09

Your patch looks good. A few comments:

Technically, `_integer_()` is a _conversion_ not a _coercion_ (the same docstring is also in the corresponding method of the givaro element). I believe it is cheaper to call `is_one()` and `is_zero()` than to do a comparison with 0 and 1:


```
sage: timeit('a == 0')
625 loops, best of 3: 6.23 µs per loop
sage: timeit('a.is_zero()')
625 loops, best of 3: 437 ns per loop
sage: timeit('a == 1')
625 loops, best of 3: 6.21 µs per loop
sage: timeit('a.is_zero()')
625 loops, best of 3: 525 ns per loop
```


Also, I added double colons to get the formatting in the reference manual right.

Anyway, if you are ok with my changes. Feel free to set it to positive_review.


---

Comment by saraedum created at 2011-12-21 00:56:29

Btw., your patch doesn't seem to have a good commit message (12147_binary_ntl_field_coercion). So I replace it with a single patch.


---

Comment by saraedum created at 2011-12-21 00:59:16

combines patch and review patch


---

Attachment

apply 12147_review.patch


---

Comment by jsrn created at 2011-12-21 14:15:09

Your comments seem very right, and I agree with your changes.


---

Comment by jsrn created at 2011-12-21 14:15:09

Changing status from needs_review to positive_review.


---

Comment by saraedum created at 2011-12-21 15:22:44

Changing keywords from "finite field, algebra" to "finite field, algebra, sd35".


---

Comment by jdemeyer created at 2011-12-24 01:04:46

Resolution: fixed
