# Issue 19511: bug in number_of_Gamma0_NFCusps

Issue created by migration from Trac.

Original creator: cremona

Original creation time: 2015-12-18 17:15:16

Keywords: number field cusps

Haluk Sengun reported this:

```
sage: k.<a> = NumberField(x^2 + 7)
sage: N = k.ideal(9)
sage: from sage.modular.cusps_nf import number_of_Gamma0_NFCusps
sage: number_of_Gamma0_NFCusps(N)
...
PariError: inconsistent variables in nf_to_scalar_or_basis, u != y
```


For a simpler sequence which triggers the bug:

```
sage: k.<a> = NumberField(x^2 + 7)
sage: ugens = k.unit_group().gens(); ugens
(u,)
sage: I = k.ideal(3)
sage: I.invertible_residues_mod(ugens)
```


The following works, showing how to fix it (possibly):

```
sage: I.invertible_residues_mod([k(u) for u in ugens])
```





---

Comment by aly.deines created at 2016-03-20 17:35:10

Changing status from new to needs_review.


---

Comment by aly.deines created at 2016-03-20 17:35:10

Should be fixed.  I also fixed so it's not trying to create a list from an empty iterator which raises and error.
----
New commits:


---

Comment by rozenszt created at 2016-03-21 14:55:31

The correction looks fine.


---

Comment by rozenszt created at 2016-03-21 14:55:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-03-21 23:58:39

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-03-21 23:58:39

Reviewer name


---

Comment by rozenszt created at 2016-03-22 06:51:05

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-03-22 23:44:09

Resolution: fixed


---

Comment by aly.deines created at 2016-03-23 15:24:34

Changing keywords from "number field cusps" to "number field cusps, sd71".


---

Comment by aly.deines created at 2016-03-23 17:41:14

Changing keywords from "number field cusps, sd71" to "number field cusps, days71".
