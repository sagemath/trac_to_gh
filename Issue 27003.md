# Issue 27003: py3: tests/cmdline.py

Issue created by migration from https://trac.sagemath.org/ticket/27240

Original creator: jhpalmieri

Original creation time: 2019-02-09 03:35:04

The file tests/cmdline.py fails a few doctests with Python 3 because it relies on the scripts `sage-rst2sws` and `sage-rst2txt`, which in turn use `sagenb`. Since `sagenb` is not Python 3 compatible, the tests fail.

The script `sage-rst2txt` is only incompatible in the sense that it raises a deprecation warning, and so we can ignore that. Trying to run `sage-rst2sws` produces a genuine error, from this line in `sagenb.notebook.smtpsend`:

```
from twisted.mail import smtp, relaymanager  # problematic with python 3
```

So ignore the error for `sage-rst2txt` with Python 3, and don't run the test for `sage-rst2sws` at all with Python 3.


---

Comment by jhpalmieri created at 2019-02-09 03:35:51

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2019-02-09 03:35:51

New commits:


---

Comment by chapoton created at 2019-02-09 19:31:45

looks good

maybe we can use the opportunity to fix the pyflakes warnings in the modified file, using

```
from subprocess import Popen, PIPE
```

?


---

Comment by git created at 2019-02-09 20:02:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2019-02-09 20:03:32

Done.


---

Comment by chapoton created at 2019-02-10 12:45:13

ok, thanks


---

Comment by chapoton created at 2019-02-10 12:45:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-02-11 23:06:40

Resolution: fixed
