# Issue 27329: Unhandled configure error when multiple installation records exist for the same SPKG

Issue created by migration from https://trac.sagemath.org/ticket/27566

Original creator: embray

Original creation time: 2019-03-29 15:41:02

CC:  dimpase jhpalmieri saraedum mjo

If, by some accident, one ends up with multiple stamp files for the same package in `local/var/lib/sage/installed`, an error occurs when running `./configure`.

For example, in my case, in the course of development I somehow accidentally wound up with two install records for different versions of mpir.  This results in an error appearing during `./configure` like:


```
...
    mpc-1.1.0
    mpfi-1.5.2
    mpfr-4.0.1.p0
    mpfrcx-0.5
./configure: line 10692: test: local/var/lib/sage/installed/mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868: binary operator expected
    mpir-3.0.0-644faf502c56f97d9accd301965fc57d6ec70868.p0
    mpmath-1.1.0
    nauty-26r1.p0
```


Of course, this should never happen during normal development or usage, but apparently it _can_ since I somehow made it happen.


---

Comment by embray created at 2019-03-29 15:45:34

New commits:


---

Comment by embray created at 2019-03-29 15:45:34

Changing status from new to needs_review.


---

Comment by embray created at 2019-03-29 15:50:50

Changing component from build to build: configure.


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-02-09 23:12:18

This should be rebased on top of #28788 because it touches the same code.


---

Comment by mkoeppe created at 2020-02-09 23:54:22

Last 10 new commits:


---

Comment by git created at 2020-02-16 20:28:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-03-01 00:03:22

Needs review


---

Comment by git created at 2020-03-02 01:52:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-03-02 01:52:58

New commits:


---

Comment by mkoeppe created at 2020-03-06 16:53:26

`@`embray please take a look.


---

Comment by mkoeppe created at 2020-03-15 23:11:49

Waiting for review


---

Comment by mjo created at 2020-03-15 23:57:16

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2020-03-15 23:57:16

I hate to slow down the configure script even more to display a message about a one-in-a-million error condition. The change to `sage_spkg_enable.m4` alone avoids the error. But everything works as advertised.


---

Comment by mkoeppe created at 2020-03-15 23:58:37

Thanks!


---

Comment by vbraun created at 2020-03-18 22:40:36

Resolution: fixed
