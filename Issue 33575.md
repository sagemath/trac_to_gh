# Issue 33575: Refactor distributions sage-setup, sagemath-{objects,categories} through sagemath-{environment,repl}

archive/issues_033575.json:
```json
{
    "body": "CC:  klee\n\nCurrently **sagemath-categories** distributes a superset of **sagemath-objects**, and both distributions include a copy of the doctester for their doctesting. We remove this duplication by declaring install-requires and extras-require.\n\n**sage-setup** currently calls into the Sage package that it installs by manipulating the load path. We replace it by an install-requires on **sagemath-environment**.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33812\n\n",
    "created_at": "2022-05-05T17:54:37Z",
    "labels": [
        "refactoring",
        "major",
        "enhancement"
    ],
    "title": "Refactor distributions sage-setup, sagemath-{objects,categories} through sagemath-{environment,repl}",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33575",
    "user": "mkoeppe"
}
```
CC:  klee

Currently **sagemath-categories** distributes a superset of **sagemath-objects**, and both distributions include a copy of the doctester for their doctesting. We remove this duplication by declaring install-requires and extras-require.

**sage-setup** currently calls into the Sage package that it installs by manipulating the load path. We replace it by an install-requires on **sagemath-environment**.

Issue created by migration from https://trac.sagemath.org/ticket/33812





---

archive/issue_comments_477789.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T03:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477789",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477790.json:
```json
{
    "body": "Now that we are testing **sagemath-objects** with the stuff now in **sagemath-environment** stripped away, dependencies become apparent that need to be removed.\n\n```\n[sagemath_objects-9.6.rc3]   File \"sage/misc/lazy_import.pyx\", line 69, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10965)\n[sagemath_objects-9.6.rc3]     from . import sageinspect\n[sagemath_objects-9.6.rc3]   File \"/Users/mkoeppe/s/sage/sage-rebasing/pkgs/sagemath-objects/.tox/sagepython-norequirements-sagewheels-nopypi/lib/python3.10/site-packages/sage/misc/sageinspect.py\", line 122, in <module>\n[sagemath_objects-9.6.rc3]     from sage.env import SAGE_LIB\n[sagemath_objects-9.6.rc3] ModuleNotFoundError: No module named 'sage.env'\n```\n",
    "created_at": "2022-05-08T03:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477790",
    "user": "mkoeppe"
}
```

Now that we are testing **sagemath-objects** with the stuff now in **sagemath-environment** stripped away, dependencies become apparent that need to be removed.

```
[sagemath_objects-9.6.rc3]   File "sage/misc/lazy_import.pyx", line 69, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10965)
[sagemath_objects-9.6.rc3]     from . import sageinspect
[sagemath_objects-9.6.rc3]   File "/Users/mkoeppe/s/sage/sage-rebasing/pkgs/sagemath-objects/.tox/sagepython-norequirements-sagewheels-nopypi/lib/python3.10/site-packages/sage/misc/sageinspect.py", line 122, in <module>
[sagemath_objects-9.6.rc3]     from sage.env import SAGE_LIB
[sagemath_objects-9.6.rc3] ModuleNotFoundError: No module named 'sage.env'
```




---

archive/issue_comments_477791.json:
```json
{
    "body": "So this needs #33037 (Remove use of `SAGE_LIB`)",
    "created_at": "2022-05-08T03:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477791",
    "user": "mkoeppe"
}
```

So this needs #33037 (Remove use of `SAGE_LIB`)



---

archive/issue_comments_477792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T04:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477792",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477793.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T05:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477793",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477794.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T06:15:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477794",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477795.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T06:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477795",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477796.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T07:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477796",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477797.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T07:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477797",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477798.json:
```json
{
    "body": "Next dependency\n\n```\n[sagemath_objects-9.6.rc3]   File \"sage/structure/sage_object.pyx\", line 9, in init sage.structure.sage_object (build/cythonized/sage/structure/sage_object.c:12337)\n[sagemath_objects-9.6.rc3]     from sage.misc.lazy_import import LazyImport\n[sagemath_objects-9.6.rc3]   File \"sage/misc/lazy_import.pyx\", line 71, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:11032)\n[sagemath_objects-9.6.rc3]     from sage.features import FeatureNotPresentError\n[sagemath_objects-9.6.rc3] ModuleNotFoundError: No module named 'sage.features'\n```\n",
    "created_at": "2022-05-08T08:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477798",
    "user": "mkoeppe"
}
```

Next dependency

```
[sagemath_objects-9.6.rc3]   File "sage/structure/sage_object.pyx", line 9, in init sage.structure.sage_object (build/cythonized/sage/structure/sage_object.c:12337)
[sagemath_objects-9.6.rc3]     from sage.misc.lazy_import import LazyImport
[sagemath_objects-9.6.rc3]   File "sage/misc/lazy_import.pyx", line 71, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:11032)
[sagemath_objects-9.6.rc3]     from sage.features import FeatureNotPresentError
[sagemath_objects-9.6.rc3] ModuleNotFoundError: No module named 'sage.features'
```




---

archive/issue_comments_477799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T08:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477799",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477800.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T12:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477800",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477801.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T12:49:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477801",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477802.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-05-08T13:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477802",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_477803.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-08T18:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477803",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T18:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477804",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477805.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T19:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477805",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477806.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T19:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477806",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477807.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T19:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477807",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477808.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T20:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477808",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477809.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-09T20:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477809",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477810.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-05-10T00:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477810",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_477811.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-10T02:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477811",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-10T03:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477812",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477813.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-10T03:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477813",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477814.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-10T04:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477814",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477815.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-10T05:08:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477815",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477816.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-05-10T05:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477816",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_477817.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-05-10T05:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477817",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_477818.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-30T04:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477818",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477819.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-05-30T05:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477819",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477820.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-12T19:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477820",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477821.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T22:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477821",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477822.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T23:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477822",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477823.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-07-09T23:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477823",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_477824.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-09T23:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477824",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477825.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-11T00:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477825",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477826.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-25T20:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477826",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477827.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-25T22:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477827",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-26T01:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477828",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477829.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-26T19:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477829",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477830.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-07-26T20:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477830",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_477831.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T16:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477831",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477832.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T20:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477832",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477833.json:
```json
{
    "body": "Questions:\n\n1. In `dependencies` files, `sagemath-categories` depends on `cysignals gmpy2 sagemath_objects` and `sagemath-objects` depends on `cysignals gmpy2`. Does `cysignals gmpy2` need to be repeated?\n\n2. In the hierarchy diagram, `sagemath-repl` depends on both `sagemath-environment` and `sagemath-objects`, but in the `dependencies` file of `sagemath-repl` spkg, I see `sagemath_objects ipython`. Why `sagemath-environment` is missing?",
    "created_at": "2022-09-25T00:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477833",
    "user": "klee"
}
```

Questions:

1. In `dependencies` files, `sagemath-categories` depends on `cysignals gmpy2 sagemath_objects` and `sagemath-objects` depends on `cysignals gmpy2`. Does `cysignals gmpy2` need to be repeated?

2. In the hierarchy diagram, `sagemath-repl` depends on both `sagemath-environment` and `sagemath-objects`, but in the `dependencies` file of `sagemath-repl` spkg, I see `sagemath_objects ipython`. Why `sagemath-environment` is missing?



---

archive/issue_comments_477834.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T00:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477834",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_477835.json:
```json
{
    "body": "Replying to [comment:60 Kwankyu Lee]:\n> 2. In the hierarchy diagram, `sagemath-repl` depends on both `sagemath-environment` and `sagemath-objects`, but in the `dependencies` file of `sagemath-repl` spkg, I see `sagemath_objects ipython`. Why `sagemath-environment` is missing?\n\nSorry.. The hierarchy diagram is the hierarchy of the distribution pkgs. I now see the correct dependencies in `install_requires`.\n----\nNew commits:",
    "created_at": "2022-09-25T00:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477835",
    "user": "klee"
}
```

Replying to [comment:60 Kwankyu Lee]:
> 2. In the hierarchy diagram, `sagemath-repl` depends on both `sagemath-environment` and `sagemath-objects`, but in the `dependencies` file of `sagemath-repl` spkg, I see `sagemath_objects ipython`. Why `sagemath-environment` is missing?

Sorry.. The hierarchy diagram is the hierarchy of the distribution pkgs. I now see the correct dependencies in `install_requires`.
----
New commits:



---

archive/issue_comments_477836.json:
```json
{
    "body": "The distribution packages declare runtime dependencies (setup.cfg install_requires) and also build-time dependencies (pyproject.toml). I think in the diagram I only show the (covers of) runtime dependencies.",
    "created_at": "2022-09-25T00:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477836",
    "user": "mkoeppe"
}
```

The distribution packages declare runtime dependencies (setup.cfg install_requires) and also build-time dependencies (pyproject.toml). I think in the diagram I only show the (covers of) runtime dependencies.



---

archive/issue_comments_477837.json:
```json
{
    "body": "Then perhaps the change of the commit `996461a` is not strictly necessary? (if it is practically no-op and does not create any overhead, then no problem).",
    "created_at": "2022-09-25T01:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477837",
    "user": "klee"
}
```

Then perhaps the change of the commit `996461a` is not strictly necessary? (if it is practically no-op and does not create any overhead, then no problem).



---

archive/issue_comments_477838.json:
```json
{
    "body": "No, you spotted it correctly in comment:62. `sagemath_environment` was missing, and 996461a corrected that. (Also `ipywidgets` was missing.)",
    "created_at": "2022-09-25T01:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477838",
    "user": "mkoeppe"
}
```

No, you spotted it correctly in comment:62. `sagemath_environment` was missing, and 996461a corrected that. (Also `ipywidgets` was missing.)



---

archive/issue_comments_477839.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-09-25T01:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477839",
    "user": "klee"
}
```

New commits:



---

archive/issue_comments_477840.json:
```json
{
    "body": "What is the logic of the changes in `lazy_import.pyx`? I have no idea...",
    "created_at": "2022-09-25T06:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477840",
    "user": "klee"
}
```

What is the logic of the changes in `lazy_import.pyx`? I have no idea...



---

archive/issue_comments_477841.json:
```json
{
    "body": "Replying to [comment:68 Kwankyu Lee]:\n> What is the logic of the changes in `lazy_import.pyx`? I have no idea...\n\nIt seems a provision to avoid `ImportError` in the situation when `sage.misc.lazy_import` is used when `sage.features` package is not present...\n\nHow about adding a comment to the code to explain the situation more concretely?",
    "created_at": "2022-09-25T07:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477841",
    "user": "klee"
}
```

Replying to [comment:68 Kwankyu Lee]:
> What is the logic of the changes in `lazy_import.pyx`? I have no idea...

It seems a provision to avoid `ImportError` in the situation when `sage.misc.lazy_import` is used when `sage.features` package is not present...

How about adding a comment to the code to explain the situation more concretely?



---

archive/issue_comments_477842.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-26T01:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477842",
    "user": "klee"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_477843.json:
```json
{
    "body": "Thanks for the comment.\n\n`9.7b6` below is `9.7` in other files, though I think it doesn't matter as explained in the comment.\n\n```diff\n+++ b/build/pkgs/sagemath_repl/install-requires.txt\n@@ -0,0 +1,2 @@\n+# This file is updated on every release by the sage-update-version script\n+sagemath-repl ~= 9.7b6\n```\n\n\nI tested this ticket in several ways. It works well. It looks good to me.\n\n\n----\nNew commits:",
    "created_at": "2022-09-26T01:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477843",
    "user": "klee"
}
```

Thanks for the comment.

`9.7b6` below is `9.7` in other files, though I think it doesn't matter as explained in the comment.

```diff
+++ b/build/pkgs/sagemath_repl/install-requires.txt
@@ -0,0 +1,2 @@
+# This file is updated on every release by the sage-update-version script
+sagemath-repl ~= 9.7b6
```


I tested this ticket in several ways. It works well. It looks good to me.


----
New commits:



---

archive/issue_comments_477844.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-09-26T01:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477844",
    "user": "mkoeppe"
}
```

Thank you!



---

archive/issue_comments_477845.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-28T23:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33575#issuecomment-477845",
    "user": "vbraun"
}
```

Resolution: fixed
