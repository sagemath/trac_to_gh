# Issue 16002: ZZ in the wrong category

archive/issues_016002.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat nthiery\n\nKeywords: integer ring, category\n\n\n```\nsage: ZZ.categories()\n[Category of euclidean domains,\n Category of principal ideal domains,\n Category of unique factorization domains,\n Category of gcd domains,\n Category of integral domains,\n Category of domains,\n Category of commutative rings,\n Category of rings,\n Category of rngs,\n Category of semirings,\n Category of monoids,\n Category of semigroups,\n Category of magmas,\n Category of commutative additive groups,\n Category of commutative additive monoids,\n Category of commutative additive semigroups,\n Category of additive magmas,\n Category of sets,\n Category of sets with partial maps,\n Category of objects]\n```\n\nNotice that it is not an infinite enumerated set.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16239\n\n",
    "created_at": "2014-04-26T04:58:25Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "title": "ZZ in the wrong category",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16002",
    "user": "tscrim"
}
```
Assignee: sage-combinat

CC:  sage-combinat nthiery

Keywords: integer ring, category


```
sage: ZZ.categories()
[Category of euclidean domains,
 Category of principal ideal domains,
 Category of unique factorization domains,
 Category of gcd domains,
 Category of integral domains,
 Category of domains,
 Category of commutative rings,
 Category of rings,
 Category of rngs,
 Category of semirings,
 Category of monoids,
 Category of semigroups,
 Category of magmas,
 Category of commutative additive groups,
 Category of commutative additive monoids,
 Category of commutative additive semigroups,
 Category of additive magmas,
 Category of sets,
 Category of sets with partial maps,
 Category of objects]
```

Notice that it is not an infinite enumerated set.

Issue created by migration from https://trac.sagemath.org/ticket/16239





---

archive/issue_comments_207759.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-26T02:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207759",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207760.json:
```json
{
    "body": "Surprisingly simple fix since `ZZ` is an old parent.\n----\nNew commits:",
    "created_at": "2014-05-26T02:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207760",
    "user": "tscrim"
}
```

Surprisingly simple fix since `ZZ` is an old parent.
----
New commits:



---

archive/issue_comments_207761.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-26T21:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207761",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207762.json:
```json
{
    "body": "I am running all tests now. If they pass, and you agree with my changes, it's good to go!",
    "created_at": "2014-05-26T21:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207762",
    "user": "nthiery"
}
```

I am running all tests now. If they pass, and you agree with my changes, it's good to go!



---

archive/issue_comments_207763.json:
```json
{
    "body": "I'm good with your changes. Go ahead and set to positive review once all tests pass.",
    "created_at": "2014-05-26T21:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207763",
    "user": "tscrim"
}
```

I'm good with your changes. Go ahead and set to positive review once all tests pass.



---

archive/issue_comments_207764.json:
```json
{
    "body": "I get a bunch of failing tests; most seem trivial, but I did not have time to check in detail:\n\n```\nsage -t --long src/sage/structure/parent.pyx  # Killed due to kill signal\nsage -t --long src/sage/structure/element.pyx  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/root_space.py  # Bad exit: 1\nsage -t --long src/sage/matrix/matrix_space.py  # Killed due to kill signal\nsage -t --long src/sage/categories/primer.py  # 2 doctests failed\nsage -t --long src/sage/dev/git_interface.py  # 22 doctests failed\nsage -t --long src/sage/categories/category.py  # 3 doctests failed\nsage -t --long src/sage/categories/map.pyx  # 1 doctest failed\nsage -t --long src/sage/sets/set_from_iterator.py  # 1 doctest failed\nsage -t --long src/sage/categories/homset.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/polynomial_ring.py  # 1 doctest failed\nsage -t --long src/sage/misc/dev_tools.py  # 1 doctest failed\nsage -t --long src/doc/en/tutorial/tour_coercion.rst  # 1 doctest failed\nsage -t --long src/sage/structure/category_object.pyx  # 1 doctest failed\nsage -t --long src/doc/fr/tutorial/tour_coercion.rst  # 1 doctest failed\nsage -t --long src/sage/categories/category_types.py  # 2 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/tutorial-objects-and-classes.rst  # 2 doctests failed\nsage -t --long src/sage/misc/sage_unittest.py  # 2 doctests failed\nsage -t --long src/sage/categories/bimodules.py  # 2 doctests failed\n```\n",
    "created_at": "2014-05-26T22:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207764",
    "user": "nthiery"
}
```

I get a bunch of failing tests; most seem trivial, but I did not have time to check in detail:

```
sage -t --long src/sage/structure/parent.pyx  # Killed due to kill signal
sage -t --long src/sage/structure/element.pyx  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/root_space.py  # Bad exit: 1
sage -t --long src/sage/matrix/matrix_space.py  # Killed due to kill signal
sage -t --long src/sage/categories/primer.py  # 2 doctests failed
sage -t --long src/sage/dev/git_interface.py  # 22 doctests failed
sage -t --long src/sage/categories/category.py  # 3 doctests failed
sage -t --long src/sage/categories/map.pyx  # 1 doctest failed
sage -t --long src/sage/sets/set_from_iterator.py  # 1 doctest failed
sage -t --long src/sage/categories/homset.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/polynomial_ring.py  # 1 doctest failed
sage -t --long src/sage/misc/dev_tools.py  # 1 doctest failed
sage -t --long src/doc/en/tutorial/tour_coercion.rst  # 1 doctest failed
sage -t --long src/sage/structure/category_object.pyx  # 1 doctest failed
sage -t --long src/doc/fr/tutorial/tour_coercion.rst  # 1 doctest failed
sage -t --long src/sage/categories/category_types.py  # 2 doctests failed
sage -t --long src/doc/en/thematic_tutorials/tutorial-objects-and-classes.rst  # 2 doctests failed
sage -t --long src/sage/misc/sage_unittest.py  # 2 doctests failed
sage -t --long src/sage/categories/bimodules.py  # 2 doctests failed
```




---

archive/issue_comments_207765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-27T17:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207765",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207766.json:
```json
{
    "body": "I had to partially revert your change in order to get `(QQ^2).list()` (or any other infinite [enumerated] set that's not in the category) to raise an error. I'm not quite sure what happened with the doctest in `misc/dev_tools.py`, nor am I completely confident in the `tutorial-objects-and-classes.rst` doctest fixes (please double check those). I couldn't get anything to break in the `dev/git_interface.py`.\n\nedit - removed a stupid idea due to the overwhelming changes it would entail.",
    "created_at": "2014-05-27T17:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207766",
    "user": "tscrim"
}
```

I had to partially revert your change in order to get `(QQ^2).list()` (or any other infinite [enumerated] set that's not in the category) to raise an error. I'm not quite sure what happened with the doctest in `misc/dev_tools.py`, nor am I completely confident in the `tutorial-objects-and-classes.rst` doctest fixes (please double check those). I couldn't get anything to break in the `dev/git_interface.py`.

edit - removed a stupid idea due to the overwhelming changes it would entail.



---

archive/issue_comments_207767.json:
```json
{
    "body": "Also I should make it clear, the error came from `QQ` not being in the correct category. So should we also change that here while we're at it?",
    "created_at": "2014-06-11T04:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207767",
    "user": "tscrim"
}
```

Also I should make it clear, the error came from `QQ` not being in the correct category. So should we also change that here while we're at it?



---

archive/issue_comments_207768.json:
```json
{
    "body": "Hello,\n\nWhile we are at it, this is not an isolated case...\n\n```\nsage: std_sets = [ZZ, QQ, RDF, CDF, AA, QQbar, RR, CC]\nsage: any(x in Sets().Infinite() for x in std_sets)\nFalse\n```\n\nWe can open another ticket for the remaining ones.\n\nVincent",
    "created_at": "2014-06-15T16:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207768",
    "user": "vdelecroix"
}
```

Hello,

While we are at it, this is not an isolated case...

```
sage: std_sets = [ZZ, QQ, RDF, CDF, AA, QQbar, RR, CC]
sage: any(x in Sets().Infinite() for x in std_sets)
False
```

We can open another ticket for the remaining ones.

Vincent



---

archive/issue_comments_207769.json:
```json
{
    "body": "I'm hoping to not open a can of worms, but technically `RDF`, `CDF`, `RR`, `CC` are not infinite sets as they have a *fixed* finite precision. Although this would be somewhat surprising for beginners. Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()` (plus these \"fields\" already have worse abuses). But definitely another ticket.",
    "created_at": "2014-06-15T16:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207769",
    "user": "tscrim"
}
```

I'm hoping to not open a can of worms, but technically `RDF`, `CDF`, `RR`, `CC` are not infinite sets as they have a *fixed* finite precision. Although this would be somewhat surprising for beginners. Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()` (plus these "fields" already have worse abuses). But definitely another ticket.



---

archive/issue_comments_207770.json:
```json
{
    "body": "Replying to [comment:11 tscrim]:\n> I'm hoping to not open a can of worms, but technically `RDF`, `CDF`, `RR`, `CC` are not infinite sets as they have a *fixed* finite precision. Although this would be somewhat surprising for beginners. Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()` (plus these \"fields\" already have worse abuses). But definitely another ticket.\n\nYou are right for `RDF` and `CDF` but for `RR` and `CC`, technically, these are infinite: the mantisse is finite but the exponent is arbitrary precision (because of mpfr). And again, technically speaking these are not fields ;-)",
    "created_at": "2014-06-15T17:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207770",
    "user": "vdelecroix"
}
```

Replying to [comment:11 tscrim]:
> I'm hoping to not open a can of worms, but technically `RDF`, `CDF`, `RR`, `CC` are not infinite sets as they have a *fixed* finite precision. Although this would be somewhat surprising for beginners. Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()` (plus these "fields" already have worse abuses). But definitely another ticket.

You are right for `RDF` and `CDF` but for `RR` and `CC`, technically, these are infinite: the mantisse is finite but the exponent is arbitrary precision (because of mpfr). And again, technically speaking these are not fields ;-)



---

archive/issue_comments_207771.json:
```json
{
    "body": "Replying to [comment:11 tscrim]:\n> Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()`\n??? Infinite fields are not necessarily of characteristic zero, see for instance `FieldOfFractions(GF(q)['t'])`.\n\nIt could be something like `Fields() & AssociativeAlgebras(QQ)`, although implementation dictates we should avoid referencing parametrized bases for categories whenever possible (this case wouldn't be so bad, since QQ just a single object. It's when characteristic p fields are made as `Fields() & AssociativeAlgebras(GF(p))` that we have a problem.)",
    "created_at": "2014-06-15T17:43:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207771",
    "user": "nbruin"
}
```

Replying to [comment:11 tscrim]:
> Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()`
??? Infinite fields are not necessarily of characteristic zero, see for instance `FieldOfFractions(GF(q)['t'])`.

It could be something like `Fields() & AssociativeAlgebras(QQ)`, although implementation dictates we should avoid referencing parametrized bases for categories whenever possible (this case wouldn't be so bad, since QQ just a single object. It's when characteristic p fields are made as `Fields() & AssociativeAlgebras(GF(p))` that we have a problem.)



---

archive/issue_comments_207772.json:
```json
{
    "body": "Replying to [comment:13 nbruin]:\n> Replying to [comment:11 tscrim]:\n> > Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()`\n> ??? Infinite fields are not necessarily of characteristic zero, see for instance `FieldOfFractions(GF(q)['t'])`.\n\nHowever what I said is all fields of characteristic 0 are fields and infinite sets (as we can always add 1 more).\n\n> It could be something like `Fields() & AssociativeAlgebras(QQ)`, although implementation dictates we should avoid referencing parametrized bases for categories whenever possible (this case wouldn't be so bad, since QQ just a single object. It's when characteristic p fields are made as `Fields() & AssociativeAlgebras(GF(p))` that we have a problem.)\n\nHmmm...that's an interesting idea. Nicolas, how feasible would that be?",
    "created_at": "2014-06-16T05:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207772",
    "user": "tscrim"
}
```

Replying to [comment:13 nbruin]:
> Replying to [comment:11 tscrim]:
> > Plus if we ignore this, we could make a category for char 0 fields, which IMO is a useful distinction and we make as a join `Fields() & Sets().Infinite()`
> ??? Infinite fields are not necessarily of characteristic zero, see for instance `FieldOfFractions(GF(q)['t'])`.

However what I said is all fields of characteristic 0 are fields and infinite sets (as we can always add 1 more).

> It could be something like `Fields() & AssociativeAlgebras(QQ)`, although implementation dictates we should avoid referencing parametrized bases for categories whenever possible (this case wouldn't be so bad, since QQ just a single object. It's when characteristic p fields are made as `Fields() & AssociativeAlgebras(GF(p))` that we have a problem.)

Hmmm...that's an interesting idea. Nicolas, how feasible would that be?



---

archive/issue_comments_207773.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-01T17:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207773",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207774.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-01T17:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207774",
    "user": "nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207775.json:
```json
{
    "body": "Back to the ticket at hand: I am happy with Travis changes and he looked over my final tweaks. Good to go!",
    "created_at": "2014-07-01T17:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207775",
    "user": "nthiery"
}
```

Back to the ticket at hand: I am happy with Travis changes and he looked over my final tweaks. Good to go!



---

archive/issue_comments_207776.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-03T02:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207776",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_207777.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2014-07-03T04:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207777",
    "user": "vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_207778.json:
```json
{
    "body": "Long doctests eat all my memory in `sage.matrix.matrix_space`. Looks like matrix space `MatrixSpace(QQ, 7)` trying to figure out whether it is finite or not.",
    "created_at": "2014-07-03T04:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207778",
    "user": "vbraun"
}
```

Long doctests eat all my memory in `sage.matrix.matrix_space`. Looks like matrix space `MatrixSpace(QQ, 7)` trying to figure out whether it is finite or not.



---

archive/issue_comments_207779.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2014-07-03T04:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207779",
    "user": "vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_207780.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-06T01:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207780",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207781.json:
```json
{
    "body": "Hey Nicolas,\n\nI remember why I had things that way:\n\n```\nsage: QQ in Sets().Infinite()\nFalse\nsage: MS = MatrixSpace(ZZ, 7)\nsage: MS in Sets().Infinite()\nFalse\n```\n\nThere will be a much larger fix needed for modules over infinite base rings recognizing that they are infinite (and `QQ` and friends will need to be in `Sets().Infinite()`). For now, I just reverted the change and added a comment. If that's okay for now, then can you set this back to positive review? Thanks.\n----\nNew commits:",
    "created_at": "2014-07-06T01:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207781",
    "user": "tscrim"
}
```

Hey Nicolas,

I remember why I had things that way:

```
sage: QQ in Sets().Infinite()
False
sage: MS = MatrixSpace(ZZ, 7)
sage: MS in Sets().Infinite()
False
```

There will be a much larger fix needed for modules over infinite base rings recognizing that they are infinite (and `QQ` and friends will need to be in `Sets().Infinite()`). For now, I just reverted the change and added a comment. If that's okay for now, then can you set this back to positive review? Thanks.
----
New commits:



---

archive/issue_comments_207782.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-11T11:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207782",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207783.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n> I remember why I had things that way:\n> {{{\n> sage: QQ in Sets().Infinite()\n> False\n> sage: MS = MatrixSpace(ZZ, 7)\n> sage: MS in Sets().Infinite()\n> False\n> }}}\n> There will be a much larger fix needed for modules over infinite base rings recognizing that they are infinite (and `QQ` and friends will need to be in `Sets().Infinite()`\n\nGosh, that's ugly. Oh well, we will have to do with it I guess. Thanks! I improved a bit the wording, and now back to positive review.\n----\nNew commits:",
    "created_at": "2014-07-11T11:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207783",
    "user": "nthiery"
}
```

Replying to [comment:19 tscrim]:
> I remember why I had things that way:
> {{{
> sage: QQ in Sets().Infinite()
> False
> sage: MS = MatrixSpace(ZZ, 7)
> sage: MS in Sets().Infinite()
> False
> }}}
> There will be a much larger fix needed for modules over infinite base rings recognizing that they are infinite (and `QQ` and friends will need to be in `Sets().Infinite()`

Gosh, that's ugly. Oh well, we will have to do with it I guess. Thanks! I improved a bit the wording, and now back to positive review.
----
New commits:



---

archive/issue_comments_207784.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-11T11:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207784",
    "user": "nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207785.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-07-12T00:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207785",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_207786.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/sets/set_from_iterator.py\n**********************************************************************\nFile \"src/sage/sets/set_from_iterator.py\", line 139, in sage.sets.set_from_iterator.EnumeratedSetFromIterator\nFailed example:\n    TestSuite(E).run()\nExpected nothing\nGot:\n    doctest:291: UserWarning: Testing equality of infinite sets which will not end in case of equality\n```\n",
    "created_at": "2014-07-12T00:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207786",
    "user": "vbraun"
}
```


```
sage -t --long src/sage/sets/set_from_iterator.py
**********************************************************************
File "src/sage/sets/set_from_iterator.py", line 139, in sage.sets.set_from_iterator.EnumeratedSetFromIterator
Failed example:
    TestSuite(E).run()
Expected nothing
Got:
    doctest:291: UserWarning: Testing equality of infinite sets which will not end in case of equality
```




---

archive/issue_comments_207787.json:
```json
{
    "body": "The warning is issued by `EnumeratedSetFromIterator` when `_test_an_element` calls `self(an_element)` where `self` is `E`. From there, the parent of `an_element` is `ZZ`, which the parent's default `__call__` tries to see if the parent is `self` by equality, leading to the `__eq__` call with `ZZ` being a different enumerated set.\n\nSo how do we fix this? I'm not quite sure what the best way to proceed is, put the warning in the test, remove the warning, rework `_test_an_element` to better support facade parents, ...?",
    "created_at": "2014-07-15T03:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207787",
    "user": "tscrim"
}
```

The warning is issued by `EnumeratedSetFromIterator` when `_test_an_element` calls `self(an_element)` where `self` is `E`. From there, the parent of `an_element` is `ZZ`, which the parent's default `__call__` tries to see if the parent is `self` by equality, leading to the `__eq__` call with `ZZ` being a different enumerated set.

So how do we fix this? I'm not quite sure what the best way to proceed is, put the warning in the test, remove the warning, rework `_test_an_element` to better support facade parents, ...?



---

archive/issue_comments_207788.json:
```json
{
    "body": "Hey,\n\nFunny that this has been catch in `set_from_iterator`. The warning is useful, so please, keep it.\n\nIt looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).\n\nVincent",
    "created_at": "2014-07-15T07:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207788",
    "user": "vdelecroix"
}
```

Hey,

Funny that this has been catch in `set_from_iterator`. The warning is useful, so please, keep it.

It looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).

Vincent



---

archive/issue_comments_207789.json:
```json
{
    "body": "Replying to [comment:24 vdelecroix]:\n> It looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).\n\nIt's not checking that it is a child of a facade parent, but that the facade parents `__call__` (and the `_element_constructor_`?) doesn't change the element. I'm wondering if facade parents should work with the coercion framework differently...\n\nWell, for now I will just add the warning to the doctest unless anyone objects.",
    "created_at": "2014-07-15T17:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207789",
    "user": "tscrim"
}
```

Replying to [comment:24 vdelecroix]:
> It looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).

It's not checking that it is a child of a facade parent, but that the facade parents `__call__` (and the `_element_constructor_`?) doesn't change the element. I'm wondering if facade parents should work with the coercion framework differently...

Well, for now I will just add the warning to the doctest unless anyone objects.



---

archive/issue_comments_207790.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-15T17:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207790",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207791.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-15T17:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207791",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_207792.json:
```json
{
    "body": "I am on vacations for the next couple weeks. So please someone take over the last bit of review!\n\nCheers,\n                               Nicolas",
    "created_at": "2014-07-16T21:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207792",
    "user": "nthiery"
}
```

I am on vacations for the next couple weeks. So please someone take over the last bit of review!

Cheers,
                               Nicolas



---

archive/issue_comments_207793.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-14T10:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207793",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207794.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T04:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207794",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207795.json:
```json
{
    "body": "Replying to [comment:25 tscrim]:\n> Replying to [comment:24 vdelecroix]:\n> > It looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).\n> \n> It's not checking that it is a child of a facade parent, but that the facade parents `__call__` (and the `_element_constructor_`?) doesn't change the element. I'm wondering if facade parents should work with the coercion framework differently...\n\nWhenever possible, facade parents should indeed make sure that\nF(F.an_element()) == F.an_element(), and bark on\nF(something_outside). Now there are many occasions, like here\nprobably, where it might be hard, or costly, or just impossible to\nachieve.\n\n> Well, for now I will just add the warning to the doctest unless anyone objects.\n\nYeah, that's life. I am ok with the change.\n\nI ran all long tests, and with the little new commit, all tests pass. Back to positive review!\n\nThanks!\n                                                 Nicolas\n----\nNew commits:",
    "created_at": "2014-08-16T04:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207795",
    "user": "nthiery"
}
```

Replying to [comment:25 tscrim]:
> Replying to [comment:24 vdelecroix]:
> > It looks ok for me if you modify the doctest explaining what happened. For me it is a facade issue as a facade should be childless (i.e. there is no point in testing whether an element has a parent a given facade).
> 
> It's not checking that it is a child of a facade parent, but that the facade parents `__call__` (and the `_element_constructor_`?) doesn't change the element. I'm wondering if facade parents should work with the coercion framework differently...

Whenever possible, facade parents should indeed make sure that
F(F.an_element()) == F.an_element(), and bark on
F(something_outside). Now there are many occasions, like here
probably, where it might be hard, or costly, or just impossible to
achieve.

> Well, for now I will just add the warning to the doctest unless anyone objects.

Yeah, that's life. I am ok with the change.

I ran all long tests, and with the little new commit, all tests pass. Back to positive review!

Thanks!
                                                 Nicolas
----
New commits:



---

archive/issue_comments_207796.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-16T04:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207796",
    "user": "nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207797.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-16T09:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16002#issuecomment-207797",
    "user": "vbraun"
}
```

Resolution: fixed
