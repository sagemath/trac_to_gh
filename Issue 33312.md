# Issue 33312: Rename test_... functions to avoid the naming scheme reserved by pytest

archive/issues_033312.json:
```json
{
    "body": "CC:  @tobiasdiez\n\n`sage -t` throws errors on some files because pytest is configured to look for methods prefixed with `test_` and treats them as pytest test functions/methods, which are then executed. However, sage's code base contains some functions that match this pattern without being pytests.\n\nThis leads to problems like\n\n```\n$ ./sage -tp src/sage/tests/cmdline.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2022-03-20-11-46-21-1dc8fb11.\nUsing --optional=4ti2,buckygen,ccache,cryptominisat,debugpy,e_antic,gap_packages,homebrew,igraph,jupymake,latte_int,libsemigroups,lidia,lrslib,meataxe,normaliz,pip,polytopes_db_4d,pynormaliz,sage,sage_spkg,texttable\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nDoctesting 1 file using 8 threads.\nsage -t --random-seed=23402257756506608859254049173870803147 src/sage/tests/cmdline.py\n...\n=================================================================================== test session starts ===================================================================================\nplatform darwin -- Python 3.10.2, pytest-7.0.1, pluggy-1.0.0\nrootdir: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src, configfile: tox.ini\ncollected 1 item                                                                                                                                                                          \n\nsrc/sage/tests/cmdline.py E                                                                                                                                                         [100%]\n\n========================================================================================= ERRORS ==========================================================================================\n____________________________________________________________________________ ERROR at setup of test_executable ____________________________________________________________________________\nfile /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/tests/cmdline.py, line 61\n  def test_executable(args, input=\"\", timeout=100.0, pydebug_ignore_warnings=False, **kwds):\nE       fixture 'args' not found\n>       available fixtures: add_imports, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory\n>       use 'pytest --fixtures [testpath]' for help on them.\n\n/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/tests/cmdline.py:61\n================================================================================= short test summary info =================================================================================\nERROR src/sage/tests/cmdline.py::test_executable\n==================================================================================== 1 error in 0.01s =====================================================================================\n```\n\nWe fix it in this ticket as follows:\n- If the offending function is a proper (sage) test function, then change its name from `test_xyz` to `_test_xyz` (which also marks them as private)\n- If the offending function is a \"real\" user-faced function, then explicitly exclude it from pytests test discovery.\n\nSee #31924 for further discussion on different approaches to fix the same issue including their pros and cons. \n\nThis is preparation for #33546.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33549\n\n",
    "closed_at": "2022-03-30T22:33:19Z",
    "created_at": "2022-03-22T16:32:10Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Rename test_... functions to avoid the naming scheme reserved by pytest",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33312",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tobiasdiez

`sage -t` throws errors on some files because pytest is configured to look for methods prefixed with `test_` and treats them as pytest test functions/methods, which are then executed. However, sage's code base contains some functions that match this pattern without being pytests.

This leads to problems like

```
$ ./sage -tp src/sage/tests/cmdline.py
too many failed tests, not using stored timings
Running doctests with ID 2022-03-20-11-46-21-1dc8fb11.
Using --optional=4ti2,buckygen,ccache,cryptominisat,debugpy,e_antic,gap_packages,homebrew,igraph,jupymake,latte_int,libsemigroups,lidia,lrslib,meataxe,normaliz,pip,polytopes_db_4d,pynormaliz,sage,sage_spkg,texttable
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Doctesting 1 file using 8 threads.
sage -t --random-seed=23402257756506608859254049173870803147 src/sage/tests/cmdline.py
...
=================================================================================== test session starts ===================================================================================
platform darwin -- Python 3.10.2, pytest-7.0.1, pluggy-1.0.0
rootdir: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src, configfile: tox.ini
collected 1 item                                                                                                                                                                          

src/sage/tests/cmdline.py E                                                                                                                                                         [100%]

========================================================================================= ERRORS ==========================================================================================
____________________________________________________________________________ ERROR at setup of test_executable ____________________________________________________________________________
file /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/tests/cmdline.py, line 61
  def test_executable(args, input="", timeout=100.0, pydebug_ignore_warnings=False, **kwds):
E       fixture 'args' not found
>       available fixtures: add_imports, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/tests/cmdline.py:61
================================================================================= short test summary info =================================================================================
ERROR src/sage/tests/cmdline.py::test_executable
==================================================================================== 1 error in 0.01s =====================================================================================
```

We fix it in this ticket as follows:
- If the offending function is a proper (sage) test function, then change its name from `test_xyz` to `_test_xyz` (which also marks them as private)
- If the offending function is a "real" user-faced function, then explicitly exclude it from pytests test discovery.

See #31924 for further discussion on different approaches to fix the same issue including their pros and cons. 

This is preparation for #33546.

Issue created by migration from https://trac.sagemath.org/ticket/33549





---

archive/issue_events_088308.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-22T18:44:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88308"
}
```



---

archive/issue_comments_473689.json:
```json
{
    "body": "Good thing pycheck and pyright let us use\n`check_...` and `right_...`!    : )",
    "created_at": "2022-03-22T20:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473689",
    "user": "https://github.com/slel"
}
```

Good thing pycheck and pyright let us use
`check_...` and `right_...`!    : )



---

archive/issue_comments_473690.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-03-23T12:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473690",
    "user": "https://github.com/tobiasdiez"
}
```

Changing priority from major to critical.



---

archive/issue_comments_473691.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-23T12:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473691",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_473692.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-03-23T12:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473692",
    "user": "https://github.com/tobiasdiez"
}
```

New commits:



---

archive/issue_events_088309.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-23T12:50:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88309"
}
```



---

archive/issue_events_088310.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-23T12:50:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88310"
}
```



---

archive/issue_comments_473693.json:
```json
{
    "body": "Yo should have a look at:\n\n```\nsage -t --warn-long 126.1 --random-seed=123007730607096856939441742800394041101 src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 313, in sage.tests.cmdline._test_executable\nFailed example:\n    out.find(\"All tests passed!\") >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 316, in sage.tests.cmdline._test_executable\nFailed example:\n    ret\nExpected:\n    0\nGot:\n    2\n**********************************************************************\n1 item had failures:\n   2 of 217 in sage.tests.cmdline._test_executable\n    [216 tests, 2 failures, 190.78 s]\n```\n\nand\n\n```\nsage -t --warn-long 125.1 --random-seed=216213492016970842904386788649176794439 src/sage/rings/tests.py\n**********************************************************************\nFile \"src/sage/rings/tests.py\", line 416, in sage.rings.tests.?\nFailed example:\n    sage.rings.tests._test_karatsuba_multiplication(ZZ, 6, 5, verbose=True, seed=42)\nExpected:\n    _test_karatsuba_multiplication: ring=Univariate Polynomial Ring in x over Integer Ring, threshold=2\n    (2*x^6 - x^5 - x^4 - 3*x^3 + 4*x^2 + 4*x + 1)*(4*x^4 + x^3 - 2*x^2 - 20*x + 3)\n      (16*x^2)*(-41*x + 1)\n      (x^6 + 2*x^5 + 8*x^4 - x^3 + x^2 + x)*(-x^2 - 4*x + 3)\n      (-x^3 - x - 8)*(-1)\n      (x - 1)*(-x^5 + 3*x^4 - x^3 + 2*x + 1)\n      (x^3 + x^2 + x + 1)*(4*x^3 + 76*x^2 - x - 1)\n      (x^6 - 5*x^4 - x^3 + 6*x^2 + 1)*(5*x^2 - x + 4)\n      (3*x - 2)*(x - 1)\n      (21)*(14*x^5 - x^2 + 4*x + 1)\n      (12*x^5 - 12*x^2 + 2*x + 1)*(26*x^4 + x^3 + 1)\nGot:\n    test_karatsuba_multiplication: ring=Univariate Polynomial Ring in x over Integer Ring, threshold=2\n      (2*x^6 - x^5 - x^4 - 3*x^3 + 4*x^2 + 4*x + 1)*(4*x^4 + x^3 - 2*x^2 - 20*x + 3)\n      (16*x^2)*(-41*x + 1)\n      (x^6 + 2*x^5 + 8*x^4 - x^3 + x^2 + x)*(-x^2 - 4*x + 3)\n      (-x^3 - x - 8)*(-1)\n      (x - 1)*(-x^5 + 3*x^4 - x^3 + 2*x + 1)\n      (x^3 + x^2 + x + 1)*(4*x^3 + 76*x^2 - x - 1)\n      (x^6 - 5*x^4 - x^3 + 6*x^2 + 1)*(5*x^2 - x + 4)\n      (3*x - 2)*(x - 1)\n      (21)*(14*x^5 - x^2 + 4*x + 1)\n      (12*x^5 - 12*x^2 + 2*x + 1)*(26*x^4 + x^3 + 1)\n**********************************************************************\n1 item had failures:\n   1 of   7 in sage.rings.tests.?\n    [54 tests, 1 failure, 20.02 s]\n```",
    "created_at": "2022-03-24T08:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473693",
    "user": "https://github.com/soehms"
}
```

Yo should have a look at:

```
sage -t --warn-long 126.1 --random-seed=123007730607096856939441742800394041101 src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 313, in sage.tests.cmdline._test_executable
Failed example:
    out.find("All tests passed!") >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/tests/cmdline.py", line 316, in sage.tests.cmdline._test_executable
Failed example:
    ret
Expected:
    0
Got:
    2
**********************************************************************
1 item had failures:
   2 of 217 in sage.tests.cmdline._test_executable
    [216 tests, 2 failures, 190.78 s]
```

and

```
sage -t --warn-long 125.1 --random-seed=216213492016970842904386788649176794439 src/sage/rings/tests.py
**********************************************************************
File "src/sage/rings/tests.py", line 416, in sage.rings.tests.?
Failed example:
    sage.rings.tests._test_karatsuba_multiplication(ZZ, 6, 5, verbose=True, seed=42)
Expected:
    _test_karatsuba_multiplication: ring=Univariate Polynomial Ring in x over Integer Ring, threshold=2
    (2*x^6 - x^5 - x^4 - 3*x^3 + 4*x^2 + 4*x + 1)*(4*x^4 + x^3 - 2*x^2 - 20*x + 3)
      (16*x^2)*(-41*x + 1)
      (x^6 + 2*x^5 + 8*x^4 - x^3 + x^2 + x)*(-x^2 - 4*x + 3)
      (-x^3 - x - 8)*(-1)
      (x - 1)*(-x^5 + 3*x^4 - x^3 + 2*x + 1)
      (x^3 + x^2 + x + 1)*(4*x^3 + 76*x^2 - x - 1)
      (x^6 - 5*x^4 - x^3 + 6*x^2 + 1)*(5*x^2 - x + 4)
      (3*x - 2)*(x - 1)
      (21)*(14*x^5 - x^2 + 4*x + 1)
      (12*x^5 - 12*x^2 + 2*x + 1)*(26*x^4 + x^3 + 1)
Got:
    test_karatsuba_multiplication: ring=Univariate Polynomial Ring in x over Integer Ring, threshold=2
      (2*x^6 - x^5 - x^4 - 3*x^3 + 4*x^2 + 4*x + 1)*(4*x^4 + x^3 - 2*x^2 - 20*x + 3)
      (16*x^2)*(-41*x + 1)
      (x^6 + 2*x^5 + 8*x^4 - x^3 + x^2 + x)*(-x^2 - 4*x + 3)
      (-x^3 - x - 8)*(-1)
      (x - 1)*(-x^5 + 3*x^4 - x^3 + 2*x + 1)
      (x^3 + x^2 + x + 1)*(4*x^3 + 76*x^2 - x - 1)
      (x^6 - 5*x^4 - x^3 + 6*x^2 + 1)*(5*x^2 - x + 4)
      (3*x - 2)*(x - 1)
      (21)*(14*x^5 - x^2 + 4*x + 1)
      (12*x^5 - 12*x^2 + 2*x + 1)*(26*x^4 + x^3 + 1)
**********************************************************************
1 item had failures:
   1 of   7 in sage.rings.tests.?
    [54 tests, 1 failure, 20.02 s]
```



---

archive/issue_comments_473694.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-24T08:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473695.json:
```json
{
    "body": "`@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.",
    "created_at": "2022-03-24T12:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473695",
    "user": "https://github.com/tobiasdiez"
}
```

`@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.



---

archive/issue_comments_473696.json:
```json
{
    "body": "Testing with the command-line from the ticket description of #31924:\n\n```\n$ ./sage -tp src/sage/numerical/backends src/sage/symbolic/expression.pyx src/sage/manifolds/differentiable/symplectic_form_test.py \ntoo many failed tests, not using stored timings\nRunning doctests with ID 2022-03-24-12-10-39-2142352f.\nUsing --optional=4ti2,buckygen,ccache,cryptominisat,debugpy,e_antic,gap_packages,homebrew,igraph,jupymake,latte_int,libsemigroups,lidia,lrslib,meataxe,normaliz,pip,polytopes_db_4d,pynormaliz,sage,sage_spkg,texttable\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nSorting sources by runtime so that slower doctests are run first....\nDoctesting 27 files using 8 threads.\nsage -t --random-seed=241138219171579094251943417982594901397 src/sage/numerical/backends/interactivelp_backend.pxd\n    [0 tests, 0.00 s]\n[...]\nsage -t --random-seed=241138219171579094251943417982594901397 src/sage/numerical/backends/interactivelp_backend.pyx\n    [266 tests, 5.13 s]\nsage -t --random-seed=241138219171579094251943417982594901397 src/sage/symbolic/expression.pyx\n    [3070 tests, 35.91 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 36.7 seconds\n    cpu time: 41.2 seconds\n    cumulative wall time: 48.9 seconds\nFeatures detected for doctesting: sage.rings.number_field\n============================================================================================================ test session starts ============================================================================================================\nplatform darwin -- Python 3.10.2, pytest-7.0.1, pluggy-1.0.0\nrootdir: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src, configfile: tox.ini\ncollected 0 items                                                                                                                                                                                                                           \n\n=========================================================================================================== no tests ran in 0.01s ===========================================================================================================\nERROR: not found: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/symbolic/expression.pyx\n(no name '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/symbolic/expression.pyx' in any of [])\n```",
    "created_at": "2022-03-24T19:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473696",
    "user": "https://github.com/mkoeppe"
}
```

Testing with the command-line from the ticket description of #31924:

```
$ ./sage -tp src/sage/numerical/backends src/sage/symbolic/expression.pyx src/sage/manifolds/differentiable/symplectic_form_test.py 
too many failed tests, not using stored timings
Running doctests with ID 2022-03-24-12-10-39-2142352f.
Using --optional=4ti2,buckygen,ccache,cryptominisat,debugpy,e_antic,gap_packages,homebrew,igraph,jupymake,latte_int,libsemigroups,lidia,lrslib,meataxe,normaliz,pip,polytopes_db_4d,pynormaliz,sage,sage_spkg,texttable
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Sorting sources by runtime so that slower doctests are run first....
Doctesting 27 files using 8 threads.
sage -t --random-seed=241138219171579094251943417982594901397 src/sage/numerical/backends/interactivelp_backend.pxd
    [0 tests, 0.00 s]
[...]
sage -t --random-seed=241138219171579094251943417982594901397 src/sage/numerical/backends/interactivelp_backend.pyx
    [266 tests, 5.13 s]
sage -t --random-seed=241138219171579094251943417982594901397 src/sage/symbolic/expression.pyx
    [3070 tests, 35.91 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 36.7 seconds
    cpu time: 41.2 seconds
    cumulative wall time: 48.9 seconds
Features detected for doctesting: sage.rings.number_field
============================================================================================================ test session starts ============================================================================================================
platform darwin -- Python 3.10.2, pytest-7.0.1, pluggy-1.0.0
rootdir: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src, configfile: tox.ini
collected 0 items                                                                                                                                                                                                                           

=========================================================================================================== no tests ran in 0.01s ===========================================================================================================
ERROR: not found: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/symbolic/expression.pyx
(no name '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/symbolic/expression.pyx' in any of [])
```



---

archive/issue_comments_473697.json:
```json
{
    "body": "There's a (trivial) merge conflict with #32975, best to merge in to make it easier to test.",
    "created_at": "2022-03-24T19:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473697",
    "user": "https://github.com/mkoeppe"
}
```

There's a (trivial) merge conflict with #32975, best to merge in to make it easier to test.



---

archive/issue_comments_473698.json:
```json
{
    "body": "Typo: `skip_as_false_positve` -> `skip_as_false_positive` (2 times)",
    "created_at": "2022-03-24T21:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473698",
    "user": "https://github.com/mkoeppe"
}
```

Typo: `skip_as_false_positve` -> `skip_as_false_positive` (2 times)



---

archive/issue_comments_473699.json:
```json
{
    "body": "Other than comment:7, comment:8, comment:9, it looks good. \n\nI've tested it by itself (it makes a clear improvement - the remaining failures discussed in comment:6 and comment:7 are also present in the current beta).\n\nIt also works well with #31924 merged (it does not create new problems).",
    "created_at": "2022-03-24T21:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473699",
    "user": "https://github.com/mkoeppe"
}
```

Other than comment:7, comment:8, comment:9, it looks good. 

I've tested it by itself (it makes a clear improvement - the remaining failures discussed in comment:6 and comment:7 are also present in the current beta).

It also works well with #31924 merged (it does not create new problems).



---

archive/issue_comments_473700.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-24T21:44:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473700",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_473701.json:
```json
{
    "body": "Replying to [comment:6 gh-tobiasdiez]:\n> `@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.\n\n\nMerging with #33550 I had to resolve some conflics. So I think it would make sence to have it here as dependency.\n\nIm not really familiar with `pytest`. Thus, I can check that this branch does what it is supposed to. But I'm not the right person to evaluate the code.\nI think it would be helpful, if the hook function `pytest_collection_modifyitems` (and maybe other function and classes in `conftest.py`, as well) would have a docstring\nexplaining what this hook is good for (with pointers to the documentation) and why we need to use it here (in more than just one line).\n\nTogether with #33550 the behavior with respect to `src/sage/tests/cmdline.py` remains unchanged. Further, I get the following warnings:\n\n```\nDoctesting 3 files using 4 threads.\nsage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/misc/explain_pickle.py\n    [329 tests, 0.52 s]\nsage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/schemes/elliptic_curves/kraus.py\n    [142 tests, 24.97 s]\nsage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/symbolic/relation.py\n    [393 tests, 28.02 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 28.6 seconds\n    cpu time: 51.6 seconds\n    cumulative wall time: 53.5 seconds\nFeatures detected for doctesting:\n==================================================================================================================== test session starts ====================================================================================================================\nplatform linux -- Python 3.10.2, pytest-7.1.1, pluggy-1.0.0\nrootdir: /home/sebastian/devel/sage/src, configfile: tox.ini\ncollected 7 items\n\nsrc/sage/misc/explain_pickle.py s                                                                                                                                                                                                                     [ 14%]\nsrc/sage/schemes/elliptic_curves/kraus.py sssss                                                                                                                                                                                                       [ 85%]\nsrc/sage/symbolic/relation.py s                                                                                                                                                                                                                       [100%]\n\n===================================================================================================================== warnings summary ======================================================================================================================\nsrc/sage/misc/explain_pickle.py:2723\n  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2723: PytestCollectionWarning: cannot collect test class 'TestReduceGetinitargs' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)\n    class TestReduceGetinitargs:\n\nsrc/sage/misc/explain_pickle.py:2775\n  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2775: PytestCollectionWarning: cannot collect test class 'TestReduceNoGetinitargs' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)\n    class TestReduceNoGetinitargs:\n\nsrc/sage/misc/explain_pickle.py:2813\n  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2813: PytestCollectionWarning: cannot collect test class 'TestAppendList' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)\n    class TestAppendList(list):\n\nsrc/sage/misc/explain_pickle.py:2861\n  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2861: PytestCollectionWarning: cannot collect test class 'TestAppendNonlist' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)\n    class TestAppendNonlist(object):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n============================================================================================================== 7 skipped, 4 warnings in 0.18s ===============================================================================================================\n```\n\nAre these expected?",
    "created_at": "2022-03-25T08:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473701",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:6 gh-tobiasdiez]:
> `@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.


Merging with #33550 I had to resolve some conflics. So I think it would make sence to have it here as dependency.

Im not really familiar with `pytest`. Thus, I can check that this branch does what it is supposed to. But I'm not the right person to evaluate the code.
I think it would be helpful, if the hook function `pytest_collection_modifyitems` (and maybe other function and classes in `conftest.py`, as well) would have a docstring
explaining what this hook is good for (with pointers to the documentation) and why we need to use it here (in more than just one line).

Together with #33550 the behavior with respect to `src/sage/tests/cmdline.py` remains unchanged. Further, I get the following warnings:

```
Doctesting 3 files using 4 threads.
sage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/misc/explain_pickle.py
    [329 tests, 0.52 s]
sage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/schemes/elliptic_curves/kraus.py
    [142 tests, 24.97 s]
sage -t --long --warn-long 124.6 --random-seed=329268236894550985110801561272292236637 src/sage/symbolic/relation.py
    [393 tests, 28.02 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 28.6 seconds
    cpu time: 51.6 seconds
    cumulative wall time: 53.5 seconds
Features detected for doctesting:
==================================================================================================================== test session starts ====================================================================================================================
platform linux -- Python 3.10.2, pytest-7.1.1, pluggy-1.0.0
rootdir: /home/sebastian/devel/sage/src, configfile: tox.ini
collected 7 items

src/sage/misc/explain_pickle.py s                                                                                                                                                                                                                     [ 14%]
src/sage/schemes/elliptic_curves/kraus.py sssss                                                                                                                                                                                                       [ 85%]
src/sage/symbolic/relation.py s                                                                                                                                                                                                                       [100%]

===================================================================================================================== warnings summary ======================================================================================================================
src/sage/misc/explain_pickle.py:2723
  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2723: PytestCollectionWarning: cannot collect test class 'TestReduceGetinitargs' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)
    class TestReduceGetinitargs:

src/sage/misc/explain_pickle.py:2775
  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2775: PytestCollectionWarning: cannot collect test class 'TestReduceNoGetinitargs' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)
    class TestReduceNoGetinitargs:

src/sage/misc/explain_pickle.py:2813
  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2813: PytestCollectionWarning: cannot collect test class 'TestAppendList' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)
    class TestAppendList(list):

src/sage/misc/explain_pickle.py:2861
  /home/sebastian/devel/sage/src/sage/misc/explain_pickle.py:2861: PytestCollectionWarning: cannot collect test class 'TestAppendNonlist' because it has a __init__ constructor (from: sage/misc/explain_pickle.py)
    class TestAppendNonlist(object):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================================================================================================== 7 skipped, 4 warnings in 0.18s ===============================================================================================================
```

Are these expected?



---

archive/issue_comments_473702.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-25T11:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473703.json:
```json
{
    "body": "Replying to [comment:8 mkoeppe]:\n> There's a (trivial) merge conflict with #32975, best to merge in to make it easier to test.\n\n\nMerged!",
    "created_at": "2022-03-25T12:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473703",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:8 mkoeppe]:
> There's a (trivial) merge conflict with #32975, best to merge in to make it easier to test.


Merged!



---

archive/issue_comments_473704.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-25T12:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473704",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_473705.json:
```json
{
    "body": "Replying to [comment:9 mkoeppe]:\n> Typo: `skip_as_false_positve` -> `skip_as_false_positive` (2 times)\n\n\nFixed!",
    "created_at": "2022-03-25T12:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473705",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:9 mkoeppe]:
> Typo: `skip_as_false_positve` -> `skip_as_false_positive` (2 times)


Fixed!



---

archive/issue_comments_473706.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> Testing with the command-line from the ticket description of #31924:\n> \n> ```\n> $ ./sage -tp src/sage/numerical/backends src/sage/symbolic/expression.pyx src/sage/manifolds/differentiable/symplectic_form_test.py \n\n\nThis is now #33560.",
    "created_at": "2022-03-25T12:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473706",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:7 mkoeppe]:
> Testing with the command-line from the ticket description of #31924:
> 
> ```
> $ ./sage -tp src/sage/numerical/backends src/sage/symbolic/expression.pyx src/sage/manifolds/differentiable/symplectic_form_test.py 


This is now #33560.



---

archive/issue_comments_473707.json:
```json
{
    "body": "Replying to [comment:13 soehms]:\n> Replying to [comment:6 gh-tobiasdiez]:\n> > `@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.\n\n> \n> Merging with #33550 I had to resolve some conflics. So I think it would make sence to have it here as dependency.\n\n\nSince both tickets are still under review, I would propose to merge the first positively-reviewed ticket in the other one (to facilitate reviewing). Is this okay?",
    "created_at": "2022-03-25T12:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473707",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:13 soehms]:
> Replying to [comment:6 gh-tobiasdiez]:
> > `@`soehms, thanks for having a look. The first issue you mention also exists in `develop` and I made some progress in fixing it at #33550. The second issue is now fixed.

> 
> Merging with #33550 I had to resolve some conflics. So I think it would make sence to have it here as dependency.


Since both tickets are still under review, I would propose to merge the first positively-reviewed ticket in the other one (to facilitate reviewing). Is this okay?



---

archive/issue_comments_473708.json:
```json
{
    "body": "Replying to [comment:13 soehms]:\n> I think it would be helpful, if the hook function `pytest_collection_modifyitems` (and maybe other function and classes in `conftest.py`, as well) would have a docstring\n> explaining what this hook is good for (with pointers to the documentation) and why we need to use it here (in more than just one line).\n\n\nGood suggestion! Implemented.",
    "created_at": "2022-03-25T12:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473708",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:13 soehms]:
> I think it would be helpful, if the hook function `pytest_collection_modifyitems` (and maybe other function and classes in `conftest.py`, as well) would have a docstring
> explaining what this hook is good for (with pointers to the documentation) and why we need to use it here (in more than just one line).


Good suggestion! Implemented.



---

archive/issue_comments_473709.json:
```json
{
    "body": "Replying to [comment:13 soehms]:\n> Are these expected?\n\n\nNot really. It's the same issue as here with the test functions. These classes are discovered by pytest, which treats them as pytest test classes and fails. I've opened #33561 for this.",
    "created_at": "2022-03-25T12:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473709",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:13 soehms]:
> Are these expected?


Not really. It's the same issue as here with the test functions. These classes are discovered by pytest, which treats them as pytest test classes and fails. I've opened #33561 for this.



---

archive/issue_comments_473710.json:
```json
{
    "body": "LGTM. You can set to positive review or wait if Sebastian has further comments.",
    "created_at": "2022-03-25T15:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473710",
    "user": "https://github.com/mkoeppe"
}
```

LGTM. You can set to positive review or wait if Sebastian has further comments.



---

archive/issue_comments_473711.json:
```json
{
    "body": "Replying to [comment:19 gh-tobiasdiez]:\n> Replying to [comment:13 soehms]:\n> Since both tickets are still under review, I would propose to merge the first positively-reviewed ticket in the other one (to facilitate reviewing). Is this okay?\n\n\nYes, thats o.K.",
    "created_at": "2022-03-25T17:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473711",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:19 gh-tobiasdiez]:
> Replying to [comment:13 soehms]:
> Since both tickets are still under review, I would propose to merge the first positively-reviewed ticket in the other one (to facilitate reviewing). Is this okay?


Yes, thats o.K.



---

archive/issue_comments_473712.json:
```json
{
    "body": "Replying to [comment:22 mkoeppe]:\n> LGTM. You can set to positive review or wait if Sebastian has further comments.\n\n\nLGTM as well!",
    "created_at": "2022-03-25T17:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473712",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:22 mkoeppe]:
> LGTM. You can set to positive review or wait if Sebastian has further comments.


LGTM as well!



---

archive/issue_comments_473713.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-25T17:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473713",
    "user": "https://github.com/soehms"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_473714.json:
```json
{
    "body": "Thanks for the quick review!",
    "created_at": "2022-03-25T18:45:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473714",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks for the quick review!



---

archive/issue_comments_473715.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-03-25T22:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473715",
    "user": "https://github.com/soehms"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_473716.json:
```json
{
    "body": "Sorry, that was a little bit too fast. You accidently dropped a line from the doctest in `src/sage/tests/cmdline.py`. The first failure (line 313) I reported in [comment:4](https://trac.sagemath.org/ticket/33549#comment:4) has not been in `develop`.\n\n```diff\n@@ -308,12 +308,11 @@ def test_executable(args, input=\"\", timeout=100.0, pydebug_ignore_warnings=False\n     Now test my_script.sage and the preparsed version my_script.sage.py::\n\n-        sage: (out, err, ret) = test_executable([\"sage\", \"-t\", script])\n         sage: ret\n         0\n         sage: out.find(\"All tests passed!\") >= 0\n         True\n-        sage: (out, err, ret) = test_executable([\"sage\", \"-t\", script_py])\n+        sage: (out, err, ret) = _test_executable([\"sage\", \"-t\", script_py])\n         sage: ret\n```\n\nAs soon as this is fixed you may switch back to positive review.",
    "created_at": "2022-03-25T22:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473716",
    "user": "https://github.com/soehms"
}
```

Sorry, that was a little bit too fast. You accidently dropped a line from the doctest in `src/sage/tests/cmdline.py`. The first failure (line 313) I reported in [comment:4](https://trac.sagemath.org/ticket/33549#comment:4) has not been in `develop`.

```diff
@@ -308,12 +308,11 @@ def test_executable(args, input="", timeout=100.0, pydebug_ignore_warnings=False
     Now test my_script.sage and the preparsed version my_script.sage.py::

-        sage: (out, err, ret) = test_executable(["sage", "-t", script])
         sage: ret
         0
         sage: out.find("All tests passed!") >= 0
         True
-        sage: (out, err, ret) = test_executable(["sage", "-t", script_py])
+        sage: (out, err, ret) = _test_executable(["sage", "-t", script_py])
         sage: ret
```

As soon as this is fixed you may switch back to positive review.



---

archive/issue_comments_473717.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-26T18:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473717",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473718.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-03-26T18:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473718",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_473719.json:
```json
{
    "body": "Good that you spotted this accident, and thanks for already fixing it!",
    "created_at": "2022-03-27T09:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473719",
    "user": "https://github.com/tobiasdiez"
}
```

Good that you spotted this accident, and thanks for already fixing it!



---

archive/issue_comments_473720.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-03-27T09:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_473721.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-03-27T09:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_473722.json:
```json
{
    "body": "There was still a small typo in the function name, which I've fixed now.",
    "created_at": "2022-03-27T10:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473722",
    "user": "https://github.com/tobiasdiez"
}
```

There was still a small typo in the function name, which I've fixed now.



---

archive/issue_comments_473723.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-27T10:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473723",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_473724.json:
```json
{
    "body": "FWIW, positive review for [SageMath](SageMath) 9.6.beta6 plus #31924 and #33549 plus `make pytest` on Apple Silicon M1 Macs with Homebrew up to date, both macOS 11.6.5 (Big Sur) with Xcode 13.2.1 and macOS 12.3 (Monterey) with Xcode 13.3.",
    "created_at": "2022-03-28T01:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473724",
    "user": "https://github.com/GMS103"
}
```

FWIW, positive review for [SageMath](SageMath) 9.6.beta6 plus #31924 and #33549 plus `make pytest` on Apple Silicon M1 Macs with Homebrew up to date, both macOS 11.6.5 (Big Sur) with Xcode 13.2.1 and macOS 12.3 (Monterey) with Xcode 13.3.



---

archive/issue_comments_473725.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2022-03-30T00:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473725",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_473726.json:
```json
{
    "body": "I am not sure I support giving pytest such high priority over namespace allocation. This is a fairly major change in policy that should be discussed on sage-devel first. Furthermore, you are also hiding functions that used to be public too, which violates Sage's deprecation policy",
    "created_at": "2022-03-30T00:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473726",
    "user": "https://github.com/tscrim"
}
```

I am not sure I support giving pytest such high priority over namespace allocation. This is a fairly major change in policy that should be discussed on sage-devel first. Furthermore, you are also hiding functions that used to be public too, which violates Sage's deprecation policy



---

archive/issue_comments_473727.json:
```json
{
    "body": "In #31924#comment:43, Matthias argues that\n> I think it's fine to rename them if they are only used by doctests in the same module. Then we might argue that it was not really intended to be in the public interface and should have been named _test.... \n\n\nI agree with him that these test-related methods should have been private from the get-go. Especially since most of them contain an explicit disclaimer ala \"this is intended only for usage in doctests\".\n\nBut if you really have issues with the rename and think it's the right procedure, I can start a discussion on the mailing list.",
    "created_at": "2022-03-30T18:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473727",
    "user": "https://github.com/tobiasdiez"
}
```

In #31924#comment:43, Matthias argues that
> I think it's fine to rename them if they are only used by doctests in the same module. Then we might argue that it was not really intended to be in the public interface and should have been named _test.... 


I agree with him that these test-related methods should have been private from the get-go. Especially since most of them contain an explicit disclaimer ala "this is intended only for usage in doctests".

But if you really have issues with the rename and think it's the right procedure, I can start a discussion on the mailing list.



---

archive/issue_comments_473728.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-03-30T22:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473728",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_088311.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-30T22:33:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88311"
}
```



---

archive/issue_comments_473729.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2022-03-30T22:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473729",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_473730.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2022-03-30T22:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473730",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_088312.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-30T22:35:54Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88312"
}
```



---

archive/issue_comments_473731.json:
```json
{
    "body": "Well tests work... let me know when it is ready to be merged.",
    "created_at": "2022-03-30T22:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473731",
    "user": "https://github.com/vbraun"
}
```

Well tests work... let me know when it is ready to be merged.



---

archive/issue_comments_473732.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-30T23:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473732",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_473733.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-03-30T23:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473733",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_473734.json:
```json
{
    "body": "Replying to [comment:34 gh-tobiasdiez]:\n> In #31924#comment:43, Matthias argues that\n> > I think it's fine to rename them if they are only used by doctests in the same module. Then we might argue that it was not really intended to be in the public interface and should have been named _test.... \n\n> \n> I agree with him that these test-related methods should have been private from the get-go. Especially since most of them contain an explicit disclaimer ala \"this is intended only for usage in doctests\".\n\n\nIt does not matter what they should have been, just what they are.\n\n> But if you really have issues with the rename and think it's the right procedure, I can start a discussion on the mailing list.\n\n\nYes: comment:33",
    "created_at": "2022-03-30T23:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473734",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:34 gh-tobiasdiez]:
> In #31924#comment:43, Matthias argues that
> > I think it's fine to rename them if they are only used by doctests in the same module. Then we might argue that it was not really intended to be in the public interface and should have been named _test.... 

> 
> I agree with him that these test-related methods should have been private from the get-go. Especially since most of them contain an explicit disclaimer ala "this is intended only for usage in doctests".


It does not matter what they should have been, just what they are.

> But if you really have issues with the rename and think it's the right procedure, I can start a discussion on the mailing list.


Yes: comment:33



---

archive/issue_comments_473735.json:
```json
{
    "body": "Instead of a policy discussion, perhaps can we move the ticket forward by setting up deprecated aliases for the renamed functions.",
    "created_at": "2022-03-31T01:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473735",
    "user": "https://github.com/mkoeppe"
}
```

Instead of a policy discussion, perhaps can we move the ticket forward by setting up deprecated aliases for the renamed functions.



---

archive/issue_comments_473736.json:
```json
{
    "body": "I strongly think we should not give any package, much less an optional package, any priority over names of public functions without a very good reason. I am also not convinced that we want to move forward with pytest becoming standard either. Both of these need to be discussed on sage-devel, with the first issue for this ticket. You cannot sidestep this. Deprecating the functions is efffectively the same as renaming them as it marks a major policy change.",
    "created_at": "2022-03-31T01:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473736",
    "user": "https://github.com/tscrim"
}
```

I strongly think we should not give any package, much less an optional package, any priority over names of public functions without a very good reason. I am also not convinced that we want to move forward with pytest becoming standard either. Both of these need to be discussed on sage-devel, with the first issue for this ticket. You cannot sidestep this. Deprecating the functions is efffectively the same as renaming them as it marks a major policy change.



---

archive/issue_comments_473737.json:
```json
{
    "body": "Well, function names that are generic. If they are sufficiently unique to the package, then that is fine with me.",
    "created_at": "2022-03-31T01:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473737",
    "user": "https://github.com/tscrim"
}
```

Well, function names that are generic. If they are sufficiently unique to the package, then that is fine with me.



---

archive/issue_comments_473738.json:
```json
{
    "body": "All of them are unique to the module that they are defined in, and their purpose is to support doctests in the same module. Renaming them from `test_...` to `_test_...` is justified by existing policies, I'd say.",
    "created_at": "2022-03-31T02:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473738",
    "user": "https://github.com/mkoeppe"
}
```

All of them are unique to the module that they are defined in, and their purpose is to support doctests in the same module. Renaming them from `test_...` to `_test_...` is justified by existing policies, I'd say.



---

archive/issue_comments_473739.json:
```json
{
    "body": "Yes, but that is a non sequitur. I agree that renaming them (with deprecation) is within the current policy, but it is the reason for these changes that is the issue. It is about the conflict with an optional package's conventions that are fully reserve a certain class of (natural) function names. Enforcing this (which is done here across the entire Sage library) would give `pytest` very special privileges and status within Sage.",
    "created_at": "2022-03-31T06:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473739",
    "user": "https://github.com/tscrim"
}
```

Yes, but that is a non sequitur. I agree that renaming them (with deprecation) is within the current policy, but it is the reason for these changes that is the issue. It is about the conflict with an optional package's conventions that are fully reserve a certain class of (natural) function names. Enforcing this (which is done here across the entire Sage library) would give `pytest` very special privileges and status within Sage.



---

archive/issue_comments_473740.json:
```json
{
    "body": "I have split out #33612 for the strategy proposed in comment:40, comment:43. As you will see in the ticket description, it is an improvement to the Sage library independent from its motivation for pytest.",
    "created_at": "2022-03-31T13:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473740",
    "user": "https://github.com/mkoeppe"
}
```

I have split out #33612 for the strategy proposed in comment:40, comment:43. As you will see in the ticket description, it is an improvement to the Sage library independent from its motivation for pytest.



---

archive/issue_comments_473741.json:
```json
{
    "body": "Thanks Matthias!",
    "created_at": "2022-03-31T14:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33312#issuecomment-473741",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks Matthias!



---

archive/issue_events_088313.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88313"
}
```



---

archive/issue_events_088314.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88314"
}
```



---

archive/issue_events_088315.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-06T19:24:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88315"
}
```



---

archive/issue_events_088316.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-06T19:24:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33312",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33312#event-88316"
}
```
