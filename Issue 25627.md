# Issue 25627: make LinearExtensions an iterator

archive/issues_025627.json:
```json
{
    "body": "CC:  tscrim chapoton jmantysalo kdilks aschilling\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25864\n\n",
    "created_at": "2018-07-17T06:35:19Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "make LinearExtensions an iterator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25627",
    "user": "mantepse"
}
```
CC:  tscrim chapoton jmantysalo kdilks aschilling



Issue created by migration from https://trac.sagemath.org/ticket/25864





---

archive/issue_comments_361400.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2018-07-17T07:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361400",
    "user": "mantepse"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_361401.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-07-17T07:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361401",
    "user": "mantepse"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_361402.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-07-17T07:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361402",
    "user": "mantepse"
}
```

New commits:



---

archive/issue_comments_361403.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-17T11:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361403",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361404.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-17T18:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361404",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361405.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-17T18:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361405",
    "user": "mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_361406.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-18T07:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361406",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361407.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-18T08:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361407",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361408.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-18T11:24:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361408",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361409.json:
```json
{
    "body": "I do not understand. \"Currently, it is returning a (sorted) list.\", but already\n\n`_ = posets.BooleanLattice(4).linear_extensions()`\n\ntakes about zero time, whereas\n\n`_ = list(posets.BooleanLattice(4).linear_extensions())`\n\ntakes at least a minute, and for example\n\n`_ = posets.BooleanLattice(4).linear_extensions()[2000]`\n\ntakes a fraction of a second. So, this seems to already be an iterator.",
    "created_at": "2018-07-18T15:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361409",
    "user": "jmantysalo"
}
```

I do not understand. "Currently, it is returning a (sorted) list.", but already

`_ = posets.BooleanLattice(4).linear_extensions()`

takes about zero time, whereas

`_ = list(posets.BooleanLattice(4).linear_extensions())`

takes at least a minute, and for example

`_ = posets.BooleanLattice(4).linear_extensions()[2000]`

takes a fraction of a second. So, this seems to already be an iterator.



---

archive/issue_comments_361410.json:
```json
{
    "body": "Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.\n\nIn particular:\n\nReplying to [comment:10 jmantysalo]:\n> I do not understand. \"Currently, it is returning a (sorted) list.\", but already\n> \n> `_ = posets.BooleanLattice(4).linear_extensions()`\n> \n> takes about zero time, whereas\n\nbecause only the initialisation code is run,\n\n> `_ = list(posets.BooleanLattice(4).linear_extensions())`\n> \n> takes at least a minute, and for example\n\nbecause the list of all linear extensions is created, and\n\n> `_ = posets.BooleanLattice(4).linear_extensions()[2000]`\n> \n> takes a fraction of a second.\n\nbecause this is only accessing an element in a list.",
    "created_at": "2018-07-18T17:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361410",
    "user": "mantepse"
}
```

Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.

In particular:

Replying to [comment:10 jmantysalo]:
> I do not understand. "Currently, it is returning a (sorted) list.", but already
> 
> `_ = posets.BooleanLattice(4).linear_extensions()`
> 
> takes about zero time, whereas

because only the initialisation code is run,

> `_ = list(posets.BooleanLattice(4).linear_extensions())`
> 
> takes at least a minute, and for example

because the list of all linear extensions is created, and

> `_ = posets.BooleanLattice(4).linear_extensions()[2000]`
> 
> takes a fraction of a second.

because this is only accessing an element in a list.



---

archive/issue_comments_361411.json:
```json
{
    "body": "Replying to [comment:11 mantepse]:\n> Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.\n\n??? No, it has `__iter__` that is an iterator.",
    "created_at": "2018-07-19T04:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361411",
    "user": "jmantysalo"
}
```

Replying to [comment:11 mantepse]:
> Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.

??? No, it has `__iter__` that is an iterator.



---

archive/issue_comments_361412.json:
```json
{
    "body": "Replying to [comment:12 jmantysalo]:\n> Replying to [comment:11 mantepse]:\n> > Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.\n> \n> ??? No, it has `__iter__` that is an iterator.\n\nwhich calls `self._linear_extensions_of_hasse_diagram` which is `sage.graphs.linearextensions.LinearExtensions(poset._hasse_diagram)` which had only a `list` method before this ticket...",
    "created_at": "2018-07-19T08:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361412",
    "user": "mantepse"
}
```

Replying to [comment:12 jmantysalo]:
> Replying to [comment:11 mantepse]:
> > Currently, `P.linear_extensions()` returns a class, with some (rather little) initialisations done.  This class has a `__list__` method, which triggers the actual computation.
> 
> ??? No, it has `__iter__` that is an iterator.

which calls `self._linear_extensions_of_hasse_diagram` which is `sage.graphs.linearextensions.LinearExtensions(poset._hasse_diagram)` which had only a `list` method before this ticket...



---

archive/issue_comments_361413.json:
```json
{
    "body": "But clearly there is some kind of \"iterator\" used here, as we can ask for example tenth linear extension without generating the whole list. In a quick look it seems that `generate_linear_extensions` gives kind of \"implicit iterator\", as it computes \"next\" linear extension in some order of extensions.\n\nBut is it so that current implementation eats memory, i.e. already \"used\" extensions are not released from the memory? If so, then I understand this.",
    "created_at": "2018-07-19T08:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361413",
    "user": "jmantysalo"
}
```

But clearly there is some kind of "iterator" used here, as we can ask for example tenth linear extension without generating the whole list. In a quick look it seems that `generate_linear_extensions` gives kind of "implicit iterator", as it computes "next" linear extension in some order of extensions.

But is it so that current implementation eats memory, i.e. already "used" extensions are not released from the memory? If so, then I understand this.



---

archive/issue_comments_361414.json:
```json
{
    "body": "Replying to [comment:14 jmantysalo]:\n> But clearly there is some kind of \"iterator\" used here, as we can ask for example tenth linear extension without generating the whole list. \n\nNo, the problem is precisely that the whole list is always generated.  This is slightly obscured by the fact that posets are `UniqueRepresentation`.  But to see it, you can insert a line\n\n```diff\ndiff --git a/src/sage/graphs/linearextensions.py b/src/sage/graphs/linearextensions.py\nindex 113a2cd..f899dfc 100644\n--- a/src/sage/graphs/linearextensions.py\n+++ b/src/sage/graphs/linearextensions.py\n@@ -347,6 +347,7 @@ class LinearExtensions(CombinatorialClass):\n              [0, 2, 1, 4, 3],\n              [0, 2, 4, 1, 3]]\n         \"\"\"\n+        print(\"computing\")\n         if self.linear_extensions is not None:\n             return self.linear_extensions[:]\n```\n\nrebuild sage, and then verify the following:\n\n```\nsage: P = posets.AntichainPoset(9); L = P.linear_extensions()._linear_extensions_of_hasse_diagram\nsage: type(L.linear_extensions)\n<type 'NoneType'>\nsage: L[0]\ncomputing\n[0, 1, 2, 3, 4, 5, 6, 7, 8]\nsage: type(L.linear_extensions)\n<type 'list'>\nsage: L.linear_extensions[0]\n[0, 1, 2, 3, 4, 5, 6, 7, 8]\nsage: L.linear_extensions[-1]\n[8, 7, 6, 5, 4, 3, 2, 1, 0]\n```\n\n\nAs you can see, the list of linear extensions is computed although only the first element is requested.",
    "created_at": "2018-07-19T11:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361414",
    "user": "mantepse"
}
```

Replying to [comment:14 jmantysalo]:
> But clearly there is some kind of "iterator" used here, as we can ask for example tenth linear extension without generating the whole list. 

No, the problem is precisely that the whole list is always generated.  This is slightly obscured by the fact that posets are `UniqueRepresentation`.  But to see it, you can insert a line

```diff
diff --git a/src/sage/graphs/linearextensions.py b/src/sage/graphs/linearextensions.py
index 113a2cd..f899dfc 100644
--- a/src/sage/graphs/linearextensions.py
+++ b/src/sage/graphs/linearextensions.py
@@ -347,6 +347,7 @@ class LinearExtensions(CombinatorialClass):
              [0, 2, 1, 4, 3],
              [0, 2, 4, 1, 3]]
         """
+        print("computing")
         if self.linear_extensions is not None:
             return self.linear_extensions[:]
```

rebuild sage, and then verify the following:

```
sage: P = posets.AntichainPoset(9); L = P.linear_extensions()._linear_extensions_of_hasse_diagram
sage: type(L.linear_extensions)
<type 'NoneType'>
sage: L[0]
computing
[0, 1, 2, 3, 4, 5, 6, 7, 8]
sage: type(L.linear_extensions)
<type 'list'>
sage: L.linear_extensions[0]
[0, 1, 2, 3, 4, 5, 6, 7, 8]
sage: L.linear_extensions[-1]
[8, 7, 6, 5, 4, 3, 2, 1, 0]
```


As you can see, the list of linear extensions is computed although only the first element is requested.



---

archive/issue_comments_361415.json:
```json
{
    "body": "This is very interesting. Maybe Travis or Fr\u00e9d\u00e9ric can tell what happens here... I start Sage and say\n\n\n```\nsage: for x in posets.AntichainPoset(10).linear_extensions():\n....:     print x\n....:     break\n```\n\n\nNo output, system seems to be stalled. I press Ctrl+C and get back to command line. I give the same command again, and now I got\n\n`[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]`\n\nSo, it seems that this kind of is an iterator, but not exactly.",
    "created_at": "2018-07-19T12:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361415",
    "user": "jmantysalo"
}
```

This is very interesting. Maybe Travis or Frédéric can tell what happens here... I start Sage and say


```
sage: for x in posets.AntichainPoset(10).linear_extensions():
....:     print x
....:     break
```


No output, system seems to be stalled. I press Ctrl+C and get back to command line. I give the same command again, and now I got

`[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]`

So, it seems that this kind of is an iterator, but not exactly.



---

archive/issue_comments_361416.json:
```json
{
    "body": "Replying to [comment:16 jmantysalo]:\n> This is very interesting. Maybe Travis or Fr\u00e9d\u00e9ric can tell what happens here... I start Sage and say\n> \n> {{{\n> sage: for x in posets.AntichainPoset(10).linear_extensions():\n> ....:     print x\n> ....:     break\n> }}}\n> \n> No output, system seems to be stalled. I press Ctrl+C and get back to command line. I give the same command again, and now I got\n> \n> `[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]`\n> \n> So, it seems that this kind of is an iterator, but not exactly.\n\nYou are simply interrupting the computation in `posets.AntichainPoset(10).linear_extensions()._linear_extensions_of_hasse_diagram.list()`.\n\nYou can see this as follows: in a fresh session (!!!) do the same as before, that is, interrupt\n\n```\nsage: P = posets.AntichainPoset(10)\nsage: for x in P.linear_extensions():\n....:     print x\n....:     break\n```\n\nthen again\n\n```\nsage: for x in P.linear_extensions():\n....:     print x\n....:     break\n```\n\nwhich will yield\n\n```\n[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]\n```\n\nThen check that\n\n```\nsage: P.linear_extensions().cardinality()\n3628800\n```\n\nFinally:\n\n```\nsage: len(P.linear_extensions()._linear_extensions_of_hasse_diagram.linear_extensions)\n```\n\nwhich will tell you a smaller number.  And indeed\n\n```\nsage: P.linear_extensions()[3628800-1]\n```\n\nwill give an error (after a while, because lists are copied all the time).",
    "created_at": "2018-07-19T12:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361416",
    "user": "mantepse"
}
```

Replying to [comment:16 jmantysalo]:
> This is very interesting. Maybe Travis or Frédéric can tell what happens here... I start Sage and say
> 
> {{{
> sage: for x in posets.AntichainPoset(10).linear_extensions():
> ....:     print x
> ....:     break
> }}}
> 
> No output, system seems to be stalled. I press Ctrl+C and get back to command line. I give the same command again, and now I got
> 
> `[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]`
> 
> So, it seems that this kind of is an iterator, but not exactly.

You are simply interrupting the computation in `posets.AntichainPoset(10).linear_extensions()._linear_extensions_of_hasse_diagram.list()`.

You can see this as follows: in a fresh session (!!!) do the same as before, that is, interrupt

```
sage: P = posets.AntichainPoset(10)
sage: for x in P.linear_extensions():
....:     print x
....:     break
```

then again

```
sage: for x in P.linear_extensions():
....:     print x
....:     break
```

which will yield

```
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
```

Then check that

```
sage: P.linear_extensions().cardinality()
3628800
```

Finally:

```
sage: len(P.linear_extensions()._linear_extensions_of_hasse_diagram.linear_extensions)
```

which will tell you a smaller number.  And indeed

```
sage: P.linear_extensions()[3628800-1]
```

will give an error (after a while, because lists are copied all the time).



---

archive/issue_comments_361417.json:
```json
{
    "body": "In the process of reading the code in `graphs/linearextensions.py`, and trying to figure out how it needs to be modified to become an iterator. I may need to read a bit more of the paper to understand what the individual helper methods are doing and how they tie together. I'm hoping it will eventually be as easy as changing the end of the `move()` and `switch()` methods to be yield statements, and make the `list()` method an `_iter_()` method.\n\nOne potential problem that could arise by changing things is if any other code relies on linear extensions of a poset being generated in lexicographic order. The algorithm itself does not generate them in lexicographic order, but the current implementation makes it appear that way to the user since the entire list is generated and then sorted before being iterated over.",
    "created_at": "2018-07-23T15:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361417",
    "user": "kdilks"
}
```

In the process of reading the code in `graphs/linearextensions.py`, and trying to figure out how it needs to be modified to become an iterator. I may need to read a bit more of the paper to understand what the individual helper methods are doing and how they tie together. I'm hoping it will eventually be as easy as changing the end of the `move()` and `switch()` methods to be yield statements, and make the `list()` method an `_iter_()` method.

One potential problem that could arise by changing things is if any other code relies on linear extensions of a poset being generated in lexicographic order. The algorithm itself does not generate them in lexicographic order, but the current implementation makes it appear that way to the user since the entire list is generated and then sorted before being iterated over.



---

archive/issue_comments_361418.json:
```json
{
    "body": "`@`kdilks: I modified the code already so that it is a true iterator!\n\nIt only needs review, there is no coding to be done!",
    "created_at": "2018-07-23T17:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361418",
    "user": "mantepse"
}
```

`@`kdilks: I modified the code already so that it is a true iterator!

It only needs review, there is no coding to be done!



---

archive/issue_comments_361419.json:
```json
{
    "body": "Much easier!\n\nStill building Sage to run some tests. Only extremely minor thing I see from looking at the diff is that the docstring for the _iter_ method still says 'Returns a list of ...' from when it was the list method.",
    "created_at": "2018-07-23T19:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361419",
    "user": "kdilks"
}
```

Much easier!

Still building Sage to run some tests. Only extremely minor thing I see from looking at the diff is that the docstring for the _iter_ method still says 'Returns a list of ...' from when it was the list method.



---

archive/issue_comments_361420.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T20:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361420",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361421.json:
```json
{
    "body": "Some things:\n\n- It is better practice to copy the dag on input rather than at `_prepare` as it is possible to pass the dag in, modify the dag, and then run `_prepare`. It also means that it will never have an inconsistent state by having linear extensions for a dag that is not its `self.dag`.\n\n- Errors are not full sentences by Python conventions:\n  {{{#!diff\n-ValueError(\"The digraph must be acyclic to have linear extensions.\")\n+ValueError(\"the digraph must be acyclic to have linear extensions\")\n  }}}\n\n- The result is no longer cached. So if this is called repeatedly for the same dag, this could be slower. I think your change is okay, but it might have unintended consequences in terms of speed. Did you check this?",
    "created_at": "2018-07-24T03:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361421",
    "user": "tscrim"
}
```

Some things:

- It is better practice to copy the dag on input rather than at `_prepare` as it is possible to pass the dag in, modify the dag, and then run `_prepare`. It also means that it will never have an inconsistent state by having linear extensions for a dag that is not its `self.dag`.

- Errors are not full sentences by Python conventions:
  {{{#!diff
-ValueError("The digraph must be acyclic to have linear extensions.")
+ValueError("the digraph must be acyclic to have linear extensions")
  }}}

- The result is no longer cached. So if this is called repeatedly for the same dag, this could be slower. I think your change is okay, but it might have unintended consequences in terms of speed. Did you check this?



---

archive/issue_comments_361422.json:
```json
{
    "body": "The first item is a bit more work, because I will have to copy the graph twice or prepare a matrix of incomparable elements.  Not sure yet what's better.",
    "created_at": "2018-07-24T11:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361422",
    "user": "mantepse"
}
```

The first item is a bit more work, because I will have to copy the graph twice or prepare a matrix of incomparable elements.  Not sure yet what's better.



---

archive/issue_comments_361423.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-24T13:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361423",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361424.json:
```json
{
    "body": "I now get\n\n```\n            sage: l == loads(dumps(l))\n            False\n```\n\nno idea why (I don't even know what this does...)",
    "created_at": "2018-07-24T13:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361424",
    "user": "mantepse"
}
```

I now get

```
            sage: l == loads(dumps(l))
            False
```

no idea why (I don't even know what this does...)



---

archive/issue_comments_361425.json:
```json
{
    "body": "Google is telling me that this error can occur when you have a dictionary with non-string keys (dumps converts a dictionary to a json file which only has string keys, and then loads recreates the dictionary). How/why that's coming up...I've got nothing.",
    "created_at": "2018-07-24T13:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361425",
    "user": "kdilks"
}
```

Google is telling me that this error can occur when you have a dictionary with non-string keys (dumps converts a dictionary to a json file which only has string keys, and then loads recreates the dictionary). How/why that's coming up...I've got nothing.



---

archive/issue_comments_361426.json:
```json
{
    "body": "The loads/dumps problem is a \"pickling issue\" : dumps somehow saves a compressed copy of the object (pickle) and loads restores back something from that. This kind of error is usually triggered by wrong behaviour of the comparison methods `__eq__` or `__richcmp__`. You should try to understand why `l` and `loads(dumps(l))` do not compare equal, and who is in charge of the comparison.",
    "created_at": "2018-07-24T13:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361426",
    "user": "chapoton"
}
```

The loads/dumps problem is a "pickling issue" : dumps somehow saves a compressed copy of the object (pickle) and loads restores back something from that. This kind of error is usually triggered by wrong behaviour of the comparison methods `__eq__` or `__richcmp__`. You should try to understand why `l` and `loads(dumps(l))` do not compare equal, and who is in charge of the comparison.



---

archive/issue_comments_361427.json:
```json
{
    "body": "It appears to me now that this class actually shouldn't be a parent, because that's what `LinearExtensionsOfPoset` does, except that the latter is specialised to posets, not arbitrary DAGs.\n\nApart from there, this class is only used once in library code, in `Permutation`.\n\nAlternatively, blow it up similarly to `LinearExtensionsOfPoset`, but I'm a bit afraid that this is really only bloat.",
    "created_at": "2018-07-24T13:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361427",
    "user": "mantepse"
}
```

It appears to me now that this class actually shouldn't be a parent, because that's what `LinearExtensionsOfPoset` does, except that the latter is specialised to posets, not arbitrary DAGs.

Apart from there, this class is only used once in library code, in `Permutation`.

Alternatively, blow it up similarly to `LinearExtensionsOfPoset`, but I'm a bit afraid that this is really only bloat.



---

archive/issue_comments_361428.json:
```json
{
    "body": "I at least agree that it probably should not be a non-fa\u00e7ade `Parent` as its \"elements\" are lists. In fact, this is probably something we should consider cythonizing since this is *also* used by `DiGraph.topological_sort_generator` (which sounds like it should return an iterator, not a list, but that is a separate issue). Granted, since this is more of an internal class, you are probably right in that it should not be a subclass of `Parent`, but it might mean a finer check.",
    "created_at": "2018-07-26T12:43:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361428",
    "user": "tscrim"
}
```

I at least agree that it probably should not be a non-façade `Parent` as its "elements" are lists. In fact, this is probably something we should consider cythonizing since this is *also* used by `DiGraph.topological_sort_generator` (which sounds like it should return an iterator, not a list, but that is a separate issue). Granted, since this is more of an internal class, you are probably right in that it should not be a subclass of `Parent`, but it might mean a finer check.



---

archive/issue_comments_361429.json:
```json
{
    "body": "Changing keywords from \"\" to \"sagedays@icerm\".",
    "created_at": "2018-07-26T12:43:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361429",
    "user": "tscrim"
}
```

Changing keywords from "" to "sagedays@icerm".



---

archive/issue_comments_361430.json:
```json
{
    "body": "Could you say (or give me a reference to) what a non-facade parent is?  Or, maybe easier, what `LinearExtensions` should inherit from.\n\n(I have already adapted the code from `LinearExtensionsOfPoset`, making it a real parent with a new element class `LinearExtension` - its easy to do, I just don't know whether it is what should be done.)",
    "created_at": "2018-07-26T18:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361430",
    "user": "mantepse"
}
```

Could you say (or give me a reference to) what a non-facade parent is?  Or, maybe easier, what `LinearExtensions` should inherit from.

(I have already adapted the code from `LinearExtensionsOfPoset`, making it a real parent with a new element class `LinearExtension` - its easy to do, I just don't know whether it is what should be done.)



---

archive/issue_comments_361431.json:
```json
{
    "body": "A fa\u00e7ade parent is a parent that does not have elements but functionally behaves like a parent. IIRC, see the doc of `Parent`. As I said in comment:30, it probably should not inherit from `Parent`, and so probably should be a subclass of `object`. However, there might be some things from the category that do get utilized (such as in the top sort method).",
    "created_at": "2018-07-26T23:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361431",
    "user": "tscrim"
}
```

A façade parent is a parent that does not have elements but functionally behaves like a parent. IIRC, see the doc of `Parent`. As I said in comment:30, it probably should not inherit from `Parent`, and so probably should be a subclass of `object`. However, there might be some things from the category that do get utilized (such as in the top sort method).



---

archive/issue_comments_361432.json:
```json
{
    "body": "I decided to give it a try and cythonized the iterator.  I currently have a speedup of a factor 2.  I am still polishing.",
    "created_at": "2018-08-26T06:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361432",
    "user": "mantepse"
}
```

I decided to give it a try and cythonized the iterator.  I currently have a speedup of a factor 2.  I am still polishing.



---

archive/issue_comments_361433.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-26T21:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361433",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361434.json:
```json
{
    "body": "new:\n\n```\nsage: from sage.combinat.combinat_cython import linear_extension_iterator\nsage: D = posets.BooleanLattice(4)\nsage: %time for e in linear_extension_iterator(D._hasse_diagram): pass\nCPU times: user 23.5 s, sys: 47.7 ms, total: 23.5 s\nWall time: 23.5 s\nsage: from sage.graphs.linearextensions import LinearExtensions\nsage: %time for e in LinearExtensions(D): pass\nCPU times: user 25.1 s, sys: 0 ns, total: 25.1 s\nWall time: 25 s\n```\n\nold:\n\n```\nsage: D = posets.BooleanLattice(4)\nsage: from sage.graphs.linearextensions import LinearExtensions\nsage: %time for e in LinearExtensions(D.hasse_diagram()): pass\nCPU times: user 2min 49s, sys: 692 ms, total: 2min 49s\nWall time: 2min 51s\n```\n",
    "created_at": "2018-08-26T21:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361434",
    "user": "mantepse"
}
```

new:

```
sage: from sage.combinat.combinat_cython import linear_extension_iterator
sage: D = posets.BooleanLattice(4)
sage: %time for e in linear_extension_iterator(D._hasse_diagram): pass
CPU times: user 23.5 s, sys: 47.7 ms, total: 23.5 s
Wall time: 23.5 s
sage: from sage.graphs.linearextensions import LinearExtensions
sage: %time for e in LinearExtensions(D): pass
CPU times: user 25.1 s, sys: 0 ns, total: 25.1 s
Wall time: 25 s
```

old:

```
sage: D = posets.BooleanLattice(4)
sage: from sage.graphs.linearextensions import LinearExtensions
sage: %time for e in LinearExtensions(D.hasse_diagram()): pass
CPU times: user 2min 49s, sys: 692 ms, total: 2min 49s
Wall time: 2min 51s
```




---

archive/issue_comments_361435.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-27T19:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361435",
    "user": "mantepse"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361436.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-28T08:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361436",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361437.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-28T20:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361437",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361438.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-02T10:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361438",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361439.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2018-09-02T10:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361439",
    "user": "mantepse"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_361440.json:
```json
{
    "body": "I don't know what to do with\n\n```\n            sage: from sage.graphs.linearextensions import LinearExtensions\n            sage: D = DiGraph({ 0:[1,2], 1:[3], 2:[3,4] })\n            sage: l = LinearExtensions(D)\n            sage: l == loads(dumps(l))\n            True\n```\n\n(because this now gives `False`)\n\nAlso, maybe it would be better to deprecate the class `LinearExtensions` completely, the class `LinearExtensionsOfPoset` should be a good replacement (and might be renamed `LinearExtensions`).",
    "created_at": "2018-09-02T10:04:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361440",
    "user": "mantepse"
}
```

I don't know what to do with

```
            sage: from sage.graphs.linearextensions import LinearExtensions
            sage: D = DiGraph({ 0:[1,2], 1:[3], 2:[3,4] })
            sage: l = LinearExtensions(D)
            sage: l == loads(dumps(l))
            True
```

(because this now gives `False`)

Also, maybe it would be better to deprecate the class `LinearExtensions` completely, the class `LinearExtensionsOfPoset` should be a good replacement (and might be renamed `LinearExtensions`).



---

archive/issue_comments_361441.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-02T13:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361441",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361442.json:
```json
{
    "body": "Anne, I'm guessing that this might affect (positively, I hope) a lot of your code...",
    "created_at": "2018-09-02T13:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361442",
    "user": "mantepse"
}
```

Anne, I'm guessing that this might affect (positively, I hope) a lot of your code...



---

archive/issue_comments_361443.json:
```json
{
    "body": "Replying to [comment:41 mantepse]:\n> I don't know what to do with\n> {{{\n>             sage: from sage.graphs.linearextensions import LinearExtensions\n>             sage: D = DiGraph({ 0:[1,2], 1:[3], 2:[3,4] })\n>             sage: l = LinearExtensions(D)\n>             sage: l == loads(dumps(l))\n>             True\n> }}}\n> (because this now gives `False`)\n\nBecause `Parent` does not have an `__eq__` method (so it defaults to compare by id, which is obviously false).\n\n> Also, maybe it would be better to deprecate the class `LinearExtensions` completely, the class `LinearExtensionsOfPoset` should be a good replacement (and might be renamed `LinearExtensions`).\n\n`LinearExtensions` was serving as an iterator object that yielded low level objects. Now this is done by your cython iterator. So +1 for deprecating it, -1 from saying `LinearExtensionsOfPoset` is a replacement.\n\nAlso, I have a general -1 on all of those `sorted`. They should not be necessary, and within code, they can be (relatively) expensive when not needed.",
    "created_at": "2018-09-02T22:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361443",
    "user": "tscrim"
}
```

Replying to [comment:41 mantepse]:
> I don't know what to do with
> {{{
>             sage: from sage.graphs.linearextensions import LinearExtensions
>             sage: D = DiGraph({ 0:[1,2], 1:[3], 2:[3,4] })
>             sage: l = LinearExtensions(D)
>             sage: l == loads(dumps(l))
>             True
> }}}
> (because this now gives `False`)

Because `Parent` does not have an `__eq__` method (so it defaults to compare by id, which is obviously false).

> Also, maybe it would be better to deprecate the class `LinearExtensions` completely, the class `LinearExtensionsOfPoset` should be a good replacement (and might be renamed `LinearExtensions`).

`LinearExtensions` was serving as an iterator object that yielded low level objects. Now this is done by your cython iterator. So +1 for deprecating it, -1 from saying `LinearExtensionsOfPoset` is a replacement.

Also, I have a general -1 on all of those `sorted`. They should not be necessary, and within code, they can be (relatively) expensive when not needed.



---

archive/issue_comments_361444.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-04T16:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361444",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361445.json:
```json
{
    "body": "Travis, I need some help with the deprecation message and the `sorted` issue.\n\n* I think the deprecation is mainly (but not exclusively) to direct the user to alternatives.  Thus I'd say it's `DiGraph.topological_sort_generator` and `LinearExtensionsOfPoset`.  You wrote that you disagree with `LinearExtensionsOfPoset`, could you please expand why?\n\n* `LinearExtensions` sorted it's result, and I think it's fine to leave it that way in the deprecated class.  However, in `LinearExtensionsOfPoset` I certainly do not want to sort.  Should I remove the sorting from the doctests too?\n\n* `topological_sort_generator` returns a sorted list.  Should I create a new method `topological_sort_iterator`, which is an iterator, and deprecate the old method, or should I silently modify the old method?\n\n* I would actually like to advertise `LinearExtensionsOfPoset` as main entry point, and I think this should also be a method of `Poset`.  What do you think?",
    "created_at": "2018-09-04T16:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361445",
    "user": "mantepse"
}
```

Travis, I need some help with the deprecation message and the `sorted` issue.

* I think the deprecation is mainly (but not exclusively) to direct the user to alternatives.  Thus I'd say it's `DiGraph.topological_sort_generator` and `LinearExtensionsOfPoset`.  You wrote that you disagree with `LinearExtensionsOfPoset`, could you please expand why?

* `LinearExtensions` sorted it's result, and I think it's fine to leave it that way in the deprecated class.  However, in `LinearExtensionsOfPoset` I certainly do not want to sort.  Should I remove the sorting from the doctests too?

* `topological_sort_generator` returns a sorted list.  Should I create a new method `topological_sort_iterator`, which is an iterator, and deprecate the old method, or should I silently modify the old method?

* I would actually like to advertise `LinearExtensionsOfPoset` as main entry point, and I think this should also be a method of `Poset`.  What do you think?



---

archive/issue_comments_361446.json:
```json
{
    "body": "Replying to [comment:46 mantepse]:\n> * I think the deprecation is mainly (but not exclusively) to direct the user to alternatives.  Thus I'd say it's `DiGraph.topological_sort_generator` and `LinearExtensionsOfPoset`.  You wrote that you disagree with `LinearExtensionsOfPoset`, could you please expand why?\n\nAs per comment:44, `LinearExtensionsOfPoset` does not return a low-level object (in this case, a list). It is not equivalent or an alternative as a DAG is not a poset.\n\n> * `LinearExtensions` sorted it's result, and I think it's fine to leave it that way in the deprecated class.  However, in `LinearExtensionsOfPoset` I certainly do not want to sort.  Should I remove the sorting from the doctests too?\n\nYes. It is not machine dependent, right? There is no point in adding useless things (e.g. sorting) to doctests or code.\n\n> * `topological_sort_generator` returns a sorted list.  Should I create a new method `topological_sort_iterator`, which is an iterator, and deprecate the old method, or should I silently modify the old method?\n\nThat it was sorting things is an implementation detail. There is nothing in the documentation about guaranteeing that the linear extensions returned are in a particular order.\n\n> * I would actually like to advertise `LinearExtensionsOfPoset` as main entry point, and I think this should also be a method of `Poset`.  What do you think?\n\nStrong -1 on having `LinearExtensionsOfPoset` as a global entry point and suggesting it in any documentation. You should always go through `Poset(foo).linear_extensions()`. This is natural and helps keeps the global namespace clean.",
    "created_at": "2018-09-04T22:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361446",
    "user": "tscrim"
}
```

Replying to [comment:46 mantepse]:
> * I think the deprecation is mainly (but not exclusively) to direct the user to alternatives.  Thus I'd say it's `DiGraph.topological_sort_generator` and `LinearExtensionsOfPoset`.  You wrote that you disagree with `LinearExtensionsOfPoset`, could you please expand why?

As per comment:44, `LinearExtensionsOfPoset` does not return a low-level object (in this case, a list). It is not equivalent or an alternative as a DAG is not a poset.

> * `LinearExtensions` sorted it's result, and I think it's fine to leave it that way in the deprecated class.  However, in `LinearExtensionsOfPoset` I certainly do not want to sort.  Should I remove the sorting from the doctests too?

Yes. It is not machine dependent, right? There is no point in adding useless things (e.g. sorting) to doctests or code.

> * `topological_sort_generator` returns a sorted list.  Should I create a new method `topological_sort_iterator`, which is an iterator, and deprecate the old method, or should I silently modify the old method?

That it was sorting things is an implementation detail. There is nothing in the documentation about guaranteeing that the linear extensions returned are in a particular order.

> * I would actually like to advertise `LinearExtensionsOfPoset` as main entry point, and I think this should also be a method of `Poset`.  What do you think?

Strong -1 on having `LinearExtensionsOfPoset` as a global entry point and suggesting it in any documentation. You should always go through `Poset(foo).linear_extensions()`. This is natural and helps keeps the global namespace clean.



---

archive/issue_comments_361447.json:
```json
{
    "body": "Oh, I didn't realize that `Poset` has a method returning `LinearExtensionsOfPoset`...",
    "created_at": "2018-09-05T04:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361447",
    "user": "mantepse"
}
```

Oh, I didn't realize that `Poset` has a method returning `LinearExtensionsOfPoset`...



---

archive/issue_comments_361448.json:
```json
{
    "body": "I am now removing the sorted from the doctests, but I must say that I think this is wrong, for the following reasons:\n\n* it saves no time (because sorting a list of 4 elements is not very costly)\n\n* it makes the doctests less expressive: adding the `sorted` also tells the user not to rely on the order\n\n* it creates a lot of work and larger diffs.\n\nI am totally with you to remove the sorted from the methods, however.",
    "created_at": "2018-09-05T05:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361448",
    "user": "mantepse"
}
```

I am now removing the sorted from the doctests, but I must say that I think this is wrong, for the following reasons:

* it saves no time (because sorting a list of 4 elements is not very costly)

* it makes the doctests less expressive: adding the `sorted` also tells the user not to rely on the order

* it creates a lot of work and larger diffs.

I am totally with you to remove the sorted from the methods, however.



---

archive/issue_comments_361449.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-05T05:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361449",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361450.json:
```json
{
    "body": "I won't be able to unsort soon, sorry.",
    "created_at": "2018-09-05T06:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361450",
    "user": "mantepse"
}
```

I won't be able to unsort soon, sorry.



---

archive/issue_comments_361451.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-10T14:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361451",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361452.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-20T09:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361452",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361453.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-20T09:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361453",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361454.json:
```json
{
    "body": "I am now going to remove the sorting from the doctests.",
    "created_at": "2018-11-20T09:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361454",
    "user": "mantepse"
}
```

I am now going to remove the sorting from the doctests.



---

archive/issue_comments_361455.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-20T10:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361455",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361456.json:
```json
{
    "body": "Please check that this \"unsorting\" also works with python3. Yes, I know that this is a burden..",
    "created_at": "2018-11-20T10:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361456",
    "user": "chapoton"
}
```

Please check that this "unsorting" also works with python3. Yes, I know that this is a burden..



---

archive/issue_comments_361457.json:
```json
{
    "body": "The calls to `sorted` are now also removed in doctests.  Please review!",
    "created_at": "2018-11-20T10:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361457",
    "user": "mantepse"
}
```

The calls to `sorted` are now also removed in doctests.  Please review!



---

archive/issue_comments_361458.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-11-20T10:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361458",
    "user": "mantepse"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_361459.json:
```json
{
    "body": "Replying to [comment:57 chapoton]:\n> Please check that this \"unsorting\" also works with python3. Yes, I know that this is a burden..\n\nIt was not my idea not to sort, and I explained well why I think that sorting shoult be done, to no avail.  I just spent more than an hour to remove all the sorts, and I have no idea how to do this with python3.\n\nExcuse me, it's absolutely not your fault, but if this was wasted time, I'm really pissed off.",
    "created_at": "2018-11-20T10:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361459",
    "user": "mantepse"
}
```

Replying to [comment:57 chapoton]:
> Please check that this "unsorting" also works with python3. Yes, I know that this is a burden..

It was not my idea not to sort, and I explained well why I think that sorting shoult be done, to no avail.  I just spent more than an hour to remove all the sorts, and I have no idea how to do this with python3.

Excuse me, it's absolutely not your fault, but if this was wasted time, I'm really pissed off.



---

archive/issue_comments_361460.json:
```json
{
    "body": "I am sorry, because I could in fact have told you a bit earlier. I did not want to interfere, but then I feeled obliged to do so.\n\nThe point is: are we sure that the order in which the linear extensions are produced is deterministic ? \n\nYou need to check that the doctests that you take great care to modify will not break on a python3-build sage. I have no available time to do that for you. This means building another copy of sage, and running the doctests..",
    "created_at": "2018-11-20T10:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361460",
    "user": "chapoton"
}
```

I am sorry, because I could in fact have told you a bit earlier. I did not want to interfere, but then I feeled obliged to do so.

The point is: are we sure that the order in which the linear extensions are produced is deterministic ? 

You need to check that the doctests that you take great care to modify will not break on a python3-build sage. I have no available time to do that for you. This means building another copy of sage, and running the doctests..



---

archive/issue_comments_361461.json:
```json
{
    "body": "I am right now trying your branch on a python3-sage..",
    "created_at": "2018-11-20T10:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361461",
    "user": "chapoton"
}
```

I am right now trying your branch on a python3-sage..



---

archive/issue_comments_361462.json:
```json
{
    "body": "ok, this seems to work smoothly on python3. So let the review process go on.",
    "created_at": "2018-11-20T10:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361462",
    "user": "chapoton"
}
```

ok, this seems to work smoothly on python3. So let the review process go on.



---

archive/issue_comments_361463.json:
```json
{
    "body": "OK, now building with python3.",
    "created_at": "2018-11-20T11:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361463",
    "user": "mantepse"
}
```

OK, now building with python3.



---

archive/issue_comments_361464.json:
```json
{
    "body": "Replying to [comment:60 chapoton]:\n> I am sorry, because I could in fact have told you a bit earlier. I did not want to interfere, but then I feeled obliged to do so.\n\nNo problem, I very much value your work, and I overreacted, because I did not and do not see any sense in removing the sorting, as I explained above.  (In fact, putting in the sorting also took some time.)\n\nI hope that this can be merged soon, so #25865 can be merged, too.",
    "created_at": "2018-11-20T11:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361464",
    "user": "mantepse"
}
```

Replying to [comment:60 chapoton]:
> I am sorry, because I could in fact have told you a bit earlier. I did not want to interfere, but then I feeled obliged to do so.

No problem, I very much value your work, and I overreacted, because I did not and do not see any sense in removing the sorting, as I explained above.  (In fact, putting in the sorting also took some time.)

I hope that this can be merged soon, so #25865 can be merged, too.



---

archive/issue_comments_361465.json:
```json
{
    "body": "Thank you for removing the unnecessary sorting.\n\nThe patchbot is getting one failure:\n\n```\nFile \"src/sage/combinat/posets/poset_examples.py\", line 1400, in sage.combinat.posets.poset_examples.Posets.YoungDiagramPoset\nFailed example:\n    P.cover_relations()\nExpected:\n    [[(0, 0), (1, 0)], [(0, 0), (0, 1)], [(1, 0), (1, 1)],\n     [(0, 1), (1, 1)]]\nGot:\n    [[(0, 0), (0, 1)], [(0, 0), (1, 0)], [(0, 1), (1, 1)], [(1, 0), (1, 1)]]\n```\n\nAlso, before you whine about this, this was *not* affected by the sorting changes.",
    "created_at": "2018-11-20T17:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361465",
    "user": "tscrim"
}
```

Thank you for removing the unnecessary sorting.

The patchbot is getting one failure:

```
File "src/sage/combinat/posets/poset_examples.py", line 1400, in sage.combinat.posets.poset_examples.Posets.YoungDiagramPoset
Failed example:
    P.cover_relations()
Expected:
    [[(0, 0), (1, 0)], [(0, 0), (0, 1)], [(1, 0), (1, 1)],
     [(0, 1), (1, 1)]]
Got:
    [[(0, 0), (0, 1)], [(0, 0), (1, 0)], [(0, 1), (1, 1)], [(1, 0), (1, 1)]]
```

Also, before you whine about this, this was *not* affected by the sorting changes.



---

archive/issue_comments_361466.json:
```json
{
    "body": "This is. #26586",
    "created_at": "2018-11-20T18:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361466",
    "user": "mantepse"
}
```

This is. #26586



---

archive/issue_comments_361467.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-20T18:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361467",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361468.json:
```json
{
    "body": "Okay, then positive review.",
    "created_at": "2018-11-20T18:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361468",
    "user": "tscrim"
}
```

Okay, then positive review.



---

archive/issue_comments_361469.json:
```json
{
    "body": "Thank you!",
    "created_at": "2018-11-20T19:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361469",
    "user": "mantepse"
}
```

Thank you!



---

archive/issue_comments_361470.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-21T19:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361470",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_361471.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-11-21T19:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361471",
    "user": "vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_361472.json:
```json
{
    "body": "#26586 is not a dependency of this ticket as that problem already exists and is independent of this ticket.",
    "created_at": "2018-11-21T20:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361472",
    "user": "tscrim"
}
```

#26586 is not a dependency of this ticket as that problem already exists and is independent of this ticket.



---

archive/issue_comments_361473.json:
```json
{
    "body": "I wasn't aware of the #26586 issue before this. Or does this ticket make #26586 now appear without running the doctests with `--gc=never`?",
    "created_at": "2018-11-21T21:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361473",
    "user": "tscrim"
}
```

I wasn't aware of the #26586 issue before this. Or does this ticket make #26586 now appear without running the doctests with `--gc=never`?



---

archive/issue_comments_361474.json:
```json
{
    "body": "No, it is not really a dependency.  What happens is that I was not using `--long` on my laptop, but the patchbot is.\n\nThe problem exists with and without this branch, but this branch modifies the output.",
    "created_at": "2018-11-21T21:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361474",
    "user": "mantepse"
}
```

No, it is not really a dependency.  What happens is that I was not using `--long` on my laptop, but the patchbot is.

The problem exists with and without this branch, but this branch modifies the output.



---

archive/issue_comments_361475.json:
```json
{
    "body": "For whatever reason this ticket excascerbates the problem; I'm not going to merge it if it makes half of the buildbots fail.",
    "created_at": "2018-11-22T00:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361475",
    "user": "vbraun"
}
```

For whatever reason this ticket excascerbates the problem; I'm not going to merge it if it makes half of the buildbots fail.



---

archive/issue_comments_361476.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-22T00:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361476",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_361477.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-24T23:33:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361477",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361478.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-25T00:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361478",
    "user": "mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361479.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-25T01:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361479",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361480.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2018-12-25T14:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361480",
    "user": "vbraun"
}
```

Merge conflict



---

archive/issue_comments_361481.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-12-25T14:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361481",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_361482.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-28T15:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361482",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361483.json:
```json
{
    "body": "Essentially trivial merge.",
    "created_at": "2018-12-28T15:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361483",
    "user": "mantepse"
}
```

Essentially trivial merge.



---

archive/issue_comments_361484.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-28T15:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361484",
    "user": "mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361485.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-29T02:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361485",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361486.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-30T09:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25627#issuecomment-361486",
    "user": "vbraun"
}
```

Resolution: fixed
