# Issue 30549: Multiplying and dividing by 3 hangs

archive/issues_030549.json:
```json
{
    "body": "Tested with https://sagecell.sagemath.org\n\n```\nsage: version()\n'SageMath version 9.1, Release Date: 2020-05-20'\n```\n\nAll of these work as expected:\n\n```\nsage: exp(-ln(-x))\nsage: exp(-3*ln(-x)/3)\nsage: exp(-ln(-9*x))\n```\n\nHowever this hangs:\n\n```\nsage: exp(-3*ln(-9*x)/3)\n```\n\nIn case you are curious, this is what I was doing (the expressions were a bit more complex, of course):\n\n```\nsage: a=var('a')\nsage: y=exp(-3*x)\nsage: x0=ln(-9*a)/3\nsage: y(x=x0)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30786\n\n",
    "created_at": "2020-10-17T22:13:16Z",
    "labels": [
        "basic arithmetic",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Multiplying and dividing by 3 hangs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30549",
    "user": "@GMS103"
}
```
Tested with https://sagecell.sagemath.org

```
sage: version()
'SageMath version 9.1, Release Date: 2020-05-20'
```

All of these work as expected:

```
sage: exp(-ln(-x))
sage: exp(-3*ln(-x)/3)
sage: exp(-ln(-9*x))
```

However this hangs:

```
sage: exp(-3*ln(-9*x)/3)
```

In case you are curious, this is what I was doing (the expressions were a bit more complex, of course):

```
sage: a=var('a')
sage: y=exp(-3*x)
sage: x0=ln(-9*a)/3
sage: y(x=x0)
```


Issue created by migration from https://trac.sagemath.org/ticket/30786





---

archive/issue_comments_436240.json:
```json
{
    "body": "I confirm that there is a problem. `CoCalc` ran out of memory. My laptop (9.2rc2 on MacOS 10.15.7) completed eventually (I think it took about half an hour). The output is a 4GB string of nonsense that seems to be almost entirely digits, but starts with `-1/34723950083` and ends with `91987451449/x`.\n\nThese symptoms are somewhat similar to #30446.",
    "created_at": "2020-10-18T01:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436240",
    "user": "@DaveWitteMorris"
}
```

I confirm that there is a problem. `CoCalc` ran out of memory. My laptop (9.2rc2 on MacOS 10.15.7) completed eventually (I think it took about half an hour). The output is a 4GB string of nonsense that seems to be almost entirely digits, but starts with `-1/34723950083` and ends with `91987451449/x`.

These symptoms are somewhat similar to #30446.



---

archive/issue_comments_436241.json:
```json
{
    "body": "DaveWitteMorris is correct. I checked and this is the same issue as #30446. If you look on that ticket, I submitted a pull request with `pynac` that will fix the issue.",
    "created_at": "2020-10-19T03:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436241",
    "user": "@bmlivin"
}
```

DaveWitteMorris is correct. I checked and this is the same issue as #30446. If you look on that ticket, I submitted a pull request with `pynac` that will fix the issue.



---

archive/issue_comments_436242.json:
```json
{
    "body": "Thanks for the feedback, I was really surprised by this bug.\nGlad to know it will be fixed.",
    "created_at": "2020-10-19T23:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436242",
    "user": "@GMS103"
}
```

Thanks for the feedback, I was really surprised by this bug.
Glad to know it will be fixed.



---

archive/issue_comments_436243.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436243",
    "user": "@DaveWitteMorris"
}
```

Changing priority from major to minor.



---

archive/issue_comments_436244.json:
```json
{
    "body": "Changing component from basic arithmetic to symbolics.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436244",
    "user": "@DaveWitteMorris"
}
```

Changing component from basic arithmetic to symbolics.



---

archive/issue_comments_436245.json:
```json
{
    "body": "As pointed out in comment:2, this will be fixed by the patch to pynac in #30446. When that ticket is closed, we can add this as another doctest.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436245",
    "user": "@DaveWitteMorris"
}
```

As pointed out in comment:2, this will be fixed by the patch to pynac in #30446. When that ticket is closed, we can add this as another doctest.



---

archive/issue_comments_436246.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-10T22:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436246",
    "user": "@DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_436247.json:
```json
{
    "body": "The PR adds doctests for the bugs on this ticket, #28620, and #30304. All were fixed by the patch to pynac at #30446 (which has positive review). These doctests are in the `_pow_` method, and I moved the doctest of #30446 to the same place. (It was in the `_latex_` method, which does not seem like such a good place.)\n----\nNew commits:",
    "created_at": "2021-01-10T22:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436247",
    "user": "@DaveWitteMorris"
}
```

The PR adds doctests for the bugs on this ticket, #28620, and #30304. All were fixed by the patch to pynac at #30446 (which has positive review). These doctests are in the `_pow_` method, and I moved the doctest of #30446 to the same place. (It was in the `_latex_` method, which does not seem like such a good place.)
----
New commits:



---

archive/issue_comments_436248.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-11T23:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436248",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_436249.json:
```json
{
    "body": "LGTM.",
    "created_at": "2021-01-11T23:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436249",
    "user": "tscrim"
}
```

LGTM.



---

archive/issue_comments_436250.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-01-12T00:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436250",
    "user": "@DaveWitteMorris"
}
```

Thanks!



---

archive/issue_comments_436251.json:
```json
{
    "body": "rebase over new #30446",
    "created_at": "2021-01-24T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436251",
    "user": "dimpase"
}
```

rebase over new #30446



---

archive/issue_comments_436252.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-01-24T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436252",
    "user": "dimpase"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_436253.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-01-24T21:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436253",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436254.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-01-24T22:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436254",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_436255.json:
```json
{
    "body": "OK, done",
    "created_at": "2021-01-24T22:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436255",
    "user": "dimpase"
}
```

OK, done



---

archive/issue_comments_436256.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-09T00:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-436256",
    "user": "vbraun"
}
```

Resolution: fixed
