# Issue 30549: Multiplying and dividing by 3 hangs

archive/issues_030549.json:
```json
{
    "body": "Tested with https://sagecell.sagemath.org\n\n```\nsage: version()\n'SageMath version 9.1, Release Date: 2020-05-20'\n```\nAll of these work as expected:\n\n```\nsage: exp(-ln(-x))\nsage: exp(-3*ln(-x)/3)\nsage: exp(-ln(-9*x))\n```\nHowever this hangs:\n\n```\nsage: exp(-3*ln(-9*x)/3)\n```\nIn case you are curious, this is what I was doing (the expressions were a bit more complex, of course):\n\n```\nsage: a=var('a')\nsage: y=exp(-3*x)\nsage: x0=ln(-9*a)/3\nsage: y(x=x0)\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/30786\n\n",
    "created_at": "2020-10-17T22:13:16Z",
    "labels": [
        "component: basic arithmetic",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Multiplying and dividing by 3 hangs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30549",
    "user": "https://github.com/GMS103"
}
```
Tested with https://sagecell.sagemath.org

```
sage: version()
'SageMath version 9.1, Release Date: 2020-05-20'
```
All of these work as expected:

```
sage: exp(-ln(-x))
sage: exp(-3*ln(-x)/3)
sage: exp(-ln(-9*x))
```
However this hangs:

```
sage: exp(-3*ln(-9*x)/3)
```
In case you are curious, this is what I was doing (the expressions were a bit more complex, of course):

```
sage: a=var('a')
sage: y=exp(-3*x)
sage: x0=ln(-9*a)/3
sage: y(x=x0)
```

Issue created by migration from https://trac.sagemath.org/ticket/30786





---

archive/issue_comments_435741.json:
```json
{
    "body": "I confirm that there is a problem. `CoCalc` ran out of memory. My laptop (9.2rc2 on MacOS 10.15.7) completed eventually (I think it took about half an hour). The output is a 4GB string of nonsense that seems to be almost entirely digits, but starts with `-1/34723950083` and ends with `91987451449/x`.\n\nThese symptoms are somewhat similar to #30446.",
    "created_at": "2020-10-18T01:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435741",
    "user": "https://github.com/DaveWitteMorris"
}
```

I confirm that there is a problem. `CoCalc` ran out of memory. My laptop (9.2rc2 on MacOS 10.15.7) completed eventually (I think it took about half an hour). The output is a 4GB string of nonsense that seems to be almost entirely digits, but starts with `-1/34723950083` and ends with `91987451449/x`.

These symptoms are somewhat similar to #30446.



---

archive/issue_comments_435742.json:
```json
{
    "body": "DaveWitteMorris is correct. I checked and this is the same issue as #30446. If you look on that ticket, I submitted a pull request with `pynac` that will fix the issue.",
    "created_at": "2020-10-19T03:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435742",
    "user": "https://github.com/bmlivin"
}
```

DaveWitteMorris is correct. I checked and this is the same issue as #30446. If you look on that ticket, I submitted a pull request with `pynac` that will fix the issue.



---

archive/issue_comments_435743.json:
```json
{
    "body": "Thanks for the feedback, I was really surprised by this bug.\nGlad to know it will be fixed.",
    "created_at": "2020-10-19T23:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435743",
    "user": "https://github.com/GMS103"
}
```

Thanks for the feedback, I was really surprised by this bug.
Glad to know it will be fixed.



---

archive/issue_comments_435744.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435744",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing priority from major to minor.



---

archive/issue_events_080274.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-08T20:02:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30549#event-80274"
}
```



---

archive/issue_comments_435745.json:
```json
{
    "body": "Changing component from basic arithmetic to symbolics.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435745",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing component from basic arithmetic to symbolics.



---

archive/issue_comments_435746.json:
```json
{
    "body": "As pointed out in comment:2, this will be fixed by the patch to pynac in #30446. When that ticket is closed, we can add this as another doctest.",
    "created_at": "2021-01-08T20:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435746",
    "user": "https://github.com/DaveWitteMorris"
}
```

As pointed out in comment:2, this will be fixed by the patch to pynac in #30446. When that ticket is closed, we can add this as another doctest.



---

archive/issue_comments_435747.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-10T22:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435747",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_435748.json:
```json
{
    "body": "The PR adds doctests for the bugs on this ticket, #28620, and #30304. All were fixed by the patch to pynac at #30446 (which has positive review). These doctests are in the `_pow_` method, and I moved the doctest of #30446 to the same place. (It was in the `_latex_` method, which does not seem like such a good place.)\n\n---\nNew commits:",
    "created_at": "2021-01-10T22:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435748",
    "user": "https://github.com/DaveWitteMorris"
}
```

The PR adds doctests for the bugs on this ticket, #28620, and #30304. All were fixed by the patch to pynac at #30446 (which has positive review). These doctests are in the `_pow_` method, and I moved the doctest of #30446 to the same place. (It was in the `_latex_` method, which does not seem like such a good place.)

---
New commits:



---

archive/issue_events_080275.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-10T22:41:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30549#event-80275"
}
```



---

archive/issue_events_080276.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-10T22:41:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30549#event-80276"
}
```



---

archive/issue_comments_435749.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-11T23:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435749",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_435750.json:
```json
{
    "body": "LGTM.",
    "created_at": "2021-01-11T23:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435750",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_435751.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-01-12T00:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435751",
    "user": "https://github.com/DaveWitteMorris"
}
```

Thanks!



---

archive/issue_comments_435752.json:
```json
{
    "body": "rebase over new #30446",
    "created_at": "2021-01-24T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435752",
    "user": "https://github.com/dimpase"
}
```

rebase over new #30446



---

archive/issue_comments_435753.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-01-24T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435753",
    "user": "https://github.com/dimpase"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_435754.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-01-24T21:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435754",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435755.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-01-24T22:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435755",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_435756.json:
```json
{
    "body": "OK, done",
    "created_at": "2021-01-24T22:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435756",
    "user": "https://github.com/dimpase"
}
```

OK, done



---

archive/issue_comments_435757.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-09T00:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30549#issuecomment-435757",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_080277.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-09T00:00:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30549",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30549#event-80277"
}
```
