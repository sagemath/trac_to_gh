# Issue 10942: Lazily import plot, numpy, etc.

archive/issues_010942.json:
```json
{
    "body": "Assignee: @jasongrout\n\nCC:  @kcrisman\n\nFor startup time.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11043\n\n",
    "created_at": "2011-03-26T09:09:33Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Lazily import plot, numpy, etc.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10942",
    "user": "https://github.com/robertwb"
}
```
Assignee: @jasongrout

CC:  @kcrisman

For startup time.

Issue created by migration from https://trac.sagemath.org/ticket/11043





---

archive/issue_comments_117542.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-03-26T09:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117542",
    "user": "https://github.com/robertwb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_117543.json:
```json
{
    "body": "Attachment [11043-lazy-plot.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot.patch) by @robertwb created at 2011-03-26 09:15:17\n\nBefore \n\n\n```\n2.039 sage.all (None)\n0.410 sage.misc.all (sage.all)\n0.260 twisted.persisted.styles (sage.all)\n0.221 sage.rings.all (sage.all)\n0.188 sage.functions.all (sage.all)\n0.171 functional (sage.misc.all)\n0.164 piecewise (sage.functions.all)\n0.162 sage.calculus.all (piecewise)\n0.155 desolvers (sage.calculus.all)\n0.154 sage.plot.all (desolvers)\n0.151 zope.interface (twisted.persisted.styles)\n0.137 pkg_resources (zope.interface)\n0.132 interpreter (sage.misc.all)\n0.131 IPython.ipapi (interpreter)\n```\n\n\nAfter \n\n\n```\n1.745 sage.all (None)\n0.405 sage.misc.all (sage.all)\n0.263 twisted.persisted.styles (sage.all)\n0.180 sage.rings.all (sage.all)\n0.168 functional (sage.misc.all)\n0.154 zope.interface (twisted.persisted.styles)\n0.141 pkg_resources (zope.interface)\n0.134 sage.combinat.all (sage.all)\n0.128 interpreter (sage.misc.all)\n0.127 IPython.ipapi (interpreter)\n```\n\n\nThat's another quarter-second (12.5%) savings.",
    "created_at": "2011-03-26T09:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117543",
    "user": "https://github.com/robertwb"
}
```

Attachment [11043-lazy-plot.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot.patch) by @robertwb created at 2011-03-26 09:15:17

Before 


```
2.039 sage.all (None)
0.410 sage.misc.all (sage.all)
0.260 twisted.persisted.styles (sage.all)
0.221 sage.rings.all (sage.all)
0.188 sage.functions.all (sage.all)
0.171 functional (sage.misc.all)
0.164 piecewise (sage.functions.all)
0.162 sage.calculus.all (piecewise)
0.155 desolvers (sage.calculus.all)
0.154 sage.plot.all (desolvers)
0.151 zope.interface (twisted.persisted.styles)
0.137 pkg_resources (zope.interface)
0.132 interpreter (sage.misc.all)
0.131 IPython.ipapi (interpreter)
```


After 


```
1.745 sage.all (None)
0.405 sage.misc.all (sage.all)
0.263 twisted.persisted.styles (sage.all)
0.180 sage.rings.all (sage.all)
0.168 functional (sage.misc.all)
0.154 zope.interface (twisted.persisted.styles)
0.141 pkg_resources (zope.interface)
0.134 sage.combinat.all (sage.all)
0.128 interpreter (sage.misc.all)
0.127 IPython.ipapi (interpreter)
```


That's another quarter-second (12.5%) savings.



---

archive/issue_comments_117544.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-08-22T19:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117544",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117545.json:
```json
{
    "body": "Attachment [11043-lazy-plot-rebase4.7.1.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot-rebase4.7.1.patch) by @williamstein created at 2011-08-22 19:03:30",
    "created_at": "2011-08-22T19:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117545",
    "user": "https://github.com/williamstein"
}
```

Attachment [11043-lazy-plot-rebase4.7.1.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot-rebase4.7.1.patch) by @williamstein created at 2011-08-22 19:03:30



---

archive/issue_comments_117546.json:
```json
{
    "body": "This is a more conservative patch which only saves importing the plot.* modules (about a 50-100ms savings on my computer).",
    "created_at": "2011-08-23T09:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117546",
    "user": "https://github.com/robertwb"
}
```

This is a more conservative patch which only saves importing the plot.* modules (about a 50-100ms savings on my computer).



---

archive/issue_comments_117547.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-08-23T09:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117547",
    "user": "https://github.com/robertwb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117548.json:
```json
{
    "body": "Attachment [11043-lazy-plot-again.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot-again.patch) by @robertwb created at 2011-08-23 16:40:21\n\napply only this patch",
    "created_at": "2011-08-23T16:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117548",
    "user": "https://github.com/robertwb"
}
```

Attachment [11043-lazy-plot-again.patch](tarball://root/attachments/some-uuid/ticket11043/11043-lazy-plot-again.patch) by @robertwb created at 2011-08-23 16:40:21

apply only this patch



---

archive/issue_comments_117549.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-08-24T18:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117549",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117550.json:
```json
{
    "body": "Robert, did you even test this?   It seems to fail doctests all over the place.  E.g.,\n\n```\nsage -t  devel/sage/sage/calculus/riemann.pyx\n**********************************************************************\nFile \"/mnt/usb1/scratch/wstein/sage-4.7.1-sage.math.washington.edu-x86_64-Linux/devel/sage-main/sage/calculus/riemann.pyx\", line 114:\n    sage: m = Riemann_Map([f, hf], [hf, hfprime], 0.5 + 0.5*I)\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/usb1/scratch/wstein/sage-4.7.1-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.p\n...\nImportError: No module named riemann\n```\n\n\nIt seems like using LazyImport in any nontrivial way always results in serious breakage that is revealed by doctests.  I hit this numerous times myself.  Hmmm.",
    "created_at": "2011-08-24T18:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117550",
    "user": "https://github.com/williamstein"
}
```

Robert, did you even test this?   It seems to fail doctests all over the place.  E.g.,

```
sage -t  devel/sage/sage/calculus/riemann.pyx
**********************************************************************
File "/mnt/usb1/scratch/wstein/sage-4.7.1-sage.math.washington.edu-x86_64-Linux/devel/sage-main/sage/calculus/riemann.pyx", line 114:
    sage: m = Riemann_Map([f, hf], [hf, hfprime], 0.5 + 0.5*I)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/usb1/scratch/wstein/sage-4.7.1-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.p
...
ImportError: No module named riemann
```


It seems like using LazyImport in any nontrivial way always results in serious breakage that is revealed by doctests.  I hit this numerous times myself.  Hmmm.



---

archive/issue_comments_117551.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd32\".",
    "created_at": "2011-08-24T23:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117551",
    "user": "https://github.com/williamstein"
}
```

Changing keywords from "" to "sd32".



---

archive/issue_comments_117552.json:
```json
{
    "body": "Is anything happening on this? Robert wrote the patch, William says it breaks doctests all over the place, but then it just stalls. \n\nDave",
    "created_at": "2012-03-02T14:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117552",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Is anything happening on this? Robert wrote the patch, William says it breaks doctests all over the place, but then it just stalls. 

Dave



---

archive/issue_comments_117553.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-07-09T13:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117553",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_117554.json:
```json
{
    "body": "outdated",
    "created_at": "2020-07-09T13:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117554",
    "user": "https://github.com/dimpase"
}
```

outdated



---

archive/issue_comments_117555.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-06-24T20:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10942#issuecomment-117555",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_011053.json:
```json
{
    "actor": "@mkoeppe",
    "created_at": "2021-06-24T20:15:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10942",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10942#event-11053"
}
```
