# Issue 32378: Faster arithmetic with function field ideals

Issue created by migration from https://trac.sagemath.org/ticket/32615

Original creator: klee

Original creation time: 2021-10-03 01:32:28

We make ideal arithmetic faster for ideals with two generator representations.
 

```sage
sage: K.<x> = FunctionField(GF(2)); _.<Y> = K[]
....: L.<y> = K.extension(Y^7 - x^3*Y - x)
....: O = L.maximal_order()
....: I = O.ideal(y)
....: J = O.ideal(x + y)
sage: def naive_power(i, n):
....:     j = i
....:     for s in range(n - 1):
....:         j *= i
....:     return j
....: 
sage: n = 100
sage: i = I / J
sage: %timeit naive_power(i, n)
683 ms ± 8.82 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
sage: %timeit i^n
34.3 ms ± 454 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
sage: p, q = i.gens_two()
sage: %timeit naive_power(i, n)  # faster multiplication
147 ms ± 4.08 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
sage: %timeit i^n                # faster powering
16.2 ms ± 149 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
sage: naive_power(i, n) == i^n
True
```



---

Comment by git created at 2021-10-03 01:33:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2021-10-03 01:35:17

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-10-03 08:07:38

One trivial little change:

```diff
      def _gens_two(self):
-         """
+         r"""
```

Once done, you can set a positive review on my behalf.

I do find this line

```
if len(self._gens_two.cache) == 2:
```

to be a little strange though.


---

Comment by git created at 2021-10-03 09:05:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-10-03 09:40:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2021-10-03 09:44:14

Replying to [comment:4 tscrim]:

Sorry for the mess. I somehow lost a commit that I thought I uploaded.

> One trivial little change:
> {{{#!diff
>       def _gens_two(self):
> -         """
> +         r"""
> }}}
> Once done, you can set a positive review on my behalf.

Done now.

> I do find this line
> {{{
> if len(self._gens_two.cache) == 2:
> }}}
> to be a little strange though.

I had deleted this in the lost commit. Now done again.

I will wait for a green bot. Thank you for quick review.


---

Comment by tscrim created at 2021-10-03 11:32:45

Thanks. Sounds good. Green bot => positive review.


---

Comment by klee created at 2021-10-03 13:17:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-10-13 22:50:08

Resolution: fixed
