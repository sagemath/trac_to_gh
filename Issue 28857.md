# Issue 28857: Use rich_to_bool_sgn instead of rich_to_bool when comparing outputs of mpz_cmp

Issue created by migration from https://trac.sagemath.org/ticket/29094

Original creator: tscrim

Original creation time: 2020-01-28 15:31:38

CC:  mmasdeu chapoton

Keywords: comparison

According to its documentation, `mpz_cmp` yields arbitrary positive/negative numbers, but `rich_to_bool` assumes the input is in `[-1, 0, 1]`. Thus it yields wrong results:

```
sage: B.<i,j,k> = QuaternionAlgebra(6)
sage: B(1) == B(-1)
False
sage: B(1) != B(-1)
False
```




---

Comment by tscrim created at 2020-01-28 15:33:11

Changing status from new to needs_review.


---

Comment by git created at 2020-01-28 15:33:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-01-28 15:34:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2020-01-28 16:46:05

looks good. But why are there 2 changes ?


---

Comment by tscrim created at 2020-01-28 16:47:21

That second change is because the documentation says it returns `[-1, 0, 1]`, but `test` might not be in that range.


---

Comment by chapoton created at 2020-01-28 16:57:16

ok, you can set to positive as soon as the lights are green

by the way, the related #28945 seems not to work with the latest beta. Maybe the same kind of issue ?


---

Comment by chapoton created at 2020-01-28 19:59:20

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-01-28 20:15:19

Doesn't seem like it, but I will have to investigate further.

Thank you for doing the review.


---

Comment by vbraun created at 2020-01-31 23:49:25

Resolution: fixed
