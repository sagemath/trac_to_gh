# Issue 14194: Remove graphviz from experimental.

Issue created by migration from https://trac.sagemath.org/ticket/14398

Original creator: nthiery

Original creation time: 2013-04-02 13:12:24

Assignee: jason, ncohen, rlm

The graphviz spkg has been broken forever, and people get confused trying to install it rather than installing graphviz in their system. Let's remove it from experimental.


---

Comment by jdemeyer created at 2013-04-02 13:29:07

Changing assignee from jason, ncohen, rlm to tbd.


---

Comment by jdemeyer created at 2013-04-02 13:29:07

Is it really that confusing to have a broken *experimental* package? On [http://www.sagemath.org/packages/experimental](http://www.sagemath.org/packages/experimental), it clearly says
> These are EXPERIMENTAL! They probably won't work at all for you! Use at your own risk! Many of these have *never* been successfully built on any platform! (But still, if you can figure out how to build them, I'd like to know about it.)


---

Comment by jdemeyer created at 2013-04-02 13:29:07

Changing component from graph theory to packages: experimental.


---

Comment by kcrisman created at 2013-04-02 13:35:58

> Is it really that confusing to have a broken *experimental* package? On [http://www.sagemath.org/packages/experimental](http://www.sagemath.org/packages/experimental), it clearly says
> > These are EXPERIMENTAL! They probably won't work at all for you! Use at your own risk! Many of these have *never* been successfully built on any platform! (But still, if you can figure out how to build them, I'd like to know about it.)
Exactly.

The problem is apparently simple lack of dependencies (pango and libperl-dev, perhaps).  See #11433 and #4864.  I suppose this is a duplicate of #7438, in some sense.


---

Comment by ncohen created at 2013-04-02 13:36:40

well, this one just does not work. It looks like the problem is 4 years old, so there's nothing to hope for either #4864. And the fact that it's almost impossible to find in Sage's doc how this software should be installed makes "sage -i graphviz" the first guess, which ends with an error.

Nathann


---

Comment by ncohen created at 2013-04-02 13:39:29

(and I think that all these trac tickets above clearly give proof that many of us have already lost a lot of time because of this broken spkg)

Nathann


---

Comment by kcrisman created at 2013-04-02 13:44:16

Yeah, and the problems seem different from before.

```
creating libgvplugin_gd_C.la
(cd .libs && rm -f libgvplugin_gd_C.la && ln -s ../libgvplugin_gd_C.la libgvplugin_gd_C.la)
/bin/bash ../../libtool --tag=CC   --mode=link gcc  -g -O2 -Wno-unknown-pragmas -Wstrict-prototypes -Wpointer-arith -Wall -ffast-math -version-info 5:0:0 -L/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/local/lib -L/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/local/lib -o libgvplugin_gd.la -rpath /home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/local/lib/graphviz gvplugin_gd.lo gvrender_gd.lo gvrender_gd_vrml.lo gvtextlayout_gd.lo gvloadimage_gd.lo gvdevice_gd.lo ../../lib/gvc/libgvc.la -L/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/local/include -lgd -lfontconfig -lfreetype -lpng12 -lz -lm -lm 
libtool: link: warning: `/usr/lib64/libexpat.la' seems to be moved
libtool: link: warning: library `/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/local/lib/libgd.la' was moved.
grep: /release/merger/sage-5.8/local/lib/libfreetype.la: No such file or directory
/bin/sed: can't read /release/merger/sage-5.8/local/lib/libfreetype.la: No such file or directory
libtool: link: `/release/merger/sage-5.8/local/lib/libfreetype.la' is not a valid libtool archive
make[3]: *** [libgvplugin_gd.la] Error 1
make[3]: Leaving directory `/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/spkg/build/graphviz-2.16.1.p0/src/plugin/gd'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/spkg/build/graphviz-2.16.1.p0/src/plugin'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/kcrisman/sage-5.8-sage.math.washington.edu-x86_64-Linux/spkg/build/graphviz-2.16.1.p0/src'
make: *** [all] Error 2
Error building Graphviz

real	3m39.740s
user	1m29.320s
sys	1m41.210s
************************************************************************
Error installing package graphviz-2.16.1.p0
************************************************************************
```

Anyway, I propose this continues at #7438.  There is zero guarantee that anything from experimental works.


---

Comment by kcrisman created at 2013-04-02 13:44:43

Changing status from new to needs_review.


---

Comment by ncohen created at 2013-04-02 13:47:04

Why should we keep this if nobody can install it ? The problem could even be solved if there was on some page of the manual some instructions saying that we do not know how to fix this bug (it's not our fault after all) but that one library should be installed manually ?

But then again the bug you get is even different from mine `-_-`

Honestly, why do we care ? It's not "experimental", it's just plain broken.

Nathann


---

Comment by kcrisman created at 2013-04-02 14:13:10

> Why should we keep this if nobody can install it ? The problem could even be solved if there was on some page of the manual some instructions saying that we do not know how to fix this bug (it's not our fault after all) but that one library should be installed manually ?
We don't have anything about experimental packages elsewhere, do we? 
> Honestly, why do we care ? It's not "experimental", it's just plain broken.
See #7438; it builds fine on boxen.math.  Let's continue the discussion about graphviz there.  

If you want to open a sage-devel discussion about how non-broken experimental packages should be, that's fine.  In my view - and as you know, I am pretty conservative on such things - experimental can be as broken as they want to be.  _Someone_ probably does have the expertise to fix each of them, and removing them completely means no one will even have the chance.


---

Comment by kcrisman created at 2013-04-02 14:13:10

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-04-02 15:14:55

Replying to [comment:8 kcrisman]:
> experimental can be as broken as they want to be.  _Someone_ probably does have the expertise to fix each of them, and removing them completely means no one will even have the chance.
I agree with this. There is a reason we differentiate between _optional_ and _experimental_.

However, there is one thing that could be improved: when the user does

```
./sage -i graphviz
```

there is no obvious clue that an experimental package is being installed.

So, we could make it so that downloading an experimental package this way would first print a warning along the lines of

```
WARNING: you are about to download and install an experimental package. This
probably won't work at all for you! Use at your own risk!
Are you sure you want to continue [Y/n]?
```



---

Comment by ncohen created at 2013-04-02 15:20:15

+1 ! 

But I still think that "experimental" should mean "we don't know if the code runs everywhere, we just want to give it a 'real-life' try before making it optional or standard". Not "it does not work, everybody forgot about it, and 'experimental' is our spkg garbage folder".

Nathann


---

Comment by jdemeyer created at 2013-04-02 15:25:49

Replying to [comment:10 ncohen]:
> we don't know if the code runs everywhere, we just want to give it a 'real-life' try
I think that's more or less what I understand as the definition of "optional" packages.

I don't think we need another category of packages (standard, optional, experimental, garbage, archive).


---

Comment by jdemeyer created at 2013-04-02 15:27:29

Changing type from defect to enhancement.


---

Comment by jdemeyer created at 2013-04-02 15:27:29

Changing component from packages: experimental to build.


---

Comment by jdemeyer created at 2013-04-02 15:27:29

Changing status from positive_review to needs_work.


---

Comment by ncohen created at 2013-04-02 15:33:38

> > we don't know if the code runs everywhere, we just want to give it a 'real-life' try
> I think that's more or less what I understand as the definition of "optional" packages.

Many optional packages are optional because they are not gpl-compatible, or because they are too heavy to be standard. I don't get why a spkg would be optional otherwise... Either way, there is "experiment" in "experimental". That's actually the largest part of it. I stand by the rather bold claim that experimental packages should consist in... an experiment. And I don't see what could make this graphviz spkg an experiment.

Nathann


---

Attachment


---

Comment by jdemeyer created at 2013-04-02 15:43:27

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2013-04-02 15:52:18

Well. It will install the spkg even if the user answers "I don't want to install this SPKG" instead of "n", but that's not soooooooooooo bad `:-P`


```
Are you sure you want to continue [Y/n]? I don't want to install this SPKG !!
>>> Downloading graphviz-2.16.1.p0.spkg.
[...
```


Thanks for this patch ! `:-)`

Nathann


---

Comment by ncohen created at 2013-04-02 15:52:18

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2013-04-02 16:45:24

> Well. It will install the spkg even if the user answers "I don't want to install this SPKG" instead of "n", but that's not soooooooooooo bad `:-P`
LOL
> Thanks for this patch ! `:-)`
Indeed, this is a great solution, thanks for intervening here, Jeroen.  (It does say something about trying experimental when you download such things, but of course Nathann's point is well-taken about people perhaps not knowing just how experimental that is.)


---

Comment by jdemeyer created at 2013-04-04 17:40:53

Resolution: fixed
