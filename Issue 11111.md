# Issue 11111: algdep throws exception on valid input

Issue created by migration from Trac.

Original creator: dunfield

Original creation time: 2011-05-02 20:11:58

Assignee: was

The algdep function chokes when the input is a vanilla Python complex number.   There is explicit code in algdep to handle this case, but it tries to convert the input to a Sage ComplexField element by a nonexistent method.    Really, the traceback says it all:


```
sage: z = complex("1+2j")
sage: z
(1+2j)
sage: type(z)
<type 'complex'>
sage: algdep(z, 4)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/Users/dunfield/Dropbox/knot-genus/Genus-Comp/<ipython console> in <module>()

/pkgs/sage-4.6/local/lib/python2.6/site-packages/sage/rings/arith.pyc in algdep(z, degree, known_bits, use_bits, known_digits, use_digits, height_bound, proof)
    190         z = sage.rings.real_mpfr.RR(z)
    191     elif isinstance(z, complex):
--> 192         z = sage.rings.complex_field.CC(z)
    193 
    194     if isinstance(z, (sage.rings.real_mpfr.RealNumber,

AttributeError: 'module' object has no attribute 'CC'
```


This could be fixed simply by changing line 192 to 

```
z = sage.rings.complex_field.ComplexField()(z)
```

but I'm not sure if this the canonical way to do things, and hence didn't submit a patch. 


---

Comment by mhansen created at 2013-07-24 17:14:41

Changing status from new to needs_review.


---

Attachment


---

Comment by dunfield created at 2013-07-24 21:17:42

This is my first time reviewing a patch, but I followed the developer instructions pretty carefully.  Testing was done against Sage 5.10 on OS X Snow Leopard.   All doctests pass (except "sage/numerical/mip.pyx" which don't pass on this machine normally) and the documentation looks fine.  The patch certainly fixes the bug I reported and I double checked that algdep now works for various Python native types (int, float, complex).


---

Comment by dunfield created at 2013-07-24 21:17:42

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-07-25 06:49:40

You should add your real name as Reviewer on this ticket.


---

Comment by jdemeyer created at 2013-08-19 06:45:26

Resolution: fixed
