# Issue 26777: Deprecate sage.misc.misc.uniq

Issue created by migration from https://trac.sagemath.org/ticket/27014

Original creator: jdemeyer

Original creation time: 2019-01-04 08:58:51

CC:  tscrim

`uniq(X)` is just a shorthand for `sorted(set(X))`: I don't think that we need a separate function for that. More seriously, the sorting is problematic since arbitrary sets may not be sortable in general, especially in Python 3 or after applying #22029.


---

Comment by jdemeyer created at 2019-01-04 10:23:06

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2019-01-04 10:23:06

New commits:


---

Comment by mantepse created at 2019-01-04 17:21:23

I am all for it!  (I ran the patchbot and looked at the code)


---

Comment by mantepse created at 2019-01-04 17:21:23

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-01-04 18:59:48

Changing status from positive_review to needs_info.


---

Comment by tscrim created at 2019-01-04 18:59:48

I am not so sure about actually deprecating it. The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is. Plus the message seems like it will not be there after the deprecation, and I believe this is a useful function from the (non-expert) user perspective. So I am somewhat inclined to also just do the `_stable_uniq -> uniq` now. Thoughts?


---

Comment by jdemeyer created at 2019-01-04 19:17:07

Changing status from needs_info to positive_review.


---

Comment by jdemeyer created at 2019-01-04 19:17:07

Replying to [comment:5 tscrim]:
> The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.

No. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.


---

Comment by tscrim created at 2019-01-04 19:41:42

Replying to [comment:6 jdemeyer]:
> Replying to [comment:5 tscrim]:
> > The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.
> 
> No. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.

Ah, right, and the sorting of the output is documented. However, given the (eventual) goal, I think we should replace `uniq` with `_stable_uniq` and issue a deprecation warning about the sorting behavior change. Or at least in the current deprecation message say something like

```
the output of uniq(X) being sorted is deprecated; use sorted(set(X)) instead
if you want the output sorted
```

The current deprecation message seems to indicate that the function will be removed altogether.


---

Comment by tscrim created at 2019-01-04 19:41:42

Changing status from positive_review to needs_work.


---

Comment by mantepse created at 2019-01-04 22:52:30

Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  

Is there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?


---

Comment by tscrim created at 2019-01-05 05:36:44

Replying to [comment:8 mantepse]:
> Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  

`stable_uniq` does not sound discoverable or natural IMO. Also for those people who only want the `uniq` behavior, it means they would not have the change their code.

> Is there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?

Someone might be relying on this sorting behavior in the wild, so we need to deprecate it.


---

Comment by mantepse created at 2019-01-05 08:59:56

Replying to [comment:9 tscrim]:
> Replying to [comment:8 mantepse]:
> > Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  
> 
> `stable_uniq` does not sound discoverable or natural IMO.

OK, although I wouldn't be looking for `uniq` either.  In fact, I was surprised by it's documentation, because the well known unix utility does something else.

I was looking for `remove_duplicates` once, before it occurred to me that I want `set` :-)

> Someone might be relying on this sorting behavior in the wild, so we need to deprecate it.

I think that we all agree on that.


---

Comment by git created at 2019-01-05 09:44:45

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2019-01-05 09:45:09

Reworded deprecation message as Travis suggested.


---

Comment by jdemeyer created at 2019-01-05 09:45:09

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2019-01-05 17:39:12

Thank you.


---

Comment by tscrim created at 2019-01-05 17:39:12

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-01-15 18:16:10

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.


---

Comment by vbraun created at 2019-01-22 12:40:05

Resolution: fixed
