# Issue 28374: Genus Representative

Issue created by migration from https://trac.sagemath.org/ticket/28611

Original creator: sbrandhorst

Original creation time: 2019-10-15 22:43:49

CC:  annahaensch

Compute a representative quadratic form from a genus.
This should be added as a method `representative` of the `GenusSymbol_global_ring` class.


---

Comment by git created at 2020-01-05 20:01:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by git created at 2020-01-07 12:02:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2020-01-07 12:03:44

Changing status from new to needs_review.


---

Comment by git created at 2020-01-08 09:58:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-01-14 16:58:31

I believe you can change `(-b.q().lift().valuation(p)/2).ceil()` to `((-b.q().lift().valuation(p)+1) // 2)`, which will avoid going through `QQ`.

Also, I don't understand the logic behind `_compute_representative`. Why not make `representative` a ``@`cached_method`? You also do not have public access to the `LLL` option, nor is it used anywhere. If you still want to keep it and use the ``@`cached_method`, you can do

```python
@cached_method
def representative(self, LLL=True):
    if LLL:
        rep = self.representative(LLL=False)
        return result_of_LLL
    return computation_of_represenative
```

Although this does have a drawback of storing both the representatives in memory.

Could you make the `# long time` doctest a little shorter, say, maybe only to `15`? 40s is a little long IMO.


---

Comment by tscrim created at 2020-01-14 16:59:35

A thought just occurred to me: You could clear the cache when `LLL=True` to avoid double storing the representative.


---

Comment by sbrandhorst created at 2020-01-14 18:51:56

The reason why I did not use the cached_method decorator is that


```
sage: Genus(matrix(ZZ,[1]))
Genus of
[1]
Signature:  (1, 0)
Genus symbol at 2:    [1^1]_1
```

stores the representative matrix at object creation in `_representative`.
So it is an optional argument in the genus class. 
Can this be achieved (better?) with `cached_method` as well?


---

Comment by git created at 2020-01-14 20:39:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-01-15 01:56:48

Ah, I see, that was what I didn't get because I was looking too locally at the changes. The way you have it is good. One other option would be to have `_representative` be a ``@`lazy_attribute`, but for this, you couldn't have the `LLL` option to pass to it.


---

Comment by git created at 2020-01-15 08:36:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2020-01-15 08:37:26

o.k. this should be it.


---

Comment by tscrim created at 2020-01-15 16:12:02

Thanks. Author name, and then you can set a positive review.


---

Comment by sbrandhorst created at 2020-01-15 16:23:35

Thank you travis


---

Comment by sbrandhorst created at 2020-01-15 16:23:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-01-20 21:18:32

Resolution: fixed
