# Issue 29940: build/bin/sage-system-python: Improve check for a suitable python

Issue created by migration from https://trac.sagemath.org/ticket/30177

Original creator: mkoeppe

Original creation time: 2020-07-20 01:41:35

CC:  dimpase embray slelievre

(from #29929/#30154)

#29890 (build/bin/sage-system-python: Try "python" first) may cause failures on Cygwin if `python` is something strange coming through from the Windows installation as observed in https://github.com/mkoeppe/arb/runs/839201503:

```
+ sage-package create arb --version git --tarball arb-git.tar.gz --type=optional
C:\hostedtoolcache\windows\Python\3.7.7\x64\python.exe: can't open file '/cygdrive/d/a/arb/arb/build/bin/sage-package': [Errno 2] No such file or directory
##[error]Process completed with exit code 1.
```

  So `sage-system-python` needs better checks for the suitability of `python`.

Also, a python 2 from an outdated homebrew installation on mac needs to be rejected (https://groups.google.com/d/msg/sage-devel/DoiswEtlKs4/aCNNKBixCAAJ)


---

Comment by mkoeppe created at 2020-07-20 03:11:56

New commits:


---

Comment by mkoeppe created at 2020-07-20 03:11:56

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-07-20 08:57:30

lgtm


---

Comment by dimpase created at 2020-07-20 08:57:30

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-07-20 15:43:12

Thanks!


---

Comment by git created at 2020-07-24 19:49:55

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2020-07-24 19:49:55

Changing status from positive_review to needs_review.


---

Comment by mkoeppe created at 2020-07-24 19:51:32

This was working fine but was too noisy, as I just observed in https://github.com/mkoeppe/Sources/runs/907998067:

```
sage-package create singular --version git --tarball singular-git.tar.gz --type=optional
Traceback (most recent call last):
  File "<string>", line 1, in <module>
FileNotFoundError: [WinError 3] The system cannot find the path specified: '/cygdrive/d/a/Sources/Sources/upstream'
```



---

Comment by dimpase created at 2020-07-24 19:56:21

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-07-24 19:56:21

ok


---

Comment by mkoeppe created at 2020-07-24 20:23:07

Thanks!


---

Comment by vbraun created at 2020-08-07 22:16:11

Merge conflict


---

Comment by vbraun created at 2020-08-07 22:16:11

Changing status from positive_review to needs_work.


---

Comment by git created at 2020-08-07 23:22:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-08-07 23:22:23

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-08-10 18:49:56

Resolution: fixed
