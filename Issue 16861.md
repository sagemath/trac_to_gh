# Issue 16861: sum_of_terms on free modules leaves parent unchanged -- is this right?

Issue created by migration from https://trac.sagemath.org/ticket/17098

Original creator: darij

Original creation time: 2014-10-04 03:36:41

CC:  tscrim nthiery simonking zabrocki

Keywords: free modules, sum of terms, coercion,

On the one hand, yes, coercion is slow, so it is helpful to not use it by default. On the other hand:

```
sage: Sym = SymmetricFunctions(Zmod(2)); Sym.inject_shorthands()
sage: m.sum_of_terms([(Partition([2]), 2)])
2*m[2]
sage: _ == 0
False
sage: e(__)
0
```

I don't know if this causes actual issues anywhere else in the code, but I cannot rule it out...


---

Comment by zabrocki created at 2015-04-16 13:03:43

That 2 in the example above is an integer 2 and not an integer 2 mod 2.  I have found it useful that free_module allows coefficients outside of the ring in the construction of elements.  The example that I have been considering is `f.map_coefficients(factor)` but this example raises its own problems.


---

Comment by darij created at 2015-04-16 21:11:05

Made some changes (mostly suggested by Nicolas). Some real timings remain to be done.


---

Comment by darij created at 2015-04-16 21:11:32

New commits:


---

Comment by git created at 2015-04-16 21:19:18

Branch pushed to git repo; I updated commit sha1. New commits:
