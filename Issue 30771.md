# Issue 30771: Upgrade NumPy to 1.20.x -- needs python >= 3.7

Issue created by migration from https://trac.sagemath.org/ticket/31008

Original creator: mkoeppe

Original creation time: 2020-12-05 02:34:57

CC:  slelievre fbissey

The upgrade to 1.20.x https://numpy.org/devdocs/release/1.20.0-notes.html would require dropping support for Python 3.6

 - 1.20.0rc1 released 2020-12-03 - https://pypi.org/project/numpy/#history


---

Comment by arojas created at 2021-02-08 15:11:27

The type aliases `numpy.int`, `numpy.complex` and `numpy.float` are now deprecated
----
New commits:


---

Comment by arojas created at 2021-02-08 15:11:27

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-02-08 17:44:19

Assuming the fixes to `src/sage` also work for 1.19.x, I'd suggest to put them on a separate ticket so we can get them in Sage 9.3. The upgrade itself will have to wait as it requires dropping python3.6 support


---

Comment by arojas created at 2021-02-08 21:08:01

Done, #31364


---

Comment by mkoeppe created at 2021-04-19 19:48:14

Last 10 new commits:


---

Comment by git created at 2021-05-12 00:40:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2021-06-03 17:29:30

all GH tests failed here, restart them, maybe?


---

Comment by mkoeppe created at 2021-06-03 17:37:13

On this GH Actions run, I merged many tickets. All failures are of the form

```
  [sagelib-9.3]   building 'sage.rings.padics.padic_relaxed_element' extension
  [sagelib-9.3]   Executing 1 command (using 1 thread)
  [sagelib-9.3]   [1/1] gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -O2 -g -march=native -fPIC -I./sage/libs/flint -I./sage/cpython -Isage/libs/flint -I/sage/build/pkgs/sagelib/src -I/usr/include/python3.8 -I/sage/local/lib/python3.8/site-packages/numpy/core/include -Ibuild/cythonized -I/sage/local/include -I/usr/include/python3.8 -c build/cythonized/sage/rings/padics/padic_relaxed_element.c -o build/temp.linux-x86_64-3.8/build/cythonized/sage/rings/padics/padic_relaxed_element.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99
  [sagelib-9.3]   build/cythonized/sage/rings/padics/padic_relaxed_element.c:5174:10: fatal error: sage/libs/linkages/padics/relaxed/flint_helper.c: No such file or directory
  [sagelib-9.3]    5174 | #include "sage/libs/linkages/padics/relaxed/flint_helper.c"
  [sagelib-9.3]         |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  [sagelib-9.3]   compilation terminated.
```

Not sure which one caused this


---

Comment by mkoeppe created at 2021-06-03 22:34:25

Already 9.4.beta0 is broken with the same error - see #31903


---

Comment by mkoeppe created at 2021-06-04 18:43:58

Now there are useful reports from GH Actions.


---

Comment by dimpase created at 2021-06-07 09:35:44

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-06-07 09:35:44

lgtm


---

Comment by mkoeppe created at 2021-06-07 22:24:58

Thanks!


---

Comment by vbraun created at 2021-06-19 20:58:34

Resolution: fixed
