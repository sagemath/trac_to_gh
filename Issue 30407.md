# Issue 30407: Upgrade optional package cbc to 2.10.5

Issue created by migration from https://trac.sagemath.org/ticket/30644

Original creator: slabbe

Original creation time: 2020-09-23 13:46:07

CC:  dcoudert dimpase

Current version in sage is `2.9.4.p0` from March 30, 2015.

Version 2.10.5 is from 2020-03-09.

Tarbal is here:
https://www.coin-or.org/download/source/Cbc/Cbc-2.10.5.tgz


---

Comment by slabbe created at 2020-09-23 13:50:00

I don't upgrade package that often, so maybe I did something wrong.

In particular, the url finishes with `.tgz` but everywhere in sage it is always `.tar.gz`?
----
New commits:


---

Comment by slabbe created at 2020-09-23 13:50:00

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-09-23 18:22:25

The changes look fine. If it builds OK on your machine, the next step could be to push a tag to a [GitHub](GitHub) repository to start portability testing


---

Comment by slabbe created at 2020-09-23 18:41:50

One question: should `2.9.4` be updated here?

```
$ cat build/pkgs/cbc/spkg-configure.m4 
SAGE_SPKG_CONFIGURE([cbc], [
    SAGE_SPKG_DEPCHECK([atlas openblas zlib bzip2], [
        dnl  checking with pkg-config
        PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
    ])
])
```



---

Comment by slabbe created at 2020-09-23 18:51:14

I am currently getting the following issue, seems to be an independent bug:

```
$ sage --package download cbc
Traceback (most recent call last):
  File "/home/slabbe/GitBox/sage/build/bin/sage-package", line 42, in <module>
    run()
  File "/home/slabbe/GitBox/sage/build/bin/../sage_bootstrap/cmdline.py", line 318, in run
    app.download_cls(args.package_name, args.allow_upstream)
TypeError: download_cls() takes exactly 2 arguments (3 given)
```



---

Comment by mkoeppe created at 2020-09-23 18:56:45

Replying to [comment:3 slabbe]:
> One question: should `2.9.4` be updated here?
> {{{
> $ cat build/pkgs/cbc/spkg-configure.m4 
> SAGE_SPKG_CONFIGURE([cbc], [
>     SAGE_SPKG_DEPCHECK([atlas openblas zlib bzip2], [
>         dnl  checking with pkg-config
>         PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
>     ])
> ])
> }}}

No, we want to accept the broadest range of supported cbc versions. CBC is very mature software, and we should be fine with pretty much any system-provided version.


---

Comment by slabbe created at 2020-09-23 18:57:18

Replying to [comment:4 slabbe]:
> I am currently getting the following issue, seems to be an independent bug:
> {{{
> TypeError: download_cls() takes exactly 2 arguments (3 given)
> }}}
just created #30648


---

Comment by slabbe created at 2020-09-24 07:46:24

Replying to [comment:2 mkoeppe]:
> The changes look fine. If it builds OK on your machine, 

it is not, I currently get a lot of timeout during `make ptestlong`:


```
----------------------------------------------------------------------
sage -t --long --random-seed=0 src/doc/en/reference/sat/index.rst  # Timed out
sage -t --long --random-seed=0 src/doc/en/thematic_tutorials/linear_programming.rst  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/bibd.py  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/database.py  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/incidence_structures.py  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/orthogonal_arrays.py  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/orthogonal_arrays_build_recursive.py  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/designs/orthogonal_arrays_find_recursive.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/integer_vector.py  # Timed out
sage -t --long --random-seed=0 src/sage/cpython/wrapperdescr.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/combinat/matrices/dancing_links.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/game_theory/normal_form_game.py  # Timed out
sage -t --long --random-seed=0 src/sage/geometry/cone.py  # Timed out
sage -t --long --random-seed=0 src/sage/geometry/polyhedron/base.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/bipartite_graph.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/comparability.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/connectivity.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/digraph.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/domination.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/generators/degree_sequence.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/generators/families.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/generators/smallgraphs.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/generic_graph.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/graph.py  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/graph_coloring.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/graph_decompositions/cutwidth.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/graph_decompositions/vertex_separation.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/graphs/hypergraph_generators.py  # Timed out
sage -t --long --random-seed=0 src/sage/homology/simplicial_complex.py  # Timed out
sage -t --long --random-seed=0 src/sage/knots/link.py  # Timed out
sage -t --long --random-seed=0 src/sage/matroids/graphic_matroid.py  # Timed out
sage -t --long --random-seed=0 src/sage/matroids/matroid.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/backends/cvxopt_backend.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/backends/generic_backend.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/knapsack.py  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/linear_functions.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/linear_tensor.py  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/linear_tensor_constraints.py  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/linear_tensor_element.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/numerical/mip.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/schemes/elliptic_curves/ell_rational_field.py  # 2 doctests failed
sage -t --long --random-seed=0 src/sage/coding/linear_code.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/numerical/optimize.py  # Timed out
sage -t --long --random-seed=0 src/sage/sat/solvers/sat_lp.py  # Timed out
sage -t --long --random-seed=0 src/sage/sat/solvers/satsolver.pyx  # Timed out
sage -t --long --random-seed=0 src/sage/schemes/toric/points.py  # Timed out
sage -t --long --random-seed=0 src/sage/schemes/toric/toric_subscheme.py  # Timed out
sage -t --long --random-seed=0 src/sage/lfunctions/sympow.py  # 4 doctests failed
----------------------------------------------------------------------
```


> the next step could be to push a tag to a [GitHub](GitHub) repository to start portability testing

Ok, I will try to do something like that once the above is fixed.


---

Comment by slabbe created at 2020-09-24 12:08:14

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-20 06:18:06

New commits:


---

Comment by mkoeppe created at 2021-07-20 06:18:06

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2021-07-20 19:35:24

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-07-20 19:35:24

OK - why is #32191 a dependency?


---

Comment by mkoeppe created at 2021-07-20 19:49:56

Changing status from positive_review to needs_work.


---

Comment by mkoeppe created at 2021-07-20 19:49:56

Actually there are unresolved problems - see #30635 (which needs help)


---

Comment by git created at 2022-03-14 22:44:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2022-03-14 22:58:43

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2022-03-14 23:00:01

On top of #31962 (new CBC interface via CVXPY), this upgrade works well as tested with `./sage -tp src/sage/graphs/`


---

Comment by git created at 2022-03-14 23:25:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2022-05-31 05:56:36

Cbc 2.10.8 was released on 2022-05-05.


---

Comment by git created at 2022-07-30 23:45:59

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by mkoeppe created at 2022-07-30 23:49:44

Changing status from needs_work to needs_review.


---

Comment by git created at 2022-07-31 02:08:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
