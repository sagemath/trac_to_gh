# Issue 12823: A first step towards linear systems of hypersurfaces in Sage

Issue created by migration from https://trac.sagemath.org/ticket/12995

Original creator: minz

Original creation time: 2012-05-23 17:19:25

Assignee: minz

In Magma, one can do the following:

```
> Q := RationalField();
> P<x,y,z> := ProjectiveSpace(Q,2);
> L := LinearSystem(P,2);
> L;
Linear system on Projective Space of dimension 2
Variables : x, y, z
with 6 sections: x^2 x*y x*z y^2 y*z z^2
> p := P ! [3,2,1];
> L1 := LinearSystem(L,p);
> L1;
Linear system on Projective Space of dimension 2
Variables : x, y, z
with 5 sections:
x^2 - 9*z^2
x*y - 6*z^2
x*z - 3*z^2
y^2 - 4*z^2
y*z - 2*z^2
```

Sage does not have this functionality. This patch will be a first step towards adding a class LinearSystem to Sage.

The goal is to add a method _linear_system_as_kernel to projective spaces that returns a matrix whose kernel can be identified with the degree d hypersurfaces with multiplicity at least m at pt.

(I actually need this method in the context of equimultiple liftings of plane curves over finite fields for which I will open a separate ticket.)


---

Comment by minz created at 2012-05-23 17:25:28

Changing status from new to needs_review.


---

Comment by davideklund created at 2012-08-23 23:38:48

All tests pass on Sage 5.2 and Mac OS X lion (except two tests that fail on an unpatched Sage 5.2).

Let me look through the details and test the functionality and get back here.


---

Comment by davideklund created at 2012-08-23 23:42:48

In the documentation part of the patch it says that the output is a matrix of size 

`{m-1+n choose n}`x`{d+1 choose n}` 

but is the number of columns really `{d+1 choose n}` and not `{d+n choose n}`?


---

Comment by davideklund created at 2012-09-19 04:25:48

The syntax

`raise Error, 'error message'`

has been deprecated in Python. http://docs.python.org/release/2.6.8/tutorial/errors.html#raising-exceptions

We should use

`raise Error('error message')`

instead.


---

Comment by davideklund created at 2012-09-19 19:09:43

Tests pass on Sage 5.3 (Mac OS X lion) also.


---

Comment by minz created at 2012-09-19 20:44:12

Dear David,

thanks for your remarks and your time to review this patch! I have uploaded a new version of the patch moments ago. You are quite right about the d+1 vs. d+n thing. I have also changed the syntax for raising Errors as you suggested.


---

Comment by davideklund created at 2012-09-20 03:58:01

Ok, looks good! I will put this to positive review soon.


---

Attachment

Fixed typos and line continuation of strings.


---

Comment by davideklund created at 2012-09-26 17:05:47

Hi!

I have a question: It says in the documentation part that the output is with respect to reverse lexicographic ordering of monomials. But it seems to me that, for example in the case of degree 2 in projective 2-space the monomials are ordered as:

`[x<sup>2,xy,xz,y</sup>2,yz,z^2]`

which seems to be just the lexicographic ordering rather than reverse lexicographic ordering.

If you agree I can incorporate this change into the review patch.


---

Comment by minz created at 2012-09-26 20:00:07

I don't have time tonight to answer your question, but I'll try to look at it tomorrow!


---

Comment by davideklund created at 2012-09-28 17:08:22

Ok, this looks good!

If you agree with the changes in the review patch and we resolve the issue about the monomial ordering, then we are good to go.


---

Attachment

fixes two more things in documentation/comments


---

Comment by minz created at 2012-09-29 13:15:43

Hi David,

please excuse my slow response. I've recently left academia and can only find time to look at Sage in the evenings (but I am happy to do so!).

Thanks again for your comments. You are quite right, I've changed the documentation accordingly. I also saw where I got confused and changed one line of comment, too. :)


---

Comment by davideklund created at 2012-09-29 19:41:40

Thanks!

Actually, I think you are responding very quickly. I will try to get the patch bot to apply the right patches so that we can get rid of the ugly red blob at the top.


---

Comment by davideklund created at 2012-09-29 19:43:03

For the patchbot:

Apply trac_12995_initial.patch, trac_12995_review2.patch


---

Comment by davideklund created at 2012-09-29 19:43:44

Changing status from needs_review to positive_review.


---

Comment by davideklund created at 2012-09-29 19:49:02

Changing priority from minor to major.


---

Comment by jdemeyer created at 2012-10-17 21:00:12

Resolution: fixed


---

Comment by jdemeyer created at 2012-10-18 06:33:08

Could you please make the commit message more descriptive than "incorporates David's remarks".


---

Comment by davideklund created at 2012-10-26 05:16:26

Yes, a more descriptive message would be better. Moritz, do you think you can take care of this? Thanks!


---

Comment by minz created at 2012-10-27 17:48:01

Hi,

I will get to it later tonight/tomorrow.


---

Attachment


---

Comment by minz created at 2012-10-29 07:03:00

Ok, done. :)


---

Comment by davideklund created at 2012-10-29 19:26:54

Thanks!
