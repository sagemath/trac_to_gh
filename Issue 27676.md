# Issue 27676: Failure in GAP package listing check due to different handling of user's .gap directory

Issue created by migration from https://trac.sagemath.org/ticket/27913

Original creator: nthiery

Original creation time: 2019-06-01 04:50:48

CC:  vbraun tscrim dimpase embray


```
sage -t src/sage/tests/gap_packages.py
**********************************************************************
File "src/sage/tests/gap_packages.py", line 137, in sage.tests.gap_packages.all_installed_packages
Failed example:
    all_installed_packages() == all_installed_packages(gap=gap)
Expected:
    True
Got:
    False
**********************************************************************
```

This is because `libgap` includes my .gap directory (which contains a few packages) but not `gap`:


```
sage: gap('GAPInfo.RootPaths')
[ "/opt/sage-git/local/share/gap/" ]
sage: libgap.eval('GAPInfo.RootPaths')
[ "/home/nthiery/.gap/", "/opt/sage-git/local/share/gap/" ]
```


Potential actions:
- Make gap and libgap behave consistently, presumably by having gap include the user's .gap directory
- Consider that the sanity check is about system packages, and use the option "ignore_dot_gap" of all_gap_packages in the above test.


---

Comment by fbissey created at 2019-06-01 04:52:54

Duplicate of #27878 really.


---

Comment by nthiery created at 2019-06-01 05:06:16

Thanks FranÃ§ois for the super-fast pointer!


---

Comment by embray created at 2019-06-03 06:24:49

Resolution: duplicate


---

Comment by embray created at 2019-06-03 06:27:24

> Make gap and libgap behave consistently, presumably by having gap include the user's .gap directory

I believe the opposite should be the case: By default the GAP interfaces in Sage should ignore a user `.gap` because it could potentially interfere with the functionality of Sage itself.

In the pexpect interface there is an option for this but it doesn't currently work properly.  We should fix it so that it does.  On libgap it's trickier, but it's not currently possible to have multiple "embedded GAP interpreters" as it were.  That would be a good chance to make in GAP, but would also require a lot of major work, so the safest option is for it to still ignore the user's .gap by default.
