# Issue 13084: abs floor ceil for quadratic number field

archive/issues_013084.json:
```json
{
    "body": "Assignee: @videlec\n\nCC:  @mwhansen berocal\n\nKeywords: absolute value, floor, ceiling, number field, quadratic\n\nImplementation of absolute value (abs), floor (floor) and ceiling (ceil) function for elements in quadratic number field. This depends (not very much) on comparisons in quadratic number fields implemented in tickects #7160 and #13213.\n\nStrangely enough, floor and ceil functions are much faster than abs function! The reason is because the comparison in #13213 which is called in abs is actually very slow.\n\n```\nsage: sage: K.<sqrt2> = QuadraticField(2, name='sqrt2')\nsage: %timeit abs(sqrt2)\n125 loops, best of 3: 2.22 ms per loop\nsage: %timeit floor(sqrt2)\n625 loops, best of 3: 3.37 \u00b5s per loop\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/13256\n\n",
    "created_at": "2012-07-14T17:48:12Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.11",
    "title": "abs floor ceil for quadratic number field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13084",
    "user": "https://github.com/videlec"
}
```
Assignee: @videlec

CC:  @mwhansen berocal

Keywords: absolute value, floor, ceiling, number field, quadratic

Implementation of absolute value (abs), floor (floor) and ceiling (ceil) function for elements in quadratic number field. This depends (not very much) on comparisons in quadratic number fields implemented in tickects #7160 and #13213.

Strangely enough, floor and ceil functions are much faster than abs function! The reason is because the comparison in #13213 which is called in abs is actually very slow.

```
sage: sage: K.<sqrt2> = QuadraticField(2, name='sqrt2')
sage: %timeit abs(sqrt2)
125 loops, best of 3: 2.22 ms per loop
sage: %timeit floor(sqrt2)
625 loops, best of 3: 3.37 µs per loop
```

Issue created by migration from https://trac.sagemath.org/ticket/13256





---

archive/issue_comments_158926.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-14T18:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158926",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_158927.json:
```json
{
    "body": "Does the removal of\n\n```\nK.<a> = NumberField(x^2+1, embedding=CDF.gen()) \n```\nas an example mean that one couldn't use this syntax at all any more?  Would number fields from quadratics not automatically be quadratic fields (when mathematically appropriate, I'm excluding `x^2-1` and the like) and inherit these methods, or would that simply not work now?",
    "created_at": "2013-05-10T17:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158927",
    "user": "https://github.com/kcrisman"
}
```

Does the removal of

```
K.<a> = NumberField(x^2+1, embedding=CDF.gen()) 
```
as an example mean that one couldn't use this syntax at all any more?  Would number fields from quadratics not automatically be quadratic fields (when mathematically appropriate, I'm excluding `x^2-1` and the like) and inherit these methods, or would that simply not work now?



---

archive/issue_comments_158928.json:
```json
{
    "body": "Replying to [comment:2 kcrisman]:\n> Does the removal of\n> \n> ```\n> K.<a> = NumberField(x^2+1, embedding=CDF.gen()) \n> ```\n> as an example mean that one couldn't use this syntax at all any more?\n\n\nThis syntax is still available. The patch only aims to implement methods abs, floor and ceil for quadratic elements. As an example\n\n```\nsage: K.<sqrt2> = QuadraticField(2)\nsage: sqrt2.floor()\n1\n```\nIt is yet possible (without the patch) to do\n\n```\nsage: K.<sqrt2> = QuadraticField(2)\nsage: floor(sqrt2)\n1\n```\nBut there is a simpler and faster way to do it compared to what floor does (using the real interval field with finer and finer approximations). Note that if the method .floor is present, the the function floor will use it!\n\n\n> Would number fields from quadratics not automatically be quadratic fields (when mathematically appropriate, I'm excluding `x^2-1` and the like) and inherit these methods, or would that simply not work now?\n\n\nYes, it is the way it is\n\n```\nsage: type(NumberField(x^2 + 1, 'a'))\n<class 'sage.rings.number_field.number_field.NumberField_quadratic_with_category'>\n```",
    "created_at": "2013-05-10T18:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158928",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:2 kcrisman]:
> Does the removal of
> 
> ```
> K.<a> = NumberField(x^2+1, embedding=CDF.gen()) 
> ```
> as an example mean that one couldn't use this syntax at all any more?


This syntax is still available. The patch only aims to implement methods abs, floor and ceil for quadratic elements. As an example

```
sage: K.<sqrt2> = QuadraticField(2)
sage: sqrt2.floor()
1
```
It is yet possible (without the patch) to do

```
sage: K.<sqrt2> = QuadraticField(2)
sage: floor(sqrt2)
1
```
But there is a simpler and faster way to do it compared to what floor does (using the real interval field with finer and finer approximations). Note that if the method .floor is present, the the function floor will use it!


> Would number fields from quadratics not automatically be quadratic fields (when mathematically appropriate, I'm excluding `x^2-1` and the like) and inherit these methods, or would that simply not work now?


Yes, it is the way it is

```
sage: type(NumberField(x^2 + 1, 'a'))
<class 'sage.rings.number_field.number_field.NumberField_quadratic_with_category'>
```



---

archive/issue_comments_158929.json:
```json
{
    "body": "Attachment [trac_13256-abs_floor_ceil_in_quadratic_fields.patch](tarball://root/attachments/some-uuid/ticket13256/trac_13256-abs_floor_ceil_in_quadratic_fields.patch) by @videlec created at 2013-05-18 13:15:37",
    "created_at": "2013-05-18T13:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158929",
    "user": "https://github.com/videlec"
}
```

Attachment [trac_13256-abs_floor_ceil_in_quadratic_fields.patch](tarball://root/attachments/some-uuid/ticket13256/trac_13256-abs_floor_ceil_in_quadratic_fields.patch) by @videlec created at 2013-05-18 13:15:37



---

archive/issue_comments_158930.json:
```json
{
    "body": "The patch now takes care of the new doctest framework (ie replace \"...\" by \"....:\" for multiline tests).",
    "created_at": "2013-05-18T13:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158930",
    "user": "https://github.com/videlec"
}
```

The patch now takes care of the new doctest framework (ie replace "..." by "....:" for multiline tests).



---

archive/issue_comments_158931.json:
```json
{
    "body": "I have made a short review patch, with correct links to trac and raise statements.",
    "created_at": "2013-05-28T20:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158931",
    "user": "https://github.com/fchapoton"
}
```

I have made a short review patch, with correct links to trac and raise statements.



---

archive/issue_comments_158932.json:
```json
{
    "body": "Attachment [trac_13256_details-review.patch](tarball://root/attachments/some-uuid/ticket13256/trac_13256_details-review.patch) by @fchapoton created at 2013-05-30 18:45:39",
    "created_at": "2013-05-30T18:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158932",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_13256_details-review.patch](tarball://root/attachments/some-uuid/ticket13256/trac_13256_details-review.patch) by @fchapoton created at 2013-05-30 18:45:39



---

archive/issue_comments_158933.json:
```json
{
    "body": "ok, looks good to me. Positive review.",
    "created_at": "2013-05-31T18:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158933",
    "user": "https://github.com/fchapoton"
}
```

ok, looks good to me. Positive review.



---

archive/issue_comments_158934.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-05-31T18:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158934",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_158935.json:
```json
{
    "body": "Replying to [comment:7 chapoton]:\n> ok, looks good to me. Positive review.\n\n\nCool. Thanks Fr\u00e9d\u00e9ric.",
    "created_at": "2013-05-31T22:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158935",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:7 chapoton]:
> ok, looks good to me. Positive review.


Cool. Thanks Frédéric.



---

archive/issue_events_036618.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-03T10:02:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13084#event-36618"
}
```



---

archive/issue_events_036619.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-06T12:32:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13084#event-36619"
}
```



---

archive/issue_comments_158936.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-06T12:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13084#issuecomment-158936",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
