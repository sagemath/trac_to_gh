# Issue 20667: Deprecate Matrix.I

archive/issues_020667.json:
```json
{
    "body": "Keywords: property, consistency\n\nFollowing two long discussions on sage-devel about ``@`property`: https://groups.google.com/forum/#!searchin/sage-devel/heavy/sage-devel/tVa8vs_PHH0/60QajUDYBQAJ\nhttps://groups.google.com/forum/#!searchin/sage-devel/heavy/sage-devel/b-u-0WqrtcY/SWhdeoO_BgAJ\n\nNo consensus was reached, except that mostly everyone agreed that `Matrix.I` was bad (in particular, there was people both for and against Matrix.T and Matrix.H).\n\nSo this ticket aims to deprecate just `Matrix.I`, so we can take it out\ncompletely at some point in the future.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/20904\n\n",
    "created_at": "2016-06-29T07:29:31Z",
    "labels": [
        "linear algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Deprecate Matrix.I",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20667",
    "user": "@johanrosenkilde"
}
```
Keywords: property, consistency

Following two long discussions on sage-devel about ``@`property`: https://groups.google.com/forum/#!searchin/sage-devel/heavy/sage-devel/tVa8vs_PHH0/60QajUDYBQAJ
https://groups.google.com/forum/#!searchin/sage-devel/heavy/sage-devel/b-u-0WqrtcY/SWhdeoO_BgAJ

No consensus was reached, except that mostly everyone agreed that `Matrix.I` was bad (in particular, there was people both for and against Matrix.T and Matrix.H).

So this ticket aims to deprecate just `Matrix.I`, so we can take it out
completely at some point in the future.


Issue created by migration from https://trac.sagemath.org/ticket/20904





---

archive/issue_comments_285456.json:
```json
{
    "body": "I'm setting this for needs_review. Note that I tried to run the doctests but that I'm getting a gazillion errors all over the place, unrelated to this ticket, for some reason, and so it's difficult for me to check whether this ticket causes new failures.\n----\nNew commits:",
    "created_at": "2016-06-30T12:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285456",
    "user": "@johanrosenkilde"
}
```

I'm setting this for needs_review. Note that I tried to run the doctests but that I'm getting a gazillion errors all over the place, unrelated to this ticket, for some reason, and so it's difficult for me to check whether this ticket causes new failures.
----
New commits:



---

archive/issue_comments_285457.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-30T12:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285457",
    "user": "@johanrosenkilde"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285458.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-30T13:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285458",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285459.json:
```json
{
    "body": "Fix a doc-test problem. Still open for review.",
    "created_at": "2016-06-30T13:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285459",
    "user": "@johanrosenkilde"
}
```

Fix a doc-test problem. Still open for review.



---

archive/issue_comments_285460.json:
```json
{
    "body": "I got no deprecation warning at all from this code.",
    "created_at": "2016-07-05T11:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285460",
    "user": "@jm58660"
}
```

I got no deprecation warning at all from this code.



---

archive/issue_comments_285461.json:
```json
{
    "body": "Perhaps it is due to this: https://groups.google.com/forum/#!topic/sage-devel/NCuA7F4YOLk",
    "created_at": "2016-07-05T12:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285461",
    "user": "@johanrosenkilde"
}
```

Perhaps it is due to this: https://groups.google.com/forum/#!topic/sage-devel/NCuA7F4YOLk



---

archive/issue_comments_285462.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-06T06:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285462",
    "user": "@jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285463.json:
```json
{
    "body": "OK. Maybe it works after #20948, but for now I mark this as needs_work. I can review this then. Please also fill in author name.",
    "created_at": "2016-07-06T06:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285463",
    "user": "@jm58660"
}
```

OK. Maybe it works after #20948, but for now I mark this as needs_work. I can review this then. Please also fill in author name.



---

archive/issue_comments_285464.json:
```json
{
    "body": "This should work, as #20948 has been closet. But installing this will force big recompiling, so I guess this needs rebasing or merging.",
    "created_at": "2016-07-21T09:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285464",
    "user": "@jm58660"
}
```

This should work, as #20948 has been closet. But installing this will force big recompiling, so I guess this needs rebasing or merging.



---

archive/issue_comments_285465.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-27T12:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285465",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285466.json:
```json
{
    "body": "Rebased. The warnings work correctly for me now.",
    "created_at": "2016-07-27T12:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285466",
    "user": "@johanrosenkilde"
}
```

Rebased. The warnings work correctly for me now.



---

archive/issue_comments_285467.json:
```json
{
    "body": "Works. Thanks.\n\nPlease add your real name to Authors-field and put this to needs_review so I can mark my positive review.",
    "created_at": "2016-07-27T19:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285467",
    "user": "@jm58660"
}
```

Works. Thanks.

Please add your real name to Authors-field and put this to needs_review so I can mark my positive review.



---

archive/issue_comments_285468.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-27T23:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285468",
    "user": "@johanrosenkilde"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285469.json:
```json
{
    "body": "Thanks. I always forget...",
    "created_at": "2016-07-27T23:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285469",
    "user": "@johanrosenkilde"
}
```

Thanks. I always forget...



---

archive/issue_comments_285470.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-28T04:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285470",
    "user": "@jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285471.json:
```json
{
    "body": "See patchbot",
    "created_at": "2016-08-05T21:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285471",
    "user": "@vbraun"
}
```

See patchbot



---

archive/issue_comments_285472.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-05T21:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285472",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_285473.json:
```json
{
    "body": "Why the changes to `src/sage/structure/sage_object.pyx` anyway?",
    "created_at": "2016-08-06T09:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285473",
    "user": "@jdemeyer"
}
```

Why the changes to `src/sage/structure/sage_object.pyx` anyway?



---

archive/issue_comments_285474.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-06T09:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285474",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285475.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-06T09:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285475",
    "user": "@johanrosenkilde"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285476.json:
```json
{
    "body": "OK, fixed: the bug was due to not properly reinstating warnings in `_test_not_implemented_methods` if that method threw an `AssertionError`.\n\n`@`jdemeyer: the reason is that `_test_not_implemented_methods` accesses every attribute on an object. A gazillion `TESTS`-blocks in `sage.matrix` runs `TestSuite` on matrices, which will run `_test_not_implemented_methods`, which will access every attribute, in particular `Matrix.I`. Since this is a property, accessing it will \"call\" it, thus triggering the deprecation warning. Since `_test_not_implemented_methods` is not about warnings, I thought that disabling *all* warnings would be OK for the duration of the test.\n\nA more efficient version of `_test_not_implemented_methods` shouldn't actually call properties, of course, and then I wouldn't have to modify the warnings filter. Do you have a suggestion for an alternative version that would behave like this?\n\nBest,\nJohan",
    "created_at": "2016-08-06T09:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285476",
    "user": "@johanrosenkilde"
}
```

OK, fixed: the bug was due to not properly reinstating warnings in `_test_not_implemented_methods` if that method threw an `AssertionError`.

`@`jdemeyer: the reason is that `_test_not_implemented_methods` accesses every attribute on an object. A gazillion `TESTS`-blocks in `sage.matrix` runs `TestSuite` on matrices, which will run `_test_not_implemented_methods`, which will access every attribute, in particular `Matrix.I`. Since this is a property, accessing it will "call" it, thus triggering the deprecation warning. Since `_test_not_implemented_methods` is not about warnings, I thought that disabling *all* warnings would be OK for the duration of the test.

A more efficient version of `_test_not_implemented_methods` shouldn't actually call properties, of course, and then I wouldn't have to modify the warnings filter. Do you have a suggestion for an alternative version that would behave like this?

Best,
Johan



---

archive/issue_comments_285477.json:
```json
{
    "body": "OK, got it. One detail: I think it is better to use a `try`/`finally` to restore the warnings. That is more robust than adding `warnings.filters.pop(0)` at every exit point of the function.",
    "created_at": "2016-08-06T10:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285477",
    "user": "@jdemeyer"
}
```

OK, got it. One detail: I think it is better to use a `try`/`finally` to restore the warnings. That is more robust than adding `warnings.filters.pop(0)` at every exit point of the function.



---

archive/issue_comments_285478.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-06T12:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285478",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285479.json:
```json
{
    "body": "Agreed, fixed now.",
    "created_at": "2016-08-06T12:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285479",
    "user": "@johanrosenkilde"
}
```

Agreed, fixed now.



---

archive/issue_comments_285480.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-11T09:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285480",
    "user": "@jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285481.json:
```json
{
    "body": "Works. (But too late to 7.3, changed milestone.)",
    "created_at": "2016-08-11T09:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285481",
    "user": "@jm58660"
}
```

Works. (But too late to 7.3, changed milestone.)



---

archive/issue_comments_285482.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-13T22:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20667",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20667#issuecomment-285482",
    "user": "@vbraun"
}
```

Resolution: fixed
