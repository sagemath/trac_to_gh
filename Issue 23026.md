# Issue 23026: Allow use of an unpatched pari

Issue created by migration from Trac.

Original creator: infinity0

Original creation time: 2017-06-17 10:21:11

CC:  thansen




---

Comment by infinity0 created at 2017-06-17 10:26:33

Changing component from PLEASE CHANGE to doctest framework.


---

Comment by infinity0 created at 2017-06-17 10:26:33

Changing type from PLEASE CHANGE to defect.


---

Comment by infinity0 created at 2017-06-17 10:26:33

New commits:


---

Comment by infinity0 created at 2017-06-17 10:26:33

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-06-18 21:54:21

I don't really get the point of this patch. We are still patching PARI, so which problem does this fix? I think this branch should be applied by distros if they feel the need, not by Sage.

I don't want to overcomplicate our doctest framework just because upstream PARI is so stubborn to insist that debug messages should be shown unconditionally with no way to disable them. The correct solution here is fixing PARI, not Sage.


---

Comment by infinity0 created at 2017-06-19 10:26:18

OK, I found [the thread](http://pari.math.u-bordeaux1.fr/archives/pari-dev-1601/threads.html#00013) and I can agree that the PARI position does not make much sense. Today is 2017, stack size warnings should at best be considered "memory debugging messages" and not in the same category as other types of warnings.

Nevertheless, this patch would help other distros packages Sage more quickly. It is small, but the amount of small things like this in Sage quickly adds up to a major time sink when packaging. Yes, we can keep carrying this in Debian if you don't agree, it's up to you.

When I find some time I'll try to re-raise this issue on the pari mailing list.


---

Comment by jdemeyer created at 2017-06-19 11:50:36

Replying to [comment:4 infinity0]:
> Nevertheless, this patch would help other distros packages Sage more quickly. It is small, but the amount of small things like this in Sage quickly adds up to a major time sink when packaging. Yes, we can keep carrying this in Debian if you don't agree, it's up to you.

Exactly the same arguments could be used to apply the PARI patch to the Debian PARI package.


---

Comment by infinity0 created at 2017-06-19 12:15:34

I don't quite follow that - how would applying the PARI patch to Debian, help other distros package Sage (or PARI) more quickly? And even if it did, I don't think it would be appropriate to patch package A to make it easier to package B.

As you have seen, we _have_ applied some Sage patches to other packages in Debian. In this situation, I can't by convention (because there is already an active maintainer), and even if I was the only maintainer, upstream has voiced some opposition to the patch which makes me less certain about applying it - there might be issue or concern that he has about the patch, that I don't know about. If I knew more about PARI's internals and its usecases I might be more confident about trying to override him for this patch, but I'm not.

Anyway, no worries I don't mean to pressure you. The next step for us would be to contact PARI again.


---

Comment by jdemeyer created at 2017-06-20 15:11:03

Replying to [comment:6 infinity0]:
> I don't quite follow that - how would applying the PARI patch to Debian, help other distros package Sage (or PARI) more quickly?

Right, I was just thinking about Debian...

Anyway, I still think that this patch has no place in the Sage doctest framework.


---

Comment by vdelecroix created at 2017-06-20 17:18:13

Replying to [comment:7 jdemeyer]:
> Replying to [comment:6 infinity0]:
> > I don't quite follow that - how would applying the PARI patch to Debian, help other distros package Sage (or PARI) more quickly?
> 
> Right, I was just thinking about Debian...
> 
> Anyway, I still think that this patch has no place in the Sage doctest framework.

Not so long ago, there was a [proposal on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/nTwhCV89FXE) to allow some of the packages to be picked from the system. The patch in this ticket would be useful if the PARI/GP used is the one from the system.


---

Comment by jdemeyer created at 2017-06-20 17:28:36

I am still hoping that PARI upstream will see the light and just accept my stack warning patch.


---

Comment by fbissey created at 2017-06-20 21:18:11

Well, I am lucky enough to do more or less what I want in sage-on-gentoo. I have the nagging feeling that I could inherit a number of packages in the official Gentoo tree (including pari) if I was to finally become an official dev.


---

Comment by saraedum created at 2017-06-22 04:56:58

I think this patch makes perfect sense. If the author could add a comment to the source code explaining that this is not relevant for the patched PARI that Sage is shipping as of now, that would be great. Anyway, I would be willing to give it positive review unless jdemeyer has very strong feelings about it.


---

Comment by jdemeyer created at 2017-06-22 08:11:37

To be honest, I mostly have strong feelings about the upstream PARI patch that they do not want to accept (why???). It feels like accepting this ticket in Sage is like admitting defeat. So I certainly won't set this to positive_review.

On the other hand, if this patch makes other people's lives easier, then I will not veto this patch.


---

Comment by saraedum created at 2018-01-06 00:02:53

Oh, it's been a while. thansen, if you still think that this would make things easier for packagers, please add a short comment, and I will set this to positive review.


---

Comment by jdemeyer created at 2018-01-06 07:38:47

Breaking news (from last month or so): upstream PARI finally accepted this patch in `master`. So it should be sufficient to wait for the next PARI release (or backport the patch in Debian).


---

Comment by jdemeyer created at 2018-01-06 10:39:50

Replying to [comment:14 jdemeyer]:
> upstream PARI finally accepted this patch in `master`.

Actually, I just saw that they reverted part of that patch again. So we are getting closer, but we are not quite there yet.


---

Comment by jdemeyer created at 2018-01-08 11:02:21

I think that this can be closed in light of #24481.


---

Comment by jdemeyer created at 2018-02-13 16:29:33

Resolution: duplicate
