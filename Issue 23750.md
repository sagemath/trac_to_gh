# Issue 23750: minimal implementation of FQSYM

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-10-08 09:07:31

CC:  tscrim darij amypang

FQSym is also know as Malvenuto-Reutenauer Hopf algebra

because #19278 has rotten


---

Comment by chapoton created at 2017-10-08 09:08:06

New commits:


---

Comment by chapoton created at 2017-10-08 09:08:06

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-10-08 09:10:35

All tests pass, but the documentation is still rough.


---

Comment by chapoton created at 2017-10-08 09:10:35

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-10-21 07:51:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-10-21 07:52:16

comments welcome, please


---

Comment by git created at 2017-10-21 09:05:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-10-23 04:04:23

I mentioned this on one of the other tickets, but what about using `<<` and `>>` as shorthands for `prec` and `succ`? Bit shifting doesn't make sense here and we can (at Python speed) go to the coercion framework. However, they just are just lower precedence than `+`, so `x << y + a << b` gets evaluated as `(x << (y + a)) << b`.


---

Comment by darij created at 2017-10-24 18:46:00

How easy would it be to extend this class to a multi-basis (i.e., WithRealizations) Hopf algebra? I am fairly sure that at some point, we will want FQSym to have multiple basis, and not just the two obvious ones that are related by inverting the permutation.

In other news, sorry for not reviewing this until now. I am not sure whether I'll do it today -- this semester my todo list is growing a lot faster than it is shrinking. But I'll at least take a look and try to fill in the doc if some of it is missing.


---

Comment by darij created at 2017-10-24 19:10:10

I am confused by the handling of empty permutations in `succ_product_on_basis` and `prec_product_on_basis`. Normally, the output of such methods should be an element of the module (here, FQSym); but in those special cases, it is a list of keys. Does Sage know how to deal with these issues? [EDIT: No, but I've fixed the methods now.]

Also, I suggest resolving the "empty \prec empty" and "empty \succ empty" indeterminacy in some way, e.g., setting one of them to be empty and the other 0. No, I don't have much of a preference :)

Where do we put references nowadays? I'd like to cite Grinberg & Reiner Chapter 8.


---

Comment by darij created at 2017-10-24 19:16:23

New commits:


---

Comment by darij created at 2017-10-26 21:04:56

I'll make a commit shortly. It is a review commit, but the following issues remain:

- The shorthand Travis suggested above (comment:6).

- Multi-basis support (comment:7).

- A reference to any source that uses modern notation (e.g., Grinberg/Reiner Chapter 8).

- For reasons of speed: use sum_of_terms or sum_of_monomials instead of sum in the constructors of the three operations?

- For reasons of speed: don't we have lower-level shuffle iterators that avoid the detour through the `Word` class?


---

Comment by git created at 2017-10-26 21:06:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-10-26 21:15:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by amypang created at 2017-10-27 00:41:49

For multi-basis support: maybe Mike Zabrocki's template would be useful? (It's designed to be a template for CHAs in general, but he actually demonstrates it with FQSym.)

https://cocalc.com/projects/44ed3873-5f1b-4e40-8f2f-be95581bf080/files/for_Mike_Z/?session=default

Thank you everybody for your hard work, really looking forward to having FQSym in Sage.


---

Comment by chapoton created at 2017-10-27 07:19:40

Thanks, Darij.

I would strongly suggest keeping the multi-basis support for another ticket.


---

Comment by darij created at 2017-10-27 07:28:27

The problem is: can it be done without changing the syntax? If not, we need to do it in this ticket, or else the next ticket will essentially be a full deprecation.


---

Comment by git created at 2017-11-02 00:13:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-11-02 00:53:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-02 00:55:16

Darij and I worked on doing the multiple bases support so we do not have to deal with (very tricky) deprecations later on. Darij is going to work on the SGA coercions.

My only question is do we want the algebra to be `FQSYM` in all caps in `algebras`?


---

Comment by git created at 2017-11-02 01:24:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-02 08:24:56

Actually, I have another question: comment:6. If you don't want to, it's fine, but just a thought (at least, I don't recall you saying anything about it previous, sorry if you did). Both of these are primarily for Frédéric.


---

Comment by chapoton created at 2017-11-03 20:40:27

Thanks for working on that. I am not very positive about using << and >> for the dendriform operations. I think we must live with the fact that there are too many operations to assign a symbol to each of them.


---

Comment by tscrim created at 2017-11-03 20:54:31

Changing status from needs_work to needs_info.


---

Comment by tscrim created at 2017-11-03 20:54:31

I also feel that the swapped order of operators would likely confuse some people too. So scratch that idea.

The only other thing left is `algebras.FQSym` vs `algebras.FQSYM`. This is probably bikeshedding, but I don't like the all-caps as it makes it feel like the `Y` and `M` stand for something. I'm also more included to having `FreeQuasiSymmetricFunctions` and in the global namespace in line with our other CHAs in Sage (imported lazily). Moreover, I think we should also have `algebras.MalvenutoReutenauer`.

At some point we should decide how we want to add the CHAs to `algebras`, if we want to do `algebras.combinatorial_hopf.Foo`, add them `algebras.Foo`, leave some of them in the global namespace, and/or have `combinatorial_hopf_algebras.Foo`. However, that is a separate issue for another ticket that is far easier to do.

Thoughts?

(Darij didn't want to set it to needs_info because he felt it was a quagmire; I am to prove him wrong. :P)


---

Comment by tscrim created at 2017-11-06 21:27:33

ping?


---

Comment by chapoton created at 2017-11-07 18:45:52

ok for algebras.FQSym instead of algebras.FQSYM

ok for algebras.MalvenutoReutenauer (but not a strong +1)

ok for lazily imported global FreeQuasiSymmetricFunctions (not a strong +1 either)


---

Comment by git created at 2017-11-07 22:31:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-07 22:35:42

I made a few changes beyond the naming.

- I added Darij to the authors and copyright.
- I changed the implementation of `to_symmetric_group_algebra` because SGA's form a natural tower of R-algebras. Since this is just a R-linear embedding, it makes perfect sense to use the maximal degree (and the behavior you allowed did not match your doc).
- Some minor documentation/formatting changes.

If my changes are good, then positive review.


---

Comment by tscrim created at 2017-11-07 22:35:42

Changing status from needs_info to needs_review.


---

Comment by darij created at 2017-11-08 00:34:04

Nice extension of `to_symmetric_group_algebra`, although I'm not sure how useful it will be (it's not an embedding anymore). BUT this part:

```
+            if not self:
+                return SymmetricGroupAlgebra(self.base_ring(), 0).zero()
```

should be

```
            if not self:
                if n is None:
                    n = 0
                return SymmetricGroupAlgebra(self.base_ring(), n).zero()
```

instead.


---

Comment by git created at 2017-11-08 00:36:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-08 00:39:24

Right, good point. Fixed. I also changed the error message to be more specific about the cause. I'm not sure how useful the R-linear map to SGA is in general (even restricted to the graded component), but I'm assuming you have a use-case and it is my ignorance about FQSym.


---

Comment by darij created at 2017-11-08 00:43:13

Thanks -- it LGTM now.

My first use case is studying the Reiner-Saliola-Welker idempotents in the SGAs using Hopf machinery in FQSym (as they are not in the descent algebra). Not sure whether anything will come out of that, but now it can be done easily with Sage, which is some progress.


---

Comment by tscrim created at 2017-11-11 04:12:47

Frédéric, everything okay with you?

`@`darij thanks for the explanation.


---

Comment by chapoton created at 2017-11-11 07:41:56

2 failing doctests, otherwise I'm ok


---

Comment by git created at 2017-11-11 15:31:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-11 15:35:05

This fixes the doctest failures because the `FQSym` object does not have a distinguished basis, so it should not have a `WithBasis()` with the category. But the bases need to specify it. Just needs a quick double-check.


---

Comment by darij created at 2017-11-11 15:37:53

If tests pass, this is a pos_rev. I mistook WithBasis for WithRealizations :)


---

Comment by tscrim created at 2017-11-11 22:52:10

Green patchbot. Thank you both for your work on this.


---

Comment by tscrim created at 2017-11-11 22:52:10

Changing status from needs_review to positive_review.


---

Comment by darij created at 2017-11-11 23:41:51

Thanks to the two of you, who did most of it!


---

Comment by vbraun created at 2017-12-11 01:03:33

Resolution: fixed
