# Issue 19389: OpenSSL hack for El Capitan

archive/issues_019389.json:
```json
{
    "body": "CC:  u/vbraun/openssl_hack_for_el_capitan\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19626\n\n",
    "created_at": "2015-11-26T13:15:02Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "OpenSSL hack for El Capitan",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19389",
    "user": "https://github.com/vbraun"
}
```
CC:  u/vbraun/openssl_hack_for_el_capitan



Issue created by migration from https://trac.sagemath.org/ticket/19626





---

archive/issue_comments_266230.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-11-26T14:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266230",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_266231.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-26T14:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266231",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_266232.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-11-26T14:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266232",
    "user": "https://github.com/vbraun"
}
```

New commits:



---

archive/issue_comments_266233.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2015-11-26T14:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266233",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_266234.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-26T15:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266234",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_266235.json:
```json
{
    "body": "I can't test this but if you say that it works, I believe you.\n\nPlease merge this in the same beta as #18542, otherwise you'll need to bump the version number of the package.",
    "created_at": "2015-11-26T15:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266235",
    "user": "https://github.com/jdemeyer"
}
```

I can't test this but if you say that it works, I believe you.

Please merge this in the same beta as #18542, otherwise you'll need to bump the version number of the package.



---

archive/issue_comments_266236.json:
```json
{
    "body": "It seems to work on OS X 10.10 (or at least when I build Python, it looks in the indicated place for the openssl headers), but I don't have access to my OS X 10.11 machine today.",
    "created_at": "2015-11-26T17:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266236",
    "user": "https://github.com/jhpalmieri"
}
```

It seems to work on OS X 10.10 (or at least when I build Python, it looks in the indicated place for the openssl headers), but I don't have access to my OS X 10.11 machine today.



---

archive/issue_comments_266237.json:
```json
{
    "body": "Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do\n\n```\n>> import ssl\n```\n",
    "created_at": "2015-11-26T18:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266237",
    "user": "https://github.com/dimpase"
}
```

Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do

```
>> import ssl
```




---

archive/issue_comments_266238.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-26T18:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266238",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_266239.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do\n> {{{\n> >> import ssl\n> }}} \n\nCould you try building from scratch? When I rebuild Python everything works, but when I build from scratch, Python fails to build. This is on OS X 10.10:\n\n```\nInstalling valgrind suppression file...\nTesting importing of various modules...\nctypes module imported OK\nmath module imported OK\nhashlib module imported OK\ncrypt module imported OK\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named readline\nreadline module failed to import\nsocket module imported OK\nError: One or more modules failed to import.\n```\n\nEarlier in the log:\n\n```\nbuilding 'readline' extension\ngcc -fno-strict-aliasing -I/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift-migrator/sdk/MacOSX.sdk/usr/include/ -DNDEBUG -g -fwrapv -O3 -Wall -I/Users/palmieri/Desktop/TEMP/sage/local/include -I. -IInclude -I./Include -I/usr/local/include -I/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Include -I/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src -c /Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Modules/readline.c -o build/temp.macosx-10.9-x86_64-2.7/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Modules/readline.o\nModules/readline.c: In function 'flex_complete':\nModules/readline.c:868:5: error: 'rl_completion_suppress_append' undeclared (first use in this function)\n     rl_completion_suppress_append = 0;\n     ^\nModules/readline.c:868:5: note: each undeclared identifier is reported only once for each function it appears in\nModules/readline.c: In function 'readline_until_enter_or_signal':\nModules/readline.c:988:5: error: 'rl_catch_signals' undeclared (first use in this function)\n     rl_catch_signals = 0;\n     ^\n\n[snip]\n\n\nFailed to build these modules:\n_elementtree       _scproxy           pyexpat         \nreadline                                              \n```\n\nCould it be picking up the readline headers from the new include path?\n\nI think this needs to be reopened, since it doesn't build from scratch successfully on OS X 10.10.",
    "created_at": "2015-11-26T20:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266239",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:5 dimpase]:
> Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do
> {{{
> >> import ssl
> }}} 

Could you try building from scratch? When I rebuild Python everything works, but when I build from scratch, Python fails to build. This is on OS X 10.10:

```
Installing valgrind suppression file...
Testing importing of various modules...
ctypes module imported OK
math module imported OK
hashlib module imported OK
crypt module imported OK
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named readline
readline module failed to import
socket module imported OK
Error: One or more modules failed to import.
```

Earlier in the log:

```
building 'readline' extension
gcc -fno-strict-aliasing -I/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift-migrator/sdk/MacOSX.sdk/usr/include/ -DNDEBUG -g -fwrapv -O3 -Wall -I/Users/palmieri/Desktop/TEMP/sage/local/include -I. -IInclude -I./Include -I/usr/local/include -I/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Include -I/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src -c /Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Modules/readline.c -o build/temp.macosx-10.9-x86_64-2.7/Users/palmieri/Desktop/TEMP/sage/local/var/tmp/sage/build/python2-2.7.9/src/Modules/readline.o
Modules/readline.c: In function 'flex_complete':
Modules/readline.c:868:5: error: 'rl_completion_suppress_append' undeclared (first use in this function)
     rl_completion_suppress_append = 0;
     ^
Modules/readline.c:868:5: note: each undeclared identifier is reported only once for each function it appears in
Modules/readline.c: In function 'readline_until_enter_or_signal':
Modules/readline.c:988:5: error: 'rl_catch_signals' undeclared (first use in this function)
     rl_catch_signals = 0;
     ^

[snip]


Failed to build these modules:
_elementtree       _scproxy           pyexpat         
readline                                              
```

Could it be picking up the readline headers from the new include path?

I think this needs to be reopened, since it doesn't build from scratch successfully on OS X 10.10.



---

archive/issue_comments_266240.json:
```json
{
    "body": "Replying to [comment:7 jhpalmieri]:\n> Replying to [comment:5 dimpase]:\n> > Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do\n> > {{{\n> > >> import ssl\n> > }}} \n> \n> Could you try building from scratch? When I rebuild Python everything works, but when I build from scratch, Python fails to build. \n\npresently it is building in my office, I'll only know the outcome in about 14 hours from now on.\nIn the worst case one can copy or link `...wift-migrator/sdk/MacOSX.sdk/usr/include/openssl/` somewhere, so that anything outside `openssl/` from there is not looked up...",
    "created_at": "2015-11-26T20:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266240",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:7 jhpalmieri]:
> Replying to [comment:5 dimpase]:
> > Cool, after applying this patch on OSX 10.11 and rebuilding python I indeed can do
> > {{{
> > >> import ssl
> > }}} 
> 
> Could you try building from scratch? When I rebuild Python everything works, but when I build from scratch, Python fails to build. 

presently it is building in my office, I'll only know the outcome in about 14 hours from now on.
In the worst case one can copy or link `...wift-migrator/sdk/MacOSX.sdk/usr/include/openssl/` somewhere, so that anything outside `openssl/` from there is not looked up...



---

archive/issue_comments_266241.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2015-11-26T22:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266241",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_266242.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2015-11-26T22:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266242",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_266243.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-11-26T22:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266243",
    "user": "https://github.com/vbraun"
}
```

New commits:



---

archive/issue_comments_266244.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-26T22:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266244",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_266245.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-26T22:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_266246.json:
```json
{
    "body": "Rebuild from scratch works now",
    "created_at": "2015-11-26T23:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266246",
    "user": "https://github.com/vbraun"
}
```

Rebuild from scratch works now



---

archive/issue_comments_266247.json:
```json
{
    "body": "Works for me, too.",
    "created_at": "2015-11-27T00:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266247",
    "user": "https://github.com/jhpalmieri"
}
```

Works for me, too.



---

archive/issue_comments_266248.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-27T08:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19389#issuecomment-266248",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
