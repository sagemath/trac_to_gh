# Issue 26503: create a python3 test make target

archive/issues_026503.json:
```json
{
    "body": "CC:  @jdemeyer @tscrim @kiwifb @embray @vbraun\n\nto prevent regression by testing submodules already known to be ok.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26740\n\n",
    "created_at": "2018-11-22T14:27:29Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "create a python3 test make target",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26503",
    "user": "https://github.com/fchapoton"
}
```
CC:  @jdemeyer @tscrim @kiwifb @embray @vbraun

to prevent regression by testing submodules already known to be ok.


Issue created by migration from https://trac.sagemath.org/ticket/26740





---

archive/issue_comments_372272.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-11-22T14:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372272",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_372273.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-22T14:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372273",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372274.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-22T15:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372274",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_372275.json:
```json
{
    "body": "errors when not using this option..",
    "created_at": "2018-11-22T15:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372275",
    "user": "https://github.com/fchapoton"
}
```

errors when not using this option..



---

archive/issue_comments_372276.json:
```json
{
    "body": "Oh, well, this seems to work correctly. Feedback would be appreciated.",
    "created_at": "2018-11-22T19:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372276",
    "user": "https://github.com/fchapoton"
}
```

Oh, well, this seems to work correctly. Feedback would be appreciated.



---

archive/issue_comments_372277.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-22T19:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372277",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372278.json:
```json
{
    "body": "I think that's a lofty goal but I have reservations until I understand how it impact and work with distro (like me). What happens when you\nhit this section with python2?\n\n```\n@@ -690,6 +690,13 @@ class DocTestController(SageObject):\n             Doctesting the Sage notebook.\n             sage: DC.files[0][-6:]  # py2\n             'sagenb'\n+\n+        ::\n+\n+            sage: DD = DocTestDefaults(python3 = True)\n+            sage: DC = DocTestController(DD, [])\n+            sage: DC.add_files()\n+            Doctesting modules compatible with Python 3\n         \"\"\"\n         opj = os.path.join\n         from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_ROOT\n```\n\n\nAs a distro with sage installed for python2 and python3 do I have to run something like `S{sage-python3} -t --python3 --long`, but not `--all`, to run the appropriate doctests?",
    "created_at": "2018-11-22T20:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372278",
    "user": "https://github.com/kiwifb"
}
```

I think that's a lofty goal but I have reservations until I understand how it impact and work with distro (like me). What happens when you
hit this section with python2?

```
@@ -690,6 +690,13 @@ class DocTestController(SageObject):
             Doctesting the Sage notebook.
             sage: DC.files[0][-6:]  # py2
             'sagenb'
+
+        ::
+
+            sage: DD = DocTestDefaults(python3 = True)
+            sage: DC = DocTestController(DD, [])
+            sage: DC.add_files()
+            Doctesting modules compatible with Python 3
         """
         opj = os.path.join
         from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_ROOT
```


As a distro with sage installed for python2 and python3 do I have to run something like `S{sage-python3} -t --python3 --long`, but not `--all`, to run the appropriate doctests?



---

archive/issue_comments_372279.json:
```json
{
    "body": "There is no reason for you to worry at all. It has no effect on the distro side, as far as I can tell.\n\nThis introduces a new option \"--python3\" when running the doctests. Maybe a better name would be \"--python3only\" or \"--python3-valid-modules-only\".\n\nThe only effect of using this option is to select a pre-defined list of modules whose doctests will be launched.\n\nIf you use the option with sage2, it will just test those files.\n\nIf you use this option with sage3, exactly the same.\n\nThe crop in your comment just doctests that this option exists and works. It does not launch the associated behaviour.\n\nThe goal of this ticket is to allow our release manager to have a builtbot that checks that no regression happens, namely that once a module is ok for python3, it will be checked to remain so.",
    "created_at": "2018-11-22T20:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372279",
    "user": "https://github.com/fchapoton"
}
```

There is no reason for you to worry at all. It has no effect on the distro side, as far as I can tell.

This introduces a new option "--python3" when running the doctests. Maybe a better name would be "--python3only" or "--python3-valid-modules-only".

The only effect of using this option is to select a pre-defined list of modules whose doctests will be launched.

If you use the option with sage2, it will just test those files.

If you use this option with sage3, exactly the same.

The crop in your comment just doctests that this option exists and works. It does not launch the associated behaviour.

The goal of this ticket is to allow our release manager to have a builtbot that checks that no regression happens, namely that once a module is ok for python3, it will be checked to remain so.



---

archive/issue_comments_372280.json:
```json
{
    "body": "Thank you for taking the time to answer. Just to be sure, I could run the test as I suggested on a distro to check for regression or problem with my distro regarding python3?",
    "created_at": "2018-11-22T20:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372280",
    "user": "https://github.com/kiwifb"
}
```

Thank you for taking the time to answer. Just to be sure, I could run the test as I suggested on a distro to check for regression or problem with my distro regarding python3?



---

archive/issue_comments_372281.json:
```json
{
    "body": "Right, if you provide sage3 on your distro, you could indeed use this option to check that all these tests do pass as they should.",
    "created_at": "2018-11-23T07:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372281",
    "user": "https://github.com/fchapoton"
}
```

Right, if you provide sage3 on your distro, you could indeed use this option to check that all these tests do pass as they should.



---

archive/issue_comments_372282.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-23T20:24:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372282",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372283.json:
```json
{
    "body": "I don't really see the point.  Just let them fail.  If regressions happen they will usually be small, and will be reduced over time.  Before long hopefully there will, or should, be none, in which case this will be a useless feature.\n\nWhat I think would be more useful, which is something I *have* wanted for other purposes as well, is a way to provide `./sage -t -a` a custom list of \"known failures\" which could be provided on a machine by machine basis (e.g. known failures for a specific platform being tested on).  This could be passed, for example, to any Python 3 builders if you wanted.  It would also be helpful to know when tests that are expected to fail start passing :)",
    "created_at": "2018-11-26T14:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372283",
    "user": "https://github.com/embray"
}
```

I don't really see the point.  Just let them fail.  If regressions happen they will usually be small, and will be reduced over time.  Before long hopefully there will, or should, be none, in which case this will be a useless feature.

What I think would be more useful, which is something I *have* wanted for other purposes as well, is a way to provide `./sage -t -a` a custom list of "known failures" which could be provided on a machine by machine basis (e.g. known failures for a specific platform being tested on).  This could be passed, for example, to any Python 3 builders if you wanted.  It would also be helpful to know when tests that are expected to fail start passing :)



---

archive/issue_comments_372284.json:
```json
{
    "body": "The point is to move the responsability of fixing the new failing doctests from me (or should I say us?) to the ticket owners..",
    "created_at": "2018-11-26T15:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372284",
    "user": "https://github.com/fchapoton"
}
```

The point is to move the responsability of fixing the new failing doctests from me (or should I say us?) to the ticket owners..



---

archive/issue_comments_372285.json:
```json
{
    "body": "I'm not opposed to that of course, but I think a more generic way to list known-failures or exclusions would be better.  This also obviates the need for a special make target since this can just be passed in the `TEST_OPTS` variable.",
    "created_at": "2018-11-26T15:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372285",
    "user": "https://github.com/embray"
}
```

I'm not opposed to that of course, but I think a more generic way to list known-failures or exclusions would be better.  This also obviates the need for a special make target since this can just be passed in the `TEST_OPTS` variable.



---

archive/issue_comments_372286.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-27T15:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372286",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372287.json:
```json
{
    "body": "Being able to pass in a list of known failures might be useful, feel free to open a ticket for that. Until then: The perfect is the enemy of the good.",
    "created_at": "2018-11-27T15:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372287",
    "user": "https://github.com/vbraun"
}
```

Being able to pass in a list of known failures might be useful, feel free to open a ticket for that. Until then: The perfect is the enemy of the good.



---

archive/issue_comments_372288.json:
```json
{
    "body": "I disagree--this can very easily be improved.  Just give me a day or two.",
    "created_at": "2018-11-27T16:05:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372288",
    "user": "https://github.com/embray"
}
```

I disagree--this can very easily be improved.  Just give me a day or two.



---

archive/issue_comments_372289.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-27T16:05:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372289",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_372290.json:
```json
{
    "body": "All that's required is to remove the \"python 3\" specific stuff, and change that option to be able to read a list of filenames/directories (possibly optionally from a file as well).  We could even add a file listing known Python 3 failures to the repository which I wouldn't mind, but it's silly to hard-code this when a few small changes can upgrade it to a more generally useful feature that won't just have to be ripped out later when it becomes obsolete.",
    "created_at": "2018-11-27T16:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372290",
    "user": "https://github.com/embray"
}
```

All that's required is to remove the "python 3" specific stuff, and change that option to be able to read a list of filenames/directories (possibly optionally from a file as well).  We could even add a file listing known Python 3 failures to the repository which I wouldn't mind, but it's silly to hard-code this when a few small changes can upgrade it to a more generally useful feature that won't just have to be ripped out later when it becomes obsolete.



---

archive/issue_comments_372291.json:
```json
{
    "body": "OK, you have 2 days. And make sure that the known python3 failures are in the repo so I don't have to manually maintain them on a dozen buildbots.",
    "created_at": "2018-11-27T16:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372291",
    "user": "https://github.com/vbraun"
}
```

OK, you have 2 days. And make sure that the known python3 failures are in the repo so I don't have to manually maintain them on a dozen buildbots.



---

archive/issue_comments_372292.json:
```json
{
    "body": "I mean, I don't know what you mean by \"a dozen buildbots\" as that's a setting that can just go in the builder settings for Python 3 builds, which is one place.  The builder settings have to be updated either way.  But I'm happy to maintain a list in the repo for now since they can be scratched off alongside changes that fix them.",
    "created_at": "2018-11-27T16:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372292",
    "user": "https://github.com/embray"
}
```

I mean, I don't know what you mean by "a dozen buildbots" as that's a setting that can just go in the builder settings for Python 3 builds, which is one place.  The builder settings have to be updated either way.  But I'm happy to maintain a list in the repo for now since they can be scratched off alongside changes that fix them.



---

archive/issue_comments_372293.json:
```json
{
    "body": "Thanks, looking forward to having a py3 buildbot...",
    "created_at": "2018-11-27T16:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372293",
    "user": "https://github.com/vbraun"
}
```

Thanks, looking forward to having a py3 buildbot...



---

archive/issue_comments_372294.json:
```json
{
    "body": "It occurs to me I initially misread the patch on this ticket--I thought the hard-coded `python3_files` was for some reason a list of known failures to *exclude*, but in fact it's a list of sub-packages that are known passing.  In which case this could have been done without adding anything to the doctest runner.  Rather, just put this list in a file or something and (as a compromise, for simplicity's sake) keep the separate makefile target and do the rough equivalent of `./sage -t --long $(cat list-of-known-passing.txt)`.\n\nHowever, I still think having the converse--an ability to list known failures--would be very useful in general.",
    "created_at": "2018-11-28T07:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372294",
    "user": "https://github.com/embray"
}
```

It occurs to me I initially misread the patch on this ticket--I thought the hard-coded `python3_files` was for some reason a list of known failures to *exclude*, but in fact it's a list of sub-packages that are known passing.  In which case this could have been done without adding anything to the doctest runner.  Rather, just put this list in a file or something and (as a compromise, for simplicity's sake) keep the separate makefile target and do the rough equivalent of `./sage -t --long $(cat list-of-known-passing.txt)`.

However, I still think having the converse--an ability to list known failures--would be very useful in general.



---

archive/issue_comments_372295.json:
```json
{
    "body": "Fr\u00e9d\u00e9ric, does your list of \"known passing\" include with flags like `--long`?  Or are we not worrying about that for now?  I'm just curious because I want to see about generating the converse list, of test modules with known failures.",
    "created_at": "2018-11-28T08:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372295",
    "user": "https://github.com/embray"
}
```

Frédéric, does your list of "known passing" include with flags like `--long`?  Or are we not worrying about that for now?  I'm just curious because I want to see about generating the converse list, of test modules with known failures.



---

archive/issue_comments_372296.json:
```json
{
    "body": "Attachment [small-log.txt](tarball://root/attachments/some-uuid/ticket26740/small-log.txt) by @fchapoton created at 2018-11-28 08:23:04",
    "created_at": "2018-11-28T08:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372296",
    "user": "https://github.com/fchapoton"
}
```

Attachment [small-log.txt](tarball://root/attachments/some-uuid/ticket26740/small-log.txt) by @fchapoton created at 2018-11-28 08:23:04



---

archive/issue_comments_372297.json:
```json
{
    "body": "I have attached the list of failing files in 8.5.b5. This is the result of a patchbot run, so it was done with \"--long\" but not using any other optional option.\n\n**EDIT**:\nThere is a script attached to #26212 that takes a patchbot log and extract useful information, including the list of failing modules.",
    "created_at": "2018-11-28T08:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372297",
    "user": "https://github.com/fchapoton"
}
```

I have attached the list of failing files in 8.5.b5. This is the result of a patchbot run, so it was done with "--long" but not using any other optional option.

**EDIT**:
There is a script attached to #26212 that takes a patchbot log and extract useful information, including the list of failing modules.



---

archive/issue_comments_372298.json:
```json
{
    "body": "Thanks.  Interestingly, I just ran the tests against current develop branch *without* `--long` and got 309 failing files: more than the log you attached.  Perhaps YMMV depending on your system, or the order in which the test were run.  Still, pretty good!  A lot of progress (~150 more passing) since I last tried.",
    "created_at": "2018-11-28T08:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372298",
    "user": "https://github.com/embray"
}
```

Thanks.  Interestingly, I just ran the tests against current develop branch *without* `--long` and got 309 failing files: more than the log you attached.  Perhaps YMMV depending on your system, or the order in which the test were run.  Still, pretty good!  A lot of progress (~150 more passing) since I last tried.



---

archive/issue_comments_372299.json:
```json
{
    "body": "Please see #26785 and its companion #26784.\n\nOne minor concern I have is that because this list of \"known failures\" is more fine-grained than the list of \"expected passes\" in this ticket, it could be a little more difficult to manage especially w.r.t. merge conflicts.  I would like to give it a try though.  Merge conflicts shouldn't be too much trouble since we want to mostly be removing lines from the file and never adding them.",
    "created_at": "2018-11-28T15:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372299",
    "user": "https://github.com/embray"
}
```

Please see #26785 and its companion #26784.

One minor concern I have is that because this list of "known failures" is more fine-grained than the list of "expected passes" in this ticket, it could be a little more difficult to manage especially w.r.t. merge conflicts.  I would like to give it a try though.  Merge conflicts shouldn't be too much trouble since we want to mostly be removing lines from the file and never adding them.



---

archive/issue_comments_372300.json:
```json
{
    "body": "I am not very happy (for the present task) with the idea that Erik proposed to store a list of failing files. And I dislike even more a list of failing files than a list of failing modules. My only aim here (yes it's scaffolding, but that is useful and can be removed once used) is to prevent regression by using this make target as a lock.\n\nStoring and testing a list of successful python-3 modules has two advantages : it needs much less maintenance work, as it will change less often. And we do not want to run for nothing the doctests that will be failing.\n\nMaybe other opinions would help to arbitrate (`@`jdemeyer, `@`fbissey). If somebody else review #26785 and #26784, I will certainly not object in any manner.",
    "created_at": "2018-12-03T13:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372300",
    "user": "https://github.com/fchapoton"
}
```

I am not very happy (for the present task) with the idea that Erik proposed to store a list of failing files. And I dislike even more a list of failing files than a list of failing modules. My only aim here (yes it's scaffolding, but that is useful and can be removed once used) is to prevent regression by using this make target as a lock.

Storing and testing a list of successful python-3 modules has two advantages : it needs much less maintenance work, as it will change less often. And we do not want to run for nothing the doctests that will be failing.

Maybe other opinions would help to arbitrate (`@`jdemeyer, `@`fbissey). If somebody else review #26785 and #26784, I will certainly not object in any manner.



---

archive/issue_comments_372301.json:
```json
{
    "body": "I don't really understand your point--this accomplishes the same purpose.  It's still effectively storing a list of \"successful\" modules in the form of the list of all tests, minus those that are known failures.\n\n> And we do not want to run for nothing the doctests that will be failing.\n\nIt's not for nothing: In fact it can inform you when some files' tests start passing e.g. due to something that was fixed.",
    "created_at": "2018-12-11T10:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372301",
    "user": "https://github.com/embray"
}
```

I don't really understand your point--this accomplishes the same purpose.  It's still effectively storing a list of "successful" modules in the form of the list of all tests, minus those that are known failures.

> And we do not want to run for nothing the doctests that will be failing.

It's not for nothing: In fact it can inform you when some files' tests start passing e.g. due to something that was fixed.



---

archive/issue_comments_372302.json:
```json
{
    "body": "I thought I made this point elsewhere, but should add your patch could be implemented as a file like `python3-known-passing.txt`:\n\n\n```\nsrc/sage/foo\nsrc/sage/bar\nsrc/sage/whatever\n...\n```\n\n\n\n```\n$ cat python3-known-passing.txt | xargs ./sage -t --long -p\n```\n\n\nNo need for special \"hacks\".",
    "created_at": "2018-12-11T10:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372302",
    "user": "https://github.com/embray"
}
```

I thought I made this point elsewhere, but should add your patch could be implemented as a file like `python3-known-passing.txt`:


```
src/sage/foo
src/sage/bar
src/sage/whatever
...
```



```
$ cat python3-known-passing.txt | xargs ./sage -t --long -p
```


No need for special "hacks".



---

archive/issue_comments_372303.json:
```json
{
    "body": "So how about turning your one-liner into a makefile target? Both positive and negative lists can be useful for different use cases...",
    "created_at": "2018-12-25T11:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372303",
    "user": "https://github.com/vbraun"
}
```

So how about turning your one-liner into a makefile target? Both positive and negative lists can be useful for different use cases...



---

archive/issue_comments_372304.json:
```json
{
    "body": "another tentative, as suggested by Erik\n----\nNew commits:",
    "created_at": "2019-01-16T16:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372304",
    "user": "https://github.com/fchapoton"
}
```

another tentative, as suggested by Erik
----
New commits:



---

archive/issue_comments_372305.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-16T16:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372305",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372306.json:
```json
{
    "body": "ok, ready for review",
    "created_at": "2019-01-16T16:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372306",
    "user": "https://github.com/fchapoton"
}
```

ok, ready for review



---

archive/issue_comments_372307.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-16T16:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372307",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372308.json:
```json
{
    "body": "Why is `python3-known-passing.txt` one long line? Isn't the whole point of `xargs` to support a file with one filename per line?",
    "created_at": "2019-01-16T16:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372308",
    "user": "https://github.com/jdemeyer"
}
```

Why is `python3-known-passing.txt` one long line? Isn't the whole point of `xargs` to support a file with one filename per line?



---

archive/issue_comments_372309.json:
```json
{
    "body": "Because this is the (only) way I managed to get it work. If you feel able to do better, please help!",
    "created_at": "2019-01-16T16:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372309",
    "user": "https://github.com/fchapoton"
}
```

Because this is the (only) way I managed to get it work. If you feel able to do better, please help!



---

archive/issue_comments_372310.json:
```json
{
    "body": "it turns out that one can split the lines, coming soon",
    "created_at": "2019-01-16T16:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372310",
    "user": "https://github.com/fchapoton"
}
```

it turns out that one can split the lines, coming soon



---

archive/issue_comments_372311.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-16T16:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372311",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_372312.json:
```json
{
    "body": "done. Better like that ?",
    "created_at": "2019-01-16T17:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372312",
    "user": "https://github.com/fchapoton"
}
```

done. Better like that ?



---

archive/issue_comments_372313.json:
```json
{
    "body": "Just to avoid top-level file proliferation, can this .txt file go in `misc/` or something?",
    "created_at": "2019-01-16T17:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372313",
    "user": "https://github.com/embray"
}
```

Just to avoid top-level file proliferation, can this .txt file go in `misc/` or something?



---

archive/issue_comments_372314.json:
```json
{
    "body": "Just tell me where exactly I should put that and I will do so..",
    "created_at": "2019-01-16T19:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372314",
    "user": "https://github.com/fchapoton"
}
```

Just tell me where exactly I should put that and I will do so..



---

archive/issue_comments_372315.json:
```json
{
    "body": "Maybe create a file in `src/ext/doctest/`?",
    "created_at": "2019-01-16T19:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372315",
    "user": "https://github.com/jhpalmieri"
}
```

Maybe create a file in `src/ext/doctest/`?



---

archive/issue_comments_372316.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-16T19:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372316",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372317.json:
```json
{
    "body": "done, thanks",
    "created_at": "2019-01-16T19:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372317",
    "user": "https://github.com/fchapoton"
}
```

done, thanks



---

archive/issue_comments_372318.json:
```json
{
    "body": "This works well on my usual python3-test machine, where the selected passing doctests are known to pass since many months. Before putting it on a buildbot, could other people please launch the new make target on python3-sage installations on various machines ? We need to see if some failures happen in these modules in other architectures and os.",
    "created_at": "2019-01-17T10:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372318",
    "user": "https://github.com/fchapoton"
}
```

This works well on my usual python3-test machine, where the selected passing doctests are known to pass since many months. Before putting it on a buildbot, could other people please launch the new make target on python3-sage installations on various machines ? We need to see if some failures happen in these modules in other architectures and os.



---

archive/issue_comments_372319.json:
```json
{
    "body": "It worked for me on OS X. On some future ticket, we should add a `ptestlong` option.",
    "created_at": "2019-01-17T16:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372319",
    "user": "https://github.com/jhpalmieri"
}
```

It worked for me on OS X. On some future ticket, we should add a `ptestlong` option.



---

archive/issue_comments_372320.json:
```json
{
    "body": "Thanks John. Anybody else ? Maybe we can consider that this is ready for positive review ? Volker, what do you think ?",
    "created_at": "2019-01-18T09:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372320",
    "user": "https://github.com/fchapoton"
}
```

Thanks John. Anybody else ? Maybe we can consider that this is ready for positive review ? Volker, what do you think ?



---

archive/issue_comments_372321.json:
```json
{
    "body": "I literally just meant adding a top-level directory called `misc/`, but either way.",
    "created_at": "2019-01-18T12:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372321",
    "user": "https://github.com/embray"
}
```

I literally just meant adding a top-level directory called `misc/`, but either way.



---

archive/issue_comments_372322.json:
```json
{
    "body": "would you please try it on Cygwin ?",
    "created_at": "2019-01-18T12:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372322",
    "user": "https://github.com/fchapoton"
}
```

would you please try it on Cygwin ?



---

archive/issue_comments_372323.json:
```json
{
    "body": "I would but my Windows machine is currently occupied building the Sage 8.6 release.  I'm not sure it's really needed though: There's nothing very special about Python 2 vs Python 3 on Cygwin that I'm aware of as it pertains to Sage.",
    "created_at": "2019-01-18T13:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372323",
    "user": "https://github.com/embray"
}
```

I would but my Windows machine is currently occupied building the Sage 8.6 release.  I'm not sure it's really needed though: There's nothing very special about Python 2 vs Python 3 on Cygwin that I'm aware of as it pertains to Sage.



---

archive/issue_comments_372324.json:
```json
{
    "body": "I can test on `ppc64le`",
    "created_at": "2019-01-18T14:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372324",
    "user": "https://github.com/jdemeyer"
}
```

I can test on `ppc64le`



---

archive/issue_comments_372325.json:
```json
{
    "body": "On `Linux sardonis 4.4.0-141-generic #167-Ubuntu SMP Wed Dec 5 10:33:00 UTC 2018 ppc64le ppc64le ppc64le GNU/Linux`:\n\n```\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 367.5 seconds\n    cpu time: 4433.2 seconds\n    cumulative wall time: 4408.9 seconds\n```\n",
    "created_at": "2019-01-18T14:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372325",
    "user": "https://github.com/jdemeyer"
}
```

On `Linux sardonis 4.4.0-141-generic #167-Ubuntu SMP Wed Dec 5 10:33:00 UTC 2018 ppc64le ppc64le ppc64le GNU/Linux`:

```
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 367.5 seconds
    cpu time: 4433.2 seconds
    cumulative wall time: 4408.9 seconds
```




---

archive/issue_comments_372326.json:
```json
{
    "body": "Thanks. Would somebody be brave enough to set a positive review ?",
    "created_at": "2019-01-18T15:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372326",
    "user": "https://github.com/fchapoton"
}
```

Thanks. Would somebody be brave enough to set a positive review ?



---

archive/issue_comments_372327.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-18T16:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372327",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_024630.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-01-24T18:17:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26503#event-24630"
}
```



---

archive/issue_comments_372328.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-24T18:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26503#issuecomment-372328",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
