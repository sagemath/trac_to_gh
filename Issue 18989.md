# Issue 18989: some  (collinearity graphs of) GQ(q-1,q+1)

Issue created by migration from https://trac.sagemath.org/ticket/19226

Original creator: dimpase

Original creation time: 2015-09-17 03:59:05

CC:  ncohen

For SRG database, we need these. This ticket implements AS(q) (q odd prime power) and T_2*(O)  constructions of GQ(q-1,q+1).


---

Comment by dimpase created at 2015-09-17 06:53:28

the GQs basically done (few things to check still, but it's basically there)
----
Last 10 new commits:


---

Comment by git created at 2015-09-17 21:44:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-18 00:11:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-18 00:12:25

should't be hard to review, given the new beta.


---

Comment by dimpase created at 2015-09-18 00:12:25

Changing status from new to needs_review.


---

Comment by ncohen created at 2015-09-18 12:51:28

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2015-09-18 12:51:28

Hello Dima,

Here is a first-pass review.

- `coordinates`: why not a boolean? Its default value is `None`, and you did not
  mention its type in the documentation.

- Docstrings of the two new classes: we usually describe what exactly the
  function builds before the input section.

- Could you add a link toward the wikipedia page on generalized quadrangles? I
  do not believe that we have a definition of that in Sage yet.

- The value of `check` arguments is usually `True`.

- As we usually disable checks when calling those functions internally (we only
  check whatever is returned to the user), you may be a bit less careful when
  you check that the hyperoval is indeed an hyperoval, e.g.:
  `Pi.trace(O).is_uniform(2)` or something (I did not check exactly yet).

- `checkhyperoval` -> `check_hyperoval`

- why do you name `O` the hyperoval, given that you have a `hyperoval` variable?
  Use that second name instead?!

Nathann


---

Comment by git created at 2015-09-21 21:18:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-21 21:21:48

Replying to [comment:6 ncohen]:
> Here is a first-pass review.
> 
> - `coordinates`: why not a boolean? Its default value is `None`, and you did not
>   mention its type in the documentation.
done (see last commit)

> 
> - Docstrings of the two new classes: we usually describe what exactly the
>   function builds before the input section.
done
> 
> - Could you add a link toward the wikipedia page on generalized quadrangles? I
>   do not believe that we have a definition of that in Sage yet.
done

> 
> - The value of `check` arguments is usually `True`.
done

> 
> - As we usually disable checks when calling those functions internally (we only
>   check whatever is returned to the user), you may be a bit less careful when
>   you check that the hyperoval is indeed an hyperoval, e.g.:
>   `Pi.trace(O).is_uniform(2)` or something (I did not check exactly yet).
I added a condition so that the check is only done on user's input.

> 
> - `checkhyperoval` -> `check_hyperoval`
done.

> 
> - why do you name `O` the hyperoval, given that you have a `hyperoval` variable?
>   Use that second name instead?!

I don't like to mess around with values of parameters, and then O is shorter too; well, if you insist I can change this...


---

Comment by ncohen created at 2015-09-21 22:16:44

Just wondered about something troublesome. Why are these graph constructors? You say explicitly that you build an incidence structure then its colinearity graph. Shouldn't they be hypergraph constructors instead?

Nathann


---

Comment by ncohen created at 2015-09-21 22:49:52

Dima,

- Documentation of `AhrensSzekeresGQ` -- the first line seems to miss
  backticks. Also, please write complete sentence in english and not 'of GQ
  AS(q)'.

- Same function: you "define" q in the second line of the paragraph while you
  use it in the first.

- Could you rewrite the lines in "set notation", i.e. {{{* `(\sigma, a, b),
  \sigma\in F_q`}}} -> `* `\{(\sigma, a, b): \sigma\in F_q\}``?. It would be
  easier to understand.

- Documentation of `T2starGQ` -- also needs some backticks.

- Same function: `q` should also be defined at the beginning of the paragraph.

- All graph constructors end in 'Graph'. Except the the ones you added recently,
  I missed that `:-/`

- Please do not use GQ anywhere which is not a mathematical notation,
  e.g. neither in paragraphs of documentation nor in the constructor's name. As
  far as I know it is a global Sage convention to write everything expanded as
  much as possible.

- What is the point of the `hyperoval` argument that lets the user specify one?
  It makes the code more complicated, and you do not seem to use it yourself. If
  you remove it, I guess that `check_hyperoval` can be removed too.

- In `is_GQqmqp`: instead of having a 'if' inside of the 'if', could you compute
  q *before* the first if (using `//` instead of `/`) so that you can call
  `is_prime` directly?

- Same function: you don't need to filter which function you should
  import. Import both, there is no time to save there, only added code
  complexity.

- in `ProjectiveGeometryDesign`: could you change the default of
  `point_coordinates`?

01:00 am. Good night `T_T`

Nathann

P.S.: the most troublesome is probably the question above about hypergraph
constructors. Note that there is a (pretty empty) `hypergraphs.<tab>` thing if
you don't consider them to be designs.


---

Comment by dimpase created at 2015-09-21 22:55:27

Replying to [comment:9 ncohen]:
> Just wondered about something troublesome. Why are these graph constructors? You say explicitly that you build an incidence structure then its colinearity graph. Shouldn't they be hypergraph constructors instead?

this equally applies to most graphs in generators/classical_geometries.
(they are polar spaces, as I told you long ago: cf
http://trac.sagemath.org/ticket/14532#comment:17 and later comments there; GQs are
polar spaces too, and projective spaces are polar spaces, by the way)

(and probably to more "sporadic" graphs...)

so this is a massive rewrite, and not much fun...


---

Comment by ncohen created at 2015-09-21 22:56:49

> so this is a massive rewrite, and not much fun...

Okay. Let's forget about it for the moment.


---

Comment by git created at 2015-09-22 06:11:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-22 06:22:28

Replying to [comment:10 ncohen]:
> Dima,
> 
> - Documentation of `AhrensSzekeresGQ` -- the first line seems to miss
>   backticks. Also, please write complete sentence in english and not 'of GQ
>   AS(q)'.
> 
> - Same function: you "define" q in the second line of the paragraph while you
>   use it in the first.
> 
> - Could you rewrite the lines in "set notation", i.e. {{{* `(\sigma, a, b),
>   \sigma\in F_q`}}} -> `* `\{(\sigma, a, b): \sigma\in F_q\}``?. It would be
>   easier to understand.
> 
> - Documentation of `T2starGQ` -- also needs some backticks.
> 
> - Same function: `q` should also be defined at the beginning of the paragraph.

right, all the above is fixed in the last commit.

> 
> - All graph constructors end in 'Graph'. Except the the ones you added recently,
>   I missed that `:-/`lah

well, isn't it high time to realise that `graphs.BlahBLahGraph` is an abomination, for stuff in `graphs.*` is meant to be a graph after all...
 
> 
> - Please do not use GQ anywhere which is not a mathematical notation,
>   e.g. neither in paragraphs of documentation nor in the constructor's name. As
>   far as I know it is a global Sage convention to write everything expanded as
>   much as possible.
> 
> - What is the point of the `hyperoval` argument that lets the user specify one?
>   It makes the code more complicated, and you do not seem to use it yourself. If
>   you remove it, I guess that `check_hyperoval` can be removed too.g 

well, `T_2^*(q)` is in fact `T_2^*(O)`, so I'm following the standard definition.
And there is a sizable cottage industry of hyperoval production out there, so it's good to have things ready for them.

> 
> - In `is_GQqmqp`: instead of having a 'if' inside of the 'if', could you compute
>   q *before* the first if (using `//` instead of `/`) so that you can call
>   `is_prime` directly?

Why? I think it's clean the way it is written. In 99% of the cases we don't even reach the 2nd if.

> 
> - Same function: you don't need to filter which function you should
>   import. Import both, there is no time to save there, only added code
>   complexity. 

I do not just import, I set up a function `F` to be called.
This is why I do it this way...

> 
> - in `ProjectiveGeometryDesign`: could you change the default of
>   `point_coordinates`?

would it make things less efficient?


---

Comment by ncohen created at 2015-09-22 08:33:28

Hello,

> well, isn't it high time to realise that `graphs.BlahBLahGraph` is an abomination, for stuff in `graphs.*` is meant to be a graph after all...

It is an abomination, but that's the current standard in `graphs.<tab>`. It is still more sensible to have everything end in `Graph` than a different standard for each function. And, indeed, this standard is awful.

> well, `T_2^*(q)` is in fact `T_2^*(O)`, so I'm following the standard definition.

I do not understand this sentence, and I do not understand to what you answer.

> And there is a sizable cottage industry of hyperoval production out there, so it's good to have things ready for them.

Okay.. I'll trust you for that.

> Why? I think it's clean the way it is written. In 99% of the cases we don't even reach the 2nd if.

All you lose is a division per 2. You won't feel it, and the code will be ligther.

> > - in `ProjectiveGeometryDesign`: could you change the default of
> >   `point_coordinates`?
> 
> would it make things less efficient?

If you can measure the difference I owe you a beer.

Nathann


---

Comment by git created at 2015-09-22 17:45:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-22 17:59:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-22 18:01:23

Replying to [comment:15 ncohen]:
> > well, isn't it high time to realise that `graphs.BlahBLahGraph` is an abomination, for stuff in `graphs.*` is meant to be a graph after all...
> 
> It is an abomination, but that's the current standard in `graphs.<tab>`. It is still more sensible to have everything end in `Graph` than a different standard for each function. And, indeed, this standard is awful.

Is this mere a lament? Or a request to change names of functions on this ticket? Or a proposal to change the standard?
> 
> > well, `T_2^*(q)` is in fact `T_2^*(O)`, so I'm following the standard definition.
> 
> I do not understand this sentence, and I do not understand to what you answer.

in the literature people write about `T_2^*(O)`, with O a hyperoval in a plane in PG(3,q).

> 
> > And there is a sizable cottage industry of hyperoval production out there, so it's good to have things ready for them.
> 
> Okay.. I'll trust you for that.
> 
> > Why? I think it's clean the way it is written. In 99% of the cases we don't even reach the 2nd if.
> 
> All you lose is a division per 2. You won't feel it, and the code will be ligther.
> 
OK, done

> > > - in `ProjectiveGeometryDesign`: could you change the default of
> > >   `point_coordinates`?
> > 
> > would it make things less efficient?

OK, changed.
----
New commits:


---

Comment by ncohen created at 2015-09-22 21:02:29

> Is this mere a lament? Or a request to change names of functions on this ticket? Or a proposal to change the standard?

All of it. Please update your functions.

> in the literature people write about `T_2^*(O)`, with O a hyperoval in a plane in PG(3,q).

Oh, I see. I was reading 0 instead of O.

Nathann


---

Comment by git created at 2015-09-23 05:33:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-23 05:34:23

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2015-09-23 05:34:23

Replying to [comment:19 ncohen]:
> > Is this mere a lament? Or a request to change names of functions on this ticket? Or a proposal to change the standard?
> 
> All of it. Please update your functions.
done.


---

Comment by ncohen created at 2015-09-23 08:03:26

In [comment:10]:

> Please do not use GQ anywhere which is not a mathematical notation, e.g. neither in 
> paragraphs of documentation nor in the constructor's name.

Also,


```
+    if hyperoval is None:
+        O = filter(lambda x: x[1]+x[2]*x[3]==0 or (x[1]==1 and x[2]==0 and x[3]==0), Pi)
+        O = set(O)
+    else:
+        map(lambda x: x.set_immutable(), hyperoval)
+        O = set(hyperoval)
+
+    if check_hyperoval and (not hyperoval is None):
```


I read:


```
if A:
   ...
else:
   ...
if (not A):
   ...
```


Could you change it into:


```
if hyperoval is None:
   ...
else:
   ...
   if check_hyperoval:
      ...
```


Then it should be good to go,

Nathann


---

Comment by ncohen created at 2015-09-23 08:03:36

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-09-23 15:04:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-09-23 15:07:15

Despite what the commit message says, it does not replace GQ by more appropriate things.

Nathann


---

Comment by dimpase created at 2015-09-23 15:09:44

Replying to [comment:22 ncohen]:
> In [comment:10]:
> 
> > Please do not use GQ anywhere which is not a mathematical notation, e.g. neither in 
> > paragraphs of documentation nor in the constructor's name.

While GQ is as acceptable abbreviation as LP, and LP is used a lot in Sage code and docs, I realise that I should have been more careful there, sorry...


> 
> Also,
> 
> {{{
> +    if hyperoval is None:
> +        O = filter(lambda x: x[1]+x[2]*x[3]==0 or (x[1]==1 and x[2]==0 and x[3]==0), Pi)
> +        O = set(O)
> +    else:
> +        map(lambda x: x.set_immutable(), hyperoval)
> +        O = set(hyperoval)
> +
> +    if check_hyperoval and (not hyperoval is None):
> }}}
> 
> I read:
> 
> {{{
> if A:
>    ...
> else:
>    ...
> if (not A):
>    ...
> }}}
> 
> Could you change it into:

done
----
New commits:


---

Comment by dimpase created at 2015-09-23 15:09:44

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2015-09-23 15:17:57

> While GQ is as acceptable abbreviation as LP, and LP is used a lot in Sage code and docs, I realise that I should have been more careful there, sorry...

Update the LP doc to replace it by `Linear Programming` if you think that it is necessary. I've been studying graph theory for the last 7 years or so and I wouldn't recognize GQ if I was told that "This graph is a GQ".

Can't say the same for "This problem has a LP formulation".

Update those functions. It costs you nothing, and it will help people who look for those graphs.

Nathann


---

Comment by ncohen created at 2015-09-23 15:19:02

*Especially* when the name of your constructor is the pretty obscure `T2starGQGraph`.


---

Comment by ncohen created at 2015-09-23 15:32:35

I don't mind doing it if you are tired by this ticket.


---

Comment by dimpase created at 2015-09-23 16:18:45

Replying to [comment:27 ncohen]:
> > While GQ is as acceptable abbreviation as LP, and LP is used a lot in Sage code and docs, I realise that I should have been more careful there, sorry...
> 
> Update the LP doc to replace it by `Linear Programming` if you think that it is necessary. 

Why? I am totally happy with LP, and GQ, as well.

>I've been studying graph theory for the last 7 years or so and I wouldn't recognize GQ if I was told that "This graph is a GQ".

If a user did not hear about generelised quadrangles then having is spelled out fully in the function name makes no difference for the user. If the user did hear about them then it's very likely that the abbreviated form was also used, and is thus meaningful.

No, sorry, I'm not going to name anything `BlahBlahCollinearityGraphOfGeneralisedQuadrangleGraph`.


---

Comment by ncohen created at 2015-09-23 16:26:55

I just posted to sage-devel to ask for the general policy. We'll do what they say.

Let us pray that they have some consistent opinion.

And please don't join the thread to explain why it makes no sense in this specific ticket.

Nathann


---

Comment by git created at 2015-09-23 17:49:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-24 19:14:25

I can add a function `graphs.GeneralizedQuadrangleGraph(s,t)` which will produce an example for each set `(s,t)` of parameters for which existence is known, if it would help you with naming issue...


---

Comment by ncohen created at 2015-09-25 09:09:20

Having this function is a good idea, but to me it's orthogonal to the naming issue. It seems that 90% of those who commented the sage-devel thread stand for the full name.

Nathann


---

Comment by dimpase created at 2015-09-25 16:28:29

Replying to [comment:34 ncohen]:
> Having this function is a good idea, but to me it's orthogonal to the naming issue. It seems that 90% of those who commented the sage-devel thread stand for the full name.

As I write this, these brave abbreviation fighters must be busily working on a large number of tickets removing all the abbreviations from Sage function names... Perhaps you should join them, it's by far more important than this ticket. Death to all abbreviation in Sage, Victory or Death!


---

Comment by git created at 2015-09-25 18:59:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-25 19:02:21

it's all now named according to what majority wants...


---

Comment by ncohen created at 2015-09-26 12:00:32

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2015-09-26 12:00:32

> it's all now named according to what majority wants...

Thank you. I hope that will help others as it would have helped me.

Nathann


---

Comment by ncohen created at 2015-09-26 12:00:57

And thank you for the graphs too, of course. We are below 100 SRGs left `;-)`


---

Comment by vbraun created at 2015-10-11 16:56:44

Doctest fails. Guys, which part of the failing patchbot report was unclear to you?


---

Comment by vbraun created at 2015-10-11 16:57:11

Changing status from positive_review to needs_work.


---

Comment by ncohen created at 2015-10-11 16:59:18

> Doctest fails. Guys, which part of the failing patchbot report was unclear to you?

I don't have a clue how what is done here could have the slightest effect in `simplicial_complex.pyx`. And as you know, sometimes, patchbot output nonsense.

Nathann


---

Comment by ncohen created at 2015-10-11 17:01:00

Err.. Okay, it's related `:-D`


---

Comment by ncohen created at 2015-10-11 17:03:46

Changing status from needs_work to positive_review.


---

Comment by ncohen created at 2015-10-11 17:03:46

New commits:


---

Comment by vbraun created at 2015-10-12 22:53:00

Resolution: fixed
