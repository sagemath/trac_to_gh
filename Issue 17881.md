# Issue 17881: transducer: convenience option for process words iterativly (and showing output)

Issue created by migration from Trac.

Original creator: dkrenn

Original creation time: 2015-04-03 08:11:41

CC:  cheuberg skropf

Keywords: sd66

This ticket introduces a new option so that `iter_processs` gives the output of a transducer (when processing a word) step by step. If the transducer branches (non-deterministic transducer), an exception is raised.

This is in contrast to the existing implementation, where the full output (including information on all branches of the process) is given back in each step during iteration.

An example:

```
sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
....:     initial_states=['A'], final_states=['A'])
sage: it = inverter.iter_process(
....:     words.FibonacciWord(), iterator_type='simple')
sage: from itertools import islice
sage: [o for o in islice(it, 0, 5)]  # only output the first 5 letters
[1, 0, 1, 1, 0]
```



---

Comment by dkrenn created at 2015-04-03 08:14:56

New commits:


---

Comment by dkrenn created at 2015-04-03 08:14:56

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-04-03 08:29:05

Even better example

```
sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
....:                initial_states=['A'], final_states=['A'])
sage: it = inverter.iter_process(
....: words.FibonacciWord(), iterator_type='simple')
sage: u = Words([0,1])(it)
sage: u
word: 1011010110110101101011011010110110101101...
```



---

Comment by git created at 2015-04-03 08:36:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-03 08:37:45

Replying to [comment:4 vdelecroix]:
> Even better example
> {{{
> sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
> ....:                initial_states=['A'], final_states=['A'])
> sage: it = inverter.iter_process(
> ....: words.FibonacciWord(), iterator_type='simple')
> sage: u = Words([0,1])(it)
> sage: u
> word: 1011010110110101101011011010110110101101...
> }}}

Included. Thanks.


---

Comment by vdelecroix created at 2015-04-03 08:47:20

Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works

```
sage: W = Words([0,1])
sage: inverter.process(W([0,1,0])
word: 101
sage: inverter.process(words.FibonacciWord([0,1]))
word: 1011010110110101101011011010110110101101...
```


What do you think?

Vincent


---

Comment by dkrenn created at 2015-04-03 19:23:16

Replying to [comment:7 vdelecroix]:
> Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works
> {{{
> sage: W = Words([0,1])
> sage: inverter.process(W([0,1,0])
> word: 101
> sage: inverter.process(words.FibonacciWord([0,1]))
> word: 1011010110110101101011011010110110101101...
> }}}
> 
> What do you think?

Would be nice to have, but takes some effort (not sure if possible with the infinite (lazy) words). This is now #18123.

Daniel


---

Comment by git created at 2015-04-17 08:19:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2015-04-17 08:29:04

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2015-04-17 08:29:04

* Added two minor commits, please cross-review
* The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?
* IMHO, there should be doctests for all error conditions in `_iter_process_simple_`
* I do not understand the code of `_iter_process_simple_`:
  - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?
  - why do you reset `outputs[0] = []` at the end? 

  Could you please add comments on that?
* Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.


---

Comment by dkrenn created at 2015-09-09 09:25:55

Replying to [comment:11 cheuberg]:
> * Added two minor commits, please cross-review

Done....ok.

> * The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?
> * IMHO, there should be doctests for all error conditions in `_iter_process_simple_`
> * I do not understand the code of `_iter_process_simple_`:
>   - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?
>   - why do you reset `outputs[0] = []` at the end? 
> 
>   Could you please add comments on that?
> * Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.

Addressed all these comments in the new commits.
----
New commits:


---

Comment by dkrenn created at 2015-09-09 09:25:55

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2015-09-13 12:58:36

I added two commits, please cross-review them and set to `positive_review`.
----
New commits:


---

Comment by dkrenn created at 2015-09-14 07:27:54

Changing status from needs_review to positive_review.


---

Comment by cheuberg created at 2015-09-14 14:03:49

the commit field did not update, so I add a comment to do so.
----
New commits:


---

Comment by vbraun created at 2015-09-15 07:52:27

Resolution: fixed
