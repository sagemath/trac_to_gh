# Issue 17881: transducer: convenience option for process words iterativly (and showing output)

archive/issues_017881.json:
```json
{
    "body": "CC:  @cheuberg skropf\n\nKeywords: sd66\n\nThis ticket introduces a new option so that `iter_processs` gives the output of a transducer (when processing a word) step by step. If the transducer branches (non-deterministic transducer), an exception is raised.\n\nThis is in contrast to the existing implementation, where the full output (including information on all branches of the process) is given back in each step during iteration.\n\nAn example:\n\n```\nsage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},\n....:     initial_states=['A'], final_states=['A'])\nsage: it = inverter.iter_process(\n....:     words.FibonacciWord(), iterator_type='simple')\nsage: from itertools import islice\nsage: [o for o in islice(it, 0, 5)]  # only output the first 5 letters\n[1, 0, 1, 1, 0]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18118\n\n",
    "created_at": "2015-04-03T08:11:41Z",
    "labels": [
        "component: finite state machines"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "transducer: convenience option for process words iterativly (and showing output)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17881",
    "user": "https://github.com/dkrenn"
}
```
CC:  @cheuberg skropf

Keywords: sd66

This ticket introduces a new option so that `iter_processs` gives the output of a transducer (when processing a word) step by step. If the transducer branches (non-deterministic transducer), an exception is raised.

This is in contrast to the existing implementation, where the full output (including information on all branches of the process) is given back in each step during iteration.

An example:

```
sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
....:     initial_states=['A'], final_states=['A'])
sage: it = inverter.iter_process(
....:     words.FibonacciWord(), iterator_type='simple')
sage: from itertools import islice
sage: [o for o in islice(it, 0, 5)]  # only output the first 5 letters
[1, 0, 1, 1, 0]
```


Issue created by migration from https://trac.sagemath.org/ticket/18118





---

archive/issue_comments_239607.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-03T08:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239607",
    "user": "https://github.com/dkrenn"
}
```

New commits:



---

archive/issue_comments_239608.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-03T08:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239608",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_239609.json:
```json
{
    "body": "Even better example\n\n```\nsage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},\n....:                initial_states=['A'], final_states=['A'])\nsage: it = inverter.iter_process(\n....: words.FibonacciWord(), iterator_type='simple')\nsage: u = Words([0,1])(it)\nsage: u\nword: 1011010110110101101011011010110110101101...\n```\n",
    "created_at": "2015-04-03T08:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239609",
    "user": "https://github.com/videlec"
}
```

Even better example

```
sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
....:                initial_states=['A'], final_states=['A'])
sage: it = inverter.iter_process(
....: words.FibonacciWord(), iterator_type='simple')
sage: u = Words([0,1])(it)
sage: u
word: 1011010110110101101011011010110110101101...
```




---

archive/issue_comments_239610.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-03T08:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_239611.json:
```json
{
    "body": "Replying to [comment:4 vdelecroix]:\n> Even better example\n> {{{\n> sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},\n> ....:                initial_states=['A'], final_states=['A'])\n> sage: it = inverter.iter_process(\n> ....: words.FibonacciWord(), iterator_type='simple')\n> sage: u = Words([0,1])(it)\n> sage: u\n> word: 1011010110110101101011011010110110101101...\n> }}}\n\nIncluded. Thanks.",
    "created_at": "2015-04-03T08:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239611",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:4 vdelecroix]:
> Even better example
> {{{
> sage: inverter = Transducer({'A': [('A', 0, 1), ('A', 1, 0)]},
> ....:                initial_states=['A'], final_states=['A'])
> sage: it = inverter.iter_process(
> ....: words.FibonacciWord(), iterator_type='simple')
> sage: u = Words([0,1])(it)
> sage: u
> word: 1011010110110101101011011010110110101101...
> }}}

Included. Thanks.



---

archive/issue_comments_239612.json:
```json
{
    "body": "Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works\n\n```\nsage: W = Words([0,1])\nsage: inverter.process(W([0,1,0])\nword: 101\nsage: inverter.process(words.FibonacciWord([0,1]))\nword: 1011010110110101101011011010110110101101...\n```\n\n\nWhat do you think?\n\nVincent",
    "created_at": "2015-04-03T08:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239612",
    "user": "https://github.com/videlec"
}
```

Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works

```
sage: W = Words([0,1])
sage: inverter.process(W([0,1,0])
word: 101
sage: inverter.process(words.FibonacciWord([0,1]))
word: 1011010110110101101011011010110110101101...
```


What do you think?

Vincent



---

archive/issue_comments_239613.json:
```json
{
    "body": "Replying to [comment:7 vdelecroix]:\n> Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works\n> {{{\n> sage: W = Words([0,1])\n> sage: inverter.process(W([0,1,0])\n> word: 101\n> sage: inverter.process(words.FibonacciWord([0,1]))\n> word: 1011010110110101101011011010110110101101...\n> }}}\n> \n> What do you think?\n\nWould be nice to have, but takes some effort (not sure if possible with the infinite (lazy) words). This is now #18123.\n\nDaniel",
    "created_at": "2015-04-03T19:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239613",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:7 vdelecroix]:
> Couldn't we do better? I tried to use `inverter.process` directly, but sadly it does not return only a word. My dream would be that the following just works
> {{{
> sage: W = Words([0,1])
> sage: inverter.process(W([0,1,0])
> word: 101
> sage: inverter.process(words.FibonacciWord([0,1]))
> word: 1011010110110101101011011010110110101101...
> }}}
> 
> What do you think?

Would be nice to have, but takes some effort (not sure if possible with the infinite (lazy) words). This is now #18123.

Daniel



---

archive/issue_comments_239614.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T08:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239614",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_239615.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-17T08:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239615",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239616.json:
```json
{
    "body": "* Added two minor commits, please cross-review\n* The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?\n* IMHO, there should be doctests for all error conditions in `_iter_process_simple_`\n* I do not understand the code of `_iter_process_simple_`:\n  - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?\n  - why do you reset `outputs[0] = []` at the end? \n\n  Could you please add comments on that?\n* Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.",
    "created_at": "2015-04-17T08:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239616",
    "user": "https://github.com/cheuberg"
}
```

* Added two minor commits, please cross-review
* The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?
* IMHO, there should be doctests for all error conditions in `_iter_process_simple_`
* I do not understand the code of `_iter_process_simple_`:
  - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?
  - why do you reset `outputs[0] = []` at the end? 

  Could you please add comments on that?
* Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.



---

archive/issue_comments_239617.json:
```json
{
    "body": "Replying to [comment:11 cheuberg]:\n> * Added two minor commits, please cross-review\n\nDone....ok.\n\n> * The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?\n> * IMHO, there should be doctests for all error conditions in `_iter_process_simple_`\n> * I do not understand the code of `_iter_process_simple_`:\n>   - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?\n>   - why do you reset `outputs[0] = []` at the end? \n> \n>   Could you please add comments on that?\n> * Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.\n\nAddressed all these comments in the new commits.\n----\nNew commits:",
    "created_at": "2015-09-09T09:25:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239617",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:11 cheuberg]:
> * Added two minor commits, please cross-review

Done....ok.

> * The description of `iter_process` does not explain why a user would want to have a simple iterator. Could you elaborate and/or provide an illustrating example (for simplicity, for finite input instead of an infinite word) on how the standard and the simple iterator differ?
> * IMHO, there should be doctests for all error conditions in `_iter_process_simple_`
> * I do not understand the code of `_iter_process_simple_`:
>   - why do you need to set `output = outputs[0]` and iterate over `output` instead of `outputs[0]`?
>   - why do you reset `outputs[0] = []` at the end? 
> 
>   Could you please add comments on that?
> * Please add a `SEE ALSO` block for `_iter_process_simple_` even if it does not currently show up in the reference manual.

Addressed all these comments in the new commits.
----
New commits:



---

archive/issue_comments_239618.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-09T09:25:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239618",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239619.json:
```json
{
    "body": "I added two commits, please cross-review them and set to `positive_review`.\n----\nNew commits:",
    "created_at": "2015-09-13T12:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239619",
    "user": "https://github.com/cheuberg"
}
```

I added two commits, please cross-review them and set to `positive_review`.
----
New commits:



---

archive/issue_comments_239620.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-14T07:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239620",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_239621.json:
```json
{
    "body": "the commit field did not update, so I add a comment to do so.\n----\nNew commits:",
    "created_at": "2015-09-14T14:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239621",
    "user": "https://github.com/cheuberg"
}
```

the commit field did not update, so I add a comment to do so.
----
New commits:



---

archive/issue_comments_239622.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-09-15T07:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17881#issuecomment-239622",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
