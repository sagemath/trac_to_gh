# Issue 30367: fix scipy for XCode 12

Issue created by migration from https://trac.sagemath.org/ticket/30604

Original creator: dimpase

Original creation time: 2020-09-18 20:08:09

CC:  mkoeppe jhpalmieri




---

Comment by dimpase created at 2020-09-18 20:19:40

upstream already have some of these fixes in master, but not all.
----
New commits:


---

Comment by dimpase created at 2020-09-18 20:19:40

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-09-18 21:05:57

PR for the upstream master branch: https://github.com/scipy/scipy/pull/12864


---

Comment by jhpalmieri created at 2020-09-18 21:25:28

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2020-09-18 21:25:28

The changes look sensible, I don't imagine them causing breakage on other platforms, and `scipy` now builds for me with Xcode 12.


---

Comment by mkoeppe created at 2020-09-19 14:41:48

Changing priority from major to blocker.


---

Comment by dimpase created at 2020-09-20 14:20:03

our PR is accepted upstream.

Do you know if Sage's scipy passed its tests on macOS before ?
It does not in this configuration.


---

Comment by jhpalmieri created at 2020-09-20 16:48:06

It seems that [when I checked a year ago](https://groups.google.com/d/msg/sage-devel/abysgIIVGZI/fF7efL9RAwAJ), it did pass its test suite.


---

Comment by jhpalmieri created at 2020-09-20 17:22:57

Actually, sorry, I misunderstood. I don't know if I've ever run scipy's tests: I typically only run tests using the spkg-check files in Sage (via SAGE_CHECK=yes), and scipy doesn't have one of those. So I didn't run its tests a year ago.


---

Comment by dimpase created at 2020-09-20 18:24:06

One can fire up Python and do

```
>>> import scipy
>>> scipy.test()
```

for a relatively short testsuite.
(It requires `pytest` installed).


---

Comment by jhpalmieri created at 2020-09-20 18:30:09

I don't have any machine with Xcode 11 to test with, unfortunately.


---

Comment by @zlscherr created at 2020-09-20 20:33:30

I also don't have Xcode 11 any more, but my systemwide scipy on Mac and ubuntu both have similar numbers:

Ubuntu 20.04:

============================ 25461 passed, 2015 skipped, 10989 deselected, 75 xfailed, 7 xpassed, 10 warnings in 459.37s (0:07:39) =============================

Mac 10.15, Xcode 12

============================ 25497 passed, 1980 skipped, 10989 deselected, 75 xfailed, 6 xpassed, 10 warnings in 398.20s (0:06:38) =============================


---

Attachment

failure report


---

Comment by @DaveWitteMorris created at 2020-09-20 20:39:31

In case it's any help: I ran `scipy.test()` inside sage (or, at least, I think that's what I did) and I seemed to get only one failure.  It seems to be in `test_hyperu_around_0` in `test_mpmath.py`. (The failure report from the end of the run is attached as scipy-test-failure.txt.)  This is sage 9.2b12 on Mac OS 10.15.6. I think my XCode version is 11.0.


---

Comment by dimpase created at 2020-09-20 21:32:03

That Xcode 12 update raises the question whether the clang-12 - compiled code meant to be compatible with the clang-11 - compiled code, in particular C++ might be an issue.


---

Comment by vbraun created at 2020-09-23 21:28:07

Resolution: fixed
