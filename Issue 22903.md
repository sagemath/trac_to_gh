# Issue 22903: Gauss-Legendre Integrator

Issue created by migration from https://trac.sagemath.org/ticket/23140

Original creator: sasha.zotine

Original creation time: 2017-06-05 20:41:15

Keywords: Gauss-Legendre Integration

This code implements a method for doing Gauss-Legendre integration on a fast-callable polynomial. Designed with multi-precision in mind.


---

Comment by sasha.zotine created at 2017-06-06 20:09:32

Changing keywords from "Gauss-Legendre Integration" to "Gauss-Legendre Integration sd86.5".


---

Comment by sasha.zotine created at 2017-06-06 20:09:32

New commits:


---

Comment by git created at 2017-06-07 04:56:46

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-06-07 05:02:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by nbruin created at 2017-06-07 05:11:30

Ready for review. Code is basically a translation of what is in mpmath. See for instance

[https://github.com/fredrik-johansson/mpmath/blob/master/mpmath/calculus/quadrature.py#L203](https://github.com/fredrik-johansson/mpmath/blob/master/mpmath/calculus/quadrature.py#L203)

for comparison.

(most computations are straightforward. It's particularly the error estimator that is tricky, and that is basically copied literally; modulo some log-base changes)


---

Comment by git created at 2017-06-07 05:16:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nbruin created at 2017-06-07 05:18:57

Changing status from new to needs_review.


---

Comment by nbruin created at 2017-06-07 05:18:57

For documentation completeness, here is an issue tracker for an issue concerning log bases in the error estimation routine: [https://github.com/fredrik-johansson/mpmath/pull/329](https://github.com/fredrik-johansson/mpmath/pull/329)


---

Comment by nbruin created at 2017-06-07 05:18:57

Changing priority from minor to major.


---

Comment by jdemeyer created at 2017-06-07 07:54:50

Minor comments:

1. In Cython, you can use the libc math library instead of the Python math library. It suffices to replace `import math` by `cimport libc.math as math`.

2. To ensure Python 3 compatibility, use `from __future__ import absolute_import, division, print_function`.

3. Keep in mind PEP 8 which says that assignments should have spaces: replace `Rout=RealField(prec)` by `Rout = RealField(prec)`.


---

Comment by jdemeyer created at 2017-06-07 07:57:29

4. You use `cdef int` in various places. Only do this when you know that the variable must always be small. If there any tiny chance that this will ever be larger than `2^31`, use `cdef long` or some other type instead. Even if you cannot support Gauss-Legendre integration in "degree" `>= 31` now, there is no reason to a priori assume that it will never be needed.

5. In documentation, use `^` instead of `**`.

(*) I find "degree" a confusing name. Is this standard in Gauss­–Legendre integration theory? I would expect the degree to be one less than the number of nodes.


---

Comment by git created at 2017-06-07 14:08:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by nbruin created at 2017-06-07 14:10:53

(Pushed an amended branch because git had filled in a bogus author. cocalc projects and git mix badly)


---

Comment by nbruin created at 2017-06-07 14:46:44

Replying to [comment:9 jdemeyer]:
Replying to [comment:8 jdemeyer]:
> Minor comments:
> 
> 1. In Cython, you can use the libc math library instead of the Python math library. It suffices to replace `import math` by `cimport libc.math as math`.

I tried and it generated errors for me (it got confused with complex numbers in a way that python's math doesn't). It's only used in a non-critical part (computing the initial value for newton iteration), so it doesn't need to be fast. The python library seems to work fine. 

> 2. To ensure Python 3 compatibility, use `from __future__ import absolute_import, division, print_function`.

Thanks

> 3. Keep in mind PEP 8 which says that assignments should have spaces: replace `Rout=RealField(prec)` by `Rout = RealField(prec)`.

Done

> 4. You use `cdef int` in various places. Only do this when you know that the variable must always be small. If there any tiny chance that this will ever be larger than `2^31`, use `cdef long` or some other type instead. Even if you cannot support Gauss-Legendre integration in "degree" `>= 31` now, there is no reason to a priori assume that it will never be needed.

Good point.

> 5. In documentation, use `^` instead of `**`.

Good point
 
> (*) I find "degree" a confusing name. Is this standard in Gauss­–Legendre integration theory? I would expect the degree to be one less than the number of nodes.

Frederic uses it in mpmath. He scales the parameter so that an increase roughly doubles the precision. I agree, though: it's much easier to document if you just give the degree of the legendre polynomials. It would be nice to use this routine as a drop-in replacement in sage's mpmath too.


---

Comment by git created at 2017-06-07 14:48:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aly.deines created at 2017-06-07 22:38:45

If you really really wanted to you could clean up a tiny bit to meet all PEP 8 standards, but nothing else needs work or to be changed.


---

Comment by aly.deines created at 2017-06-07 22:38:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-11 09:13:24

Resolution: fixed


---

Comment by slelievre created at 2020-10-02 12:38:01

Follow-up at #30698 to add this to the documentation.

I don't see it in the built documentation, web search engines
don't find "Gauss-Legendre" at doc.sagemath.org, and `search_doc`
gives nothing for "Gauss-Legendre" or "gauss_legendre".

If you know how to do that, please post a branch at #30698.
Otherwise I'll look into it.
