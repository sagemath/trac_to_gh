# Issue 34134: support factoring polynomials modulo prime powers

Issue created by migration from https://trac.sagemath.org/ticket/34371

Original creator: lorenz

Original creation time: 2022-08-15 19:55:31

Currently, `Polynomial_zmod_flint` refuses to factor polynomials modulo composites, which is generally not well-defined. However, we can easily make this work modulo prime powers (where it _is_ well-defined) by reusing the implementation for polynomials over p‑adics. This is almost certainly not the fastest way of doing it, but at least it _works_.


---

Comment by lorenz created at 2022-08-15 19:55:41

Changing status from new to needs_review.


---

Comment by tscrim created at 2022-08-16 06:03:39

It probably would be too much trouble to separate out the algorithm into a separate function rather than converting the elements by changing the base ring. If it is actually simple, then please do so. Otherwise, green bot => positive review.


---

Comment by lorenz created at 2022-08-16 16:46:15

The implementation for `ℤₚ[x]` relies on PARI, whereas the implementation of `(ℤ/n)[x]` is based on FLINT. I suppose we could inline the PARI conversion and call PARI without explicitly changing to `ℤₚ`, but that's already much more effort than this and I'm not sure how much it would actually help (it saves some Python overhead, but the conversion is still needed).

Personally I'd argue that this is an easy way to make something work that didn't work previously, and we can improve the performance later if it turns out to be a problem.


---

Comment by tscrim created at 2022-08-16 23:57:36

Replying to [comment:3 lorenz]:
> The implementation for `ℤₚ[x]` relies on PARI, whereas the implementation of `(ℤ/n)[x]` is based on FLINT. I suppose we could inline the PARI conversion and call PARI without explicitly changing to `ℤₚ`, but that's already much more effort than this and I'm not sure how much it would actually help (it saves some Python overhead, but the conversion is still needed).

It also means you get an additional transient object that takes up time and memory, which could matter if the polynomial is "big". However...

> Personally I'd argue that this is an easy way to make something work that didn't work previously, and we can improve the performance later if it turns out to be a problem.

I agree fully. Only to be done if it was clearly easy.


---

Comment by tscrim created at 2022-08-16 23:57:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-08-30 19:05:22

Resolution: fixed
