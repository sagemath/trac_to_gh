# Issue 11623: Support environment variables for different viewers (e.g. PNG, DVI, PDF)

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2011-09-13 11:45:06

Assignee: was

CC:  kcrisman

Keywords: plot browser

Currently, all viewers default to `$SAGE_BROWSER` if it is set, `$BROWSER` or some other system-specific defaults (like `xdg-open`, if present) otherwise.

We should IMHO also support environment variables for what is currently

 * `sage.misc.viewer.DVI_VIEWER`,
 * `sage.misc.viewer.PDF_VIEWER`, and
 * `sage.misc.viewer.PNG_VIEWER`.


---

Comment by jhpalmieri created at 2011-09-13 20:48:31

Oh, good, more environment variables.  ;)


---

Comment by jhpalmieri created at 2011-09-13 22:21:44

On further thought, I think this is a bad idea. These variables are only used within Sage, so rather than environment variables, they should be set in `.sage/init.sage`.  I'm attaching a patch (which needs work: no doctests and not really tested at all), which allows for this sort of behavior:

```
# init.sage file
from sage.misc.viewer import viewer
viewer.pdf_viewer('open -a /Applications/Adobe\ Reader.app')
```

Then if `a` is some Sage object, this opens up Adobe Reader on my Mac:

```
view(a, pdflatex=True)
```

(The attached patch also fixes a few bugs in latex.py so that this actually works.)

Opinions about using init.sage instead of environment variables?


---

Comment by jhpalmieri created at 2011-11-30 04:14:14

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2011-11-30 04:14:14

Okay, this has doctests and is ready for review.


---

Comment by ncohen created at 2012-12-16 19:02:30

Just rebased the patch on 5.5.rc0


---

Comment by ncohen created at 2012-12-16 19:18:08

Changing status from needs_review to needs_work.


---

Attachment

ellooooooooooooo John !!

Thank you very much for this patch ! I had actually begun to write a (much worse) version of it, then noticed you had already done the job ! I joined a patch adding unimportant details to yours, and there's one question keeping me from giving a positive review to your patch immediately : why isn't `_viewer_prefs` just a dictionary ?

This should get in quickly `:-)`

Nathann


---

Comment by ncohen created at 2012-12-16 19:19:04

Changing status from needs_work to needs_info.


---

Attachment


---

Comment by jhpalmieri created at 2012-12-16 19:40:05

Changing status from needs_info to needs_review.


---

Comment by jhpalmieri created at 2012-12-16 19:40:05

I don't know why `_viewer_prefs` is not just a dictionary. Maybe that class used to do more things in some prehistoric version of the patch? Anyway, I changed it so it's just a dictionary now.


---

Comment by ncohen created at 2012-12-16 19:49:57

Well, then...

Thank you again ! `:-)`

Nathann

Apply trac_11795.v2.patch, trac_11795-rev.patch


---

Comment by ncohen created at 2012-12-16 19:49:57

Changing status from needs_review to positive_review.


---

Comment by minshall created at 2012-12-19 02:08:45

hi.  fwiw, i downloaded an applied these two patches on my macosx 10.8 system (using fink).  i added the following to my init.sage:

```python
from sage.misc.viewer import viewer
viewer.browser('/sw/bin/w3m')
viewer.dvi_viewer('/sw/bin/xdvi')
viewer.pdf_viewer('/sw/bin/xpdf')
viewer.png_viewer('/sw/bin/display')
```

and ran simple tests.  everything worked just fine.  (i had a separate issue with error reporting for non-existent viewers, but i don't think that's in the scope of this patch.)

*i* would also like the ability to get plot3d to use other than jmol.  i suspect that's also out of scope for this patch.  so, i'm basically happy.  cheers.


---

Comment by ncohen created at 2012-12-19 08:39:04

Helloooooooooooo !!

Well, as this one has been reviewed and fixes something already let's not disturb it. This being said, if you create a ticket to fix your problem do add me as a Cc, if I understand it the review will be fast `:-)`

Nathann


---

Comment by minshall created at 2012-12-19 11:31:17

hello, back.

okay.  i've added #13842 (give an error or warning if user specified program does not exist) and #13843 (allow configuration of 3D plot program).

i wasn't sure of who to add as CCs, etc.  i'm happy to be educated in the way of the sage...

cheers.


---

Comment by ncohen created at 2012-12-19 12:46:37

Hellooooooooooo !!!

Well, you can add as a CC whoever may feel involved by the patch. Like me, as I reviewed this, or John (who did all the smart work). This being said, it is very likely that these tickets will remain open for a while unless you write a patch yourself and want it to be reviewed `:-)`

Nathann


---

Comment by jdemeyer created at 2012-12-21 09:31:03

Resolution: fixed
