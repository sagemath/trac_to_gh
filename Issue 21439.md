# Issue 21439: Upate NTL to 10.0.0

archive/issues_021439.json:
```json
{
    "body": "CC:  leif fbissey jdemeyer vbraun\n\nUse repackaged tarball at:\n* http://perso.telecom-paristech.fr/~flori/ntl-10.0.0.tar.bz2\n\n(Original upstream tarball at:\n* http://www.shoup.net/ntl/ntl-10.0.0.tar.gz\n)\n\nIssue created by migration from https://trac.sagemath.org/ticket/21676\n\n",
    "created_at": "2016-10-10T09:57:23Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "title": "Upate NTL to 10.0.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21439",
    "user": "jpflori"
}
```
CC:  leif fbissey jdemeyer vbraun

Use repackaged tarball at:
* http://perso.telecom-paristech.fr/~flori/ntl-10.0.0.tar.bz2

(Original upstream tarball at:
* http://www.shoup.net/ntl/ntl-10.0.0.tar.gz
)

Issue created by migration from https://trac.sagemath.org/ticket/21676





---

archive/issue_comments_297567.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-10T09:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297567",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_297568.json:
```json
{
    "body": "You want me to modify this to use the new version (which shouldn't need repacking)?\nOr would someone consider to first include this version for which the modifications are much more trivial?",
    "created_at": "2016-10-17T14:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297568",
    "user": "jpflori"
}
```

You want me to modify this to use the new version (which shouldn't need repacking)?
Or would someone consider to first include this version for which the modifications are much more trivial?



---

archive/issue_comments_297569.json:
```json
{
    "body": "I would say use the new version (at the risk of volunteering to review), since that is what we are going to have to eventually anyways.",
    "created_at": "2016-10-17T15:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297569",
    "user": "tscrim"
}
```

I would say use the new version (at the risk of volunteering to review), since that is what we are going to have to eventually anyways.



---

archive/issue_comments_297570.json:
```json
{
    "body": "Definitely new version. That's what I am targeting for Gentoo. I have one last issue with testing that I need to sort out but it shouldn't have an effect on sage since sage does test \"backwards\" (testing after install rather than before).",
    "created_at": "2016-10-17T20:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297570",
    "user": "fbissey"
}
```

Definitely new version. That's what I am targeting for Gentoo. I have one last issue with testing that I need to sort out but it shouldn't have an effect on sage since sage does test "backwards" (testing after install rather than before).



---

archive/issue_comments_297571.json:
```json
{
    "body": "Replying to [comment:4 fbissey]:\n> Definitely new version. That's what I am targeting for Gentoo. I have one last issue with testing that I need to sort out but it shouldn't have an effect on sage since sage does test \"backwards\" (testing after install rather than before).\n\nVictor is good, not obvious to find but he does run tests with the appropriate `LD_LIBRARY_PATH` on linux at least.",
    "created_at": "2016-10-17T21:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297571",
    "user": "fbissey"
}
```

Replying to [comment:4 fbissey]:
> Definitely new version. That's what I am targeting for Gentoo. I have one last issue with testing that I need to sort out but it shouldn't have an effect on sage since sage does test "backwards" (testing after install rather than before).

Victor is good, not obvious to find but he does run tests with the appropriate `LD_LIBRARY_PATH` on linux at least.



---

archive/issue_comments_297572.json:
```json
{
    "body": "Any of you have seen that while compiling singular 4? \n\n```\nNTLconvert.cc: In function \u2018CanonicalForm convertZZ2CF(const NTL::ZZ&)\u2019:\nNTLconvert.cc:509:38: error: invalid static_cast from type \u2018const raw_ptr {aka _ntl_gbigint_body* const}\u2019 to type \u2018long int*\u2019\n       static_cast<long *>( a.rep.rep ); // what about NTL7?\n```\n\n\nIt happens with and without the \"nothrow\" patch to `ntl`. Did I miss a patch to singular?",
    "created_at": "2016-10-18T01:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297572",
    "user": "fbissey"
}
```

Any of you have seen that while compiling singular 4? 

```
NTLconvert.cc: In function ‘CanonicalForm convertZZ2CF(const NTL::ZZ&)’:
NTLconvert.cc:509:38: error: invalid static_cast from type ‘const raw_ptr {aka _ntl_gbigint_body* const}’ to type ‘long int*’
       static_cast<long *>( a.rep.rep ); // what about NTL7?
```


It happens with and without the "nothrow" patch to `ntl`. Did I miss a patch to singular?



---

archive/issue_comments_297573.json:
```json
{
    "body": "It vaguely reminds me of issues btw NTL and Singular 3 with template instantiation when we updated NTL to the first version using templates (rather than macros).",
    "created_at": "2016-10-18T06:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297573",
    "user": "jpflori"
}
```

It vaguely reminds me of issues btw NTL and Singular 3 with template instantiation when we updated NTL to the first version using templates (rather than macros).



---

archive/issue_comments_297574.json:
```json
{
    "body": "That was at #16882 from:\n* #16882#comment:29\n* http://git.sagemath.org/sage.git/commit/?id=071b2546b17df057f4ac157b096b9ee0fc33e2e5\nThough you can see at #16882#comment:97 and following comment that at that point I had no trouble building Singular 4.",
    "created_at": "2016-10-18T06:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297574",
    "user": "jpflori"
}
```

That was at #16882 from:
* #16882#comment:29
* http://git.sagemath.org/sage.git/commit/?id=071b2546b17df057f4ac157b096b9ee0fc33e2e5
Though you can see at #16882#comment:97 and following comment that at that point I had no trouble building Singular 4.



---

archive/issue_comments_297575.json:
```json
{
    "body": "We had a chat with Victor on sage-devel I see you have seen it by now. So Victor changed something in ntl that triggers this particular error (and presumably it would also be present in singular 3). Because it is an undocumented/internal interface singular gets the failure they deserve.",
    "created_at": "2016-10-18T06:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297575",
    "user": "fbissey"
}
```

We had a chat with Victor on sage-devel I see you have seen it by now. So Victor changed something in ntl that triggers this particular error (and presumably it would also be present in singular 3). Because it is an undocumented/internal interface singular gets the failure they deserve.



---

archive/issue_comments_297576.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-18T13:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297576",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_297577.json:
```json
{
    "body": "I did some experiments, starting with upgrading `singular` to 4.0.3p4 (without touching `ntl`)  on top of 7.5.beta0, since it contains the fix for `ntl` 10+. The plan was to change one thing at a time. You would think that it being just a patch level, it would be straightforward. Well so much for that\n\n```\nsage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/graded_ring_element.py  # 52 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 29 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/readme.py  # 10 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py  # 9 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/curves/projective_curve.py  # 15 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py  # 70 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/abstract_ring.py  # 7 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/tests/french_book/mpoly.py  # 14 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py  # 6 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/interfaces/singular.py  # 2 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/matrix/matrix_sparse.pyx  # 3 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/curves/affine_curve.py  # 15 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/algebras/commutative_dga.py  # 366 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/algebras/free_algebra.py  # 10 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # 2 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/plural.pyx  # 367 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx  # 22 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/projective/projective_space.py  # 4 doctests failed\nsage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/groebner_strategy.pyx  # 40 doctests failed\n```\n\nThat one is ok\n\n```\nsage -t --long /usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\n**********************************************************************\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1088, in sage.interfaces.singular.Singular.set_ring\nFailed example:\n    singular.current_ring()\nExpected:\n    polynomial ring, over a field, local/mixed ordering\n    //   characteristic : 7\n    //   number of vars : 2\n    //        block   1 : ordering ds\n    //                  : names    a b\n    //        block   2 : ordering C\nGot:\n    polynomial ring, over a field, local ordering\n    //   characteristic : 7\n    //   number of vars : 2\n    //        block   1 : ordering ds\n    //                  : names    a b\n    //        block   2 : ordering C\n**********************************************************************\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1997, in sage.interfaces.singular.SingularElement.set_ring\nFailed example:\n    singular.current_ring()\nExpected:\n    polynomial ring, over a field, local/mixed ordering\n    //   characteristic : 7\n    //   number of vars : 2\n    //        block   1 : ordering ds\n    //                  : names    a b\n    //        block   2 : ordering C\nGot:\n    polynomial ring, over a field, local ordering\n    //   characteristic : 7\n    //   number of vars : 2\n    //        block   1 : ordering ds\n    //                  : names    a b\n    //        block   2 : ordering C\n**********************************************************************\n2 items had failures:\n   1 of   6 in sage.interfaces.singular.Singular.set_ring\n   1 of   6 in sage.interfaces.singular.SingularElement.set_ring\n```\n\nBut a lot of problem seem to go back to `libs/singular/function.pyx`\n\n```\nsage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx\n**********************************************************************\nFile \"/usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx\", line 307, in sage.libs.singular.function.Resolution.__init__\nFailed example:\n    resolution = mres(M, 0)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 501, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 864, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.libs.singular.function.Resolution.__init__[6]>\", line 1, in <module>\n        resolution = mres(M, Integer(0))\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9$\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1500, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-pyth$\n        with opt_ctx: # we are preserving the global options state here\n      File \"sage/libs/singular/function.pyx\", line 1502, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-pyth$\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 108, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1448)\n    SignalError: Segmentation fault\n**********************************************************************\n```\n\nAnd more in the same style that go to the `with opt_ctx: # we are preserving the global options state here` line before segfaulting. There are a few other original one but fixing the above would considerably reduce the number of failure all over the place.\n\nIdeas?",
    "created_at": "2016-10-22T22:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297577",
    "user": "fbissey"
}
```

I did some experiments, starting with upgrading `singular` to 4.0.3p4 (without touching `ntl`)  on top of 7.5.beta0, since it contains the fix for `ntl` 10+. The plan was to change one thing at a time. You would think that it being just a patch level, it would be straightforward. Well so much for that

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/graded_ring_element.py  # 52 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 29 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/readme.py  # 10 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py  # 9 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/curves/projective_curve.py  # 15 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py  # 70 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/modular/modform_hecketriangle/abstract_ring.py  # 7 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/tests/french_book/mpoly.py  # 14 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py  # 6 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/interfaces/singular.py  # 2 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/matrix/matrix_sparse.pyx  # 3 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/curves/affine_curve.py  # 15 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/algebras/commutative_dga.py  # 366 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/algebras/free_algebra.py  # 10 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/geometry/polyhedron/palp_database.py  # 1 doctest failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # 2 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/rings/polynomial/plural.pyx  # 367 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx  # 22 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/projective/projective_space.py  # 4 doctests failed
sage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/groebner_strategy.pyx  # 40 doctests failed
```

That one is ok

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/interfaces/singular.py
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1088, in sage.interfaces.singular.Singular.set_ring
Failed example:
    singular.current_ring()
Expected:
    polynomial ring, over a field, local/mixed ordering
    //   characteristic : 7
    //   number of vars : 2
    //        block   1 : ordering ds
    //                  : names    a b
    //        block   2 : ordering C
Got:
    polynomial ring, over a field, local ordering
    //   characteristic : 7
    //   number of vars : 2
    //        block   1 : ordering ds
    //                  : names    a b
    //        block   2 : ordering C
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1997, in sage.interfaces.singular.SingularElement.set_ring
Failed example:
    singular.current_ring()
Expected:
    polynomial ring, over a field, local/mixed ordering
    //   characteristic : 7
    //   number of vars : 2
    //        block   1 : ordering ds
    //                  : names    a b
    //        block   2 : ordering C
Got:
    polynomial ring, over a field, local ordering
    //   characteristic : 7
    //   number of vars : 2
    //        block   1 : ordering ds
    //                  : names    a b
    //        block   2 : ordering C
**********************************************************************
2 items had failures:
   1 of   6 in sage.interfaces.singular.Singular.set_ring
   1 of   6 in sage.interfaces.singular.SingularElement.set_ring
```

But a lot of problem seem to go back to `libs/singular/function.pyx`

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/libs/singular/function.pyx", line 307, in sage.libs.singular.function.Resolution.__init__
Failed example:
    resolution = mres(M, 0)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 501, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 864, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.singular.function.Resolution.__init__[6]>", line 1, in <module>
        resolution = mres(M, Integer(0))
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9$
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1500, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-pyth$
        with opt_ctx: # we are preserving the global options state here
      File "sage/libs/singular/function.pyx", line 1502, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-pyth$
        sig_on()
      File "src/cysignals/signals.pyx", line 108, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1448)
    SignalError: Segmentation fault
**********************************************************************
```

And more in the same style that go to the `with opt_ctx: # we are preserving the global options state here` line before segfaulting. There are a few other original one but fixing the above would considerably reduce the number of failure all over the place.

Ideas?



---

archive/issue_comments_297578.json:
```json
{
    "body": "No ideas... I'll have to try the new upstream tarball.",
    "created_at": "2016-10-24T11:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297578",
    "user": "jpflori"
}
```

No ideas... I'll have to try the new upstream tarball.



---

archive/issue_comments_297579.json:
```json
{
    "body": "See #21631.",
    "created_at": "2016-10-24T13:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297579",
    "user": "jpflori"
}
```

See #21631.



---

archive/issue_comments_297580.json:
```json
{
    "body": "Adding https://github.com/Singular/Sources/commit/861b7899904e3bbe3e8fe49fc0dd11ef9f5f238e to singular 4.0.3p4, I was able to compile sage-on-gentoo with ntl-10.1.0. A doc test run didn't reveal any failures from ntl.\nSince we are now supporting C++11 should we enable threads in ntl (this requires C++11)?",
    "created_at": "2016-10-31T07:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297580",
    "user": "fbissey"
}
```

Adding https://github.com/Singular/Sources/commit/861b7899904e3bbe3e8fe49fc0dd11ef9f5f238e to singular 4.0.3p4, I was able to compile sage-on-gentoo with ntl-10.1.0. A doc test run didn't reveal any failures from ntl.
Since we are now supporting C++11 should we enable threads in ntl (this requires C++11)?



---

archive/issue_comments_297581.json:
```json
{
    "body": "Am I understanding you correctly that we require a C++11 compiler? If so, then I think we should enable threads. If it is something we check at configure-time, then I would say we should extend that to NTL as well.",
    "created_at": "2016-10-31T14:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297581",
    "user": "tscrim"
}
```

Am I understanding you correctly that we require a C++11 compiler? If so, then I think we should enable threads. If it is something we check at configure-time, then I would say we should extend that to NTL as well.



---

archive/issue_comments_297582.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-31T15:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297582",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_297583.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-31T16:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297583",
    "user": "jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_297584.json:
```json
{
    "body": "Update to 10.1.0. The upstream tarball is no longer repackaged.\nI merged #21631, that was surely unnecessary, but it's done.\n\nEnabling threads vould wait for another ticket?\nOr do we really think it will caue no problems?",
    "created_at": "2016-10-31T16:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297584",
    "user": "jpflori"
}
```

Update to 10.1.0. The upstream tarball is no longer repackaged.
I merged #21631, that was surely unnecessary, but it's done.

Enabling threads vould wait for another ticket?
Or do we really think it will caue no problems?



---

archive/issue_comments_297585.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-31T16:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297585",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_297586.json:
```json
{
    "body": "I wouldn't think threads would create much problems in themselves. The main problem is that all ntl dependencies needs to use a c++11 compiler. It may actually deserve another ticket because we may have to touch the sage library itself on a few key files and that's better done separately.\nThe other possible trouble is increased random failures in parallel doctesting because the machine is over-subscribed.",
    "created_at": "2016-10-31T19:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297586",
    "user": "fbissey"
}
```

I wouldn't think threads would create much problems in themselves. The main problem is that all ntl dependencies needs to use a c++11 compiler. It may actually deserve another ticket because we may have to touch the sage library itself on a few key files and that's better done separately.
The other possible trouble is increased random failures in parallel doctesting because the machine is over-subscribed.



---

archive/issue_comments_297587.json:
```json
{
    "body": "I would just try it and see what breaks. If it works, then we can include it in; if it requires significant work, then we cut that off as the starting point for a new ticket.\n\nI can't say anything about possible increased random failures.",
    "created_at": "2016-10-31T23:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297587",
    "user": "tscrim"
}
```

I would just try it and see what breaks. If it works, then we can include it in; if it requires significant work, then we cut that off as the starting point for a new ticket.

I can't say anything about possible increased random failures.



---

archive/issue_comments_297588.json:
```json
{
    "body": "OK making an attempt.",
    "created_at": "2016-11-01T00:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297588",
    "user": "fbissey"
}
```

OK making an attempt.



---

archive/issue_comments_297589.json:
```json
{
    "body": "`flint` doesn't default to c++11 for its `ntl` interface. That can easily be fixed at the spkg-install level. But by default it fails. Forgot about `flint`.",
    "created_at": "2016-11-01T00:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297589",
    "user": "fbissey"
}
```

`flint` doesn't default to c++11 for its `ntl` interface. That can easily be fixed at the spkg-install level. But by default it fails. Forgot about `flint`.



---

archive/issue_comments_297590.json:
```json
{
    "body": "OK, anything that includes `ntlwrap.h` needs to have a `-std=c++11` flag added to it. Let's save that for later.",
    "created_at": "2016-11-01T02:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297590",
    "user": "fbissey"
}
```

OK, anything that includes `ntlwrap.h` needs to have a `-std=c++11` flag added to it. Let's save that for later.



---

archive/issue_comments_297591.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-01T08:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297591",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_297592.json:
```json
{
    "body": "I should have put positive review earlier, lgtm :)",
    "created_at": "2016-11-01T08:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297592",
    "user": "fbissey"
}
```

I should have put positive review earlier, lgtm :)



---

archive/issue_comments_297593.json:
```json
{
    "body": "\n```\n[ntl-10.1.0] Running the test suite for ntl-10.1.0...\n[ntl-10.1.0] ./spkg-check: line 3: cd: src/ntl/src: No such file or directory\n```\n",
    "created_at": "2016-11-03T23:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297593",
    "user": "vbraun"
}
```


```
[ntl-10.1.0] Running the test suite for ntl-10.1.0...
[ntl-10.1.0] ./spkg-check: line 3: cd: src/ntl/src: No such file or directory
```




---

archive/issue_comments_297594.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-11-03T23:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297594",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_297595.json:
```json
{
    "body": "Embarrassing... From what I can see in `spkg-install` `src/ntl/src` should be replaced by `src/src`.",
    "created_at": "2016-11-04T07:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297595",
    "user": "fbissey"
}
```

Embarrassing... From what I can see in `spkg-install` `src/ntl/src` should be replaced by `src/src`.



---

archive/issue_comments_297596.json:
```json
{
    "body": "4.0.3p5 is out and has the ntl patch do we move along while fixing the tests?",
    "created_at": "2016-11-07T02:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297596",
    "user": "fbissey"
}
```

4.0.3p5 is out and has the ntl patch do we move along while fixing the tests?



---

archive/issue_comments_297597.json:
```json
{
    "body": "Wrong ticket...",
    "created_at": "2016-11-07T02:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297597",
    "user": "fbissey"
}
```

Wrong ticket...



---

archive/issue_comments_297598.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-07T10:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297598",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_297599.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-11-07T10:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297599",
    "user": "jpflori"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_297600.json:
```json
{
    "body": "Trivial change, I put this back to positive review.\nSorry for missing that change before.",
    "created_at": "2016-11-07T10:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297600",
    "user": "jpflori"
}
```

Trivial change, I put this back to positive review.
Sorry for missing that change before.



---

archive/issue_comments_297601.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-08T23:42:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21439#issuecomment-297601",
    "user": "vbraun"
}
```

Resolution: fixed
