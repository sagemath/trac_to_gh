# Issue 17025: Update to gcc 4.9.2

archive/issues_017025.json:
```json
{
    "body": "CC:  @kiwifb jpflori\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/17262\n\n",
    "created_at": "2014-10-30T15:27:25Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Update to gcc 4.9.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17025",
    "user": "@vbraun"
}
```
CC:  @kiwifb jpflori



Issue created by migration from https://trac.sagemath.org/ticket/17262





---

archive/issue_comments_226364.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-10-30T15:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226364",
    "user": "@vbraun"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_226365.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2014-10-30T15:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226365",
    "user": "@vbraun"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_226366.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-10-30T17:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226366",
    "user": "@vbraun"
}
```

New commits:



---

archive/issue_comments_226367.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-30T17:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226367",
    "user": "@vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_226368.json:
```json
{
    "body": "On two OS X systems (one 10.9, one 10.10) this builds successfully but takes longer to build than previous gcc's. Is that the nature of version 4.9, or are we building extra stuff?\n\nThe time difference: on an old slow machine, it took 58 minutes to build 4.7.3 and 101 minutes to build this. On a newer faster machine, it took 16 minutes to build 4.7.3 and 21 minutes to build this. This time increase was also true with version 4.9.1. Do you see this on other platforms?",
    "created_at": "2014-10-30T18:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226368",
    "user": "@jhpalmieri"
}
```

On two OS X systems (one 10.9, one 10.10) this builds successfully but takes longer to build than previous gcc's. Is that the nature of version 4.9, or are we building extra stuff?

The time difference: on an old slow machine, it took 58 minutes to build 4.7.3 and 101 minutes to build this. On a newer faster machine, it took 16 minutes to build 4.7.3 and 21 minutes to build this. This time increase was also true with version 4.9.1. Do you see this on other platforms?



---

archive/issue_comments_226369.json:
```json
{
    "body": "Sounds about right. Also includes the C -> C++ switch and C++ is definitely slower to compile since it is a much richer language.",
    "created_at": "2014-10-30T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226369",
    "user": "@vbraun"
}
```

Sounds about right. Also includes the C -> C++ switch and C++ is definitely slower to compile since it is a much richer language.



---

archive/issue_comments_226370.json:
```json
{
    "body": "Replying to [comment:4 jhpalmieri]:\n> On two OS X systems (one 10.9, one 10.10) this builds successfully but takes longer to build than previous gcc's. Is that the nature of version 4.9, or are we building extra stuff?\n> \n> The time difference: on an old slow machine, it took 58 minutes to build 4.7.3 and 101 minutes to build this. On a newer faster machine, it took 16 minutes to build 4.7.3 and 21 minutes to build this. This time increase was also true with version 4.9.1. Do you see this on other platforms?\n\nApart from the switch to c++ you may also be building a few more things compared to 4.7.3. Useful things like the sanitizer, more conformance to C++11, some C++14, support for latest openmp specification. All those take a bit of time.",
    "created_at": "2014-10-31T08:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226370",
    "user": "@kiwifb"
}
```

Replying to [comment:4 jhpalmieri]:
> On two OS X systems (one 10.9, one 10.10) this builds successfully but takes longer to build than previous gcc's. Is that the nature of version 4.9, or are we building extra stuff?
> 
> The time difference: on an old slow machine, it took 58 minutes to build 4.7.3 and 101 minutes to build this. On a newer faster machine, it took 16 minutes to build 4.7.3 and 21 minutes to build this. This time increase was also true with version 4.9.1. Do you see this on other platforms?

Apart from the switch to c++ you may also be building a few more things compared to 4.7.3. Useful things like the sanitizer, more conformance to C++11, some C++14, support for latest openmp specification. All those take a bit of time.



---

archive/issue_comments_226371.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-10-31T14:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226371",
    "user": "@jdemeyer"
}
```

New commits:



---

archive/issue_comments_226372.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-31T14:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226372",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_226373.json:
```json
{
    "body": "Some of the failure logs people posted on sage-devel were due to homebrew's isl in /usr/local, which is apparently good enough to be detected but not good enough to compile gcc. I think we should just disable isl/cloog/graphite on Darwin, its unlikely that anybody will have working libraries to build graphite... thoughts?",
    "created_at": "2014-10-31T14:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226373",
    "user": "@vbraun"
}
```

Some of the failure logs people posted on sage-devel were due to homebrew's isl in /usr/local, which is apparently good enough to be detected but not good enough to compile gcc. I think we should just disable isl/cloog/graphite on Darwin, its unlikely that anybody will have working libraries to build graphite... thoughts?



---

archive/issue_comments_226374.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-10-31T15:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226374",
    "user": "@vbraun"
}
```

New commits:



---

archive/issue_comments_226375.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-10-31T15:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226375",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_226376.json:
```json
{
    "body": "Also, gcc 4.6.3 in Ubuntu 12.04 doesn't work: https://groups.google.com/d/msg/sage-release/xgmJ3nAcUOY/jH8OZjftYRsJ\n\nSince we already shitlisted 4.6.1 and 4.6.2, how about we build gcc for all 4.6.x versions?",
    "created_at": "2014-10-31T15:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226376",
    "user": "@vbraun"
}
```

Also, gcc 4.6.3 in Ubuntu 12.04 doesn't work: https://groups.google.com/d/msg/sage-release/xgmJ3nAcUOY/jH8OZjftYRsJ

Since we already shitlisted 4.6.1 and 4.6.2, how about we build gcc for all 4.6.x versions?



---

archive/issue_comments_226377.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T15:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226377",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226378.json:
```json
{
    "body": "Done!",
    "created_at": "2014-10-31T15:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226378",
    "user": "@vbraun"
}
```

Done!



---

archive/issue_comments_226379.json:
```json
{
    "body": "Instead of blacklisting GCC 4.6 specifically, would it not make more sense to simply declare all GCC versions <= 4.6 as \"old\"?",
    "created_at": "2014-10-31T16:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226379",
    "user": "@jdemeyer"
}
```

Instead of blacklisting GCC 4.6 specifically, would it not make more sense to simply declare all GCC versions <= 4.6 as "old"?



---

archive/issue_comments_226380.json:
```json
{
    "body": "I thought about it, but then nobody complained about it. It might actually work ;-)",
    "created_at": "2014-10-31T17:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226380",
    "user": "@vbraun"
}
```

I thought about it, but then nobody complained about it. It might actually work ;-)



---

archive/issue_comments_226381.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-31T17:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226381",
    "user": "@dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_226382.json:
```json
{
    "body": "this `fi;;` should go!\n\n```\ndiff --git a/build/install b/build/install\nindex a5fae62..abe04d7 100755\n--- a/build/install\n+++ b/build/install\n@@ -147,7 +147,6 @@ else\n                 echo >&2 \"Installing GCC because you have $CXX version $GCCVERSION.\"\n                 echo >&2 \"gcc-4.6.* has known bugs affecting Sage.\"\n                 need_to_install_gcc=yes;;\n-                fi;;\n             4.7.0)\n                 # GCC 4.7.0 is very broken on ia64, see\n                 # http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48496\n```\n",
    "created_at": "2014-10-31T17:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226382",
    "user": "@dimpase"
}
```

this `fi;;` should go!

```
diff --git a/build/install b/build/install
index a5fae62..abe04d7 100755
--- a/build/install
+++ b/build/install
@@ -147,7 +147,6 @@ else
                 echo >&2 "Installing GCC because you have $CXX version $GCCVERSION."
                 echo >&2 "gcc-4.6.* has known bugs affecting Sage."
                 need_to_install_gcc=yes;;
-                fi;;
             4.7.0)
                 # GCC 4.7.0 is very broken on ia64, see
                 # http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48496
```




---

archive/issue_comments_226383.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T18:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226383",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226384.json:
```json
{
    "body": "Oops, fixed!",
    "created_at": "2014-10-31T18:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226384",
    "user": "@vbraun"
}
```

Oops, fixed!



---

archive/issue_comments_226385.json:
```json
{
    "body": "anything else not done here? Can it be reviewed?",
    "created_at": "2014-10-31T20:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226385",
    "user": "@dimpase"
}
```

anything else not done here? Can it be reviewed?



---

archive/issue_comments_226386.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2014-10-31T20:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226386",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_226387.json:
```json
{
    "body": "As far as I'm concerned its good to go. Positive review to Jeroen's commits...",
    "created_at": "2014-10-31T21:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226387",
    "user": "@vbraun"
}
```

As far as I'm concerned its good to go. Positive review to Jeroen's commits...



---

archive/issue_comments_226388.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-10-31T21:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226388",
    "user": "@vbraun"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_226389.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-31T22:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226389",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_226390.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-01T18:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17025#issuecomment-226390",
    "user": "@vbraun"
}
```

Resolution: fixed
