# Issue 27594: Small fix for is_symmetric for matrices over CDF

Issue created by migration from https://trac.sagemath.org/ticket/27831

Original creator: @mwageringel

Original creation time: 2019-05-14 20:27:28

Calling `is_symmetric` on a matrix defined over `CDF` fails:


```
sage: a = matrix(CDF, [(21, 0.6 + 18.5*i), (0.6 - 18.5*i, 21)])
sage: a.is_symmetric()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-6d0498c2f774> in <module>()
----> 1 a.is_symmetric()

/Applications/SageMath/local/lib/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx in sage.matrix.matrix_double_dense.Matrix_double_dense.is_symmetric (build/cythonized/sage/matrix/matrix_double_dense.c:15478)()
   2400         for i from 0 < i < self._nrows:
   2401             for j from 0 <= j < i:
-> 2402                 if math.fabs(self.get_unsafe(i,j) - self.get_unsafe(j,i)) > tol:
   2403                     b = False
   2404                     break

/Applications/SageMath/local/lib/python2.7/site-packages/sage/rings/complex_double.pyx in sage.rings.complex_double.ComplexDoubleElement.__float__ (build/cythonized/sage/rings/complex_double.c:10102)()
    968         """
    969         if self._complex.imag:
--> 970             raise TypeError(f"unable to convert {self} to float; use abs() or real_part() as desired")
    971         return self._complex.real
    972

TypeError: unable to convert -37.0*I to float; use abs() or real_part() as desired
```


The implementation calls `math.fabs` which unsuitable for complex numbers and should be replaced by `abs` (which is used in similar functions like `is_hermitian`).


---

Comment by @mwageringel created at 2019-05-14 20:35:43

New commits:


---

Comment by @mwageringel created at 2019-05-14 20:35:43

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2019-05-14 20:35:43

Changing keywords from "" to "numpy".


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by chapoton created at 2019-08-24 11:34:56

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-08-24 11:34:56

ok


---

Comment by vbraun created at 2019-08-26 22:15:02

Resolution: fixed
