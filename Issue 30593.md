# Issue 30593: Subintervals of OpenInterval and UniqueRepresentation

Issue created by migration from https://trac.sagemath.org/ticket/30830

Original creator: @mjungmath

Original creation time: 2020-10-25 20:09:12

CC:  egourgoulhon tscrim @tobiasdiez

At the moment, we have the following behavior:

```
sage: I = OpenInterval(0,2)
sage: J = OpenInterval(0,1, ambient_interval=I, start_index=1)
sage: I.open_interval(0,1)
Traceback (most recent call last)
...
ValueError: the name '(0, 1)' is already used for another subset of the Real interval (0, 2)
```


Even though the use of `OpenInterval(0,1, ambient_interval=I)` is not intended, this is still a blind spot.

The reason for this behavior comes from the `UniqueRepresentation` and how the subintervals are constructed.


---

Comment by @mjungmath created at 2020-10-25 20:32:40

Changing status from new to needs_review.


---

Comment by @mjungmath created at 2020-10-25 20:32:40

Ready for review.
----
New commits:


---

Comment by tscrim created at 2020-10-26 00:22:55

You have a doctest failure in `continuous_map` (see the patchbot). Otherwise LGTM.


---

Comment by tscrim created at 2020-10-26 00:23:24

Also `TEST:` -> `TESTS::`.


---

Comment by git created at 2020-10-26 10:21:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-10-26 10:23:16

I think, this approach is slighly better because it is closer to the original behavior. Now, the test in `continuous_map.py` should pass.


---

Comment by mkoeppe created at 2020-10-26 17:10:02

Side remark: It would be nice to connect `OpenInterval` also to `RealSet` (not on this ticket)...


---

Comment by @mjungmath created at 2020-10-26 17:17:20

Replying to [comment:8 mkoeppe]:
> Side remark: It would be nice to connect `OpenInterval` also to `RealSet` (not on this ticket)...

Nice! Would you take the honor to open the corresponding ticket?


---

Comment by mkoeppe created at 2020-10-26 20:10:11

That's now #30832


---

Comment by @mjungmath created at 2020-10-26 20:37:02

Replying to [comment:10 mkoeppe]:
> That's now #30832
+1


---

Comment by tscrim created at 2020-10-31 07:26:07

With this change, you can create two distinct intervals with the same (latex) name by passing the resulting values if `None` is given (e.g., `name='R'`). While this is me being deliberately evil, it is something I want you to consider and if you are okay with this possible situation happening.


---

Comment by @mjungmath created at 2020-10-31 10:26:02

You mean


```
sage: R = RealLine(); R                                                         
Real number line R
sage: R1 = RealLine(name='R'); R1                                               
Real number line R
sage: R is R1                                                                   
False
```


Right?


---

Comment by tscrim created at 2020-10-31 10:43:12

Replying to [comment:13 gh-mjungmath]:
> You mean
> 
> {{{
> sage: R = RealLine(); R                                                         
> Real number line R
> sage: R1 = RealLine(name='R'); R1                                               
> Real number line R
> sage: R is R1                                                                   
> False
> }}}
> 
> Right?

Yes, exactly.


---

Comment by @mjungmath created at 2020-10-31 11:03:24

This should do, but it doesn't. Adding `__classcall__` to `RealLine` doesn't help either.


---

Comment by git created at 2020-10-31 11:03:32

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-10-31 11:47:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-10-31 11:53:18

This works now.

I think that `OpenInterval` should silently return a `RealLine` instance if `lower == minus_infinity` and `upper == infinity`. As [Eric pointed out](https://trac.sagemath.org/ticket/30799#comment:50), the  Real line is a fully determined mathematical object, and the behaviour here should reflect that.

But this should be part of another ticket.


---

Comment by tscrim created at 2020-11-02 22:41:02

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-11-02 22:41:02

Thanks. LGTM.


---

Comment by @mjungmath created at 2020-11-02 22:52:05

Thanks for the review.


---

Comment by vbraun created at 2020-11-22 15:06:30

Resolution: fixed
