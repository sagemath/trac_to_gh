# Issue 25514: Improve PARI finite field iterator

Issue created by migration from https://trac.sagemath.org/ticket/25751

Original creator: jdemeyer

Original creation time: 2018-07-02 21:01:47

CC:  pbruin

Keywords: days94

Note the difference between

```
sage: k.<a> = GF(3^10, impl="givaro");
sage: %time L = list(k)
CPU times: user 100 ms, sys: 2 ms, total: 102 ms
Wall time: 102 ms
```

and

```
sage: k.<a> = GF(3^10, impl="pari_ffelt")
sage: %time L = list(k)
CPU times: user 3.18 s, sys: 11 ms, total: 3.19 s
Wall time: 3.17 s
```

There is clearly room for improvement in the latter.


---

Comment by git created at 2018-07-05 08:40:36

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-07-05 08:47:01

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-07-05 23:41:58

Do all of those returns in `element_pari_ffelt.pyx` need a `sig_off`, or is that handled by the calling function?

Would it be worth cythonizing the iterator (by making it a function in `element_pari_ffelt.pyx`)?


---

Comment by jdemeyer created at 2018-07-06 07:17:22

I just realized that my "PARI finite field" iterator is in fact completely generic and doesn't use any PARI features. So I'll move that to the base class.


---

Comment by jdemeyer created at 2018-07-06 07:17:47

Replying to [comment:6 tscrim]:
> Do all of those returns in `element_pari_ffelt.pyx` need a `sig_off`, or is that handled by the calling function?

It's handled by `construct`.

> Would it be worth cythonizing the iterator (by making it a function in `element_pari_ffelt.pyx`)?

Maybe, but I'd rather do that another time :-)


---

Comment by jdemeyer created at 2018-07-06 08:22:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-07-06 08:47:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-07-06 08:47:30

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-07-06 08:49:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-07-06 09:13:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-07-06 10:28:20

Replying to [comment:7 jdemeyer]:
> I just realized that my "PARI finite field" iterator is in fact completely generic and doesn't use any PARI features. So I'll move that to the base class.

...which happens to be implemented in Cython. So I got another x2.5 speedup!

I think that the current code is as good as it can get for a generic implementation.


---

Comment by tscrim created at 2018-07-06 15:03:21

Thank you. LGTM.


---

Comment by tscrim created at 2018-07-06 15:03:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-05 08:17:13

Resolution: fixed
