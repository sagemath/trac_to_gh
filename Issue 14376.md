# Issue 14376: Set individual legend font color in Sage

Issue created by migration from https://trac.sagemath.org/ticket/14580

Original creator: ppurka

Original creation time: 2013-05-14 16:30:02

Assignee: jason, was

CC:  sd45 sd48

Currently, it is not possible to change the legend font color in Sage at all. [This link](http://permalink.gmane.org/gmane.comp.python.matplotlib.general/24674) shows how to do it in matplotlib - it is not straightforward in matplotlib either.

I think the way to introduce it is

1. Allow a `legend_color` parameter to each plot.
2. Keep track of the individual legend colors via a key in the `Graphics._legend_opts` dictionary.
3. The key will contain a list of colors, defaulting to black or None (I prefer None, so that we use matplotlib's default).
4. After all the plots have been rendered and the legend as been set, we can follow the method in the link above to extract all the texts and set the colors individually, skipping the ones which are None (if the default is None).


---

Comment by ppurka created at 2013-05-20 11:43:25

Changing status from new to needs_review.


---

Comment by ppurka created at 2013-05-20 11:43:25

I added a new attribute `self._legend_colors = []` to `Graphics`. This will hold the colors or `None` in case no colors are provided. Patch needs review.

_Edit_: It is now possible to get a graph [like this](http://i.imgur.com/1hpaBbw.png):

```
sage: p1 = plot(x, legend_label='this is x', legend_color='red', color='red')
sage: p2 = plot(x**2, legend_label='this is x^2', legend_color='green', color='green')
sage: (p1+p2).save('/tmp/a.png')
```



---

Comment by ppurka created at 2013-05-21 06:51:44

Changing status from needs_review to needs_work.


---

Comment by ppurka created at 2013-05-21 11:34:01

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2013-06-15 02:44:17

I think this is very intriguing.  I spent a lot of time thinking about why the existing legend suboptions decorator might not work, and how this code magically allows examples to work in different orders, and I think this is really correct.  So this is my only question:
 * Tons of other graphics primitives have legends (arrow, disk, etc.), which do not use `point` or `line`.  Presumably we should support those too?


---

Comment by kcrisman created at 2013-06-18 21:38:54


```
$ grep -r p.set_label sage/plot/
sage/plot/arrow.py:        p.set_label(options['legend_label'])
sage/plot/arrow.py:        p.set_label(options['legend_label'])
sage/plot/circle.py:        p.set_label(options['legend_label'])
sage/plot/disk.py:        p.set_label(options['legend_label'])
sage/plot/ellipse.py:        p.set_label(options['legend_label'])
sage/plot/line.py:        p.set_label(options['legend_label'])
sage/plot/polygon.py:        p.set_label(options['legend_label'])
```



---

Comment by kcrisman created at 2013-06-18 21:40:32

There is also not a doctest for the `point` version yet.  I'll try to write a second patch now, which would definitely need review.


---

Attachment

Patchbot, apply trac_14580-legend_color.patch  and trac_14580-more-colors.patch


---

Comment by ppurka created at 2013-06-22 17:35:22

Don't know why the patchbot refuses to test your new patch. It passes all tests in devel/sage/sage/plot. I see no issues with your patch.


---

Comment by ppurka created at 2013-06-22 17:35:22

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-07-24 06:53:06

This needs to be rebased to #13834.


---

Comment by jdemeyer created at 2013-07-24 06:55:24

Changing status from positive_review to needs_work.


---

Comment by ppurka created at 2013-07-24 07:53:18

Apply to devel/sage


---

Attachment

Rebased against #13834


---

Comment by ppurka created at 2013-07-24 07:54:59

Changing status from needs_work to positive_review.


---

Attachment

Rebased both the patches against #13834


---

Comment by ppurka created at 2013-07-24 07:55:31

patchbot apply trac_14580-legend_color.patch trac_14580-more-colors-rebased.patch


---

Comment by jdemeyer created at 2013-08-16 21:19:12

Resolution: fixed
