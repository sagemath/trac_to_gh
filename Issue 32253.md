# Issue 32253: sign errors in multiplication_by_m_isogeny

Issue created by migration from https://trac.sagemath.org/ticket/32490

Original creator: lorenz

Original creation time: 2021-09-08 03:42:27

CC:  cremona defeo


```sage
sage: E = EllipticCurve(QQbar, [1,0])
sage: E.multiplication_by_m_isogeny(1).rational_maps()
(x, -y)
```



```sage
sage: E = EllipticCurve(GF(127), [1,0])
sage: P = E.random_point()
sage: E.multiplication_by_m_isogeny(5)(P)
(15 : 56 : 1)
sage: 5*P
(15 : 71 : 1)
sage: -5*P
(15 : 56 : 1)
sage: E.multiplication_by_m(5) == (-E.multiplication_by_m_isogeny(5)).rational_maps()
True
```


It isn't _consistently_ wrong:


```sage
sage: E = EllipticCurve(QQ, [1,0])
sage: E.multiplication_by_m_isogeny(1).rational_maps()
(x, y)
```



---

Comment by lorenz created at 2021-09-08 09:50:28

Changing status from new to needs_review.


---

Comment by lorenz created at 2021-09-08 09:50:28

New commits:


---

Comment by tscrim created at 2021-09-13 01:25:34

Based on your description, it seems like the thing to do would be to make #32388 a dependency since it generally seems to be better. You can then use this ticket as motivation for #32388 if that is necessary.


---

Comment by lorenz created at 2021-09-13 04:44:22

Replying to [comment:3 tscrim]:
> Based on your description, it seems like the thing to do would be to make #32388 a dependency since it generally seems to be better.

I was worried that #32388 might take a while to get in, which could cause this (in principle, totally unrelated) bug to remain unfixed for no good reason if there was a dependency. Hence why I figured the best way to proceed would be to first apply this minimal bugfix and pursue the longer-term solution based on `EllipticCurveHom` later.


---

Comment by tscrim created at 2021-09-13 04:58:05

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-09-13 04:58:05

Then let's get the bug-fix in.


---

Comment by lorenz created at 2021-09-17 02:59:15

Now that #32388 is also green, this will almost certainly cause test failures when both are merged (since this currently uses a method deprecated in #32388). What's the recommended way of dealing with this? Should I rebase this onto #32388 using the new syntax and add a dependency after all?


---

Comment by tscrim created at 2021-09-17 06:14:35

Sounds like you should make this depend on #32388.


---

Comment by git created at 2021-09-17 08:52:29

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:


---

Comment by git created at 2021-09-17 08:52:29

Changing status from positive_review to needs_review.


---

Comment by lorenz created at 2021-09-17 08:56:17

Rebased and adapted to the new syntax. (Only the last commit is relevant here; the rest are from #32388.)


---

Comment by tscrim created at 2021-09-21 04:32:27

LGTM. Thanks.


---

Comment by tscrim created at 2021-09-21 04:32:27

Changing status from needs_review to positive_review.


---

Comment by lorenz created at 2021-10-23 03:39:19

Bumping priority since this bug can lead to mathematical errors.


---

Comment by lorenz created at 2021-10-23 03:39:19

Changing priority from minor to major.


---

Comment by vbraun created at 2021-10-23 22:58:33

Resolution: fixed
