# Issue 17363: AsymptoticGrowthElement

Issue created by migration from https://trac.sagemath.org/ticket/17600

Original creator: behackl

Original creation time: 2015-01-08 13:51:22

CC:  cheuberg dkrenn ncohen vdelecroix

Keywords: asymptotics

Hold one order of magnitude for asymptotic terms and expressions. Such a term could be, e.g. n<sup>2</sup> or k/n or n*log(n).

AsymptoticGrowthElement can be compared, multiplied, etc., but has **no** coefficient. Here, only the order of magnitude shall be managed.

See (meta ticket no.) for the planned structure.


---

Comment by git created at 2015-01-16 19:28:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-02-05 11:32:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2015-03-21 21:34:08

Hello,

The "planned structure" at #17601 does not motivates any choice. In particular, the branch attached to this ticket makes me sceptical since it implements a completely broken version of a multiplicative group isomorphic to `RR` (which is also slower and less usable than the original one).

Why is it a group and not a ring? Why should there be, if any, a dedicated parent to an asymptotic term? Do you really intend to implement a parent for each kind of asymptotic you have in mind?

What I see in the branch is only code that is working for itself which is not very interesting and not very useful. You can not start building a cathedral without any serious roadmap.

Vincent


---

Comment by cheuberg created at 2015-03-22 04:34:26

Replying to [comment:6 vdelecroix]:
> Why is it a group and not a ring?

The `AsymptoticGrowthGroup` is only planned to handle the multiplicative structure. Instead of the simplest example here, think about asymptotics involving powers of `n` and `log(n)` for `n -> infinity`. Then this group will be isomorphic to a cartesian product of `RR` with itself with lexicographic order. In another example, where `|h|<= n^(3/4)` and `n->infinity`, this group will again be a cartesian product of `RR` with itself, but the partial order of the lexicographic order will be refined by the additional rule, but not yet be a linear order because some of these terms cannot be compared.

Handling of coefficients, addition of two terms and absorption of O terms are rather independent of the growth group as outlined here. Thus they are planned to be handeled by the `AsymptoticTerm` (#17715).

High level operations such as addition and multiplication of expressions are still more general and will be part of the (yet unimplemented) `AsymptoticExpression` (#17716).

> Why should there be, if any, a dedicated parent to an asymptotic term?

There is a natural coercion from an `AsymptoticGrowthGroup` in `n` to the `AsymptoticGrowthGroup` in `n` and `log(n)`, for instance. Thus I think it makes sense to use the coercion framework. This requires to have parents.

> What I see in the branch is only code that is working for itself which is not very interesting and not very useful.

Therefore, all these tickets are still in status `new` and not `needs_review`, because the `AsymptoticExpression` is still missing.

> You can not start building a cathedral without any serious roadmap.

There is a roadmap and the very brief version is in the meta ticket #17601. The long version are notes made during long oral discussions.

Your comments here and on the meta ticket #17601 make it clear that the abbreviated version is not sufficiently clear. Probably the long version of the road map will also be of interest later on and could live in the documentation of the asymptotic expression.


---

Comment by behackl created at 2015-05-26 18:02:36

Rebased to Sage 6.7.


---

Comment by git created at 2015-05-26 18:04:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-05-31 13:22:52

Changing keywords from "asymptotics" to "asymptotics, gsoc2015".


---

Comment by dkrenn created at 2015-05-31 13:22:52

Last 10 new commits:


---

Comment by git created at 2015-06-01 20:59:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-02 23:23:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-18 13:24:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-14 14:49:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-20 14:55:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-27 13:53:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-27 14:11:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-28 18:40:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by behackl created at 2015-08-11 13:04:27

Last 10 new commits:


---

Comment by git created at 2015-08-13 20:05:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-08-14 14:15:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by behackl created at 2015-08-20 07:51:12

Changing status from new to needs_review.


---

Comment by dkrenn created at 2015-08-20 08:06:24

During the project #17601 (the last months in course of GSOC2015 as mentor) I did a very careful reviewing of all code. This includes the code of this ticket. Now this is clearly a positive_review from my side.


---

Comment by rws created at 2015-08-20 13:13:34

I found a few language oddities.

```
functions and their behavior as the
functions, and their behavior as the

It, its functionality or its interface
Either its functionality or its interface

Helper method, which generates
Helper method which generates

Growth elements form a group by multiplication and (some of) the
Growth elements form a group by multiplication, and (some of) the

that this element, as well as ``other`` are of the same type.
that this element is of the same type as ``other``.

This can anything that is valid to be on the right hand side of ``*`` with an elements of the parent's base
This can be anything that is a valid right hand side of ``*`` with elements of the parent's base.
(found twice)

The result of this exponentiation a :class:`MonomialGrowthElement`.
The result of this exponentiation, a :class:`MonomialGrowthElement`.

Return if this growth element is equal to ``other``.
Return True if this growth element is equal to ``other``.

Return if this :class:`GenericGrowthElement` is equal to ``other``.
Return True if this :class:`GenericGrowthElement` is equal to ``other``.
...and similar cases...

Converts given object to this growth group.
Converts a given object to this growth group.

Converts given ``data`` to something...
Converts ``data`` to something...

class and should be overridden in inherited class.
class, and should be overridden in inherited classes.

Takes this growth element to the given ``power``.
Raises this growth element to the given ``power``.
```



---

Comment by behackl created at 2015-08-20 14:39:37

Hi Ralf! Thanks for your remarks; I'm currently fixing these oddities and will push the changes soon. One question: instead of 

```
Return ``True`` if ...
```

what do you think about:

```
Return whether ...
```

Just because we'd like to avoid directly referring to `True`.


---

Comment by rws created at 2015-08-20 15:15:21

Replying to [comment:27 behackl]:
> Hi Ralf! Thanks for your remarks; I'm currently fixing these oddities and will push the changes soon. One question: instead of 
> {{{
> Return ``True`` if ...
> }}}
> what do you think about:
> {{{
> Return whether ...
> }}}
Well if is a synonym for whether so nothing changed.
> Just because we'd like to avoid directly referring to `True`.
I have no idea why you would want that. Can you please clarify?


---

Comment by dkrenn created at 2015-08-20 15:24:09

Replying to [comment:28 rws]:
> > {{{
> > Return ``True`` if ...
> > }}}
> > what do you think about:
> > {{{
> > Return whether ...
> > }}}
> Well if is a synonym for whether so nothing changed.
> > Just because we'd like to avoid directly referring to `True`.
> I have no idea why you would want that. Can you please clarify?

The one-liner description should be short; additionally we have an output block saying that the method returns a boolean. Since there also an ongoing discussion in #19041 about such things, I would leave it for now as it is...

Is there a grammatical reason that "Return if..." should be avoided?


---

Comment by rws created at 2015-08-20 16:06:57

Replying to [comment:29 dkrenn]:
> Is there a grammatical reason that "Return if..." should be avoided?
Not at all. I accept your explanation.


---

Comment by git created at 2015-08-20 17:19:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-09-09 14:48:13

Merged in 6.9.beta5
----
New commits:


---

Comment by dkrenn created at 2015-09-15 17:26:30

Changing component from symbolics to asymptotic expansions.


---

Comment by git created at 2015-09-15 18:30:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2015-09-15 18:35:50

I started reviewing this ticket and added three reviewer commits, one of which is not shown in trac.

Comments so far:

- I think that the following behaviour does not conform to the use of the parameter `category` in `Parent` ("If category is a list or tuple, a JoinCategory is created out of them."):

```
sage: import sage.rings.asymptotic.growth_group as agg
sage: agg.GenericGrowthGroup(ZZ, category=(Posets(), Groups()))
Traceback (most recent call last):
...
ValueError: (Category of posets, Category of groups) is not a subcategory of Join of Category of groups and Category of posets
```

  Compare this with 

```
sage: Parent(category=(Posets(), Groups())).category()
Join of Category of groups and Category of posets
```

- `GenericGrowthElement` - class documentation: "abstract implementation" sounds contradictory.
- `GenericGrowthElement.__init__`: first and second tests seem to do the same thing.


---

Comment by git created at 2015-09-16 08:57:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2015-09-16 09:45:43

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2015-09-16 09:45:43

Here is the remainder of my comments.
- `GenericGrowthGroup._element_constructor_`: make clear that either `data` or `raw_element` has to be given; in the latter case, `data` has to be 0.
- `GenericGrowthGroup._element_constructor_`: shouldn't the tests be marked as indirect doctests?
- `GenericGrowthGroup._element_constructor_`: is there a particular reason for using `type(data) == self.element_class` in the second line and `isinstance(data, self.element_class)` in the fourth line of the code?
- `GenericGrowthGroup.gens_monomial`: it is not clear what the difference between `gens` and `gens_monomial` should be.
- `MonomialGrowthGroup.__classcall__`: The category parameter is not checked, but I can live with that:

```
sage: from sage.rings.asymptotic.growth_group import MonomialGrowthGroup
sage: G1 = MonomialGrowthGroup(ZZ, 'x')
sage: G2 = MonomialGrowthGroup(ZZ, 'x', category=Posets() & Groups())
sage: G1 is G2
False
sage: G1.category() == G2.category()
True
```

- `MonomialGrowthGroup.__init__`: Please include doctests for the two `ValueErrors`
- `MonomialGrowthGroup._convert_`: I think that the error message on variable in a multivariate power series is not instructive in the following example, I'd prefer to see "Cannot convert 2" as in `G(2)` below.

```
sage: from sage.rings.asymptotic.growth_group import MonomialGrowthGroup
sage: G = MonomialGrowthGroup(ZZ, 'x')
sage: R.<x, y> = PowerSeriesRing(ZZ, ['x', 'y'])
sage: R(2).variables()
()
sage: G(R(2))
Traceback (most recent call last):
...
NotImplementedError: variable not defined for multivariate power series;
use 'variables' instead.
sage: G(2)
Traceback (most recent call last):
...
ValueError: Cannot convert 2.
```

- `MonomialGrowthGroup.gens_monomial`: Is this method needed? See the example:

```
sage: from sage.rings.asymptotic.growth_group import MonomialGrowthGroup
sage: MonomialGrowthGroup(ZZ, 'log(x)').gens_monomial()
()
sage: MonomialGrowthGroup(ZZ, 'exp(x)').gens_monomial()
(exp(x),)
```

- `MonomialGrowthGroup.gens`: cf. `gens_monomial`: I'd move "even if the growth group is logarithmic" from `gens` to `gens_monomial` as "except if the growth group is logarithmic"
- `parent_to_repr_short`: Rewrite INPUT section to standard format


---

Comment by behackl created at 2015-09-16 17:01:16

Last 10 new commits:


---

Comment by behackl created at 2015-09-16 17:05:18

Replying to [comment:38 cheuberg]:
> - I think that the following behaviour does not conform to the use of the parameter `category` in `Parent` ("If category is a list or tuple, a JoinCategory is created out of them."):
> {{{
> sage: import sage.rings.asymptotic.growth_group as agg
> sage: agg.GenericGrowthGroup(ZZ, category=(Posets(), Groups()))
> Traceback (most recent call last):
> ...
> ValueError: (Category of posets, Category of groups) is not a subcategory of Join of Category of groups and Category of posets
> }}}

This is because our code checks, whether at least one argument in the tuple is a subcategory of `Join of Category of groups and Category of posets`. Of course, this could be relaxed such that we check if there is at least one argument that is a subcategory of `Category of groups`, and at least one that is a subcategory of `Category of posets`.

However, we already took care of that in the cleanup ticket #19083. Thus, I'd leave this as it is here.

> - `GenericGrowthElement` - class documentation: "abstract implementation" sounds contradictory.

Rephrased to "basic implementation".

> - `GenericGrowthElement.__init__`: first and second tests seem to do the same thing.

Duplicate removed.

> - `GenericGrowthGroup._element_constructor_`: make clear that either `data` or `raw_element` has to be given; in the latter case, `data` has to be 0.

Done.

> - `GenericGrowthGroup._element_constructor_`: shouldn't the tests be marked as indirect doctests?

Done.

> - `GenericGrowthGroup._element_constructor_`: is there a particular reason for using `type(data) == self.element_class` in the second line and `isinstance(data, self.element_class)` in the fourth line of the code?

Not as far as I can remember. I have rewritten this particular part of the element constructor.

> - `GenericGrowthGroup.gens_monomial`: it is not clear what the difference between `gens` and `gens_monomial` should be.

I've tried to clarify by extending the documentation.

> - `MonomialGrowthGroup.__classcall__`: The category parameter is not checked, but I can live with that:

Fixed on the cleanup-ticket.

> - `MonomialGrowthGroup.__init__`: Please include doctests for the two `ValueErrors`

We put the code handling variables in a separate class on the cleanup ticket. Thus, I think that this is not really necessary.

> - `MonomialGrowthGroup._convert_`: I think that the error message on variable in a multivariate power series is not instructive in the following example, I'd prefer to see "Cannot convert 2" as in `G(2)` below.
> {{{
> sage: from sage.rings.asymptotic.growth_group import MonomialGrowthGroup
> sage: G = MonomialGrowthGroup(ZZ, 'x')
> sage: R.<x, y> = PowerSeriesRing(ZZ, ['x', 'y'])
> sage: R(2).variables()
> ()
> sage: G(R(2))
> Traceback (most recent call last):
> ...
> NotImplementedError: variable not defined for multivariate power series;
> use 'variables' instead.
> sage: G(2)
> Traceback (most recent call last):
> ...
> ValueError: Cannot convert 2.
> }}}

Fixed.

> - `MonomialGrowthGroup.gens_monomial`: Is this method needed? See the example:
> {{{
> sage: from sage.rings.asymptotic.growth_group import MonomialGrowthGroup
> sage: MonomialGrowthGroup(ZZ, 'log(x)').gens_monomial()
> ()
> sage: MonomialGrowthGroup(ZZ, 'exp(x)').gens_monomial()
> (exp(x),)
> }}}

I've added an additional note to explain what this method should exactly do. Note that while it can only recognize `log(...)` on this ticket, we have extended the functionality of it (to actually do what it should) on ticket #18587.

> - `MonomialGrowthGroup.gens`: cf. `gens_monomial`: I'd move "even if the growth group is logarithmic" from `gens` to `gens_monomial` as "except if the growth group is logarithmic"

Removed the half-sentence. The additional note for `gens_monomial` should make the difference clear.

> - `parent_to_repr_short`: Rewrite INPUT section to standard format

Done.

Thank you for your review---this is now ready for a short cross-review.


---

Comment by behackl created at 2015-09-16 17:05:18

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2015-09-16 17:40:15

Changing status from needs_review to positive_review.


---

Comment by cheuberg created at 2015-09-16 17:40:15

Reviewed your changes.

Doctests pass, documentation builds, code is ok.

Obviously, inclusion of this ticket alone into SageMath is not useful. However, once everything mentioned in the meta ticket #17601 is merged, this should be very useful. It will take some more time to finish and then review all those tickets.

Despite all that, a first step has to be made, so I set this to positive_review.


---

Comment by vbraun created at 2015-09-17 09:24:15

Resolution: fixed
