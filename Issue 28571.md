# Issue 28571: failing internet and imagemagick doctests because argument must be str, not bytes

archive/issues_028571.json:
```json
{
    "body": "CC:  @tscrim @embray\n\n\n```\nsage -t --optional=sage,optional,external src/sage/repl/load.py src/sage/misc/latex.py src/sage/plot/animate.py\n```\n\n\ngives\n\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/repl/load.py  # 1 doctest failed\nsage -t src/sage/misc/latex.py  # 1 doctest failed\nsage -t src/sage/plot/animate.py  # 7 doctests failed\n----------------------------------------------------------------------\nExternal software detected for doctesting: imagemagick,internet,latex\n```\n\n\nwith errors of that kind:\n\n\n```\nsage -t src/sage/repl/load.py\n**********************************************************************\nFile \"src/sage/repl/load.py\", line 157, in sage.repl.load.load\nFailed example:\n    sage.repl.load.load('https://github.com/jasongrout/minimum_rank/raw/minimum_rank_1_0_0/minrank.py', globals())  # optional - internet\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.load.load[16]>\", line 1, in <module>\n        sage.repl.load.load('https://github.com/jasongrout/minimum_rank/raw/minimum_rank_1_0_0/minrank.py', globals())  # optional - internet\n      File \"/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/repl/load.py\", line 235, in load\n        filename = get_remote_file(filename, verbose=False)\n      File \"/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/misc/remote_file.py\", line 49, in get_remote_file\n        f.write(content.read())\n    TypeError: write() argument must be str, not bytes\n**********************************************************************\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28808\n\n",
    "created_at": "2019-11-27T15:13:44Z",
    "labels": [
        "component: doctest coverage",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "failing internet and imagemagick doctests because argument must be str, not bytes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28571",
    "user": "https://github.com/seblabbe"
}
```
CC:  @tscrim @embray


```
sage -t --optional=sage,optional,external src/sage/repl/load.py src/sage/misc/latex.py src/sage/plot/animate.py
```


gives


```
----------------------------------------------------------------------
sage -t src/sage/repl/load.py  # 1 doctest failed
sage -t src/sage/misc/latex.py  # 1 doctest failed
sage -t src/sage/plot/animate.py  # 7 doctests failed
----------------------------------------------------------------------
External software detected for doctesting: imagemagick,internet,latex
```


with errors of that kind:


```
sage -t src/sage/repl/load.py
**********************************************************************
File "src/sage/repl/load.py", line 157, in sage.repl.load.load
Failed example:
    sage.repl.load.load('https://github.com/jasongrout/minimum_rank/raw/minimum_rank_1_0_0/minrank.py', globals())  # optional - internet
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.load.load[16]>", line 1, in <module>
        sage.repl.load.load('https://github.com/jasongrout/minimum_rank/raw/minimum_rank_1_0_0/minrank.py', globals())  # optional - internet
      File "/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/repl/load.py", line 235, in load
        filename = get_remote_file(filename, verbose=False)
      File "/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage/misc/remote_file.py", line 49, in get_remote_file
        f.write(content.read())
    TypeError: write() argument must be str, not bytes
**********************************************************************
```


Issue created by migration from https://trac.sagemath.org/ticket/28808





---

archive/issue_comments_402894.json:
```json
{
    "body": "spliting this ticket:\n\n- failures with plot/animate.py are now in #28868\n- failures with 1 imagemagick failing doctest in misc/latex.py is now in #28867",
    "created_at": "2019-12-10T08:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402894",
    "user": "https://github.com/seblabbe"
}
```

spliting this ticket:

- failures with plot/animate.py are now in #28868
- failures with 1 imagemagick failing doctest in misc/latex.py is now in #28867



---

archive/issue_comments_402895.json:
```json
{
    "body": "see https://github.com/jasongrout/minimum_rank/pull/5",
    "created_at": "2019-12-11T07:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402895",
    "user": "https://github.com/fchapoton"
}
```

see https://github.com/jasongrout/minimum_rank/pull/5



---

archive/issue_comments_402896.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-12T14:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402896",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_402897.json:
```json
{
    "body": "I have changed the example, using the sage patchbot instead.\n----\nNew commits:",
    "created_at": "2019-12-12T14:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402897",
    "user": "https://github.com/fchapoton"
}
```

I have changed the example, using the sage patchbot instead.
----
New commits:



---

archive/issue_comments_402898.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-12-12T20:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402898",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_402899.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-12T20:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402899",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_072808.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-12-17T13:33:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28571#event-72808"
}
```



---

archive/issue_comments_402900.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-17T22:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402900",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_072809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-17T22:46:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28571#event-72809"
}
```



---

archive/issue_comments_402901.json:
```json
{
    "body": "The link `https://raw.githubusercontent.com/sagemath/sage-patchbot/2.8.4/sage_patchbot/util.py` added in this ticket is currently broken. See #29047",
    "created_at": "2020-01-20T08:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402901",
    "user": "https://github.com/seblabbe"
}
```

The link `https://raw.githubusercontent.com/sagemath/sage-patchbot/2.8.4/sage_patchbot/util.py` added in this ticket is currently broken. See #29047



---

archive/issue_comments_402902.json:
```json
{
    "body": "Erik, could you please fix that ?",
    "created_at": "2020-01-20T08:24:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402902",
    "user": "https://github.com/fchapoton"
}
```

Erik, could you please fix that ?



---

archive/issue_comments_402903.json:
```json
{
    "body": "ok, fixed in #29047",
    "created_at": "2020-01-20T16:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28571#issuecomment-402903",
    "user": "https://github.com/fchapoton"
}
```

ok, fixed in #29047
