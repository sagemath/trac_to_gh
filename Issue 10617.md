# Issue 10617: Mobius matrices of posets are integer matrices

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2011-01-21 11:17:12

Assignee: sage-combinat

CC:  chapoton sage-combinat

Keywords: poset, matrix

I have noticed the following problem.

```
P=Posets.PentagonPoset()
P.mobius_function_matrix().parent()
Full MatrixSpace of 5 by 5 sparse matrices over Rational Field
```

The Mobius function of a poset should really be an *integer matrix*.


---

Comment by chapoton created at 2011-06-01 13:57:37

Changing status from new to needs_review.


---

Comment by hivert created at 2011-06-02 10:34:35

Hi Frédéric,

Thanks for taking care of this problem.

Here are a few remarks:

 - The field Author below is used to give credits after each release. You
   should put your real name here and not your login.

 - If you think returning a matrix over `QQ` is a bug, then you should
   make sure by a doctest that the bug is indeed fixed, indicating in comment
   the ticket number for this bug.

 - I can easily imagine use cases where the Moebius function is needed over a
   different ring (eg: Z2 or a polynomial field). What about having an
   optional argument `ring` with a default value `ZZ` to avoid
   changing the ring twice ? In this case for consistency,
   `.mobius_function_matrix()` should also take this optional parameter too.
   What do you think ?

Right now, I'm having lunch, but I'll probably find the time to post a review
patch this evening if you don't beat me. If you start working on it please put
a message here so that we avoid doing it twice. Of course I'll do the same. In
any case one of us will have to do some review and the other to write some
code.

Florent


---

Comment by hivert created at 2011-06-02 10:34:35

Remove assignee sage-combinat.


---

Comment by hivert created at 2011-06-02 13:53:35

Changing status from needs_review to needs_work.


---

Comment by hivert created at 2011-06-02 13:53:35

> Right now, I'm having lunch, but I'll probably find the time to post a review
> patch this evening if you don't beat me. If you start working on it please put
> a message here so that we avoid doing it twice. Of course I'll do the same. In
> any case one of us will have to do some review and the other to write some
> code.

I'm on It. Please don't touch anything !


---

Comment by hivert created at 2011-06-02 14:45:26

I reworked the patch. Unfortunately on the way I got a dependency on #10998

Florent


---

Comment by hivert created at 2011-06-02 14:45:26

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2011-06-10 07:42:26

Trying to help the build bot to do its job

Apply trac_10670_integral_mobius_matrix_for_posets-fh.patch


---

Comment by hivert created at 2011-12-03 14:46:40

Set assignee to hivert.


---

Comment by hivert created at 2012-02-06 14:55:12

Changing keywords from "poset, matrix" to "poset, matrix, Cernay2012".


---

Comment by nthiery created at 2012-02-08 12:42:04

We finalized the patch together with Florent.
Positive review on the version I just uploaded, assuming the test pass (I am running them).


---

Comment by nthiery created at 2012-02-09 00:34:17

Changing status from needs_review to positive_review.


---

Comment by nthiery created at 2012-02-09 00:34:17

Except for a timeout in sage/sandpiles/sandpile.py, all tests passed on sage-5.0.beta2 with the following patches applied::

```
trac_11003-folded.patch
trac_10998-categories-posets-nt.patch
trac_10670_integral_mobius_matrix_for_posets-fh.patch
trac_11382-subposet_to_vertex_speedup-fh.patch
trac_12476-lattice_join_matrix_speedup-fh.patch
trac_11118-finite_enumset_list_cache-fh.patch
```


Setting a positive review. Thanks Frédéric and Florent!


---

Attachment


---

Comment by jdemeyer created at 2012-02-22 10:44:33

Resolution: fixed
