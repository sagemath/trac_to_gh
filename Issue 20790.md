# Issue 20790: Add "check" keyword to _module_constructor for additive abelian groups

Issue created by migration from https://trac.sagemath.org/ticket/21027

Original creator: jhpalmieri

Original creation time: 2016-07-14 22:01:37

Currently running `phi.image()` on a morphism of additive abelian groups raises an error

```
TypeError: _module_constructor() got an unexpected keyword argument 'check'
```

This is because the additive abelian group code (in `groups.additive_abelian.additive_abelian_group`) wraps the code for finitely generated modules over a PID (in `module.fg_pid`), and the `image` method calls `_module_constructor` with the argument `check=fgp_module.DEBUG`. The `_module_constructor` method in `fg_pid` accepts such a keyword, but not the corresponding method in `additive_abelian_group`.


---

Comment by jhpalmieri created at 2016-07-14 22:06:41

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2016-07-14 22:06:41

New commits:


---

Comment by tscrim created at 2016-07-14 22:32:06

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-07-14 22:32:06

LGTM.


---

Comment by vbraun created at 2016-07-15 23:31:36

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-07-15 23:31:36


```
sage -t --long src/sage/groups/additive_abelian/additive_abelian_group.py
**********************************************************************
File "src/sage/groups/additive_abelian/additive_abelian_group.py", line 314, in sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor
Failed example:
    sage: G = groups.misc.AdditiveAbelian([2,2,2])
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 860, in compile_and_execute
        compiled = compiler(example)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 497, in <lambda>
        example.source, filename, "single", compileflags, 1)
      File "<doctest sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor[4]>", line 1
        sage: G = groups.misc.AdditiveAbelian([Integer(2),Integer(2),Integer(2)])
            ^
    SyntaxError: invalid syntax
**********************************************************************
File "src/sage/groups/additive_abelian/additive_abelian_group.py", line 315, in sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor
Failed example:
    phi = G.hom([G.0, G.0, G.0])
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 862, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor[5]>", line 1, in <module>
        phi = G.hom([G.gen(0), G.gen(0), G.gen(0)])
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/modules/fg_pid/fgp_module.py", line 1346, in hom
        return self._hom_general(im_gens, check)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/modules/fg_pid/fgp_module.py", line 1388, in _hom_general
        raise ValueError("Images do not determine a valid homomorphism")
    ValueError: Images do not determine a valid homomorphism
**********************************************************************
File "src/sage/groups/additive_abelian/additive_abelian_group.py", line 316, in sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor
Failed example:
    phi.image()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 862, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor[6]>", line 1, in <module>
        phi.image()
    NameError: name 'phi' is not defined
**********************************************************************
1 item had failures:
   3 of   8 in sage.groups.additive_abelian.additive_abelian_group.AdditiveAbelianGroup_class._module_constructor
```



---

Comment by git created at 2016-07-18 04:04:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2016-07-18 04:05:28

Sorry, that was sloppy of me.


---

Comment by jhpalmieri created at 2016-07-18 04:05:28

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-07-19 23:13:07

Resolution: fixed
