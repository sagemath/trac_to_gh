# Issue 22447: pynormaliz fails to build on 32bit system

archive/issues_022447.json:
```json
{
    "body": "CC:  mkoeppe \u200bvdelecroix winfried\n\nSee the attached log.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22684\n\n",
    "created_at": "2017-03-26T19:46:58Z",
    "labels": [
        "packages: optional",
        "major",
        "bug"
    ],
    "title": "pynormaliz fails to build on 32bit system",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22447",
    "user": "tmonteil"
}
```
CC:  mkoeppe ​vdelecroix winfried

See the attached log.

Issue created by migration from https://trac.sagemath.org/ticket/22684





---

archive/issue_comments_312734.json:
```json
{
    "body": "Attachment",
    "created_at": "2017-03-26T19:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312734",
    "user": "tmonteil"
}
```

Attachment



---

archive/issue_comments_312735.json:
```json
{
    "body": "The new upstream version 1.5 has some 32/64-bit work. Could you test this?",
    "created_at": "2017-03-28T02:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312735",
    "user": "mkoeppe"
}
```

The new upstream version 1.5 has some 32/64-bit work. Could you test this?



---

archive/issue_comments_312736.json:
```json
{
    "body": "Changing keywords from \"\" to \"days86\".",
    "created_at": "2017-04-21T05:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312736",
    "user": "tmonteil"
}
```

Changing keywords from "" to "days86".



---

archive/issue_comments_312737.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2017-04-21T05:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312737",
    "user": "tmonteil"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_312738.json:
```json
{
    "body": "Updating `pynormaliz` requires an update of `normaliz`, which installs and self-checks correctly, but i get the following doctest failure:\n\n\n```\n**********************************************************************\nFile \"backend_normaliz.py\", line 500, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points\nFailed example:\n    len(P.integral_points())                                 # optional - pynormaliz\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 503, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 866, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points[14]>\", line 1, in <module>\n        len(P.integral_points())                                 # optional - pynormaliz\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py\", line 578, in integral_points\n        for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    interface_error: std::bad_alloc\n**********************************************************************\n```\n\n----\nNew commits:",
    "created_at": "2017-04-21T05:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312738",
    "user": "tmonteil"
}
```

Updating `pynormaliz` requires an update of `normaliz`, which installs and self-checks correctly, but i get the following doctest failure:


```
**********************************************************************
File "backend_normaliz.py", line 500, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points
Failed example:
    len(P.integral_points())                                 # optional - pynormaliz
Exception raised:
    Traceback (most recent call last):
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 503, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 866, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points[14]>", line 1, in <module>
        len(P.integral_points())                                 # optional - pynormaliz
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py", line 578, in integral_points
        for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    interface_error: std::bad_alloc
**********************************************************************
```

----
New commits:



---

archive/issue_comments_312739.json:
```json
{
    "body": "Thierry, is this doctest failure on a 32-bit platform? \nOn Mac OS X (64-bit), I can't reproduce it.",
    "created_at": "2017-04-22T04:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312739",
    "user": "mkoeppe"
}
```

Thierry, is this doctest failure on a 32-bit platform? 
On Mac OS X (64-bit), I can't reproduce it.



---

archive/issue_comments_312740.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n> Thierry, is this doctest failure on a 32-bit platform? \n> On Mac OS X (64-bit), I can't reproduce it.\n\nSorry for not being clear, i got that on 64bit system (i have to move to pynormaliz 1.5 for 32bits reasons, but it is easier for me to first work on my 64bit laptop). I will try to rebuild.",
    "created_at": "2017-04-22T14:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312740",
    "user": "tmonteil"
}
```

Replying to [comment:6 mkoeppe]:
> Thierry, is this doctest failure on a 32-bit platform? 
> On Mac OS X (64-bit), I can't reproduce it.

Sorry for not being clear, i got that on 64bit system (i have to move to pynormaliz 1.5 for 32bits reasons, but it is easier for me to first work on my 64bit laptop). I will try to rebuild.



---

archive/issue_comments_312741.json:
```json
{
    "body": "I rebuilt normaliz and pynormaliz, i still get the same error (+ some change in the ordering):\n\n\n```\n$ sage -t --long src/sage/geometry/polyhedron/backend_normaliz.py \ntoo few successful tests, not using stored timings\nRunning doctests with ID 2017-04-23-01-20-48-2c49990f.\nGit branch: t/22684/pynormaliz_fails_to_build_on_32bit_system\nUsing --optional=4ti2,d3js,gdb,giacpy_sage,git_trac,latte_int,lidia,lrslib,mpir,normaliz,ore_algebra,pandoc_attributes,pandocfilters,pynormaliz,python2,qepcad,rst2ipynb,saclib,sage\nDoctesting 1 file.\nsage -t --long src/sage/geometry/polyhedron/backend_normaliz.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_normaliz.py\", line 412, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull\nFailed example:\n    set(PI.Vrepresentation())                                # optional - pynormaliz\nExpected:\n    {A vertex at (-1, 0), A vertex at (0, 1), A ray in the direction (1, 0)}\nGot:\n    {A ray in the direction (1, 0), A vertex at (-1, 0), A vertex at (0, 1)}\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_normaliz.py\", line 420, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull\nFailed example:\n    set(PI.Vrepresentation())                                # optional - pynormaliz\nExpected:\n    {A vertex at (1, 0),\n     A ray in the direction (1, 0),\n     A line in the direction (1, -1)}\nGot:\n    {A line in the direction (1, -1),\n     A ray in the direction (1, 0),\n     A vertex at (1, 0)}\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_normaliz.py\", line 500, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points\nFailed example:\n    len(P.integral_points())                                 # optional - pynormaliz\nException raised:\n    Traceback (most recent call last):\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 503, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 866, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points[14]>\", line 1, in <module>\n        len(P.integral_points())                                 # optional - pynormaliz\n      File \"/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py\", line 578, in integral_points\n        for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    interface_error: std::bad_alloc\n**********************************************************************\n2 items had failures:\n   2 of  10 in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull\n   1 of  33 in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points\n    [95 tests, 3 failures, 28.21 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/geometry/polyhedron/backend_normaliz.py  # 3 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 28.4 seconds\n    cpu time: 29.7 seconds\n    cumulative wall time: 28.2 seconds\n```\n",
    "created_at": "2017-04-22T23:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312741",
    "user": "tmonteil"
}
```

I rebuilt normaliz and pynormaliz, i still get the same error (+ some change in the ordering):


```
$ sage -t --long src/sage/geometry/polyhedron/backend_normaliz.py 
too few successful tests, not using stored timings
Running doctests with ID 2017-04-23-01-20-48-2c49990f.
Git branch: t/22684/pynormaliz_fails_to_build_on_32bit_system
Using --optional=4ti2,d3js,gdb,giacpy_sage,git_trac,latte_int,lidia,lrslib,mpir,normaliz,ore_algebra,pandoc_attributes,pandocfilters,pynormaliz,python2,qepcad,rst2ipynb,saclib,sage
Doctesting 1 file.
sage -t --long src/sage/geometry/polyhedron/backend_normaliz.py
**********************************************************************
File "src/sage/geometry/polyhedron/backend_normaliz.py", line 412, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull
Failed example:
    set(PI.Vrepresentation())                                # optional - pynormaliz
Expected:
    {A vertex at (-1, 0), A vertex at (0, 1), A ray in the direction (1, 0)}
Got:
    {A ray in the direction (1, 0), A vertex at (-1, 0), A vertex at (0, 1)}
**********************************************************************
File "src/sage/geometry/polyhedron/backend_normaliz.py", line 420, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull
Failed example:
    set(PI.Vrepresentation())                                # optional - pynormaliz
Expected:
    {A vertex at (1, 0),
     A ray in the direction (1, 0),
     A line in the direction (1, -1)}
Got:
    {A line in the direction (1, -1),
     A ray in the direction (1, 0),
     A vertex at (1, 0)}
**********************************************************************
File "src/sage/geometry/polyhedron/backend_normaliz.py", line 500, in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points
Failed example:
    len(P.integral_points())                                 # optional - pynormaliz
Exception raised:
    Traceback (most recent call last):
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 503, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 866, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points[14]>", line 1, in <module>
        len(P.integral_points())                                 # optional - pynormaliz
      File "/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py", line 578, in integral_points
        for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    interface_error: std::bad_alloc
**********************************************************************
2 items had failures:
   2 of  10 in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_hull
   1 of  33 in sage.geometry.polyhedron.backend_normaliz.Polyhedron_normaliz.integral_points
    [95 tests, 3 failures, 28.21 s]
----------------------------------------------------------------------
sage -t --long src/sage/geometry/polyhedron/backend_normaliz.py  # 3 doctests failed
----------------------------------------------------------------------
Total time for all tests: 28.4 seconds
    cpu time: 29.7 seconds
    cumulative wall time: 28.2 seconds
```




---

archive/issue_comments_312742.json:
```json
{
    "body": "But when i rerun the test, the doctest crashes, i attach the backtrace.",
    "created_at": "2017-04-22T23:41:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312742",
    "user": "tmonteil"
}
```

But when i rerun the test, the doctest crashes, i attach the backtrace.



---

archive/issue_comments_312743.json:
```json
{
    "body": "Attachment\n\nAs far as I can see, 2 of the failzres reported are simply a permutation of the output data. This has nothing to do with Normaliz.\n\nThe crash is another matter. Could I have the input data to run this outside of Sage?\n\nI am not sure whether I can find a genuine 32bit system in my neighborhood, and I don't have a Mac.\n\nIt could be useful to add debugging output in matrix.cpp before line 778 to see the vlaue of nc (number of clolumns of \"this\") because the allocation of the vector w fails.",
    "created_at": "2017-04-23T09:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312743",
    "user": "Winfried"
}
```

Attachment

As far as I can see, 2 of the failzres reported are simply a permutation of the output data. This has nothing to do with Normaliz.

The crash is another matter. Could I have the input data to run this outside of Sage?

I am not sure whether I can find a genuine 32bit system in my neighborhood, and I don't have a Mac.

It could be useful to add debugging output in matrix.cpp before line 778 to see the vlaue of nc (number of clolumns of "this") because the allocation of the vector w fails.



---

archive/issue_comments_312744.json:
```json
{
    "body": "It must be an example with latge numbers because Normaliz calculates with GMP ontegers. It only does this if it is afraid of an overflow or is forced to do it.\n\nThis could explain why the problem arises with 32 bit and not with 64 bit.",
    "created_at": "2017-04-23T09:09:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312744",
    "user": "Winfried"
}
```

It must be an example with latge numbers because Normaliz calculates with GMP ontegers. It only does this if it is afraid of an overflow or is forced to do it.

This could explain why the problem arises with 32 bit and not with 64 bit.



---

archive/issue_comments_312745.json:
```json
{
    "body": "Replying to [comment:11 Winfried]:\n> This could explain why the problem arises with 32 bit and not with 64 bit.\n\nTo clarify: i had top upgrade to 1.5 because pynormaliz 1.0 was not building on 32bit.\n\nHowever, the errors reported on the ticket appear on Debian jessie 64bits.",
    "created_at": "2017-04-23T12:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312745",
    "user": "tmonteil"
}
```

Replying to [comment:11 Winfried]:
> This could explain why the problem arises with 32 bit and not with 64 bit.

To clarify: i had top upgrade to 1.5 because pynormaliz 1.0 was not building on 32bit.

However, the errors reported on the ticket appear on Debian jessie 64bits.



---

archive/issue_comments_312746.json:
```json
{
    "body": "Thanks for the clarification.\n\nBut let me repeat by request: can you please isolate the input data that cause the crash? I am not familiar enough with Sage to do this in reasonable time.",
    "created_at": "2017-04-23T13:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312746",
    "user": "Winfried"
}
```

Thanks for the clarification.

But let me repeat by request: can you please isolate the input data that cause the crash? I am not familiar enough with Sage to do this in reasonable time.



---

archive/issue_comments_312747.json:
```json
{
    "body": "Replying to [comment:13 Winfried]:\n> Thanks for the clarification.\n> \n> But let me repeat by request: can you please isolate the input data that cause the crash? I am not familiar enough with Sage to do this in reasonable time.\n\n\nI will try, but i will first rebuild Sage from scratch on my laptop, just in case. Indeed, this ticket passes on my 32bit VM !",
    "created_at": "2017-04-23T14:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312747",
    "user": "tmonteil"
}
```

Replying to [comment:13 Winfried]:
> Thanks for the clarification.
> 
> But let me repeat by request: can you please isolate the input data that cause the crash? I am not familiar enough with Sage to do this in reasonable time.


I will try, but i will first rebuild Sage from scratch on my laptop, just in case. Indeed, this ticket passes on my 32bit VM !



---

archive/issue_comments_312748.json:
```json
{
    "body": "Winfried, this is the test case. I added `verbose=True`, which displays the PyNormaliz command that the sage code translates to.\n\n```\nsage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)\nsage: P = Polyhedron(vertices=P.vertices_list(),               # optional - pynormaliz\n....:                backend='normaliz', verbose=True)\n# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])\nsage: len(P.integral_points())                                 # optional - pynormaliz\n# Calling PyNormaliz.NmzResult(cone, \"ModuleGenerators\")\n3654\n```\n\n\nThe error that Thierry noticed appears when calling `PyNormaliz.NmzResult(cone, \"ModuleGenerators\")` on this cone. I can't reproduce it on Mac OS, however.",
    "created_at": "2017-04-23T17:28:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312748",
    "user": "mkoeppe"
}
```

Winfried, this is the test case. I added `verbose=True`, which displays the PyNormaliz command that the sage code translates to.

```
sage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)
sage: P = Polyhedron(vertices=P.vertices_list(),               # optional - pynormaliz
....:                backend='normaliz', verbose=True)
# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])
sage: len(P.integral_points())                                 # optional - pynormaliz
# Calling PyNormaliz.NmzResult(cone, "ModuleGenerators")
3654
```


The error that Thierry noticed appears when calling `PyNormaliz.NmzResult(cone, "ModuleGenerators")` on this cone. I can't reproduce it on Mac OS, however.



---

archive/issue_comments_312749.json:
```json
{
    "body": "I have made the following input file for Normaliz:\n\namb_space 2\nvertices\n[[-1, -1, 1000], [-1, 1, 1000],\n [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000],\n [1789344999, 37121001, 1000]]\nModuleGenerators\n\nI get 3654 lattice points. Normaliz uses approximation as desired (by me). There is 1 local transition to GMP, but no global switch to GMP. I will have another look at the backtrace.\n\nFor some reason the formatter puts a question mark behind the last line \"ModuleGenerators\" of the input file.",
    "created_at": "2017-04-23T18:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312749",
    "user": "Winfried"
}
```

I have made the following input file for Normaliz:

amb_space 2
vertices
[[-1, -1, 1000], [-1, 1, 1000],
 [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000],
 [1789344999, 37121001, 1000]]
ModuleGenerators

I get 3654 lattice points. Normaliz uses approximation as desired (by me). There is 1 local transition to GMP, but no global switch to GMP. I will have another look at the backtrace.

For some reason the formatter puts a question mark behind the last line "ModuleGenerators" of the input file.



---

archive/issue_comments_312750.json:
```json
{
    "body": "PS. It could be helpful to run this example in Normaliz with the option -c and to post the terminal output (or to produce he terminal output via PyNormaliz).",
    "created_at": "2017-04-23T18:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312750",
    "user": "Winfried"
}
```

PS. It could be helpful to run this example in Normaliz with the option -c and to post the terminal output (or to produce he terminal output via PyNormaliz).



---

archive/issue_comments_312751.json:
```json
{
    "body": "i rebuilt sage from scratch and the error persists. Here are the details you asked:\n\nIf the file `plop.in` contains:\n\n\n```\namb_space 2\nvertices\n[[-1, -1, 1000], [-1, 1, 1000],\n [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000],\n [1789344999, 37121001, 1000]]\nModuleGenerators\n```\n\n\nrunning `normaliz -c plop.in` from `sage -sh` shell leads to:\n\n\n```\n                                                    \\.....|\n                    Normaliz 3.2.1                   \\....|\n                                                      \\...|\n     (C) The Normaliz Team, University of Osnabrueck   \\..|\n                    February  2017                      \\.|\n                                                         \\|\n************************************************************\nCommand line: -c plop.in \nCompute: ModuleGenerators \n************************************************************\nstarting primal algorithm (only support hyperplanes) ...\nGenerators sorted lexicographically\nStart simplex 1 2 3 \ngen=4, 4 hyp\ngen=5, 5 hyp\ngen=6, 6 hyp\nChecking pointedness ... done.\nSelect extreme rays via comparison ... done.\n------------------------------------------------------------\ntransforming data... done.\nComputing approximating polytope\n************************************************************\nstarting primal algorithm with partial triangulation ...\nRoughness 1\nGenerators sorted by degree and lexicographically\nGenerators per degree:\n1: 12  \nStart simplex 1 2 3 \ngen=4, 4 hyp, 0 simpl\ngen=5, 4 hyp, 0 simpl\ngen=6, 5 hyp, 0 simpl\ngen=7, 5 hyp, 2 simpl\ngen=8, 6 hyp, 3 simpl\ngen=9, 7 hyp, 3 simpl\ngen=10, 6 hyp, 4 simpl\ngen=11, 7 hyp, 4 simpl\ngen=12, 8 hyp, 4 simpl\nPointed since graded\nSelect extreme rays via comparison ... done.\nevaluating 4 simplices\n4 simplices, 3578686 deg1 vectors accumulated.\nTotal number of pyramids = 4, among them simplicial 4\nGMP transitions: matrices 0 hyperplanes 1 vector operations 0\n------------------------------------------------------------\ntransforming data... done.\n```\n\n||||||||||||||||||||||||||||||||||||||||||||||||||\nThe `plop.out` file contains:\n\n\n```\n3654 module generators\n0 Hilbert basis elements of recession monoid\n6 vertices of polyhedron\n0 extreme rays of recession cone\n6 support hyperplanes of polyhedron (homogenized)\n\nembedding dimension = 3\naffine dimension of the polyhedron = 2 (maximal)\nrank of recession monoid = 0\ninternal index = 4000\n\ndehomogenization:\n0 0 1 \n\n\nmodule rank = 3654\n\n***********************************************************************\n\n3654 module generators:\n       0     0 1\n     241     5 1\n     482    10 1\n     723    15 1\n    2603    54 1\n    2844    59 1\n    3085    64 1\n    3326    69 1\n    3567    74 1\n    3808    79 1\n    5688   118 1\n    5929   123 1\n    6170   128 1\n    6411   133 1\n    6652   138 1\n    6893   143 1\n    8773   182 1\n    9014   187 1\n    9255   192 1\n    9496   197 1\n    9737   202 1\n    9978   207 1\n   10219   212 1\n\n[ ... OUTPUT MANUALLY dTRUNCATED ... ]\n\n 1780090 36929 1\n 1780331 36934 1\n 1780572 36939 1\n 1782452 36978 1\n 1782693 36983 1\n 1782934 36988 1\n 1783175 36993 1\n 1783416 36998 1\n 1783657 37003 1\n 1785537 37042 1\n 1785778 37047 1\n 1786019 37052 1\n 1786260 37057 1\n 1786501 37062 1\n 1786742 37067 1\n 1788622 37106 1\n 1788863 37111 1\n 1789104 37116 1\n 1789345 37121 1\n\n0 Hilbert basis elements of recession monoid:\n\n6 vertices of polyhedron:\n         -1       -1 1000\n         -1        1 1000\n          1       -1 1000\n 1789344999 37121001 1000\n 1789345001 37120999 1000\n 1789345001 37121001 1000\n\n0 extreme rays of recession cone:\n\n6 support hyperplanes of polyhedron (homogenized):\n -18560500  894672500     913233\n     -1000          0 1789345001\n         0      -1000   37121001\n         0       1000          1\n      1000          0          1\n  18560500 -894672500     913233\n```\n\n\nRunning the following from #comment:15 within in a Sage shell leads to:\n\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.0.beta2, Release Date: 2017-04-12               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)\nsage: P = Polyhedron(vertices=P.vertices_list(),\n....: backend='normaliz', verbose=True)\n# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])\nsage: len(P.integral_points())\n---------------------------------------------------------------------------\ninterface_error                           Traceback (most recent call last)\n<ipython-input-3-19b874c06a0f> in <module>()\n----> 1 len(P.integral_points())\n\n/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.pyc in integral_points(self, threshold)\n    576         cone = self._normaliz_cone\n    577         assert cone\n--> 578         for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    579             assert g[-1] == 1\n    580             points.append(vector(ZZ, g[:-1]))\n\ninterface_error: std::bad_alloc\n```\n\n\n\nRegarding the question mark, this is because `ModuleGenerators` is camel-case. If you want a block to be displayed raw, just enclose it between triple braces.",
    "created_at": "2017-04-24T01:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312751",
    "user": "tmonteil"
}
```

i rebuilt sage from scratch and the error persists. Here are the details you asked:

If the file `plop.in` contains:


```
amb_space 2
vertices
[[-1, -1, 1000], [-1, 1, 1000],
 [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000],
 [1789344999, 37121001, 1000]]
ModuleGenerators
```


running `normaliz -c plop.in` from `sage -sh` shell leads to:


```
                                                    \.....|
                    Normaliz 3.2.1                   \....|
                                                      \...|
     (C) The Normaliz Team, University of Osnabrueck   \..|
                    February  2017                      \.|
                                                         \|
************************************************************
Command line: -c plop.in 
Compute: ModuleGenerators 
************************************************************
starting primal algorithm (only support hyperplanes) ...
Generators sorted lexicographically
Start simplex 1 2 3 
gen=4, 4 hyp
gen=5, 5 hyp
gen=6, 6 hyp
Checking pointedness ... done.
Select extreme rays via comparison ... done.
------------------------------------------------------------
transforming data... done.
Computing approximating polytope
************************************************************
starting primal algorithm with partial triangulation ...
Roughness 1
Generators sorted by degree and lexicographically
Generators per degree:
1: 12  
Start simplex 1 2 3 
gen=4, 4 hyp, 0 simpl
gen=5, 4 hyp, 0 simpl
gen=6, 5 hyp, 0 simpl
gen=7, 5 hyp, 2 simpl
gen=8, 6 hyp, 3 simpl
gen=9, 7 hyp, 3 simpl
gen=10, 6 hyp, 4 simpl
gen=11, 7 hyp, 4 simpl
gen=12, 8 hyp, 4 simpl
Pointed since graded
Select extreme rays via comparison ... done.
evaluating 4 simplices
4 simplices, 3578686 deg1 vectors accumulated.
Total number of pyramids = 4, among them simplicial 4
GMP transitions: matrices 0 hyperplanes 1 vector operations 0
------------------------------------------------------------
transforming data... done.
```

||||||||||||||||||||||||||||||||||||||||||||||||||
The `plop.out` file contains:


```
3654 module generators
0 Hilbert basis elements of recession monoid
6 vertices of polyhedron
0 extreme rays of recession cone
6 support hyperplanes of polyhedron (homogenized)

embedding dimension = 3
affine dimension of the polyhedron = 2 (maximal)
rank of recession monoid = 0
internal index = 4000

dehomogenization:
0 0 1 


module rank = 3654

***********************************************************************

3654 module generators:
       0     0 1
     241     5 1
     482    10 1
     723    15 1
    2603    54 1
    2844    59 1
    3085    64 1
    3326    69 1
    3567    74 1
    3808    79 1
    5688   118 1
    5929   123 1
    6170   128 1
    6411   133 1
    6652   138 1
    6893   143 1
    8773   182 1
    9014   187 1
    9255   192 1
    9496   197 1
    9737   202 1
    9978   207 1
   10219   212 1

[ ... OUTPUT MANUALLY dTRUNCATED ... ]

 1780090 36929 1
 1780331 36934 1
 1780572 36939 1
 1782452 36978 1
 1782693 36983 1
 1782934 36988 1
 1783175 36993 1
 1783416 36998 1
 1783657 37003 1
 1785537 37042 1
 1785778 37047 1
 1786019 37052 1
 1786260 37057 1
 1786501 37062 1
 1786742 37067 1
 1788622 37106 1
 1788863 37111 1
 1789104 37116 1
 1789345 37121 1

0 Hilbert basis elements of recession monoid:

6 vertices of polyhedron:
         -1       -1 1000
         -1        1 1000
          1       -1 1000
 1789344999 37121001 1000
 1789345001 37120999 1000
 1789345001 37121001 1000

0 extreme rays of recession cone:

6 support hyperplanes of polyhedron (homogenized):
 -18560500  894672500     913233
     -1000          0 1789345001
         0      -1000   37121001
         0       1000          1
      1000          0          1
  18560500 -894672500     913233
```


Running the following from #comment:15 within in a Sage shell leads to:


```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.0.beta2, Release Date: 2017-04-12               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)
sage: P = Polyhedron(vertices=P.vertices_list(),
....: backend='normaliz', verbose=True)
# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])
sage: len(P.integral_points())
---------------------------------------------------------------------------
interface_error                           Traceback (most recent call last)
<ipython-input-3-19b874c06a0f> in <module>()
----> 1 len(P.integral_points())

/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.pyc in integral_points(self, threshold)
    576         cone = self._normaliz_cone
    577         assert cone
--> 578         for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    579             assert g[-1] == 1
    580             points.append(vector(ZZ, g[:-1]))

interface_error: std::bad_alloc
```



Regarding the question mark, this is because `ModuleGenerators` is camel-case. If you want a block to be displayed raw, just enclose it between triple braces.



---

archive/issue_comments_312752.json:
```json
{
    "body": "Thanks, but the problem is now more mysterious. The stand-alone version runs as expected, but the access from Sage fails. Please forget what I said about transition to GMP. I will have a look at the backtrace and the source.",
    "created_at": "2017-04-24T08:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312752",
    "user": "Winfried"
}
```

Thanks, but the problem is now more mysterious. The stand-alone version runs as expected, but the access from Sage fails. Please forget what I said about transition to GMP. I will have a look at the backtrace and the source.



---

archive/issue_comments_312753.json:
```json
{
    "body": "I have analyzed what is going on. As said, the lattice points in this polytope are computed by \"approximatiion\": Normaliz computes the lattice points in an INTEGRAL overpolytope and then selects the ones that lie in the given polytope. This process creates > 3 million lattice points in the overpolytope -- it would actually be better in this case to suppress approximation by --NoApproximation. I will go over this issue anyway in the next days.\n\nCould it be that the access from Sage simply fails because of lack of memory for the > 3 million lattice points that must even coexist in long long and GMP? It might be good to have a look at \"top\" in another window.\n\nstd::bad_alloc is the exception that I see when I run out of memory.",
    "created_at": "2017-04-24T09:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312753",
    "user": "Winfried"
}
```

I have analyzed what is going on. As said, the lattice points in this polytope are computed by "approximatiion": Normaliz computes the lattice points in an INTEGRAL overpolytope and then selects the ones that lie in the given polytope. This process creates > 3 million lattice points in the overpolytope -- it would actually be better in this case to suppress approximation by --NoApproximation. I will go over this issue anyway in the next days.

Could it be that the access from Sage simply fails because of lack of memory for the > 3 million lattice points that must even coexist in long long and GMP? It might be good to have a look at "top" in another window.

std::bad_alloc is the exception that I see when I run out of memory.



---

archive/issue_comments_312754.json:
```json
{
    "body": "Here is what (h)top gives juste before the crash:\n\n\n```\nPID USER      PRI  NI  VIRT   RES   SHR S CPU% MEM%   TIME+  Command\n12752 thierry    20   0 2833M 1038M 44812 S  0.0 21.1  0:01.90 python /opt/sagemath/sage-source/src/bin/sage-runtests --long src/sage/\n12751 thierry    20   0 2833M 1038M 44812 R 99.0 21.1  0:28.30 python /opt/sagemath/sage-source/src/bin/sage-runtests --long src/sage/\n```\n \n\nSo it eats 21% of the RAM (i.e. 1GB out of 5).",
    "created_at": "2017-04-25T15:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312754",
    "user": "tmonteil"
}
```

Here is what (h)top gives juste before the crash:


```
PID USER      PRI  NI  VIRT   RES   SHR S CPU% MEM%   TIME+  Command
12752 thierry    20   0 2833M 1038M 44812 S  0.0 21.1  0:01.90 python /opt/sagemath/sage-source/src/bin/sage-runtests --long src/sage/
12751 thierry    20   0 2833M 1038M 44812 R 99.0 21.1  0:28.30 python /opt/sagemath/sage-source/src/bin/sage-runtests --long src/sage/
```
 

So it eats 21% of the RAM (i.e. 1GB out of 5).



---

archive/issue_comments_312755.json:
```json
{
    "body": "If it is not the memory, then I have no idea at the moment. I personally would insert debugging code in order to locate the cause. Let me know if you are willing to test this. Then I can send you patches. It may of course take several rounds.\n\nFor the next release 3.3.0: I have worked on the function that computes the lattice points in the polytope. It is now much more efficient, and uses much less memory.",
    "created_at": "2017-04-25T15:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312755",
    "user": "Winfried"
}
```

If it is not the memory, then I have no idea at the moment. I personally would insert debugging code in order to locate the cause. Let me know if you are willing to test this. Then I can send you patches. It may of course take several rounds.

For the next release 3.3.0: I have worked on the function that computes the lattice points in the polytope. It is now much more efficient, and uses much less memory.



---

archive/issue_comments_312756.json:
```json
{
    "body": "Sure, i can run tests for you (just tell me the commands to run).",
    "created_at": "2017-04-25T17:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312756",
    "user": "tmonteil"
}
```

Sure, i can run tests for you (just tell me the commands to run).



---

archive/issue_comments_312757.json:
```json
{
    "body": "By the way, i removed the singular stuff from `spkg-install` since i could not find the `Singular` directory in the normaliz tarball, and because the singular stuff was commented in the corresponding Makefiles. I am doing this correctly, or there is something to do for singular support ?",
    "created_at": "2017-04-25T17:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312757",
    "user": "tmonteil"
}
```

By the way, i removed the singular stuff from `spkg-install` since i could not find the `Singular` directory in the normaliz tarball, and because the singular stuff was commented in the corresponding Makefiles. I am doing this correctly, or there is something to do for singular support ?



---

archive/issue_comments_312758.json:
```json
{
    "body": "O.K. I will come send some code for debugging.\n\nI am sure that the Singular stuff has nothing to do with it. Normaliz does not use Singular in any way. It has a Singular library so that it can be accessed from Singular. The data exchange uses files.",
    "created_at": "2017-04-25T17:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312758",
    "user": "Winfried"
}
```

O.K. I will come send some code for debugging.

I am sure that the Singular stuff has nothing to do with it. Normaliz does not use Singular in any way. It has a Singular library so that it can be accessed from Singular. The data exchange uses files.



---

archive/issue_comments_312759.json:
```json
{
    "body": "Replying to [comment:25 Winfried]:\n> I am sure that the Singular stuff has nothing to do with it.\n\nSure, i am just asking whether it was safe to remove the last two lines of `spkg-install` or if there should be some replacing procedure.\n\n> Normaliz does not use Singular in any way. It has a Singular library so that it can be accessed from Singular. The data exchange uses files.\n\nWhat is the current procedure to let Singular know about Normaliz ? It there a replacement for `Singular/normaliz.lib` that was shipped in previous versions ? Or does Singular just detects the existence of a normaliz binary itself now ?",
    "created_at": "2017-04-25T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312759",
    "user": "tmonteil"
}
```

Replying to [comment:25 Winfried]:
> I am sure that the Singular stuff has nothing to do with it.

Sure, i am just asking whether it was safe to remove the last two lines of `spkg-install` or if there should be some replacing procedure.

> Normaliz does not use Singular in any way. It has a Singular library so that it can be accessed from Singular. The data exchange uses files.

What is the current procedure to let Singular know about Normaliz ? It there a replacement for `Singular/normaliz.lib` that was shipped in previous versions ? Or does Singular just detects the existence of a normaliz binary itself now ?



---

archive/issue_comments_312760.json:
```json
{
    "body": "I think it will not do any harm if you the last two lines of spkg/install, but I am not absolutely sure. Matthias should know.\n\nThere is no replacement for Singular/normaliz.lib yet, not even an update. The current version works well with the current version(s) of Normaliz, but cannot use all Normaliz features.\n\nBefore we try any debugging, please rebuild libnormaliz after replacing libnormaliz/cone.cpp, line 3266 by\n\n`const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();`\n\nI was too careless at this pint. The line above should reduce the memory usage since it does no longer copy the matrix, but accesses it via the const reference.",
    "created_at": "2017-04-26T14:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312760",
    "user": "Winfried"
}
```

I think it will not do any harm if you the last two lines of spkg/install, but I am not absolutely sure. Matthias should know.

There is no replacement for Singular/normaliz.lib yet, not even an update. The current version works well with the current version(s) of Normaliz, but cannot use all Normaliz features.

Before we try any debugging, please rebuild libnormaliz after replacing libnormaliz/cone.cpp, line 3266 by

`const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();`

I was too careless at this pint. The line above should reduce the memory usage since it does no longer copy the matrix, but accesses it via the const reference.



---

archive/issue_comments_312761.json:
```json
{
    "body": "Correction: line 3226",
    "created_at": "2017-04-26T14:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312761",
    "user": "Winfried"
}
```

Correction: line 3226



---

archive/issue_comments_312762.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-26T15:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312762",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312763.json:
```json
{
    "body": "I added a patch to implement you suggestion (see the current branch), but the problem persists.",
    "created_at": "2017-04-26T15:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312763",
    "user": "tmonteil"
}
```

I added a patch to implement you suggestion (see the current branch), but the problem persists.



---

archive/issue_comments_312764.json:
```json
{
    "body": "If this can help, i reverted normaliz to 3.1.4, and testing again the suggestion from comment:15 i got something that fails earlier:\n\n\n```\nsage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)\nsage: P = Polyhedron(vertices=P.vertices_list(),\n....: backend='normaliz', verbose=True)\n# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])\npython: malloc.c:3695: _int_malloc: Assertion `(unsigned long) (size) >= (unsigned long) (nb)' failed.\n------------------------------------------------------------------------\n```\n\n\nThen Sage hangs.",
    "created_at": "2017-04-26T16:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312764",
    "user": "tmonteil"
}
```

If this can help, i reverted normaliz to 3.1.4, and testing again the suggestion from comment:15 i got something that fails earlier:


```
sage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)
sage: P = Polyhedron(vertices=P.vertices_list(),
....: backend='normaliz', verbose=True)
# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])
python: malloc.c:3695: _int_malloc: Assertion `(unsigned long) (size) >= (unsigned long) (nb)' failed.
------------------------------------------------------------------------
```


Then Sage hangs.



---

archive/issue_comments_312765.json:
```json
{
    "body": "Again with the normaliz 3.1.4, if i test the comment:16, i got:\n\n\n```\n$ normaliz -c plop.in\n                                                    \\.....|\n                    Normaliz 3.1.4                   \\....|\n                                                      \\...|\n     (C) The Normaliz Team, University of Osnabrueck   \\..|\n                    November  2016                      \\.|\n                                                         \\|\n************************************************************\nCommand line: -c plop.in \nCompute: ModuleGenerators \n************************************************************\nstarting primal algorithm (only support hyperplanes) ...\nGenerators sorted lexicographically\nStart simplex 1 2 3 \ngen=4, 4 hyp\ngen=5, 5 hyp\ngen=6, 6 hyp\nChecking pointedness ... done.\nSelect extreme rays via comparison ... done.\n------------------------------------------------------------\ntransforming data... done.\nComputing approximating polytope\n************************************************************\nstarting primal algorithm with partial triangulation ...\nRoughness 1\nGenerators sorted by degree and lexicographically\nGenerators per degree:\n1: 12  \nStart simplex 1 2 3 \ngen=4, 4 hyp, 0 simpl\ngen=5, 4 hyp, 0 simpl\ngen=6, 5 hyp, 0 simpl\ngen=7, 5 hyp, 2 simpl\ngen=8, 6 hyp, 3 simpl\ngen=9, 7 hyp, 3 simpl\ngen=10, 6 hyp, 4 simpl\ngen=11, 7 hyp, 4 simpl\ngen=12, 8 hyp, 4 simpl\nPointed since graded\nSelect extreme rays via comparison ... done.\nevaluating 4 simplices\n4 simplices, 3578686 deg1 vectors accumulated.\nTotal number of pyramids = 4, among them simplicial 4\nGMP transitions: matrices 0 hyperplanes 1 vector operations 0\n------------------------------------------------------------\ntransforming data... done.\nErreur de segmentation\n```\n\n||||||||||||||||||||||||||||||||||||||||||||||||||\n(note the last line that means `Segmentation Fault` in french).\n\nand the produced `plop.out` ends with:\n\n\n```\n 1786501 37062 1\n 1786742 37067 1\n 1788622 37106 1\n 1788863 37111 1\n 1789104 37116 1\n 1789345 37121 1\n\n0 Hilbert basis elements of recession monoid:\n\n6 vertices of polyhedron:\n         -1       -1 1000\n         -1        1 1000\n          1       -1 1000\n 1789344999 37121001 1000\n 1789345001 37120999 1000\n 1789345001 37121001 1000\n\n0 extreme rays of recession cone:\n\n6 support hyperplanes of polyhedron (homogenized):\n -18560500  894672500     913233\n     -1000          0 1789345001\n         0      -1000   37121001\n         0       1000          1\n      1000          0          1\n  18560500 -894672500     913233\n\n3 basis elements of lattice:\n 1 0 0\n 0 1 0\n 0 0 1\n```\n",
    "created_at": "2017-04-26T16:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312765",
    "user": "tmonteil"
}
```

Again with the normaliz 3.1.4, if i test the comment:16, i got:


```
$ normaliz -c plop.in
                                                    \.....|
                    Normaliz 3.1.4                   \....|
                                                      \...|
     (C) The Normaliz Team, University of Osnabrueck   \..|
                    November  2016                      \.|
                                                         \|
************************************************************
Command line: -c plop.in 
Compute: ModuleGenerators 
************************************************************
starting primal algorithm (only support hyperplanes) ...
Generators sorted lexicographically
Start simplex 1 2 3 
gen=4, 4 hyp
gen=5, 5 hyp
gen=6, 6 hyp
Checking pointedness ... done.
Select extreme rays via comparison ... done.
------------------------------------------------------------
transforming data... done.
Computing approximating polytope
************************************************************
starting primal algorithm with partial triangulation ...
Roughness 1
Generators sorted by degree and lexicographically
Generators per degree:
1: 12  
Start simplex 1 2 3 
gen=4, 4 hyp, 0 simpl
gen=5, 4 hyp, 0 simpl
gen=6, 5 hyp, 0 simpl
gen=7, 5 hyp, 2 simpl
gen=8, 6 hyp, 3 simpl
gen=9, 7 hyp, 3 simpl
gen=10, 6 hyp, 4 simpl
gen=11, 7 hyp, 4 simpl
gen=12, 8 hyp, 4 simpl
Pointed since graded
Select extreme rays via comparison ... done.
evaluating 4 simplices
4 simplices, 3578686 deg1 vectors accumulated.
Total number of pyramids = 4, among them simplicial 4
GMP transitions: matrices 0 hyperplanes 1 vector operations 0
------------------------------------------------------------
transforming data... done.
Erreur de segmentation
```

||||||||||||||||||||||||||||||||||||||||||||||||||
(note the last line that means `Segmentation Fault` in french).

and the produced `plop.out` ends with:


```
 1786501 37062 1
 1786742 37067 1
 1788622 37106 1
 1788863 37111 1
 1789104 37116 1
 1789345 37121 1

0 Hilbert basis elements of recession monoid:

6 vertices of polyhedron:
         -1       -1 1000
         -1        1 1000
          1       -1 1000
 1789344999 37121001 1000
 1789345001 37120999 1000
 1789345001 37121001 1000

0 extreme rays of recession cone:

6 support hyperplanes of polyhedron (homogenized):
 -18560500  894672500     913233
     -1000          0 1789345001
         0      -1000   37121001
         0       1000          1
      1000          0          1
  18560500 -894672500     913233

3 basis elements of lattice:
 1 0 0
 0 1 0
 0 0 1
```




---

archive/issue_comments_312766.json:
```json
{
    "body": "I will try the computation in 3.1.4. So far no idea where the segmentation fault comes from.\n\nIt is difficult to have an idea why Normaliz standalone works and then the computations fail within `PyNormaliz/Sage`. With 3.1.4 the computation takes another route than with 3.2.1 (it is the route that you get in 3.2.1 with the option `--NoSymmetrization`). \n\nLet us stick to 3.2.1. Tomorrow I will send some code that could us closer to the problem.\n\nNext week Sebastian Gutsche will visit me. He has written `PyNormaliz`.",
    "created_at": "2017-04-26T17:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312766",
    "user": "Winfried"
}
```

I will try the computation in 3.1.4. So far no idea where the segmentation fault comes from.

It is difficult to have an idea why Normaliz standalone works and then the computations fail within `PyNormaliz/Sage`. With 3.1.4 the computation takes another route than with 3.2.1 (it is the route that you get in 3.2.1 with the option `--NoSymmetrization`). 

Let us stick to 3.2.1. Tomorrow I will send some code that could us closer to the problem.

Next week Sebastian Gutsche will visit me. He has written `PyNormaliz`.



---

archive/issue_comments_312767.json:
```json
{
    "body": "On version 3.1.4:\n\nThe failure shown in comment:31 is caused by Python, not by Normaliz. I will show it to Sebastian Gutsche.\n\nThe segmentation fault in comment:32 does not show up in my system. Can you produce a gdb backtrace?\n\nA correction: for this example 4.1.4 = 3.2.1 with `--NoApproximation.`",
    "created_at": "2017-04-27T07:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312767",
    "user": "Winfried"
}
```

On version 3.1.4:

The failure shown in comment:31 is caused by Python, not by Normaliz. I will show it to Sebastian Gutsche.

The segmentation fault in comment:32 does not show up in my system. Can you produce a gdb backtrace?

A correction: for this example 4.1.4 = 3.2.1 with `--NoApproximation.`



---

archive/issue_comments_312768.json:
```json
{
    "body": "For 3.2.1 I suggest to first find out when the problem comes up. Please replace the block starting at line 2437 in cone.cpp by the following. It just inserts a counter. (This is of course meant only for debugging.) If the computation runs successfully, then 3578698 is the last value shown. According to the backtrace you sent, you will not reach it.\n\n\n```\n    if (FC.isComputed(ConeProperty::Deg1Elements)) {\n        Deg1Elements = Matrix<Integer>(0,dim);\n        typename list< vector<IntegerFC> >::const_iterator DFC(FC.Deg1_Elements.begin());\n        vector<Integer> tmp;\n        long counter=0;\n        for (; DFC != FC.Deg1_Elements.end(); ++DFC) {\n            counter++; cout << counter << endl;\n            BasisChangePointed.convert_from_sublattice(tmp,*DFC);                \n            Deg1Elements.append(tmp);\n        }\n        Deg1Elements.sort_by_weights(WeightsGrad,GradAbs);\n        is_Computed.set(ConeProperty::Deg1Elements);\n    }\n```\n",
    "created_at": "2017-04-27T08:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312768",
    "user": "Winfried"
}
```

For 3.2.1 I suggest to first find out when the problem comes up. Please replace the block starting at line 2437 in cone.cpp by the following. It just inserts a counter. (This is of course meant only for debugging.) If the computation runs successfully, then 3578698 is the last value shown. According to the backtrace you sent, you will not reach it.


```
    if (FC.isComputed(ConeProperty::Deg1Elements)) {
        Deg1Elements = Matrix<Integer>(0,dim);
        typename list< vector<IntegerFC> >::const_iterator DFC(FC.Deg1_Elements.begin());
        vector<Integer> tmp;
        long counter=0;
        for (; DFC != FC.Deg1_Elements.end(); ++DFC) {
            counter++; cout << counter << endl;
            BasisChangePointed.convert_from_sublattice(tmp,*DFC);                
            Deg1Elements.append(tmp);
        }
        Deg1Elements.sort_by_weights(WeightsGrad,GradAbs);
        is_Computed.set(ConeProperty::Deg1Elements);
    }
```




---

archive/issue_comments_312769.json:
```json
{
    "body": "Replying to [comment:34 Winfried]:\n> On version 3.1.4:\n> \n> The failure shown in comment:31 is caused by Python, not by Normaliz. I will show it to Sebastian Gutsche.\n> \n> The segmentation fault in comment:32 does not show up in my system. Can you produce a gdb backtrace?\n\n\nI do not know much about gdb, so after reading some webpages i ran this command from a `sage -sh` shell (please tell me if i am wrong):\n\n\n```\n$ gdb --args /opt/sagemath/sage/local/bin/normaliz -c plop.in\n```\n\n\nAnd then i typed\n\n\n```\n(gdb) run\n```\n\n\nThis leads to this output:\n\n\n```\nStarting program: /opt/sagemath/sage-source/local/bin/normaliz -c plop.in\nGot object file from memory but can't read symbols: Fichier tronqu\u00e9.\nwarning: Could not load shared library symbols for linux-vdso.so.1.\nDo you need \"set solib-search-path\" or \"set sysroot\"?\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n                                                    \\.....|\n                    Normaliz 3.1.4                   \\....|\n                                                      \\...|\n     (C) The Normaliz Team, University of Osnabrueck   \\..|\n                    November  2016                      \\.|\n                                                         \\|\n************************************************************\nCommand line: -c plop.in \nCompute: ModuleGenerators \n************************************************************\nstarting primal algorithm (only support hyperplanes) ...\nGenerators sorted lexicographically\nStart simplex 1 2 3 \n[New Thread 0x7ffff6591700 (LWP 8292)]\ngen=4, 4 hyp\ngen=5, 5 hyp\ngen=6, 6 hyp\nChecking pointedness ... done.\nSelect extreme rays via comparison ... done.\n------------------------------------------------------------\ntransforming data... done.\nComputing approximating polytope\n************************************************************\nstarting primal algorithm with partial triangulation ...\nRoughness 1\nGenerators sorted by degree and lexicographically\nGenerators per degree:\n1: 12  \nStart simplex 1 2 3 \ngen=4, 4 hyp, 0 simpl\ngen=5, 4 hyp, 0 simpl\ngen=6, 5 hyp, 0 simpl\ngen=7, 5 hyp, 2 simpl\ngen=8, 6 hyp, 3 simpl\ngen=9, 7 hyp, 3 simpl\ngen=10, 6 hyp, 4 simpl\ngen=11, 7 hyp, 4 simpl\ngen=12, 8 hyp, 4 simpl\nPointed since graded\nSelect extreme rays via comparison ... done.\nevaluating 4 simplices\n4 simplices, 3578686 deg1 vectors accumulated.\nTotal number of pyramids = 4, among them simplicial 4\nGMP transitions: matrices 0 hyperplanes 1 vector operations 0\n------------------------------------------------------------\ntransforming data... done.\n||||||||||||||||||||||||||||||||||||||||||||||||||\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000000000 in ?? ()\n```\n\n\nThen if i type :\n\n\n```\n(gdb) backtrace \n```\n\n\ni got:\n\n\n```\n#0  0x0000000000000000 in ?? ()\n#1  0x0000000000000000 in ?? ()\n```\n\n\nThe plop.out is similar to the previous one (comment:32).\n\nBy the way, notice that the plop.out in the comment:32 (with normaliz  3.1.4) has the following additional lines, that the  comment:18 (with normaliz  3.2.1) does not have:\n\n\n```\n\n3 basis elements of lattice:\n 1 0 0\n 0 1 0\n 0 0 1\n\n```\n",
    "created_at": "2017-04-27T09:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312769",
    "user": "tmonteil"
}
```

Replying to [comment:34 Winfried]:
> On version 3.1.4:
> 
> The failure shown in comment:31 is caused by Python, not by Normaliz. I will show it to Sebastian Gutsche.
> 
> The segmentation fault in comment:32 does not show up in my system. Can you produce a gdb backtrace?


I do not know much about gdb, so after reading some webpages i ran this command from a `sage -sh` shell (please tell me if i am wrong):


```
$ gdb --args /opt/sagemath/sage/local/bin/normaliz -c plop.in
```


And then i typed


```
(gdb) run
```


This leads to this output:


```
Starting program: /opt/sagemath/sage-source/local/bin/normaliz -c plop.in
Got object file from memory but can't read symbols: Fichier tronqué.
warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
                                                    \.....|
                    Normaliz 3.1.4                   \....|
                                                      \...|
     (C) The Normaliz Team, University of Osnabrueck   \..|
                    November  2016                      \.|
                                                         \|
************************************************************
Command line: -c plop.in 
Compute: ModuleGenerators 
************************************************************
starting primal algorithm (only support hyperplanes) ...
Generators sorted lexicographically
Start simplex 1 2 3 
[New Thread 0x7ffff6591700 (LWP 8292)]
gen=4, 4 hyp
gen=5, 5 hyp
gen=6, 6 hyp
Checking pointedness ... done.
Select extreme rays via comparison ... done.
------------------------------------------------------------
transforming data... done.
Computing approximating polytope
************************************************************
starting primal algorithm with partial triangulation ...
Roughness 1
Generators sorted by degree and lexicographically
Generators per degree:
1: 12  
Start simplex 1 2 3 
gen=4, 4 hyp, 0 simpl
gen=5, 4 hyp, 0 simpl
gen=6, 5 hyp, 0 simpl
gen=7, 5 hyp, 2 simpl
gen=8, 6 hyp, 3 simpl
gen=9, 7 hyp, 3 simpl
gen=10, 6 hyp, 4 simpl
gen=11, 7 hyp, 4 simpl
gen=12, 8 hyp, 4 simpl
Pointed since graded
Select extreme rays via comparison ... done.
evaluating 4 simplices
4 simplices, 3578686 deg1 vectors accumulated.
Total number of pyramids = 4, among them simplicial 4
GMP transitions: matrices 0 hyperplanes 1 vector operations 0
------------------------------------------------------------
transforming data... done.
||||||||||||||||||||||||||||||||||||||||||||||||||
Program received signal SIGSEGV, Segmentation fault.
0x0000000000000000 in ?? ()
```


Then if i type :


```
(gdb) backtrace 
```


i got:


```
#0  0x0000000000000000 in ?? ()
#1  0x0000000000000000 in ?? ()
```


The plop.out is similar to the previous one (comment:32).

By the way, notice that the plop.out in the comment:32 (with normaliz  3.1.4) has the following additional lines, that the  comment:18 (with normaliz  3.2.1) does not have:


```

3 basis elements of lattice:
 1 0 0
 0 1 0
 0 0 1

```




---

archive/issue_comments_312770.json:
```json
{
    "body": "Replying to [comment:35 Winfried]:\n> For 3.2.1 I suggest to first find out when the problem comes up. Please replace the block starting at line 2437 in cone.cpp by the following. It just inserts a counter. (This is of course meant only for debugging.) If the computation runs successfully, then 3578698 is the last value shown. According to the backtrace you sent, you will not reach it.\n> \n> {{{\n>     if (FC.isComputed(ConeProperty::Deg1Elements)) {\n>         Deg1Elements = Matrix<Integer>(0,dim);\n>         typename list< vector<IntegerFC> >::const_iterator DFC(FC.Deg1_Elements.begin());\n>         vector<Integer> tmp;\n>         long counter=0;\n>         for (; DFC != FC.Deg1_Elements.end(); ++DFC) {\n>             counter++; cout << counter << endl;\n>             BasisChangePointed.convert_from_sublattice(tmp,*DFC);                \n>             Deg1Elements.append(tmp);\n>         }\n>         Deg1Elements.sort_by_weights(WeightsGrad,GradAbs);\n>         is_Computed.set(ConeProperty::Deg1Elements);\n>     }\n> }}}\n\n\nI will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?",
    "created_at": "2017-04-27T09:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312770",
    "user": "tmonteil"
}
```

Replying to [comment:35 Winfried]:
> For 3.2.1 I suggest to first find out when the problem comes up. Please replace the block starting at line 2437 in cone.cpp by the following. It just inserts a counter. (This is of course meant only for debugging.) If the computation runs successfully, then 3578698 is the last value shown. According to the backtrace you sent, you will not reach it.
> 
> {{{
>     if (FC.isComputed(ConeProperty::Deg1Elements)) {
>         Deg1Elements = Matrix<Integer>(0,dim);
>         typename list< vector<IntegerFC> >::const_iterator DFC(FC.Deg1_Elements.begin());
>         vector<Integer> tmp;
>         long counter=0;
>         for (; DFC != FC.Deg1_Elements.end(); ++DFC) {
>             counter++; cout << counter << endl;
>             BasisChangePointed.convert_from_sublattice(tmp,*DFC);                
>             Deg1Elements.append(tmp);
>         }
>         Deg1Elements.sort_by_weights(WeightsGrad,GradAbs);
>         is_Computed.set(ConeProperty::Deg1Elements);
>     }
> }}}


I will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?



---

archive/issue_comments_312771.json:
```json
{
    "body": "Replying to [comment:36 tmonteil]:\n> Replying to [comment:34 Winfried]:\n \n> I do not know much about gdb, so after reading some webpages i ran this command from a `sage -sh` shell (please tell me if i am wrong):\n> \n> {{{\n> $ gdb --args /opt/sagemath/sage/local/bin/normaliz -c plop.in\n> }}}\n> \n> And then i typed\n> \n> {{{\n> (gdb) run\n> }}}\nAbsolutely correct.\n> \n> This leads to this output:\n\n...\n\n> \n> \n> Program received signal SIGSEGV, Segmentation fault.\n> 0x0000000000000000 in ?? ()\n> }}}\n> \n> Then if i type :\n> \n> {{{\n> (gdb) backtrace \n> }}}\n> \n> i got:\n> \n> {{{\n> #0  0x0000000000000000 in ?? ()\n> #1  0x0000000000000000 in ?? ()\n> }}}\n> \nHard to tell where the segmentation fault occurs. Does not lokk like Normaliz.\n\n> The plop.out is similar to the previous one (comment:32).\n> \n> By the way, notice that the plop.out in the comment:32 (with normaliz  3.1.4) has the following additional lines, that the  comment:18 (with normaliz  3.2.1) does not have:\n> \n> {{{\n> \n> 3 basis elements of lattice:\n>  1 0 0\n>  0 1 0\n>  0 0 1\n> \n> }}}\n\nI will check why the lattice basis is shown. It is of course correct, but should only show up if it is not the trivial one. At least the newer version has the expected behavior.",
    "created_at": "2017-04-27T10:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312771",
    "user": "Winfried"
}
```

Replying to [comment:36 tmonteil]:
> Replying to [comment:34 Winfried]:
 
> I do not know much about gdb, so after reading some webpages i ran this command from a `sage -sh` shell (please tell me if i am wrong):
> 
> {{{
> $ gdb --args /opt/sagemath/sage/local/bin/normaliz -c plop.in
> }}}
> 
> And then i typed
> 
> {{{
> (gdb) run
> }}}
Absolutely correct.
> 
> This leads to this output:

...

> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x0000000000000000 in ?? ()
> }}}
> 
> Then if i type :
> 
> {{{
> (gdb) backtrace 
> }}}
> 
> i got:
> 
> {{{
> #0  0x0000000000000000 in ?? ()
> #1  0x0000000000000000 in ?? ()
> }}}
> 
Hard to tell where the segmentation fault occurs. Does not lokk like Normaliz.

> The plop.out is similar to the previous one (comment:32).
> 
> By the way, notice that the plop.out in the comment:32 (with normaliz  3.1.4) has the following additional lines, that the  comment:18 (with normaliz  3.2.1) does not have:
> 
> {{{
> 
> 3 basis elements of lattice:
>  1 0 0
>  0 1 0
>  0 0 1
> 
> }}}

I will check why the lattice basis is shown. It is of course correct, but should only show up if it is not the trivial one. At least the newer version has the expected behavior.



---

archive/issue_comments_312772.json:
```json
{
    "body": "Regarding comment:35 and comment:37 (on 3.2.1) i kept the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` change.\n\nThe last number i got is 2680870. I will attach the backtrace as `crash.comment_39.log`.",
    "created_at": "2017-04-27T10:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312772",
    "user": "tmonteil"
}
```

Regarding comment:35 and comment:37 (on 3.2.1) i kept the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` change.

The last number i got is 2680870. I will attach the backtrace as `crash.comment_39.log`.



---

archive/issue_comments_312773.json:
```json
{
    "body": "Attachment\n\nReplying to [comment:37 tmonteil]:\n \n> I will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?\n\nYes",
    "created_at": "2017-04-27T10:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312773",
    "user": "Winfried"
}
```

Attachment

Replying to [comment:37 tmonteil]:
 
> I will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?

Yes



---

archive/issue_comments_312774.json:
```json
{
    "body": "Replying to [comment:40 Winfried]:\n> Replying to [comment:37 tmonteil]:\n>  \n> > I will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?\n> \n> Yes\n\nOK, this si what i did (see comment:39).",
    "created_at": "2017-04-27T10:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312774",
    "user": "tmonteil"
}
```

Replying to [comment:40 Winfried]:
> Replying to [comment:37 tmonteil]:
>  
> > I will try this. Should i keep the `const Matrix<Integer>& Raw=ApproxCone.getDeg1ElementsMatrix();` suggested in comment:27 ?
> 
> Yes

OK, this si what i did (see comment:39).



---

archive/issue_comments_312775.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-27T10:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312775",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312776.json:
```json
{
    "body": "I added the patch corresponding to the test to the current branch for information and if people want to try.",
    "created_at": "2017-04-27T10:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312776",
    "user": "tmonteil"
}
```

I added the patch corresponding to the test to the current branch for information and if people want to try.



---

archive/issue_comments_312777.json:
```json
{
    "body": "Let us continue our experiment. I still assume that you are facing a memory problem. The current line 2445 of cone.cpp is\n\n```  \n           Deg1Elements.append(tmp);\n```\n\nWe double it to\n\n```  \n           Deg1Elements.append(tmp);\n           Deg1Elements.append(tmp);\n```\n\nThis means that every vector is stored twice at this point. This will give a wrong result, but that is irrelevant at the moment. If the conjecture on memory holds true, then you should reach only a considerably smaller value of the counter.",
    "created_at": "2017-04-27T12:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312777",
    "user": "Winfried"
}
```

Let us continue our experiment. I still assume that you are facing a memory problem. The current line 2445 of cone.cpp is

```  
           Deg1Elements.append(tmp);
```

We double it to

```  
           Deg1Elements.append(tmp);
           Deg1Elements.append(tmp);
```

This means that every vector is stored twice at this point. This will give a wrong result, but that is irrelevant at the moment. If the conjecture on memory holds true, then you should reach only a considerably smaller value of the counter.



---

archive/issue_comments_312778.json:
```json
{
    "body": "This time i go until 2671113, i do not get a crash, but a bad_alloc catched by the interface, here are the last lines:\n\n\n```\n2671112\n2671113\n---------------------------------------------------------------------------\ninterface_error                           Traceback (most recent call last)\n<ipython-input-3-19b874c06a0f> in <module>()\n----> 1 len(P.integral_points())\n\n/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py in integral_points(self, threshold)\n    576         cone = self._normaliz_cone\n    577         assert cone\n--> 578         for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    579             assert g[-1] == 1\n    580             points.append(vector(ZZ, g[:-1]))\n\ninterface_error: std::bad_alloc\n```\n\n\nIf i re-run the `sage: len(P.integral_points())` command again, from the same Sage command line, it only goes to 82:\n\n\n```\n79\n80\n81\n82\n---------------------------------------------------------------------------\ninterface_error                           Traceback (most recent call last)\n<ipython-input-4-19b874c06a0f> in <module>()\n----> 1 len(P.integral_points())\n\n/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py in integral_points(self, threshold)\n    576         cone = self._normaliz_cone\n    577         assert cone\n--> 578         for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    579             assert g[-1] == 1\n    580             points.append(vector(ZZ, g[:-1]))\n\ninterface_error: std::bad_alloc\n```\n",
    "created_at": "2017-04-27T14:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312778",
    "user": "tmonteil"
}
```

This time i go until 2671113, i do not get a crash, but a bad_alloc catched by the interface, here are the last lines:


```
2671112
2671113
---------------------------------------------------------------------------
interface_error                           Traceback (most recent call last)
<ipython-input-3-19b874c06a0f> in <module>()
----> 1 len(P.integral_points())

/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py in integral_points(self, threshold)
    576         cone = self._normaliz_cone
    577         assert cone
--> 578         for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    579             assert g[-1] == 1
    580             points.append(vector(ZZ, g[:-1]))

interface_error: std::bad_alloc
```


If i re-run the `sage: len(P.integral_points())` command again, from the same Sage command line, it only goes to 82:


```
79
80
81
82
---------------------------------------------------------------------------
interface_error                           Traceback (most recent call last)
<ipython-input-4-19b874c06a0f> in <module>()
----> 1 len(P.integral_points())

/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.py in integral_points(self, threshold)
    576         cone = self._normaliz_cone
    577         assert cone
--> 578         for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    579             assert g[-1] == 1
    580             points.append(vector(ZZ, g[:-1]))

interface_error: std::bad_alloc
```




---

archive/issue_comments_312779.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-27T14:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312779",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312780.json:
```json
{
    "body": "Let us try to go one step further.\n\nThe std::bad_alloc exception shown by crash.log occurs when the vector w in line 778 of matrix.cpp is to be allocated:\n\n`    vector<Integer> w(nc,0);`\n\nThe only reason why this could fail because of a Normaliz bug is a corrupted value of nc (the number of columns of the matrix *this). Therefore I suggest to insert\n\n`    cout << nc << endl;`\n\nbefore this line. When our counter starts running, its printed value must always be followed by 4 (in the critical example). If there is a 4 immediately before the exception is thrown, then the std::bad_alloc is a system problem.",
    "created_at": "2017-04-28T14:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312780",
    "user": "Winfried"
}
```

Let us try to go one step further.

The std::bad_alloc exception shown by crash.log occurs when the vector w in line 778 of matrix.cpp is to be allocated:

`    vector<Integer> w(nc,0);`

The only reason why this could fail because of a Normaliz bug is a corrupted value of nc (the number of columns of the matrix *this). Therefore I suggest to insert

`    cout << nc << endl;`

before this line. When our counter starts running, its printed value must always be followed by 4 (in the critical example). If there is a 4 immediately before the exception is thrown, then the std::bad_alloc is a system problem.



---

archive/issue_comments_312781.json:
```json
{
    "body": "Here is how it ends:\n\n\n```\nsage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)\n....: P = Polyhedron(vertices=P.vertices_list(), backend='normaliz', verbose=True)\n....: len(P.integral_points())\n....: \n# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])\n3\n3\n3\n3\n3\n3\n3\n\n[snip]\n\n2698103\n4\n2698104\n4\n2698105\n4\n2698106\n4\n2698107\n4\n2698108\n4\n2698109\n4\n2698110\n4\n---------------------------------------------------------------------------\ninterface_error                           Traceback (most recent call last)\n<ipython-input-1-2df9fc6cdad6> in <module>()\n      1 P = Polyhedron(vertices=((Integer(0), Integer(0)), (Integer(1789345),Integer(37121)))) + Integer(1)/Integer(1000)*polytopes.hypercube(Integer(2))\n      2 P = Polyhedron(vertices=P.vertices_list(), backend='normaliz', verbose=True)\n----> 3 len(P.integral_points())\n\n/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.pyc in integral_points(self, threshold)\n    576         cone = self._normaliz_cone\n    577         assert cone\n--> 578         for g in PyNormaliz.NmzResult(cone, \"ModuleGenerators\"):\n    579             assert g[-1] == 1\n    580             points.append(vector(ZZ, g[:-1]))\n\ninterface_error: std::bad_alloc\n```\n\n\nSo indeed, the last thing before the exception is a 4.",
    "created_at": "2017-05-03T12:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312781",
    "user": "tmonteil"
}
```

Here is how it ends:


```
sage: P = Polyhedron(vertices=((0, 0), (1789345,37121))) + 1/1000*polytopes.hypercube(2)
....: P = Polyhedron(vertices=P.vertices_list(), backend='normaliz', verbose=True)
....: len(P.integral_points())
....: 
# Calling PyNormaliz.NmzCone(['vertices', [[-1, -1, 1000], [-1, 1, 1000], [1, -1, 1000], [1789345001, 37121001, 1000], [1789345001, 37120999, 1000], [1789344999, 37121001, 1000]], 'cone', [], 'subspace', []])
3
3
3
3
3
3
3

[snip]

2698103
4
2698104
4
2698105
4
2698106
4
2698107
4
2698108
4
2698109
4
2698110
4
---------------------------------------------------------------------------
interface_error                           Traceback (most recent call last)
<ipython-input-1-2df9fc6cdad6> in <module>()
      1 P = Polyhedron(vertices=((Integer(0), Integer(0)), (Integer(1789345),Integer(37121)))) + Integer(1)/Integer(1000)*polytopes.hypercube(Integer(2))
      2 P = Polyhedron(vertices=P.vertices_list(), backend='normaliz', verbose=True)
----> 3 len(P.integral_points())

/opt/sagemath/sage-source/local/lib/python2.7/site-packages/sage/geometry/polyhedron/backend_normaliz.pyc in integral_points(self, threshold)
    576         cone = self._normaliz_cone
    577         assert cone
--> 578         for g in PyNormaliz.NmzResult(cone, "ModuleGenerators"):
    579             assert g[-1] == 1
    580             points.append(vector(ZZ, g[:-1]))

interface_error: std::bad_alloc
```


So indeed, the last thing before the exception is a 4.



---

archive/issue_comments_312782.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-03T12:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312782",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312783.json:
```json
{
    "body": "If i understand your last comment, it is a system problem. I upgraded my kernel and libc (Debian jessie), rebooted, and rebuilt normaliz but the problem persists. Is there something to do ? Does this mean that the problem comes from my computer and not from the normaliz code ?",
    "created_at": "2017-05-05T06:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312783",
    "user": "tmonteil"
}
```

If i understand your last comment, it is a system problem. I upgraded my kernel and libc (Debian jessie), rebooted, and rebuilt normaliz but the problem persists. Is there something to do ? Does this mean that the problem comes from my computer and not from the normaliz code ?



---

archive/issue_comments_312784.json:
```json
{
    "body": "I really don't think that the problem comes from the Normaliz code. The last think Normaliz tries to do is to correctly allocate a vector with 4 components, and the system responds by a std::bad_alloc. I am not a system expert. The only explanation I can think of is that you run out of memory.",
    "created_at": "2017-05-05T13:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312784",
    "user": "Winfried"
}
```

I really don't think that the problem comes from the Normaliz code. The last think Normaliz tries to do is to correctly allocate a vector with 4 components, and the system responds by a std::bad_alloc. I am not a system expert. The only explanation I can think of is that you run out of memory.



---

archive/issue_comments_312785.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-06T11:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312785",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_312786.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-06T15:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312786",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312787.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-06T16:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312787",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_312788.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-05-06T16:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312788",
    "user": "tmonteil"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_312789.json:
```json
{
    "body": "Replying to [comment:51 Winfried]:\n> I really don't think that the problem comes from the Normaliz code. The last think Normaliz tries to do is to correctly allocate a vector with 4 components, and the system responds by a std::bad_alloc. I am not a system expert. The only explanation I can think of is that you run out of memory.\n\nYou are right, it seems that the weirdness of the error came from a ulimit (3GB for Sage) i set to protect the memory of my computer. If i remove it, then the process goes until my computer freezes out of memory.\n\nHence, i reduced the size of the culprit polytope by a factor 10 in one direction (hope it is still illustrative, please tell me).\n\nAlso, i kept the patch suggested at comment:27.",
    "created_at": "2017-05-06T16:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312789",
    "user": "tmonteil"
}
```

Replying to [comment:51 Winfried]:
> I really don't think that the problem comes from the Normaliz code. The last think Normaliz tries to do is to correctly allocate a vector with 4 components, and the system responds by a std::bad_alloc. I am not a system expert. The only explanation I can think of is that you run out of memory.

You are right, it seems that the weirdness of the error came from a ulimit (3GB for Sage) i set to protect the memory of my computer. If i remove it, then the process goes until my computer freezes out of memory.

Hence, i reduced the size of the culprit polytope by a factor 10 in one direction (hope it is still illustrative, please tell me).

Also, i kept the patch suggested at comment:27.



---

archive/issue_comments_312790.json:
```json
{
    "body": "The checksum for pynormaliz is wrong.",
    "created_at": "2017-05-07T04:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312790",
    "user": "mkoeppe"
}
```

The checksum for pynormaliz is wrong.



---

archive/issue_comments_312791.json:
```json
{
    "body": "Replying to [comment:55 tmonteil]:\n> i reduced the size of the culprit polytope by a factor 10 in one direction (hope it is still illustrative, please tell me).\n\nYes, I agree with this change.",
    "created_at": "2017-05-07T04:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312791",
    "user": "mkoeppe"
}
```

Replying to [comment:55 tmonteil]:
> i reduced the size of the culprit polytope by a factor 10 in one direction (hope it is still illustrative, please tell me).

Yes, I agree with this change.



---

archive/issue_comments_312792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-07T07:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312792",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312793.json:
```json
{
    "body": "Weird indeed. I checked: the current tarball contains:\n\n\n```\nPyNormaliz-1.5/\nPyNormaliz-1.5/README\nPyNormaliz-1.5/PyNormaliz.py\nPyNormaliz-1.5/COPYING\nPyNormaliz-1.5/GPLv2\nPyNormaliz-1.5/NormalizModule.cpp\nPyNormaliz-1.5/PKG-INFO\nPyNormaliz-1.5/setup.py\n```\n\n\nwhile the previous contains:\n\n\n```\nPyNormaliz-1.5/\nPyNormaliz-1.5/.gitignore\nPyNormaliz-1.5/.travis-install.sh\nPyNormaliz-1.5/.travis-test.sh\nPyNormaliz-1.5/.travis.yml\nPyNormaliz-1.5/COPYING\nPyNormaliz-1.5/GPLv2\nPyNormaliz-1.5/MANIFEST.in\nPyNormaliz-1.5/Makefile\nPyNormaliz-1.5/NormalizModule.cpp\nPyNormaliz-1.5/PyNormaliz.py\nPyNormaliz-1.5/README\nPyNormaliz-1.5/Readme.md\nPyNormaliz-1.5/examples/\nPyNormaliz-1.5/examples/PyNormaliz_Tutorial.ipynb\nPyNormaliz-1.5/examples/first.py\nPyNormaliz-1.5/examples/first_long.py\nPyNormaliz-1.5/examples/simple.py\nPyNormaliz-1.5/setup.py\n```\n\n\nThe common files are the same. I updated the checksums but perhaps something went wrong there.",
    "created_at": "2017-05-07T07:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312793",
    "user": "tmonteil"
}
```

Weird indeed. I checked: the current tarball contains:


```
PyNormaliz-1.5/
PyNormaliz-1.5/README
PyNormaliz-1.5/PyNormaliz.py
PyNormaliz-1.5/COPYING
PyNormaliz-1.5/GPLv2
PyNormaliz-1.5/NormalizModule.cpp
PyNormaliz-1.5/PKG-INFO
PyNormaliz-1.5/setup.py
```


while the previous contains:


```
PyNormaliz-1.5/
PyNormaliz-1.5/.gitignore
PyNormaliz-1.5/.travis-install.sh
PyNormaliz-1.5/.travis-test.sh
PyNormaliz-1.5/.travis.yml
PyNormaliz-1.5/COPYING
PyNormaliz-1.5/GPLv2
PyNormaliz-1.5/MANIFEST.in
PyNormaliz-1.5/Makefile
PyNormaliz-1.5/NormalizModule.cpp
PyNormaliz-1.5/PyNormaliz.py
PyNormaliz-1.5/README
PyNormaliz-1.5/Readme.md
PyNormaliz-1.5/examples/
PyNormaliz-1.5/examples/PyNormaliz_Tutorial.ipynb
PyNormaliz-1.5/examples/first.py
PyNormaliz-1.5/examples/first_long.py
PyNormaliz-1.5/examples/simple.py
PyNormaliz-1.5/setup.py
```


The common files are the same. I updated the checksums but perhaps something went wrong there.



---

archive/issue_comments_312794.json:
```json
{
    "body": "In the next version 3.3.0 the algorithm that computes the lattice points in this example will be significantly improved. In particular it will use less memory by discarding superfluous vectors as early as possible (and not as late as possible).",
    "created_at": "2017-05-07T08:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312794",
    "user": "Winfried"
}
```

In the next version 3.3.0 the algorithm that computes the lattice points in this example will be significantly improved. In particular it will use less memory by discarding superfluous vectors as early as possible (and not as late as possible).



---

archive/issue_comments_312795.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-07T16:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312795",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_312796.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-11T21:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312796",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_312797.json:
```json
{
    "body": "Changing keywords from \"days86\" to \"days86, sdl\".",
    "created_at": "2019-08-26T12:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22447#issuecomment-312797",
    "user": "tmonteil"
}
```

Changing keywords from "days86" to "days86, sdl".
