# Issue 10161: sage-location: "update" library files the first time this is run

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2010-10-23 21:14:10

Assignee: GeorgSWeber

CC:  leif

If you build Sage but do not run it, then the script sage-location does not get run, so the file sage-location.txt does not get written.  So if you move the Sage install directory before running it, the paths in the files SAGE_ROOT/local/lib/*.la are not correct.  The attached patch updates the paths in those files if the file sage-location.txt does not exist.

(I'm marking this "minor" since it's not likely to happen at all frequently.  When it does happen, it can screw things up pretty badly, though.)


---

Comment by jhpalmieri created at 2010-10-23 21:15:07

scripts repo


---

Comment by jhpalmieri created at 2010-10-23 21:15:14

Changing status from new to needs_review.


---

Attachment


---

Comment by leif created at 2010-10-23 22:28:31

Except that the file's name is `sage-current-location.txt`...

Good catch by the way, I assumed it was an even larger, perhaps OS-related problem.


---

Comment by leif created at 2010-10-23 22:28:31

Changing status from needs_review to positive_review.


---

Comment by leif created at 2010-10-26 23:01:07

Personal note (or to whom it may concern): ;-)

 * Open a follow-up to also improve `sage-sage`:
   * Check exit code of `sage-location` before running `sage-upgrade`, too.
   * Call `sage-location` also before running `sage-spkg`.
   * Trap `SIGINT` while running `sage-location`(?) (such that we end up in a defined state in case it gets interrupted; perhaps requires further modification of `sage-location` as well)

 * Open a follow-up to make `sage-location` a bit verbose? (aids debugging)

(I'm happy with *this* ticket as is, therefore further changes like the above should IMHO be made on follow-up tickets.)


---

Comment by jdemeyer created at 2010-11-01 10:17:52

Resolution: fixed


---

Comment by leif created at 2010-11-02 17:18:31

See #10202 for a follow-up (regarding *when* `sage-location` is called [first], and especially patching / "initializing" pkg-config's `.pc` files).
