# Issue 22344: lack of service_identity Python package creates doctest failure

Issue created by migration from https://trac.sagemath.org/ticket/22581

Original creator: vdelecroix

Original creation time: 2017-03-11 09:08:12

CC:  mderickx

On a fresh build of Sage, the test suite break at many places with complaints from `service_identity` not being installed.

See also:
- [comment:22 in #21006](https://trac.sagemath.org/ticket/21006#comment:22)
- [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/Wu7vbnlOydE)


---

Comment by vdelecroix created at 2017-03-11 09:08:24

Changing keywords from "" to "days84".


---

Comment by jdemeyer created at 2017-03-11 16:17:24

Details please... in particular can you show the actual doctest failure that you get?


---

Comment by vbraun created at 2017-03-14 23:30:32

I'll go out on a limb and say that whatever this is, its not a blocker.


---

Comment by vbraun created at 2017-03-14 23:30:32

Changing priority from blocker to major.


---

Comment by jdemeyer created at 2017-10-04 14:56:33

Changing priority from major to blocker.


---

Comment by jdemeyer created at 2017-10-04 14:56:33

Changing component from packages: standard to packages: optional.


---

Comment by vdelecroix created at 2017-10-04 16:29:13

The description in #23540 that you decided to close as duplicate contains much more information than the one here...


---

Comment by mderickx created at 2017-10-04 20:09:01

This would be a trivial fix if sage's pip packages allowed for dependencies, but this is something that needs to be implemented a.f.a.i.k..


---

Comment by jdemeyer created at 2017-10-05 08:11:26

`pip` packages do support dependencies just like any other package. But you cannot have a dependency _on_ a `pip` package, so `service_identity` should be an optional package.


---

Comment by jdemeyer created at 2017-10-05 09:48:45

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-10-05 09:48:45

New commits:


---

Comment by mderickx created at 2017-10-07 19:13:43

Hi Jeroen,

I started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .


---

Comment by jdemeyer created at 2017-10-09 09:35:07

Replying to [comment:13 mderickx]:
> Hi Jeroen,
> 
> I started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .

They are a special case just like `pip` packages. Essentially, a `script` package is a package without sources: the `spkg-install` file is just run as a script.


---

Comment by vdelecroix created at 2017-11-10 19:32:36

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2017-11-10 19:32:36

At least it fixes the issue for my configuration. Setting to positive review.


---

Comment by vbraun created at 2017-11-15 01:24:17

Resolution: fixed
