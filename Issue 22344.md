# Issue 22344: lack of service_identity Python package creates doctest failure

archive/issues_022344.json:
```json
{
    "body": "CC:  mderickx\n\nOn a fresh build of Sage, the test suite break at many places with complaints from `service_identity` not being installed.\n\nSee also:\n- [comment:22 in #21006](https://trac.sagemath.org/ticket/21006#comment:22)\n- [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/Wu7vbnlOydE)\n\nIssue created by migration from https://trac.sagemath.org/ticket/22581\n\n",
    "created_at": "2017-03-11T09:08:12Z",
    "labels": [
        "packages: standard",
        "blocker",
        "bug"
    ],
    "title": "lack of service_identity Python package creates doctest failure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22344",
    "user": "vdelecroix"
}
```
CC:  mderickx

On a fresh build of Sage, the test suite break at many places with complaints from `service_identity` not being installed.

See also:
- [comment:22 in #21006](https://trac.sagemath.org/ticket/21006#comment:22)
- [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/Wu7vbnlOydE)

Issue created by migration from https://trac.sagemath.org/ticket/22581





---

archive/issue_comments_310606.json:
```json
{
    "body": "Changing keywords from \"\" to \"days84\".",
    "created_at": "2017-03-11T09:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310606",
    "user": "vdelecroix"
}
```

Changing keywords from "" to "days84".



---

archive/issue_comments_310607.json:
```json
{
    "body": "Details please... in particular can you show the actual doctest failure that you get?",
    "created_at": "2017-03-11T16:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310607",
    "user": "jdemeyer"
}
```

Details please... in particular can you show the actual doctest failure that you get?



---

archive/issue_comments_310608.json:
```json
{
    "body": "I'll go out on a limb and say that whatever this is, its not a blocker.",
    "created_at": "2017-03-14T23:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310608",
    "user": "vbraun"
}
```

I'll go out on a limb and say that whatever this is, its not a blocker.



---

archive/issue_comments_310609.json:
```json
{
    "body": "Changing priority from blocker to major.",
    "created_at": "2017-03-14T23:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310609",
    "user": "vbraun"
}
```

Changing priority from blocker to major.



---

archive/issue_comments_310610.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2017-10-04T14:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310610",
    "user": "jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_310611.json:
```json
{
    "body": "Changing component from packages: standard to packages: optional.",
    "created_at": "2017-10-04T14:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310611",
    "user": "jdemeyer"
}
```

Changing component from packages: standard to packages: optional.



---

archive/issue_comments_310612.json:
```json
{
    "body": "The description in #23540 that you decided to close as duplicate contains much more information than the one here...",
    "created_at": "2017-10-04T16:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310612",
    "user": "vdelecroix"
}
```

The description in #23540 that you decided to close as duplicate contains much more information than the one here...



---

archive/issue_comments_310613.json:
```json
{
    "body": "This would be a trivial fix if sage's pip packages allowed for dependencies, but this is something that needs to be implemented a.f.a.i.k..",
    "created_at": "2017-10-04T20:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310613",
    "user": "mderickx"
}
```

This would be a trivial fix if sage's pip packages allowed for dependencies, but this is something that needs to be implemented a.f.a.i.k..



---

archive/issue_comments_310614.json:
```json
{
    "body": "`pip` packages do support dependencies just like any other package. But you cannot have a dependency *on* a `pip` package, so `service_identity` should be an optional package.",
    "created_at": "2017-10-05T08:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310614",
    "user": "jdemeyer"
}
```

`pip` packages do support dependencies just like any other package. But you cannot have a dependency *on* a `pip` package, so `service_identity` should be an optional package.



---

archive/issue_comments_310615.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-05T09:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310615",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310616.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-05T09:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310616",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_310617.json:
```json
{
    "body": "Hi Jeroen,\n\nI started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .",
    "created_at": "2017-10-07T19:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310617",
    "user": "mderickx"
}
```

Hi Jeroen,

I started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .



---

archive/issue_comments_310618.json:
```json
{
    "body": "Replying to [comment:13 mderickx]:\n> Hi Jeroen,\n> \n> I started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .\n\nThey are a special case just like `pip` packages. Essentially, a `script` package is a package without sources: the `spkg-install` file is just run as a script.",
    "created_at": "2017-10-09T09:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310618",
    "user": "jdemeyer"
}
```

Replying to [comment:13 mderickx]:
> Hi Jeroen,
> 
> I started to review this ticket, and the install script looks ok, but what are 'script' type packages? They are not mentioned in http://doc.sagemath.org/html/en/developer/packaging.html , and from reading the source code are also not listed by sage.misc.package.list_packages .

They are a special case just like `pip` packages. Essentially, a `script` package is a package without sources: the `spkg-install` file is just run as a script.



---

archive/issue_comments_310619.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-10T19:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310619",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310620.json:
```json
{
    "body": "At least it fixes the issue for my configuration. Setting to positive review.",
    "created_at": "2017-11-10T19:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310620",
    "user": "vdelecroix"
}
```

At least it fixes the issue for my configuration. Setting to positive review.



---

archive/issue_comments_310621.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-11-15T01:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22344#issuecomment-310621",
    "user": "vbraun"
}
```

Resolution: fixed
