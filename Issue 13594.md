# Issue 13594: q-Bernoulli numbers of Carlitz

Issue created by migration from https://trac.sagemath.org/ticket/13798

Original creator: chapoton

Original creation time: 2012-12-05 12:44:35

Assignee: sage-combinat

Keywords: bernoulli

Leonard Carlitz has introduced q-analogues of Bernoulli numbers in 

* Carlitz, L: q-Bernoulli numbers and polynomials. Duke Math J. 15, 987–1000 (1948)

* Carlitz, L: q-Bernoulli and Eulerian numbers. Trans Am Soc. 76, 332–350 (1954)

These q-Bernoulli numbers are fractions in q, that give the usual Bernoulli numbers when q=1.

A patch to compute them is in preparation.


---

Comment by chapoton created at 2012-12-06 08:31:55

Changing status from new to needs_review.


---

Comment by fwclarke created at 2012-12-06 11:51:40

Changing status from needs_review to needs_work.


---

Comment by fwclarke created at 2012-12-06 11:51:40

I believe the code implements Carlitz's definition accurately.  It's difficult to see how it could easily be speeded up.  

Just a few improvements are needed, I think.

* As in the code for classical Bernoulli numbers, the definition ought to start with the lines
  {{{
        from sage.rings.all import Integer
        m = Integer(m)
  }}}
  This allows the argument to be an `int`, which is compatible with `gaussian_binomial`, letting users write things like
  {{{
[q_bernoulli(i) for i in range(13)]
  }}}
  and gives a less confusing error message for
  {{{
q_bernoulli(1/2)
}}}

* To make `q_bernoulli` even more compatible with `gaussian_binomial` it would be worth having a second argument, defaulting to a the polynomial generator `q`.  [Actually `q_binomial(4, 2, 1)` raises a `ZeroDivisionError` at present.  I'll raise a ticket for this.]

* It would be worth citing Carlitz's 1948 paper in the docstring.

* I would write "q-analogue of the Bernoulli numbers" (one analogue, many numbers).


---

Comment by chapoton created at 2012-12-06 16:02:15

I have made some corrections and enhancements.

I would prefer not to add the optional choice of the value of q. Indeed, in the computation, one has to divide by `q^n -1` for many n. One would therefore had to ensure that q is not a root of unity. I prefer to have a procedure that clearly work with an indeterminate q.

Note that my principal aim is speed.


---

Comment by chapoton created at 2012-12-06 16:03:18

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2013-02-27 19:58:09

Here is a new patch:

* I have added the possibility to evaluate at another point, like for q_binomials.
* I have enhanced the references, using #14011.

Please review !


---

Comment by fwclarke created at 2013-03-01 09:30:30

Just a few trivia:


```
Bernoulli number `B_n`
```

needs to be 

```
Bernoulli number `B_m`
```


I think "rational function of" would be better than "fraction in", and then "function is" rather than "fraction is".

For compatibility with `gaussian_binomial` it would be preferable if the optional argument was called `q` rather than `p`.


---

Comment by fwclarke created at 2013-03-01 09:30:30

Changing status from needs_review to needs_work.


---

Attachment


---

Comment by chapoton created at 2013-03-01 09:44:04

Here is a corrected patch.

I have not changed the name of the optional argument from p to q, because the optional parameter of q_binomial is also called p.


---

Comment by chapoton created at 2013-03-01 09:44:04

Changing status from needs_work to needs_review.


---

Comment by fwclarke created at 2013-03-01 10:45:56

Changing status from needs_review to positive_review.


---

Comment by fwclarke created at 2013-03-01 10:45:56

Yes, it's fine now. 

 I wasn't aware of `q_binomial` and the other functions hidden away in `combinat/q_analogues.py`.  Shouldn't they be more widely available?  In particular `gaussian_binomial` ought to use the `q_binomial` code because it's significantly faster.  I still prefer `q` to `p` though!


---

Comment by chapoton created at 2013-03-01 11:07:40

Thanks for the review. 

I was not aware of the gaussian_binomial function.


---

Comment by jdemeyer created at 2013-03-04 07:36:17

Resolution: fixed
