# Issue 29040: Incidence matrix method doesnt work for G = DiGraph({0: ['a']})

Issue created by migration from https://trac.sagemath.org/ticket/29277

Original creator: @vipul79321

Original creation time: 2020-03-03 19:24:28

CC:  dcoudert

Current behavior:

```
sage: G = DiGraph({0: ['a']})
sage: G.incidence_matrix()
Traceback (most recent call last)
...
TypeError: '<' not supported between instances of 'int' and 'str'
```


incidence_matrix method should be able to handle the case when vertices are of mismatched types.


---

Comment by dcoudert created at 2020-03-04 09:06:03

When vertices are of different types, a solution is to give as input an ordering of the vertices

```
sage: G = DiGraph({0: ['a']})
sage: G.incidence_matrix(vertices=[0, 'a'])
[-1]
[ 1]
sage: G.incidence_matrix(vertices=list(G))
[ 1]
[-1]
```

and we will have to proceed with #22349 to stop sorting vertices and edges by default (not easy).


---

Comment by @vipul79321 created at 2020-03-07 17:29:55

Replying to [comment:1 dcoudert]:
> When vertices are of different types, a solution is to give as input an ordering of the vertices
> {{{
> sage: G = DiGraph({0: ['a']})
> sage: G.incidence_matrix(vertices=[0, 'a'])
> [-1]
> [ 1]
> sage: G.incidence_matrix(vertices=list(G))
> [ 1]
> [-1]
> }}}
> and we will have to proceed with #22349 to stop sorting vertices and edges by default (not easy).
I was wondering why can't we make the following changes:
Instead of calling `self.vertices()`, we can call `self.vertices(sort=False)` which will solve our problem. And then we can modify doc-tests and documentation accordingly.\\

Also, We are kind of expecting the same behavior as above from fixing of #22349


---

Comment by dcoudert created at 2020-03-08 13:19:25

We did a hard work on the graph module to make it compatible with Python3. We let this case for compatibility with other codes for the moment. The compromise was to introduce parameter `vertices`.
Also, I prefer to first deprecate default sorting of vertices and edges before changing the behavior of this method. Meanwhile, we can document the issue in the doctests of the method to should that it is better to specify the order of vertices and edges.


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-04-07 19:29:15

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.
