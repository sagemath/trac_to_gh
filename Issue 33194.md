# Issue 33194: Category of submodules of sage.modules.free_module.FreeModule_ambient_pid

Issue created by migration from https://trac.sagemath.org/ticket/33431

Original creator: mkoeppe

Original creation time: 2022-02-28 23:37:24

CC:  tscrim @louisng114


```
sage: (QQ^2).submodule([[1,1]])
Vector space of degree 2 and dimension 1 over Rational Field
Basis matrix:
[1 1]
sage: _.category()
Category of finite dimensional vector spaces with basis over (number fields and quotient fields and metric spaces)
```


`Subobjects` is missing, so the standard methods `ambient`, `lift`, `retract` are missing. 

This is in contrast to `CombinatorialFreeModule`.


(There is a class-specific method `ambient_module` though.)


---

Comment by git created at 2022-09-01 05:21:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-09-01 05:29:42

Changing status from new to needs_review.


---

Comment by git created at 2022-09-04 23:25:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-09-05 14:08:41

LGTM other than catching `Exception` seems quite broad and might hide bugs. Could we make that more refined?


---

Comment by mkoeppe created at 2022-09-05 14:14:19

I generally agree (and specifically it did hide a bug, just fixed in 8230736!) but this is copied directly from `Module_free_ambient.__init__` and I don't have special insights to what it should be tightened.


---

Comment by tscrim created at 2022-09-05 14:16:53

I would do the standard ones: `ValueError`, `TypeError`, `AttributeError`, and maybe `NotImplementedError`. If it is raising something outside of these (such as an `assert`) then it almost certainly should be another issue to address.


---

Comment by git created at 2022-09-05 15:21:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-09-05 15:21:36

OK. I've made this change (in both places)


---

Comment by mkoeppe created at 2022-09-05 15:36:42


```
+        if category is None:
+            from sage.categories.modules_with_basis import ModulesWithBasis
+            category = ModulesWithBasis(R.category()).FiniteDimensional()
+            try:
+                if R.is_finite() or len(basis) == 0:
+                    category = category.Enumerated().Finite()
+            except (ValueError, TypeError, AttributeError, NotImplementedError):
+                pass
+        category = category.Subobjects()
```

I guess I should probably change this to `category &= ModulesWithBasis(R.category()).Subobjects()`?


---

Comment by tscrim created at 2022-09-06 02:27:47

That would probably be better since it is not promising to be, e.g., a subalgebra.


---

Comment by git created at 2022-09-06 04:33:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-09-07 04:23:54

Thanks. LGTM.


---

Comment by tscrim created at 2022-09-07 04:23:54

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-09-07 04:34:43

Thank you!


---

Comment by vbraun created at 2022-09-20 20:23:10

Resolution: fixed
