# Issue 13428: Fix latex display of arguments of symbolic functions

Issue created by migration from Trac.

Original creator: gouezel

Original creation time: 2012-10-20 14:34:05

Assignee: burcin

In sage 5.3, if the arguments of a symbolic function have no _latex_ attribute, an exception is raised if one tries to latex it:

```
sage: P=function('P',x)
sage: latex(P(x=int(0)))
Traceback (click to the left of this block for traceback)
...
AttributeError: 'int' object has no attribute '_latex_'
```


This is fixed in the attached patch.




---

Attachment


---

Comment by gouezel created at 2012-10-20 15:11:15

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-10-21 01:37:03

Wow, that's a pretty simple fix, but it looks right.  I am a little concerned about the following:

```
sage: type(latex(x))
<class 'sage.misc.latex.LatexExpr'>
sage: type(x._latex_())
<type 'str'>
```

Will that cause any problem/slow things down, or is this actually an improvement?

```
sage: L = [4,x,3.4]
sage: timeit("' '.join([z._latex_() for z in L])")
625 loops, best of 3: 10.1 µs per loop
sage: timeit("' '.join([latex(z) for z in L])")
625 loops, best of 3: 17 µs per loop
```

Naturally fixing the bug is good, just wondering if there is any slick way to avoid turning things into LatexExpr and back to strings - or maybe a try/except thing catching the attribute error?

Otherwise this looks like a good idea and nice fix.


---

Comment by gouezel created at 2012-10-21 12:26:37

It is certainly possible to avoid the conversion from string to LatexExpr and then back to string. However, simply trying x._latex_() and catching an exception will not suffice, since _latex_() is broken in some cases where it exists (see has_latex_attr in latex.py). So, one would need to duplicate part of the code of latex() (more precisely, the first few lines of Latex.__call__).

Since latex output should never be speed-critical (it is supposed to be read by humans, right?), I would rather stay with the current version of the patch to avoid code duplication and keep it as simple as possible.


---

Comment by burcin created at 2012-10-22 00:11:44

I agree that the overhead of typesetting an equation is not really important for the usual user. If you're doing this a lot when typesetting a book it might be an issue, but I'm willing to risk it. I'm switching to positive review.

Thanks a lot for the quick patch!


---

Comment by burcin created at 2012-10-22 00:11:44

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-10-30 16:16:15

Resolution: fixed
