# Issue 19045: Operators expander in categories

Issue created by migration from Trac.

Original creator: elixyre

Original creation time: 2015-09-24 19:23:24

CC:  zabrocki nthiery vdelecroix

In Sage, mathematical structures as dendrifom algebras, algebras with internal product, _etc_ involve to implement operators in several class. For example, if I wish define a new amazing operator `foo` in the category `CategoryOfSomeWonderfulStructures`, I have to do that:


```python
        class CategoryOfSomeWonderfulStructures(Category):

            def super_categories(self):
                return [...]

            class ParentMethods:

                def foo(self, I):
                    '''
                    My amazing unary operator with definition
                    '''

            class ElementMethods:

                def foo(self):
                    '''
                    My amazing unary operator applied
                    '''
                    return self.parent().foo(self)

            class WithRealizations(WithRealizationsCategory):
                class ParentMethods:

                    def foo(self, I):
                        return self.a_realization().foo(I)

            class Realizations(RealizationsCategory):
                class ParentMethods:

                    def foo_by_coercion(self, I):
                        ... looking for the good realizations which knows how to do


            class WithBasis(CategoryWithAxiom_over_base_ring):
                class ParentMethods:

                    `@`abstract_method
                    def foo_on_basis(self, i):
                        pass

                    def foo_by_linearity(self, I):
                        return self.linear_combination(...)
```


I propose to provide two methods (one for unary operator and one other for binary operator) such that the implementation could be resume to 


```python
        class CategoryOfSomeWonderfulStructures(Category):

            def super_categories(self):
                return [...]

            class ParentMethods:

                def foo(self, I):
                    '''
                    My amazing unary operator with definition
                    '''

        expand_unary_operator(CategoryOfSomeWonderfulStructures, CategoryOfSomeWonderfulStructures.ParentMethods.foo)
```



---

Comment by elixyre created at 2015-09-24 19:27:08

I don't put it in need review because my english documentation is poor but... my code and my test should be good. 
So... please improve my english :-).

(And if you think that the code could be factorize to use one function parameterize by the arity... do it!!!)


---

Comment by zabrocki created at 2015-09-25 03:25:26

Changing type from PLEASE CHANGE to enhancement.


---

Comment by zabrocki created at 2015-09-25 03:25:26

A number of previously implemented Hopf algebras could be greatly simplified with this code.  In QSym alone the methods: `internal_product`, `skew_by`, `duality_pairing`, `degree_negation`, `counit`, and probably a few others follow this pattern.
