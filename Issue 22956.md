# Issue 22956: some_elements is non-deterministic for function fields

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2017-06-09 07:41:29

Keywords: sd86.5

This should return some "typical" elements that are good for testing. Just random elements is a bit unfortunate because we are missing elements such as 0, 1, x, 1/x, â€¦

```
sage: K.<x> = FunctionField(QQ)
sage: K.some_elements()
[(x^2 - x - 1)/(-11/4*x^2 - x),
 (-x^2 - 1)/(-x - 1),
 (2/217*x^2 + 6*x - 3)/(-23*x^2 - 1/6*x - 2)]
sage: K.some_elements()
[-2*x - 1/7,
 (-x + 1)/(-2*x^2 + 2/3*x + 1/8),
 (x^2 + x - 1)/(-1/3*x^2 - 1/2*x - 35)]
```




---

Comment by hwsmith created at 2017-06-10 01:01:57

Changing status from new to needs_review.


---

Comment by git created at 2017-06-10 01:16:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-10 01:51:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-06-10 07:06:29

Sorry, I said something incorrect about this earlier, claiming that this would only affect rational function fields. This actually gets called as well for extensions of function fields, so you can never simply divide by the generator or something like that sadly.

Here is an idea how you could probably elegantly rewrite this and do so without putting some random constants in the code here. `self._ring` is the polynomial ring underlying the function field (i.e., if you have `K(x)`, then this would be `K[x]` and if you have `K(x)[y]/(f)`, then this would be `K(x)[y]`.) So you could just take numerators and denominators from this ring, i.e., do two nested for-loops (say `a`, `b`) that go through `self._ring.some_elements()`, check whether `self(b) != 0` and if so add `self(a)/self(b)` to a list that you then return. What do you think?

You might want to also check that `a != b` and `a != 0` to avoid duplicates in that list and then add [0,1] to the list manually.


---

Comment by saraedum created at 2017-06-10 07:06:59

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-06-27 21:35:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-06-27 21:35:32

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-07-20 21:47:39

Changing keywords from "sd86.5" to "sd86.5, sd87, beginner".


---

Comment by fli created at 2017-07-21 19:05:08

Doctests pass.


---

Comment by fli created at 2017-07-21 19:05:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-08-03 22:11:33

Resolution: fixed


---

Comment by chapoton created at 2017-08-23 12:48:41

WARNING: this is causing the doctests of function_field to be VERY LONG (10 minutes) !

So please truncate this long list of some_elements to a much shorter list, until the doctest time is less than one minute.

See https://groups.google.com/forum/#!topic/sage-release/mSHCqsHpdkA


---

Comment by saraedum created at 2017-08-23 13:16:42

I guess there was no reason to delete the commit here?
Ok. Let's fix this in a followup ticket.


---

Comment by saraedum created at 2017-08-23 13:17:26

Hm...but there seems to be no way of putting the commit back in.


---

Comment by chapoton created at 2017-08-23 13:17:36

The commit deletion is automatic when editing a close ticket, and should not be a problem.


---

Comment by saraedum created at 2017-08-23 13:18:47

I created #23683 to speed up function field tests.
