# Issue 16766: Upgrade ECL to 13.5.1

archive/issues_016766.json:
```json
{
    "body": "CC:  @kiwifb jpflori\n\nKeywords: ecl\n\nTarball: http://pub.math.leidenuniv.nl/~bruinpj/sage/ecl-13.5.1.tar.bz2\n\nIssue created by migration from https://trac.sagemath.org/ticket/17003\n\n",
    "created_at": "2014-09-18T07:26:19Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Upgrade ECL to 13.5.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16766",
    "user": "https://github.com/pjbruin"
}
```
CC:  @kiwifb jpflori

Keywords: ecl

Tarball: http://pub.math.leidenuniv.nl/~bruinpj/sage/ecl-13.5.1.tar.bz2

Issue created by migration from https://trac.sagemath.org/ticket/17003





---

archive/issue_comments_221447.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-18T08:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221447",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221448.json:
```json
{
    "body": "We have to force rebuild of maxima after the upgrade and I think there are minor doctest failures that are caused by the upgrade namely a few like this one:\n\n```\nsage -t --long /usr/share/sage/src/sage/interfaces/maxima_lib.py\n**********************************************************************\nFile \"/usr/share/sage/src/sage/interfaces/maxima_lib.py\", line 902, in sage.interfaces.maxima_lib.MaximaLib.sr_limit\nFailed example:\n    limit(x^a,x=0)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Computation failed ...\n    Is a an integer?\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 843, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.maxima_lib.MaximaLib.sr_limit[7]>\", line 1, in <module>\n        limit(x**a,x=Integer(0))\n      File \"/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py\", line 1251, in limit\n        l = maxima.sr_limit(ex, v, a)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 952, in sr_limit\n        self._missing_assumption(s)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 997, in _missing_assumption\n        raise ValueError(outstr)\n    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)\n    Is a an ?integer?\n**********************************************************************\n```\n\nNot sure if the blank line cause the failure but \"?integer?\" instead of \"integer?\" probably does. I am not sure what the \"?\" is for. There is at least another doctest failing that way.",
    "created_at": "2014-09-18T08:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221448",
    "user": "https://github.com/kiwifb"
}
```

We have to force rebuild of maxima after the upgrade and I think there are minor doctest failures that are caused by the upgrade namely a few like this one:

```
sage -t --long /usr/share/sage/src/sage/interfaces/maxima_lib.py
**********************************************************************
File "/usr/share/sage/src/sage/interfaces/maxima_lib.py", line 902, in sage.interfaces.maxima_lib.MaximaLib.sr_limit
Failed example:
    limit(x^a,x=0)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Computation failed ...
    Is a an integer?
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 843, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.maxima_lib.MaximaLib.sr_limit[7]>", line 1, in <module>
        limit(x**a,x=Integer(0))
      File "/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py", line 1251, in limit
        l = maxima.sr_limit(ex, v, a)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 952, in sr_limit
        self._missing_assumption(s)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 997, in _missing_assumption
        raise ValueError(outstr)
    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)
    Is a an ?integer?
**********************************************************************
```

Not sure if the blank line cause the failure but "?integer?" instead of "integer?" probably does. I am not sure what the "?" is for. There is at least another doctest failing that way.



---

archive/issue_comments_221449.json:
```json
{
    "body": "calculus.py\n\n```\nsage -t --long /usr/share/sage/src/sage/calculus/calculus.py\n**********************************************************************\nFile \"/usr/share/sage/src/sage/calculus/calculus.py\", line 1098, in sage.calculus.calculus.limit\nFailed example:\n    limit(x^a,x=0)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Computation failed since Maxima requested additional\n    constraints; using the 'assume' command before evaluation *may* help\n    (example of legal syntax is 'assume(a>0)', see `assume?` for\n     more details)\n    Is a an integer?\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 843, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus.limit[13]>\", line 1, in <module>\n        limit(x**a,x=Integer(0))\n      File \"/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py\", line 1251, in limit\n        l = maxima.sr_limit(ex, v, a)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 952, in sr_limit\n        self._missing_assumption(s)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 997, in _missing_assumption\n        raise ValueError(outstr)\n    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)\n    Is a an ?integer?\n**********************************************************************\nFile \"/usr/share/sage/src/sage/calculus/calculus.py\", line 1107, in sage.calculus.calculus.limit\nFailed example:\n    limit(x^a,x=0)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Computation failed since Maxima requested additional\n    constraints; using the 'assume' command before evaluation *may* help\n    (example of legal syntax is 'assume(a>0)', see `assume?` for\n     more details)\n    Is a an even number?\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 843, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus.limit[15]>\", line 1, in <module>\n        limit(x**a,x=Integer(0))\n      File \"/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py\", line 1251, in limit\n        l = maxima.sr_limit(ex, v, a)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 952, in sr_limit\n        self._missing_assumption(s)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 997, in _missing_assumption\n        raise ValueError(outstr)\n    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)\n    Is a an ?even?\\ ?number?\n**********************************************************************\n```\n",
    "created_at": "2014-09-18T08:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221449",
    "user": "https://github.com/kiwifb"
}
```

calculus.py

```
sage -t --long /usr/share/sage/src/sage/calculus/calculus.py
**********************************************************************
File "/usr/share/sage/src/sage/calculus/calculus.py", line 1098, in sage.calculus.calculus.limit
Failed example:
    limit(x^a,x=0)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Computation failed since Maxima requested additional
    constraints; using the 'assume' command before evaluation *may* help
    (example of legal syntax is 'assume(a>0)', see `assume?` for
     more details)
    Is a an integer?
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 843, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus.limit[13]>", line 1, in <module>
        limit(x**a,x=Integer(0))
      File "/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py", line 1251, in limit
        l = maxima.sr_limit(ex, v, a)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 952, in sr_limit
        self._missing_assumption(s)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 997, in _missing_assumption
        raise ValueError(outstr)
    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)
    Is a an ?integer?
**********************************************************************
File "/usr/share/sage/src/sage/calculus/calculus.py", line 1107, in sage.calculus.calculus.limit
Failed example:
    limit(x^a,x=0)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Computation failed since Maxima requested additional
    constraints; using the 'assume' command before evaluation *may* help
    (example of legal syntax is 'assume(a>0)', see `assume?` for
     more details)
    Is a an even number?
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 843, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus.limit[15]>", line 1, in <module>
        limit(x**a,x=Integer(0))
      File "/usr/lib64/python2.7/site-packages/sage/calculus/calculus.py", line 1251, in limit
        l = maxima.sr_limit(ex, v, a)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 952, in sr_limit
        self._missing_assumption(s)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 997, in _missing_assumption
        raise ValueError(outstr)
    ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(a>0)', see `assume?` for more details)
    Is a an ?even?\ ?number?
**********************************************************************
```




---

archive/issue_comments_221450.json:
```json
{
    "body": "Replying to [comment:2 fbissey]:\n> We have to force rebuild of maxima after the upgrade\nWith the current branch, `make` should automatically build the new Maxima 5.34.1 due to the dependency on #16908, unless you already did a previous build of #16908, in which case you indeed have to reinstall Maxima.\n> and I think there are minor doctest failures that are caused by the upgrade\nI cannot reproduce these.  The printing of question marks should be suppressed by `build/pkgs/maxima/patches/undoing_true_false_printing_patch.patch`; did that somehow fail to apply?",
    "created_at": "2014-09-18T08:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221450",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:2 fbissey]:
> We have to force rebuild of maxima after the upgrade
With the current branch, `make` should automatically build the new Maxima 5.34.1 due to the dependency on #16908, unless you already did a previous build of #16908, in which case you indeed have to reinstall Maxima.
> and I think there are minor doctest failures that are caused by the upgrade
I cannot reproduce these.  The printing of question marks should be suppressed by `build/pkgs/maxima/patches/undoing_true_false_printing_patch.patch`; did that somehow fail to apply?



---

archive/issue_comments_221451.json:
```json
{
    "body": "No, that's a patch I am missing in sage-on-gentoo, it flew under my radar. I thought they were related to ecl.",
    "created_at": "2014-09-18T08:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221451",
    "user": "https://github.com/kiwifb"
}
```

No, that's a patch I am missing in sage-on-gentoo, it flew under my radar. I thought they were related to ecl.



---

archive/issue_comments_221452.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-30T11:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221452",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_221453.json:
```json
{
    "body": "OK, I actually cheated in #12985 I actually did the testing straight away with the new ecl. I want this to go in, same comments as in #12985 but the version bump should definitely trigger a rebuild.\n\nA side note, #12985 enables ecl to be used with or without unicode. That is ecl compiled without unicode will work just as well with the patch to sage - so long that maxima and sage are properly compiled against that version.",
    "created_at": "2014-09-30T11:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221453",
    "user": "https://github.com/kiwifb"
}
```

OK, I actually cheated in #12985 I actually did the testing straight away with the new ecl. I want this to go in, same comments as in #12985 but the version bump should definitely trigger a rebuild.

A side note, #12985 enables ecl to be used with or without unicode. That is ecl compiled without unicode will work just as well with the patch to sage - so long that maxima and sage are properly compiled against that version.



---

archive/issue_comments_221454.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-02T16:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16766#issuecomment-221454",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049522.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-02T16:21:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16766",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16766#event-49522"
}
```
