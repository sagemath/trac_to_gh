# Issue 15285: Conversion gp -> string is broken

Issue created by migration from https://trac.sagemath.org/ticket/15522

Original creator: jdemeyer

Original creation time: 2013-12-16 10:12:58


```
sage: gp('"foo"').sage()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-1-5f1854206d09> in <module>()
----> 1 gp('"foo"').sage()

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/interface.pyc in sage(self)
    867             Rational Field
    868         """
--> 869         return self._sage_()
    870 
    871     def __repr__(self):

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/gp.pyc in _sage_(self)
    831             True
    832         """
--> 833         return pari(str(self)).python()
    834 
    835     def __long__(self):

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.gen.python (sage/libs/pari/gen.c:10167)()

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/libs/pari/gen_py.pyc in python(z, locals)
    273     else:
    274         from sage.misc.sage_eval import sage_eval
--> 275         return sage_eval(str(z), locals=locals)

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/misc/sage_eval.pyc in sage_eval(source, locals, cmds, preparse)
    197         return locals['_sage_eval_returnval_']
    198     else:
--> 199         return eval(source, sage.all.__dict__, locals)
    200 
    201 

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/all.pyc in <module>()

NameError: name 'foo' is not defined
```



---

Attachment


---

Comment by chapoton created at 2018-04-30 09:32:06

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-04-30 09:32:06

New commits:


---

Comment by chapoton created at 2018-04-30 17:00:54

Jeroen, I allow myself to set this to positive.


---

Comment by chapoton created at 2018-04-30 17:00:54

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2018-05-04 08:54:34

Changing status from positive_review to needs_work.


---

Comment by chapoton created at 2018-05-04 11:23:30

so, is this one a duplicate, or what ?


---

Comment by jdemeyer created at 2018-05-04 15:09:24

No, because `gp` is not `pari` (the first uses `pexpect`, the second uses `cypari2`)


---

Comment by chapoton created at 2018-05-04 15:25:33

Indeed. Using the branch from #25289, one gets

```
sage: gp('"toto"')
toto
sage: pari('"toto"')
"toto"
```



---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by chapoton created at 2018-09-06 18:07:27

New commits:


---

Comment by chapoton created at 2018-09-06 18:07:27

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2018-09-06 22:38:34

LGTM.


---

Comment by tscrim created at 2018-09-06 22:38:34

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-09-08 17:56:04

Resolution: fixed
