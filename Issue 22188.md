# Issue 22188: Update Singular to 4.1.0p2

Issue created by migration from https://trac.sagemath.org/ticket/22425

Original creator: jpflori

Original creation time: 2017-02-23 13:18:39

CC:  jakobkroeker jdemeyer fbissey vbraun rlmiller

New version at:
* http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p2.tar.gz

This should fix warnings in debug mode: #21624


---

Comment by jpflori created at 2017-02-23 13:20:01

On a ppc64, I get a bunch of

```
        return new_Expression_from_GEx(self._parent, self._gobj.numer())
    RuntimeError: Exponent overflow Error: Bad Argument Value
```

which look pynac related and singular unrelated.
In fact I seem to get them on a pristine 7.6beta4.


---

Comment by jpflori created at 2017-02-23 13:22:20

Or its due to giac being broken on ppc64, no idea.


---

Comment by git created at 2017-02-23 18:01:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-02-24 13:10:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2017-02-24 13:12:05

I'm not sure this is in a review state as my ppc64 spits a lot of giac related errors, but feel free to finish this ticket as I will be away from the internet for a couple of weeks.


---

Comment by jpflori created at 2017-02-24 13:12:05

Changing status from new to needs_review.


---

Comment by jpflori created at 2017-03-10 15:38:34

Anyone?
`@`volker: this should simplify your life as the patch bot building in debug mode won't have singular related errors anymore.


---

Comment by vbraun created at 2017-03-10 23:11:12

I'll give it a whirl ...


---

Comment by vbraun created at 2017-03-10 23:11:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-03-10 23:20:47

Doesn't work:

```
[singular-4.1.0p2] 1 out of 1 hunk ignored -- saving rejects to file kernel/spectrum/test.cc.rej
[singular-4.1.0p2] patching file kernel/test.cc
[singular-4.1.0p2] Reversed (or previously applied) patch detected!  Assume -R? [n] 
[singular-4.1.0p2] Apply anyway? [n] 
[singular-4.1.0p2] Skipping patch.
[singular-4.1.0p2] 1 out of 1 hunk ignored -- saving rejects to file kernel/test.cc.rej
[singular-4.1.0p2] patching file libpolys/tests/rings_test.h
[singular-4.1.0p2] Reversed (or previously applied) patch detected!  Assume -R? [n] 
[singular-4.1.0p2] Apply anyway? [n] 
[singular-4.1.0p2] Skipping patch.
[singular-4.1.0p2] 1 out of 1 hunk ignored -- saving rejects to file libpolys/tests/rings_test.h.rej
[singular-4.1.0p2] Error applying '../patches/make_check.patch'
```



---

Comment by vbraun created at 2017-03-10 23:20:47

Changing status from positive_review to needs_work.


---

Comment by fbissey created at 2017-03-11 03:03:31

It looks like the patch has been included in upstream tarball. So yes the tarball is the tagged git branch plus this patch at least - dubious. I'll push a fix in a few hours.


---

Comment by git created at 2017-03-11 03:56:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2017-03-11 03:57:06

Changing status from needs_work to positive_review.


---

Comment by fbissey created at 2017-03-11 03:57:06

Fixed.


---

Comment by vbraun created at 2017-03-11 17:19:52

Seems to have a different normalization:

```
sage -t --long src/sage/schemes/affine/affine_morphism.py
**********************************************************************
File "src/sage/schemes/affine/affine_morphism.py", line 672, in sage.schemes.affine.affine_morphism.SchemeMorphism_polynomial_affine_space.dynatomic_polynomial
Failed example:
    F.dynatomic_polynomial([1,1])
Expected:
    (2.00000000000000*x^4 + 5.85640646055102*x^2 + 24.0000000000000)/(x^2 + (-2.00000000000000)*x + 3.46410161513775)
Got:
    (0.125000000000000*x^4 + 0.366025403784439*x^2 + 1.50000000000000)/(0.500000000000000*x^2 - x + 1.73205080756888)
**********************************************************************
1 item had failures:
   1 of  39 in sage.schemes.affine.affine_morphism.SchemeMorphism_polynomial_affine_space.dynatomic_polynomial
    [295 tests, 1 failure, 1.78 s]
```



---

Comment by vbraun created at 2017-03-11 17:19:52

Changing status from positive_review to needs_work.


---

Comment by jpflori created at 2017-03-11 22:14:09

Is that the only failure?


---

Comment by vbraun created at 2017-03-11 23:34:25

yes


---

Comment by fbissey created at 2017-03-12 00:00:14

One email notification in 10 posts. trac has problems sending email again?


---

Comment by jpflori created at 2017-03-14 12:55:24

This failing test was added at #22265.
`@`rlmiller: any idea of what might have changed?


---

Comment by jpflori created at 2017-03-14 12:57:59

Ok, only a normalization change, roots did not change.
It's just I'm not that good at multiplication by 16.


---

Comment by git created at 2017-03-14 13:02:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2017-03-14 13:02:36

Changing status from needs_work to positive_review.


---

Comment by jpflori created at 2017-03-14 15:32:16

Changing keywords from "" to "days85".


---

Comment by embray created at 2017-03-20 11:06:42

Any chance of getting this merged for 7.6?


---

Comment by vbraun created at 2017-03-27 20:43:15

Resolution: fixed
