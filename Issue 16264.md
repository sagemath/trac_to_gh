# Issue 16264: Allow installation of spkgs whose names don't match their top-level directories.

Issue created by migration from https://trac.sagemath.org/ticket/16501

Original creator: robertwb

Original creation time: 2014-06-19 21:36:43

CC:  embray

This is handy to be able to pull the archive directly from services such as github, e.g. https://github.com/user/project/archive/master.tar.gz


---

Comment by robertwb created at 2014-06-19 22:09:16

New commits:


---

Comment by robertwb created at 2014-06-19 22:09:16

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-08-14 10:04:18

Instead of grepping the output of `tar tf -`, I would prefer a simple shell script along the lines of

```sh
# Find the unique subdirectory name
PKG_SUBDIR=""
for d in *; do
    if [ -d "$d" ]; then
        if [ -z "$PKG_SUBDIR" ]; then
            PKG_SUBDIR="$d"
        else
            echo >&2 "Multiple directories in package, no idea what to do..."
            exit 1
        fi
    fi
done
if [ -z "$PKG_SUBDIR" ]; then
    echo >&2 "No directory found in package, no idea what to do..."
    exit 1
fi
cd "$PKG_SUBDIR" || exit $?
```


This also deals with the case that there are multiple directories, and there are less worries about portability of `tar tf -`.


---

Comment by jdemeyer created at 2014-08-14 11:30:58

While you're at it, could you add `2>/dev/null` to the `mv` command in

```
if [ "$USE_LOCAL_SCRIPTS" = yes ]; then
    shopt -s nocaseglob      # see trac:16415
    mv "${PKG_NAME_UPSTREAM%.tar*}"* src
    shopt -u nocaseglob
    echo "Finished set up"
```



---

Comment by jdemeyer created at 2014-10-16 11:25:29

Changing status from needs_review to needs_info.


---

Comment by embray created at 2016-08-19 14:27:20

I think probably this can be closed as of #20721.


---

Comment by jdemeyer created at 2016-08-19 14:33:49

Changing status from needs_info to positive_review.


---

Comment by embray created at 2016-08-19 14:49:01

I like to actually close tickets, so... I think I'll close as a duplicate of #20721 (even though this one came first).


---

Comment by embray created at 2016-08-19 14:49:01

Resolution: duplicate


---

Comment by mkoeppe created at 2016-08-19 17:11:57

Thanks!
