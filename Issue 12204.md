# Issue 12204: BipartiteGraph complement

archive/issues_012204.json:
```json
{
    "body": "Assignee: brunellus\n\nCC:  @tscrim\n\n```\nsage: B = BipartiteGraph(3)  # no edges\nsage: type(B)\n<class 'sage.graphs.bipartite_graph.BipartiteGraph'>\nsage: type(B.complement())\n<class 'sage.graphs.bipartite_graph.BipartiteGraph'>\nsage: B.complement().is_bipartite()\nFalse\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/12376\n\n",
    "closed_at": "2016-09-04T00:14:02Z",
    "created_at": "2012-01-28T12:19:23Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "BipartiteGraph complement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12204",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```
Assignee: brunellus

CC:  @tscrim

```
sage: B = BipartiteGraph(3)  # no edges
sage: type(B)
<class 'sage.graphs.bipartite_graph.BipartiteGraph'>
sage: type(B.complement())
<class 'sage.graphs.bipartite_graph.BipartiteGraph'>
sage: B.complement().is_bipartite()
False
```


Issue created by migration from https://trac.sagemath.org/ticket/12376





---

archive/issue_comments_142353.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-01-28T13:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142353",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_142354.json:
```json
{
    "body": "Attachment [trac_12376_bipartite_complement.patch](tarball://root/attachments/some-uuid/ticket12376/trac_12376_bipartite_complement.patch) by @nathanncohen created at 2012-01-29 18:19:04\n\nHmmm.... I am sorry but these things are really dangerous... `:-/`\n\nWhat would happen if one of the functions BipartiteGraph inherits has to compute the complement of the graph at some point ? The result would not be the one intended.... `:-/`\n\nNathann",
    "created_at": "2012-01-29T18:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142354",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_12376_bipartite_complement.patch](tarball://root/attachments/some-uuid/ticket12376/trac_12376_bipartite_complement.patch) by @nathanncohen created at 2012-01-29 18:19:04

Hmmm.... I am sorry but these things are really dangerous... `:-/`

What would happen if one of the functions BipartiteGraph inherits has to compute the complement of the graph at some point ? The result would not be the one intended.... `:-/`

Nathann



---

archive/issue_comments_142355.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2012-01-29T18:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142355",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_142356.json:
```json
{
    "body": "I think that the correct behaviour there would be to throw an exception whenever the Bipartite graph contains two vertices in the same partition (=> the result is not bipartite, or does not respect the bipartition stored), and to define a complement_bipartite() method. Actually bipartite_complement would be better, but it would be easier to find if named bipartite_complement.\n\nNathann",
    "created_at": "2012-01-29T18:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142356",
    "user": "https://github.com/nathanncohen"
}
```

I think that the correct behaviour there would be to throw an exception whenever the Bipartite graph contains two vertices in the same partition (=> the result is not bipartite, or does not respect the bipartition stored), and to define a complement_bipartite() method. Actually bipartite_complement would be better, but it would be easier to find if named bipartite_complement.

Nathann



---

archive/issue_events_033180.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33180"
}
```



---

archive/issue_events_033181.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33181"
}
```



---

archive/issue_events_033182.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33182"
}
```



---

archive/issue_events_033183.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33183"
}
```



---

archive/issue_events_033184.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33184"
}
```



---

archive/issue_events_033185.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33185"
}
```



---

archive/issue_events_033186.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33186"
}
```



---

archive/issue_comments_142357.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2016-08-21T04:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142357",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_142358.json:
```json
{
    "body": "Original error report was misleading, as this has been changed. Anyways, currently `.complement()` returns wrong type.",
    "created_at": "2016-08-21T04:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142358",
    "user": "https://github.com/jm58660"
}
```

Original error report was misleading, as this has been changed. Anyways, currently `.complement()` returns wrong type.



---

archive/issue_events_033187.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2016-08-21T04:48:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33187"
}
```



---

archive/issue_events_033188.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2016-08-21T04:48:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33188"
}
```



---

archive/issue_comments_142359.json:
```json
{
    "body": "Travis, can you comment this?\n\nIf I make a special case for `BipartiteGraph`, it will break if there will be another subclass of `Graph`. So I should just check for `isinstance(g, sage.graphs.digraph.DiGraph)` and `isinstance(g, sage.graphs.graph.Graph)` and then make a copy like `Graph(self)`. However the docstring for that says \"Please use this method only if you need to copy but change the underlying implementation or weightedness.  Otherwise simply do `copy(g)` - -\".\n\nSo what is the right thing to do?",
    "created_at": "2016-08-22T03:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142359",
    "user": "https://github.com/jm58660"
}
```

Travis, can you comment this?

If I make a special case for `BipartiteGraph`, it will break if there will be another subclass of `Graph`. So I should just check for `isinstance(g, sage.graphs.digraph.DiGraph)` and `isinstance(g, sage.graphs.graph.Graph)` and then make a copy like `Graph(self)`. However the docstring for that says "Please use this method only if you need to copy but change the underlying implementation or weightedness.  Otherwise simply do `copy(g)` - -".

So what is the right thing to do?



---

archive/issue_comments_142360.json:
```json
{
    "body": "Hmm...I'm really not sure. The problem is that doing stuff to the backend doesn't reflect the front-end class (normally if you added an edge that breaks the bipartite-ness, then it errors out). I would implement a `BipartiteGraph.complement` that either checks the output is bipartite and errors out if not or generically constructs the corresponding `Graph`.",
    "created_at": "2016-08-22T04:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142360",
    "user": "https://github.com/tscrim"
}
```

Hmm...I'm really not sure. The problem is that doing stuff to the backend doesn't reflect the front-end class (normally if you added an edge that breaks the bipartite-ness, then it errors out). I would implement a `BipartiteGraph.complement` that either checks the output is bipartite and errors out if not or generically constructs the corresponding `Graph`.



---

archive/issue_comments_142361.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-22T05:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142361",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_142362.json:
```json
{
    "body": "Like this?\n\nBut this will not help if there will be another subclass of generic graphs. Anyways, this corrects this particular problem for now.\n\n---\nNew commits:",
    "created_at": "2016-08-22T05:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142362",
    "user": "https://github.com/jm58660"
}
```

Like this?

But this will not help if there will be another subclass of generic graphs. Anyways, this corrects this particular problem for now.

---
New commits:



---

archive/issue_comments_142363.json:
```json
{
    "body": "Just pinging. At least this fixes a bug.",
    "created_at": "2016-09-02T11:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142363",
    "user": "https://github.com/jm58660"
}
```

Just pinging. At least this fixes a bug.



---

archive/issue_comments_142364.json:
```json
{
    "body": "Agreed. (Sorry about this dropping off my radar.)",
    "created_at": "2016-09-02T14:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142364",
    "user": "https://github.com/tscrim"
}
```

Agreed. (Sorry about this dropping off my radar.)



---

archive/issue_comments_142365.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-02T14:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142365",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_142366.json:
```json
{
    "body": "Thanks. And no horry: I work on several tickets, so nothing gets stalled for one ticket being in review queue.",
    "created_at": "2016-09-02T16:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142366",
    "user": "https://github.com/jm58660"
}
```

Thanks. And no horry: I work on several tickets, so nothing gets stalled for one ticket being in review queue.



---

archive/issue_comments_142367.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-09-04T00:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12204#issuecomment-142367",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_033189.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-04T00:14:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12204",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12204#event-33189"
}
```
