# Issue 12204: BipartiteGraph complement

Issue created by migration from https://trac.sagemath.org/ticket/12376

Original creator: brunellus

Original creation time: 2012-01-28 12:19:23

Assignee: brunellus

CC:  tscrim


```
sage: B = BipartiteGraph({0:[1,2]})
sage: print(B.complement())
...
  File "/sagenb/sage_install/sage-4.7.2/local/lib/python2.6/site-packages/sage/graphs/generic_graph.py", line 11939, in complement
    G.add_edge(u,v)
  File "/sagenb/sage_install/sage-4.7.2/local/lib/python2.6/site-packages/sage/graphs/bipartite_graph.py", line 766, in add_edge
    "Edge vertices must lie in different partitions.")
RuntimeError: Edge vertices must lie in different partitions.
```


It is natural to understand complement on BipartiteGraph object in the bipartite context, i.e. excluding possible edges between vertices in the same partition. Currently there is no such implementation in the BipartiteGraph object and call falls back to the GenericGraph implementation.


---

Comment by brunellus created at 2012-01-28 13:09:27

Changing status from new to needs_review.


---

Attachment

Hmmm.... I am sorry but these things are really dangerous... `:-/`

What would happen if one of the functions BipartiteGraph inherits has to compute the complement of the graph at some point ? The result would not be the one intended.... `:-/`

Nathann


---

Comment by ncohen created at 2012-01-29 18:19:04

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2012-01-29 18:20:55

I think that the correct behaviour there would be to throw an exception whenever the Bipartite graph contains two vertices in the same partition (=> the result is not bipartite, or does not respect the bipartition stored), and to define a complement_bipartite() method. Actually bipartite_complement would be better, but it would be easier to find if named bipartite_complement.

Nathann


---

Comment by jmantysalo created at 2016-08-21 04:48:09

Changing status from needs_info to needs_work.


---

Comment by jmantysalo created at 2016-08-21 04:48:09

Original error report was misleading, as this has been changed. Anyways, currently `.complement()` returns wrong type.


---

Comment by jmantysalo created at 2016-08-22 03:47:18

Travis, can you comment this?

If I make a special case for `BipartiteGraph`, it will break if there will be another subclass of `Graph`. So I should just check for `isinstance(g, sage.graphs.digraph.DiGraph)` and `isinstance(g, sage.graphs.graph.Graph)` and then make a copy like `Graph(self)`. However the docstring for that says "Please use this method only if you need to copy but change the underlying implementation or weightedness.  Otherwise simply do `copy(g)` - -".

So what is the right thing to do?


---

Comment by tscrim created at 2016-08-22 04:25:31

Hmm...I'm really not sure. The problem is that doing stuff to the backend doesn't reflect the front-end class (normally if you added an edge that breaks the bipartite-ness, then it errors out). I would implement a `BipartiteGraph.complement` that either checks the output is bipartite and errors out if not or generically constructs the corresponding `Graph`.


---

Comment by jmantysalo created at 2016-08-22 05:35:14

Changing status from needs_work to needs_review.


---

Comment by jmantysalo created at 2016-08-22 05:35:14

Like this?

But this will not help if there will be another subclass of generic graphs. Anyways, this corrects this particular problem for now.
----
New commits:


---

Comment by jmantysalo created at 2016-09-02 11:50:38

Just pinging. At least this fixes a bug.


---

Comment by tscrim created at 2016-09-02 14:34:07

Agreed. (Sorry about this dropping off my radar.)


---

Comment by tscrim created at 2016-09-02 14:34:07

Changing status from needs_review to positive_review.


---

Comment by jmantysalo created at 2016-09-02 16:48:31

Thanks. And no horry: I work on several tickets, so nothing gets stalled for one ticket being in review queue.


---

Comment by vbraun created at 2016-09-04 00:14:02

Resolution: fixed
