# Issue 14136: More doctests from the book "Calcul mathématique avec Sage"--Chap. "domaines"

Issue created by migration from Trac.

Original creator: mmezzarobba

Original creation time: 2013-03-22 21:04:01

Assignee: tbd

CC:  gconnan

The attached file provides doctests for examples in the chapter on computation domains (common parents and useful classes of formal expressions). See #9395 for some background.

All tests pass with Sage 5.9β0 on my machine.


---

Comment by mmezzarobba created at 2013-03-22 21:06:11

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2013-06-03 18:56:53

Looks good to me.

What is the purpose of the unique non docstring line in the file ?

```
from sage.all_cmdline import *   # import sage library 
```



---

Comment by vdelecroix created at 2013-06-03 18:56:53

Changing component from PLEASE CHANGE to documentation.


---

Comment by ncohen created at 2013-07-04 09:48:50

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2013-07-04 09:48:50

Same comment as #10983

Nathann


---

Comment by zimmerma created at 2013-08-23 08:24:18

a new patch taking into account the output ordering change from #9880 is attached.
Works fine with Sage 5.11, thus ready to review. See also #10983.

Paul


---

Comment by zimmerma created at 2013-08-23 08:24:18

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2013-08-23 11:12:34

Replying to [comment:2 vdelecroix]:
> Looks good to me.
> 
> What is the purpose of the unique non docstring line in the file ?
> {{{
> from sage.all_cmdline import *   # import sage library 
> }}}

Vincent, that line was generated automatically by `sage -preparse domaines_doctests.sage`,
which is the way we produce the `xxx_doctests.py` file from `xxx_doctests.sage`.
Does it hurt?

Paul


---

Comment by jdemeyer created at 2013-08-23 12:08:39

Replying to [comment:7 zimmerma]:
> `sage -preparse domaines_doctests.sage`
Really, that's what you use? First of all, it would be perfectly fine to simply keep the `.sage` file and add that to the Sage library. Second, if you really insist on a `.py` file, just rename it instead of preparsing. Above all, be consistent. In sage-5.12.beta3, there are 4 files in `tests/french_book` of which 2 have that `import` line and one file (`recequadiff.py`) is executable which should certainly not be.


---

Comment by zimmerma created at 2013-08-23 13:08:32

new patch without the `import`, and with `....:`

Paul


---

Comment by zimmerma created at 2013-08-23 13:16:55

about the 2 files with `import` and the one which is executable, I've asked my colleagues to fix
that.

Paul


---

Comment by chapoton created at 2013-08-29 11:26:04

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2013-08-29 11:26:04

ok, good to go


---

Comment by zimmerma created at 2013-08-29 16:27:21

thank you Frédéric for reviewing this.

Paul


---

Comment by jdemeyer created at 2013-09-03 12:19:48

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-09-03 12:19:48

On some systems (e.g. OS X 10.8, Linux ia64):

```
sage -t --long devel/sage/sage/tests/french_book/domaines_doctest.py
**********************************************************************
File "devel/sage/sage/tests/french_book/domaines_doctest.py", line 368, in sage.tests.french_book.domaines_doctest
Failed example:
    prod( (a-b) for (a,b) in Subsets([x1,x2,x3,x4],2) )
Expected:
    (x1 - x2)*(x1 - x3)*(x1 - x4)*(x2 - x3)*(x2 - x4)*(x3 - x4)
Got:
    -(x1 - x2)*(x1 - x3)*(x1 - x4)*(x2 - x3)*(x2 - x4)*(x3 - x4)
**********************************************************************
```



---

Comment by jdemeyer created at 2013-09-03 12:27:16

If you care about ordering, use `itertools.combinations` instead of `Subsets`:

```
sage: from itertools import combinations
sage: list(combinations([x1,x2,x3,x4],2))
[(x1, x2), (x1, x3), (x1, x4), (x2, x3), (x2, x4), (x3, x4)]
```



---

Attachment


---

Comment by zimmerma created at 2013-09-03 13:32:35

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2013-09-03 13:32:35

the new patch checks whether the product equals `(x1 - x2)*(x1 - x3)*(x1 - x4)*(x2 - x3)*(x2 - x4)*(x3 - x4)` or its opposite.

Paul


---

Comment by vdelecroix created at 2013-09-03 13:42:09

Replying to [comment:15 zimmerma]:
> the new patch checks whether the product equals `(x1 - x2)*(x1 - x3)*(x1 - x4)*(x2 - x3)*(x2 - x4)*(x3 - x4)` or its opposite.

Or you may modify the polynom to something invariant under permutation like `(x1 - x2)^2*(x1 - x3)^2*(x1 - x4)^2*(x2 - x3)^2*(x2 - x4)^2*(x3 - x4)^2` (which makes sense as Jeroen pointed out, subset are not ordered).


---

Comment by zimmerma created at 2013-09-03 13:47:23

> Or you may modify the polynom to something invariant under permutation

good idea, but since the book is already published, I prefer not to change the input.

Paul


---

Comment by chapoton created at 2013-09-11 12:36:24

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2013-09-11 12:36:24

ok, let me say "good to go" again


---

Comment by chapoton created at 2013-09-23 15:59:35

Changing status from positive_review to needs_work.


---

Comment by chapoton created at 2013-09-23 15:59:35

could you please change the indentation from 2 to 4 ?


---

Attachment

I have made a new patch with correct indentation, and that passes all tests.

for the *patchbots*:

apply trac_14340_doctests_from_french_book_v2.patch


---

Comment by chapoton created at 2013-10-22 19:05:49

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2013-10-23 11:30:31

ok, good to go again.


---

Comment by chapoton created at 2013-10-23 11:30:31

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-10-31 19:16:41

Resolution: fixed
