# Issue 11325: Twisted won't build on Cygwin - sometimes

Issue created by migration from https://trac.sagemath.org/ticket/11497

Original creator: kcrisman

Original creation time: 2011-06-16 02:49:50

Assignee: tbd

CC:  mhansen dimpase was

Here's a new one: Cygwin fails on Twisted.

The error looks like errors linking `_pmap_set` and `_pmap_unset`.


---

Comment by kcrisman created at 2011-06-16 02:54:05

The internet (e.g. [this patch](http://twistedmatrix.com/trac/attachment/ticket/1820/runner-setup-2.patch)) says that the problem is in twisted/runner/topfiles/setup.py.

The fix is to add the rpc library like in the [original fix](http://twistedmatrix.com/trac/ticket/1820) to that Twisted ticket.


---

Comment by kcrisman created at 2011-06-23 03:39:01

See also the twisted upgrade ticket - #8741.


---

Comment by kcrisman created at 2011-06-24 15:07:30

Changing status from new to needs_review.


---

Comment by kcrisman created at 2011-06-24 15:07:30

Okay, spkg ready for testing at [http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg](http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg)


---

Comment by kcrisman created at 2011-06-25 12:36:23

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2011-06-25 12:36:23

I must have messed something up in the syntax - I forgot a comma.   Don't try this yet.


---

Comment by kcrisman created at 2011-06-25 13:32:42

Okay, hopefully this fixed it.  Sorry not to have posted a patch yet - no time now.  Same location.


---

Comment by kcrisman created at 2011-06-27 18:00:27

Okay, this is now correct - I fixed the comma, and it worked.

Let's say this ticket is just for XP, for now, since Win7 seems to have so many other troubles.  Hopefully that will make it easier to review.


---

Comment by kcrisman created at 2011-06-27 18:00:27

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2011-06-28 16:42:06

But it works on XP as well.


---

Comment by kcrisman created at 2011-06-29 01:13:46

Replying to [comment:8 kcrisman]:
> But it works on XP as well.
By which I meant Win 7 as well.


---

Comment by kcrisman created at 2011-07-29 15:25:03

User "RegB" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  

So this just needs someone to look at the actual spkg.


---

Comment by kcrisman created at 2011-07-29 19:27:07

That is, this needs someone _other than me_ to look at the actual spkg and its construction :) - should be very easy.


---

Comment by kcrisman created at 2011-07-29 19:43:30

Replying to [comment:10 kcrisman]:
> User "RegB" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  

That was on Vista, just FYI.  Maybe we need another XP reviewer for this?


---

Comment by dimpase created at 2011-11-27 15:33:44

somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.


---

Comment by kcrisman created at 2011-11-28 13:50:42

Replying to [comment:14 dimpase]:

Welcome back!

> somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.
Yes, this was only ever an XP problem, as far as I know.

If you can verify this spkg doesn't cause problems on Win 7, then I think that would be enough to positively review and merge. You are right that XP is less and less important in the long run, of course.


---

Comment by jason created at 2011-12-13 17:48:19

Is this superseded by the Twisted 11.0 spkg at #11847?


---

Comment by kcrisman created at 2011-12-13 18:00:04

> Is this superseded by the Twisted 11.0 spkg at #11847?
Almost certainly not - the devels on the link above seemed not to care too much - the last change was 18 months ago, and they didn't want to do anything without a Cygwin slave.  I can try to see whether the new package applies sometime tonight, but I doubt that it's in upstream.  And of course this was only ever on XP.

Still, if you can apply this without too much trouble on yours, with a patch applied only in case of Cygwin, I think that would be a good idea.


---

Comment by kcrisman created at 2011-12-14 01:51:53

You mean #11874, of course!


---

Comment by kcrisman created at 2011-12-14 02:13:44

For reference only


---

Attachment

After testing on the newest Cygwin on XP, I think this issue may have been an older Cygwin issue, not an XP issue per se.  I have no problems building the current p2, the p3 on this ticket, or Twisted 11 on #11874.  Setting to sage-invalid, keeping Reg as a reviewer for checking this worked on Vista and Dima for checking on Win 7 this wasn't necessary.
----
I've added [attachment:trac_11497.diff] for reference in case we need to apply this in the future for some reason.


---

Comment by kcrisman created at 2011-12-14 02:18:01

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-01-05 13:29:54

Resolution: worksforme
