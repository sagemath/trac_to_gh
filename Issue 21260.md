# Issue 21260: modular symbols - is_cuspidal sometimes incorrectly returns False

Issue created by migration from Trac.

Original creator: dgulotta

Original creation time: 2016-09-15 00:10:51

In the following example, the modular symbols are cuspidal but Sage says that they are not:

```
sage: M = ModularSymbols(Gamma0(3),weight=22,sign=1)
sage: N = next(S for S in M.decomposition(anemic=False) if S.hecke_matrix(3).trace()==-128844)
sage: N.is_cuspidal()
True
sage: [g.is_cuspidal() for g in N.gens()]
[False, False]
```



---

Comment by dgulotta created at 2016-09-18 17:59:43

It seems that the underlying issue is that the code checks whether `g` is cuspidal by checking whether `g==M.cuspidal_submodule()(g)`.  This test returns false because Sage can't find a common parent of `N` and `M.cuspidal_submodule()`.


---

Comment by dgulotta created at 2016-09-18 17:59:43

Changing type from PLEASE CHANGE to defect.


---

Comment by dgulotta created at 2016-10-23 01:01:39

New commits:


---

Comment by dgulotta created at 2016-10-23 01:01:39

Changing status from new to needs_review.


---

Comment by git created at 2016-10-25 00:26:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-10-25 01:00:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-12-24 09:45:40

Could you add your full name in the "Author" field of the ticket?


---

Comment by vdelecroix created at 2016-12-24 09:47:41

The following syntax is wrong

```
TESTS::

Make sure that the element is created correctly when the codomain is
not the full module (related to :trac:`21497`):
```

It should be

```
TESTS:    <---- only one colon

Make sure that the element is created correctly when the codomain is
not the full module (related to :trac:`21497`)::   <----- but two colons here
```



---

Comment by vdelecroix created at 2016-12-24 09:50:41

For direct sums you can use `+`

```
sage: V = QQ**4
sage: U1 = V.subspace([(1,0,0,-1)])
sage: U2 = V.subspace([(2,1,0,0), (1,0,1,0)])
sage: U1+U2
Vector space of degree 4 and dimension 3 over Rational Field
Basis matrix:
[ 1  0  0 -1]
[ 0  1  0  2]
[ 0  0  1  1]
sage: M = ModularSymbols(Gamma0(3),weight=22,sign=1)
sage: U1 = M.cuspidal_submodule()
sage: U2 = M.eisenstein_submodule()
sage: U1+U2
Modular Symbols subspace of dimension 8 of Modular Symbols space of dimension 8 for Gamma_0(3) of weight 22 with sign 1 over Rational Field
```



---

Comment by vdelecroix created at 2016-12-24 09:51:00

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-12-24 17:27:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dgulotta created at 2016-12-24 17:32:34

It seems that implementing _pushout_ was not necessary; just fixing the homspaces is enough to make is_cuspidal work.


---

Comment by dgulotta created at 2016-12-24 17:32:34

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-01-05 15:25:52

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-01-05 15:25:52

ok, let it be


---

Comment by vbraun created at 2017-01-18 20:39:41

Resolution: fixed
