# Issue 24785: change_ring broken on polynomials

Issue created by migration from https://trac.sagemath.org/ticket/25022

Original creator: vdelecroix

Original creation time: 2018-03-22 09:12:07

CC:  rws

If the polynomial can be coerced in the new base ring, the result of `change_ring` is a constant

```
sage: p = ZZ['x']([1,2,3])
sage: p.change_ring(QQ['x']).degree()
0
sage: p.change_ring(SR).degree()
0
```



---

Comment by nbruin created at 2018-03-23 05:43:17

Note that `change_ring` is supposed to change the base ring. For instance, we have:

```
sage: p.change_ring(QQ['y']).degree()
2
sage: p.change_ring(QQ['y']).parent()
Univariate Polynomial Ring in x over Univariate Polynomial Ring in y over Rational Field
```

In your case, you basically end up with

```
sage: QQ['x']['x'](p)
3*x^2 + 2*x + 1
```

and as it goes with coercion, the `x` of `p` coerces as low in the tower as possible.

Perhaps you'd prefer the result

```
sage: QQ['x']['x'](p)
3*x^2 + 2*x + 1
```


There's some work to be done, though:

```
sage: R.<x,y>=ZZ[]
sage: f=x^2+y^2
sage: f.change_ring(QQ['x','y']).monomials()
[1]
sage: f.change_ring(QQ['x']).monomials()
[x^2, y^2]
sage: f.change_ring(QQ['y']).monomials()
[x^2, y^2]
```

which does match

```
sage: QQ['x']['x','y'](f).monomials()
[x^2, y^2]
sage: QQ['x','y']['x','y'](f).monomials()
[1]
```

but doesn't seem to fit the pattern of "coerce 'x' as low as possible. But then, following that rule consistently might not be such a good idea.

```
sage: QQ['x']['x'](QQ['x']['x'].0).degree()
1
```



---

Comment by vdelecroix created at 2018-03-23 08:11:49

I think that `change_ring` on elements should uniformly be

```
def change_ring(self, R):
    return self.parent().change_ring(R)(list(self))
```

I don't plan to change anything to the `_element_constructor_` which is definitely allowed to behave differently.


---

Comment by vdelecroix created at 2018-03-23 14:42:05

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-03-23 14:42:05

New commits:


---

Comment by saraedum created at 2018-03-23 22:06:48

Changes look good to me. nbruin, do you agree?


---

Comment by rws created at 2018-03-25 08:08:22

Patchbot is green, too.


---

Comment by vdelecroix created at 2018-04-03 07:22:00

ping


---

Comment by saraedum created at 2018-04-04 20:31:18

Since nbruin has not reacted, let's assume that he does at least not strongly disagreeâ€¦


---

Comment by saraedum created at 2018-04-04 20:31:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-12 11:47:18

Resolution: fixed
