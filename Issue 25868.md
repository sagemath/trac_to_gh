# Issue 25868: Support base_morphism for hom(im_gens)

archive/issues_025868.json:
```json
{
    "body": "CC:  @roed314 @xcaruso swewers\n\nKeywords: padicBordeaux\n\nCurrently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.\n\nThis is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.\n\nSee #26103 for a followup.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26105\n\n",
    "closed_at": "2019-10-12T22:12:36Z",
    "created_at": "2018-08-21T17:24:34Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Support base_morphism for hom(im_gens)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25868",
    "user": "https://github.com/saraedum"
}
```
CC:  @roed314 @xcaruso swewers

Keywords: padicBordeaux

Currently, the method `.hom(im_gens)` on parents allows you to define the images of the generators of a structure. This is assuming that the coefficients of these generators can be sent to the codomain with some canonical coercion.

This is often insufficient, e.g., in the case of polynomial rings where you would also like to define a map that translate the ring of coefficients non-canonically. Note that function fields already have a specialized `.hom()` implementation that supports this feature.

See #26103 for a followup.

Issue created by migration from https://trac.sagemath.org/ticket/26105





---

archive/issue_comments_364705.json:
```json
{
    "body": "roed, caruso: I am curious to hear what you think about this. I have been stumbling upon this several times during the past years.",
    "created_at": "2018-08-21T17:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364705",
    "user": "https://github.com/saraedum"
}
```

roed, caruso: I am curious to hear what you think about this. I have been stumbling upon this several times during the past years.



---

archive/issue_comments_364706.json:
```json
{
    "body": "The problem with `im_gens` is that it's not really mathematically defined in the first place. So I wouldn't try to add more functionality to it.\n\nInstead, I would define a specific morphism class for polynomial rings. Mathematically, a ring morphism from a polynomial ring is defined by a morphism of the base together with the images of the generators. That was my plan for #25558 but I stopped working on that...",
    "created_at": "2018-08-21T20:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364706",
    "user": "https://github.com/jdemeyer"
}
```

The problem with `im_gens` is that it's not really mathematically defined in the first place. So I wouldn't try to add more functionality to it.

Instead, I would define a specific morphism class for polynomial rings. Mathematically, a ring morphism from a polynomial ring is defined by a morphism of the base together with the images of the generators. That was my plan for #25558 but I stopped working on that...



---

archive/issue_comments_364707.json:
```json
{
    "body": "Polynomial rings are just one example. Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\nBut I think I also had this issue with fraction fields before.\n\nI agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.\n\nMaybe I'll just use a `SetMorphism` if I shouldn't extend `hom()` though I personally don't like these.\n\nAnyway, let me give a try at extending `hom()` and see what the result looks like.",
    "created_at": "2018-08-29T01:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364707",
    "user": "https://github.com/saraedum"
}
```

Polynomial rings are just one example. Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.

But I think I also had this issue with fraction fields before.

I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.

Maybe I'll just use a `SetMorphism` if I shouldn't extend `hom()` though I personally don't like these.

Anyway, let me give a try at extending `hom()` and see what the result looks like.



---

archive/issue_comments_364708.json:
```json
{
    "body": "Looking at the ring homomorphism code brings back bad memories from #23204. Maybe I don't want to add more to morphism.pyx and homset.py as these should probably be drastically simplified if anything.",
    "created_at": "2018-08-29T02:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364708",
    "user": "https://github.com/saraedum"
}
```

Looking at the ring homomorphism code brings back bad memories from #23204. Maybe I don't want to add more to morphism.pyx and homset.py as these should probably be drastically simplified if anything.



---

archive/issue_comments_364709.json:
```json
{
    "body": "Replying to [comment:4 saraedum]:\n> I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.\n\n\nOf course, if it works using generic code, that's fine for me. But it might be harder to do it that way. I'm pretty sure that some of the existing issues with morphism are precisely because code wants to be too generic and doesn't really know what it is doing.",
    "created_at": "2018-08-29T08:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364709",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:4 saraedum]:
> I agree, that specialized morphism classes can be nice because they might have more knowledge about the objects involved (say to implement is_injective()/is_surjective()) but I don't want to implement a new class whenever I need a map between new types of parents and generic code might do that as well.


Of course, if it works using generic code, that's fine for me. But it might be harder to do it that way. I'm pretty sure that some of the existing issues with morphism are precisely because code wants to be too generic and doesn't really know what it is doing.



---

archive/issue_comments_364710.json:
```json
{
    "body": "Replying to [comment:4 saraedum]:\n> Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\n\nBut this is really a map induced by a polynomial ring map `k[x] \u2192 l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.",
    "created_at": "2018-08-29T08:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364710",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:4 saraedum]:
> Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.


But this is really a map induced by a polynomial ring map `k[x] → l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.



---

archive/issue_comments_364711.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> Replying to [comment:4 saraedum]:\n> > Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(\u03b1)\u2192l`.\n\n> \n> But this is really a map induced by a polynomial ring map `k[x] \u2192 l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.\n\n\nI am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]\u2192l`?",
    "created_at": "2018-08-29T10:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364711",
    "user": "https://github.com/saraedum"
}
```

Replying to [comment:7 jdemeyer]:
> Replying to [comment:4 saraedum]:
> > Another one (see #26103) are extensions, say an extension of a finite field where I would like to define a map `k(α)→l`.

> 
> But this is really a map induced by a polynomial ring map `k[x] → l`. We already have a class for such maps induced on a quotient, so we just need the polynomial ring map.


I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]→l`?



---

archive/issue_comments_364712.json:
```json
{
    "body": "Replying to [comment:8 saraedum]:\n> I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]\u2192l`?\n\n\nBy giving a map `k \u2192 l` and the image of `x`.\n\nIf `k` is not a prime finite field, then use recursion: `k = f[\u03b1]`, so `k \u2192 l` is induced by a map `f[x] \u2192 l`.",
    "created_at": "2018-08-29T11:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364712",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:8 saraedum]:
> I am not sure I understand. If k is not a prime field, then how would I would I define my map `k[x]→l`?


By giving a map `k → l` and the image of `x`.

If `k` is not a prime finite field, then use recursion: `k = f[α]`, so `k → l` is induced by a map `f[x] → l`.



---

archive/issue_comments_364713.json:
```json
{
    "body": "Sorry, my question was how to do this in Sage precisely. So, I can map `k(\u03b1)\u2192k[x]` by mapping the generator to `x`. Then I map `k[x]\u2192l[x]` by using an induced map. Finally I use the evaluation `l[x]\u2192l`. But are people really supposed to figure this out on their own?\n\nIf I understand your proposal in comment 7 above, you would like to see a shortcut to define `k[x]\u2192l` as `(k[x]).hom(\u03b1', base_morphism=k\u2192l)`. But why not go all the way and allow people to write `(k(\u03b1)).hom(\u03b1', base_morphism=k\u2192l)`?",
    "created_at": "2018-08-29T11:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364713",
    "user": "https://github.com/saraedum"
}
```

Sorry, my question was how to do this in Sage precisely. So, I can map `k(α)→k[x]` by mapping the generator to `x`. Then I map `k[x]→l[x]` by using an induced map. Finally I use the evaluation `l[x]→l`. But are people really supposed to figure this out on their own?

If I understand your proposal in comment 7 above, you would like to see a shortcut to define `k[x]→l` as `(k[x]).hom(α', base_morphism=k→l)`. But why not go all the way and allow people to write `(k(α)).hom(α', base_morphism=k→l)`?



---

archive/issue_comments_364714.json:
```json
{
    "body": "Replying to [comment:10 saraedum]:\n> But why not go all the way and allow people to write `(k(\u03b1)).hom(\u03b1', base_morphism=k\u2192l)`?\n\n\nI'm only talking about the implementation. What you \"allow people to write\" is an entirely different discussion.",
    "created_at": "2018-08-29T11:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364714",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:10 saraedum]:
> But why not go all the way and allow people to write `(k(α)).hom(α', base_morphism=k→l)`?


I'm only talking about the implementation. What you "allow people to write" is an entirely different discussion.



---

archive/issue_comments_364715.json:
```json
{
    "body": "An alternative might be to just document these things in the docstring of `hom()`.",
    "created_at": "2018-08-29T12:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364715",
    "user": "https://github.com/saraedum"
}
```

An alternative might be to just document these things in the docstring of `hom()`.



---

archive/issue_comments_364716.json:
```json
{
    "body": "`@`saraedum:\nI'm not sure that I understand what you have in mind. Could you please give a short concrete example of what you would like to see implemented, please?",
    "created_at": "2018-08-29T14:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364716",
    "user": "https://github.com/xcaruso"
}
```

`@`saraedum:
I'm not sure that I understand what you have in mind. Could you please give a short concrete example of what you would like to see implemented, please?



---

archive/issue_comments_364717.json:
```json
{
    "body": "A concrete example where I would like to be able to specify a base_morphism is the following:\n\n```\nsage: k = GF(2)\nsage: R.<a> = k[]\nsage: l.<a> = k.extension(a^3 + a^2 + 1)\nsage: R.<b> = l[]\nsage: m.<b> = l.extension(b^2 + b + a)\nsage: n.<z> = GF(2^6)\n\nsage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))\n```",
    "created_at": "2018-08-29T15:00:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364717",
    "user": "https://github.com/saraedum"
}
```

A concrete example where I would like to be able to specify a base_morphism is the following:

```
sage: k = GF(2)
sage: R.<a> = k[]
sage: l.<a> = k.extension(a^3 + a^2 + 1)
sage: R.<b> = l[]
sage: m.<b> = l.extension(b^2 + b + a)
sage: n.<z> = GF(2^6)

sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))
```



---

archive/issue_comments_364718.json:
```json
{
    "body": "Changing keywords from \"\" to \"padicBordeaux\".",
    "created_at": "2019-09-10T16:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364718",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "padicBordeaux".



---

archive/issue_comments_364719.json:
```json
{
    "body": "I fixed a few other things as well:\n* a whitespace issue in parent.pyx (a function indented three spaces rather than 4)\n* Changed some double underscore attributes to single underscore\n* Switched some custom caching to `cached_method`.\n\n---\nNew commits:",
    "created_at": "2019-09-11T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364719",
    "user": "https://github.com/roed314"
}
```

I fixed a few other things as well:
* a whitespace issue in parent.pyx (a function indented three spaces rather than 4)
* Changed some double underscore attributes to single underscore
* Switched some custom caching to `cached_method`.

---
New commits:



---

archive/issue_comments_364720.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-11T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364720",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_364721.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-12T08:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364722.json:
```json
{
    "body": "Replying to [comment:14 saraedum]:\n> A concrete example where I would like to be able to specify a base_morphism is the following:\n> \n> ```\n> sage: k = GF(2)\n> sage: R.<a> = k[]\n> sage: l.<a> = k.extension(a^3 + a^2 + 1)\n> sage: R.<b> = l[]\n> sage: m.<b> = l.extension(b^2 + b + a)\n> sage: n.<z> = GF(2^6)\n> \n> sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))\n> ```\n\n\nThis example raises the following error with the current implementation:\n\n```\nTraceback (most recent call last)\n...\nValueError: relations do not all (canonically) map to 0 under map determined by images of generators\n```",
    "created_at": "2019-09-12T19:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364722",
    "user": "https://github.com/xcaruso"
}
```

Replying to [comment:14 saraedum]:
> A concrete example where I would like to be able to specify a base_morphism is the following:
> 
> ```
> sage: k = GF(2)
> sage: R.<a> = k[]
> sage: l.<a> = k.extension(a^3 + a^2 + 1)
> sage: R.<b> = l[]
> sage: m.<b> = l.extension(b^2 + b + a)
> sage: n.<z> = GF(2^6)
> 
> sage: m.hom([z^4 + z^3 + 1], base_morphism=l.hom([z^5 + z^4 + z^2]))
> ```


This example raises the following error with the current implementation:

```
Traceback (most recent call last)
...
ValueError: relations do not all (canonically) map to 0 under map determined by images of generators
```



---

archive/issue_comments_364723.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-12T19:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364723",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_364724.json:
```json
{
    "body": "A similar problem occurs with Lie algebras:\n\n```\nsage: R.<x> = ZZ[]\nsage: K.<i> = NumberField(x^2 + 1)\nsage: cc = K.hom([-i])\nsage: L.<X,Y,Z,W> = LieAlgebra(K, {('X','Y'): {'Z':i}, ('X','Z'): {'W':1}})\nsage: M.<A,B,C,D> = LieAlgebra(K, {('A','B'): {'C':i}, ('A','C'): {'D':1}})\nsage: phi = L.morphism({X:A, Y:B, Z:C, W:D}, base_map=cc)\n```\n\nThe last line should raise an error since `phi` is not a Lie Algebra morphism:\n\n```\nsage: phi(X.bracket(Y))\n-i*C\nsage: phi(X).bracket(phi(Y))\ni*C\n```\n\nIn the same fashion, if I define:\n\n```\nsage: phi = L.morphism({X:A,Y:B,W:D}, base_map=cc)\n```\n\nI expect `Z` to be mapped to `-C` but this is not the case:\n\n```\nsage: phi(Z)\nC\n```",
    "created_at": "2019-09-12T19:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364724",
    "user": "https://github.com/xcaruso"
}
```

A similar problem occurs with Lie algebras:

```
sage: R.<x> = ZZ[]
sage: K.<i> = NumberField(x^2 + 1)
sage: cc = K.hom([-i])
sage: L.<X,Y,Z,W> = LieAlgebra(K, {('X','Y'): {'Z':i}, ('X','Z'): {'W':1}})
sage: M.<A,B,C,D> = LieAlgebra(K, {('A','B'): {'C':i}, ('A','C'): {'D':1}})
sage: phi = L.morphism({X:A, Y:B, Z:C, W:D}, base_map=cc)
```

The last line should raise an error since `phi` is not a Lie Algebra morphism:

```
sage: phi(X.bracket(Y))
-i*C
sage: phi(X).bracket(phi(Y))
i*C
```

In the same fashion, if I define:

```
sage: phi = L.morphism({X:A,Y:B,W:D}, base_map=cc)
```

I expect `Z` to be mapped to `-C` but this is not the case:

```
sage: phi(Z)
C
```



---

archive/issue_comments_364725.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T13:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364725",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364726.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T13:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364727.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-13T13:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364727",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_364728.json:
```json
{
    "body": "Okay, I think I've addressed Xavier's comments.",
    "created_at": "2019-09-13T13:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364728",
    "user": "https://github.com/roed314"
}
```

Okay, I think I've addressed Xavier's comments.



---

archive/issue_comments_364729.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T15:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364729",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364730.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364730",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364731.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T23:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364731",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364732.json:
```json
{
    "body": "There are still issues with Lie algebra:\n\n```\nsage: R.<x> = ZZ[]\nsage: K.<i> = NumberField(x^2 + 1)\nsage: cc = K.hom([-i])\nsage: L.<X,Y,Z> = LieAlgebra(K, {('X','Y'): {'Z':i}})\nsage: M.<A,B,C> = LieAlgebra(K, {('A','B'): {'C':-i}})\nsage: phi = L.morphism({X:A, Y:B, Z:C}, base_map=cc)\nTraceback (most recent call last):\n...\nValueError: this does not define a Lie algebra morphism; contradictory values for brackets of length 2\n```\n\nbut I think that `phi` is a well-defined semi-linear morphism of Lie algebras.\n\nThe checking is performed in the `__init__` function of `LieAlgebraMorphism_from_generators` (starting at line 474 of `src/sage/algebras/lie_algebras/morphism.py`).",
    "created_at": "2019-09-15T04:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364732",
    "user": "https://github.com/xcaruso"
}
```

There are still issues with Lie algebra:

```
sage: R.<x> = ZZ[]
sage: K.<i> = NumberField(x^2 + 1)
sage: cc = K.hom([-i])
sage: L.<X,Y,Z> = LieAlgebra(K, {('X','Y'): {'Z':i}})
sage: M.<A,B,C> = LieAlgebra(K, {('A','B'): {'C':-i}})
sage: phi = L.morphism({X:A, Y:B, Z:C}, base_map=cc)
Traceback (most recent call last):
...
ValueError: this does not define a Lie algebra morphism; contradictory values for brackets of length 2
```

but I think that `phi` is a well-defined semi-linear morphism of Lie algebras.

The checking is performed in the `__init__` function of `LieAlgebraMorphism_from_generators` (starting at line 474 of `src/sage/algebras/lie_algebras/morphism.py`).



---

archive/issue_comments_364733.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-15T04:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364733",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_364734.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-26T20:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364735.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-26T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364736.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-03T19:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364736",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_364737.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-03T21:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364738.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-03T21:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364739.json:
```json
{
    "body": "LGTM (see also discussion on Zulip).\n\nPositive review when patchbot is happy.",
    "created_at": "2019-10-03T23:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364739",
    "user": "https://github.com/xcaruso"
}
```

LGTM (see also discussion on Zulip).

Positive review when patchbot is happy.



---

archive/issue_comments_364740.json:
```json
{
    "body": "There are failing doctests.\n\n```\nFile \"src/sage/rings/morphism.pyx\", line 837, in sage.rings.morphism.RingHomomorphism._composition_\nFailed example:\n    (f*f).base_map()\nExpected:\n    Ring morphism:\n      From: Univariate Polynomial Ring in x over Rational Field\n      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field\n      Defn: x |--> 2*x\nGot:\n    Ring morphism:\n      From: Univariate Polynomial Ring in x over Rational Field\n      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field\n      Defn: x |--> 2*x\n            with map of base ring\n**********************************************************************\nFile \"src/sage/rings/morphism.pyx\", line 1117, in sage.rings.morphism.RingHomomorphism_im_gens.__init__\nFailed example:\n    phi = S.hom([xx+1,xx-1],check=False)\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: images do not define a valid homomorphism\nGot:\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/rings/morphism.pyx\", line 1192, in sage.rings.morphism.RingHomomorphism_im_gens.base_map\nFailed example:\n    phi.base_map()\nExpected:\n    Ring endomorphism of Number Field in i with defining polynomial x^2 + 1\n      Defn: i |--> -i\nGot:\n    Composite map:\n      From: Number Field in i with defining polynomial x^2 + 1\n      To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1\n      Defn:   Ring endomorphism of Number Field in i with defining polynomial x^2 + 1\n              Defn: i |--> -i\n            then\n              Polynomial base injection morphism:\n              From: Number Field in i with defining polynomial x^2 + 1\n              To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 311, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f = R.hom([x+1], base_map=lambda t: t+1); f\nException raised:\n    Traceback (most recent call last):\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.structure.parent_gens.ParentWithGens.gens.hom[22]>\", line 1, in <module>\n        f = R.hom([x+Integer(1)], base_map=lambda t: t+Integer(1)); f\n      File \"sage/structure/parent_gens.pyx\", line 328, in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3690)\n        return parent.Parent.hom(self, im_gens, codomain, base_map=base_map, category=category, check=check)\n      File \"sage/structure/parent.pyx\", line 1360, in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:11708)\n        return self.Hom(codomain, **Hom_kwds)(im_gens, **kwds)\n      File \"/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/homset.py\", line 208, in __call__\n        return morphism.RingHomomorphism_im_gens(self, im_gens, base_map=base_map, check=check)\n      File \"sage/rings/morphism.pyx\", line 1134, in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8239)\n        if base_map.codomain() is not self.codomain():\n    AttributeError: 'function' object has no attribute 'codomain'\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 315, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f.category_for()\nExpected:\n    Join of Category of euclidean domains and Category of commutative algebras over (finite enumerated fields and subquotients of monoids and quotients of semigroups) and Category of infinite sets\nGot:\n    Category of enumerated euclidean domains\n**********************************************************************\nFile \"src/sage/structure/parent_gens.pyx\", line 317, in sage.structure.parent_gens.ParentWithGens.gens.hom\nFailed example:\n    f(-1)\nExpected:\n    0\nGot:\n    4\n**********************************************************************\n```\n\nAnd the flag is red for non_ascii and pyflakes but I don't understand what's wrong.",
    "created_at": "2019-10-04T06:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364740",
    "user": "https://github.com/xcaruso"
}
```

There are failing doctests.

```
File "src/sage/rings/morphism.pyx", line 837, in sage.rings.morphism.RingHomomorphism._composition_
Failed example:
    (f*f).base_map()
Expected:
    Ring morphism:
      From: Univariate Polynomial Ring in x over Rational Field
      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
      Defn: x |--> 2*x
Got:
    Ring morphism:
      From: Univariate Polynomial Ring in x over Rational Field
      To:   Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
      Defn: x |--> 2*x
            with map of base ring
**********************************************************************
File "src/sage/rings/morphism.pyx", line 1117, in sage.rings.morphism.RingHomomorphism_im_gens.__init__
Failed example:
    phi = S.hom([xx+1,xx-1],check=False)
Expected:
    Traceback (most recent call last):
    ...
    TypeError: images do not define a valid homomorphism
Got:
    <BLANKLINE>
**********************************************************************
File "src/sage/rings/morphism.pyx", line 1192, in sage.rings.morphism.RingHomomorphism_im_gens.base_map
Failed example:
    phi.base_map()
Expected:
    Ring endomorphism of Number Field in i with defining polynomial x^2 + 1
      Defn: i |--> -i
Got:
    Composite map:
      From: Number Field in i with defining polynomial x^2 + 1
      To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1
      Defn:   Ring endomorphism of Number Field in i with defining polynomial x^2 + 1
              Defn: i |--> -i
            then
              Polynomial base injection morphism:
              From: Number Field in i with defining polynomial x^2 + 1
              To:   Univariate Polynomial Ring in y over Number Field in i with defining polynomial x^2 + 1
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 311, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f = R.hom([x+1], base_map=lambda t: t+1); f
Exception raised:
    Traceback (most recent call last):
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.structure.parent_gens.ParentWithGens.gens.hom[22]>", line 1, in <module>
        f = R.hom([x+Integer(1)], base_map=lambda t: t+Integer(1)); f
      File "sage/structure/parent_gens.pyx", line 328, in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3690)
        return parent.Parent.hom(self, im_gens, codomain, base_map=base_map, category=category, check=check)
      File "sage/structure/parent.pyx", line 1360, in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:11708)
        return self.Hom(codomain, **Hom_kwds)(im_gens, **kwds)
      File "/local/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/homset.py", line 208, in __call__
        return morphism.RingHomomorphism_im_gens(self, im_gens, base_map=base_map, check=check)
      File "sage/rings/morphism.pyx", line 1134, in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8239)
        if base_map.codomain() is not self.codomain():
    AttributeError: 'function' object has no attribute 'codomain'
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 315, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f.category_for()
Expected:
    Join of Category of euclidean domains and Category of commutative algebras over (finite enumerated fields and subquotients of monoids and quotients of semigroups) and Category of infinite sets
Got:
    Category of enumerated euclidean domains
**********************************************************************
File "src/sage/structure/parent_gens.pyx", line 317, in sage.structure.parent_gens.ParentWithGens.gens.hom
Failed example:
    f(-1)
Expected:
    0
Got:
    4
**********************************************************************
```

And the flag is red for non_ascii and pyflakes but I don't understand what's wrong.



---

archive/issue_comments_364741.json:
```json
{
    "body": "I've just updated the doctest.\n\nIf you agree with my changes, please give a positive review.\n\n---\nNew commits:",
    "created_at": "2019-10-06T19:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364741",
    "user": "https://github.com/xcaruso"
}
```

I've just updated the doctest.

If you agree with my changes, please give a positive review.

---
New commits:



---

archive/issue_comments_364742.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2019-10-10T19:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364742",
    "user": "https://github.com/roed314"
}
```

Looks good to me.



---

archive/issue_comments_364743.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-10T19:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364743",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065134.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-11T12:08:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25868#event-65134"
}
```



---

archive/issue_comments_364744.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-12T22:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25868#issuecomment-364744",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065135.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-12T22:12:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25868",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25868#event-65135"
}
```
