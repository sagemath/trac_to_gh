# Issue 14628: Unified construction of irreducible polynomials over finite fields

archive/issues_014628.json:
```json
{
    "body": "Assignee: @ClementPernet\n\nCC:  @xcaruso\n\nKeywords: polynomials\n\nCurrently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket, the `FiniteField` constructor will be adapted to call this function.\n\nSince it uses PARI's `ffinit`, this depends on #14817.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14832\n\n",
    "created_at": "2013-06-27T07:30:40Z",
    "labels": [
        "finite rings",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Unified construction of irreducible polynomials over finite fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14628",
    "user": "@pjbruin"
}
```
Assignee: @ClementPernet

CC:  @xcaruso

Keywords: polynomials

Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket, the `FiniteField` constructor will be adapted to call this function.

Since it uses PARI's `ffinit`, this depends on #14817.

Issue created by migration from https://trac.sagemath.org/ticket/14832





---

archive/issue_comments_186138.json:
```json
{
    "body": "based on 5.11.beta3",
    "created_at": "2013-06-27T07:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186138",
    "user": "@pjbruin"
}
```

based on 5.11.beta3



---

archive/issue_comments_186139.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-27T07:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186139",
    "user": "@pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_186140.json:
```json
{
    "body": "Attachment [trac_14832_make_irreducible_polynomial.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832_make_irreducible_polynomial.patch) by @pjbruin created at 2013-06-27 07:42:07",
    "created_at": "2013-06-27T07:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186140",
    "user": "@pjbruin"
}
```

Attachment [trac_14832_make_irreducible_polynomial.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832_make_irreducible_polynomial.patch) by @pjbruin created at 2013-06-27 07:42:07



---

archive/issue_comments_186141.json:
```json
{
    "body": "Moved finite field-specific code from `PolynomialRing_field.__init__()` to `PolynomialRing_dense_finite_field.__init__()`.",
    "created_at": "2013-06-29T10:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186141",
    "user": "@pjbruin"
}
```

Moved finite field-specific code from `PolynomialRing_field.__init__()` to `PolynomialRing_dense_finite_field.__init__()`.



---

archive/issue_comments_186142.json:
```json
{
    "body": "new class for polynomial rings over finite fields",
    "created_at": "2013-06-29T10:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186142",
    "user": "@pjbruin"
}
```

new class for polynomial rings over finite fields



---

archive/issue_comments_186143.json:
```json
{
    "body": "Attachment [trac_14832-PolynomialRing_dense_finite_field.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch) by @pjbruin created at 2013-06-29 10:14:35\n\nmethod irreducible_element()",
    "created_at": "2013-06-29T10:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186143",
    "user": "@pjbruin"
}
```

Attachment [trac_14832-PolynomialRing_dense_finite_field.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch) by @pjbruin created at 2013-06-29 10:14:35

method irreducible_element()



---

archive/issue_comments_186144.json:
```json
{
    "body": "Attachment [trac_14832-irreducible_polynomial.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-irreducible_polynomial.patch) by jpflori created at 2013-07-08 14:43:17\n\nIs there any reason for removing the implementation arg to the PR_field constructor?\nI agree it's not used, but maybe at some point :)\n\nAnd why not test in the PR_field constructor if the field is finite and call the new constructor in that case?\n\nBy the way, I'm not sure using is_FiniteField is the right way to check for finite fields.\nUsing the category framework and doing something like \"R in FiniteFields()\" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.",
    "created_at": "2013-07-08T14:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186144",
    "user": "jpflori"
}
```

Attachment [trac_14832-irreducible_polynomial.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-irreducible_polynomial.patch) by jpflori created at 2013-07-08 14:43:17

Is there any reason for removing the implementation arg to the PR_field constructor?
I agree it's not used, but maybe at some point :)

And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.



---

archive/issue_comments_186145.json:
```json
{
    "body": "(The same category stuff would be true for IntegerModRing and so on... but I'm not asking you to fix the old code, just not to introduce new \"bad\" stuff.)",
    "created_at": "2013-07-08T14:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186145",
    "user": "jpflori"
}
```

(The same category stuff would be true for IntegerModRing and so on... but I'm not asking you to fix the old code, just not to introduce new "bad" stuff.)



---

archive/issue_comments_186146.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-07-08T14:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186146",
    "user": "jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_186147.json:
```json
{
    "body": "You also need to use two consecutive colons to introduce examples:\n\n```\nEXAMPLES::\n\n    sage: 1+1\n    2\n```\n\nor\n\n```\nEXAMPLES:\n\nWe check that 1+1 is equal to 2::\n\n    sage: 1+1\n    2\n```\n",
    "created_at": "2013-07-08T14:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186147",
    "user": "jpflori"
}
```

You also need to use two consecutive colons to introduce examples:

```
EXAMPLES::

    sage: 1+1
    2
```

or

```
EXAMPLES:

We check that 1+1 is equal to 2::

    sage: 1+1
    2
```




---

archive/issue_comments_186148.json:
```json
{
    "body": "Replying to [comment:5 jpflori]:\n> Is there any reason for removing the implementation arg to the PR_field constructor?\n> I agree it's not used, but maybe at some point :)\n>\n> And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?\n\nI think it is better to be conservative with the `implementation` parameter: allow it for the generic `PolynomialRing` constructor and pass it to subclasses that actually have different implementations, but do not add (or keep) the flag in subclasses where it does not do anything.\n\n> By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.\n> Using the category framework and doing something like \"R in FiniteFields()\" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.\n\nI did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.\n\nFirst, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.\n\nSecond, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)",
    "created_at": "2013-07-11T16:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186148",
    "user": "@pjbruin"
}
```

Replying to [comment:5 jpflori]:
> Is there any reason for removing the implementation arg to the PR_field constructor?
> I agree it's not used, but maybe at some point :)
>
> And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

I think it is better to be conservative with the `implementation` parameter: allow it for the generic `PolynomialRing` constructor and pass it to subclasses that actually have different implementations, but do not add (or keep) the flag in subclasses where it does not do anything.

> By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
> Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.

I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.

First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.

Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)



---

archive/issue_comments_186149.json:
```json
{
    "body": "Replying to [comment:8 pbruin]:\n> I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.\n> \n> First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.\n>\nI'd say that a subfield of an algebraic closure would be in the category of finite fields and the new one, just as it is as well in that of integral domains. \n> Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)\nI agree, but I don't think the test performed by is_FiniteField is to ensure implementations details, but really the fact that the robject represents a finite field.\n\nAnyway, as you pointed out you just moved the test  so let's keep this for later.\n\nIf you fix the doc, I'll happily positive review that.",
    "created_at": "2013-07-11T20:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186149",
    "user": "jpflori"
}
```

Replying to [comment:8 pbruin]:
> I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.
> 
> First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.
>
I'd say that a subfield of an algebraic closure would be in the category of finite fields and the new one, just as it is as well in that of integral domains. 
> Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)
I agree, but I don't think the test performed by is_FiniteField is to ensure implementations details, but really the fact that the robject represents a finite field.

Anyway, as you pointed out you just moved the test  so let's keep this for later.

If you fix the doc, I'll happily positive review that.



---

archive/issue_comments_186150.json:
```json
{
    "body": "Reviewer patch.",
    "created_at": "2013-07-11T21:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186150",
    "user": "jpflori"
}
```

Reviewer patch.



---

archive/issue_comments_186151.json:
```json
{
    "body": "Attachment [trac_14832-reviewer.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-reviewer.patch) by jpflori created at 2013-07-11 21:21:47",
    "created_at": "2013-07-11T21:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186151",
    "user": "jpflori"
}
```

Attachment [trac_14832-reviewer.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-reviewer.patch) by jpflori created at 2013-07-11 21:21:47



---

archive/issue_comments_186152.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-07-11T21:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186152",
    "user": "jpflori"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_186153.json:
```json
{
    "body": "For the patchbot, apply only:\n* [attachment:trac_14832-PolynomialRing_dense_finite_field.patch],\n* [attachment:trac_14832-irreducible_polynomial.patch],\n* [attachment:trac_14832-reviewer.patch].",
    "created_at": "2013-07-12T09:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186153",
    "user": "jpflori"
}
```

For the patchbot, apply only:
* [attachment:trac_14832-PolynomialRing_dense_finite_field.patch],
* [attachment:trac_14832-irreducible_polynomial.patch],
* [attachment:trac_14832-reviewer.patch].



---

archive/issue_comments_186154.json:
```json
{
    "body": "The patchbot doesn't get it:\n\nApply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch",
    "created_at": "2013-07-16T09:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186154",
    "user": "@pjbruin"
}
```

The patchbot doesn't get it:

Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch



---

archive/issue_comments_186155.json:
```json
{
    "body": "\n```\nApply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch\n```\n",
    "created_at": "2013-07-17T08:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186155",
    "user": "@pjbruin"
}
```


```
Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch
```




---

archive/issue_comments_186156.json:
```json
{
    "body": "Attachment [trac_14832-doctest.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-doctest.patch) by @pjbruin created at 2013-07-17 13:12:56\n\nadd doctest",
    "created_at": "2013-07-17T13:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186156",
    "user": "@pjbruin"
}
```

Attachment [trac_14832-doctest.patch](tarball://root/attachments/some-uuid/ticket14832/trac_14832-doctest.patch) by @pjbruin created at 2013-07-17 13:12:56

add doctest



---

archive/issue_comments_186157.json:
```json
{
    "body": "Just want to confirm that Peter's patch solves the patchbot rant and is correct.",
    "created_at": "2013-07-17T13:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186157",
    "user": "jpflori"
}
```

Just want to confirm that Peter's patch solves the patchbot rant and is correct.



---

archive/issue_comments_186158.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-16T21:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14628#issuecomment-186158",
    "user": "@jdemeyer"
}
```

Resolution: fixed
