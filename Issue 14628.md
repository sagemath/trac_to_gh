# Issue 14628: Unified construction of irreducible polynomials over finite fields

Issue created by migration from https://trac.sagemath.org/ticket/14832

Original creator: pbruin

Original creation time: 2013-06-27 07:30:40

Assignee: cpernet

CC:  caruso

Keywords: polynomials

Currently, every finite field implementation (integers mod _p_, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket, the `FiniteField` constructor will be adapted to call this function.

Since it uses PARI's `ffinit`, this depends on #14817.


---

Comment by pbruin created at 2013-06-27 07:32:09

based on 5.11.beta3


---

Comment by pbruin created at 2013-06-27 07:42:07

Changing status from new to needs_review.


---

Attachment


---

Comment by pbruin created at 2013-06-29 10:04:28

Moved finite field-specific code from `PolynomialRing_field.__init__()` to `PolynomialRing_dense_finite_field.__init__()`.


---

Comment by pbruin created at 2013-06-29 10:05:39

new class for polynomial rings over finite fields


---

Attachment

method irreducible_element()


---

Attachment

Is there any reason for removing the implementation arg to the PR_field constructor?
I agree it's not used, but maybe at some point :)

And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.


---

Comment by jpflori created at 2013-07-08 14:45:26

(The same category stuff would be true for IntegerModRing and so on... but I'm not asking you to fix the old code, just not to introduce new "bad" stuff.)


---

Comment by jpflori created at 2013-07-08 14:49:52

Changing status from needs_review to needs_work.


---

Comment by jpflori created at 2013-07-08 14:49:52

You also need to use two consecutive colons to introduce examples:

```
EXAMPLES::

    sage: 1+1
    2
```

or

```
EXAMPLES:

We check that 1+1 is equal to 2::

    sage: 1+1
    2
```



---

Comment by pbruin created at 2013-07-11 16:59:03

Replying to [comment:5 jpflori]:
> Is there any reason for removing the implementation arg to the PR_field constructor?
> I agree it's not used, but maybe at some point :)
>
> And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

I think it is better to be conservative with the `implementation` parameter: allow it for the generic `PolynomialRing` constructor and pass it to subclasses that actually have different implementations, but do not add (or keep) the flag in subclasses where it does not do anything.

> By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
> Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.

I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.

First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of *F*<sub>_p_</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.

Second, one reason to have different implementations of `PolynomialRing` _is_ so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)


---

Comment by jpflori created at 2013-07-11 20:03:17

Replying to [comment:8 pbruin]:
> I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.
> 
> First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of *F*<sub>_p_</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.
>
I'd say that a subfield of an algebraic closure would be in the category of finite fields and the new one, just as it is as well in that of integral domains. 
> Second, one reason to have different implementations of `PolynomialRing` _is_ so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)
I agree, but I don't think the test performed by is_FiniteField is to ensure implementations details, but really the fact that the robject represents a finite field.

Anyway, as you pointed out you just moved the test  so let's keep this for later.

If you fix the doc, I'll happily positive review that.


---

Comment by jpflori created at 2013-07-11 21:21:04

Reviewer patch.


---

Attachment


---

Comment by jpflori created at 2013-07-11 21:21:47

Changing status from needs_work to positive_review.


---

Comment by jpflori created at 2013-07-12 09:44:28

For the patchbot, apply only:
* [attachment:trac_14832-PolynomialRing_dense_finite_field.patch],
* [attachment:trac_14832-irreducible_polynomial.patch],
* [attachment:trac_14832-reviewer.patch].


---

Comment by pbruin created at 2013-07-16 09:44:28

The patchbot doesn't get it:

Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch


---

Comment by pbruin created at 2013-07-17 08:42:46


```
Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch
```



---

Attachment

add doctest


---

Comment by jpflori created at 2013-07-17 13:29:20

Just want to confirm that Peter's patch solves the patchbot rant and is correct.


---

Comment by jdemeyer created at 2013-08-16 21:12:58

Resolution: fixed
