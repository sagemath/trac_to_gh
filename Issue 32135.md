# Issue 32135: requests: Upgrade to 2.26.0, add new (unvendored) deps

Issue created by migration from https://trac.sagemath.org/ticket/32372

Original creator: mkoeppe

Original creation time: 2021-08-12 17:56:45

CC:  chapoton slelievre dimpase

(split out from #31280)

As noted in #31280#comment:65, this will help for #30768 and hence for Python 3.10 compatibility


---

Comment by mkoeppe created at 2021-08-12 17:59:54

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-08-12 17:59:54

New commits:


---

Comment by git created at 2021-08-12 18:31:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-08-13 01:59:32

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-08-13 01:59:32

requests 2.26.0 has switched from `chardet` to `charset_normalizer`
https://docs.python-requests.org/en/master/community/updates/#id1


---

Comment by git created at 2021-08-13 04:13:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-08-13 04:22:00

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2021-08-21 12:47:06

Would a round of github-actions be a good way
to start a review of this?


---

Comment by chapoton created at 2021-08-21 15:27:43

I have launched one some hours ago. It should take 1 day or more.

https://github.com/sagemath/sagetrac-mirror/actions/runs/1153312296


---

Comment by chapoton created at 2021-08-21 18:09:13

apparently, the github CI is not able to use the "upstream_url" for "charset_normalizer"


---

Comment by mkoeppe created at 2021-08-21 20:24:16

The download failure on `ubuntu-trusty-standard` [https://github.com/sagemath/sagetrac-mirror/runs/3388617349?check_suite_focus=true](https://github.com/sagemath/sagetrac-mirror/runs/3388617349?check_suite_focus=true)

```
  [urllib3-1.26.6]   [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
  [urllib3-1.26.6]   ERROR [transfer|run:135]: [Errno 403] SNI is required: '//pypi.io/packages/source/u/urllib3/urllib3-1.26.6.tar.gz'
  [urllib3-1.26.6]   ************************************************************************
  [urllib3-1.26.6]   Traceback (most recent call last):
  [urllib3-1.26.6]     File "/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 126, in run_safe
  [urllib3-1.26.6]       run()
```

is new (and unrelated to #32403)


---

Comment by mkoeppe created at 2021-08-21 20:26:13

This appears to be from https://github.com/pypa/pypi-support/issues/978 ("Deprecation of non-SNI compatible clients")


---

Comment by mkoeppe created at 2021-08-21 22:33:06

I've opened #32405 for this failure; it has no technical relation to the present ticket.


---

Comment by dimpase created at 2021-08-30 20:24:07

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-08-30 20:24:07

lgtm


---

Comment by mkoeppe created at 2021-08-30 20:25:16

Thanks!


---

Comment by vbraun created at 2021-09-07 20:52:08

Resolution: fixed
