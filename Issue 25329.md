# Issue 25329: small failing graphviz optional doctest in posets.py and doctest/external.py

Issue created by migration from Trac.

Original creator: slabbe

Original creation time: 2018-06-12 13:35:51

On top of 8.3.beta5 (available on github develop branch)


```
sage -t --optional=sage,optional,external src/sage/doctest/external.py src/sage/combinat/posets/posets.py
```


gives


```
Using --optional=bliss,cbc,ccache,cmake,dot2tex,external,gmpy2,mpir,python2,sage
External software to be detected: cplex,ffmpeg,graphviz,gurobi,imagemagick,internet,latex,macaulay2,magma,maple,mathematica,matlab,octave,scilab
Doctesting 2 files.
sage -t src/sage/doctest/external.py
**********************************************************************
File "src/sage/doctest/external.py", line 233, in sage.doctest.external.has_graphviz
Failed example:
    has_graphviz()   # optional -- graphviz
Expected:
    True
Got:
    FeatureTestResult('Graphviz', True)
**********************************************************************
File "src/sage/doctest/external.py", line 246, in sage.doctest.external.has_ffmpeg
Failed example:
    has_ffmpeg()      # optional -- ffmpeg
Expected:
    True
Got:
    FeatureTestResult('FFmpeg', True)
**********************************************************************
File "src/sage/doctest/external.py", line 259, in sage.doctest.external.has_imagemagick
Failed example:
    has_imagemagick() # optional -- imagemagick
Expected:
    True
Got:
    FeatureTestResult('convert', True)
**********************************************************************
3 items had failures:
   1 of   3 in sage.doctest.external.has_ffmpeg
   1 of   3 in sage.doctest.external.has_graphviz
   1 of   3 in sage.doctest.external.has_imagemagick
    [44 tests, 3 failures, 4.82 s]
sage -t src/sage/combinat/posets/posets.py
**********************************************************************
File "src/sage/combinat/posets/posets.py", line 1317, in sage.combinat.posets.posets.FinitePoset._latex_
Failed example:
    print(P._latex_()) #optional - dot2tex graphviz
Expected:
    \begin{tikzpicture}[>=latex,line join=bevel,]
    %%
    \node (node_1) at (6.0...bp,57.0...bp) [draw,draw=none] {$2$};
      \node (node_0) at (6.0...bp,7.0...bp) [draw,draw=none] {$1$};
      \draw [black,->] (node_0) ..controls (...bp,...bp) and (...bp,...bp)  .. (node_1);
    %
    \end{tikzpicture}
Got:
    \begin{tikzpicture}[>=latex,line join=bevel,]
    %%
    \node (node_1) at (6.0bp,55.5bp) [draw,draw=none] {$2$};
      \node (node_0) at (6.0bp,6.5bp) [draw,draw=none] {$1$};
      \draw [black,->] (node_0) ..controls (6.0bp,19.603bp) and (6.0bp,30.062bp)  .. (node_1);
    %
    \end{tikzpicture}
**********************************************************************
1 item had failures:
   1 of   3 in sage.combinat.posets.posets.FinitePoset._latex_
    [1272 tests, 1 failure, 8.26 s]
```



---

Comment by slabbe created at 2018-06-12 13:40:44

Changing status from new to needs_review.


---

Comment by slabbe created at 2018-06-12 13:40:44

New commits:


---

Comment by chapoton created at 2018-06-12 20:11:25

ok


---

Comment by chapoton created at 2018-06-12 20:11:25

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-06-14 07:40:55

Resolution: fixed
