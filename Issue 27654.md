# Issue 27654: Add options for flipping plot axes

Issue created by migration from https://trac.sagemath.org/ticket/27891

Original creator: @mwageringel

Original creation time: 2019-05-29 06:39:05

Keywords: matplotlib

This ticket implements new show options `flip_x` and `flip_y` for flipping the direction of axes in 2d graphics. This was previously suggested in comment:12:ticket:18463.

Currently, something similar can be achieved by setting limits such that `xmin > xmax`.

```
sage: plot(x).show(xmin=1, xmax=-1)
```

This works because it is supported by matplotlib, but it is fragile and does not seem to be documented anywhere in Sage, apart from some implementation comments in `sage.plot.graphics`. The implementation of `matrix_plot` also relies on this, as by default matrices are plotted with the vertical axis directed downward. This leads to subtle issues like the following.

```
sage: p = matrix_plot(identity_matrix(5))
sage: p.get_minmax_data()
{ xmin:-0.5, ymin:4.5, ymax:-0.5, xmax:4.5 }
sage: p2 = p + point((2, 2), zorder=1)
sage: p2.get_minmax_data()
{ xmin:-0.5, ymin:1.0, ymax:3.0, xmax:4.5 }
```

Here, the bounding box of `p` has `ymin > ymax` which does not get taken into account when adding plots. As a consequence, `p2` does not show the entire matrix.

As a solution that is hopefully more robust, this ticket adds `flip_x`/`flip_y` options that are documented to the user. For example:

```
sage: plot(x, -1, 1, flip_x=True)
```

From now on, the minmax data should always have `min <= max`, though for backward compatibility this is not enforced. When summing plots, flipped axes take precedence.

In `matrix_plot`, the now redundant option `origin='upper'`/`origin='lower'` is deprecated and replaced by `flip_y`.

Moreover, this ticket fixes an issue with plots of sparse matrices for which the data was incorrectly flipped:

```
sage: matrix_plot(identity_matrix(5, sparse=True), origin='lower')
```


See #18463 and #18612 for some related discussions.



---

Attachment


---

Attachment


---

Attachment


---

Attachment

New commits:


---

Comment by @mwageringel created at 2019-05-29 07:02:10

Changing status from new to needs_review.


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by vdelecroix created at 2020-02-22 23:16:16

Nice!

How do I do a `graphics_array` that would show the four versions of the following picture with all possible values for `flip_x`/`flip_y`? The following is somehow inconvenient

```
l = []
for flip_x in [False, True]:
    for flip_y in [False, True]:
        H = circle((1,0),2,color='red') + line2d([(-1,3),(1,5)], color='blue')
        H._extra_kwds['flip_x'] = flip_x
        H._extra_kwds['flip_y'] = flip_y
        l.append(H)
graphics_array(l,2,2)
```



---

Comment by @mwageringel created at 2020-02-22 23:46:03

Replying to [comment:4 vdelecroix]:
> Nice!
> 
> How do I do a `graphics_array` that would show the four versions of the following picture with all possible values for `flip_x`/`flip_y`? The following is somehow inconvenient

It could be done like this:


```
graphics_array([circle((1,0),2,color='red') +
                line2d([(-1,3),(1,5)], color='blue', flip_x=flip_x, flip_y=flip_y)
                for flip_x in [False, True]
                for flip_y in [False, True]], 2, 2)
```


This works because flipped axes take precedence when taking the sum of two graphics objects.


---

Comment by vdelecroix created at 2020-02-23 09:13:47

If I have a graphic `G` and I changed my mind about flipping. Should we have something like `G.set_flip(flip_x=True)`? I just mention this because of the existence of `G.set_aspect_ratio(ratio)`, `G.set_axes_range(xmin, xmax, ymin, ymax)`, `G.set_legend_options(**kwds)`.


---

Comment by vdelecroix created at 2020-02-23 09:18:11

(of course what I wrote in [comment:4 comment:4] is a way to do it, but not a very nice user interface)


---

Comment by git created at 2020-02-23 12:02:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mwageringel created at 2020-02-23 12:02:49

Replying to [comment:6 vdelecroix]:
> If I have a graphic `G` and I changed my mind about flipping. Should we have something like `G.set_flip(flip_x=True)`? I just mention this because of the existence of `G.set_aspect_ratio(ratio)`, `G.set_axes_range(xmin, xmax, ymin, ymax)`, `G.set_legend_options(**kwds)`.

Good idea. I have added a getter and setter for `flip_x`/`flip_y`.


---

Comment by vdelecroix created at 2020-02-23 12:45:15

You could make `flip` way shorter

```
if flip_x:
    self._extra_kwds['flip_x'] = not self._extra_kwds.get('flip_x', self.SHOW_OPTIONS['flip_x'])
if flip_y:
    self._extra_kwds['flip_y'] = not self._extra_kwds.get('flip_y', self.SHOW_OPTIONS['flip_y'])
```



---

Comment by @mwageringel created at 2020-02-23 12:49:31

Then it could not be used as getter anymore.


---

Comment by vdelecroix created at 2020-02-23 12:55:11

Oh I see your point. With `False/False` it is a getter :-) But the first line description is very confusing

```
Mirror this graphics object and get the new flip options.
```

By default the method does **not** change anything.


---

Comment by git created at 2020-02-23 13:11:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mwageringel created at 2020-02-23 13:12:56

Indeed, that was a bit convoluted. It should be better now.


---

Comment by vdelecroix created at 2020-02-23 13:23:51

Changing status from needs_review to positive_review.


---

Comment by @mwageringel created at 2020-02-23 13:33:00

Thank you for the review.


---

Comment by vbraun created at 2020-02-25 19:51:09

Resolution: fixed
