# Issue 25652: Backport a fix for std(id,P) in Singular

Issue created by migration from https://trac.sagemath.org/ticket/25889

Original creator: SimonKing

Original creation time: 2018-07-20 11:57:56

CC:  slelievre

Keywords: Singular std

In Singular, if `id` is an ideal given by a standard basis and `P` is a list of polynomials, then `std(id,P)` is computing a standard basis for the ideal generated by `id` and `P`. It is supposed to take into account that `id` is a standard basis, which means that a lot of critical pairs can be discarded.

However, the current Singular version does in fact considers a lot of unnecessary critical pairs in `std(id,P)`, as I uncovered in my cohomology computations.

Hans Schönemann found a fix that will be part of the next Singular release and also helped me to backport that fix to the Singular version that currently is in Sage. I suggest to add this to `build/pkgs/singular/patches`.


---

Comment by SimonKing created at 2018-07-20 12:04:05

With the added patch, the first step in the construction of a filter regular sequence in a certain complicated cohomology ring improved from more than two days to less than 10 seconds.
----
New commits:


---

Comment by SimonKing created at 2018-07-20 12:04:05

Changing status from new to needs_review.


---

Attachment

I have attached an example (actually from some cohomology computation, but the example is stand-alone).

Start Sage's Singular (`sage -singular`) and do

```
> execute(read("example.sing"));
```


With the patch, it finishes quite soon, and the protocol output shows that almost no work needed to be done. Without the patch, you have to be very patient.

By the way, I tested that `make test` passes with the patch.


---

Comment by tscrim created at 2018-07-22 19:38:41

You will also need to bump the patch level for singular: `4.1.0p3.p2` -> `4.1.0p3.p3` (I don't know why this has such a strange numbering system...).


---

Comment by tscrim created at 2018-07-22 19:38:41

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-07-22 21:07:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by SimonKing created at 2018-07-22 21:09:41

Changing status from needs_work to needs_review.


---

Comment by SimonKing created at 2018-07-22 21:09:41

Done.


---

Comment by tscrim created at 2018-07-22 21:33:06

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-07-22 21:33:06

LGTM. Thank you.


---

Comment by SimonKing created at 2018-07-24 11:41:20

Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Schönemann helped me to backport it.


---

Comment by slelievre created at 2018-07-24 16:00:53

Thanks for clarifying. It's still useful to have some concrete reference so we can
track when this does appear in a stable upstream release.


---

Comment by jdemeyer created at 2018-08-03 11:25:38

Replying to [comment:9 SimonKing]:
> Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Schönemann helped me to backport it.

You should really include those links in the `.patch` files. That way, it is easy for packagers to find the origin of the patches. In my opinion, we should never accept patches like on this ticket without any explanation or reference.


---

Comment by jdemeyer created at 2018-08-03 11:28:42

It seems that these patches are included in Singular-4.1.1p3 (#25993) but not in Singular-4.1.1p2 (#24735).


---

Comment by jdemeyer created at 2018-08-03 11:43:03

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2018-08-03 11:43:03

Given that this patch will conflict (in the `git merge` sense) with #24735, given that it won't be needed anymore after #25993 and given that it needs_work to add the links, I would propose to put this ticket on hold for now. If #25993 turns out to be easy, then we can close this ticket. Otherwise, we can rebase it on top of #24735. That ticket is ready, it just requires somebody to push the "positive_review" button.


---

Comment by SimonKing created at 2018-08-03 13:50:24

Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.

From my perspective, it would be perfectly alright to resolve this ticket as "wontfix", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.

Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?


---

Comment by jdemeyer created at 2018-08-03 14:02:22

Replying to [comment:14 SimonKing]:
> Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?

Yes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.


---

Comment by jdemeyer created at 2018-08-03 14:04:51

Replying to [comment:14 SimonKing]:
> Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.
> 
> From my perspective, it would be perfectly alright to resolve this ticket as "wontfix", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.

Well, I would like to keep open the possibility that #25993 gives unexpected problems.


---

Comment by SimonKing created at 2018-08-03 14:11:39

Replying to [comment:15 jdemeyer]:
> Replying to [comment:14 SimonKing]:
> > Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?
> 
> Yes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.

Right, you said that p_group_cohomology still works with #24735, and trouble only start with #25993. Anyway, I should create a package version that works with both...


---

Comment by vbraun created at 2018-08-05 08:15:53

Resolution: fixed


---

Comment by vbraun created at 2018-08-05 08:34:41

Resolution changed from fixed to 


---

Comment by vbraun created at 2018-08-05 08:34:41

Changing status from closed to new.


---

Comment by vbraun created at 2018-08-05 08:34:41

I don't understand the rationale of "lets not fix the bug because at some point in the future I'll have a branch that fixes it, too". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.


---

Comment by SimonKing created at 2018-08-05 11:09:36

Replying to [comment:19 vbraun]:
> I don't understand the rationale of "lets not fix the bug because at some point in the future I'll have a branch that fixes it, too". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.

- The bug is not a bug in the sense of giving wrong results, but a bug in the sense of "slow in some exotic situations that is relevant in some extreme examples of the pet project of one developer (me)". In fact I only know a single example (computation of a filter regular system of parameters of the modular cohomology ring of group number 299 of order 256) where not fixing the bug really hurts. So, one could argue that it isn't particularly urgent to fix.
- "Some point in the future" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.
- Did you delete the commit on purpose?


---

Comment by SimonKing created at 2018-12-27 20:30:11

To Volker,

Replying to [comment:20 SimonKing]:
> - "Some point in the future" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.

I do believe this is the case.


---

Comment by SimonKing created at 2018-12-27 20:30:11

Changing status from new to needs_review.


---

Comment by SimonKing created at 2018-12-27 20:30:31

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
