# Issue 25652: Backport a fix for std(id,P) in Singular

archive/issues_025652.json:
```json
{
    "body": "CC:  slelievre\n\nKeywords: Singular std\n\nIn Singular, if `id` is an ideal given by a standard basis and `P` is a list of polynomials, then `std(id,P)` is computing a standard basis for the ideal generated by `id` and `P`. It is supposed to take into account that `id` is a standard basis, which means that a lot of critical pairs can be discarded.\n\nHowever, the current Singular version does in fact considers a lot of unnecessary critical pairs in `std(id,P)`, as I uncovered in my cohomology computations.\n\nHans Sch\u00f6nemann found a fix that will be part of the next Singular release and also helped me to backport that fix to the Singular version that currently is in Sage. I suggest to add this to `build/pkgs/singular/patches`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25889\n\n",
    "created_at": "2018-07-20T11:57:56Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Backport a fix for std(id,P) in Singular",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25652",
    "user": "SimonKing"
}
```
CC:  slelievre

Keywords: Singular std

In Singular, if `id` is an ideal given by a standard basis and `P` is a list of polynomials, then `std(id,P)` is computing a standard basis for the ideal generated by `id` and `P`. It is supposed to take into account that `id` is a standard basis, which means that a lot of critical pairs can be discarded.

However, the current Singular version does in fact considers a lot of unnecessary critical pairs in `std(id,P)`, as I uncovered in my cohomology computations.

Hans Schönemann found a fix that will be part of the next Singular release and also helped me to backport that fix to the Singular version that currently is in Sage. I suggest to add this to `build/pkgs/singular/patches`.

Issue created by migration from https://trac.sagemath.org/ticket/25889





---

archive/issue_comments_361794.json:
```json
{
    "body": "With the added patch, the first step in the construction of a filter regular sequence in a certain complicated cohomology ring improved from more than two days to less than 10 seconds.\n----\nNew commits:",
    "created_at": "2018-07-20T12:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361794",
    "user": "SimonKing"
}
```

With the added patch, the first step in the construction of a filter regular sequence in a certain complicated cohomology ring improved from more than two days to less than 10 seconds.
----
New commits:



---

archive/issue_comments_361795.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-20T12:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361795",
    "user": "SimonKing"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_361796.json:
```json
{
    "body": "Attachment [example.sing](tarball://root/attachments/some-uuid/ticket25889/example.sing) by SimonKing created at 2018-07-20 13:25:03\n\nI have attached an example (actually from some cohomology computation, but the example is stand-alone).\n\nStart Sage's Singular (`sage -singular`) and do\n\n```\n> execute(read(\"example.sing\"));\n```\n\n\nWith the patch, it finishes quite soon, and the protocol output shows that almost no work needed to be done. Without the patch, you have to be very patient.\n\nBy the way, I tested that `make test` passes with the patch.",
    "created_at": "2018-07-20T13:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361796",
    "user": "SimonKing"
}
```

Attachment [example.sing](tarball://root/attachments/some-uuid/ticket25889/example.sing) by SimonKing created at 2018-07-20 13:25:03

I have attached an example (actually from some cohomology computation, but the example is stand-alone).

Start Sage's Singular (`sage -singular`) and do

```
> execute(read("example.sing"));
```


With the patch, it finishes quite soon, and the protocol output shows that almost no work needed to be done. Without the patch, you have to be very patient.

By the way, I tested that `make test` passes with the patch.



---

archive/issue_comments_361797.json:
```json
{
    "body": "You will also need to bump the patch level for singular: `4.1.0p3.p2` -> `4.1.0p3.p3` (I don't know why this has such a strange numbering system...).",
    "created_at": "2018-07-22T19:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361797",
    "user": "tscrim"
}
```

You will also need to bump the patch level for singular: `4.1.0p3.p2` -> `4.1.0p3.p3` (I don't know why this has such a strange numbering system...).



---

archive/issue_comments_361798.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-22T19:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361798",
    "user": "tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-22T21:07:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361799",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361800.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-22T21:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361800",
    "user": "SimonKing"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361801.json:
```json
{
    "body": "Done.",
    "created_at": "2018-07-22T21:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361801",
    "user": "SimonKing"
}
```

Done.



---

archive/issue_comments_361802.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-22T21:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361802",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361803.json:
```json
{
    "body": "LGTM. Thank you.",
    "created_at": "2018-07-22T21:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361803",
    "user": "tscrim"
}
```

LGTM. Thank you.



---

archive/issue_comments_361804.json:
```json
{
    "body": "Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Sch\u00f6nemann helped me to backport it.",
    "created_at": "2018-07-24T11:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361804",
    "user": "SimonKing"
}
```

Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Schönemann helped me to backport it.



---

archive/issue_comments_361805.json:
```json
{
    "body": "Thanks for clarifying. It's still useful to have some concrete reference so we can\ntrack when this does appear in a stable upstream release.",
    "created_at": "2018-07-24T16:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361805",
    "user": "slelievre"
}
```

Thanks for clarifying. It's still useful to have some concrete reference so we can
track when this does appear in a stable upstream release.



---

archive/issue_comments_361806.json:
```json
{
    "body": "Replying to [comment:9 SimonKing]:\n> Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Sch\u00f6nemann helped me to backport it.\n\nYou should really include those links in the `.patch` files. That way, it is easy for packagers to find the origin of the patches. In my opinion, we should never accept patches like on this ticket without any explanation or reference.",
    "created_at": "2018-08-03T11:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361806",
    "user": "jdemeyer"
}
```

Replying to [comment:9 SimonKing]:
> Hi Samuel, the links you gave are correct. Note, however, that they are not identical with the patch provided here, as the upstream changeset is applied to a different version than the one provided by Sage. Hans Schönemann helped me to backport it.

You should really include those links in the `.patch` files. That way, it is easy for packagers to find the origin of the patches. In my opinion, we should never accept patches like on this ticket without any explanation or reference.



---

archive/issue_comments_361807.json:
```json
{
    "body": "It seems that these patches are included in Singular-4.1.1p3 (#25993) but not in Singular-4.1.1p2 (#24735).",
    "created_at": "2018-08-03T11:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361807",
    "user": "jdemeyer"
}
```

It seems that these patches are included in Singular-4.1.1p3 (#25993) but not in Singular-4.1.1p2 (#24735).



---

archive/issue_comments_361808.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-08-03T11:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361808",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_361809.json:
```json
{
    "body": "Given that this patch will conflict (in the `git merge` sense) with #24735, given that it won't be needed anymore after #25993 and given that it needs_work to add the links, I would propose to put this ticket on hold for now. If #25993 turns out to be easy, then we can close this ticket. Otherwise, we can rebase it on top of #24735. That ticket is ready, it just requires somebody to push the \"positive_review\" button.",
    "created_at": "2018-08-03T11:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361809",
    "user": "jdemeyer"
}
```

Given that this patch will conflict (in the `git merge` sense) with #24735, given that it won't be needed anymore after #25993 and given that it needs_work to add the links, I would propose to put this ticket on hold for now. If #25993 turns out to be easy, then we can close this ticket. Otherwise, we can rebase it on top of #24735. That ticket is ready, it just requires somebody to push the "positive_review" button.



---

archive/issue_comments_361810.json:
```json
{
    "body": "Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.\n\nFrom my perspective, it would be perfectly alright to resolve this ticket as \"wontfix\", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.\n\nJeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?",
    "created_at": "2018-08-03T13:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361810",
    "user": "SimonKing"
}
```

Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.

From my perspective, it would be perfectly alright to resolve this ticket as "wontfix", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.

Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?



---

archive/issue_comments_361811.json:
```json
{
    "body": "Replying to [comment:14 SimonKing]:\n> Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?\n\nYes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.",
    "created_at": "2018-08-03T14:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361811",
    "user": "jdemeyer"
}
```

Replying to [comment:14 SimonKing]:
> Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?

Yes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.



---

archive/issue_comments_361812.json:
```json
{
    "body": "Replying to [comment:14 SimonKing]:\n> Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.\n> \n> From my perspective, it would be perfectly alright to resolve this ticket as \"wontfix\", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.\n\nWell, I would like to keep open the possibility that #25993 gives unexpected problems.",
    "created_at": "2018-08-03T14:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361812",
    "user": "jdemeyer"
}
```

Replying to [comment:14 SimonKing]:
> Well, the bug fixed by this patch is not yielding wrong results but yielding very slow computations in a situation that I care about.
> 
> From my perspective, it would be perfectly alright to resolve this ticket as "wontfix", given that there is a realistic perspective that soonish (namely with #25993) the issue will be fixed without a backported patch.

Well, I would like to keep open the possibility that #25993 gives unexpected problems.



---

archive/issue_comments_361813.json:
```json
{
    "body": "Replying to [comment:15 jdemeyer]:\n> Replying to [comment:14 SimonKing]:\n> > Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?\n> \n> Yes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.\n\nRight, you said that p_group_cohomology still works with #24735, and trouble only start with #25993. Anyway, I should create a package version that works with both...",
    "created_at": "2018-08-03T14:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361813",
    "user": "SimonKing"
}
```

Replying to [comment:15 jdemeyer]:
> Replying to [comment:14 SimonKing]:
> > Jeroen, do I understand correctly: Based on #24735, I should create a new ticket for group cohomology, implementing things so that it works both with Singular-4.1.1.p2 and ...p3, and this new ticket would be a dependency for #25933?
> 
> Yes, except that it doesn't have to be on top of #24735. I don't know whether there are any changes between Singular-4.1.0p3 (currently in Sage) and 4.1.1p2 (in #24735) that are relevant to p_group_cohomology.

Right, you said that p_group_cohomology still works with #24735, and trouble only start with #25993. Anyway, I should create a package version that works with both...



---

archive/issue_comments_361814.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361814",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_361815.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2018-08-05T08:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361815",
    "user": "vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_361816.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2018-08-05T08:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361816",
    "user": "vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_361817.json:
```json
{
    "body": "I don't understand the rationale of \"lets not fix the bug because at some point in the future I'll have a branch that fixes it, too\". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.",
    "created_at": "2018-08-05T08:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361817",
    "user": "vbraun"
}
```

I don't understand the rationale of "lets not fix the bug because at some point in the future I'll have a branch that fixes it, too". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.



---

archive/issue_comments_361818.json:
```json
{
    "body": "Replying to [comment:19 vbraun]:\n> I don't understand the rationale of \"lets not fix the bug because at some point in the future I'll have a branch that fixes it, too\". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.\n\n- The bug is not a bug in the sense of giving wrong results, but a bug in the sense of \"slow in some exotic situations that is relevant in some extreme examples of the pet project of one developer (me)\". In fact I only know a single example (computation of a filter regular system of parameters of the modular cohomology ring of group number 299 of order 256) where not fixing the bug really hurts. So, one could argue that it isn't particularly urgent to fix.\n- \"Some point in the future\" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.\n- Did you delete the commit on purpose?",
    "created_at": "2018-08-05T11:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361818",
    "user": "SimonKing"
}
```

Replying to [comment:19 vbraun]:
> I don't understand the rationale of "lets not fix the bug because at some point in the future I'll have a branch that fixes it, too". Just deal with git conflicts by merging already positively reviewed tickets into your branch as necessary. In any case, I'll leave this ticket for you to figure out.

- The bug is not a bug in the sense of giving wrong results, but a bug in the sense of "slow in some exotic situations that is relevant in some extreme examples of the pet project of one developer (me)". In fact I only know a single example (computation of a filter regular system of parameters of the modular cohomology ring of group number 299 of order 256) where not fixing the bug really hurts. So, one could argue that it isn't particularly urgent to fix.
- "Some point in the future" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.
- Did you delete the commit on purpose?



---

archive/issue_comments_361819.json:
```json
{
    "body": "To Volker,\n\nReplying to [comment:20 SimonKing]:\n> - \"Some point in the future\" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.\n\nI do believe this is the case.",
    "created_at": "2018-12-27T20:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361819",
    "user": "SimonKing"
}
```

To Volker,

Replying to [comment:20 SimonKing]:
> - "Some point in the future" is #25993, so, the future is there. One could argue that #25933 supersedes this ticket, making this ticket a duplicate.

I do believe this is the case.



---

archive/issue_comments_361820.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-27T20:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361820",
    "user": "SimonKing"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_361821.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-27T20:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361821",
    "user": "SimonKing"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361822.json:
```json
{
    "body": "Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361822",
    "user": "embray"
}
```

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_361823.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25652#issuecomment-361823",
    "user": "embray"
}
```

Resolution: invalid
