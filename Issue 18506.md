# Issue 18506: Display does not support the 'ascii_art' option of _repr_option

Issue created by migration from https://trac.sagemath.org/ticket/18743

Original creator: tscrim

Original creation time: 2015-06-19 22:57:01

Assignee: tscrim

CC:  vbraun jdemeyer elixyre jpflori simonking kdilks

Keywords: fancy repr

The following does not behave as it should:

```
sage: class Foo(object):
....:     def __repr__(self):
....:         return '''BBB    AA   RRR
....: B  B  A  A  R  R
....: BBB   AAAA  RRR
....: B  B  A  A  R  R
....: BBB   A  A  R   R'''
....:     def _repr_option(self, key):
....:         return key == 'ascii_art'
sage: F = Foo()
sage: [F, F]
```




---

Comment by tscrim created at 2015-06-19 22:58:08

New commits:


---

Comment by tscrim created at 2015-06-19 22:58:08

Changing status from new to needs_review.


---

Comment by git created at 2015-06-19 22:58:50

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2015-06-25 17:37:20

I am completely dumbfounded as to why this addition causes the failing doctests in `interfaces/psage.py`. It fails in the _original_ code

```
ascii_art_repr = ascii_art_repr or o.parent()._repr_option('element_ascii_art')
```

but only when I've added the line before it! I know I could simply add `NonImplementedError` or a general `Exception` as the `except` types, but this makes me feel like I'm covering up errors that should be allowed to propagate.

Jean-Pierre and Simon, I've cc-ed you incase you had any insight as you were the most recent listed authors to `interfaces/expect.py` (and have made significant changes and are not currently cc-ed).


---

Comment by tscrim created at 2015-06-25 17:37:20

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2015-06-25 19:46:18

Is there a `__getattr__` hack somewhere in the interface?


---

Comment by tscrim created at 2015-06-25 21:37:30

Would this count: in `interfaces.sage0.SageElement`

```
    def __getattr__(self, attrname):
        """
        EXAMPLES::

            sage: m = sage0(4)
            sage: four_gcd = m.gcd
            sage: type(four_gcd)
            <class 'sage.interfaces.sage0.SageFunction'>
        """
        self._check_valid()
        return SageFunction(self, attrname)
```



---

Comment by git created at 2015-06-27 15:07:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-06-27 15:08:46

Yes, that was the issue. I've just returned `False` anytime `_repr_option` is called to avoid calling the `__getattr__`. Thanks.

Needs review. Should be easy enough at this point.


---

Comment by tscrim created at 2015-06-27 15:08:46

Changing status from needs_work to needs_review.


---

Comment by kdilks created at 2015-10-10 20:14:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-10-12 07:16:17

Resolution: fixed
