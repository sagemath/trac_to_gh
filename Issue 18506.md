# Issue 18506: Display does not support the 'ascii_art' option of _repr_option

archive/issues_018506.json:
```json
{
    "body": "Assignee: @tscrim\n\nCC:  @vbraun @jdemeyer elixyre jpflori simonking @kevindilks\n\nKeywords: fancy repr\n\nThe following does not behave as it should:\n\n```\nsage: class Foo(object):\n....:     def __repr__(self):\n....:         return '''BBB    AA   RRR\n....: B  B  A  A  R  R\n....: BBB   AAAA  RRR\n....: B  B  A  A  R  R\n....: BBB   A  A  R   R'''\n....:     def _repr_option(self, key):\n....:         return key == 'ascii_art'\nsage: F = Foo()\nsage: [F, F]\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18743\n\n",
    "created_at": "2015-06-19T22:57:01Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Display does not support the 'ascii_art' option of _repr_option",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18506",
    "user": "https://github.com/tscrim"
}
```
Assignee: @tscrim

CC:  @vbraun @jdemeyer elixyre jpflori simonking @kevindilks

Keywords: fancy repr

The following does not behave as it should:

```
sage: class Foo(object):
....:     def __repr__(self):
....:         return '''BBB    AA   RRR
....: B  B  A  A  R  R
....: BBB   AAAA  RRR
....: B  B  A  A  R  R
....: BBB   A  A  R   R'''
....:     def _repr_option(self, key):
....:         return key == 'ascii_art'
sage: F = Foo()
sage: [F, F]
```



Issue created by migration from https://trac.sagemath.org/ticket/18743





---

archive/issue_comments_251278.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251278",
    "user": "https://github.com/tscrim"
}
```

New commits:



---

archive/issue_comments_251279.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251279",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_251280.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-19T22:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_251281.json:
```json
{
    "body": "I am completely dumbfounded as to why this addition causes the failing doctests in `interfaces/psage.py`. It fails in the *original* code\n\n```\nascii_art_repr = ascii_art_repr or o.parent()._repr_option('element_ascii_art')\n```\n\nbut only when I've added the line before it! I know I could simply add `NonImplementedError` or a general `Exception` as the `except` types, but this makes me feel like I'm covering up errors that should be allowed to propagate.\n\nJean-Pierre and Simon, I've cc-ed you incase you had any insight as you were the most recent listed authors to `interfaces/expect.py` (and have made significant changes and are not currently cc-ed).",
    "created_at": "2015-06-25T17:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251281",
    "user": "https://github.com/tscrim"
}
```

I am completely dumbfounded as to why this addition causes the failing doctests in `interfaces/psage.py`. It fails in the *original* code

```
ascii_art_repr = ascii_art_repr or o.parent()._repr_option('element_ascii_art')
```

but only when I've added the line before it! I know I could simply add `NonImplementedError` or a general `Exception` as the `except` types, but this makes me feel like I'm covering up errors that should be allowed to propagate.

Jean-Pierre and Simon, I've cc-ed you incase you had any insight as you were the most recent listed authors to `interfaces/expect.py` (and have made significant changes and are not currently cc-ed).



---

archive/issue_comments_251282.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-25T17:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251282",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_251283.json:
```json
{
    "body": "Is there a `__getattr__` hack somewhere in the interface?",
    "created_at": "2015-06-25T19:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251283",
    "user": "https://github.com/vbraun"
}
```

Is there a `__getattr__` hack somewhere in the interface?



---

archive/issue_comments_251284.json:
```json
{
    "body": "Would this count: in `interfaces.sage0.SageElement`\n\n```\n    def __getattr__(self, attrname):\n        \"\"\"\n        EXAMPLES::\n\n            sage: m = sage0(4)\n            sage: four_gcd = m.gcd\n            sage: type(four_gcd)\n            <class 'sage.interfaces.sage0.SageFunction'>\n        \"\"\"\n        self._check_valid()\n        return SageFunction(self, attrname)\n```\n",
    "created_at": "2015-06-25T21:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251284",
    "user": "https://github.com/tscrim"
}
```

Would this count: in `interfaces.sage0.SageElement`

```
    def __getattr__(self, attrname):
        """
        EXAMPLES::

            sage: m = sage0(4)
            sage: four_gcd = m.gcd
            sage: type(four_gcd)
            <class 'sage.interfaces.sage0.SageFunction'>
        """
        self._check_valid()
        return SageFunction(self, attrname)
```




---

archive/issue_comments_251285.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-27T15:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251285",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_251286.json:
```json
{
    "body": "Yes, that was the issue. I've just returned `False` anytime `_repr_option` is called to avoid calling the `__getattr__`. Thanks.\n\nNeeds review. Should be easy enough at this point.",
    "created_at": "2015-06-27T15:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251286",
    "user": "https://github.com/tscrim"
}
```

Yes, that was the issue. I've just returned `False` anytime `_repr_option` is called to avoid calling the `__getattr__`. Thanks.

Needs review. Should be easy enough at this point.



---

archive/issue_comments_251287.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-27T15:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251287",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_251288.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-10T20:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251288",
    "user": "https://github.com/kevindilks"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_251289.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-12T07:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18506",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18506#issuecomment-251289",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
