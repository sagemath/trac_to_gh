# Issue 15549: Streamline construction of PARI objects

archive/issues_015312.json:
```json
{
    "body": "Clean up the construction of PARI objects by inlining some functions and initialising the `_refers_to` dictionary only when necessary.\n\nBefore:\n\n```\nsage: %timeit -r 1 pari(0)\n1000000 loops, best of 1: 1.02 us per loop\n```\nAfter:\n\n```\nsage: %timeit -r 1 pari(0)\n1000000 loops, best of 1: 875 ns per loop\n```\n\nAlso modify gen.__init__() to raise an error instead of creating a gen object wrapping NULL.\n\nCC:  @jdemeyer\n\nKeywords: pari performance\n\nReviewer: Jeroen Demeyer\n\nAuthor: Peter Bruin\n\nBranch: u/jdemeyer/ticket/15549\n\nDependencies: #15461\n\nCommit: 5713c53af6e5caa3c993daf2ba41ba88b473ff33\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15549\n\n",
    "closed_at": "2014-01-05T00:32:07Z",
    "created_at": "2013-12-19T13:37:14Z",
    "labels": [
        "component: interfaces",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "Streamline construction of PARI objects",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15549",
    "user": "https://github.com/pjbruin"
}
```
Clean up the construction of PARI objects by inlining some functions and initialising the `_refers_to` dictionary only when necessary.

Before:

```
sage: %timeit -r 1 pari(0)
1000000 loops, best of 1: 1.02 us per loop
```
After:

```
sage: %timeit -r 1 pari(0)
1000000 loops, best of 1: 875 ns per loop
```

Also modify gen.__init__() to raise an error instead of creating a gen object wrapping NULL.

CC:  @jdemeyer

Keywords: pari performance

Reviewer: Jeroen Demeyer

Author: Peter Bruin

Branch: u/jdemeyer/ticket/15549

Dependencies: #15461

Commit: 5713c53af6e5caa3c993daf2ba41ba88b473ff33

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15549





---

archive/issue_comments_210045.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n-Clean up the construction of PARI objects by inlining some functions.\n+Clean up the construction of PARI objects by inlining some functions and initialising the \\`_refers_to\\` dictionary only when necessary.\n+\n+Before:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 1.02 us per loop\n+\\`\\`\\`\n+After:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 875 us per loop\n+\\`\\`\\`\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2013-12-19T14:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210045",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,18 @@
-Clean up the construction of PARI objects by inlining some functions.
+Clean up the construction of PARI objects by inlining some functions and initialising the \`_refers_to\` dictionary only when necessary.
+
+Before:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 1.02 us per loop
+\`\`\`
+After:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 875 us per loop
+\`\`\`
+
 
 Comment: 1
 
```




---

archive/issue_comments_210046.json:
```json
{
    "body": "Changing keywords from \"\" to \"pari performance\".",
    "created_at": "2013-12-19T14:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210046",
    "user": "https://github.com/pjbruin"
}
```

Changing keywords from "" to "pari performance".



---

archive/issue_comments_210047.json:
```json
{
    "body": "<a id='comment:2'></a>Are you sure the ticket description is right? If so, you **slowed this down** by a factor of 858.",
    "created_at": "2013-12-19T14:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210047",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Are you sure the ticket description is right? If so, you **slowed this down** by a factor of 858.



---

archive/issue_comments_210048.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 jdemeyer]:\n> Are you sure the ticket description is right? If so, you **slowed this down** by a factor of 858.\n\nThat was a typo; I don't know why I didn't simply copy-paste this...\n\n---\nLast 10 new commits:",
    "created_at": "2013-12-19T15:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210048",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:4'></a>Replying to [comment:2 jdemeyer]:
> Are you sure the ticket description is right? If so, you **slowed this down** by a factor of 858.

That was a typo; I don't know why I didn't simply copy-paste this...

---
Last 10 new commits:



---

archive/issue_comments_210049.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-12-19T15:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210049",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_210050.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,17 @@\n+Clean up the construction of PARI objects by inlining some functions and initialising the \\`_refers_to\\` dictionary only when necessary.\n+\n+Before:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 1.02 us per loop\n+\\`\\`\\`\n+After:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 875 ns per loop\n+\\`\\`\\`\n \n \n Comment: 1\n```\n",
    "created_at": "2013-12-19T15:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210050",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,17 @@
+Clean up the construction of PARI objects by inlining some functions and initialising the \`_refers_to\` dictionary only when necessary.
+
+Before:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 1.02 us per loop
+\`\`\`
+After:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 875 ns per loop
+\`\`\`
 
 
 Comment: 1
```




---

archive/issue_comments_210051.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-12-19T17:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210051",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210052.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,19 @@\n+Clean up the construction of PARI objects by inlining some functions and initialising the \\`_refers_to\\` dictionary only when necessary.\n \n+Before:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 1.02 us per loop\n+\\`\\`\\`\n+After:\n+\n+\\`\\`\\`\n+sage: %timeit -r 1 pari(0)\n+1000000 loops, best of 1: 875 ns per loop\n+\\`\\`\\`\n+\n+Also modify gen.__init__() to raise an error instead of creating a gen object wrapping NULL.\n \n Comment: 1\n \n```\n",
    "created_at": "2013-12-19T17:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210052",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,19 @@
+Clean up the construction of PARI objects by inlining some functions and initialising the \`_refers_to\` dictionary only when necessary.
 
+Before:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 1.02 us per loop
+\`\`\`
+After:
+
+\`\`\`
+sage: %timeit -r 1 pari(0)
+1000000 loops, best of 1: 875 ns per loop
+\`\`\`
+
+Also modify gen.__init__() to raise an error instead of creating a gen object wrapping NULL.
 
 Comment: 1
 
```




---

archive/issue_comments_210053.json:
```json
{
    "body": "<a id='comment:8'></a>Small reviewer patch needs review.\n\n---\nNew commits:",
    "created_at": "2014-01-02T11:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210053",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Small reviewer patch needs review.

---
New commits:



---

archive/issue_comments_210054.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 jdemeyer]:\n> Small reviewer patch needs review.\n\nI agree with these changes.",
    "created_at": "2014-01-03T13:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210054",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:9'></a>Replying to [comment:8 jdemeyer]:
> Small reviewer patch needs review.

I agree with these changes.



---

archive/issue_comments_210055.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-01-03T14:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210055",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_045443.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-05T00:32:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15549#event-45443"
}
```



---

archive/issue_comments_210056.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-01-05T00:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15549#issuecomment-210056",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
