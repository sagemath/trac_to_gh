# Issue 15447: implement evaluation of PARI closures

archive/issues_015210.json:
```json
{
    "body": "It would be nice to be able to call PARI closures from Sage.  Currently, calling a PARI object assumes that it is a polynomial:\n\n```\nsage: T = pari('n->n+1')\nsage: T.type()\n't_CLOSURE'\nsage: T(3)\nTraceback (most recent call last):\n...\nPariError: incorrect type in poleval\n```\nWith the patch, one gets the expected answer:\n\n```\nT(3)\n4\n```\n\n**Keywords:** pari closure\n\n**Branch:** [u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)\n\n**Commit:** [679310bd938fd20812c638c0e73e1c7ce3e60eef](https://github.com/sagemath/sagetrac-mirror/commit/679310bd938fd20812c638c0e73e1c7ce3e60eef)\n\n**Reviewer:** Jeroen Demeyer, Peter Bruin\n\n**Author:** Peter Bruin, Jeroen Demeyer\n\n**Dependencies:** #15461\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15447\n\n",
    "closed_at": "2013-12-21T12:16:01Z",
    "created_at": "2013-11-22T19:06:56Z",
    "labels": [
        "component: interfaces",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "implement evaluation of PARI closures",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15447",
    "user": "https://github.com/pjbruin"
}
```
It would be nice to be able to call PARI closures from Sage.  Currently, calling a PARI object assumes that it is a polynomial:

```
sage: T = pari('n->n+1')
sage: T.type()
't_CLOSURE'
sage: T(3)
Traceback (most recent call last):
...
PariError: incorrect type in poleval
```
With the patch, one gets the expected answer:

```
T(3)
4
```

**Keywords:** pari closure

**Branch:** [u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)

**Commit:** [679310bd938fd20812c638c0e73e1c7ce3e60eef](https://github.com/sagemath/sagetrac-mirror/commit/679310bd938fd20812c638c0e73e1c7ce3e60eef)

**Reviewer:** Jeroen Demeyer, Peter Bruin

**Author:** Peter Bruin, Jeroen Demeyer

**Dependencies:** #15461

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/15447





---

archive/issue_comments_251011.json:
```json
{
    "body": "**Dependencies:** #15185",
    "created_at": "2013-11-22T19:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251011",
    "user": "https://github.com/pjbruin"
}
```

**Dependencies:** #15185



---

archive/issue_comments_251012.json:
```json
{
    "body": "**Branch:** [u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)",
    "created_at": "2013-11-22T22:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251012",
    "user": "https://github.com/pjbruin"
}
```

**Branch:** [u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)



---

archive/issue_comments_251013.json:
```json
{
    "body": "<a id='comment:3'></a>\nLast 10 new commits:\n|                                                                                                         |                                        |\n|---------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[55b5cb2](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2)|allow evaluation of PARI closure objects|\n|[129a939](https://github.com/sagemath/sagetrac-mirror/commit/129a939)|declare closure_callgenvec in sage/libs/pari/decl.pxi|\n|[2344f0b](https://github.com/sagemath/sagetrac-mirror/commit/2344f0b)|more fixes related to relocation of PariInstance|\n|[9dae3c3](https://github.com/sagemath/sagetrac-mirror/commit/9dae3c3)|minor fixes; update copyright notice|\n|[de61800](https://github.com/sagemath/sagetrac-mirror/commit/de61800)|fix doctest failures in sage/libs/pari|\n|[3b27308](https://github.com/sagemath/sagetrac-mirror/commit/3b27308)|adapt miscellaneous files to the relocation of some things to pari_instance.pyx|\n|[0c55f55](https://github.com/sagemath/sagetrac-mirror/commit/0c55f55)|fixes to gen.pyx, handle_error.pyx, pari_instance.pyx|\n|[27877bc](https://github.com/sagemath/sagetrac-mirror/commit/27877bc)|patch pari_instance.pxd and pari_instance.pyx|\n|[536094e](https://github.com/sagemath/sagetrac-mirror/commit/536094e)|patch gen_py.py|\n|[a75b15a](https://github.com/sagemath/sagetrac-mirror/commit/a75b15a)|patch gen.pxd and gen.pyx|",
    "created_at": "2013-11-22T22:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251013",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Last 10 new commits:
|                                                                                                         |                                        |
|---------------------------------------------------------------------------------------------------------|----------------------------------------|
|[55b5cb2](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2)|allow evaluation of PARI closure objects|
|[129a939](https://github.com/sagemath/sagetrac-mirror/commit/129a939)|declare closure_callgenvec in sage/libs/pari/decl.pxi|
|[2344f0b](https://github.com/sagemath/sagetrac-mirror/commit/2344f0b)|more fixes related to relocation of PariInstance|
|[9dae3c3](https://github.com/sagemath/sagetrac-mirror/commit/9dae3c3)|minor fixes; update copyright notice|
|[de61800](https://github.com/sagemath/sagetrac-mirror/commit/de61800)|fix doctest failures in sage/libs/pari|
|[3b27308](https://github.com/sagemath/sagetrac-mirror/commit/3b27308)|adapt miscellaneous files to the relocation of some things to pari_instance.pyx|
|[0c55f55](https://github.com/sagemath/sagetrac-mirror/commit/0c55f55)|fixes to gen.pyx, handle_error.pyx, pari_instance.pyx|
|[27877bc](https://github.com/sagemath/sagetrac-mirror/commit/27877bc)|patch pari_instance.pxd and pari_instance.pyx|
|[536094e](https://github.com/sagemath/sagetrac-mirror/commit/536094e)|patch gen_py.py|
|[a75b15a](https://github.com/sagemath/sagetrac-mirror/commit/a75b15a)|patch gen.pxd and gen.pyx|



---

archive/issue_comments_251014.json:
```json
{
    "body": "**Author:** Peter Bruin",
    "created_at": "2013-11-22T22:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251014",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Peter Bruin



---

archive/issue_events_051463.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-22T22:15:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15447#event-51463"
}
```



---

archive/issue_comments_251015.json:
```json
{
    "body": "**Commit:** [55b5cb2b38a7e95a413267e1a9992ca49a958935](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2b38a7e95a413267e1a9992ca49a958935)",
    "created_at": "2013-11-22T22:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251015",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [55b5cb2b38a7e95a413267e1a9992ca49a958935](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2b38a7e95a413267e1a9992ca49a958935)



---

archive/issue_comments_251016.json:
```json
{
    "body": "**Changing commit** from \"[55b5cb2b38a7e95a413267e1a9992ca49a958935](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2b38a7e95a413267e1a9992ca49a958935)\" to \"[b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a)\".",
    "created_at": "2013-11-22T22:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[55b5cb2b38a7e95a413267e1a9992ca49a958935](https://github.com/sagemath/sagetrac-mirror/commit/55b5cb2b38a7e95a413267e1a9992ca49a958935)" to "[b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a)".



---

archive/issue_comments_251017.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** New commits:\n|                                                                                                         |                                            |\n|---------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[b8f8ae8](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8)|slightly improve documentation of gen.eval()|",
    "created_at": "2013-11-22T22:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** New commits:
|                                                                                                         |                                            |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[b8f8ae8](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8)|slightly improve documentation of gen.eval()|



---

archive/issue_comments_251018.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,4 +9,10 @@\n ...\n PariError: incorrect type in poleval\n ```\n+With the patch, one gets the expected answer:\n \n+```\n+T(3)\n+4\n+```\n+\n``````\n",
    "created_at": "2013-11-22T22:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251018",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,4 +9,10 @@
 ...
 PariError: incorrect type in poleval
 ```
+With the patch, one gets the expected answer:
 
+```
+T(3)
+4
+```
+
``````




---

archive/issue_comments_251019.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-11-22T22:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251019",
    "user": "https://github.com/pjbruin"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_251020.json:
```json
{
    "body": "<a id='comment:6'></a>\nI think you should also implement `getattr()` using closures, see [http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html](http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html)`",
    "created_at": "2013-11-27T07:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251020",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
I think you should also implement `getattr()` using closures, see [http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html](http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html)`



---

archive/issue_comments_251021.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** Recent commits:\n|                                                                                                         |                                        |\n|---------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[8ce4d47](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d47)|allow evaluation of PARI closure objects|\n|[4718331](https://github.com/sagemath/sagetrac-mirror/commit/4718331)|declare closure_callgenvec in sage/libs/pari/decl.pxi|",
    "created_at": "2013-12-13T22:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** Recent commits:
|                                                                                                         |                                        |
|---------------------------------------------------------------------------------------------------------|----------------------------------------|
|[8ce4d47](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d47)|allow evaluation of PARI closure objects|
|[4718331](https://github.com/sagemath/sagetrac-mirror/commit/4718331)|declare closure_callgenvec in sage/libs/pari/decl.pxi|



---

archive/issue_comments_251022.json:
```json
{
    "body": "**Changing commit** from \"[b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a)\" to \"[8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d)\".",
    "created_at": "2013-12-13T22:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a](https://github.com/sagemath/sagetrac-mirror/commit/b8f8ae8dd4e65834c5cb60b46fc88f434ca72b2a)" to "[8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d)".



---

archive/issue_comments_251023.json:
```json
{
    "body": "**Changing dependencies** from \"#15185\" to \"\".",
    "created_at": "2013-12-13T22:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251023",
    "user": "https://github.com/pjbruin"
}
```

**Changing dependencies** from "#15185" to "".



---

archive/issue_comments_251024.json:
```json
{
    "body": "<a id='comment:8'></a>\nNow that the `t0GEN` stuff is done, this does not depend on #15185 anymore.",
    "created_at": "2013-12-13T22:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251024",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:8'></a>
Now that the `t0GEN` stuff is done, this does not depend on #15185 anymore.



---

archive/issue_comments_251025.json:
```json
{
    "body": "**Changing branch** from \"[u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)\" to \"[u/jdemeyer/ticket/15447](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15447)\".",
    "created_at": "2013-12-17T13:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251025",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)" to "[u/jdemeyer/ticket/15447](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15447)".



---

archive/issue_comments_251026.json:
```json
{
    "body": "**Dependencies:** #15461",
    "created_at": "2013-12-17T13:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251026",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #15461



---

archive/issue_comments_251027.json:
```json
{
    "body": "**Changing commit** from \"[8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d)\" to \"[033f60bc83fce2a7a803999e2ab2e6aa04a43a0a](https://github.com/sagemath/sagetrac-mirror/commit/033f60bc83fce2a7a803999e2ab2e6aa04a43a0a)\".",
    "created_at": "2013-12-17T13:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251027",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d](https://github.com/sagemath/sagetrac-mirror/commit/8ce4d4764b9ec325ca0d6051cfac1e60bb2d116d)" to "[033f60bc83fce2a7a803999e2ab2e6aa04a43a0a](https://github.com/sagemath/sagetrac-mirror/commit/033f60bc83fce2a7a803999e2ab2e6aa04a43a0a)".



---

archive/issue_comments_251028.json:
```json
{
    "body": "<a id='comment:11'></a>\nNew commit needs review. I merged in #15461 since that has positive_review anyway and I didn't want to risk merge conflicts.\n\n---\nLast 10 new commits:\n|                                                                                                         |                                          |\n|---------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[033f60b](https://github.com/sagemath/sagetrac-mirror/commit/033f60b)|Support __call__(**kwds) using gsubstvec()|\n|[1290955](https://github.com/sagemath/sagetrac-mirror/commit/1290955)|Merge branch 'u/pbruin/15461_clean_up_pari_interface' of git://trac.sagemath.org/sage into ticket/15447|\n|[5bb8f8d](https://github.com/sagemath/sagetrac-mirror/commit/5bb8f8d)|remove commented-out method gen.python()|\n|[3fa4f1d](https://github.com/sagemath/sagetrac-mirror/commit/3fa4f1d)|remove redundant methods from sage.libs.pari.gen|\n|[511f05b](https://github.com/sagemath/sagetrac-mirror/commit/511f05b)|remove global variable mytop|\n|[866f7fd](https://github.com/sagemath/sagetrac-mirror/commit/866f7fd)|remove methods sage.libs.pari.gen.*_unsafe|\n|[05b93b7](https://github.com/sagemath/sagetrac-mirror/commit/05b93b7)|remove \"pbw\" as an abbreviation for \"prec_bits_to_words\"|\n|[95a622a](https://github.com/sagemath/sagetrac-mirror/commit/95a622a)|better fix for real_double.pyx|\n|[11a3bfb](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfb)|more fixes related to relocation of PariInstance|\n|[34013cc](https://github.com/sagemath/sagetrac-mirror/commit/34013cc)|fixes in sage.libs.pari|",
    "created_at": "2013-12-17T13:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251028",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
New commit needs review. I merged in #15461 since that has positive_review anyway and I didn't want to risk merge conflicts.

---
Last 10 new commits:
|                                                                                                         |                                          |
|---------------------------------------------------------------------------------------------------------|------------------------------------------|
|[033f60b](https://github.com/sagemath/sagetrac-mirror/commit/033f60b)|Support __call__(**kwds) using gsubstvec()|
|[1290955](https://github.com/sagemath/sagetrac-mirror/commit/1290955)|Merge branch 'u/pbruin/15461_clean_up_pari_interface' of git://trac.sagemath.org/sage into ticket/15447|
|[5bb8f8d](https://github.com/sagemath/sagetrac-mirror/commit/5bb8f8d)|remove commented-out method gen.python()|
|[3fa4f1d](https://github.com/sagemath/sagetrac-mirror/commit/3fa4f1d)|remove redundant methods from sage.libs.pari.gen|
|[511f05b](https://github.com/sagemath/sagetrac-mirror/commit/511f05b)|remove global variable mytop|
|[866f7fd](https://github.com/sagemath/sagetrac-mirror/commit/866f7fd)|remove methods sage.libs.pari.gen.*_unsafe|
|[05b93b7](https://github.com/sagemath/sagetrac-mirror/commit/05b93b7)|remove "pbw" as an abbreviation for "prec_bits_to_words"|
|[95a622a](https://github.com/sagemath/sagetrac-mirror/commit/95a622a)|better fix for real_double.pyx|
|[11a3bfb](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfb)|more fixes related to relocation of PariInstance|
|[34013cc](https://github.com/sagemath/sagetrac-mirror/commit/34013cc)|fixes in sage.libs.pari|



---

archive/issue_events_051464.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:42:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15447#event-51464"
}
```



---

archive/issue_events_051465.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:42:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15447#event-51465"
}
```



---

archive/issue_comments_251029.json:
```json
{
    "body": "<a id='comment:13'></a>\nPARI allows default values for arguments; without the arity check one can do\n\n```\nsage: f = pari('(x, y=3) -> x/y')\nsage: f(2)\n2/3\n```\nOn the other hand, omitting the arity check altogether is not an option since passing too many arguments gives unexpected results (and moreover a look at the source code of `closure_callgenvec` suggests that this could lead to memory corruption):\n\n```\nsage: f(1,2,3,4,5)\n4/5\n```\nFiguring out the default values from the `t_CLOSURE` doesn't seem worth the trouble, leaving two reasonable options:\n- either don't bother supporting PARI default values\n- or check for `nargs <= arity` and allow PARI to substitute default values, including its convention to set any unspecified arguments to 0\nI don't have a strong preference.",
    "created_at": "2013-12-18T16:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251029",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:13'></a>
PARI allows default values for arguments; without the arity check one can do

```
sage: f = pari('(x, y=3) -> x/y')
sage: f(2)
2/3
```
On the other hand, omitting the arity check altogether is not an option since passing too many arguments gives unexpected results (and moreover a look at the source code of `closure_callgenvec` suggests that this could lead to memory corruption):

```
sage: f(1,2,3,4,5)
4/5
```
Figuring out the default values from the `t_CLOSURE` doesn't seem worth the trouble, leaving two reasonable options:
- either don't bother supporting PARI default values
- or check for `nargs <= arity` and allow PARI to substitute default values, including its convention to set any unspecified arguments to 0
I don't have a strong preference.



---

archive/issue_comments_251030.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [pbruin](#comment%3A13):\n> check for `nargs <= arity` and allow PARI to substitute default values, including its convention to set any unspecified arguments to 0\n\n\nThis is actually what GP does, so I'll go with that.",
    "created_at": "2013-12-18T16:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251030",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [pbruin](#comment%3A13):
> check for `nargs <= arity` and allow PARI to substitute default values, including its convention to set any unspecified arguments to 0


This is actually what GP does, so I'll go with that.



---

archive/issue_comments_251031.json:
```json
{
    "body": "**Changing commit** from \"[033f60bc83fce2a7a803999e2ab2e6aa04a43a0a](https://github.com/sagemath/sagetrac-mirror/commit/033f60bc83fce2a7a803999e2ab2e6aa04a43a0a)\" to \"[ee5e39e59a08b3d96471fc368819784baf020eb8](https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e59a08b3d96471fc368819784baf020eb8)\".",
    "created_at": "2013-12-18T17:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[033f60bc83fce2a7a803999e2ab2e6aa04a43a0a](https://github.com/sagemath/sagetrac-mirror/commit/033f60bc83fce2a7a803999e2ab2e6aa04a43a0a)" to "[ee5e39e59a08b3d96471fc368819784baf020eb8](https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e59a08b3d96471fc368819784baf020eb8)".



---

archive/issue_comments_251032.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e\">ee5e39e</a></td><td><code>Allow default arguments in closures</code></td></tr></table>\n",
    "created_at": "2013-12-18T17:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e">ee5e39e</a></td><td><code>Allow default arguments in closures</code></td></tr></table>




---

archive/issue_comments_251033.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/ticket/15447](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15447)\" to \"[u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)\".",
    "created_at": "2013-12-18T22:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251033",
    "user": "https://github.com/pjbruin"
}
```

**Changing branch** from "[u/jdemeyer/ticket/15447](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15447)" to "[u/pbruin/15447-eval_PARI_closure](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15447-eval_PARI_closure)".



---

archive/issue_comments_251034.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,4 +15,3 @@\n T(3)\n 4\n ```\n-\n``````\n",
    "created_at": "2013-12-18T22:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251034",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,4 +15,3 @@
 T(3)
 4
 ```
-
``````




---

archive/issue_comments_251035.json:
```json
{
    "body": "**Changing author** from \"Peter Bruin\" to \"Peter Bruin, Jeroen Demeyer\".",
    "created_at": "2013-12-18T22:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251035",
    "user": "https://github.com/pjbruin"
}
```

**Changing author** from "Peter Bruin" to "Peter Bruin, Jeroen Demeyer".



---

archive/issue_comments_251036.json:
```json
{
    "body": "**Changing commit** from \"[ee5e39e59a08b3d96471fc368819784baf020eb8](https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e59a08b3d96471fc368819784baf020eb8)\" to \"[679310bd938fd20812c638c0e73e1c7ce3e60eef](https://github.com/sagemath/sagetrac-mirror/commit/679310bd938fd20812c638c0e73e1c7ce3e60eef)\".",
    "created_at": "2013-12-18T22:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251036",
    "user": "https://github.com/pjbruin"
}
```

**Changing commit** from "[ee5e39e59a08b3d96471fc368819784baf020eb8](https://github.com/sagemath/sagetrac-mirror/commit/ee5e39e59a08b3d96471fc368819784baf020eb8)" to "[679310bd938fd20812c638c0e73e1c7ce3e60eef](https://github.com/sagemath/sagetrac-mirror/commit/679310bd938fd20812c638c0e73e1c7ce3e60eef)".



---

archive/issue_comments_251037.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe last commit makes a small addition to the documentation: mention in the documentation of `eval()` that `f(x) == f.eval(x)`, before the examples that use this.\n\n---\nNew commits:\n|                                                                                                         |                                                        |\n|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[679310b](https://github.com/sagemath/sagetrac-mirror/commit/679310b)|gen.eval() documentation: mention that f(x) == f.eval(x)|",
    "created_at": "2013-12-18T22:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251037",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'></a>
The last commit makes a small addition to the documentation: mention in the documentation of `eval()` that `f(x) == f.eval(x)`, before the examples that use this.

---
New commits:
|                                                                                                         |                                                        |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[679310b](https://github.com/sagemath/sagetrac-mirror/commit/679310b)|gen.eval() documentation: mention that f(x) == f.eval(x)|



---

archive/issue_comments_251038.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [jdemeyer](#comment%3A6):\n> I think you should also implement `getattr()` using closures, see [http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html](http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html)`\n\nI forgot to say here that this is now #15518.",
    "created_at": "2013-12-18T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251038",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:18'></a>
Replying to [jdemeyer](#comment%3A6):
> I think you should also implement `getattr()` using closures, see [http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html](http://pari.math.u-bordeaux1.fr/archives/pari-dev-1311/msg00015.html)`

I forgot to say here that this is now #15518.



---

archive/issue_comments_251039.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer, Peter Bruin",
    "created_at": "2013-12-19T08:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251039",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer, Peter Bruin



---

archive/issue_comments_251040.json:
```json
{
    "body": "<a id='comment:19'></a>\npositive_review from me. If you agree, you can set the ticket to positive_review.",
    "created_at": "2013-12-19T08:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251040",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
positive_review from me. If you agree, you can set the ticket to positive_review.



---

archive/issue_comments_251041.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-12-19T12:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251041",
    "user": "https://github.com/pjbruin"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_051466.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-21T12:16:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15447#event-51466"
}
```



---

archive/issue_comments_251042.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-12-21T12:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15447",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15447#issuecomment-251042",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed
