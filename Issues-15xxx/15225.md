# Issue 15225: dot2tex breaks Poset.show()

archive/issues_014988.json:
```json
{
    "assignees": [],
    "body": "\n```\nvar('a,b,c,d,e,f,g,h')\n\nTHISFAILS=Poset( (\n[h, g*h, f*h, e*h, d*e*h, c*e*h, b*e*h, a*b*c*d*e*f*g*h],\n[[h, g*h], [h, f*h], [h, e*h], [g*h, a*b*c*d*e*f*g*h],\n[f*h, a*b*c*d*e*f*g*h], [e*h, d*e*h], [e*h, c*e*h], [e*h, b*e*h],\n[d*e*h, a*b*c*d*e*f*g*h], [c*e*h, a*b*c*d*e*f*g*h], [b*e*h, a*b*c*d*e*f*g*h]]),\ncover_relations = True, facade = False)\n\nTHISFAILS.show()\n```\n\ngives\n\nAttributeError: 'str' object has no attribute 'iteritems'\n\n\nCC:  @strogdon\n\nKeywords: **poset, dot2tex**\n\nReviewer: **Travis Scrimshaw**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15225_\n\n",
    "closed_at": "2014-04-06T20:53:36Z",
    "created_at": "2013-09-24T15:10:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "dot2tex breaks Poset.show()",
    "type": "issue",
    "updated_at": "2014-04-06T20:53:36Z",
    "url": "https://github.com/sagemath/sage/issues/15225",
    "user": "https://github.com/jm58660"
}
```

```
var('a,b,c,d,e,f,g,h')

THISFAILS=Poset( (
[h, g*h, f*h, e*h, d*e*h, c*e*h, b*e*h, a*b*c*d*e*f*g*h],
[[h, g*h], [h, f*h], [h, e*h], [g*h, a*b*c*d*e*f*g*h],
[f*h, a*b*c*d*e*f*g*h], [e*h, d*e*h], [e*h, c*e*h], [e*h, b*e*h],
[d*e*h, a*b*c*d*e*f*g*h], [c*e*h, a*b*c*d*e*f*g*h], [b*e*h, a*b*c*d*e*f*g*h]]),
cover_relations = True, facade = False)

THISFAILS.show()
```

gives

AttributeError: 'str' object has no attribute 'iteritems'


CC:  @strogdon

Keywords: **poset, dot2tex**

Reviewer: **Travis Scrimshaw**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/15225_





---

archive/issue_events_217351.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2013-09-24T15:10:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217351"
}
```



---

archive/issue_events_217352.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2013-09-24T15:10:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217352"
}
```



---

archive/issue_events_217353.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2013-09-24T15:10:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217353"
}
```



---

archive/issue_events_217354.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2013-09-24T15:10:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217354"
}
```



---

archive/issue_comments_187673.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAnother one, gives same error:\n\n```\nPoset([range(0,11), [[0, 1], [0, 3], [0, 6], [1, 2], [1, 5], [2, 7],\n[3, 4], [3, 8], [4, 5], [5, 9], [6, 7], [6, 8], [7, 9], [8, 9]]]).show()\n```",
    "created_at": "2013-10-22T13:19:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187673",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:1" align="right">comment:1</div>

Another one, gives same error:

```
Poset([range(0,11), [[0, 1], [0, 3], [0, 6], [1, 2], [1, 5], [2, 7],
[3, 4], [3, 8], [4, 5], [5, 9], [6, 7], [6, 8], [7, 9], [8, 9]]]).show()
```



---

archive/issue_comments_187674.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI can not confirm this bug. Both the plots work in sage-5.10, sage-5.11.rc0 and sage-5.13.beta1.\n\nWhat version of sage are you using? Can you try some recent versions?",
    "created_at": "2013-10-26T03:07:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187674",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:2" align="right">comment:2</div>

I can not confirm this bug. Both the plots work in sage-5.10, sage-5.11.rc0 and sage-5.13.beta1.

What version of sage are you using? Can you try some recent versions?



---

archive/issue_events_217355.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-26T03:07:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217355"
}
```



---

archive/issue_comments_187675.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nLast example was tested with 5.12. For example\n\n```\nPoset([ [1,2,3], [[1,2],[2,3]] ]).show()\n```\n\nworks, so system itself seems to work.  sage.misc.package.optional_packages() says\n\n```\n(['autotools-20121217', 'beautifulsoup-3.2.1', 'benzene-20130630',\n'biopython-1.61', 'buckygen-1.0', 'cbc-2.8.1.p0', 'ccache-3.1.9',\n'chomp-20130518.p1', 'cluster_seed-1.0', 'coxeter3-1.1',\n'cryptominisat-2.9.6', 'cunningham_tables-1.0',\n'database_cremona_ellcurve-20121022', 'database_gap-4.6.4',\n'database_jones_numfield-v4', 'database_kohel-20060803',\n'database_odlyzko_zeta', 'database_pari-20130516',\n'database_sloane_oeis-2005-12', 'database_stein_watkins_mini.p0',\n'database_symbolic_data-20070206', 'dot2tex-2.8.7.p2',\n'extra_docs-20070208', 'gap_packages-4.6.4.p1', 'gcc-4.6.4',\n'gdbm-1.8.3', 'ginv-1.9-20080723', 'git-1.7.12.2.p0', 'gnuplotpy-1.8',\n'guppy-0.1.8', 'java3d-20070901', 'kash3-2008-07-31.p0',\n'knoboo-20080411', 'libogg-1.1.4', 'lie-2.2.2.p5', 'lrs-4.2b.p1',\n'mpi4py-1.2.2', 'nauty-25', 'normaliz-2.8.p0', 'nose-1.1.2',\n'nzmath-1.1.0', 'openmpi-1.4.3', 'openssl-1.0.1c.p0',\n'p_group_cohomology-2.1.4', 'phc-2.3.65.p0', 'pybtex-20120618',\n'pycryptoplus-20100809-git', 'pyopenssl-0.13.p0', 'PyQt_x11-4.9.1.p0',\n'pyx-0.10', 'pyzmq-2.1.11.p1', 'qhull-2010.1', 'sage_mode-0.9.1',\n'sip-4.13.2.p0', 'TOPCOM-0.17.4', 'trac-0.11.5.p0', 'valgrind-3.8.1.p0',\n'zeromq-3.2.0.p0'], ['4ti2-1.6', 'brian-1.4.1.p0', 'fricas-1.0.9',\n'fricasaldor-1.0.9', 'jsmath_image_fonts-1.4.p3', 'libcocoa-0.9930',\n'libtheora-1.1.1', 'patchbot-2.0'])\n```\n\nThere is also ldap installed on system, but I guess that it doesn't make any differense.\n\nI will compile plain sage-5.12 to see if this happens without packages.",
    "created_at": "2013-10-28T09:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187675",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:4" align="right">comment:4</div>

Last example was tested with 5.12. For example

```
Poset([ [1,2,3], [[1,2],[2,3]] ]).show()
```

works, so system itself seems to work.  sage.misc.package.optional_packages() says

```
(['autotools-20121217', 'beautifulsoup-3.2.1', 'benzene-20130630',
'biopython-1.61', 'buckygen-1.0', 'cbc-2.8.1.p0', 'ccache-3.1.9',
'chomp-20130518.p1', 'cluster_seed-1.0', 'coxeter3-1.1',
'cryptominisat-2.9.6', 'cunningham_tables-1.0',
'database_cremona_ellcurve-20121022', 'database_gap-4.6.4',
'database_jones_numfield-v4', 'database_kohel-20060803',
'database_odlyzko_zeta', 'database_pari-20130516',
'database_sloane_oeis-2005-12', 'database_stein_watkins_mini.p0',
'database_symbolic_data-20070206', 'dot2tex-2.8.7.p2',
'extra_docs-20070208', 'gap_packages-4.6.4.p1', 'gcc-4.6.4',
'gdbm-1.8.3', 'ginv-1.9-20080723', 'git-1.7.12.2.p0', 'gnuplotpy-1.8',
'guppy-0.1.8', 'java3d-20070901', 'kash3-2008-07-31.p0',
'knoboo-20080411', 'libogg-1.1.4', 'lie-2.2.2.p5', 'lrs-4.2b.p1',
'mpi4py-1.2.2', 'nauty-25', 'normaliz-2.8.p0', 'nose-1.1.2',
'nzmath-1.1.0', 'openmpi-1.4.3', 'openssl-1.0.1c.p0',
'p_group_cohomology-2.1.4', 'phc-2.3.65.p0', 'pybtex-20120618',
'pycryptoplus-20100809-git', 'pyopenssl-0.13.p0', 'PyQt_x11-4.9.1.p0',
'pyx-0.10', 'pyzmq-2.1.11.p1', 'qhull-2010.1', 'sage_mode-0.9.1',
'sip-4.13.2.p0', 'TOPCOM-0.17.4', 'trac-0.11.5.p0', 'valgrind-3.8.1.p0',
'zeromq-3.2.0.p0'], ['4ti2-1.6', 'brian-1.4.1.p0', 'fricas-1.0.9',
'fricasaldor-1.0.9', 'jsmath_image_fonts-1.4.p3', 'libcocoa-0.9930',
'libtheora-1.1.1', 'patchbot-2.0'])
```

There is also ldap installed on system, but I guess that it doesn't make any differense.

I will compile plain sage-5.12 to see if this happens without packages.



---

archive/issue_comments_187676.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI downloaded sage-5.12-linux-64bit-fedora_release_16_verne-x86_64-Linux.tar.lzma and show() command works. Then I installed gnuplotpy-1.8 and it still works. But after sage.misc.package.optional_packages() if fails. Any ideas about what package to test?",
    "created_at": "2013-10-29T10:52:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187676",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:5" align="right">comment:5</div>

I downloaded sage-5.12-linux-64bit-fedora_release_16_verne-x86_64-Linux.tar.lzma and show() command works. Then I installed gnuplotpy-1.8 and it still works. But after sage.misc.package.optional_packages() if fails. Any ideas about what package to test?



---

archive/issue_comments_187677.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nFound it. dot2tex-2.8.7.p2 breaks this.",
    "created_at": "2013-10-29T12:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187677",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:6" align="right">comment:6</div>

Found it. dot2tex-2.8.7.p2 breaks this.



---

archive/issue_events_217356.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-29T12:08:51Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "title_is": "dot2tex breaks Poset.show()",
    "title_was": "Poset.show gives error 'str' object has no attribute 'iteritems'",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217356"
}
```



---

archive/issue_events_217357.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-29T12:09:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217357"
}
```



---

archive/issue_events_217358.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-29T12:09:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217358"
}
```



---

archive/issue_comments_187678.json:
```json
{
    "body": "Changed keywords from **poset** to **poset, dot2tex**",
    "created_at": "2013-10-29T12:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187678",
    "user": "https://github.com/ppurka"
}
```

Changed keywords from **poset** to **poset, dot2tex**



---

archive/issue_comments_187679.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSame happens with 5.13.beta1 and dot2tex-2.8.7.p2.spkg. Does this still needs more info?",
    "created_at": "2013-10-30T11:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187679",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:9" align="right">comment:9</div>

Same happens with 5.13.beta1 and dot2tex-2.8.7.p2.spkg. Does this still needs more info?



---

archive/issue_comments_187680.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jm58660](#comment:9):\n> Same happens with 5.13.beta1 and dot2tex-2.8.7.p2.spkg. Does this still needs more info?\n\nOf course not! Thanks for tracking it down. I have still kept it at needs info because there is no other better status to set it to.",
    "created_at": "2013-10-30T11:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187680",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jm58660](#comment:9):
> Same happens with 5.13.beta1 and dot2tex-2.8.7.p2.spkg. Does this still needs more info?

Of course not! Thanks for tracking it down. I have still kept it at needs info because there is no other better status to set it to.



---

archive/issue_events_217359.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-30T11:38:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217359"
}
```



---

archive/issue_events_217360.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-30T11:38:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217360"
}
```



---

archive/issue_comments_187681.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOk. Let's set it to needs work. dot2tex needs to be fixed.",
    "created_at": "2013-10-30T11:38:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187681",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:11" align="right">comment:11</div>

Ok. Let's set it to needs work. dot2tex needs to be fixed.



---

archive/issue_comments_187682.json:
```json
{
    "body": "Work Issues: **fix dot2tex**",
    "created_at": "2013-10-30T11:38:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187682",
    "user": "https://github.com/ppurka"
}
```

Work Issues: **fix dot2tex**



---

archive/issue_comments_187683.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nDo you have `graphviz` installed on your system?\n\nThe (the optional package) `dot2tex` stuff [typically] needs `graphviz` installed as well, but there's no check for that in Sage AFAIK. So if you have `dot2tex` installed but not `graphviz`, you can get things breaking because things that check for `dot2tex` pass and it expects `graphviz` to be there as well..",
    "created_at": "2013-11-03T05:58:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187683",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Do you have `graphviz` installed on your system?

The (the optional package) `dot2tex` stuff [typically] needs `graphviz` installed as well, but there's no check for that in Sage AFAIK. So if you have `dot2tex` installed but not `graphviz`, you can get things breaking because things that check for `dot2tex` pass and it expects `graphviz` to be there as well..



---

archive/issue_comments_187684.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAt least on one system with this problem dpkg says \"ii graphviz 2.26.3-10ubuntu1 rich set of graph drawing tools\".\n\nAnd anyways, how could missing package break just one or two special poset?",
    "created_at": "2013-11-03T07:53:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187684",
    "user": "https://github.com/jm58660"
}
```

<div id="comment:13" align="right">comment:13</div>

At least on one system with this problem dpkg says "ii graphviz 2.26.3-10ubuntu1 rich set of graph drawing tools".

And anyways, how could missing package break just one or two special poset?



---

archive/issue_comments_187685.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nTrue. Although I do get this error message:\n\n```\nERROR    Failed to process input\nTraceback (most recent call last):\n  File \"/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py\", line 2928, in main\n    s =  conv.convert(dotdata)\n  File \"/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py\", line 848, in convert\n    return self.output()\n  File \"/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py\", line 2566, in output\n    positions[node.name] = map(int, pos.split(','))\nValueError: invalid literal for int() with base 10: '185.4'\n```\nI'm not convinced it is a `dot2tex` error. If you run `view(P)` it works, but `P._hasse_diagram.plot()` does not. I've uncovered another minor issue; the `hasse_diagram()` method only returns a `DiGraph`, not a `HasseDiagram`, but that probably won't fix this problem. The error gets triggered when I create the corresponding `DiGraph` object and tell it to plot with `layout='acyclic'`.\n\nAlso for reference, here's the remaining part of the error message:\n\n```\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-52-ba27df962a36> in <module>()\n----> 1 P.hasse_diagram().plot(layout='acyclic')\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)\n    535                 options['__original_opts'] = kwds\n    536             options.update(kwds)\n--> 537             return func(*args, **options)\n    538 \n    539         #Add the options specified by @options to the signature of the wrapped\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in plot(self, **options)\n  14924             ['black', 'purple', 'yellow', 'yellow']\n  14925         \"\"\"\n> 14926         return self.graphplot(**options).plot()\n  14927 \n  14928     def show(self, **kwds):\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in graphplot(self, **options)\n  14636         \"\"\"\n  14637         from sage.graphs.graph_plot import GraphPlot\n> 14638         return GraphPlot(graph=self, options=options)\n  14639 \n  14640     @options()\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/graph_plot.pyc in __init__(self, graph, options)\n    236         self._graph = graph\n    237         self._options = options # contains both plot and show options\n--> 238         self.set_pos()\n    239         self._arcs = self._graph.has_multiple_edges(to_undirected=True)\n    240         self._loops = self._graph.has_loops()\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/graph_plot.pyc in set_pos(self)\n    306 \n    307         \"\"\"\n--> 308         self._pos = self._graph.layout(**self._options)\n    309         # make sure the positions are floats (trac #10124)\n    310         self._pos = dict((k,(float(v[0]), float(v[1]))) for k,v in self._pos.iteritems())\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in layout(self, layout, pos, dim, save_pos, **options)\n  14167 \n  14168         if hasattr(self, \"layout_%s\"%layout):\n> 14169             pos = getattr(self, \"layout_%s\"%layout)(dim = dim, **options)\n  14170         elif layout is not None:\n  14171             raise ValueError(\"unknown layout algorithm: %s\"%layout)\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/digraph.pyc in layout_acyclic(self, **options)\n   2937         \"\"\"\n   2938         if have_dot2tex():\n-> 2939             return self.layout_graphviz(**options)\n   2940         else:\n   2941             return self.layout_acyclic_dummy(**options)\n\n/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in layout_graphviz(self, dim, prog, **options)\n  14571         positions = dot2tex.dot2tex(self.graphviz_string(**options), format = \"positions\", prog = prog)\n  14572 \n> 14573         return dict( (key_to_vertex[key], pos) for (key, pos) in positions.iteritems() )\n  14574 \n  14575     def _layout_bounding_box(self, pos):\n\nAttributeError: 'str' object has no attribute 'iteritems'\n```",
    "created_at": "2013-11-03T15:32:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187685",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

True. Although I do get this error message:

```
ERROR    Failed to process input
Traceback (most recent call last):
  File "/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py", line 2928, in main
    s =  conv.convert(dotdata)
  File "/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py", line 848, in convert
    return self.output()
  File "/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/dot2tex/dot2tex.py", line 2566, in output
    positions[node.name] = map(int, pos.split(','))
ValueError: invalid literal for int() with base 10: '185.4'
```
I'm not convinced it is a `dot2tex` error. If you run `view(P)` it works, but `P._hasse_diagram.plot()` does not. I've uncovered another minor issue; the `hasse_diagram()` method only returns a `DiGraph`, not a `HasseDiagram`, but that probably won't fix this problem. The error gets triggered when I create the corresponding `DiGraph` object and tell it to plot with `layout='acyclic'`.

Also for reference, here's the remaining part of the error message:

```
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-52-ba27df962a36> in <module>()
----> 1 P.hasse_diagram().plot(layout='acyclic')

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)
    535                 options['__original_opts'] = kwds
    536             options.update(kwds)
--> 537             return func(*args, **options)
    538 
    539         #Add the options specified by @options to the signature of the wrapped

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in plot(self, **options)
  14924             ['black', 'purple', 'yellow', 'yellow']
  14925         """
> 14926         return self.graphplot(**options).plot()
  14927 
  14928     def show(self, **kwds):

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in graphplot(self, **options)
  14636         """
  14637         from sage.graphs.graph_plot import GraphPlot
> 14638         return GraphPlot(graph=self, options=options)
  14639 
  14640     @options()

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/graph_plot.pyc in __init__(self, graph, options)
    236         self._graph = graph
    237         self._options = options # contains both plot and show options
--> 238         self.set_pos()
    239         self._arcs = self._graph.has_multiple_edges(to_undirected=True)
    240         self._loops = self._graph.has_loops()

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/graph_plot.pyc in set_pos(self)
    306 
    307         """
--> 308         self._pos = self._graph.layout(**self._options)
    309         # make sure the positions are floats (trac #10124)
    310         self._pos = dict((k,(float(v[0]), float(v[1]))) for k,v in self._pos.iteritems())

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in layout(self, layout, pos, dim, save_pos, **options)
  14167 
  14168         if hasattr(self, "layout_%s"%layout):
> 14169             pos = getattr(self, "layout_%s"%layout)(dim = dim, **options)
  14170         elif layout is not None:
  14171             raise ValueError("unknown layout algorithm: %s"%layout)

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/digraph.pyc in layout_acyclic(self, **options)
   2937         """
   2938         if have_dot2tex():
-> 2939             return self.layout_graphviz(**options)
   2940         else:
   2941             return self.layout_acyclic_dummy(**options)

/home/travis/sage-5.13.beta2/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in layout_graphviz(self, dim, prog, **options)
  14571         positions = dot2tex.dot2tex(self.graphviz_string(**options), format = "positions", prog = prog)
  14572 
> 14573         return dict( (key_to_vertex[key], pos) for (key, pos) in positions.iteritems() )
  14574 
  14575     def _layout_bounding_box(self, pos):

AttributeError: 'str' object has no attribute 'iteritems'
```



---

archive/issue_comments_187686.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe ValueError/AttributeError disappears for me if I include the [dot2tex patch](https://code.google.com/p/dot2tex/source/diff?spec=svn681c5a92ec1604f6810dbe88b916f082a4ed6a44&old=7395e5a250800a174c86e3b9bf9435ca5d7618ef&r=681c5a92ec1604f6810dbe88b916f082a4ed6a44&format=unidiff&path=%2Fdot2tex%2Fdot2tex.py) which seems to be present in the spkg(s) at ticket #14408. However, perhaps the real issue is that `prog='dot'` returns sometimes ints and sometimes floats for the positions. For example, with the patch:\n\n```\nsage: import dot2tex\nsage: AA = 'digraph {\\n  \"0\" [label=\"0\"];\\n  \"1\" [label=\"1\"];\\n  \"2\" [label=\"2\"];\\n  \"3\" [label=\"3\"];\\n  \"4\" [label=\"4\"];\\n  \"5\" [label=\"5\"];\\n  \"6\" [label=\"6\"];\\n  \"7\" [label=\"7\"];\\n  \"8\" [label=\"8\"];\\n  \"9\" [label=\"9\"];\\n  \"10\" [label=\"10\"];\\n\\nedge [color=\"black\"];\\n  \"0\" -> \"1\";\\n  \"0\" -> \"3\";\\n  \"0\" -> \"6\";\\n  \"1\" -> \"2\";\\n  \"1\" -> \"5\";\\n  \"2\" -> \"7\";\\n  \"3\" -> \"4\";\\n  \"3\" -> \"8\";\\n  \"4\" -> \"5\";\\n  \"5\" -> \"9\";\\n  \"6\" -> \"7\";\\n  \"6\" -> \"8\";\\n  \"7\" -> \"9\";\\n  \"8\" -> \"9\";\\n}'\nsage: dot2tex.dot2tex(AA, format=\"positions\", prog=\"dot\")\n{'0': [113.39, 315.0],\n '1': [41.39, 241.0],\n '10': [185.39, 315.0],\n '2': [41.39, 167.0],\n '3': [113.39, 241.0],\n '4': [113.39, 167.0],\n '5': [113.39, 93.0],\n '6': [185.39, 241.0],\n '7': [231.39, 93.0],\n '8': [185.39, 167.0],\n '9': [176.39, 19.0]}\nsage: BB = 'digraph {\\n  \"0\" [label=\"0\"];\\n  \"1\" [label=\"1\"];\\n  \"2\" [label=\"2\"];\\n  \"3\" [label=\"3\"];\\n  \"4\" [label=\"4\"];\\n  \"5\" [label=\"5\"];\\n  \"6\" [label=\"6\"];\\n  \"7\" [label=\"7\"];\\n  \"8\" [label=\"8\"];\\n  \"9\" [label=\"9\"];\\n  \"10\" [label=\"10\"];\\n\\nedge [color=\"black\"];\\n  \"0\" -> \"1\";\\n  \"0\" -> \"3\";\\n  \"0\" -> \"6\";\\n  \"1\" -> \"2\";\\n  \"1\" -> \"5\";\\n  \"2\" -> \"7\";\\n  \"3\" -> \"4\";\\n  \"3\" -> \"8\";\\n  \"4\" -> \"5\";\\n  \"5\" -> \"9\";\\n  \"6\" -> \"7\";\\n  \"6\" -> \"8\";\\n  \"7\" -> \"9\";\\n}'\nsage: dot2tex.dot2tex(BB, format=\"positions\", prog=\"dot\")\n{'0': [137, 315],\n '1': [209, 241],\n '10': [209, 315],\n '2': [247, 167],\n '3': [65, 241],\n '4': [27, 167],\n '5': [128, 93],\n '6': [137, 241],\n '7': [200, 93],\n '8': [99, 167],\n '9': [164, 19]}\n```\nThe first example gives a ValueError without the patch. This can be reproduced from python, so it's not Sage-specific. I suppose what's returned by `prog='dot'` should either be always ints or always floats for the positions, but I'm not sure whether the present situation is a bug or a feature, nor is it clear to me which calls in dot2tex produce these values.",
    "created_at": "2013-11-15T23:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187686",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:16" align="right">comment:16</div>

The ValueError/AttributeError disappears for me if I include the [dot2tex patch](https://code.google.com/p/dot2tex/source/diff?spec=svn681c5a92ec1604f6810dbe88b916f082a4ed6a44&old=7395e5a250800a174c86e3b9bf9435ca5d7618ef&r=681c5a92ec1604f6810dbe88b916f082a4ed6a44&format=unidiff&path=%2Fdot2tex%2Fdot2tex.py) which seems to be present in the spkg(s) at ticket #14408. However, perhaps the real issue is that `prog='dot'` returns sometimes ints and sometimes floats for the positions. For example, with the patch:

```
sage: import dot2tex
sage: AA = 'digraph {\n  "0" [label="0"];\n  "1" [label="1"];\n  "2" [label="2"];\n  "3" [label="3"];\n  "4" [label="4"];\n  "5" [label="5"];\n  "6" [label="6"];\n  "7" [label="7"];\n  "8" [label="8"];\n  "9" [label="9"];\n  "10" [label="10"];\n\nedge [color="black"];\n  "0" -> "1";\n  "0" -> "3";\n  "0" -> "6";\n  "1" -> "2";\n  "1" -> "5";\n  "2" -> "7";\n  "3" -> "4";\n  "3" -> "8";\n  "4" -> "5";\n  "5" -> "9";\n  "6" -> "7";\n  "6" -> "8";\n  "7" -> "9";\n  "8" -> "9";\n}'
sage: dot2tex.dot2tex(AA, format="positions", prog="dot")
{'0': [113.39, 315.0],
 '1': [41.39, 241.0],
 '10': [185.39, 315.0],
 '2': [41.39, 167.0],
 '3': [113.39, 241.0],
 '4': [113.39, 167.0],
 '5': [113.39, 93.0],
 '6': [185.39, 241.0],
 '7': [231.39, 93.0],
 '8': [185.39, 167.0],
 '9': [176.39, 19.0]}
sage: BB = 'digraph {\n  "0" [label="0"];\n  "1" [label="1"];\n  "2" [label="2"];\n  "3" [label="3"];\n  "4" [label="4"];\n  "5" [label="5"];\n  "6" [label="6"];\n  "7" [label="7"];\n  "8" [label="8"];\n  "9" [label="9"];\n  "10" [label="10"];\n\nedge [color="black"];\n  "0" -> "1";\n  "0" -> "3";\n  "0" -> "6";\n  "1" -> "2";\n  "1" -> "5";\n  "2" -> "7";\n  "3" -> "4";\n  "3" -> "8";\n  "4" -> "5";\n  "5" -> "9";\n  "6" -> "7";\n  "6" -> "8";\n  "7" -> "9";\n}'
sage: dot2tex.dot2tex(BB, format="positions", prog="dot")
{'0': [137, 315],
 '1': [209, 241],
 '10': [209, 315],
 '2': [247, 167],
 '3': [65, 241],
 '4': [27, 167],
 '5': [128, 93],
 '6': [137, 241],
 '7': [200, 93],
 '8': [99, 167],
 '9': [164, 19]}
```
The first example gives a ValueError without the patch. This can be reproduced from python, so it's not Sage-specific. I suppose what's returned by `prog='dot'` should either be always ints or always floats for the positions, but I'm not sure whether the present situation is a bug or a feature, nor is it clear to me which calls in dot2tex produce these values.



---

archive/issue_events_217361.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217361"
}
```



---

archive/issue_events_217362.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217362"
}
```



---

archive/issue_comments_187687.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFrom what I've tested it appears that ticket #16026 solves the dot2tex breakage here. In any event the patch [dot2tex](https://code.google.com/p/dot2tex/source/diff?spec=svn681c5a92ec1604f6810dbe88b916f082a4ed6a44&old=7395e5a250800a174c86e3b9bf9435ca5d7618ef&r=681c5a92ec1604f6810dbe88b916f082a4ed6a44&format=unidiff&path=%2Fdot2tex%2Fdot2tex.py) patch appears in the upstream [tarball](http://boxen.math.washington.edu/home/vbraun/upstream/dot2tex-20120520.tar.bz2)",
    "created_at": "2014-04-03T23:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187687",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:18" align="right">comment:18</div>

From what I've tested it appears that ticket #16026 solves the dot2tex breakage here. In any event the patch [dot2tex](https://code.google.com/p/dot2tex/source/diff?spec=svn681c5a92ec1604f6810dbe88b916f082a4ed6a44&old=7395e5a250800a174c86e3b9bf9435ca5d7618ef&r=681c5a92ec1604f6810dbe88b916f082a4ed6a44&format=unidiff&path=%2Fdot2tex%2Fdot2tex.py) patch appears in the upstream [tarball](http://boxen.math.washington.edu/home/vbraun/upstream/dot2tex-20120520.tar.bz2)



---

archive/issue_comments_187688.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI also get that #16026 fixes this.",
    "created_at": "2014-04-06T17:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187688",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

I also get that #16026 fixes this.



---

archive/issue_comments_187689.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2014-04-06T17:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187689",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_187690.json:
```json
{
    "body": "Changed work issues from **fix dot2tex** to none",
    "created_at": "2014-04-06T17:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15225#issuecomment-187690",
    "user": "https://github.com/tscrim"
}
```

Changed work issues from **fix dot2tex** to none



---

archive/issue_events_217363.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-06T17:14:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217363"
}
```



---

archive/issue_events_217364.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-06T17:14:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217364"
}
```



---

archive/issue_events_217365.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-06T17:14:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217365"
}
```



---

archive/issue_events_217366.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-06T17:14:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217366"
}
```



---

archive/issue_events_217367.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-06T17:14:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "c6c6c6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217367"
}
```



---

archive/issue_events_217368.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-06T20:53:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217368"
}
```



---

archive/issue_events_217369.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-06T20:53:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217369"
}
```



---

archive/issue_events_217370.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-06T20:53:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15225",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "c6c6c6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15225#event-217370"
}
```
