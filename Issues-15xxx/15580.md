# Issue 15580: Integrate prereq in the new build system

archive/issues_015343.json:
```json
{
    "assignees": [],
    "body": "After downloading Sage 6.0 either from git or from the `.tar.gz` sdist tarball, the prereq tarball `prereq-1.2.tar.gz` is missing. This is a huge problem, because many checks are skipped because of this.\n\nIntegrating this was probably overlooked in the sage-git build system. I think the best solution is not have prereq as a tarball at all and simply integrate the *contents* of the former prereq tarball in the git repo.\n\nDepends on #15596\n\nCC:  @ohanar @vbraun\n\nBranch/Commit: **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580) @ [2e27abb](https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f)**\n\nReviewer: **R. Andrew Ohana, Volker Braun**\n\nAuthor: **R. Andrew Ohana, Jeroen Demeyer**\n\nComponent: **distribution**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15580_\n\n",
    "closed_at": "2014-01-16T05:10:37Z",
    "created_at": "2013-12-24T09:40:37Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20distribution",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Integrate prereq in the new build system",
    "type": "issue",
    "updated_at": "2014-01-16T05:10:37Z",
    "url": "https://github.com/sagemath/sage/issues/15580",
    "user": "https://github.com/jdemeyer"
}
```
After downloading Sage 6.0 either from git or from the `.tar.gz` sdist tarball, the prereq tarball `prereq-1.2.tar.gz` is missing. This is a huge problem, because many checks are skipped because of this.

Integrating this was probably overlooked in the sage-git build system. I think the best solution is not have prereq as a tarball at all and simply integrate the *contents* of the former prereq tarball in the git repo.

Depends on #15596

CC:  @ohanar @vbraun

Branch/Commit: **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580) @ [2e27abb](https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f)**

Reviewer: **R. Andrew Ohana, Volker Braun**

Author: **R. Andrew Ohana, Jeroen Demeyer**

Component: **distribution**

_Issue created by migration from https://trac.sagemath.org/ticket/15580_





---

archive/issue_events_222110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-24T09:40:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222110"
}
```



---

archive/issue_events_222111.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-24T09:40:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20distribution",
    "label_color": "000080",
    "label_name": "c: distribution",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222111"
}
```



---

archive/issue_events_222112.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-24T09:40:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222112"
}
```



---

archive/issue_events_222113.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-24T09:40:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222113"
}
```



---

archive/issue_events_222114.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-24T09:51:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "title_is": "Integrate prereq in the new build system",
    "title_was": "prereq tarball is missing",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222114"
}
```



---

archive/issue_comments_194978.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n After downloading Sage 6.0 either from git or from the `.tar.gz` sdist tarball, the prereq tarball `prereq-1.2.tar.gz` is missing. This is a huge problem, because many checks are skipped because of this.\n+\n+Integrating this was probably overlooked in the sage-git build system. I think the best solution is not have prereq as a tarball at all and simply integrate the *contents* of the former prereq tarball in the git repo.\n``````\n",
    "created_at": "2013-12-24T09:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194978",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 After downloading Sage 6.0 either from git or from the `.tar.gz` sdist tarball, the prereq tarball `prereq-1.2.tar.gz` is missing. This is a huge problem, because many checks are skipped because of this.
+
+Integrating this was probably overlooked in the sage-git build system. I think the best solution is not have prereq as a tarball at all and simply integrate the *contents* of the former prereq tarball in the git repo.
``````




---

archive/issue_comments_194979.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nActually `prereq-1.2.tar.gz` should work if you drop it into the `upstream` directory, but since it was different, it didn't receive any of the extra treatment the other packages got.",
    "created_at": "2013-12-24T11:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194979",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:2" align="right">comment:2</div>

Actually `prereq-1.2.tar.gz` should work if you drop it into the `upstream` directory, but since it was different, it didn't receive any of the extra treatment the other packages got.



---

archive/issue_comments_194980.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@ohanar](#comment:2):\n> Actually `prereq-1.2.tar.gz` should work if you drop it into the `upstream` directory\n\nOK, I see that. But it's not distributed by default.",
    "created_at": "2013-12-24T11:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194980",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@ohanar](#comment:2):
> Actually `prereq-1.2.tar.gz` should work if you drop it into the `upstream` directory

OK, I see that. But it's not distributed by default.



---

archive/issue_comments_194981.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIf somebody can merge the prereq tarball contents in the git repo, I can easily do the rest.",
    "created_at": "2013-12-27T12:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194981",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

If somebody can merge the prereq tarball contents in the git repo, I can easily do the rest.



---

archive/issue_comments_194982.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI've exported `prereq-1.2`'s history to the root directory with no cleanup (e.g. there is still the hgignore).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0881c74\">0881c74</a></td><td><code>Merge in prereq-1.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb5e072\">cb5e072</a></td><td><code>Trac #14406: remove sqrtl() and SAGE_FORTRAN/SAGE_FORTRAN_LIB checks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e98db82\">e98db82</a></td><td><code>trac 13385: Remove check for openssl.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e63837b\">e63837b</a></td><td><code>Trac #13329: Add -lcrypto and -ldl (needed for -lssl), support SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48b54aa\">48b54aa</a></td><td><code>Trac #13329: small reviewer fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac675c6\">ac675c6</a></td><td><code>make dpgk-architecture check error out, its at least in Ubuntu 8.04</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73f867d\">73f867d</a></td><td><code>added openssl and dpkg-architecture check</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b9c3e9\">6b9c3e9</a></td><td><code>Trac #12112: Support --disable-compiler-checks option</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea08e9b\">ea08e9b</a></td><td><code>Initialization of repository</code></td></tr></table>\n",
    "created_at": "2013-12-28T09:23:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194982",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:5" align="right">comment:5</div>

I've exported `prereq-1.2`'s history to the root directory with no cleanup (e.g. there is still the hgignore).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0881c74">0881c74</a></td><td><code>Merge in prereq-1.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb5e072">cb5e072</a></td><td><code>Trac #14406: remove sqrtl() and SAGE_FORTRAN/SAGE_FORTRAN_LIB checks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e98db82">e98db82</a></td><td><code>trac 13385: Remove check for openssl.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e63837b">e63837b</a></td><td><code>Trac #13329: Add -lcrypto and -ldl (needed for -lssl), support SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48b54aa">48b54aa</a></td><td><code>Trac #13329: small reviewer fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac675c6">ac675c6</a></td><td><code>make dpgk-architecture check error out, its at least in Ubuntu 8.04</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73f867d">73f867d</a></td><td><code>added openssl and dpkg-architecture check</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b9c3e9">6b9c3e9</a></td><td><code>Trac #12112: Support --disable-compiler-checks option</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea08e9b">ea08e9b</a></td><td><code>Initialization of repository</code></td></tr></table>




---

archive/issue_comments_194983.json:
```json
{
    "body": "Branch: **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**",
    "created_at": "2013-12-28T09:23:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194983",
    "user": "https://github.com/ohanar"
}
```

Branch: **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**



---

archive/issue_comments_194984.json:
```json
{
    "body": "Commit: **[0881c74](https://github.com/sagemath/sagetrac-mirror/commit/0881c74dbd67f5cb8ee7733e8f4a9627f823a8f9)**",
    "created_at": "2013-12-28T09:23:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194984",
    "user": "https://github.com/ohanar"
}
```

Commit: **[0881c74](https://github.com/sagemath/sagetrac-mirror/commit/0881c74dbd67f5cb8ee7733e8f4a9627f823a8f9)**



---

archive/issue_comments_194985.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI have a patch ready, but I need to rebuild Sage before it can be uploaded...",
    "created_at": "2013-12-28T17:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194985",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I have a patch ready, but I need to rebuild Sage before it can be uploaded...



---

archive/issue_comments_194986.json:
```json
{
    "body": "Author: **R. Andrew Ohana, Jeroen Demeyer**",
    "created_at": "2013-12-28T17:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194986",
    "user": "https://github.com/jdemeyer"
}
```

Author: **R. Andrew Ohana, Jeroen Demeyer**



---

archive/issue_comments_194987.json:
```json
{
    "body": "Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2013-12-28T21:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194987",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_comments_194988.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNot yet ready for review, requires more work.",
    "created_at": "2013-12-28T21:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194988",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Not yet ready for review, requires more work.



---

archive/issue_comments_194989.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**",
    "created_at": "2013-12-28T21:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194989",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**



---

archive/issue_comments_194990.json:
```json
{
    "body": "Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2013-12-28T23:36:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194990",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_events_222115.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-28T23:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222115"
}
```



---

archive/issue_comments_194991.json:
```json
{
    "body": "Changed commit from **[0881c74](https://github.com/sagemath/sagetrac-mirror/commit/0881c74dbd67f5cb8ee7733e8f4a9627f823a8f9)** to **[143e5e4](https://github.com/sagemath/sagetrac-mirror/commit/143e5e4eacab65525b99f71650cac8d4d893d0c3)**",
    "created_at": "2013-12-29T00:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194991",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0881c74](https://github.com/sagemath/sagetrac-mirror/commit/0881c74dbd67f5cb8ee7733e8f4a9627f823a8f9)** to **[143e5e4](https://github.com/sagemath/sagetrac-mirror/commit/143e5e4eacab65525b99f71650cac8d4d893d0c3)**



---

archive/issue_comments_194992.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/143e5e4\">143e5e4</a></td><td><code>Don't use cp -p in sage-clone-source</code></td></tr></table>\n",
    "created_at": "2013-12-29T00:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194992",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/143e5e4">143e5e4</a></td><td><code>Don't use cp -p in sage-clone-source</code></td></tr></table>




---

archive/issue_comments_194993.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68ac77f\">68ac77f</a></td><td><code>Merge branch 'u/jdemeyer/ticket/15596' of git://trac.sagemath.org/sage into ticket/15580</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7c0106\">c7c0106</a></td><td><code>sage-sdist: copy upstream tarballs using sage-spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/321a9ad\">321a9ad</a></td><td><code>Merge remote-tracking branch 'trac/u/ohanar/pillow' into t/15596/sdist_fails_with_capital_p_illow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f005905\">f005905</a></td><td><code>pillow: depends on setuptools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adc90ce\">adc90ce</a></td><td><code>Pillow -> pillow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8987381\">8987381</a></td><td><code>remove PIL (it has been replaced by Pillow)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c055bd\">2c055bd</a></td><td><code>Pillow: fix patch to work against 2.2.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6690d97\">6690d97</a></td><td><code>doc: remove now unused environment variables</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3778f42\">3778f42</a></td><td><code>Pillow: re-resolve #9864</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6df0adb\">6df0adb</a></td><td><code>replace PIL with Pillow</code></td></tr></table>\n",
    "created_at": "2013-12-29T10:37:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194993",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68ac77f">68ac77f</a></td><td><code>Merge branch 'u/jdemeyer/ticket/15596' of git://trac.sagemath.org/sage into ticket/15580</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7c0106">c7c0106</a></td><td><code>sage-sdist: copy upstream tarballs using sage-spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/321a9ad">321a9ad</a></td><td><code>Merge remote-tracking branch 'trac/u/ohanar/pillow' into t/15596/sdist_fails_with_capital_p_illow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f005905">f005905</a></td><td><code>pillow: depends on setuptools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adc90ce">adc90ce</a></td><td><code>Pillow -> pillow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8987381">8987381</a></td><td><code>remove PIL (it has been replaced by Pillow)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c055bd">2c055bd</a></td><td><code>Pillow: fix patch to work against 2.2.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6690d97">6690d97</a></td><td><code>doc: remove now unused environment variables</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3778f42">3778f42</a></td><td><code>Pillow: re-resolve #9864</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6df0adb">6df0adb</a></td><td><code>replace PIL with Pillow</code></td></tr></table>




---

archive/issue_comments_194994.json:
```json
{
    "body": "Changed commit from **[143e5e4](https://github.com/sagemath/sagetrac-mirror/commit/143e5e4eacab65525b99f71650cac8d4d893d0c3)** to **[68ac77f](https://github.com/sagemath/sagetrac-mirror/commit/68ac77f261a2e36ea899bea3ce76971642c1a0d1)**",
    "created_at": "2013-12-29T10:37:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194994",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[143e5e4](https://github.com/sagemath/sagetrac-mirror/commit/143e5e4eacab65525b99f71650cac8d4d893d0c3)** to **[68ac77f](https://github.com/sagemath/sagetrac-mirror/commit/68ac77f261a2e36ea899bea3ce76971642c1a0d1)**



---

archive/issue_comments_194995.json:
```json
{
    "body": "Dependencies: **#15596**",
    "created_at": "2013-12-29T10:50:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194995",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#15596**



---

archive/issue_comments_194996.json:
```json
{
    "body": "Reviewer: **R. Andrew Ohana**",
    "created_at": "2013-12-30T05:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194996",
    "user": "https://github.com/ohanar"
}
```

Reviewer: **R. Andrew Ohana**



---

archive/issue_comments_194997.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nLooks fine to me, so long as someone can review my reviewer commit. (It is just restoring a small regression of `sage-sdist`.)\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43b696f\">43b696f</a></td><td><code>sage-sdist: don't require sage to be built</code></td></tr></table>\n",
    "created_at": "2013-12-30T05:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194997",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:14" align="right">comment:14</div>

Looks fine to me, so long as someone can review my reviewer commit. (It is just restoring a small regression of `sage-sdist`.)

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43b696f">43b696f</a></td><td><code>sage-sdist: don't require sage to be built</code></td></tr></table>




---

archive/issue_comments_194998.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**",
    "created_at": "2013-12-30T05:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194998",
    "user": "https://github.com/ohanar"
}
```

Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)**



---

archive/issue_comments_194999.json:
```json
{
    "body": "Changed commit from **[68ac77f](https://github.com/sagemath/sagetrac-mirror/commit/68ac77f261a2e36ea899bea3ce76971642c1a0d1)** to **[43b696f](https://github.com/sagemath/sagetrac-mirror/commit/43b696f7f53f21e9a08f8a01a3fe0480e1c3a448)**",
    "created_at": "2013-12-30T05:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-194999",
    "user": "https://github.com/ohanar"
}
```

Changed commit from **[68ac77f](https://github.com/sagemath/sagetrac-mirror/commit/68ac77f261a2e36ea899bea3ce76971642c1a0d1)** to **[43b696f](https://github.com/sagemath/sagetrac-mirror/commit/43b696f7f53f21e9a08f8a01a3fe0480e1c3a448)**



---

archive/issue_comments_195000.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOne comment I have is that having a toplevel configure script might confuse those not familiar with sage's odd build system. Maybe we should move it to be under the build directory?",
    "created_at": "2013-12-30T05:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195000",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:15" align="right">comment:15</div>

One comment I have is that having a toplevel configure script might confuse those not familiar with sage's odd build system. Maybe we should move it to be under the build directory?



---

archive/issue_comments_195001.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@ohanar](#comment:15):\n> One comment I have is that having a toplevel configure script might confuse those not familiar with sage's odd build system. Maybe we should move it to be under the build directory?\n\nMy hope is to converge to a more standard build system, so having `./configure` at the top-level makes the most sense. And even if it confuses people, doing `./configure && make` like the usual packages still works.",
    "created_at": "2013-12-30T10:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195001",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@ohanar](#comment:15):
> One comment I have is that having a toplevel configure script might confuse those not familiar with sage's odd build system. Maybe we should move it to be under the build directory?

My hope is to converge to a more standard build system, so having `./configure` at the top-level makes the most sense. And even if it confuses people, doing `./configure && make` like the usual packages still works.



---

archive/issue_comments_195002.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@ohanar](#comment:14):\n> Looks fine to me, so long as someone can review my reviewer commit. (It is just restoring a small regression of `sage-sdist`.)\n\nI don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem? I never liked the `[ -z \"$$SAGE_INSTALL_FETCH_ONLY\" ]` in `build/deps` and I want to remove that. The only reason I didn't do that on this ticket is to avoid potential merge conflicts. And reusing the `$(INST)/sage` build rule to copy the sources makes both `build/deps` and `sage-sdist` harder to understand for no good reason.\n\nSo my proposal is still to merge my patch as-is, but of course I'm listening to suggestions...",
    "created_at": "2013-12-30T10:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195002",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@ohanar](#comment:14):
> Looks fine to me, so long as someone can review my reviewer commit. (It is just restoring a small regression of `sage-sdist`.)

I don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem? I never liked the `[ -z "$$SAGE_INSTALL_FETCH_ONLY" ]` in `build/deps` and I want to remove that. The only reason I didn't do that on this ticket is to avoid potential merge conflicts. And reusing the `$(INST)/sage` build rule to copy the sources makes both `build/deps` and `sage-sdist` harder to understand for no good reason.

So my proposal is still to merge my patch as-is, but of course I'm listening to suggestions...



---

archive/issue_comments_195003.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jdemeyer](#comment:17):\n> I don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem?\n\nIt requires that all of the sage libraries dependencies to already be built (otherwise it will bail). Before this branch, you could clone a sage repository, and without running `make`, you could run (without error) `sage -sdist`.\n\nThis was not true back in mercurial land, but then again, `sage-sdist` had to be a lot more complicated since there were a number of repositories to manage.\n\nI think that the best solution to these issues are to include the package type (and dependencies) in the metadata of each individual package. Right now you have to do this psuedo-build to pull just the standard packages (since the only thing that records them as standard is that they are a dependency of sage in `build/deps`).\n\nI would propose my additional commit for now (or some alternative to restore `sage -sdist` for freshly cloned repos), and open a new ticket to introduce the extra metadata.",
    "created_at": "2013-12-30T11:23:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195003",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jdemeyer](#comment:17):
> I don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem?

It requires that all of the sage libraries dependencies to already be built (otherwise it will bail). Before this branch, you could clone a sage repository, and without running `make`, you could run (without error) `sage -sdist`.

This was not true back in mercurial land, but then again, `sage-sdist` had to be a lot more complicated since there were a number of repositories to manage.

I think that the best solution to these issues are to include the package type (and dependencies) in the metadata of each individual package. Right now you have to do this psuedo-build to pull just the standard packages (since the only thing that records them as standard is that they are a dependency of sage in `build/deps`).

I would propose my additional commit for now (or some alternative to restore `sage -sdist` for freshly cloned repos), and open a new ticket to introduce the extra metadata.



---

archive/issue_comments_195004.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@jdemeyer](#comment:16):\n> My hope is to converge to a more standard build system, so having `./configure` at the top-level makes the most sense. And even if it confuses people, doing `./configure && make` like the usual packages still works.\n\nOk, sounds good.",
    "created_at": "2013-12-30T11:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195004",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@jdemeyer](#comment:16):
> My hope is to converge to a more standard build system, so having `./configure` at the top-level makes the most sense. And even if it confuses people, doing `./configure && make` like the usual packages still works.

Ok, sounds good.



---

archive/issue_comments_195005.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@ohanar](#comment:18):\n> and open a new ticket to introduce the extra metadata.\n\nOn the other hand, I don't like the idea of storing the same information (which packages are \"standard\") twice.",
    "created_at": "2013-12-30T11:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195005",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@ohanar](#comment:18):
> and open a new ticket to introduce the extra metadata.

On the other hand, I don't like the idea of storing the same information (which packages are "standard") twice.



---

archive/issue_comments_195006.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@ohanar](#comment:18):\n> Replying to [@jdemeyer](#comment:17):\n> > I don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem?\n\n> It requires that all of the sage libraries dependencies to already be built (otherwise it will bail). Before this branch, you could clone a sage repository, and without running `make`, you could run (without error) `sage -sdist`.\n\nOK, I get it. I'm not convinced that the extra complication is justified for this use-case, but I'll fix it (but hopefully in a simpler way than your patch).",
    "created_at": "2013-12-30T11:42:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195006",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@ohanar](#comment:18):
> Replying to [@jdemeyer](#comment:17):
> > I don't think there is a regression to be fixed there. It's true that `python setup.py` is run indeed because of my patch, but why is that a problem?

> It requires that all of the sage libraries dependencies to already be built (otherwise it will bail). Before this branch, you could clone a sage repository, and without running `make`, you could run (without error) `sage -sdist`.

OK, I get it. I'm not convinced that the extra complication is justified for this use-case, but I'll fix it (but hopefully in a simpler way than your patch).



---

archive/issue_events_222116.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-30T11:42:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222116"
}
```



---

archive/issue_events_222117.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-30T11:42:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222117"
}
```



---

archive/issue_comments_195007.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI think this is sufficient\n\n```diff\ncommit 0255a2a53e9aebaf54c0fab335ef0202a6b77ae8\nAuthor: Jeroen Demeyer <jdemeyer@cage.ugent.be>\nDate:   Mon Dec 30 12:47:06 2013 +0100\n\n    Allow sage --sdist without building Sage\n\ndiff --git a/src/bin/sage-clone-source b/src/bin/sage-clone-source\nindex aabc452..090466b 100755\n--- a/src/bin/sage-clone-source\n+++ b/src/bin/sage-clone-source\n@@ -20,7 +20,7 @@ SRC=\"$1\"\n DST=\"$2\"\n \n rm -rf \"$DST\"\n-mkdir \"$DST\"\n+mkdir -p \"$DST\"\n \n git clone \"$SRC\" \"$DST\"\n \ndiff --git a/src/bin/sage-sdist b/src/bin/sage-sdist\nindex 3a554b6..1aee0cc 100755\n--- a/src/bin/sage-sdist\n+++ b/src/bin/sage-sdist\n@@ -46,7 +46,9 @@ sage-clone-source \"$SAGE_ROOT\" \"$TMP_DIR/$TARGET\"\n # Download and copy all upstream tarballs (the -B option to make forces\n # all targets to be built unconditionally)\n cd \"$SAGE_ROOT/build\"\n-SAGE_INSTALL_GCC=yes SAGE_SPKG_OPTS=\"-f -d\" SAGE_SPKG_COPY_UPSTREAM=\"$TMP_DIR/$TARGET/upstream\" ./install -B all\n+SAGE_INSTALL_GCC=yes SAGE_SPKG_COPY_UPSTREAM=\"$TMP_DIR/$TARGET/upstream\" \\\n+SAGE_INSTALL_FETCH_ONLY=yes SAGE_SPKG_OPTS=\"-f -d\" \\\n+./install -B all\n \n # Create source .tar.gz\n cd \"$TMP_DIR\"\n```",
    "created_at": "2013-12-30T11:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195007",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

I think this is sufficient

```diff
commit 0255a2a53e9aebaf54c0fab335ef0202a6b77ae8
Author: Jeroen Demeyer <jdemeyer@cage.ugent.be>
Date:   Mon Dec 30 12:47:06 2013 +0100

    Allow sage --sdist without building Sage

diff --git a/src/bin/sage-clone-source b/src/bin/sage-clone-source
index aabc452..090466b 100755
--- a/src/bin/sage-clone-source
+++ b/src/bin/sage-clone-source
@@ -20,7 +20,7 @@ SRC="$1"
 DST="$2"
 
 rm -rf "$DST"
-mkdir "$DST"
+mkdir -p "$DST"
 
 git clone "$SRC" "$DST"
 
diff --git a/src/bin/sage-sdist b/src/bin/sage-sdist
index 3a554b6..1aee0cc 100755
--- a/src/bin/sage-sdist
+++ b/src/bin/sage-sdist
@@ -46,7 +46,9 @@ sage-clone-source "$SAGE_ROOT" "$TMP_DIR/$TARGET"
 # Download and copy all upstream tarballs (the -B option to make forces
 # all targets to be built unconditionally)
 cd "$SAGE_ROOT/build"
-SAGE_INSTALL_GCC=yes SAGE_SPKG_OPTS="-f -d" SAGE_SPKG_COPY_UPSTREAM="$TMP_DIR/$TARGET/upstream" ./install -B all
+SAGE_INSTALL_GCC=yes SAGE_SPKG_COPY_UPSTREAM="$TMP_DIR/$TARGET/upstream" \
+SAGE_INSTALL_FETCH_ONLY=yes SAGE_SPKG_OPTS="-f -d" \
+./install -B all
 
 # Create source .tar.gz
 cd "$TMP_DIR"
```



---

archive/issue_comments_195008.json:
```json
{
    "body": "Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2013-12-30T13:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195008",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/ohanar/prereq](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/prereq)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_events_222118.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-30T13:57:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222118"
}
```



---

archive/issue_events_222119.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-30T13:57:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222119"
}
```



---

archive/issue_comments_195009.json:
```json
{
    "body": "Changed commit from **[43b696f](https://github.com/sagemath/sagetrac-mirror/commit/43b696f7f53f21e9a08f8a01a3fe0480e1c3a448)** to **[0255a2a](https://github.com/sagemath/sagetrac-mirror/commit/0255a2a53e9aebaf54c0fab335ef0202a6b77ae8)**",
    "created_at": "2013-12-30T13:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195009",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[43b696f](https://github.com/sagemath/sagetrac-mirror/commit/43b696f7f53f21e9a08f8a01a3fe0480e1c3a448)** to **[0255a2a](https://github.com/sagemath/sagetrac-mirror/commit/0255a2a53e9aebaf54c0fab335ef0202a6b77ae8)**



---

archive/issue_comments_195010.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0255a2a\">0255a2a</a></td><td><code>Allow sage --sdist without building Sage</code></td></tr></table>\n",
    "created_at": "2013-12-30T13:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195010",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0255a2a">0255a2a</a></td><td><code>Allow sage --sdist without building Sage</code></td></tr></table>




---

archive/issue_comments_195011.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nSure, this is fine.",
    "created_at": "2013-12-31T05:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195011",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:24" align="right">comment:24</div>

Sure, this is fine.



---

archive/issue_events_222120.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-12-31T05:44:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222120"
}
```



---

archive/issue_events_222121.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-12-31T05:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222121"
}
```



---

archive/issue_comments_195012.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nDoes this imply also a positive review to #15596 by transitivity?",
    "created_at": "2013-12-31T10:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195012",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Does this imply also a positive review to #15596 by transitivity?



---

archive/issue_comments_195013.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFails on mod:\n\n```\nconfigure.ac:21: error: Autoconf version 2.63 or higher is required\nconfigure.ac:21: the top level\nautom4te: /usr/bin/m4 failed with exit status: 63\naclocal: autom4te failed with exit status: 63\n```",
    "created_at": "2014-01-04T02:47:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195013",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

Fails on mod:

```
configure.ac:21: error: Autoconf version 2.63 or higher is required
configure.ac:21: the top level
autom4te: /usr/bin/m4 failed with exit status: 63
aclocal: autom4te failed with exit status: 63
```



---

archive/issue_comments_195014.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@vbraun](#comment:26):\n> Fails on mod:\n> \n> ```\n> configure.ac:21: error: Autoconf version 2.63 or higher is required\n> configure.ac:21: the top level\n> autom4te: /usr/bin/m4 failed with exit status: 63\n> aclocal: autom4te failed with exit status: 63\n> ```\n\nOf course it fails, installing from `git` now requires a recent enough version of autotools (this is true for many projects, it's not the fault of Sage).\n\nIf you're bothered by this, you could drop the `git` builder on `mod` and only build from the source tarball (which doesn't require autotools).",
    "created_at": "2014-01-04T10:22:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195014",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@vbraun](#comment:26):
> Fails on mod:
> 
> ```
> configure.ac:21: error: Autoconf version 2.63 or higher is required
> configure.ac:21: the top level
> autom4te: /usr/bin/m4 failed with exit status: 63
> aclocal: autom4te failed with exit status: 63
> ```

Of course it fails, installing from `git` now requires a recent enough version of autotools (this is true for many projects, it's not the fault of Sage).

If you're bothered by this, you could drop the `git` builder on `mod` and only build from the source tarball (which doesn't require autotools).



---

archive/issue_comments_195015.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nWhy does it say \"does not merge cleanly\"? It merges cleanly for me...",
    "created_at": "2014-01-04T12:01:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195015",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Why does it say "does not merge cleanly"? It merges cleanly for me...



---

archive/issue_comments_195016.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAndrew is working on the git plugin this week, so its possibly not accurate at the moment.\n\nDo we really need ac 2.63, which is only about 5 years old? 2.61 doesn't work? Also I don't see the new dependency being documented.\n\nIn any case, I think OSX users will be in a world of hurt if we merge this. I take it you are volunteering to walk them through autoconf installation? ;-)",
    "created_at": "2014-01-04T18:08:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195016",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>

Andrew is working on the git plugin this week, so its possibly not accurate at the moment.

Do we really need ac 2.63, which is only about 5 years old? 2.61 doesn't work? Also I don't see the new dependency being documented.

In any case, I think OSX users will be in a world of hurt if we merge this. I take it you are volunteering to walk them through autoconf installation? ;-)



---

archive/issue_comments_195017.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@jdemeyer](#comment:28):\n> Why does it say \"does not merge cleanly\"? It merges cleanly for me...\n\nThis particular merge confuses a lot of git tools since there is a new root in your branch. I should be rolling out the new plugin later today, but it won't fix this ticket (or this sort of issue). In the long run, these sorts of merge issues should disappear as all the old repositories get merged.",
    "created_at": "2014-01-04T21:56:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195017",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@jdemeyer](#comment:28):
> Why does it say "does not merge cleanly"? It merges cleanly for me...

This particular merge confuses a lot of git tools since there is a new root in your branch. I should be rolling out the new plugin later today, but it won't fix this ticket (or this sort of issue). In the long run, these sorts of merge issues should disappear as all the old repositories get merged.



---

archive/issue_comments_195018.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI discussed this with Andrew and we agreed to just package the autogenerated files into a tarball, and make it so that the \"make configure\" target automatically updates the tarball / checksum.ini. Objections?",
    "created_at": "2014-01-05T00:40:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195018",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

I discussed this with Andrew and we agreed to just package the autogenerated files into a tarball, and make it so that the "make configure" target automatically updates the tarball / checksum.ini. Objections?



---

archive/issue_comments_195019.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@vbraun](#comment:29):\n> Andrew is working on the git plugin this week, so its possibly not accurate at the moment.\n> \n> Do we really need ac 2.63, which is only about 5 years old? 2.61 doesn't work?\n\nProbably, but I can easily check to be sure.\n\n> Also I don't see the new dependency being documented.\n\nWell, building directly from the git repo isn't documented anywhere AFAIK, that would be the natural place to document the extra dependency.",
    "created_at": "2014-01-05T09:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195019",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@vbraun](#comment:29):
> Andrew is working on the git plugin this week, so its possibly not accurate at the moment.
> 
> Do we really need ac 2.63, which is only about 5 years old? 2.61 doesn't work?

Probably, but I can easily check to be sure.

> Also I don't see the new dependency being documented.

Well, building directly from the git repo isn't documented anywhere AFAIK, that would be the natural place to document the extra dependency.



---

archive/issue_comments_195020.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@vbraun](#comment:31):\n> I discussed this with Andrew and we agreed to just package the autogenerated files into a tarball. Objections?\n\nNo objections in principle. But this tarball should not be treated like other \"upstream\" tarballs. I prefer a direct call to `sage-download-file`, without going through `sage-spkg` and checksum checking.\n\nI think creating this tarball should be left to `sage --sdist`, I don't see the point of recreating it every time you run `autoconf`.",
    "created_at": "2014-01-05T09:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195020",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@vbraun](#comment:31):
> I discussed this with Andrew and we agreed to just package the autogenerated files into a tarball. Objections?

No objections in principle. But this tarball should not be treated like other "upstream" tarballs. I prefer a direct call to `sage-download-file`, without going through `sage-spkg` and checksum checking.

I think creating this tarball should be left to `sage --sdist`, I don't see the point of recreating it every time you run `autoconf`.



---

archive/issue_comments_195021.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI am working on this.",
    "created_at": "2014-01-05T10:12:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195021",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

I am working on this.



---

archive/issue_events_222122.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-05T10:12:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222122"
}
```



---

archive/issue_events_222123.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-05T10:12:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222123"
}
```



---

archive/issue_comments_195022.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nYou're right, `autoconf` version 2.60 does work (2.59 does not).",
    "created_at": "2014-01-05T10:31:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195022",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

You're right, `autoconf` version 2.60 does work (2.59 does not).



---

archive/issue_comments_195023.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jdemeyer](#comment:34):\n> I think creating this tarball should be left to `sage --sdist`, I don't see the point of recreating it every time you run `autoconf`.\n\nIf we want to treat that tarball like all other tarballs then we need to commit its checksum *before* running `sage -sdist`. Also, for testing it would be nice to run the new tarball through the buildbot before releasing it. Of course that can be worked around by running `sage -sdist` twice but then thats hardly ideal. \n\nAnd while one could treat it completely different from the other tarballs, I don't see why we have to give up checksumming here.",
    "created_at": "2014-01-05T18:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195023",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jdemeyer](#comment:34):
> I think creating this tarball should be left to `sage --sdist`, I don't see the point of recreating it every time you run `autoconf`.

If we want to treat that tarball like all other tarballs then we need to commit its checksum *before* running `sage -sdist`. Also, for testing it would be nice to run the new tarball through the buildbot before releasing it. Of course that can be worked around by running `sage -sdist` twice but then thats hardly ideal. 

And while one could treat it completely different from the other tarballs, I don't see why we have to give up checksumming here.



---

archive/issue_comments_195024.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@vbraun](#comment:37):\n> I don't see why we have to give up checksumming here.\n\nBecause checksumming is done is `sage-spkg` and this tarball wouldn't `sage-spkg`. And I would very much be against using `sage-spkg` for this, since it would be the upside-down world. Normally, `configure` is run as very first thing in a build and it might for example be used to configure `sage-spkg`. This currently isn't the case, but we should plan for it.",
    "created_at": "2014-01-05T18:36:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195024",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@vbraun](#comment:37):
> I don't see why we have to give up checksumming here.

Because checksumming is done is `sage-spkg` and this tarball wouldn't `sage-spkg`. And I would very much be against using `sage-spkg` for this, since it would be the upside-down world. Normally, `configure` is run as very first thing in a build and it might for example be used to configure `sage-spkg`. This currently isn't the case, but we should plan for it.



---

archive/issue_comments_195025.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nEither way you need a script somewhere that a) does not depend on configure output and b) downloads a tarball and run the `spkg-install` script. If we want to auto-generate the equivalent of a `sage-spkg` script then we can just give it a different name, no?",
    "created_at": "2014-01-05T19:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195025",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">comment:39</div>

Either way you need a script somewhere that a) does not depend on configure output and b) downloads a tarball and run the `spkg-install` script. If we want to auto-generate the equivalent of a `sage-spkg` script then we can just give it a different name, no?



---

archive/issue_comments_195026.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@vbraun](#comment:39):\n> Either way you need a script somewhere that a) does not depend on configure output and b) downloads a tarball and run the `spkg-install` script.\n\nI don't understand what you're saying here. We need a script that\n1. does not depend on configure output\n2. downloads a tarball\nbut that script does not need to\n1. check checksums\n2. run `spkg-install`\n\nI also really don't want to come up with an overkill solution for this. Personally, I'd be happy to simply say \"if you want to build from `git`, make sure you have autotools installed\". There's always the source tarball which doesn't require autotools and once you've built Sage, you could install the autotools package, or simply hope that an outdated `configure` script is still fine.",
    "created_at": "2014-01-05T19:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195026",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@vbraun](#comment:39):
> Either way you need a script somewhere that a) does not depend on configure output and b) downloads a tarball and run the `spkg-install` script.

I don't understand what you're saying here. We need a script that
1. does not depend on configure output
2. downloads a tarball
but that script does not need to
1. check checksums
2. run `spkg-install`

I also really don't want to come up with an overkill solution for this. Personally, I'd be happy to simply say "if you want to build from `git`, make sure you have autotools installed". There's always the source tarball which doesn't require autotools and once you've built Sage, you could install the autotools package, or simply hope that an outdated `configure` script is still fine.



---

archive/issue_comments_195027.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI also want to make it as easy as possible, this is why I'm suggesting to just treat it as every other tarball instead of a custom script just for that one.",
    "created_at": "2014-01-05T19:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195027",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:41" align="right">comment:41</div>

I also want to make it as easy as possible, this is why I'm suggesting to just treat it as every other tarball instead of a custom script just for that one.



---

archive/issue_comments_195028.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nAttachment: **[configure-6.1.beta2.tar.gz](https://github.com/sagemath/sage/files/ticket15580/configure-6.1.beta2.tar.gz)**\n\nVolker, are you able to put files in the `upstream` directory on the server? If so, please do that for [attachment: configure-6.1.beta2.tar.gz](https://github.com/sagemath/sage/files/ticket15580/configure-6.1.beta2.tar.gz.gz)",
    "created_at": "2014-01-05T21:37:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195028",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

Attachment: **[configure-6.1.beta2.tar.gz](https://github.com/sagemath/sage/files/ticket15580/configure-6.1.beta2.tar.gz)**

Volker, are you able to put files in the `upstream` directory on the server? If so, please do that for [attachment: configure-6.1.beta2.tar.gz](https://github.com/sagemath/sage/files/ticket15580/configure-6.1.beta2.tar.gz.gz)



---

archive/issue_comments_195029.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f\">19d5a15</a></td><td><code>Create and use \"configure\" tarball for auto-generated files</code></td></tr></table>\n",
    "created_at": "2014-01-05T21:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195029",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f">19d5a15</a></td><td><code>Create and use "configure" tarball for auto-generated files</code></td></tr></table>




---

archive/issue_comments_195030.json:
```json
{
    "body": "Changed commit from **[0255a2a](https://github.com/sagemath/sagetrac-mirror/commit/0255a2a53e9aebaf54c0fab335ef0202a6b77ae8)** to **[19d5a15](https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f)**",
    "created_at": "2014-01-05T21:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195030",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0255a2a](https://github.com/sagemath/sagetrac-mirror/commit/0255a2a53e9aebaf54c0fab335ef0202a6b77ae8)** to **[19d5a15](https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f)**



---

archive/issue_comments_195031.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThis is the simplest solution I could come up with which should work...\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f\">19d5a15</a></td><td><code>Create and use \"configure\" tarball for auto-generated files</code></td></tr></table>\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f\">19d5a15</a></td><td><code>Create and use \"configure\" tarball for auto-generated files</code></td></tr></table>\n",
    "created_at": "2014-01-05T21:43:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195031",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

This is the simplest solution I could come up with which should work...

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f">19d5a15</a></td><td><code>Create and use "configure" tarball for auto-generated files</code></td></tr></table>

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f">19d5a15</a></td><td><code>Create and use "configure" tarball for auto-generated files</code></td></tr></table>




---

archive/issue_events_222124.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-05T21:43:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222124"
}
```



---

archive/issue_events_222125.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-05T21:43:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222125"
}
```



---

archive/issue_comments_195032.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI don't like the fact that I can't test the updated tarball on the buildbot without bumping the version. This slows down the release process as I have to bump version and re-run the buildbot. For a release I just want to bump the version and publish it immediately afterward. Any other change can break things, so requres testing, ie. another day twiddling thumbs.",
    "created_at": "2014-01-06T04:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195032",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:46" align="right">comment:46</div>

I don't like the fact that I can't test the updated tarball on the buildbot without bumping the version. This slows down the release process as I have to bump version and re-run the buildbot. For a release I just want to bump the version and publish it immediately afterward. Any other change can break things, so requres testing, ie. another day twiddling thumbs.



---

archive/issue_comments_195033.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@vbraun](#comment:46):\n> I don't like the fact that I can't test the updated tarball on the buildbot without bumping the version. This slows down the release process as I have to bump version and re-run the buildbot.\n\nI thought you were using a private git repo for the buildbot? In that case, you could easily do the version bump only in your private repo. Alternatively, point `$SAGE_UPSTREAM` to a place you control.\n\nMy philosophy with the buildbot was to always test the **exact** source tarball that I would release. If you're testing first, then changing the version number, then `sdist`, something could go wrong in those last two steps and you would never notice.\n\nAnd yes, there has been at least one bug which dependended on the length of the Sage version number, so it can happen.",
    "created_at": "2014-01-06T08:24:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195033",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@vbraun](#comment:46):
> I don't like the fact that I can't test the updated tarball on the buildbot without bumping the version. This slows down the release process as I have to bump version and re-run the buildbot.

I thought you were using a private git repo for the buildbot? In that case, you could easily do the version bump only in your private repo. Alternatively, point `$SAGE_UPSTREAM` to a place you control.

My philosophy with the buildbot was to always test the **exact** source tarball that I would release. If you're testing first, then changing the version number, then `sdist`, something could go wrong in those last two steps and you would never notice.

And yes, there has been at least one bug which dependended on the length of the Sage version number, so it can happen.



---

archive/issue_comments_195034.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI'm not testing the source tarball at all, its much faster to do incremental builds for git commits with occasional full rebuilds.",
    "created_at": "2014-01-06T08:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195034",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

I'm not testing the source tarball at all, its much faster to do incremental builds for git commits with occasional full rebuilds.



---

archive/issue_comments_195035.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@vbraun](#comment:48):\n> its much faster to do incremental builds for git commits with occasional full rebuilds.\n\nEven then, I still don't understand why this patch prevents you from testing properly.",
    "created_at": "2014-01-06T08:34:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195035",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@vbraun](#comment:48):
> its much faster to do incremental builds for git commits with occasional full rebuilds.

Even then, I still don't understand why this patch prevents you from testing properly.



---

archive/issue_comments_195036.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nIt doesn't prevent me from testing, but it makes it slower and involves more steps than it should.",
    "created_at": "2014-01-06T08:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195036",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">comment:50</div>

It doesn't prevent me from testing, but it makes it slower and involves more steps than it should.



---

archive/issue_comments_195037.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@vbraun](#comment:50):\n> It doesn't prevent me from testing, but it makes it slower and involves more steps than it should.\n\nWhy slower? I don't understand the problem...",
    "created_at": "2014-01-06T08:44:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195037",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@vbraun](#comment:50):
> It doesn't prevent me from testing, but it makes it slower and involves more steps than it should.

Why slower? I don't understand the problem...



---

archive/issue_comments_195038.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nI want to have a workflow where I merge branches, test, and once it works slap on the new version and release. Bumping the version should not require another test run. Bumping the version just to make the new configure-x.y.z tarball and then resetting to before the version bump is also not desirable.",
    "created_at": "2014-01-06T08:52:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195038",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">comment:52</div>

I want to have a workflow where I merge branches, test, and once it works slap on the new version and release. Bumping the version should not require another test run. Bumping the version just to make the new configure-x.y.z tarball and then resetting to before the version bump is also not desirable.



---

archive/issue_comments_195039.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@vbraun](#comment:52):\n> I want to have a workflow where I merge branches, test, and once it works slap on the new version and release. Bumping the version should not require another test run. Bumping the version just to make the new configure-x.y.z tarball and then resetting to before the version bump is also not desirable. \n\nWhy not the following workflow:\n1. In volker's private repo, bump the version number and merge various patches\n2. Run `sage --sdist` to generate the configure tarball\n3. Put the configure tarball in some accessible place\n4. Run the buildbots on Volker's private repo\n5. If tests pass, merge Volker's repo with the official repo.\n\n(Ideally, I would argue there should also be a 4b. Run at least one buildbot on the source tarball instead of the git repo)\n\nWhat alternative would you propose? You need to generate the configure tarball anyway before you can test it, regardless of any version bumps...",
    "created_at": "2014-01-06T09:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195039",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@vbraun](#comment:52):
> I want to have a workflow where I merge branches, test, and once it works slap on the new version and release. Bumping the version should not require another test run. Bumping the version just to make the new configure-x.y.z tarball and then resetting to before the version bump is also not desirable. 

Why not the following workflow:
1. In volker's private repo, bump the version number and merge various patches
2. Run `sage --sdist` to generate the configure tarball
3. Put the configure tarball in some accessible place
4. Run the buildbots on Volker's private repo
5. If tests pass, merge Volker's repo with the official repo.

(Ideally, I would argue there should also be a 4b. Run at least one buildbot on the source tarball instead of the git repo)

What alternative would you propose? You need to generate the configure tarball anyway before you can test it, regardless of any version bumps...



---

archive/issue_comments_195040.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nSince we don't put the version into `AC_INIT` we don't have to bump the tarball at all with each version. Not doing anything is always the easiest and least error-prone.\n\nJust increment configure-n.tar, configure-(n+1).tar, ... each time you have to re-run autoconf (i.e. `make configure` / `autogen.sh`).",
    "created_at": "2014-01-06T09:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195040",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:54" align="right">comment:54</div>

Since we don't put the version into `AC_INIT` we don't have to bump the tarball at all with each version. Not doing anything is always the easiest and least error-prone.

Just increment configure-n.tar, configure-(n+1).tar, ... each time you have to re-run autoconf (i.e. `make configure` / `autogen.sh`).



---

archive/issue_comments_195041.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nAlso, I've been bumping the version in the source and tagging the new version at the same commit. IMHO having version and tag match is the easiest to understand for others. That requires me to bump the version at the end of the beta series.",
    "created_at": "2014-01-06T09:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195041",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:55" align="right">comment:55</div>

Also, I've been bumping the version in the source and tagging the new version at the same commit. IMHO having version and tag match is the easiest to understand for others. That requires me to bump the version at the end of the beta series.



---

archive/issue_comments_195042.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@vbraun](#comment:54):\n> we don't put the version into `AC_INIT`\n\nThat's \"fixed\" in #15606, but it's not really important anyway.\n\n> Not doing anything is always the easiest and least error-prone.\n\nI disagree. Doing the same thing every time (i.e. always changing the version number) is always the easiest and least error-prone. Special cases are often the cause for errors.\n\n> Just increment configure-n.tar, configure-(n+1).tar, ... each time you have to re-run autoconf (i.e. make configure / autogen.sh).\n\nAnd how are you going to implement this auto-incrementing and keeping track of which number to use... this seems far more complicated than my proposal.",
    "created_at": "2014-01-06T09:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195042",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@vbraun](#comment:54):
> we don't put the version into `AC_INIT`

That's "fixed" in #15606, but it's not really important anyway.

> Not doing anything is always the easiest and least error-prone.

I disagree. Doing the same thing every time (i.e. always changing the version number) is always the easiest and least error-prone. Special cases are often the cause for errors.

> Just increment configure-n.tar, configure-(n+1).tar, ... each time you have to re-run autoconf (i.e. make configure / autogen.sh).

And how are you going to implement this auto-incrementing and keeping track of which number to use... this seems far more complicated than my proposal.



---

archive/issue_comments_195043.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@vbraun](#comment:55):\n> Also, I've been bumping the version in the source and tagging the new version at the same commit. IMHO having version and tag match is the easiest to understand for others. That requires me to bump the version at the end of the beta series.\n\nOne could argue that the new version \"starts\" right after the old tag. The first commit after sage-6.1.beta4 belongs to sage-6.1.beta5, so I would find it logical that checking out that commit would give the new version number.",
    "created_at": "2014-01-06T09:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195043",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@vbraun](#comment:55):
> Also, I've been bumping the version in the source and tagging the new version at the same commit. IMHO having version and tag match is the easiest to understand for others. That requires me to bump the version at the end of the beta series.

One could argue that the new version "starts" right after the old tag. The first commit after sage-6.1.beta4 belongs to sage-6.1.beta5, so I would find it logical that checking out that commit would give the new version number.



---

archive/issue_comments_195044.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nOn can certainly argue for other ways of labeling things. In the end, doing it this way is one step vs. two separate steps, so its easier for me.\n\nReplying to [@jdemeyer](#comment:56):\n> And how are you going to implement this auto-incrementing and keeping track of which number to use..\n\nEasy, there will be a `build/pkgs/configure/package-version.txt` that contains the integer `n`. Reading it and incrementing it by one is standard bash `$[n+1]`",
    "created_at": "2014-01-06T09:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195044",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:58" align="right">comment:58</div>

On can certainly argue for other ways of labeling things. In the end, doing it this way is one step vs. two separate steps, so its easier for me.

Replying to [@jdemeyer](#comment:56):
> And how are you going to implement this auto-incrementing and keeping track of which number to use..

Easy, there will be a `build/pkgs/configure/package-version.txt` that contains the integer `n`. Reading it and incrementing it by one is standard bash `$[n+1]`



---

archive/issue_comments_195045.json:
```json
{
    "body": "Changed commit from **[19d5a15](https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f)** to **[5d7729c](https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f)**",
    "created_at": "2014-01-06T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[19d5a15](https://github.com/sagemath/sagetrac-mirror/commit/19d5a15ba83c7861237be766420541bb783ec34f)** to **[5d7729c](https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f)**



---

archive/issue_comments_195046.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f\">5d7729c</a></td><td><code>Use build/pkgs/configure/package-version.txt for configure version number</code></td></tr></table>\n",
    "created_at": "2014-01-06T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195046",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f">5d7729c</a></td><td><code>Use build/pkgs/configure/package-version.txt for configure version number</code></td></tr></table>




---

archive/issue_comments_195047.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nDo you like this better?",
    "created_at": "2014-01-06T10:17:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195047",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

Do you like this better?



---

archive/issue_comments_195048.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nLooks good. Is there an argument against automatically increasing the version number whenever you re-run autoconf? Skipping configure-$version numbers costs us nothing, but forgetting to increase it will potentially cause major problems. \n\nAlso, filling out the other files (e.g. checksums.ini) in the `build/pkgs/configure` files will make it easier to manage the upstream directory on the sagemath web server in a unified manner.",
    "created_at": "2014-01-06T22:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195048",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:61" align="right">comment:61</div>

Looks good. Is there an argument against automatically increasing the version number whenever you re-run autoconf? Skipping configure-$version numbers costs us nothing, but forgetting to increase it will potentially cause major problems. 

Also, filling out the other files (e.g. checksums.ini) in the `build/pkgs/configure` files will make it easier to manage the upstream directory on the sagemath web server in a unified manner.



---

archive/issue_comments_195049.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nReplying to [@vbraun](#comment:61):\n> Looks good. Is there an argument against automatically increasing the version number whenever you re-run autoconf? Skipping configure-$version numbers costs us nothing, but forgetting to increase it will potentially cause major problems.\n\nWould you agree with increasing the version number automatically in `sage-update-version`?",
    "created_at": "2014-01-07T07:40:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195049",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

Replying to [@vbraun](#comment:61):
> Looks good. Is there an argument against automatically increasing the version number whenever you re-run autoconf? Skipping configure-$version numbers costs us nothing, but forgetting to increase it will potentially cause major problems.

Would you agree with increasing the version number automatically in `sage-update-version`?



---

archive/issue_comments_195050.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nMy main question is whether we are going to hardcode the current version into the autogenerated scripts or not (see #15606). If that is the case then we of course should save the new autogenerated stuff in `sage-update-version`. If not then there would be no need to tie version to the autogenerated scripts, so we should not.",
    "created_at": "2014-01-07T07:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195050",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:63" align="right">comment:63</div>

My main question is whether we are going to hardcode the current version into the autogenerated scripts or not (see #15606). If that is the case then we of course should save the new autogenerated stuff in `sage-update-version`. If not then there would be no need to tie version to the autogenerated scripts, so we should not.



---

archive/issue_comments_195051.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nReplying to [@vbraun](#comment:63):\n> My main question is whether we are going to hardcode the current version into the autogenerated scripts or not (see #15606).\n\nI propose to do so indeed.",
    "created_at": "2014-01-07T08:43:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195051",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:64" align="right">comment:64</div>

Replying to [@vbraun](#comment:63):
> My main question is whether we are going to hardcode the current version into the autogenerated scripts or not (see #15606).

I propose to do so indeed.



---

archive/issue_comments_195052.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nOk, fine. Thats imho the right thing to do, keep the version in configure.ac and then generate all other files that contain the version form .in files at configure time.\n\nI'd still prefer to not use the Sage version as the configure tarball version since it'll be potentially confusing to test different configure tarballs on the buildbot if it needs to be debugged.",
    "created_at": "2014-01-07T09:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195052",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:65" align="right">comment:65</div>

Ok, fine. Thats imho the right thing to do, keep the version in configure.ac and then generate all other files that contain the version form .in files at configure time.

I'd still prefer to not use the Sage version as the configure tarball version since it'll be potentially confusing to test different configure tarballs on the buildbot if it needs to be debugged.



---

archive/issue_comments_195053.json:
```json
{
    "body": "<div id=\"comment:66\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd\">e13b216</a></td><td><code>Create sage-autogen script to generate configure tarball</code></td></tr></table>\n",
    "created_at": "2014-01-07T11:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195053",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:66"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd">e13b216</a></td><td><code>Create sage-autogen script to generate configure tarball</code></td></tr></table>




---

archive/issue_comments_195054.json:
```json
{
    "body": "Changed commit from **[5d7729c](https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f)** to **[e13b216](https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd)**",
    "created_at": "2014-01-07T11:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195054",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5d7729c](https://github.com/sagemath/sagetrac-mirror/commit/5d7729c51042f87a125e76b3e2819e564d2d562f)** to **[e13b216](https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd)**



---

archive/issue_comments_195055.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nOK, new approach. I now have a script `src/bin/sage-autogen` which takes care of creating the configure tarball and computing the checksum. It can optionally (with the `-i` option) increase the version number. This script is never run automatically, it must be explicitly called by the release manager. But then the release manager can freely choose when to do this.",
    "created_at": "2014-01-07T11:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195055",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:67" align="right">comment:67</div>

OK, new approach. I now have a script `src/bin/sage-autogen` which takes care of creating the configure tarball and computing the checksum. It can optionally (with the `-i` option) increase the version number. This script is never run automatically, it must be explicitly called by the release manager. But then the release manager can freely choose when to do this.



---

archive/issue_comments_195056.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@vbraun](#comment:48):\n> I'm not testing the source tarball at all\n\nI think that's a mistake. If something breaks `sage-sdist`, you need to know.",
    "created_at": "2014-01-08T15:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195056",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@vbraun](#comment:48):
> I'm not testing the source tarball at all

I think that's a mistake. If something breaks `sage-sdist`, you need to know.



---

archive/issue_comments_195057.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nAt the end of the day, the git repo is the authorative download. The source tarball is added as a convenience, but I don't think there is a point in worrying too much about it.",
    "created_at": "2014-01-11T22:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195057",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:69" align="right">comment:69</div>

At the end of the day, the git repo is the authorative download. The source tarball is added as a convenience, but I don't think there is a point in worrying too much about it.



---

archive/issue_comments_195058.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nGnu recommends `./bootstrap` (http://www.gnu.org/software/automake/faq/autotools-faq.html#What-does-_002e_002fbootstrap-or-_002e_002fautogen_002esh-do_003f} instead of autogen.\n\nAlso, the new configure tarball needs to be committed together with the version number change (and should eventually **become** the version number change) to end up with the correct tag.\n\nI'll implement these changes...",
    "created_at": "2014-01-12T02:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195058",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:70" align="right">comment:70</div>

Gnu recommends `./bootstrap` (http://www.gnu.org/software/automake/faq/autotools-faq.html#What-does-_002e_002fbootstrap-or-_002e_002fautogen_002esh-do_003f} instead of autogen.

Also, the new configure tarball needs to be committed together with the version number change (and should eventually **become** the version number change) to end up with the correct tag.

I'll implement these changes...



---

archive/issue_comments_195059.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**",
    "created_at": "2014-01-12T03:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195059",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**



---

archive/issue_comments_195060.json:
```json
{
    "body": "Changed commit from **[e13b216](https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd)** to **[1c57e53](https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3)**",
    "created_at": "2014-01-12T03:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195060",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[e13b216](https://github.com/sagemath/sagetrac-mirror/commit/e13b216c61977b1d9ae262791bb5bdaf392033cd)** to **[1c57e53](https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3)**



---

archive/issue_comments_195061.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nI agree with everything so far, only my final commits need review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/900212e60c9af760af4578343b759821a49d9d26\">900212e</a></td><td><code>rename to bootstrap, run during version bump</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56adaa62ad4e6a6a5d704e43ccf9a3269912c147\">56adaa6</a></td><td><code>add a SPKG.txt file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3\">1c57e53</a></td><td><code>also commit changes to confball in sage-update-version</code></td></tr></table>\n",
    "created_at": "2014-01-12T03:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195061",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:72" align="right">comment:72</div>

I agree with everything so far, only my final commits need review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/900212e60c9af760af4578343b759821a49d9d26">900212e</a></td><td><code>rename to bootstrap, run during version bump</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56adaa62ad4e6a6a5d704e43ccf9a3269912c147">56adaa6</a></td><td><code>add a SPKG.txt file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3">1c57e53</a></td><td><code>also commit changes to confball in sage-update-version</code></td></tr></table>




---

archive/issue_comments_195062.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nIn `SPKG.txt`, *They are shippd* [sic] *with* is not a sentence.",
    "created_at": "2014-01-12T06:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195062",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:73" align="right">comment:73</div>

In `SPKG.txt`, *They are shippd* [sic] *with* is not a sentence.



---

archive/issue_events_222126.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-12T06:46:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222126"
}
```



---

archive/issue_events_222127.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-12T06:46:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222127"
}
```



---

archive/issue_comments_195063.json:
```json
{
    "body": "Changed commit from **[1c57e53](https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3)** to **[cdc7c0a](https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a)**",
    "created_at": "2014-01-12T16:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195063",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1c57e53](https://github.com/sagemath/sagetrac-mirror/commit/1c57e53f536db2f505b447ee6f617682372550d3)** to **[cdc7c0a](https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a)**



---

archive/issue_comments_195064.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d17bda99ff9da74429188d09c0fd7d42c930d9a\">5d17bda</a></td><td><code>fix typos in SPKG.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a\">cdc7c0a</a></td><td><code>make saving of the confball optional in bootstrap</code></td></tr></table>\n",
    "created_at": "2014-01-12T16:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195064",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d17bda99ff9da74429188d09c0fd7d42c930d9a">5d17bda</a></td><td><code>fix typos in SPKG.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a">cdc7c0a</a></td><td><code>make saving of the confball optional in bootstrap</code></td></tr></table>




---

archive/issue_comments_195065.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nVolker: I'm fine with your patch, modulo a few details in my reviewer commit.",
    "created_at": "2014-01-12T19:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195065",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:75" align="right">comment:75</div>

Volker: I'm fine with your patch, modulo a few details in my reviewer commit.



---

archive/issue_events_222128.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-12T19:45:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222128"
}
```



---

archive/issue_events_222129.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-12T19:45:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222129"
}
```



---

archive/issue_comments_195066.json:
```json
{
    "body": "Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2014-01-12T19:45:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195066",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_comments_195067.json:
```json
{
    "body": "Changed commit from **[cdc7c0a](https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a)** to **[d042722](https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a)**",
    "created_at": "2014-01-12T19:45:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195067",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[cdc7c0a](https://github.com/sagemath/sagetrac-mirror/commit/cdc7c0a332ae31e61c6bf92a6e09e6dd7c4b8e1a)** to **[d042722](https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a)**



---

archive/issue_comments_195068.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a\">d042722</a></td><td><code>bootstrap configure: small fixes</code></td></tr></table>\n",
    "created_at": "2014-01-12T19:45:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195068",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:77"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a">d042722</a></td><td><code>bootstrap configure: small fixes</code></td></tr></table>




---

archive/issue_comments_195069.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nReplying to [@vbraun](#comment:69):\n> At the end of the day, the git repo is the authorative download. The source tarball is added as a convenience\n\nGiven that the [Sage home page](http://www.sagemath.org/) only has links to the source and binary tarballs, I'd say the opposite is true.\n\n> but I don't think there is a point in worrying too much about it.\n\nPerhaps not, but this ticket could certainly break sdists. So if you don't want automated testing, you should at least try building from an sdist generated after this ticket.",
    "created_at": "2014-01-13T09:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195069",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:78" align="right">comment:78</div>

Replying to [@vbraun](#comment:69):
> At the end of the day, the git repo is the authorative download. The source tarball is added as a convenience

Given that the [Sage home page](http://www.sagemath.org/) only has links to the source and binary tarballs, I'd say the opposite is true.

> but I don't think there is a point in worrying too much about it.

Perhaps not, but this ticket could certainly break sdists. So if you don't want automated testing, you should at least try building from an sdist generated after this ticket.



---

archive/issue_comments_195070.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nBreaks incremental builds on mod:\n\n```\nconfigure:2803: $? = 1\nconfigure:2826: checking for C compiler default output file name\nconfigure:2853: gcc   -I/mnt/SSD1/mod_buildslave/sage_git/build/local/include  -L/mnt/SSD1/mod_buildslave/sage_git/build/local/lib conftest.c  >&5\n/mnt/SSD1/mod_buildslave/sage_git/build/local/libexec/gcc/x86_64-unknown-linux-gnu/4.7.3/cc1: error while loading shared libraries: libmpc.so.3: cannot open shared object file: No such file or directory\nconfigure:2856: $? = 1\nconfigure:2894: result: \nconfigure: failed program was:\n| /* confdefs.h.  */\n| #define PACKAGE_NAME \"Sage\"\n| #define PACKAGE_TARNAME \"sage\"\n| #define PACKAGE_VERSION \"x.y.z\"\n| #define PACKAGE_STRING \"Sage x.y.z\"\n| #define PACKAGE_BUGREPORT \"sage-devel@googlegroups.com\"\n| #define PACKAGE \"sage\"\n| #define VERSION \"x.y.z\"\n| /* end confdefs.h.  */\n| \n| int\n| main ()\n| {\n| \n|   ;\n|   return 0;\n| }\nconfigure:2901: error: C compiler cannot create executables\nSee `config.log' for more details\n```\nWhy does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...",
    "created_at": "2014-01-14T05:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195070",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:79" align="right">comment:79</div>

Breaks incremental builds on mod:

```
configure:2803: $? = 1
configure:2826: checking for C compiler default output file name
configure:2853: gcc   -I/mnt/SSD1/mod_buildslave/sage_git/build/local/include  -L/mnt/SSD1/mod_buildslave/sage_git/build/local/lib conftest.c  >&5
/mnt/SSD1/mod_buildslave/sage_git/build/local/libexec/gcc/x86_64-unknown-linux-gnu/4.7.3/cc1: error while loading shared libraries: libmpc.so.3: cannot open shared object file: No such file or directory
configure:2856: $? = 1
configure:2894: result: 
configure: failed program was:
| /* confdefs.h.  */
| #define PACKAGE_NAME "Sage"
| #define PACKAGE_TARNAME "sage"
| #define PACKAGE_VERSION "x.y.z"
| #define PACKAGE_STRING "Sage x.y.z"
| #define PACKAGE_BUGREPORT "sage-devel@googlegroups.com"
| #define PACKAGE "sage"
| #define VERSION "x.y.z"
| /* end confdefs.h.  */
| 
| int
| main ()
| {
| 
|   ;
|   return 0;
| }
configure:2901: error: C compiler cannot create executables
See `config.log' for more details
```
Why does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...



---

archive/issue_comments_195071.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nBtw the \"See `config.log' for more details\" is kind of impractical. It would be nice if the config.log would be inserted into the prereq.log file, especially if something goes wrong.",
    "created_at": "2014-01-14T05:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195071",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:80" align="right">comment:80</div>

Btw the "See `config.log' for more details" is kind of impractical. It would be nice if the config.log would be inserted into the prereq.log file, especially if something goes wrong.



---

archive/issue_comments_195072.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nFull rebuild works on mod, for the record.",
    "created_at": "2014-01-14T05:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195072",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:81" align="right">comment:81</div>

Full rebuild works on mod, for the record.



---

archive/issue_comments_195073.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@vbraun](#comment:79):\n> Why does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...\n\nCould it be a bug in your build scripts?\n\nIn any case, if the full build works, I wouldn't worry too much...",
    "created_at": "2014-01-14T07:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195073",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@vbraun](#comment:79):
> Why does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...

Could it be a bug in your build scripts?

In any case, if the full build works, I wouldn't worry too much...



---

archive/issue_comments_195074.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nReplying to [@vbraun](#comment:80):\n> Btw the \"See `config.log' for more details\" is kind of impractical. It would be nice if the config.log would be inserted into the prereq.log file, especially if something goes wrong.\n\nOK, I'll have a look at that in #15606.",
    "created_at": "2014-01-14T07:59:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195074",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:83" align="right">comment:83</div>

Replying to [@vbraun](#comment:80):
> Btw the "See `config.log' for more details" is kind of impractical. It would be nice if the config.log would be inserted into the prereq.log file, especially if something goes wrong.

OK, I'll have a look at that in #15606.



---

archive/issue_comments_195075.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nReplying to [@vbraun](#comment:79):\n> Why does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...\n\nIt seems you discovered a very old bug. `build/install` adds `SAGE_LOCAL/bin` to the `PATH`, but doesn't change `LD_LIBRARY_PATH`.",
    "created_at": "2014-01-14T09:07:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195075",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">comment:84</div>

Replying to [@vbraun](#comment:79):
> Why does it even know about the `$SAGE_LOCAL` paths? The part should also set up `LD_LIBRARY_PATH`...

It seems you discovered a very old bug. `build/install` adds `SAGE_LOCAL/bin` to the `PATH`, but doesn't change `LD_LIBRARY_PATH`.



---

archive/issue_comments_195076.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nThe reason that the bug hasn't been seen before is that `configure` was never re-run after upgrading.",
    "created_at": "2014-01-14T10:15:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195076",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:85" align="right">comment:85</div>

The reason that the bug hasn't been seen before is that `configure` was never re-run after upgrading.



---

archive/issue_comments_195077.json:
```json
{
    "body": "<div id=\"comment:86\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440\">e03f296</a></td><td><code>Source sage-env inside configure</code></td></tr></table>\n",
    "created_at": "2014-01-14T11:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195077",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:86"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440">e03f296</a></td><td><code>Source sage-env inside configure</code></td></tr></table>




---

archive/issue_comments_195078.json:
```json
{
    "body": "Changed commit from **[d042722](https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a)** to **[e03f296](https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440)**",
    "created_at": "2014-01-14T11:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195078",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d042722](https://github.com/sagemath/sagetrac-mirror/commit/d0427228339f59811fc41d0ecb861d7e5e64a99a)** to **[e03f296](https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440)**



---

archive/issue_comments_195079.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nMirror directory layout is `SAGE_UPSTREAM/configure/configure-n.tar.gz`, for the record",
    "created_at": "2014-01-14T16:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195079",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:87" align="right">comment:87</div>

Mirror directory layout is `SAGE_UPSTREAM/configure/configure-n.tar.gz`, for the record



---

archive/issue_comments_195080.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**",
    "created_at": "2014-01-14T16:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195080",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**



---

archive/issue_comments_195081.json:
```json
{
    "body": "Changed commit from **[e03f296](https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440)** to **[3e5dfa5](https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b)**",
    "created_at": "2014-01-14T16:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195081",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[e03f296](https://github.com/sagemath/sagetrac-mirror/commit/e03f296685f986f89e1e12974f4c5ead9a9ff440)** to **[3e5dfa5](https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b)**



---

archive/issue_comments_195082.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nStill fails on mark/skynet:\n\n```\nmake[1]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'\nmake[1]: warning: -jN forced in submake: disabling jobserver mode.\nmake[1]: Warning: File `Makefile' has modification time 6.4e+02 s in the future\nmake -j2 base\nmake[2]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'\nmake[2]: warning: -jN forced in submake: disabling jobserver mode.\nmake[2]: Warning: File `Makefile' has modification time 6.4e+02 s in the future\n/home/buildbot/build/sage/mark-1/sage_git/build/build/pipestatus \"./prereq.sh 2>&1\" \"tee -a /home/buildbot/build/sage/mark-1/sage_git/build/logs/pkgs/prereq.log\"\nStarting prerequisite check.\nMachine: SunOS mark 5.10 Generic_127111-01 sun4u sparc SUNW,Sun-Blade-2500\n\nmake[3]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build'\nmake[3]: warning: -jN forced in submake: disabling jobserver mode.\nmake[3]: Warning: File `Makefile' has modification time 5.5e+02 s in the future\ntest -f config/missing || make -j2 config/missing || \\\n\t\tbash -c 'source src/bin/sage-env; sage-download-file $SAGE_UPSTREAM/configure/configure-`cat build/pkgs/configure/package-version.txt`.tar.gz | tar zxf -'\nconfig/missing --run aclocal -I m4\nconfig/missing: aclocal: not found\nmake[3]: *** [configure] Error 1\nmake[3]: warning:  Clock skew detected.  Your build may be incomplete.\nmake[3]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build'\nmake[2]: *** [/home/buildbot/build/sage/mark-1/sage_git/build/local/var/lib/sage/installed/prereq] Error 2\nmake[2]: Target `base' not remade because of errors.\nmake[2]: warning:  Clock skew detected.  Your build may be incomplete.\nmake[2]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'\nmake[1]: *** [all] Error 2\nmake[1]: warning:  Clock skew detected.  Your build may be incomplete.\nmake[1]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b\">3e5dfa5</a></td><td><code>fix tarball url</code></td></tr></table>\n",
    "created_at": "2014-01-14T16:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195082",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:89" align="right">comment:89</div>

Still fails on mark/skynet:

```
make[1]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'
make[1]: warning: -jN forced in submake: disabling jobserver mode.
make[1]: Warning: File `Makefile' has modification time 6.4e+02 s in the future
make -j2 base
make[2]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'
make[2]: warning: -jN forced in submake: disabling jobserver mode.
make[2]: Warning: File `Makefile' has modification time 6.4e+02 s in the future
/home/buildbot/build/sage/mark-1/sage_git/build/build/pipestatus "./prereq.sh 2>&1" "tee -a /home/buildbot/build/sage/mark-1/sage_git/build/logs/pkgs/prereq.log"
Starting prerequisite check.
Machine: SunOS mark 5.10 Generic_127111-01 sun4u sparc SUNW,Sun-Blade-2500

make[3]: Entering directory `/home/buildbot/build/sage/mark-1/sage_git/build'
make[3]: warning: -jN forced in submake: disabling jobserver mode.
make[3]: Warning: File `Makefile' has modification time 5.5e+02 s in the future
test -f config/missing || make -j2 config/missing || \
		bash -c 'source src/bin/sage-env; sage-download-file $SAGE_UPSTREAM/configure/configure-`cat build/pkgs/configure/package-version.txt`.tar.gz | tar zxf -'
config/missing --run aclocal -I m4
config/missing: aclocal: not found
make[3]: *** [configure] Error 1
make[3]: warning:  Clock skew detected.  Your build may be incomplete.
make[3]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build'
make[2]: *** [/home/buildbot/build/sage/mark-1/sage_git/build/local/var/lib/sage/installed/prereq] Error 2
make[2]: Target `base' not remade because of errors.
make[2]: warning:  Clock skew detected.  Your build may be incomplete.
make[2]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'
make[1]: *** [all] Error 2
make[1]: warning:  Clock skew detected.  Your build may be incomplete.
make[1]: Leaving directory `/home/buildbot/build/sage/mark-1/sage_git/build/build'
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b">3e5dfa5</a></td><td><code>fix tarball url</code></td></tr></table>




---

archive/issue_comments_195083.json:
```json
{
    "body": "Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2014-01-14T21:02:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195083",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_comments_195084.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nNot tested, but I guess this should help.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54\">e1df3ce</a></td><td><code>Run \"missing\" using bash</code></td></tr></table>\n",
    "created_at": "2014-01-14T21:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195084",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:91" align="right">comment:91</div>

Not tested, but I guess this should help.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54">e1df3ce</a></td><td><code>Run "missing" using bash</code></td></tr></table>




---

archive/issue_comments_195085.json:
```json
{
    "body": "Changed commit from **[3e5dfa5](https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b)** to **[e1df3ce](https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54)**",
    "created_at": "2014-01-14T21:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195085",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[3e5dfa5](https://github.com/sagemath/sagetrac-mirror/commit/3e5dfa5f0623f015faf6a81d96dbf3aaaa7f712b)** to **[e1df3ce](https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54)**



---

archive/issue_comments_195086.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nHow is that supposed to change anything? The `aclocal.m4' is not in the confball, so you need aclocal to generate it. The job of the \"missing\" script is to mangle the timestamps as if aclocal has run, but you still need the file whose timestamp is to be changed.",
    "created_at": "2014-01-15T03:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195086",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:92" align="right">comment:92</div>

How is that supposed to change anything? The `aclocal.m4' is not in the confball, so you need aclocal to generate it. The job of the "missing" script is to mangle the timestamps as if aclocal has run, but you still need the file whose timestamp is to be changed.



---

archive/issue_comments_195087.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nPS: What running with bash does give you is the proper warning before it errors out:\n\n```\nWARNING: 'aclocal' is missing on your system.\n         You should only need it if you modified 'acinclude.m4' or\n         'configure.ac' or m4 files included by 'configure.ac'.\n         The 'aclocal' program is part of the GNU Automake package:\n         <http://www.gnu.org/software/automake>\n         It also requires GNU Autoconf, GNU m4 and Perl in order to run:\n         <http://www.gnu.org/software/autoconf>\n         <http://www.gnu.org/software/m4/>\n         <http://www.perl.org/>\nmake[3]: *** [configure] Error 127\n```",
    "created_at": "2014-01-15T03:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195087",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:93" align="right">comment:93</div>

PS: What running with bash does give you is the proper warning before it errors out:

```
WARNING: 'aclocal' is missing on your system.
         You should only need it if you modified 'acinclude.m4' or
         'configure.ac' or m4 files included by 'configure.ac'.
         The 'aclocal' program is part of the GNU Automake package:
         <http://www.gnu.org/software/automake>
         It also requires GNU Autoconf, GNU m4 and Perl in order to run:
         <http://www.gnu.org/software/autoconf>
         <http://www.gnu.org/software/m4/>
         <http://www.perl.org/>
make[3]: *** [configure] Error 127
```



---

archive/issue_comments_195088.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nPPS: any thoughts on enabling `AM_MAINTAINER_MODE`?",
    "created_at": "2014-01-15T03:29:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195088",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:94" align="right">comment:94</div>

PPS: any thoughts on enabling `AM_MAINTAINER_MODE`?



---

archive/issue_comments_195089.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**",
    "created_at": "2014-01-15T05:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195089",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)** to **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)**



---

archive/issue_comments_195090.json:
```json
{
    "body": "Changed commit from **[e1df3ce](https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54)** to **[9c13193](https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded)**",
    "created_at": "2014-01-15T05:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195090",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[e1df3ce](https://github.com/sagemath/sagetrac-mirror/commit/e1df3ce1e4a7004cc9ca0aef6008c9edde6c6e54)** to **[9c13193](https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded)**



---

archive/issue_comments_195091.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nI guess disabling maintainer mode is only interesting when you actually run the automake-generated makefile. But we probably should, then. I'll put it in for now.\n\nIn any case, we should only run autotools from the bootstrap script. As long as we don't use the automake output there are no timestamp issues.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a38f91911ace2a7dcd0cc49e77c31c3a25e0889d\">a38f919</a></td><td><code>allow disabling of maintainer mode</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded\">9c13193</a></td><td><code>only run autotools from the bootstrap script</code></td></tr></table>\n",
    "created_at": "2014-01-15T05:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195091",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:96" align="right">comment:96</div>

I guess disabling maintainer mode is only interesting when you actually run the automake-generated makefile. But we probably should, then. I'll put it in for now.

In any case, we should only run autotools from the bootstrap script. As long as we don't use the automake output there are no timestamp issues.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a38f91911ace2a7dcd0cc49e77c31c3a25e0889d">a38f919</a></td><td><code>allow disabling of maintainer mode</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded">9c13193</a></td><td><code>only run autotools from the bootstrap script</code></td></tr></table>




---

archive/issue_comments_195092.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nI disagree with `./sage -f configure` since I absolutely don't want `configure` to act like a spkg. I prefer `configure` to have as few dependencies as possible. I much prefer to not depend on `sage-spkg` (and preferably also not on `build/install` nor `sage-env`, but that's harder for now).\n\nAlso, what was wrong with bootstrapping from the top-level `Makefile`? Doesn't the `missing` script work properly? I like the fact that `configure` gets regenerated automatically when I edit `configure.ac`.",
    "created_at": "2014-01-15T07:38:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195092",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:97" align="right">comment:97</div>

I disagree with `./sage -f configure` since I absolutely don't want `configure` to act like a spkg. I prefer `configure` to have as few dependencies as possible. I much prefer to not depend on `sage-spkg` (and preferably also not on `build/install` nor `sage-env`, but that's harder for now).

Also, what was wrong with bootstrapping from the top-level `Makefile`? Doesn't the `missing` script work properly? I like the fact that `configure` gets regenerated automatically when I edit `configure.ac`.



---

archive/issue_comments_195093.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@vbraun](#comment:92):\n> How is that supposed to change anything? The `aclocal.m4' is not in the confball, so you need aclocal to generate it.\n\nOK, I forgot to add that file, no big deal.",
    "created_at": "2014-01-15T07:52:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195093",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@vbraun](#comment:92):
> How is that supposed to change anything? The `aclocal.m4' is not in the confball, so you need aclocal to generate it.

OK, I forgot to add that file, no big deal.



---

archive/issue_comments_195094.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nHmm, it seems that `missing` has changed functionality. Now it doesn't really do anything, except for printing a more verbose error message. Old versions of `missing` did indeed touch the files.",
    "created_at": "2014-01-15T08:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195094",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:99" align="right">comment:99</div>

Hmm, it seems that `missing` has changed functionality. Now it doesn't really do anything, except for printing a more verbose error message. Old versions of `missing` did indeed touch the files.



---

archive/issue_comments_195095.json:
```json
{
    "body": "Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**",
    "created_at": "2014-01-15T12:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195095",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/vbraun/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/ticket/15580)** to **[u/jdemeyer/ticket/15580](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15580)**



---

archive/issue_comments_195096.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nVolker, this patch simply stops using the `missing` script while keeping the rest of the bootstrap process.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f\">2e27abb</a></td><td><code>Don't use \"missing\"</code></td></tr></table>\n",
    "created_at": "2014-01-15T13:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195096",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

Volker, this patch simply stops using the `missing` script while keeping the rest of the bootstrap process.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f">2e27abb</a></td><td><code>Don't use "missing"</code></td></tr></table>




---

archive/issue_comments_195097.json:
```json
{
    "body": "Changed commit from **[9c13193](https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded)** to **[2e27abb](https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f)**",
    "created_at": "2014-01-15T13:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195097",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[9c13193](https://github.com/sagemath/sagetrac-mirror/commit/9c13193d2fedb3d4d20ddb1aacd44d5c3e333ded)** to **[2e27abb](https://github.com/sagemath/sagetrac-mirror/commit/2e27abb8a34a779d5c7cf755450bc273abea443f)**



---

archive/issue_comments_195098.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nbootstrap shouldn't call make to do its business, usually it would run automake to generate the makefile. But we can also disentangle that later if you prefer.\n\nAFAIK we do guarantee that \"sage -f\" works even before building Sage, so that you can install replacements for certain optional build-time dependencies (e.g. ccache). Not using that mechanism means that \"make download\" won't work, for example. Not to mention that it duplicates the sagemath upstream url, doesn't verify the checksum, etc. I don't necessarily care so much about using it, just wanted to make sure that you thought about the potential downsides of downloading the confball manually.",
    "created_at": "2014-01-15T14:37:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195098",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

bootstrap shouldn't call make to do its business, usually it would run automake to generate the makefile. But we can also disentangle that later if you prefer.

AFAIK we do guarantee that "sage -f" works even before building Sage, so that you can install replacements for certain optional build-time dependencies (e.g. ccache). Not using that mechanism means that "make download" won't work, for example. Not to mention that it duplicates the sagemath upstream url, doesn't verify the checksum, etc. I don't necessarily care so much about using it, just wanted to make sure that you thought about the potential downsides of downloading the confball manually.



---

archive/issue_comments_195099.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nPS: I agree that missing changed and should be treated as implementation details for the autotools, i.e., do not call directly.",
    "created_at": "2014-01-15T14:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195099",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

PS: I agree that missing changed and should be treated as implementation details for the autotools, i.e., do not call directly.



---

archive/issue_comments_195100.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@vbraun](#comment:102):\n> AFAIK we do guarantee that \"sage -f\" works even before building Sage, so that you can install replacements for certain optional build-time dependencies (e.g. ccache). Not using that mechanism means that \"make download\" won't work, for example. Not to mention that it duplicates the sagemath upstream url, doesn't verify the checksum, etc. I don't necessarily care so much about using it, just wanted to make sure that you thought about the potential downsides of downloading the confball manually. \n\nI was thinking of moving towards a more typical \"configure + make\" model. Then `./sage -f` should be guaranteed to work only *after* `./configure` but before `make`. What we actually want for optional packages would be something like\n\n```\n$ ./configure --enable-ccache --enable-build-gcc --enable-mirror=http://example.com/ --optional-packages=database_gap\n$ make\n```",
    "created_at": "2014-01-15T14:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195100",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@vbraun](#comment:102):
> AFAIK we do guarantee that "sage -f" works even before building Sage, so that you can install replacements for certain optional build-time dependencies (e.g. ccache). Not using that mechanism means that "make download" won't work, for example. Not to mention that it duplicates the sagemath upstream url, doesn't verify the checksum, etc. I don't necessarily care so much about using it, just wanted to make sure that you thought about the potential downsides of downloading the confball manually. 

I was thinking of moving towards a more typical "configure + make" model. Then `./sage -f` should be guaranteed to work only *after* `./configure` but before `make`. What we actually want for optional packages would be something like

```
$ ./configure --enable-ccache --enable-build-gcc --enable-mirror=http://example.com/ --optional-packages=database_gap
$ make
```



---

archive/issue_comments_195101.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@vbraun](#comment:102):\n> bootstrap shouldn't call make to do its business, usually it would run automake to generate the makefile. But we can also disentangle that later if you prefer.\n\nPerhaps you are right. But I would indeed prefer to do that later, especially since #15606 changes the bootstrap process also.",
    "created_at": "2014-01-15T14:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195101",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@vbraun](#comment:102):
> bootstrap shouldn't call make to do its business, usually it would run automake to generate the makefile. But we can also disentangle that later if you prefer.

Perhaps you are right. But I would indeed prefer to do that later, especially since #15606 changes the bootstrap process also.



---

archive/issue_comments_195102.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nReplying to [@jdemeyer](#comment:104):\n> \n> ```\n> $ ./configure --enable-ccache --enable-build-gcc --enable-mirror=http://example.com/ --optional-packages=database_gap\n> ```\n\nSounds good to me, but does not have to prevent `sage -f` from working (with sane defaults) before configure is run. If you want to change the mirror url then you just have to have your own set of autotools.",
    "created_at": "2014-01-15T15:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195102",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:106" align="right">comment:106</div>

Replying to [@jdemeyer](#comment:104):
> 
> ```
> $ ./configure --enable-ccache --enable-build-gcc --enable-mirror=http://example.com/ --optional-packages=database_gap
> ```

Sounds good to me, but does not have to prevent `sage -f` from working (with sane defaults) before configure is run. If you want to change the mirror url then you just have to have your own set of autotools.



---

archive/issue_comments_195103.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nReplying to [@vbraun](#comment:106):\n> Sounds good to me, but does not have to prevent `sage -f` from working (with sane defaults) before configure is run.\n\nI'd say: let's see how things evolve. I will not actively prevent `sage -f` from working.",
    "created_at": "2014-01-15T20:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195103",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:107" align="right">comment:107</div>

Replying to [@vbraun](#comment:106):
> Sounds good to me, but does not have to prevent `sage -f` from working (with sane defaults) before configure is run.

I'd say: let's see how things evolve. I will not actively prevent `sage -f` from working.



---

archive/issue_comments_195104.json:
```json
{
    "body": "Changed reviewer from **R. Andrew Ohana** to **R. Andrew Ohana, Volker Braun**",
    "created_at": "2014-01-15T20:23:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195104",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **R. Andrew Ohana** to **R. Andrew Ohana, Volker Braun**



---

archive/issue_comments_195105.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nfine with me...",
    "created_at": "2014-01-15T20:23:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195105",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

fine with me...



---

archive/issue_events_222130.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-15T20:23:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222130"
}
```



---

archive/issue_events_222131.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-15T20:23:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222131"
}
```



---

archive/issue_comments_195106.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAnother side effect of treating the confball different:\n\n```\nvbraun@boxen:~/Sage/git$ git clone ...\nvbraun@boxen:~/Sage/git$ ./sage -sdist\nSage version 6.1.beta5, release date 2014-01-15\nError: configure tarball '/home/vbraun/Sage/git/upstream/configure-3.tar.gz' does not exist.\n```",
    "created_at": "2014-01-16T04:50:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15580#issuecomment-195106",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Another side effect of treating the confball different:

```
vbraun@boxen:~/Sage/git$ git clone ...
vbraun@boxen:~/Sage/git$ ./sage -sdist
Sage version 6.1.beta5, release date 2014-01-15
Error: configure tarball '/home/vbraun/Sage/git/upstream/configure-3.tar.gz' does not exist.
```



---

archive/issue_events_222132.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-16T05:10:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222132"
}
```



---

archive/issue_events_222133.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ea36c89262669e5d38bf28484c22bbc4b9a16762",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-01-16T05:10:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15580",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15580#event-222133"
}
```
