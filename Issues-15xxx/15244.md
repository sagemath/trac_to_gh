# Issue 15244: sage -t outputs duplicate lines

archive/issues_015007.json:
```json
{
    "body": "Normally, this should be zero:\n\n```\n$ rm -f logs/ptest.log\n$ make ptest\n$ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines\n436\n```\n\nThis is caused by forking with unflushed buffers.\n\nCC:  @roed314\n\nReviewer: David Roe\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.13.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15244\n\n",
    "closed_at": "2013-10-31T19:17:44Z",
    "created_at": "2013-09-30T19:05:31Z",
    "labels": [
        "component: doctest framework",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "sage -t outputs duplicate lines",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15244",
    "user": "https://github.com/jdemeyer"
}
```
Normally, this should be zero:

```
$ rm -f logs/ptest.log
$ make ptest
$ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines
436
```

This is caused by forking with unflushed buffers.

CC:  @roed314

Reviewer: David Roe

Author: Jeroen Demeyer

Merged: sage-5.13.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15244





---

archive/issue_comments_237825.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2013-10-28T10:28:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237825",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_237826.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n Normally, this should be zero:\n \n ```\n-$ grep '^sage -t' ptest.log  |sort |uniq -d |wc --lines\n+$ rm -f logs/ptest.log\n+$ make ptest\n+$ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines\n 436\n ```\n``````\n",
    "created_at": "2013-10-28T10:28:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237826",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
 Normally, this should be zero:
 
 ```
-$ grep '^sage -t' ptest.log  |sort |uniq -d |wc --lines
+$ rm -f logs/ptest.log
+$ make ptest
+$ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines
 436
 ```
``````




---

archive/issue_comments_237827.json:
```json
{
    "body": "<a id='comment:2'></a>\nAttachment [15244_doctest_flush.patch](tarball://root/attachments/some-uuid/ticket15244/15244_doctest_flush.patch) by @jdemeyer created at 2013-10-28 14:02:01",
    "created_at": "2013-10-28T14:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237827",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Attachment [15244_doctest_flush.patch](tarball://root/attachments/some-uuid/ticket15244/15244_doctest_flush.patch) by @jdemeyer created at 2013-10-28 14:02:01



---

archive/issue_comments_237828.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-28T14:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237828",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_237829.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,5 @@\n $ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines\n 436\n ```\n+\n+This is caused by forking with unflushed buffers.\n``````\n",
    "created_at": "2013-10-28T14:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237829",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,5 @@
 $ grep '^sage -t' logs/ptest.log  |sort |uniq -d |wc --lines
 436
 ```
+
+This is caused by forking with unflushed buffers.
``````




---

archive/issue_comments_237830.json:
```json
{
    "body": "<a id='comment:3'></a>\nThat looks fine to me.",
    "created_at": "2013-10-28T14:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237830",
    "user": "https://github.com/roed314"
}
```

<a id='comment:3'></a>
That looks fine to me.



---

archive/issue_comments_237831.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-28T14:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237831",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_237832.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2013-10-28T15:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237832",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_237833.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.13.beta2\"",
    "created_at": "2013-10-31T19:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237833",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.13.beta2"



---

archive/issue_comments_237834.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-31T19:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15244#issuecomment-237834",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_058256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:17:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15244",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15244#event-58256"
}
```
