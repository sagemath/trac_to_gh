# Issue 15340: Bug in chord_and_tangent

archive/issues_015103.json:
```json
{
    "body": "The `chord_and_tangent` method fails to treat one special case: the `t`-family of points\n\n```\n(dy*t+P[0], (-dx-dz)*t+P[1], dy*t+P[2])\n```\nmight fail to parametrize a line if `(dy,-dx-dz,dy)` is projectively equivalent to P. One needs to try two independent normal directions...\n\nThis leads to the following failure (reported by Pierre Vanhove):\n\n```\nsage: R.<x,y,z> = QQ[]\nsage: cubic = x^2*y + 4*x*y^2 + x^2*z + 8*x*y*z + 4*y^2*z + 9*x*z^2 + 9*y*z^2\nsage: EllipticCurve_from_cubic(cubic, [1,-1,1], morphism=False)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-3-67b6e7c68a76> in <module>()\n----> 1 EllipticCurve_from_cubic(cubic, [Integer(1),-Integer(1),Integer(1)], morphism=False)\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve_from_cubic(F, P, morphism)\n    774         X, Y, Z = S.gen(0), S.gen(1), S(-1/b)*S.gen(2)\n    775         F4 = F3(X, Y, Z)\n--> 776         E = EllipticCurve(F4.subs(z=1))\n    777         if not morphism:\n    778             return E\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j, minimal_twist)\n    313     if is_MPolynomial(x):\n    314         if y is None:\n--> 315             return EllipticCurve_from_Weierstrass_polynomial(x)\n    316         else:\n    317             return EllipticCurve_from_cubic(x, y, morphism=False)\n\n/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve_from_Weierstrass_polynomial(f)\n    433             a3 = -coeff\n    434         else:\n--> 435             raise ValueError('polynomial is not in long Weierstrass form')\n    436 \n    437     if x3 != y2:\n\nValueError: polynomial is not in long Weierstrass form\n```\n\nCC:  niels @JohnCremona @defeo\n\nReviewer: Luca De Feo\n\nAuthor: Volker Braun\n\nBranch: u/vbraun/ell_curve_from_cubic_fix\n\nCommit: 92d3cfb02e58648f8a2f250a0bc1690d0d84920d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15340\n\n",
    "closed_at": "2013-12-17T19:19:23Z",
    "created_at": "2013-10-28T19:51:11Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "Bug in chord_and_tangent",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15340",
    "user": "https://github.com/vbraun"
}
```
The `chord_and_tangent` method fails to treat one special case: the `t`-family of points

```
(dy*t+P[0], (-dx-dz)*t+P[1], dy*t+P[2])
```
might fail to parametrize a line if `(dy,-dx-dz,dy)` is projectively equivalent to P. One needs to try two independent normal directions...

This leads to the following failure (reported by Pierre Vanhove):

```
sage: R.<x,y,z> = QQ[]
sage: cubic = x^2*y + 4*x*y^2 + x^2*z + 8*x*y*z + 4*y^2*z + 9*x*z^2 + 9*y*z^2
sage: EllipticCurve_from_cubic(cubic, [1,-1,1], morphism=False)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-3-67b6e7c68a76> in <module>()
----> 1 EllipticCurve_from_cubic(cubic, [Integer(1),-Integer(1),Integer(1)], morphism=False)

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve_from_cubic(F, P, morphism)
    774         X, Y, Z = S.gen(0), S.gen(1), S(-1/b)*S.gen(2)
    775         F4 = F3(X, Y, Z)
--> 776         E = EllipticCurve(F4.subs(z=1))
    777         if not morphism:
    778             return E

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j, minimal_twist)
    313     if is_MPolynomial(x):
    314         if y is None:
--> 315             return EllipticCurve_from_Weierstrass_polynomial(x)
    316         else:
    317             return EllipticCurve_from_cubic(x, y, morphism=False)

/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve_from_Weierstrass_polynomial(f)
    433             a3 = -coeff
    434         else:
--> 435             raise ValueError('polynomial is not in long Weierstrass form')
    436 
    437     if x3 != y2:

ValueError: polynomial is not in long Weierstrass form
```

CC:  niels @JohnCremona @defeo

Reviewer: Luca De Feo

Author: Volker Braun

Branch: u/vbraun/ell_curve_from_cubic_fix

Commit: 92d3cfb02e58648f8a2f250a0bc1690d0d84920d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15340





---

archive/issue_comments_206412.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2013-10-28T19:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15340#issuecomment-206412",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_206413.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-28T19:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15340#issuecomment-206413",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_206414.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-30T17:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15340#issuecomment-206414",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_044490.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:22:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15340#event-44490"
}
```



---

archive/issue_events_044491.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-17T18:20:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15340#event-44491"
}
```



---

archive/issue_events_044492.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-17T18:20:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15340#event-44492"
}
```



---

archive/issue_comments_206415.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-17T19:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15340#issuecomment-206415",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_044493.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-17T19:19:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15340#event-44493"
}
```



---

archive/issue_comments_206416.json:
```json
{
    "body": "<a id='comment:9'></a>Try to avoid putting U+200b characters in the Reviewer name.",
    "created_at": "2014-02-03T14:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15340#issuecomment-206416",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Try to avoid putting U+200b characters in the Reviewer name.
