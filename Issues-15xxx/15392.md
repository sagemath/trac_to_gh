# Issue 15392: Implement minimal model algorithm

archive/issues_015155.json:
```json
{
    "assignees": [],
    "body": "Bruin-Molnar published an algorithm to compute the minimal model of a morphism on P1, \"Minimal models for rational functions in a dynamical setting\".\n\nTranslate their algorithm and code to work with the existing dynamical framework\n\nApply:\n\n* [attachment: trac_15392_minimal_model.patch](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)\n\nDepends on #14219\n\nAssignee: **@bhutz**\n\nKeywords: **sage-days55**\n\nReviewer: **Nils Bruin**\n\nAuthor: **Ben Hutz**\n\nMerged: **sage-5.13.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15392_\n\n",
    "closed_at": "2013-12-10T08:38:51Z",
    "created_at": "2013-11-10T00:58:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement minimal model algorithm",
    "type": "issue",
    "updated_at": "2016-04-15T20:27:33Z",
    "url": "https://github.com/sagemath/sage/issues/15392",
    "user": "https://github.com/bhutz"
}
```
Bruin-Molnar published an algorithm to compute the minimal model of a morphism on P1, "Minimal models for rational functions in a dynamical setting".

Translate their algorithm and code to work with the existing dynamical framework

Apply:

* [attachment: trac_15392_minimal_model.patch](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)

Depends on #14219

Assignee: **@bhutz**

Keywords: **sage-days55**

Reviewer: **Nils Bruin**

Author: **Ben Hutz**

Merged: **sage-5.13.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/15392_





---

archive/issue_events_201645.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T00:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201645"
}
```



---

archive/issue_events_201646.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T00:58:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201646"
}
```



---

archive/issue_events_201647.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T00:58:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201647"
}
```



---

archive/issue_events_201648.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T01:01:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201648"
}
```



---

archive/issue_events_201649.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-11T17:57:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201649"
}
```



---

archive/issue_comments_193813.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nWorking with Brian Stout we've translated Alexander Molnar's minimal model algorithm/code to work within Sage. A few minors changes from his original work, but the algorithm remains unchanged.",
    "created_at": "2013-11-11T17:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193813",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:2" align="right">Comment 2</div>

Working with Brian Stout we've translated Alexander Molnar's minimal model algorithm/code to work within Sage. A few minors changes from his original work, but the algorithm remains unchanged.



---

archive/issue_comments_193814.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nforgot to include the GPL in the new file the first time\n\nBrian - can you please add yourself to authors.",
    "created_at": "2013-11-11T18:09:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193814",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:3" align="right">Comment 3</div>

forgot to include the GPL in the new file the first time

Brian - can you please add yourself to authors.



---

archive/issue_comments_193815.json:
```json
{
    "body": "Author: **bhutz**",
    "created_at": "2013-11-11T18:09:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193815",
    "user": "https://github.com/bhutz"
}
```

Author: **bhutz**



---

archive/issue_comments_193816.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nHello,\n\nIt is very good that the code is documented and contains references! But there are several problem with the documentation (see [sage developer guide](http://sagemath.github.io/git-developer-guide/coding_basics.html#documentation-strings)).\n\n1) there are trailing whitespaces\n\n2) the indentation is not good. The blocks INPUT, EXAMPLES must have the same identation as the documentation and you must have a blankline between the block name EXAMPLES and its content (for example lines 201-202 are wrong).\n\n```\ndef my_function(arg1, arg2):\n    \"\"\"\n    This is a nice function\n\n    INPUT:\n\n    - ``arg1`` - a first nice argument\n\n    - ``arg2`` - an other nice argument\n\n    EXAMPLES::\n\n        sage: my_function(8,3)\n \n    We can also use the function with strings::\n\n        sage: my_function('toto', 'bibi')\n    \"\"\"\n```\n\n3) Bibliography is not set up properly\n\n4) In the examples (at least) respect the convention \"my_variable = f()\" and do not use \"my_variable=f()\". If possible, try to be coherent in function arguments and prefer \"def f(a, b=3, c=4)\" to \"def f(a,b = 3, c=4)\".\n\n5) For the name I guess \"is_affine_minimal\" is more suited than \"affine_minimal\".",
    "created_at": "2013-11-12T01:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193816",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">Comment 4</div>

Hello,

It is very good that the code is documented and contains references! But there are several problem with the documentation (see [sage developer guide](http://sagemath.github.io/git-developer-guide/coding_basics.html#documentation-strings)).

1) there are trailing whitespaces

2) the indentation is not good. The blocks INPUT, EXAMPLES must have the same identation as the documentation and you must have a blankline between the block name EXAMPLES and its content (for example lines 201-202 are wrong).

```
def my_function(arg1, arg2):
    """
    This is a nice function

    INPUT:

    - ``arg1`` - a first nice argument

    - ``arg2`` - an other nice argument

    EXAMPLES::

        sage: my_function(8,3)
 
    We can also use the function with strings::

        sage: my_function('toto', 'bibi')
    """
```

3) Bibliography is not set up properly

4) In the examples (at least) respect the convention "my_variable = f()" and do not use "my_variable=f()". If possible, try to be coherent in function arguments and prefer "def f(a, b=3, c=4)" to "def f(a,b = 3, c=4)".

5) For the name I guess "is_affine_minimal" is more suited than "affine_minimal".



---

archive/issue_comments_193817.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nYes, 1,2,4 are all simple changes that need to be made.  3 was waiting to add an additional citation (which I have now) and will be fixed as well.\n\n5 I disagree with. The minimalmodel.py file is not exposed to the user, so neither is affine_minimal. The two functions exposed to the user are\n\nis_minimal_model() and minimal_model()\n\nPart of the original citation is that it is enough for minimal to check affine minimal, so those names should be fine.",
    "created_at": "2013-11-12T01:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193817",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:5" align="right">Comment 5</div>

Yes, 1,2,4 are all simple changes that need to be made.  3 was waiting to add an additional citation (which I have now) and will be fixed as well.

5 I disagree with. The minimalmodel.py file is not exposed to the user, so neither is affine_minimal. The two functions exposed to the user are

is_minimal_model() and minimal_model()

Part of the original citation is that it is enough for minimal to check affine minimal, so those names should be fine.



---

archive/issue_comments_193818.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nSome comments from Alex Molnar:\n\nI ... have finally looked through the code. I only glossed the parts that appear unchanged (with the original code side-by-side) and otherwise think the adaptation to projective morphisms looks good.\n\nJust two minor comments. In line 206, I think you mean ``vp`` to ``newvp``, and in line 1453 ``self`` is written ``sefl``.\n\n---\nI've updated the patch to make those minor corrections.",
    "created_at": "2013-11-29T14:33:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193818",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:6" align="right">Comment 6</div>

Some comments from Alex Molnar:

I ... have finally looked through the code. I only glossed the parts that appear unchanged (with the original code side-by-side) and otherwise think the adaptation to projective morphisms looks good.

Just two minor comments. In line 206, I think you mean ``vp`` to ``newvp``, and in line 1453 ``self`` is written ``sefl``.

---
I've updated the patch to make those minor corrections.



---

archive/issue_comments_193819.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI'm just parking some test code here for my own use:\n\n```\nimport urllib\n\nQx.<x>=QQ[]\ndef interpolate(c,n):\n   M=matrix([[c[i]^k for k in range(n+1)]+[-c[i+1]*c[i]^k for k in range(n+1)] for i in range(len(c)-1)])\n   v=list(M.right_kernel().basis()[0])\n   return Qx(v[:n+1])/Qx(v[n+1:])\n   \nV=[eval(c) for c in urllib.urlopen(\"http://www.cecm.sfu.ca/~nbruin/intorbits/deg2.txt\")]\n\nP1.<X,Y>=ProjectiveSpace(QQ,1)\ndef proj_map(f):\n    phi=f(X/Y)\n    return End(P1)([phi.numerator(),phi.denominator()])\n    \n[proj_map(interpolate(c,2)((x+1)/(x-1))).is_minimal_model() for c in V[:50]]\n```\nI'm noticing it's awfully slow! I think I tried a similar thing with the magma version and that was quite quick. Initial impression is that this is just a sage problem:\n\n```\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      110    0.033    0.000    0.073    0.001 minimal_model.py:41(bCheck)\n1847/1843    0.026    0.000    0.031    0.000 polynomial_ring.py:299(_element_constructor_)\n    26/22    0.022    0.001    0.062    0.003 minimal_model.py:122(blift)\n      264    0.015    0.000    0.020    0.000 {method 'subs' of 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' objects}\n     2097    0.011    0.000    0.015    0.000 {method 'sub' of '_sre.SRE_Pattern' objects}\n      943    0.010    0.000    0.033    0.000 polynomial_ring_constructor.py:60(PolynomialRing)\n        3    0.008    0.003    0.169    0.056 minimal_model.py:302(Min)\n    19104    0.006    0.000    0.006    0.000 {isinstance}\n     2157    0.004    0.000    0.005    0.000 re.py:226(_compile)\n```\nso it looks like just constructing the polynomials is an expensive proposition already. `bCheck` does take quite a bit of time by itself too, so there may be some algorithmic issues too. Perhaps we don't care about performance at this point?\n\n(Ah, I see: there are lots of polynomial rings constructed *inside* functions. That shouldn't happen)\n\nSome possible packaging problems:\n- I think the file name `sage/schemes/projective/minimal_model.py` will cause problems later on: there are all kinds of projective schemes that have their own concept of minimality, so I think it should be `endP1_minimal_model` or something more appetizing.\n- `phi.is_minimal_model` reads a little strange: `phi` is supposed to be an endomorphism on a `P1` (with coordinate choice, i.e., with `0,1,infty` marked), not a model of one. Would is_PGL_minimal be better (or perhaps is_minimal)?",
    "created_at": "2013-11-29T22:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193819",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:7" align="right">Comment 7</div>

I'm just parking some test code here for my own use:

```
import urllib

Qx.<x>=QQ[]
def interpolate(c,n):
   M=matrix([[c[i]^k for k in range(n+1)]+[-c[i+1]*c[i]^k for k in range(n+1)] for i in range(len(c)-1)])
   v=list(M.right_kernel().basis()[0])
   return Qx(v[:n+1])/Qx(v[n+1:])
   
V=[eval(c) for c in urllib.urlopen("http://www.cecm.sfu.ca/~nbruin/intorbits/deg2.txt")]

P1.<X,Y>=ProjectiveSpace(QQ,1)
def proj_map(f):
    phi=f(X/Y)
    return End(P1)([phi.numerator(),phi.denominator()])
    
[proj_map(interpolate(c,2)((x+1)/(x-1))).is_minimal_model() for c in V[:50]]
```
I'm noticing it's awfully slow! I think I tried a similar thing with the magma version and that was quite quick. Initial impression is that this is just a sage problem:

```
   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      110    0.033    0.000    0.073    0.001 minimal_model.py:41(bCheck)
1847/1843    0.026    0.000    0.031    0.000 polynomial_ring.py:299(_element_constructor_)
    26/22    0.022    0.001    0.062    0.003 minimal_model.py:122(blift)
      264    0.015    0.000    0.020    0.000 {method 'subs' of 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' objects}
     2097    0.011    0.000    0.015    0.000 {method 'sub' of '_sre.SRE_Pattern' objects}
      943    0.010    0.000    0.033    0.000 polynomial_ring_constructor.py:60(PolynomialRing)
        3    0.008    0.003    0.169    0.056 minimal_model.py:302(Min)
    19104    0.006    0.000    0.006    0.000 {isinstance}
     2157    0.004    0.000    0.005    0.000 re.py:226(_compile)
```
so it looks like just constructing the polynomials is an expensive proposition already. `bCheck` does take quite a bit of time by itself too, so there may be some algorithmic issues too. Perhaps we don't care about performance at this point?

(Ah, I see: there are lots of polynomial rings constructed *inside* functions. That shouldn't happen)

Some possible packaging problems:
- I think the file name `sage/schemes/projective/minimal_model.py` will cause problems later on: there are all kinds of projective schemes that have their own concept of minimality, so I think it should be `endP1_minimal_model` or something more appetizing.
- `phi.is_minimal_model` reads a little strange: `phi` is supposed to be an endomorphism on a `P1` (with coordinate choice, i.e., with `0,1,infty` marked), not a model of one. Would is_PGL_minimal be better (or perhaps is_minimal)?



---

archive/issue_comments_193820.json:
```json
{
    "body": "Attachment: **[trac15392_referee.patch.gz](https://github.com/sagemath/sage/files/ticket15392/trac15392_referee.patch.gz)**\n\nSome suggested improvements",
    "created_at": "2013-12-01T04:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193820",
    "user": "https://github.com/nbruin"
}
```

Attachment: **[trac15392_referee.patch.gz](https://github.com/sagemath/sage/files/ticket15392/trac15392_referee.patch.gz)**

Some suggested improvements



---

archive/issue_comments_193821.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI've attached a \"patch\" with some suggested improvements. With that version, I was able to check the minimality of `[eval(c) for c in urllib.urlopen(\"http://www.cecm.sfu.ca/~nbruin/intorbits/deg2.txt\")]` within a minute (that's a little over 2000 quadratic maps). I'm sure the code could be optimized further, but why bother now? I don't think the current code is doing anything outright silly any more and running `%prun` on some examples produces for me a profile I can believe (most time is spent in the recursive `blift`, which is what one would expect).\n\nThere's still the naming of the file and of the routines to be considered.\n\nThe code itself seems fine. I've run it by giving it (known) minimal maps from the tables referred to above, conjugating by random transformations, and seeing if the minimal model returned has the same resultant (up to sign) as the original, and I didn't find problems.\n\n(I noticed there's a doctest failing for `blift` now, but that's because the test puts an integer in the input list where there should be polynomials. I propose the doctest gets amended, since the internal use of `blift` guarantees that the input consists of a list of polynomials.)",
    "created_at": "2013-12-01T04:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193821",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:8" align="right">Comment 8</div>

I've attached a "patch" with some suggested improvements. With that version, I was able to check the minimality of `[eval(c) for c in urllib.urlopen("http://www.cecm.sfu.ca/~nbruin/intorbits/deg2.txt")]` within a minute (that's a little over 2000 quadratic maps). I'm sure the code could be optimized further, but why bother now? I don't think the current code is doing anything outright silly any more and running `%prun` on some examples produces for me a profile I can believe (most time is spent in the recursive `blift`, which is what one would expect).

There's still the naming of the file and of the routines to be considered.

The code itself seems fine. I've run it by giving it (known) minimal maps from the tables referred to above, conjugating by random transformations, and seeing if the minimal model returned has the same resultant (up to sign) as the original, and I didn't find problems.

(I noticed there's a doctest failing for `blift` now, but that's because the test puts an integer in the input list where there should be polynomials. I propose the doctest gets amended, since the internal use of `blift` guarantees that the input consists of a list of polynomials.)



---

archive/issue_comments_193822.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThose changes look good.\n\nI have thought about the naming and see your point on the file name. Although, I'm inclined to be optimistic for the future and call it `endPN_minimal_model`. This will also allow consistent naming for other algorithms for endomorphisms of PN.\n\nI'm also happy to call the function `is_PGL_minimal`.\n\nYes. we should just update the doctest as well as we made our best guess as to what a reasonable test was for the individual functions.\n\nI can fold the patches together and make these changes unless you want to use your `referee` patch to do them?",
    "created_at": "2013-12-01T15:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193822",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:9" align="right">Comment 9</div>

Those changes look good.

I have thought about the naming and see your point on the file name. Although, I'm inclined to be optimistic for the future and call it `endPN_minimal_model`. This will also allow consistent naming for other algorithms for endomorphisms of PN.

I'm also happy to call the function `is_PGL_minimal`.

Yes. we should just update the doctest as well as we made our best guess as to what a reasonable test was for the individual functions.

I can fold the patches together and make these changes unless you want to use your `referee` patch to do them?



---

archive/issue_comments_193823.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nI went to fold this together and make the other changes, but your patch doesn't apply on my system. Could you double check your patch?\n\nI'm still using 5.12, but it shouldn't matter since these are all changing the new `minimal_model.py` anyway.",
    "created_at": "2013-12-01T22:21:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193823",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:10" align="right">Comment 10</div>

I went to fold this together and make the other changes, but your patch doesn't apply on my system. Could you double check your patch?

I'm still using 5.12, but it shouldn't matter since these are all changing the new `minimal_model.py` anyway.



---

archive/issue_comments_193824.json:
```json
{
    "body": "Attachment: **[minimal_model.py.gz](https://github.com/sagemath/sage/files/ticket15392/minimal_model.py.gz)**\n\nattached file (due to failing patches)",
    "created_at": "2013-12-02T00:25:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193824",
    "user": "https://github.com/nbruin"
}
```

Attachment: **[minimal_model.py.gz](https://github.com/sagemath/sage/files/ticket15392/minimal_model.py.gz)**

attached file (due to failing patches)



---

archive/issue_comments_193825.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@bhutz](#comment%3A10):\n> I'm still using 5.12, but it shouldn't matter since these are all changing the new `minimal_model.py` anyway.\n\nOK, back to basics then. You may be aware that sage is in the middle of changing the source control system. I'm working on the git version and have no idea how to get a HG patch out of it (importing hg patches doesn't seem to be a problem) Attached is the file that resulted from my editing. You should be able to get out of that whatever you want by just replacing the file and let your source control system of choice figure out what the changes are.",
    "created_at": "2013-12-02T00:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193825",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@bhutz](#comment%3A10):
> I'm still using 5.12, but it shouldn't matter since these are all changing the new `minimal_model.py` anyway.

OK, back to basics then. You may be aware that sage is in the middle of changing the source control system. I'm working on the git version and have no idea how to get a HG patch out of it (importing hg patches doesn't seem to be a problem) Attached is the file that resulted from my editing. You should be able to get out of that whatever you want by just replacing the file and let your source control system of choice figure out what the changes are.



---

archive/issue_comments_193826.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nYes, that would certainly do it. In the near future I'll be switching over to git, I just haven't done it yet.\n\nNew patch attached with your changes, the names changes, and the doctest fixed.\n\napply trac_15392_minimal_model.patch\u200b",
    "created_at": "2013-12-02T00:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193826",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:12" align="right">Comment 12</div>

Yes, that would certainly do it. In the near future I'll be switching over to git, I just haven't done it yet.

New patch attached with your changes, the names changes, and the doctest fixed.

apply trac_15392_minimal_model.patch​



---

archive/issue_comments_193827.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\napply trac_15392_minimal_model.patch\u200b",
    "created_at": "2013-12-02T00:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193827",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:13" align="right">Comment 13</div>

apply trac_15392_minimal_model.patch​



---

archive/issue_comments_193828.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nLooks good to me. Incidentally, the name `is_PGL_minimal` might not be the best name. It's certainly descriptive, but the spelling is perhaps a little painful relative to the rest of sage?\n\nSome very small points:\n\nThe fact that\n\n```\nsage: phi.minimal_model().resultant()\n```\ndoesn't work seems a little strange. Shouldn't it be `return_conjugation=False` by default, so that the default returns a value that can be immediately used rather than needing unpacking? Also, wouldn't `return_transformation` be a better name? \n\nCertainly in the doctest:\n\n```\n     sage: f.minimal_model(False)\n```\nshould refer to the keyword argument by keyword, i.e.,\n\n```\n     sage: f.minimal_model(return_transformation=False)\n```\nA \"positional\" false is rather unclear here, even though it works.\n\nFinally (and this is for another ticket): If we're \"minimizing\" rational transformations, shouldn't we also be \"reducing\" them, i.e., compute an SL(2,Z) transformation that makes the coefficients small? The most simple approach would be to \"reduce\" the binary form describing the fixed points or (if that's too degenerate) the points of period n for some small n.\n\nSee [Stoll, Michael; Cremona, John E., On the reduction theory of binary forms. J. Reine Angew. Math. 565 (2003), 79\u201399.], which is fairly easy to implement and which would be useful to have in sage anyway.",
    "created_at": "2013-12-04T01:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193828",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:14" align="right">Comment 14</div>

Looks good to me. Incidentally, the name `is_PGL_minimal` might not be the best name. It's certainly descriptive, but the spelling is perhaps a little painful relative to the rest of sage?

Some very small points:

The fact that

```
sage: phi.minimal_model().resultant()
```
doesn't work seems a little strange. Shouldn't it be `return_conjugation=False` by default, so that the default returns a value that can be immediately used rather than needing unpacking? Also, wouldn't `return_transformation` be a better name? 

Certainly in the doctest:

```
     sage: f.minimal_model(False)
```
should refer to the keyword argument by keyword, i.e.,

```
     sage: f.minimal_model(return_transformation=False)
```
A "positional" false is rather unclear here, even though it works.

Finally (and this is for another ticket): If we're "minimizing" rational transformations, shouldn't we also be "reducing" them, i.e., compute an SL(2,Z) transformation that makes the coefficients small? The most simple approach would be to "reduce" the binary form describing the fixed points or (if that's too degenerate) the points of period n for some small n.

See [Stoll, Michael; Cremona, John E., On the reduction theory of binary forms. J. Reine Angew. Math. 565 (2003), 79–99.], which is fairly easy to implement and which would be useful to have in sage anyway.



---

archive/issue_comments_193829.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nHaving the default be False is fine and is now changed.\n\nI do have the two optional parameters as positional that is why it is positional in the doctest. It sounds like you think this should be `**kwds` instead of positional. I could change it and don't have a strong opinion either way, but have not done so at this point.\n\nYes, getting the reduced form would be nice and I'll add it to the dynamics todo list on the wiki.",
    "created_at": "2013-12-04T16:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193829",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:15" align="right">Comment 15</div>

Having the default be False is fine and is now changed.

I do have the two optional parameters as positional that is why it is positional in the doctest. It sounds like you think this should be `**kwds` instead of positional. I could change it and don't have a strong opinion either way, but have not done so at this point.

Yes, getting the reduced form would be nice and I'll add it to the dynamics todo list on the wiki.



---

archive/issue_comments_193830.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@bhutz](#comment%3A15):\n> I do have the two optional parameters as positional that is why it is positional in the doctest.\n\nNo, in Python, *all* named arguments can be addressed via keyword. So I wasn't suggesting changing the code, only using the doctest to encourage addressing this option by key. If you prefer, you can still address it by position in your own code. It's just that\n\n```\nphi.minimal_model(True)\n```\nisn't very self-documenting.\n\nI think the patch update didn't quite work. Do you want to stick with `return_conjugation` rather than `return_transformation`?",
    "created_at": "2013-12-04T19:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193830",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@bhutz](#comment%3A15):
> I do have the two optional parameters as positional that is why it is positional in the doctest.

No, in Python, *all* named arguments can be addressed via keyword. So I wasn't suggesting changing the code, only using the doctest to encourage addressing this option by key. If you prefer, you can still address it by position in your own code. It's just that

```
phi.minimal_model(True)
```
isn't very self-documenting.

I think the patch update didn't quite work. Do you want to stick with `return_conjugation` rather than `return_transformation`?



---

archive/issue_comments_193831.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nok. That's easy enough to change and is done in this version.\n\nI forgot to qrefresh before, but the correct one should be up.",
    "created_at": "2013-12-04T19:26:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193831",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:17" align="right">Comment 17</div>

ok. That's easy enough to change and is done in this version.

I forgot to qrefresh before, but the correct one should be up.



---

archive/issue_events_201650.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-05T05:34:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201650"
}
```



---

archive/issue_events_201651.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-05T05:34:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201651"
}
```



---

archive/issue_comments_193832.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nGood with me. To repeat: I did try the code quite extensively on more or less random examples, where the code has to do non-trivial work and I didn't catch it on any inconsistencies.",
    "created_at": "2013-12-05T05:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193832",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:18" align="right">Comment 18</div>

Good with me. To repeat: I did try the code quite extensively on more or less random examples, where the code has to do non-trivial work and I didn't catch it on any inconsistencies.



---

archive/issue_comments_193833.json:
```json
{
    "body": "Changed author from **bhutz** to **Ben Hutz**",
    "created_at": "2013-12-05T05:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193833",
    "user": "https://github.com/nbruin"
}
```

Changed author from **bhutz** to **Ben Hutz**



---

archive/issue_comments_193834.json:
```json
{
    "body": "Reviewer: **Nils Bruin**",
    "created_at": "2013-12-05T05:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193834",
    "user": "https://github.com/nbruin"
}
```

Reviewer: **Nils Bruin**



---

archive/issue_events_201652.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T08:00:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201652"
}
```



---

archive/issue_events_201653.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T08:00:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201653"
}
```



---

archive/issue_comments_193835.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nPlease clarify which patch(es) should be merged.",
    "created_at": "2013-12-05T08:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193835",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">Comment 19</div>

Please clarify which patch(es) should be merged.



---

archive/issue_comments_193836.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n Bruin-Molnar published an algorithm to compute the minimal model of a morphism on P1, \"Minimal models for rational functions in a dynamical setting\".\n \n Translate their algorithm and code to work with the existing dynamical framework\n+\n+Apply:\n+\n+* [attachment: trac_15392_minimal_model.patch](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)\n``````\n",
    "created_at": "2013-12-05T13:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193836",
    "user": "https://github.com/bhutz"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
 Bruin-Molnar published an algorithm to compute the minimal model of a morphism on P1, "Minimal models for rational functions in a dynamical setting".
 
 Translate their algorithm and code to work with the existing dynamical framework
+
+Apply:
+
+* [attachment: trac_15392_minimal_model.patch](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)
``````




---

archive/issue_events_201654.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-05T13:10:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201654"
}
```



---

archive/issue_events_201655.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-05T13:10:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201655"
}
```



---

archive/issue_events_201656.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-05T16:44:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201656"
}
```



---

archive/issue_events_201657.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-05T16:44:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201657"
}
```



---

archive/issue_comments_193837.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nPatch hasn't changed, so I don't think \"review\" is necessary. This is just admin to keep Jeroen's job manageable.",
    "created_at": "2013-12-05T16:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193837",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:21" align="right">Comment 21</div>

Patch hasn't changed, so I don't think "review" is necessary. This is just admin to keep Jeroen's job manageable.



---

archive/issue_events_201658.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T22:34:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201658"
}
```



---

archive/issue_events_201659.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T22:34:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201659"
}
```



---

archive/issue_comments_193838.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\n\n```\ndochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:8: WARNING: Duplicate explicit target name: \"bruin-molnar\".\ndochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:12: WARNING: Duplicate explicit target name: \"molnar\".\ndochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:8: WARNING: duplicate citation Bruin-Molnar, other instance in /scratch/release/merger/sage-5.13.rc0/devel/sage/doc/en/reference/schemes/sage/schemes/projective/projective_morphism.rst\ndochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:12: WARNING: duplicate citation Molnar, other instance in /scratch/release/merger/sage-5.13.rc0/devel/sage/doc/en/reference/schemes/sage/schemes/projective/projective_morphism.rst\n```",
    "created_at": "2013-12-05T22:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193838",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">Comment 22</div>


```
dochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:8: WARNING: Duplicate explicit target name: "bruin-molnar".
dochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:12: WARNING: Duplicate explicit target name: "molnar".
dochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:8: WARNING: duplicate citation Bruin-Molnar, other instance in /scratch/release/merger/sage-5.13.rc0/devel/sage/doc/en/reference/schemes/sage/schemes/projective/projective_morphism.rst
dochtml.log:[schemes  ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.minimal_model:12: WARNING: duplicate citation Molnar, other instance in /scratch/release/merger/sage-5.13.rc0/devel/sage/doc/en/reference/schemes/sage/schemes/projective/projective_morphism.rst
```



---

archive/issue_comments_193839.json:
```json
{
    "body": "Work Issues: **docbuild**",
    "created_at": "2013-12-05T22:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193839",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **docbuild**



---

archive/issue_comments_193840.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nhmm...Since I using the same references in two different functions it is giving the warning. I'm not 100% sure what the procedure is here. In looking at some of the toric variety code, it seems to be the case to put the reference listing in one place and then use `[.]` everywhere else.\n\nSo then I've moved the `REFERENCES` block to the 'main' function and just used the citation `[.]` for the other.",
    "created_at": "2013-12-05T23:02:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193840",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:23" align="right">Comment 23</div>

hmm...Since I using the same references in two different functions it is giving the warning. I'm not 100% sure what the procedure is here. In looking at some of the toric variety code, it seems to be the case to put the reference listing in one place and then use `[.]` everywhere else.

So then I've moved the `REFERENCES` block to the 'main' function and just used the citation `[.]` for the other.



---

archive/issue_events_201660.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-05T23:02:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201660"
}
```



---

archive/issue_events_201661.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-05T23:02:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201661"
}
```



---

archive/issue_comments_193841.json:
```json
{
    "body": "Dependencies: **#14219**",
    "created_at": "2013-12-06T10:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193841",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#14219**



---

archive/issue_comments_193842.json:
```json
{
    "body": "Changed work issues from **docbuild** to **rebase**",
    "created_at": "2013-12-06T10:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193842",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **docbuild** to **rebase**



---

archive/issue_comments_193843.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nPlease rebase the patch to sage-5.13.beta4 or later.",
    "created_at": "2013-12-06T10:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193843",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

Please rebase the patch to sage-5.13.beta4 or later.



---

archive/issue_events_201662.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-06T10:28:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201662"
}
```



---

archive/issue_events_201663.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-06T10:28:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201663"
}
```



---

archive/issue_comments_193844.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nYes, sorry, I should have realized. Even though there is no functionality dependency, they do modify the same file. The new version is rebased.",
    "created_at": "2013-12-06T13:21:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193844",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:25" align="right">Comment 25</div>

Yes, sorry, I should have realized. Even though there is no functionality dependency, they do modify the same file. The new version is rebased.



---

archive/issue_comments_193845.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\n\n```\nsage -t devel/sage/sage/schemes/projective/endPN_minimal_model.py\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/endPN_minimal_model.py\", line 65, in sage.schemes.projective.endPN_minimal_model.bCheck\nFailed example:\n    from sage.schemes.projective.minimal_model import bCheck\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 479, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 838, in execute\n        exec compiled in globs\n      File \"<doctest sage.schemes.projective.endPN_minimal_model.bCheck[1]>\", line 1, in <module>\n        from sage.schemes.projective.minimal_model import bCheck\n    ImportError: No module named minimal_model\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/endPN_minimal_model.py\", line 66, in sage.schemes.projective.endPN_minimal_model.bCheck\nFailed example:\n    bCheck(11664*b^2 + 70227*b + 76059, 15/2, 3, b)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 479, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 838, in execute\n        exec compiled in globs\n      File \"<doctest sage.schemes.projective.endPN_minimal_model.bCheck[2]>\", line 1, in <module>\n        bCheck(Integer(11664)*b**Integer(2) + Integer(70227)*b + Integer(76059), Integer(15)/Integer(2), Integer(3), b)\n    NameError: name 'bCheck' is not defined\n**********************************************************************\n```",
    "created_at": "2013-12-07T19:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193845",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">Comment 26</div>


```
sage -t devel/sage/sage/schemes/projective/endPN_minimal_model.py
**********************************************************************
File "devel/sage/sage/schemes/projective/endPN_minimal_model.py", line 65, in sage.schemes.projective.endPN_minimal_model.bCheck
Failed example:
    from sage.schemes.projective.minimal_model import bCheck
Exception raised:
    Traceback (most recent call last):
      File "/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 479, in _run
        self.execute(example, compiled, test.globs)
      File "/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 838, in execute
        exec compiled in globs
      File "<doctest sage.schemes.projective.endPN_minimal_model.bCheck[1]>", line 1, in <module>
        from sage.schemes.projective.minimal_model import bCheck
    ImportError: No module named minimal_model
**********************************************************************
File "devel/sage/sage/schemes/projective/endPN_minimal_model.py", line 66, in sage.schemes.projective.endPN_minimal_model.bCheck
Failed example:
    bCheck(11664*b^2 + 70227*b + 76059, 15/2, 3, b)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 479, in _run
        self.execute(example, compiled, test.globs)
      File "/scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 838, in execute
        exec compiled in globs
      File "<doctest sage.schemes.projective.endPN_minimal_model.bCheck[2]>", line 1, in <module>
        bCheck(Integer(11664)*b**Integer(2) + Integer(70227)*b + Integer(76059), Integer(15)/Integer(2), Integer(3), b)
    NameError: name 'bCheck' is not defined
**********************************************************************
```



---

archive/issue_events_201664.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-07T23:39:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201664"
}
```



---

archive/issue_events_201665.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-12-07T23:39:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201665"
}
```



---

archive/issue_comments_193846.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nAttachment: **[trac_15392_minimal_model.patch.gz](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)**\n\nok. I fixed that typo in the test and I've doubled checked that the doctests and the docbuild pass on my system.",
    "created_at": "2013-12-07T23:39:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193846",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:27" align="right">Comment 27</div>

Attachment: **[trac_15392_minimal_model.patch.gz](https://github.com/sagemath/sage/files/ticket15392/trac_15392_minimal_model.patch.gz)**

ok. I fixed that typo in the test and I've doubled checked that the doctests and the docbuild pass on my system.



---

archive/issue_comments_193847.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nOK, it works now. Nils, can you do the final review?",
    "created_at": "2013-12-08T13:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193847",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">Comment 28</div>

OK, it works now. Nils, can you do the final review?



---

archive/issue_comments_193848.json:
```json
{
    "body": "Changed work issues from **rebase** to none",
    "created_at": "2013-12-08T13:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193848",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **rebase** to none



---

archive/issue_events_201666.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-08T20:08:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201666"
}
```



---

archive/issue_events_201667.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2013-12-08T20:08:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201667"
}
```



---

archive/issue_comments_193849.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nHow many reviews do we need?",
    "created_at": "2013-12-08T20:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193849",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:30" align="right">Comment 30</div>

How many reviews do we need?



---

archive/issue_events_201668.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-10T08:38:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201668"
}
```



---

archive/issue_events_201669.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-10T08:38:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15392#event-201669"
}
```



---

archive/issue_comments_193850.json:
```json
{
    "body": "Merged: **sage-5.13.rc0**",
    "created_at": "2013-12-10T08:38:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193850",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.rc0**



---

archive/issue_comments_193851.json:
```json
{
    "body": "Changed author from **Ben Hutz** to **Benjamin Hutz**",
    "created_at": "2013-12-15T09:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193851",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Ben Hutz** to **Benjamin Hutz**



---

archive/issue_comments_193852.json:
```json
{
    "body": "Changed author from **Benjamin Hutz** to **Ben Hutz**",
    "created_at": "2016-04-15T20:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15392#issuecomment-193852",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Benjamin Hutz** to **Ben Hutz**
