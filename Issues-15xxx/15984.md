# Issue 15984: Python 3 preparation: Change some code to use more modern Python idioms

archive/issues_015747.json:
```json
{
    "body": "This fixer changes code like `type(x) == T)` and `while 1:` and it introduces the `sorted()` function where appropriate.\n\nThese changes are optional, but they improve style and may provide a small performance gain.\n\nChanges according to `lib2to3/fixes/fix_idioms.py`:\n\n```\n* Change some type comparisons to isinstance() calls:\n    type(x) == T -> isinstance(x, T)\n    type(x) is T -> isinstance(x, T)\n    type(x) != T -> not isinstance(x, T)\n    type(x) is not T -> not isinstance(x, T)\n\n* Change \"while 1:\" into \"while True:\".\n\n* Change both\n    v = list(EXPR)\n    v.sort()\n    foo(v)\n\nand the more general\n    v = EXPR\n    v.sort()\n    foo(v)\n\ninto\n    v = sorted(EXPR)\n    foo(v)\n```\n\n\nKeywords: python3\n\nBranch/Commit: [6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Wilfried Luebbe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15984\n\n",
    "closed_at": "2014-04-08T12:41:27Z",
    "created_at": "2014-03-20T15:18:38Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Python 3 preparation: Change some code to use more modern Python idioms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15984",
    "user": "https://github.com/wluebbe"
}
```
This fixer changes code like `type(x) == T)` and `while 1:` and it introduces the `sorted()` function where appropriate.

These changes are optional, but they improve style and may provide a small performance gain.

Changes according to `lib2to3/fixes/fix_idioms.py`:

```
* Change some type comparisons to isinstance() calls:
    type(x) == T -> isinstance(x, T)
    type(x) is T -> isinstance(x, T)
    type(x) != T -> not isinstance(x, T)
    type(x) is not T -> not isinstance(x, T)

* Change "while 1:" into "while True:".

* Change both
    v = list(EXPR)
    v.sort()
    foo(v)

and the more general
    v = EXPR
    v.sort()
    foo(v)

into
    v = sorted(EXPR)
    foo(v)
```


Keywords: python3

Branch/Commit: [6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)

Reviewer: Travis Scrimshaw

Author: Wilfried Luebbe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15984





---

archive/issue_comments_263597.json:
```json
{
    "body": "Branch: [u/wluebbe/ticket/15984](https://github.com/sagemath/sagetrac-mirror/tree/u/wluebbe/ticket/15984)",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263597",
    "user": "https://github.com/wluebbe"
}
```

Branch: [u/wluebbe/ticket/15984](https://github.com/sagemath/sagetrac-mirror/tree/u/wluebbe/ticket/15984)



---

archive/issue_comments_263598.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263598",
    "user": "https://github.com/wluebbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_263599.json:
```json
{
    "body": "<a id='comment:1'></a>\n* At first I applied the 2to3 tool (idioms) -> first commit  \n* Fixing the doctests failures of the first commit -> second commit. All tests passed.\n* Changed `while 1:` into `while True:` for cython modules -> third commit.\n \n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[86de429](https://github.com/sagemath/sagetrac-mirror/commit/86de42958864006b263231dc0245c68e5e367b78)|`changes made by 2to3 tool (idioms), many changes`|\n|[1f05981](https://github.com/sagemath/sagetrac-mirror/commit/1f059812415dbf4915dff9895228c9d28a07fe68)|`reverted changes to 4 modules done by 2to3 tool`|\n|[85f7d5e](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)|`change \"while 1:\" into \"while True:\" for .pyx modules`|",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263599",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:1'></a>
* At first I applied the 2to3 tool (idioms) -> first commit  
* Fixing the doctests failures of the first commit -> second commit. All tests passed.
* Changed `while 1:` into `while True:` for cython modules -> third commit.
 
---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[86de429](https://github.com/sagemath/sagetrac-mirror/commit/86de42958864006b263231dc0245c68e5e367b78)|`changes made by 2to3 tool (idioms), many changes`|
|[1f05981](https://github.com/sagemath/sagetrac-mirror/commit/1f059812415dbf4915dff9895228c9d28a07fe68)|`reverted changes to 4 modules done by 2to3 tool`|
|[85f7d5e](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)|`change "while 1:" into "while True:" for .pyx modules`|



---

archive/issue_comments_263600.json:
```json
{
    "body": "Commit: [85f7d5e4d37663aa841e33a52664d1e070c32fa6](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263600",
    "user": "https://github.com/wluebbe"
}
```

Commit: [85f7d5e4d37663aa841e33a52664d1e070c32fa6](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)



---

archive/issue_comments_263601.json:
```json
{
    "body": "Changing commit from \"[85f7d5e4d37663aa841e33a52664d1e070c32fa6](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)\" to \"[6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)\"",
    "created_at": "2014-04-03T08:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[85f7d5e4d37663aa841e33a52664d1e070c32fa6](https://github.com/sagemath/sagetrac-mirror/commit/85f7d5e4d37663aa841e33a52664d1e070c32fa6)" to "[6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)"



---

archive/issue_comments_263602.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[617b158](https://github.com/sagemath/sagetrac-mirror/commit/617b158e860c87fc139362156ed32731e50dd491)|`changes made by 2to3 tool (idioms), many changes`|\n|[85ef438](https://github.com/sagemath/sagetrac-mirror/commit/85ef438f971cd5a7f87d55552f8ccd13715289e1)|`reverted changes to 4 modules done by 2to3 tool`|\n|[6964533](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)|`change \"while 1:\" into \"while True:\" for .pyx modules`|",
    "created_at": "2014-04-03T08:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[617b158](https://github.com/sagemath/sagetrac-mirror/commit/617b158e860c87fc139362156ed32731e50dd491)|`changes made by 2to3 tool (idioms), many changes`|
|[85ef438](https://github.com/sagemath/sagetrac-mirror/commit/85ef438f971cd5a7f87d55552f8ccd13715289e1)|`reverted changes to 4 modules done by 2to3 tool`|
|[6964533](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)|`change "while 1:" into "while True:" for .pyx modules`|



---

archive/issue_comments_263603.json:
```json
{
    "body": "<a id='comment:3'></a>\nRebased on 6.2.beta6 and resolved merge conflicts.",
    "created_at": "2014-04-03T08:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263603",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:3'></a>
Rebased on 6.2.beta6 and resolved merge conflicts.



---

archive/issue_comments_263604.json:
```json
{
    "body": "<a id='comment:4'></a>\nAnd the test report:\n\n```\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 3214.7 seconds\n```",
    "created_at": "2014-04-04T17:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263604",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:4'></a>
And the test report:

```
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 3214.7 seconds
```



---

archive/issue_comments_263605.json:
```json
{
    "body": "<a id='comment:5'></a>\nI think it would also be good to change `x == None` to `x is None` while we're at it.",
    "created_at": "2014-04-06T03:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263605",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
I think it would also be good to change `x == None` to `x is None` while we're at it.



---

archive/issue_comments_263606.json:
```json
{
    "body": "<a id='comment:6'></a>\nThere are 151 modules (py and pyx combined) which have at least one of `== None` or `!= None`. \n\n\nThe change makes sense as (by far) most modules use `is None` or `is not None`.\n\nBut as this change is already pretty large I would prefer to see this change in a separate ticket/branch.",
    "created_at": "2014-04-06T12:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263606",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:6'></a>
There are 151 modules (py and pyx combined) which have at least one of `== None` or `!= None`. 


The change makes sense as (by far) most modules use `is None` or `is not None`.

But as this change is already pretty large I would prefer to see this change in a separate ticket/branch.



---

archive/issue_comments_263607.json:
```json
{
    "body": "<a id='comment:7'></a>\nI think it fits well with this ticket (plus how many of those modules overlap with this one?). Also one large sweeping change is the same to me as two large sweeping changes (especially with different commits), but with the added benefit of an only one time potential rebase. If you still disagree and want it in a separate ticket, then you can set this to positive review.",
    "created_at": "2014-04-07T19:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263607",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
I think it fits well with this ticket (plus how many of those modules overlap with this one?). Also one large sweeping change is the same to me as two large sweeping changes (especially with different commits), but with the added benefit of an only one time potential rebase. If you still disagree and want it in a separate ticket, then you can set this to positive review.



---

archive/issue_comments_263608.json:
```json
{
    "body": "Reviewer: Travis Scrimshaw",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263608",
    "user": "https://github.com/wluebbe"
}
```

Reviewer: Travis Scrimshaw



---

archive/issue_comments_263609.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263609",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_263610.json:
```json
{
    "body": "<a id='comment:8'></a>\nI generated 151 patched py and pyx files. 3 pyx files gave doctest failures. And I got merge conflicts with this branch.\n\nTherefor I set this ticket to \"positive review\" (as suggested above).\n\nI will open a separate ticket for `== None` and generate fresh patches when this ticket is merged in a beta or release.",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263610",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:8'></a>
I generated 151 patched py and pyx files. 3 pyx files gave doctest failures. And I got merge conflicts with this branch.

Therefor I set this ticket to "positive review" (as suggested above).

I will open a separate ticket for `== None` and generate fresh patches when this ticket is merged in a beta or release.



---

archive/issue_comments_263611.json:
```json
{
    "body": "Author: Wilfried Luebbe",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263611",
    "user": "https://github.com/wluebbe"
}
```

Author: Wilfried Luebbe



---

archive/issue_events_053563.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-08T12:41:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15984#event-53563"
}
```



---

archive/issue_comments_263612.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-08T12:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263612",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_263613.json:
```json
{
    "body": "Changing branch from \"[u/wluebbe/ticket/15984](https://github.com/sagemath/sagetrac-mirror/tree/u/wluebbe/ticket/15984)\" to \"[6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)\"",
    "created_at": "2014-04-08T12:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15984#issuecomment-263613",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/wluebbe/ticket/15984](https://github.com/sagemath/sagetrac-mirror/tree/u/wluebbe/ticket/15984)" to "[6964533eb27d07a2d1bcccb0dbfc7214edb57b16](https://github.com/sagemath/sagetrac-mirror/commit/6964533eb27d07a2d1bcccb0dbfc7214edb57b16)"
