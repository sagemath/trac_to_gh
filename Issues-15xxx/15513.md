# Issue 15513: Generic factorization algorithms for polynomials over field extensions and similar constructions

archive/issues_015276.json:
```json
{
    "body": "CC:  @defeo\n\nImplement generic (univariate?) polynomial factorization algorithms\nover ground fields obtained through standard constructions.\n\nRationale: factorization is a fundamental building block of computer\nalgebra. Students and colleagues are stumbling over this over on this\nmissing feature while playing with not so exotic fields built from\nstandard ones.\n\nHere is for example a translation in Sage of my old favorite demo in\nMuPAD illustrating constructions and generic algorithms:\n\n```\n    sage: Qx.<x> = QQ[]\n    sage: Qxz.<z> = Qx.fraction_field()[]\n    sage: F.<z> = Qxz.quo(z^2-x)\n    sage: P.<u> = F[]\n    sage: z*u   * z\n    x*u\n    sage: (u^2 - x^3).factor()     # Should return (u + x z) (u - x z)\n    *NotImplementedError*\n```\n\nTODO: review the literature, what's already implemented, and what\ncould be; provide examples in each case. Split the ticket as\nappropriate.\n\n# Factorization over a transcendental extension F(x)\n\nAssuming one can factor (univariate) polynomials over F, implement\nfactorization for (univariate) polynomials over F(z).\n\n\n# Factorization over an algebraic extension F(a)\n\nAssuming one can factor (univariate) polynomials over F, implement\nfactorization for (univariate) polynomials over F(a).\n\nTaken from the MuPAD library:\n\n```\n  faclib::algfactor(a,flag) factors the polynomial a in F(alpha)[z]\n  or tests it for irreducibility only, depending on flag \n  \n  Input: a is a bivariate polynomial in z and alpha, \n         flag: TRUE or FALSE\n  Output: if flag <> FALSE then list of factors of a\n          if flag is FALSE then TRUE if a is irreducible\n\t\t\t\tFALSE if a is reducible\n\n  Reference: Geddes et al, Algorithms for Computer Algebra, algorithm\n  AlgebraicFactorization page 383\n```\n\n# Factorization over polynomial rings F[...]\n\n```\n    sage: K.<x0,x1> = QQ[]\n    sage: R.<x> = K[]\n    sage: factor(x^2 - (x0+x1)*x)\n    NotImplementedError\n```\n\n# Special case: bivariate polynomials\n\n```\n  factorization of bivariate polynomials over a field F\n             or of univariate polynomials over F[y]\n\n  The algorithm implemented in faclib::FACTOR is based on Hensel lifting\n  and short vector computation. It works for the factorization of an\n  univariate polynomial over F[y][x] over any ring y. \n  Reference: von zur Gathen, Hensel and Newton Methods in Valuation Rings, Math.Comp.\n\t\t166(1984), pp. 637-661.\n  The complexity is O(n^6 m^2 + n log q) operations in F_q when\n  F=F_q, and where n = deg(f,x) and m = deg(f,y).\n```\n\n# Some old data points\n\nFor the record, there has been progress lately, with factorization\nimplemented in more situations. Here are examples that used to fail\nwith Sage 5.8 and work with Sage 6.4:\n\n```\n    sage: Px.<x> = QQ[]\n    sage: Qx = Px.fraction_field()\n    sage: Qxz = Qx['z']\n    sage: z = Qxz.gen()\n    sage: (z^2-x).factor()\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15513\n\n",
    "created_at": "2013-12-11T21:38:38Z",
    "labels": [
        "component: factorization"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Generic factorization algorithms for polynomials over field extensions and similar constructions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15513",
    "user": "https://github.com/nthiery"
}
```
CC:  @defeo

Implement generic (univariate?) polynomial factorization algorithms
over ground fields obtained through standard constructions.

Rationale: factorization is a fundamental building block of computer
algebra. Students and colleagues are stumbling over this over on this
missing feature while playing with not so exotic fields built from
standard ones.

Here is for example a translation in Sage of my old favorite demo in
MuPAD illustrating constructions and generic algorithms:

```
    sage: Qx.<x> = QQ[]
    sage: Qxz.<z> = Qx.fraction_field()[]
    sage: F.<z> = Qxz.quo(z^2-x)
    sage: P.<u> = F[]
    sage: z*u   * z
    x*u
    sage: (u^2 - x^3).factor()     # Should return (u + x z) (u - x z)
    *NotImplementedError*
```

TODO: review the literature, what's already implemented, and what
could be; provide examples in each case. Split the ticket as
appropriate.

# Factorization over a transcendental extension F(x)

Assuming one can factor (univariate) polynomials over F, implement
factorization for (univariate) polynomials over F(z).


# Factorization over an algebraic extension F(a)

Assuming one can factor (univariate) polynomials over F, implement
factorization for (univariate) polynomials over F(a).

Taken from the MuPAD library:

```
  faclib::algfactor(a,flag) factors the polynomial a in F(alpha)[z]
  or tests it for irreducibility only, depending on flag 
  
  Input: a is a bivariate polynomial in z and alpha, 
         flag: TRUE or FALSE
  Output: if flag <> FALSE then list of factors of a
          if flag is FALSE then TRUE if a is irreducible
				FALSE if a is reducible

  Reference: Geddes et al, Algorithms for Computer Algebra, algorithm
  AlgebraicFactorization page 383
```

# Factorization over polynomial rings F[...]

```
    sage: K.<x0,x1> = QQ[]
    sage: R.<x> = K[]
    sage: factor(x^2 - (x0+x1)*x)
    NotImplementedError
```

# Special case: bivariate polynomials

```
  factorization of bivariate polynomials over a field F
             or of univariate polynomials over F[y]

  The algorithm implemented in faclib::FACTOR is based on Hensel lifting
  and short vector computation. It works for the factorization of an
  univariate polynomial over F[y][x] over any ring y. 
  Reference: von zur Gathen, Hensel and Newton Methods in Valuation Rings, Math.Comp.
		166(1984), pp. 637-661.
  The complexity is O(n^6 m^2 + n log q) operations in F_q when
  F=F_q, and where n = deg(f,x) and m = deg(f,y).
```

# Some old data points

For the record, there has been progress lately, with factorization
implemented in more situations. Here are examples that used to fail
with Sage 5.8 and work with Sage 6.4:

```
    sage: Px.<x> = QQ[]
    sage: Qx = Px.fraction_field()
    sage: Qxz = Qx['z']
    sage: z = Qxz.gen()
    sage: (z^2-x).factor()
```


Issue created by migration from https://trac.sagemath.org/ticket/15513





---

archive/issue_events_045310.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15513#event-45310"
}
```



---

archive/issue_events_045311.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15513#event-45311"
}
```



---

archive/issue_events_045312.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15513#event-45312"
}
```



---

archive/issue_events_045313.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15513#event-45313"
}
```



---

archive/issue_events_045314.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15513#event-45314"
}
```



---

archive/issue_comments_196209.json:
```json
{
    "body": "Replying to [ticket:15513 nthiery]:\n> Sage is still missing a generic implementation of factorization that would\n> work over any (reasonable) field.\n\nThis issue is **way** too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)",
    "created_at": "2014-10-08T09:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196209",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:15513 nthiery]:
> Sage is still missing a generic implementation of factorization that would
> work over any (reasonable) field.

This issue is **way** too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)



---

archive/issue_comments_196210.json:
```json
{
    "body": "Replying to [comment:6 jdemeyer]:\n> Replying to [ticket:15513 nthiery]:\n> > Sage is still missing a generic implementation of factorization that would\n> > work over any (reasonable) field.\n\n> This issue is **way** too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)\n\nWhy too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields. There exists algorithms for this, e.g. implemented in MuPAD.",
    "created_at": "2014-10-08T09:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196210",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:6 jdemeyer]:
> Replying to [ticket:15513 nthiery]:
> > Sage is still missing a generic implementation of factorization that would
> > work over any (reasonable) field.

> This issue is **way** too general. I think it fails bullet points 2 and 4 of [http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets](http://www.sagemath.org/doc/developer/trac.html#guidelines-for-opening-tickets)

Why too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields. There exists algorithms for this, e.g. implemented in MuPAD.



---

archive/issue_comments_196211.json:
```json
{
    "body": "Please remove the working examples from the ticket description such that it's more clear what you actually want.",
    "created_at": "2014-10-08T09:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196211",
    "user": "https://github.com/jdemeyer"
}
```

Please remove the working examples from the ticket description such that it's more clear what you actually want.



---

archive/issue_comments_196212.json:
```json
{
    "body": "Replying to [comment:8 nthiery]:\n> Why too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields.\n\nFine, but none of the examples in your description was an example of a factorization of a **multi**-variate polynomial over a **field** which currently **fails** in Sage.",
    "created_at": "2014-10-08T11:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196212",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:8 nthiery]:
> Why too general? It asks for a very specific feature: having a default generic implementation of multivariate polynomials over (reasonably computable) fields.

Fine, but none of the examples in your description was an example of a factorization of a **multi**-variate polynomial over a **field** which currently **fails** in Sage.



---

archive/issue_comments_196213.json:
```json
{
    "body": "Note: I'm not trying to deny that there are issues with factorization of polynomials in Sage, but at least make it clear what this ticket is really about.",
    "created_at": "2014-10-08T11:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196213",
    "user": "https://github.com/jdemeyer"
}
```

Note: I'm not trying to deny that there are issues with factorization of polynomials in Sage, but at least make it clear what this ticket is really about.



---

archive/issue_comments_196214.json:
```json
{
    "body": "I agree that the description was crappy, and my latest update had not improved it. I was in the middle of discussion with the Singular people and just wanted to make sure I had updated the datapoints, before going back to it later.\n\nBut please don't destroy data points! Those are vital to reproduce issues and measure progress.",
    "created_at": "2014-10-09T11:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196214",
    "user": "https://github.com/nthiery"
}
```

I agree that the description was crappy, and my latest update had not improved it. I was in the middle of discussion with the Singular people and just wanted to make sure I had updated the datapoints, before going back to it later.

But please don't destroy data points! Those are vital to reproduce issues and measure progress.



---

archive/issue_comments_196215.json:
```json
{
    "body": "Replying to [comment:17 nthiery]:\n> But please don't destroy data points!\n\nInitially, I planned to remove all examples which didn't fit the description. Until I realized I had no examples left...",
    "created_at": "2014-10-09T11:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196215",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:17 nthiery]:
> But please don't destroy data points!

Initially, I planned to remove all examples which didn't fit the description. Until I realized I had no examples left...



---

archive/issue_comments_196216.json:
```json
{
    "body": "> Implement a generic implementation of univariate polynomial\n> factorization that would work over any (computable enough) field.\n\nThis is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.",
    "created_at": "2014-10-09T11:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196216",
    "user": "https://github.com/jdemeyer"
}
```

> Implement a generic implementation of univariate polynomial
> factorization that would work over any (computable enough) field.

This is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.



---

archive/issue_comments_196217.json:
```json
{
    "body": "Replying to [comment:17 nthiery]:\n> But please don't destroy data points! Those are vital to reproduce issues and measure progress.\n\nWhat's the point of having information like \"this used to fail, but now works\"?",
    "created_at": "2014-10-09T11:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196217",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:17 nthiery]:
> But please don't destroy data points! Those are vital to reproduce issues and measure progress.

What's the point of having information like "this used to fail, but now works"?



---

archive/issue_comments_196218.json:
```json
{
    "body": "Replying to [comment:19 jdemeyer]:\n> This is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.\n\n\nI agree we could split a second ticket for factorization over a ring. But for fields I don't see how it is too general: as far as I know, there exist generic algorithms that cover all cases.",
    "created_at": "2014-10-09T11:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196218",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:19 jdemeyer]:
> This is still way too general. I think the two examples you mention really should be 2 tickets, and those tickets should be just about those examples, nothing too general.


I agree we could split a second ticket for factorization over a ring. But for fields I don't see how it is too general: as far as I know, there exist generic algorithms that cover all cases.



---

archive/issue_comments_196219.json:
```json
{
    "body": "Replying to [comment:20 jdemeyer]:\n> Replying to [comment:17 nthiery]:\n> > But please don't destroy data points! Those are vital to reproduce issues and measure progress.\n\n> What's the point of having information like \"this used to fail, but now works\"?\n\nTracking progress, and keeping a trace of history. For example, people may stumble on similar issues with various versions of Sage and want to report it. And learn from the ticket \"nice, my special case is now fixed, but I should be careful because not all cases are\".\n\nAnd honestly I don't see, with the new layout, what disadvantage there can be of having this information.\n\nAnyway, I am bailing out of this discussion. It's not my area, I have tried to bring in as much useful information I could, if you know better how to lay it out so that the job gets done, go ahead.",
    "created_at": "2014-10-09T11:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196219",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:20 jdemeyer]:
> Replying to [comment:17 nthiery]:
> > But please don't destroy data points! Those are vital to reproduce issues and measure progress.

> What's the point of having information like "this used to fail, but now works"?

Tracking progress, and keeping a trace of history. For example, people may stumble on similar issues with various versions of Sage and want to report it. And learn from the ticket "nice, my special case is now fixed, but I should be careful because not all cases are".

And honestly I don't see, with the new layout, what disadvantage there can be of having this information.

Anyway, I am bailing out of this discussion. It's not my area, I have tried to bring in as much useful information I could, if you know better how to lay it out so that the job gets done, go ahead.



---

archive/issue_comments_196220.json:
```json
{
    "body": "Replying to [comment:21 nthiery]:\n> as far as I know, there exist generic algorithms that cover all cases.\n\nI have very strong doubts about this. Factorization algorithms over `CC`, over `QQ` and over `GF(q)` are very different, so I don't see how one algorithm could work in all cases.",
    "created_at": "2014-10-09T11:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196220",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:21 nthiery]:
> as far as I know, there exist generic algorithms that cover all cases.

I have very strong doubts about this. Factorization algorithms over `CC`, over `QQ` and over `GF(q)` are very different, so I don't see how one algorithm could work in all cases.



---

archive/issue_comments_196221.json:
```json
{
    "body": "Replying to [comment:22 nthiery]:\n> And honestly I don't see, with the new layout, what disadvantage there can be of having this information.\n\nToo much irrelevant information can be confusing. But I'll leave it for now.",
    "created_at": "2014-10-09T11:52:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196221",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:22 nthiery]:
> And honestly I don't see, with the new layout, what disadvantage there can be of having this information.

Too much irrelevant information can be confusing. But I'll leave it for now.



---

archive/issue_comments_196222.json:
```json
{
    "body": "> as far as I know, there exist generic algorithms that cover all cases.\n\nThere are generic algorithms for factorization of multi-variate polynomials, assuming you can do uni-variate factorization. Perhaps that's what you had in mind?",
    "created_at": "2014-10-09T12:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196222",
    "user": "https://github.com/jdemeyer"
}
```

> as far as I know, there exist generic algorithms that cover all cases.

There are generic algorithms for factorization of multi-variate polynomials, assuming you can do uni-variate factorization. Perhaps that's what you had in mind?



---

archive/issue_comments_196223.json:
```json
{
    "body": "Oh, wait, wait, wait, where is my mind ... Yes, of course factorization over K[x] for K=QQ, CC, ... is completely different; I am even illustrating this in my usuals intros to Sage :-)\n\nSo, let's see. What I had in mind was indeed generic factorization algorithm for the standard constructions of fields from existing ones.\n\nOk, I'll try now to rewrite the description in a proper way. It's not my area, so please clarify it :-)",
    "created_at": "2014-10-10T12:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196223",
    "user": "https://github.com/nthiery"
}
```

Oh, wait, wait, wait, where is my mind ... Yes, of course factorization over K[x] for K=QQ, CC, ... is completely different; I am even illustrating this in my usuals intros to Sage :-)

So, let's see. What I had in mind was indeed generic factorization algorithm for the standard constructions of fields from existing ones.

Ok, I'll try now to rewrite the description in a proper way. It's not my area, so please clarify it :-)



---

archive/issue_comments_196224.json:
```json
{
    "body": "Changing type from enhancement to task.",
    "created_at": "2014-10-10T13:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196224",
    "user": "https://github.com/nthiery"
}
```

Changing type from enhancement to task.



---

archive/issue_comments_196225.json:
```json
{
    "body": "Ok, a first draft is there. Please, someone competent, expand it as appropriate!",
    "created_at": "2014-10-10T13:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15513#issuecomment-196225",
    "user": "https://github.com/nthiery"
}
```

Ok, a first draft is there. Please, someone competent, expand it as appropriate!
