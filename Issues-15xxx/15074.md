# Issue 15074: Allowing 'textbook style' derivative output from pynac

archive/issues_014837.json:
```json
{
    "body": "This is to allow for 'textbook style' of derivatives - something like \\partial!^!{2}/\\partial xy\\,f(x, y), instead of D[0,1](f)(x,y) for a more readable output, especially in LaTeX in the notebook environment. I imagine it working like this:\n\n```\nsage: var('x y z'); f = function('f', x, y, z)\nsage: from sage.symbolic.pynac import textbook_style_deriv \nsage: textbook_style_deriv(True) \nsage: f.diff(x,z,y,z) \nD^4/Dxyzz f(x, y, z) \nsage: latex(f.diff(x,z,y,z)) \n\\frac{\\partial^4}{\\partial\\,xyzz}f(x, y, z) \nsage: textbook_style_deriv(False) \nsage: f.diff(x,z,y,z) \nD[0, 1, 2, 2](f)(x, y, z)\n```\n\nCC:  @egourgoulhon\n\nReviewer: Eric Gourgoulhon\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/15074\n\n",
    "closed_at": "2021-10-04T23:44:13Z",
    "created_at": "2013-08-21T13:38:18Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Allowing 'textbook style' derivative output from pynac",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15074",
    "user": "https://trac.sagemath.org/admin/accounts/users/mbejger"
}
```
This is to allow for 'textbook style' of derivatives - something like \partial!^!{2}/\partial xy\,f(x, y), instead of D[0,1](f)(x,y) for a more readable output, especially in LaTeX in the notebook environment. I imagine it working like this:

```
sage: var('x y z'); f = function('f', x, y, z)
sage: from sage.symbolic.pynac import textbook_style_deriv 
sage: textbook_style_deriv(True) 
sage: f.diff(x,z,y,z) 
D^4/Dxyzz f(x, y, z) 
sage: latex(f.diff(x,z,y,z)) 
\frac{\partial^4}{\partial\,xyzz}f(x, y, z) 
sage: textbook_style_deriv(False) 
sage: f.diff(x,z,y,z) 
D[0, 1, 2, 2](f)(x, y, z)
```

CC:  @egourgoulhon

Reviewer: Eric Gourgoulhon

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/15074





---

archive/issue_comments_237522.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [trac_15074_textbook_style_deriv_pynac.patch](tarball://root/attachments/some-uuid/ticket15074/trac_15074_textbook_style_deriv_pynac.patch) by @nbruin created at 2013-08-21 14:42:23\n\nI think this has been proposed before. The problem is that there is not enough information available to use Leibniz notation. Consider the following examples and decide \n\n```\nsage: var(\"x,y,u,v\")\nsage: function('f')\nsage: ddf=f(x,y).diff(x,y).operator()\nsage: ddf(x^2+y^2,x-y)   ## 1\nD[0, 1](f)(x^2 + y^2, x - y)\nsage: ddf(v,u)           ## 2\nD[0, 1](f)(v, u)\nsage: ddf(x,x^2+y)           ## 3\nD[0, 1](f)(x, x^2+y)\n```\nI think Maple uses Leibniz notation if it applies (i.e., all parameters are distinct pure variables) and reverts to operator (Euler?) notation otherwise; also indexed by parameter position rather than name.",
    "created_at": "2013-08-21T14:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237522",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:1'></a>Attachment [trac_15074_textbook_style_deriv_pynac.patch](tarball://root/attachments/some-uuid/ticket15074/trac_15074_textbook_style_deriv_pynac.patch) by @nbruin created at 2013-08-21 14:42:23

I think this has been proposed before. The problem is that there is not enough information available to use Leibniz notation. Consider the following examples and decide 

```
sage: var("x,y,u,v")
sage: function('f')
sage: ddf=f(x,y).diff(x,y).operator()
sage: ddf(x^2+y^2,x-y)   ## 1
D[0, 1](f)(x^2 + y^2, x - y)
sage: ddf(v,u)           ## 2
D[0, 1](f)(v, u)
sage: ddf(x,x^2+y)           ## 3
D[0, 1](f)(x, x^2+y)
```
I think Maple uses Leibniz notation if it applies (i.e., all parameters are distinct pure variables) and reverts to operator (Euler?) notation otherwise; also indexed by parameter position rather than name.



---

archive/issue_comments_237523.json:
```json
{
    "body": "<a id='comment:2'></a>I see your point, but still think that it would be good to have an option for the Leibniz notation. Most of the time in physical applications the variables are pure variables anyway, and for some reason, depending on the context the user may decide to have such an output. Also, these notations are equivalent in the sense that no new information is added or taken away, it is just a matter of presenting them this of that way.",
    "created_at": "2013-08-22T08:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237523",
    "user": "https://trac.sagemath.org/admin/accounts/users/mbejger"
}
```

<a id='comment:2'></a>I see your point, but still think that it would be good to have an option for the Leibniz notation. Most of the time in physical applications the variables are pure variables anyway, and for some reason, depending on the context the user may decide to have such an output. Also, these notations are equivalent in the sense that no new information is added or taken away, it is just a matter of presenting them this of that way.



---

archive/issue_comments_237524.json:
```json
{
    "body": "<a id='comment:4'></a>Attachment [trac_15074_textbook_style_deriv_pynac_v2.patch](tarball://root/attachments/some-uuid/ticket15074/trac_15074_textbook_style_deriv_pynac_v2.patch) by mbejger created at 2013-09-10 21:03:24\n\nDear All, I have added a newer patch with an additional switch that allows for omitting the arguments of a function: \n\n```\nvar('x y z'); f = function('f', x, y, z)\nf.diff(x,z,y,z)\nD[0, 1, 2, 2](f)(x, y, z)\nfrom sage.symbolic.pynac import omit_function_args\nomit_function_args(True)\nD[0, 1, 2, 2](f)\n```",
    "created_at": "2013-09-10T21:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237524",
    "user": "https://trac.sagemath.org/admin/accounts/users/mbejger"
}
```

<a id='comment:4'></a>Attachment [trac_15074_textbook_style_deriv_pynac_v2.patch](tarball://root/attachments/some-uuid/ticket15074/trac_15074_textbook_style_deriv_pynac_v2.patch) by mbejger created at 2013-09-10 21:03:24

Dear All, I have added a newer patch with an additional switch that allows for omitting the arguments of a function: 

```
var('x y z'); f = function('f', x, y, z)
f.diff(x,z,y,z)
D[0, 1, 2, 2](f)(x, y, z)
from sage.symbolic.pynac import omit_function_args
omit_function_args(True)
D[0, 1, 2, 2](f)
```



---

archive/issue_comments_237525.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 mbejger]:\n> Dear All, I have added a newer patch with an additional switch that allows for omitting the arguments of a function: \n> \n> \n> ```\n> var('x y z'); f = function('f', x, y, z)\n> f.diff(x,z,y,z)\n> D[0, 1, 2, 2](f)(x, y, z)\n> from sage.symbolic.pynac import omit_function_args\n> omit_function_args(True)\n> D[0, 1, 2, 2](f)\n> ```\n\nNot a good idea. How do you tell apart the two following extremely different objects:\n\n```\nsage: sage.symbolic.operators.FDerivativeOperator(f,[0,1,2,2])\nD[0, 1, 2, 2](f)\nsage: f(x,y,z).diff(x,z,y,z)\nD[0, 1, 2, 2](f)(x, y, z)\n```\nThe standard printing reflects exactly their relation: The second is obtained by evaluating the first at `(x,y,z)`.\n\nI think having a printing option that does something along the lines of\n\n```\nif (isinstance(expr.operator(), sage.symbolic.operators.FDerivativeOperator) and\n        are_all_distinct_pure_variables(expr.operands())):\n    return \"diff(%s%s,%s)\"%(\n        expr.operator().function(),\n        tuple(expr.operands()),\n        tuple( v.operands()[i] for i in v.operator().parameter_set())\nelse:\n    return <normal string rep>\n```\nwould be reasonable. That's the same approach maple seems to take.",
    "created_at": "2013-09-10T21:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237525",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:5'></a>Replying to [comment:4 mbejger]:
> Dear All, I have added a newer patch with an additional switch that allows for omitting the arguments of a function: 
> 
> 
> ```
> var('x y z'); f = function('f', x, y, z)
> f.diff(x,z,y,z)
> D[0, 1, 2, 2](f)(x, y, z)
> from sage.symbolic.pynac import omit_function_args
> omit_function_args(True)
> D[0, 1, 2, 2](f)
> ```

Not a good idea. How do you tell apart the two following extremely different objects:

```
sage: sage.symbolic.operators.FDerivativeOperator(f,[0,1,2,2])
D[0, 1, 2, 2](f)
sage: f(x,y,z).diff(x,z,y,z)
D[0, 1, 2, 2](f)(x, y, z)
```
The standard printing reflects exactly their relation: The second is obtained by evaluating the first at `(x,y,z)`.

I think having a printing option that does something along the lines of

```
if (isinstance(expr.operator(), sage.symbolic.operators.FDerivativeOperator) and
        are_all_distinct_pure_variables(expr.operands())):
    return "diff(%s%s,%s)"%(
        expr.operator().function(),
        tuple(expr.operands()),
        tuple( v.operands()[i] for i in v.operator().parameter_set())
else:
    return <normal string rep>
```
would be reasonable. That's the same approach maple seems to take.



---

archive/issue_comments_237526.json:
```json
{
    "body": "<a id='comment:6'></a>I agree that the arguments must be kept if the output is subject to further manipulations (e.g. the output is a symbolic expression). But it would be nice to remove them for *final* outputs, like LaTeX printing: this would greatly improve human readability of lengthy expressions.",
    "created_at": "2013-09-11T08:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237526",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'></a>I agree that the arguments must be kept if the output is subject to further manipulations (e.g. the output is a symbolic expression). But it would be nice to remove them for *final* outputs, like LaTeX printing: this would greatly improve human readability of lengthy expressions.



---

archive/issue_events_043357.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43357"
}
```



---

archive/issue_events_043358.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43358"
}
```



---

archive/issue_events_043359.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43359"
}
```



---

archive/issue_events_043360.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43360"
}
```



---

archive/issue_events_043361.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43361"
}
```



---

archive/issue_events_043362.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-09-23T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43362"
}
```



---

archive/issue_events_043363.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-09-23T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43363"
}
```



---

archive/issue_comments_237527.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-23T17:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237527",
    "user": "https://github.com/nbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_237528.json:
```json
{
    "body": "<a id='comment:10'></a>I think this can be closed as \"invalid/fixed/obsolete\". This is how it works nowadays:\n\n```\nsage: var('x,y,z')                                                                                                          \n(x, y, z)\nsage: function('f')                                                                                                         \nf\nsage: f(x,y,z).diff(x,z,y,z)                                                                                                \ndiff(f(x, y, z), x, y, z, z)\n```",
    "created_at": "2021-09-23T17:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237528",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:10'></a>I think this can be closed as "invalid/fixed/obsolete". This is how it works nowadays:

```
sage: var('x,y,z')                                                                                                          
(x, y, z)
sage: function('f')                                                                                                         
f
sage: f(x,y,z).diff(x,z,y,z)                                                                                                
diff(f(x, y, z), x, y, z, z)
```



---

archive/issue_comments_237529.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Eric Gourgoulhon\"",
    "created_at": "2021-09-23T18:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237529",
    "user": "https://github.com/egourgoulhon"
}
```

Changing reviewer from "" to "Eric Gourgoulhon"



---

archive/issue_comments_237530.json:
```json
{
    "body": "<a id='comment:11'></a>Indeed this can be closed.",
    "created_at": "2021-09-23T18:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237530",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:11'></a>Indeed this can be closed.



---

archive/issue_comments_237531.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-23T18:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237531",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_043364.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-04T23:44:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15074#event-43364"
}
```



---

archive/issue_comments_237532.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-10-04T23:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15074",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15074#issuecomment-237532",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
