# Issue 15136: spkg-install improvements

archive/issues_014899.json:
```json
{
    "body": "The build system #14796 works better with some minor tweaks to some spkg-install scripts.\n\n- with idempotence, \"keepbuilt\" starts to make sense\n- without hardwired paths, compiling with packages disabled (=fallback to system) works\n- with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible\n- with a list of files that belong to a package, unstaging is easy.\n- setting write permissions for copied files allows cleanup, even if the source files are not writable\n\nthese changes are minimal (for each package) and are intended to not break the old build system. This is a series of individual patches. Opening up ~100 tickets doesn't seem appropriate.\n\n\nKeywords: spkg-install idempotence environment filelist\n\nReviewer: Dima Pasechnik\n\nDependencies: #14750, #14804\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/15136\n\n",
    "closed_at": "2020-10-11T22:19:46Z",
    "created_at": "2013-09-01T15:37:38Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "spkg-install improvements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15136",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```
The build system #14796 works better with some minor tweaks to some spkg-install scripts.

- with idempotence, "keepbuilt" starts to make sense
- without hardwired paths, compiling with packages disabled (=fallback to system) works
- with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible
- with a list of files that belong to a package, unstaging is easy.
- setting write permissions for copied files allows cleanup, even if the source files are not writable

these changes are minimal (for each package) and are intended to not break the old build system. This is a series of individual patches. Opening up ~100 tickets doesn't seem appropriate.


Keywords: spkg-install idempotence environment filelist

Reviewer: Dima Pasechnik

Dependencies: #14750, #14804

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/15136





---

archive/issue_comments_202849.json:
```json
{
    "body": "Changing keywords from \"spkg-install idempotence environment\" to \"spkg-install idempotence environment filelist\".",
    "created_at": "2013-09-02T07:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202849",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```

Changing keywords from "spkg-install idempotence environment" to "spkg-install idempotence environment filelist".



---

archive/issue_comments_202850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,10 +3,13 @@\n - with idempotence, \"keepbuilt\" starts to make sense\n - without hardwired paths, compiling with packages disabled (=fallback to system) works\n - with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible\n+- with a list of files that belong to a package, unstaging is easy.\n \n these changes are minimal (for each package) and are intended to not break the old build system.\n \n-Keywords: spkg-install idempotence environment\n+\n+\n+\n \n Author: Felix Salfelder\n \n``````\n",
    "created_at": "2013-09-02T07:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202850",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,10 +3,13 @@
 - with idempotence, "keepbuilt" starts to make sense
 - without hardwired paths, compiling with packages disabled (=fallback to system) works
 - with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible
+- with a list of files that belong to a package, unstaging is easy.
 
 these changes are minimal (for each package) and are intended to not break the old build system.
 
-Keywords: spkg-install idempotence environment
+
+
+
 
 Author: Felix Salfelder
 
``````




---

archive/issue_comments_202851.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-05T10:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202851",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_202852.json:
```json
{
    "body": "<a id='comment:3'></a>I have set \"needs_review\", subsequent commits will be independent.",
    "created_at": "2013-09-05T10:52:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202852",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```

<a id='comment:3'></a>I have set "needs_review", subsequent commits will be independent.



---

archive/issue_comments_202853.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+The build system #14796 works better with some minor tweaks to some spkg-install scripts.\n+\n+- with idempotence, \"keepbuilt\" starts to make sense\n+- without hardwired paths, compiling with packages disabled (=fallback to system) works\n+- with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible\n+- with a list of files that belong to a package, unstaging is easy.\n+- setting write permissions for copied files allows cleanup, even if the source files are not writable\n+\n+these changes are minimal (for each package) and are intended to not break the old build system. This is a series of individual patches. Opening up ~100 tickets doesn't seem appropriate.\n \n \n Author: Felix Salfelder\n``````\n",
    "created_at": "2013-09-05T10:52:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202853",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,12 @@
+The build system #14796 works better with some minor tweaks to some spkg-install scripts.
+
+- with idempotence, "keepbuilt" starts to make sense
+- without hardwired paths, compiling with packages disabled (=fallback to system) works
+- with environment in `$SAGE_ETC/env.d/*`, run time environment is more flexible
+- with a list of files that belong to a package, unstaging is easy.
+- setting write permissions for copied files allows cleanup, even if the source files are not writable
+
+these changes are minimal (for each package) and are intended to not break the old build system. This is a series of individual patches. Opening up ~100 tickets doesn't seem appropriate.
 
 
 Author: Felix Salfelder
``````




---

archive/issue_comments_202854.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-09-05T10:52:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202854",
    "user": "https://trac.sagemath.org/admin/accounts/users/felixs"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_202855.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-06T21:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202855",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_202856.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-07T18:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202856",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_202857.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-08T09:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_202858.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-16T18:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_202859.json:
```json
{
    "body": "<a id='comment:8'></a>Needs to be rebased.",
    "created_at": "2013-12-29T18:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202859",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Needs to be rebased.



---

archive/issue_comments_202860.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-12-29T18:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202860",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_043601.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43601"
}
```



---

archive/issue_events_043602.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43602"
}
```



---

archive/issue_events_043603.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43603"
}
```



---

archive/issue_events_043604.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43604"
}
```



---

archive/issue_events_043605.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43605"
}
```



---

archive/issue_comments_202861.json:
```json
{
    "body": "<a id='comment:12'></a>It's too bad this never went anywhere since it was a lot of work.  It seems to be redundant though with what I'm doing with #23160 #22509, and #22510.",
    "created_at": "2017-07-12T12:17:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202861",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>It's too bad this never went anywhere since it was a lot of work.  It seems to be redundant though with what I'm doing with #23160 #22509, and #22510.



---

archive/issue_events_043606.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-25T02:19:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43606"
}
```



---

archive/issue_events_043607.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-25T02:19:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43607"
}
```



---

archive/issue_comments_202862.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-04-25T02:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202862",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_202863.json:
```json
{
    "body": "<a id='comment:13'></a>Outdated, should be closed",
    "created_at": "2020-04-25T02:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202863",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Outdated, should be closed



---

archive/issue_comments_202864.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-06T21:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202864",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_043608.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-10-11T22:19:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15136#event-43608"
}
```



---

archive/issue_comments_202865.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2020-10-11T22:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15136",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15136#issuecomment-202865",
    "user": "https://github.com/slel"
}
```

Resolution: duplicate
