# Issue 15642: Use mirrors for tarballs

archive/issues_015405.json:
```json
{
    "body": "This ticket rewrites the `sage-download-file` script in pure Python. It is, first of all, a drop-in replacement of the current script. But it is now also aware of our tarballs, so you can just write e.g.\n\n```\nsage-download-file sympy-0.7.4.tar.gz\n```\nand it will download that tarball from the fastest mirror and verify its checksum.\n\n**CC:**  @ohanar tmonteil @haraldschilly\n\n**Branch/Commit:** [d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)\n\n**Reviewer:** Volker Braun\n\n**Author:** Volker Braun\n\nIssue created by migration from https://trac.sagemath.org/ticket/15642\n\n",
    "closed_at": "2015-05-13T20:11:27Z",
    "created_at": "2014-01-07T08:44:19Z",
    "labels": [
        "component: build",
        "blocker",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Use mirrors for tarballs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15642",
    "user": "https://github.com/vbraun"
}
```
This ticket rewrites the `sage-download-file` script in pure Python. It is, first of all, a drop-in replacement of the current script. But it is now also aware of our tarballs, so you can just write e.g.

```
sage-download-file sympy-0.7.4.tar.gz
```
and it will download that tarball from the fastest mirror and verify its checksum.

**CC:**  @ohanar tmonteil @haraldschilly

**Branch/Commit:** [d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)

**Reviewer:** Volker Braun

**Author:** Volker Braun

Issue created by migration from https://trac.sagemath.org/ticket/15642





---

archive/issue_comments_200575.json:
```json
{
    "body": "**Branch:** [u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)",
    "created_at": "2014-01-11T21:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200575",
    "user": "https://github.com/vbraun"
}
```

**Branch:** [u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)



---

archive/issue_comments_200576.json:
```json
{
    "body": "**Commit:** [dd4abcb7757c17e5a7bae9cf347c9d34e154503d](https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d)",
    "created_at": "2014-01-13T06:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [dd4abcb7757c17e5a7bae9cf347c9d34e154503d](https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d)



---

archive/issue_comments_200577.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39679681f304dcdf6df195fbc71254cebd395444\">3967968</a></td><td><code>Merge tag '6.1.beta4' into 'u/vbraun/use_mirrors_for_tarballs'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d\">dd4abcb</a></td><td><code>py3 fix, also try testing packages</code></td></tr></table>\n",
    "created_at": "2014-01-13T06:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39679681f304dcdf6df195fbc71254cebd395444">3967968</a></td><td><code>Merge tag '6.1.beta4' into 'u/vbraun/use_mirrors_for_tarballs'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d">dd4abcb</a></td><td><code>py3 fix, also try testing packages</code></td></tr></table>




---

archive/issue_events_141597.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-13T06:15:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141597"
}
```



---

archive/issue_events_141598.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-13T06:15:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141598"
}
```



---

archive/issue_events_141599.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-13T06:15:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "component: build",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141599"
}
```



---

archive/issue_comments_200578.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n+This ticket rewrites the `sage-download-file` script in pure Python. It is, first of all, a drop-in replacement of the current script. But it is now also aware of our tarballs, so you can just write e.g.\n \n+```\n+sage-download-file sympy-0.7.4.tar.gz\n+```\n+and it will download that tarball from the fastest mirror and verify its checksum.\n``````\n",
    "created_at": "2014-01-13T06:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200578",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,6 @@
+This ticket rewrites the `sage-download-file` script in pure Python. It is, first of all, a drop-in replacement of the current script. But it is now also aware of our tarballs, so you can just write e.g.
 
+```
+sage-download-file sympy-0.7.4.tar.gz
+```
+and it will download that tarball from the fastest mirror and verify its checksum.
``````




---

archive/issue_comments_200579.json:
```json
{
    "body": "**Changing commit** from \"[dd4abcb7757c17e5a7bae9cf347c9d34e154503d](https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d)\" to \"[b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49](https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49)\".",
    "created_at": "2014-01-13T19:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200579",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dd4abcb7757c17e5a7bae9cf347c9d34e154503d](https://github.com/sagemath/sagetrac-mirror/commit/dd4abcb7757c17e5a7bae9cf347c9d34e154503d)" to "[b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49](https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49)".



---

archive/issue_comments_200580.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49\">b1ef0b6</a></td><td><code>prefer SAGE_DISTFILES for upstream directory</code></td></tr></table>\n",
    "created_at": "2014-01-13T19:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49">b1ef0b6</a></td><td><code>prefer SAGE_DISTFILES for upstream directory</code></td></tr></table>




---

archive/issue_comments_200581.json:
```json
{
    "body": "<a id='comment:6'></a>\nI would replace the regex in `_parse_name` with something like\n\n```\n(?P<base>(?:[^-]|-(?!\\d))*)-(?P<version>.*)\\.(?P<ext>tar.*|zip|tgz)\n```\n(We may as well support more general package names, even if our restrictive naming convention doesn't allow it at the moment.)",
    "created_at": "2014-01-14T09:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200581",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:6'></a>
I would replace the regex in `_parse_name` with something like

```
(?P<base>(?:[^-]|-(?!\d))*)-(?P<version>.*)\.(?P<ext>tar.*|zip|tgz)
```
(We may as well support more general package names, even if our restrictive naming convention doesn't allow it at the moment.)



---

archive/issue_comments_200582.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad\">cd155cf</a></td><td><code>more general tarball regex</code></td></tr></table>\n",
    "created_at": "2014-01-15T16:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200582",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad">cd155cf</a></td><td><code>more general tarball regex</code></td></tr></table>




---

archive/issue_comments_200583.json:
```json
{
    "body": "**Changing commit** from \"[b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49](https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49)\" to \"[cd155cf944bcdede7c6489fc489511703c10c8ad](https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad)\".",
    "created_at": "2014-01-15T16:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49](https://github.com/sagemath/sagetrac-mirror/commit/b1ef0b663cff6fdbcb2ae9cefad7d72c14605b49)" to "[cd155cf944bcdede7c6489fc489511703c10c8ad](https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad)".



---

archive/issue_comments_200584.json:
```json
{
    "body": "**Author:** Volker Braun",
    "created_at": "2014-01-21T09:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200584",
    "user": "https://github.com/ohanar"
}
```

**Author:** Volker Braun



---

archive/issue_comments_200585.json:
```json
{
    "body": "<a id='comment:8'></a>\nI added a few extra commits to resolve a couple of small bugs I noticed. Pending someone signing off on those, and testing on various versions of python, this looks good to me.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f647251e0ab3ac78220005f48c2883f16a94a974\">f647251</a></td><td><code>remove commented out old code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/905df0918db48496ca824879cdb22da2d683f54c\">905df09</a></td><td><code>rework environment stuff a bit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e\">991de26</a></td><td><code>don't actually write unsorted mirror list to disk</code></td></tr></table>\n",
    "created_at": "2014-01-21T09:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200585",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:8'></a>
I added a few extra commits to resolve a couple of small bugs I noticed. Pending someone signing off on those, and testing on various versions of python, this looks good to me.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f647251e0ab3ac78220005f48c2883f16a94a974">f647251</a></td><td><code>remove commented out old code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/905df0918db48496ca824879cdb22da2d683f54c">905df09</a></td><td><code>rework environment stuff a bit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e">991de26</a></td><td><code>don't actually write unsorted mirror list to disk</code></td></tr></table>




---

archive/issue_comments_200586.json:
```json
{
    "body": "**Changing branch** from \"[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)\" to \"[u/ohanar/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/use_mirrors_for_tarballs)\".",
    "created_at": "2014-01-21T09:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200586",
    "user": "https://github.com/ohanar"
}
```

**Changing branch** from "[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)" to "[u/ohanar/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/use_mirrors_for_tarballs)".



---

archive/issue_comments_200587.json:
```json
{
    "body": "**Changing commit** from \"[cd155cf944bcdede7c6489fc489511703c10c8ad](https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad)\" to \"[991de268a9fd9bc0ff4bd94295d8b6cfbe78015e](https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e)\".",
    "created_at": "2014-01-21T09:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200587",
    "user": "https://github.com/ohanar"
}
```

**Changing commit** from "[cd155cf944bcdede7c6489fc489511703c10c8ad](https://github.com/sagemath/sagetrac-mirror/commit/cd155cf944bcdede7c6489fc489511703c10c8ad)" to "[991de268a9fd9bc0ff4bd94295d8b6cfbe78015e](https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e)".



---

archive/issue_events_141600.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141600"
}
```



---

archive/issue_events_141601.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141601"
}
```



---

archive/issue_events_141602.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-02-04T08:03:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141602"
}
```



---

archive/issue_events_141603.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-02-04T08:03:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141603"
}
```



---

archive/issue_comments_200588.json:
```json
{
    "body": "<a id='comment:10'></a>\nWhy remove the possibility to use the system `curl` or `wget` programs? That seems like an unneeded regression to me.",
    "created_at": "2014-02-04T08:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200588",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Why remove the possibility to use the system `curl` or `wget` programs? That seems like an unneeded regression to me.



---

archive/issue_comments_200589.json:
```json
{
    "body": "<a id='comment:11'></a>\nWe only need **one** way to download files. There is no point in having untested (hence broken) code laying around \"just in case\". There is no use case, just clutter laying around.",
    "created_at": "2014-02-04T22:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200589",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
We only need **one** way to download files. There is no point in having untested (hence broken) code laying around "just in case". There is no use case, just clutter laying around.



---

archive/issue_comments_200590.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [vbraun](#comment%3A11):\n> There is no use case\n\nThe use case is building from git on systems without Python installed.",
    "created_at": "2014-02-05T15:33:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200590",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [vbraun](#comment%3A11):
> There is no use case

The use case is building from git on systems without Python installed.



---

archive/issue_comments_200591.json:
```json
{
    "body": "<a id='comment:13'></a>\nPer the discussion on sage-devel, Python is a requirement. Sooner or later Sage won't build without Python with or without this ticket.",
    "created_at": "2014-02-05T15:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200591",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'></a>
Per the discussion on sage-devel, Python is a requirement. Sooner or later Sage won't build without Python with or without this ticket.



---

archive/issue_comments_200592.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [vbraun](#comment%3A13):\n> Per the discussion on sage-devel, Python is a requirement.\n\nThat would require at least a change to the documentation.",
    "created_at": "2014-02-06T10:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200592",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [vbraun](#comment%3A13):
> Per the discussion on sage-devel, Python is a requirement.

That would require at least a change to the documentation.



---

archive/issue_comments_200593.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [vbraun](#comment%3A13):\n> Sooner or later Sage won't build without Python with or without this ticket.\n\nSure, but why break building on systems without Python on this ticket? It is absolutely trivial to keep supporting without Python for now (just keep the shell part of the script). It seems you're breaking stuff for no reason.",
    "created_at": "2014-02-06T10:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200593",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Replying to [vbraun](#comment%3A13):
> Sooner or later Sage won't build without Python with or without this ticket.

Sure, but why break building on systems without Python on this ticket? It is absolutely trivial to keep supporting without Python for now (just keep the shell part of the script). It seems you're breaking stuff for no reason.



---

archive/issue_comments_200594.json:
```json
{
    "body": "<a id='comment:16'></a>\nSo would it make you feel better if we wait with this ticket and merge it only after another change broke building without Python?",
    "created_at": "2014-02-06T10:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200594",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>
So would it make you feel better if we wait with this ticket and merge it only after another change broke building without Python?



---

archive/issue_comments_200595.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [vbraun](#comment%3A16):\n> So would it make you feel better if we wait with this ticket and merge it only after another change broke building without Python?\n\nEssentially yes. I agree with breaking building without Python, but not breaking just for the sake of it.",
    "created_at": "2014-02-06T16:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200595",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
Replying to [vbraun](#comment%3A16):
> So would it make you feel better if we wait with this ticket and merge it only after another change broke building without Python?

Essentially yes. I agree with breaking building without Python, but not breaking just for the sake of it.



---

archive/issue_events_141604.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141604"
}
```



---

archive/issue_events_141605.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141605"
}
```



---

archive/issue_events_141606.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141606"
}
```



---

archive/issue_events_141607.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141607"
}
```



---

archive/issue_comments_200596.json:
```json
{
    "body": "<a id='comment:21'></a>\nI would say this is not breaking building without Python for the sake of breaking, but for the sake of moving the build system to a language that all Sage developers understand (and therefore can make further improvements).",
    "created_at": "2014-11-05T23:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200596",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:21'></a>
I would say this is not breaking building without Python for the sake of breaking, but for the sake of moving the build system to a language that all Sage developers understand (and therefore can make further improvements).



---

archive/issue_comments_200597.json:
```json
{
    "body": "<a id='comment:22'></a>\nCurrently in Sage, we have a Python script to download stuff with a shell-script wrapper to handle the case where Python in Sage is not yet installed. I would rather keep the shell-script wrapper and only modify the Python script.",
    "created_at": "2014-11-06T07:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200597",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Currently in Sage, we have a Python script to download stuff with a shell-script wrapper to handle the case where Python in Sage is not yet installed. I would rather keep the shell-script wrapper and only modify the Python script.



---

archive/issue_comments_200598.json:
```json
{
    "body": "<a id='comment:23'></a>\nWhy have a shell script here-document a fortran program which runs a python script? Just so that we can build Sage without Python for a few more months? The decision is made, Python is a built-time requirement.",
    "created_at": "2014-11-06T09:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200598",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
Why have a shell script here-document a fortran program which runs a python script? Just so that we can build Sage without Python for a few more months? The decision is made, Python is a built-time requirement.



---

archive/issue_comments_200599.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [vbraun](#comment%3A23):\n> The decision is made\n\nI don't recall that discussion...\n\nLet me repeat what I said above:\n\nWhy break building on systems without Python on this ticket? It is absolutely trivial to keep support for building without Python for now (just keep the shell part of the script). It seems you're breaking stuff for no reason. I don't mind breaking building without Python if there is a good reason, but not breaking just for the sake of it.",
    "created_at": "2014-11-06T10:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200599",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [vbraun](#comment%3A23):
> The decision is made

I don't recall that discussion...

Let me repeat what I said above:

Why break building on systems without Python on this ticket? It is absolutely trivial to keep support for building without Python for now (just keep the shell part of the script). It seems you're breaking stuff for no reason. I don't mind breaking building without Python if there is a good reason, but not breaking just for the sake of it.



---

archive/issue_comments_200600.json:
```json
{
    "body": "<a id='comment:25'></a>\nYou are going to say the same thing all the time, why rely on a Python script here when you could just as well have an additional shell script to provide a fall back. The answer is: fewer moving parts = less bugs.",
    "created_at": "2014-11-06T11:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200600",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>
You are going to say the same thing all the time, why rely on a Python script here when you could just as well have an additional shell script to provide a fall back. The answer is: fewer moving parts = less bugs.



---

archive/issue_comments_200601.json:
```json
{
    "body": "<a id='comment:26'></a>\nThis is not about python as a requirement nor the curl and wget fallbacks, but i see the benefit of being able to set a `URL_GRABBER` variable that calls some fetcher with more robust options, as discussed on [this sage-devel thread](http://comments.gmane.org/gmane.comp.mathematics.sage.devel/75369).",
    "created_at": "2014-11-06T15:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200601",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:26'></a>
This is not about python as a requirement nor the curl and wget fallbacks, but i see the benefit of being able to set a `URL_GRABBER` variable that calls some fetcher with more robust options, as discussed on [this sage-devel thread](http://comments.gmane.org/gmane.comp.mathematics.sage.devel/75369).



---

archive/issue_comments_200602.json:
```json
{
    "body": "**Changing branch** from \"[u/ohanar/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/use_mirrors_for_tarballs)\" to \"[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)\".",
    "created_at": "2015-05-04T14:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200602",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/ohanar/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/ohanar/use_mirrors_for_tarballs)" to "[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)".



---

archive/issue_events_141608.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-04T14:38:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141608"
}
```



---

archive/issue_events_141609.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-04T14:38:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141609"
}
```



---

archive/issue_events_141610.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-04T14:38:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141610"
}
```



---

archive/issue_comments_200603.json:
```json
{
    "body": "<a id='comment:28'></a>\nWe must use the mirrors very soon, the centrally-hosted packages will go away.\n\nThe downloading script still needs to be called from sage-spkg, when that is finished we must merge this ticket asap.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b\">74ac922</a></td><td><code>Merge 6.7.beta3 into #15642</code></td></tr></table>\n",
    "created_at": "2015-05-04T14:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200603",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>
We must use the mirrors very soon, the centrally-hosted packages will go away.

The downloading script still needs to be called from sage-spkg, when that is finished we must merge this ticket asap.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b">74ac922</a></td><td><code>Merge 6.7.beta3 into #15642</code></td></tr></table>




---

archive/issue_comments_200604.json:
```json
{
    "body": "**Changing commit** from \"[991de268a9fd9bc0ff4bd94295d8b6cfbe78015e](https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e)\" to \"[74ac9229132583c3636e551e36aa0a53a23dbc8b](https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b)\".",
    "created_at": "2015-05-04T14:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200604",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[991de268a9fd9bc0ff4bd94295d8b6cfbe78015e](https://github.com/sagemath/sagetrac-mirror/commit/991de268a9fd9bc0ff4bd94295d8b6cfbe78015e)" to "[74ac9229132583c3636e551e36aa0a53a23dbc8b](https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b)".



---

archive/issue_comments_200605.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9c0318daf085da3f96a66a8450721b5dfe800a2\">d9c0318</a></td><td><code>Merge 6.7.beta4 into #15642</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4f9892ffa9c1bd83be490253a9abbd3a5c9e4cc\">a4f9892</a></td><td><code>Ignore the single ftp-only mirror for now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354\">33bf83f</a></td><td><code>Use the new sage-download-file script to download all packages</code></td></tr></table>\n",
    "created_at": "2015-05-09T00:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200605",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9c0318daf085da3f96a66a8450721b5dfe800a2">d9c0318</a></td><td><code>Merge 6.7.beta4 into #15642</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4f9892ffa9c1bd83be490253a9abbd3a5c9e4cc">a4f9892</a></td><td><code>Ignore the single ftp-only mirror for now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354">33bf83f</a></td><td><code>Use the new sage-download-file script to download all packages</code></td></tr></table>




---

archive/issue_comments_200606.json:
```json
{
    "body": "**Changing commit** from \"[74ac9229132583c3636e551e36aa0a53a23dbc8b](https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b)\" to \"[33bf83f60c6332bd06d19c177638b00e0e918354](https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354)\".",
    "created_at": "2015-05-09T00:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[74ac9229132583c3636e551e36aa0a53a23dbc8b](https://github.com/sagemath/sagetrac-mirror/commit/74ac9229132583c3636e551e36aa0a53a23dbc8b)" to "[33bf83f60c6332bd06d19c177638b00e0e918354](https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354)".



---

archive/issue_events_141611.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-09T08:24:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141611"
}
```



---

archive/issue_events_141612.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-09T08:24:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141612"
}
```



---

archive/issue_comments_200607.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c\">a7afa48</a></td><td><code>Add a SAGE_MIRROR environment variable</code></td></tr></table>\n",
    "created_at": "2015-05-09T09:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200607",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c">a7afa48</a></td><td><code>Add a SAGE_MIRROR environment variable</code></td></tr></table>




---

archive/issue_comments_200608.json:
```json
{
    "body": "**Changing commit** from \"[33bf83f60c6332bd06d19c177638b00e0e918354](https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354)\" to \"[a7afa48370ccba8b406a3f820b76ff522bea600c](https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c)\".",
    "created_at": "2015-05-09T09:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[33bf83f60c6332bd06d19c177638b00e0e918354](https://github.com/sagemath/sagetrac-mirror/commit/33bf83f60c6332bd06d19c177638b00e0e918354)" to "[a7afa48370ccba8b406a3f820b76ff522bea600c](https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c)".



---

archive/issue_comments_200609.json:
```json
{
    "body": "<a id='comment:32'></a>\nThe buildbot will set `SAGE_MIRROR` to its own so it doesn't have to wait for the mirrors to catch up.",
    "created_at": "2015-05-09T10:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200609",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'></a>
The buildbot will set `SAGE_MIRROR` to its own so it doesn't have to wait for the mirrors to catch up.



---

archive/issue_events_141613.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-05-09T11:39:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141613"
}
```



---

archive/issue_events_141614.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-05-09T11:39:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141614"
}
```



---

archive/issue_comments_200610.json:
```json
{
    "body": "<a id='comment:34'></a>\n\"Usage\" doesn't match implementation: `--fastest-mirror` vs. `--print-fastest-mirror`.",
    "created_at": "2015-05-09T12:25:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200610",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:34'></a>
"Usage" doesn't match implementation: `--fastest-mirror` vs. `--print-fastest-mirror`.



---

archive/issue_events_141615.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-05-09T12:25:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141615"
}
```



---

archive/issue_events_141616.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-05-09T12:25:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141616"
}
```



---

archive/issue_comments_200611.json:
```json
{
    "body": "<a id='comment:35'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1\">9a06850</a></td><td><code>fix usage doc</code></td></tr></table>\n",
    "created_at": "2015-05-09T12:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200611",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1">9a06850</a></td><td><code>fix usage doc</code></td></tr></table>




---

archive/issue_comments_200612.json:
```json
{
    "body": "**Changing commit** from \"[a7afa48370ccba8b406a3f820b76ff522bea600c](https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c)\" to \"[9a06850aa7e90080cd1841ce7a4aea46da25ccc1](https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1)\".",
    "created_at": "2015-05-09T12:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200612",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a7afa48370ccba8b406a3f820b76ff522bea600c](https://github.com/sagemath/sagetrac-mirror/commit/a7afa48370ccba8b406a3f820b76ff522bea600c)" to "[9a06850aa7e90080cd1841ce7a4aea46da25ccc1](https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1)".



---

archive/issue_comments_200613.json:
```json
{
    "body": "<a id='comment:36'></a>\nThanks, fixed",
    "created_at": "2015-05-09T12:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200613",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>
Thanks, fixed



---

archive/issue_events_141617.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-09T12:30:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141617"
}
```



---

archive/issue_events_141618.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-09T12:30:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141618"
}
```



---

archive/issue_comments_200614.json:
```json
{
    "body": "<a id='comment:37'></a>\nNot entirely clear to me why you use `.startswith()` though... ;-)\n\n(Ok, it does support `--print-fastest-mirror-and-drop-me-a-beer`, but I'm still waiting...)",
    "created_at": "2015-05-09T12:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200614",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:37'></a>
Not entirely clear to me why you use `.startswith()` though... ;-)

(Ok, it does support `--print-fastest-mirror-and-drop-me-a-beer`, but I'm still waiting...)



---

archive/issue_comments_200615.json:
```json
{
    "body": "<a id='comment:38'></a>\nCould we please suppress the tracebacks on errors like 404?",
    "created_at": "2015-05-09T12:37:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200615",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:38'></a>
Could we please suppress the tracebacks on errors like 404?



---

archive/issue_comments_200616.json:
```json
{
    "body": "<a id='comment:39'></a>\nAs you said, using startswith() is a cheap emulation of argparse so `--quiet=...` works. The point is to be compatible with Python 2.6, of course, so we can't use argparse.",
    "created_at": "2015-05-09T12:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200616",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'></a>
As you said, using startswith() is a cheap emulation of argparse so `--quiet=...` works. The point is to be compatible with Python 2.6, of course, so we can't use argparse.



---

archive/issue_comments_200617.json:
```json
{
    "body": "<a id='comment:40'></a>\nMirror layout fixes, part I:\n\n```diff\ndiff --git a/src/bin/sage-spkg b/src/bin/sage-spkg\nindex d25542c..0eb2f8a 100755\n--- a/src/bin/sage-spkg\n+++ b/src/bin/sage-spkg\n@@ -367,9 +367,9 @@ if [ ! -f \"$PKG_SRC\" ]; then\n                 echo \">>> Checking online list of $repo packages.\"\n                 # File inside DOT_SAGE should be writable\n                 repolist=\"${DOT_SAGE}/${repo}.list\"\n-                sage-download-file \"$MIRROR/$repo/list\" $repolist\n+                sage-download-file \"$MIRROR/spkg/$repo/list\" $repolist\n                 if [ $? -ne 0 ]; then\n-                    echo >&2 \"Error: failed to download $MIRROR/$repo/list, aborting\"\n+                    echo >&2 \"Error: failed to download $MIRROR/spkg/$repo/list, aborting\"\n                     rm -f $repolist\n                     exit 1\n                 fi\n@@ -386,7 +386,7 @@ if [ ! -f \"$PKG_SRC\" ]; then\n \n                     # If INFO is set, try downloading only the .txt file\n                     if [ $INFO -eq 1 ]; then\n-                        PKG_URL=\"$MIRROR/$repo/$pkg.txt\"\n+                        PKG_URL=\"$MIRROR/spkg/$repo/$pkg.txt\"\n                         sage-download-file \"$PKG_URL\" && exit 0\n                         # If the download failed (for whatever reason),\n                         # fall through and use the .spkg file.\n@@ -416,7 +416,7 @@ if [ ! -f \"$PKG_SRC\" ]; then\n                             esac\n                         fi\n                     fi\n-                    PKG_URL=\"$MIRROR/$repo/$pkg.spkg\"\n+                    PKG_URL=\"$MIRROR/spkg/$repo/$pkg.spkg\"\n                     break\n                 fi\n             done\n```\n(Try e.g. `./sage -i foobar`.)",
    "created_at": "2015-05-09T13:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200617",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:40'></a>
Mirror layout fixes, part I:

```diff
diff --git a/src/bin/sage-spkg b/src/bin/sage-spkg
index d25542c..0eb2f8a 100755
--- a/src/bin/sage-spkg
+++ b/src/bin/sage-spkg
@@ -367,9 +367,9 @@ if [ ! -f "$PKG_SRC" ]; then
                 echo ">>> Checking online list of $repo packages."
                 # File inside DOT_SAGE should be writable
                 repolist="${DOT_SAGE}/${repo}.list"
-                sage-download-file "$MIRROR/$repo/list" $repolist
+                sage-download-file "$MIRROR/spkg/$repo/list" $repolist
                 if [ $? -ne 0 ]; then
-                    echo >&2 "Error: failed to download $MIRROR/$repo/list, aborting"
+                    echo >&2 "Error: failed to download $MIRROR/spkg/$repo/list, aborting"
                     rm -f $repolist
                     exit 1
                 fi
@@ -386,7 +386,7 @@ if [ ! -f "$PKG_SRC" ]; then
 
                     # If INFO is set, try downloading only the .txt file
                     if [ $INFO -eq 1 ]; then
-                        PKG_URL="$MIRROR/$repo/$pkg.txt"
+                        PKG_URL="$MIRROR/spkg/$repo/$pkg.txt"
                         sage-download-file "$PKG_URL" && exit 0
                         # If the download failed (for whatever reason),
                         # fall through and use the .spkg file.
@@ -416,7 +416,7 @@ if [ ! -f "$PKG_SRC" ]; then
                             esac
                         fi
                     fi
-                    PKG_URL="$MIRROR/$repo/$pkg.spkg"
+                    PKG_URL="$MIRROR/spkg/$repo/$pkg.spkg"
                     break
                 fi
             done
```
(Try e.g. `./sage -i foobar`.)



---

archive/issue_comments_200618.json:
```json
{
    "body": "<a id='comment:41'></a>\n... we'd better use a variable like `MIRROR_PACKAGE_FOLDER` or whatever there.",
    "created_at": "2015-05-09T13:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200618",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:41'></a>
... we'd better use a variable like `MIRROR_PACKAGE_FOLDER` or whatever there.



---

archive/issue_comments_200619.json:
```json
{
    "body": "<a id='comment:42'></a>\nhow about you just push that to trac, I'm not going to type that in for you",
    "created_at": "2015-05-09T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200619",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'></a>
how about you just push that to trac, I'm not going to type that in for you



---

archive/issue_comments_200620.json:
```json
{
    "body": "<a id='comment:43'></a>\nThere are still issues we have to fix w.r.t. `MIRROR` vs. `SAGE_SERVER`.",
    "created_at": "2015-05-09T13:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200620",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:43'></a>
There are still issues we have to fix w.r.t. `MIRROR` vs. `SAGE_SERVER`.



---

archive/issue_comments_200621.json:
```json
{
    "body": "<a id='comment:44'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec\">d9e66ac</a></td><td><code>no backtrace on IOError</code></td></tr></table>\n",
    "created_at": "2015-05-09T13:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec">d9e66ac</a></td><td><code>no backtrace on IOError</code></td></tr></table>




---

archive/issue_comments_200622.json:
```json
{
    "body": "**Changing commit** from \"[9a06850aa7e90080cd1841ce7a4aea46da25ccc1](https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1)\" to \"[d9e66acabedfe0ae55b961482bfa4ec3515257ec](https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec)\".",
    "created_at": "2015-05-09T13:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9a06850aa7e90080cd1841ce7a4aea46da25ccc1](https://github.com/sagemath/sagetrac-mirror/commit/9a06850aa7e90080cd1841ce7a4aea46da25ccc1)" to "[d9e66acabedfe0ae55b961482bfa4ec3515257ec](https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec)".



---

archive/issue_comments_200623.json:
```json
{
    "body": "<a id='comment:45'></a>\nSAGE_SERVER is used elsewhere, its where the docs are hosted etc.",
    "created_at": "2015-05-09T13:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200623",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'></a>
SAGE_SERVER is used elsewhere, its where the docs are hosted etc.



---

archive/issue_comments_200624.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [vbraun](#comment%3A42):\n> how about you just push that to trac, I'm not going to type that in for you\n\n\nThat's not something I expect you to merge; it just shows errors in the current code.  As said, we should IMHO use a variable for that.  (I'm not doing your work either... ;-) )",
    "created_at": "2015-05-09T13:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200624",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:46'></a>
Replying to [vbraun](#comment%3A42):
> how about you just push that to trac, I'm not going to type that in for you


That's not something I expect you to merge; it just shows errors in the current code.  As said, we should IMHO use a variable for that.  (I'm not doing your work either... ;-) )



---

archive/issue_comments_200625.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [vbraun](#comment%3A45):\n> SAGE_SERVER is used elsewhere, its where the docs are hosted etc.\n\n\nIt's still in an error message in `sage-spkg`, although `MIRROR` was used.",
    "created_at": "2015-05-09T13:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200625",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:47'></a>
Replying to [vbraun](#comment%3A45):
> SAGE_SERVER is used elsewhere, its where the docs are hosted etc.


It's still in an error message in `sage-spkg`, although `MIRROR` was used.



---

archive/issue_comments_200626.json:
```json
{
    "body": "<a id='comment:48'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099\">30b1647</a></td><td><code>fix mirror uri</code></td></tr></table>\n",
    "created_at": "2015-05-09T13:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200626",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099">30b1647</a></td><td><code>fix mirror uri</code></td></tr></table>




---

archive/issue_comments_200627.json:
```json
{
    "body": "**Changing commit** from \"[d9e66acabedfe0ae55b961482bfa4ec3515257ec](https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec)\" to \"[30b1647e7b6a527e72daa7835f26a710306a6099](https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099)\".",
    "created_at": "2015-05-09T13:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200627",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d9e66acabedfe0ae55b961482bfa4ec3515257ec](https://github.com/sagemath/sagetrac-mirror/commit/d9e66acabedfe0ae55b961482bfa4ec3515257ec)" to "[30b1647e7b6a527e72daa7835f26a710306a6099](https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099)".



---

archive/issue_comments_200628.json:
```json
{
    "body": "<a id='comment:49'></a>\nFixed",
    "created_at": "2015-05-09T13:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200628",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:49'></a>
Fixed



---

archive/issue_comments_200629.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [vbraun](#comment%3A49):\n> Fixed\n\n\nOk, but there's an extra slash (`MIRROR` already has a trailing one).",
    "created_at": "2015-05-09T13:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200629",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:50'></a>
Replying to [vbraun](#comment%3A49):
> Fixed


Ok, but there's an extra slash (`MIRROR` already has a trailing one).



---

archive/issue_comments_200630.json:
```json
{
    "body": "<a id='comment:51'></a>\nthe official mirror list may or may not have a slash at the end",
    "created_at": "2015-05-09T13:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200630",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:51'></a>
the official mirror list may or may not have a slash at the end



---

archive/issue_comments_200631.json:
```json
{
    "body": "<a id='comment:52'></a>\nFTP doesn't seem to work (hangs after receiving the file).\n\nTry for example\n\n```sh\n./sage --sh -c 'sage-download-file ftp://ftp.fu-berlin.de/unix/misc/sage/spkg/optional/list'\n```",
    "created_at": "2015-05-09T13:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200631",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:52'></a>
FTP doesn't seem to work (hangs after receiving the file).

Try for example

```sh
./sage --sh -c 'sage-download-file ftp://ftp.fu-berlin.de/unix/misc/sage/spkg/optional/list'
```



---

archive/issue_comments_200632.json:
```json
{
    "body": "<a id='comment:53'></a>\nCorrect, FTP is not allowed",
    "created_at": "2015-05-09T13:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200632",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:53'></a>
Correct, FTP is not allowed



---

archive/issue_comments_200633.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [vbraun](#comment%3A51):\n> the official mirror list may or may not have a slash at the end\n\n\nA matter of what your script outputs...\n\n\n\n\nSo, what about `SAGE_SERVER` to specify a mirror?  While `$SOMEBODY` partially broke that anyway by hardcoding the incompatible `packages/` subfolder, we should IMHO still (or again) support that.  (At least `sage-list-packages` also needs to get fixed, preferably on a separate ticket I'd say.)",
    "created_at": "2015-05-09T13:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200633",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:54'></a>
Replying to [vbraun](#comment%3A51):
> the official mirror list may or may not have a slash at the end


A matter of what your script outputs...




So, what about `SAGE_SERVER` to specify a mirror?  While `$SOMEBODY` partially broke that anyway by hardcoding the incompatible `packages/` subfolder, we should IMHO still (or again) support that.  (At least `sage-list-packages` also needs to get fixed, preferably on a separate ticket I'd say.)



---

archive/issue_comments_200634.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [vbraun](#comment%3A53):\n> Correct, FTP is not allowed\n\n\n```\n The single mandatory argument can be a http:// or ftp:// url or a\n tarball filename.\n```\n\n```python\n    if url.startswith('http://') or url.startswith('https://') or url.startswith('ftp://'):\n        http_download(url, destination, progress=progress, ignore_errors=True)\n```",
    "created_at": "2015-05-09T13:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200634",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:55'></a>
Replying to [vbraun](#comment%3A53):
> Correct, FTP is not allowed


```
 The single mandatory argument can be a http:// or ftp:// url or a
 tarball filename.
```

```python
    if url.startswith('http://') or url.startswith('https://') or url.startswith('ftp://'):
        http_download(url, destination, progress=progress, ignore_errors=True)
```



---

archive/issue_comments_200635.json:
```json
{
    "body": "<a id='comment:56'></a>\nI don't really like the SAGE_SERVER name (could refer anything, sage cell server), but historically that was where the official mirror list was and thats what I wanted to keep",
    "created_at": "2015-05-09T14:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200635",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:56'></a>
I don't really like the SAGE_SERVER name (could refer anything, sage cell server), but historically that was where the official mirror list was and thats what I wanted to keep



---

archive/issue_comments_200636.json:
```json
{
    "body": "<a id='comment:57'></a>\nAlso, IMHO we should just phase out old-style spkgs. As long as we have to drag along that technical debt its very hard to clean up scripts.",
    "created_at": "2015-05-09T14:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200636",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:57'></a>
Also, IMHO we should just phase out old-style spkgs. As long as we have to drag along that technical debt its very hard to clean up scripts.



---

archive/issue_comments_200637.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [vbraun](#comment%3A56):\n> I don't really like the SAGE_SERVER name (could refer anything, sage cell server), but historically that was where the official mirror list was and thats what I wanted to keep\n\n\n?  Before the breakage, setting `SAGE_SERVER` to e.g. `http://mirror.switch.ch/mirror/sagemath/` worked, for example with `sage --optional` and -- long time ago -- with `sage --upgrade`.\n\n\nDeprecate it, later use `SAGE_MIRROR` for package download purposes?",
    "created_at": "2015-05-09T14:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200637",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:58'></a>
Replying to [vbraun](#comment%3A56):
> I don't really like the SAGE_SERVER name (could refer anything, sage cell server), but historically that was where the official mirror list was and thats what I wanted to keep


?  Before the breakage, setting `SAGE_SERVER` to e.g. `http://mirror.switch.ch/mirror/sagemath/` worked, for example with `sage --optional` and -- long time ago -- with `sage --upgrade`.


Deprecate it, later use `SAGE_MIRROR` for package download purposes?



---

archive/issue_comments_200638.json:
```json
{
    "body": "<a id='comment:59'></a>\nReplying to [vbraun](#comment%3A57):\n> Also, IMHO we should just phase out old-style spkgs.\n\n\nI'm all against that.  The worst decision was to hardcode package metadata (solely!) into specific Sage releases, while that data doesn't even show whether a package is optional, experimental, or whatever.  (It's pretty easy to *create* \"old-style\" packages from that though... ;-) )\n\nIn my opinion the main reason we should (still) support real spkgs is that anybody can easily create and offer such self-contained packages to others, and installing and using them doesn't artificially depend on the Sage version.  (Whether they'll work of course depends on a couple of things.)\n\nThey're also often much more convenient for testing.\n \n\n\n\n> As long as we have to drag along that technical debt its very hard to clean up scripts.\n\n\nPerhaps with the exception of left-over old-style standard packages, I don't see a problem.",
    "created_at": "2015-05-09T14:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200638",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:59'></a>
Replying to [vbraun](#comment%3A57):
> Also, IMHO we should just phase out old-style spkgs.


I'm all against that.  The worst decision was to hardcode package metadata (solely!) into specific Sage releases, while that data doesn't even show whether a package is optional, experimental, or whatever.  (It's pretty easy to *create* "old-style" packages from that though... ;-) )

In my opinion the main reason we should (still) support real spkgs is that anybody can easily create and offer such self-contained packages to others, and installing and using them doesn't artificially depend on the Sage version.  (Whether they'll work of course depends on a couple of things.)

They're also often much more convenient for testing.
 



> As long as we have to drag along that technical debt its very hard to clean up scripts.


Perhaps with the exception of left-over old-style standard packages, I don't see a problem.



---

archive/issue_comments_200639.json:
```json
{
    "body": "<a id='comment:60'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27b71e517fef3594dffe282b99c2538d02ebf5a8\">27b71e5</a></td><td><code>remove ftp from docs for now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da\">a103ab5</a></td><td><code>Use SAGE_SERVER instead of SAGE_MIRROR</code></td></tr></table>\n",
    "created_at": "2015-05-09T14:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27b71e517fef3594dffe282b99c2538d02ebf5a8">27b71e5</a></td><td><code>remove ftp from docs for now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da">a103ab5</a></td><td><code>Use SAGE_SERVER instead of SAGE_MIRROR</code></td></tr></table>




---

archive/issue_comments_200640.json:
```json
{
    "body": "**Changing commit** from \"[30b1647e7b6a527e72daa7835f26a710306a6099](https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099)\" to \"[a103ab5dd842e5a6f24970a42649e4df8935a9da](https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da)\".",
    "created_at": "2015-05-09T14:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[30b1647e7b6a527e72daa7835f26a710306a6099](https://github.com/sagemath/sagetrac-mirror/commit/30b1647e7b6a527e72daa7835f26a710306a6099)" to "[a103ab5dd842e5a6f24970a42649e4df8935a9da](https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da)".



---

archive/issue_comments_200641.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [leif](#comment%3A59):\n> Whether they'll work of course depends on a couple of things.\n\n\nEven if they work in principle you can't do that much with them as there is no dependency management. Its just an all-out shitty solution for everyone.",
    "created_at": "2015-05-09T14:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200641",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:61'></a>
Replying to [leif](#comment%3A59):
> Whether they'll work of course depends on a couple of things.


Even if they work in principle you can't do that much with them as there is no dependency management. Its just an all-out shitty solution for everyone.



---

archive/issue_comments_200642.json:
```json
{
    "body": "<a id='comment:62'></a>\nSAGE_SERVER must of course then not be set by default...",
    "created_at": "2015-05-09T14:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200642",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:62'></a>
SAGE_SERVER must of course then not be set by default...



---

archive/issue_comments_200643.json:
```json
{
    "body": "<a id='comment:63'></a>\nDoes any mirror have `packages/`?  Will they at some point?\n\nOtherwise `s|SAGE_SERVER/packages/|SAGE_SERVER/spkg/|` in the docs.",
    "created_at": "2015-05-09T15:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200643",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:63'></a>
Does any mirror have `packages/`?  Will they at some point?

Otherwise `s|SAGE_SERVER/packages/|SAGE_SERVER/spkg/|` in the docs.



---

archive/issue_comments_200644.json:
```json
{
    "body": "<a id='comment:64'></a>\nAFAIK there will only ever be /spkg/ on the mirrors",
    "created_at": "2015-05-09T15:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200644",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:64'></a>
AFAIK there will only ever be /spkg/ on the mirrors



---

archive/issue_comments_200645.json:
```json
{
    "body": "**Changing commit** from \"[a103ab5dd842e5a6f24970a42649e4df8935a9da](https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da)\" to \"[a259f27b95e1b69fbdde1a4b0e8496996cd427fe](https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe)\".",
    "created_at": "2015-05-09T15:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a103ab5dd842e5a6f24970a42649e4df8935a9da](https://github.com/sagemath/sagetrac-mirror/commit/a103ab5dd842e5a6f24970a42649e4df8935a9da)" to "[a259f27b95e1b69fbdde1a4b0e8496996cd427fe](https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe)".



---

archive/issue_comments_200646.json:
```json
{
    "body": "<a id='comment:65'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe\">a259f27</a></td><td><code>rename SAGE_SERVER/packages to SAGE_SERVER/spkg</code></td></tr></table>\n",
    "created_at": "2015-05-09T15:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200646",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe">a259f27</a></td><td><code>rename SAGE_SERVER/packages to SAGE_SERVER/spkg</code></td></tr></table>




---

archive/issue_comments_200647.json:
```json
{
    "body": "<a id='comment:66'></a>\nReplying to [leif](#comment%3A63):\n> Does any mirror have `packages/`?  Will they at some point?\n> \n> Otherwise `s|SAGE_SERVER/packages/|SAGE_SERVER/spkg/|` in the docs.\n\n\nShould we fix this here, since we now touch `sage-list-packages` anyway?\n\n```\nSAGE_SERVER=\"http://mirror.switch.ch/mirror/sagemath/\" ./sage --optional\nUsing Sage Server http://mirror.switch.ch/mirror/sagemath/packages\nHTTP Error 404: Not Found\n\n\n\n********************************************************************************\n\n\n\nError contacting http://mirror.switch.ch/mirror/sagemath/packages/optional/list. Try using an alternative server.\nFor example, from the bash prompt try typing\n\n   export SAGE_SERVER=http://sage.scipy.org/sage/\n\nthen try again.\n\n\n\n********************************************************************************\n```\n\n([http://sage.scipy.org/sage/](http://sage.scipy.org/sage/) is btw. a joke...)",
    "created_at": "2015-05-09T15:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200647",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:66'></a>
Replying to [leif](#comment%3A63):
> Does any mirror have `packages/`?  Will they at some point?
> 
> Otherwise `s|SAGE_SERVER/packages/|SAGE_SERVER/spkg/|` in the docs.


Should we fix this here, since we now touch `sage-list-packages` anyway?

```
SAGE_SERVER="http://mirror.switch.ch/mirror/sagemath/" ./sage --optional
Using Sage Server http://mirror.switch.ch/mirror/sagemath/packages
HTTP Error 404: Not Found



********************************************************************************



Error contacting http://mirror.switch.ch/mirror/sagemath/packages/optional/list. Try using an alternative server.
For example, from the bash prompt try typing

   export SAGE_SERVER=http://sage.scipy.org/sage/

then try again.



********************************************************************************
```

([http://sage.scipy.org/sage/](http://sage.scipy.org/sage/) is btw. a joke...)



---

archive/issue_comments_200648.json:
```json
{
    "body": "<a id='comment:67'></a>\nConcurrent posting (luckily not pushing)...",
    "created_at": "2015-05-09T15:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200648",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:67'></a>
Concurrent posting (luckily not pushing)...



---

archive/issue_comments_200649.json:
```json
{
    "body": "**Changing commit** from \"[a259f27b95e1b69fbdde1a4b0e8496996cd427fe](https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe)\" to \"[d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)\".",
    "created_at": "2015-05-09T15:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a259f27b95e1b69fbdde1a4b0e8496996cd427fe](https://github.com/sagemath/sagetrac-mirror/commit/a259f27b95e1b69fbdde1a4b0e8496996cd427fe)" to "[d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)".



---

archive/issue_comments_200650.json:
```json
{
    "body": "<a id='comment:68'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb\">d79364b</a></td><td><code>fix sage-list-packages</code></td></tr></table>\n",
    "created_at": "2015-05-09T15:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb">d79364b</a></td><td><code>fix sage-list-packages</code></td></tr></table>




---

archive/issue_comments_200651.json:
```json
{
    "body": "<a id='comment:69'></a>\nThe whole listing of packages is also made hideously complicated by mashing old and new style packages together...",
    "created_at": "2015-05-09T15:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200651",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:69'></a>
The whole listing of packages is also made hideously complicated by mashing old and new style packages together...



---

archive/issue_comments_200652.json:
```json
{
    "body": "<a id='comment:70'></a>\nI thought of just adding a further `try: ... except HTTPError: ...`, in case `sagemath.org/packages/` remains for a while.  (IIRC it had *both* for a while.)\n\n`PKG_SERVER` is superfluous anyway; I'd simply use `os.environ['SAGE_SERVER']` there.",
    "created_at": "2015-05-09T15:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200652",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:70'></a>
I thought of just adding a further `try: ... except HTTPError: ...`, in case `sagemath.org/packages/` remains for a while.  (IIRC it had *both* for a while.)

`PKG_SERVER` is superfluous anyway; I'd simply use `os.environ['SAGE_SERVER']` there.



---

archive/issue_comments_200653.json:
```json
{
    "body": "<a id='comment:71'></a>\nReplying to [vbraun](#comment%3A69):\n> The whole listing of packages is also made hideously complicated by mashing old and new style packages together...\n\n\nAs I said, in principle only the old standard packages disturb a bit; otherwise it's just a matter of syncing.\n\nI was actually working on that a few days ago (#16759).",
    "created_at": "2015-05-09T15:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200653",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:71'></a>
Replying to [vbraun](#comment%3A69):
> The whole listing of packages is also made hideously complicated by mashing old and new style packages together...


As I said, in principle only the old standard packages disturb a bit; otherwise it's just a matter of syncing.

I was actually working on that a few days ago (#16759).



---

archive/issue_comments_200654.json:
```json
{
    "body": "<a id='comment:72'></a>\nQuoting [ticket:16759#comment:2 jdemeyer]:\n> Replying to [ticket:16759#comment:1 jhpalmieri]:\n> > It also looks like `sage --standard` is broken: it is using old package information.\n\n> I would say that `sage --standard` is doing the right thing, but somehow `http://www.sagemath.org/packages/standard/` is no longer updated. The right solution is updating the website script to take into account the new git-style packages (which is certainly a different issue than the one this ticket is about).",
    "created_at": "2015-05-09T15:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200654",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:72'></a>
Quoting [ticket:16759#comment:2 jdemeyer]:
> Replying to [ticket:16759#comment:1 jhpalmieri]:
> > It also looks like `sage --standard` is broken: it is using old package information.

> I would say that `sage --standard` is doing the right thing, but somehow `http://www.sagemath.org/packages/standard/` is no longer updated. The right solution is updating the website script to take into account the new git-style packages (which is certainly a different issue than the one this ticket is about).



---

archive/issue_comments_200655.json:
```json
{
    "body": "<a id='comment:73'></a>\nSince I'm CCed: There is currently a move of the whole infrastructure going on. Before that I tried to keep everything compatible with the original system from a long time ago. That's no longer possible. Long story short: the website and the binary-files need to be untangled and that means there are no longer chains of symlink-aliases. Hence, don't use the `/mirror` subdirectory of the website and I hope the essence of this ticket is to get rid of this old dependence. The only mirror related aspect is the `mirror_list` file for the base URLs.",
    "created_at": "2015-05-09T16:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200655",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:73'></a>
Since I'm CCed: There is currently a move of the whole infrastructure going on. Before that I tried to keep everything compatible with the original system from a long time ago. That's no longer possible. Long story short: the website and the binary-files need to be untangled and that means there are no longer chains of symlink-aliases. Hence, don't use the `/mirror` subdirectory of the website and I hope the essence of this ticket is to get rid of this old dependence. The only mirror related aspect is the `mirror_list` file for the base URLs.



---

archive/issue_comments_200656.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [schilly](#comment%3A73):\n> Since I'm CCed: There is currently a move of the whole infrastructure going on. Before that I tried to keep everything compatible with the original system from a long time ago. That's no longer possible. Long story short: the website and the binary-files need to be untangled and that means there are no longer chains of symlink-aliases. Hence, don't use the `/mirror` subdirectory of the website and I hope the essence of this ticket is to get rid of this old dependence. The only mirror related aspect is the `mirror_list` file for the base URLs.\n\n\nWell, the Sage scripts never used the `mirror/` folder.  The problematic part here is the structure below the base URL; `spkg/` was changed to `packages` on sagemath.org, but the mirrors all have the classical structure (plus `upstream/` below `spkg/`).\n\nThe new thing on this ticket is also that we now use [http://www.sagemath.org/mirror_list](http://www.sagemath.org/mirror_list) (currently hardcoded) again, which is periodically generated by a script on the server (or at least used to be).",
    "created_at": "2015-05-09T16:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200656",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:74'></a>
Replying to [schilly](#comment%3A73):
> Since I'm CCed: There is currently a move of the whole infrastructure going on. Before that I tried to keep everything compatible with the original system from a long time ago. That's no longer possible. Long story short: the website and the binary-files need to be untangled and that means there are no longer chains of symlink-aliases. Hence, don't use the `/mirror` subdirectory of the website and I hope the essence of this ticket is to get rid of this old dependence. The only mirror related aspect is the `mirror_list` file for the base URLs.


Well, the Sage scripts never used the `mirror/` folder.  The problematic part here is the structure below the base URL; `spkg/` was changed to `packages` on sagemath.org, but the mirrors all have the classical structure (plus `upstream/` below `spkg/`).

The new thing on this ticket is also that we now use [http://www.sagemath.org/mirror_list](http://www.sagemath.org/mirror_list) (currently hardcoded) again, which is periodically generated by a script on the server (or at least used to be).



---

archive/issue_comments_200657.json:
```json
{
    "body": "<a id='comment:75'></a>\nHarald, also note Jeroen's comment I quoted [above](#comment%3A72).\n\nMeanwhile, it's not just standard packages, but also optional packages, of which (only) some now have the \"new style\", i.e., the data of newer ones is hardcoded into the Sage releases, while obsolete \"old-style\" packages remain in `spkg/optional/list` (and `spkg/optional/`).\n\n`./sage --optional` shows some examples of optional packages which became standard:\n\n```\nOptional packages:\n\n...\ngit-1.7.12.2.p0 ........................ installed version: 2.3.0\n...\npyzmq-2.1.11.p1 ........................ installed version: 14.3.0\n...\nzeromq-3.2.0.p0 ........................ installed version: 4.0.5\n```\n\nThere are other still optional packages where `sage -i ...` would install newer versions than listed by `sage --optional` because the \"local metadata\" (`$SAGE_ROOT/build/pkgs/<package>/package-version.txt`) differs from what `spkg/optional/list` gives.  (Same issue as with our current standard packages.)\n\nA more funny one is TOPCOM:\n\n`./sage -i TOPCOM` installs the \"legacy\" spkg, while `./sage -i topcom` installs the \"new-style\" spkg.  (The package versions are currently still the same though, modulo a `.p0` for the \"new-style\" one.)",
    "created_at": "2015-05-09T17:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200657",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:75'></a>
Harald, also note Jeroen's comment I quoted [above](#comment%3A72).

Meanwhile, it's not just standard packages, but also optional packages, of which (only) some now have the "new style", i.e., the data of newer ones is hardcoded into the Sage releases, while obsolete "old-style" packages remain in `spkg/optional/list` (and `spkg/optional/`).

`./sage --optional` shows some examples of optional packages which became standard:

```
Optional packages:

...
git-1.7.12.2.p0 ........................ installed version: 2.3.0
...
pyzmq-2.1.11.p1 ........................ installed version: 14.3.0
...
zeromq-3.2.0.p0 ........................ installed version: 4.0.5
```

There are other still optional packages where `sage -i ...` would install newer versions than listed by `sage --optional` because the "local metadata" (`$SAGE_ROOT/build/pkgs/<package>/package-version.txt`) differs from what `spkg/optional/list` gives.  (Same issue as with our current standard packages.)

A more funny one is TOPCOM:

`./sage -i TOPCOM` installs the "legacy" spkg, while `./sage -i topcom` installs the "new-style" spkg.  (The package versions are currently still the same though, modulo a `.p0` for the "new-style" one.)



---

archive/issue_comments_200658.json:
```json
{
    "body": "<a id='comment:76'></a>\nWe definitely should not check sagemath.org/packages any more, I've already changed the release management scripts to no longer put the tarballs there.",
    "created_at": "2015-05-09T18:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200658",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:76'></a>
We definitely should not check sagemath.org/packages any more, I've already changed the release management scripts to no longer put the tarballs there.



---

archive/issue_comments_200659.json:
```json
{
    "body": "<a id='comment:77'></a>\nReplying to [vbraun](#comment%3A76):\n> We definitely should not check sagemath.org/packages any more, I've already changed the release management scripts to no longer put the tarballs there.\n\n\nOk, `sagemath.org/spkg/`* gave a 404 for a while, but apparently works again.",
    "created_at": "2015-05-09T18:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200659",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:77'></a>
Replying to [vbraun](#comment%3A76):
> We definitely should not check sagemath.org/packages any more, I've already changed the release management scripts to no longer put the tarballs there.


Ok, `sagemath.org/spkg/`* gave a 404 for a while, but apparently works again.



---

archive/issue_comments_200660.json:
```json
{
    "body": "<a id='comment:78'></a>\n**Note for other reviewers:**  So far I'm ok with the changes/corrections made, but haven't yet tested thoroughly enough (I think).\n\nWhile I don't like completely changing the previously *generic* character of `sage-download-file` (nor removing the \"shell fallback\" with e.g. `wget` or `curl` if Python isn't available or functional), I strongly doubt we could convince the author or the RM to change that back to how it was.\n\nFTP support (probably with Python3) and e.g. usage of a static mirror list (perhaps to be shipped with Sage) is something for follow-up tickets; the broken behaviour of `sage-list-packages` is (or will be) dealt with at #16759, which depends on *this* ticket.\n\n\n\n\nW.r.t. the threat of losing sagemath.org for downloads:  [According to William](http://article.gmane.org/gmane.comp.mathematics.sage.devel/79645), *\"soon\" is not **that** soon*.",
    "created_at": "2015-05-10T15:03:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200660",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:78'></a>
**Note for other reviewers:**  So far I'm ok with the changes/corrections made, but haven't yet tested thoroughly enough (I think).

While I don't like completely changing the previously *generic* character of `sage-download-file` (nor removing the "shell fallback" with e.g. `wget` or `curl` if Python isn't available or functional), I strongly doubt we could convince the author or the RM to change that back to how it was.

FTP support (probably with Python3) and e.g. usage of a static mirror list (perhaps to be shipped with Sage) is something for follow-up tickets; the broken behaviour of `sage-list-packages` is (or will be) dealt with at #16759, which depends on *this* ticket.




W.r.t. the threat of losing sagemath.org for downloads:  [According to William](http://article.gmane.org/gmane.comp.mathematics.sage.devel/79645), *"soon" is not **that** soon*.



---

archive/issue_comments_200661.json:
```json
{
    "body": "<a id='comment:79'></a>\nI don't mind if you rewrite the functionality in bash fwiw. I would consider it utterly retarded and backward, but as long as it works and you are committed to maintaining that solution then that would be fine with me.",
    "created_at": "2015-05-10T15:06:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200661",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:79'></a>
I don't mind if you rewrite the functionality in bash fwiw. I would consider it utterly retarded and backward, but as long as it works and you are committed to maintaining that solution then that would be fine with me.



---

archive/issue_comments_200662.json:
```json
{
    "body": "<a id='comment:80'></a>\nReplying to [leif](#comment%3A77):\n> Ok, `sagemath.org/spkg/`* gave a 404 for a while, but apparently works again.\n\n\nUhm, to reduce that confusion a little bit: The source of this inconsistency is that right now most of the old infrastructure is still running, including the currently \"old\" website. I would suggest to wait until the \"new\" website is operational. Then, any bugs in scripts relying on the website will be obvious (and fixes to the new website visible immediately).\n\nThe reason why this is a bit slow is, because there are many links assuming certain subdirectories (for documentation and e.g. /mirror/) and my time is limited. I could report back once the DNS entry has switched to the new page.\n\nPS: \"new\" just means, that there are minor changes like an additional mirror, publications etc. The current \"old\" website is an older fork of the website with some other patches. Hence this diverged and there is no need to support the old one any more.",
    "created_at": "2015-05-10T15:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200662",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:80'></a>
Replying to [leif](#comment%3A77):
> Ok, `sagemath.org/spkg/`* gave a 404 for a while, but apparently works again.


Uhm, to reduce that confusion a little bit: The source of this inconsistency is that right now most of the old infrastructure is still running, including the currently "old" website. I would suggest to wait until the "new" website is operational. Then, any bugs in scripts relying on the website will be obvious (and fixes to the new website visible immediately).

The reason why this is a bit slow is, because there are many links assuming certain subdirectories (for documentation and e.g. /mirror/) and my time is limited. I could report back once the DNS entry has switched to the new page.

PS: "new" just means, that there are minor changes like an additional mirror, publications etc. The current "old" website is an older fork of the website with some other patches. Hence this diverged and there is no need to support the old one any more.



---

archive/issue_comments_200663.json:
```json
{
    "body": "<a id='comment:81'></a>\nReplying to [schilly](#comment%3A80):\n> I could report back once the DNS entry has switched to the new page.\n\n\nETA Hausnummer?\n\n\n> PS: \"new\" just means, that there are minor changes like an additional mirror, publications etc. The current \"old\" website is an older fork of the website with some other patches. Hence this diverged and there is no need to support the old one any more.\n\n\nCould we already test the new one (using its unofficial address) w.r.t. download stuff / package (and mirror) lists?",
    "created_at": "2015-05-10T15:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200663",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:81'></a>
Replying to [schilly](#comment%3A80):
> I could report back once the DNS entry has switched to the new page.


ETA Hausnummer?


> PS: "new" just means, that there are minor changes like an additional mirror, publications etc. The current "old" website is an older fork of the website with some other patches. Hence this diverged and there is no need to support the old one any more.


Could we already test the new one (using its unofficial address) w.r.t. download stuff / package (and mirror) lists?



---

archive/issue_comments_200664.json:
```json
{
    "body": "<a id='comment:82'></a>\nThe attached branch will only use www.sagemath.org to download the mirror list, so once we have merged it there are a lot fewer things that could break.",
    "created_at": "2015-05-10T15:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200664",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:82'></a>
The attached branch will only use www.sagemath.org to download the mirror list, so once we have merged it there are a lot fewer things that could break.



---

archive/issue_comments_200665.json:
```json
{
    "body": "<a id='comment:83'></a>\nReplying to [leif](#comment%3A81):\n> ETA Hausnummer?\n\n\nFriday. It's tedious stupid work, so maybe I'm already whining more about it than it will actually take to work on.\n\n> Could we already test the new one (using its unofficial address) w.r.t. download stuff / package (and mirror) lists?\n\n\nNo, Github resolves the inofficial URL to the official one and I don't want to mess with this around even more.",
    "created_at": "2015-05-10T15:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200665",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:83'></a>
Replying to [leif](#comment%3A81):
> ETA Hausnummer?


Friday. It's tedious stupid work, so maybe I'm already whining more about it than it will actually take to work on.

> Could we already test the new one (using its unofficial address) w.r.t. download stuff / package (and mirror) lists?


No, Github resolves the inofficial URL to the official one and I don't want to mess with this around even more.



---

archive/issue_comments_200666.json:
```json
{
    "body": "<a id='comment:84'></a>\nReplying to [vbraun](#comment%3A82):\n> The attached branch will only use www.sagemath.org to download the mirror list ...\n\n\nYes, it's just one file, and as already mentioned: the full list could easily be hardcoded as a backup into Sage to remove that SPOF. Ticket for later please :-)",
    "created_at": "2015-05-10T15:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200666",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:84'></a>
Replying to [vbraun](#comment%3A82):
> The attached branch will only use www.sagemath.org to download the mirror list ...


Yes, it's just one file, and as already mentioned: the full list could easily be hardcoded as a backup into Sage to remove that SPOF. Ticket for later please :-)



---

archive/issue_comments_200667.json:
```json
{
    "body": "<a id='comment:85'></a>\nReplying to [vbraun](#comment%3A82):\n> once we have merged it there are a lot fewer things that could break.\n\n\nProvided the mirrors can still sync...\n\n\n\n\nIn principle we could already include a snapshot of `mirror_list` into the git tree (in `$SAGE_ROOT/`?  in more human-readable form?).  The dynamic one should rather be located in `$SAGE_ROOT/local/var/{lib,tmp}/sage/`, say, not `$SAGE_DIST_FILES/` (defaults to `$SAGE_ROOT/upstream/`).",
    "created_at": "2015-05-10T16:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200667",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:85'></a>
Replying to [vbraun](#comment%3A82):
> once we have merged it there are a lot fewer things that could break.


Provided the mirrors can still sync...




In principle we could already include a snapshot of `mirror_list` into the git tree (in `$SAGE_ROOT/`?  in more human-readable form?).  The dynamic one should rather be located in `$SAGE_ROOT/local/var/{lib,tmp}/sage/`, say, not `$SAGE_DIST_FILES/` (defaults to `$SAGE_ROOT/upstream/`).



---

archive/issue_comments_200668.json:
```json
{
    "body": "<a id='comment:86'></a>\nNothing else needs the mirror list so why put it in a separate file? In any case, this question should be dealt with in a separate ticket.",
    "created_at": "2015-05-10T20:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200668",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:86'></a>
Nothing else needs the mirror list so why put it in a separate file? In any case, this question should be dealt with in a separate ticket.



---

archive/issue_comments_200669.json:
```json
{
    "body": "<a id='comment:87'></a>\nReplying to [vbraun](#comment%3A86):\n> Nothing else needs the mirror list\n\n\nHuman users perhaps?\n\n> so why put it in a separate file?\n\n\nYou're right, all package metadata should be moved into `sage-spkg` as well.",
    "created_at": "2015-05-10T20:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200669",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:87'></a>
Replying to [vbraun](#comment%3A86):
> Nothing else needs the mirror list


Human users perhaps?

> so why put it in a separate file?


You're right, all package metadata should be moved into `sage-spkg` as well.



---

archive/issue_comments_200670.json:
```json
{
    "body": "<a id='comment:88'></a>\nThere are many packages but only one mirror list. Your argument is invalid.\n\nNot to mention the question of what file format, custom = crap, json = not exactly human-readable, yaml = not necessarily available in the System python, is it supposed to be readable from a shell script, ...",
    "created_at": "2015-05-11T08:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200670",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:88'></a>
There are many packages but only one mirror list. Your argument is invalid.

Not to mention the question of what file format, custom = crap, json = not exactly human-readable, yaml = not necessarily available in the System python, is it supposed to be readable from a shell script, ...



---

archive/issue_comments_200671.json:
```json
{
    "body": "<a id='comment:89'></a>\nPlain text, one URL per line, preferably in the top-level folder.  What's the problem?\n\nAny human and any kind of script can easily read such.  (If you want to add further data such as organization, location etc., just put that after each URL, seperated by whitespace, but I wouldn't even do that.  We don't have to process that.  Blank lines and comment lines starting with `#` at the first position would IMHO be ok, too, but that's not really needed.  Order of the mirrors doesn't matter for our purposes either, although we could keep them sorted by continent, say.) \n\nI thought we had postponed that to a follow-up ticket.",
    "created_at": "2015-05-11T08:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200671",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:89'></a>
Plain text, one URL per line, preferably in the top-level folder.  What's the problem?

Any human and any kind of script can easily read such.  (If you want to add further data such as organization, location etc., just put that after each URL, seperated by whitespace, but I wouldn't even do that.  We don't have to process that.  Blank lines and comment lines starting with `#` at the first position would IMHO be ok, too, but that's not really needed.  Order of the mirrors doesn't matter for our purposes either, although we could keep them sorted by continent, say.) 

I thought we had postponed that to a follow-up ticket.



---

archive/issue_comments_200672.json:
```json
{
    "body": "<a id='comment:90'></a>\nReplying to [leif](#comment%3A89):\n> I thought we had postponed that to a follow-up ticket.\n\n\nWe have, but you keep bringing it up.",
    "created_at": "2015-05-11T09:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200672",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:90'></a>
Replying to [leif](#comment%3A89):
> I thought we had postponed that to a follow-up ticket.


We have, but you keep bringing it up.



---

archive/issue_comments_200673.json:
```json
{
    "body": "<a id='comment:91'></a>\nReplying to [vbraun](#comment%3A90):\n> you keep bringing it up.\n\n\nNot me, [Harald](#comment%3A84) did.",
    "created_at": "2015-05-11T09:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200673",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:91'></a>
Replying to [vbraun](#comment%3A90):
> you keep bringing it up.


Not me, [Harald](#comment%3A84) did.



---

archive/issue_comments_200674.json:
```json
{
    "body": "<a id='comment:92'></a>\nReplying to [leif](#comment%3A81):\n> Replying to [schilly](#comment%3A80):\n> > I could report back once the DNS entry has switched to the new page.\n\n> \n> ETA Hausnummer?\n\n\nYay! 2 days ahead of schedule! I fixed all the obviously broken links and there are just two minor details left.",
    "created_at": "2015-05-13T19:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200674",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:92'></a>
Replying to [leif](#comment%3A81):
> Replying to [schilly](#comment%3A80):
> > I could report back once the DNS entry has switched to the new page.

> 
> ETA Hausnummer?


Yay! 2 days ahead of schedule! I fixed all the obviously broken links and there are just two minor details left.



---

archive/issue_comments_200675.json:
```json
{
    "body": "**Reviewer:** Volker Braun",
    "created_at": "2015-05-13T19:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200675",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Volker Braun



---

archive/issue_events_141619.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T19:17:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141619"
}
```



---

archive/issue_events_141620.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T19:17:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141620"
}
```



---

archive/issue_comments_200676.json:
```json
{
    "body": "<a id='comment:94'></a>\nReplying to [schilly](#comment%3A92):\n> Replying to [leif](#comment%3A81):\n> > Replying to [schilly](#comment%3A80):\n> > > I could report back once the DNS entry has switched to the new page.\n\n> > \n> > ETA Hausnummer?\n\n> \n> Yay! 2 days ahead of schedule! I fixed all the obviously broken links and there are just two minor details left.\n\n\nsagemath.org no longer serves packages (especially not the upstream tarballs); is that intentional, or will it again?  (Cf. [sage-release](http://thread.gmane.org/gmane.comp.mathematics.sage.release/2834).)",
    "created_at": "2015-05-13T19:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200676",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:94'></a>
Replying to [schilly](#comment%3A92):
> Replying to [leif](#comment%3A81):
> > Replying to [schilly](#comment%3A80):
> > > I could report back once the DNS entry has switched to the new page.

> > 
> > ETA Hausnummer?

> 
> Yay! 2 days ahead of schedule! I fixed all the obviously broken links and there are just two minor details left.


sagemath.org no longer serves packages (especially not the upstream tarballs); is that intentional, or will it again?  (Cf. [sage-release](http://thread.gmane.org/gmane.comp.mathematics.sage.release/2834).)



---

archive/issue_comments_200677.json:
```json
{
    "body": "**Changing branch** from \"[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)\" to \"[d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)\".",
    "created_at": "2015-05-13T20:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15642#issuecomment-200677",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/vbraun/use_mirrors_for_tarballs](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/use_mirrors_for_tarballs)" to "[d79364b9fc5131199eaed14340582715f2f937fb](https://github.com/sagemath/sagetrac-mirror/commit/d79364b9fc5131199eaed14340582715f2f937fb)".



---

archive/issue_events_141621.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T20:11:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141621"
}
```



---

archive/issue_events_141622.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T20:11:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15642",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15642#event-141622"
}
```
