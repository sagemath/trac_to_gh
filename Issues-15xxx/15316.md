# Issue 15316: Make gf2x respect SAGE_FAT_BINARY and use --libdir

archive/issues_015079.json:
```json
{
    "assignees": [],
    "body": "When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.\nWe should also use --libdir so that gf2x works ok on OpenSuse and similar systems.\n\n**Upstream**: [https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979](https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979)\n\nKeywords: **spkg gf2x**\n\nBranch/Commit: **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**\n\nReviewer: **Jeroen Demeyer, Jean-Pierre Flori**\n\nAuthor: **Jean-Pierre Flori, Erik Massop**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15316_\n\n",
    "closed_at": "2014-11-14T21:01:47Z",
    "created_at": "2013-10-22T11:35:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make gf2x respect SAGE_FAT_BINARY and use --libdir",
    "type": "issue",
    "updated_at": "2014-11-14T21:01:47Z",
    "url": "https://github.com/sagemath/sage/issues/15316",
    "user": "https://github.com/jpflori"
}
```
When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.
We should also use --libdir so that gf2x works ok on OpenSuse and similar systems.

**Upstream**: [https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979](https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979)

Keywords: **spkg gf2x**

Branch/Commit: **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**

Reviewer: **Jeroen Demeyer, Jean-Pierre Flori**

Author: **Jean-Pierre Flori, Erik Massop**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/15316_





---

archive/issue_events_217846.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-10-22T11:35:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217846"
}
```



---

archive/issue_events_217847.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-10-22T11:35:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217847"
}
```



---

archive/issue_events_217848.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-10-22T11:35:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217848"
}
```



---

archive/issue_events_217849.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-10-22T11:35:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217849"
}
```



---

archive/issue_comments_189738.json:
```json
{
    "body": "Commit: **[a278bc9](https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc)**",
    "created_at": "2014-01-06T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189738",
    "user": "https://github.com/jpflori"
}
```

Commit: **[a278bc9](https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc)**



---

archive/issue_comments_189739.json:
```json
{
    "body": "Changed keywords from none to **spkg gf2x**",
    "created_at": "2014-01-06T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189739",
    "user": "https://github.com/jpflori"
}
```

Changed keywords from none to **spkg gf2x**



---

archive/issue_events_217850.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-06T19:57:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217850"
}
```



---

archive/issue_comments_189740.json:
```json
{
    "body": "Branch: **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**",
    "created_at": "2014-01-06T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189740",
    "user": "https://github.com/jpflori"
}
```

Branch: **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**



---

archive/issue_comments_189741.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc\">a278bc9</a></td><td><code>Let gf2x use --libdir and make SAGE_FAT_BINARY work.</code></td></tr></table>\n",
    "created_at": "2014-01-06T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189741",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc">a278bc9</a></td><td><code>Let gf2x use --libdir and make SAGE_FAT_BINARY work.</code></td></tr></table>




---

archive/issue_comments_189742.json:
```json
{
    "body": "Author: **Jean-Pierre Flori**",
    "created_at": "2014-01-06T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189742",
    "user": "https://github.com/jpflori"
}
```

Author: **Jean-Pierre Flori**



---

archive/issue_comments_189743.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI'm not entirely sure how portable `ln -sf` is. I recommend changing it to a `rm -f` + `ln -s` instead.",
    "created_at": "2014-01-06T20:32:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189743",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

I'm not entirely sure how portable `ln -sf` is. I recommend changing it to a `rm -f` + `ln -s` instead.



---

archive/issue_comments_189744.json:
```json
{
    "body": "Changed commit from **[a278bc9](https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc)** to **[2371b35](https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8)**",
    "created_at": "2014-01-06T21:53:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189744",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a278bc9](https://github.com/sagemath/sagetrac-mirror/commit/a278bc91cc19a43f6f8bcfe5c08db486e804f8cc)** to **[2371b35](https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8)**



---

archive/issue_comments_189745.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8\">2371b35</a></td><td><code>Replace symlink in a more portable way.</code></td></tr></table>\n",
    "created_at": "2014-01-06T21:53:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189745",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8">2371b35</a></td><td><code>Replace symlink in a more portable way.</code></td></tr></table>




---

archive/issue_comments_189746.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nDone.",
    "created_at": "2014-01-06T21:53:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189746",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:4" align="right">comment:4</div>

Done.



---

archive/issue_events_217851.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-11T21:12:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217851"
}
```



---

archive/issue_events_217852.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-11T21:12:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217852"
}
```



---

archive/issue_comments_189747.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-01-11T21:12:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189747",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_189748.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nGiven that all x86_64 processors support SSE2, why should we disable that? We should disable it for i386, but not for x86_64.\n\nAnother small comment: I don't like\n\n```\necho \"Disabling optimizations.\"\n```\nWhy not make it\n\n```\necho \"Building a generic gf2x library.\"\n```",
    "created_at": "2014-01-11T21:12:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189748",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Given that all x86_64 processors support SSE2, why should we disable that? We should disable it for i386, but not for x86_64.

Another small comment: I don't like

```
echo "Disabling optimizations."
```
Why not make it

```
echo "Building a generic gf2x library."
```



---

archive/issue_comments_189749.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nFor SSE2, I said the same thing to gf2x devs and they told me sse2 was not part of the x86_64.\nSee https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979\n\nThe other point is I was too lazy to check if the system was actually 32 or 64 bits in spkg-install.",
    "created_at": "2014-01-11T23:10:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189749",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:6" align="right">comment:6</div>

For SSE2, I said the same thing to gf2x devs and they told me sse2 was not part of the x86_64.
See https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979

The other point is I was too lazy to check if the system was actually 32 or 64 bits in spkg-install.



---

archive/issue_comments_189750.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nPerhaps SSE2 is not part of the official standard, but at least all x86_64 CPUs support it, so it would say it is \"de facto\" standard. Also GCC will generate SSE+SSE2 code by default on x86_64, which is a very strong precedent.\n\nIs this not just a matter of **not** replacing the symlink?",
    "created_at": "2014-01-13T10:05:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189750",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Perhaps SSE2 is not part of the official standard, but at least all x86_64 CPUs support it, so it would say it is "de facto" standard. Also GCC will generate SSE+SSE2 code by default on x86_64, which is a very strong precedent.

Is this not just a matter of **not** replacing the symlink?



---

archive/issue_comments_189751.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.",
    "created_at": "2014-01-13T10:12:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189751",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

The gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.



---

archive/issue_comments_189752.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jdemeyer](#comment:7):\n> Perhaps SSE2 is not part of the official standard, but at least all x86_64 CPUs support it, so it would say it is \"de facto\" standard. Also GCC will generate SSE+SSE2 code by default on x86_64, which is a very strong precedent.\n\nI agree, and that's what I defended upstream, but Emmanuel didn't hear it that way...\n> \n> Is this not just a matter of **not** replacing the symlink?\n\nIn fact, if SSE2 is enabled, then we don't even need to replace the symlinks.\n\nApart from the feedback from upstream which does not want to provide a build system with an option to disable optimizations which would build an SSE2 lib but without further optimizations on x86_64, but just one which would simply point to the generic32/64 folders (so no assembly at all whatever the platform) when enabled.\n\nThe other issue is that I did not feel the need to add a bunch of code to spkg-install tyo detect if the system targeted is 32/64 bits, x86 or sparc or whatever, and then pass the correct value to the \"hwdir\" var (let's say x86, x86_64 and so on depending on the system, which is what I asked for upstream but got as a response: \"we'll pass generic32/64 and nothing more depending on the bit length\"), when passing unconditionnaly \"--disable-sse2 --disable-pclmul\" would more or less do the trick (except for the fact it broke the build on x86_64...).\nIndeed this would really fit in the upstream autotools project, not within our spkg-install script.\nBut you nearly convinced me to submit that upstream....",
    "created_at": "2014-01-13T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189752",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jdemeyer](#comment:7):
> Perhaps SSE2 is not part of the official standard, but at least all x86_64 CPUs support it, so it would say it is "de facto" standard. Also GCC will generate SSE+SSE2 code by default on x86_64, which is a very strong precedent.

I agree, and that's what I defended upstream, but Emmanuel didn't hear it that way...
> 
> Is this not just a matter of **not** replacing the symlink?

In fact, if SSE2 is enabled, then we don't even need to replace the symlinks.

Apart from the feedback from upstream which does not want to provide a build system with an option to disable optimizations which would build an SSE2 lib but without further optimizations on x86_64, but just one which would simply point to the generic32/64 folders (so no assembly at all whatever the platform) when enabled.

The other issue is that I did not feel the need to add a bunch of code to spkg-install tyo detect if the system targeted is 32/64 bits, x86 or sparc or whatever, and then pass the correct value to the "hwdir" var (let's say x86, x86_64 and so on depending on the system, which is what I asked for upstream but got as a response: "we'll pass generic32/64 and nothing more depending on the bit length"), when passing unconditionnaly "--disable-sse2 --disable-pclmul" would more or less do the trick (except for the fact it broke the build on x86_64...).
Indeed this would really fit in the upstream autotools project, not within our spkg-install script.
But you nearly convinced me to submit that upstream....



---

archive/issue_comments_189753.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment:8):\n> The gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.\n\nNice.\nI'll push that upstream, but how \"official\" is this document?\nIn fact when upstream told me SSE2 was not required I was not sure what and where the official ABI could be...",
    "created_at": "2014-01-13T10:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189753",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment:8):
> The gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.

Nice.
I'll push that upstream, but how "official" is this document?
In fact when upstream told me SSE2 was not required I was not sure what and where the official ABI could be...



---

archive/issue_comments_189754.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@jpflori](#comment:10):\n> Replying to [@jdemeyer](#comment:8):\n> > The gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.\n\n> Nice.\n> I'll push that upstream, but how \"official\" is this document?\n> In fact when upstream told me SSE2 was not required I was not sure what and where the official ABI could be...\n\nHum, the about page:\n* http://www.x86-64.org/about.html\nmakes it look more official than what the site design made me orignalmly think.",
    "created_at": "2014-01-13T10:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189754",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@jpflori](#comment:10):
> Replying to [@jdemeyer](#comment:8):
> > The gf2x devs are wrong: [http://www.x86-64.org/documentation/abi.pdf](http://www.x86-64.org/documentation/abi.pdf) states on p.125 that sse2 is a required processor feature.

> Nice.
> I'll push that upstream, but how "official" is this document?
> In fact when upstream told me SSE2 was not required I was not sure what and where the official ABI could be...

Hum, the about page:
* http://www.x86-64.org/about.html
makes it look more official than what the site design made me orignalmly think.



---

archive/issue_comments_189755.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI think you should discuss the ABI thing with upstream and see what they say.",
    "created_at": "2014-01-13T10:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189755",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

I think you should discuss the ABI thing with upstream and see what they say.



---

archive/issue_comments_189756.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jdemeyer](#comment:12):\n> I think you should discuss the ABI thing with upstream and see what they say.\n\nSure, I'll bump the discussion there, pointing to the exact page you spotted and hopefully their position will shift.\nI'll also directly provide a patch to implement what I (and apprently you) would like to see in.\n\nIn between I'll provide these changes here.",
    "created_at": "2014-01-13T10:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189756",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jdemeyer](#comment:12):
> I think you should discuss the ABI thing with upstream and see what they say.

Sure, I'll bump the discussion there, pointing to the exact page you spotted and hopefully their position will shift.
I'll also directly provide a patch to implement what I (and apprently you) would like to see in.

In between I'll provide these changes here.



---

archive/issue_comments_189757.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c\">0086d4a</a></td><td><code>Make generic build of gf2x smarter.</code></td></tr></table>\n",
    "created_at": "2014-01-13T14:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189757",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c">0086d4a</a></td><td><code>Make generic build of gf2x smarter.</code></td></tr></table>




---

archive/issue_comments_189758.json:
```json
{
    "body": "Changed commit from **[2371b35](https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8)** to **[0086d4a](https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c)**",
    "created_at": "2014-01-13T14:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189758",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2371b35](https://github.com/sagemath/sagetrac-mirror/commit/2371b3586b7b656293f036dc6e0d467946d02ad8)** to **[0086d4a](https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c)**



---

archive/issue_events_217853.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-13T14:45:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217853"
}
```



---

archive/issue_events_217854.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-13T14:45:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217854"
}
```



---

archive/issue_comments_189759.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,2 @@\n-When SAGE_FAT_BINARY is set we should pass --disable-sse2 --disable-pclmul to configure.\n+When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.\n We should also use --libdir so that gf2x works ok on OpenSuse and similar systems.\n``````\n",
    "created_at": "2014-01-13T14:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189759",
    "user": "https://github.com/jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,2 @@
-When SAGE_FAT_BINARY is set we should pass --disable-sse2 --disable-pclmul to configure.
+When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.
 We should also use --libdir so that gf2x works ok on OpenSuse and similar systems.
``````




---

archive/issue_comments_189760.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've tried to tweak the install script to pick up a correct generic value for hwdir depending on cpu/os.",
    "created_at": "2014-01-13T14:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189760",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:15" align="right">comment:15</div>

I've tried to tweak the install script to pick up a correct generic value for hwdir depending on cpu/os.



---

archive/issue_events_217855.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-13T14:48:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217855"
}
```



---

archive/issue_events_217856.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-13T14:48:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217856"
}
```



---

archive/issue_comments_189761.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHum, that's not enough to prevent the use of specific optimizations flags passed to gcc...",
    "created_at": "2014-01-13T14:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189761",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:16" align="right">comment:16</div>

Hum, that's not enough to prevent the use of specific optimizations flags passed to gcc...



---

archive/issue_comments_189762.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59925a5bd36ff9abae20f6aa54c5b002ba37db55\">59925a5</a></td><td><code>More fixes for gf2x generic build.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f\">5159831</a></td><td><code>Support SSE2 on x86_64 for gf2x.</code></td></tr></table>\n",
    "created_at": "2014-01-13T15:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189762",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59925a5bd36ff9abae20f6aa54c5b002ba37db55">59925a5</a></td><td><code>More fixes for gf2x generic build.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f">5159831</a></td><td><code>Support SSE2 on x86_64 for gf2x.</code></td></tr></table>




---

archive/issue_comments_189763.json:
```json
{
    "body": "Changed commit from **[0086d4a](https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c)** to **[5159831](https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f)**",
    "created_at": "2014-01-13T15:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189763",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0086d4a](https://github.com/sagemath/sagetrac-mirror/commit/0086d4a6c8ca1e1fa3da40a6bdcee21758c2331c)** to **[5159831](https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f)**



---

archive/issue_comments_189764.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nWhy this?\n\n```\nAll other platforms currently supported should build 32 bit by default\n```\nI would simply leave non-x86 platform alone.",
    "created_at": "2014-01-13T16:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189764",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Why this?

```
All other platforms currently supported should build 32 bit by default
```
I would simply leave non-x86 platform alone.



---

archive/issue_comments_189765.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nInstead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.",
    "created_at": "2014-01-13T16:16:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189765",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Instead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.



---

archive/issue_comments_189766.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jdemeyer](#comment:18):\n> Why this?\n> \n> ```\n> All other platforms currently supported should build 32 bit by default\n> ```\n\nBecause it seemed to me it was the case.\nI thought of:\n* Solaris/Linux on sparc* where the default is 32 bit (as per what gcc does) unless SAGE64 is passed (by the way the current filtering might be wrong on Solaris on top of x86_64...).\n* ARM (only 32 bit at the moment, but not even really officially supported anyway).\n* Cygwin should only be x86/x86_64 (does Windows even run on something else?) so is taken care of.\n* Darwin on PPC[!64]/PowerPC (and even PPC64 in fact) which is only supported 32 bit by Sage.\n* non-Darwin ppc64 (let's say POWER? system) are 64 bits.\n* don\"t really know on what FreeBSD can run on, but it's not officially supported, and x86/x86_64.\n\nHum, I forgot (linux) itanium which happens to be 64 bit (only I'd say?)...\n\nAll that to say, that my original point was to avoid to develop an overly complicated test script which shouldn't really belong within the install script imho.",
    "created_at": "2014-01-13T16:18:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189766",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jdemeyer](#comment:18):
> Why this?
> 
> ```
> All other platforms currently supported should build 32 bit by default
> ```

Because it seemed to me it was the case.
I thought of:
* Solaris/Linux on sparc* where the default is 32 bit (as per what gcc does) unless SAGE64 is passed (by the way the current filtering might be wrong on Solaris on top of x86_64...).
* ARM (only 32 bit at the moment, but not even really officially supported anyway).
* Cygwin should only be x86/x86_64 (does Windows even run on something else?) so is taken care of.
* Darwin on PPC[!64]/PowerPC (and even PPC64 in fact) which is only supported 32 bit by Sage.
* non-Darwin ppc64 (let's say POWER? system) are 64 bits.
* don"t really know on what FreeBSD can run on, but it's not officially supported, and x86/x86_64.

Hum, I forgot (linux) itanium which happens to be 64 bit (only I'd say?)...

All that to say, that my original point was to avoid to develop an overly complicated test script which shouldn't really belong within the install script imho.



---

archive/issue_comments_189767.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@jdemeyer](#comment:18):\n> I would simply leave non-x86 platform alone.\n\nIndeed, this could work as gf2x is smart enough to detect what unsigned long length the compiler use and pick a correct generic* directory.",
    "created_at": "2014-01-13T16:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189767",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@jdemeyer](#comment:18):
> I would simply leave non-x86 platform alone.

Indeed, this could work as gf2x is smart enough to detect what unsigned long length the compiler use and pick a correct generic* directory.



---

archive/issue_comments_189768.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jdemeyer](#comment:19):\n> Instead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.\n\nI'm fed up with overkill patches produced by autoreconfing and don't have access to a machine where your nice autotools spkg is installed (and even with it, autoreconfing can still be a hell sometimes).",
    "created_at": "2014-01-13T16:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189768",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jdemeyer](#comment:19):
> Instead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.

I'm fed up with overkill patches produced by autoreconfing and don't have access to a machine where your nice autotools spkg is installed (and even with it, autoreconfing can still be a hell sometimes).



---

archive/issue_comments_189769.json:
```json
{
    "body": "Changed commit from **[5159831](https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f)** to **[ddee57e](https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5)**",
    "created_at": "2014-01-13T16:25:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189769",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5159831](https://github.com/sagemath/sagetrac-mirror/commit/5159831b64a5a5a3f9c83480f61f031224cd6f5f)** to **[ddee57e](https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5)**



---

archive/issue_comments_189770.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5\">ddee57e</a></td><td><code>Simplify generic build of gf2x.</code></td></tr></table>\n",
    "created_at": "2014-01-13T16:25:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189770",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5">ddee57e</a></td><td><code>Simplify generic build of gf2x.</code></td></tr></table>




---

archive/issue_comments_189771.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jpflori](#comment:22):\n> Replying to [@jdemeyer](#comment:19):\n> > Instead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.\n\n> I'm fed up with overkill patches produced by autoreconfing and don't have access to a machine where your nice autotools spkg is installed (and even with it, autoreconfing can still be a hell sometimes).\n\nAlso note that is quite exactly what autoreconfing would produce (with all the bullshit removed) or so I hope.\nI can provide the configure.ac corrsepondig part, which is basically upstream except for the SSE2 on x86_64 part.",
    "created_at": "2014-01-13T16:28:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189771",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jpflori](#comment:22):
> Replying to [@jdemeyer](#comment:19):
> > Instead of money-patching `configure`, you should patch `configure.ac` and re-run `autoconf` and add the resulting patch.

> I'm fed up with overkill patches produced by autoreconfing and don't have access to a machine where your nice autotools spkg is installed (and even with it, autoreconfing can still be a hell sometimes).

Also note that is quite exactly what autoreconfing would produce (with all the bullshit removed) or so I hope.
I can provide the configure.ac corrsepondig part, which is basically upstream except for the SSE2 on x86_64 part.



---

archive/issue_comments_189772.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@jpflori](#comment:24):\n> I can provide the configure.ac corrsepondig part\n\nPlease do.",
    "created_at": "2014-01-14T08:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189772",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@jpflori](#comment:24):
> I can provide the configure.ac corrsepondig part

Please do.



---

archive/issue_comments_189773.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jpflori](#comment:22):\n> and even with it, autoreconfing can still be a hell sometimes.\n\nThat's usually because upstream uses a distro-specific version of autotools. For vanilla versions of autotools, the output that you get with the autotools spkg should be identical to the one in the package.",
    "created_at": "2014-01-14T08:13:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189773",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jpflori](#comment:22):
> and even with it, autoreconfing can still be a hell sometimes.

That's usually because upstream uses a distro-specific version of autotools. For vanilla versions of autotools, the output that you get with the autotools spkg should be identical to the one in the package.



---

archive/issue_comments_189774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,4 @@\n When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.\n We should also use --libdir so that gf2x works ok on OpenSuse and similar systems.\n+\n+**Upstream**: [https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979](https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979)\n``````\n",
    "created_at": "2014-01-14T11:00:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189774",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,4 @@
 When SAGE_FAT_BINARY is set we should pick a generic value for hwdir.
 We should also use --libdir so that gf2x works ok on OpenSuse and similar systems.
+
+**Upstream**: [https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979](https://gforge.inria.fr/tracker/index.php?func=detail&aid=16566&group_id=1874&atid=6979)
``````




---

archive/issue_comments_189775.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment:26):\n> Replying to [@jpflori](#comment:22):\n> > and even with it, autoreconfing can still be a hell sometimes.\n\n> That's usually because upstream uses a distro-specific version of autotools. For vanilla versions of autotools, the output that you get with the autotools spkg should be identical to the one in the package.\n\nOn a side note, would you consider updateing the autotools spkg and gitify it?\n\nI'm currently crafting a proper patch, and while at it I'll aslo include the fixes for SSE2 checks.",
    "created_at": "2014-01-14T11:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189775",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment:26):
> Replying to [@jpflori](#comment:22):
> > and even with it, autoreconfing can still be a hell sometimes.

> That's usually because upstream uses a distro-specific version of autotools. For vanilla versions of autotools, the output that you get with the autotools spkg should be identical to the one in the package.

On a side note, would you consider updateing the autotools spkg and gitify it?

I'm currently crafting a proper patch, and while at it I'll aslo include the fixes for SSE2 checks.



---

archive/issue_comments_189776.json:
```json
{
    "body": "Changed commit from **[ddee57e](https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5)** to **[75888b1](https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34)**",
    "created_at": "2014-01-14T11:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189776",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ddee57e](https://github.com/sagemath/sagetrac-mirror/commit/ddee57e91708e8599f7c5d8d94aeffe5f0ae2cc5)** to **[75888b1](https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34)**



---

archive/issue_comments_189777.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdd76942417b05350d5a0d05e91673b00958e3ce\">fdd7694</a></td><td><code>Properly autoreconfed patches.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34\">75888b1</a></td><td><code>Document new gf2x patch.</code></td></tr></table>\n",
    "created_at": "2014-01-14T11:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189777",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdd76942417b05350d5a0d05e91673b00958e3ce">fdd7694</a></td><td><code>Properly autoreconfed patches.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34">75888b1</a></td><td><code>Document new gf2x patch.</code></td></tr></table>




---

archive/issue_comments_189778.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nNow it seems that as acinclude.m4 is patched (before configure), autotools want to rerun some magic stuff.\nShould we manually touch Makefiles?",
    "created_at": "2014-01-14T11:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189778",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:30" align="right">comment:30</div>

Now it seems that as acinclude.m4 is patched (before configure), autotools want to rerun some magic stuff.
Should we manually touch Makefiles?



---

archive/issue_comments_189779.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@jpflori](#comment:30):\n> Should we manually touch Makefiles?\n\nSure, why not?",
    "created_at": "2014-01-14T12:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189779",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@jpflori](#comment:30):
> Should we manually touch Makefiles?

Sure, why not?



---

archive/issue_comments_189780.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment:31):\n> Replying to [@jpflori](#comment:30):\n> > Should we manually touch Makefiles?\n\n> Sure, why not?\n\nBecause:\n* it's more work,\n* it's a pain to maintain as it will be additional code within spkg-install (unless I introduce empty chunks touching these Makefiles in the same patch file touching acinclude.m4 but it feels hackish),\n* I'm lazy :)",
    "created_at": "2014-01-14T13:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189780",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment:31):
> Replying to [@jpflori](#comment:30):
> > Should we manually touch Makefiles?

> Sure, why not?

Because:
* it's more work,
* it's a pain to maintain as it will be additional code within spkg-install (unless I introduce empty chunks touching these Makefiles in the same patch file touching acinclude.m4 but it feels hackish),
* I'm lazy :)



---

archive/issue_comments_189781.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b\">1fb1afe</a></td><td><code>Prevent autotools to regenerate files.</code></td></tr></table>\n",
    "created_at": "2014-01-14T14:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189781",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b">1fb1afe</a></td><td><code>Prevent autotools to regenerate files.</code></td></tr></table>




---

archive/issue_comments_189782.json:
```json
{
    "body": "Changed commit from **[75888b1](https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34)** to **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)**",
    "created_at": "2014-01-14T14:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189782",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[75888b1](https://github.com/sagemath/sagetrac-mirror/commit/75888b131d6dbf68506a0096bec7c8b3cd28db34)** to **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)**



---

archive/issue_events_217857.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-14T14:12:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217857"
}
```



---

archive/issue_events_217858.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-01-14T14:12:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217858"
}
```



---

archive/issue_comments_189783.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI'm confused because it seems that you're solving the same problem twice:\n1. You supply the `hwdir` option to configure\n2. You supply the `--disable-hardware-specific-code` option to configure\n\nWouldn't either of these two work by itself?\n\nA more serious issue is that you should not assume that SSE2 code can be *compiled* properly, the compiler and assembler need to support it. Hardware support and software support are orthogonal. On `x86_64`, you may assume hardware support but you still need `CHECK_SSE2_SUPPORT()` to check for software support.",
    "created_at": "2014-01-14T14:58:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189783",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

I'm confused because it seems that you're solving the same problem twice:
1. You supply the `hwdir` option to configure
2. You supply the `--disable-hardware-specific-code` option to configure

Wouldn't either of these two work by itself?

A more serious issue is that you should not assume that SSE2 code can be *compiled* properly, the compiler and assembler need to support it. Hardware support and software support are orthogonal. On `x86_64`, you may assume hardware support but you still need `CHECK_SSE2_SUPPORT()` to check for software support.



---

archive/issue_events_217859.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-14T14:59:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217859"
}
```



---

archive/issue_events_217860.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-14T14:59:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217860"
}
```



---

archive/issue_comments_189784.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nHang on, working on a patch...",
    "created_at": "2014-01-14T15:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189784",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

Hang on, working on a patch...



---

archive/issue_comments_189785.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@jdemeyer](#comment:35):\n> I'm confused because it seems that you're solving the same problem twice:\n> 1. You supply the `hwdir` option to configure\n> 2. You supply the `--disable-hardware-specific-code` option to configure\n> \n> Wouldn't either of these two work by itself?\n\nNot right now.\nWith \"--disable-hardware-specific-code\" you only use the generic32, generic64 targets.\nWith only hwdir set, the configure script still checks whether SSE2 and pclmul are supported and can add the corresponding flags to CFLAGS.\n> \n> A more serious issue is that you should not assume that SSE2 code can be *compiled* properly, the compiler and assembler need to support it. Hardware support and software support are orthogonal. On `x86_64`, you may assume hardware support but you still need `CHECK_SSE2_SUPPORT()` to check for software support.\n\nI agree with the hardware/software dichotomy.\nThe problem is that the CHECK_SSE2_SUPPORT macro does not only checks for SSE2 support but can add things to CFLAGS (for example on 32 bits where -msse2 is needed)... so we cannot just call it unconditionally and that's why it is not called upstream when \"--disable-hardware-specific-code\" is passed, and the upstream choice to only use generic32/64 seems the right one.\n\nIf we want to use the x86_64 hwdir (with sse2) for sage generic builds, we should still pass \"--disable-hardware-specific-code\" to ensure pclmul is not used, nor sse2 on x86, but still call CHECK_SSE2_SUPPORT() on x86_64 and if that succeeds, set hwdir to x86_64.\n\nThe other solution is to modify the symlinks as before so that the x86_64 does not require sse2 (but could still use plain assembly).",
    "created_at": "2014-01-14T15:09:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189785",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@jdemeyer](#comment:35):
> I'm confused because it seems that you're solving the same problem twice:
> 1. You supply the `hwdir` option to configure
> 2. You supply the `--disable-hardware-specific-code` option to configure
> 
> Wouldn't either of these two work by itself?

Not right now.
With "--disable-hardware-specific-code" you only use the generic32, generic64 targets.
With only hwdir set, the configure script still checks whether SSE2 and pclmul are supported and can add the corresponding flags to CFLAGS.
> 
> A more serious issue is that you should not assume that SSE2 code can be *compiled* properly, the compiler and assembler need to support it. Hardware support and software support are orthogonal. On `x86_64`, you may assume hardware support but you still need `CHECK_SSE2_SUPPORT()` to check for software support.

I agree with the hardware/software dichotomy.
The problem is that the CHECK_SSE2_SUPPORT macro does not only checks for SSE2 support but can add things to CFLAGS (for example on 32 bits where -msse2 is needed)... so we cannot just call it unconditionally and that's why it is not called upstream when "--disable-hardware-specific-code" is passed, and the upstream choice to only use generic32/64 seems the right one.

If we want to use the x86_64 hwdir (with sse2) for sage generic builds, we should still pass "--disable-hardware-specific-code" to ensure pclmul is not used, nor sse2 on x86, but still call CHECK_SSE2_SUPPORT() on x86_64 and if that succeeds, set hwdir to x86_64.

The other solution is to modify the symlinks as before so that the x86_64 does not require sse2 (but could still use plain assembly).



---

archive/issue_comments_189786.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nDid upstream accept your `--disable-hardware-specific-code` patch?",
    "created_at": "2014-01-14T15:56:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189786",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

Did upstream accept your `--disable-hardware-specific-code` patch?



---

archive/issue_comments_189787.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nSimplified version of the patches, seems to work (at first sight).",
    "created_at": "2014-01-14T15:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189787",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

Simplified version of the patches, seems to work (at first sight).



---

archive/issue_comments_189788.json:
```json
{
    "body": "Changed author from **Jean-Pierre Flori** to **Jean-Pierre Flori, Jeroen Demeyer**",
    "created_at": "2014-01-14T15:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189788",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jean-Pierre Flori** to **Jean-Pierre Flori, Jeroen Demeyer**



---

archive/issue_events_217861.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-14T15:58:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217861"
}
```



---

archive/issue_events_217862.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-01-14T15:58:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217862"
}
```



---

archive/issue_comments_189789.json:
```json
{
    "body": "Changed author from **Jean-Pierre Flori, Jeroen Demeyer** to **Jean-Pierre Flori**",
    "created_at": "2014-01-14T15:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189789",
    "user": "https://github.com/jpflori"
}
```

Changed author from **Jean-Pierre Flori, Jeroen Demeyer** to **Jean-Pierre Flori**



---

archive/issue_comments_189790.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@jdemeyer](#comment:39):\n> Did upstream accept your `--disable-hardware-specific-code` patch?\n\nHummm, this patch is upstream (see commit numbers in SPKG.txt, 162 ands 167 IIRC). \nOnly the x86_64 part which assumes SSE2 support is mine.",
    "created_at": "2014-01-14T15:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189790",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@jdemeyer](#comment:39):
> Did upstream accept your `--disable-hardware-specific-code` patch?

Hummm, this patch is upstream (see commit numbers in SPKG.txt, 162 ands 167 IIRC). 
Only the x86_64 part which assumes SSE2 support is mine.



---

archive/issue_comments_189791.json:
```json
{
    "body": "Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)**",
    "created_at": "2014-01-14T16:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189791",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)**



---

archive/issue_comments_189792.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI didn't realize the patch was upstream, so perhaps I shouldn't have changed it. Anyway, I'm going to leave this for today...\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b\">c059db7</a></td><td><code>Simplify gf2x patches</code></td></tr></table>\n",
    "created_at": "2014-01-14T16:02:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189792",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">comment:43</div>

I didn't realize the patch was upstream, so perhaps I shouldn't have changed it. Anyway, I'm going to leave this for today...

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b">c059db7</a></td><td><code>Simplify gf2x patches</code></td></tr></table>




---

archive/issue_comments_189793.json:
```json
{
    "body": "Changed commit from **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)** to **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)**",
    "created_at": "2014-01-14T16:02:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189793",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)** to **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)**



---

archive/issue_comments_189794.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**",
    "created_at": "2014-01-14T16:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189794",
    "user": "https://github.com/jpflori"
}
```

Changed branch from **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**



---

archive/issue_comments_189795.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nIn fact I'm happier with your patch than with what upstream provided, so you could even transfer it upstream.\n\nAnd note that your patch touch configure.ac after configure.",
    "created_at": "2014-01-14T16:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189795",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:44" align="right">comment:44</div>

In fact I'm happier with your patch than with what upstream provided, so you could even transfer it upstream.

And note that your patch touch configure.ac after configure.



---

archive/issue_comments_189796.json:
```json
{
    "body": "Changed commit from **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)** to **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)**",
    "created_at": "2014-01-14T16:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189796",
    "user": "https://github.com/jpflori"
}
```

Changed commit from **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)** to **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)**



---

archive/issue_comments_189797.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nAbout the patch order: you're touching `configure` anyway...",
    "created_at": "2014-01-14T16:08:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189797",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

About the patch order: you're touching `configure` anyway...



---

archive/issue_comments_189798.json:
```json
{
    "body": "Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)**",
    "created_at": "2014-01-14T16:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189798",
    "user": "https://github.com/jpflori"
}
```

Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)**



---

archive/issue_comments_189799.json:
```json
{
    "body": "Changed commit from **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)** to **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)**",
    "created_at": "2014-01-14T16:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189799",
    "user": "https://github.com/jpflori"
}
```

Changed commit from **[1fb1afe](https://github.com/sagemath/sagetrac-mirror/commit/1fb1afe23d755de863d6c8f17b317f2349b8955b)** to **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)**



---

archive/issue_comments_189800.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOops, I mistakenly changed the branch name.\n\nAbout the patch order: I'd say your patch is the last one so configure.ac will have a more recent timestamp than configure which is what we want to avoid, isn't it? (ok in real life I don't know what granularity timestamps have, so if it is one second, timestamps should be the same).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b\">c059db7</a></td><td><code>Simplify gf2x patches</code></td></tr></table>\n",
    "created_at": "2014-01-14T16:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189800",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:46" align="right">comment:46</div>

Oops, I mistakenly changed the branch name.

About the patch order: I'd say your patch is the last one so configure.ac will have a more recent timestamp than configure which is what we want to avoid, isn't it? (ok in real life I don't know what granularity timestamps have, so if it is one second, timestamps should be the same).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b">c059db7</a></td><td><code>Simplify gf2x patches</code></td></tr></table>




---

archive/issue_comments_189801.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nFor the autotools package: see #15123.",
    "created_at": "2014-01-14T17:41:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189801",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

For the autotools package: see #15123.



---

archive/issue_comments_189802.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nYour branch fails on ppc64.\nIn fact mine does as well in a similar way but only when SAGE_FAT_BINARY=yes..\nApparently the tuning process tries to build sse2 code.\n\nAnd this won't work if the compiler does not support SSE2:\n\n```\n++ CHECK_SSE2_SUPPORT()\n++ if test x$enable_hardware_specific_code = xyes; then\n++ CHECK_PCLMUL_SUPPORT()\n++ fi\n++ if test x$gf2x_cv_cc_supports_pclmul != xyes ; then\n+ hwdir=x86_64\n```\nbecause the x86_64 dir cannot be used without sse2 support (and that's why you could and still can not build on x86_64 with --disable-sse2).",
    "created_at": "2014-01-15T22:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189802",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:48" align="right">comment:48</div>

Your branch fails on ppc64.
In fact mine does as well in a similar way but only when SAGE_FAT_BINARY=yes..
Apparently the tuning process tries to build sse2 code.

And this won't work if the compiler does not support SSE2:

```
++ CHECK_SSE2_SUPPORT()
++ if test x$enable_hardware_specific_code = xyes; then
++ CHECK_PCLMUL_SUPPORT()
++ fi
++ if test x$gf2x_cv_cc_supports_pclmul != xyes ; then
+ hwdir=x86_64
```
because the x86_64 dir cannot be used without sse2 support (and that's why you could and still can not build on x86_64 with --disable-sse2).



---

archive/issue_comments_189803.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThe matter is surely that\n\n```\nAM_CONDITIONAL([GF2X_SSE2_AVAILABLE],[test \"x$gf2x_cv_cc_supports_sse2\" != xno])\nAM_CONDITIONAL([GF2X_PCLMUL_AVAILABLE],[test \"x$gf2x_cv_cc_supports_pclmul\" != xno])\n```\nbehaves wrongly because the `_supports_` vars are left undefined.",
    "created_at": "2014-01-15T22:07:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189803",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:49" align="right">comment:49</div>

The matter is surely that

```
AM_CONDITIONAL([GF2X_SSE2_AVAILABLE],[test "x$gf2x_cv_cc_supports_sse2" != xno])
AM_CONDITIONAL([GF2X_PCLMUL_AVAILABLE],[test "x$gf2x_cv_cc_supports_pclmul" != xno])
```
behaves wrongly because the `_supports_` vars are left undefined.



---

archive/issue_comments_189804.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nYes, the `!= xno` should be replaced by `= xyes` I guess.",
    "created_at": "2014-01-15T22:10:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189804",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50" align="right">comment:50</div>

Yes, the `!= xno` should be replaced by `= xyes` I guess.



---

archive/issue_comments_189805.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nA better and more flexible solution could be to decorrelate the sse2/pclmul tests and the definitions of HAVE_*_SUPPORT.\nJust as \n\n```\nAM_CONDITIONAL([GF2X_PCLMUL_AVAILABLE],[test \"x$gf2x_cv_cc_supports_pclmul\" != xno])\n```\nwhich is in configure.ac, the following which is in acinclude.m4 within the SSE2 support macro could be in configure.ac.\n\n```\n if test \"$gf2x_cv_cc_supports_sse2\" != \"no\" ;then\n  AC_DEFINE([HAVE_SSE2_SUPPORT],[1],[Define if sse-2 code as present in the source tree is supported by the compiler])\n fi\n```",
    "created_at": "2014-01-15T22:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189805",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:51" align="right">comment:51</div>

A better and more flexible solution could be to decorrelate the sse2/pclmul tests and the definitions of HAVE_*_SUPPORT.
Just as 

```
AM_CONDITIONAL([GF2X_PCLMUL_AVAILABLE],[test "x$gf2x_cv_cc_supports_pclmul" != xno])
```
which is in configure.ac, the following which is in acinclude.m4 within the SSE2 support macro could be in configure.ac.

```
 if test "$gf2x_cv_cc_supports_sse2" != "no" ;then
  AC_DEFINE([HAVE_SSE2_SUPPORT],[1],[Define if sse-2 code as present in the source tree is supported by the compiler])
 fi
```



---

archive/issue_comments_189806.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@jdemeyer](#comment:50):\n> Yes, the `!= xno` should be replaced by `= xyes` I guess.\n\nThat would also do the trick.",
    "created_at": "2014-01-15T22:13:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189806",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@jdemeyer](#comment:50):
> Yes, the `!= xno` should be replaced by `= xyes` I guess.

That would also do the trick.



---

archive/issue_comments_189807.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@jpflori](#comment:46):\n> About the patch order: I'd say your patch is the last one so configure.ac will have a more recent timestamp than configure which is what we want to avoid, isn't it? (ok in real life I don't know what granularity timestamps have, so if it is one second, timestamps should be the same).\n\nCould you clarify this as I'm apparently mistaken of why configure.ac should usually be patched before configure?",
    "created_at": "2014-01-16T10:43:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189807",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@jpflori](#comment:46):
> About the patch order: I'd say your patch is the last one so configure.ac will have a more recent timestamp than configure which is what we want to avoid, isn't it? (ok in real life I don't know what granularity timestamps have, so if it is one second, timestamps should be the same).

Could you clarify this as I'm apparently mistaken of why configure.ac should usually be patched before configure?



---

archive/issue_comments_189808.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**",
    "created_at": "2014-01-28T18:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189808",
    "user": "https://github.com/jpflori"
}
```

Changed branch from **[u/jdemeyer/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**



---

archive/issue_comments_189809.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI've implemented the changes suggested above.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3\">a231689</a></td><td><code>Make the SSE2 stuff work if the compiler does not support SSE2.</code></td></tr></table>\n",
    "created_at": "2014-01-28T18:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189809",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:54" align="right">comment:54</div>

I've implemented the changes suggested above.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3">a231689</a></td><td><code>Make the SSE2 stuff work if the compiler does not support SSE2.</code></td></tr></table>




---

archive/issue_comments_189810.json:
```json
{
    "body": "Changed commit from **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)** to **[a231689](https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3)**",
    "created_at": "2014-01-28T18:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189810",
    "user": "https://github.com/jpflori"
}
```

Changed commit from **[c059db7](https://github.com/sagemath/sagetrac-mirror/commit/c059db7ebf1de9c819d549158189d52b4949af8b)** to **[a231689](https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3)**



---

archive/issue_events_217863.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217863"
}
```



---

archive/issue_events_217864.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217864"
}
```



---

archive/issue_comments_189811.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nJeroen, any chance you could review this one?",
    "created_at": "2014-03-30T14:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189811",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:56" align="right">comment:56</div>

Jeroen, any chance you could review this one?



---

archive/issue_events_217865.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217865"
}
```



---

archive/issue_events_217866.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217866"
}
```



---

archive/issue_events_217867.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-16T14:23:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217867"
}
```



---

archive/issue_events_217868.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-16T14:23:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217868"
}
```



---

archive/issue_comments_189812.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@jpflori](#comment:52):\n> Replying to [@jdemeyer](#comment:50):\n> > Yes, the `!= xno` should be replaced by `= xyes` I guess.\n\n> That would also do the trick.\n\nNot quite: $gf2x_cv_cc_supports_sse2 can be \"requires -msse2\", and $gf2x_cv_cc_supports_pclmul can be \"requires -mpclmul\".\n\nSeems more sane to me to run CHECK_SSE2_SUPPORT and CHECK_PCLMUL_SUPPORT always, so that the case  where gf2x_cv_cc_supports_sse2/pclmul is undefined does not occur, with enable_sse2=no and enable_pclmul=no as appropriate.",
    "created_at": "2014-06-16T14:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189812",
    "user": "https://github.com/sagetrac-emassop"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@jpflori](#comment:52):
> Replying to [@jdemeyer](#comment:50):
> > Yes, the `!= xno` should be replaced by `= xyes` I guess.

> That would also do the trick.

Not quite: $gf2x_cv_cc_supports_sse2 can be "requires -msse2", and $gf2x_cv_cc_supports_pclmul can be "requires -mpclmul".

Seems more sane to me to run CHECK_SSE2_SUPPORT and CHECK_PCLMUL_SUPPORT always, so that the case  where gf2x_cv_cc_supports_sse2/pclmul is undefined does not occur, with enable_sse2=no and enable_pclmul=no as appropriate.



---

archive/issue_comments_189813.json:
```json
{
    "body": "Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/emassop/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/emassop/ticket/15316)**",
    "created_at": "2014-06-19T08:40:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189813",
    "user": "https://github.com/sagetrac-emassop"
}
```

Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[u/emassop/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/emassop/ticket/15316)**



---

archive/issue_events_217869.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-19T09:03:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217869"
}
```



---

archive/issue_events_217870.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-19T09:03:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217870"
}
```



---

archive/issue_comments_189814.json:
```json
{
    "body": "Changed commit from **[a231689](https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3)** to **[3ca3e7b](https://github.com/sagemath/sagetrac-mirror/commit/3ca3e7b9386475ccefea3f9f9c6c0a29c141190d)**",
    "created_at": "2014-06-19T09:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189814",
    "user": "https://github.com/sagetrac-emassop"
}
```

Changed commit from **[a231689](https://github.com/sagemath/sagetrac-mirror/commit/a23168950a9901003604b85a765379d24ac63fb3)** to **[3ca3e7b](https://github.com/sagemath/sagetrac-mirror/commit/3ca3e7b9386475ccefea3f9f9c6c0a29c141190d)**



---

archive/issue_comments_189815.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nBy seperating enabling of sse2/pclmul support from checking for support, configure can now run CHECK_(SSE2|PCLMUL)_SUPPORT always, avoiding the case where $gfx_cv_cc_support_(sse|pclmul) is not defined.\n\nI'm afraid the patches are all different again. I imported upstream [svn](https://github.com/nesciens/gf2x/tree/svn) and the upstream [tarballs](https://github.com/nesciens/gf2x/tree/tarballs) into [a git repository](https://github.com/nesciens/gf2x), then applied the changes in several topic branches ([cygwin](https://github.com/nesciens/gf2x/tree/cygwin), [hardware-specific](https://github.com/nesciens/gf2x/tree/hardware-specific), [sse2](https://github.com/nesciens/gf2x/tree/sse2), and [tr](https://github.com/nesciens/gf2x/tree/tr)), merge --squash'ed those branches into [single commits](https://github.com/nesciens/gf2x/commits/sage), updated autotooled files (running autoreconf and reverse applying autoreconf's effect on upstream tarball), and finally ran git format-patch to obtain the patch series.",
    "created_at": "2014-06-19T09:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189815",
    "user": "https://github.com/sagetrac-emassop"
}
```

<div id="comment:60" align="right">comment:60</div>

By seperating enabling of sse2/pclmul support from checking for support, configure can now run CHECK_(SSE2|PCLMUL)_SUPPORT always, avoiding the case where $gfx_cv_cc_support_(sse|pclmul) is not defined.

I'm afraid the patches are all different again. I imported upstream [svn](https://github.com/nesciens/gf2x/tree/svn) and the upstream [tarballs](https://github.com/nesciens/gf2x/tree/tarballs) into [a git repository](https://github.com/nesciens/gf2x), then applied the changes in several topic branches ([cygwin](https://github.com/nesciens/gf2x/tree/cygwin), [hardware-specific](https://github.com/nesciens/gf2x/tree/hardware-specific), [sse2](https://github.com/nesciens/gf2x/tree/sse2), and [tr](https://github.com/nesciens/gf2x/tree/tr)), merge --squash'ed those branches into [single commits](https://github.com/nesciens/gf2x/commits/sage), updated autotooled files (running autoreconf and reverse applying autoreconf's effect on upstream tarball), and finally ran git format-patch to obtain the patch series.



---

archive/issue_comments_189816.json:
```json
{
    "body": "Changed author from **Jean-Pierre Flori** to **Jean-Pierre Flori, Erik Massop**",
    "created_at": "2014-06-19T09:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189816",
    "user": "https://github.com/sagetrac-emassop"
}
```

Changed author from **Jean-Pierre Flori** to **Jean-Pierre Flori, Erik Massop**



---

archive/issue_comments_189817.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nIt's not so easy to see what the last commit actually does and unfortunately I have no time to play around applying different sets of patches to the src we distribute, diff the result and play with strange archs, compilers.\n\nSo my question is: what dirs will be used on x86_64 when the compiler support emitting sse2 instructions and when it does not and when the blabla-hardware-blabla flag is passed?",
    "created_at": "2014-06-19T14:06:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189817",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:61" align="right">comment:61</div>

It's not so easy to see what the last commit actually does and unfortunately I have no time to play around applying different sets of patches to the src we distribute, diff the result and play with strange archs, compilers.

So my question is: what dirs will be used on x86_64 when the compiler support emitting sse2 instructions and when it does not and when the blabla-hardware-blabla flag is passed?



---

archive/issue_events_217871.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-19T17:33:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217871"
}
```



---

archive/issue_events_217872.json:
```json
{
    "actor": "https://github.com/sagetrac-emassop",
    "created_at": "2014-06-19T17:33:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217872"
}
```



---

archive/issue_comments_189818.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nWith --enable-hardware-specific-code (the default), it depends on whether code with sse2/pclmul can be **compiled and executed**.\n\n|cpu   |execute sse2 |execute pclmul |dir          |\n|:------:|:-------------:|:---------------:|:-------------:|\n|x86_64  |yes            |yes              |x86_64_pclmul  |\n|x86_64  |no             |yes              |x86_64_pclmul  |\n|x86_64  |yes            |no               |x86_64         |\n|x86_64  |no             |no               |generic64      |\n\nWith --disable-hardware-specific-code: generic64.\n\nHmm, according to the discussion above that latter should be x86_64 instead of generic64, right? I'll fiddle with this some more.\n\nI'm thinking of having the options --enable-sse2 and --enable-pclmul with values \"no\"/\"hostcpu\"/\"native\"/\"yes\", with as default the value of --enable-hardware-specific-code which would itself defaults to \"native\". Value \"hostcpu\" would enable minimally for this $host_cpu (for x86_64 this would be sse2 yes and pclmul no). Value \"native\" would try to compile and execute. Having calculated the final values for --enable-sse2 and --enable-pclmul, sse2 and pclmul would be enabled based on these values. Configure would error out if the compiler lacks support.\n\nThe default directory would be selected based on $host_cpu and whether sse2 and pclmul are enabled. When the directory is forced, insufficient sse2/pclmul might be enabled and configure would error out.",
    "created_at": "2014-06-19T17:33:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189818",
    "user": "https://github.com/sagetrac-emassop"
}
```

<div id="comment:62" align="right">comment:62</div>

With --enable-hardware-specific-code (the default), it depends on whether code with sse2/pclmul can be **compiled and executed**.

|cpu   |execute sse2 |execute pclmul |dir          |
|:------:|:-------------:|:---------------:|:-------------:|
|x86_64  |yes            |yes              |x86_64_pclmul  |
|x86_64  |no             |yes              |x86_64_pclmul  |
|x86_64  |yes            |no               |x86_64         |
|x86_64  |no             |no               |generic64      |

With --disable-hardware-specific-code: generic64.

Hmm, according to the discussion above that latter should be x86_64 instead of generic64, right? I'll fiddle with this some more.

I'm thinking of having the options --enable-sse2 and --enable-pclmul with values "no"/"hostcpu"/"native"/"yes", with as default the value of --enable-hardware-specific-code which would itself defaults to "native". Value "hostcpu" would enable minimally for this $host_cpu (for x86_64 this would be sse2 yes and pclmul no). Value "native" would try to compile and execute. Having calculated the final values for --enable-sse2 and --enable-pclmul, sse2 and pclmul would be enabled based on these values. Configure would error out if the compiler lacks support.

The default directory would be selected based on $host_cpu and whether sse2 and pclmul are enabled. When the directory is forced, insufficient sse2/pclmul might be enabled and configure would error out.



---

archive/issue_comments_189819.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThat's basically upstream choice: use generic when the hardware flag is passed.\nFrom my discussion with Emmanuel, it's basically because they don't care.\nI (and Jeroen?) found it disappointing because the x86_64 spec includes sse2 and quickly and easily came up with our patches which on x86_64 tested if the compiler supports sse2 and if so use the x86_64 folder.\n(Note that this folder uses sse2 instruction, so you cannot use it if the compiler does not support sse2.)",
    "created_at": "2014-06-19T21:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189819",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:63" align="right">comment:63</div>

That's basically upstream choice: use generic when the hardware flag is passed.
From my discussion with Emmanuel, it's basically because they don't care.
I (and Jeroen?) found it disappointing because the x86_64 spec includes sse2 and quickly and easily came up with our patches which on x86_64 tested if the compiler supports sse2 and if so use the x86_64 folder.
(Note that this folder uses sse2 instruction, so you cannot use it if the compiler does not support sse2.)



---

archive/issue_events_217873.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217873"
}
```



---

archive/issue_events_217874.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217874"
}
```



---

archive/issue_comments_189820.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nI'm basically ok with Erik last changes.\n\nI'll just clean up the git branch to current standards and give it positive review.",
    "created_at": "2014-11-12T10:03:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189820",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:65" align="right">comment:65</div>

I'm basically ok with Erik last changes.

I'll just clean up the git branch to current standards and give it positive review.



---

archive/issue_comments_189821.json:
```json
{
    "body": "Changed commit from **[3ca3e7b](https://github.com/sagemath/sagetrac-mirror/commit/3ca3e7b9386475ccefea3f9f9c6c0a29c141190d)** to **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**",
    "created_at": "2014-11-12T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189821",
    "user": "https://github.com/jpflori"
}
```

Changed commit from **[3ca3e7b](https://github.com/sagemath/sagetrac-mirror/commit/3ca3e7b9386475ccefea3f9f9c6c0a29c141190d)** to **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**



---

archive/issue_comments_189822.json:
```json
{
    "body": "<div id=\"comment:66\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ba330eaf20a63d36a6dab5de1667f5a52ad1d63\">9ba330e</a></td><td><code>Merge remote-tracking branch 'trac/develop' into ticket/15316</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e\">969de52</a></td><td><code>Update git branch for gf2x SSE2 and Cygwin fixes.</code></td></tr></table>\n",
    "created_at": "2014-11-12T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189822",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:66"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ba330eaf20a63d36a6dab5de1667f5a52ad1d63">9ba330e</a></td><td><code>Merge remote-tracking branch 'trac/develop' into ticket/15316</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e">969de52</a></td><td><code>Update git branch for gf2x SSE2 and Cygwin fixes.</code></td></tr></table>




---

archive/issue_comments_189823.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Jean-Pierre Flori**",
    "created_at": "2014-11-12T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189823",
    "user": "https://github.com/jpflori"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Jean-Pierre Flori**



---

archive/issue_events_217875.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-11-12T10:15:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217875"
}
```



---

archive/issue_events_217876.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-11-12T10:15:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217876"
}
```



---

archive/issue_comments_189824.json:
```json
{
    "body": "Changed branch from **[u/emassop/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/emassop/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**",
    "created_at": "2014-11-12T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189824",
    "user": "https://github.com/jpflori"
}
```

Changed branch from **[u/emassop/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/emassop/ticket/15316)** to **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)**



---

archive/issue_events_217877.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-11-12T10:16:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217877"
}
```



---

archive/issue_events_217878.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2014-11-12T10:16:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217878"
}
```



---

archive/issue_events_217879.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-14T21:01:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217879"
}
```



---

archive/issue_events_217880.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "39abd9fdc5dcf446ef49674416a308ba7597d8c5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-11-14T21:01:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15316#event-217880"
}
```



---

archive/issue_comments_189825.json:
```json
{
    "body": "Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**",
    "created_at": "2014-11-14T21:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15316",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15316#issuecomment-189825",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jpflori/ticket/15316](https://github.com/sagemath/sagetrac-mirror/tree/u/jpflori/ticket/15316)** to **[969de52](https://github.com/sagemath/sagetrac-mirror/commit/969de52313ee407d874e9f7b318111c144de534e)**
