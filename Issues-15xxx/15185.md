# Issue 15185: Clean up interface to the PARI library

archive/issues_014948.json:
```json
{
    "body": "The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two parts:\n- `gen.pyx` containing the class `gen`;\n- `pari_instance.pyx` containing the class `PariInstance` and some utility functions;\nMore cleaning-up will be done in #15461.\n\n**Keywords:** pari\n\n**Branch:** [u/jdemeyer/ticket/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15185)\n\n**Commit:** [7ec74e0598300f96d1c41604fb288f41db4cc9da](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0598300f96d1c41604fb288f41db4cc9da)\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** Peter Bruin\n\n**Dependencies:** #9640, #10018, #11868\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15185\n\n",
    "closed_at": "2013-12-20T15:50:51Z",
    "created_at": "2013-09-11T14:35:35Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "Clean up interface to the PARI library",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15185",
    "user": "https://github.com/pjbruin"
}
```
The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two parts:
- `gen.pyx` containing the class `gen`;
- `pari_instance.pyx` containing the class `PariInstance` and some utility functions;
More cleaning-up will be done in #15461.

**Keywords:** pari

**Branch:** [u/jdemeyer/ticket/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15185)

**Commit:** [7ec74e0598300f96d1c41604fb288f41db4cc9da](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0598300f96d1c41604fb288f41db4cc9da)

**Reviewer:** Jeroen Demeyer

**Author:** Peter Bruin

**Dependencies:** #9640, #10018, #11868

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/15185





---

archive/issue_comments_244613.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe `t0GEN` stuff is #11868.",
    "created_at": "2013-10-03T10:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244613",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
The `t0GEN` stuff is #11868.



---

archive/issue_comments_244614.json:
```json
{
    "body": "**Branch:** [u/pbruin/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185)",
    "created_at": "2013-11-18T01:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244614",
    "user": "https://github.com/pjbruin"
}
```

**Branch:** [u/pbruin/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185)



---

archive/issue_comments_244615.json:
```json
{
    "body": "**Work_Issues:** wait for #10018",
    "created_at": "2013-11-18T01:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244615",
    "user": "https://github.com/pjbruin"
}
```

**Work_Issues:** wait for #10018



---

archive/issue_comments_244616.json:
```json
{
    "body": "**Changing dependencies** from \"#9640\" to \"#9640 #10018\".",
    "created_at": "2013-11-18T01:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244616",
    "user": "https://github.com/pjbruin"
}
```

**Changing dependencies** from "#9640" to "#9640 #10018".



---

archive/issue_comments_244617.json:
```json
{
    "body": "**Commit:** [2344f0bd14b5f72eb84ad1b134f84a74de25fc2e](https://github.com/sagemath/sagetrac-mirror/commit/2344f0bd14b5f72eb84ad1b134f84a74de25fc2e)",
    "created_at": "2013-11-18T01:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244617",
    "user": "https://github.com/pjbruin"
}
```

**Commit:** [2344f0bd14b5f72eb84ad1b134f84a74de25fc2e](https://github.com/sagemath/sagetrac-mirror/commit/2344f0bd14b5f72eb84ad1b134f84a74de25fc2e)



---

archive/issue_comments_244618.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,9 @@\n-The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into three parts:\n+The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two or three parts:\n - `gen.pyx` containing the class `gen`;\n-- `pari_error.pyx` containing the class `PariError` and other error-handling code;\n-- `pari_instance.pyx` containing the class `PariInstance` and some utility functions.\n-The following things should probably be cut out:\n-- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods should be deleted.\n-- The global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) should be replaced by appropriate local variables.\n-- There is a lot of obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be); this should be deleted.\n-A patch is being worked on; it does not work well with the existing error-handling code and should be rebased on #9640.\n+- `pari_instance.pyx` containing the class `PariInstance` and some utility functions;\n+- (maybe) `pari_error.pyx` containing the class `PariError`.\n+In addition, this ticket makes the following changes:\n+- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.\n+- Replace the global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) by appropriate local variables.\n+- Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).\n \n``````\n",
    "created_at": "2013-11-18T01:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244618",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,9 @@
-The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into three parts:
+The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two or three parts:
 - `gen.pyx` containing the class `gen`;
-- `pari_error.pyx` containing the class `PariError` and other error-handling code;
-- `pari_instance.pyx` containing the class `PariInstance` and some utility functions.
-The following things should probably be cut out:
-- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods should be deleted.
-- The global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) should be replaced by appropriate local variables.
-- There is a lot of obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be); this should be deleted.
-A patch is being worked on; it does not work well with the existing error-handling code and should be rebased on #9640.
+- `pari_instance.pyx` containing the class `PariInstance` and some utility functions;
+- (maybe) `pari_error.pyx` containing the class `PariError`.
+In addition, this ticket makes the following changes:
+- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.
+- Replace the global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) by appropriate local variables.
+- Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).
 
``````




---

archive/issue_comments_244619.json:
```json
{
    "body": "**Author:** Peter Bruin",
    "created_at": "2013-11-18T01:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244619",
    "user": "https://github.com/pjbruin"
}
```

**Author:** Peter Bruin



---

archive/issue_comments_244620.json:
```json
{
    "body": "**Changing dependencies** from \"#9640 #10018\" to \"#9640, #10018\".",
    "created_at": "2013-11-18T01:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244620",
    "user": "https://github.com/pjbruin"
}
```

**Changing dependencies** from "#9640 #10018" to "#9640, #10018".



---

archive/issue_events_050234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-18T07:22:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15185#event-50234"
}
```



---

archive/issue_comments_244621.json:
```json
{
    "body": "<a id='comment:7'></a>\nI think this ticket is a typical \"patchbomb\" which should be avoided. In particular, the replacing of the global variables `t0`... and the re-organizing of the `.py(x)` files are both big changes which should be on different tickets. For the former, I already created #11868 for this.",
    "created_at": "2013-11-23T11:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244621",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I think this ticket is a typical "patchbomb" which should be avoided. In particular, the replacing of the global variables `t0`... and the re-organizing of the `.py(x)` files are both big changes which should be on different tickets. For the former, I already created #11868 for this.



---

archive/issue_comments_244622.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jdemeyer](#comment%3A7):\n> I think this ticket is a typical \"patchbomb\" which should be avoided.\n\nI know.  The problem is that when I started this clean-up operation, it wasn't clear what the end result was going to look like.  I created this ticket -- and the list of separate issues -- only after reaching a state that worked again, and didn't know about #11868.  Cutting it up into separate tickets is easier said than done; it will probably become more manageable by using Git, but it will still take a lot of effort.",
    "created_at": "2013-11-23T20:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244622",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:8'></a>
Replying to [jdemeyer](#comment%3A7):
> I think this ticket is a typical "patchbomb" which should be avoided.

I know.  The problem is that when I started this clean-up operation, it wasn't clear what the end result was going to look like.  I created this ticket -- and the list of separate issues -- only after reaching a state that worked again, and didn't know about #11868.  Cutting it up into separate tickets is easier said than done; it will probably become more manageable by using Git, but it will still take a lot of effort.



---

archive/issue_comments_244623.json:
```json
{
    "body": "**Changing dependencies** from \"#9640, #10018\" to \"#9640, #10018, #11868\".",
    "created_at": "2013-11-24T02:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244623",
    "user": "https://github.com/pjbruin"
}
```

**Changing dependencies** from "#9640, #10018" to "#9640, #10018, #11868".



---

archive/issue_comments_244624.json:
```json
{
    "body": "**Changing work_issues** from \"wait for #10018\" to \"rebase\".",
    "created_at": "2013-11-24T02:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244624",
    "user": "https://github.com/pjbruin"
}
```

**Changing work_issues** from "wait for #10018" to "rebase".



---

archive/issue_comments_244625.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,6 +4,5 @@\n - (maybe) `pari_error.pyx` containing the class `PariError`.\n In addition, this ticket makes the following changes:\n - The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.\n-- Replace the global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) by appropriate local variables.\n - Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).\n \n``````\n",
    "created_at": "2013-11-24T02:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244625",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,6 +4,5 @@
 - (maybe) `pari_error.pyx` containing the class `PariError`.
 In addition, this ticket makes the following changes:
 - The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.
-- Replace the global variables `t0, ..., t5` (used to store results of conversion of Python objects to PARI objects) by appropriate local variables.
 - Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).
 
``````




---

archive/issue_comments_244626.json:
```json
{
    "body": "<a id='comment:9'></a>\nAs a first step I split off the changes eliminating the global GEN variables as a patch on #11868.  This will certainly have to be rebased, but that had to be done anyway because of #10018.",
    "created_at": "2013-11-24T02:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244626",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:9'></a>
As a first step I split off the changes eliminating the global GEN variables as a patch on #11868.  This will certainly have to be rebased, but that had to be done anyway because of #10018.



---

archive/issue_comments_244627.json:
```json
{
    "body": "<a id='comment:10'></a>\nTo ease rebasing and reviewing, I recommend you to make this ticket absolutely minimal (only move stuff, nothing else): everything which can be done on a different ticket, should be done so.",
    "created_at": "2013-11-26T14:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244627",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
To ease rebasing and reviewing, I recommend you to make this ticket absolutely minimal (only move stuff, nothing else): everything which can be done on a different ticket, should be done so.



---

archive/issue_comments_244628.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jdemeyer](#comment%3A10):\n> To ease rebasing and reviewing, I recommend you to make this ticket absolutely minimal (only move stuff, nothing else): everything which can be done on a different ticket, should be done so.\n\nThat is more or less my plan, after #11868 is finished.",
    "created_at": "2013-11-26T14:18:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244628",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:11'></a>
Replying to [jdemeyer](#comment%3A10):
> To ease rebasing and reviewing, I recommend you to make this ticket absolutely minimal (only move stuff, nothing else): everything which can be done on a different ticket, should be done so.

That is more or less my plan, after #11868 is finished.



---

archive/issue_comments_244629.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,4 @@\n - `gen.pyx` containing the class `gen`;\n - `pari_instance.pyx` containing the class `PariInstance` and some utility functions;\n - (maybe) `pari_error.pyx` containing the class `PariError`.\n-In addition, this ticket makes the following changes:\n-- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.\n-- Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).\n-\n+More cleaning-up will be done in #15461.\n``````\n",
    "created_at": "2013-11-27T16:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244629",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,4 @@
 - `gen.pyx` containing the class `gen`;
 - `pari_instance.pyx` containing the class `PariInstance` and some utility functions;
 - (maybe) `pari_error.pyx` containing the class `PariError`.
-In addition, this ticket makes the following changes:
-- The `gen` class currently contains duplicates of various methods of `PariInstance` (such as `new_gen`) for no obvious reason.  These methods will be deleted.
-- Remove obsolete code (e.g. `add_unsafe`, which currently is not used, and probably never should be).
-
+More cleaning-up will be done in #15461.
``````




---

archive/issue_comments_244630.json:
```json
{
    "body": "<a id='comment:13'></a>\nAre we sure we really want to do this? I'm afraid that performance is going to be worse because Cython has an overhead when calling functions in a different module.",
    "created_at": "2013-12-06T21:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244630",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Are we sure we really want to do this? I'm afraid that performance is going to be worse because Cython has an overhead when calling functions in a different module.



---

archive/issue_comments_244631.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A13):\n> Are we sure we really want to do this? I'm afraid that performance is going to be worse because Cython has an overhead when calling functions in a different module.\n\nIs this because the `@cython.final` decorator on an extension type `T` currently does not forbid subtyping `T` in a different Cython module (so that methods can be called directly in the same module, but only via a vtab in a different module)?\n\nIf this is what you mean, could the overhead be avoided by making `new_gen()` and `clear_stack()` (which will be responsible for most of the cross-module calls) functions instead of methods?",
    "created_at": "2013-12-08T16:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244631",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A13):
> Are we sure we really want to do this? I'm afraid that performance is going to be worse because Cython has an overhead when calling functions in a different module.

Is this because the `@cython.final` decorator on an extension type `T` currently does not forbid subtyping `T` in a different Cython module (so that methods can be called directly in the same module, but only via a vtab in a different module)?

If this is what you mean, could the overhead be avoided by making `new_gen()` and `clear_stack()` (which will be responsible for most of the cross-module calls) functions instead of methods?



---

archive/issue_comments_244632.json:
```json
{
    "body": "**Changing branch** from \"[u/pbruin/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185)\" to \"[u/pbruin/15185-split_up_pari_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185-split_up_pari_interface)\".",
    "created_at": "2013-12-11T01:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244632",
    "user": "https://github.com/pjbruin"
}
```

**Changing branch** from "[u/pbruin/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185)" to "[u/pbruin/15185-split_up_pari_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185-split_up_pari_interface)".



---

archive/issue_comments_244633.json:
```json
{
    "body": "**Changing work_issues** from \"rebase\" to \"\".",
    "created_at": "2013-12-11T01:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244633",
    "user": "https://github.com/pjbruin"
}
```

**Changing work_issues** from "rebase" to "".



---

archive/issue_comments_244634.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-12-11T01:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244634",
    "user": "https://github.com/pjbruin"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_244635.json:
```json
{
    "body": "**Changing commit** from \"[2344f0bd14b5f72eb84ad1b134f84a74de25fc2e](https://github.com/sagemath/sagetrac-mirror/commit/2344f0bd14b5f72eb84ad1b134f84a74de25fc2e)\" to \"[11a3bfbda21bde9c0d0778442cdd3607db14e583](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfbda21bde9c0d0778442cdd3607db14e583)\".",
    "created_at": "2013-12-11T01:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244635",
    "user": "https://github.com/pjbruin"
}
```

**Changing commit** from "[2344f0bd14b5f72eb84ad1b134f84a74de25fc2e](https://github.com/sagemath/sagetrac-mirror/commit/2344f0bd14b5f72eb84ad1b134f84a74de25fc2e)" to "[11a3bfbda21bde9c0d0778442cdd3607db14e583](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfbda21bde9c0d0778442cdd3607db14e583)".



---

archive/issue_comments_244636.json:
```json
{
    "body": "<a id='comment:16'></a>\nHere is a new branch which moves `PariInstance` to a separate file and otherwise is close to minimal.\n\nIt is true that the Cython-generated code has some overhead in for the cross-module method calls.  I think it is very small, but I will try to do some timings.  Depending on the outcome, it might be reasonable to duplicate a small amount of code to avoid these cross-module calls.  I think it is better to do that as part of #15461, though.\n\n---\nNew commits:\n|                                                                                                         |                                                |\n|---------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[11a3bfb](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfb)|more fixes related to relocation of PariInstance|\n|[34013cc](https://github.com/sagemath/sagetrac-mirror/commit/34013cc)|fixes in sage.libs.pari|\n|[db8cd7e](https://github.com/sagemath/sagetrac-mirror/commit/db8cd7e)|top-level changes related to PariInstance|\n|[fcf7972](https://github.com/sagemath/sagetrac-mirror/commit/fcf7972)|adapt miscellaneous files in the Sage library|\n|[5091563](https://github.com/sagemath/sagetrac-mirror/commit/5091563)|fix imports in gen_py.py|\n|[478dd90](https://github.com/sagemath/sagetrac-mirror/commit/478dd90)|move code from gen.pyx to pari_instance.pyx|\n|[08a278f](https://github.com/sagemath/sagetrac-mirror/commit/08a278f)|create pari_instance.pyx; move some documentation and examples there|\n|[561e39f](https://github.com/sagemath/sagetrac-mirror/commit/561e39f)|create pari_instance.pxd|",
    "created_at": "2013-12-11T01:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244636",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:16'></a>
Here is a new branch which moves `PariInstance` to a separate file and otherwise is close to minimal.

It is true that the Cython-generated code has some overhead in for the cross-module method calls.  I think it is very small, but I will try to do some timings.  Depending on the outcome, it might be reasonable to duplicate a small amount of code to avoid these cross-module calls.  I think it is better to do that as part of #15461, though.

---
New commits:
|                                                                                                         |                                                |
|---------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[11a3bfb](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfb)|more fixes related to relocation of PariInstance|
|[34013cc](https://github.com/sagemath/sagetrac-mirror/commit/34013cc)|fixes in sage.libs.pari|
|[db8cd7e](https://github.com/sagemath/sagetrac-mirror/commit/db8cd7e)|top-level changes related to PariInstance|
|[fcf7972](https://github.com/sagemath/sagetrac-mirror/commit/fcf7972)|adapt miscellaneous files in the Sage library|
|[5091563](https://github.com/sagemath/sagetrac-mirror/commit/5091563)|fix imports in gen_py.py|
|[478dd90](https://github.com/sagemath/sagetrac-mirror/commit/478dd90)|move code from gen.pyx to pari_instance.pyx|
|[08a278f](https://github.com/sagemath/sagetrac-mirror/commit/08a278f)|create pari_instance.pyx; move some documentation and examples there|
|[561e39f](https://github.com/sagemath/sagetrac-mirror/commit/561e39f)|create pari_instance.pxd|



---

archive/issue_comments_244637.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,4 @@\n-The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two or three parts:\n+The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two parts:\n - `gen.pyx` containing the class `gen`;\n - `pari_instance.pyx` containing the class `PariInstance` and some utility functions;\n-- (maybe) `pari_error.pyx` containing the class `PariError`.\n More cleaning-up will be done in #15461.\n``````\n",
    "created_at": "2013-12-11T01:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244637",
    "user": "https://github.com/pjbruin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,4 @@
-The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two or three parts:
+The file `sage/libs/pari/gen.pyx` is too big and contains too many different things.  For clarity and maintainability, it should be split into two parts:
 - `gen.pyx` containing the class `gen`;
 - `pari_instance.pyx` containing the class `PariInstance` and some utility functions;
-- (maybe) `pari_error.pyx` containing the class `PariError`.
 More cleaning-up will be done in #15461.
``````




---

archive/issue_comments_244638.json:
```json
{
    "body": "**Changing commit** from \"[11a3bfbda21bde9c0d0778442cdd3607db14e583](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfbda21bde9c0d0778442cdd3607db14e583)\" to \"[95a622a9843d9f99f7fa8009babb86ac27e2b32b](https://github.com/sagemath/sagetrac-mirror/commit/95a622a9843d9f99f7fa8009babb86ac27e2b32b)\".",
    "created_at": "2013-12-11T02:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244638",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[11a3bfbda21bde9c0d0778442cdd3607db14e583](https://github.com/sagemath/sagetrac-mirror/commit/11a3bfbda21bde9c0d0778442cdd3607db14e583)" to "[95a622a9843d9f99f7fa8009babb86ac27e2b32b](https://github.com/sagemath/sagetrac-mirror/commit/95a622a9843d9f99f7fa8009babb86ac27e2b32b)".



---

archive/issue_comments_244639.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** New commits:\n|                                                                                                         |                              |\n|---------------------------------------------------------------------------------------------------------|------------------------------|\n|[95a622a](https://github.com/sagemath/sagetrac-mirror/commit/95a622a)|better fix for real_double.pyx|",
    "created_at": "2013-12-11T02:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** New commits:
|                                                                                                         |                              |
|---------------------------------------------------------------------------------------------------------|------------------------------|
|[95a622a](https://github.com/sagemath/sagetrac-mirror/commit/95a622a)|better fix for real_double.pyx|



---

archive/issue_comments_244640.json:
```json
{
    "body": "**Changing branch** from \"[u/pbruin/15185-split_up_pari_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185-split_up_pari_interface)\" to \"[u/jdemeyer/ticket/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15185)\".",
    "created_at": "2013-12-16T11:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244640",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/pbruin/15185-split_up_pari_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15185-split_up_pari_interface)" to "[u/jdemeyer/ticket/15185](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15185)".



---

archive/issue_comments_244641.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2013-12-16T11:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244641",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_244642.json:
```json
{
    "body": "**Changing commit** from \"[95a622a9843d9f99f7fa8009babb86ac27e2b32b](https://github.com/sagemath/sagetrac-mirror/commit/95a622a9843d9f99f7fa8009babb86ac27e2b32b)\" to \"[7ec74e0598300f96d1c41604fb288f41db4cc9da](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0598300f96d1c41604fb288f41db4cc9da)\".",
    "created_at": "2013-12-16T11:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244642",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[95a622a9843d9f99f7fa8009babb86ac27e2b32b](https://github.com/sagemath/sagetrac-mirror/commit/95a622a9843d9f99f7fa8009babb86ac27e2b32b)" to "[7ec74e0598300f96d1c41604fb288f41db4cc9da](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0598300f96d1c41604fb288f41db4cc9da)".



---

archive/issue_comments_244643.json:
```json
{
    "body": "<a id='comment:19'></a>\nAdditional commit needs review. Apart from this, everything looks fine.\n\n---\nNew commits:\n|                                                                                                         |                            |\n|---------------------------------------------------------------------------------------------------------|----------------------------|\n|[7ec74e0](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0)|PARI cleanup: reviewer patch|",
    "created_at": "2013-12-16T11:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244643",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Additional commit needs review. Apart from this, everything looks fine.

---
New commits:
|                                                                                                         |                            |
|---------------------------------------------------------------------------------------------------------|----------------------------|
|[7ec74e0](https://github.com/sagemath/sagetrac-mirror/commit/7ec74e0)|PARI cleanup: reviewer patch|



---

archive/issue_comments_244644.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-12-16T13:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244644",
    "user": "https://github.com/pjbruin"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_244645.json:
```json
{
    "body": "<a id='comment:20'></a>\nI wasn't sure whether `allocatemem()` should already be removed from the global namespace (it was only deprecated recently), and whether `from sage.libs.pari.all import ...` is better than specifying the precise module, but I'm definitely OK with these changes.",
    "created_at": "2013-12-16T13:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244645",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:20'></a>
I wasn't sure whether `allocatemem()` should already be removed from the global namespace (it was only deprecated recently), and whether `from sage.libs.pari.all import ...` is better than specifying the precise module, but I'm definitely OK with these changes.



---

archive/issue_events_050235.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15185#event-50235"
}
```



---

archive/issue_events_050236.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15185#event-50236"
}
```



---

archive/issue_comments_244646.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-12-20T15:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15185#issuecomment-244646",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_050237.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-20T15:50:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15185",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15185#event-50237"
}
```
