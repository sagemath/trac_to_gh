# Issue 15942: fix md5 in sage-spkg

archive/issues_015705.json:
```json
{
    "assignees": [],
    "body": "\n```\nactual=`md5 $file | sed 's/[^0-9a-f].*//'`\n```\nmakes no sense, because that's not what's returned (at least on Macs).\n\n```\nmd5 -q\n```\nactually does work, though I don't know how portable this is.\n\nBranch/Commit: **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**\n\nReviewer: **Karl-Dieter Crisman**\n\nAuthor: **Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15942_\n\n",
    "closed_at": "2014-03-31T15:01:13Z",
    "created_at": "2014-03-14T16:28:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix md5 in sage-spkg",
    "type": "issue",
    "updated_at": "2014-03-31T15:01:13Z",
    "url": "https://github.com/sagemath/sage/issues/15942",
    "user": "https://github.com/kcrisman"
}
```

```
actual=`md5 $file | sed 's/[^0-9a-f].*//'`
```
makes no sense, because that's not what's returned (at least on Macs).

```
md5 -q
```
actually does work, though I don't know how portable this is.

Branch/Commit: **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**

Reviewer: **Karl-Dieter Crisman**

Author: **Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/15942_





---

archive/issue_events_210026.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-14T16:28:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210026"
}
```



---

archive/issue_events_210027.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-14T16:28:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210027"
}
```



---

archive/issue_events_210028.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-14T16:28:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210028"
}
```



---

archive/issue_events_210029.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-14T16:28:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210029"
}
```



---

archive/issue_events_210030.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-17T17:36:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210030"
}
```



---

archive/issue_events_210031.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-17T17:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210031"
}
```



---

archive/issue_comments_204577.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nI'm putting this as blocker, since any system with only md5 and not the other options for checksums simply will refuse to build, and presumably some systems are that barebones.  (Not just old ones?)",
    "created_at": "2014-03-17T17:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204577",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'>Comment 1:</a>
I'm putting this as blocker, since any system with only md5 and not the other options for checksums simply will refuse to build, and presumably some systems are that barebones.  (Not just old ones?)



---

archive/issue_comments_204578.json:
```json
{
    "body": "Branch: **[u/vbraun/md5_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/md5_fix)**",
    "created_at": "2014-03-17T21:33:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204578",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/md5_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/md5_fix)**



---

archive/issue_comments_204579.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f\">be51873</a></td><td><code>use md5 -q if necessary</code></td></tr></table>\n",
    "created_at": "2014-03-17T21:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204579",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f">be51873</a></td><td><code>use md5 -q if necessary</code></td></tr></table>




---

archive/issue_events_210032.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-17T21:40:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210032"
}
```



---

archive/issue_comments_204580.json:
```json
{
    "body": "Commit: **[be51873](https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f)**",
    "created_at": "2014-03-17T21:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204580",
    "user": "https://github.com/vbraun"
}
```

Commit: **[be51873](https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f)**



---

archive/issue_comments_204581.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2014-03-17T21:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204581",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_204582.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI can't guarantee this will work on other systems with possibly different `md5` implementation, but at any rate the sed doesn't mess things up, as makes sense.  For reference, with `-q`, `md5` on Mac outputs\n\n```\n$ md5 Downloads/974230_10103787412222420_571824162_n.jpg\nMD5 (Downloads/974230_10103787412222420_571824162_n.jpg) = bf36ca4308ce426d74d095681ebd5a18\nmd5 -q Downloads/974230_10103787412222420_571824162_n.jpg  | sed 's/[^0-9a-f].*//'\nbf36ca4308ce426d74d095681ebd5a18\n```\nSo fine with me, but maybe someone else should be asked as well who knows about such things?",
    "created_at": "2014-03-18T01:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204582",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'>Comment 4:</a>
I can't guarantee this will work on other systems with possibly different `md5` implementation, but at any rate the sed doesn't mess things up, as makes sense.  For reference, with `-q`, `md5` on Mac outputs

```
$ md5 Downloads/974230_10103787412222420_571824162_n.jpg
MD5 (Downloads/974230_10103787412222420_571824162_n.jpg) = bf36ca4308ce426d74d095681ebd5a18
md5 -q Downloads/974230_10103787412222420_571824162_n.jpg  | sed 's/[^0-9a-f].*//'
bf36ca4308ce426d74d095681ebd5a18
```
So fine with me, but maybe someone else should be asked as well who knows about such things?



---

archive/issue_comments_204583.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\n`md5` is not posix so whats your question? IMHO we can only try it out and see if its better. The real solution is to not try a handful different non-posix utilities. Instead use Python and the standard md5 Python module.",
    "created_at": "2014-03-18T17:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204583",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'>Comment 5:</a>
`md5` is not posix so whats your question? IMHO we can only try it out and see if its better. The real solution is to not try a handful different non-posix utilities. Instead use Python and the standard md5 Python module.



---

archive/issue_comments_204584.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nWhy do we use different invocations of `md5` in `sage-spkg` vs. `sage-fix-pkg-checksums`? We could instead change `sage-spkg` to use\n\n```\nactual=`md5 $file | sed 's/.*= *//'`\n```\nThis works for me after I disable `shasum` and `md5sum` on my Mac. (I suppose I have the same questions about invoking `shasum` and `md5sum` in the two scripts, but since `md5` is the one causing the problems, that's obviously the most relevant.)",
    "created_at": "2014-03-18T18:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204584",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>Comment 6:</a>
Why do we use different invocations of `md5` in `sage-spkg` vs. `sage-fix-pkg-checksums`? We could instead change `sage-spkg` to use

```
actual=`md5 $file | sed 's/.*= *//'`
```
This works for me after I disable `shasum` and `md5sum` on my Mac. (I suppose I have the same questions about invoking `shasum` and `md5sum` in the two scripts, but since `md5` is the one causing the problems, that's obviously the most relevant.)



---

archive/issue_comments_204585.json:
```json
{
    "body": "Changed commit from **[be51873](https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f)** to **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**",
    "created_at": "2014-03-18T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204585",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[be51873](https://github.com/sagemath/sagetrac-mirror/commit/be51873e974c88db4ec67a13fcb6206e8b00fd1f)** to **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**



---

archive/issue_comments_204586.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098\">1b3fcd9</a></td><td><code>alternate fix</code></td></tr></table>\n",
    "created_at": "2014-03-18T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204586",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098">1b3fcd9</a></td><td><code>alternate fix</code></td></tr></table>




---

archive/issue_comments_204587.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nI don't really care, we should just pick one bandaid until we replace the whole cruft with a python script",
    "created_at": "2014-03-18T18:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204587",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'>Comment 8:</a>
I don't really care, we should just pick one bandaid until we replace the whole cruft with a python script



---

archive/issue_comments_204588.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nI can't test this \"live\" right now but it looks like a right syntax as well to solve the problem.",
    "created_at": "2014-03-18T20:58:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204588",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'>Comment 9:</a>
I can't test this "live" right now but it looks like a right syntax as well to solve the problem.



---

archive/issue_comments_204589.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2014-03-25T20:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204589",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_comments_204590.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nTesting \"live\" ... works, as expected.  I like the alternate fix better, so let's go with that.",
    "created_at": "2014-03-25T20:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204590",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'>Comment 10:</a>
Testing "live" ... works, as expected.  I like the alternate fix better, so let's go with that.



---

archive/issue_events_210033.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-25T20:42:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210033"
}
```



---

archive/issue_events_210034.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-03-25T20:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210034"
}
```



---

archive/issue_events_210035.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-31T15:01:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210035"
}
```



---

archive/issue_events_210036.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e046d7a7c126d3f8ae77121d8532375192a30512",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-03-31T15:01:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15942#event-210036"
}
```



---

archive/issue_comments_204591.json:
```json
{
    "body": "Changed branch from **[u/vbraun/md5_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/md5_fix)** to **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**",
    "created_at": "2014-03-31T15:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15942",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15942#issuecomment-204591",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/md5_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/md5_fix)** to **[1b3fcd9](https://github.com/sagemath/sagetrac-mirror/commit/1b3fcd99e918261de3d0d59e030429c32906d098)**
