# Issue 15258: Flip graph of pure simplicial complex

archive/issues_015258.json:
```json
{
    "body": "CC:  @fchapoton\n\nKeywords: simplicial complex\n\nFor a pure simplicial complex (i.e., a simplicial complex with all maximal faces (facets) having the same dimension), one can compute the flip graph. This is the undirected graph with vertices being the facets, where two facets are jointed by an edge if they meet in a codimension 1 face.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15495\n\n",
    "closed_at": "2014-02-02T22:07:06Z",
    "created_at": "2013-12-09T08:54:03Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Flip graph of pure simplicial complex",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15258",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```
CC:  @fchapoton

Keywords: simplicial complex

For a pure simplicial complex (i.e., a simplicial complex with all maximal faces (facets) having the same dimension), one can compute the flip graph. This is the undirected graph with vertices being the facets, where two facets are jointed by an edge if they meet in a codimension 1 face.

Issue created by migration from https://trac.sagemath.org/ticket/15495





---

archive/issue_comments_195938.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-12-09T09:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195938",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_195939.json:
```json
{
    "body": "I set this to \"needs review\" -- I mainly did this to test how I can make create a new ticket and implement a new feature with git. Anyway, there is still quite some code duplication between `flip_graph` and `is_pseudomanifold`, so it might be better to first make this nicer before finalizing this ticket.\n\n---\nNew commits:",
    "created_at": "2013-12-09T09:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195939",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

I set this to "needs review" -- I mainly did this to test how I can make create a new ticket and implement a new feature with git. Anyway, there is still quite some code duplication between `flip_graph` and `is_pseudomanifold`, so it might be better to first make this nicer before finalizing this ticket.

---
New commits:



---

archive/issue_comments_195940.json:
```json
{
    "body": "Yop !\n\nI don't know much about simplicial complices, yet I think it would be terribly faster if you created this graph in two steps :\n1) Create a dictionary associating to each d-1 face the list of all facets that contain it\n2) For each facet, create an edge between any two of the faces that contain it\n\nIn order to build 1), it would be cool if there was a quick way to list the d-1 faces contained in a d-face. If there isn't just creating the dictionary :\n`{dm1_face : [f for f in self.faces() if dm1_face.is_face(f)] for dm1_face in self.n_faces(d-1)}`\n\nAlready makes you earn an order of magnitude.\n\nBesides, if `.faces()` can contain a lot of faces of order `<d-1`, it would probably be better to filter them out first, as you test face containment VERY often.\n\nNathann",
    "created_at": "2013-12-24T15:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195940",
    "user": "https://github.com/nathanncohen"
}
```

Yop !

I don't know much about simplicial complices, yet I think it would be terribly faster if you created this graph in two steps :
1) Create a dictionary associating to each d-1 face the list of all facets that contain it
2) For each facet, create an edge between any two of the faces that contain it

In order to build 1), it would be cool if there was a quick way to list the d-1 faces contained in a d-face. If there isn't just creating the dictionary :
`{dm1_face : [f for f in self.faces() if dm1_face.is_face(f)] for dm1_face in self.n_faces(d-1)}`

Already makes you earn an order of magnitude.

Besides, if `.faces()` can contain a lot of faces of order `<d-1`, it would probably be better to filter them out first, as you test face containment VERY often.

Nathann



---

archive/issue_comments_195941.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-12-24T15:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195941",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_195942.json:
```json
{
    "body": "Thanks for checking this ticket!\n\nI am either not sure if you are talking about the right behaviour, or if we are actually looking at the same code?\n\nYour 1) and 2) do not create the graph of flips, since by 2) the vertices are codim 1 faces, while the graph of flips has facets as vertices. Also, our comment on the `.faces()` also doesn't make sense. (Or I am misunderstanding sth. completely.)\n\n`is_face` only checks containment as sets. `faces` is never called in what I wrote. What I do is: I compute all facets (maximal faces) and all codim 1 faces. Every codim 1 face represents a maximal clique in the flip graph (namely of those facets containing this codim 1 face). So I run through all those codim 1 faces, and check which facets are contained in this clique.\n\nCould you clarify the situation, so we discuss it again? Thx, Christian",
    "created_at": "2013-12-24T20:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195942",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Thanks for checking this ticket!

I am either not sure if you are talking about the right behaviour, or if we are actually looking at the same code?

Your 1) and 2) do not create the graph of flips, since by 2) the vertices are codim 1 faces, while the graph of flips has facets as vertices. Also, our comment on the `.faces()` also doesn't make sense. (Or I am misunderstanding sth. completely.)

`is_face` only checks containment as sets. `faces` is never called in what I wrote. What I do is: I compute all facets (maximal faces) and all codim 1 faces. Every codim 1 face represents a maximal clique in the flip graph (namely of those facets containing this codim 1 face). So I run through all those codim 1 faces, and check which facets are contained in this clique.

Could you clarify the situation, so we discuss it again? Thx, Christian



---

archive/issue_comments_195943.json:
```json
{
    "body": "Arggg... Not only had I misread your code, but besides I had used the wrong words in my message. I mixed \"face\" with \"facet\", and I guess it makes a difference `:-P`\n\nOkay, let's try again : all I know about simplicial complices is that they are down-closed hypergraphs. And if I make no mistake you want to build a graph whose vertices are facets (and I do not know what that is, except that they are sets of your hypergraph), two of them being adjacent when their corresponding sets (i.e. facets) intersect on d-1 elements. Is that right ?\n\nIf it is true, then I think the best you could do is the following\n\n1) build the list, for every facet, of all its d-1 subsets (which should be -- I hope -- d-1 faces)\n\n2) Update with this information a dictionary associating to each d-1 face the list of facets that contain it\n\n3) For every d-1 set in your dictionary, add an edge between any two of the facets contained in its associated list.\n\nIs that more correct ? `O_o`\n\nNathann",
    "created_at": "2013-12-24T21:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195943",
    "user": "https://github.com/nathanncohen"
}
```

Arggg... Not only had I misread your code, but besides I had used the wrong words in my message. I mixed "face" with "facet", and I guess it makes a difference `:-P`

Okay, let's try again : all I know about simplicial complices is that they are down-closed hypergraphs. And if I make no mistake you want to build a graph whose vertices are facets (and I do not know what that is, except that they are sets of your hypergraph), two of them being adjacent when their corresponding sets (i.e. facets) intersect on d-1 elements. Is that right ?

If it is true, then I think the best you could do is the following

1) build the list, for every facet, of all its d-1 subsets (which should be -- I hope -- d-1 faces)

2) Update with this information a dictionary associating to each d-1 face the list of facets that contain it

3) For every d-1 set in your dictionary, add an edge between any two of the facets contained in its associated list.

Is that more correct ? `O_o`

Nathann



---

archive/issue_comments_195944.json:
```json
{
    "body": "Oh, and it is probably better to not have \"face\" objects (which seems to be \"simplices\" for Sage) but just sets of vertices. Removing the layer of abstraction can only make it faster `:-P`\n\nNathann",
    "created_at": "2013-12-24T21:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195944",
    "user": "https://github.com/nathanncohen"
}
```

Oh, and it is probably better to not have "face" objects (which seems to be "simplices" for Sage) but just sets of vertices. Removing the layer of abstraction can only make it faster `:-P`

Nathann



---

archive/issue_comments_195945.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-12-25T08:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_195946.json:
```json
{
    "body": "Well, then... `:-)`\n\nNathann",
    "created_at": "2013-12-25T09:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195946",
    "user": "https://github.com/nathanncohen"
}
```

Well, then... `:-)`

Nathann



---

archive/issue_comments_195947.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2013-12-25T09:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195947",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_events_045243.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15258#event-45243"
}
```



---

archive/issue_events_045244.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-02T22:07:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15258#event-45244"
}
```



---

archive/issue_comments_195948.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-02T22:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15258",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15258#issuecomment-195948",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
