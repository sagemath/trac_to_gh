# Issue 15313: is_linear_extension on posets is rather liberal

archive/issues_015076.json:
```json
{
    "body": "\n```\nsage: P = Poset((divisors(12), attrcall(\"divides\")), facade=True, linear_extension=True)\nsage: list(P)\n[1, 2, 3, 4, 6, 12]\nsage: P.is_linear_extension([1,2,4,3,6,12,1337])\nTrue\nsage: P.is_linear_extension([1,2,4,3,6,666,12,1337])\nTrue\n```\n\nAt the moment I am not planning to do anything about it, since it would probably involving seeing what other parts of the code using `is_linear_extension` and how they are using (my bets that this error doesn't cause any other problems in the code, and fixing it would likely incur some speed penalty so one should keep the old functionality accessible).\n\nCC:  @nathanncohen sage-combinat\n\nKeywords: posets, combinat\n\nBranch: [u/ncohen/15313](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/15313)\n\nAuthor: Nathann Cohen\n\nCommit: b71faad7ac78cbb883f3d5ee7e7dca7a25c45ad8\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15313\n\n",
    "closed_at": "2013-12-17T22:12:08Z",
    "created_at": "2013-10-21T00:50:25Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "is_linear_extension on posets is rather liberal",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15313",
    "user": "https://github.com/darijgr"
}
```

```
sage: P = Poset((divisors(12), attrcall("divides")), facade=True, linear_extension=True)
sage: list(P)
[1, 2, 3, 4, 6, 12]
sage: P.is_linear_extension([1,2,4,3,6,12,1337])
True
sage: P.is_linear_extension([1,2,4,3,6,666,12,1337])
True
```

At the moment I am not planning to do anything about it, since it would probably involving seeing what other parts of the code using `is_linear_extension` and how they are using (my bets that this error doesn't cause any other problems in the code, and fixing it would likely incur some speed penalty so one should keep the old functionality accessible).

CC:  @nathanncohen sage-combinat

Keywords: posets, combinat

Branch: [u/ncohen/15313](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/15313)

Author: Nathann Cohen

Commit: b71faad7ac78cbb883f3d5ee7e7dca7a25c45ad8

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15313





---

archive/issue_comments_247837.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-21T13:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247837",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_247838.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ncohen/15313\"",
    "created_at": "2013-10-21T13:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247838",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "" to "u/ncohen/15313"



---

archive/issue_comments_247839.json:
```json
{
    "body": "Changing author from \"\" to \"Nathann Cohen\"",
    "created_at": "2013-10-21T13:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247839",
    "user": "https://github.com/nathanncohen"
}
```

Changing author from "" to "Nathann Cohen"



---

archive/issue_comments_247840.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think that's enough... And not too bad from the complexity point of view `:-)`\n\nNathann",
    "created_at": "2013-10-21T13:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247840",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>
I think that's enough... And not too bad from the complexity point of view `:-)`

Nathann



---

archive/issue_comments_247841.json:
```json
{
    "body": "Changing commit from \"\" to \"9e4cef1925c5294c33601227bf65a6486b03b50d\"",
    "created_at": "2013-10-21T13:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247841",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "9e4cef1925c5294c33601227bf65a6486b03b50d"



---

archive/issue_comments_247842.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|       |                                               |\n|-------|-----------------------------------------------|\n|9e4cef1|is_linear_extension on posets is rather liberal|",
    "created_at": "2013-10-21T13:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247842",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|       |                                               |
|-------|-----------------------------------------------|
|9e4cef1|is_linear_extension on posets is rather liberal|



---

archive/issue_comments_247843.json:
```json
{
    "body": "<a id='comment:3'></a>\nGood fix, but sage/combinat/posets/linear_extension.py still is trying to work around this bug:\n\n```\n    def __contains__(self, obj):\n        \"\"\"\n        Membership testing\n\n        EXAMPLES::\n\n            sage: P = Poset((divisors(12), attrcall(\"divides\")), facade=True, linear_extension=True)\n            sage: P.list()\n            [1, 2, 3, 4, 6, 12]\n            sage: L = P.linear_extensions()\n            sage: L([1, 2, 4, 3, 6, 12]) in L\n            True\n            sage: [1, 2, 4, 3, 6, 12] in L\n            False\n\n            sage: L = P.linear_extensions(facade=True)\n            sage: [1, 2, 4, 3, 6, 12] in L\n            True\n            sage: [1, 3, 2, 6, 4, 12] in L\n            True\n            sage: [1, 3, 6, 2, 4, 12] in L\n            False\n\n            sage: [p for p in Permutations(list(P)) if list(p) in L]\n            [[1, 2, 3, 4, 6, 12], [1, 2, 3, 6, 4, 12], [1, 2, 4, 3, 6, 12], [1, 3, 2, 4, 6, 12], [1, 3, 2, 6, 4, 12]]\n\n        \"\"\"\n        if not self._is_facade:\n            return super(LinearExtensionsOfPoset, self).__contains__(obj)\n        return \\\n            isinstance(obj, (list, tuple)) and \\\n            len(obj) == len(self.poset())  and \\\n            set(obj) == set(self.poset())  and \\\n            self.poset().is_linear_extension(obj)\n```\n\nThis could be now optimized.",
    "created_at": "2013-10-21T15:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247843",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:3'></a>
Good fix, but sage/combinat/posets/linear_extension.py still is trying to work around this bug:

```
    def __contains__(self, obj):
        """
        Membership testing

        EXAMPLES::

            sage: P = Poset((divisors(12), attrcall("divides")), facade=True, linear_extension=True)
            sage: P.list()
            [1, 2, 3, 4, 6, 12]
            sage: L = P.linear_extensions()
            sage: L([1, 2, 4, 3, 6, 12]) in L
            True
            sage: [1, 2, 4, 3, 6, 12] in L
            False

            sage: L = P.linear_extensions(facade=True)
            sage: [1, 2, 4, 3, 6, 12] in L
            True
            sage: [1, 3, 2, 6, 4, 12] in L
            True
            sage: [1, 3, 6, 2, 4, 12] in L
            False

            sage: [p for p in Permutations(list(P)) if list(p) in L]
            [[1, 2, 3, 4, 6, 12], [1, 2, 3, 6, 4, 12], [1, 2, 4, 3, 6, 12], [1, 3, 2, 4, 6, 12], [1, 3, 2, 6, 4, 12]]

        """
        if not self._is_facade:
            return super(LinearExtensionsOfPoset, self).__contains__(obj)
        return \
            isinstance(obj, (list, tuple)) and \
            len(obj) == len(self.poset())  and \
            set(obj) == set(self.poset())  and \
            self.poset().is_linear_extension(obj)
```

This could be now optimized.



---

archive/issue_comments_247844.json:
```json
{
    "body": "<a id='comment:4'></a>\nLove those guys who fix a bug somewhere knowing the other function stays wrong....\n\nNathann",
    "created_at": "2013-10-21T16:43:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247844",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Love those guys who fix a bug somewhere knowing the other function stays wrong....

Nathann



---

archive/issue_comments_247845.json:
```json
{
    "body": "Changing commit from \"9e4cef1925c5294c33601227bf65a6486b03b50d\" to \"b71faad7ac78cbb883f3d5ee7e7dca7a25c45ad8\"",
    "created_at": "2013-10-21T16:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247845",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9e4cef1925c5294c33601227bf65a6486b03b50d" to "b71faad7ac78cbb883f3d5ee7e7dca7a25c45ad8"



---

archive/issue_comments_247846.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|       |                                                                               |\n|-------|-------------------------------------------------------------------------------|\n|b71faad|is_linear_extension on posets is rather liberal : updating linear_extensions.py|",
    "created_at": "2013-10-21T16:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247846",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|       |                                                                               |
|-------|-------------------------------------------------------------------------------|
|b71faad|is_linear_extension on posets is rather liberal : updating linear_extensions.py|



---

archive/issue_comments_247847.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-21T16:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247847",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_247848.json:
```json
{
    "body": "<a id='comment:6'></a>\nSupposing that you have run the doctests, setting this to positive review. Thanks for fixing!",
    "created_at": "2013-10-21T16:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247848",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:6'></a>
Supposing that you have run the doctests, setting this to positive review. Thanks for fixing!



---

archive/issue_events_050816.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-22T15:01:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15313#event-50816"
}
```



---

archive/issue_events_050817.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:42:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15313#event-50817"
}
```



---

archive/issue_events_050818.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:42:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15313#event-50818"
}
```



---

archive/issue_comments_247849.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-17T22:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15313#issuecomment-247849",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_050819.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-17T22:12:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15313",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15313#event-50819"
}
```
