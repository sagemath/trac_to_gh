# Issue 15990: Product construction of Transversal Designs

archive/issues_015990.json:
```json
{
    "body": "CC:  @videlec @KPanComputes @dimpase\n\nThis branch implements a product construction of transversal designs. This allows to build new transversal designs that are needed for the general construction of bibd with k=5.\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/16227\n\n",
    "closed_at": "2014-05-07T08:31:11Z",
    "created_at": "2014-04-24T13:42:28Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Product construction of Transversal Designs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15990",
    "user": "https://github.com/nathanncohen"
}
```
CC:  @videlec @KPanComputes @dimpase

This branch implements a product construction of transversal designs. This allows to build new transversal designs that are needed for the general construction of bibd with k=5.

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/16227





---

archive/issue_comments_207276.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-24T13:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207276",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207277.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-04-24T13:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207277",
    "user": "https://github.com/nathanncohen"
}
```

New commits:



---

archive/issue_comments_207278.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-04-24T14:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207278",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_207279.json:
```json
{
    "body": "Hi,\n\nOnce you have fix the merge with #15310, here are other problems\n- the product is sometimes called the Kronecker product and it should be mentioned in the doc.\n- I do not like the way it works: `wilson_construction` and `TD_product` have the same purpose, build more examples of TD. But first of all, the naming scheme are different. Why not TD_wilson_construction? More importantly, in Wilson construction, you do not have to feed the function with the TD(k,m), TD(k,m+1), TD(k+1,t) and TD(k,u) but for the product you have to. From what you started with in Wilson construction, I thought we would have a function `def product(k, n1, n2):`.\n\nIt might be easier to do the whole review in #15310. I propose to merge the two tickets and set this one as won't fix.",
    "created_at": "2014-05-01T11:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207279",
    "user": "https://github.com/videlec"
}
```

Hi,

Once you have fix the merge with #15310, here are other problems
- the product is sometimes called the Kronecker product and it should be mentioned in the doc.
- I do not like the way it works: `wilson_construction` and `TD_product` have the same purpose, build more examples of TD. But first of all, the naming scheme are different. Why not TD_wilson_construction? More importantly, in Wilson construction, you do not have to feed the function with the TD(k,m), TD(k,m+1), TD(k+1,t) and TD(k,u) but for the product you have to. From what you started with in Wilson construction, I thought we would have a function `def product(k, n1, n2):`.

It might be easier to do the whole review in #15310. I propose to merge the two tickets and set this one as won't fix.



---

archive/issue_comments_207280.json:
```json
{
    "body": "1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.\n\n2) Is there any link between this product construction and the one for mols?\n\n3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.",
    "created_at": "2014-05-01T14:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207280",
    "user": "https://github.com/videlec"
}
```

1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.

2) Is there any link between this product construction and the one for mols?

3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.



---

archive/issue_comments_207281.json:
```json
{
    "body": "Yo !\n\n> 1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.\n\n\nWhat is the point of having a function `TD_product` which only takes integer as input ? What can it do that `designs.transversal_design(...)` does not already do ?\n\nWhat we could do is implement a second function TD_product_from_parameters which calls the other ?\n\n> 3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.\n\n\nWhyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy ?\n\nRight now I am building all the constructions of OA in such a way that they all take the same parameters :\n\n`function_that_builds_OA(k,n,availability)`\n\nand it does what you expect, i.e. try if it is able to build this OA and answers accordingly. If we can make all functions that return OA behave this way, and the constructor can look like this :\n\n```\nfor f in [f1,f2,f3,f4,....]:\n   # try if f can be the OA we want, otherwise try the next.\n```\n\nSo if we have recursive functions behaving this way, we can just add them to the list !\n\nNathann",
    "created_at": "2014-05-01T14:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207281",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> 1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.


What is the point of having a function `TD_product` which only takes integer as input ? What can it do that `designs.transversal_design(...)` does not already do ?

What we could do is implement a second function TD_product_from_parameters which calls the other ?

> 3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.


Whyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy ?

Right now I am building all the constructions of OA in such a way that they all take the same parameters :

`function_that_builds_OA(k,n,availability)`

and it does what you expect, i.e. try if it is able to build this OA and answers accordingly. If we can make all functions that return OA behave this way, and the constructor can look like this :

```
for f in [f1,f2,f3,f4,....]:
   # try if f can be the OA we want, otherwise try the next.
```

So if we have recursive functions behaving this way, we can just add them to the list !

Nathann



---

archive/issue_comments_207282.json:
```json
{
    "body": "(scuse me, replace \"availability\" with \"existence\")",
    "created_at": "2014-05-01T14:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207282",
    "user": "https://github.com/nathanncohen"
}
```

(scuse me, replace "availability" with "existence")



---

archive/issue_comments_207283.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-01T19:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207283",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207284.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> Yo !\n> \n> > 1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.\n\n> \n> What is the point of having a function `TD_product` which only takes integer as input ? What can it do that `designs.transversal_design(...)` does not already do ?\n> \n> What we could do is implement a second function TD_product_from_parameters which calls the other ?\n\n\nSometimes you want only functions with the same prototype and sometimes you claim it is better otherwise...\n\n> > 3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.\n\n> \n> Whyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy ?\n> \n> Right now I am building all the constructions of OA in such a way that they all take the same parameters :\n> \n> `function_that_builds_OA(k,n,availability)`\n\n>\n> and it does what you expect, i.e. try if it is able to build this OA and answers accordingly. If we can make all functions that return OA behave this way, and the constructor can look like this :\n\n\nAll right. What I meant is that it makes sense to try Wilson and product in the same function that builds OA. But on the other hands, calling divisors is relatively cheap on the kind of entries you will have. In a near future (and according to the TODO) the Wilson construction might be much more involved... will see.\n\nThere was doctest error that I solved on u/vdelecroix/16227. I also added curiosity doctests (the current maximum k that Sage knows from n between 10 and 20).\n\nSee the changes in u/vdelecroix/16227, if you are happy with them this is good to go.",
    "created_at": "2014-05-01T21:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207284",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:5 ncohen]:
> Yo !
> 
> > 1) As I mentioned in #15310, I would prefer to have `TD_product` to be something called with arguments `k,n1,n2` as it is for Wilson construction. Specifications `def TD_product(k,n1,n2,TD1=None,TD2=None)` might be better. But then, if you provide TD1 and TD2, the arguments k,n1,n2 are redundant.

> 
> What is the point of having a function `TD_product` which only takes integer as input ? What can it do that `designs.transversal_design(...)` does not already do ?
> 
> What we could do is implement a second function TD_product_from_parameters which calls the other ?


Sometimes you want only functions with the same prototype and sometimes you claim it is better otherwise...

> > 3) As Brett mentioned in #15310, it would make sense to have a more involved `find_wilson_decomposition` which also contains product. There are tons of variants of Wilson decomposition and according to Colbourne-Dinitz this is how most of the current records are obtained. We might concentrate all the non-direct constructions into a global function `build_TD_from_smaller_ones` or `generalized_Wilson_construction`.

> 
> Whyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy ?
> 
> Right now I am building all the constructions of OA in such a way that they all take the same parameters :
> 
> `function_that_builds_OA(k,n,availability)`

>
> and it does what you expect, i.e. try if it is able to build this OA and answers accordingly. If we can make all functions that return OA behave this way, and the constructor can look like this :


All right. What I meant is that it makes sense to try Wilson and product in the same function that builds OA. But on the other hands, calling divisors is relatively cheap on the kind of entries you will have. In a near future (and according to the TODO) the Wilson construction might be much more involved... will see.

There was doctest error that I solved on u/vdelecroix/16227. I also added curiosity doctests (the current maximum k that Sage knows from n between 10 and 20).

See the changes in u/vdelecroix/16227, if you are happy with them this is good to go.



---

archive/issue_comments_207285.json:
```json
{
    "body": "> Sometimes you want only functions with the same prototype and sometimes you claim it is better otherwise...\n\n\n1) I think that having a TD product functions that accepts TD as input and not only parameters is useful\n\n2) I think that at the moment Wilson's construction with TD as input is not really useful, as it is a complex thing and nobody knows it exists\n\n3) I think that all constructors should have the same prototype to give us a clean `orthogonal_array` function\n\n4) Thus creating a second function that calls the current TD and has the same prototype as the others makes sense to me.\n\n> All right. What I meant is that it makes sense to try Wilson and product in the same function that builds OA. But on the other hands, calling divisors is relatively cheap on the kind of entries you will have. In a near future (and according to the TODO) the Wilson construction might be much more involved... will see.\n\n\nCalling divisors is 100% free compared to the kind of constructions we deal with. We create fields, products, long lists, temporary matrices of thousands of entries. Calling divisors *is* free.\n\n> There was doctest error that I solved on u/vdelecroix/16227. I also added curiosity doctests (the current maximum k that Sage knows from n between 10 and 20).\n> \n> See the changes in u/vdelecroix/16227, if you are happy with them this is good to go.\n\n\nI will look at this immediately.\n\nNathann",
    "created_at": "2014-05-01T21:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207285",
    "user": "https://github.com/nathanncohen"
}
```

> Sometimes you want only functions with the same prototype and sometimes you claim it is better otherwise...


1) I think that having a TD product functions that accepts TD as input and not only parameters is useful

2) I think that at the moment Wilson's construction with TD as input is not really useful, as it is a complex thing and nobody knows it exists

3) I think that all constructors should have the same prototype to give us a clean `orthogonal_array` function

4) Thus creating a second function that calls the current TD and has the same prototype as the others makes sense to me.

> All right. What I meant is that it makes sense to try Wilson and product in the same function that builds OA. But on the other hands, calling divisors is relatively cheap on the kind of entries you will have. In a near future (and according to the TODO) the Wilson construction might be much more involved... will see.


Calling divisors is 100% free compared to the kind of constructions we deal with. We create fields, products, long lists, temporary matrices of thousands of entries. Calling divisors *is* free.

> There was doctest error that I solved on u/vdelecroix/16227. I also added curiosity doctests (the current maximum k that Sage knows from n between 10 and 20).
> 
> See the changes in u/vdelecroix/16227, if you are happy with them this is good to go.


I will look at this immediately.

Nathann



---

archive/issue_comments_207286.json:
```json
{
    "body": "Looks cool. Do you mind if I change your \"curiosity tests\" by using `availability=True`, so that we have boolean answers instead of exceptions ? And this will become \"Unknown\" return values in a later patch.\n\nNathann",
    "created_at": "2014-05-01T21:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207286",
    "user": "https://github.com/nathanncohen"
}
```

Looks cool. Do you mind if I change your "curiosity tests" by using `availability=True`, so that we have boolean answers instead of exceptions ? And this will become "Unknown" return values in a later patch.

Nathann



---

archive/issue_comments_207287.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-01T21:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207288.json:
```json
{
    "body": "Well... Actually they were \"Unknown\" answers already.. So if you don't mind here is the branch, otherwise we can go back to your latest commit, it is not very important. Just easier to read (for me), and it advertises the \"Unknown\" truth values for those who haven't met them.\n\nNathann",
    "created_at": "2014-05-01T21:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207288",
    "user": "https://github.com/nathanncohen"
}
```

Well... Actually they were "Unknown" answers already.. So if you don't mind here is the branch, otherwise we can go back to your latest commit, it is not very important. Just easier to read (for me), and it advertises the "Unknown" truth values for those who haven't met them.

Nathann



---

archive/issue_comments_207289.json:
```json
{
    "body": "Ok. Then it is good for me.\n\nVincent",
    "created_at": "2014-05-02T08:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207289",
    "user": "https://github.com/videlec"
}
```

Ok. Then it is good for me.

Vincent



---

archive/issue_comments_207290.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-02T08:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207290",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207291.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-05-04T16:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_207292.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-05-04T16:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_207293.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-04T16:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207293",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207294.json:
```json
{
    "body": "(same trivial conflict with the new release)",
    "created_at": "2014-05-04T16:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207294",
    "user": "https://github.com/nathanncohen"
}
```

(same trivial conflict with the new release)



---

archive/issue_events_047830.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15990#event-47830"
}
```



---

archive/issue_comments_207295.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-07T08:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15990#issuecomment-207295",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_047831.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-07T08:31:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15990",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15990#event-47831"
}
```
