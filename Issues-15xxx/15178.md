# Issue 15178: the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)

archive/issues_014941.json:
```json
{
    "body": "It's pretty obvious that there is a problem.  This was reported in the thread:\n\n   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n\nThere is an easy 1-line fix, which is to replace the line\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(f):\n```\nwith\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(filename):\n```\n\nat the beginning of the \"which\" function. \n\n\nCC:  @kiwifb\n\nBranch/Commit: 4fdef7436a08d4ad2af8900d81816f440d7f9c34\n\nWork_Issues: Update `package-version.txt`\n\nReviewer: William Stein, Peter Bruin\n\nAuthor: Bradly Schlenker\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15178\n\n",
    "closed_at": "2014-05-25T17:31:46Z",
    "created_at": "2013-09-08T17:51:46Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15178",
    "user": "was, certik"
}
```
It's pretty obvious that there is a problem.  This was reported in the thread:

   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78

There is an easy 1-line fix, which is to replace the line

```
if os.access (filename, os.X_OK) and not os.path.isdir(f):
```
with

```
if os.access (filename, os.X_OK) and not os.path.isdir(filename):
```

at the beginning of the "which" function. 


CC:  @kiwifb

Branch/Commit: 4fdef7436a08d4ad2af8900d81816f440d7f9c34

Work_Issues: Update `package-version.txt`

Reviewer: William Stein, Peter Bruin

Author: Bradly Schlenker

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15178





---

archive/issue_events_043779.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15178#event-43779"
}
```



---

archive/issue_comments_239632.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,10 +2,16 @@\n \n    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n \n-There is an easy 1-line fix, which is to put\n+There is an easy 1-line fix, which is to replace the line\n \n ```\n-   f = filename\n+if os.access (filename, os.X_OK) and not os.path.isdir(f):\n ```\n+with\n+\n+```\n+if os.access (filename, os.X_OK) and not os.path.isdir(filename):\n+```\n+\n at the beginning of the \"which\" function. \n \n``````\n",
    "created_at": "2014-04-27T16:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239632",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,10 +2,16 @@
 
    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78
 
-There is an easy 1-line fix, which is to put
+There is an easy 1-line fix, which is to replace the line
 
 ```
-   f = filename
+if os.access (filename, os.X_OK) and not os.path.isdir(f):
 ```
+with
+
+```
+if os.access (filename, os.X_OK) and not os.path.isdir(filename):
+```
+
 at the beginning of the "which" function. 
 
``````




---

archive/issue_events_043780.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15178#event-43780"
}
```



---

archive/issue_events_043781.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15178#event-43781"
}
```



---

archive/issue_comments_239633.json:
```json
{
    "body": "Changing branch from \"\" to \"u/bradlys/ticket/15178\"",
    "created_at": "2014-05-08T03:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239633",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

Changing branch from "" to "u/bradlys/ticket/15178"



---

archive/issue_comments_239634.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[815dd05](http://git.sagemath.org/sage.git/commit/?id=815dd05a67da0f011928c04db72d29fb812d8916)|`Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.`|",
    "created_at": "2014-05-08T03:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239634",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[815dd05](http://git.sagemath.org/sage.git/commit/?id=815dd05a67da0f011928c04db72d29fb812d8916)|`Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.`|



---

archive/issue_comments_239635.json:
```json
{
    "body": "Changing commit from \"\" to \"815dd05a67da0f011928c04db72d29fb812d8916\"",
    "created_at": "2014-05-08T03:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239635",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

Changing commit from "" to "815dd05a67da0f011928c04db72d29fb812d8916"



---

archive/issue_comments_239636.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-08T03:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239636",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_239637.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-09T19:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239637",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239638.json:
```json
{
    "body": "<a id='comment:6'></a>\n\n```\nsage -f pexpect\n\npatching file pexpect.py\npatching file pexpect.py\npatching file pexpect.py\nHunk #1 FAILED at 1134.\n1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej\nError applying '../patches/filename.patch'\n \nreal    0m0.092s\nuser    0m0.003s\nsys     0m0.009s\n************************************************************************\nError installing package pexpect-2.0.p5\n```",
    "created_at": "2014-05-09T19:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239638",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:6'></a>

```
sage -f pexpect

patching file pexpect.py
patching file pexpect.py
patching file pexpect.py
Hunk #1 FAILED at 1134.
1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej
Error applying '../patches/filename.patch'
 
real    0m0.092s
user    0m0.003s
sys     0m0.009s
************************************************************************
Error installing package pexpect-2.0.p5
```



---

archive/issue_comments_239639.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|\n|[5bd0912](http://git.sagemath.org/sage.git/commit/?id=5bd09123dafcf5df768a02365f6df93a44087777)|`Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)`|",
    "created_at": "2014-05-10T19:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
|[5bd0912](http://git.sagemath.org/sage.git/commit/?id=5bd09123dafcf5df768a02365f6df93a44087777)|`Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)`|



---

archive/issue_comments_239640.json:
```json
{
    "body": "Changing commit from \"815dd05a67da0f011928c04db72d29fb812d8916\" to \"5bd09123dafcf5df768a02365f6df93a44087777\"",
    "created_at": "2014-05-10T19:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "815dd05a67da0f011928c04db72d29fb812d8916" to "5bd09123dafcf5df768a02365f6df93a44087777"



---

archive/issue_comments_239641.json:
```json
{
    "body": "Changing reviewer from \"\" to \"William Stein\"",
    "created_at": "2014-05-11T00:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239641",
    "user": "https://github.com/nexttime"
}
```

Changing reviewer from "" to "William Stein"



---

archive/issue_comments_239642.json:
```json
{
    "body": "Changing author from \"\" to \"Bradly Schlenker\"",
    "created_at": "2014-05-11T00:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239642",
    "user": "https://github.com/nexttime"
}
```

Changing author from "" to "Bradly Schlenker"



---

archive/issue_comments_239643.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-11T00:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239643",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239644.json:
```json
{
    "body": "<a id='comment:10'></a>\nProbably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).",
    "created_at": "2014-05-11T00:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239644",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).



---

archive/issue_comments_239645.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-11T00:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239645",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239646.json:
```json
{
    "body": "<a id='comment:11'></a>\nActually, the bug is introduced by us, trying to fix something else:\n\n```patch\n--- a/pexpect.py\t2007-04-16 07:08:24.000000000 -0700\n+++ b/pexpect.py\t2009-01-23 01:49:18.000000000 -0800\n@@ -1130,7 +1130,7 @@\n     \"\"\"\n     # Special case where filename already contains a path.\n     if os.path.dirname(filename) != '':\n-        if os.access (filename, os.X_OK):\n+        if os.access (filename, os.X_OK) and not os.path.isdir(f):\n             return filename\n \n     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':\n@@ -1145,7 +1145,7 @@\n \n     for path in pathlist:\n         f = os.path.join(path, filename)\n-        if os.access(f, os.X_OK):\n+        if os.access(f, os.X_OK) and not os.path.isdir(f):\n             return f\n     return None\n \n```\n(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)",
    "created_at": "2014-05-11T00:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239646",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Actually, the bug is introduced by us, trying to fix something else:

```patch
--- a/pexpect.py	2007-04-16 07:08:24.000000000 -0700
+++ b/pexpect.py	2009-01-23 01:49:18.000000000 -0800
@@ -1130,7 +1130,7 @@
     """
     # Special case where filename already contains a path.
     if os.path.dirname(filename) != '':
-        if os.access (filename, os.X_OK):
+        if os.access (filename, os.X_OK) and not os.path.isdir(f):
             return filename
 
     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':
@@ -1145,7 +1145,7 @@
 
     for path in pathlist:
         f = os.path.join(path, filename)
-        if os.access(f, os.X_OK):
+        if os.access(f, os.X_OK) and not os.path.isdir(f):
             return f
     return None
 
```
(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)



---

archive/issue_comments_239647.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Remove new patch, fix old one\"",
    "created_at": "2014-05-11T00:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239647",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "" to "Remove new patch, fix old one"



---

archive/issue_comments_239648.json:
```json
{
    "body": "<a id='comment:12'></a>\nOh, that one apparently dates back to 2009:\n\n```\n### pexpect-2.0.p2 (William Stein, January 23rd, 2009)\n * created proper SPKG.txt\n * fixed bug in pexpect where it tried to run directories\n```\n\n(Sorry William, could not resist... B) )",
    "created_at": "2014-05-11T00:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239648",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>
Oh, that one apparently dates back to 2009:

```
### pexpect-2.0.p2 (William Stein, January 23rd, 2009)
 * created proper SPKG.txt
 * fixed bug in pexpect where it tried to run directories
```

(Sorry William, could not resist... B) )



---

archive/issue_comments_239649.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [leif](#comment%3A12):\n> Oh, that one apparently dates back to 2009:\n> \n> ```\n> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===\n>  * created proper SPKG.txt\n>  * fixed bug in pexpect where it tried to run directories\n> ```\n> \n> (Sorry William, could not resist... B) )\n\n\nThanks!  Isn't revision control awesome...",
    "created_at": "2014-05-11T14:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239649",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'></a>
Replying to [leif](#comment%3A12):
> Oh, that one apparently dates back to 2009:
> 
> ```
> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===
>  * created proper SPKG.txt
>  * fixed bug in pexpect where it tried to run directories
> ```
> 
> (Sorry William, could not resist... B) )


Thanks!  Isn't revision control awesome...



---

archive/issue_comments_239650.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [was](#comment%3A13):\n> Thanks!  Isn't revision control awesome...\n\n\nWell, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting \"legacy\" spkgs to \"new style\" spkgs.",
    "created_at": "2014-05-11T15:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239650",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [was](#comment%3A13):
> Thanks!  Isn't revision control awesome...


Well, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting "legacy" spkgs to "new style" spkgs.



---

archive/issue_comments_239651.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|\n|[8a42373](http://git.sagemath.org/sage.git/commit/?id=8a42373dd85a0e0813c040685f1474e7b735f82a)|`Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178`|",
    "created_at": "2014-05-13T02:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|[8a42373](http://git.sagemath.org/sage.git/commit/?id=8a42373dd85a0e0813c040685f1474e7b735f82a)|`Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178`|



---

archive/issue_comments_239652.json:
```json
{
    "body": "Changing commit from \"5bd09123dafcf5df768a02365f6df93a44087777\" to \"8a42373dd85a0e0813c040685f1474e7b735f82a\"",
    "created_at": "2014-05-13T02:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239652",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5bd09123dafcf5df768a02365f6df93a44087777" to "8a42373dd85a0e0813c040685f1474e7b735f82a"



---

archive/issue_comments_239653.json:
```json
{
    "body": "Changing work_issues from \"Remove new patch, fix old one\" to \"\"",
    "created_at": "2014-05-13T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239653",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "Remove new patch, fix old one" to ""



---

archive/issue_comments_239654.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-13T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239654",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239655.json:
```json
{
    "body": "<a id='comment:16'></a>\nOk.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.",
    "created_at": "2014-05-13T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239655",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
Ok.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.



---

archive/issue_comments_239656.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [leif](#comment%3A10):\n> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\nI do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?",
    "created_at": "2014-05-17T20:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239656",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'></a>
Replying to [leif](#comment%3A10):
> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?



---

archive/issue_comments_239657.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [pbruin](#comment%3A17):\n> Replying to [leif](#comment%3A10):\n> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\n> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?\n\nYes.",
    "created_at": "2014-05-17T20:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239657",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>
Replying to [pbruin](#comment%3A17):
> Replying to [leif](#comment%3A10):
> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?

Yes.



---

archive/issue_comments_239658.json:
```json
{
    "body": "<a id='comment:19'></a>\nLeif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.",
    "created_at": "2014-05-17T21:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239658",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Leif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.



---

archive/issue_comments_239659.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-18T13:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239659",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239660.json:
```json
{
    "body": "<a id='comment:20'></a>\npatchbot:\n\n```\nsage -t --long /scratch/sage/src/sage/interfaces/expect.py\n**********************************************************************\nFile \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\ns.expect.Expect._eval_line\nFailed example:\n    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\nh, 2012)\nExpected:\n    False\nGot:\n    True\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.interfaces.expect.Expect._eval_line\n    [81 tests, 1 failure, 20.20 s]\n```",
    "created_at": "2014-05-18T13:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239660",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>
patchbot:

```
sage -t --long /scratch/sage/src/sage/interfaces/expect.py
**********************************************************************
File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
s.expect.Expect._eval_line
Failed example:
    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
h, 2012)
Expected:
    False
Got:
    True
**********************************************************************
1 item had failures:
   1 of  15 in sage.interfaces.expect.Expect._eval_line
    [81 tests, 1 failure, 20.20 s]
```



---

archive/issue_comments_239661.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [rws](#comment%3A20):\n> patchbot:\n> \n> ```\n> sage -t --long /scratch/sage/src/sage/interfaces/expect.py\n> **********************************************************************\n> File \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\n> s.expect.Expect._eval_line\n> Failed example:\n>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\n> h, 2012)\n> Expected:\n>     False\n> Got:\n>     True\n> **********************************************************************\n> 1 item had failures:\n>    1 of  15 in sage.interfaces.expect.Expect._eval_line\n>     [81 tests, 1 failure, 20.20 s]\n> ```\n\n\nHow could the change here be related to this?",
    "created_at": "2014-05-18T13:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239661",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Replying to [rws](#comment%3A20):
> patchbot:
> 
> ```
> sage -t --long /scratch/sage/src/sage/interfaces/expect.py
> **********************************************************************
> File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
> s.expect.Expect._eval_line
> Failed example:
>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
> h, 2012)
> Expected:
>     False
> Got:
>     True
> **********************************************************************
> 1 item had failures:
>    1 of  15 in sage.interfaces.expect.Expect._eval_line
>     [81 tests, 1 failure, 20.20 s]
> ```


How could the change here be related to this?



---

archive/issue_comments_239662.json:
```json
{
    "body": "<a id='comment:22'></a>\nIs it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.\n\nEdit: Actually it was #10476 that hit.",
    "created_at": "2014-05-18T13:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239662",
    "user": "https://github.com/rwst"
}
```

<a id='comment:22'></a>
Is it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.

Edit: Actually it was #10476 that hit.



---

archive/issue_comments_239663.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-18T13:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239663",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239664.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Update `package-version.txt`\"",
    "created_at": "2014-05-18T14:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239664",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "" to "Update `package-version.txt`"



---

archive/issue_comments_239665.json:
```json
{
    "body": "<a id='comment:23'></a>\nSo, are we going to update `package-version.txt`?\n\nThe changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).\n\nIn the latter case, should `package-version.txt` still refer to `.p5`? ;-)\n\nBut here we actually change a patch to `pexpect`, so...",
    "created_at": "2014-05-18T14:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239665",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
So, are we going to update `package-version.txt`?

The changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).

In the latter case, should `package-version.txt` still refer to `.p5`? ;-)

But here we actually change a patch to `pexpect`, so...



---

archive/issue_comments_239666.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-18T14:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239666",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239667.json:
```json
{
    "body": "Changing commit from \"8a42373dd85a0e0813c040685f1474e7b735f82a\" to \"4fdef7436a08d4ad2af8900d81816f440d7f9c34\"",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239667",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "8a42373dd85a0e0813c040685f1474e7b735f82a" to "4fdef7436a08d4ad2af8900d81816f440d7f9c34"



---

archive/issue_comments_239668.json:
```json
{
    "body": "Changing reviewer from \"William Stein\" to \"William Stein, Peter Bruin\"",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239668",
    "user": "https://github.com/pjbruin"
}
```

Changing reviewer from "William Stein" to "William Stein, Peter Bruin"



---

archive/issue_comments_239669.json:
```json
{
    "body": "Changing branch from \"u/bradlys/ticket/15178\" to \"u/pbruin/15178-pexpect_which\"",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239669",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "u/bradlys/ticket/15178" to "u/pbruin/15178-pexpect_which"



---

archive/issue_comments_239670.json:
```json
{
    "body": "<a id='comment:24'></a>\nMerged the previous commits into one and added the `package-version.txt` update as a reviewer patch.",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239670",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:24'></a>
Merged the previous commits into one and added the `package-version.txt` update as a reviewer patch.



---

archive/issue_comments_239671.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239671",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_239672.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-25T17:31:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239672",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_043782.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-25T17:31:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15178#event-43782"
}
```



---

archive/issue_comments_239673.json:
```json
{
    "body": "Changing branch from \"u/pbruin/15178-pexpect_which\" to \"4fdef7436a08d4ad2af8900d81816f440d7f9c34\"",
    "created_at": "2014-05-25T17:31:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15178#issuecomment-239673",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pbruin/15178-pexpect_which" to "4fdef7436a08d4ad2af8900d81816f440d7f9c34"
