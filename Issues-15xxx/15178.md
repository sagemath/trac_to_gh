# Issue 15178: the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)

archive/issues_014941.json:
```json
{
    "assignees": [],
    "body": "It's pretty obvious that there is a problem.  This was reported in the thread:\n\n   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n\nThere is an easy 1-line fix, which is to replace the line\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(f):\n```\nwith\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(filename):\n```\n\nat the beginning of the \"which\" function. \n\n\nCC:  @kiwifb\n\nBranch/Commit: **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**\n\nWork Issues: **Update `package-version.txt`**\n\nReviewer: **William Stein, Peter Bruin**\n\nAuthor: **Bradly Schlenker**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15178_\n\n",
    "closed_at": "2014-05-25T17:31:46Z",
    "created_at": "2013-09-08T17:51:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)",
    "type": "issue",
    "updated_at": "2014-05-25T17:31:46Z",
    "url": "https://github.com/sagemath/sage/issues/15178",
    "user": "was, certik"
}
```
It's pretty obvious that there is a problem.  This was reported in the thread:

   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78

There is an easy 1-line fix, which is to replace the line

```
if os.access (filename, os.X_OK) and not os.path.isdir(f):
```
with

```
if os.access (filename, os.X_OK) and not os.path.isdir(filename):
```

at the beginning of the "which" function. 


CC:  @kiwifb

Branch/Commit: **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**

Work Issues: **Update `package-version.txt`**

Reviewer: **William Stein, Peter Bruin**

Author: **Bradly Schlenker**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/15178_





---

archive/issue_events_213611.json:
```json
{
    "actor": null,
    "created_at": "2013-09-08T17:51:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213611"
}
```



---

archive/issue_events_213612.json:
```json
{
    "actor": null,
    "created_at": "2013-09-08T17:51:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213612"
}
```



---

archive/issue_events_213613.json:
```json
{
    "actor": null,
    "created_at": "2013-09-08T17:51:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213613"
}
```



---

archive/issue_events_213614.json:
```json
{
    "actor": null,
    "created_at": "2013-09-08T17:51:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213614"
}
```



---

archive/issue_events_213615.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213615"
}
```



---

archive/issue_events_213616.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213616"
}
```



---

archive/issue_comments_186796.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,10 +2,16 @@\n \n    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n \n-There is an easy 1-line fix, which is to put\n+There is an easy 1-line fix, which is to replace the line\n \n ```\n-   f = filename\n+if os.access (filename, os.X_OK) and not os.path.isdir(f):\n ```\n+with\n+\n+```\n+if os.access (filename, os.X_OK) and not os.path.isdir(filename):\n+```\n+\n at the beginning of the \"which\" function. \n \n``````\n",
    "created_at": "2014-04-27T16:53:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186796",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,10 +2,16 @@
 
    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78
 
-There is an easy 1-line fix, which is to put
+There is an easy 1-line fix, which is to replace the line
 
 ```
-   f = filename
+if os.access (filename, os.X_OK) and not os.path.isdir(f):
 ```
+with
+
+```
+if os.access (filename, os.X_OK) and not os.path.isdir(filename):
+```
+
 at the beginning of the "which" function. 
 
``````




---

archive/issue_events_213617.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213617"
}
```



---

archive/issue_events_213618.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213618"
}
```



---

archive/issue_comments_186797.json:
```json
{
    "body": "Branch: **[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)**",
    "created_at": "2014-05-08T03:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186797",
    "user": "https://github.com/sagetrac-bradlys"
}
```

Branch: **[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)**



---

archive/issue_comments_186798.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916\"><code>815dd05</code></a></td><td><code>Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.</code></td></tr></table>\n",
    "created_at": "2014-05-08T03:09:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186798",
    "user": "https://github.com/sagetrac-bradlys"
}
```

<div id="comment:5"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916"><code>815dd05</code></a></td><td><code>Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.</code></td></tr></table>




---

archive/issue_comments_186799.json:
```json
{
    "body": "Commit: **[`815dd05`](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)**",
    "created_at": "2014-05-08T03:09:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186799",
    "user": "https://github.com/sagetrac-bradlys"
}
```

Commit: **[`815dd05`](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)**



---

archive/issue_events_213619.json:
```json
{
    "actor": "https://github.com/sagetrac-bradlys",
    "created_at": "2014-05-08T03:09:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213619"
}
```



---

archive/issue_events_213620.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2014-05-09T19:30:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213620"
}
```



---

archive/issue_events_213621.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2014-05-09T19:30:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213621"
}
```



---

archive/issue_comments_186800.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n\n```\nsage -f pexpect\n\npatching file pexpect.py\npatching file pexpect.py\npatching file pexpect.py\nHunk #1 FAILED at 1134.\n1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej\nError applying '../patches/filename.patch'\n \nreal    0m0.092s\nuser    0m0.003s\nsys     0m0.009s\n************************************************************************\nError installing package pexpect-2.0.p5\n```",
    "created_at": "2014-05-09T19:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186800",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:6" align="right">comment:6</div>


```
sage -f pexpect

patching file pexpect.py
patching file pexpect.py
patching file pexpect.py
Hunk #1 FAILED at 1134.
1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej
Error applying '../patches/filename.patch'
 
real    0m0.092s
user    0m0.003s
sys     0m0.009s
************************************************************************
Error installing package pexpect-2.0.p5
```



---

archive/issue_comments_186801.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777\"><code>5bd0912</code></a></td><td><code>Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)</code></td></tr></table>\n",
    "created_at": "2014-05-10T19:33:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186801",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777"><code>5bd0912</code></a></td><td><code>Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)</code></td></tr></table>




---

archive/issue_comments_186802.json:
```json
{
    "body": "Changed commit from **[`815dd05`](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)** to **[`5bd0912`](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)**",
    "created_at": "2014-05-10T19:33:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186802",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`815dd05`](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)** to **[`5bd0912`](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)**



---

archive/issue_comments_186803.json:
```json
{
    "body": "Reviewer: **William Stein**",
    "created_at": "2014-05-11T00:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186803",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **William Stein**



---

archive/issue_comments_186804.json:
```json
{
    "body": "Author: **Bradly Schlenker**",
    "created_at": "2014-05-11T00:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186804",
    "user": "https://github.com/nexttime"
}
```

Author: **Bradly Schlenker**



---

archive/issue_events_213622.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:15:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213622"
}
```



---

archive/issue_events_213623.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:15:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213623"
}
```



---

archive/issue_comments_186805.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nProbably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).",
    "created_at": "2014-05-11T00:21:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186805",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).



---

archive/issue_events_213624.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:25:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213624"
}
```



---

archive/issue_events_213625.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:25:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213625"
}
```



---

archive/issue_comments_186806.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nActually, the bug is introduced by us, trying to fix something else:\n\n```patch\n--- a/pexpect.py\t2007-04-16 07:08:24.000000000 -0700\n+++ b/pexpect.py\t2009-01-23 01:49:18.000000000 -0800\n@@ -1130,7 +1130,7 @@\n     \"\"\"\n     # Special case where filename already contains a path.\n     if os.path.dirname(filename) != '':\n-        if os.access (filename, os.X_OK):\n+        if os.access (filename, os.X_OK) and not os.path.isdir(f):\n             return filename\n \n     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':\n@@ -1145,7 +1145,7 @@\n \n     for path in pathlist:\n         f = os.path.join(path, filename)\n-        if os.access(f, os.X_OK):\n+        if os.access(f, os.X_OK) and not os.path.isdir(f):\n             return f\n     return None\n \n```\n(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)",
    "created_at": "2014-05-11T00:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186806",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

Actually, the bug is introduced by us, trying to fix something else:

```patch
--- a/pexpect.py	2007-04-16 07:08:24.000000000 -0700
+++ b/pexpect.py	2009-01-23 01:49:18.000000000 -0800
@@ -1130,7 +1130,7 @@
     """
     # Special case where filename already contains a path.
     if os.path.dirname(filename) != '':
-        if os.access (filename, os.X_OK):
+        if os.access (filename, os.X_OK) and not os.path.isdir(f):
             return filename
 
     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':
@@ -1145,7 +1145,7 @@
 
     for path in pathlist:
         f = os.path.join(path, filename)
-        if os.access(f, os.X_OK):
+        if os.access(f, os.X_OK) and not os.path.isdir(f):
             return f
     return None
 
```
(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)



---

archive/issue_comments_186807.json:
```json
{
    "body": "Work Issues: **Remove new patch, fix old one**",
    "created_at": "2014-05-11T00:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186807",
    "user": "https://github.com/nexttime"
}
```

Work Issues: **Remove new patch, fix old one**



---

archive/issue_comments_186808.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOh, that one apparently dates back to 2009:\n\n```\n=== pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===\n * created proper SPKG.txt\n * fixed bug in pexpect where it tried to run directories\n```\n\n(Sorry William, could not resist... B) )",
    "created_at": "2014-05-11T00:34:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186808",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Oh, that one apparently dates back to 2009:

```
=== pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===
 * created proper SPKG.txt
 * fixed bug in pexpect where it tried to run directories
```

(Sorry William, could not resist... B) )



---

archive/issue_comments_186809.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@nexttime](#comment:12):\n> Oh, that one apparently dates back to 2009:\n> \n> ```\n> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===\n>  * created proper SPKG.txt\n>  * fixed bug in pexpect where it tried to run directories\n> ```\n> \n> (Sorry William, could not resist... B) )\n\nThanks!  Isn't revision control awesome...",
    "created_at": "2014-05-11T14:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186809",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@nexttime](#comment:12):
> Oh, that one apparently dates back to 2009:
> 
> ```
> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===
>  * created proper SPKG.txt
>  * fixed bug in pexpect where it tried to run directories
> ```
> 
> (Sorry William, could not resist... B) )

Thanks!  Isn't revision control awesome...



---

archive/issue_comments_186810.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@williamstein](#comment:13):\n> Thanks!  Isn't revision control awesome...\n\nWell, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting \"legacy\" spkgs to \"new style\" spkgs.",
    "created_at": "2014-05-11T15:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186810",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@williamstein](#comment:13):
> Thanks!  Isn't revision control awesome...

Well, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting "legacy" spkgs to "new style" spkgs.



---

archive/issue_comments_186811.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a\"><code>8a42373</code></a></td><td><code>Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178</code></td></tr></table>\n",
    "created_at": "2014-05-13T02:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186811",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a"><code>8a42373</code></a></td><td><code>Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178</code></td></tr></table>




---

archive/issue_comments_186812.json:
```json
{
    "body": "Changed commit from **[`5bd0912`](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)** to **[`8a42373`](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)**",
    "created_at": "2014-05-13T02:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186812",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5bd0912`](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)** to **[`8a42373`](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)**



---

archive/issue_comments_186813.json:
```json
{
    "body": "Changed work issues from **Remove new patch, fix old one** to none",
    "created_at": "2014-05-13T11:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186813",
    "user": "https://github.com/nexttime"
}
```

Changed work issues from **Remove new patch, fix old one** to none



---

archive/issue_events_213626.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-13T11:12:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213626"
}
```



---

archive/issue_events_213627.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-13T11:12:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213627"
}
```



---

archive/issue_comments_186814.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOk.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.",
    "created_at": "2014-05-13T11:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186814",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Ok.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.



---

archive/issue_comments_186815.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@nexttime](#comment:10):\n> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\nI do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?",
    "created_at": "2014-05-17T20:43:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186815",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@nexttime](#comment:10):
> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?



---

archive/issue_comments_186816.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@pjbruin](#comment:17):\n> Replying to [@nexttime](#comment:10):\n> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\n> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?\n\nYes.",
    "created_at": "2014-05-17T20:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186816",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@pjbruin](#comment:17):
> Replying to [@nexttime](#comment:10):
> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?

Yes.



---

archive/issue_comments_186817.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nLeif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.",
    "created_at": "2014-05-17T21:04:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186817",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Leif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.



---

archive/issue_events_213628.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:21:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213628"
}
```



---

archive/issue_events_213629.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:21:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213629"
}
```



---

archive/issue_comments_186818.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\npatchbot:\n\n```\nsage -t --long /scratch/sage/src/sage/interfaces/expect.py\n**********************************************************************\nFile \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\ns.expect.Expect._eval_line\nFailed example:\n    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\nh, 2012)\nExpected:\n    False\nGot:\n    True\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.interfaces.expect.Expect._eval_line\n    [81 tests, 1 failure, 20.20 s]\n```",
    "created_at": "2014-05-18T13:21:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186818",
    "user": "https://github.com/rwst"
}
```

<div id="comment:20" align="right">comment:20</div>

patchbot:

```
sage -t --long /scratch/sage/src/sage/interfaces/expect.py
**********************************************************************
File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
s.expect.Expect._eval_line
Failed example:
    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
h, 2012)
Expected:
    False
Got:
    True
**********************************************************************
1 item had failures:
   1 of  15 in sage.interfaces.expect.Expect._eval_line
    [81 tests, 1 failure, 20.20 s]
```



---

archive/issue_comments_186819.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@rwst](#comment:20):\n> patchbot:\n> \n> ```\n> sage -t --long /scratch/sage/src/sage/interfaces/expect.py\n> **********************************************************************\n> File \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\n> s.expect.Expect._eval_line\n> Failed example:\n>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\n> h, 2012)\n> Expected:\n>     False\n> Got:\n>     True\n> **********************************************************************\n> 1 item had failures:\n>    1 of  15 in sage.interfaces.expect.Expect._eval_line\n>     [81 tests, 1 failure, 20.20 s]\n> ```\n\nHow could the change here be related to this?",
    "created_at": "2014-05-18T13:48:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186819",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@rwst](#comment:20):
> patchbot:
> 
> ```
> sage -t --long /scratch/sage/src/sage/interfaces/expect.py
> **********************************************************************
> File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
> s.expect.Expect._eval_line
> Failed example:
>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
> h, 2012)
> Expected:
>     False
> Got:
>     True
> **********************************************************************
> 1 item had failures:
>    1 of  15 in sage.interfaces.expect.Expect._eval_line
>     [81 tests, 1 failure, 20.20 s]
> ```

How could the change here be related to this?



---

archive/issue_comments_186820.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIs it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.\n\nEdit: Actually it was #10476 that hit.",
    "created_at": "2014-05-18T13:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186820",
    "user": "https://github.com/rwst"
}
```

<div id="comment:22" align="right">comment:22</div>

Is it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.

Edit: Actually it was #10476 that hit.



---

archive/issue_events_213630.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:51:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213630"
}
```



---

archive/issue_events_213631.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213631"
}
```



---

archive/issue_comments_186821.json:
```json
{
    "body": "Work Issues: **Update `package-version.txt`**",
    "created_at": "2014-05-18T14:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186821",
    "user": "https://github.com/nexttime"
}
```

Work Issues: **Update `package-version.txt`**



---

archive/issue_comments_186822.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nSo, are we going to update `package-version.txt`?\n\nThe changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).\n\nIn the latter case, should `package-version.txt` still refer to `.p5`? ;-)\n\nBut here we actually change a patch to `pexpect`, so...",
    "created_at": "2014-05-18T14:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186822",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:23" align="right">comment:23</div>

So, are we going to update `package-version.txt`?

The changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).

In the latter case, should `package-version.txt` still refer to `.p5`? ;-)

But here we actually change a patch to `pexpect`, so...



---

archive/issue_events_213632.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-18T14:04:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213632"
}
```



---

archive/issue_events_213633.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-18T14:04:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213633"
}
```



---

archive/issue_comments_186823.json:
```json
{
    "body": "Changed commit from **[`8a42373`](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)** to **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**",
    "created_at": "2014-05-24T12:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186823",
    "user": "https://github.com/pjbruin"
}
```

Changed commit from **[`8a42373`](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)** to **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**



---

archive/issue_comments_186824.json:
```json
{
    "body": "Changed reviewer from **William Stein** to **William Stein, Peter Bruin**",
    "created_at": "2014-05-24T12:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186824",
    "user": "https://github.com/pjbruin"
}
```

Changed reviewer from **William Stein** to **William Stein, Peter Bruin**



---

archive/issue_comments_186825.json:
```json
{
    "body": "Changed branch from **[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)** to **[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)**",
    "created_at": "2014-05-24T12:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186825",
    "user": "https://github.com/pjbruin"
}
```

Changed branch from **[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)** to **[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)**



---

archive/issue_comments_186826.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nMerged the previous commits into one and added the `package-version.txt` update as a reviewer patch.",
    "created_at": "2014-05-24T12:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186826",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:24" align="right">comment:24</div>

Merged the previous commits into one and added the `package-version.txt` update as a reviewer patch.



---

archive/issue_events_213634.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-24T12:02:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213634"
}
```



---

archive/issue_events_213635.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-24T12:02:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213635"
}
```



---

archive/issue_events_213636.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-25T17:31:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213636"
}
```



---

archive/issue_events_213637.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8634ff216213117f1a065f2723dbf254990c785d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-05-25T17:31:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-213637"
}
```



---

archive/issue_comments_186827.json:
```json
{
    "body": "Changed branch from **[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)** to **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**",
    "created_at": "2014-05-25T17:31:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-186827",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)** to **[`4fdef74`](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)**
