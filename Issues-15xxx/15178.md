# Issue 15178: the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)

archive/issues_014941.json:
```json
{
    "body": "It's pretty obvious that there is a problem.  This was reported in the thread:\n\n   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n\nThere is an easy 1-line fix, which is to replace the line\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(f):\n```\nwith\n\n```\nif os.access (filename, os.X_OK) and not os.path.isdir(filename):\n```\n\nat the beginning of the \"which\" function. \n\n\n**CC:**  @kiwifb\n\n**Branch/Commit:** [4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)\n\n**Work Issues:** Update `package-version.txt`\n\n**Reviewer:** William Stein, Peter Bruin\n\n**Author:** Bradly Schlenker\n\nIssue created by migration from https://trac.sagemath.org/ticket/15178\n\n",
    "closed_at": "2014-05-25T17:31:46Z",
    "created_at": "2013-09-08T17:51:46Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "title": "the pexpect in sage has a major bug in it -- the which command is broken (easy to fix)",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/15178",
    "user": "was, certik"
}
```
It's pretty obvious that there is a problem.  This was reported in the thread:

   https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78

There is an easy 1-line fix, which is to replace the line

```
if os.access (filename, os.X_OK) and not os.path.isdir(f):
```
with

```
if os.access (filename, os.X_OK) and not os.path.isdir(filename):
```

at the beginning of the "which" function. 


**CC:**  @kiwifb

**Branch/Commit:** [4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)

**Work Issues:** Update `package-version.txt`

**Reviewer:** William Stein, Peter Bruin

**Author:** Bradly Schlenker

Issue created by migration from https://trac.sagemath.org/ticket/15178





---

archive/issue_events_133269.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133269"
}
```



---

archive/issue_events_133270.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133270"
}
```



---

archive/issue_comments_189217.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,10 +2,16 @@\n \n    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78\n \n-There is an easy 1-line fix, which is to put\n+There is an easy 1-line fix, which is to replace the line\n \n ```\n-   f = filename\n+if os.access (filename, os.X_OK) and not os.path.isdir(f):\n ```\n+with\n+\n+```\n+if os.access (filename, os.X_OK) and not os.path.isdir(filename):\n+```\n+\n at the beginning of the \"which\" function. \n \n``````\n",
    "created_at": "2014-04-27T16:53:59Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189217",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,10 +2,16 @@
 
    https://groups.google.com/forum/#!topic/sage-cloud/8NgkWfTbU78
 
-There is an easy 1-line fix, which is to put
+There is an easy 1-line fix, which is to replace the line
 
 ```
-   f = filename
+if os.access (filename, os.X_OK) and not os.path.isdir(f):
 ```
+with
+
+```
+if os.access (filename, os.X_OK) and not os.path.isdir(filename):
+```
+
 at the beginning of the "which" function. 
 
``````




---

archive/issue_events_133271.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133271"
}
```



---

archive/issue_events_133272.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133272"
}
```



---

archive/issue_comments_189218.json:
```json
{
    "body": "**Branch:** [u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)",
    "created_at": "2014-05-08T03:08:10Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189218",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

**Branch:** [u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)



---

archive/issue_comments_189219.json:
```json
{
    "body": "<a id='comment:5'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916\">815dd05</a></td><td><code>Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.</code></td></tr></table>\n",
    "created_at": "2014-05-08T03:09:03Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189219",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

<a id='comment:5'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916">815dd05</a></td><td><code>Add filename.patch which patches pexpect-2.0 a bug found in ticket 15178.</code></td></tr></table>




---

archive/issue_comments_189220.json:
```json
{
    "body": "**Commit:** [815dd05a67da0f011928c04db72d29fb812d8916](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)",
    "created_at": "2014-05-08T03:09:03Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189220",
    "user": "https://trac.sagemath.org/admin/accounts/users/bradlys"
}
```

**Commit:** [815dd05a67da0f011928c04db72d29fb812d8916](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)



---

archive/issue_events_133273.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/bradlys",
    "created_at": "2014-05-08T03:09:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133273"
}
```



---

archive/issue_events_133274.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2014-05-09T19:30:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133274"
}
```



---

archive/issue_events_133275.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2014-05-09T19:30:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133275"
}
```



---

archive/issue_comments_189221.json:
```json
{
    "body": "<a id='comment:6'></a>\n\n```\nsage -f pexpect\n\npatching file pexpect.py\npatching file pexpect.py\npatching file pexpect.py\nHunk #1 FAILED at 1134.\n1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej\nError applying '../patches/filename.patch'\n \nreal    0m0.092s\nuser    0m0.003s\nsys     0m0.009s\n************************************************************************\nError installing package pexpect-2.0.p5\n```",
    "created_at": "2014-05-09T19:30:13Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189221",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:6'></a>

```
sage -f pexpect

patching file pexpect.py
patching file pexpect.py
patching file pexpect.py
Hunk #1 FAILED at 1134.
1 out of 1 hunk FAILED -- saving rejects to file pexpect.py.rej
Error applying '../patches/filename.patch'
 
real    0m0.092s
user    0m0.003s
sys     0m0.009s
************************************************************************
Error installing package pexpect-2.0.p5
```



---

archive/issue_comments_189222.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777\">5bd0912</a></td><td><code>Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)</code></td></tr></table>\n",
    "created_at": "2014-05-10T19:33:55Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777">5bd0912</a></td><td><code>Add zzfilename.patch to resolve issues with patching. (Out of order patching, I believe)</code></td></tr></table>




---

archive/issue_comments_189223.json:
```json
{
    "body": "**Changing commit** from \"[815dd05a67da0f011928c04db72d29fb812d8916](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)\" to \"[5bd09123dafcf5df768a02365f6df93a44087777](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)\".",
    "created_at": "2014-05-10T19:33:55Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189223",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[815dd05a67da0f011928c04db72d29fb812d8916](https://github.com/sagemath/sagetrac-mirror/commit/815dd05a67da0f011928c04db72d29fb812d8916)" to "[5bd09123dafcf5df768a02365f6df93a44087777](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)".



---

archive/issue_comments_189224.json:
```json
{
    "body": "**Reviewer:** William Stein",
    "created_at": "2014-05-11T00:15:47Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189224",
    "user": "https://github.com/nexttime"
}
```

**Reviewer:** William Stein



---

archive/issue_comments_189225.json:
```json
{
    "body": "**Author:** Bradly Schlenker",
    "created_at": "2014-05-11T00:15:47Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189225",
    "user": "https://github.com/nexttime"
}
```

**Author:** Bradly Schlenker



---

archive/issue_events_133276.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:15:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133276"
}
```



---

archive/issue_events_133277.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:15:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133277"
}
```



---

archive/issue_comments_189226.json:
```json
{
    "body": "<a id='comment:10'></a>\nProbably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).",
    "created_at": "2014-05-11T00:21:36Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189226",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it (and also delete the changelog in `SPKG.txt`, which I don't like).



---

archive/issue_events_133278.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:25:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133278"
}
```



---

archive/issue_events_133279.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T00:25:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133279"
}
```



---

archive/issue_comments_189227.json:
```json
{
    "body": "<a id='comment:11'></a>\nActually, the bug is introduced by us, trying to fix something else:\n\n```patch\n--- a/pexpect.py\t2007-04-16 07:08:24.000000000 -0700\n+++ b/pexpect.py\t2009-01-23 01:49:18.000000000 -0800\n@@ -1130,7 +1130,7 @@\n     \"\"\"\n     # Special case where filename already contains a path.\n     if os.path.dirname(filename) != '':\n-        if os.access (filename, os.X_OK):\n+        if os.access (filename, os.X_OK) and not os.path.isdir(f):\n             return filename\n \n     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':\n@@ -1145,7 +1145,7 @@\n \n     for path in pathlist:\n         f = os.path.join(path, filename)\n-        if os.access(f, os.X_OK):\n+        if os.access(f, os.X_OK) and not os.path.isdir(f):\n             return f\n     return None\n \n```\n(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)",
    "created_at": "2014-05-11T00:25:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189227",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Actually, the bug is introduced by us, trying to fix something else:

```patch
--- a/pexpect.py	2007-04-16 07:08:24.000000000 -0700
+++ b/pexpect.py	2009-01-23 01:49:18.000000000 -0800
@@ -1130,7 +1130,7 @@
     """
     # Special case where filename already contains a path.
     if os.path.dirname(filename) != '':
-        if os.access (filename, os.X_OK):
+        if os.access (filename, os.X_OK) and not os.path.isdir(f):
             return filename
 
     if not os.environ.has_key('PATH') or os.environ['PATH'] == '':
@@ -1145,7 +1145,7 @@
 
     for path in pathlist:
         f = os.path.join(path, filename)
-        if os.access(f, os.X_OK):
+        if os.access(f, os.X_OK) and not os.path.isdir(f):
             return f
     return None
 
```
(This is `patches/pexpect.py-isdir_bug_fix.patch`, so *that one* should get fixed.)



---

archive/issue_comments_189228.json:
```json
{
    "body": "**Work_Issues:** Remove new patch, fix old one",
    "created_at": "2014-05-11T00:25:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189228",
    "user": "https://github.com/nexttime"
}
```

**Work_Issues:** Remove new patch, fix old one



---

archive/issue_comments_189229.json:
```json
{
    "body": "<a id='comment:12'></a>\nOh, that one apparently dates back to 2009:\n\n```\n=== pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===\n * created proper SPKG.txt\n * fixed bug in pexpect where it tried to run directories\n```\n\n(Sorry William, could not resist... B) )",
    "created_at": "2014-05-11T00:34:57Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189229",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>
Oh, that one apparently dates back to 2009:

```
=== pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===
 * created proper SPKG.txt
 * fixed bug in pexpect where it tried to run directories
```

(Sorry William, could not resist... B) )



---

archive/issue_comments_189230.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [leif](#comment%3A12):\n> Oh, that one apparently dates back to 2009:\n> \n> ```\n> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===\n>  * created proper SPKG.txt\n>  * fixed bug in pexpect where it tried to run directories\n> ```\n> \n> (Sorry William, could not resist... B) )\n\n\nThanks!  Isn't revision control awesome...",
    "created_at": "2014-05-11T14:54:34Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189230",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'></a>
Replying to [leif](#comment%3A12):
> Oh, that one apparently dates back to 2009:
> 
> ```
> === pexpect-2.0.p2 (William Stein, January 23rd, 2009) ===
>  * created proper SPKG.txt
>  * fixed bug in pexpect where it tried to run directories
> ```
> 
> (Sorry William, could not resist... B) )


Thanks!  Isn't revision control awesome...



---

archive/issue_comments_189231.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [was](#comment%3A13):\n> Thanks!  Isn't revision control awesome...\n\n\nWell, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting \"legacy\" spkgs to \"new style\" spkgs.",
    "created_at": "2014-05-11T15:05:04Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189231",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [was](#comment%3A13):
> Thanks!  Isn't revision control awesome...


Well, in this case it was our hand-made changelog in `SPKG.txt`, and others don't update but delete it when converting "legacy" spkgs to "new style" spkgs.



---

archive/issue_comments_189232.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a\">8a42373</a></td><td><code>Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178</code></td></tr></table>\n",
    "created_at": "2014-05-13T02:47:12Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189232",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a">8a42373</a></td><td><code>Removed zzfilename.patch and modified an existing patch that was the root cause of the error for ticket 15178</code></td></tr></table>




---

archive/issue_comments_189233.json:
```json
{
    "body": "**Changing commit** from \"[5bd09123dafcf5df768a02365f6df93a44087777](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)\" to \"[8a42373dd85a0e0813c040685f1474e7b735f82a](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)\".",
    "created_at": "2014-05-13T02:47:12Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5bd09123dafcf5df768a02365f6df93a44087777](https://github.com/sagemath/sagetrac-mirror/commit/5bd09123dafcf5df768a02365f6df93a44087777)" to "[8a42373dd85a0e0813c040685f1474e7b735f82a](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)".



---

archive/issue_comments_189234.json:
```json
{
    "body": "**Changing work_issues** from \"Remove new patch, fix old one\" to \"\".",
    "created_at": "2014-05-13T11:12:57Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189234",
    "user": "https://github.com/nexttime"
}
```

**Changing work_issues** from "Remove new patch, fix old one" to "".



---

archive/issue_events_133280.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-13T11:12:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133280"
}
```



---

archive/issue_events_133281.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-13T11:12:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133281"
}
```



---

archive/issue_comments_189235.json:
```json
{
    "body": "<a id='comment:16'></a>\nOk.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.",
    "created_at": "2014-05-13T11:12:57Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189235",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
Ok.  I personally would have started from scratch, then pushing *a new branch* to trac (with `-f`, force), but the commits aren't that large, so I don't really mind.



---

archive/issue_comments_189236.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [leif](#comment%3A10):\n> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\nI do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?",
    "created_at": "2014-05-17T20:43:43Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189236",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'></a>
Replying to [leif](#comment%3A10):
> Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?



---

archive/issue_comments_189237.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [pbruin](#comment%3A17):\n> Replying to [leif](#comment%3A10):\n> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the \"new git workflow\" others just drop it\n\n> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?\n\nYes.",
    "created_at": "2014-05-17T20:59:55Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189237",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>
Replying to [pbruin](#comment%3A17):
> Replying to [leif](#comment%3A10):
> > Probably the patch level in the package version (`package-version.txt`) should get bumped (to `.p6`), although with the "new git workflow" others just drop it

> I do think you have to update `package-version.txt`; isn't that how Sage knows that it should reinstall the package with the updated patches?

Yes.



---

archive/issue_comments_189238.json:
```json
{
    "body": "<a id='comment:19'></a>\nLeif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.",
    "created_at": "2014-05-17T21:04:53Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189238",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Leif beat me to it. The only reason not to bump the version is if you fix a building bug which prevented some people (but not everyone) to install. People with successful install shouldn't have to re-install and the people for whom you provided the fix couldn't install.



---

archive/issue_events_133282.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:21:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133282"
}
```



---

archive/issue_events_133283.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:21:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133283"
}
```



---

archive/issue_comments_189239.json:
```json
{
    "body": "<a id='comment:20'></a>\npatchbot:\n\n```\nsage -t --long /scratch/sage/src/sage/interfaces/expect.py\n**********************************************************************\nFile \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\ns.expect.Expect._eval_line\nFailed example:\n    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\nh, 2012)\nExpected:\n    False\nGot:\n    True\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.interfaces.expect.Expect._eval_line\n    [81 tests, 1 failure, 20.20 s]\n```",
    "created_at": "2014-05-18T13:21:32Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189239",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>
patchbot:

```
sage -t --long /scratch/sage/src/sage/interfaces/expect.py
**********************************************************************
File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
s.expect.Expect._eval_line
Failed example:
    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
h, 2012)
Expected:
    False
Got:
    True
**********************************************************************
1 item had failures:
   1 of  15 in sage.interfaces.expect.Expect._eval_line
    [81 tests, 1 failure, 20.20 s]
```



---

archive/issue_comments_189240.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [rws](#comment%3A20):\n> patchbot:\n> \n> ```\n> sage -t --long /scratch/sage/src/sage/interfaces/expect.py\n> **********************************************************************\n> File \"/scratch/sage/src/sage/interfaces/expect.py\", line 786, in sage.interface\n> s.expect.Expect._eval_line\n> Failed example:\n>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat\n> h, 2012)\n> Expected:\n>     False\n> Got:\n>     True\n> **********************************************************************\n> 1 item had failures:\n>    1 of  15 in sage.interfaces.expect.Expect._eval_line\n>     [81 tests, 1 failure, 20.20 s]\n> ```\n\n\nHow could the change here be related to this?",
    "created_at": "2014-05-18T13:48:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189240",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Replying to [rws](#comment%3A20):
> patchbot:
> 
> ```
> sage -t --long /scratch/sage/src/sage/interfaces/expect.py
> **********************************************************************
> File "/scratch/sage/src/sage/interfaces/expect.py", line 786, in sage.interface
> s.expect.Expect._eval_line
> Failed example:
>     singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.mat
> h, 2012)
> Expected:
>     False
> Got:
>     True
> **********************************************************************
> 1 item had failures:
>    1 of  15 in sage.interfaces.expect.Expect._eval_line
>     [81 tests, 1 failure, 20.20 s]
> ```


How could the change here be related to this?



---

archive/issue_comments_189241.json:
```json
{
    "body": "<a id='comment:22'></a>\nIs it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.\n\nEdit: Actually it was #10476 that hit.",
    "created_at": "2014-05-18T13:51:44Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189241",
    "user": "https://github.com/rwst"
}
```

<a id='comment:22'></a>
Is it not? I was only superficially skimming. Then it's another patchbot problem. Sorry for the fuss.

Edit: Actually it was #10476 that hit.



---

archive/issue_events_133284.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:51:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133284"
}
```



---

archive/issue_events_133285.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-18T13:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133285"
}
```



---

archive/issue_comments_189242.json:
```json
{
    "body": "**Work_Issues:** Update `package-version.txt`",
    "created_at": "2014-05-18T14:04:28Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189242",
    "user": "https://github.com/nexttime"
}
```

**Work_Issues:** Update `package-version.txt`



---

archive/issue_comments_189243.json:
```json
{
    "body": "<a id='comment:23'></a>\nSo, are we going to update `package-version.txt`?\n\nThe changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).\n\nIn the latter case, should `package-version.txt` still refer to `.p5`? ;-)\n\nBut here we actually change a patch to `pexpect`, so...",
    "created_at": "2014-05-18T14:04:28Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189243",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
So, are we going to update `package-version.txt`?

The changelog entry in `SPKG.txt` refers to `.p6`, but we could also just delete the whole changelog (later?).

In the latter case, should `package-version.txt` still refer to `.p5`? ;-)

But here we actually change a patch to `pexpect`, so...



---

archive/issue_events_133286.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-18T14:04:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133286"
}
```



---

archive/issue_events_133287.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-18T14:04:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133287"
}
```



---

archive/issue_comments_189244.json:
```json
{
    "body": "**Changing commit** from \"[8a42373dd85a0e0813c040685f1474e7b735f82a](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)\" to \"[4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)\".",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189244",
    "user": "https://github.com/pjbruin"
}
```

**Changing commit** from "[8a42373dd85a0e0813c040685f1474e7b735f82a](https://github.com/sagemath/sagetrac-mirror/commit/8a42373dd85a0e0813c040685f1474e7b735f82a)" to "[4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)".



---

archive/issue_comments_189245.json:
```json
{
    "body": "**Changing reviewer** from \"William Stein\" to \"William Stein, Peter Bruin\".",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189245",
    "user": "https://github.com/pjbruin"
}
```

**Changing reviewer** from "William Stein" to "William Stein, Peter Bruin".



---

archive/issue_comments_189246.json:
```json
{
    "body": "**Changing branch** from \"[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)\" to \"[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)\".",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189246",
    "user": "https://github.com/pjbruin"
}
```

**Changing branch** from "[u/bradlys/ticket/15178](https://github.com/sagemath/sagetrac-mirror/tree/u/bradlys/ticket/15178)" to "[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)".



---

archive/issue_comments_189247.json:
```json
{
    "body": "<a id='comment:24'></a>\nMerged the previous commits into one and added the `package-version.txt` update as a reviewer patch.",
    "created_at": "2014-05-24T12:02:27Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189247",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:24'></a>
Merged the previous commits into one and added the `package-version.txt` update as a reviewer patch.



---

archive/issue_events_133288.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-24T12:02:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133288"
}
```



---

archive/issue_events_133289.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-24T12:02:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133289"
}
```



---

archive/issue_events_133290.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-25T17:31:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133290"
}
```



---

archive/issue_events_133291.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8634ff216213117f1a065f2723dbf254990c785d",
    "created_at": "2014-05-25T17:31:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15178#event-133291"
}
```



---

archive/issue_comments_189248.json:
```json
{
    "body": "**Changing branch** from \"[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)\" to \"[4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)\".",
    "created_at": "2014-05-25T17:31:46Z",
    "issue": "https://github.com/sagemath/sage/issues/15178",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15178#issuecomment-189248",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/pbruin/15178-pexpect_which](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/15178-pexpect_which)" to "[4fdef7436a08d4ad2af8900d81816f440d7f9c34](https://github.com/sagemath/sagetrac-mirror/commit/4fdef7436a08d4ad2af8900d81816f440d7f9c34)".
