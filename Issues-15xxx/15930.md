# Issue 15930: CartanType hangs on bad input

archive/issues_015693.json:
```json
{
    "assignees": [],
    "body": "` sage: CartanType(ZZ) ` \n\nhangs.\n\nI suggest creating a new sage category for Cartan types\nso that there is a graceful way to \"type check\"\nsomething that should be a Cartan type.\nWithin this framework one could more explicitly codify \"direct product\",\n\"dual\", \"relabelled\" Cartan types.\n\n\nCC:  @tscrim @sagetrac-jakobkroeker\n\nReviewer: **Travis Scrimshaw**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15930_\n\n",
    "closed_at": "2022-02-25T07:13:43Z",
    "created_at": "2014-03-13T14:21:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "CartanType hangs on bad input",
    "type": "issue",
    "updated_at": "2022-02-25T07:13:43Z",
    "url": "https://github.com/sagemath/sage/issues/15930",
    "user": "https://github.com/sagetrac-mshimo"
}
```
` sage: CartanType(ZZ) ` 

hangs.

I suggest creating a new sage category for Cartan types
so that there is a graceful way to "type check"
something that should be a Cartan type.
Within this framework one could more explicitly codify "direct product",
"dual", "relabelled" Cartan types.


CC:  @tscrim @sagetrac-jakobkroeker

Reviewer: **Travis Scrimshaw**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/15930_





---

archive/issue_events_227391.json:
```json
{
    "actor": "https://github.com/sagetrac-mshimo",
    "created_at": "2014-03-13T14:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227391"
}
```



---

archive/issue_events_227392.json:
```json
{
    "actor": "https://github.com/sagetrac-mshimo",
    "created_at": "2014-03-13T14:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227392"
}
```



---

archive/issue_events_227393.json:
```json
{
    "actor": "https://github.com/sagetrac-mshimo",
    "created_at": "2014-03-13T14:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227393"
}
```



---

archive/issue_events_227394.json:
```json
{
    "actor": "https://github.com/sagetrac-mshimo",
    "created_at": "2014-03-13T14:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227394"
}
```



---

archive/issue_events_227395.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227395"
}
```



---

archive/issue_events_227396.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227396"
}
```



---

archive/issue_events_227397.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227397"
}
```



---

archive/issue_events_227398.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227398"
}
```



---

archive/issue_comments_201988.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSeems fixed now (sage 7.6 beta 4). Needs a test?\nThen needs review.",
    "created_at": "2017-03-03T23:58:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15930#issuecomment-201988",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<div id="comment:3" align="right">comment:3</div>

Seems fixed now (sage 7.6 beta 4). Needs a test?
Then needs review.



---

archive/issue_comments_201989.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI propose to close this one as \"garbage in, garbage out\".",
    "created_at": "2022-02-24T16:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15930#issuecomment-201989",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

I propose to close this one as "garbage in, garbage out".



---

archive/issue_events_227399.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227399"
}
```



---

archive/issue_events_227400.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227400"
}
```



---

archive/issue_events_227401.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227401"
}
```



---

archive/issue_events_227402.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227402"
}
```



---

archive/issue_comments_201990.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-02-24T23:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15930#issuecomment-201990",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_201991.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI actually get a now:\n\n```\nsage: CartanType(ZZ)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-4167abd6d9c5> in <module>\n----> 1 CartanType(ZZ)\n\n~/sage-build/local/lib/python3.9/site-packages/sage/combinat/root_system/cartan_type.py in __call__(self, *args)\n    588             return t.cartan_type()\n    589 \n--> 590         if len(t) == 1: # Fix for trac #13774\n    591             t = t[0]\n    592 \n\n~/sage-build/local/lib/python3.9/site-packages/sage/rings/ring.pyx in sage.rings.ring.Ring.__len__ (build/cythonized/sage/rings/ring.c:3344)()\n    236         if self.is_finite():\n    237             return self.cardinality()\n--> 238         raise NotImplementedError('len() of an infinite set')\n    239 \n    240     def __xor__(self, n):\n\nNotImplementedError: len() of an infinite set\n```\nHowever, it is more of a fluke because `ZZ` has a well-defined `len` that doesn't just iterate over the object. However, I agree on the general premise; it is necessarily the job of the constructor to police every type of input.",
    "created_at": "2022-02-24T23:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15930#issuecomment-201991",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

I actually get a now:

```
sage: CartanType(ZZ)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-4167abd6d9c5> in <module>
----> 1 CartanType(ZZ)

~/sage-build/local/lib/python3.9/site-packages/sage/combinat/root_system/cartan_type.py in __call__(self, *args)
    588             return t.cartan_type()
    589 
--> 590         if len(t) == 1: # Fix for trac #13774
    591             t = t[0]
    592 

~/sage-build/local/lib/python3.9/site-packages/sage/rings/ring.pyx in sage.rings.ring.Ring.__len__ (build/cythonized/sage/rings/ring.c:3344)()
    236         if self.is_finite():
    237             return self.cardinality()
--> 238         raise NotImplementedError('len() of an infinite set')
    239 
    240     def __xor__(self, n):

NotImplementedError: len() of an infinite set
```
However, it is more of a fluke because `ZZ` has a well-defined `len` that doesn't just iterate over the object. However, I agree on the general premise; it is necessarily the job of the constructor to police every type of input.



---

archive/issue_events_227403.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-24T23:35:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227403"
}
```



---

archive/issue_events_227404.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-24T23:35:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227404"
}
```



---

archive/issue_events_227405.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-25T07:13:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227405"
}
```



---

archive/issue_events_227406.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-25T07:13:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15930#event-227406"
}
```
