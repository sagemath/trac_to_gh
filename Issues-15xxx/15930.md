# Issue 15930: CartanType hangs on bad input

archive/issues_015693.json:
```json
{
    "body": "` sage: CartanType(ZZ) ` \n\nhangs.\n\nI suggest creating a new sage category for Cartan types\nso that there is a graceful way to \"type check\"\nsomething that should be a Cartan type.\nWithin this framework one could more explicitly codify \"direct product\",\n\"dual\", \"relabelled\" Cartan types.\n\n\n**CC:**  @tscrim jakobkroeker\n\n**Reviewer:** Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/15930\n\n",
    "closed_at": "2022-02-25T07:13:43Z",
    "created_at": "2014-03-13T14:21:58Z",
    "labels": [
        "component: combinatorics",
        "bug",
        "invalid"
    ],
    "title": "CartanType hangs on bad input",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15930",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```
` sage: CartanType(ZZ) ` 

hangs.

I suggest creating a new sage category for Cartan types
so that there is a graceful way to "type check"
something that should be a Cartan type.
Within this framework one could more explicitly codify "direct product",
"dual", "relabelled" Cartan types.


**CC:**  @tscrim jakobkroeker

**Reviewer:** Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/15930





---

archive/issue_events_144598.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144598"
}
```



---

archive/issue_events_144599.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144599"
}
```



---

archive/issue_events_144600.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144600"
}
```



---

archive/issue_events_144601.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144601"
}
```



---

archive/issue_comments_205975.json:
```json
{
    "body": "<a id='comment:3'></a>\nSeems fixed now (sage 7.6 beta 4). Needs a test?\nThen needs review.",
    "created_at": "2017-03-03T23:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15930#issuecomment-205975",
    "user": "https://trac.sagemath.org/admin/accounts/users/jakobkroeker"
}
```

<a id='comment:3'></a>
Seems fixed now (sage 7.6 beta 4). Needs a test?
Then needs review.



---

archive/issue_comments_205976.json:
```json
{
    "body": "<a id='comment:4'></a>\nI propose to close this one as \"garbage in, garbage out\".",
    "created_at": "2022-02-24T16:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15930#issuecomment-205976",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
I propose to close this one as "garbage in, garbage out".



---

archive/issue_events_144602.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144602"
}
```



---

archive/issue_events_144603.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144603"
}
```



---

archive/issue_events_144604.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-24T16:18:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "label": "duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144604"
}
```



---

archive/issue_comments_205977.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2022-02-24T23:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15930#issuecomment-205977",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_205978.json:
```json
{
    "body": "<a id='comment:5'></a>\nI actually get a now:\n\n```\nsage: CartanType(ZZ)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-4167abd6d9c5> in <module>\n----> 1 CartanType(ZZ)\n\n~/sage-build/local/lib/python3.9/site-packages/sage/combinat/root_system/cartan_type.py in __call__(self, *args)\n    588             return t.cartan_type()\n    589 \n--> 590         if len(t) == 1: # Fix for trac #13774\n    591             t = t[0]\n    592 \n\n~/sage-build/local/lib/python3.9/site-packages/sage/rings/ring.pyx in sage.rings.ring.Ring.__len__ (build/cythonized/sage/rings/ring.c:3344)()\n    236         if self.is_finite():\n    237             return self.cardinality()\n--> 238         raise NotImplementedError('len() of an infinite set')\n    239 \n    240     def __xor__(self, n):\n\nNotImplementedError: len() of an infinite set\n```\nHowever, it is more of a fluke because `ZZ` has a well-defined `len` that doesn't just iterate over the object. However, I agree on the general premise; it is necessarily the job of the constructor to police every type of input.",
    "created_at": "2022-02-24T23:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15930#issuecomment-205978",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
I actually get a now:

```
sage: CartanType(ZZ)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-4167abd6d9c5> in <module>
----> 1 CartanType(ZZ)

~/sage-build/local/lib/python3.9/site-packages/sage/combinat/root_system/cartan_type.py in __call__(self, *args)
    588             return t.cartan_type()
    589 
--> 590         if len(t) == 1: # Fix for trac #13774
    591             t = t[0]
    592 

~/sage-build/local/lib/python3.9/site-packages/sage/rings/ring.pyx in sage.rings.ring.Ring.__len__ (build/cythonized/sage/rings/ring.c:3344)()
    236         if self.is_finite():
    237             return self.cardinality()
--> 238         raise NotImplementedError('len() of an infinite set')
    239 
    240     def __xor__(self, n):

NotImplementedError: len() of an infinite set
```
However, it is more of a fluke because `ZZ` has a well-defined `len` that doesn't just iterate over the object. However, I agree on the general premise; it is necessarily the job of the constructor to police every type of input.



---

archive/issue_events_144605.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-24T23:35:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144605"
}
```



---

archive/issue_events_144606.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-24T23:35:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144606"
}
```



---

archive/issue_events_144607.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-25T07:13:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144607"
}
```



---

archive/issue_events_144608.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-02-25T07:13:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15930#event-144608"
}
```
